2024-03-27 11:46:58.273 | WARNING  | qlib.tests.data:qlib_data:175 - Data already exists: ~/.qlib/qlib_data/cn_data, the data download will be skipped
	If downloading is required: `exists_skip=False` or `change target_dir`
[2648869:MainThread](2024-03-27 11:46:58,274) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[2648869:MainThread](2024-03-27 11:46:58,277) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[2648869:MainThread](2024-03-27 11:46:58,277) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/cn_data')}
[2648869:MainThread](2024-03-27 11:46:58,280) WARNING - qlib.Rolling - [workflow.py:38] - Model type is not in the benchmark!
[2648869:MainThread](2024-03-27 11:46:58,305) INFO - qlib.Rolling - [base.py:162] - The prediction horizon is overrided
[2648869:MainThread](2024-03-27 11:47:11,742) INFO - qlib.timer - [log.py:127] - Time cost: 13.434s | Loading data Done
[2648869:MainThread](2024-03-27 11:47:12,740) INFO - qlib.timer - [log.py:127] - Time cost: 0.251s | DropCol Done
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/qlib/data/dataset/processor.py:391: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[cols] = (
[2648869:MainThread](2024-03-27 11:52:07,668) INFO - qlib.timer - [log.py:127] - Time cost: 294.927s | CSZFillna Done
[2648869:MainThread](2024-03-27 11:52:08,691) INFO - qlib.timer - [log.py:127] - Time cost: 0.256s | DropCol Done
[2648869:MainThread](2024-03-27 11:52:09,387) INFO - qlib.timer - [log.py:127] - Time cost: 0.696s | DropnaProcessor Done
[2648869:MainThread](2024-03-27 11:52:09,655) INFO - qlib.timer - [log.py:127] - Time cost: 0.268s | DropnaLabel Done
[2648869:MainThread](2024-03-27 11:52:15,289) INFO - qlib.timer - [log.py:127] - Time cost: 5.633s | CSZScoreNorm Done
[2648869:MainThread](2024-03-27 11:52:15,291) INFO - qlib.timer - [log.py:127] - Time cost: 303.548s | fit & process data Done
[2648869:MainThread](2024-03-27 11:52:15,291) INFO - qlib.timer - [log.py:127] - Time cost: 316.984s | Init data Done
[2648869:MainThread](2024-03-27 11:52:17,717) INFO - qlib.Rolling - [base.py:173] - {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.002, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 8192, 'GPU': 0, 'weight_decay': 0.0002, 'pt_model_kwargs': {'input_dim': 157}}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/code/qlib/examples/benchmarks/MLP/Alpha158.f6683b3d28.pkl', 'segments': {'train': [datetime.date(2008, 1, 1), datetime.date(2014, 12, 31)], 'valid': [datetime.date(2015, 1, 1), datetime.date(2016, 12, 31)], 'test': [datetime.date(2017, 1, 1), datetime.date(2020, 8, 1)]}}}, 'record': [{'class': 'SignalRecord', 'module_path': 'qlib.workflow.record_temp', 'kwargs': {'model': '<MODEL>', 'dataset': '<DATASET>'}}, {'class': 'SigAnaRecord', 'module_path': 'qlib.workflow.record_temp', 'kwargs': {'ana_long_short': False, 'ann_scaler': 252}}, {'class': 'PortAnaRecord', 'module_path': 'qlib.workflow.record_temp', 'kwargs': {'config': {'strategy': {'class': 'TopkDropoutStrategy', 'module_path': 'qlib.contrib.strategy', 'kwargs': {'signal': '<PRED>', 'topk': 50, 'n_drop': 5}}, 'backtest': {'start_time': datetime.date(2017, 1, 1), 'end_time': datetime.date(2020, 8, 1), 'account': 100000000, 'benchmark': 'SH000300', 'exchange_kwargs': {'limit_threshold': 0.095, 'deal_price': 'close', 'open_cost': 0.0005, 'close_cost': 0.0015, 'min_cost': 5}}}}}]}
[2648869:MainThread](2024-03-27 11:52:17,719) WARNING - qlib.data - [data.py:666] - load calendar error: freq=day, future=True; return current calendar!
[2648869:MainThread](2024-03-27 11:52:17,719) WARNING - qlib.data - [data.py:669] - You can get future calendar by referring to the following document: https://github.com/microsoft/qlib/blob/main/scripts/data_collector/contrib/README.md
[2648869:MainThread](2024-03-27 11:52:17,748) INFO - qlib.MetaDatasetDS - [dataset.py:355] - Example task for training meta model: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.002, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 8192, 'GPU': 0, 'weight_decay': 0.0002, 'pt_model_kwargs': {'input_dim': 157}}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/code/qlib/examples/benchmarks/MLP/Alpha158.f6683b3d28.pkl', 'segments': {'train': (Timestamp('2008-01-02 00:00:00'), Timestamp('2014-12-31 00:00:00')), 'valid': (Timestamp('2015-01-05 00:00:00'), Timestamp('2016-12-02 00:00:00')), 'test': (Timestamp('2017-01-03 00:00:00'), Timestamp('2017-02-06 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/44 [00:00<?, ?it/s]creating meta tasks:   2%|▏         | 1/44 [00:00<00:17,  2.49it/s]creating meta tasks:   5%|▍         | 2/44 [00:00<00:17,  2.42it/s]creating meta tasks:   7%|▋         | 3/44 [00:01<00:17,  2.33it/s]creating meta tasks:   9%|▉         | 4/44 [00:01<00:17,  2.29it/s]creating meta tasks:  11%|█▏        | 5/44 [00:02<00:17,  2.26it/s]creating meta tasks:  14%|█▎        | 6/44 [00:02<00:16,  2.24it/s]creating meta tasks:  16%|█▌        | 7/44 [00:03<00:16,  2.23it/s]creating meta tasks:  18%|█▊        | 8/44 [00:03<00:16,  2.22it/s]creating meta tasks:  20%|██        | 9/44 [00:03<00:15,  2.22it/s]creating meta tasks:  23%|██▎       | 10/44 [00:04<00:15,  2.18it/s]creating meta tasks:  25%|██▌       | 11/44 [00:04<00:15,  2.18it/s]creating meta tasks:  27%|██▋       | 12/44 [00:05<00:14,  2.16it/s]creating meta tasks:  30%|██▉       | 13/44 [00:05<00:14,  2.15it/s]creating meta tasks:  32%|███▏      | 14/44 [00:06<00:14,  2.14it/s]creating meta tasks:  34%|███▍      | 15/44 [00:06<00:13,  2.14it/s]creating meta tasks:  36%|███▋      | 16/44 [00:07<00:13,  2.14it/s]creating meta tasks:  39%|███▊      | 17/44 [00:07<00:12,  2.13it/s]creating meta tasks:  41%|████      | 18/44 [00:08<00:12,  2.12it/s]creating meta tasks:  43%|████▎     | 19/44 [00:08<00:11,  2.12it/s]creating meta tasks:  45%|████▌     | 20/44 [00:09<00:11,  2.17it/s]creating meta tasks:  48%|████▊     | 21/44 [00:09<00:10,  2.24it/s]creating meta tasks:  50%|█████     | 22/44 [00:09<00:09,  2.28it/s]creating meta tasks:  52%|█████▏    | 23/44 [00:10<00:09,  2.31it/s]creating meta tasks:  55%|█████▍    | 24/44 [00:10<00:08,  2.33it/s]creating meta tasks:  57%|█████▋    | 25/44 [00:11<00:08,  2.34it/s]creating meta tasks:  59%|█████▉    | 26/44 [00:11<00:07,  2.35it/s]creating meta tasks:  61%|██████▏   | 27/44 [00:12<00:07,  2.36it/s]creating meta tasks:  64%|██████▎   | 28/44 [00:12<00:06,  2.35it/s]creating meta tasks:  66%|██████▌   | 29/44 [00:12<00:06,  2.30it/s]creating meta tasks:  68%|██████▊   | 30/44 [00:13<00:06,  2.30it/s]creating meta tasks:  70%|███████   | 31/44 [00:13<00:05,  2.30it/s]creating meta tasks:  73%|███████▎  | 32/44 [00:14<00:05,  2.30it/s]creating meta tasks:  75%|███████▌  | 33/44 [00:14<00:04,  2.26it/s]creating meta tasks:  77%|███████▋  | 34/44 [00:15<00:04,  2.27it/s]creating meta tasks:  80%|███████▉  | 35/44 [00:15<00:03,  2.28it/s]creating meta tasks:  82%|████████▏ | 36/44 [00:16<00:03,  2.18it/s]creating meta tasks:  84%|████████▍ | 37/44 [00:16<00:03,  2.12it/s]creating meta tasks:  86%|████████▋ | 38/44 [00:17<00:02,  2.08it/s]creating meta tasks:  89%|████████▊ | 39/44 [00:17<00:02,  2.05it/s]creating meta tasks:  91%|█████████ | 40/44 [00:18<00:01,  2.03it/s]creating meta tasks:  93%|█████████▎| 41/44 [00:18<00:01,  2.09it/s]creating meta tasks:  95%|█████████▌| 42/44 [00:18<00:00,  2.14it/s]creating meta tasks:  98%|█████████▊| 43/44 [00:19<00:00,  2.17it/s]creating meta tasks: 100%|██████████| 44/44 [00:19<00:00,  2.18it/s]creating meta tasks: 100%|██████████| 44/44 [00:19<00:00,  2.21it/s]
[2648869:MainThread](2024-03-27 11:52:37,911) INFO - qlib.Rolling - [base.py:190] - Deleting previous Rolling results
[2648869:MainThread](2024-03-27 11:52:37,915) INFO - qlib.Rolling - [base.py:196] - No previous rolling results
train tasks:   0%|          | 0/44 [00:00<?, ?it/s][2648869:MainThread](2024-03-27 11:52:37,918) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name rolling_models_20240327114658.
[2648869:MainThread](2024-03-27 11:52:37,925) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 11:52:38,395) INFO - qlib.workflow - [recorder.py:341] - Recorder d962efd420af4ac1b0c2557fafc8efad starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 11:52:38,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 11:52:38,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 11:52:38,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 11:52:38,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 11:52:45,410) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.766359
            SH600004      0.766359
            SH600006      0.766359
            SH600007      0.766359
            SH600008      0.766359
                            ...   
2014-12-31  SZ300058      1.688579
            SZ300070      1.688579
            SZ300124      1.688579
            SZ300146      1.688579
            SZ300251      1.688579
Length: 434169, dtype: float64
[2648869:MainThread](2024-03-27 11:52:46,322) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2015-01-05  SH600000      1.688579
            SH600008      1.688579
            SH600009      1.688579
            SH600010      1.688579
            SH600011      1.688579
                            ...   
2016-12-02  SZ300144      0.694610
            SZ300146      0.694610
            SZ300168      0.694610
            SZ300251      0.694610
            SZ300315      0.694610
Length: 107243, dtype: float64
[2648869:MainThread](2024-03-27 11:52:46,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 11:52:46,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.311006, valid_loss 1.381716, train_metric nan, valid_metric 0.028581
[2648869:MainThread](2024-03-27 11:52:46,972) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.381716, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 11:52:47,184) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.218721, valid_loss 1.369845, train_metric nan, valid_metric 0.081882
[2648869:MainThread](2024-03-27 11:52:47,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.381716 to 1.369845, save checkpoint.
[2648869:MainThread](2024-03-27 11:52:47,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.172083, valid_loss 1.387298, train_metric nan, valid_metric 0.027764
[2648869:MainThread](2024-03-27 11:52:47,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.087289, valid_loss 1.369166, train_metric nan, valid_metric 0.072493
[2648869:MainThread](2024-03-27 11:52:47,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.369845 to 1.369166, save checkpoint.
[2648869:MainThread](2024-03-27 11:52:47,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.062339, valid_loss 1.369253, train_metric nan, valid_metric 0.073519
[2648869:MainThread](2024-03-27 11:52:48,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.083879, valid_loss 1.361309, train_metric nan, valid_metric 0.103041
[2648869:MainThread](2024-03-27 11:52:48,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.369166 to 1.361309, save checkpoint.
[2648869:MainThread](2024-03-27 11:52:48,292) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.083053, valid_loss 1.364714, train_metric nan, valid_metric 0.092850
[2648869:MainThread](2024-03-27 11:52:48,500) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.078696, valid_loss 1.362553, train_metric nan, valid_metric 0.105201
[2648869:MainThread](2024-03-27 11:52:48,702) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.066940, valid_loss 1.361163, train_metric nan, valid_metric 0.112585
[2648869:MainThread](2024-03-27 11:52:48,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.361309 to 1.361163, save checkpoint.
[2648869:MainThread](2024-03-27 11:52:48,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.060513, valid_loss 1.363112, train_metric nan, valid_metric 0.101426
[2648869:MainThread](2024-03-27 11:52:49,108) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.094911, valid_loss 1.364915, train_metric nan, valid_metric 0.103281
[2648869:MainThread](2024-03-27 11:52:49,321) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.046458, valid_loss 1.360760, train_metric nan, valid_metric 0.114288
[2648869:MainThread](2024-03-27 11:52:49,321) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.361163 to 1.360760, save checkpoint.
[2648869:MainThread](2024-03-27 11:52:49,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.044793, valid_loss 1.359487, train_metric nan, valid_metric 0.117639
[2648869:MainThread](2024-03-27 11:52:49,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.360760 to 1.359487, save checkpoint.
[2648869:MainThread](2024-03-27 11:52:49,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.057386, valid_loss 1.364768, train_metric nan, valid_metric 0.110982
[2648869:MainThread](2024-03-27 11:52:49,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.077538, valid_loss 1.358944, train_metric nan, valid_metric 0.117031
[2648869:MainThread](2024-03-27 11:52:49,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.359487 to 1.358944, save checkpoint.
[2648869:MainThread](2024-03-27 11:52:50,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.044670, valid_loss 1.361193, train_metric nan, valid_metric 0.123031
[2648869:MainThread](2024-03-27 11:52:50,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.042042, valid_loss 1.360078, train_metric nan, valid_metric 0.117080
[2648869:MainThread](2024-03-27 11:52:50,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.068281, valid_loss 1.366545, train_metric nan, valid_metric 0.114086
[2648869:MainThread](2024-03-27 11:52:50,760) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.046835, valid_loss 1.361337, train_metric nan, valid_metric 0.122010
[2648869:MainThread](2024-03-27 11:52:50,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.039946, valid_loss 1.358335, train_metric nan, valid_metric 0.126202
[2648869:MainThread](2024-03-27 11:52:50,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.358944 to 1.358335, save checkpoint.
[2648869:MainThread](2024-03-27 11:52:51,171) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.040462, valid_loss 1.357257, train_metric nan, valid_metric 0.123967
[2648869:MainThread](2024-03-27 11:52:51,172) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.358335 to 1.357257, save checkpoint.
[2648869:MainThread](2024-03-27 11:52:51,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.035405, valid_loss 1.358993, train_metric nan, valid_metric 0.125337
[2648869:MainThread](2024-03-27 11:52:51,581) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.024725, valid_loss 1.360989, train_metric nan, valid_metric 0.121966
[2648869:MainThread](2024-03-27 11:52:51,782) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.019894, valid_loss 1.360211, train_metric nan, valid_metric 0.116321
[2648869:MainThread](2024-03-27 11:52:51,985) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.015185, valid_loss 1.361905, train_metric nan, valid_metric 0.112266
[2648869:MainThread](2024-03-27 11:52:52,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.022917, valid_loss 1.362622, train_metric nan, valid_metric 0.106107
[2648869:MainThread](2024-03-27 11:52:52,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.030910, valid_loss 1.361107, train_metric nan, valid_metric 0.116536
[2648869:MainThread](2024-03-27 11:52:52,590) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.020200, valid_loss 1.361661, train_metric nan, valid_metric 0.112064
[2648869:MainThread](2024-03-27 11:52:52,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.028300, valid_loss 1.360295, train_metric nan, valid_metric 0.116625
[2648869:MainThread](2024-03-27 11:52:52,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.020766, valid_loss 1.358187, train_metric nan, valid_metric 0.126258
[2648869:MainThread](2024-03-27 11:52:53,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.022189, valid_loss 1.357709, train_metric nan, valid_metric 0.125879
[2648869:MainThread](2024-03-27 11:52:53,396) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.039268, valid_loss 1.361666, train_metric nan, valid_metric 0.115643
[2648869:MainThread](2024-03-27 11:52:53,598) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.032903, valid_loss 1.362128, train_metric nan, valid_metric 0.118804
[2648869:MainThread](2024-03-27 11:52:53,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.019776, valid_loss 1.358928, train_metric nan, valid_metric 0.127044
[2648869:MainThread](2024-03-27 11:52:53,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.029031, valid_loss 1.359590, train_metric nan, valid_metric 0.120659
[2648869:MainThread](2024-03-27 11:52:54,196) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.019357, valid_loss 1.363080, train_metric nan, valid_metric 0.105257
[2648869:MainThread](2024-03-27 11:52:54,400) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.026313, valid_loss 1.362318, train_metric nan, valid_metric 0.112874
[2648869:MainThread](2024-03-27 11:52:54,607) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.008934, valid_loss 1.361848, train_metric nan, valid_metric 0.116927
[2648869:MainThread](2024-03-27 11:52:54,812) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.020363, valid_loss 1.360228, train_metric nan, valid_metric 0.120423
[2648869:MainThread](2024-03-27 11:52:55,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.017813, valid_loss 1.359502, train_metric nan, valid_metric 0.119030
[2648869:MainThread](2024-03-27 11:52:55,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.022242, valid_loss 1.360774, train_metric nan, valid_metric 0.116275
[2648869:MainThread](2024-03-27 11:52:55,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.021922, valid_loss 1.360318, train_metric nan, valid_metric 0.118081
[2648869:MainThread](2024-03-27 11:52:55,624) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.027334, valid_loss 1.360965, train_metric nan, valid_metric 0.113936
[2648869:MainThread](2024-03-27 11:52:55,830) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.010524, valid_loss 1.360228, train_metric nan, valid_metric 0.115287
[2648869:MainThread](2024-03-27 11:52:56,033) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.019069, valid_loss 1.359138, train_metric nan, valid_metric 0.116686
[2648869:MainThread](2024-03-27 11:52:56,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.008844, valid_loss 1.359126, train_metric nan, valid_metric 0.118816
[2648869:MainThread](2024-03-27 11:52:56,444) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.006706, valid_loss 1.359406, train_metric nan, valid_metric 0.118915
[2648869:MainThread](2024-03-27 11:52:56,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.011683, valid_loss 1.359207, train_metric nan, valid_metric 0.118962
[2648869:MainThread](2024-03-27 11:52:56,846) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.017809, valid_loss 1.358606, train_metric nan, valid_metric 0.118965
[2648869:MainThread](2024-03-27 11:52:57,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.015197, valid_loss 1.358771, train_metric nan, valid_metric 0.118706
[2648869:MainThread](2024-03-27 11:52:57,251) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.017960, valid_loss 1.360286, train_metric nan, valid_metric 0.117089
[2648869:MainThread](2024-03-27 11:52:57,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.010323, valid_loss 1.360647, train_metric nan, valid_metric 0.115193
[2648869:MainThread](2024-03-27 11:52:57,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.030200, valid_loss 1.360167, train_metric nan, valid_metric 0.117732
[2648869:MainThread](2024-03-27 11:52:57,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.008391, valid_loss 1.359104, train_metric nan, valid_metric 0.118616
[2648869:MainThread](2024-03-27 11:52:58,052) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.010516, valid_loss 1.361735, train_metric nan, valid_metric 0.114481
[2648869:MainThread](2024-03-27 11:52:58,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.007261, valid_loss 1.359022, train_metric nan, valid_metric 0.119030
[2648869:MainThread](2024-03-27 11:52:58,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.996167, valid_loss 1.357855, train_metric nan, valid_metric 0.117201
[2648869:MainThread](2024-03-27 11:52:58,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.007355, valid_loss 1.359980, train_metric nan, valid_metric 0.119818
[2648869:MainThread](2024-03-27 11:52:58,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.006288, valid_loss 1.359927, train_metric nan, valid_metric 0.118554
[2648869:MainThread](2024-03-27 11:52:59,050) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.011046, valid_loss 1.360100, train_metric nan, valid_metric 0.117745
[2648869:MainThread](2024-03-27 11:52:59,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.013694, valid_loss 1.360195, train_metric nan, valid_metric 0.119718
[2648869:MainThread](2024-03-27 11:52:59,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.014126, valid_loss 1.358781, train_metric nan, valid_metric 0.118454
[2648869:MainThread](2024-03-27 11:52:59,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.018756, valid_loss 1.359910, train_metric nan, valid_metric 0.115755
[2648869:MainThread](2024-03-27 11:52:59,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.000236, valid_loss 1.359691, train_metric nan, valid_metric 0.115941
[2648869:MainThread](2024-03-27 11:53:00,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.014397, valid_loss 1.360213, train_metric nan, valid_metric 0.113532
[2648869:MainThread](2024-03-27 11:53:00,268) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.019099, valid_loss 1.360444, train_metric nan, valid_metric 0.115139
[2648869:MainThread](2024-03-27 11:53:00,474) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.018234, valid_loss 1.359856, train_metric nan, valid_metric 0.117304
[2648869:MainThread](2024-03-27 11:53:00,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.022572, valid_loss 1.361341, train_metric nan, valid_metric 0.116057
[2648869:MainThread](2024-03-27 11:53:00,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.015096, valid_loss 1.361985, train_metric nan, valid_metric 0.115350
[2648869:MainThread](2024-03-27 11:53:01,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.009832, valid_loss 1.361054, train_metric nan, valid_metric 0.116829
[2648869:MainThread](2024-03-27 11:53:01,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.014793, valid_loss 1.360428, train_metric nan, valid_metric 0.116529
[2648869:MainThread](2024-03-27 11:53:01,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 11:53:01,939) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 11:53:02,641) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   2%|▏         | 1/44 [00:24<17:43, 24.73s/it][2648869:MainThread](2024-03-27 11:53:02,647) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 11:53:02,658) INFO - qlib.workflow - [recorder.py:341] - Recorder 36e310a0d26345d0855bb6c386d8fa72 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 11:53:03,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 11:53:03,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 11:53:03,287) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 11:53:03,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 11:53:05,060) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.730198
            SH600004      0.730198
            SH600006      0.730198
            SH600007      0.730198
            SH600008      0.730198
                            ...   
2015-01-30  SZ300058      0.800932
            SZ300070      0.800932
            SZ300124      0.800932
            SZ300133      0.800932
            SZ300146      0.800932
Length: 439229, dtype: float64
[2648869:MainThread](2024-03-27 11:53:05,966) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2015-02-02  SH600000      0.800932
            SH600008      0.800932
            SH600009      0.800932
            SH600010      0.800932
            SH600011      0.800932
                            ...   
2016-12-30  SZ300133      0.925023
            SZ300144      0.925023
            SZ300146      0.925023
            SZ300182      0.925023
            SZ300251      0.925023
Length: 107566, dtype: float64
[2648869:MainThread](2024-03-27 11:53:06,066) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 11:53:06,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.235009, valid_loss 1.402998, train_metric nan, valid_metric 0.055978
[2648869:MainThread](2024-03-27 11:53:06,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.402998, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 11:53:06,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.172662, valid_loss 1.397426, train_metric nan, valid_metric 0.069244
[2648869:MainThread](2024-03-27 11:53:06,731) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.402998 to 1.397426, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:06,912) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.118223, valid_loss 1.391426, train_metric nan, valid_metric 0.083160
[2648869:MainThread](2024-03-27 11:53:06,913) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.397426 to 1.391426, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:07,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.123601, valid_loss 1.400937, train_metric nan, valid_metric 0.048102
[2648869:MainThread](2024-03-27 11:53:07,285) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.094932, valid_loss 1.387052, train_metric nan, valid_metric 0.101701
[2648869:MainThread](2024-03-27 11:53:07,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.391426 to 1.387052, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:07,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.100271, valid_loss 1.412268, train_metric nan, valid_metric 0.017268
[2648869:MainThread](2024-03-27 11:53:07,667) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.081035, valid_loss 1.385987, train_metric nan, valid_metric 0.098734
[2648869:MainThread](2024-03-27 11:53:07,667) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.387052 to 1.385987, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:07,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.060716, valid_loss 1.392099, train_metric nan, valid_metric 0.085143
[2648869:MainThread](2024-03-27 11:53:08,058) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.102457, valid_loss 1.390768, train_metric nan, valid_metric 0.081693
[2648869:MainThread](2024-03-27 11:53:08,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.064051, valid_loss 1.384123, train_metric nan, valid_metric 0.102416
[2648869:MainThread](2024-03-27 11:53:08,260) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.385987 to 1.384123, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:08,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.050851, valid_loss 1.393174, train_metric nan, valid_metric 0.063174
[2648869:MainThread](2024-03-27 11:53:08,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.060679, valid_loss 1.387294, train_metric nan, valid_metric 0.111337
[2648869:MainThread](2024-03-27 11:53:08,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.091703, valid_loss 1.385095, train_metric nan, valid_metric 0.099278
[2648869:MainThread](2024-03-27 11:53:09,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.063767, valid_loss 1.385069, train_metric nan, valid_metric 0.102997
[2648869:MainThread](2024-03-27 11:53:09,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.044840, valid_loss 1.389884, train_metric nan, valid_metric 0.082092
[2648869:MainThread](2024-03-27 11:53:09,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.061398, valid_loss 1.390751, train_metric nan, valid_metric 0.098956
[2648869:MainThread](2024-03-27 11:53:09,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.065983, valid_loss 1.384485, train_metric nan, valid_metric 0.112261
[2648869:MainThread](2024-03-27 11:53:09,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.052086, valid_loss 1.385270, train_metric nan, valid_metric 0.107932
[2648869:MainThread](2024-03-27 11:53:10,050) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.050159, valid_loss 1.384229, train_metric nan, valid_metric 0.111024
[2648869:MainThread](2024-03-27 11:53:10,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.047034, valid_loss 1.385199, train_metric nan, valid_metric 0.101493
[2648869:MainThread](2024-03-27 11:53:10,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.047558, valid_loss 1.384978, train_metric nan, valid_metric 0.103245
[2648869:MainThread](2024-03-27 11:53:10,659) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.048270, valid_loss 1.385877, train_metric nan, valid_metric 0.101653
[2648869:MainThread](2024-03-27 11:53:10,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.043759, valid_loss 1.383835, train_metric nan, valid_metric 0.102005
[2648869:MainThread](2024-03-27 11:53:10,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.384123 to 1.383835, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:11,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.025948, valid_loss 1.386857, train_metric nan, valid_metric 0.094355
[2648869:MainThread](2024-03-27 11:53:11,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.035143, valid_loss 1.384474, train_metric nan, valid_metric 0.101255
[2648869:MainThread](2024-03-27 11:53:11,474) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.033260, valid_loss 1.384084, train_metric nan, valid_metric 0.102678
[2648869:MainThread](2024-03-27 11:53:11,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.033874, valid_loss 1.385367, train_metric nan, valid_metric 0.098485
[2648869:MainThread](2024-03-27 11:53:11,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.032213, valid_loss 1.383882, train_metric nan, valid_metric 0.100897
[2648869:MainThread](2024-03-27 11:53:12,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.040148, valid_loss 1.383462, train_metric nan, valid_metric 0.105487
[2648869:MainThread](2024-03-27 11:53:12,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.383835 to 1.383462, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:12,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.049758, valid_loss 1.384108, train_metric nan, valid_metric 0.104068
[2648869:MainThread](2024-03-27 11:53:12,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.041052, valid_loss 1.382710, train_metric nan, valid_metric 0.107675
[2648869:MainThread](2024-03-27 11:53:12,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.383462 to 1.382710, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:12,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.031712, valid_loss 1.384088, train_metric nan, valid_metric 0.108903
[2648869:MainThread](2024-03-27 11:53:12,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.039384, valid_loss 1.383398, train_metric nan, valid_metric 0.107543
[2648869:MainThread](2024-03-27 11:53:13,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.039814, valid_loss 1.384214, train_metric nan, valid_metric 0.108802
[2648869:MainThread](2024-03-27 11:53:13,287) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.021615, valid_loss 1.382993, train_metric nan, valid_metric 0.102577
[2648869:MainThread](2024-03-27 11:53:13,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.034948, valid_loss 1.383426, train_metric nan, valid_metric 0.108001
[2648869:MainThread](2024-03-27 11:53:13,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.039537, valid_loss 1.383038, train_metric nan, valid_metric 0.108508
[2648869:MainThread](2024-03-27 11:53:13,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.046455, valid_loss 1.384383, train_metric nan, valid_metric 0.103284
[2648869:MainThread](2024-03-27 11:53:14,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.031615, valid_loss 1.383568, train_metric nan, valid_metric 0.107231
[2648869:MainThread](2024-03-27 11:53:14,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.049298, valid_loss 1.384144, train_metric nan, valid_metric 0.106746
[2648869:MainThread](2024-03-27 11:53:14,494) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.034465, valid_loss 1.383392, train_metric nan, valid_metric 0.112313
[2648869:MainThread](2024-03-27 11:53:14,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.043729, valid_loss 1.383353, train_metric nan, valid_metric 0.110134
[2648869:MainThread](2024-03-27 11:53:14,897) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.021621, valid_loss 1.383052, train_metric nan, valid_metric 0.112421
[2648869:MainThread](2024-03-27 11:53:15,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.035263, valid_loss 1.383959, train_metric nan, valid_metric 0.106055
[2648869:MainThread](2024-03-27 11:53:15,296) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.038946, valid_loss 1.384403, train_metric nan, valid_metric 0.107441
[2648869:MainThread](2024-03-27 11:53:15,502) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.042371, valid_loss 1.384973, train_metric nan, valid_metric 0.101353
[2648869:MainThread](2024-03-27 11:53:15,705) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.026742, valid_loss 1.384460, train_metric nan, valid_metric 0.104316
[2648869:MainThread](2024-03-27 11:53:15,909) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.034815, valid_loss 1.384006, train_metric nan, valid_metric 0.109467
[2648869:MainThread](2024-03-27 11:53:16,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.027176, valid_loss 1.385082, train_metric nan, valid_metric 0.103584
[2648869:MainThread](2024-03-27 11:53:16,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.051623, valid_loss 1.384954, train_metric nan, valid_metric 0.105953
[2648869:MainThread](2024-03-27 11:53:16,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.042249, valid_loss 1.383095, train_metric nan, valid_metric 0.109064
[2648869:MainThread](2024-03-27 11:53:16,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.017523, valid_loss 1.384089, train_metric nan, valid_metric 0.108447
[2648869:MainThread](2024-03-27 11:53:16,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.038615, valid_loss 1.384113, train_metric nan, valid_metric 0.106530
[2648869:MainThread](2024-03-27 11:53:17,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.032441, valid_loss 1.385223, train_metric nan, valid_metric 0.106714
[2648869:MainThread](2024-03-27 11:53:17,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.025835, valid_loss 1.383095, train_metric nan, valid_metric 0.107302
[2648869:MainThread](2024-03-27 11:53:17,515) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.034517, valid_loss 1.383085, train_metric nan, valid_metric 0.105585
[2648869:MainThread](2024-03-27 11:53:17,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.026456, valid_loss 1.385317, train_metric nan, valid_metric 0.100507
[2648869:MainThread](2024-03-27 11:53:17,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.018546, valid_loss 1.384928, train_metric nan, valid_metric 0.102322
[2648869:MainThread](2024-03-27 11:53:18,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.023538, valid_loss 1.383813, train_metric nan, valid_metric 0.105939
[2648869:MainThread](2024-03-27 11:53:18,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.024064, valid_loss 1.384698, train_metric nan, valid_metric 0.106818
[2648869:MainThread](2024-03-27 11:53:18,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.045713, valid_loss 1.384007, train_metric nan, valid_metric 0.108017
[2648869:MainThread](2024-03-27 11:53:18,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.036977, valid_loss 1.383832, train_metric nan, valid_metric 0.107679
[2648869:MainThread](2024-03-27 11:53:18,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.022603, valid_loss 1.385419, train_metric nan, valid_metric 0.104953
[2648869:MainThread](2024-03-27 11:53:19,119) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.030232, valid_loss 1.383666, train_metric nan, valid_metric 0.110225
[2648869:MainThread](2024-03-27 11:53:19,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.036543, valid_loss 1.384247, train_metric nan, valid_metric 0.109658
[2648869:MainThread](2024-03-27 11:53:19,517) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.020601, valid_loss 1.382360, train_metric nan, valid_metric 0.107786
[2648869:MainThread](2024-03-27 11:53:19,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.382710 to 1.382360, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:19,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.033555, valid_loss 1.382640, train_metric nan, valid_metric 0.109455
[2648869:MainThread](2024-03-27 11:53:19,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.028654, valid_loss 1.383519, train_metric nan, valid_metric 0.108841
[2648869:MainThread](2024-03-27 11:53:20,129) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.032569, valid_loss 1.383710, train_metric nan, valid_metric 0.107084
[2648869:MainThread](2024-03-27 11:53:20,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.029420, valid_loss 1.383126, train_metric nan, valid_metric 0.106845
[2648869:MainThread](2024-03-27 11:53:20,527) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.018838, valid_loss 1.383720, train_metric nan, valid_metric 0.107538
[2648869:MainThread](2024-03-27 11:53:20,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.022596, valid_loss 1.383248, train_metric nan, valid_metric 0.108171
[2648869:MainThread](2024-03-27 11:53:20,941) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.021982, valid_loss 1.383053, train_metric nan, valid_metric 0.107302
[2648869:MainThread](2024-03-27 11:53:21,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.041223, valid_loss 1.385865, train_metric nan, valid_metric 0.102038
[2648869:MainThread](2024-03-27 11:53:21,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.029185, valid_loss 1.383403, train_metric nan, valid_metric 0.107597
[2648869:MainThread](2024-03-27 11:53:21,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.029147, valid_loss 1.383124, train_metric nan, valid_metric 0.108369
[2648869:MainThread](2024-03-27 11:53:21,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.031376, valid_loss 1.384867, train_metric nan, valid_metric 0.107419
[2648869:MainThread](2024-03-27 11:53:21,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.023301, valid_loss 1.384008, train_metric nan, valid_metric 0.108175
[2648869:MainThread](2024-03-27 11:53:22,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.023304, valid_loss 1.382948, train_metric nan, valid_metric 0.108916
[2648869:MainThread](2024-03-27 11:53:22,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.028103, valid_loss 1.384175, train_metric nan, valid_metric 0.108713
[2648869:MainThread](2024-03-27 11:53:22,561) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.024173, valid_loss 1.383012, train_metric nan, valid_metric 0.107920
[2648869:MainThread](2024-03-27 11:53:22,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.042027, valid_loss 1.383107, train_metric nan, valid_metric 0.109374
[2648869:MainThread](2024-03-27 11:53:22,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.039111, valid_loss 1.383406, train_metric nan, valid_metric 0.109500
[2648869:MainThread](2024-03-27 11:53:23,167) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.014082, valid_loss 1.382980, train_metric nan, valid_metric 0.106874
[2648869:MainThread](2024-03-27 11:53:23,369) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.036598, valid_loss 1.383468, train_metric nan, valid_metric 0.105482
[2648869:MainThread](2024-03-27 11:53:23,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.016248, valid_loss 1.383577, train_metric nan, valid_metric 0.109527
[2648869:MainThread](2024-03-27 11:53:23,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.033636, valid_loss 1.383631, train_metric nan, valid_metric 0.107095
[2648869:MainThread](2024-03-27 11:53:23,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.029424, valid_loss 1.383345, train_metric nan, valid_metric 0.110286
[2648869:MainThread](2024-03-27 11:53:24,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.020366, valid_loss 1.382761, train_metric nan, valid_metric 0.110174
[2648869:MainThread](2024-03-27 11:53:24,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.012899, valid_loss 1.382777, train_metric nan, valid_metric 0.109266
[2648869:MainThread](2024-03-27 11:53:24,576) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.034309, valid_loss 1.382821, train_metric nan, valid_metric 0.109880
[2648869:MainThread](2024-03-27 11:53:24,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.031879, valid_loss 1.383038, train_metric nan, valid_metric 0.109897
[2648869:MainThread](2024-03-27 11:53:24,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.037040, valid_loss 1.383387, train_metric nan, valid_metric 0.108277
[2648869:MainThread](2024-03-27 11:53:25,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.028704, valid_loss 1.382889, train_metric nan, valid_metric 0.110124
[2648869:MainThread](2024-03-27 11:53:25,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.022652, valid_loss 1.383712, train_metric nan, valid_metric 0.108701
[2648869:MainThread](2024-03-27 11:53:25,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.028781, valid_loss 1.383468, train_metric nan, valid_metric 0.107832
[2648869:MainThread](2024-03-27 11:53:25,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.031105, valid_loss 1.383051, train_metric nan, valid_metric 0.107829
[2648869:MainThread](2024-03-27 11:53:25,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.016997, valid_loss 1.382105, train_metric nan, valid_metric 0.108171
[2648869:MainThread](2024-03-27 11:53:25,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.382360 to 1.382105, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:26,215) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.017803, valid_loss 1.382772, train_metric nan, valid_metric 0.108200
[2648869:MainThread](2024-03-27 11:53:26,417) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.024399, valid_loss 1.382874, train_metric nan, valid_metric 0.108756
[2648869:MainThread](2024-03-27 11:53:26,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.032303, valid_loss 1.384148, train_metric nan, valid_metric 0.110435
[2648869:MainThread](2024-03-27 11:53:26,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.029917, valid_loss 1.382999, train_metric nan, valid_metric 0.108723
[2648869:MainThread](2024-03-27 11:53:27,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.044656, valid_loss 1.384260, train_metric nan, valid_metric 0.108107
[2648869:MainThread](2024-03-27 11:53:27,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.020394, valid_loss 1.383002, train_metric nan, valid_metric 0.108396
[2648869:MainThread](2024-03-27 11:53:27,427) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.012028, valid_loss 1.383075, train_metric nan, valid_metric 0.106959
[2648869:MainThread](2024-03-27 11:53:27,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.042158, valid_loss 1.384449, train_metric nan, valid_metric 0.105915
[2648869:MainThread](2024-03-27 11:53:27,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.026821, valid_loss 1.383723, train_metric nan, valid_metric 0.106595
[2648869:MainThread](2024-03-27 11:53:28,039) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.022482, valid_loss 1.383437, train_metric nan, valid_metric 0.105412
[2648869:MainThread](2024-03-27 11:53:28,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.024511, valid_loss 1.382254, train_metric nan, valid_metric 0.108689
[2648869:MainThread](2024-03-27 11:53:28,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.035429, valid_loss 1.384529, train_metric nan, valid_metric 0.106501
[2648869:MainThread](2024-03-27 11:53:28,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.030686, valid_loss 1.383615, train_metric nan, valid_metric 0.104305
[2648869:MainThread](2024-03-27 11:53:28,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.029500, valid_loss 1.383760, train_metric nan, valid_metric 0.105566
[2648869:MainThread](2024-03-27 11:53:29,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.030122, valid_loss 1.383341, train_metric nan, valid_metric 0.107102
[2648869:MainThread](2024-03-27 11:53:29,263) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.017503, valid_loss 1.384459, train_metric nan, valid_metric 0.107192
[2648869:MainThread](2024-03-27 11:53:29,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.022058, valid_loss 1.383433, train_metric nan, valid_metric 0.106963
[2648869:MainThread](2024-03-27 11:53:29,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.035816, valid_loss 1.383563, train_metric nan, valid_metric 0.105942
[2648869:MainThread](2024-03-27 11:53:29,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 1.026522, valid_loss 1.384269, train_metric nan, valid_metric 0.106307
[2648869:MainThread](2024-03-27 11:53:30,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 1.020630, valid_loss 1.382613, train_metric nan, valid_metric 0.106328
[2648869:MainThread](2024-03-27 11:53:30,277) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 1.032329, valid_loss 1.382880, train_metric nan, valid_metric 0.102663
[2648869:MainThread](2024-03-27 11:53:30,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 1.028568, valid_loss 1.383263, train_metric nan, valid_metric 0.106060
[2648869:MainThread](2024-03-27 11:53:30,684) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 1.025530, valid_loss 1.383679, train_metric nan, valid_metric 0.106835
[2648869:MainThread](2024-03-27 11:53:30,885) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 1.027293, valid_loss 1.383924, train_metric nan, valid_metric 0.107381
[2648869:MainThread](2024-03-27 11:53:31,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 1.039702, valid_loss 1.383572, train_metric nan, valid_metric 0.106038
[2648869:MainThread](2024-03-27 11:53:31,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 1.024336, valid_loss 1.383820, train_metric nan, valid_metric 0.107333
[2648869:MainThread](2024-03-27 11:53:31,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 1.027905, valid_loss 1.382013, train_metric nan, valid_metric 0.105798
[2648869:MainThread](2024-03-27 11:53:31,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.382105 to 1.382013, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:31,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 1.013947, valid_loss 1.384442, train_metric nan, valid_metric 0.105419
[2648869:MainThread](2024-03-27 11:53:31,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 1.035205, valid_loss 1.383135, train_metric nan, valid_metric 0.107642
[2648869:MainThread](2024-03-27 11:53:32,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 1.019852, valid_loss 1.383780, train_metric nan, valid_metric 0.107219
[2648869:MainThread](2024-03-27 11:53:32,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 1.027307, valid_loss 1.384022, train_metric nan, valid_metric 0.105636
[2648869:MainThread](2024-03-27 11:53:32,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 1.012704, valid_loss 1.384375, train_metric nan, valid_metric 0.105235
[2648869:MainThread](2024-03-27 11:53:32,732) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 1.021447, valid_loss 1.383194, train_metric nan, valid_metric 0.107451
[2648869:MainThread](2024-03-27 11:53:32,936) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 1.022468, valid_loss 1.383508, train_metric nan, valid_metric 0.105746
[2648869:MainThread](2024-03-27 11:53:33,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 1.024659, valid_loss 1.382916, train_metric nan, valid_metric 0.106733
[2648869:MainThread](2024-03-27 11:53:33,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 1.018278, valid_loss 1.383907, train_metric nan, valid_metric 0.107009
[2648869:MainThread](2024-03-27 11:53:33,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 1.029523, valid_loss 1.385107, train_metric nan, valid_metric 0.104198
[2648869:MainThread](2024-03-27 11:53:33,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 1.041005, valid_loss 1.384618, train_metric nan, valid_metric 0.106318
[2648869:MainThread](2024-03-27 11:53:33,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 1.025380, valid_loss 1.383443, train_metric nan, valid_metric 0.108149
[2648869:MainThread](2024-03-27 11:53:34,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2760]: train_loss 1.032965, valid_loss 1.383644, train_metric nan, valid_metric 0.107484
[2648869:MainThread](2024-03-27 11:53:34,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2780]: train_loss 1.032275, valid_loss 1.383544, train_metric nan, valid_metric 0.107034
[2648869:MainThread](2024-03-27 11:53:34,651) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2800]: train_loss 1.031731, valid_loss 1.384355, train_metric nan, valid_metric 0.106336
[2648869:MainThread](2024-03-27 11:53:34,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2820]: train_loss 1.023202, valid_loss 1.383464, train_metric nan, valid_metric 0.107558
[2648869:MainThread](2024-03-27 11:53:35,148) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2840]: train_loss 1.037796, valid_loss 1.384849, train_metric nan, valid_metric 0.106879
[2648869:MainThread](2024-03-27 11:53:35,400) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2860]: train_loss 1.034587, valid_loss 1.382881, train_metric nan, valid_metric 0.107072
[2648869:MainThread](2024-03-27 11:53:35,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2880]: train_loss 1.033875, valid_loss 1.384351, train_metric nan, valid_metric 0.107827
[2648869:MainThread](2024-03-27 11:53:35,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2900]: train_loss 1.024005, valid_loss 1.383606, train_metric nan, valid_metric 0.107000
[2648869:MainThread](2024-03-27 11:53:36,105) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2920]: train_loss 1.027263, valid_loss 1.383372, train_metric nan, valid_metric 0.107105
[2648869:MainThread](2024-03-27 11:53:36,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2940]: train_loss 1.038054, valid_loss 1.383397, train_metric nan, valid_metric 0.107047
[2648869:MainThread](2024-03-27 11:53:36,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2960]: train_loss 1.023394, valid_loss 1.382716, train_metric nan, valid_metric 0.107950
[2648869:MainThread](2024-03-27 11:53:36,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2980]: train_loss 1.013628, valid_loss 1.382924, train_metric nan, valid_metric 0.107729
[2648869:MainThread](2024-03-27 11:53:37,059) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3000]: train_loss 1.047917, valid_loss 1.384257, train_metric nan, valid_metric 0.106084
[2648869:MainThread](2024-03-27 11:53:37,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3020]: train_loss 1.028463, valid_loss 1.383711, train_metric nan, valid_metric 0.107915
[2648869:MainThread](2024-03-27 11:53:37,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3040]: train_loss 1.029677, valid_loss 1.383720, train_metric nan, valid_metric 0.107352
[2648869:MainThread](2024-03-27 11:53:37,672) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3060]: train_loss 1.025727, valid_loss 1.381963, train_metric nan, valid_metric 0.108581
[2648869:MainThread](2024-03-27 11:53:37,672) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.382013 to 1.381963, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:37,878) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3080]: train_loss 1.027326, valid_loss 1.383486, train_metric nan, valid_metric 0.106917
[2648869:MainThread](2024-03-27 11:53:38,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3100]: train_loss 1.037228, valid_loss 1.383202, train_metric nan, valid_metric 0.106160
[2648869:MainThread](2024-03-27 11:53:38,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3120]: train_loss 1.023989, valid_loss 1.383180, train_metric nan, valid_metric 0.106967
[2648869:MainThread](2024-03-27 11:53:38,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3140]: train_loss 1.039133, valid_loss 1.383712, train_metric nan, valid_metric 0.105900
[2648869:MainThread](2024-03-27 11:53:38,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3160]: train_loss 1.023277, valid_loss 1.384255, train_metric nan, valid_metric 0.106711
[2648869:MainThread](2024-03-27 11:53:38,878) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3180]: train_loss 1.017356, valid_loss 1.383258, train_metric nan, valid_metric 0.107230
[2648869:MainThread](2024-03-27 11:53:39,077) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3200]: train_loss 1.023684, valid_loss 1.383650, train_metric nan, valid_metric 0.107977
[2648869:MainThread](2024-03-27 11:53:39,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3220]: train_loss 1.025303, valid_loss 1.383679, train_metric nan, valid_metric 0.107140
[2648869:MainThread](2024-03-27 11:53:39,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3240]: train_loss 1.029922, valid_loss 1.384218, train_metric nan, valid_metric 0.104997
[2648869:MainThread](2024-03-27 11:53:39,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3260]: train_loss 1.023777, valid_loss 1.383130, train_metric nan, valid_metric 0.105420
[2648869:MainThread](2024-03-27 11:53:39,881) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3280]: train_loss 1.030895, valid_loss 1.384850, train_metric nan, valid_metric 0.106368
[2648869:MainThread](2024-03-27 11:53:40,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3300]: train_loss 1.028616, valid_loss 1.383023, train_metric nan, valid_metric 0.105558
[2648869:MainThread](2024-03-27 11:53:40,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3320]: train_loss 1.035483, valid_loss 1.383587, train_metric nan, valid_metric 0.107862
[2648869:MainThread](2024-03-27 11:53:40,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3340]: train_loss 1.026654, valid_loss 1.384023, train_metric nan, valid_metric 0.106116
[2648869:MainThread](2024-03-27 11:53:40,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3360]: train_loss 1.017993, valid_loss 1.383975, train_metric nan, valid_metric 0.107976
[2648869:MainThread](2024-03-27 11:53:40,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3380]: train_loss 1.034287, valid_loss 1.383254, train_metric nan, valid_metric 0.106330
[2648869:MainThread](2024-03-27 11:53:41,079) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3400]: train_loss 1.025699, valid_loss 1.383627, train_metric nan, valid_metric 0.103970
[2648869:MainThread](2024-03-27 11:53:41,277) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3420]: train_loss 1.025783, valid_loss 1.383368, train_metric nan, valid_metric 0.103779
[2648869:MainThread](2024-03-27 11:53:41,477) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3440]: train_loss 1.015784, valid_loss 1.384180, train_metric nan, valid_metric 0.106833
[2648869:MainThread](2024-03-27 11:53:41,676) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3460]: train_loss 1.024695, valid_loss 1.383924, train_metric nan, valid_metric 0.107710
[2648869:MainThread](2024-03-27 11:53:41,876) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3480]: train_loss 1.031069, valid_loss 1.382249, train_metric nan, valid_metric 0.106716
[2648869:MainThread](2024-03-27 11:53:42,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3500]: train_loss 1.012841, valid_loss 1.383134, train_metric nan, valid_metric 0.109125
[2648869:MainThread](2024-03-27 11:53:42,275) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3520]: train_loss 1.014473, valid_loss 1.382704, train_metric nan, valid_metric 0.109264
[2648869:MainThread](2024-03-27 11:53:42,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3540]: train_loss 1.015291, valid_loss 1.382578, train_metric nan, valid_metric 0.106627
[2648869:MainThread](2024-03-27 11:53:42,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3560]: train_loss 1.024869, valid_loss 1.383397, train_metric nan, valid_metric 0.103764
[2648869:MainThread](2024-03-27 11:53:42,877) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3580]: train_loss 1.019542, valid_loss 1.383652, train_metric nan, valid_metric 0.105791
[2648869:MainThread](2024-03-27 11:53:43,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3600]: train_loss 1.026427, valid_loss 1.384771, train_metric nan, valid_metric 0.105626
[2648869:MainThread](2024-03-27 11:53:43,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3620]: train_loss 1.033225, valid_loss 1.383763, train_metric nan, valid_metric 0.108528
[2648869:MainThread](2024-03-27 11:53:43,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3640]: train_loss 1.024090, valid_loss 1.383245, train_metric nan, valid_metric 0.107407
[2648869:MainThread](2024-03-27 11:53:43,676) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3660]: train_loss 1.030500, valid_loss 1.384121, train_metric nan, valid_metric 0.108439
[2648869:MainThread](2024-03-27 11:53:43,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3680]: train_loss 1.023638, valid_loss 1.383002, train_metric nan, valid_metric 0.109064
[2648869:MainThread](2024-03-27 11:53:44,075) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3700]: train_loss 1.025389, valid_loss 1.382587, train_metric nan, valid_metric 0.107253
[2648869:MainThread](2024-03-27 11:53:44,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3720]: train_loss 1.033093, valid_loss 1.382529, train_metric nan, valid_metric 0.107014
[2648869:MainThread](2024-03-27 11:53:44,483) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3740]: train_loss 1.020695, valid_loss 1.382962, train_metric nan, valid_metric 0.107612
[2648869:MainThread](2024-03-27 11:53:44,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3760]: train_loss 1.030779, valid_loss 1.383309, train_metric nan, valid_metric 0.107029
[2648869:MainThread](2024-03-27 11:53:44,887) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3780]: train_loss 1.030432, valid_loss 1.383266, train_metric nan, valid_metric 0.107969
[2648869:MainThread](2024-03-27 11:53:45,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3800]: train_loss 1.032861, valid_loss 1.383448, train_metric nan, valid_metric 0.105458
[2648869:MainThread](2024-03-27 11:53:45,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3820]: train_loss 1.027144, valid_loss 1.383156, train_metric nan, valid_metric 0.108069
[2648869:MainThread](2024-03-27 11:53:45,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3840]: train_loss 1.024787, valid_loss 1.384635, train_metric nan, valid_metric 0.105620
[2648869:MainThread](2024-03-27 11:53:45,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3860]: train_loss 1.033909, valid_loss 1.384284, train_metric nan, valid_metric 0.105291
[2648869:MainThread](2024-03-27 11:53:45,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3880]: train_loss 1.029249, valid_loss 1.383717, train_metric nan, valid_metric 0.104566
[2648869:MainThread](2024-03-27 11:53:46,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3900]: train_loss 1.021759, valid_loss 1.382519, train_metric nan, valid_metric 0.106972
[2648869:MainThread](2024-03-27 11:53:46,304) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3920]: train_loss 1.034106, valid_loss 1.383268, train_metric nan, valid_metric 0.107751
[2648869:MainThread](2024-03-27 11:53:46,510) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3940]: train_loss 1.035992, valid_loss 1.382924, train_metric nan, valid_metric 0.106596
[2648869:MainThread](2024-03-27 11:53:46,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3960]: train_loss 1.027093, valid_loss 1.383435, train_metric nan, valid_metric 0.106544
[2648869:MainThread](2024-03-27 11:53:46,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3980]: train_loss 1.019439, valid_loss 1.383278, train_metric nan, valid_metric 0.105473
[2648869:MainThread](2024-03-27 11:53:47,120) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4000]: train_loss 1.025412, valid_loss 1.383662, train_metric nan, valid_metric 0.104534
[2648869:MainThread](2024-03-27 11:53:47,328) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4020]: train_loss 1.023141, valid_loss 1.383286, train_metric nan, valid_metric 0.106686
[2648869:MainThread](2024-03-27 11:53:47,528) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4040]: train_loss 1.036434, valid_loss 1.382976, train_metric nan, valid_metric 0.106327
[2648869:MainThread](2024-03-27 11:53:47,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4060]: train_loss 1.030477, valid_loss 1.383259, train_metric nan, valid_metric 0.107111
[2648869:MainThread](2024-03-27 11:53:47,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 11:53:48,383) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 11:53:49,060) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   5%|▍         | 2/44 [01:11<26:14, 37.49s/it][2648869:MainThread](2024-03-27 11:53:49,067) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 11:53:49,078) INFO - qlib.workflow - [recorder.py:341] - Recorder c4082269e86b4a37be8163e2aa3a8160 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 11:53:49,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 11:53:49,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 11:53:49,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 11:53:49,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 11:53:51,398) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.317379
            SH600004      1.317379
            SH600006      1.317379
            SH600007      1.317379
            SH600008      1.317379
                            ...   
2015-03-06  SZ300058      0.603885
            SZ300070      0.603885
            SZ300124      0.603885
            SZ300133      0.603885
            SZ300146      0.603885
Length: 444037, dtype: float64
[2648869:MainThread](2024-03-27 11:53:52,300) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2015-03-09  SH600000      0.603885
            SH600008      0.603885
            SH600009      0.603885
            SH600010      0.603885
            SH600011      0.603885
                            ...   
2017-02-06  SZ300133      0.624648
            SZ300144      0.624648
            SZ300146      0.624648
            SZ300182      0.624648
            SZ300251      0.624648
Length: 108062, dtype: float64
[2648869:MainThread](2024-03-27 11:53:52,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 11:53:52,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.904508, valid_loss 1.215448, train_metric nan, valid_metric 0.041701
[2648869:MainThread](2024-03-27 11:53:52,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.215448, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 11:53:53,073) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.236042, valid_loss 1.197278, train_metric nan, valid_metric 0.037614
[2648869:MainThread](2024-03-27 11:53:53,073) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.215448 to 1.197278, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:53,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.198218, valid_loss 1.171731, train_metric nan, valid_metric 0.077636
[2648869:MainThread](2024-03-27 11:53:53,275) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.197278 to 1.171731, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:53,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.169849, valid_loss 1.180506, train_metric nan, valid_metric 0.083654
[2648869:MainThread](2024-03-27 11:53:53,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.171245, valid_loss 1.169123, train_metric nan, valid_metric 0.064516
[2648869:MainThread](2024-03-27 11:53:53,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.171731 to 1.169123, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:53,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.206064, valid_loss 1.167671, train_metric nan, valid_metric 0.097268
[2648869:MainThread](2024-03-27 11:53:53,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.169123 to 1.167671, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:54,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.102744, valid_loss 1.164382, train_metric nan, valid_metric 0.103103
[2648869:MainThread](2024-03-27 11:53:54,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.167671 to 1.164382, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:54,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.100291, valid_loss 1.165935, train_metric nan, valid_metric 0.087369
[2648869:MainThread](2024-03-27 11:53:54,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.075241, valid_loss 1.166411, train_metric nan, valid_metric 0.084896
[2648869:MainThread](2024-03-27 11:53:54,718) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.061859, valid_loss 1.163247, train_metric nan, valid_metric 0.096186
[2648869:MainThread](2024-03-27 11:53:54,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.164382 to 1.163247, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:54,973) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.044107, valid_loss 1.163656, train_metric nan, valid_metric 0.101757
[2648869:MainThread](2024-03-27 11:53:55,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.053510, valid_loss 1.165830, train_metric nan, valid_metric 0.084399
[2648869:MainThread](2024-03-27 11:53:55,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.047945, valid_loss 1.163061, train_metric nan, valid_metric 0.097074
[2648869:MainThread](2024-03-27 11:53:55,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.163247 to 1.163061, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:55,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.044589, valid_loss 1.162356, train_metric nan, valid_metric 0.106307
[2648869:MainThread](2024-03-27 11:53:55,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.163061 to 1.162356, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:55,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.071070, valid_loss 1.162689, train_metric nan, valid_metric 0.107624
[2648869:MainThread](2024-03-27 11:53:56,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.057417, valid_loss 1.165170, train_metric nan, valid_metric 0.094558
[2648869:MainThread](2024-03-27 11:53:56,205) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.076185, valid_loss 1.164359, train_metric nan, valid_metric 0.092152
[2648869:MainThread](2024-03-27 11:53:56,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.080507, valid_loss 1.161772, train_metric nan, valid_metric 0.100362
[2648869:MainThread](2024-03-27 11:53:56,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.162356 to 1.161772, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:56,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.070268, valid_loss 1.163176, train_metric nan, valid_metric 0.096355
[2648869:MainThread](2024-03-27 11:53:56,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.037227, valid_loss 1.159198, train_metric nan, valid_metric 0.115472
[2648869:MainThread](2024-03-27 11:53:56,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.161772 to 1.159198, save checkpoint.
[2648869:MainThread](2024-03-27 11:53:57,028) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.029131, valid_loss 1.161454, train_metric nan, valid_metric 0.107589
[2648869:MainThread](2024-03-27 11:53:57,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.030868, valid_loss 1.162854, train_metric nan, valid_metric 0.110616
[2648869:MainThread](2024-03-27 11:53:57,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.058515, valid_loss 1.162737, train_metric nan, valid_metric 0.102523
[2648869:MainThread](2024-03-27 11:53:57,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.033737, valid_loss 1.162297, train_metric nan, valid_metric 0.104630
[2648869:MainThread](2024-03-27 11:53:57,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.037214, valid_loss 1.161394, train_metric nan, valid_metric 0.108441
[2648869:MainThread](2024-03-27 11:53:58,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.008830, valid_loss 1.162169, train_metric nan, valid_metric 0.102434
[2648869:MainThread](2024-03-27 11:53:58,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.035436, valid_loss 1.163252, train_metric nan, valid_metric 0.107714
[2648869:MainThread](2024-03-27 11:53:58,530) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.027731, valid_loss 1.160364, train_metric nan, valid_metric 0.109688
[2648869:MainThread](2024-03-27 11:53:58,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.013457, valid_loss 1.164497, train_metric nan, valid_metric 0.095002
[2648869:MainThread](2024-03-27 11:53:58,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.024739, valid_loss 1.163657, train_metric nan, valid_metric 0.100664
[2648869:MainThread](2024-03-27 11:53:59,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.027837, valid_loss 1.161577, train_metric nan, valid_metric 0.103407
[2648869:MainThread](2024-03-27 11:53:59,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.002670, valid_loss 1.162988, train_metric nan, valid_metric 0.107089
[2648869:MainThread](2024-03-27 11:53:59,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.023517, valid_loss 1.161015, train_metric nan, valid_metric 0.106755
[2648869:MainThread](2024-03-27 11:53:59,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.005397, valid_loss 1.160977, train_metric nan, valid_metric 0.103469
[2648869:MainThread](2024-03-27 11:54:00,080) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.033239, valid_loss 1.161108, train_metric nan, valid_metric 0.106591
[2648869:MainThread](2024-03-27 11:54:00,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.019717, valid_loss 1.159452, train_metric nan, valid_metric 0.107545
[2648869:MainThread](2024-03-27 11:54:00,533) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.014526, valid_loss 1.161896, train_metric nan, valid_metric 0.104055
[2648869:MainThread](2024-03-27 11:54:00,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.010655, valid_loss 1.161635, train_metric nan, valid_metric 0.102695
[2648869:MainThread](2024-03-27 11:54:01,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.023031, valid_loss 1.163306, train_metric nan, valid_metric 0.098726
[2648869:MainThread](2024-03-27 11:54:01,305) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.029019, valid_loss 1.163218, train_metric nan, valid_metric 0.100304
[2648869:MainThread](2024-03-27 11:54:01,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.025521, valid_loss 1.162148, train_metric nan, valid_metric 0.098780
[2648869:MainThread](2024-03-27 11:54:01,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.014727, valid_loss 1.161824, train_metric nan, valid_metric 0.100794
[2648869:MainThread](2024-03-27 11:54:01,984) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.011850, valid_loss 1.161648, train_metric nan, valid_metric 0.107404
[2648869:MainThread](2024-03-27 11:54:02,229) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.998743, valid_loss 1.162559, train_metric nan, valid_metric 0.102698
[2648869:MainThread](2024-03-27 11:54:02,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.014270, valid_loss 1.161371, train_metric nan, valid_metric 0.109804
[2648869:MainThread](2024-03-27 11:54:02,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.010098, valid_loss 1.159362, train_metric nan, valid_metric 0.113104
[2648869:MainThread](2024-03-27 11:54:02,985) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.998731, valid_loss 1.160886, train_metric nan, valid_metric 0.106812
[2648869:MainThread](2024-03-27 11:54:03,243) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.011835, valid_loss 1.161042, train_metric nan, valid_metric 0.105152
[2648869:MainThread](2024-03-27 11:54:03,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.022159, valid_loss 1.160898, train_metric nan, valid_metric 0.109370
[2648869:MainThread](2024-03-27 11:54:03,741) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.004758, valid_loss 1.161124, train_metric nan, valid_metric 0.102016
[2648869:MainThread](2024-03-27 11:54:03,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.007135, valid_loss 1.160966, train_metric nan, valid_metric 0.102303
[2648869:MainThread](2024-03-27 11:54:04,235) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.021368, valid_loss 1.161595, train_metric nan, valid_metric 0.107911
[2648869:MainThread](2024-03-27 11:54:04,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.003465, valid_loss 1.162228, train_metric nan, valid_metric 0.101554
[2648869:MainThread](2024-03-27 11:54:04,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.022899, valid_loss 1.161324, train_metric nan, valid_metric 0.108348
[2648869:MainThread](2024-03-27 11:54:04,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.999531, valid_loss 1.163312, train_metric nan, valid_metric 0.103833
[2648869:MainThread](2024-03-27 11:54:05,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.026299, valid_loss 1.161845, train_metric nan, valid_metric 0.105326
[2648869:MainThread](2024-03-27 11:54:05,394) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.005732, valid_loss 1.160629, train_metric nan, valid_metric 0.106226
[2648869:MainThread](2024-03-27 11:54:05,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.003909, valid_loss 1.162925, train_metric nan, valid_metric 0.107189
[2648869:MainThread](2024-03-27 11:54:05,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.006660, valid_loss 1.162475, train_metric nan, valid_metric 0.110374
[2648869:MainThread](2024-03-27 11:54:06,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.008831, valid_loss 1.159808, train_metric nan, valid_metric 0.108948
[2648869:MainThread](2024-03-27 11:54:06,352) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.009664, valid_loss 1.160996, train_metric nan, valid_metric 0.106908
[2648869:MainThread](2024-03-27 11:54:06,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.996389, valid_loss 1.161948, train_metric nan, valid_metric 0.108140
[2648869:MainThread](2024-03-27 11:54:06,756) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.995985, valid_loss 1.162393, train_metric nan, valid_metric 0.107001
[2648869:MainThread](2024-03-27 11:54:06,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.997970, valid_loss 1.162393, train_metric nan, valid_metric 0.106139
[2648869:MainThread](2024-03-27 11:54:07,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.020477, valid_loss 1.161175, train_metric nan, valid_metric 0.107818
[2648869:MainThread](2024-03-27 11:54:07,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.016019, valid_loss 1.162663, train_metric nan, valid_metric 0.105203
[2648869:MainThread](2024-03-27 11:54:07,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.009515, valid_loss 1.161668, train_metric nan, valid_metric 0.110825
[2648869:MainThread](2024-03-27 11:54:07,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.998444, valid_loss 1.159462, train_metric nan, valid_metric 0.109906
[2648869:MainThread](2024-03-27 11:54:08,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.010402, valid_loss 1.162526, train_metric nan, valid_metric 0.108578
[2648869:MainThread](2024-03-27 11:54:08,289) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.000662, valid_loss 1.161075, train_metric nan, valid_metric 0.107302
[2648869:MainThread](2024-03-27 11:54:08,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 11:54:08,957) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 11:54:09,652) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   7%|▋         | 3/44 [01:31<20:20, 29.77s/it][2648869:MainThread](2024-03-27 11:54:09,659) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 11:54:09,670) INFO - qlib.workflow - [recorder.py:341] - Recorder 74e15740e0304b50a47075800f810d58 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 11:54:10,296) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 11:54:10,297) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 11:54:10,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 11:54:10,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 11:54:12,000) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.200816
            SH600004      1.200816
            SH600006      1.200816
            SH600007      1.200816
            SH600008      1.200816
                            ...   
2015-04-03  SZ300070      1.231984
            SZ300124      1.231984
            SZ300133      1.231984
            SZ300146      1.231984
            SZ300251      1.231984
Length: 448934, dtype: float64
[2648869:MainThread](2024-03-27 11:54:12,897) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2015-04-07  SH600000      1.231984
            SH600008      1.231984
            SH600009      1.231984
            SH600010      1.231984
            SH600011      1.231984
                            ...   
2017-03-06  SZ300144      0.775520
            SZ300146      0.775520
            SZ300168      0.775520
            SZ300182      0.775520
            SZ300251      0.775520
Length: 108475, dtype: float64
[2648869:MainThread](2024-03-27 11:54:12,983) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 11:54:13,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.486253, valid_loss 1.136080, train_metric nan, valid_metric 0.011101
[2648869:MainThread](2024-03-27 11:54:13,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.136080, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 11:54:13,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.421148, valid_loss 1.114478, train_metric nan, valid_metric 0.042780
[2648869:MainThread](2024-03-27 11:54:13,735) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.136080 to 1.114478, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:13,968) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.232127, valid_loss 1.118912, train_metric nan, valid_metric 0.054825
[2648869:MainThread](2024-03-27 11:54:14,203) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.131861, valid_loss 1.117216, train_metric nan, valid_metric 0.076042
[2648869:MainThread](2024-03-27 11:54:14,393) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.238196, valid_loss 1.115993, train_metric nan, valid_metric 0.071943
[2648869:MainThread](2024-03-27 11:54:14,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.251233, valid_loss 1.116295, train_metric nan, valid_metric 0.058642
[2648869:MainThread](2024-03-27 11:54:14,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.124647, valid_loss 1.124421, train_metric nan, valid_metric 0.069318
[2648869:MainThread](2024-03-27 11:54:14,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.150867, valid_loss 1.111333, train_metric nan, valid_metric 0.084736
[2648869:MainThread](2024-03-27 11:54:14,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.114478 to 1.111333, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:15,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.209681, valid_loss 1.116242, train_metric nan, valid_metric 0.087946
[2648869:MainThread](2024-03-27 11:54:15,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.188019, valid_loss 1.108541, train_metric nan, valid_metric 0.102674
[2648869:MainThread](2024-03-27 11:54:15,366) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.111333 to 1.108541, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:15,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.133053, valid_loss 1.107998, train_metric nan, valid_metric 0.096155
[2648869:MainThread](2024-03-27 11:54:15,611) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.108541 to 1.107998, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:15,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.133520, valid_loss 1.109844, train_metric nan, valid_metric 0.085325
[2648869:MainThread](2024-03-27 11:54:16,067) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.169292, valid_loss 1.110524, train_metric nan, valid_metric 0.089388
[2648869:MainThread](2024-03-27 11:54:16,268) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.120359, valid_loss 1.107616, train_metric nan, valid_metric 0.093447
[2648869:MainThread](2024-03-27 11:54:16,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.107998 to 1.107616, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:16,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.102812, valid_loss 1.108463, train_metric nan, valid_metric 0.097903
[2648869:MainThread](2024-03-27 11:54:16,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.115312, valid_loss 1.111072, train_metric nan, valid_metric 0.067952
[2648869:MainThread](2024-03-27 11:54:16,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.169558, valid_loss 1.106747, train_metric nan, valid_metric 0.107080
[2648869:MainThread](2024-03-27 11:54:16,880) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.107616 to 1.106747, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:17,082) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.107487, valid_loss 1.107664, train_metric nan, valid_metric 0.089963
[2648869:MainThread](2024-03-27 11:54:17,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.186739, valid_loss 1.115822, train_metric nan, valid_metric 0.036673
[2648869:MainThread](2024-03-27 11:54:17,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.168430, valid_loss 1.107291, train_metric nan, valid_metric 0.102499
[2648869:MainThread](2024-03-27 11:54:17,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.095083, valid_loss 1.104572, train_metric nan, valid_metric 0.127504
[2648869:MainThread](2024-03-27 11:54:17,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.106747 to 1.104572, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:17,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.085553, valid_loss 1.107890, train_metric nan, valid_metric 0.103779
[2648869:MainThread](2024-03-27 11:54:18,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.101921, valid_loss 1.106106, train_metric nan, valid_metric 0.112584
[2648869:MainThread](2024-03-27 11:54:18,289) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.102339, valid_loss 1.105743, train_metric nan, valid_metric 0.114487
[2648869:MainThread](2024-03-27 11:54:18,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.085682, valid_loss 1.105367, train_metric nan, valid_metric 0.112039
[2648869:MainThread](2024-03-27 11:54:18,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.134976, valid_loss 1.106963, train_metric nan, valid_metric 0.104598
[2648869:MainThread](2024-03-27 11:54:18,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.092680, valid_loss 1.105361, train_metric nan, valid_metric 0.106585
[2648869:MainThread](2024-03-27 11:54:19,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.058081, valid_loss 1.105771, train_metric nan, valid_metric 0.105113
[2648869:MainThread](2024-03-27 11:54:19,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.071442, valid_loss 1.108867, train_metric nan, valid_metric 0.103038
[2648869:MainThread](2024-03-27 11:54:19,594) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.065429, valid_loss 1.105063, train_metric nan, valid_metric 0.114182
[2648869:MainThread](2024-03-27 11:54:19,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.064101, valid_loss 1.106532, train_metric nan, valid_metric 0.113599
[2648869:MainThread](2024-03-27 11:54:19,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.062471, valid_loss 1.108874, train_metric nan, valid_metric 0.111558
[2648869:MainThread](2024-03-27 11:54:20,196) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.048893, valid_loss 1.104832, train_metric nan, valid_metric 0.118859
[2648869:MainThread](2024-03-27 11:54:20,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.057902, valid_loss 1.105801, train_metric nan, valid_metric 0.113576
[2648869:MainThread](2024-03-27 11:54:20,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.068913, valid_loss 1.105287, train_metric nan, valid_metric 0.111661
[2648869:MainThread](2024-03-27 11:54:20,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.061157, valid_loss 1.105304, train_metric nan, valid_metric 0.115390
[2648869:MainThread](2024-03-27 11:54:20,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.068816, valid_loss 1.105051, train_metric nan, valid_metric 0.115692
[2648869:MainThread](2024-03-27 11:54:21,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.064536, valid_loss 1.105693, train_metric nan, valid_metric 0.115169
[2648869:MainThread](2024-03-27 11:54:21,400) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.055283, valid_loss 1.105107, train_metric nan, valid_metric 0.115182
[2648869:MainThread](2024-03-27 11:54:21,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.053245, valid_loss 1.105572, train_metric nan, valid_metric 0.108310
[2648869:MainThread](2024-03-27 11:54:21,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.052323, valid_loss 1.104071, train_metric nan, valid_metric 0.120351
[2648869:MainThread](2024-03-27 11:54:21,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.104572 to 1.104071, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:22,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.060915, valid_loss 1.105993, train_metric nan, valid_metric 0.116620
[2648869:MainThread](2024-03-27 11:54:22,210) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.056972, valid_loss 1.104485, train_metric nan, valid_metric 0.114060
[2648869:MainThread](2024-03-27 11:54:22,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.054913, valid_loss 1.106302, train_metric nan, valid_metric 0.110667
[2648869:MainThread](2024-03-27 11:54:22,624) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.069958, valid_loss 1.106306, train_metric nan, valid_metric 0.109188
[2648869:MainThread](2024-03-27 11:54:22,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.048084, valid_loss 1.105839, train_metric nan, valid_metric 0.111676
[2648869:MainThread](2024-03-27 11:54:23,037) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.056333, valid_loss 1.105327, train_metric nan, valid_metric 0.113779
[2648869:MainThread](2024-03-27 11:54:23,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.046467, valid_loss 1.106147, train_metric nan, valid_metric 0.108750
[2648869:MainThread](2024-03-27 11:54:23,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.053610, valid_loss 1.105652, train_metric nan, valid_metric 0.109009
[2648869:MainThread](2024-03-27 11:54:23,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.050040, valid_loss 1.105604, train_metric nan, valid_metric 0.111424
[2648869:MainThread](2024-03-27 11:54:23,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.058517, valid_loss 1.104611, train_metric nan, valid_metric 0.115826
[2648869:MainThread](2024-03-27 11:54:24,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.061720, valid_loss 1.105259, train_metric nan, valid_metric 0.115463
[2648869:MainThread](2024-03-27 11:54:24,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.040189, valid_loss 1.105069, train_metric nan, valid_metric 0.115509
[2648869:MainThread](2024-03-27 11:54:24,494) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.052350, valid_loss 1.106091, train_metric nan, valid_metric 0.112606
[2648869:MainThread](2024-03-27 11:54:24,696) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.048430, valid_loss 1.105415, train_metric nan, valid_metric 0.115950
[2648869:MainThread](2024-03-27 11:54:24,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.050901, valid_loss 1.105073, train_metric nan, valid_metric 0.110703
[2648869:MainThread](2024-03-27 11:54:25,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.049847, valid_loss 1.105227, train_metric nan, valid_metric 0.110173
[2648869:MainThread](2024-03-27 11:54:25,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.038395, valid_loss 1.105690, train_metric nan, valid_metric 0.105443
[2648869:MainThread](2024-03-27 11:54:25,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.038816, valid_loss 1.106418, train_metric nan, valid_metric 0.102066
[2648869:MainThread](2024-03-27 11:54:25,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.042879, valid_loss 1.105829, train_metric nan, valid_metric 0.114132
[2648869:MainThread](2024-03-27 11:54:25,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.044278, valid_loss 1.106116, train_metric nan, valid_metric 0.112403
[2648869:MainThread](2024-03-27 11:54:26,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.060070, valid_loss 1.105251, train_metric nan, valid_metric 0.115770
[2648869:MainThread](2024-03-27 11:54:26,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.055866, valid_loss 1.105455, train_metric nan, valid_metric 0.113799
[2648869:MainThread](2024-03-27 11:54:26,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.050148, valid_loss 1.105582, train_metric nan, valid_metric 0.114797
[2648869:MainThread](2024-03-27 11:54:26,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.056515, valid_loss 1.104795, train_metric nan, valid_metric 0.119962
[2648869:MainThread](2024-03-27 11:54:26,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.056033, valid_loss 1.104652, train_metric nan, valid_metric 0.118060
[2648869:MainThread](2024-03-27 11:54:27,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.040576, valid_loss 1.104294, train_metric nan, valid_metric 0.117109
[2648869:MainThread](2024-03-27 11:54:27,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.052328, valid_loss 1.105265, train_metric nan, valid_metric 0.115994
[2648869:MainThread](2024-03-27 11:54:27,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.050139, valid_loss 1.105087, train_metric nan, valid_metric 0.118681
[2648869:MainThread](2024-03-27 11:54:27,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.041881, valid_loss 1.104997, train_metric nan, valid_metric 0.109691
[2648869:MainThread](2024-03-27 11:54:27,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.035451, valid_loss 1.104509, train_metric nan, valid_metric 0.112875
[2648869:MainThread](2024-03-27 11:54:28,127) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.039296, valid_loss 1.105063, train_metric nan, valid_metric 0.111547
[2648869:MainThread](2024-03-27 11:54:28,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.054316, valid_loss 1.106583, train_metric nan, valid_metric 0.108659
[2648869:MainThread](2024-03-27 11:54:28,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.027444, valid_loss 1.105463, train_metric nan, valid_metric 0.109613
[2648869:MainThread](2024-03-27 11:54:28,732) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.032445, valid_loss 1.104684, train_metric nan, valid_metric 0.110085
[2648869:MainThread](2024-03-27 11:54:28,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.058363, valid_loss 1.105708, train_metric nan, valid_metric 0.109084
[2648869:MainThread](2024-03-27 11:54:29,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.042523, valid_loss 1.105229, train_metric nan, valid_metric 0.114364
[2648869:MainThread](2024-03-27 11:54:29,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.043169, valid_loss 1.105099, train_metric nan, valid_metric 0.112716
[2648869:MainThread](2024-03-27 11:54:29,550) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.048118, valid_loss 1.105159, train_metric nan, valid_metric 0.116298
[2648869:MainThread](2024-03-27 11:54:29,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.051877, valid_loss 1.106138, train_metric nan, valid_metric 0.113591
[2648869:MainThread](2024-03-27 11:54:29,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.037870, valid_loss 1.105306, train_metric nan, valid_metric 0.118573
[2648869:MainThread](2024-03-27 11:54:30,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.047915, valid_loss 1.105998, train_metric nan, valid_metric 0.115837
[2648869:MainThread](2024-03-27 11:54:30,344) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.050132, valid_loss 1.105270, train_metric nan, valid_metric 0.113294
[2648869:MainThread](2024-03-27 11:54:30,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.034573, valid_loss 1.105324, train_metric nan, valid_metric 0.115154
[2648869:MainThread](2024-03-27 11:54:30,743) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.038802, valid_loss 1.105544, train_metric nan, valid_metric 0.115087
[2648869:MainThread](2024-03-27 11:54:30,942) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.041764, valid_loss 1.104415, train_metric nan, valid_metric 0.114270
[2648869:MainThread](2024-03-27 11:54:31,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.034457, valid_loss 1.105551, train_metric nan, valid_metric 0.110329
[2648869:MainThread](2024-03-27 11:54:31,346) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.029742, valid_loss 1.104980, train_metric nan, valid_metric 0.118017
[2648869:MainThread](2024-03-27 11:54:31,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.047326, valid_loss 1.104370, train_metric nan, valid_metric 0.117070
[2648869:MainThread](2024-03-27 11:54:31,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.036688, valid_loss 1.105093, train_metric nan, valid_metric 0.114641
[2648869:MainThread](2024-03-27 11:54:31,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.038486, valid_loss 1.105061, train_metric nan, valid_metric 0.114017
[2648869:MainThread](2024-03-27 11:54:31,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 11:54:32,619) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 11:54:33,308) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   9%|▉         | 4/44 [01:55<18:14, 27.36s/it][2648869:MainThread](2024-03-27 11:54:33,315) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 11:54:33,325) INFO - qlib.workflow - [recorder.py:341] - Recorder 9d5de9ff8c7749ffba5b8e9f614235d0 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 11:54:33,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 11:54:33,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 11:54:33,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 11:54:33,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 11:54:35,647) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.700067
            SH600004      0.700067
            SH600006      0.700067
            SH600007      0.700067
            SH600008      0.700067
                            ...   
2015-05-05  SZ300058      1.282643
            SZ300070      1.282643
            SZ300124      1.282643
            SZ300133      1.282643
            SZ300146      1.282643
Length: 453792, dtype: float64
[2648869:MainThread](2024-03-27 11:54:36,560) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2015-05-06  SH600000      1.282643
            SH600008      1.282643
            SH600009      1.282643
            SH600010      1.282643
            SH600011      1.282643
                            ...   
2017-04-05  SZ300133      1.010317
            SZ300144      1.010317
            SZ300146      1.010317
            SZ300182      1.010317
            SZ300251      1.010317
Length: 108865, dtype: float64
[2648869:MainThread](2024-03-27 11:54:36,646) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 11:54:37,153) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.653432, valid_loss 1.281106, train_metric nan, valid_metric 0.016830
[2648869:MainThread](2024-03-27 11:54:37,154) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.281106, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 11:54:37,352) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.283585, valid_loss 1.264098, train_metric nan, valid_metric 0.039708
[2648869:MainThread](2024-03-27 11:54:37,352) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.281106 to 1.264098, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:37,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.139024, valid_loss 1.249583, train_metric nan, valid_metric 0.071698
[2648869:MainThread](2024-03-27 11:54:37,545) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.264098 to 1.249583, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:37,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.150895, valid_loss 1.248847, train_metric nan, valid_metric 0.055055
[2648869:MainThread](2024-03-27 11:54:37,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.249583 to 1.248847, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:38,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.147697, valid_loss 1.244322, train_metric nan, valid_metric 0.073581
[2648869:MainThread](2024-03-27 11:54:38,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.248847 to 1.244322, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:38,211) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.115259, valid_loss 1.245761, train_metric nan, valid_metric 0.074481
[2648869:MainThread](2024-03-27 11:54:38,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.157366, valid_loss 1.242674, train_metric nan, valid_metric 0.082092
[2648869:MainThread](2024-03-27 11:54:38,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.244322 to 1.242674, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:38,702) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.173444, valid_loss 1.243740, train_metric nan, valid_metric 0.086596
[2648869:MainThread](2024-03-27 11:54:38,942) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.092635, valid_loss 1.242819, train_metric nan, valid_metric 0.084928
[2648869:MainThread](2024-03-27 11:54:39,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.096694, valid_loss 1.243346, train_metric nan, valid_metric 0.086501
[2648869:MainThread](2024-03-27 11:54:39,437) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.140581, valid_loss 1.243090, train_metric nan, valid_metric 0.092973
[2648869:MainThread](2024-03-27 11:54:39,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.105807, valid_loss 1.245561, train_metric nan, valid_metric 0.086289
[2648869:MainThread](2024-03-27 11:54:39,907) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.132669, valid_loss 1.246098, train_metric nan, valid_metric 0.095391
[2648869:MainThread](2024-03-27 11:54:40,120) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.129317, valid_loss 1.240383, train_metric nan, valid_metric 0.100148
[2648869:MainThread](2024-03-27 11:54:40,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.242674 to 1.240383, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:40,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.110892, valid_loss 1.242215, train_metric nan, valid_metric 0.101181
[2648869:MainThread](2024-03-27 11:54:40,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.092740, valid_loss 1.240861, train_metric nan, valid_metric 0.100066
[2648869:MainThread](2024-03-27 11:54:40,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.081375, valid_loss 1.240537, train_metric nan, valid_metric 0.108218
[2648869:MainThread](2024-03-27 11:54:40,926) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.108840, valid_loss 1.242385, train_metric nan, valid_metric 0.092326
[2648869:MainThread](2024-03-27 11:54:41,167) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.083494, valid_loss 1.242585, train_metric nan, valid_metric 0.102780
[2648869:MainThread](2024-03-27 11:54:41,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.100956, valid_loss 1.239019, train_metric nan, valid_metric 0.107587
[2648869:MainThread](2024-03-27 11:54:41,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.240383 to 1.239019, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:41,577) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.073442, valid_loss 1.240000, train_metric nan, valid_metric 0.112550
[2648869:MainThread](2024-03-27 11:54:41,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.068648, valid_loss 1.241605, train_metric nan, valid_metric 0.107207
[2648869:MainThread](2024-03-27 11:54:41,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.052168, valid_loss 1.240485, train_metric nan, valid_metric 0.104431
[2648869:MainThread](2024-03-27 11:54:42,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.057569, valid_loss 1.238298, train_metric nan, valid_metric 0.116546
[2648869:MainThread](2024-03-27 11:54:42,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.239019 to 1.238298, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:42,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.117769, valid_loss 1.239466, train_metric nan, valid_metric 0.110698
[2648869:MainThread](2024-03-27 11:54:42,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.092698, valid_loss 1.240076, train_metric nan, valid_metric 0.113691
[2648869:MainThread](2024-03-27 11:54:42,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.091502, valid_loss 1.240587, train_metric nan, valid_metric 0.101983
[2648869:MainThread](2024-03-27 11:54:42,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.090296, valid_loss 1.240534, train_metric nan, valid_metric 0.106588
[2648869:MainThread](2024-03-27 11:54:43,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.066251, valid_loss 1.238198, train_metric nan, valid_metric 0.115591
[2648869:MainThread](2024-03-27 11:54:43,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.238298 to 1.238198, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:43,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.050765, valid_loss 1.240006, train_metric nan, valid_metric 0.109719
[2648869:MainThread](2024-03-27 11:54:43,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.055320, valid_loss 1.238984, train_metric nan, valid_metric 0.116216
[2648869:MainThread](2024-03-27 11:54:43,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.079516, valid_loss 1.241691, train_metric nan, valid_metric 0.105729
[2648869:MainThread](2024-03-27 11:54:44,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.059472, valid_loss 1.241425, train_metric nan, valid_metric 0.108977
[2648869:MainThread](2024-03-27 11:54:44,203) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.046410, valid_loss 1.238853, train_metric nan, valid_metric 0.112869
[2648869:MainThread](2024-03-27 11:54:44,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.041375, valid_loss 1.238974, train_metric nan, valid_metric 0.115064
[2648869:MainThread](2024-03-27 11:54:44,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.085161, valid_loss 1.240275, train_metric nan, valid_metric 0.113260
[2648869:MainThread](2024-03-27 11:54:44,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.074438, valid_loss 1.240195, train_metric nan, valid_metric 0.111889
[2648869:MainThread](2024-03-27 11:54:45,015) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.051018, valid_loss 1.239680, train_metric nan, valid_metric 0.109756
[2648869:MainThread](2024-03-27 11:54:45,257) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.049747, valid_loss 1.239671, train_metric nan, valid_metric 0.108447
[2648869:MainThread](2024-03-27 11:54:45,502) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.075925, valid_loss 1.239346, train_metric nan, valid_metric 0.109976
[2648869:MainThread](2024-03-27 11:54:45,710) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.052279, valid_loss 1.239427, train_metric nan, valid_metric 0.109311
[2648869:MainThread](2024-03-27 11:54:45,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.059568, valid_loss 1.239423, train_metric nan, valid_metric 0.111713
[2648869:MainThread](2024-03-27 11:54:46,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.052977, valid_loss 1.239291, train_metric nan, valid_metric 0.110359
[2648869:MainThread](2024-03-27 11:54:46,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.075253, valid_loss 1.238213, train_metric nan, valid_metric 0.116331
[2648869:MainThread](2024-03-27 11:54:46,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.045186, valid_loss 1.239076, train_metric nan, valid_metric 0.113632
[2648869:MainThread](2024-03-27 11:54:46,741) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.040261, valid_loss 1.238242, train_metric nan, valid_metric 0.117772
[2648869:MainThread](2024-03-27 11:54:46,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.023409, valid_loss 1.238933, train_metric nan, valid_metric 0.112242
[2648869:MainThread](2024-03-27 11:54:47,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.049466, valid_loss 1.240087, train_metric nan, valid_metric 0.110329
[2648869:MainThread](2024-03-27 11:54:47,349) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.033538, valid_loss 1.239149, train_metric nan, valid_metric 0.112013
[2648869:MainThread](2024-03-27 11:54:47,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.036511, valid_loss 1.239895, train_metric nan, valid_metric 0.111330
[2648869:MainThread](2024-03-27 11:54:47,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.048258, valid_loss 1.238948, train_metric nan, valid_metric 0.113295
[2648869:MainThread](2024-03-27 11:54:47,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.056071, valid_loss 1.239325, train_metric nan, valid_metric 0.112815
[2648869:MainThread](2024-03-27 11:54:48,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.045631, valid_loss 1.240015, train_metric nan, valid_metric 0.110614
[2648869:MainThread](2024-03-27 11:54:48,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.037287, valid_loss 1.239838, train_metric nan, valid_metric 0.111306
[2648869:MainThread](2024-03-27 11:54:48,565) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.045414, valid_loss 1.239142, train_metric nan, valid_metric 0.115980
[2648869:MainThread](2024-03-27 11:54:48,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.052825, valid_loss 1.239388, train_metric nan, valid_metric 0.114208
[2648869:MainThread](2024-03-27 11:54:48,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.041582, valid_loss 1.239568, train_metric nan, valid_metric 0.114019
[2648869:MainThread](2024-03-27 11:54:49,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.034353, valid_loss 1.238618, train_metric nan, valid_metric 0.112344
[2648869:MainThread](2024-03-27 11:54:49,366) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.027267, valid_loss 1.239534, train_metric nan, valid_metric 0.110075
[2648869:MainThread](2024-03-27 11:54:49,568) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.040052, valid_loss 1.239913, train_metric nan, valid_metric 0.110540
[2648869:MainThread](2024-03-27 11:54:49,770) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.047708, valid_loss 1.239551, train_metric nan, valid_metric 0.109332
[2648869:MainThread](2024-03-27 11:54:49,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.043100, valid_loss 1.239228, train_metric nan, valid_metric 0.112867
[2648869:MainThread](2024-03-27 11:54:50,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.033377, valid_loss 1.239377, train_metric nan, valid_metric 0.113123
[2648869:MainThread](2024-03-27 11:54:50,375) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.033741, valid_loss 1.239330, train_metric nan, valid_metric 0.111225
[2648869:MainThread](2024-03-27 11:54:50,581) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.034737, valid_loss 1.238733, train_metric nan, valid_metric 0.114999
[2648869:MainThread](2024-03-27 11:54:50,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.052592, valid_loss 1.239369, train_metric nan, valid_metric 0.110332
[2648869:MainThread](2024-03-27 11:54:50,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.039804, valid_loss 1.239994, train_metric nan, valid_metric 0.108430
[2648869:MainThread](2024-03-27 11:54:51,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.038702, valid_loss 1.239546, train_metric nan, valid_metric 0.110976
[2648869:MainThread](2024-03-27 11:54:51,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.037774, valid_loss 1.239448, train_metric nan, valid_metric 0.110057
[2648869:MainThread](2024-03-27 11:54:51,586) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.026968, valid_loss 1.238995, train_metric nan, valid_metric 0.112351
[2648869:MainThread](2024-03-27 11:54:51,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.035970, valid_loss 1.238871, train_metric nan, valid_metric 0.111056
[2648869:MainThread](2024-03-27 11:54:51,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.042549, valid_loss 1.238981, train_metric nan, valid_metric 0.113693
[2648869:MainThread](2024-03-27 11:54:52,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.031347, valid_loss 1.239824, train_metric nan, valid_metric 0.109671
[2648869:MainThread](2024-03-27 11:54:52,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.050518, valid_loss 1.239225, train_metric nan, valid_metric 0.112321
[2648869:MainThread](2024-03-27 11:54:52,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.035598, valid_loss 1.238292, train_metric nan, valid_metric 0.113446
[2648869:MainThread](2024-03-27 11:54:52,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.039636, valid_loss 1.238272, train_metric nan, valid_metric 0.111715
[2648869:MainThread](2024-03-27 11:54:53,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.034178, valid_loss 1.240041, train_metric nan, valid_metric 0.108510
[2648869:MainThread](2024-03-27 11:54:53,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.050331, valid_loss 1.239037, train_metric nan, valid_metric 0.111809
[2648869:MainThread](2024-03-27 11:54:53,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.041199, valid_loss 1.239112, train_metric nan, valid_metric 0.111123
[2648869:MainThread](2024-03-27 11:54:53,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 11:54:54,080) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 11:54:54,776) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  11%|█▏        | 5/44 [02:16<16:24, 25.23s/it][2648869:MainThread](2024-03-27 11:54:54,783) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 11:54:54,794) INFO - qlib.workflow - [recorder.py:341] - Recorder 3c2821810452479b81d0e1c90442ca8f starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 11:54:55,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 11:54:55,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 11:54:55,410) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 11:54:55,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 11:54:57,117) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.790953
            SH600004      0.790953
            SH600006      0.790953
            SH600007      0.790953
            SH600008      0.790953
                            ...   
2015-06-02  SZ300024      1.411950
            SZ300058      1.411950
            SZ300070      1.411950
            SZ300124      1.411950
            SZ300146      1.411950
Length: 458234, dtype: float64
[2648869:MainThread](2024-03-27 11:54:58,032) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2015-06-03  SH600000      1.411950
            SH600008      1.411950
            SH600009      1.411950
            SH600010      1.411950
            SH600011      1.411950
                            ...   
2017-05-04  SZ300133      1.902027
            SZ300144      1.902027
            SZ300146      1.902027
            SZ300182      1.902027
            SZ300251      1.902027
Length: 109658, dtype: float64
[2648869:MainThread](2024-03-27 11:54:58,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 11:54:58,624) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.449670, valid_loss 1.412555, train_metric nan, valid_metric 0.007600
[2648869:MainThread](2024-03-27 11:54:58,624) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.412555, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 11:54:58,813) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.305682, valid_loss 1.391866, train_metric nan, valid_metric 0.078207
[2648869:MainThread](2024-03-27 11:54:58,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.412555 to 1.391866, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:59,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.180511, valid_loss 1.382185, train_metric nan, valid_metric 0.105052
[2648869:MainThread](2024-03-27 11:54:59,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.391866 to 1.382185, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:59,187) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.162421, valid_loss 1.385135, train_metric nan, valid_metric 0.100669
[2648869:MainThread](2024-03-27 11:54:59,371) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.156360, valid_loss 1.391930, train_metric nan, valid_metric 0.087642
[2648869:MainThread](2024-03-27 11:54:59,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.146859, valid_loss 1.388722, train_metric nan, valid_metric 0.101645
[2648869:MainThread](2024-03-27 11:54:59,737) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.131371, valid_loss 1.381382, train_metric nan, valid_metric 0.107777
[2648869:MainThread](2024-03-27 11:54:59,737) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.382185 to 1.381382, save checkpoint.
[2648869:MainThread](2024-03-27 11:54:59,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.168586, valid_loss 1.383990, train_metric nan, valid_metric 0.112587
[2648869:MainThread](2024-03-27 11:55:00,104) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.122711, valid_loss 1.378631, train_metric nan, valid_metric 0.116366
[2648869:MainThread](2024-03-27 11:55:00,104) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.381382 to 1.378631, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:00,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.095586, valid_loss 1.380409, train_metric nan, valid_metric 0.110186
[2648869:MainThread](2024-03-27 11:55:00,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.105784, valid_loss 1.380084, train_metric nan, valid_metric 0.122152
[2648869:MainThread](2024-03-27 11:55:00,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.122301, valid_loss 1.378992, train_metric nan, valid_metric 0.118145
[2648869:MainThread](2024-03-27 11:55:00,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.100633, valid_loss 1.379151, train_metric nan, valid_metric 0.117514
[2648869:MainThread](2024-03-27 11:55:01,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.133305, valid_loss 1.379444, train_metric nan, valid_metric 0.129547
[2648869:MainThread](2024-03-27 11:55:01,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.122073, valid_loss 1.382073, train_metric nan, valid_metric 0.109478
[2648869:MainThread](2024-03-27 11:55:01,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.116103, valid_loss 1.385851, train_metric nan, valid_metric 0.101376
[2648869:MainThread](2024-03-27 11:55:01,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.126335, valid_loss 1.384886, train_metric nan, valid_metric 0.117875
[2648869:MainThread](2024-03-27 11:55:01,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.126223, valid_loss 1.382417, train_metric nan, valid_metric 0.112763
[2648869:MainThread](2024-03-27 11:55:02,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.119870, valid_loss 1.377281, train_metric nan, valid_metric 0.127076
[2648869:MainThread](2024-03-27 11:55:02,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.378631 to 1.377281, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:02,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.078095, valid_loss 1.379819, train_metric nan, valid_metric 0.128734
[2648869:MainThread](2024-03-27 11:55:02,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.095684, valid_loss 1.376528, train_metric nan, valid_metric 0.130184
[2648869:MainThread](2024-03-27 11:55:02,444) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.377281 to 1.376528, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:02,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.084339, valid_loss 1.378023, train_metric nan, valid_metric 0.125700
[2648869:MainThread](2024-03-27 11:55:02,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.122950, valid_loss 1.381772, train_metric nan, valid_metric 0.113397
[2648869:MainThread](2024-03-27 11:55:03,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.089079, valid_loss 1.377791, train_metric nan, valid_metric 0.123232
[2648869:MainThread](2024-03-27 11:55:03,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.086301, valid_loss 1.378811, train_metric nan, valid_metric 0.126257
[2648869:MainThread](2024-03-27 11:55:03,452) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.081564, valid_loss 1.382075, train_metric nan, valid_metric 0.122260
[2648869:MainThread](2024-03-27 11:55:03,651) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.069099, valid_loss 1.378540, train_metric nan, valid_metric 0.125977
[2648869:MainThread](2024-03-27 11:55:03,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.049989, valid_loss 1.375371, train_metric nan, valid_metric 0.131000
[2648869:MainThread](2024-03-27 11:55:03,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.376528 to 1.375371, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:04,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.086753, valid_loss 1.378085, train_metric nan, valid_metric 0.123759
[2648869:MainThread](2024-03-27 11:55:04,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.071317, valid_loss 1.376324, train_metric nan, valid_metric 0.132182
[2648869:MainThread](2024-03-27 11:55:04,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.071323, valid_loss 1.379015, train_metric nan, valid_metric 0.132057
[2648869:MainThread](2024-03-27 11:55:04,663) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.061395, valid_loss 1.375144, train_metric nan, valid_metric 0.134570
[2648869:MainThread](2024-03-27 11:55:04,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.375371 to 1.375144, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:04,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.087033, valid_loss 1.375717, train_metric nan, valid_metric 0.133145
[2648869:MainThread](2024-03-27 11:55:05,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.083950, valid_loss 1.378521, train_metric nan, valid_metric 0.130663
[2648869:MainThread](2024-03-27 11:55:05,270) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.090709, valid_loss 1.375038, train_metric nan, valid_metric 0.136526
[2648869:MainThread](2024-03-27 11:55:05,270) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.375144 to 1.375038, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:05,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.071160, valid_loss 1.377685, train_metric nan, valid_metric 0.138895
[2648869:MainThread](2024-03-27 11:55:05,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.054093, valid_loss 1.376481, train_metric nan, valid_metric 0.136781
[2648869:MainThread](2024-03-27 11:55:05,869) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.058363, valid_loss 1.374242, train_metric nan, valid_metric 0.136951
[2648869:MainThread](2024-03-27 11:55:05,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.375038 to 1.374242, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:06,079) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.084443, valid_loss 1.377476, train_metric nan, valid_metric 0.130716
[2648869:MainThread](2024-03-27 11:55:06,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.065574, valid_loss 1.377696, train_metric nan, valid_metric 0.128552
[2648869:MainThread](2024-03-27 11:55:06,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.063059, valid_loss 1.381107, train_metric nan, valid_metric 0.128670
[2648869:MainThread](2024-03-27 11:55:06,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.047117, valid_loss 1.375604, train_metric nan, valid_metric 0.133807
[2648869:MainThread](2024-03-27 11:55:06,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.060722, valid_loss 1.373921, train_metric nan, valid_metric 0.131724
[2648869:MainThread](2024-03-27 11:55:06,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.374242 to 1.373921, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:07,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.051175, valid_loss 1.374179, train_metric nan, valid_metric 0.135508
[2648869:MainThread](2024-03-27 11:55:07,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.068002, valid_loss 1.377405, train_metric nan, valid_metric 0.130637
[2648869:MainThread](2024-03-27 11:55:07,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.071329, valid_loss 1.377599, train_metric nan, valid_metric 0.132730
[2648869:MainThread](2024-03-27 11:55:07,718) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.055099, valid_loss 1.376873, train_metric nan, valid_metric 0.135757
[2648869:MainThread](2024-03-27 11:55:07,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.050119, valid_loss 1.377575, train_metric nan, valid_metric 0.133451
[2648869:MainThread](2024-03-27 11:55:08,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.056562, valid_loss 1.376679, train_metric nan, valid_metric 0.128781
[2648869:MainThread](2024-03-27 11:55:08,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.065664, valid_loss 1.373318, train_metric nan, valid_metric 0.140997
[2648869:MainThread](2024-03-27 11:55:08,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.373921 to 1.373318, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:08,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.071096, valid_loss 1.375410, train_metric nan, valid_metric 0.136126
[2648869:MainThread](2024-03-27 11:55:08,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.054955, valid_loss 1.376709, train_metric nan, valid_metric 0.137262
[2648869:MainThread](2024-03-27 11:55:08,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.065455, valid_loss 1.377128, train_metric nan, valid_metric 0.136705
[2648869:MainThread](2024-03-27 11:55:09,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.049270, valid_loss 1.374229, train_metric nan, valid_metric 0.135700
[2648869:MainThread](2024-03-27 11:55:09,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.065118, valid_loss 1.375980, train_metric nan, valid_metric 0.135118
[2648869:MainThread](2024-03-27 11:55:09,635) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.047476, valid_loss 1.376641, train_metric nan, valid_metric 0.133089
[2648869:MainThread](2024-03-27 11:55:09,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.062210, valid_loss 1.376400, train_metric nan, valid_metric 0.134385
[2648869:MainThread](2024-03-27 11:55:10,099) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.056036, valid_loss 1.375192, train_metric nan, valid_metric 0.133389
[2648869:MainThread](2024-03-27 11:55:10,304) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.061140, valid_loss 1.376767, train_metric nan, valid_metric 0.128446
[2648869:MainThread](2024-03-27 11:55:10,507) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.044207, valid_loss 1.374585, train_metric nan, valid_metric 0.133408
[2648869:MainThread](2024-03-27 11:55:10,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.046362, valid_loss 1.375977, train_metric nan, valid_metric 0.127486
[2648869:MainThread](2024-03-27 11:55:10,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.042985, valid_loss 1.376851, train_metric nan, valid_metric 0.132667
[2648869:MainThread](2024-03-27 11:55:11,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.042739, valid_loss 1.374403, train_metric nan, valid_metric 0.134817
[2648869:MainThread](2024-03-27 11:55:11,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.042106, valid_loss 1.372802, train_metric nan, valid_metric 0.134361
[2648869:MainThread](2024-03-27 11:55:11,320) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.373318 to 1.372802, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:11,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.046865, valid_loss 1.376289, train_metric nan, valid_metric 0.131452
[2648869:MainThread](2024-03-27 11:55:11,727) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.045984, valid_loss 1.375378, train_metric nan, valid_metric 0.133626
[2648869:MainThread](2024-03-27 11:55:11,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.051685, valid_loss 1.373578, train_metric nan, valid_metric 0.135792
[2648869:MainThread](2024-03-27 11:55:12,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.054880, valid_loss 1.376370, train_metric nan, valid_metric 0.133480
[2648869:MainThread](2024-03-27 11:55:12,340) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.053155, valid_loss 1.372501, train_metric nan, valid_metric 0.135760
[2648869:MainThread](2024-03-27 11:55:12,341) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.372802 to 1.372501, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:12,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.068118, valid_loss 1.375306, train_metric nan, valid_metric 0.136232
[2648869:MainThread](2024-03-27 11:55:12,742) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.049457, valid_loss 1.373372, train_metric nan, valid_metric 0.138194
[2648869:MainThread](2024-03-27 11:55:12,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.044596, valid_loss 1.375788, train_metric nan, valid_metric 0.134007
[2648869:MainThread](2024-03-27 11:55:13,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.044869, valid_loss 1.377112, train_metric nan, valid_metric 0.132997
[2648869:MainThread](2024-03-27 11:55:13,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.058519, valid_loss 1.372805, train_metric nan, valid_metric 0.137756
[2648869:MainThread](2024-03-27 11:55:13,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.052400, valid_loss 1.376303, train_metric nan, valid_metric 0.135692
[2648869:MainThread](2024-03-27 11:55:13,750) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.044296, valid_loss 1.374820, train_metric nan, valid_metric 0.139681
[2648869:MainThread](2024-03-27 11:55:13,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.049730, valid_loss 1.375260, train_metric nan, valid_metric 0.139616
[2648869:MainThread](2024-03-27 11:55:14,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.039538, valid_loss 1.374437, train_metric nan, valid_metric 0.134642
[2648869:MainThread](2024-03-27 11:55:14,359) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.048103, valid_loss 1.374996, train_metric nan, valid_metric 0.137631
[2648869:MainThread](2024-03-27 11:55:14,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.055440, valid_loss 1.374052, train_metric nan, valid_metric 0.137642
[2648869:MainThread](2024-03-27 11:55:14,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.053468, valid_loss 1.373688, train_metric nan, valid_metric 0.139165
[2648869:MainThread](2024-03-27 11:55:14,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.035230, valid_loss 1.373316, train_metric nan, valid_metric 0.137178
[2648869:MainThread](2024-03-27 11:55:15,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.048292, valid_loss 1.377657, train_metric nan, valid_metric 0.135278
[2648869:MainThread](2024-03-27 11:55:15,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.048089, valid_loss 1.376706, train_metric nan, valid_metric 0.135004
[2648869:MainThread](2024-03-27 11:55:15,569) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.046786, valid_loss 1.374037, train_metric nan, valid_metric 0.135545
[2648869:MainThread](2024-03-27 11:55:15,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.039238, valid_loss 1.373411, train_metric nan, valid_metric 0.137351
[2648869:MainThread](2024-03-27 11:55:15,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.045376, valid_loss 1.374445, train_metric nan, valid_metric 0.135623
[2648869:MainThread](2024-03-27 11:55:16,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.045961, valid_loss 1.376527, train_metric nan, valid_metric 0.133341
[2648869:MainThread](2024-03-27 11:55:16,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.055407, valid_loss 1.372277, train_metric nan, valid_metric 0.139343
[2648869:MainThread](2024-03-27 11:55:16,380) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.372501 to 1.372277, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:16,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.041682, valid_loss 1.374660, train_metric nan, valid_metric 0.135672
[2648869:MainThread](2024-03-27 11:55:16,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.050020, valid_loss 1.374217, train_metric nan, valid_metric 0.135669
[2648869:MainThread](2024-03-27 11:55:16,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.058523, valid_loss 1.376234, train_metric nan, valid_metric 0.134025
[2648869:MainThread](2024-03-27 11:55:17,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.052349, valid_loss 1.371354, train_metric nan, valid_metric 0.141839
[2648869:MainThread](2024-03-27 11:55:17,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.372277 to 1.371354, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:17,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.044193, valid_loss 1.375617, train_metric nan, valid_metric 0.136835
[2648869:MainThread](2024-03-27 11:55:17,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.047675, valid_loss 1.376864, train_metric nan, valid_metric 0.133834
[2648869:MainThread](2024-03-27 11:55:17,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.055924, valid_loss 1.374657, train_metric nan, valid_metric 0.138682
[2648869:MainThread](2024-03-27 11:55:18,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.057206, valid_loss 1.376888, train_metric nan, valid_metric 0.133968
[2648869:MainThread](2024-03-27 11:55:18,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.049071, valid_loss 1.376367, train_metric nan, valid_metric 0.133487
[2648869:MainThread](2024-03-27 11:55:18,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.055348, valid_loss 1.374069, train_metric nan, valid_metric 0.136330
[2648869:MainThread](2024-03-27 11:55:18,603) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.044220, valid_loss 1.376371, train_metric nan, valid_metric 0.133017
[2648869:MainThread](2024-03-27 11:55:18,804) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.056908, valid_loss 1.375692, train_metric nan, valid_metric 0.135990
[2648869:MainThread](2024-03-27 11:55:19,004) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.040907, valid_loss 1.374252, train_metric nan, valid_metric 0.134633
[2648869:MainThread](2024-03-27 11:55:19,205) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.043005, valid_loss 1.373026, train_metric nan, valid_metric 0.137702
[2648869:MainThread](2024-03-27 11:55:19,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.042313, valid_loss 1.373095, train_metric nan, valid_metric 0.135979
[2648869:MainThread](2024-03-27 11:55:19,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.044260, valid_loss 1.371980, train_metric nan, valid_metric 0.140594
[2648869:MainThread](2024-03-27 11:55:19,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.040899, valid_loss 1.375198, train_metric nan, valid_metric 0.134132
[2648869:MainThread](2024-03-27 11:55:20,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.042459, valid_loss 1.370603, train_metric nan, valid_metric 0.139242
[2648869:MainThread](2024-03-27 11:55:20,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.371354 to 1.370603, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:20,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.057901, valid_loss 1.372830, train_metric nan, valid_metric 0.139929
[2648869:MainThread](2024-03-27 11:55:20,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.048426, valid_loss 1.374117, train_metric nan, valid_metric 0.136086
[2648869:MainThread](2024-03-27 11:55:20,615) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.054441, valid_loss 1.374515, train_metric nan, valid_metric 0.134918
[2648869:MainThread](2024-03-27 11:55:20,818) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.050098, valid_loss 1.373527, train_metric nan, valid_metric 0.137952
[2648869:MainThread](2024-03-27 11:55:21,017) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.035546, valid_loss 1.372478, train_metric nan, valid_metric 0.136402
[2648869:MainThread](2024-03-27 11:55:21,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.060078, valid_loss 1.373520, train_metric nan, valid_metric 0.136557
[2648869:MainThread](2024-03-27 11:55:21,426) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.053507, valid_loss 1.375244, train_metric nan, valid_metric 0.134189
[2648869:MainThread](2024-03-27 11:55:21,631) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.044348, valid_loss 1.374113, train_metric nan, valid_metric 0.137685
[2648869:MainThread](2024-03-27 11:55:21,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.051093, valid_loss 1.377528, train_metric nan, valid_metric 0.133522
[2648869:MainThread](2024-03-27 11:55:22,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 1.048031, valid_loss 1.375784, train_metric nan, valid_metric 0.137297
[2648869:MainThread](2024-03-27 11:55:22,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 1.047806, valid_loss 1.373022, train_metric nan, valid_metric 0.138301
[2648869:MainThread](2024-03-27 11:55:22,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 1.043133, valid_loss 1.373169, train_metric nan, valid_metric 0.139301
[2648869:MainThread](2024-03-27 11:55:22,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 1.041626, valid_loss 1.372080, train_metric nan, valid_metric 0.137611
[2648869:MainThread](2024-03-27 11:55:22,850) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 1.055128, valid_loss 1.374475, train_metric nan, valid_metric 0.136441
[2648869:MainThread](2024-03-27 11:55:23,053) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 1.040161, valid_loss 1.372547, train_metric nan, valid_metric 0.139028
[2648869:MainThread](2024-03-27 11:55:23,255) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 1.041452, valid_loss 1.374963, train_metric nan, valid_metric 0.139389
[2648869:MainThread](2024-03-27 11:55:23,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 1.037084, valid_loss 1.373640, train_metric nan, valid_metric 0.139921
[2648869:MainThread](2024-03-27 11:55:23,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 1.045384, valid_loss 1.374316, train_metric nan, valid_metric 0.137590
[2648869:MainThread](2024-03-27 11:55:23,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 1.040740, valid_loss 1.371518, train_metric nan, valid_metric 0.142233
[2648869:MainThread](2024-03-27 11:55:24,064) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 1.030762, valid_loss 1.371155, train_metric nan, valid_metric 0.141372
[2648869:MainThread](2024-03-27 11:55:24,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 1.048297, valid_loss 1.369571, train_metric nan, valid_metric 0.143028
[2648869:MainThread](2024-03-27 11:55:24,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.370603 to 1.369571, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:24,470) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 1.041730, valid_loss 1.372258, train_metric nan, valid_metric 0.140749
[2648869:MainThread](2024-03-27 11:55:24,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 1.045044, valid_loss 1.371125, train_metric nan, valid_metric 0.140794
[2648869:MainThread](2024-03-27 11:55:24,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 1.039270, valid_loss 1.372266, train_metric nan, valid_metric 0.142992
[2648869:MainThread](2024-03-27 11:55:25,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 1.035072, valid_loss 1.372100, train_metric nan, valid_metric 0.143342
[2648869:MainThread](2024-03-27 11:55:25,275) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 1.045803, valid_loss 1.373702, train_metric nan, valid_metric 0.139002
[2648869:MainThread](2024-03-27 11:55:25,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 1.029967, valid_loss 1.372173, train_metric nan, valid_metric 0.139648
[2648869:MainThread](2024-03-27 11:55:25,677) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 1.042945, valid_loss 1.373044, train_metric nan, valid_metric 0.140469
[2648869:MainThread](2024-03-27 11:55:25,880) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 1.043666, valid_loss 1.371447, train_metric nan, valid_metric 0.140356
[2648869:MainThread](2024-03-27 11:55:26,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 1.044421, valid_loss 1.370652, train_metric nan, valid_metric 0.141811
[2648869:MainThread](2024-03-27 11:55:26,285) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2760]: train_loss 1.033176, valid_loss 1.374290, train_metric nan, valid_metric 0.137052
[2648869:MainThread](2024-03-27 11:55:26,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2780]: train_loss 1.043702, valid_loss 1.373045, train_metric nan, valid_metric 0.140568
[2648869:MainThread](2024-03-27 11:55:26,690) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2800]: train_loss 1.044392, valid_loss 1.375592, train_metric nan, valid_metric 0.137683
[2648869:MainThread](2024-03-27 11:55:26,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2820]: train_loss 1.045539, valid_loss 1.373381, train_metric nan, valid_metric 0.139401
[2648869:MainThread](2024-03-27 11:55:27,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2840]: train_loss 1.039336, valid_loss 1.370883, train_metric nan, valid_metric 0.142854
[2648869:MainThread](2024-03-27 11:55:27,304) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2860]: train_loss 1.054318, valid_loss 1.373239, train_metric nan, valid_metric 0.141165
[2648869:MainThread](2024-03-27 11:55:27,511) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2880]: train_loss 1.045201, valid_loss 1.374893, train_metric nan, valid_metric 0.138929
[2648869:MainThread](2024-03-27 11:55:27,712) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2900]: train_loss 1.038383, valid_loss 1.371610, train_metric nan, valid_metric 0.138475
[2648869:MainThread](2024-03-27 11:55:27,913) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2920]: train_loss 1.042752, valid_loss 1.374479, train_metric nan, valid_metric 0.136520
[2648869:MainThread](2024-03-27 11:55:28,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2940]: train_loss 1.050393, valid_loss 1.372607, train_metric nan, valid_metric 0.136783
[2648869:MainThread](2024-03-27 11:55:28,316) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2960]: train_loss 1.046717, valid_loss 1.371792, train_metric nan, valid_metric 0.142178
[2648869:MainThread](2024-03-27 11:55:28,516) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2980]: train_loss 1.047761, valid_loss 1.372100, train_metric nan, valid_metric 0.140366
[2648869:MainThread](2024-03-27 11:55:28,718) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3000]: train_loss 1.035486, valid_loss 1.369332, train_metric nan, valid_metric 0.142088
[2648869:MainThread](2024-03-27 11:55:28,718) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.369571 to 1.369332, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:28,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3020]: train_loss 1.044561, valid_loss 1.374420, train_metric nan, valid_metric 0.135455
[2648869:MainThread](2024-03-27 11:55:29,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3040]: train_loss 1.047971, valid_loss 1.374450, train_metric nan, valid_metric 0.137859
[2648869:MainThread](2024-03-27 11:55:29,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3060]: train_loss 1.049846, valid_loss 1.374428, train_metric nan, valid_metric 0.138217
[2648869:MainThread](2024-03-27 11:55:29,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3080]: train_loss 1.044329, valid_loss 1.375194, train_metric nan, valid_metric 0.134952
[2648869:MainThread](2024-03-27 11:55:29,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3100]: train_loss 1.044746, valid_loss 1.373835, train_metric nan, valid_metric 0.137346
[2648869:MainThread](2024-03-27 11:55:29,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3120]: train_loss 1.038295, valid_loss 1.373202, train_metric nan, valid_metric 0.138662
[2648869:MainThread](2024-03-27 11:55:30,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3140]: train_loss 1.040299, valid_loss 1.371668, train_metric nan, valid_metric 0.141521
[2648869:MainThread](2024-03-27 11:55:30,359) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3160]: train_loss 1.054561, valid_loss 1.374641, train_metric nan, valid_metric 0.136596
[2648869:MainThread](2024-03-27 11:55:30,564) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3180]: train_loss 1.045093, valid_loss 1.371849, train_metric nan, valid_metric 0.140112
[2648869:MainThread](2024-03-27 11:55:30,767) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3200]: train_loss 1.036664, valid_loss 1.375108, train_metric nan, valid_metric 0.136266
[2648869:MainThread](2024-03-27 11:55:30,973) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3220]: train_loss 1.038227, valid_loss 1.373034, train_metric nan, valid_metric 0.139062
[2648869:MainThread](2024-03-27 11:55:31,172) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3240]: train_loss 1.045510, valid_loss 1.372165, train_metric nan, valid_metric 0.139394
[2648869:MainThread](2024-03-27 11:55:31,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3260]: train_loss 1.021675, valid_loss 1.372423, train_metric nan, valid_metric 0.139139
[2648869:MainThread](2024-03-27 11:55:31,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3280]: train_loss 1.042614, valid_loss 1.373278, train_metric nan, valid_metric 0.140565
[2648869:MainThread](2024-03-27 11:55:31,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3300]: train_loss 1.046861, valid_loss 1.373405, train_metric nan, valid_metric 0.139657
[2648869:MainThread](2024-03-27 11:55:31,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3320]: train_loss 1.054004, valid_loss 1.374058, train_metric nan, valid_metric 0.140275
[2648869:MainThread](2024-03-27 11:55:32,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3340]: train_loss 1.055100, valid_loss 1.372665, train_metric nan, valid_metric 0.140997
[2648869:MainThread](2024-03-27 11:55:32,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3360]: train_loss 1.034198, valid_loss 1.371882, train_metric nan, valid_metric 0.138030
[2648869:MainThread](2024-03-27 11:55:32,582) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3380]: train_loss 1.056470, valid_loss 1.371582, train_metric nan, valid_metric 0.138541
[2648869:MainThread](2024-03-27 11:55:32,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3400]: train_loss 1.042727, valid_loss 1.372621, train_metric nan, valid_metric 0.141018
[2648869:MainThread](2024-03-27 11:55:32,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3420]: train_loss 1.035084, valid_loss 1.373798, train_metric nan, valid_metric 0.140497
[2648869:MainThread](2024-03-27 11:55:33,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3440]: train_loss 1.050895, valid_loss 1.373831, train_metric nan, valid_metric 0.136629
[2648869:MainThread](2024-03-27 11:55:33,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3460]: train_loss 1.034863, valid_loss 1.372692, train_metric nan, valid_metric 0.138504
[2648869:MainThread](2024-03-27 11:55:33,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3480]: train_loss 1.047600, valid_loss 1.372155, train_metric nan, valid_metric 0.142105
[2648869:MainThread](2024-03-27 11:55:33,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3500]: train_loss 1.055844, valid_loss 1.373530, train_metric nan, valid_metric 0.137290
[2648869:MainThread](2024-03-27 11:55:33,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3520]: train_loss 1.040638, valid_loss 1.373561, train_metric nan, valid_metric 0.138153
[2648869:MainThread](2024-03-27 11:55:34,191) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3540]: train_loss 1.039608, valid_loss 1.374133, train_metric nan, valid_metric 0.138420
[2648869:MainThread](2024-03-27 11:55:34,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3560]: train_loss 1.047394, valid_loss 1.373118, train_metric nan, valid_metric 0.140076
[2648869:MainThread](2024-03-27 11:55:34,593) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3580]: train_loss 1.040093, valid_loss 1.369393, train_metric nan, valid_metric 0.145399
[2648869:MainThread](2024-03-27 11:55:34,794) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3600]: train_loss 1.043632, valid_loss 1.370515, train_metric nan, valid_metric 0.144000
[2648869:MainThread](2024-03-27 11:55:34,995) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3620]: train_loss 1.043222, valid_loss 1.373085, train_metric nan, valid_metric 0.139053
[2648869:MainThread](2024-03-27 11:55:35,195) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3640]: train_loss 1.046709, valid_loss 1.372974, train_metric nan, valid_metric 0.138948
[2648869:MainThread](2024-03-27 11:55:35,395) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3660]: train_loss 1.048640, valid_loss 1.373433, train_metric nan, valid_metric 0.137528
[2648869:MainThread](2024-03-27 11:55:35,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3680]: train_loss 1.036668, valid_loss 1.371713, train_metric nan, valid_metric 0.141298
[2648869:MainThread](2024-03-27 11:55:35,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3700]: train_loss 1.033955, valid_loss 1.372804, train_metric nan, valid_metric 0.138137
[2648869:MainThread](2024-03-27 11:55:35,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3720]: train_loss 1.047347, valid_loss 1.375359, train_metric nan, valid_metric 0.138324
[2648869:MainThread](2024-03-27 11:55:36,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3740]: train_loss 1.045181, valid_loss 1.374200, train_metric nan, valid_metric 0.139943
[2648869:MainThread](2024-03-27 11:55:36,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3760]: train_loss 1.038509, valid_loss 1.370479, train_metric nan, valid_metric 0.145145
[2648869:MainThread](2024-03-27 11:55:36,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3780]: train_loss 1.040606, valid_loss 1.372381, train_metric nan, valid_metric 0.140106
[2648869:MainThread](2024-03-27 11:55:36,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3800]: train_loss 1.051746, valid_loss 1.373894, train_metric nan, valid_metric 0.138831
[2648869:MainThread](2024-03-27 11:55:37,004) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3820]: train_loss 1.040822, valid_loss 1.372980, train_metric nan, valid_metric 0.139687
[2648869:MainThread](2024-03-27 11:55:37,204) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3840]: train_loss 1.045736, valid_loss 1.372734, train_metric nan, valid_metric 0.140770
[2648869:MainThread](2024-03-27 11:55:37,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3860]: train_loss 1.038827, valid_loss 1.373561, train_metric nan, valid_metric 0.138963
[2648869:MainThread](2024-03-27 11:55:37,608) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3880]: train_loss 1.052000, valid_loss 1.373085, train_metric nan, valid_metric 0.140725
[2648869:MainThread](2024-03-27 11:55:37,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3900]: train_loss 1.040254, valid_loss 1.372097, train_metric nan, valid_metric 0.139846
[2648869:MainThread](2024-03-27 11:55:37,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3920]: train_loss 1.050389, valid_loss 1.376333, train_metric nan, valid_metric 0.137181
[2648869:MainThread](2024-03-27 11:55:38,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3940]: train_loss 1.049553, valid_loss 1.372698, train_metric nan, valid_metric 0.141026
[2648869:MainThread](2024-03-27 11:55:38,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3960]: train_loss 1.040140, valid_loss 1.374601, train_metric nan, valid_metric 0.138578
[2648869:MainThread](2024-03-27 11:55:38,578) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3980]: train_loss 1.039908, valid_loss 1.372266, train_metric nan, valid_metric 0.140682
[2648869:MainThread](2024-03-27 11:55:38,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4000]: train_loss 1.036031, valid_loss 1.373114, train_metric nan, valid_metric 0.138501
[2648869:MainThread](2024-03-27 11:55:38,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 11:55:39,433) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 11:55:40,113) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  14%|█▎        | 6/44 [03:02<20:18, 32.07s/it][2648869:MainThread](2024-03-27 11:55:40,120) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 11:55:40,131) INFO - qlib.workflow - [recorder.py:341] - Recorder e4342e0484bd48ac8af49c53ddec3d4e starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 11:55:40,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 11:55:40,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 11:55:40,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 11:55:40,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 11:55:42,434) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.585526
            SH600004      1.585526
            SH600006      1.585526
            SH600007      1.585526
            SH600008      1.585526
                            ...   
2015-07-10  SZ300015      0.969478
            SZ300024      0.969478
            SZ300104      0.969478
            SZ300124      0.969478
            SZ300146      0.969478
Length: 462637, dtype: float64
[2648869:MainThread](2024-03-27 11:55:43,345) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2015-07-13  SH600000      0.969478
            SH600008      0.969478
            SH600009      0.969478
            SH600010      0.969478
            SH600011      0.969478
                            ...   
2017-06-05  SZ300133      1.546582
            SZ300144      1.546582
            SZ300146      1.546582
            SZ300182      1.546582
            SZ300251      1.546582
Length: 110330, dtype: float64
[2648869:MainThread](2024-03-27 11:55:43,444) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 11:55:43,920) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.394654, valid_loss 1.277718, train_metric nan, valid_metric 0.043433
[2648869:MainThread](2024-03-27 11:55:43,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.277718, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 11:55:44,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.237249, valid_loss 1.277695, train_metric nan, valid_metric 0.048022
[2648869:MainThread](2024-03-27 11:55:44,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.277718 to 1.277695, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:44,298) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.218631, valid_loss 1.279869, train_metric nan, valid_metric 0.074460
[2648869:MainThread](2024-03-27 11:55:44,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.151606, valid_loss 1.288345, train_metric nan, valid_metric 0.071051
[2648869:MainThread](2024-03-27 11:55:44,684) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.098147, valid_loss 1.270065, train_metric nan, valid_metric 0.088188
[2648869:MainThread](2024-03-27 11:55:44,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.277695 to 1.270065, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:44,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.170493, valid_loss 1.273671, train_metric nan, valid_metric 0.052368
[2648869:MainThread](2024-03-27 11:55:45,080) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.148387, valid_loss 1.259376, train_metric nan, valid_metric 0.099633
[2648869:MainThread](2024-03-27 11:55:45,080) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.270065 to 1.259376, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:45,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.130608, valid_loss 1.257674, train_metric nan, valid_metric 0.117602
[2648869:MainThread](2024-03-27 11:55:45,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.259376 to 1.257674, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:45,477) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.094943, valid_loss 1.259099, train_metric nan, valid_metric 0.126464
[2648869:MainThread](2024-03-27 11:55:45,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.104404, valid_loss 1.256874, train_metric nan, valid_metric 0.130386
[2648869:MainThread](2024-03-27 11:55:45,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.257674 to 1.256874, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:45,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.080985, valid_loss 1.258958, train_metric nan, valid_metric 0.109614
[2648869:MainThread](2024-03-27 11:55:46,170) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.093227, valid_loss 1.256302, train_metric nan, valid_metric 0.130605
[2648869:MainThread](2024-03-27 11:55:46,170) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.256874 to 1.256302, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:46,376) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.085791, valid_loss 1.256908, train_metric nan, valid_metric 0.129503
[2648869:MainThread](2024-03-27 11:55:46,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.077805, valid_loss 1.257476, train_metric nan, valid_metric 0.136100
[2648869:MainThread](2024-03-27 11:55:46,818) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.107991, valid_loss 1.256010, train_metric nan, valid_metric 0.125656
[2648869:MainThread](2024-03-27 11:55:46,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.256302 to 1.256010, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:47,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.092237, valid_loss 1.258740, train_metric nan, valid_metric 0.120964
[2648869:MainThread](2024-03-27 11:55:47,316) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.079626, valid_loss 1.257636, train_metric nan, valid_metric 0.132196
[2648869:MainThread](2024-03-27 11:55:47,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.077015, valid_loss 1.258032, train_metric nan, valid_metric 0.126085
[2648869:MainThread](2024-03-27 11:55:47,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.060146, valid_loss 1.256426, train_metric nan, valid_metric 0.127526
[2648869:MainThread](2024-03-27 11:55:48,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.085999, valid_loss 1.270279, train_metric nan, valid_metric 0.116781
[2648869:MainThread](2024-03-27 11:55:48,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.101583, valid_loss 1.260548, train_metric nan, valid_metric 0.124322
[2648869:MainThread](2024-03-27 11:55:48,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.081581, valid_loss 1.255650, train_metric nan, valid_metric 0.136130
[2648869:MainThread](2024-03-27 11:55:48,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.256010 to 1.255650, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:48,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.069393, valid_loss 1.256520, train_metric nan, valid_metric 0.127241
[2648869:MainThread](2024-03-27 11:55:49,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.135450, valid_loss 1.255543, train_metric nan, valid_metric 0.135133
[2648869:MainThread](2024-03-27 11:55:49,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.255650 to 1.255543, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:49,306) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.060161, valid_loss 1.256876, train_metric nan, valid_metric 0.135635
[2648869:MainThread](2024-03-27 11:55:49,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.060542, valid_loss 1.255427, train_metric nan, valid_metric 0.137748
[2648869:MainThread](2024-03-27 11:55:49,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.255543 to 1.255427, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:49,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.061588, valid_loss 1.253986, train_metric nan, valid_metric 0.133173
[2648869:MainThread](2024-03-27 11:55:49,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.255427 to 1.253986, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:50,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.054085, valid_loss 1.254211, train_metric nan, valid_metric 0.134906
[2648869:MainThread](2024-03-27 11:55:50,298) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.059923, valid_loss 1.254319, train_metric nan, valid_metric 0.137700
[2648869:MainThread](2024-03-27 11:55:50,545) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.074251, valid_loss 1.254660, train_metric nan, valid_metric 0.137110
[2648869:MainThread](2024-03-27 11:55:50,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.048846, valid_loss 1.255352, train_metric nan, valid_metric 0.138240
[2648869:MainThread](2024-03-27 11:55:51,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.064561, valid_loss 1.258330, train_metric nan, valid_metric 0.129777
[2648869:MainThread](2024-03-27 11:55:51,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.052599, valid_loss 1.257147, train_metric nan, valid_metric 0.135793
[2648869:MainThread](2024-03-27 11:55:51,536) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.053075, valid_loss 1.253375, train_metric nan, valid_metric 0.140955
[2648869:MainThread](2024-03-27 11:55:51,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.253986 to 1.253375, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:51,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.065461, valid_loss 1.256078, train_metric nan, valid_metric 0.128928
[2648869:MainThread](2024-03-27 11:55:52,037) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.076717, valid_loss 1.254892, train_metric nan, valid_metric 0.129840
[2648869:MainThread](2024-03-27 11:55:52,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.066840, valid_loss 1.254339, train_metric nan, valid_metric 0.135832
[2648869:MainThread](2024-03-27 11:55:52,533) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.048632, valid_loss 1.254758, train_metric nan, valid_metric 0.139375
[2648869:MainThread](2024-03-27 11:55:52,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.054372, valid_loss 1.254558, train_metric nan, valid_metric 0.142166
[2648869:MainThread](2024-03-27 11:55:53,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.065438, valid_loss 1.254726, train_metric nan, valid_metric 0.136038
[2648869:MainThread](2024-03-27 11:55:53,234) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.057083, valid_loss 1.255708, train_metric nan, valid_metric 0.128505
[2648869:MainThread](2024-03-27 11:55:53,486) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.063936, valid_loss 1.255496, train_metric nan, valid_metric 0.138661
[2648869:MainThread](2024-03-27 11:55:53,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.052869, valid_loss 1.256715, train_metric nan, valid_metric 0.138847
[2648869:MainThread](2024-03-27 11:55:53,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.067920, valid_loss 1.257340, train_metric nan, valid_metric 0.131324
[2648869:MainThread](2024-03-27 11:55:54,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.048562, valid_loss 1.255835, train_metric nan, valid_metric 0.131912
[2648869:MainThread](2024-03-27 11:55:54,393) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.052441, valid_loss 1.255831, train_metric nan, valid_metric 0.137202
[2648869:MainThread](2024-03-27 11:55:54,603) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.034554, valid_loss 1.255458, train_metric nan, valid_metric 0.136038
[2648869:MainThread](2024-03-27 11:55:54,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.054651, valid_loss 1.254426, train_metric nan, valid_metric 0.138755
[2648869:MainThread](2024-03-27 11:55:55,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.041240, valid_loss 1.252774, train_metric nan, valid_metric 0.142109
[2648869:MainThread](2024-03-27 11:55:55,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.253375 to 1.252774, save checkpoint.
[2648869:MainThread](2024-03-27 11:55:55,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.052955, valid_loss 1.254429, train_metric nan, valid_metric 0.140399
[2648869:MainThread](2024-03-27 11:55:55,579) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.055302, valid_loss 1.256970, train_metric nan, valid_metric 0.138882
[2648869:MainThread](2024-03-27 11:55:55,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.050331, valid_loss 1.256623, train_metric nan, valid_metric 0.141086
[2648869:MainThread](2024-03-27 11:55:56,062) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.036866, valid_loss 1.257030, train_metric nan, valid_metric 0.141538
[2648869:MainThread](2024-03-27 11:55:56,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.033463, valid_loss 1.255445, train_metric nan, valid_metric 0.141209
[2648869:MainThread](2024-03-27 11:55:56,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.054196, valid_loss 1.256880, train_metric nan, valid_metric 0.134409
[2648869:MainThread](2024-03-27 11:55:56,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.034158, valid_loss 1.254860, train_metric nan, valid_metric 0.141861
[2648869:MainThread](2024-03-27 11:55:57,018) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.045790, valid_loss 1.255860, train_metric nan, valid_metric 0.138496
[2648869:MainThread](2024-03-27 11:55:57,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.042569, valid_loss 1.254206, train_metric nan, valid_metric 0.137305
[2648869:MainThread](2024-03-27 11:55:57,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.052760, valid_loss 1.253379, train_metric nan, valid_metric 0.141434
[2648869:MainThread](2024-03-27 11:55:57,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.041037, valid_loss 1.254104, train_metric nan, valid_metric 0.137753
[2648869:MainThread](2024-03-27 11:55:57,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.060203, valid_loss 1.253739, train_metric nan, valid_metric 0.139662
[2648869:MainThread](2024-03-27 11:55:58,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.052167, valid_loss 1.255261, train_metric nan, valid_metric 0.137221
[2648869:MainThread](2024-03-27 11:55:58,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.041660, valid_loss 1.256282, train_metric nan, valid_metric 0.137809
[2648869:MainThread](2024-03-27 11:55:58,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.051509, valid_loss 1.253270, train_metric nan, valid_metric 0.139247
[2648869:MainThread](2024-03-27 11:55:58,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.047623, valid_loss 1.255448, train_metric nan, valid_metric 0.139204
[2648869:MainThread](2024-03-27 11:55:59,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.039154, valid_loss 1.254718, train_metric nan, valid_metric 0.136433
[2648869:MainThread](2024-03-27 11:55:59,268) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.045182, valid_loss 1.255742, train_metric nan, valid_metric 0.138950
[2648869:MainThread](2024-03-27 11:55:59,516) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.041417, valid_loss 1.253282, train_metric nan, valid_metric 0.140524
[2648869:MainThread](2024-03-27 11:55:59,762) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.055365, valid_loss 1.254863, train_metric nan, valid_metric 0.142224
[2648869:MainThread](2024-03-27 11:56:00,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.049170, valid_loss 1.255505, train_metric nan, valid_metric 0.140738
[2648869:MainThread](2024-03-27 11:56:00,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.048243, valid_loss 1.253610, train_metric nan, valid_metric 0.139634
[2648869:MainThread](2024-03-27 11:56:00,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.037833, valid_loss 1.254688, train_metric nan, valid_metric 0.140414
[2648869:MainThread](2024-03-27 11:56:00,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.030753, valid_loss 1.252699, train_metric nan, valid_metric 0.138319
[2648869:MainThread](2024-03-27 11:56:00,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.252774 to 1.252699, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:01,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.042712, valid_loss 1.254562, train_metric nan, valid_metric 0.141748
[2648869:MainThread](2024-03-27 11:56:01,251) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.036044, valid_loss 1.253816, train_metric nan, valid_metric 0.142152
[2648869:MainThread](2024-03-27 11:56:01,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.042790, valid_loss 1.256604, train_metric nan, valid_metric 0.142259
[2648869:MainThread](2024-03-27 11:56:01,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.039184, valid_loss 1.255405, train_metric nan, valid_metric 0.138455
[2648869:MainThread](2024-03-27 11:56:01,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.043748, valid_loss 1.254461, train_metric nan, valid_metric 0.139154
[2648869:MainThread](2024-03-27 11:56:02,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.054863, valid_loss 1.255792, train_metric nan, valid_metric 0.138352
[2648869:MainThread](2024-03-27 11:56:02,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.037297, valid_loss 1.255373, train_metric nan, valid_metric 0.139653
[2648869:MainThread](2024-03-27 11:56:02,746) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.038976, valid_loss 1.254395, train_metric nan, valid_metric 0.140283
[2648869:MainThread](2024-03-27 11:56:02,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.043390, valid_loss 1.254767, train_metric nan, valid_metric 0.139093
[2648869:MainThread](2024-03-27 11:56:03,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.036496, valid_loss 1.254209, train_metric nan, valid_metric 0.139790
[2648869:MainThread](2024-03-27 11:56:03,496) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.041809, valid_loss 1.254987, train_metric nan, valid_metric 0.140724
[2648869:MainThread](2024-03-27 11:56:03,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.052146, valid_loss 1.254241, train_metric nan, valid_metric 0.142287
[2648869:MainThread](2024-03-27 11:56:03,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.039736, valid_loss 1.252805, train_metric nan, valid_metric 0.143345
[2648869:MainThread](2024-03-27 11:56:04,204) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.040592, valid_loss 1.255063, train_metric nan, valid_metric 0.138634
[2648869:MainThread](2024-03-27 11:56:04,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.041051, valid_loss 1.254668, train_metric nan, valid_metric 0.139585
[2648869:MainThread](2024-03-27 11:56:04,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.036915, valid_loss 1.253743, train_metric nan, valid_metric 0.141553
[2648869:MainThread](2024-03-27 11:56:04,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.042700, valid_loss 1.251096, train_metric nan, valid_metric 0.140968
[2648869:MainThread](2024-03-27 11:56:04,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.252699 to 1.251096, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:05,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.029909, valid_loss 1.252174, train_metric nan, valid_metric 0.144724
[2648869:MainThread](2024-03-27 11:56:05,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.040376, valid_loss 1.253580, train_metric nan, valid_metric 0.140409
[2648869:MainThread](2024-03-27 11:56:05,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.050976, valid_loss 1.253208, train_metric nan, valid_metric 0.141305
[2648869:MainThread](2024-03-27 11:56:05,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.036017, valid_loss 1.255323, train_metric nan, valid_metric 0.139027
[2648869:MainThread](2024-03-27 11:56:05,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.041846, valid_loss 1.253571, train_metric nan, valid_metric 0.140155
[2648869:MainThread](2024-03-27 11:56:06,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.039411, valid_loss 1.254241, train_metric nan, valid_metric 0.141758
[2648869:MainThread](2024-03-27 11:56:06,243) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.053117, valid_loss 1.254732, train_metric nan, valid_metric 0.139406
[2648869:MainThread](2024-03-27 11:56:06,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.037802, valid_loss 1.254196, train_metric nan, valid_metric 0.140053
[2648869:MainThread](2024-03-27 11:56:06,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.036663, valid_loss 1.252688, train_metric nan, valid_metric 0.140846
[2648869:MainThread](2024-03-27 11:56:06,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.036281, valid_loss 1.253203, train_metric nan, valid_metric 0.140558
[2648869:MainThread](2024-03-27 11:56:07,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.053893, valid_loss 1.254222, train_metric nan, valid_metric 0.140520
[2648869:MainThread](2024-03-27 11:56:07,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.040489, valid_loss 1.252251, train_metric nan, valid_metric 0.140864
[2648869:MainThread](2024-03-27 11:56:07,483) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.047909, valid_loss 1.253930, train_metric nan, valid_metric 0.140078
[2648869:MainThread](2024-03-27 11:56:07,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.036686, valid_loss 1.252574, train_metric nan, valid_metric 0.141715
[2648869:MainThread](2024-03-27 11:56:07,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.041646, valid_loss 1.251470, train_metric nan, valid_metric 0.141706
[2648869:MainThread](2024-03-27 11:56:08,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.036179, valid_loss 1.255440, train_metric nan, valid_metric 0.139737
[2648869:MainThread](2024-03-27 11:56:08,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.040244, valid_loss 1.254125, train_metric nan, valid_metric 0.139772
[2648869:MainThread](2024-03-27 11:56:08,492) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.028295, valid_loss 1.254145, train_metric nan, valid_metric 0.141192
[2648869:MainThread](2024-03-27 11:56:08,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.038496, valid_loss 1.254004, train_metric nan, valid_metric 0.142593
[2648869:MainThread](2024-03-27 11:56:08,894) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.034305, valid_loss 1.253337, train_metric nan, valid_metric 0.139781
[2648869:MainThread](2024-03-27 11:56:09,104) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.042393, valid_loss 1.253762, train_metric nan, valid_metric 0.140622
[2648869:MainThread](2024-03-27 11:56:09,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.049275, valid_loss 1.253788, train_metric nan, valid_metric 0.138639
[2648869:MainThread](2024-03-27 11:56:09,502) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.034176, valid_loss 1.255449, train_metric nan, valid_metric 0.139592
[2648869:MainThread](2024-03-27 11:56:09,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.035609, valid_loss 1.253392, train_metric nan, valid_metric 0.140477
[2648869:MainThread](2024-03-27 11:56:09,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.038068, valid_loss 1.253741, train_metric nan, valid_metric 0.140069
[2648869:MainThread](2024-03-27 11:56:10,107) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.042095, valid_loss 1.254450, train_metric nan, valid_metric 0.140277
[2648869:MainThread](2024-03-27 11:56:10,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 1.034730, valid_loss 1.254849, train_metric nan, valid_metric 0.139642
[2648869:MainThread](2024-03-27 11:56:10,517) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 1.040090, valid_loss 1.255782, train_metric nan, valid_metric 0.137647
[2648869:MainThread](2024-03-27 11:56:10,727) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 1.042136, valid_loss 1.253883, train_metric nan, valid_metric 0.138744
[2648869:MainThread](2024-03-27 11:56:10,931) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 1.040588, valid_loss 1.254127, train_metric nan, valid_metric 0.139161
[2648869:MainThread](2024-03-27 11:56:11,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 1.035342, valid_loss 1.251372, train_metric nan, valid_metric 0.141478
[2648869:MainThread](2024-03-27 11:56:11,341) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 1.035501, valid_loss 1.252950, train_metric nan, valid_metric 0.139803
[2648869:MainThread](2024-03-27 11:56:11,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 1.048609, valid_loss 1.252419, train_metric nan, valid_metric 0.141014
[2648869:MainThread](2024-03-27 11:56:11,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 1.046559, valid_loss 1.253039, train_metric nan, valid_metric 0.140472
[2648869:MainThread](2024-03-27 11:56:12,043) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 1.032020, valid_loss 1.254576, train_metric nan, valid_metric 0.140114
[2648869:MainThread](2024-03-27 11:56:12,287) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 1.045156, valid_loss 1.254919, train_metric nan, valid_metric 0.140156
[2648869:MainThread](2024-03-27 11:56:12,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 1.039266, valid_loss 1.254407, train_metric nan, valid_metric 0.141695
[2648869:MainThread](2024-03-27 11:56:12,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 1.036225, valid_loss 1.253081, train_metric nan, valid_metric 0.141022
[2648869:MainThread](2024-03-27 11:56:12,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 1.050942, valid_loss 1.253078, train_metric nan, valid_metric 0.140894
[2648869:MainThread](2024-03-27 11:56:13,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 1.042497, valid_loss 1.255562, train_metric nan, valid_metric 0.140661
[2648869:MainThread](2024-03-27 11:56:13,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 1.030295, valid_loss 1.254361, train_metric nan, valid_metric 0.140802
[2648869:MainThread](2024-03-27 11:56:13,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 1.037489, valid_loss 1.254176, train_metric nan, valid_metric 0.144851
[2648869:MainThread](2024-03-27 11:56:13,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 1.049768, valid_loss 1.254227, train_metric nan, valid_metric 0.142141
[2648869:MainThread](2024-03-27 11:56:13,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 1.049779, valid_loss 1.254774, train_metric nan, valid_metric 0.138806
[2648869:MainThread](2024-03-27 11:56:14,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 1.030408, valid_loss 1.253530, train_metric nan, valid_metric 0.141871
[2648869:MainThread](2024-03-27 11:56:14,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 1.041215, valid_loss 1.253695, train_metric nan, valid_metric 0.141139
[2648869:MainThread](2024-03-27 11:56:14,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 1.029751, valid_loss 1.255015, train_metric nan, valid_metric 0.139861
[2648869:MainThread](2024-03-27 11:56:14,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2760]: train_loss 1.045372, valid_loss 1.253869, train_metric nan, valid_metric 0.139399
[2648869:MainThread](2024-03-27 11:56:14,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2780]: train_loss 1.042514, valid_loss 1.252314, train_metric nan, valid_metric 0.141194
[2648869:MainThread](2024-03-27 11:56:15,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2800]: train_loss 1.040575, valid_loss 1.252737, train_metric nan, valid_metric 0.138945
[2648869:MainThread](2024-03-27 11:56:15,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 11:56:15,783) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 11:56:16,475) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  16%|█▌        | 7/44 [03:38<20:38, 33.47s/it][2648869:MainThread](2024-03-27 11:56:16,482) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 11:56:16,493) INFO - qlib.workflow - [recorder.py:341] - Recorder 8a507d1984a34920bc119febedb2e23e starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 11:56:17,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 11:56:17,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 11:56:17,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 11:56:17,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 11:56:18,819) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.809961
            SH600004      1.809961
            SH600006      1.809961
            SH600007      1.809961
            SH600008      1.809961
                            ...   
2015-08-07  SZ300024      0.818157
            SZ300059      0.818157
            SZ300104      0.818157
            SZ300124      0.818157
            SZ300146      0.818157
Length: 466606, dtype: float64
[2648869:MainThread](2024-03-27 11:56:19,740) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2015-08-10  SH600000      0.818157
            SH600008      0.818157
            SH600009      0.818157
            SH600010      0.818157
            SH600011      0.818157
                            ...   
2017-07-03  SZ300033      0.984763
            SZ300124      0.984763
            SZ300133      0.984763
            SZ300144      0.984763
            SZ300251      0.984763
Length: 111149, dtype: float64
[2648869:MainThread](2024-03-27 11:56:19,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 11:56:20,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.563664, valid_loss 1.120361, train_metric nan, valid_metric 0.028431
[2648869:MainThread](2024-03-27 11:56:20,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.120361, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 11:56:20,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.305219, valid_loss 1.114705, train_metric nan, valid_metric 0.049907
[2648869:MainThread](2024-03-27 11:56:20,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.120361 to 1.114705, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:20,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.192195, valid_loss 1.110430, train_metric nan, valid_metric 0.079860
[2648869:MainThread](2024-03-27 11:56:20,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.114705 to 1.110430, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:20,937) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.111629, valid_loss 1.109511, train_metric nan, valid_metric 0.092951
[2648869:MainThread](2024-03-27 11:56:20,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.110430 to 1.109511, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:21,142) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.124949, valid_loss 1.111746, train_metric nan, valid_metric 0.076051
[2648869:MainThread](2024-03-27 11:56:21,352) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.112774, valid_loss 1.110063, train_metric nan, valid_metric 0.086530
[2648869:MainThread](2024-03-27 11:56:21,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.083374, valid_loss 1.108772, train_metric nan, valid_metric 0.099124
[2648869:MainThread](2024-03-27 11:56:21,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.109511 to 1.108772, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:21,771) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.091117, valid_loss 1.106475, train_metric nan, valid_metric 0.109209
[2648869:MainThread](2024-03-27 11:56:21,771) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.108772 to 1.106475, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:21,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.077610, valid_loss 1.106995, train_metric nan, valid_metric 0.107794
[2648869:MainThread](2024-03-27 11:56:22,184) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.076003, valid_loss 1.107807, train_metric nan, valid_metric 0.100263
[2648869:MainThread](2024-03-27 11:56:22,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.088736, valid_loss 1.105426, train_metric nan, valid_metric 0.115133
[2648869:MainThread](2024-03-27 11:56:22,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.106475 to 1.105426, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:22,599) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.080046, valid_loss 1.105923, train_metric nan, valid_metric 0.116305
[2648869:MainThread](2024-03-27 11:56:22,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.061150, valid_loss 1.107706, train_metric nan, valid_metric 0.099341
[2648869:MainThread](2024-03-27 11:56:23,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.080085, valid_loss 1.105407, train_metric nan, valid_metric 0.114302
[2648869:MainThread](2024-03-27 11:56:23,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.105426 to 1.105407, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:23,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.081081, valid_loss 1.107005, train_metric nan, valid_metric 0.126534
[2648869:MainThread](2024-03-27 11:56:23,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.054527, valid_loss 1.104345, train_metric nan, valid_metric 0.124332
[2648869:MainThread](2024-03-27 11:56:23,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.105407 to 1.104345, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:23,630) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.050517, valid_loss 1.106910, train_metric nan, valid_metric 0.113785
[2648869:MainThread](2024-03-27 11:56:23,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.070434, valid_loss 1.104733, train_metric nan, valid_metric 0.130222
[2648869:MainThread](2024-03-27 11:56:24,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.063365, valid_loss 1.107962, train_metric nan, valid_metric 0.115659
[2648869:MainThread](2024-03-27 11:56:24,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.062887, valid_loss 1.109288, train_metric nan, valid_metric 0.089671
[2648869:MainThread](2024-03-27 11:56:24,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.063109, valid_loss 1.107648, train_metric nan, valid_metric 0.118970
[2648869:MainThread](2024-03-27 11:56:24,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.073115, valid_loss 1.103896, train_metric nan, valid_metric 0.128949
[2648869:MainThread](2024-03-27 11:56:24,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.104345 to 1.103896, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:24,869) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.050421, valid_loss 1.106529, train_metric nan, valid_metric 0.106746
[2648869:MainThread](2024-03-27 11:56:25,079) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.071435, valid_loss 1.105395, train_metric nan, valid_metric 0.121236
[2648869:MainThread](2024-03-27 11:56:25,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.056301, valid_loss 1.105732, train_metric nan, valid_metric 0.115368
[2648869:MainThread](2024-03-27 11:56:25,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.062436, valid_loss 1.109005, train_metric nan, valid_metric 0.112747
[2648869:MainThread](2024-03-27 11:56:25,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.058904, valid_loss 1.105468, train_metric nan, valid_metric 0.116980
[2648869:MainThread](2024-03-27 11:56:25,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.045820, valid_loss 1.101899, train_metric nan, valid_metric 0.139215
[2648869:MainThread](2024-03-27 11:56:25,907) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.103896 to 1.101899, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:26,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.038868, valid_loss 1.102674, train_metric nan, valid_metric 0.133327
[2648869:MainThread](2024-03-27 11:56:26,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.035635, valid_loss 1.105242, train_metric nan, valid_metric 0.132718
[2648869:MainThread](2024-03-27 11:56:26,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.046185, valid_loss 1.103565, train_metric nan, valid_metric 0.129670
[2648869:MainThread](2024-03-27 11:56:26,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.063684, valid_loss 1.107734, train_metric nan, valid_metric 0.107341
[2648869:MainThread](2024-03-27 11:56:26,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.075980, valid_loss 1.106662, train_metric nan, valid_metric 0.117267
[2648869:MainThread](2024-03-27 11:56:27,143) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.041750, valid_loss 1.104180, train_metric nan, valid_metric 0.128728
[2648869:MainThread](2024-03-27 11:56:27,346) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.046663, valid_loss 1.105019, train_metric nan, valid_metric 0.129772
[2648869:MainThread](2024-03-27 11:56:27,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.053266, valid_loss 1.105881, train_metric nan, valid_metric 0.130732
[2648869:MainThread](2024-03-27 11:56:27,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.067215, valid_loss 1.104183, train_metric nan, valid_metric 0.123814
[2648869:MainThread](2024-03-27 11:56:27,953) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.036129, valid_loss 1.103453, train_metric nan, valid_metric 0.130885
[2648869:MainThread](2024-03-27 11:56:28,153) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.080511, valid_loss 1.105637, train_metric nan, valid_metric 0.119296
[2648869:MainThread](2024-03-27 11:56:28,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.048777, valid_loss 1.104742, train_metric nan, valid_metric 0.127962
[2648869:MainThread](2024-03-27 11:56:28,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.029089, valid_loss 1.106367, train_metric nan, valid_metric 0.129961
[2648869:MainThread](2024-03-27 11:56:28,756) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.028017, valid_loss 1.104515, train_metric nan, valid_metric 0.128237
[2648869:MainThread](2024-03-27 11:56:28,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.041483, valid_loss 1.105859, train_metric nan, valid_metric 0.129095
[2648869:MainThread](2024-03-27 11:56:29,156) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.036150, valid_loss 1.103571, train_metric nan, valid_metric 0.129058
[2648869:MainThread](2024-03-27 11:56:29,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.031471, valid_loss 1.103995, train_metric nan, valid_metric 0.127773
[2648869:MainThread](2024-03-27 11:56:29,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.023710, valid_loss 1.105284, train_metric nan, valid_metric 0.126609
[2648869:MainThread](2024-03-27 11:56:29,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.040298, valid_loss 1.103994, train_metric nan, valid_metric 0.130242
[2648869:MainThread](2024-03-27 11:56:29,983) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.030788, valid_loss 1.104453, train_metric nan, valid_metric 0.125526
[2648869:MainThread](2024-03-27 11:56:30,196) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.051340, valid_loss 1.105671, train_metric nan, valid_metric 0.120546
[2648869:MainThread](2024-03-27 11:56:30,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.041707, valid_loss 1.104231, train_metric nan, valid_metric 0.129623
[2648869:MainThread](2024-03-27 11:56:30,608) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.029355, valid_loss 1.103159, train_metric nan, valid_metric 0.132609
[2648869:MainThread](2024-03-27 11:56:30,812) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.051478, valid_loss 1.102486, train_metric nan, valid_metric 0.135411
[2648869:MainThread](2024-03-27 11:56:31,016) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.043871, valid_loss 1.103813, train_metric nan, valid_metric 0.125933
[2648869:MainThread](2024-03-27 11:56:31,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.038073, valid_loss 1.106222, train_metric nan, valid_metric 0.122293
[2648869:MainThread](2024-03-27 11:56:31,416) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.037285, valid_loss 1.104743, train_metric nan, valid_metric 0.129765
[2648869:MainThread](2024-03-27 11:56:31,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.035855, valid_loss 1.103496, train_metric nan, valid_metric 0.135619
[2648869:MainThread](2024-03-27 11:56:31,817) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.041106, valid_loss 1.104907, train_metric nan, valid_metric 0.130052
[2648869:MainThread](2024-03-27 11:56:32,017) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.023995, valid_loss 1.102923, train_metric nan, valid_metric 0.133453
[2648869:MainThread](2024-03-27 11:56:32,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.032675, valid_loss 1.104423, train_metric nan, valid_metric 0.125963
[2648869:MainThread](2024-03-27 11:56:32,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.029261, valid_loss 1.105551, train_metric nan, valid_metric 0.128257
[2648869:MainThread](2024-03-27 11:56:32,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.037257, valid_loss 1.104247, train_metric nan, valid_metric 0.131469
[2648869:MainThread](2024-03-27 11:56:32,817) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.034034, valid_loss 1.102574, train_metric nan, valid_metric 0.131409
[2648869:MainThread](2024-03-27 11:56:33,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.025058, valid_loss 1.103640, train_metric nan, valid_metric 0.123435
[2648869:MainThread](2024-03-27 11:56:33,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.022468, valid_loss 1.103136, train_metric nan, valid_metric 0.130340
[2648869:MainThread](2024-03-27 11:56:33,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.035200, valid_loss 1.104631, train_metric nan, valid_metric 0.121396
[2648869:MainThread](2024-03-27 11:56:33,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.031721, valid_loss 1.102925, train_metric nan, valid_metric 0.128819
[2648869:MainThread](2024-03-27 11:56:33,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.022193, valid_loss 1.104858, train_metric nan, valid_metric 0.123250
[2648869:MainThread](2024-03-27 11:56:34,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.036496, valid_loss 1.104554, train_metric nan, valid_metric 0.129010
[2648869:MainThread](2024-03-27 11:56:34,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.035328, valid_loss 1.104787, train_metric nan, valid_metric 0.129234
[2648869:MainThread](2024-03-27 11:56:34,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.029930, valid_loss 1.103757, train_metric nan, valid_metric 0.128297
[2648869:MainThread](2024-03-27 11:56:34,633) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.038177, valid_loss 1.103974, train_metric nan, valid_metric 0.130326
[2648869:MainThread](2024-03-27 11:56:34,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.026956, valid_loss 1.103488, train_metric nan, valid_metric 0.130204
[2648869:MainThread](2024-03-27 11:56:35,034) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.032313, valid_loss 1.105308, train_metric nan, valid_metric 0.119390
[2648869:MainThread](2024-03-27 11:56:35,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.029532, valid_loss 1.103926, train_metric nan, valid_metric 0.126735
[2648869:MainThread](2024-03-27 11:56:35,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.030843, valid_loss 1.102925, train_metric nan, valid_metric 0.131963
[2648869:MainThread](2024-03-27 11:56:35,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.024343, valid_loss 1.102071, train_metric nan, valid_metric 0.133519
[2648869:MainThread](2024-03-27 11:56:35,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.037691, valid_loss 1.103385, train_metric nan, valid_metric 0.130252
[2648869:MainThread](2024-03-27 11:56:36,043) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.036900, valid_loss 1.104380, train_metric nan, valid_metric 0.127504
[2648869:MainThread](2024-03-27 11:56:36,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 11:56:36,715) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 11:56:37,408) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  18%|█▊        | 8/44 [03:59<17:41, 29.48s/it][2648869:MainThread](2024-03-27 11:56:37,415) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 11:56:37,426) INFO - qlib.workflow - [recorder.py:341] - Recorder d5d4c4e35a4245ba9a36300cac13e252 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 11:56:38,047) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 11:56:38,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 11:56:38,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 11:56:38,053) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 11:56:39,730) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.521168
            SH600004      1.521168
            SH600006      1.521168
            SH600007      1.521168
            SH600008      1.521168
                            ...   
2015-09-08  SZ300104      0.793960
            SZ300124      0.793960
            SZ300133      0.793960
            SZ300146      0.793960
            SZ300251      0.793960
Length: 471010, dtype: float64
[2648869:MainThread](2024-03-27 11:56:40,636) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2015-09-09  SH600000      0.793960
            SH600008      0.793960
            SH600009      0.793960
            SH600010      0.793960
            SH600011      0.793960
                            ...   
2017-07-31  SZ300033      0.724507
            SZ300124      0.724507
            SZ300133      0.724507
            SZ300144      0.724507
            SZ300251      0.724507
Length: 111786, dtype: float64
[2648869:MainThread](2024-03-27 11:56:40,744) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 11:56:41,220) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.302942, valid_loss 1.300021, train_metric nan, valid_metric 0.006494
[2648869:MainThread](2024-03-27 11:56:41,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.300021, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 11:56:41,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.304648, valid_loss 1.275534, train_metric nan, valid_metric 0.056615
[2648869:MainThread](2024-03-27 11:56:41,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.300021 to 1.275534, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:41,598) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.137538, valid_loss 1.258202, train_metric nan, valid_metric 0.073656
[2648869:MainThread](2024-03-27 11:56:41,598) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.275534 to 1.258202, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:41,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.192384, valid_loss 1.262729, train_metric nan, valid_metric 0.068587
[2648869:MainThread](2024-03-27 11:56:41,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.109619, valid_loss 1.259740, train_metric nan, valid_metric 0.075700
[2648869:MainThread](2024-03-27 11:56:42,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.118649, valid_loss 1.260049, train_metric nan, valid_metric 0.083174
[2648869:MainThread](2024-03-27 11:56:42,353) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.118194, valid_loss 1.280192, train_metric nan, valid_metric 0.061059
[2648869:MainThread](2024-03-27 11:56:42,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.108323, valid_loss 1.255835, train_metric nan, valid_metric 0.102846
[2648869:MainThread](2024-03-27 11:56:42,545) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.258202 to 1.255835, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:42,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.083753, valid_loss 1.255353, train_metric nan, valid_metric 0.096391
[2648869:MainThread](2024-03-27 11:56:42,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.255835 to 1.255353, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:42,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.077572, valid_loss 1.256175, train_metric nan, valid_metric 0.088832
[2648869:MainThread](2024-03-27 11:56:43,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.060828, valid_loss 1.256985, train_metric nan, valid_metric 0.090219
[2648869:MainThread](2024-03-27 11:56:43,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.087663, valid_loss 1.256139, train_metric nan, valid_metric 0.093452
[2648869:MainThread](2024-03-27 11:56:43,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.062284, valid_loss 1.256733, train_metric nan, valid_metric 0.094354
[2648869:MainThread](2024-03-27 11:56:43,696) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.055472, valid_loss 1.258918, train_metric nan, valid_metric 0.083103
[2648869:MainThread](2024-03-27 11:56:43,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.063808, valid_loss 1.257203, train_metric nan, valid_metric 0.091932
[2648869:MainThread](2024-03-27 11:56:44,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.081924, valid_loss 1.255317, train_metric nan, valid_metric 0.099474
[2648869:MainThread](2024-03-27 11:56:44,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.255353 to 1.255317, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:44,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.111877, valid_loss 1.254460, train_metric nan, valid_metric 0.097703
[2648869:MainThread](2024-03-27 11:56:44,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.255317 to 1.254460, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:44,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.090959, valid_loss 1.255563, train_metric nan, valid_metric 0.104617
[2648869:MainThread](2024-03-27 11:56:44,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.043413, valid_loss 1.255548, train_metric nan, valid_metric 0.099268
[2648869:MainThread](2024-03-27 11:56:44,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.029348, valid_loss 1.253674, train_metric nan, valid_metric 0.103898
[2648869:MainThread](2024-03-27 11:56:44,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.254460 to 1.253674, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:45,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.055444, valid_loss 1.253947, train_metric nan, valid_metric 0.101566
[2648869:MainThread](2024-03-27 11:56:45,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.068126, valid_loss 1.254639, train_metric nan, valid_metric 0.097948
[2648869:MainThread](2024-03-27 11:56:45,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.060628, valid_loss 1.252487, train_metric nan, valid_metric 0.099043
[2648869:MainThread](2024-03-27 11:56:45,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.253674 to 1.252487, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:45,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.049494, valid_loss 1.255756, train_metric nan, valid_metric 0.089745
[2648869:MainThread](2024-03-27 11:56:45,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.162054, valid_loss 1.255500, train_metric nan, valid_metric 0.096646
[2648869:MainThread](2024-03-27 11:56:46,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.043609, valid_loss 1.254127, train_metric nan, valid_metric 0.103515
[2648869:MainThread](2024-03-27 11:56:46,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.074683, valid_loss 1.257722, train_metric nan, valid_metric 0.107171
[2648869:MainThread](2024-03-27 11:56:46,452) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.053828, valid_loss 1.253740, train_metric nan, valid_metric 0.104101
[2648869:MainThread](2024-03-27 11:56:46,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.029158, valid_loss 1.252976, train_metric nan, valid_metric 0.110322
[2648869:MainThread](2024-03-27 11:56:46,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.041723, valid_loss 1.253482, train_metric nan, valid_metric 0.109208
[2648869:MainThread](2024-03-27 11:56:47,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.021329, valid_loss 1.250662, train_metric nan, valid_metric 0.119503
[2648869:MainThread](2024-03-27 11:56:47,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.252487 to 1.250662, save checkpoint.
[2648869:MainThread](2024-03-27 11:56:47,251) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.025315, valid_loss 1.254892, train_metric nan, valid_metric 0.110720
[2648869:MainThread](2024-03-27 11:56:47,453) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.035151, valid_loss 1.252694, train_metric nan, valid_metric 0.108200
[2648869:MainThread](2024-03-27 11:56:47,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.049547, valid_loss 1.254831, train_metric nan, valid_metric 0.105425
[2648869:MainThread](2024-03-27 11:56:47,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.042410, valid_loss 1.256102, train_metric nan, valid_metric 0.106810
[2648869:MainThread](2024-03-27 11:56:48,058) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.024035, valid_loss 1.255221, train_metric nan, valid_metric 0.108538
[2648869:MainThread](2024-03-27 11:56:48,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.042972, valid_loss 1.255153, train_metric nan, valid_metric 0.100557
[2648869:MainThread](2024-03-27 11:56:48,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.038022, valid_loss 1.254303, train_metric nan, valid_metric 0.104058
[2648869:MainThread](2024-03-27 11:56:48,669) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.049330, valid_loss 1.255717, train_metric nan, valid_metric 0.103440
[2648869:MainThread](2024-03-27 11:56:48,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.046621, valid_loss 1.255062, train_metric nan, valid_metric 0.107129
[2648869:MainThread](2024-03-27 11:56:49,077) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.028487, valid_loss 1.251588, train_metric nan, valid_metric 0.109875
[2648869:MainThread](2024-03-27 11:56:49,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.059574, valid_loss 1.254350, train_metric nan, valid_metric 0.101594
[2648869:MainThread](2024-03-27 11:56:49,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.018851, valid_loss 1.252656, train_metric nan, valid_metric 0.110371
[2648869:MainThread](2024-03-27 11:56:49,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.052056, valid_loss 1.253434, train_metric nan, valid_metric 0.109850
[2648869:MainThread](2024-03-27 11:56:49,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.036300, valid_loss 1.254575, train_metric nan, valid_metric 0.104412
[2648869:MainThread](2024-03-27 11:56:50,086) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.024277, valid_loss 1.254184, train_metric nan, valid_metric 0.105679
[2648869:MainThread](2024-03-27 11:56:50,285) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.037167, valid_loss 1.254012, train_metric nan, valid_metric 0.108248
[2648869:MainThread](2024-03-27 11:56:50,487) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.023326, valid_loss 1.253379, train_metric nan, valid_metric 0.107108
[2648869:MainThread](2024-03-27 11:56:50,684) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.011732, valid_loss 1.251480, train_metric nan, valid_metric 0.110617
[2648869:MainThread](2024-03-27 11:56:50,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.025002, valid_loss 1.255125, train_metric nan, valid_metric 0.102967
[2648869:MainThread](2024-03-27 11:56:51,084) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.013249, valid_loss 1.255252, train_metric nan, valid_metric 0.103474
[2648869:MainThread](2024-03-27 11:56:51,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.023944, valid_loss 1.254136, train_metric nan, valid_metric 0.108150
[2648869:MainThread](2024-03-27 11:56:51,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.021236, valid_loss 1.253527, train_metric nan, valid_metric 0.108164
[2648869:MainThread](2024-03-27 11:56:51,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.016744, valid_loss 1.252681, train_metric nan, valid_metric 0.108725
[2648869:MainThread](2024-03-27 11:56:51,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.028811, valid_loss 1.255065, train_metric nan, valid_metric 0.104703
[2648869:MainThread](2024-03-27 11:56:52,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.027931, valid_loss 1.255498, train_metric nan, valid_metric 0.105825
[2648869:MainThread](2024-03-27 11:56:52,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.029600, valid_loss 1.255478, train_metric nan, valid_metric 0.107723
[2648869:MainThread](2024-03-27 11:56:52,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.014840, valid_loss 1.254062, train_metric nan, valid_metric 0.109281
[2648869:MainThread](2024-03-27 11:56:52,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.024136, valid_loss 1.254486, train_metric nan, valid_metric 0.109139
[2648869:MainThread](2024-03-27 11:56:52,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.031623, valid_loss 1.253687, train_metric nan, valid_metric 0.109275
[2648869:MainThread](2024-03-27 11:56:53,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.030609, valid_loss 1.253827, train_metric nan, valid_metric 0.107862
[2648869:MainThread](2024-03-27 11:56:53,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.017486, valid_loss 1.252627, train_metric nan, valid_metric 0.112276
[2648869:MainThread](2024-03-27 11:56:53,508) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.019080, valid_loss 1.253548, train_metric nan, valid_metric 0.111445
[2648869:MainThread](2024-03-27 11:56:53,716) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.016420, valid_loss 1.252993, train_metric nan, valid_metric 0.112528
[2648869:MainThread](2024-03-27 11:56:53,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.999983, valid_loss 1.252131, train_metric nan, valid_metric 0.113142
[2648869:MainThread](2024-03-27 11:56:54,130) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.027249, valid_loss 1.252865, train_metric nan, valid_metric 0.110937
[2648869:MainThread](2024-03-27 11:56:54,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.029159, valid_loss 1.253373, train_metric nan, valid_metric 0.109806
[2648869:MainThread](2024-03-27 11:56:54,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.010606, valid_loss 1.254867, train_metric nan, valid_metric 0.110406
[2648869:MainThread](2024-03-27 11:56:54,750) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.019070, valid_loss 1.253453, train_metric nan, valid_metric 0.108249
[2648869:MainThread](2024-03-27 11:56:54,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.020382, valid_loss 1.252738, train_metric nan, valid_metric 0.110137
[2648869:MainThread](2024-03-27 11:56:55,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.020163, valid_loss 1.253267, train_metric nan, valid_metric 0.109723
[2648869:MainThread](2024-03-27 11:56:55,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.011515, valid_loss 1.253431, train_metric nan, valid_metric 0.108989
[2648869:MainThread](2024-03-27 11:56:55,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.017030, valid_loss 1.254614, train_metric nan, valid_metric 0.107700
[2648869:MainThread](2024-03-27 11:56:55,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.010496, valid_loss 1.254029, train_metric nan, valid_metric 0.109592
[2648869:MainThread](2024-03-27 11:56:55,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.013353, valid_loss 1.254300, train_metric nan, valid_metric 0.107391
[2648869:MainThread](2024-03-27 11:56:56,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.009231, valid_loss 1.252846, train_metric nan, valid_metric 0.108669
[2648869:MainThread](2024-03-27 11:56:56,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.021727, valid_loss 1.253543, train_metric nan, valid_metric 0.109979
[2648869:MainThread](2024-03-27 11:56:56,586) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.006431, valid_loss 1.253191, train_metric nan, valid_metric 0.111962
[2648869:MainThread](2024-03-27 11:56:56,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.009776, valid_loss 1.252370, train_metric nan, valid_metric 0.111811
[2648869:MainThread](2024-03-27 11:56:56,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.006584, valid_loss 1.254293, train_metric nan, valid_metric 0.109332
[2648869:MainThread](2024-03-27 11:56:57,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.014977, valid_loss 1.252715, train_metric nan, valid_metric 0.110452
[2648869:MainThread](2024-03-27 11:56:57,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 11:56:57,786) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 11:56:58,449) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  20%|██        | 9/44 [04:20<15:39, 26.84s/it][2648869:MainThread](2024-03-27 11:56:58,456) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 11:56:58,466) INFO - qlib.workflow - [recorder.py:341] - Recorder 986edaba7c3849be98977178c0c8f807 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 11:56:59,127) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 11:56:59,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 11:56:59,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 11:56:59,132) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 11:57:00,763) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.257309
            SH600004      1.257309
            SH600006      1.257309
            SH600007      1.257309
            SH600008      1.257309
                            ...   
2015-10-13  SZ300015      1.252903
            SZ300024      1.252903
            SZ300104      1.252903
            SZ300124      1.252903
            SZ300146      1.252903
Length: 475624, dtype: float64
[2648869:MainThread](2024-03-27 11:57:01,663) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2015-10-14  SH600000      1.252903
            SH600008      1.252903
            SH600009      1.252903
            SH600010      1.252903
            SH600011      1.252903
                            ...   
2017-08-28  SZ300072      0.711990
            SZ300124      0.711990
            SZ300133      0.711990
            SZ300144      0.711990
            SZ300251      0.711990
Length: 112493, dtype: float64
[2648869:MainThread](2024-03-27 11:57:01,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 11:57:02,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.884572, valid_loss 1.345981, train_metric nan, valid_metric -0.008831
[2648869:MainThread](2024-03-27 11:57:02,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.345981, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 11:57:02,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.216923, valid_loss 1.306447, train_metric nan, valid_metric 0.021572
[2648869:MainThread](2024-03-27 11:57:02,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.345981 to 1.306447, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:02,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.235824, valid_loss 1.301945, train_metric nan, valid_metric 0.036083
[2648869:MainThread](2024-03-27 11:57:02,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.306447 to 1.301945, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:02,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.135328, valid_loss 1.301017, train_metric nan, valid_metric 0.043324
[2648869:MainThread](2024-03-27 11:57:02,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.301945 to 1.301017, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:03,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.116869, valid_loss 1.302529, train_metric nan, valid_metric 0.039010
[2648869:MainThread](2024-03-27 11:57:03,243) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.117846, valid_loss 1.299500, train_metric nan, valid_metric 0.041168
[2648869:MainThread](2024-03-27 11:57:03,243) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.301017 to 1.299500, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:03,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.108260, valid_loss 1.295928, train_metric nan, valid_metric 0.070672
[2648869:MainThread](2024-03-27 11:57:03,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.299500 to 1.295928, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:03,628) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.100029, valid_loss 1.295271, train_metric nan, valid_metric 0.071607
[2648869:MainThread](2024-03-27 11:57:03,629) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.295928 to 1.295271, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:03,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.146667, valid_loss 1.296365, train_metric nan, valid_metric 0.055798
[2648869:MainThread](2024-03-27 11:57:04,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.122292, valid_loss 1.294140, train_metric nan, valid_metric 0.070517
[2648869:MainThread](2024-03-27 11:57:04,028) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.295271 to 1.294140, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:04,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.109495, valid_loss 1.294017, train_metric nan, valid_metric 0.067945
[2648869:MainThread](2024-03-27 11:57:04,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.294140 to 1.294017, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:04,437) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.113038, valid_loss 1.295053, train_metric nan, valid_metric 0.062530
[2648869:MainThread](2024-03-27 11:57:04,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.129334, valid_loss 1.294781, train_metric nan, valid_metric 0.066180
[2648869:MainThread](2024-03-27 11:57:04,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.106460, valid_loss 1.292592, train_metric nan, valid_metric 0.082541
[2648869:MainThread](2024-03-27 11:57:04,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.294017 to 1.292592, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:05,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.078286, valid_loss 1.297022, train_metric nan, valid_metric 0.074268
[2648869:MainThread](2024-03-27 11:57:05,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.074562, valid_loss 1.293986, train_metric nan, valid_metric 0.081210
[2648869:MainThread](2024-03-27 11:57:05,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.173363, valid_loss 1.293664, train_metric nan, valid_metric 0.087872
[2648869:MainThread](2024-03-27 11:57:05,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.075727, valid_loss 1.291451, train_metric nan, valid_metric 0.090238
[2648869:MainThread](2024-03-27 11:57:05,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.292592 to 1.291451, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:05,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.114327, valid_loss 1.294571, train_metric nan, valid_metric 0.073085
[2648869:MainThread](2024-03-27 11:57:06,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.119457, valid_loss 1.293226, train_metric nan, valid_metric 0.076695
[2648869:MainThread](2024-03-27 11:57:06,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.063606, valid_loss 1.292303, train_metric nan, valid_metric 0.082587
[2648869:MainThread](2024-03-27 11:57:06,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.094526, valid_loss 1.292626, train_metric nan, valid_metric 0.082919
[2648869:MainThread](2024-03-27 11:57:06,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.058049, valid_loss 1.292084, train_metric nan, valid_metric 0.088640
[2648869:MainThread](2024-03-27 11:57:06,873) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.081025, valid_loss 1.292041, train_metric nan, valid_metric 0.084589
[2648869:MainThread](2024-03-27 11:57:07,067) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.052640, valid_loss 1.291301, train_metric nan, valid_metric 0.083178
[2648869:MainThread](2024-03-27 11:57:07,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.291451 to 1.291301, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:07,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.054976, valid_loss 1.288873, train_metric nan, valid_metric 0.090256
[2648869:MainThread](2024-03-27 11:57:07,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.291301 to 1.288873, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:07,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.046806, valid_loss 1.289446, train_metric nan, valid_metric 0.093364
[2648869:MainThread](2024-03-27 11:57:07,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.062525, valid_loss 1.290394, train_metric nan, valid_metric 0.091306
[2648869:MainThread](2024-03-27 11:57:07,842) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.069881, valid_loss 1.289518, train_metric nan, valid_metric 0.087200
[2648869:MainThread](2024-03-27 11:57:08,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.054781, valid_loss 1.291625, train_metric nan, valid_metric 0.087330
[2648869:MainThread](2024-03-27 11:57:08,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.064895, valid_loss 1.289746, train_metric nan, valid_metric 0.088559
[2648869:MainThread](2024-03-27 11:57:08,452) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.083498, valid_loss 1.290509, train_metric nan, valid_metric 0.097076
[2648869:MainThread](2024-03-27 11:57:08,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.049908, valid_loss 1.290624, train_metric nan, valid_metric 0.093279
[2648869:MainThread](2024-03-27 11:57:08,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.061744, valid_loss 1.291433, train_metric nan, valid_metric 0.095330
[2648869:MainThread](2024-03-27 11:57:09,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.057870, valid_loss 1.291111, train_metric nan, valid_metric 0.094661
[2648869:MainThread](2024-03-27 11:57:09,260) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.057425, valid_loss 1.289792, train_metric nan, valid_metric 0.094328
[2648869:MainThread](2024-03-27 11:57:09,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.039202, valid_loss 1.289642, train_metric nan, valid_metric 0.098376
[2648869:MainThread](2024-03-27 11:57:09,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.045291, valid_loss 1.289398, train_metric nan, valid_metric 0.090820
[2648869:MainThread](2024-03-27 11:57:09,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.051818, valid_loss 1.289580, train_metric nan, valid_metric 0.095525
[2648869:MainThread](2024-03-27 11:57:10,066) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.050810, valid_loss 1.290317, train_metric nan, valid_metric 0.093269
[2648869:MainThread](2024-03-27 11:57:10,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.040212, valid_loss 1.288700, train_metric nan, valid_metric 0.091540
[2648869:MainThread](2024-03-27 11:57:10,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.288873 to 1.288700, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:10,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.042336, valid_loss 1.289888, train_metric nan, valid_metric 0.091591
[2648869:MainThread](2024-03-27 11:57:10,678) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.037428, valid_loss 1.291692, train_metric nan, valid_metric 0.087413
[2648869:MainThread](2024-03-27 11:57:10,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.044808, valid_loss 1.289249, train_metric nan, valid_metric 0.095700
[2648869:MainThread](2024-03-27 11:57:11,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.048179, valid_loss 1.290160, train_metric nan, valid_metric 0.093595
[2648869:MainThread](2024-03-27 11:57:11,287) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.062279, valid_loss 1.288824, train_metric nan, valid_metric 0.096487
[2648869:MainThread](2024-03-27 11:57:11,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.043447, valid_loss 1.288295, train_metric nan, valid_metric 0.098548
[2648869:MainThread](2024-03-27 11:57:11,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.288700 to 1.288295, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:11,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.053002, valid_loss 1.290569, train_metric nan, valid_metric 0.088996
[2648869:MainThread](2024-03-27 11:57:11,894) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.047414, valid_loss 1.289189, train_metric nan, valid_metric 0.092708
[2648869:MainThread](2024-03-27 11:57:12,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.034661, valid_loss 1.287609, train_metric nan, valid_metric 0.093605
[2648869:MainThread](2024-03-27 11:57:12,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.288295 to 1.287609, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:12,304) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.053739, valid_loss 1.289589, train_metric nan, valid_metric 0.091346
[2648869:MainThread](2024-03-27 11:57:12,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.032340, valid_loss 1.289021, train_metric nan, valid_metric 0.099044
[2648869:MainThread](2024-03-27 11:57:12,709) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.043052, valid_loss 1.288733, train_metric nan, valid_metric 0.095245
[2648869:MainThread](2024-03-27 11:57:12,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.026430, valid_loss 1.286604, train_metric nan, valid_metric 0.100846
[2648869:MainThread](2024-03-27 11:57:12,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.287609 to 1.286604, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:13,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.035253, valid_loss 1.288512, train_metric nan, valid_metric 0.100841
[2648869:MainThread](2024-03-27 11:57:13,321) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.027274, valid_loss 1.288486, train_metric nan, valid_metric 0.096081
[2648869:MainThread](2024-03-27 11:57:13,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.027835, valid_loss 1.289276, train_metric nan, valid_metric 0.094159
[2648869:MainThread](2024-03-27 11:57:13,726) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.028218, valid_loss 1.288939, train_metric nan, valid_metric 0.097548
[2648869:MainThread](2024-03-27 11:57:13,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.032594, valid_loss 1.288319, train_metric nan, valid_metric 0.101130
[2648869:MainThread](2024-03-27 11:57:14,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.040488, valid_loss 1.287245, train_metric nan, valid_metric 0.102896
[2648869:MainThread](2024-03-27 11:57:14,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.052731, valid_loss 1.290172, train_metric nan, valid_metric 0.095663
[2648869:MainThread](2024-03-27 11:57:14,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.056340, valid_loss 1.289286, train_metric nan, valid_metric 0.101033
[2648869:MainThread](2024-03-27 11:57:14,735) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.054125, valid_loss 1.289592, train_metric nan, valid_metric 0.091289
[2648869:MainThread](2024-03-27 11:57:14,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.030546, valid_loss 1.289479, train_metric nan, valid_metric 0.087830
[2648869:MainThread](2024-03-27 11:57:15,141) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.035045, valid_loss 1.289858, train_metric nan, valid_metric 0.096241
[2648869:MainThread](2024-03-27 11:57:15,341) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.031645, valid_loss 1.288164, train_metric nan, valid_metric 0.101620
[2648869:MainThread](2024-03-27 11:57:15,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.042436, valid_loss 1.289931, train_metric nan, valid_metric 0.097368
[2648869:MainThread](2024-03-27 11:57:15,743) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.032892, valid_loss 1.288701, train_metric nan, valid_metric 0.097972
[2648869:MainThread](2024-03-27 11:57:15,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.037146, valid_loss 1.287883, train_metric nan, valid_metric 0.098616
[2648869:MainThread](2024-03-27 11:57:16,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.038138, valid_loss 1.288730, train_metric nan, valid_metric 0.099789
[2648869:MainThread](2024-03-27 11:57:16,353) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.031145, valid_loss 1.287747, train_metric nan, valid_metric 0.102454
[2648869:MainThread](2024-03-27 11:57:16,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.023258, valid_loss 1.286270, train_metric nan, valid_metric 0.104028
[2648869:MainThread](2024-03-27 11:57:16,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.286604 to 1.286270, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:16,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.032037, valid_loss 1.286428, train_metric nan, valid_metric 0.104370
[2648869:MainThread](2024-03-27 11:57:16,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.037182, valid_loss 1.289419, train_metric nan, valid_metric 0.100044
[2648869:MainThread](2024-03-27 11:57:17,179) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.028301, valid_loss 1.287388, train_metric nan, valid_metric 0.102604
[2648869:MainThread](2024-03-27 11:57:17,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.038029, valid_loss 1.289206, train_metric nan, valid_metric 0.098857
[2648869:MainThread](2024-03-27 11:57:17,585) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.040573, valid_loss 1.287204, train_metric nan, valid_metric 0.100616
[2648869:MainThread](2024-03-27 11:57:17,794) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.040045, valid_loss 1.288206, train_metric nan, valid_metric 0.100875
[2648869:MainThread](2024-03-27 11:57:17,996) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.036034, valid_loss 1.288185, train_metric nan, valid_metric 0.101676
[2648869:MainThread](2024-03-27 11:57:18,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.038528, valid_loss 1.288477, train_metric nan, valid_metric 0.097730
[2648869:MainThread](2024-03-27 11:57:18,403) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.031458, valid_loss 1.286566, train_metric nan, valid_metric 0.106606
[2648869:MainThread](2024-03-27 11:57:18,603) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.033317, valid_loss 1.287310, train_metric nan, valid_metric 0.103182
[2648869:MainThread](2024-03-27 11:57:18,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.045378, valid_loss 1.288456, train_metric nan, valid_metric 0.105898
[2648869:MainThread](2024-03-27 11:57:19,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.024422, valid_loss 1.286150, train_metric nan, valid_metric 0.107317
[2648869:MainThread](2024-03-27 11:57:19,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.286270 to 1.286150, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:19,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.027174, valid_loss 1.288029, train_metric nan, valid_metric 0.102180
[2648869:MainThread](2024-03-27 11:57:19,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.020787, valid_loss 1.286494, train_metric nan, valid_metric 0.106280
[2648869:MainThread](2024-03-27 11:57:19,623) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.039405, valid_loss 1.287346, train_metric nan, valid_metric 0.106184
[2648869:MainThread](2024-03-27 11:57:19,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.030687, valid_loss 1.289140, train_metric nan, valid_metric 0.102065
[2648869:MainThread](2024-03-27 11:57:20,018) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.024307, valid_loss 1.286356, train_metric nan, valid_metric 0.107181
[2648869:MainThread](2024-03-27 11:57:20,215) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.024895, valid_loss 1.288582, train_metric nan, valid_metric 0.104827
[2648869:MainThread](2024-03-27 11:57:20,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.037538, valid_loss 1.286862, train_metric nan, valid_metric 0.104254
[2648869:MainThread](2024-03-27 11:57:20,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.039048, valid_loss 1.287699, train_metric nan, valid_metric 0.102584
[2648869:MainThread](2024-03-27 11:57:20,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.029239, valid_loss 1.287303, train_metric nan, valid_metric 0.103589
[2648869:MainThread](2024-03-27 11:57:21,005) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.023266, valid_loss 1.285853, train_metric nan, valid_metric 0.106547
[2648869:MainThread](2024-03-27 11:57:21,005) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.286150 to 1.285853, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:21,204) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.025091, valid_loss 1.286708, train_metric nan, valid_metric 0.107873
[2648869:MainThread](2024-03-27 11:57:21,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.040517, valid_loss 1.288505, train_metric nan, valid_metric 0.104633
[2648869:MainThread](2024-03-27 11:57:21,590) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.037675, valid_loss 1.287173, train_metric nan, valid_metric 0.102951
[2648869:MainThread](2024-03-27 11:57:21,779) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.035544, valid_loss 1.287244, train_metric nan, valid_metric 0.103448
[2648869:MainThread](2024-03-27 11:57:21,970) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.033028, valid_loss 1.286858, train_metric nan, valid_metric 0.105132
[2648869:MainThread](2024-03-27 11:57:22,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.039102, valid_loss 1.287945, train_metric nan, valid_metric 0.103408
[2648869:MainThread](2024-03-27 11:57:22,350) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.024333, valid_loss 1.285299, train_metric nan, valid_metric 0.109327
[2648869:MainThread](2024-03-27 11:57:22,350) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.285853 to 1.285299, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:22,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.021783, valid_loss 1.285244, train_metric nan, valid_metric 0.111646
[2648869:MainThread](2024-03-27 11:57:22,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.285299 to 1.285244, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:22,733) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.034718, valid_loss 1.286383, train_metric nan, valid_metric 0.107778
[2648869:MainThread](2024-03-27 11:57:22,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.033483, valid_loss 1.287027, train_metric nan, valid_metric 0.105849
[2648869:MainThread](2024-03-27 11:57:23,125) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.028906, valid_loss 1.288237, train_metric nan, valid_metric 0.101192
[2648869:MainThread](2024-03-27 11:57:23,320) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.032396, valid_loss 1.287253, train_metric nan, valid_metric 0.106103
[2648869:MainThread](2024-03-27 11:57:23,517) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.032007, valid_loss 1.285555, train_metric nan, valid_metric 0.108923
[2648869:MainThread](2024-03-27 11:57:23,718) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.039625, valid_loss 1.286784, train_metric nan, valid_metric 0.105792
[2648869:MainThread](2024-03-27 11:57:23,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.033785, valid_loss 1.286329, train_metric nan, valid_metric 0.106866
[2648869:MainThread](2024-03-27 11:57:24,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.041322, valid_loss 1.285504, train_metric nan, valid_metric 0.108557
[2648869:MainThread](2024-03-27 11:57:24,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.029372, valid_loss 1.287777, train_metric nan, valid_metric 0.106858
[2648869:MainThread](2024-03-27 11:57:24,528) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.030692, valid_loss 1.287320, train_metric nan, valid_metric 0.103572
[2648869:MainThread](2024-03-27 11:57:24,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.026937, valid_loss 1.288461, train_metric nan, valid_metric 0.102649
[2648869:MainThread](2024-03-27 11:57:24,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.028034, valid_loss 1.287270, train_metric nan, valid_metric 0.106229
[2648869:MainThread](2024-03-27 11:57:25,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.014567, valid_loss 1.284334, train_metric nan, valid_metric 0.108653
[2648869:MainThread](2024-03-27 11:57:25,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.285244 to 1.284334, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:25,342) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.028698, valid_loss 1.286626, train_metric nan, valid_metric 0.105790
[2648869:MainThread](2024-03-27 11:57:25,545) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 1.027590, valid_loss 1.287674, train_metric nan, valid_metric 0.104081
[2648869:MainThread](2024-03-27 11:57:25,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 1.031563, valid_loss 1.288329, train_metric nan, valid_metric 0.102229
[2648869:MainThread](2024-03-27 11:57:25,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 1.026699, valid_loss 1.287175, train_metric nan, valid_metric 0.104938
[2648869:MainThread](2024-03-27 11:57:26,154) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 1.028297, valid_loss 1.286482, train_metric nan, valid_metric 0.107122
[2648869:MainThread](2024-03-27 11:57:26,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 1.025474, valid_loss 1.287491, train_metric nan, valid_metric 0.105643
[2648869:MainThread](2024-03-27 11:57:26,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 1.019147, valid_loss 1.286778, train_metric nan, valid_metric 0.103692
[2648869:MainThread](2024-03-27 11:57:26,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 1.036095, valid_loss 1.286389, train_metric nan, valid_metric 0.106543
[2648869:MainThread](2024-03-27 11:57:26,962) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 1.037433, valid_loss 1.287642, train_metric nan, valid_metric 0.104075
[2648869:MainThread](2024-03-27 11:57:27,163) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 1.027325, valid_loss 1.285661, train_metric nan, valid_metric 0.107495
[2648869:MainThread](2024-03-27 11:57:27,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 1.021189, valid_loss 1.286501, train_metric nan, valid_metric 0.108354
[2648869:MainThread](2024-03-27 11:57:27,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 1.035729, valid_loss 1.287945, train_metric nan, valid_metric 0.103912
[2648869:MainThread](2024-03-27 11:57:27,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 1.024825, valid_loss 1.286481, train_metric nan, valid_metric 0.104407
[2648869:MainThread](2024-03-27 11:57:27,976) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 1.020503, valid_loss 1.286582, train_metric nan, valid_metric 0.105090
[2648869:MainThread](2024-03-27 11:57:28,184) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 1.029068, valid_loss 1.285409, train_metric nan, valid_metric 0.107868
[2648869:MainThread](2024-03-27 11:57:28,375) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 1.031534, valid_loss 1.286167, train_metric nan, valid_metric 0.108285
[2648869:MainThread](2024-03-27 11:57:28,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 1.034615, valid_loss 1.288478, train_metric nan, valid_metric 0.105677
[2648869:MainThread](2024-03-27 11:57:28,757) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 1.019262, valid_loss 1.289396, train_metric nan, valid_metric 0.103882
[2648869:MainThread](2024-03-27 11:57:28,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 1.032647, valid_loss 1.287817, train_metric nan, valid_metric 0.108039
[2648869:MainThread](2024-03-27 11:57:29,140) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 1.028618, valid_loss 1.286823, train_metric nan, valid_metric 0.106439
[2648869:MainThread](2024-03-27 11:57:29,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 1.021046, valid_loss 1.286364, train_metric nan, valid_metric 0.108249
[2648869:MainThread](2024-03-27 11:57:29,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 1.038270, valid_loss 1.287883, train_metric nan, valid_metric 0.105571
[2648869:MainThread](2024-03-27 11:57:29,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2760]: train_loss 1.030109, valid_loss 1.286219, train_metric nan, valid_metric 0.105724
[2648869:MainThread](2024-03-27 11:57:29,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2780]: train_loss 1.029248, valid_loss 1.287588, train_metric nan, valid_metric 0.106698
[2648869:MainThread](2024-03-27 11:57:30,104) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2800]: train_loss 1.025211, valid_loss 1.285830, train_metric nan, valid_metric 0.109561
[2648869:MainThread](2024-03-27 11:57:30,305) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2820]: train_loss 1.022986, valid_loss 1.288305, train_metric nan, valid_metric 0.103404
[2648869:MainThread](2024-03-27 11:57:30,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2840]: train_loss 1.019523, valid_loss 1.286245, train_metric nan, valid_metric 0.105404
[2648869:MainThread](2024-03-27 11:57:30,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2860]: train_loss 1.022107, valid_loss 1.286766, train_metric nan, valid_metric 0.108411
[2648869:MainThread](2024-03-27 11:57:30,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2880]: train_loss 1.035661, valid_loss 1.285791, train_metric nan, valid_metric 0.108311
[2648869:MainThread](2024-03-27 11:57:31,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2900]: train_loss 1.021060, valid_loss 1.286835, train_metric nan, valid_metric 0.103352
[2648869:MainThread](2024-03-27 11:57:31,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2920]: train_loss 1.016036, valid_loss 1.286738, train_metric nan, valid_metric 0.105249
[2648869:MainThread](2024-03-27 11:57:31,524) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2940]: train_loss 1.029850, valid_loss 1.287662, train_metric nan, valid_metric 0.107068
[2648869:MainThread](2024-03-27 11:57:31,731) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2960]: train_loss 1.028998, valid_loss 1.288551, train_metric nan, valid_metric 0.105513
[2648869:MainThread](2024-03-27 11:57:31,929) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2980]: train_loss 1.029927, valid_loss 1.288078, train_metric nan, valid_metric 0.105615
[2648869:MainThread](2024-03-27 11:57:32,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3000]: train_loss 1.037289, valid_loss 1.286951, train_metric nan, valid_metric 0.105469
[2648869:MainThread](2024-03-27 11:57:32,333) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3020]: train_loss 1.039765, valid_loss 1.287747, train_metric nan, valid_metric 0.106195
[2648869:MainThread](2024-03-27 11:57:32,538) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3040]: train_loss 1.014203, valid_loss 1.286874, train_metric nan, valid_metric 0.107760
[2648869:MainThread](2024-03-27 11:57:32,739) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3060]: train_loss 1.031553, valid_loss 1.287414, train_metric nan, valid_metric 0.106841
[2648869:MainThread](2024-03-27 11:57:32,942) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3080]: train_loss 1.020170, valid_loss 1.287531, train_metric nan, valid_metric 0.106033
[2648869:MainThread](2024-03-27 11:57:33,143) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3100]: train_loss 1.033474, valid_loss 1.287022, train_metric nan, valid_metric 0.107443
[2648869:MainThread](2024-03-27 11:57:33,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3120]: train_loss 1.019561, valid_loss 1.285550, train_metric nan, valid_metric 0.110946
[2648869:MainThread](2024-03-27 11:57:33,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3140]: train_loss 1.014572, valid_loss 1.285854, train_metric nan, valid_metric 0.109504
[2648869:MainThread](2024-03-27 11:57:33,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3160]: train_loss 1.042312, valid_loss 1.286989, train_metric nan, valid_metric 0.107701
[2648869:MainThread](2024-03-27 11:57:33,942) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3180]: train_loss 1.031857, valid_loss 1.287091, train_metric nan, valid_metric 0.106629
[2648869:MainThread](2024-03-27 11:57:34,134) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3200]: train_loss 1.027867, valid_loss 1.287287, train_metric nan, valid_metric 0.108359
[2648869:MainThread](2024-03-27 11:57:34,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3220]: train_loss 1.028126, valid_loss 1.287266, train_metric nan, valid_metric 0.105263
[2648869:MainThread](2024-03-27 11:57:34,511) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3240]: train_loss 1.028663, valid_loss 1.286313, train_metric nan, valid_metric 0.104994
[2648869:MainThread](2024-03-27 11:57:34,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3260]: train_loss 1.022102, valid_loss 1.285209, train_metric nan, valid_metric 0.108122
[2648869:MainThread](2024-03-27 11:57:34,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3280]: train_loss 1.024394, valid_loss 1.287678, train_metric nan, valid_metric 0.105551
[2648869:MainThread](2024-03-27 11:57:35,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3300]: train_loss 1.025935, valid_loss 1.285753, train_metric nan, valid_metric 0.107705
[2648869:MainThread](2024-03-27 11:57:35,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 11:57:35,683) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 11:57:36,297) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  23%|██▎       | 10/44 [04:58<17:08, 30.24s/it][2648869:MainThread](2024-03-27 11:57:36,304) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 11:57:36,316) INFO - qlib.workflow - [recorder.py:341] - Recorder a170077e0246430797c1449904c6b244 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 11:57:36,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 11:57:36,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 11:57:36,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 11:57:36,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 11:57:38,628) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.166736
            SH600004      1.166736
            SH600006      1.166736
            SH600007      1.166736
            SH600008      1.166736
                            ...   
2015-11-19  SZ300059      1.173273
            SZ300124      1.173273
            SZ300133      1.173273
            SZ300146      1.173273
            SZ300251      1.173273
Length: 480381, dtype: float64
[2648869:MainThread](2024-03-27 11:57:39,519) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2015-11-20  SH600000      1.173273
            SH600008      1.173273
            SH600009      1.173273
            SH600010      1.173273
            SH600011      1.173273
                            ...   
2017-09-25  SZ300133      1.160791
            SZ300144      1.160791
            SZ300168      1.160791
            SZ300251      1.160791
            SZ300315      1.160791
Length: 112870, dtype: float64
[2648869:MainThread](2024-03-27 11:57:39,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 11:57:40,073) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.408651, valid_loss 1.226601, train_metric nan, valid_metric 0.014118
[2648869:MainThread](2024-03-27 11:57:40,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.226601, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 11:57:40,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.143852, valid_loss 1.201593, train_metric nan, valid_metric 0.049282
[2648869:MainThread](2024-03-27 11:57:40,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.226601 to 1.201593, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:40,486) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.150087, valid_loss 1.206943, train_metric nan, valid_metric 0.043008
[2648869:MainThread](2024-03-27 11:57:40,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.089548, valid_loss 1.199309, train_metric nan, valid_metric 0.064309
[2648869:MainThread](2024-03-27 11:57:40,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.201593 to 1.199309, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:40,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.095079, valid_loss 1.207061, train_metric nan, valid_metric 0.064152
[2648869:MainThread](2024-03-27 11:57:41,089) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.097986, valid_loss 1.197746, train_metric nan, valid_metric 0.076118
[2648869:MainThread](2024-03-27 11:57:41,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.199309 to 1.197746, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:41,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.085701, valid_loss 1.198229, train_metric nan, valid_metric 0.073535
[2648869:MainThread](2024-03-27 11:57:41,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.077069, valid_loss 1.196707, train_metric nan, valid_metric 0.081525
[2648869:MainThread](2024-03-27 11:57:41,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.197746 to 1.196707, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:41,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.084748, valid_loss 1.197880, train_metric nan, valid_metric 0.090515
[2648869:MainThread](2024-03-27 11:57:41,895) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.075580, valid_loss 1.194185, train_metric nan, valid_metric 0.090027
[2648869:MainThread](2024-03-27 11:57:41,895) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.196707 to 1.194185, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:42,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.067193, valid_loss 1.194112, train_metric nan, valid_metric 0.093468
[2648869:MainThread](2024-03-27 11:57:42,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.194185 to 1.194112, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:42,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.072534, valid_loss 1.195297, train_metric nan, valid_metric 0.086029
[2648869:MainThread](2024-03-27 11:57:42,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.095591, valid_loss 1.194745, train_metric nan, valid_metric 0.094187
[2648869:MainThread](2024-03-27 11:57:42,701) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.061261, valid_loss 1.193249, train_metric nan, valid_metric 0.099020
[2648869:MainThread](2024-03-27 11:57:42,702) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.194112 to 1.193249, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:42,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.081756, valid_loss 1.192680, train_metric nan, valid_metric 0.098823
[2648869:MainThread](2024-03-27 11:57:42,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.193249 to 1.192680, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:43,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.073396, valid_loss 1.193861, train_metric nan, valid_metric 0.099828
[2648869:MainThread](2024-03-27 11:57:43,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.057069, valid_loss 1.192664, train_metric nan, valid_metric 0.100747
[2648869:MainThread](2024-03-27 11:57:43,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.192680 to 1.192664, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:43,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.068981, valid_loss 1.189993, train_metric nan, valid_metric 0.107549
[2648869:MainThread](2024-03-27 11:57:43,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.192664 to 1.189993, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:43,765) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.059095, valid_loss 1.191464, train_metric nan, valid_metric 0.102224
[2648869:MainThread](2024-03-27 11:57:44,015) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.038111, valid_loss 1.191545, train_metric nan, valid_metric 0.104815
[2648869:MainThread](2024-03-27 11:57:44,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.045907, valid_loss 1.192202, train_metric nan, valid_metric 0.106283
[2648869:MainThread](2024-03-27 11:57:44,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.029937, valid_loss 1.191853, train_metric nan, valid_metric 0.107174
[2648869:MainThread](2024-03-27 11:57:44,770) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.038758, valid_loss 1.192828, train_metric nan, valid_metric 0.106657
[2648869:MainThread](2024-03-27 11:57:45,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.057366, valid_loss 1.190880, train_metric nan, valid_metric 0.112893
[2648869:MainThread](2024-03-27 11:57:45,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.034862, valid_loss 1.192056, train_metric nan, valid_metric 0.112155
[2648869:MainThread](2024-03-27 11:57:45,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.037909, valid_loss 1.191509, train_metric nan, valid_metric 0.111188
[2648869:MainThread](2024-03-27 11:57:45,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.045107, valid_loss 1.191973, train_metric nan, valid_metric 0.110434
[2648869:MainThread](2024-03-27 11:57:45,894) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.038953, valid_loss 1.192290, train_metric nan, valid_metric 0.107119
[2648869:MainThread](2024-03-27 11:57:46,102) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.060225, valid_loss 1.190464, train_metric nan, valid_metric 0.115274
[2648869:MainThread](2024-03-27 11:57:46,307) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.040585, valid_loss 1.191328, train_metric nan, valid_metric 0.113281
[2648869:MainThread](2024-03-27 11:57:46,508) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.028697, valid_loss 1.189954, train_metric nan, valid_metric 0.112930
[2648869:MainThread](2024-03-27 11:57:46,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.189993 to 1.189954, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:46,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.020503, valid_loss 1.190893, train_metric nan, valid_metric 0.113907
[2648869:MainThread](2024-03-27 11:57:46,912) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.023771, valid_loss 1.188885, train_metric nan, valid_metric 0.114108
[2648869:MainThread](2024-03-27 11:57:46,912) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.189954 to 1.188885, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:47,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.026284, valid_loss 1.188632, train_metric nan, valid_metric 0.117619
[2648869:MainThread](2024-03-27 11:57:47,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.188885 to 1.188632, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:47,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.024911, valid_loss 1.190909, train_metric nan, valid_metric 0.116404
[2648869:MainThread](2024-03-27 11:57:47,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.034588, valid_loss 1.189466, train_metric nan, valid_metric 0.115590
[2648869:MainThread](2024-03-27 11:57:47,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.023839, valid_loss 1.191081, train_metric nan, valid_metric 0.114284
[2648869:MainThread](2024-03-27 11:57:47,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.016231, valid_loss 1.191651, train_metric nan, valid_metric 0.114975
[2648869:MainThread](2024-03-27 11:57:48,126) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.023161, valid_loss 1.190980, train_metric nan, valid_metric 0.114356
[2648869:MainThread](2024-03-27 11:57:48,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.048144, valid_loss 1.190275, train_metric nan, valid_metric 0.113089
[2648869:MainThread](2024-03-27 11:57:48,533) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.031736, valid_loss 1.191574, train_metric nan, valid_metric 0.112120
[2648869:MainThread](2024-03-27 11:57:48,735) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.015833, valid_loss 1.189278, train_metric nan, valid_metric 0.116916
[2648869:MainThread](2024-03-27 11:57:48,937) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.025034, valid_loss 1.190263, train_metric nan, valid_metric 0.113339
[2648869:MainThread](2024-03-27 11:57:49,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.023301, valid_loss 1.190703, train_metric nan, valid_metric 0.114701
[2648869:MainThread](2024-03-27 11:57:49,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.019620, valid_loss 1.190076, train_metric nan, valid_metric 0.115827
[2648869:MainThread](2024-03-27 11:57:49,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.021874, valid_loss 1.189955, train_metric nan, valid_metric 0.116335
[2648869:MainThread](2024-03-27 11:57:49,750) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.023195, valid_loss 1.189310, train_metric nan, valid_metric 0.116388
[2648869:MainThread](2024-03-27 11:57:49,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.017833, valid_loss 1.189598, train_metric nan, valid_metric 0.119059
[2648869:MainThread](2024-03-27 11:57:50,153) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.009218, valid_loss 1.188548, train_metric nan, valid_metric 0.117649
[2648869:MainThread](2024-03-27 11:57:50,153) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.188632 to 1.188548, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:50,356) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.025716, valid_loss 1.188051, train_metric nan, valid_metric 0.117527
[2648869:MainThread](2024-03-27 11:57:50,356) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.188548 to 1.188051, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:50,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.012129, valid_loss 1.188902, train_metric nan, valid_metric 0.115939
[2648869:MainThread](2024-03-27 11:57:50,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.029090, valid_loss 1.190965, train_metric nan, valid_metric 0.113633
[2648869:MainThread](2024-03-27 11:57:50,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.018986, valid_loss 1.189725, train_metric nan, valid_metric 0.115691
[2648869:MainThread](2024-03-27 11:57:51,163) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.011129, valid_loss 1.189365, train_metric nan, valid_metric 0.116877
[2648869:MainThread](2024-03-27 11:57:51,366) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.011497, valid_loss 1.190700, train_metric nan, valid_metric 0.114319
[2648869:MainThread](2024-03-27 11:57:51,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.047269, valid_loss 1.190866, train_metric nan, valid_metric 0.114888
[2648869:MainThread](2024-03-27 11:57:51,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.006203, valid_loss 1.189697, train_metric nan, valid_metric 0.116530
[2648869:MainThread](2024-03-27 11:57:51,973) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.026723, valid_loss 1.190294, train_metric nan, valid_metric 0.115127
[2648869:MainThread](2024-03-27 11:57:52,172) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.032563, valid_loss 1.190871, train_metric nan, valid_metric 0.115435
[2648869:MainThread](2024-03-27 11:57:52,375) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.030031, valid_loss 1.190230, train_metric nan, valid_metric 0.117492
[2648869:MainThread](2024-03-27 11:57:52,576) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.028875, valid_loss 1.190058, train_metric nan, valid_metric 0.116185
[2648869:MainThread](2024-03-27 11:57:52,778) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.049386, valid_loss 1.189942, train_metric nan, valid_metric 0.116416
[2648869:MainThread](2024-03-27 11:57:52,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.020777, valid_loss 1.189874, train_metric nan, valid_metric 0.115625
[2648869:MainThread](2024-03-27 11:57:53,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.010138, valid_loss 1.188171, train_metric nan, valid_metric 0.117865
[2648869:MainThread](2024-03-27 11:57:53,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.021772, valid_loss 1.191421, train_metric nan, valid_metric 0.112529
[2648869:MainThread](2024-03-27 11:57:53,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.008891, valid_loss 1.190909, train_metric nan, valid_metric 0.115667
[2648869:MainThread](2024-03-27 11:57:53,793) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.016363, valid_loss 1.189251, train_metric nan, valid_metric 0.116620
[2648869:MainThread](2024-03-27 11:57:53,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.031246, valid_loss 1.189418, train_metric nan, valid_metric 0.117875
[2648869:MainThread](2024-03-27 11:57:54,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.014303, valid_loss 1.188631, train_metric nan, valid_metric 0.118530
[2648869:MainThread](2024-03-27 11:57:54,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.017345, valid_loss 1.190177, train_metric nan, valid_metric 0.116490
[2648869:MainThread](2024-03-27 11:57:54,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.011651, valid_loss 1.191044, train_metric nan, valid_metric 0.116872
[2648869:MainThread](2024-03-27 11:57:54,817) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.026609, valid_loss 1.188949, train_metric nan, valid_metric 0.118212
[2648869:MainThread](2024-03-27 11:57:55,016) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.010755, valid_loss 1.189908, train_metric nan, valid_metric 0.116812
[2648869:MainThread](2024-03-27 11:57:55,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.016673, valid_loss 1.188167, train_metric nan, valid_metric 0.118759
[2648869:MainThread](2024-03-27 11:57:55,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.015161, valid_loss 1.190229, train_metric nan, valid_metric 0.118821
[2648869:MainThread](2024-03-27 11:57:55,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.011543, valid_loss 1.187314, train_metric nan, valid_metric 0.120552
[2648869:MainThread](2024-03-27 11:57:55,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.188051 to 1.187314, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:55,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.034803, valid_loss 1.189419, train_metric nan, valid_metric 0.118704
[2648869:MainThread](2024-03-27 11:57:56,029) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.019114, valid_loss 1.190114, train_metric nan, valid_metric 0.116166
[2648869:MainThread](2024-03-27 11:57:56,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.024708, valid_loss 1.188343, train_metric nan, valid_metric 0.118316
[2648869:MainThread](2024-03-27 11:57:56,437) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.016367, valid_loss 1.190029, train_metric nan, valid_metric 0.118657
[2648869:MainThread](2024-03-27 11:57:56,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.014794, valid_loss 1.190061, train_metric nan, valid_metric 0.118478
[2648869:MainThread](2024-03-27 11:57:56,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.014457, valid_loss 1.190608, train_metric nan, valid_metric 0.117573
[2648869:MainThread](2024-03-27 11:57:57,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.018754, valid_loss 1.188856, train_metric nan, valid_metric 0.119616
[2648869:MainThread](2024-03-27 11:57:57,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.026644, valid_loss 1.190115, train_metric nan, valid_metric 0.118504
[2648869:MainThread](2024-03-27 11:57:57,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.019165, valid_loss 1.189912, train_metric nan, valid_metric 0.118065
[2648869:MainThread](2024-03-27 11:57:57,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.016297, valid_loss 1.187940, train_metric nan, valid_metric 0.117358
[2648869:MainThread](2024-03-27 11:57:57,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.028462, valid_loss 1.189094, train_metric nan, valid_metric 0.118650
[2648869:MainThread](2024-03-27 11:57:58,114) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.015110, valid_loss 1.188754, train_metric nan, valid_metric 0.119107
[2648869:MainThread](2024-03-27 11:57:58,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.009025, valid_loss 1.189093, train_metric nan, valid_metric 0.117847
[2648869:MainThread](2024-03-27 11:57:58,611) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.016311, valid_loss 1.189186, train_metric nan, valid_metric 0.118123
[2648869:MainThread](2024-03-27 11:57:58,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.025828, valid_loss 1.189331, train_metric nan, valid_metric 0.116781
[2648869:MainThread](2024-03-27 11:57:59,104) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.015304, valid_loss 1.187311, train_metric nan, valid_metric 0.119472
[2648869:MainThread](2024-03-27 11:57:59,104) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.187314 to 1.187311, save checkpoint.
[2648869:MainThread](2024-03-27 11:57:59,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.028312, valid_loss 1.191486, train_metric nan, valid_metric 0.116836
[2648869:MainThread](2024-03-27 11:57:59,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.012467, valid_loss 1.188463, train_metric nan, valid_metric 0.118877
[2648869:MainThread](2024-03-27 11:57:59,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.006755, valid_loss 1.187513, train_metric nan, valid_metric 0.119405
[2648869:MainThread](2024-03-27 11:58:00,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.022243, valid_loss 1.189037, train_metric nan, valid_metric 0.118178
[2648869:MainThread](2024-03-27 11:58:00,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.999771, valid_loss 1.190254, train_metric nan, valid_metric 0.117682
[2648869:MainThread](2024-03-27 11:58:00,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.010692, valid_loss 1.189091, train_metric nan, valid_metric 0.118364
[2648869:MainThread](2024-03-27 11:58:00,842) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.017052, valid_loss 1.190230, train_metric nan, valid_metric 0.117135
[2648869:MainThread](2024-03-27 11:58:01,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.022419, valid_loss 1.190854, train_metric nan, valid_metric 0.116311
[2648869:MainThread](2024-03-27 11:58:01,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.012451, valid_loss 1.190336, train_metric nan, valid_metric 0.117112
[2648869:MainThread](2024-03-27 11:58:01,494) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.018187, valid_loss 1.189095, train_metric nan, valid_metric 0.117170
[2648869:MainThread](2024-03-27 11:58:01,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.023202, valid_loss 1.190550, train_metric nan, valid_metric 0.115358
[2648869:MainThread](2024-03-27 11:58:01,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.011787, valid_loss 1.189881, train_metric nan, valid_metric 0.117509
[2648869:MainThread](2024-03-27 11:58:02,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.024104, valid_loss 1.189404, train_metric nan, valid_metric 0.118063
[2648869:MainThread](2024-03-27 11:58:02,295) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.014406, valid_loss 1.188027, train_metric nan, valid_metric 0.119600
[2648869:MainThread](2024-03-27 11:58:02,541) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.014836, valid_loss 1.189033, train_metric nan, valid_metric 0.118436
[2648869:MainThread](2024-03-27 11:58:02,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.027494, valid_loss 1.187961, train_metric nan, valid_metric 0.119922
[2648869:MainThread](2024-03-27 11:58:03,043) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.017451, valid_loss 1.188993, train_metric nan, valid_metric 0.118838
[2648869:MainThread](2024-03-27 11:58:03,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.001665, valid_loss 1.188930, train_metric nan, valid_metric 0.118431
[2648869:MainThread](2024-03-27 11:58:03,453) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.003890, valid_loss 1.188841, train_metric nan, valid_metric 0.118305
[2648869:MainThread](2024-03-27 11:58:03,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.013374, valid_loss 1.189543, train_metric nan, valid_metric 0.118162
[2648869:MainThread](2024-03-27 11:58:03,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.018522, valid_loss 1.190605, train_metric nan, valid_metric 0.116615
[2648869:MainThread](2024-03-27 11:58:04,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.022629, valid_loss 1.190656, train_metric nan, valid_metric 0.116138
[2648869:MainThread](2024-03-27 11:58:04,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.020035, valid_loss 1.191145, train_metric nan, valid_metric 0.115526
[2648869:MainThread](2024-03-27 11:58:04,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.016036, valid_loss 1.189695, train_metric nan, valid_metric 0.117676
[2648869:MainThread](2024-03-27 11:58:04,897) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 1.028317, valid_loss 1.189202, train_metric nan, valid_metric 0.118461
[2648869:MainThread](2024-03-27 11:58:05,142) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 1.021855, valid_loss 1.188643, train_metric nan, valid_metric 0.119122
[2648869:MainThread](2024-03-27 11:58:05,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 1.025351, valid_loss 1.188291, train_metric nan, valid_metric 0.119122
[2648869:MainThread](2024-03-27 11:58:05,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 1.020496, valid_loss 1.188217, train_metric nan, valid_metric 0.118033
[2648869:MainThread](2024-03-27 11:58:05,887) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 1.008008, valid_loss 1.188320, train_metric nan, valid_metric 0.118852
[2648869:MainThread](2024-03-27 11:58:06,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 1.008727, valid_loss 1.188425, train_metric nan, valid_metric 0.118620
[2648869:MainThread](2024-03-27 11:58:06,385) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 1.013826, valid_loss 1.188316, train_metric nan, valid_metric 0.118213
[2648869:MainThread](2024-03-27 11:58:06,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 1.018413, valid_loss 1.188309, train_metric nan, valid_metric 0.118844
[2648869:MainThread](2024-03-27 11:58:06,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 1.014312, valid_loss 1.189959, train_metric nan, valid_metric 0.115899
[2648869:MainThread](2024-03-27 11:58:06,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 1.022779, valid_loss 1.190950, train_metric nan, valid_metric 0.118010
[2648869:MainThread](2024-03-27 11:58:07,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 1.017183, valid_loss 1.188547, train_metric nan, valid_metric 0.118555
[2648869:MainThread](2024-03-27 11:58:07,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 1.012194, valid_loss 1.187027, train_metric nan, valid_metric 0.120252
[2648869:MainThread](2024-03-27 11:58:07,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.187311 to 1.187027, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:07,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 1.022260, valid_loss 1.188596, train_metric nan, valid_metric 0.119224
[2648869:MainThread](2024-03-27 11:58:07,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 1.001505, valid_loss 1.188014, train_metric nan, valid_metric 0.118652
[2648869:MainThread](2024-03-27 11:58:08,016) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 1.017674, valid_loss 1.189953, train_metric nan, valid_metric 0.117993
[2648869:MainThread](2024-03-27 11:58:08,263) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 1.016024, valid_loss 1.189791, train_metric nan, valid_metric 0.118715
[2648869:MainThread](2024-03-27 11:58:08,470) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 1.009687, valid_loss 1.189043, train_metric nan, valid_metric 0.118222
[2648869:MainThread](2024-03-27 11:58:08,672) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 1.013326, valid_loss 1.189441, train_metric nan, valid_metric 0.117495
[2648869:MainThread](2024-03-27 11:58:08,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 1.021207, valid_loss 1.188846, train_metric nan, valid_metric 0.118511
[2648869:MainThread](2024-03-27 11:58:09,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 1.018567, valid_loss 1.188919, train_metric nan, valid_metric 0.118995
[2648869:MainThread](2024-03-27 11:58:09,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 1.011522, valid_loss 1.187285, train_metric nan, valid_metric 0.119555
[2648869:MainThread](2024-03-27 11:58:09,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2760]: train_loss 1.009515, valid_loss 1.188637, train_metric nan, valid_metric 0.119238
[2648869:MainThread](2024-03-27 11:58:09,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2780]: train_loss 1.021350, valid_loss 1.188588, train_metric nan, valid_metric 0.118688
[2648869:MainThread](2024-03-27 11:58:09,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2800]: train_loss 1.014893, valid_loss 1.190808, train_metric nan, valid_metric 0.116538
[2648869:MainThread](2024-03-27 11:58:10,091) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2820]: train_loss 1.019940, valid_loss 1.189789, train_metric nan, valid_metric 0.118604
[2648869:MainThread](2024-03-27 11:58:10,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2840]: train_loss 1.009339, valid_loss 1.188383, train_metric nan, valid_metric 0.119335
[2648869:MainThread](2024-03-27 11:58:10,492) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2860]: train_loss 1.010144, valid_loss 1.190374, train_metric nan, valid_metric 0.117626
[2648869:MainThread](2024-03-27 11:58:10,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2880]: train_loss 1.009426, valid_loss 1.190521, train_metric nan, valid_metric 0.116820
[2648869:MainThread](2024-03-27 11:58:10,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2900]: train_loss 1.004964, valid_loss 1.188704, train_metric nan, valid_metric 0.119358
[2648869:MainThread](2024-03-27 11:58:11,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2920]: train_loss 1.024131, valid_loss 1.189376, train_metric nan, valid_metric 0.118087
[2648869:MainThread](2024-03-27 11:58:11,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2940]: train_loss 1.020433, valid_loss 1.188898, train_metric nan, valid_metric 0.118177
[2648869:MainThread](2024-03-27 11:58:11,496) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2960]: train_loss 1.015250, valid_loss 1.187478, train_metric nan, valid_metric 0.119628
[2648869:MainThread](2024-03-27 11:58:11,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2980]: train_loss 1.014874, valid_loss 1.190894, train_metric nan, valid_metric 0.115466
[2648869:MainThread](2024-03-27 11:58:11,899) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3000]: train_loss 1.008968, valid_loss 1.189324, train_metric nan, valid_metric 0.117995
[2648869:MainThread](2024-03-27 11:58:12,099) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3020]: train_loss 1.010010, valid_loss 1.187849, train_metric nan, valid_metric 0.119206
[2648869:MainThread](2024-03-27 11:58:12,300) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3040]: train_loss 1.028046, valid_loss 1.190189, train_metric nan, valid_metric 0.117362
[2648869:MainThread](2024-03-27 11:58:12,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3060]: train_loss 1.013644, valid_loss 1.189320, train_metric nan, valid_metric 0.118826
[2648869:MainThread](2024-03-27 11:58:12,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3080]: train_loss 1.008999, valid_loss 1.188334, train_metric nan, valid_metric 0.118228
[2648869:MainThread](2024-03-27 11:58:12,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3100]: train_loss 1.010514, valid_loss 1.188698, train_metric nan, valid_metric 0.117938
[2648869:MainThread](2024-03-27 11:58:13,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3120]: train_loss 1.031410, valid_loss 1.189969, train_metric nan, valid_metric 0.117495
[2648869:MainThread](2024-03-27 11:58:13,304) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3140]: train_loss 1.017290, valid_loss 1.189147, train_metric nan, valid_metric 0.118295
[2648869:MainThread](2024-03-27 11:58:13,508) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3160]: train_loss 1.012534, valid_loss 1.188537, train_metric nan, valid_metric 0.118797
[2648869:MainThread](2024-03-27 11:58:13,710) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3180]: train_loss 1.020821, valid_loss 1.188847, train_metric nan, valid_metric 0.118715
[2648869:MainThread](2024-03-27 11:58:13,913) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3200]: train_loss 1.020975, valid_loss 1.189498, train_metric nan, valid_metric 0.119111
[2648869:MainThread](2024-03-27 11:58:14,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3220]: train_loss 1.022322, valid_loss 1.189626, train_metric nan, valid_metric 0.117299
[2648869:MainThread](2024-03-27 11:58:14,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3240]: train_loss 1.023440, valid_loss 1.189072, train_metric nan, valid_metric 0.117516
[2648869:MainThread](2024-03-27 11:58:14,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3260]: train_loss 1.022281, valid_loss 1.188905, train_metric nan, valid_metric 0.118725
[2648869:MainThread](2024-03-27 11:58:14,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3280]: train_loss 1.020960, valid_loss 1.188251, train_metric nan, valid_metric 0.119101
[2648869:MainThread](2024-03-27 11:58:14,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3300]: train_loss 0.997794, valid_loss 1.187642, train_metric nan, valid_metric 0.118160
[2648869:MainThread](2024-03-27 11:58:15,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3320]: train_loss 1.011749, valid_loss 1.187948, train_metric nan, valid_metric 0.119717
[2648869:MainThread](2024-03-27 11:58:15,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3340]: train_loss 1.015891, valid_loss 1.187352, train_metric nan, valid_metric 0.119958
[2648869:MainThread](2024-03-27 11:58:15,516) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3360]: train_loss 1.007496, valid_loss 1.188371, train_metric nan, valid_metric 0.119145
[2648869:MainThread](2024-03-27 11:58:15,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3380]: train_loss 1.020866, valid_loss 1.189233, train_metric nan, valid_metric 0.118692
[2648869:MainThread](2024-03-27 11:58:15,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3400]: train_loss 1.012950, valid_loss 1.187159, train_metric nan, valid_metric 0.120313
[2648869:MainThread](2024-03-27 11:58:16,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3420]: train_loss 1.023970, valid_loss 1.188826, train_metric nan, valid_metric 0.118263
[2648869:MainThread](2024-03-27 11:58:16,328) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3440]: train_loss 1.020228, valid_loss 1.189520, train_metric nan, valid_metric 0.118023
[2648869:MainThread](2024-03-27 11:58:16,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3460]: train_loss 1.010150, valid_loss 1.189357, train_metric nan, valid_metric 0.117891
[2648869:MainThread](2024-03-27 11:58:16,735) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3480]: train_loss 1.023004, valid_loss 1.189190, train_metric nan, valid_metric 0.118760
[2648869:MainThread](2024-03-27 11:58:16,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3500]: train_loss 1.027739, valid_loss 1.189213, train_metric nan, valid_metric 0.117280
[2648869:MainThread](2024-03-27 11:58:17,141) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3520]: train_loss 1.010078, valid_loss 1.189625, train_metric nan, valid_metric 0.117173
[2648869:MainThread](2024-03-27 11:58:17,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3540]: train_loss 1.011860, valid_loss 1.189014, train_metric nan, valid_metric 0.118631
[2648869:MainThread](2024-03-27 11:58:17,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3560]: train_loss 1.024713, valid_loss 1.190524, train_metric nan, valid_metric 0.117315
[2648869:MainThread](2024-03-27 11:58:17,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 11:58:18,200) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 11:58:18,880) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  25%|██▌       | 11/44 [05:40<18:42, 34.02s/it][2648869:MainThread](2024-03-27 11:58:18,887) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 11:58:18,898) INFO - qlib.workflow - [recorder.py:341] - Recorder 08dcdb1d284447139b0e965d4b490706 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 11:58:19,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 11:58:19,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 11:58:19,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 11:58:19,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 11:58:21,210) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.972512
            SH600004      0.972512
            SH600006      0.972512
            SH600007      0.972512
            SH600008      0.972512
                            ...   
2015-12-17  SZ300133      1.198128
            SZ300144      1.198128
            SZ300146      1.198128
            SZ300251      1.198128
            SZ300315      1.198128
Length: 485266, dtype: float64
[2648869:MainThread](2024-03-27 11:58:22,099) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2015-12-18  SH600000      1.198128
            SH600008      1.198128
            SH600009      1.198128
            SH600010      1.198128
            SH600011      1.198128
                            ...   
2017-10-30  SZ300133      1.349786
            SZ300144      1.349786
            SZ300168      1.349786
            SZ300251      1.349786
            SZ300315      1.349786
Length: 113282, dtype: float64
[2648869:MainThread](2024-03-27 11:58:22,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 11:58:22,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.329236, valid_loss 1.158714, train_metric nan, valid_metric 0.038093
[2648869:MainThread](2024-03-27 11:58:22,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.158714, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 11:58:22,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.227022, valid_loss 1.168423, train_metric nan, valid_metric 0.018619
[2648869:MainThread](2024-03-27 11:58:23,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.111384, valid_loss 1.155664, train_metric nan, valid_metric 0.069106
[2648869:MainThread](2024-03-27 11:58:23,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.158714 to 1.155664, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:23,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.139139, valid_loss 1.156450, train_metric nan, valid_metric 0.060058
[2648869:MainThread](2024-03-27 11:58:23,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.099057, valid_loss 1.149920, train_metric nan, valid_metric 0.093198
[2648869:MainThread](2024-03-27 11:58:23,463) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.155664 to 1.149920, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:23,666) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.065244, valid_loss 1.151581, train_metric nan, valid_metric 0.080223
[2648869:MainThread](2024-03-27 11:58:23,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.078712, valid_loss 1.148449, train_metric nan, valid_metric 0.093536
[2648869:MainThread](2024-03-27 11:58:23,868) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.149920 to 1.148449, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:24,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.153249, valid_loss 1.155673, train_metric nan, valid_metric 0.092622
[2648869:MainThread](2024-03-27 11:58:24,275) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.082002, valid_loss 1.147231, train_metric nan, valid_metric 0.103100
[2648869:MainThread](2024-03-27 11:58:24,275) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.148449 to 1.147231, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:24,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.050152, valid_loss 1.150062, train_metric nan, valid_metric 0.096136
[2648869:MainThread](2024-03-27 11:58:24,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.074738, valid_loss 1.151887, train_metric nan, valid_metric 0.081735
[2648869:MainThread](2024-03-27 11:58:24,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.045589, valid_loss 1.147912, train_metric nan, valid_metric 0.097727
[2648869:MainThread](2024-03-27 11:58:25,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.071917, valid_loss 1.146684, train_metric nan, valid_metric 0.118624
[2648869:MainThread](2024-03-27 11:58:25,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.147231 to 1.146684, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:25,295) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.053572, valid_loss 1.147402, train_metric nan, valid_metric 0.112947
[2648869:MainThread](2024-03-27 11:58:25,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.055349, valid_loss 1.149286, train_metric nan, valid_metric 0.111506
[2648869:MainThread](2024-03-27 11:58:25,701) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.051053, valid_loss 1.151007, train_metric nan, valid_metric 0.081109
[2648869:MainThread](2024-03-27 11:58:25,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.063890, valid_loss 1.147829, train_metric nan, valid_metric 0.111087
[2648869:MainThread](2024-03-27 11:58:26,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.066835, valid_loss 1.149500, train_metric nan, valid_metric 0.106426
[2648869:MainThread](2024-03-27 11:58:26,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.035636, valid_loss 1.147540, train_metric nan, valid_metric 0.119547
[2648869:MainThread](2024-03-27 11:58:26,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.033903, valid_loss 1.147814, train_metric nan, valid_metric 0.117755
[2648869:MainThread](2024-03-27 11:58:26,702) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.039961, valid_loss 1.148879, train_metric nan, valid_metric 0.101836
[2648869:MainThread](2024-03-27 11:58:26,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.037116, valid_loss 1.148574, train_metric nan, valid_metric 0.110865
[2648869:MainThread](2024-03-27 11:58:27,104) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.029779, valid_loss 1.147972, train_metric nan, valid_metric 0.106096
[2648869:MainThread](2024-03-27 11:58:27,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.028781, valid_loss 1.146998, train_metric nan, valid_metric 0.127561
[2648869:MainThread](2024-03-27 11:58:27,515) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.029504, valid_loss 1.147003, train_metric nan, valid_metric 0.122824
[2648869:MainThread](2024-03-27 11:58:27,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.020564, valid_loss 1.149074, train_metric nan, valid_metric 0.108046
[2648869:MainThread](2024-03-27 11:58:27,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.025498, valid_loss 1.147620, train_metric nan, valid_metric 0.122891
[2648869:MainThread](2024-03-27 11:58:28,119) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.035893, valid_loss 1.147469, train_metric nan, valid_metric 0.119549
[2648869:MainThread](2024-03-27 11:58:28,321) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.036488, valid_loss 1.147308, train_metric nan, valid_metric 0.113131
[2648869:MainThread](2024-03-27 11:58:28,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.030375, valid_loss 1.148451, train_metric nan, valid_metric 0.115508
[2648869:MainThread](2024-03-27 11:58:28,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.018804, valid_loss 1.145725, train_metric nan, valid_metric 0.125582
[2648869:MainThread](2024-03-27 11:58:28,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.146684 to 1.145725, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:28,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.023406, valid_loss 1.146477, train_metric nan, valid_metric 0.112071
[2648869:MainThread](2024-03-27 11:58:29,127) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.023123, valid_loss 1.146886, train_metric nan, valid_metric 0.127475
[2648869:MainThread](2024-03-27 11:58:29,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.015508, valid_loss 1.149046, train_metric nan, valid_metric 0.105795
[2648869:MainThread](2024-03-27 11:58:29,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.015130, valid_loss 1.147145, train_metric nan, valid_metric 0.116048
[2648869:MainThread](2024-03-27 11:58:29,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.008342, valid_loss 1.145356, train_metric nan, valid_metric 0.126828
[2648869:MainThread](2024-03-27 11:58:29,731) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.145725 to 1.145356, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:29,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.031977, valid_loss 1.146262, train_metric nan, valid_metric 0.123072
[2648869:MainThread](2024-03-27 11:58:30,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.021873, valid_loss 1.146312, train_metric nan, valid_metric 0.123902
[2648869:MainThread](2024-03-27 11:58:30,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.013934, valid_loss 1.144951, train_metric nan, valid_metric 0.127773
[2648869:MainThread](2024-03-27 11:58:30,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.145356 to 1.144951, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:30,538) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.036056, valid_loss 1.145482, train_metric nan, valid_metric 0.124112
[2648869:MainThread](2024-03-27 11:58:30,739) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.025185, valid_loss 1.148106, train_metric nan, valid_metric 0.109617
[2648869:MainThread](2024-03-27 11:58:30,941) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.023748, valid_loss 1.147031, train_metric nan, valid_metric 0.117826
[2648869:MainThread](2024-03-27 11:58:31,143) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.029065, valid_loss 1.146575, train_metric nan, valid_metric 0.116643
[2648869:MainThread](2024-03-27 11:58:31,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.021219, valid_loss 1.146451, train_metric nan, valid_metric 0.122659
[2648869:MainThread](2024-03-27 11:58:31,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.021941, valid_loss 1.144788, train_metric nan, valid_metric 0.129784
[2648869:MainThread](2024-03-27 11:58:31,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.144951 to 1.144788, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:31,756) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.013053, valid_loss 1.145288, train_metric nan, valid_metric 0.129091
[2648869:MainThread](2024-03-27 11:58:31,963) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.010442, valid_loss 1.144589, train_metric nan, valid_metric 0.129014
[2648869:MainThread](2024-03-27 11:58:31,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.144788 to 1.144589, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:32,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.003682, valid_loss 1.142676, train_metric nan, valid_metric 0.130142
[2648869:MainThread](2024-03-27 11:58:32,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.144589 to 1.142676, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:32,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.019722, valid_loss 1.146351, train_metric nan, valid_metric 0.127817
[2648869:MainThread](2024-03-27 11:58:32,585) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.019271, valid_loss 1.147107, train_metric nan, valid_metric 0.117274
[2648869:MainThread](2024-03-27 11:58:32,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.016063, valid_loss 1.147387, train_metric nan, valid_metric 0.114854
[2648869:MainThread](2024-03-27 11:58:32,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.011535, valid_loss 1.145857, train_metric nan, valid_metric 0.125257
[2648869:MainThread](2024-03-27 11:58:33,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.022413, valid_loss 1.145227, train_metric nan, valid_metric 0.126435
[2648869:MainThread](2024-03-27 11:58:33,386) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.012841, valid_loss 1.145167, train_metric nan, valid_metric 0.126492
[2648869:MainThread](2024-03-27 11:58:33,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.020367, valid_loss 1.145784, train_metric nan, valid_metric 0.121053
[2648869:MainThread](2024-03-27 11:58:33,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.012258, valid_loss 1.145855, train_metric nan, valid_metric 0.125979
[2648869:MainThread](2024-03-27 11:58:33,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.005912, valid_loss 1.143449, train_metric nan, valid_metric 0.127341
[2648869:MainThread](2024-03-27 11:58:34,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.019834, valid_loss 1.144765, train_metric nan, valid_metric 0.128165
[2648869:MainThread](2024-03-27 11:58:34,398) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.010525, valid_loss 1.143922, train_metric nan, valid_metric 0.130701
[2648869:MainThread](2024-03-27 11:58:34,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.020998, valid_loss 1.146169, train_metric nan, valid_metric 0.124164
[2648869:MainThread](2024-03-27 11:58:34,804) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.005147, valid_loss 1.146832, train_metric nan, valid_metric 0.113700
[2648869:MainThread](2024-03-27 11:58:35,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.014977, valid_loss 1.144769, train_metric nan, valid_metric 0.122302
[2648869:MainThread](2024-03-27 11:58:35,213) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.008252, valid_loss 1.146281, train_metric nan, valid_metric 0.128085
[2648869:MainThread](2024-03-27 11:58:35,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.027109, valid_loss 1.145614, train_metric nan, valid_metric 0.121503
[2648869:MainThread](2024-03-27 11:58:35,624) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.019795, valid_loss 1.145705, train_metric nan, valid_metric 0.121124
[2648869:MainThread](2024-03-27 11:58:35,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.005343, valid_loss 1.145077, train_metric nan, valid_metric 0.128363
[2648869:MainThread](2024-03-27 11:58:36,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.011017, valid_loss 1.147780, train_metric nan, valid_metric 0.117551
[2648869:MainThread](2024-03-27 11:58:36,229) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.014312, valid_loss 1.146670, train_metric nan, valid_metric 0.122403
[2648869:MainThread](2024-03-27 11:58:36,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.001829, valid_loss 1.143554, train_metric nan, valid_metric 0.129904
[2648869:MainThread](2024-03-27 11:58:36,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.013559, valid_loss 1.144779, train_metric nan, valid_metric 0.129293
[2648869:MainThread](2024-03-27 11:58:36,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.012114, valid_loss 1.145271, train_metric nan, valid_metric 0.128461
[2648869:MainThread](2024-03-27 11:58:37,053) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.014927, valid_loss 1.146420, train_metric nan, valid_metric 0.125669
[2648869:MainThread](2024-03-27 11:58:37,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.017732, valid_loss 1.144641, train_metric nan, valid_metric 0.129350
[2648869:MainThread](2024-03-27 11:58:37,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.014321, valid_loss 1.145509, train_metric nan, valid_metric 0.127071
[2648869:MainThread](2024-03-27 11:58:37,666) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.006439, valid_loss 1.144146, train_metric nan, valid_metric 0.129359
[2648869:MainThread](2024-03-27 11:58:37,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.013490, valid_loss 1.146775, train_metric nan, valid_metric 0.123410
[2648869:MainThread](2024-03-27 11:58:38,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.011630, valid_loss 1.144339, train_metric nan, valid_metric 0.127306
[2648869:MainThread](2024-03-27 11:58:38,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.998238, valid_loss 1.144777, train_metric nan, valid_metric 0.130228
[2648869:MainThread](2024-03-27 11:58:38,471) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.001063, valid_loss 1.145973, train_metric nan, valid_metric 0.125206
[2648869:MainThread](2024-03-27 11:58:38,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.006493, valid_loss 1.145870, train_metric nan, valid_metric 0.126439
[2648869:MainThread](2024-03-27 11:58:38,873) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.012483, valid_loss 1.146629, train_metric nan, valid_metric 0.124659
[2648869:MainThread](2024-03-27 11:58:39,075) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.015559, valid_loss 1.144701, train_metric nan, valid_metric 0.130663
[2648869:MainThread](2024-03-27 11:58:39,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.006621, valid_loss 1.143759, train_metric nan, valid_metric 0.129567
[2648869:MainThread](2024-03-27 11:58:39,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.012298, valid_loss 1.145944, train_metric nan, valid_metric 0.127255
[2648869:MainThread](2024-03-27 11:58:39,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.008867, valid_loss 1.144051, train_metric nan, valid_metric 0.128245
[2648869:MainThread](2024-03-27 11:58:39,887) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.015442, valid_loss 1.145137, train_metric nan, valid_metric 0.127962
[2648869:MainThread](2024-03-27 11:58:40,089) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.017675, valid_loss 1.145529, train_metric nan, valid_metric 0.126814
[2648869:MainThread](2024-03-27 11:58:40,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.014813, valid_loss 1.144922, train_metric nan, valid_metric 0.129248
[2648869:MainThread](2024-03-27 11:58:40,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.012115, valid_loss 1.145655, train_metric nan, valid_metric 0.126821
[2648869:MainThread](2024-03-27 11:58:40,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.006266, valid_loss 1.144963, train_metric nan, valid_metric 0.127429
[2648869:MainThread](2024-03-27 11:58:40,898) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.004098, valid_loss 1.143385, train_metric nan, valid_metric 0.131472
[2648869:MainThread](2024-03-27 11:58:41,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.005085, valid_loss 1.143705, train_metric nan, valid_metric 0.129893
[2648869:MainThread](2024-03-27 11:58:41,310) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.007049, valid_loss 1.145435, train_metric nan, valid_metric 0.124476
[2648869:MainThread](2024-03-27 11:58:41,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.007702, valid_loss 1.144844, train_metric nan, valid_metric 0.131856
[2648869:MainThread](2024-03-27 11:58:41,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.015813, valid_loss 1.145666, train_metric nan, valid_metric 0.125924
[2648869:MainThread](2024-03-27 11:58:41,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.014763, valid_loss 1.144573, train_metric nan, valid_metric 0.129168
[2648869:MainThread](2024-03-27 11:58:42,126) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.004892, valid_loss 1.143299, train_metric nan, valid_metric 0.130820
[2648869:MainThread](2024-03-27 11:58:42,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.999264, valid_loss 1.145575, train_metric nan, valid_metric 0.123389
[2648869:MainThread](2024-03-27 11:58:42,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 11:58:42,984) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 11:58:43,660) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  27%|██▋       | 12/44 [06:05<16:38, 31.21s/it][2648869:MainThread](2024-03-27 11:58:43,667) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 11:58:43,677) INFO - qlib.workflow - [recorder.py:341] - Recorder f81d714a0ad542e3a9f0d17f4a6bdf13 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 11:58:44,300) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 11:58:44,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 11:58:44,305) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 11:58:44,305) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 11:58:46,001) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.118195
            SH600004      1.118195
            SH600006      1.118195
            SH600007      1.118195
            SH600008      1.118195
                            ...   
2016-01-15  SZ300133      0.745593
            SZ300144      0.745593
            SZ300146      0.745593
            SZ300251      0.745593
            SZ300315      0.745593
Length: 490017, dtype: float64
[2648869:MainThread](2024-03-27 11:58:46,883) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2016-01-18  SH600000      0.745593
            SH600008      0.745593
            SH600009      0.745593
            SH600010      0.745593
            SH600011      0.745593
                            ...   
2017-11-27  SZ300133      1.440320
            SZ300144      1.440320
            SZ300168      1.440320
            SZ300251      1.440320
            SZ300315      1.440320
Length: 113849, dtype: float64
[2648869:MainThread](2024-03-27 11:58:46,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 11:58:47,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.316486, valid_loss 1.211511, train_metric nan, valid_metric 0.042581
[2648869:MainThread](2024-03-27 11:58:47,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.211511, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 11:58:47,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.200897, valid_loss 1.203855, train_metric nan, valid_metric 0.064244
[2648869:MainThread](2024-03-27 11:58:47,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.211511 to 1.203855, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:47,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.186591, valid_loss 1.217016, train_metric nan, valid_metric 0.061191
[2648869:MainThread](2024-03-27 11:58:48,043) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.151176, valid_loss 1.196636, train_metric nan, valid_metric 0.080416
[2648869:MainThread](2024-03-27 11:58:48,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.203855 to 1.196636, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:48,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.132603, valid_loss 1.212446, train_metric nan, valid_metric 0.065908
[2648869:MainThread](2024-03-27 11:58:48,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.152809, valid_loss 1.191001, train_metric nan, valid_metric 0.104664
[2648869:MainThread](2024-03-27 11:58:48,437) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.196636 to 1.191001, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:48,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.099927, valid_loss 1.197741, train_metric nan, valid_metric 0.100336
[2648869:MainThread](2024-03-27 11:58:48,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.135837, valid_loss 1.202335, train_metric nan, valid_metric 0.077026
[2648869:MainThread](2024-03-27 11:58:49,047) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.088412, valid_loss 1.192794, train_metric nan, valid_metric 0.095471
[2648869:MainThread](2024-03-27 11:58:49,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.077207, valid_loss 1.194229, train_metric nan, valid_metric 0.095379
[2648869:MainThread](2024-03-27 11:58:49,453) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.086678, valid_loss 1.191764, train_metric nan, valid_metric 0.095539
[2648869:MainThread](2024-03-27 11:58:49,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.098525, valid_loss 1.190744, train_metric nan, valid_metric 0.100230
[2648869:MainThread](2024-03-27 11:58:49,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.191001 to 1.190744, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:49,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.086276, valid_loss 1.193441, train_metric nan, valid_metric 0.091926
[2648869:MainThread](2024-03-27 11:58:50,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.060104, valid_loss 1.198002, train_metric nan, valid_metric 0.086470
[2648869:MainThread](2024-03-27 11:58:50,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.081231, valid_loss 1.191890, train_metric nan, valid_metric 0.102954
[2648869:MainThread](2024-03-27 11:58:50,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.075917, valid_loss 1.193232, train_metric nan, valid_metric 0.094380
[2648869:MainThread](2024-03-27 11:58:50,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.086938, valid_loss 1.194580, train_metric nan, valid_metric 0.103506
[2648869:MainThread](2024-03-27 11:58:50,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.083997, valid_loss 1.191688, train_metric nan, valid_metric 0.096993
[2648869:MainThread](2024-03-27 11:58:51,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.064508, valid_loss 1.191811, train_metric nan, valid_metric 0.104089
[2648869:MainThread](2024-03-27 11:58:51,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.059123, valid_loss 1.192114, train_metric nan, valid_metric 0.101812
[2648869:MainThread](2024-03-27 11:58:51,483) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.087676, valid_loss 1.191521, train_metric nan, valid_metric 0.103140
[2648869:MainThread](2024-03-27 11:58:51,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.076110, valid_loss 1.192237, train_metric nan, valid_metric 0.098166
[2648869:MainThread](2024-03-27 11:58:51,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.050194, valid_loss 1.193295, train_metric nan, valid_metric 0.111329
[2648869:MainThread](2024-03-27 11:58:52,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.051634, valid_loss 1.190071, train_metric nan, valid_metric 0.118835
[2648869:MainThread](2024-03-27 11:58:52,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.190744 to 1.190071, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:52,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.071533, valid_loss 1.192431, train_metric nan, valid_metric 0.110704
[2648869:MainThread](2024-03-27 11:58:52,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.069053, valid_loss 1.188779, train_metric nan, valid_metric 0.116294
[2648869:MainThread](2024-03-27 11:58:52,515) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.190071 to 1.188779, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:52,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.057351, valid_loss 1.189137, train_metric nan, valid_metric 0.111245
[2648869:MainThread](2024-03-27 11:58:52,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.055058, valid_loss 1.189880, train_metric nan, valid_metric 0.117817
[2648869:MainThread](2024-03-27 11:58:53,130) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.056405, valid_loss 1.187383, train_metric nan, valid_metric 0.119982
[2648869:MainThread](2024-03-27 11:58:53,130) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.188779 to 1.187383, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:53,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.042779, valid_loss 1.186144, train_metric nan, valid_metric 0.125596
[2648869:MainThread](2024-03-27 11:58:53,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.187383 to 1.186144, save checkpoint.
[2648869:MainThread](2024-03-27 11:58:53,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.045646, valid_loss 1.189371, train_metric nan, valid_metric 0.116202
[2648869:MainThread](2024-03-27 11:58:53,754) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.051842, valid_loss 1.190121, train_metric nan, valid_metric 0.122069
[2648869:MainThread](2024-03-27 11:58:53,960) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.043392, valid_loss 1.189250, train_metric nan, valid_metric 0.119405
[2648869:MainThread](2024-03-27 11:58:54,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.054680, valid_loss 1.188342, train_metric nan, valid_metric 0.123270
[2648869:MainThread](2024-03-27 11:58:54,371) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.045341, valid_loss 1.189060, train_metric nan, valid_metric 0.124643
[2648869:MainThread](2024-03-27 11:58:54,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.046126, valid_loss 1.189741, train_metric nan, valid_metric 0.119892
[2648869:MainThread](2024-03-27 11:58:54,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.049755, valid_loss 1.190350, train_metric nan, valid_metric 0.116076
[2648869:MainThread](2024-03-27 11:58:55,077) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.039632, valid_loss 1.188468, train_metric nan, valid_metric 0.118782
[2648869:MainThread](2024-03-27 11:58:55,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.044850, valid_loss 1.190640, train_metric nan, valid_metric 0.113639
[2648869:MainThread](2024-03-27 11:58:55,487) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.040902, valid_loss 1.188492, train_metric nan, valid_metric 0.122534
[2648869:MainThread](2024-03-27 11:58:55,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.032553, valid_loss 1.189811, train_metric nan, valid_metric 0.114956
ModuleNotFoundError. CatBoostModel are skipped. (optional: maybe installing CatBoostModel can fix it.)
ModuleNotFoundError. XGBModel is skipped(optional: maybe installing xgboost can fix it).
Epoch   640: reducing learning rate of group 0 to 1.0000e-03.
Epoch   860: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1080: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1300: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2017-01-03 SH600000   -0.028003
           SH600008   -0.051923
           SH600009    0.044746
           SH600010   -0.072345
           SH600015    0.037536
Epoch   420: reducing learning rate of group 0 to 1.0000e-03.
Epoch   840: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1060: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1280: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1540: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1760: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2180: reducing learning rate of group 0 to 1.5625e-05.
Epoch  2400: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2017-02-07 SH600000    0.101106
           SH600008   -0.064083
           SH600009    0.260757
           SH600010   -0.133721
           SH600015    0.182704
Epoch   620: reducing learning rate of group 0 to 1.0000e-03.
Epoch   840: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1060: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1280: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2017-03-07 SH600000   -0.018038
           SH600008   -0.057302
           SH600009    0.056582
           SH600010   -0.051702
           SH600015    0.023112
Epoch   640: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1040: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1260: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1480: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1700: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2017-04-06 SH600000    0.014735
           SH600008   -0.134059
           SH600009   -0.018831
           SH600010    0.002752
           SH600015   -0.017675
Epoch   700: reducing learning rate of group 0 to 1.0000e-03.
Epoch   920: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1140: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1360: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1580: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2017-05-05 SH600000    0.126526
           SH600008   -0.032318
           SH600009   -0.008220
           SH600010   -0.063404
           SH600015    0.122222
Epoch  1220: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1600: reducing learning rate of group 0 to 5.0000e-04.
Epoch  2080: reducing learning rate of group 0 to 2.5000e-04.
Epoch  2360: reducing learning rate of group 0 to 1.2500e-04.
Epoch  2780: reducing learning rate of group 0 to 6.2500e-05.
Epoch  3220: reducing learning rate of group 0 to 3.1250e-05.
Epoch  3440: reducing learning rate of group 0 to 1.5625e-05.
Epoch  3660: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2017-06-06 SH600000    0.129410
           SH600008   -0.117589
           SH600009    0.036223
           SH600010    0.075521
           SH600015    0.029670
Epoch   900: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1200: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1420: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1640: reducing learning rate of group 0 to 1.2500e-04.
Epoch  2020: reducing learning rate of group 0 to 6.2500e-05.
Epoch  2240: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2460: reducing learning rate of group 0 to 1.5625e-05.
Epoch  2680: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2017-07-04 SH600000    0.072743
           SH600008   -0.080376
           SH600009    0.101698
           SH600010   -0.001699
           SH600015    0.075570
Epoch   780: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1000: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1220: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1440: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2017-08-01 SH600000    0.102779
           SH600008   -0.051941
           SH600009    0.004922
           SH600010   -0.073080
           SH600015    0.050084
Epoch   840: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1060: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1280: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1500: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2017-08-29 SH600000    0.032767
           SH600008   -0.162681
           SH600009    0.026425
           SH600010    0.081388
           SH600015    0.017857
Epoch   740: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1300: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1660: reducing learning rate of group 0 to 2.5000e-04.
Epoch  2240: reducing learning rate of group 0 to 1.2500e-04.
Epoch  2520: reducing learning rate of group 0 to 6.2500e-05.
Epoch  2740: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2960: reducing learning rate of group 0 to 1.5625e-05.
Epoch  3180: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2017-09-26 SH600000   -0.063772
           SH600008   -0.159186
           SH600009   -0.023864
           SH600010   -0.087445
           SH600015   -0.186411
Epoch   580: reducing learning rate of group 0 to 1.0000e-03.
Epoch   900: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1220: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1440: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1740: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1960: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2180: reducing learning rate of group 0 to 1.5625e-05.
Epoch  2400: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2017-10-31 SH600000   -0.062960
           SH600008   -0.152421
           SH600009    0.026167
           SH600010   -0.020210
           SH600015   -0.022383
Epoch   480: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1180: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1400: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1620: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1840: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2017-11-28 SH600000    0.052171
           SH600008    0.028625
           SH600009    0.015289
           SH600010   -0.053611
           SH600015    0.021366
Epoch   460: reducing learning rate of group 0 to 1.0000e-03.
[2648869:MainThread](2024-03-27 11:58:55,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.042992, valid_loss 1.188684, train_metric nan, valid_metric 0.119897
[2648869:MainThread](2024-03-27 11:58:56,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.043483, valid_loss 1.187413, train_metric nan, valid_metric 0.119564
[2648869:MainThread](2024-03-27 11:58:56,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.030904, valid_loss 1.188909, train_metric nan, valid_metric 0.120222
[2648869:MainThread](2024-03-27 11:58:56,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.035174, valid_loss 1.190716, train_metric nan, valid_metric 0.122387
[2648869:MainThread](2024-03-27 11:58:56,691) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.044565, valid_loss 1.188198, train_metric nan, valid_metric 0.118884
[2648869:MainThread](2024-03-27 11:58:56,892) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.040597, valid_loss 1.190515, train_metric nan, valid_metric 0.124505
[2648869:MainThread](2024-03-27 11:58:57,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.033242, valid_loss 1.187107, train_metric nan, valid_metric 0.121687
[2648869:MainThread](2024-03-27 11:58:57,296) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.055223, valid_loss 1.190067, train_metric nan, valid_metric 0.117133
[2648869:MainThread](2024-03-27 11:58:57,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.036653, valid_loss 1.187869, train_metric nan, valid_metric 0.124466
[2648869:MainThread](2024-03-27 11:58:57,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.054366, valid_loss 1.188510, train_metric nan, valid_metric 0.122322
[2648869:MainThread](2024-03-27 11:58:57,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.037720, valid_loss 1.187382, train_metric nan, valid_metric 0.124105
[2648869:MainThread](2024-03-27 11:58:58,107) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.044152, valid_loss 1.188764, train_metric nan, valid_metric 0.122489
[2648869:MainThread](2024-03-27 11:58:58,309) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.045065, valid_loss 1.189729, train_metric nan, valid_metric 0.122406
[2648869:MainThread](2024-03-27 11:58:58,510) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.027699, valid_loss 1.190077, train_metric nan, valid_metric 0.126191
[2648869:MainThread](2024-03-27 11:58:58,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.032169, valid_loss 1.187565, train_metric nan, valid_metric 0.126486
[2648869:MainThread](2024-03-27 11:58:58,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.049992, valid_loss 1.187995, train_metric nan, valid_metric 0.124366
[2648869:MainThread](2024-03-27 11:58:59,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.035995, valid_loss 1.187774, train_metric nan, valid_metric 0.125749
[2648869:MainThread](2024-03-27 11:58:59,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.029262, valid_loss 1.187508, train_metric nan, valid_metric 0.126663
[2648869:MainThread](2024-03-27 11:58:59,515) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.052447, valid_loss 1.189240, train_metric nan, valid_metric 0.124829
[2648869:MainThread](2024-03-27 11:58:59,716) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.032406, valid_loss 1.188342, train_metric nan, valid_metric 0.126832
[2648869:MainThread](2024-03-27 11:58:59,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.030575, valid_loss 1.187472, train_metric nan, valid_metric 0.127629
[2648869:MainThread](2024-03-27 11:59:00,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.042293, valid_loss 1.187986, train_metric nan, valid_metric 0.128189
[2648869:MainThread](2024-03-27 11:59:00,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.033513, valid_loss 1.187906, train_metric nan, valid_metric 0.128009
[2648869:MainThread](2024-03-27 11:59:00,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.029314, valid_loss 1.188220, train_metric nan, valid_metric 0.127466
[2648869:MainThread](2024-03-27 11:59:00,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.022357, valid_loss 1.182531, train_metric nan, valid_metric 0.129993
[2648869:MainThread](2024-03-27 11:59:00,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.186144 to 1.182531, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:01,033) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.038981, valid_loss 1.184382, train_metric nan, valid_metric 0.127062
[2648869:MainThread](2024-03-27 11:59:01,238) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.037782, valid_loss 1.188653, train_metric nan, valid_metric 0.124933
[2648869:MainThread](2024-03-27 11:59:01,438) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.046052, valid_loss 1.187799, train_metric nan, valid_metric 0.125550
[2648869:MainThread](2024-03-27 11:59:01,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.033123, valid_loss 1.184552, train_metric nan, valid_metric 0.126033
[2648869:MainThread](2024-03-27 11:59:01,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.035689, valid_loss 1.188746, train_metric nan, valid_metric 0.127176
[2648869:MainThread](2024-03-27 11:59:02,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.044317, valid_loss 1.189092, train_metric nan, valid_metric 0.125082
[2648869:MainThread](2024-03-27 11:59:02,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.057618, valid_loss 1.186437, train_metric nan, valid_metric 0.128915
[2648869:MainThread](2024-03-27 11:59:02,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.045106, valid_loss 1.188359, train_metric nan, valid_metric 0.125819
[2648869:MainThread](2024-03-27 11:59:02,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.039485, valid_loss 1.189359, train_metric nan, valid_metric 0.123363
[2648869:MainThread](2024-03-27 11:59:02,842) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.034582, valid_loss 1.189631, train_metric nan, valid_metric 0.121986
[2648869:MainThread](2024-03-27 11:59:03,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.029925, valid_loss 1.188673, train_metric nan, valid_metric 0.126409
[2648869:MainThread](2024-03-27 11:59:03,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.030386, valid_loss 1.190097, train_metric nan, valid_metric 0.125566
[2648869:MainThread](2024-03-27 11:59:03,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.049426, valid_loss 1.187207, train_metric nan, valid_metric 0.127285
[2648869:MainThread](2024-03-27 11:59:03,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.041421, valid_loss 1.187726, train_metric nan, valid_metric 0.120623
[2648869:MainThread](2024-03-27 11:59:03,877) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.041312, valid_loss 1.188581, train_metric nan, valid_metric 0.120302
[2648869:MainThread](2024-03-27 11:59:04,079) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.041555, valid_loss 1.186794, train_metric nan, valid_metric 0.124565
[2648869:MainThread](2024-03-27 11:59:04,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.026891, valid_loss 1.187876, train_metric nan, valid_metric 0.124295
[2648869:MainThread](2024-03-27 11:59:04,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.043600, valid_loss 1.188573, train_metric nan, valid_metric 0.123600
[2648869:MainThread](2024-03-27 11:59:04,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.037140, valid_loss 1.190765, train_metric nan, valid_metric 0.123418
[2648869:MainThread](2024-03-27 11:59:04,881) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.039821, valid_loss 1.188581, train_metric nan, valid_metric 0.128145
[2648869:MainThread](2024-03-27 11:59:05,082) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.032700, valid_loss 1.189674, train_metric nan, valid_metric 0.126842
[2648869:MainThread](2024-03-27 11:59:05,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.040457, valid_loss 1.189274, train_metric nan, valid_metric 0.126937
[2648869:MainThread](2024-03-27 11:59:05,484) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.039756, valid_loss 1.186059, train_metric nan, valid_metric 0.126915
[2648869:MainThread](2024-03-27 11:59:05,684) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.035286, valid_loss 1.185264, train_metric nan, valid_metric 0.126611
[2648869:MainThread](2024-03-27 11:59:05,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.047987, valid_loss 1.189168, train_metric nan, valid_metric 0.125500
[2648869:MainThread](2024-03-27 11:59:06,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.040404, valid_loss 1.187652, train_metric nan, valid_metric 0.124839
[2648869:MainThread](2024-03-27 11:59:06,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.051246, valid_loss 1.187327, train_metric nan, valid_metric 0.124919
[2648869:MainThread](2024-03-27 11:59:06,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.046862, valid_loss 1.188743, train_metric nan, valid_metric 0.125224
[2648869:MainThread](2024-03-27 11:59:06,702) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.033431, valid_loss 1.190274, train_metric nan, valid_metric 0.123616
[2648869:MainThread](2024-03-27 11:59:06,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.039777, valid_loss 1.187665, train_metric nan, valid_metric 0.127242
[2648869:MainThread](2024-03-27 11:59:07,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.033205, valid_loss 1.188995, train_metric nan, valid_metric 0.126582
[2648869:MainThread](2024-03-27 11:59:07,310) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.048097, valid_loss 1.188867, train_metric nan, valid_metric 0.125282
[2648869:MainThread](2024-03-27 11:59:07,511) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.024869, valid_loss 1.187813, train_metric nan, valid_metric 0.125454
[2648869:MainThread](2024-03-27 11:59:07,712) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.040415, valid_loss 1.186377, train_metric nan, valid_metric 0.124405
[2648869:MainThread](2024-03-27 11:59:07,914) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.033234, valid_loss 1.187092, train_metric nan, valid_metric 0.123075
[2648869:MainThread](2024-03-27 11:59:08,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.029916, valid_loss 1.189452, train_metric nan, valid_metric 0.125079
[2648869:MainThread](2024-03-27 11:59:08,322) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.028881, valid_loss 1.188135, train_metric nan, valid_metric 0.125346
[2648869:MainThread](2024-03-27 11:59:08,528) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.043440, valid_loss 1.187517, train_metric nan, valid_metric 0.127065
[2648869:MainThread](2024-03-27 11:59:08,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.036185, valid_loss 1.189562, train_metric nan, valid_metric 0.125066
[2648869:MainThread](2024-03-27 11:59:08,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.040519, valid_loss 1.188096, train_metric nan, valid_metric 0.126216
[2648869:MainThread](2024-03-27 11:59:09,130) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.032467, valid_loss 1.188156, train_metric nan, valid_metric 0.125967
[2648869:MainThread](2024-03-27 11:59:09,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.042846, valid_loss 1.186901, train_metric nan, valid_metric 0.122571
[2648869:MainThread](2024-03-27 11:59:09,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.039009, valid_loss 1.187921, train_metric nan, valid_metric 0.123843
[2648869:MainThread](2024-03-27 11:59:09,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.036367, valid_loss 1.186929, train_metric nan, valid_metric 0.127327
[2648869:MainThread](2024-03-27 11:59:09,937) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.031471, valid_loss 1.187363, train_metric nan, valid_metric 0.124539
[2648869:MainThread](2024-03-27 11:59:10,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.032781, valid_loss 1.188628, train_metric nan, valid_metric 0.124966
[2648869:MainThread](2024-03-27 11:59:10,341) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.040453, valid_loss 1.186298, train_metric nan, valid_metric 0.125333
[2648869:MainThread](2024-03-27 11:59:10,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.042187, valid_loss 1.188867, train_metric nan, valid_metric 0.126174
[2648869:MainThread](2024-03-27 11:59:10,743) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.035560, valid_loss 1.188112, train_metric nan, valid_metric 0.124618
[2648869:MainThread](2024-03-27 11:59:10,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.024455, valid_loss 1.187137, train_metric nan, valid_metric 0.124188
[2648869:MainThread](2024-03-27 11:59:10,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 11:59:11,474) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 11:59:12,038) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  30%|██▉       | 13/44 [06:34<15:40, 30.35s/it][2648869:MainThread](2024-03-27 11:59:12,044) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 11:59:12,055) INFO - qlib.workflow - [recorder.py:341] - Recorder f00332a79e3e4f96b0d57dbf386db4ad starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 11:59:12,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 11:59:12,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 11:59:12,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 11:59:12,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 11:59:14,385) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.395851
            SH600004      1.395851
            SH600006      1.395851
            SH600007      1.395851
            SH600008      1.395851
                            ...   
2016-03-16  SZ300124      0.854765
            SZ300133      0.854765
            SZ300144      0.854765
            SZ300146      0.854765
            SZ300315      0.854765
Length: 494934, dtype: float64
[2648869:MainThread](2024-03-27 11:59:15,258) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2016-03-17  SH600000      0.854765
            SH600008      0.854765
            SH600009      0.854765
            SH600010      0.854765
            SH600011      0.854765
                            ...   
2017-12-25  SZ300124      1.280847
            SZ300136      1.280847
            SZ300144      1.280847
            SZ300251      1.280847
            SZ300315      1.280847
Length: 114309, dtype: float64
[2648869:MainThread](2024-03-27 11:59:15,346) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 11:59:15,838) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.275621, valid_loss 1.263711, train_metric nan, valid_metric 0.066708
[2648869:MainThread](2024-03-27 11:59:15,838) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.263711, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 11:59:16,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.357373, valid_loss 1.284141, train_metric nan, valid_metric 0.051986
[2648869:MainThread](2024-03-27 11:59:16,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.155681, valid_loss 1.261421, train_metric nan, valid_metric 0.079191
[2648869:MainThread](2024-03-27 11:59:16,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.263711 to 1.261421, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:16,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.163518, valid_loss 1.255574, train_metric nan, valid_metric 0.102433
[2648869:MainThread](2024-03-27 11:59:16,390) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.261421 to 1.255574, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:16,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.137143, valid_loss 1.259169, train_metric nan, valid_metric 0.107785
[2648869:MainThread](2024-03-27 11:59:16,771) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.185512, valid_loss 1.259189, train_metric nan, valid_metric 0.094444
[2648869:MainThread](2024-03-27 11:59:16,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.148478, valid_loss 1.266174, train_metric nan, valid_metric 0.060565
[2648869:MainThread](2024-03-27 11:59:17,163) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.211759, valid_loss 1.257290, train_metric nan, valid_metric 0.090164
[2648869:MainThread](2024-03-27 11:59:17,356) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.191774, valid_loss 1.262605, train_metric nan, valid_metric 0.102508
[2648869:MainThread](2024-03-27 11:59:17,550) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.130965, valid_loss 1.257787, train_metric nan, valid_metric 0.097948
[2648869:MainThread](2024-03-27 11:59:17,744) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.151592, valid_loss 1.255883, train_metric nan, valid_metric 0.104618
[2648869:MainThread](2024-03-27 11:59:17,942) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.109292, valid_loss 1.253233, train_metric nan, valid_metric 0.118210
[2648869:MainThread](2024-03-27 11:59:17,942) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.255574 to 1.253233, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:18,146) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.149156, valid_loss 1.254368, train_metric nan, valid_metric 0.112019
[2648869:MainThread](2024-03-27 11:59:18,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.065697, valid_loss 1.257564, train_metric nan, valid_metric 0.108700
[2648869:MainThread](2024-03-27 11:59:18,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.098591, valid_loss 1.254315, train_metric nan, valid_metric 0.111335
[2648869:MainThread](2024-03-27 11:59:18,747) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.064477, valid_loss 1.261774, train_metric nan, valid_metric 0.118596
[2648869:MainThread](2024-03-27 11:59:18,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.061479, valid_loss 1.256382, train_metric nan, valid_metric 0.115313
[2648869:MainThread](2024-03-27 11:59:19,153) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.140123, valid_loss 1.261807, train_metric nan, valid_metric 0.118415
[2648869:MainThread](2024-03-27 11:59:19,359) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.076717, valid_loss 1.256366, train_metric nan, valid_metric 0.101561
[2648869:MainThread](2024-03-27 11:59:19,555) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.093023, valid_loss 1.255834, train_metric nan, valid_metric 0.108950
[2648869:MainThread](2024-03-27 11:59:19,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.097164, valid_loss 1.252111, train_metric nan, valid_metric 0.124199
[2648869:MainThread](2024-03-27 11:59:19,754) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.253233 to 1.252111, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:19,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.103191, valid_loss 1.251777, train_metric nan, valid_metric 0.109380
[2648869:MainThread](2024-03-27 11:59:19,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.252111 to 1.251777, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:20,158) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.101104, valid_loss 1.261533, train_metric nan, valid_metric 0.105603
[2648869:MainThread](2024-03-27 11:59:20,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.071971, valid_loss 1.256060, train_metric nan, valid_metric 0.113038
[2648869:MainThread](2024-03-27 11:59:20,564) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.063739, valid_loss 1.256223, train_metric nan, valid_metric 0.115833
[2648869:MainThread](2024-03-27 11:59:20,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.069011, valid_loss 1.257290, train_metric nan, valid_metric 0.101359
[2648869:MainThread](2024-03-27 11:59:21,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.072768, valid_loss 1.256862, train_metric nan, valid_metric 0.105249
[2648869:MainThread](2024-03-27 11:59:21,234) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.073317, valid_loss 1.258279, train_metric nan, valid_metric 0.098503
[2648869:MainThread](2024-03-27 11:59:21,440) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.074833, valid_loss 1.255813, train_metric nan, valid_metric 0.118942
[2648869:MainThread](2024-03-27 11:59:21,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.059354, valid_loss 1.254561, train_metric nan, valid_metric 0.114886
[2648869:MainThread](2024-03-27 11:59:21,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.075255, valid_loss 1.256709, train_metric nan, valid_metric 0.127280
[2648869:MainThread](2024-03-27 11:59:22,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.053275, valid_loss 1.253147, train_metric nan, valid_metric 0.128012
[2648869:MainThread](2024-03-27 11:59:22,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.058606, valid_loss 1.254271, train_metric nan, valid_metric 0.108968
[2648869:MainThread](2024-03-27 11:59:22,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.036974, valid_loss 1.253250, train_metric nan, valid_metric 0.122921
[2648869:MainThread](2024-03-27 11:59:22,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.053735, valid_loss 1.250845, train_metric nan, valid_metric 0.120293
[2648869:MainThread](2024-03-27 11:59:22,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.251777 to 1.250845, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:22,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.054485, valid_loss 1.252586, train_metric nan, valid_metric 0.115994
[2648869:MainThread](2024-03-27 11:59:23,059) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.030626, valid_loss 1.255012, train_metric nan, valid_metric 0.122958
[2648869:MainThread](2024-03-27 11:59:23,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.059336, valid_loss 1.254980, train_metric nan, valid_metric 0.112284
[2648869:MainThread](2024-03-27 11:59:23,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.051139, valid_loss 1.253532, train_metric nan, valid_metric 0.120322
[2648869:MainThread](2024-03-27 11:59:23,669) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.049896, valid_loss 1.249377, train_metric nan, valid_metric 0.124609
[2648869:MainThread](2024-03-27 11:59:23,669) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.250845 to 1.249377, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:23,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.042866, valid_loss 1.250477, train_metric nan, valid_metric 0.125182
[2648869:MainThread](2024-03-27 11:59:24,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.055908, valid_loss 1.254105, train_metric nan, valid_metric 0.122409
[2648869:MainThread](2024-03-27 11:59:24,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.066213, valid_loss 1.254095, train_metric nan, valid_metric 0.122513
[2648869:MainThread](2024-03-27 11:59:24,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.040562, valid_loss 1.253932, train_metric nan, valid_metric 0.118705
[2648869:MainThread](2024-03-27 11:59:24,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.044094, valid_loss 1.249409, train_metric nan, valid_metric 0.127993
[2648869:MainThread](2024-03-27 11:59:24,899) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.063575, valid_loss 1.250560, train_metric nan, valid_metric 0.121703
[2648869:MainThread](2024-03-27 11:59:25,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.045782, valid_loss 1.251104, train_metric nan, valid_metric 0.124183
[2648869:MainThread](2024-03-27 11:59:25,316) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.053641, valid_loss 1.252965, train_metric nan, valid_metric 0.121243
[2648869:MainThread](2024-03-27 11:59:25,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.063472, valid_loss 1.251655, train_metric nan, valid_metric 0.125117
[2648869:MainThread](2024-03-27 11:59:25,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.052412, valid_loss 1.254594, train_metric nan, valid_metric 0.120781
[2648869:MainThread](2024-03-27 11:59:25,936) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.056216, valid_loss 1.255074, train_metric nan, valid_metric 0.120618
[2648869:MainThread](2024-03-27 11:59:26,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.050569, valid_loss 1.253093, train_metric nan, valid_metric 0.123537
[2648869:MainThread](2024-03-27 11:59:26,340) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.041444, valid_loss 1.252177, train_metric nan, valid_metric 0.126651
[2648869:MainThread](2024-03-27 11:59:26,545) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.039311, valid_loss 1.253339, train_metric nan, valid_metric 0.126843
[2648869:MainThread](2024-03-27 11:59:26,754) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.036284, valid_loss 1.251490, train_metric nan, valid_metric 0.123538
[2648869:MainThread](2024-03-27 11:59:26,953) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.039045, valid_loss 1.250726, train_metric nan, valid_metric 0.123214
[2648869:MainThread](2024-03-27 11:59:27,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.070219, valid_loss 1.254632, train_metric nan, valid_metric 0.118897
[2648869:MainThread](2024-03-27 11:59:27,356) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.033502, valid_loss 1.251959, train_metric nan, valid_metric 0.121129
[2648869:MainThread](2024-03-27 11:59:27,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.031079, valid_loss 1.248523, train_metric nan, valid_metric 0.124328
[2648869:MainThread](2024-03-27 11:59:27,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.249377 to 1.248523, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:27,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.037665, valid_loss 1.251100, train_metric nan, valid_metric 0.125078
[2648869:MainThread](2024-03-27 11:59:27,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.038601, valid_loss 1.254197, train_metric nan, valid_metric 0.119741
[2648869:MainThread](2024-03-27 11:59:28,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.041500, valid_loss 1.252943, train_metric nan, valid_metric 0.124002
[2648869:MainThread](2024-03-27 11:59:28,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.038047, valid_loss 1.251591, train_metric nan, valid_metric 0.125526
[2648869:MainThread](2024-03-27 11:59:28,581) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.035056, valid_loss 1.254264, train_metric nan, valid_metric 0.119702
[2648869:MainThread](2024-03-27 11:59:28,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.034607, valid_loss 1.251693, train_metric nan, valid_metric 0.122449
[2648869:MainThread](2024-03-27 11:59:28,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.037722, valid_loss 1.252972, train_metric nan, valid_metric 0.120562
[2648869:MainThread](2024-03-27 11:59:29,183) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.056212, valid_loss 1.252934, train_metric nan, valid_metric 0.123721
[2648869:MainThread](2024-03-27 11:59:29,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.042426, valid_loss 1.253847, train_metric nan, valid_metric 0.120312
[2648869:MainThread](2024-03-27 11:59:29,591) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.040824, valid_loss 1.252363, train_metric nan, valid_metric 0.124466
[2648869:MainThread](2024-03-27 11:59:29,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.048840, valid_loss 1.252651, train_metric nan, valid_metric 0.123253
[2648869:MainThread](2024-03-27 11:59:29,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.048016, valid_loss 1.253864, train_metric nan, valid_metric 0.124206
[2648869:MainThread](2024-03-27 11:59:30,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.041098, valid_loss 1.249043, train_metric nan, valid_metric 0.125672
[2648869:MainThread](2024-03-27 11:59:30,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.038384, valid_loss 1.251103, train_metric nan, valid_metric 0.123875
[2648869:MainThread](2024-03-27 11:59:30,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.026628, valid_loss 1.254930, train_metric nan, valid_metric 0.124163
[2648869:MainThread](2024-03-27 11:59:30,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.037756, valid_loss 1.252890, train_metric nan, valid_metric 0.122901
[2648869:MainThread](2024-03-27 11:59:31,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.034150, valid_loss 1.249215, train_metric nan, valid_metric 0.123040
[2648869:MainThread](2024-03-27 11:59:31,233) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.035920, valid_loss 1.252551, train_metric nan, valid_metric 0.125897
[2648869:MainThread](2024-03-27 11:59:31,438) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.055736, valid_loss 1.251308, train_metric nan, valid_metric 0.123192
[2648869:MainThread](2024-03-27 11:59:31,643) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.043642, valid_loss 1.252404, train_metric nan, valid_metric 0.124129
[2648869:MainThread](2024-03-27 11:59:31,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.034665, valid_loss 1.249629, train_metric nan, valid_metric 0.127257
[2648869:MainThread](2024-03-27 11:59:32,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.019451, valid_loss 1.246509, train_metric nan, valid_metric 0.128824
[2648869:MainThread](2024-03-27 11:59:32,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.248523 to 1.246509, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:32,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.028080, valid_loss 1.248717, train_metric nan, valid_metric 0.127105
[2648869:MainThread](2024-03-27 11:59:32,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.029208, valid_loss 1.249584, train_metric nan, valid_metric 0.126096
[2648869:MainThread](2024-03-27 11:59:32,672) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.038038, valid_loss 1.249431, train_metric nan, valid_metric 0.127006
[2648869:MainThread](2024-03-27 11:59:32,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.050188, valid_loss 1.253280, train_metric nan, valid_metric 0.123872
[2648869:MainThread](2024-03-27 11:59:33,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.041073, valid_loss 1.252708, train_metric nan, valid_metric 0.125210
[2648869:MainThread](2024-03-27 11:59:33,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.041920, valid_loss 1.251992, train_metric nan, valid_metric 0.125471
[2648869:MainThread](2024-03-27 11:59:33,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.035093, valid_loss 1.249527, train_metric nan, valid_metric 0.125853
[2648869:MainThread](2024-03-27 11:59:33,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.035416, valid_loss 1.251342, train_metric nan, valid_metric 0.124729
[2648869:MainThread](2024-03-27 11:59:33,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.046777, valid_loss 1.252608, train_metric nan, valid_metric 0.121537
[2648869:MainThread](2024-03-27 11:59:34,238) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.048249, valid_loss 1.252799, train_metric nan, valid_metric 0.121045
[2648869:MainThread](2024-03-27 11:59:34,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.036491, valid_loss 1.251429, train_metric nan, valid_metric 0.125276
[2648869:MainThread](2024-03-27 11:59:34,726) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.041978, valid_loss 1.251473, train_metric nan, valid_metric 0.123467
[2648869:MainThread](2024-03-27 11:59:34,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.036963, valid_loss 1.249129, train_metric nan, valid_metric 0.123752
[2648869:MainThread](2024-03-27 11:59:35,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.034579, valid_loss 1.250605, train_metric nan, valid_metric 0.122145
[2648869:MainThread](2024-03-27 11:59:35,346) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.019041, valid_loss 1.249338, train_metric nan, valid_metric 0.125455
[2648869:MainThread](2024-03-27 11:59:35,550) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.031818, valid_loss 1.253338, train_metric nan, valid_metric 0.122201
[2648869:MainThread](2024-03-27 11:59:35,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.033950, valid_loss 1.248073, train_metric nan, valid_metric 0.126620
[2648869:MainThread](2024-03-27 11:59:35,957) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.041325, valid_loss 1.250252, train_metric nan, valid_metric 0.125433
[2648869:MainThread](2024-03-27 11:59:36,161) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.039886, valid_loss 1.253278, train_metric nan, valid_metric 0.124652
[2648869:MainThread](2024-03-27 11:59:36,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.039418, valid_loss 1.255285, train_metric nan, valid_metric 0.120467
[2648869:MainThread](2024-03-27 11:59:36,567) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.027736, valid_loss 1.252057, train_metric nan, valid_metric 0.126024
[2648869:MainThread](2024-03-27 11:59:36,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.035982, valid_loss 1.249830, train_metric nan, valid_metric 0.125534
[2648869:MainThread](2024-03-27 11:59:36,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.028783, valid_loss 1.248832, train_metric nan, valid_metric 0.125776
[2648869:MainThread](2024-03-27 11:59:37,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.028839, valid_loss 1.251788, train_metric nan, valid_metric 0.123751
[2648869:MainThread](2024-03-27 11:59:37,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.032467, valid_loss 1.252731, train_metric nan, valid_metric 0.124215
[2648869:MainThread](2024-03-27 11:59:37,583) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.044811, valid_loss 1.251614, train_metric nan, valid_metric 0.125898
[2648869:MainThread](2024-03-27 11:59:37,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.025405, valid_loss 1.251285, train_metric nan, valid_metric 0.126017
[2648869:MainThread](2024-03-27 11:59:37,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.033047, valid_loss 1.250445, train_metric nan, valid_metric 0.125825
[2648869:MainThread](2024-03-27 11:59:38,196) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.027688, valid_loss 1.250505, train_metric nan, valid_metric 0.126882
[2648869:MainThread](2024-03-27 11:59:38,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.030375, valid_loss 1.252264, train_metric nan, valid_metric 0.125629
[2648869:MainThread](2024-03-27 11:59:38,612) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.034299, valid_loss 1.249926, train_metric nan, valid_metric 0.125423
[2648869:MainThread](2024-03-27 11:59:38,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.020857, valid_loss 1.248963, train_metric nan, valid_metric 0.127858
[2648869:MainThread](2024-03-27 11:59:39,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.033491, valid_loss 1.252739, train_metric nan, valid_metric 0.127111
[2648869:MainThread](2024-03-27 11:59:39,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.037591, valid_loss 1.250019, train_metric nan, valid_metric 0.127723
[2648869:MainThread](2024-03-27 11:59:39,426) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.027977, valid_loss 1.248038, train_metric nan, valid_metric 0.125991
[2648869:MainThread](2024-03-27 11:59:39,629) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 1.038397, valid_loss 1.252759, train_metric nan, valid_metric 0.126725
[2648869:MainThread](2024-03-27 11:59:39,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 1.036351, valid_loss 1.253011, train_metric nan, valid_metric 0.125339
[2648869:MainThread](2024-03-27 11:59:40,034) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 1.041154, valid_loss 1.252542, train_metric nan, valid_metric 0.127994
[2648869:MainThread](2024-03-27 11:59:40,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 1.032188, valid_loss 1.249362, train_metric nan, valid_metric 0.127528
[2648869:MainThread](2024-03-27 11:59:40,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 1.046995, valid_loss 1.252664, train_metric nan, valid_metric 0.124093
[2648869:MainThread](2024-03-27 11:59:40,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 1.028935, valid_loss 1.249609, train_metric nan, valid_metric 0.127189
[2648869:MainThread](2024-03-27 11:59:40,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 1.045446, valid_loss 1.252527, train_metric nan, valid_metric 0.126902
[2648869:MainThread](2024-03-27 11:59:41,043) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 1.040038, valid_loss 1.251199, train_metric nan, valid_metric 0.126875
[2648869:MainThread](2024-03-27 11:59:41,251) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 1.049788, valid_loss 1.251029, train_metric nan, valid_metric 0.127052
[2648869:MainThread](2024-03-27 11:59:41,453) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 1.043289, valid_loss 1.253259, train_metric nan, valid_metric 0.126559
[2648869:MainThread](2024-03-27 11:59:41,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 1.029883, valid_loss 1.250235, train_metric nan, valid_metric 0.126624
[2648869:MainThread](2024-03-27 11:59:41,856) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 1.045344, valid_loss 1.249397, train_metric nan, valid_metric 0.125500
[2648869:MainThread](2024-03-27 11:59:42,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 1.042295, valid_loss 1.251957, train_metric nan, valid_metric 0.126949
[2648869:MainThread](2024-03-27 11:59:42,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 1.030133, valid_loss 1.250413, train_metric nan, valid_metric 0.127425
[2648869:MainThread](2024-03-27 11:59:42,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 1.033464, valid_loss 1.253171, train_metric nan, valid_metric 0.128425
[2648869:MainThread](2024-03-27 11:59:42,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 11:59:43,123) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 11:59:43,779) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  32%|███▏      | 14/44 [07:05<15:23, 30.77s/it][2648869:MainThread](2024-03-27 11:59:43,786) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 11:59:43,797) INFO - qlib.workflow - [recorder.py:341] - Recorder 3811c7bbaf48479e8682937852766ff3 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 11:59:44,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 11:59:44,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 11:59:44,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 11:59:44,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 11:59:46,082) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.979741
            SH600004      0.979741
            SH600006      0.979741
            SH600007      0.979741
            SH600008      0.979741
                            ...   
2016-04-14  SZ300124      1.325327
            SZ300133      1.325327
            SZ300144      1.325327
            SZ300146      1.325327
            SZ300315      1.325327
Length: 499975, dtype: float64
[2648869:MainThread](2024-03-27 11:59:46,990) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2016-04-15  SH600000      1.325327
            SH600008      1.325327
            SH600009      1.325327
            SH600010      1.325327
            SH600011      1.325327
                            ...   
2018-01-23  SZ300124      0.974145
            SZ300136      0.974145
            SZ300144      0.974145
            SZ300251      0.974145
            SZ300315      0.974145
Length: 114726, dtype: float64
[2648869:MainThread](2024-03-27 11:59:47,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 11:59:47,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.292569, valid_loss 1.314009, train_metric nan, valid_metric 0.051647
[2648869:MainThread](2024-03-27 11:59:47,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.314009, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 11:59:47,767) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.114229, valid_loss 1.276636, train_metric nan, valid_metric 0.087017
[2648869:MainThread](2024-03-27 11:59:47,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.314009 to 1.276636, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:47,970) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.135527, valid_loss 1.272593, train_metric nan, valid_metric 0.098200
[2648869:MainThread](2024-03-27 11:59:47,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.276636 to 1.272593, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:48,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.115678, valid_loss 1.268402, train_metric nan, valid_metric 0.104166
[2648869:MainThread](2024-03-27 11:59:48,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.272593 to 1.268402, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:48,376) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.096128, valid_loss 1.268838, train_metric nan, valid_metric 0.106149
[2648869:MainThread](2024-03-27 11:59:48,577) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.079563, valid_loss 1.268859, train_metric nan, valid_metric 0.107354
[2648869:MainThread](2024-03-27 11:59:48,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.117115, valid_loss 1.268471, train_metric nan, valid_metric 0.112766
[2648869:MainThread](2024-03-27 11:59:48,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.081830, valid_loss 1.267329, train_metric nan, valid_metric 0.117882
[2648869:MainThread](2024-03-27 11:59:48,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.268402 to 1.267329, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:49,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.062501, valid_loss 1.267215, train_metric nan, valid_metric 0.112640
[2648869:MainThread](2024-03-27 11:59:49,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.267329 to 1.267215, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:49,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.079908, valid_loss 1.267284, train_metric nan, valid_metric 0.118073
[2648869:MainThread](2024-03-27 11:59:49,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.122303, valid_loss 1.268914, train_metric nan, valid_metric 0.106389
[2648869:MainThread](2024-03-27 11:59:49,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.080993, valid_loss 1.272701, train_metric nan, valid_metric 0.122122
[2648869:MainThread](2024-03-27 11:59:49,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.078348, valid_loss 1.269863, train_metric nan, valid_metric 0.107817
[2648869:MainThread](2024-03-27 11:59:50,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.050736, valid_loss 1.265642, train_metric nan, valid_metric 0.119695
[2648869:MainThread](2024-03-27 11:59:50,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.267215 to 1.265642, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:50,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.068953, valid_loss 1.269379, train_metric nan, valid_metric 0.104453
[2648869:MainThread](2024-03-27 11:59:50,598) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.058047, valid_loss 1.270276, train_metric nan, valid_metric 0.102414
[2648869:MainThread](2024-03-27 11:59:50,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.060807, valid_loss 1.270850, train_metric nan, valid_metric 0.106409
[2648869:MainThread](2024-03-27 11:59:51,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.055396, valid_loss 1.265302, train_metric nan, valid_metric 0.122417
[2648869:MainThread](2024-03-27 11:59:51,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.265642 to 1.265302, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:51,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.038814, valid_loss 1.265574, train_metric nan, valid_metric 0.121605
[2648869:MainThread](2024-03-27 11:59:51,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.038143, valid_loss 1.266358, train_metric nan, valid_metric 0.125674
[2648869:MainThread](2024-03-27 11:59:51,630) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.052726, valid_loss 1.267583, train_metric nan, valid_metric 0.118786
[2648869:MainThread](2024-03-27 11:59:51,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.040805, valid_loss 1.268560, train_metric nan, valid_metric 0.119571
[2648869:MainThread](2024-03-27 11:59:52,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.071712, valid_loss 1.266589, train_metric nan, valid_metric 0.124624
[2648869:MainThread](2024-03-27 11:59:52,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.035349, valid_loss 1.269328, train_metric nan, valid_metric 0.119475
[2648869:MainThread](2024-03-27 11:59:52,453) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.042265, valid_loss 1.267740, train_metric nan, valid_metric 0.123728
[2648869:MainThread](2024-03-27 11:59:52,659) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.022449, valid_loss 1.267989, train_metric nan, valid_metric 0.125402
[2648869:MainThread](2024-03-27 11:59:52,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.026716, valid_loss 1.266653, train_metric nan, valid_metric 0.125917
[2648869:MainThread](2024-03-27 11:59:53,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.033407, valid_loss 1.264411, train_metric nan, valid_metric 0.123530
[2648869:MainThread](2024-03-27 11:59:53,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.265302 to 1.264411, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:53,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.024350, valid_loss 1.264799, train_metric nan, valid_metric 0.122800
[2648869:MainThread](2024-03-27 11:59:53,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.051878, valid_loss 1.264307, train_metric nan, valid_metric 0.124819
[2648869:MainThread](2024-03-27 11:59:53,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.264411 to 1.264307, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:53,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.041860, valid_loss 1.268747, train_metric nan, valid_metric 0.109430
[2648869:MainThread](2024-03-27 11:59:53,895) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.055793, valid_loss 1.268104, train_metric nan, valid_metric 0.123719
[2648869:MainThread](2024-03-27 11:59:54,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.035029, valid_loss 1.266828, train_metric nan, valid_metric 0.126495
[2648869:MainThread](2024-03-27 11:59:54,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.027857, valid_loss 1.267751, train_metric nan, valid_metric 0.124267
[2648869:MainThread](2024-03-27 11:59:54,502) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.026844, valid_loss 1.265916, train_metric nan, valid_metric 0.128251
[2648869:MainThread](2024-03-27 11:59:54,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.016409, valid_loss 1.267026, train_metric nan, valid_metric 0.127619
[2648869:MainThread](2024-03-27 11:59:54,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.037271, valid_loss 1.266461, train_metric nan, valid_metric 0.118973
[2648869:MainThread](2024-03-27 11:59:55,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.028323, valid_loss 1.266275, train_metric nan, valid_metric 0.122239
[2648869:MainThread](2024-03-27 11:59:55,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.032592, valid_loss 1.268350, train_metric nan, valid_metric 0.127002
[2648869:MainThread](2024-03-27 11:59:55,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.023738, valid_loss 1.268271, train_metric nan, valid_metric 0.121728
[2648869:MainThread](2024-03-27 11:59:55,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.018715, valid_loss 1.266095, train_metric nan, valid_metric 0.124862
[2648869:MainThread](2024-03-27 11:59:55,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.006133, valid_loss 1.264025, train_metric nan, valid_metric 0.123804
[2648869:MainThread](2024-03-27 11:59:55,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.264307 to 1.264025, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:56,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.029371, valid_loss 1.265062, train_metric nan, valid_metric 0.125686
[2648869:MainThread](2024-03-27 11:59:56,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.026402, valid_loss 1.266123, train_metric nan, valid_metric 0.124537
[2648869:MainThread](2024-03-27 11:59:56,538) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.009030, valid_loss 1.266447, train_metric nan, valid_metric 0.123056
[2648869:MainThread](2024-03-27 11:59:56,743) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.009864, valid_loss 1.264915, train_metric nan, valid_metric 0.128307
[2648869:MainThread](2024-03-27 11:59:56,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.023192, valid_loss 1.267061, train_metric nan, valid_metric 0.128535
[2648869:MainThread](2024-03-27 11:59:57,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.022943, valid_loss 1.266088, train_metric nan, valid_metric 0.127843
[2648869:MainThread](2024-03-27 11:59:57,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.002515, valid_loss 1.268559, train_metric nan, valid_metric 0.123544
[2648869:MainThread](2024-03-27 11:59:57,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.014764, valid_loss 1.266014, train_metric nan, valid_metric 0.124756
[2648869:MainThread](2024-03-27 11:59:57,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.017385, valid_loss 1.265740, train_metric nan, valid_metric 0.129698
[2648869:MainThread](2024-03-27 11:59:57,967) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.018287, valid_loss 1.265180, train_metric nan, valid_metric 0.127604
[2648869:MainThread](2024-03-27 11:59:58,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.028229, valid_loss 1.265957, train_metric nan, valid_metric 0.126816
[2648869:MainThread](2024-03-27 11:59:58,374) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.031365, valid_loss 1.263822, train_metric nan, valid_metric 0.127102
[2648869:MainThread](2024-03-27 11:59:58,374) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.264025 to 1.263822, save checkpoint.
[2648869:MainThread](2024-03-27 11:59:58,576) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.006842, valid_loss 1.267776, train_metric nan, valid_metric 0.124745
[2648869:MainThread](2024-03-27 11:59:58,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.008783, valid_loss 1.265047, train_metric nan, valid_metric 0.126627
[2648869:MainThread](2024-03-27 11:59:58,976) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.006235, valid_loss 1.266850, train_metric nan, valid_metric 0.130010
[2648869:MainThread](2024-03-27 11:59:59,179) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.010720, valid_loss 1.264698, train_metric nan, valid_metric 0.129494
[2648869:MainThread](2024-03-27 11:59:59,380) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.020082, valid_loss 1.265879, train_metric nan, valid_metric 0.127839
[2648869:MainThread](2024-03-27 11:59:59,583) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.014333, valid_loss 1.265779, train_metric nan, valid_metric 0.126577
[2648869:MainThread](2024-03-27 11:59:59,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.009699, valid_loss 1.266496, train_metric nan, valid_metric 0.129515
[2648869:MainThread](2024-03-27 11:59:59,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.015827, valid_loss 1.268165, train_metric nan, valid_metric 0.126823
[2648869:MainThread](2024-03-27 12:00:00,188) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.027593, valid_loss 1.265920, train_metric nan, valid_metric 0.127666
[2648869:MainThread](2024-03-27 12:00:00,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.014725, valid_loss 1.264994, train_metric nan, valid_metric 0.124423
[2648869:MainThread](2024-03-27 12:00:00,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.005829, valid_loss 1.267217, train_metric nan, valid_metric 0.124254
[2648869:MainThread](2024-03-27 12:00:00,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.006501, valid_loss 1.265419, train_metric nan, valid_metric 0.123753
[2648869:MainThread](2024-03-27 12:00:01,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.013044, valid_loss 1.265637, train_metric nan, valid_metric 0.127854
[2648869:MainThread](2024-03-27 12:00:01,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.009350, valid_loss 1.263871, train_metric nan, valid_metric 0.129731
[2648869:MainThread](2024-03-27 12:00:01,410) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.010409, valid_loss 1.268655, train_metric nan, valid_metric 0.122864
[2648869:MainThread](2024-03-27 12:00:01,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.010390, valid_loss 1.263725, train_metric nan, valid_metric 0.129056
[2648869:MainThread](2024-03-27 12:00:01,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.263822 to 1.263725, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:01,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.011960, valid_loss 1.266095, train_metric nan, valid_metric 0.129723
[2648869:MainThread](2024-03-27 12:00:02,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.023921, valid_loss 1.268797, train_metric nan, valid_metric 0.124669
[2648869:MainThread](2024-03-27 12:00:02,229) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.004289, valid_loss 1.265506, train_metric nan, valid_metric 0.126013
[2648869:MainThread](2024-03-27 12:00:02,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.011524, valid_loss 1.265652, train_metric nan, valid_metric 0.128177
[2648869:MainThread](2024-03-27 12:00:02,638) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.021526, valid_loss 1.264152, train_metric nan, valid_metric 0.129784
[2648869:MainThread](2024-03-27 12:00:02,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.018453, valid_loss 1.265849, train_metric nan, valid_metric 0.128658
[2648869:MainThread](2024-03-27 12:00:03,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.019133, valid_loss 1.264633, train_metric nan, valid_metric 0.128580
[2648869:MainThread](2024-03-27 12:00:03,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.013139, valid_loss 1.267343, train_metric nan, valid_metric 0.127909
[2648869:MainThread](2024-03-27 12:00:03,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.018953, valid_loss 1.266180, train_metric nan, valid_metric 0.128134
[2648869:MainThread](2024-03-27 12:00:03,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.006952, valid_loss 1.264261, train_metric nan, valid_metric 0.129541
[2648869:MainThread](2024-03-27 12:00:03,846) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.017764, valid_loss 1.262755, train_metric nan, valid_metric 0.128158
[2648869:MainThread](2024-03-27 12:00:03,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.263725 to 1.262755, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:04,050) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.010572, valid_loss 1.266624, train_metric nan, valid_metric 0.127259
[2648869:MainThread](2024-03-27 12:00:04,250) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.011434, valid_loss 1.267709, train_metric nan, valid_metric 0.124543
[2648869:MainThread](2024-03-27 12:00:04,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.009867, valid_loss 1.266381, train_metric nan, valid_metric 0.125219
[2648869:MainThread](2024-03-27 12:00:04,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.003503, valid_loss 1.267401, train_metric nan, valid_metric 0.122990
[2648869:MainThread](2024-03-27 12:00:04,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.006282, valid_loss 1.266551, train_metric nan, valid_metric 0.126999
[2648869:MainThread](2024-03-27 12:00:05,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.008874, valid_loss 1.265920, train_metric nan, valid_metric 0.128442
[2648869:MainThread](2024-03-27 12:00:05,257) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.018773, valid_loss 1.266551, train_metric nan, valid_metric 0.128271
[2648869:MainThread](2024-03-27 12:00:05,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.022310, valid_loss 1.265598, train_metric nan, valid_metric 0.130025
[2648869:MainThread](2024-03-27 12:00:05,663) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.012371, valid_loss 1.267075, train_metric nan, valid_metric 0.126179
[2648869:MainThread](2024-03-27 12:00:05,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.011381, valid_loss 1.261245, train_metric nan, valid_metric 0.130287
[2648869:MainThread](2024-03-27 12:00:05,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.262755 to 1.261245, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:06,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.014086, valid_loss 1.266797, train_metric nan, valid_metric 0.128916
[2648869:MainThread](2024-03-27 12:00:06,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.027774, valid_loss 1.266342, train_metric nan, valid_metric 0.130524
[2648869:MainThread](2024-03-27 12:00:06,487) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.016918, valid_loss 1.263975, train_metric nan, valid_metric 0.131857
[2648869:MainThread](2024-03-27 12:00:06,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.005253, valid_loss 1.260971, train_metric nan, valid_metric 0.130192
[2648869:MainThread](2024-03-27 12:00:06,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.261245 to 1.260971, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:06,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.001550, valid_loss 1.263506, train_metric nan, valid_metric 0.130930
[2648869:MainThread](2024-03-27 12:00:07,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.011907, valid_loss 1.264117, train_metric nan, valid_metric 0.127520
[2648869:MainThread](2024-03-27 12:00:07,298) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.003688, valid_loss 1.265500, train_metric nan, valid_metric 0.131207
[2648869:MainThread](2024-03-27 12:00:07,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.015022, valid_loss 1.262335, train_metric nan, valid_metric 0.131045
[2648869:MainThread](2024-03-27 12:00:07,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.005088, valid_loss 1.266390, train_metric nan, valid_metric 0.127357
[2648869:MainThread](2024-03-27 12:00:07,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.024783, valid_loss 1.268155, train_metric nan, valid_metric 0.129617
[2648869:MainThread](2024-03-27 12:00:08,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.017759, valid_loss 1.263928, train_metric nan, valid_metric 0.130657
[2648869:MainThread](2024-03-27 12:00:08,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.017552, valid_loss 1.264980, train_metric nan, valid_metric 0.128919
[2648869:MainThread](2024-03-27 12:00:08,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.002614, valid_loss 1.266645, train_metric nan, valid_metric 0.128235
[2648869:MainThread](2024-03-27 12:00:08,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.007065, valid_loss 1.266168, train_metric nan, valid_metric 0.129321
[2648869:MainThread](2024-03-27 12:00:08,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.014303, valid_loss 1.265015, train_metric nan, valid_metric 0.129241
[2648869:MainThread](2024-03-27 12:00:09,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.010621, valid_loss 1.266356, train_metric nan, valid_metric 0.129435
[2648869:MainThread](2024-03-27 12:00:09,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.008164, valid_loss 1.261686, train_metric nan, valid_metric 0.130674
[2648869:MainThread](2024-03-27 12:00:09,527) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.011821, valid_loss 1.263903, train_metric nan, valid_metric 0.130622
[2648869:MainThread](2024-03-27 12:00:09,733) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.012208, valid_loss 1.263928, train_metric nan, valid_metric 0.129760
[2648869:MainThread](2024-03-27 12:00:09,935) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.017561, valid_loss 1.264929, train_metric nan, valid_metric 0.127695
[2648869:MainThread](2024-03-27 12:00:10,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.014896, valid_loss 1.263389, train_metric nan, valid_metric 0.130450
[2648869:MainThread](2024-03-27 12:00:10,340) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.007127, valid_loss 1.263064, train_metric nan, valid_metric 0.128116
[2648869:MainThread](2024-03-27 12:00:10,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.011396, valid_loss 1.265757, train_metric nan, valid_metric 0.129653
[2648869:MainThread](2024-03-27 12:00:10,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 0.998760, valid_loss 1.266048, train_metric nan, valid_metric 0.128746
[2648869:MainThread](2024-03-27 12:00:10,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.016447, valid_loss 1.263999, train_metric nan, valid_metric 0.129174
[2648869:MainThread](2024-03-27 12:00:11,140) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 1.007319, valid_loss 1.263579, train_metric nan, valid_metric 0.131172
[2648869:MainThread](2024-03-27 12:00:11,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 1.013605, valid_loss 1.263004, train_metric nan, valid_metric 0.129996
[2648869:MainThread](2024-03-27 12:00:11,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 1.006961, valid_loss 1.263674, train_metric nan, valid_metric 0.129141
[2648869:MainThread](2024-03-27 12:00:11,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 1.018536, valid_loss 1.265791, train_metric nan, valid_metric 0.128482
[2648869:MainThread](2024-03-27 12:00:11,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 1.020984, valid_loss 1.265119, train_metric nan, valid_metric 0.130251
[2648869:MainThread](2024-03-27 12:00:12,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 1.000664, valid_loss 1.267947, train_metric nan, valid_metric 0.126704
[2648869:MainThread](2024-03-27 12:00:12,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 1.015897, valid_loss 1.267409, train_metric nan, valid_metric 0.126841
[2648869:MainThread](2024-03-27 12:00:12,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 1.003969, valid_loss 1.266322, train_metric nan, valid_metric 0.128485
[2648869:MainThread](2024-03-27 12:00:12,759) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 1.000879, valid_loss 1.267121, train_metric nan, valid_metric 0.128965
[2648869:MainThread](2024-03-27 12:00:12,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 1.030604, valid_loss 1.270140, train_metric nan, valid_metric 0.126085
[2648869:MainThread](2024-03-27 12:00:13,172) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 1.006535, valid_loss 1.264371, train_metric nan, valid_metric 0.129432
[2648869:MainThread](2024-03-27 12:00:13,378) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 1.016399, valid_loss 1.264337, train_metric nan, valid_metric 0.128054
[2648869:MainThread](2024-03-27 12:00:13,581) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 1.005126, valid_loss 1.265125, train_metric nan, valid_metric 0.126910
[2648869:MainThread](2024-03-27 12:00:13,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 1.017221, valid_loss 1.266301, train_metric nan, valid_metric 0.128011
[2648869:MainThread](2024-03-27 12:00:13,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 1.013175, valid_loss 1.264532, train_metric nan, valid_metric 0.128908
[2648869:MainThread](2024-03-27 12:00:14,191) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 1.016507, valid_loss 1.266571, train_metric nan, valid_metric 0.127560
[2648869:MainThread](2024-03-27 12:00:14,398) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 1.004407, valid_loss 1.265667, train_metric nan, valid_metric 0.128313
[2648869:MainThread](2024-03-27 12:00:14,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 1.017467, valid_loss 1.266038, train_metric nan, valid_metric 0.128864
[2648869:MainThread](2024-03-27 12:00:14,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 1.016509, valid_loss 1.265787, train_metric nan, valid_metric 0.125722
[2648869:MainThread](2024-03-27 12:00:15,004) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 1.010724, valid_loss 1.264466, train_metric nan, valid_metric 0.130756
[2648869:MainThread](2024-03-27 12:00:15,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 1.012411, valid_loss 1.265344, train_metric nan, valid_metric 0.128166
[2648869:MainThread](2024-03-27 12:00:15,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2760]: train_loss 1.002968, valid_loss 1.266277, train_metric nan, valid_metric 0.122456
[2648869:MainThread](2024-03-27 12:00:15,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2780]: train_loss 0.998196, valid_loss 1.263901, train_metric nan, valid_metric 0.126656
[2648869:MainThread](2024-03-27 12:00:15,817) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2800]: train_loss 1.011295, valid_loss 1.268155, train_metric nan, valid_metric 0.124929
[2648869:MainThread](2024-03-27 12:00:16,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2820]: train_loss 1.001524, valid_loss 1.265343, train_metric nan, valid_metric 0.128946
[2648869:MainThread](2024-03-27 12:00:16,223) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2840]: train_loss 1.015125, valid_loss 1.263384, train_metric nan, valid_metric 0.131323
[2648869:MainThread](2024-03-27 12:00:16,426) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2860]: train_loss 1.004337, valid_loss 1.264323, train_metric nan, valid_metric 0.131139
[2648869:MainThread](2024-03-27 12:00:16,629) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2880]: train_loss 1.021638, valid_loss 1.263616, train_metric nan, valid_metric 0.131331
[2648869:MainThread](2024-03-27 12:00:16,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2900]: train_loss 1.001595, valid_loss 1.262938, train_metric nan, valid_metric 0.130040
[2648869:MainThread](2024-03-27 12:00:16,835) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:00:17,491) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:00:18,146) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  34%|███▍      | 15/44 [07:40<15:23, 31.85s/it][2648869:MainThread](2024-03-27 12:00:18,152) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:00:18,163) INFO - qlib.workflow - [recorder.py:341] - Recorder 3b04ea29b8514bfc8b7ea392c97bb0e4 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:00:18,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:00:18,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:00:18,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:00:18,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:00:20,445) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.870674
            SH600004      0.870674
            SH600006      0.870674
            SH600007      0.870674
            SH600008      0.870674
                            ...   
2016-05-13  SZ300124      1.114864
            SZ300133      1.114864
            SZ300144      1.114864
            SZ300146      1.114864
            SZ300315      1.114864
Length: 505000, dtype: float64
[2648869:MainThread](2024-03-27 12:00:21,358) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2016-05-16  SH600000      1.114864
            SH600008      1.114864
            SH600009      1.114864
            SH600010      1.114864
            SH600011      1.114864
                            ...   
2018-02-27  SZ300124      0.667596
            SZ300136      0.667596
            SZ300144      0.667596
            SZ300251      0.667596
            SZ300315      0.667596
Length: 115208, dtype: float64
[2648869:MainThread](2024-03-27 12:00:21,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:00:21,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 2.081132, valid_loss 1.266137, train_metric nan, valid_metric 0.003183
[2648869:MainThread](2024-03-27 12:00:21,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.266137, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:00:22,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.362313, valid_loss 1.200881, train_metric nan, valid_metric 0.033881
[2648869:MainThread](2024-03-27 12:00:22,233) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.266137 to 1.200881, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:22,438) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.276676, valid_loss 1.202431, train_metric nan, valid_metric 0.028129
[2648869:MainThread](2024-03-27 12:00:22,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.277560, valid_loss 1.200275, train_metric nan, valid_metric 0.029250
[2648869:MainThread](2024-03-27 12:00:22,633) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.200881 to 1.200275, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:22,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.167411, valid_loss 1.197962, train_metric nan, valid_metric 0.052915
[2648869:MainThread](2024-03-27 12:00:22,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.200275 to 1.197962, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:23,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.236453, valid_loss 1.191821, train_metric nan, valid_metric 0.046034
[2648869:MainThread](2024-03-27 12:00:23,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.197962 to 1.191821, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:23,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.174086, valid_loss 1.191188, train_metric nan, valid_metric 0.062594
[2648869:MainThread](2024-03-27 12:00:23,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.191821 to 1.191188, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:23,477) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.227754, valid_loss 1.184573, train_metric nan, valid_metric 0.096525
[2648869:MainThread](2024-03-27 12:00:23,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.191188 to 1.184573, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:23,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.109270, valid_loss 1.185214, train_metric nan, valid_metric 0.097432
[2648869:MainThread](2024-03-27 12:00:23,972) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.100187, valid_loss 1.189251, train_metric nan, valid_metric 0.085140
[2648869:MainThread](2024-03-27 12:00:24,220) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.123024, valid_loss 1.187891, train_metric nan, valid_metric 0.072490
[2648869:MainThread](2024-03-27 12:00:24,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.167600, valid_loss 1.194659, train_metric nan, valid_metric 0.078903
[2648869:MainThread](2024-03-27 12:00:24,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.166633, valid_loss 1.187292, train_metric nan, valid_metric 0.086570
[2648869:MainThread](2024-03-27 12:00:24,920) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.127213, valid_loss 1.184327, train_metric nan, valid_metric 0.097545
[2648869:MainThread](2024-03-27 12:00:24,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.184573 to 1.184327, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:25,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.087005, valid_loss 1.188143, train_metric nan, valid_metric 0.076856
[2648869:MainThread](2024-03-27 12:00:25,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.066773, valid_loss 1.192876, train_metric nan, valid_metric 0.093060
[2648869:MainThread](2024-03-27 12:00:25,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.108193, valid_loss 1.184474, train_metric nan, valid_metric 0.097561
[2648869:MainThread](2024-03-27 12:00:25,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.127652, valid_loss 1.184456, train_metric nan, valid_metric 0.100574
[2648869:MainThread](2024-03-27 12:00:25,970) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.095389, valid_loss 1.186777, train_metric nan, valid_metric 0.083141
[2648869:MainThread](2024-03-27 12:00:26,170) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.075850, valid_loss 1.183425, train_metric nan, valid_metric 0.106719
[2648869:MainThread](2024-03-27 12:00:26,171) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.184327 to 1.183425, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:26,374) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.050257, valid_loss 1.184990, train_metric nan, valid_metric 0.105378
[2648869:MainThread](2024-03-27 12:00:26,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.062392, valid_loss 1.182843, train_metric nan, valid_metric 0.112284
[2648869:MainThread](2024-03-27 12:00:26,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.183425 to 1.182843, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:26,778) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.144572, valid_loss 1.182693, train_metric nan, valid_metric 0.110269
[2648869:MainThread](2024-03-27 12:00:26,779) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.182843 to 1.182693, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:26,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.141632, valid_loss 1.186525, train_metric nan, valid_metric 0.090779
[2648869:MainThread](2024-03-27 12:00:27,184) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.100504, valid_loss 1.183026, train_metric nan, valid_metric 0.114345
[2648869:MainThread](2024-03-27 12:00:27,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.107296, valid_loss 1.182092, train_metric nan, valid_metric 0.117443
[2648869:MainThread](2024-03-27 12:00:27,385) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.182693 to 1.182092, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:27,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.061587, valid_loss 1.183785, train_metric nan, valid_metric 0.107368
[2648869:MainThread](2024-03-27 12:00:27,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.063179, valid_loss 1.183868, train_metric nan, valid_metric 0.105441
[2648869:MainThread](2024-03-27 12:00:27,996) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.043683, valid_loss 1.184789, train_metric nan, valid_metric 0.099027
[2648869:MainThread](2024-03-27 12:00:28,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.051462, valid_loss 1.183738, train_metric nan, valid_metric 0.105769
[2648869:MainThread](2024-03-27 12:00:28,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.056293, valid_loss 1.186139, train_metric nan, valid_metric 0.103300
[2648869:MainThread](2024-03-27 12:00:28,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.058616, valid_loss 1.181362, train_metric nan, valid_metric 0.118188
[2648869:MainThread](2024-03-27 12:00:28,615) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.182092 to 1.181362, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:28,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.065870, valid_loss 1.181374, train_metric nan, valid_metric 0.124178
[2648869:MainThread](2024-03-27 12:00:29,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.053781, valid_loss 1.184075, train_metric nan, valid_metric 0.098734
[2648869:MainThread](2024-03-27 12:00:29,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.082366, valid_loss 1.180992, train_metric nan, valid_metric 0.122196
[2648869:MainThread](2024-03-27 12:00:29,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.181362 to 1.180992, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:29,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.051236, valid_loss 1.183428, train_metric nan, valid_metric 0.116038
[2648869:MainThread](2024-03-27 12:00:29,868) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.062889, valid_loss 1.183253, train_metric nan, valid_metric 0.121183
[2648869:MainThread](2024-03-27 12:00:30,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.052991, valid_loss 1.182384, train_metric nan, valid_metric 0.119594
[2648869:MainThread](2024-03-27 12:00:30,371) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.043401, valid_loss 1.182617, train_metric nan, valid_metric 0.119186
[2648869:MainThread](2024-03-27 12:00:30,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.028759, valid_loss 1.182503, train_metric nan, valid_metric 0.123245
[2648869:MainThread](2024-03-27 12:00:30,878) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.028984, valid_loss 1.185035, train_metric nan, valid_metric 0.096308
[2648869:MainThread](2024-03-27 12:00:31,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.054369, valid_loss 1.182089, train_metric nan, valid_metric 0.114242
[2648869:MainThread](2024-03-27 12:00:31,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.046930, valid_loss 1.183540, train_metric nan, valid_metric 0.113528
[2648869:MainThread](2024-03-27 12:00:31,504) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.063118, valid_loss 1.184329, train_metric nan, valid_metric 0.106271
[2648869:MainThread](2024-03-27 12:00:31,709) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.060040, valid_loss 1.184088, train_metric nan, valid_metric 0.107547
[2648869:MainThread](2024-03-27 12:00:31,914) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.026991, valid_loss 1.180040, train_metric nan, valid_metric 0.121174
[2648869:MainThread](2024-03-27 12:00:31,914) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.180992 to 1.180040, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:32,125) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.034891, valid_loss 1.182671, train_metric nan, valid_metric 0.111157
[2648869:MainThread](2024-03-27 12:00:32,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.046963, valid_loss 1.181124, train_metric nan, valid_metric 0.118598
[2648869:MainThread](2024-03-27 12:00:32,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.093603, valid_loss 1.183138, train_metric nan, valid_metric 0.113968
[2648869:MainThread](2024-03-27 12:00:32,746) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.037816, valid_loss 1.185655, train_metric nan, valid_metric 0.108346
[2648869:MainThread](2024-03-27 12:00:32,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.046120, valid_loss 1.184628, train_metric nan, valid_metric 0.118843
[2648869:MainThread](2024-03-27 12:00:33,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.024283, valid_loss 1.180213, train_metric nan, valid_metric 0.127801
[2648869:MainThread](2024-03-27 12:00:33,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.033180, valid_loss 1.181224, train_metric nan, valid_metric 0.121170
[2648869:MainThread](2024-03-27 12:00:33,551) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.048943, valid_loss 1.182563, train_metric nan, valid_metric 0.121571
[2648869:MainThread](2024-03-27 12:00:33,756) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.041997, valid_loss 1.182895, train_metric nan, valid_metric 0.123187
[2648869:MainThread](2024-03-27 12:00:33,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.039456, valid_loss 1.182349, train_metric nan, valid_metric 0.119696
[2648869:MainThread](2024-03-27 12:00:34,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.023123, valid_loss 1.181303, train_metric nan, valid_metric 0.124380
[2648869:MainThread](2024-03-27 12:00:34,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.025371, valid_loss 1.181113, train_metric nan, valid_metric 0.123881
[2648869:MainThread](2024-03-27 12:00:34,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.019024, valid_loss 1.179749, train_metric nan, valid_metric 0.126772
[2648869:MainThread](2024-03-27 12:00:34,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.180040 to 1.179749, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:34,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.025240, valid_loss 1.179076, train_metric nan, valid_metric 0.129495
[2648869:MainThread](2024-03-27 12:00:34,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.179749 to 1.179076, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:34,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.033076, valid_loss 1.179408, train_metric nan, valid_metric 0.132803
[2648869:MainThread](2024-03-27 12:00:35,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.018381, valid_loss 1.179418, train_metric nan, valid_metric 0.128375
[2648869:MainThread](2024-03-27 12:00:35,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.015463, valid_loss 1.182298, train_metric nan, valid_metric 0.122954
[2648869:MainThread](2024-03-27 12:00:35,603) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.033257, valid_loss 1.181812, train_metric nan, valid_metric 0.123157
[2648869:MainThread](2024-03-27 12:00:35,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.012994, valid_loss 1.183469, train_metric nan, valid_metric 0.124179
[2648869:MainThread](2024-03-27 12:00:36,021) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.022197, valid_loss 1.181569, train_metric nan, valid_metric 0.121572
[2648869:MainThread](2024-03-27 12:00:36,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.020954, valid_loss 1.183140, train_metric nan, valid_metric 0.125106
[2648869:MainThread](2024-03-27 12:00:36,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.018908, valid_loss 1.181357, train_metric nan, valid_metric 0.128082
[2648869:MainThread](2024-03-27 12:00:36,635) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.012694, valid_loss 1.181668, train_metric nan, valid_metric 0.123431
[2648869:MainThread](2024-03-27 12:00:36,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.027191, valid_loss 1.183778, train_metric nan, valid_metric 0.112532
[2648869:MainThread](2024-03-27 12:00:37,039) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.022527, valid_loss 1.181262, train_metric nan, valid_metric 0.128437
[2648869:MainThread](2024-03-27 12:00:37,242) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.032934, valid_loss 1.182465, train_metric nan, valid_metric 0.117860
[2648869:MainThread](2024-03-27 12:00:37,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.041625, valid_loss 1.181503, train_metric nan, valid_metric 0.126064
[2648869:MainThread](2024-03-27 12:00:37,646) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.011389, valid_loss 1.180404, train_metric nan, valid_metric 0.127031
[2648869:MainThread](2024-03-27 12:00:37,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.013909, valid_loss 1.181502, train_metric nan, valid_metric 0.122060
[2648869:MainThread](2024-03-27 12:00:38,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.040598, valid_loss 1.182988, train_metric nan, valid_metric 0.122627
[2648869:MainThread](2024-03-27 12:00:38,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.025700, valid_loss 1.182279, train_metric nan, valid_metric 0.119595
[2648869:MainThread](2024-03-27 12:00:38,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.023720, valid_loss 1.184241, train_metric nan, valid_metric 0.114320
[2648869:MainThread](2024-03-27 12:00:38,673) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.030382, valid_loss 1.183433, train_metric nan, valid_metric 0.116836
[2648869:MainThread](2024-03-27 12:00:38,877) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.050805, valid_loss 1.180853, train_metric nan, valid_metric 0.128600
[2648869:MainThread](2024-03-27 12:00:39,079) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.002223, valid_loss 1.180848, train_metric nan, valid_metric 0.123996
[2648869:MainThread](2024-03-27 12:00:39,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.023906, valid_loss 1.182737, train_metric nan, valid_metric 0.121901
[2648869:MainThread](2024-03-27 12:00:39,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.010152, valid_loss 1.183212, train_metric nan, valid_metric 0.119807
[2648869:MainThread](2024-03-27 12:00:39,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.006932, valid_loss 1.179856, train_metric nan, valid_metric 0.128415
[2648869:MainThread](2024-03-27 12:00:39,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.025939, valid_loss 1.181422, train_metric nan, valid_metric 0.124999
[2648869:MainThread](2024-03-27 12:00:40,102) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.015234, valid_loss 1.182845, train_metric nan, valid_metric 0.123584
[2648869:MainThread](2024-03-27 12:00:40,310) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.022665, valid_loss 1.181956, train_metric nan, valid_metric 0.123906
[2648869:MainThread](2024-03-27 12:00:40,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.024264, valid_loss 1.181624, train_metric nan, valid_metric 0.125724
[2648869:MainThread](2024-03-27 12:00:40,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.018980, valid_loss 1.179046, train_metric nan, valid_metric 0.129160
[2648869:MainThread](2024-03-27 12:00:40,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.179076 to 1.179046, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:40,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.008501, valid_loss 1.180757, train_metric nan, valid_metric 0.127306
[2648869:MainThread](2024-03-27 12:00:41,126) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.009706, valid_loss 1.182307, train_metric nan, valid_metric 0.125083
[2648869:MainThread](2024-03-27 12:00:41,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.019935, valid_loss 1.183212, train_metric nan, valid_metric 0.119476
[2648869:MainThread](2024-03-27 12:00:41,530) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.004039, valid_loss 1.181313, train_metric nan, valid_metric 0.128010
[2648869:MainThread](2024-03-27 12:00:41,732) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.025517, valid_loss 1.182551, train_metric nan, valid_metric 0.127881
[2648869:MainThread](2024-03-27 12:00:41,935) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.007497, valid_loss 1.180575, train_metric nan, valid_metric 0.128781
[2648869:MainThread](2024-03-27 12:00:42,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.008771, valid_loss 1.179319, train_metric nan, valid_metric 0.129333
[2648869:MainThread](2024-03-27 12:00:42,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.032500, valid_loss 1.182660, train_metric nan, valid_metric 0.128017
[2648869:MainThread](2024-03-27 12:00:42,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.014258, valid_loss 1.182087, train_metric nan, valid_metric 0.123797
[2648869:MainThread](2024-03-27 12:00:42,746) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.009599, valid_loss 1.180329, train_metric nan, valid_metric 0.128804
[2648869:MainThread](2024-03-27 12:00:42,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.010097, valid_loss 1.183832, train_metric nan, valid_metric 0.120827
[2648869:MainThread](2024-03-27 12:00:43,148) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.013387, valid_loss 1.180950, train_metric nan, valid_metric 0.128121
[2648869:MainThread](2024-03-27 12:00:43,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.012311, valid_loss 1.181242, train_metric nan, valid_metric 0.127301
[2648869:MainThread](2024-03-27 12:00:43,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.013696, valid_loss 1.180535, train_metric nan, valid_metric 0.127476
[2648869:MainThread](2024-03-27 12:00:43,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.007550, valid_loss 1.179562, train_metric nan, valid_metric 0.130097
[2648869:MainThread](2024-03-27 12:00:43,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.011784, valid_loss 1.182664, train_metric nan, valid_metric 0.125153
[2648869:MainThread](2024-03-27 12:00:44,170) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.027401, valid_loss 1.182113, train_metric nan, valid_metric 0.124940
[2648869:MainThread](2024-03-27 12:00:44,371) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.017331, valid_loss 1.182647, train_metric nan, valid_metric 0.126442
[2648869:MainThread](2024-03-27 12:00:44,579) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.025824, valid_loss 1.181571, train_metric nan, valid_metric 0.124721
[2648869:MainThread](2024-03-27 12:00:44,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.019791, valid_loss 1.181220, train_metric nan, valid_metric 0.125678
[2648869:MainThread](2024-03-27 12:00:44,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.025300, valid_loss 1.181682, train_metric nan, valid_metric 0.125027
[2648869:MainThread](2024-03-27 12:00:45,195) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.019138, valid_loss 1.184084, train_metric nan, valid_metric 0.122118
[2648869:MainThread](2024-03-27 12:00:45,400) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.018788, valid_loss 1.181656, train_metric nan, valid_metric 0.125976
[2648869:MainThread](2024-03-27 12:00:45,608) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.012874, valid_loss 1.183344, train_metric nan, valid_metric 0.122992
[2648869:MainThread](2024-03-27 12:00:45,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.015252, valid_loss 1.182067, train_metric nan, valid_metric 0.123410
[2648869:MainThread](2024-03-27 12:00:46,014) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.022143, valid_loss 1.178871, train_metric nan, valid_metric 0.128761
[2648869:MainThread](2024-03-27 12:00:46,015) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.179046 to 1.178871, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:46,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.031291, valid_loss 1.181662, train_metric nan, valid_metric 0.125186
[2648869:MainThread](2024-03-27 12:00:46,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 1.013325, valid_loss 1.181484, train_metric nan, valid_metric 0.126537
[2648869:MainThread](2024-03-27 12:00:46,623) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 1.019111, valid_loss 1.181471, train_metric nan, valid_metric 0.126516
[2648869:MainThread](2024-03-27 12:00:46,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 1.028643, valid_loss 1.182191, train_metric nan, valid_metric 0.123263
[2648869:MainThread](2024-03-27 12:00:47,031) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 1.005357, valid_loss 1.180432, train_metric nan, valid_metric 0.126904
[2648869:MainThread](2024-03-27 12:00:47,233) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 1.011751, valid_loss 1.180824, train_metric nan, valid_metric 0.128554
[2648869:MainThread](2024-03-27 12:00:47,434) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 1.015640, valid_loss 1.181144, train_metric nan, valid_metric 0.127054
[2648869:MainThread](2024-03-27 12:00:47,635) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 1.014106, valid_loss 1.182035, train_metric nan, valid_metric 0.125701
[2648869:MainThread](2024-03-27 12:00:47,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 1.021049, valid_loss 1.181263, train_metric nan, valid_metric 0.124853
[2648869:MainThread](2024-03-27 12:00:48,043) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 1.012014, valid_loss 1.182970, train_metric nan, valid_metric 0.124056
[2648869:MainThread](2024-03-27 12:00:48,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 1.013050, valid_loss 1.181160, train_metric nan, valid_metric 0.127397
[2648869:MainThread](2024-03-27 12:00:48,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 1.025383, valid_loss 1.181075, train_metric nan, valid_metric 0.125562
[2648869:MainThread](2024-03-27 12:00:48,663) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 1.040685, valid_loss 1.181951, train_metric nan, valid_metric 0.125674
[2648869:MainThread](2024-03-27 12:00:48,869) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 1.017652, valid_loss 1.181661, train_metric nan, valid_metric 0.127530
[2648869:MainThread](2024-03-27 12:00:49,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 1.011338, valid_loss 1.181326, train_metric nan, valid_metric 0.124255
[2648869:MainThread](2024-03-27 12:00:49,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 1.037151, valid_loss 1.183385, train_metric nan, valid_metric 0.123151
[2648869:MainThread](2024-03-27 12:00:49,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 1.018781, valid_loss 1.180990, train_metric nan, valid_metric 0.129723
[2648869:MainThread](2024-03-27 12:00:49,678) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 1.028624, valid_loss 1.180622, train_metric nan, valid_metric 0.127202
[2648869:MainThread](2024-03-27 12:00:49,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 1.016089, valid_loss 1.179417, train_metric nan, valid_metric 0.130588
[2648869:MainThread](2024-03-27 12:00:50,079) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 1.004239, valid_loss 1.182144, train_metric nan, valid_metric 0.123172
[2648869:MainThread](2024-03-27 12:00:50,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 1.012280, valid_loss 1.179458, train_metric nan, valid_metric 0.128373
[2648869:MainThread](2024-03-27 12:00:50,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 1.028688, valid_loss 1.179759, train_metric nan, valid_metric 0.126501
[2648869:MainThread](2024-03-27 12:00:50,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2760]: train_loss 1.017236, valid_loss 1.181126, train_metric nan, valid_metric 0.130880
[2648869:MainThread](2024-03-27 12:00:50,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2780]: train_loss 1.016215, valid_loss 1.180721, train_metric nan, valid_metric 0.127667
[2648869:MainThread](2024-03-27 12:00:51,089) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2800]: train_loss 1.002897, valid_loss 1.183880, train_metric nan, valid_metric 0.122203
[2648869:MainThread](2024-03-27 12:00:51,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2820]: train_loss 1.011683, valid_loss 1.181774, train_metric nan, valid_metric 0.122745
[2648869:MainThread](2024-03-27 12:00:51,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2840]: train_loss 1.021612, valid_loss 1.179603, train_metric nan, valid_metric 0.128029
[2648869:MainThread](2024-03-27 12:00:51,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2860]: train_loss 1.009670, valid_loss 1.180789, train_metric nan, valid_metric 0.127942
[2648869:MainThread](2024-03-27 12:00:51,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2880]: train_loss 1.013840, valid_loss 1.179021, train_metric nan, valid_metric 0.128973
[2648869:MainThread](2024-03-27 12:00:52,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2900]: train_loss 1.021818, valid_loss 1.182903, train_metric nan, valid_metric 0.123483
[2648869:MainThread](2024-03-27 12:00:52,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2920]: train_loss 1.023722, valid_loss 1.182122, train_metric nan, valid_metric 0.127030
[2648869:MainThread](2024-03-27 12:00:52,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2940]: train_loss 1.003288, valid_loss 1.182443, train_metric nan, valid_metric 0.127487
[2648869:MainThread](2024-03-27 12:00:52,716) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2960]: train_loss 1.004366, valid_loss 1.181172, train_metric nan, valid_metric 0.128373
[2648869:MainThread](2024-03-27 12:00:52,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2980]: train_loss 1.008298, valid_loss 1.178320, train_metric nan, valid_metric 0.129094
[2648869:MainThread](2024-03-27 12:00:52,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.178871 to 1.178320, save checkpoint.
[2648869:MainThread](2024-03-27 12:00:53,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3000]: train_loss 1.012159, valid_loss 1.181142, train_metric nan, valid_metric 0.127303
[2648869:MainThread](2024-03-27 12:00:53,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3020]: train_loss 1.035920, valid_loss 1.182911, train_metric nan, valid_metric 0.122148
[2648869:MainThread](2024-03-27 12:00:53,526) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3040]: train_loss 1.009731, valid_loss 1.181437, train_metric nan, valid_metric 0.127087
[2648869:MainThread](2024-03-27 12:00:53,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3060]: train_loss 1.021140, valid_loss 1.180654, train_metric nan, valid_metric 0.126154
[2648869:MainThread](2024-03-27 12:00:53,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3080]: train_loss 1.016101, valid_loss 1.182032, train_metric nan, valid_metric 0.129181
[2648869:MainThread](2024-03-27 12:00:54,132) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3100]: train_loss 1.007958, valid_loss 1.183759, train_metric nan, valid_metric 0.127777
[2648869:MainThread](2024-03-27 12:00:54,336) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3120]: train_loss 1.024476, valid_loss 1.182611, train_metric nan, valid_metric 0.123462
[2648869:MainThread](2024-03-27 12:00:54,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3140]: train_loss 1.015844, valid_loss 1.183742, train_metric nan, valid_metric 0.118579
[2648869:MainThread](2024-03-27 12:00:54,744) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3160]: train_loss 1.012119, valid_loss 1.181003, train_metric nan, valid_metric 0.129008
[2648869:MainThread](2024-03-27 12:00:54,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3180]: train_loss 1.012675, valid_loss 1.181396, train_metric nan, valid_metric 0.124641
[2648869:MainThread](2024-03-27 12:00:55,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3200]: train_loss 1.019753, valid_loss 1.181971, train_metric nan, valid_metric 0.123989
[2648869:MainThread](2024-03-27 12:00:55,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3220]: train_loss 1.025663, valid_loss 1.181808, train_metric nan, valid_metric 0.123562
[2648869:MainThread](2024-03-27 12:00:55,561) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3240]: train_loss 1.007961, valid_loss 1.181155, train_metric nan, valid_metric 0.127400
[2648869:MainThread](2024-03-27 12:00:55,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3260]: train_loss 1.032688, valid_loss 1.183615, train_metric nan, valid_metric 0.121502
[2648869:MainThread](2024-03-27 12:00:55,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3280]: train_loss 1.023144, valid_loss 1.181477, train_metric nan, valid_metric 0.126673
[2648869:MainThread](2024-03-27 12:00:56,171) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3300]: train_loss 1.020379, valid_loss 1.180528, train_metric nan, valid_metric 0.126393
[2648869:MainThread](2024-03-27 12:00:56,374) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3320]: train_loss 1.020045, valid_loss 1.180864, train_metric nan, valid_metric 0.127969
[2648869:MainThread](2024-03-27 12:00:56,580) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3340]: train_loss 1.010865, valid_loss 1.183246, train_metric nan, valid_metric 0.123934
[2648869:MainThread](2024-03-27 12:00:56,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3360]: train_loss 1.013156, valid_loss 1.181765, train_metric nan, valid_metric 0.122170
[2648869:MainThread](2024-03-27 12:00:56,985) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3380]: train_loss 1.011027, valid_loss 1.180551, train_metric nan, valid_metric 0.127687
[2648869:MainThread](2024-03-27 12:00:57,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3400]: train_loss 1.012797, valid_loss 1.180997, train_metric nan, valid_metric 0.127081
[2648869:MainThread](2024-03-27 12:00:57,395) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3420]: train_loss 1.019371, valid_loss 1.183764, train_metric nan, valid_metric 0.120752
[2648869:MainThread](2024-03-27 12:00:57,603) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3440]: train_loss 1.009125, valid_loss 1.182098, train_metric nan, valid_metric 0.123202
[2648869:MainThread](2024-03-27 12:00:57,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3460]: train_loss 1.014426, valid_loss 1.183062, train_metric nan, valid_metric 0.125494
[2648869:MainThread](2024-03-27 12:00:58,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3480]: train_loss 1.017233, valid_loss 1.180894, train_metric nan, valid_metric 0.127212
[2648869:MainThread](2024-03-27 12:00:58,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3500]: train_loss 1.024411, valid_loss 1.181600, train_metric nan, valid_metric 0.127830
[2648869:MainThread](2024-03-27 12:00:58,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3520]: train_loss 1.005753, valid_loss 1.181004, train_metric nan, valid_metric 0.128506
[2648869:MainThread](2024-03-27 12:00:58,608) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3540]: train_loss 1.003986, valid_loss 1.180812, train_metric nan, valid_metric 0.127593
[2648869:MainThread](2024-03-27 12:00:58,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3560]: train_loss 1.035954, valid_loss 1.180971, train_metric nan, valid_metric 0.128095
[2648869:MainThread](2024-03-27 12:00:59,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3580]: train_loss 1.028226, valid_loss 1.183632, train_metric nan, valid_metric 0.122606
[2648869:MainThread](2024-03-27 12:00:59,223) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3600]: train_loss 1.017983, valid_loss 1.182490, train_metric nan, valid_metric 0.124477
[2648869:MainThread](2024-03-27 12:00:59,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3620]: train_loss 1.029009, valid_loss 1.182000, train_metric nan, valid_metric 0.126792
[2648869:MainThread](2024-03-27 12:00:59,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3640]: train_loss 1.014385, valid_loss 1.179262, train_metric nan, valid_metric 0.130687
[2648869:MainThread](2024-03-27 12:00:59,835) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3660]: train_loss 1.009450, valid_loss 1.181313, train_metric nan, valid_metric 0.129124
[2648869:MainThread](2024-03-27 12:01:00,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3680]: train_loss 1.007446, valid_loss 1.177957, train_metric nan, valid_metric 0.129201
[2648869:MainThread](2024-03-27 12:01:00,039) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.178320 to 1.177957, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:00,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3700]: train_loss 1.007584, valid_loss 1.181982, train_metric nan, valid_metric 0.124269
[2648869:MainThread](2024-03-27 12:01:00,453) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3720]: train_loss 1.023474, valid_loss 1.183296, train_metric nan, valid_metric 0.121888
[2648869:MainThread](2024-03-27 12:01:00,663) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3740]: train_loss 1.009009, valid_loss 1.182061, train_metric nan, valid_metric 0.125272
[2648869:MainThread](2024-03-27 12:01:00,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3760]: train_loss 1.010998, valid_loss 1.183600, train_metric nan, valid_metric 0.121164
[2648869:MainThread](2024-03-27 12:01:01,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3780]: train_loss 1.021125, valid_loss 1.182557, train_metric nan, valid_metric 0.124551
[2648869:MainThread](2024-03-27 12:01:01,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3800]: train_loss 1.012922, valid_loss 1.180818, train_metric nan, valid_metric 0.127985
[2648869:MainThread](2024-03-27 12:01:01,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3820]: train_loss 1.016567, valid_loss 1.183598, train_metric nan, valid_metric 0.120976
[2648869:MainThread](2024-03-27 12:01:01,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3840]: train_loss 1.036411, valid_loss 1.182368, train_metric nan, valid_metric 0.125414
[2648869:MainThread](2024-03-27 12:01:01,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3860]: train_loss 1.014237, valid_loss 1.180571, train_metric nan, valid_metric 0.127996
[2648869:MainThread](2024-03-27 12:01:02,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3880]: train_loss 1.014629, valid_loss 1.179931, train_metric nan, valid_metric 0.128296
[2648869:MainThread](2024-03-27 12:01:02,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3900]: train_loss 1.017582, valid_loss 1.180907, train_metric nan, valid_metric 0.127468
[2648869:MainThread](2024-03-27 12:01:02,507) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3920]: train_loss 1.010566, valid_loss 1.182175, train_metric nan, valid_metric 0.121593
[2648869:MainThread](2024-03-27 12:01:02,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3940]: train_loss 1.011783, valid_loss 1.178171, train_metric nan, valid_metric 0.129790
[2648869:MainThread](2024-03-27 12:01:02,910) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3960]: train_loss 1.009323, valid_loss 1.182463, train_metric nan, valid_metric 0.124575
[2648869:MainThread](2024-03-27 12:01:03,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3980]: train_loss 1.008871, valid_loss 1.182424, train_metric nan, valid_metric 0.125764
[2648869:MainThread](2024-03-27 12:01:03,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4000]: train_loss 1.016055, valid_loss 1.182600, train_metric nan, valid_metric 0.122016
[2648869:MainThread](2024-03-27 12:01:03,524) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4020]: train_loss 1.014031, valid_loss 1.182768, train_metric nan, valid_metric 0.121622
[2648869:MainThread](2024-03-27 12:01:03,727) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4040]: train_loss 1.013522, valid_loss 1.180324, train_metric nan, valid_metric 0.127086
[2648869:MainThread](2024-03-27 12:01:03,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4060]: train_loss 1.022266, valid_loss 1.179926, train_metric nan, valid_metric 0.128924
[2648869:MainThread](2024-03-27 12:01:04,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4080]: train_loss 1.020017, valid_loss 1.178333, train_metric nan, valid_metric 0.130701
[2648869:MainThread](2024-03-27 12:01:04,340) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4100]: train_loss 1.020406, valid_loss 1.181987, train_metric nan, valid_metric 0.124277
[2648869:MainThread](2024-03-27 12:01:04,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4120]: train_loss 1.021346, valid_loss 1.180156, train_metric nan, valid_metric 0.129595
[2648869:MainThread](2024-03-27 12:01:04,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4140]: train_loss 1.003274, valid_loss 1.181613, train_metric nan, valid_metric 0.126414
[2648869:MainThread](2024-03-27 12:01:04,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4160]: train_loss 1.020999, valid_loss 1.183467, train_metric nan, valid_metric 0.123197
[2648869:MainThread](2024-03-27 12:01:05,158) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4180]: train_loss 1.019994, valid_loss 1.181002, train_metric nan, valid_metric 0.126463
[2648869:MainThread](2024-03-27 12:01:05,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4200]: train_loss 1.008013, valid_loss 1.181701, train_metric nan, valid_metric 0.124391
[2648869:MainThread](2024-03-27 12:01:05,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4220]: train_loss 1.020430, valid_loss 1.183639, train_metric nan, valid_metric 0.123505
[2648869:MainThread](2024-03-27 12:01:05,779) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4240]: train_loss 1.020571, valid_loss 1.179149, train_metric nan, valid_metric 0.130285
[2648869:MainThread](2024-03-27 12:01:05,976) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4260]: train_loss 1.022046, valid_loss 1.179404, train_metric nan, valid_metric 0.129094
[2648869:MainThread](2024-03-27 12:01:06,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4280]: train_loss 1.013682, valid_loss 1.183554, train_metric nan, valid_metric 0.120131
[2648869:MainThread](2024-03-27 12:01:06,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4300]: train_loss 1.023048, valid_loss 1.179961, train_metric nan, valid_metric 0.128022
[2648869:MainThread](2024-03-27 12:01:06,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4320]: train_loss 1.007756, valid_loss 1.178912, train_metric nan, valid_metric 0.128384
[2648869:MainThread](2024-03-27 12:01:06,793) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4340]: train_loss 1.007203, valid_loss 1.180685, train_metric nan, valid_metric 0.127703
[2648869:MainThread](2024-03-27 12:01:06,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4360]: train_loss 1.014355, valid_loss 1.183452, train_metric nan, valid_metric 0.119596
[2648869:MainThread](2024-03-27 12:01:07,203) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4380]: train_loss 1.010461, valid_loss 1.179698, train_metric nan, valid_metric 0.128623
[2648869:MainThread](2024-03-27 12:01:07,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4400]: train_loss 1.008456, valid_loss 1.180776, train_metric nan, valid_metric 0.125749
[2648869:MainThread](2024-03-27 12:01:07,608) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4420]: train_loss 1.018978, valid_loss 1.181997, train_metric nan, valid_metric 0.123382
[2648869:MainThread](2024-03-27 12:01:07,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4440]: train_loss 1.024160, valid_loss 1.180292, train_metric nan, valid_metric 0.127646
[2648869:MainThread](2024-03-27 12:01:08,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4460]: train_loss 1.019233, valid_loss 1.181402, train_metric nan, valid_metric 0.126640
[2648869:MainThread](2024-03-27 12:01:08,213) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4480]: train_loss 1.013437, valid_loss 1.179170, train_metric nan, valid_metric 0.128747
[2648869:MainThread](2024-03-27 12:01:08,415) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4500]: train_loss 1.018959, valid_loss 1.180492, train_metric nan, valid_metric 0.126030
[2648869:MainThread](2024-03-27 12:01:08,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4520]: train_loss 1.027131, valid_loss 1.180628, train_metric nan, valid_metric 0.124188
[2648869:MainThread](2024-03-27 12:01:08,817) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4540]: train_loss 1.014791, valid_loss 1.180485, train_metric nan, valid_metric 0.128060
[2648869:MainThread](2024-03-27 12:01:09,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4560]: train_loss 1.004793, valid_loss 1.180371, train_metric nan, valid_metric 0.127326
[2648869:MainThread](2024-03-27 12:01:09,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4580]: train_loss 1.028875, valid_loss 1.182227, train_metric nan, valid_metric 0.124909
[2648869:MainThread](2024-03-27 12:01:09,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4600]: train_loss 1.012975, valid_loss 1.180412, train_metric nan, valid_metric 0.128213
[2648869:MainThread](2024-03-27 12:01:09,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4620]: train_loss 1.025830, valid_loss 1.181951, train_metric nan, valid_metric 0.128168
[2648869:MainThread](2024-03-27 12:01:09,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4640]: train_loss 1.011705, valid_loss 1.181945, train_metric nan, valid_metric 0.125178
[2648869:MainThread](2024-03-27 12:01:10,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4660]: train_loss 1.005648, valid_loss 1.180140, train_metric nan, valid_metric 0.126471
[2648869:MainThread](2024-03-27 12:01:10,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4680]: train_loss 1.019225, valid_loss 1.178028, train_metric nan, valid_metric 0.130199
[2648869:MainThread](2024-03-27 12:01:10,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:01:10,887) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:01:11,570) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  36%|███▋      | 16/44 [08:33<17:53, 38.35s/it][2648869:MainThread](2024-03-27 12:01:11,577) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:01:11,589) INFO - qlib.workflow - [recorder.py:341] - Recorder 156afd7f61804e2cb6ee8738b76d8d6b starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:01:12,211) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:01:12,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:01:12,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:01:12,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:01:13,911) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.074196
            SH600004      1.074196
            SH600006      1.074196
            SH600007      1.074196
            SH600008      1.074196
                            ...   
2016-06-14  SZ300124      1.108004
            SZ300133      1.108004
            SZ300144      1.108004
            SZ300146      1.108004
            SZ300315      1.108004
Length: 510142, dtype: float64
[2648869:MainThread](2024-03-27 12:01:14,824) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2016-06-15  SH600000      1.108004
            SH600008      1.108004
            SH600009      1.108004
            SH600010      1.108004
            SH600011      1.108004
                            ...   
2018-03-27  SZ300124      1.031757
            SZ300136      1.031757
            SZ300144      1.031757
            SZ300251      1.031757
            SZ300315      1.031757
Length: 115539, dtype: float64
[2648869:MainThread](2024-03-27 12:01:14,926) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:01:15,410) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.698289, valid_loss 1.095749, train_metric nan, valid_metric 0.033001
[2648869:MainThread](2024-03-27 12:01:15,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.095749, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:01:15,599) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.519135, valid_loss 1.150839, train_metric nan, valid_metric 0.028602
[2648869:MainThread](2024-03-27 12:01:15,799) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.276651, valid_loss 1.096613, train_metric nan, valid_metric 0.052375
[2648869:MainThread](2024-03-27 12:01:16,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.204102, valid_loss 1.102468, train_metric nan, valid_metric 0.036939
[2648869:MainThread](2024-03-27 12:01:16,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.177527, valid_loss 1.095117, train_metric nan, valid_metric 0.016104
[2648869:MainThread](2024-03-27 12:01:16,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.095749 to 1.095117, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:16,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.186845, valid_loss 1.093739, train_metric nan, valid_metric 0.066417
[2648869:MainThread](2024-03-27 12:01:16,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.095117 to 1.093739, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:16,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.275320, valid_loss 1.091246, train_metric nan, valid_metric 0.035256
[2648869:MainThread](2024-03-27 12:01:16,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.093739 to 1.091246, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:16,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.224438, valid_loss 1.088358, train_metric nan, valid_metric 0.050195
[2648869:MainThread](2024-03-27 12:01:16,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.091246 to 1.088358, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:17,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.198607, valid_loss 1.091164, train_metric nan, valid_metric 0.046616
[2648869:MainThread](2024-03-27 12:01:17,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.164825, valid_loss 1.103204, train_metric nan, valid_metric 0.041662
[2648869:MainThread](2024-03-27 12:01:17,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.258896, valid_loss 1.088155, train_metric nan, valid_metric 0.050767
[2648869:MainThread](2024-03-27 12:01:17,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.088358 to 1.088155, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:17,629) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.271174, valid_loss 1.092911, train_metric nan, valid_metric 0.030955
[2648869:MainThread](2024-03-27 12:01:17,830) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.202513, valid_loss 1.087898, train_metric nan, valid_metric 0.085496
[2648869:MainThread](2024-03-27 12:01:17,830) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.088155 to 1.087898, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:18,033) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.122967, valid_loss 1.086170, train_metric nan, valid_metric 0.070158
[2648869:MainThread](2024-03-27 12:01:18,033) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.087898 to 1.086170, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:18,238) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.138455, valid_loss 1.089172, train_metric nan, valid_metric 0.047778
[2648869:MainThread](2024-03-27 12:01:18,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.137134, valid_loss 1.088949, train_metric nan, valid_metric 0.039831
[2648869:MainThread](2024-03-27 12:01:18,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.134089, valid_loss 1.087301, train_metric nan, valid_metric 0.060090
[2648869:MainThread](2024-03-27 12:01:18,842) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.121773, valid_loss 1.087106, train_metric nan, valid_metric 0.073606
[2648869:MainThread](2024-03-27 12:01:19,043) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.172979, valid_loss 1.091723, train_metric nan, valid_metric 0.050797
[2648869:MainThread](2024-03-27 12:01:19,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.188908, valid_loss 1.092827, train_metric nan, valid_metric 0.063891
[2648869:MainThread](2024-03-27 12:01:19,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.128361, valid_loss 1.086391, train_metric nan, valid_metric 0.080136
[2648869:MainThread](2024-03-27 12:01:19,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.099900, valid_loss 1.085030, train_metric nan, valid_metric 0.092172
[2648869:MainThread](2024-03-27 12:01:19,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.086170 to 1.085030, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:19,850) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.123489, valid_loss 1.085562, train_metric nan, valid_metric 0.088403
[2648869:MainThread](2024-03-27 12:01:20,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.124781, valid_loss 1.086666, train_metric nan, valid_metric 0.062901
[2648869:MainThread](2024-03-27 12:01:20,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.088867, valid_loss 1.088443, train_metric nan, valid_metric 0.048572
[2648869:MainThread](2024-03-27 12:01:20,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.124449, valid_loss 1.088395, train_metric nan, valid_metric 0.053967
[2648869:MainThread](2024-03-27 12:01:20,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.122216, valid_loss 1.088868, train_metric nan, valid_metric 0.044742
[2648869:MainThread](2024-03-27 12:01:20,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.148296, valid_loss 1.086370, train_metric nan, valid_metric 0.072923
[2648869:MainThread](2024-03-27 12:01:21,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.093647, valid_loss 1.087652, train_metric nan, valid_metric 0.080396
[2648869:MainThread](2024-03-27 12:01:21,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.090959, valid_loss 1.087023, train_metric nan, valid_metric 0.065823
[2648869:MainThread](2024-03-27 12:01:21,468) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.110365, valid_loss 1.088078, train_metric nan, valid_metric 0.057333
[2648869:MainThread](2024-03-27 12:01:21,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.116412, valid_loss 1.085564, train_metric nan, valid_metric 0.080076
[2648869:MainThread](2024-03-27 12:01:21,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.075444, valid_loss 1.085531, train_metric nan, valid_metric 0.083873
[2648869:MainThread](2024-03-27 12:01:22,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.099748, valid_loss 1.088131, train_metric nan, valid_metric 0.057704
[2648869:MainThread](2024-03-27 12:01:22,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.116219, valid_loss 1.087509, train_metric nan, valid_metric 0.056802
[2648869:MainThread](2024-03-27 12:01:22,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.105685, valid_loss 1.086435, train_metric nan, valid_metric 0.073201
[2648869:MainThread](2024-03-27 12:01:22,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.085408, valid_loss 1.085508, train_metric nan, valid_metric 0.086074
[2648869:MainThread](2024-03-27 12:01:22,898) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.084436, valid_loss 1.085613, train_metric nan, valid_metric 0.078875
[2648869:MainThread](2024-03-27 12:01:23,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.098412, valid_loss 1.084535, train_metric nan, valid_metric 0.094566
[2648869:MainThread](2024-03-27 12:01:23,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.085030 to 1.084535, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:23,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.091366, valid_loss 1.087544, train_metric nan, valid_metric 0.057905
[2648869:MainThread](2024-03-27 12:01:23,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.079101, valid_loss 1.085468, train_metric nan, valid_metric 0.080416
[2648869:MainThread](2024-03-27 12:01:23,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.071393, valid_loss 1.086812, train_metric nan, valid_metric 0.065743
[2648869:MainThread](2024-03-27 12:01:23,928) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.094293, valid_loss 1.088033, train_metric nan, valid_metric 0.053089
[2648869:MainThread](2024-03-27 12:01:24,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.079423, valid_loss 1.086671, train_metric nan, valid_metric 0.063965
[2648869:MainThread](2024-03-27 12:01:24,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.088875, valid_loss 1.085021, train_metric nan, valid_metric 0.083030
[2648869:MainThread](2024-03-27 12:01:24,545) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.074014, valid_loss 1.084768, train_metric nan, valid_metric 0.090022
[2648869:MainThread](2024-03-27 12:01:24,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.077491, valid_loss 1.086416, train_metric nan, valid_metric 0.066726
[2648869:MainThread](2024-03-27 12:01:24,963) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.097116, valid_loss 1.087635, train_metric nan, valid_metric 0.050382
[2648869:MainThread](2024-03-27 12:01:25,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.074045, valid_loss 1.086459, train_metric nan, valid_metric 0.065853
[2648869:MainThread](2024-03-27 12:01:25,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.085425, valid_loss 1.085572, train_metric nan, valid_metric 0.075843
[2648869:MainThread](2024-03-27 12:01:25,573) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.079346, valid_loss 1.086040, train_metric nan, valid_metric 0.074276
[2648869:MainThread](2024-03-27 12:01:25,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.087686, valid_loss 1.085354, train_metric nan, valid_metric 0.083257
[2648869:MainThread](2024-03-27 12:01:25,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.066909, valid_loss 1.086457, train_metric nan, valid_metric 0.066867
[2648869:MainThread](2024-03-27 12:01:26,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.082055, valid_loss 1.084620, train_metric nan, valid_metric 0.088934
[2648869:MainThread](2024-03-27 12:01:26,380) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.061724, valid_loss 1.084882, train_metric nan, valid_metric 0.086781
[2648869:MainThread](2024-03-27 12:01:26,579) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.065596, valid_loss 1.085833, train_metric nan, valid_metric 0.077970
[2648869:MainThread](2024-03-27 12:01:26,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.083592, valid_loss 1.085318, train_metric nan, valid_metric 0.082296
[2648869:MainThread](2024-03-27 12:01:26,983) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.075608, valid_loss 1.084400, train_metric nan, valid_metric 0.089895
[2648869:MainThread](2024-03-27 12:01:26,984) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.084535 to 1.084400, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:27,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.057840, valid_loss 1.085159, train_metric nan, valid_metric 0.083534
[2648869:MainThread](2024-03-27 12:01:27,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.067334, valid_loss 1.086010, train_metric nan, valid_metric 0.078003
[2648869:MainThread](2024-03-27 12:01:27,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.062960, valid_loss 1.083799, train_metric nan, valid_metric 0.098655
[2648869:MainThread](2024-03-27 12:01:27,593) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.084400 to 1.083799, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:27,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.071858, valid_loss 1.085570, train_metric nan, valid_metric 0.080651
[2648869:MainThread](2024-03-27 12:01:27,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.073421, valid_loss 1.083412, train_metric nan, valid_metric 0.101744
[2648869:MainThread](2024-03-27 12:01:27,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.083799 to 1.083412, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:28,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.063219, valid_loss 1.084569, train_metric nan, valid_metric 0.090260
[2648869:MainThread](2024-03-27 12:01:28,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.064726, valid_loss 1.084641, train_metric nan, valid_metric 0.090112
[2648869:MainThread](2024-03-27 12:01:28,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.088315, valid_loss 1.085064, train_metric nan, valid_metric 0.086952
[2648869:MainThread](2024-03-27 12:01:28,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.065021, valid_loss 1.085554, train_metric nan, valid_metric 0.076433
[2648869:MainThread](2024-03-27 12:01:29,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.064029, valid_loss 1.083440, train_metric nan, valid_metric 0.104397
[2648869:MainThread](2024-03-27 12:01:29,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.090609, valid_loss 1.085911, train_metric nan, valid_metric 0.075271
[2648869:MainThread](2024-03-27 12:01:29,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.077246, valid_loss 1.085564, train_metric nan, valid_metric 0.077288
[2648869:MainThread](2024-03-27 12:01:29,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.066117, valid_loss 1.084534, train_metric nan, valid_metric 0.093768
[2648869:MainThread](2024-03-27 12:01:29,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.072075, valid_loss 1.086038, train_metric nan, valid_metric 0.068852
[2648869:MainThread](2024-03-27 12:01:30,021) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.085700, valid_loss 1.083192, train_metric nan, valid_metric 0.099977
[2648869:MainThread](2024-03-27 12:01:30,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.083412 to 1.083192, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:30,227) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.072878, valid_loss 1.082481, train_metric nan, valid_metric 0.112796
[2648869:MainThread](2024-03-27 12:01:30,227) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.083192 to 1.082481, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:30,433) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.084023, valid_loss 1.083219, train_metric nan, valid_metric 0.105220
[2648869:MainThread](2024-03-27 12:01:30,641) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.095409, valid_loss 1.084052, train_metric nan, valid_metric 0.099183
[2648869:MainThread](2024-03-27 12:01:30,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.057337, valid_loss 1.085232, train_metric nan, valid_metric 0.083092
[2648869:MainThread](2024-03-27 12:01:31,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.068902, valid_loss 1.084780, train_metric nan, valid_metric 0.087290
[2648869:MainThread](2024-03-27 12:01:31,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.082025, valid_loss 1.084557, train_metric nan, valid_metric 0.097153
[2648869:MainThread](2024-03-27 12:01:31,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.072412, valid_loss 1.083446, train_metric nan, valid_metric 0.100428
[2648869:MainThread](2024-03-27 12:01:31,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.084463, valid_loss 1.085175, train_metric nan, valid_metric 0.086577
[2648869:MainThread](2024-03-27 12:01:31,850) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.101100, valid_loss 1.085007, train_metric nan, valid_metric 0.083828
[2648869:MainThread](2024-03-27 12:01:32,050) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.062448, valid_loss 1.086264, train_metric nan, valid_metric 0.073361
[2648869:MainThread](2024-03-27 12:01:32,255) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.079927, valid_loss 1.083824, train_metric nan, valid_metric 0.101862
[2648869:MainThread](2024-03-27 12:01:32,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.070078, valid_loss 1.084604, train_metric nan, valid_metric 0.095036
[2648869:MainThread](2024-03-27 12:01:32,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.066639, valid_loss 1.085117, train_metric nan, valid_metric 0.092234
[2648869:MainThread](2024-03-27 12:01:32,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.064710, valid_loss 1.086272, train_metric nan, valid_metric 0.074367
[2648869:MainThread](2024-03-27 12:01:33,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.069765, valid_loss 1.085154, train_metric nan, valid_metric 0.086067
[2648869:MainThread](2024-03-27 12:01:33,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.061975, valid_loss 1.085245, train_metric nan, valid_metric 0.087786
[2648869:MainThread](2024-03-27 12:01:33,486) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.071561, valid_loss 1.085786, train_metric nan, valid_metric 0.078811
[2648869:MainThread](2024-03-27 12:01:33,690) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.086587, valid_loss 1.085933, train_metric nan, valid_metric 0.080625
[2648869:MainThread](2024-03-27 12:01:33,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.071304, valid_loss 1.084565, train_metric nan, valid_metric 0.092381
[2648869:MainThread](2024-03-27 12:01:34,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.057787, valid_loss 1.085035, train_metric nan, valid_metric 0.092758
[2648869:MainThread](2024-03-27 12:01:34,304) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.053767, valid_loss 1.085125, train_metric nan, valid_metric 0.091506
[2648869:MainThread](2024-03-27 12:01:34,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.067864, valid_loss 1.084900, train_metric nan, valid_metric 0.091638
[2648869:MainThread](2024-03-27 12:01:34,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.068749, valid_loss 1.084051, train_metric nan, valid_metric 0.093047
[2648869:MainThread](2024-03-27 12:01:34,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.070067, valid_loss 1.083301, train_metric nan, valid_metric 0.108991
[2648869:MainThread](2024-03-27 12:01:35,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.057944, valid_loss 1.084901, train_metric nan, valid_metric 0.087701
[2648869:MainThread](2024-03-27 12:01:35,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.072447, valid_loss 1.084929, train_metric nan, valid_metric 0.084675
[2648869:MainThread](2024-03-27 12:01:35,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.075749, valid_loss 1.085176, train_metric nan, valid_metric 0.084188
[2648869:MainThread](2024-03-27 12:01:35,739) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.080641, valid_loss 1.083816, train_metric nan, valid_metric 0.096346
[2648869:MainThread](2024-03-27 12:01:35,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.064748, valid_loss 1.086303, train_metric nan, valid_metric 0.071605
[2648869:MainThread](2024-03-27 12:01:36,149) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.068951, valid_loss 1.084373, train_metric nan, valid_metric 0.099804
[2648869:MainThread](2024-03-27 12:01:36,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.070381, valid_loss 1.084380, train_metric nan, valid_metric 0.095131
[2648869:MainThread](2024-03-27 12:01:36,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.067048, valid_loss 1.083939, train_metric nan, valid_metric 0.093940
[2648869:MainThread](2024-03-27 12:01:36,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.081377, valid_loss 1.084437, train_metric nan, valid_metric 0.093439
[2648869:MainThread](2024-03-27 12:01:36,970) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.069184, valid_loss 1.085425, train_metric nan, valid_metric 0.083349
[2648869:MainThread](2024-03-27 12:01:37,170) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.049223, valid_loss 1.084300, train_metric nan, valid_metric 0.092001
[2648869:MainThread](2024-03-27 12:01:37,371) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.043931, valid_loss 1.084666, train_metric nan, valid_metric 0.089643
[2648869:MainThread](2024-03-27 12:01:37,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.053348, valid_loss 1.084423, train_metric nan, valid_metric 0.093247
[2648869:MainThread](2024-03-27 12:01:37,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.079916, valid_loss 1.085881, train_metric nan, valid_metric 0.079676
[2648869:MainThread](2024-03-27 12:01:37,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.090389, valid_loss 1.084177, train_metric nan, valid_metric 0.099624
[2648869:MainThread](2024-03-27 12:01:38,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.062169, valid_loss 1.084646, train_metric nan, valid_metric 0.093695
[2648869:MainThread](2024-03-27 12:01:38,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.057995, valid_loss 1.086630, train_metric nan, valid_metric 0.066510
[2648869:MainThread](2024-03-27 12:01:38,593) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.075293, valid_loss 1.085393, train_metric nan, valid_metric 0.083113
[2648869:MainThread](2024-03-27 12:01:38,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.064810, valid_loss 1.084444, train_metric nan, valid_metric 0.091714
[2648869:MainThread](2024-03-27 12:01:39,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 1.068197, valid_loss 1.085090, train_metric nan, valid_metric 0.091735
[2648869:MainThread](2024-03-27 12:01:39,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 1.066137, valid_loss 1.083889, train_metric nan, valid_metric 0.103837
[2648869:MainThread](2024-03-27 12:01:39,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 1.076859, valid_loss 1.086310, train_metric nan, valid_metric 0.072711
[2648869:MainThread](2024-03-27 12:01:39,608) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 1.070104, valid_loss 1.084177, train_metric nan, valid_metric 0.098039
[2648869:MainThread](2024-03-27 12:01:39,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 1.062240, valid_loss 1.083755, train_metric nan, valid_metric 0.101664
[2648869:MainThread](2024-03-27 12:01:40,053) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 1.049409, valid_loss 1.085658, train_metric nan, valid_metric 0.079659
[2648869:MainThread](2024-03-27 12:01:40,261) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 1.061434, valid_loss 1.084599, train_metric nan, valid_metric 0.096057
[2648869:MainThread](2024-03-27 12:01:40,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 1.059934, valid_loss 1.084235, train_metric nan, valid_metric 0.101386
[2648869:MainThread](2024-03-27 12:01:40,468) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:01:41,142) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:01:41,841) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  39%|███▊      | 17/44 [09:03<16:09, 35.92s/it][2648869:MainThread](2024-03-27 12:01:41,848) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:01:41,859) INFO - qlib.workflow - [recorder.py:341] - Recorder a7606ea379364b709b27ecba2a199521 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:01:42,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:01:42,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:01:42,484) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:01:42,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:01:44,192) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.186560
            SH600004      1.186560
            SH600006      1.186560
            SH600007      1.186560
            SH600008      1.186560
                            ...   
2016-07-12  SZ300124      1.121046
            SZ300133      1.121046
            SZ300144      1.121046
            SZ300146      1.121046
            SZ300315      1.121046
Length: 515400, dtype: float64
[2648869:MainThread](2024-03-27 12:01:45,078) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2016-07-13  SH600000      1.121046
            SH600008      1.121046
            SH600009      1.121046
            SH600010      1.121046
            SH600011      1.121046
                            ...   
2018-04-26  SZ300124      0.553938
            SZ300136      0.553938
            SZ300144      0.553938
            SZ300251      0.553938
            SZ300315      0.553938
Length: 115756, dtype: float64
[2648869:MainThread](2024-03-27 12:01:45,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:01:45,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.614794, valid_loss 1.124553, train_metric nan, valid_metric 0.049664
[2648869:MainThread](2024-03-27 12:01:45,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.124553, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:01:45,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.317703, valid_loss 1.104579, train_metric nan, valid_metric 0.022883
[2648869:MainThread](2024-03-27 12:01:45,838) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.124553 to 1.104579, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:46,039) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.247779, valid_loss 1.104915, train_metric nan, valid_metric 0.044856
[2648869:MainThread](2024-03-27 12:01:46,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.256719, valid_loss 1.101819, train_metric nan, valid_metric 0.047793
[2648869:MainThread](2024-03-27 12:01:46,287) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.104579 to 1.101819, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:46,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.258626, valid_loss 1.113307, train_metric nan, valid_metric 0.052458
[2648869:MainThread](2024-03-27 12:01:46,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.347067, valid_loss 1.102296, train_metric nan, valid_metric 0.061193
[2648869:MainThread](2024-03-27 12:01:46,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.188472, valid_loss 1.100709, train_metric nan, valid_metric 0.053600
[2648869:MainThread](2024-03-27 12:01:46,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.101819 to 1.100709, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:47,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.270701, valid_loss 1.100884, train_metric nan, valid_metric 0.051483
[2648869:MainThread](2024-03-27 12:01:47,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.196924, valid_loss 1.102872, train_metric nan, valid_metric 0.043226
[2648869:MainThread](2024-03-27 12:01:47,527) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.175827, valid_loss 1.099163, train_metric nan, valid_metric 0.058564
[2648869:MainThread](2024-03-27 12:01:47,527) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.100709 to 1.099163, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:47,782) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.159209, valid_loss 1.100003, train_metric nan, valid_metric 0.078744
[2648869:MainThread](2024-03-27 12:01:48,029) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.192758, valid_loss 1.100232, train_metric nan, valid_metric 0.073603
[2648869:MainThread](2024-03-27 12:01:48,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.131474, valid_loss 1.097350, train_metric nan, valid_metric 0.083641
[2648869:MainThread](2024-03-27 12:01:48,281) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.099163 to 1.097350, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:48,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.196816, valid_loss 1.099322, train_metric nan, valid_metric 0.061762
[2648869:MainThread](2024-03-27 12:01:48,778) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.176285, valid_loss 1.099812, train_metric nan, valid_metric 0.077380
[2648869:MainThread](2024-03-27 12:01:49,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.140850, valid_loss 1.103659, train_metric nan, valid_metric 0.056667
[2648869:MainThread](2024-03-27 12:01:49,275) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.162126, valid_loss 1.100040, train_metric nan, valid_metric 0.054981
[2648869:MainThread](2024-03-27 12:01:49,515) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.165084, valid_loss 1.098770, train_metric nan, valid_metric 0.068876
[2648869:MainThread](2024-03-27 12:01:49,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.103224, valid_loss 1.101498, train_metric nan, valid_metric 0.073833
[2648869:MainThread](2024-03-27 12:01:49,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.117030, valid_loss 1.098017, train_metric nan, valid_metric 0.075202
[2648869:MainThread](2024-03-27 12:01:50,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.119739, valid_loss 1.098671, train_metric nan, valid_metric 0.067762
[2648869:MainThread](2024-03-27 12:01:50,396) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.176770, valid_loss 1.103273, train_metric nan, valid_metric 0.029776
[2648869:MainThread](2024-03-27 12:01:50,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.107911, valid_loss 1.097173, train_metric nan, valid_metric 0.087097
[2648869:MainThread](2024-03-27 12:01:50,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.097350 to 1.097173, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:50,878) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.122737, valid_loss 1.098406, train_metric nan, valid_metric 0.082911
[2648869:MainThread](2024-03-27 12:01:51,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.111736, valid_loss 1.097783, train_metric nan, valid_metric 0.092712
[2648869:MainThread](2024-03-27 12:01:51,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.110244, valid_loss 1.098624, train_metric nan, valid_metric 0.068392
[2648869:MainThread](2024-03-27 12:01:51,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.126709, valid_loss 1.097174, train_metric nan, valid_metric 0.081516
[2648869:MainThread](2024-03-27 12:01:51,799) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.094646, valid_loss 1.097133, train_metric nan, valid_metric 0.091972
[2648869:MainThread](2024-03-27 12:01:51,799) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.097173 to 1.097133, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:52,039) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.100284, valid_loss 1.099893, train_metric nan, valid_metric 0.049009
[2648869:MainThread](2024-03-27 12:01:52,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.114998, valid_loss 1.098220, train_metric nan, valid_metric 0.071151
[2648869:MainThread](2024-03-27 12:01:52,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.161739, valid_loss 1.097379, train_metric nan, valid_metric 0.095384
[2648869:MainThread](2024-03-27 12:01:52,731) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.119205, valid_loss 1.096949, train_metric nan, valid_metric 0.101481
[2648869:MainThread](2024-03-27 12:01:52,732) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.097133 to 1.096949, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:52,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.101113, valid_loss 1.096302, train_metric nan, valid_metric 0.099972
[2648869:MainThread](2024-03-27 12:01:52,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.096949 to 1.096302, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:53,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.101524, valid_loss 1.096614, train_metric nan, valid_metric 0.089334
[2648869:MainThread](2024-03-27 12:01:53,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.075161, valid_loss 1.096982, train_metric nan, valid_metric 0.084286
[2648869:MainThread](2024-03-27 12:01:53,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.081796, valid_loss 1.095881, train_metric nan, valid_metric 0.095220
[2648869:MainThread](2024-03-27 12:01:53,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.096302 to 1.095881, save checkpoint.
[2648869:MainThread](2024-03-27 12:01:53,744) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.087110, valid_loss 1.096766, train_metric nan, valid_metric 0.088958
[2648869:MainThread](2024-03-27 12:01:53,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.121186, valid_loss 1.096498, train_metric nan, valid_metric 0.098180
[2648869:MainThread](2024-03-27 12:01:54,149) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.086172, valid_loss 1.098407, train_metric nan, valid_metric 0.065102
[2648869:MainThread](2024-03-27 12:01:54,350) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.082241, valid_loss 1.099084, train_metric nan, valid_metric 0.077765
[2648869:MainThread](2024-03-27 12:01:54,555) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.067678, valid_loss 1.097325, train_metric nan, valid_metric 0.087203
[2648869:MainThread](2024-03-27 12:01:54,759) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.100285, valid_loss 1.096438, train_metric nan, valid_metric 0.096207
[2648869:MainThread](2024-03-27 12:01:54,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.131253, valid_loss 1.098503, train_metric nan, valid_metric 0.078897
[2648869:MainThread](2024-03-27 12:01:55,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.106605, valid_loss 1.097018, train_metric nan, valid_metric 0.095580
[2648869:MainThread](2024-03-27 12:01:55,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.128394, valid_loss 1.097255, train_metric nan, valid_metric 0.084354
[2648869:MainThread](2024-03-27 12:01:55,564) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.093147, valid_loss 1.095881, train_metric nan, valid_metric 0.101194
[2648869:MainThread](2024-03-27 12:01:55,765) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.079341, valid_loss 1.097810, train_metric nan, valid_metric 0.077050
[2648869:MainThread](2024-03-27 12:01:55,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.082874, valid_loss 1.097111, train_metric nan, valid_metric 0.089664
[2648869:MainThread](2024-03-27 12:01:56,175) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.074870, valid_loss 1.097357, train_metric nan, valid_metric 0.084153
[2648869:MainThread](2024-03-27 12:01:56,375) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.079774, valid_loss 1.097232, train_metric nan, valid_metric 0.079315
[2648869:MainThread](2024-03-27 12:01:56,576) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.079462, valid_loss 1.098023, train_metric nan, valid_metric 0.072491
[2648869:MainThread](2024-03-27 12:01:56,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.089484, valid_loss 1.096849, train_metric nan, valid_metric 0.095221
[2648869:MainThread](2024-03-27 12:01:56,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.080886, valid_loss 1.097487, train_metric nan, valid_metric 0.079729
[2648869:MainThread](2024-03-27 12:01:57,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.085810, valid_loss 1.096931, train_metric nan, valid_metric 0.085222
[2648869:MainThread](2024-03-27 12:01:57,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.083795, valid_loss 1.097735, train_metric nan, valid_metric 0.071877
[2648869:MainThread](2024-03-27 12:01:57,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.102386, valid_loss 1.097770, train_metric nan, valid_metric 0.073725
[2648869:MainThread](2024-03-27 12:01:57,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.086156, valid_loss 1.097213, train_metric nan, valid_metric 0.082794
[2648869:MainThread](2024-03-27 12:01:57,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.073942, valid_loss 1.096710, train_metric nan, valid_metric 0.088901
[2648869:MainThread](2024-03-27 12:01:58,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.070329, valid_loss 1.097093, train_metric nan, valid_metric 0.084472
[2648869:MainThread](2024-03-27 12:01:58,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.074684, valid_loss 1.096719, train_metric nan, valid_metric 0.086206
[2648869:MainThread](2024-03-27 12:01:58,598) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.079101, valid_loss 1.098025, train_metric nan, valid_metric 0.072373
[2648869:MainThread](2024-03-27 12:01:58,799) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.087247, valid_loss 1.097264, train_metric nan, valid_metric 0.084278
[2648869:MainThread](2024-03-27 12:01:59,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.080589, valid_loss 1.097209, train_metric nan, valid_metric 0.079871
[2648869:MainThread](2024-03-27 12:01:59,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.088394, valid_loss 1.097601, train_metric nan, valid_metric 0.082369
[2648869:MainThread](2024-03-27 12:01:59,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.063336, valid_loss 1.096667, train_metric nan, valid_metric 0.091000
[2648869:MainThread](2024-03-27 12:01:59,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.060449, valid_loss 1.097213, train_metric nan, valid_metric 0.081184
[2648869:MainThread](2024-03-27 12:01:59,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.074929, valid_loss 1.096804, train_metric nan, valid_metric 0.088174
[2648869:MainThread](2024-03-27 12:02:00,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.088587, valid_loss 1.097100, train_metric nan, valid_metric 0.085269
[2648869:MainThread](2024-03-27 12:02:00,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.048696, valid_loss 1.097988, train_metric nan, valid_metric 0.075758
[2648869:MainThread](2024-03-27 12:02:00,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.072084, valid_loss 1.096565, train_metric nan, valid_metric 0.088400
[2648869:MainThread](2024-03-27 12:02:00,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.074828, valid_loss 1.096618, train_metric nan, valid_metric 0.086844
[2648869:MainThread](2024-03-27 12:02:00,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.073343, valid_loss 1.096222, train_metric nan, valid_metric 0.094548
[2648869:MainThread](2024-03-27 12:02:01,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.071157, valid_loss 1.097162, train_metric nan, valid_metric 0.088188
[2648869:MainThread](2024-03-27 12:02:01,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.083290, valid_loss 1.096544, train_metric nan, valid_metric 0.088055
[2648869:MainThread](2024-03-27 12:02:01,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.076851, valid_loss 1.096786, train_metric nan, valid_metric 0.089163
[2648869:MainThread](2024-03-27 12:02:01,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.083637, valid_loss 1.097308, train_metric nan, valid_metric 0.084613
[2648869:MainThread](2024-03-27 12:02:01,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.067939, valid_loss 1.096723, train_metric nan, valid_metric 0.087206
[2648869:MainThread](2024-03-27 12:02:02,059) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.063258, valid_loss 1.096842, train_metric nan, valid_metric 0.089478
[2648869:MainThread](2024-03-27 12:02:02,263) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.081342, valid_loss 1.096954, train_metric nan, valid_metric 0.088237
[2648869:MainThread](2024-03-27 12:02:02,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.077297, valid_loss 1.097173, train_metric nan, valid_metric 0.083927
[2648869:MainThread](2024-03-27 12:02:02,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.076656, valid_loss 1.096418, train_metric nan, valid_metric 0.090435
[2648869:MainThread](2024-03-27 12:02:02,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.087478, valid_loss 1.097331, train_metric nan, valid_metric 0.073627
[2648869:MainThread](2024-03-27 12:02:03,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.065965, valid_loss 1.096995, train_metric nan, valid_metric 0.091309
[2648869:MainThread](2024-03-27 12:02:03,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.078087, valid_loss 1.097316, train_metric nan, valid_metric 0.081309
[2648869:MainThread](2024-03-27 12:02:03,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.076728, valid_loss 1.097388, train_metric nan, valid_metric 0.075206
[2648869:MainThread](2024-03-27 12:02:03,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.085589, valid_loss 1.096816, train_metric nan, valid_metric 0.085733
[2648869:MainThread](2024-03-27 12:02:03,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:02:04,338) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:02:05,015) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  41%|████      | 18/44 [09:27<13:54, 32.09s/it][2648869:MainThread](2024-03-27 12:02:05,022) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:02:05,033) INFO - qlib.workflow - [recorder.py:341] - Recorder 7dec7b618bc64133a92bcb5719c78a55 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:02:05,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:02:05,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:02:05,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:02:05,661) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:02:07,365) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.976862
            SH600004      0.976862
            SH600006      0.976862
            SH600007      0.976862
            SH600008      0.976862
                            ...   
2016-08-09  SZ300133      0.783797
            SZ300144      0.783797
            SZ300146      0.783797
            SZ300168      0.783797
            SZ300315      0.783797
Length: 520702, dtype: float64
[2648869:MainThread](2024-03-27 12:02:08,260) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2016-08-10  SH600000      0.783797
            SH600008      0.783797
            SH600009      0.783797
            SH600010      0.783797
            SH600011      0.783797
                            ...   
2018-05-28  SZ300124      1.100137
            SZ300136      1.100137
            SZ300144      1.100137
            SZ300251      1.100137
            SZ300315      1.100137
Length: 115825, dtype: float64
[2648869:MainThread](2024-03-27 12:02:08,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:02:08,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.456751, valid_loss 1.149227, train_metric nan, valid_metric 0.052277
[2648869:MainThread](2024-03-27 12:02:08,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.149227, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:02:09,021) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.243149, valid_loss 1.152998, train_metric nan, valid_metric 0.080883
[2648869:MainThread](2024-03-27 12:02:09,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.105459, valid_loss 1.149398, train_metric nan, valid_metric 0.037507
[2648869:MainThread](2024-03-27 12:02:09,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.262927, valid_loss 1.178957, train_metric nan, valid_metric 0.088105
[2648869:MainThread](2024-03-27 12:02:09,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.162990, valid_loss 1.145629, train_metric nan, valid_metric 0.087462
[2648869:MainThread](2024-03-27 12:02:09,628) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.149227 to 1.145629, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:09,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.199024, valid_loss 1.143753, train_metric nan, valid_metric 0.103269
[2648869:MainThread](2024-03-27 12:02:09,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.145629 to 1.143753, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:10,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.131565, valid_loss 1.140273, train_metric nan, valid_metric 0.107455
[2648869:MainThread](2024-03-27 12:02:10,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.143753 to 1.140273, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:10,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.091587, valid_loss 1.139623, train_metric nan, valid_metric 0.117336
[2648869:MainThread](2024-03-27 12:02:10,257) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.140273 to 1.139623, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:10,470) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.073588, valid_loss 1.137267, train_metric nan, valid_metric 0.121322
[2648869:MainThread](2024-03-27 12:02:10,471) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.139623 to 1.137267, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:10,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.082964, valid_loss 1.140777, train_metric nan, valid_metric 0.104111
[2648869:MainThread](2024-03-27 12:02:10,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.064689, valid_loss 1.137421, train_metric nan, valid_metric 0.119471
[2648869:MainThread](2024-03-27 12:02:11,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.072822, valid_loss 1.141014, train_metric nan, valid_metric 0.111332
[2648869:MainThread](2024-03-27 12:02:11,296) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.053366, valid_loss 1.141686, train_metric nan, valid_metric 0.100335
[2648869:MainThread](2024-03-27 12:02:11,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.053703, valid_loss 1.136630, train_metric nan, valid_metric 0.124308
[2648869:MainThread](2024-03-27 12:02:11,502) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.137267 to 1.136630, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:11,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.065630, valid_loss 1.140046, train_metric nan, valid_metric 0.091743
[2648869:MainThread](2024-03-27 12:02:11,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.100834, valid_loss 1.134161, train_metric nan, valid_metric 0.129321
[2648869:MainThread](2024-03-27 12:02:11,912) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.136630 to 1.134161, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:12,119) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.037297, valid_loss 1.138026, train_metric nan, valid_metric 0.122104
[2648869:MainThread](2024-03-27 12:02:12,322) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.039400, valid_loss 1.135071, train_metric nan, valid_metric 0.131864
[2648869:MainThread](2024-03-27 12:02:12,526) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.040696, valid_loss 1.135237, train_metric nan, valid_metric 0.130761
[2648869:MainThread](2024-03-27 12:02:12,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.049474, valid_loss 1.138724, train_metric nan, valid_metric 0.124605
[2648869:MainThread](2024-03-27 12:02:12,941) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.023747, valid_loss 1.137090, train_metric nan, valid_metric 0.121867
[2648869:MainThread](2024-03-27 12:02:13,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.035666, valid_loss 1.138422, train_metric nan, valid_metric 0.131313
[2648869:MainThread](2024-03-27 12:02:13,354) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.066833, valid_loss 1.136599, train_metric nan, valid_metric 0.136491
[2648869:MainThread](2024-03-27 12:02:13,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.038047, valid_loss 1.136807, train_metric nan, valid_metric 0.141204
[2648869:MainThread](2024-03-27 12:02:13,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.060439, valid_loss 1.137982, train_metric nan, valid_metric 0.128333
[2648869:MainThread](2024-03-27 12:02:14,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.062618, valid_loss 1.136982, train_metric nan, valid_metric 0.133375
[2648869:MainThread](2024-03-27 12:02:14,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.072126, valid_loss 1.138630, train_metric nan, valid_metric 0.136595
[2648869:MainThread](2024-03-27 12:02:14,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.044939, valid_loss 1.136737, train_metric nan, valid_metric 0.135282
[2648869:MainThread](2024-03-27 12:02:14,669) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.021690, valid_loss 1.135989, train_metric nan, valid_metric 0.136343
[2648869:MainThread](2024-03-27 12:02:14,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.030328, valid_loss 1.136503, train_metric nan, valid_metric 0.139347
[2648869:MainThread](2024-03-27 12:02:15,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.018412, valid_loss 1.137060, train_metric nan, valid_metric 0.135795
[2648869:MainThread](2024-03-27 12:02:15,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.020930, valid_loss 1.137792, train_metric nan, valid_metric 0.136806
[2648869:MainThread](2024-03-27 12:02:15,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.033806, valid_loss 1.136526, train_metric nan, valid_metric 0.140344
[2648869:MainThread](2024-03-27 12:02:15,659) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.030471, valid_loss 1.138639, train_metric nan, valid_metric 0.139115
[2648869:MainThread](2024-03-27 12:02:15,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.012962, valid_loss 1.133999, train_metric nan, valid_metric 0.146286
[2648869:MainThread](2024-03-27 12:02:15,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.134161 to 1.133999, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:16,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.033983, valid_loss 1.135599, train_metric nan, valid_metric 0.138466
[2648869:MainThread](2024-03-27 12:02:16,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.032612, valid_loss 1.135453, train_metric nan, valid_metric 0.136514
[2648869:MainThread](2024-03-27 12:02:16,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.013888, valid_loss 1.136795, train_metric nan, valid_metric 0.135953
[2648869:MainThread](2024-03-27 12:02:16,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.033515, valid_loss 1.137562, train_metric nan, valid_metric 0.135626
[2648869:MainThread](2024-03-27 12:02:16,880) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.031861, valid_loss 1.136606, train_metric nan, valid_metric 0.137717
[2648869:MainThread](2024-03-27 12:02:17,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.011098, valid_loss 1.134987, train_metric nan, valid_metric 0.138763
[2648869:MainThread](2024-03-27 12:02:17,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.017151, valid_loss 1.136856, train_metric nan, valid_metric 0.142579
[2648869:MainThread](2024-03-27 12:02:17,504) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.014462, valid_loss 1.136600, train_metric nan, valid_metric 0.145145
[2648869:MainThread](2024-03-27 12:02:17,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.020551, valid_loss 1.135176, train_metric nan, valid_metric 0.143919
[2648869:MainThread](2024-03-27 12:02:17,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.008450, valid_loss 1.134680, train_metric nan, valid_metric 0.143269
[2648869:MainThread](2024-03-27 12:02:18,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.026214, valid_loss 1.137780, train_metric nan, valid_metric 0.142800
[2648869:MainThread](2024-03-27 12:02:18,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.032370, valid_loss 1.135414, train_metric nan, valid_metric 0.146321
[2648869:MainThread](2024-03-27 12:02:18,536) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.015330, valid_loss 1.136076, train_metric nan, valid_metric 0.142239
[2648869:MainThread](2024-03-27 12:02:18,741) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.003279, valid_loss 1.132779, train_metric nan, valid_metric 0.144111
[2648869:MainThread](2024-03-27 12:02:18,742) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.133999 to 1.132779, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:18,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.023261, valid_loss 1.137703, train_metric nan, valid_metric 0.134737
[2648869:MainThread](2024-03-27 12:02:19,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.013324, valid_loss 1.135772, train_metric nan, valid_metric 0.144019
[2648869:MainThread](2024-03-27 12:02:19,352) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.000536, valid_loss 1.134841, train_metric nan, valid_metric 0.142288
[2648869:MainThread](2024-03-27 12:02:19,555) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.013909, valid_loss 1.134690, train_metric nan, valid_metric 0.146527
[2648869:MainThread](2024-03-27 12:02:19,757) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.019982, valid_loss 1.134352, train_metric nan, valid_metric 0.141046
[2648869:MainThread](2024-03-27 12:02:19,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.024556, valid_loss 1.135016, train_metric nan, valid_metric 0.141220
[2648869:MainThread](2024-03-27 12:02:20,171) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.027354, valid_loss 1.133917, train_metric nan, valid_metric 0.141640
[2648869:MainThread](2024-03-27 12:02:20,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.028364, valid_loss 1.134189, train_metric nan, valid_metric 0.143291
[2648869:MainThread](2024-03-27 12:02:20,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.017992, valid_loss 1.136245, train_metric nan, valid_metric 0.143731
[2648869:MainThread](2024-03-27 12:02:20,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.024297, valid_loss 1.135259, train_metric nan, valid_metric 0.144322
[2648869:MainThread](2024-03-27 12:02:20,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.014037, valid_loss 1.134371, train_metric nan, valid_metric 0.148515
[2648869:MainThread](2024-03-27 12:02:21,184) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.027462, valid_loss 1.135658, train_metric nan, valid_metric 0.147287
[2648869:MainThread](2024-03-27 12:02:21,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.014708, valid_loss 1.132988, train_metric nan, valid_metric 0.146082
[2648869:MainThread](2024-03-27 12:02:21,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.002900, valid_loss 1.131444, train_metric nan, valid_metric 0.145909
[2648869:MainThread](2024-03-27 12:02:21,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.132779 to 1.131444, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:21,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.009833, valid_loss 1.132621, train_metric nan, valid_metric 0.145375
[2648869:MainThread](2024-03-27 12:02:22,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.002692, valid_loss 1.135273, train_metric nan, valid_metric 0.145063
[2648869:MainThread](2024-03-27 12:02:22,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.013368, valid_loss 1.133924, train_metric nan, valid_metric 0.140067
[2648869:MainThread](2024-03-27 12:02:22,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.007908, valid_loss 1.129556, train_metric nan, valid_metric 0.147044
[2648869:MainThread](2024-03-27 12:02:22,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.131444 to 1.129556, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:22,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.009139, valid_loss 1.131516, train_metric nan, valid_metric 0.143376
[2648869:MainThread](2024-03-27 12:02:22,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.014418, valid_loss 1.136067, train_metric nan, valid_metric 0.129288
[2648869:MainThread](2024-03-27 12:02:23,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.010480, valid_loss 1.134024, train_metric nan, valid_metric 0.143026
[2648869:MainThread](2024-03-27 12:02:23,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.005694, valid_loss 1.134619, train_metric nan, valid_metric 0.146287
[2648869:MainThread](2024-03-27 12:02:23,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.016510, valid_loss 1.134609, train_metric nan, valid_metric 0.144608
[2648869:MainThread](2024-03-27 12:02:23,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.009861, valid_loss 1.134837, train_metric nan, valid_metric 0.145649
[2648869:MainThread](2024-03-27 12:02:23,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.005241, valid_loss 1.134949, train_metric nan, valid_metric 0.145447
[2648869:MainThread](2024-03-27 12:02:24,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.011793, valid_loss 1.134176, train_metric nan, valid_metric 0.146126
[2648869:MainThread](2024-03-27 12:02:24,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.024653, valid_loss 1.135433, train_metric nan, valid_metric 0.140050
[2648869:MainThread](2024-03-27 12:02:24,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.028688, valid_loss 1.135280, train_metric nan, valid_metric 0.142120
[2648869:MainThread](2024-03-27 12:02:24,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.003024, valid_loss 1.134026, train_metric nan, valid_metric 0.144705
[2648869:MainThread](2024-03-27 12:02:24,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.004325, valid_loss 1.138434, train_metric nan, valid_metric 0.141317
[2648869:MainThread](2024-03-27 12:02:25,062) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.011376, valid_loss 1.135529, train_metric nan, valid_metric 0.138098
[2648869:MainThread](2024-03-27 12:02:25,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.013086, valid_loss 1.134538, train_metric nan, valid_metric 0.146701
[2648869:MainThread](2024-03-27 12:02:25,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.016079, valid_loss 1.135550, train_metric nan, valid_metric 0.144217
[2648869:MainThread](2024-03-27 12:02:25,672) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.015614, valid_loss 1.135951, train_metric nan, valid_metric 0.139672
[2648869:MainThread](2024-03-27 12:02:25,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.015434, valid_loss 1.135497, train_metric nan, valid_metric 0.141317
[2648869:MainThread](2024-03-27 12:02:26,077) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.014875, valid_loss 1.134897, train_metric nan, valid_metric 0.145040
[2648869:MainThread](2024-03-27 12:02:26,277) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.999442, valid_loss 1.134324, train_metric nan, valid_metric 0.140840
[2648869:MainThread](2024-03-27 12:02:26,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.016277, valid_loss 1.136754, train_metric nan, valid_metric 0.141163
[2648869:MainThread](2024-03-27 12:02:26,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.000783, valid_loss 1.134418, train_metric nan, valid_metric 0.144973
[2648869:MainThread](2024-03-27 12:02:26,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.004610, valid_loss 1.134497, train_metric nan, valid_metric 0.144897
[2648869:MainThread](2024-03-27 12:02:27,089) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.997731, valid_loss 1.133917, train_metric nan, valid_metric 0.144910
[2648869:MainThread](2024-03-27 12:02:27,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.004205, valid_loss 1.133472, train_metric nan, valid_metric 0.145738
[2648869:MainThread](2024-03-27 12:02:27,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.003353, valid_loss 1.133572, train_metric nan, valid_metric 0.147264
[2648869:MainThread](2024-03-27 12:02:27,690) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.002540, valid_loss 1.133017, train_metric nan, valid_metric 0.146341
[2648869:MainThread](2024-03-27 12:02:27,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.013826, valid_loss 1.132541, train_metric nan, valid_metric 0.143431
[2648869:MainThread](2024-03-27 12:02:28,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.003188, valid_loss 1.136115, train_metric nan, valid_metric 0.141093
[2648869:MainThread](2024-03-27 12:02:28,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.004690, valid_loss 1.135347, train_metric nan, valid_metric 0.143565
[2648869:MainThread](2024-03-27 12:02:28,502) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.014549, valid_loss 1.135638, train_metric nan, valid_metric 0.144978
[2648869:MainThread](2024-03-27 12:02:28,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.011531, valid_loss 1.133742, train_metric nan, valid_metric 0.146047
[2648869:MainThread](2024-03-27 12:02:28,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.001770, valid_loss 1.132944, train_metric nan, valid_metric 0.143887
[2648869:MainThread](2024-03-27 12:02:29,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.006018, valid_loss 1.133234, train_metric nan, valid_metric 0.145638
[2648869:MainThread](2024-03-27 12:02:29,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.008375, valid_loss 1.131643, train_metric nan, valid_metric 0.148527
[2648869:MainThread](2024-03-27 12:02:29,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.008587, valid_loss 1.137179, train_metric nan, valid_metric 0.142404
[2648869:MainThread](2024-03-27 12:02:29,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.019461, valid_loss 1.133362, train_metric nan, valid_metric 0.146366
[2648869:MainThread](2024-03-27 12:02:29,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.993872, valid_loss 1.137314, train_metric nan, valid_metric 0.146823
[2648869:MainThread](2024-03-27 12:02:30,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.022211, valid_loss 1.136606, train_metric nan, valid_metric 0.144161
[2648869:MainThread](2024-03-27 12:02:30,344) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.003248, valid_loss 1.133974, train_metric nan, valid_metric 0.146952
[2648869:MainThread](2024-03-27 12:02:30,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.002933, valid_loss 1.137320, train_metric nan, valid_metric 0.144290
[2648869:MainThread](2024-03-27 12:02:30,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.012201, valid_loss 1.135893, train_metric nan, valid_metric 0.146346
[2648869:MainThread](2024-03-27 12:02:30,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 0.999697, valid_loss 1.133309, train_metric nan, valid_metric 0.146505
[2648869:MainThread](2024-03-27 12:02:31,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.000796, valid_loss 1.134272, train_metric nan, valid_metric 0.145451
[2648869:MainThread](2024-03-27 12:02:31,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.012804, valid_loss 1.134129, train_metric nan, valid_metric 0.145859
[2648869:MainThread](2024-03-27 12:02:31,565) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.006171, valid_loss 1.133144, train_metric nan, valid_metric 0.146896
[2648869:MainThread](2024-03-27 12:02:31,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.020006, valid_loss 1.132686, train_metric nan, valid_metric 0.147091
[2648869:MainThread](2024-03-27 12:02:31,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.013166, valid_loss 1.134163, train_metric nan, valid_metric 0.146204
[2648869:MainThread](2024-03-27 12:02:32,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 0.993819, valid_loss 1.134443, train_metric nan, valid_metric 0.146150
[2648869:MainThread](2024-03-27 12:02:32,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.010302, valid_loss 1.133049, train_metric nan, valid_metric 0.146689
[2648869:MainThread](2024-03-27 12:02:32,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 0.992052, valid_loss 1.133051, train_metric nan, valid_metric 0.147057
[2648869:MainThread](2024-03-27 12:02:32,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:02:33,089) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:02:33,625) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  43%|████▎     | 19/44 [09:55<12:56, 31.04s/it][2648869:MainThread](2024-03-27 12:02:33,632) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:02:33,643) INFO - qlib.workflow - [recorder.py:341] - Recorder b897185c7101488586d2f7eef5f72e10 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:02:34,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:02:34,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:02:34,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:02:34,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:02:35,945) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.699676
            SH600004      0.699676
            SH600006      0.699676
            SH600007      0.699676
            SH600008      0.699676
                            ...   
2016-09-06  SZ300133      0.531382
            SZ300144      0.531382
            SZ300146      0.531382
            SZ300251      0.531382
            SZ300315      0.531382
Length: 526075, dtype: float64
[2648869:MainThread](2024-03-27 12:02:36,845) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2016-09-07  SH600000      0.531382
            SH600008      0.531382
            SH600009      0.531382
            SH600010      0.531382
            SH600011      0.531382
                            ...   
2018-06-26  SZ300136      0.973392
            SZ300144      0.973392
            SZ300251      0.973392
            SZ300408      0.973392
            SZ300433      0.973392
Length: 115859, dtype: float64
[2648869:MainThread](2024-03-27 12:02:36,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:02:37,415) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.432200, valid_loss 1.326788, train_metric nan, valid_metric 0.033771
[2648869:MainThread](2024-03-27 12:02:37,415) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.326788, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:02:37,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.262834, valid_loss 1.335845, train_metric nan, valid_metric 0.064973
[2648869:MainThread](2024-03-27 12:02:37,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.212274, valid_loss 1.313094, train_metric nan, valid_metric 0.059306
[2648869:MainThread](2024-03-27 12:02:37,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.326788 to 1.313094, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:38,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.177262, valid_loss 1.305457, train_metric nan, valid_metric 0.090393
[2648869:MainThread](2024-03-27 12:02:38,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.313094 to 1.305457, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:38,211) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.137395, valid_loss 1.302604, train_metric nan, valid_metric 0.112216
[2648869:MainThread](2024-03-27 12:02:38,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.305457 to 1.302604, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:38,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.134841, valid_loss 1.306036, train_metric nan, valid_metric 0.086993
[2648869:MainThread](2024-03-27 12:02:38,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.161377, valid_loss 1.308181, train_metric nan, valid_metric 0.097781
[2648869:MainThread](2024-03-27 12:02:38,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.130276, valid_loss 1.305313, train_metric nan, valid_metric 0.108199
[2648869:MainThread](2024-03-27 12:02:39,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.133550, valid_loss 1.295145, train_metric nan, valid_metric 0.118536
[2648869:MainThread](2024-03-27 12:02:39,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.302604 to 1.295145, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:39,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.134135, valid_loss 1.298839, train_metric nan, valid_metric 0.121402
[2648869:MainThread](2024-03-27 12:02:39,433) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.107109, valid_loss 1.297821, train_metric nan, valid_metric 0.112751
[2648869:MainThread](2024-03-27 12:02:39,638) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.097673, valid_loss 1.298140, train_metric nan, valid_metric 0.112594
[2648869:MainThread](2024-03-27 12:02:39,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.110545, valid_loss 1.299873, train_metric nan, valid_metric 0.114201
[2648869:MainThread](2024-03-27 12:02:40,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.110183, valid_loss 1.296892, train_metric nan, valid_metric 0.119644
[2648869:MainThread](2024-03-27 12:02:40,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.109156, valid_loss 1.300120, train_metric nan, valid_metric 0.116419
[2648869:MainThread](2024-03-27 12:02:40,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.123086, valid_loss 1.299018, train_metric nan, valid_metric 0.117693
[2648869:MainThread](2024-03-27 12:02:40,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.103862, valid_loss 1.299228, train_metric nan, valid_metric 0.124014
[2648869:MainThread](2024-03-27 12:02:40,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.088900, valid_loss 1.295577, train_metric nan, valid_metric 0.124836
[2648869:MainThread](2024-03-27 12:02:41,062) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.103391, valid_loss 1.287245, train_metric nan, valid_metric 0.147745
[2648869:MainThread](2024-03-27 12:02:41,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.295145 to 1.287245, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:41,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.108064, valid_loss 1.294241, train_metric nan, valid_metric 0.141502
[2648869:MainThread](2024-03-27 12:02:41,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.083050, valid_loss 1.293539, train_metric nan, valid_metric 0.127595
[2648869:MainThread](2024-03-27 12:02:41,667) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.097577, valid_loss 1.297399, train_metric nan, valid_metric 0.122238
[2648869:MainThread](2024-03-27 12:02:41,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.082815, valid_loss 1.296326, train_metric nan, valid_metric 0.123072
[2648869:MainThread](2024-03-27 12:02:42,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.076524, valid_loss 1.292902, train_metric nan, valid_metric 0.141861
[2648869:MainThread](2024-03-27 12:02:42,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.099610, valid_loss 1.290380, train_metric nan, valid_metric 0.135946
[2648869:MainThread](2024-03-27 12:02:42,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.116650, valid_loss 1.286502, train_metric nan, valid_metric 0.143695
[2648869:MainThread](2024-03-27 12:02:42,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.287245 to 1.286502, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:42,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.095610, valid_loss 1.291640, train_metric nan, valid_metric 0.137052
[2648869:MainThread](2024-03-27 12:02:42,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.084807, valid_loss 1.292874, train_metric nan, valid_metric 0.140961
[2648869:MainThread](2024-03-27 12:02:43,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.087242, valid_loss 1.297684, train_metric nan, valid_metric 0.143943
[2648869:MainThread](2024-03-27 12:02:43,295) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.100124, valid_loss 1.290391, train_metric nan, valid_metric 0.143688
[2648869:MainThread](2024-03-27 12:02:43,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.073979, valid_loss 1.290681, train_metric nan, valid_metric 0.148894
[2648869:MainThread](2024-03-27 12:02:43,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.096390, valid_loss 1.289396, train_metric nan, valid_metric 0.145123
[2648869:MainThread](2024-03-27 12:02:43,907) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.078084, valid_loss 1.297169, train_metric nan, valid_metric 0.126556
[2648869:MainThread](2024-03-27 12:02:44,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.091143, valid_loss 1.289449, train_metric nan, valid_metric 0.136129
[2648869:MainThread](2024-03-27 12:02:44,306) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.084076, valid_loss 1.289138, train_metric nan, valid_metric 0.143879
[2648869:MainThread](2024-03-27 12:02:44,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.079819, valid_loss 1.293791, train_metric nan, valid_metric 0.139145
[2648869:MainThread](2024-03-27 12:02:44,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.076598, valid_loss 1.289057, train_metric nan, valid_metric 0.143808
[2648869:MainThread](2024-03-27 12:02:44,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.071152, valid_loss 1.287110, train_metric nan, valid_metric 0.148045
[2648869:MainThread](2024-03-27 12:02:45,104) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.074913, valid_loss 1.287627, train_metric nan, valid_metric 0.147647
[2648869:MainThread](2024-03-27 12:02:45,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.072850, valid_loss 1.289476, train_metric nan, valid_metric 0.147288
[2648869:MainThread](2024-03-27 12:02:45,517) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.066751, valid_loss 1.285133, train_metric nan, valid_metric 0.146912
[2648869:MainThread](2024-03-27 12:02:45,517) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.286502 to 1.285133, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:45,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.080799, valid_loss 1.288502, train_metric nan, valid_metric 0.147443
[2648869:MainThread](2024-03-27 12:02:45,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.073602, valid_loss 1.290298, train_metric nan, valid_metric 0.141337
[2648869:MainThread](2024-03-27 12:02:46,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.087779, valid_loss 1.291453, train_metric nan, valid_metric 0.142108
[2648869:MainThread](2024-03-27 12:02:46,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.089929, valid_loss 1.290208, train_metric nan, valid_metric 0.146275
[2648869:MainThread](2024-03-27 12:02:46,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.072673, valid_loss 1.290676, train_metric nan, valid_metric 0.144872
[2648869:MainThread](2024-03-27 12:02:46,873) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.082661, valid_loss 1.288914, train_metric nan, valid_metric 0.142775
[2648869:MainThread](2024-03-27 12:02:47,130) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.075663, valid_loss 1.293238, train_metric nan, valid_metric 0.142206
[2648869:MainThread](2024-03-27 12:02:47,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.089120, valid_loss 1.290283, train_metric nan, valid_metric 0.143023
[2648869:MainThread](2024-03-27 12:02:47,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.083032, valid_loss 1.289200, train_metric nan, valid_metric 0.146752
[2648869:MainThread](2024-03-27 12:02:47,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.068515, valid_loss 1.291488, train_metric nan, valid_metric 0.144247
[2648869:MainThread](2024-03-27 12:02:48,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.069251, valid_loss 1.290715, train_metric nan, valid_metric 0.144919
[2648869:MainThread](2024-03-27 12:02:48,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.074381, valid_loss 1.286304, train_metric nan, valid_metric 0.150661
[2648869:MainThread](2024-03-27 12:02:48,646) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.073888, valid_loss 1.295853, train_metric nan, valid_metric 0.145206
[2648869:MainThread](2024-03-27 12:02:48,897) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.096363, valid_loss 1.295575, train_metric nan, valid_metric 0.143840
[2648869:MainThread](2024-03-27 12:02:49,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.080589, valid_loss 1.290913, train_metric nan, valid_metric 0.146011
[2648869:MainThread](2024-03-27 12:02:49,307) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.078893, valid_loss 1.290600, train_metric nan, valid_metric 0.146104
[2648869:MainThread](2024-03-27 12:02:49,517) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.076389, valid_loss 1.291077, train_metric nan, valid_metric 0.143335
[2648869:MainThread](2024-03-27 12:02:49,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.075364, valid_loss 1.290706, train_metric nan, valid_metric 0.146548
[2648869:MainThread](2024-03-27 12:02:49,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.082069, valid_loss 1.290805, train_metric nan, valid_metric 0.144022
[2648869:MainThread](2024-03-27 12:02:50,141) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.083858, valid_loss 1.287477, train_metric nan, valid_metric 0.145909
[2648869:MainThread](2024-03-27 12:02:50,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.071011, valid_loss 1.288142, train_metric nan, valid_metric 0.147808
[2648869:MainThread](2024-03-27 12:02:50,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.067709, valid_loss 1.285064, train_metric nan, valid_metric 0.146041
[2648869:MainThread](2024-03-27 12:02:50,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.285133 to 1.285064, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:50,770) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.077062, valid_loss 1.294244, train_metric nan, valid_metric 0.143384
[2648869:MainThread](2024-03-27 12:02:50,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.077543, valid_loss 1.286444, train_metric nan, valid_metric 0.147963
[2648869:MainThread](2024-03-27 12:02:51,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.076644, valid_loss 1.288432, train_metric nan, valid_metric 0.145856
[2648869:MainThread](2024-03-27 12:02:51,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.077302, valid_loss 1.291506, train_metric nan, valid_metric 0.145710
[2648869:MainThread](2024-03-27 12:02:51,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.070035, valid_loss 1.284596, train_metric nan, valid_metric 0.150524
[2648869:MainThread](2024-03-27 12:02:51,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.285064 to 1.284596, save checkpoint.
[2648869:MainThread](2024-03-27 12:02:51,935) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.076500, valid_loss 1.289203, train_metric nan, valid_metric 0.149667
[2648869:MainThread](2024-03-27 12:02:52,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.080966, valid_loss 1.291697, train_metric nan, valid_metric 0.147998
[2648869:MainThread](2024-03-27 12:02:52,356) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.063909, valid_loss 1.288103, train_metric nan, valid_metric 0.149301
[2648869:MainThread](2024-03-27 12:02:52,561) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.076138, valid_loss 1.294029, train_metric nan, valid_metric 0.150626
[2648869:MainThread](2024-03-27 12:02:52,765) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.073955, valid_loss 1.293068, train_metric nan, valid_metric 0.146514
[2648869:MainThread](2024-03-27 12:02:52,970) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.068574, valid_loss 1.291342, train_metric nan, valid_metric 0.147628
[2648869:MainThread](2024-03-27 12:02:53,176) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.078628, valid_loss 1.286878, train_metric nan, valid_metric 0.148543
[2648869:MainThread](2024-03-27 12:02:53,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.073476, valid_loss 1.286218, train_metric nan, valid_metric 0.146743
[2648869:MainThread](2024-03-27 12:02:53,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.072082, valid_loss 1.287119, train_metric nan, valid_metric 0.149189
[2648869:MainThread](2024-03-27 12:02:53,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.092783, valid_loss 1.288068, train_metric nan, valid_metric 0.148747
[2648869:MainThread](2024-03-27 12:02:54,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.076088, valid_loss 1.288074, train_metric nan, valid_metric 0.146625
[2648869:MainThread](2024-03-27 12:02:54,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.073409, valid_loss 1.291784, train_metric nan, valid_metric 0.145522
[2648869:MainThread](2024-03-27 12:02:54,500) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.086658, valid_loss 1.288691, train_metric nan, valid_metric 0.147792
[2648869:MainThread](2024-03-27 12:02:54,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.066869, valid_loss 1.288194, train_metric nan, valid_metric 0.145675
[2648869:MainThread](2024-03-27 12:02:54,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.070445, valid_loss 1.285066, train_metric nan, valid_metric 0.147027
[2648869:MainThread](2024-03-27 12:02:55,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.071312, valid_loss 1.285250, train_metric nan, valid_metric 0.150027
[2648869:MainThread](2024-03-27 12:02:55,325) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.079625, valid_loss 1.291888, train_metric nan, valid_metric 0.149131
[2648869:MainThread](2024-03-27 12:02:55,530) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.069012, valid_loss 1.289273, train_metric nan, valid_metric 0.147581
[2648869:MainThread](2024-03-27 12:02:55,735) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.077035, valid_loss 1.289587, train_metric nan, valid_metric 0.148654
[2648869:MainThread](2024-03-27 12:02:55,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.074551, valid_loss 1.287904, train_metric nan, valid_metric 0.147479
[2648869:MainThread](2024-03-27 12:02:56,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.076595, valid_loss 1.290316, train_metric nan, valid_metric 0.148016
[2648869:MainThread](2024-03-27 12:02:56,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.072052, valid_loss 1.290270, train_metric nan, valid_metric 0.146770
[2648869:MainThread](2024-03-27 12:02:56,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.074373, valid_loss 1.291562, train_metric nan, valid_metric 0.150401
[2648869:MainThread](2024-03-27 12:02:56,760) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.085010, valid_loss 1.291854, train_metric nan, valid_metric 0.145880
[2648869:MainThread](2024-03-27 12:02:56,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.072871, valid_loss 1.290005, train_metric nan, valid_metric 0.145259
[2648869:MainThread](2024-03-27 12:02:57,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.056917, valid_loss 1.290281, train_metric nan, valid_metric 0.150250
[2648869:MainThread](2024-03-27 12:02:57,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.058716, valid_loss 1.288744, train_metric nan, valid_metric 0.149374
[2648869:MainThread](2024-03-27 12:02:57,568) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.067900, valid_loss 1.292068, train_metric nan, valid_metric 0.148149
[2648869:MainThread](2024-03-27 12:02:57,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.068018, valid_loss 1.289099, train_metric nan, valid_metric 0.148287
[2648869:MainThread](2024-03-27 12:02:57,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.087762, valid_loss 1.286132, train_metric nan, valid_metric 0.148915
[2648869:MainThread](2024-03-27 12:02:58,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.072721, valid_loss 1.292385, train_metric nan, valid_metric 0.144611
[2648869:MainThread](2024-03-27 12:02:58,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.058414, valid_loss 1.288914, train_metric nan, valid_metric 0.149641
[2648869:MainThread](2024-03-27 12:02:58,594) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.074662, valid_loss 1.290204, train_metric nan, valid_metric 0.148371
[2648869:MainThread](2024-03-27 12:02:58,804) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.074229, valid_loss 1.286672, train_metric nan, valid_metric 0.147798
[2648869:MainThread](2024-03-27 12:02:59,008) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.064505, valid_loss 1.289913, train_metric nan, valid_metric 0.147831
[2648869:MainThread](2024-03-27 12:02:59,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.077041, valid_loss 1.289573, train_metric nan, valid_metric 0.147327
[2648869:MainThread](2024-03-27 12:02:59,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.065922, valid_loss 1.289025, train_metric nan, valid_metric 0.146027
[2648869:MainThread](2024-03-27 12:02:59,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.068855, valid_loss 1.285661, train_metric nan, valid_metric 0.147869
[2648869:MainThread](2024-03-27 12:02:59,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.081914, valid_loss 1.289526, train_metric nan, valid_metric 0.145219
[2648869:MainThread](2024-03-27 12:03:00,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.079638, valid_loss 1.291207, train_metric nan, valid_metric 0.147238
[2648869:MainThread](2024-03-27 12:03:00,359) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.074548, valid_loss 1.286437, train_metric nan, valid_metric 0.149257
[2648869:MainThread](2024-03-27 12:03:00,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.087026, valid_loss 1.290863, train_metric nan, valid_metric 0.148439
[2648869:MainThread](2024-03-27 12:03:00,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.074901, valid_loss 1.290354, train_metric nan, valid_metric 0.146159
[2648869:MainThread](2024-03-27 12:03:01,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.074423, valid_loss 1.288403, train_metric nan, valid_metric 0.146749
[2648869:MainThread](2024-03-27 12:03:01,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.071195, valid_loss 1.288167, train_metric nan, valid_metric 0.148229
[2648869:MainThread](2024-03-27 12:03:01,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.089879, valid_loss 1.291481, train_metric nan, valid_metric 0.146940
[2648869:MainThread](2024-03-27 12:03:01,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.087331, valid_loss 1.291530, train_metric nan, valid_metric 0.149741
[2648869:MainThread](2024-03-27 12:03:01,983) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.063815, valid_loss 1.288390, train_metric nan, valid_metric 0.150172
[2648869:MainThread](2024-03-27 12:03:02,234) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 1.083459, valid_loss 1.289460, train_metric nan, valid_metric 0.146418
[2648869:MainThread](2024-03-27 12:03:02,483) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 1.063756, valid_loss 1.293550, train_metric nan, valid_metric 0.147116
[2648869:MainThread](2024-03-27 12:03:02,483) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:03:03,152) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:03:03,851) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  45%|████▌     | 20/44 [10:25<12:19, 30.80s/it][2648869:MainThread](2024-03-27 12:03:03,858) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:03:03,869) INFO - qlib.workflow - [recorder.py:341] - Recorder 8c1b75cd9a1c435eb011d5146f2b7467 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:03:04,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:03:04,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:03:04,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:03:04,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:03:06,240) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.280516
            SH600004      1.280516
            SH600006      1.280516
            SH600007      1.280516
            SH600008      1.280516
                            ...   
2016-10-13  SZ300144      0.578918
            SZ300146      0.578918
            SZ300168      0.578918
            SZ300251      0.578918
            SZ300315      0.578918
Length: 531540, dtype: float64
[2648869:MainThread](2024-03-27 12:03:07,156) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2016-10-14  SH600000      0.578918
            SH600008      0.578918
            SH600009      0.578918
            SH600010      0.578918
            SH600011      0.578918
                            ...   
2018-07-24  SZ300136      0.528598
            SZ300144      0.528598
            SZ300251      0.528598
            SZ300408      0.528598
            SZ300433      0.528598
Length: 115874, dtype: float64
[2648869:MainThread](2024-03-27 12:03:07,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:03:07,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.355995, valid_loss 1.305393, train_metric nan, valid_metric 0.086310
[2648869:MainThread](2024-03-27 12:03:07,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.305393, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:03:08,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.182707, valid_loss 1.306594, train_metric nan, valid_metric 0.095272
[2648869:MainThread](2024-03-27 12:03:08,233) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.148643, valid_loss 1.307210, train_metric nan, valid_metric 0.086567
[2648869:MainThread](2024-03-27 12:03:08,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.122729, valid_loss 1.303124, train_metric nan, valid_metric 0.097755
[2648869:MainThread](2024-03-27 12:03:08,442) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.305393 to 1.303124, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:08,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.140016, valid_loss 1.298809, train_metric nan, valid_metric 0.124464
[2648869:MainThread](2024-03-27 12:03:08,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.303124 to 1.298809, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:08,850) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.115069, valid_loss 1.299370, train_metric nan, valid_metric 0.118630
[2648869:MainThread](2024-03-27 12:03:09,052) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.117996, valid_loss 1.299189, train_metric nan, valid_metric 0.119315
[2648869:MainThread](2024-03-27 12:03:09,304) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.115915, valid_loss 1.296268, train_metric nan, valid_metric 0.128477
[2648869:MainThread](2024-03-27 12:03:09,305) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.298809 to 1.296268, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:09,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.105950, valid_loss 1.301081, train_metric nan, valid_metric 0.125362
[2648869:MainThread](2024-03-27 12:03:09,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.114673, valid_loss 1.298389, train_metric nan, valid_metric 0.127429
[2648869:MainThread](2024-03-27 12:03:10,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.116143, valid_loss 1.300097, train_metric nan, valid_metric 0.121805
[2648869:MainThread](2024-03-27 12:03:10,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.093330, valid_loss 1.302918, train_metric nan, valid_metric 0.133934
[2648869:MainThread](2024-03-27 12:03:10,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.109035, valid_loss 1.298124, train_metric nan, valid_metric 0.121453
[2648869:MainThread](2024-03-27 12:03:10,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.114756, valid_loss 1.299772, train_metric nan, valid_metric 0.132893
[2648869:MainThread](2024-03-27 12:03:11,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.096484, valid_loss 1.300010, train_metric nan, valid_metric 0.129992
[2648869:MainThread](2024-03-27 12:03:11,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.079035, valid_loss 1.296247, train_metric nan, valid_metric 0.127005
[2648869:MainThread](2024-03-27 12:03:11,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.296268 to 1.296247, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:11,568) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.095295, valid_loss 1.295164, train_metric nan, valid_metric 0.133055
[2648869:MainThread](2024-03-27 12:03:11,569) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.296247 to 1.295164, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:11,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.079462, valid_loss 1.296084, train_metric nan, valid_metric 0.135024
[2648869:MainThread](2024-03-27 12:03:12,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.085849, valid_loss 1.293855, train_metric nan, valid_metric 0.139745
[2648869:MainThread](2024-03-27 12:03:12,033) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.295164 to 1.293855, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:12,242) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.073564, valid_loss 1.298185, train_metric nan, valid_metric 0.127090
[2648869:MainThread](2024-03-27 12:03:12,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.075743, valid_loss 1.300926, train_metric nan, valid_metric 0.134120
[2648869:MainThread](2024-03-27 12:03:12,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.074530, valid_loss 1.295845, train_metric nan, valid_metric 0.129138
[2648869:MainThread](2024-03-27 12:03:12,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.072380, valid_loss 1.297623, train_metric nan, valid_metric 0.130768
[2648869:MainThread](2024-03-27 12:03:13,067) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.095203, valid_loss 1.294221, train_metric nan, valid_metric 0.140961
[2648869:MainThread](2024-03-27 12:03:13,275) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.080911, valid_loss 1.300349, train_metric nan, valid_metric 0.131175
[2648869:MainThread](2024-03-27 12:03:13,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.085600, valid_loss 1.294561, train_metric nan, valid_metric 0.136494
[2648869:MainThread](2024-03-27 12:03:13,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.064358, valid_loss 1.296636, train_metric nan, valid_metric 0.137114
[2648869:MainThread](2024-03-27 12:03:13,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.077819, valid_loss 1.294870, train_metric nan, valid_metric 0.130571
[2648869:MainThread](2024-03-27 12:03:14,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.066326, valid_loss 1.296076, train_metric nan, valid_metric 0.138728
[2648869:MainThread](2024-03-27 12:03:14,296) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.081858, valid_loss 1.298043, train_metric nan, valid_metric 0.125878
[2648869:MainThread](2024-03-27 12:03:14,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.067335, valid_loss 1.295235, train_metric nan, valid_metric 0.136893
[2648869:MainThread](2024-03-27 12:03:14,710) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.071036, valid_loss 1.290103, train_metric nan, valid_metric 0.140089
[2648869:MainThread](2024-03-27 12:03:14,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.293855 to 1.290103, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:14,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.073334, valid_loss 1.290601, train_metric nan, valid_metric 0.143061
[2648869:MainThread](2024-03-27 12:03:15,127) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.074666, valid_loss 1.292701, train_metric nan, valid_metric 0.141303
[2648869:MainThread](2024-03-27 12:03:15,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.079057, valid_loss 1.290344, train_metric nan, valid_metric 0.143250
[2648869:MainThread](2024-03-27 12:03:15,541) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.066947, valid_loss 1.298290, train_metric nan, valid_metric 0.132770
[2648869:MainThread](2024-03-27 12:03:15,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.082263, valid_loss 1.299153, train_metric nan, valid_metric 0.136266
[2648869:MainThread](2024-03-27 12:03:15,955) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.065676, valid_loss 1.296521, train_metric nan, valid_metric 0.136054
[2648869:MainThread](2024-03-27 12:03:16,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.057771, valid_loss 1.293019, train_metric nan, valid_metric 0.138578
[2648869:MainThread](2024-03-27 12:03:16,369) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.064881, valid_loss 1.296379, train_metric nan, valid_metric 0.136118
[2648869:MainThread](2024-03-27 12:03:16,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.071864, valid_loss 1.296849, train_metric nan, valid_metric 0.141013
[2648869:MainThread](2024-03-27 12:03:16,779) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.069438, valid_loss 1.293950, train_metric nan, valid_metric 0.139677
[2648869:MainThread](2024-03-27 12:03:16,984) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.067873, valid_loss 1.293983, train_metric nan, valid_metric 0.138365
[2648869:MainThread](2024-03-27 12:03:17,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.060575, valid_loss 1.291125, train_metric nan, valid_metric 0.139979
[2648869:MainThread](2024-03-27 12:03:17,395) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.071883, valid_loss 1.292784, train_metric nan, valid_metric 0.134371
[2648869:MainThread](2024-03-27 12:03:17,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.061293, valid_loss 1.294616, train_metric nan, valid_metric 0.139227
[2648869:MainThread](2024-03-27 12:03:17,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.061123, valid_loss 1.296931, train_metric nan, valid_metric 0.141196
[2648869:MainThread](2024-03-27 12:03:18,006) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.066035, valid_loss 1.296129, train_metric nan, valid_metric 0.141063
[2648869:MainThread](2024-03-27 12:03:18,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.070777, valid_loss 1.297152, train_metric nan, valid_metric 0.138342
[2648869:MainThread](2024-03-27 12:03:18,413) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.071746, valid_loss 1.298500, train_metric nan, valid_metric 0.138636
[2648869:MainThread](2024-03-27 12:03:18,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.068327, valid_loss 1.295172, train_metric nan, valid_metric 0.138247
[2648869:MainThread](2024-03-27 12:03:18,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.067846, valid_loss 1.291590, train_metric nan, valid_metric 0.140821
[2648869:MainThread](2024-03-27 12:03:19,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.065165, valid_loss 1.293679, train_metric nan, valid_metric 0.141934
[2648869:MainThread](2024-03-27 12:03:19,235) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.068517, valid_loss 1.290844, train_metric nan, valid_metric 0.143046
[2648869:MainThread](2024-03-27 12:03:19,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.051974, valid_loss 1.292408, train_metric nan, valid_metric 0.142255
[2648869:MainThread](2024-03-27 12:03:19,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.070188, valid_loss 1.296537, train_metric nan, valid_metric 0.142600
[2648869:MainThread](2024-03-27 12:03:19,842) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.064401, valid_loss 1.295075, train_metric nan, valid_metric 0.141873
[2648869:MainThread](2024-03-27 12:03:20,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.071022, valid_loss 1.293882, train_metric nan, valid_metric 0.142286
[2648869:MainThread](2024-03-27 12:03:20,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.046107, valid_loss 1.293185, train_metric nan, valid_metric 0.142525
[2648869:MainThread](2024-03-27 12:03:20,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.076275, valid_loss 1.297370, train_metric nan, valid_metric 0.137820
[2648869:MainThread](2024-03-27 12:03:20,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.052117, valid_loss 1.294295, train_metric nan, valid_metric 0.139242
[2648869:MainThread](2024-03-27 12:03:20,869) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.054356, valid_loss 1.289597, train_metric nan, valid_metric 0.140745
[2648869:MainThread](2024-03-27 12:03:20,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.290103 to 1.289597, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:21,079) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.064133, valid_loss 1.294755, train_metric nan, valid_metric 0.140538
[2648869:MainThread](2024-03-27 12:03:21,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.054286, valid_loss 1.295304, train_metric nan, valid_metric 0.141122
[2648869:MainThread](2024-03-27 12:03:21,500) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.058770, valid_loss 1.294067, train_metric nan, valid_metric 0.141132
[2648869:MainThread](2024-03-27 12:03:21,710) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.049423, valid_loss 1.293628, train_metric nan, valid_metric 0.135334
[2648869:MainThread](2024-03-27 12:03:21,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.055787, valid_loss 1.291690, train_metric nan, valid_metric 0.141709
[2648869:MainThread](2024-03-27 12:03:22,127) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.071046, valid_loss 1.296036, train_metric nan, valid_metric 0.141074
[2648869:MainThread](2024-03-27 12:03:22,335) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.067542, valid_loss 1.295628, train_metric nan, valid_metric 0.141388
[2648869:MainThread](2024-03-27 12:03:22,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.073310, valid_loss 1.296978, train_metric nan, valid_metric 0.138341
[2648869:MainThread](2024-03-27 12:03:22,744) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.080277, valid_loss 1.293649, train_metric nan, valid_metric 0.140802
[2648869:MainThread](2024-03-27 12:03:22,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.059256, valid_loss 1.290112, train_metric nan, valid_metric 0.141990
[2648869:MainThread](2024-03-27 12:03:23,149) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.078194, valid_loss 1.294270, train_metric nan, valid_metric 0.139336
[2648869:MainThread](2024-03-27 12:03:23,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.061309, valid_loss 1.294732, train_metric nan, valid_metric 0.139799
[2648869:MainThread](2024-03-27 12:03:23,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.054994, valid_loss 1.291818, train_metric nan, valid_metric 0.140483
[2648869:MainThread](2024-03-27 12:03:23,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.049123, valid_loss 1.292554, train_metric nan, valid_metric 0.141389
[2648869:MainThread](2024-03-27 12:03:23,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.070277, valid_loss 1.296850, train_metric nan, valid_metric 0.139776
[2648869:MainThread](2024-03-27 12:03:24,192) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.074386, valid_loss 1.292886, train_metric nan, valid_metric 0.140647
[2648869:MainThread](2024-03-27 12:03:24,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.062756, valid_loss 1.290422, train_metric nan, valid_metric 0.142858
[2648869:MainThread](2024-03-27 12:03:24,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.050178, valid_loss 1.286993, train_metric nan, valid_metric 0.142923
[2648869:MainThread](2024-03-27 12:03:24,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.289597 to 1.286993, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:24,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.066143, valid_loss 1.291970, train_metric nan, valid_metric 0.140608
[2648869:MainThread](2024-03-27 12:03:25,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.055133, valid_loss 1.293903, train_metric nan, valid_metric 0.142623
[2648869:MainThread](2024-03-27 12:03:25,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.058781, valid_loss 1.287945, train_metric nan, valid_metric 0.141606
[2648869:MainThread](2024-03-27 12:03:25,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.063691, valid_loss 1.292883, train_metric nan, valid_metric 0.141591
[2648869:MainThread](2024-03-27 12:03:25,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.065917, valid_loss 1.295383, train_metric nan, valid_metric 0.140079
[2648869:MainThread](2024-03-27 12:03:25,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.055065, valid_loss 1.294299, train_metric nan, valid_metric 0.140636
[2648869:MainThread](2024-03-27 12:03:26,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.054858, valid_loss 1.292532, train_metric nan, valid_metric 0.141175
[2648869:MainThread](2024-03-27 12:03:26,298) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.063858, valid_loss 1.293040, train_metric nan, valid_metric 0.141088
[2648869:MainThread](2024-03-27 12:03:26,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.060008, valid_loss 1.291327, train_metric nan, valid_metric 0.143529
[2648869:MainThread](2024-03-27 12:03:26,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.065988, valid_loss 1.292052, train_metric nan, valid_metric 0.142207
[2648869:MainThread](2024-03-27 12:03:26,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.056019, valid_loss 1.290818, train_metric nan, valid_metric 0.142445
[2648869:MainThread](2024-03-27 12:03:27,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.060905, valid_loss 1.293223, train_metric nan, valid_metric 0.141129
[2648869:MainThread](2024-03-27 12:03:27,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.057017, valid_loss 1.291453, train_metric nan, valid_metric 0.140335
[2648869:MainThread](2024-03-27 12:03:27,581) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.043181, valid_loss 1.292923, train_metric nan, valid_metric 0.140775
[2648869:MainThread](2024-03-27 12:03:27,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.076172, valid_loss 1.295895, train_metric nan, valid_metric 0.140801
[2648869:MainThread](2024-03-27 12:03:27,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.068360, valid_loss 1.297021, train_metric nan, valid_metric 0.140196
[2648869:MainThread](2024-03-27 12:03:28,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.058425, valid_loss 1.294649, train_metric nan, valid_metric 0.140686
[2648869:MainThread](2024-03-27 12:03:28,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.060970, valid_loss 1.296637, train_metric nan, valid_metric 0.140342
[2648869:MainThread](2024-03-27 12:03:28,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.055989, valid_loss 1.290093, train_metric nan, valid_metric 0.140748
[2648869:MainThread](2024-03-27 12:03:28,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.068367, valid_loss 1.297478, train_metric nan, valid_metric 0.141688
[2648869:MainThread](2024-03-27 12:03:29,013) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.067448, valid_loss 1.297127, train_metric nan, valid_metric 0.140686
[2648869:MainThread](2024-03-27 12:03:29,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.056269, valid_loss 1.298919, train_metric nan, valid_metric 0.137011
[2648869:MainThread](2024-03-27 12:03:29,434) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.065180, valid_loss 1.292327, train_metric nan, valid_metric 0.141079
[2648869:MainThread](2024-03-27 12:03:29,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.065403, valid_loss 1.293789, train_metric nan, valid_metric 0.140058
[2648869:MainThread](2024-03-27 12:03:29,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.056002, valid_loss 1.290057, train_metric nan, valid_metric 0.141127
[2648869:MainThread](2024-03-27 12:03:30,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.060170, valid_loss 1.290983, train_metric nan, valid_metric 0.141499
[2648869:MainThread](2024-03-27 12:03:30,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.067247, valid_loss 1.295039, train_metric nan, valid_metric 0.140229
[2648869:MainThread](2024-03-27 12:03:30,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.051695, valid_loss 1.291510, train_metric nan, valid_metric 0.140473
[2648869:MainThread](2024-03-27 12:03:30,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.054192, valid_loss 1.292864, train_metric nan, valid_metric 0.141033
[2648869:MainThread](2024-03-27 12:03:31,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.067597, valid_loss 1.296295, train_metric nan, valid_metric 0.139204
[2648869:MainThread](2024-03-27 12:03:31,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.054496, valid_loss 1.293142, train_metric nan, valid_metric 0.140446
[2648869:MainThread](2024-03-27 12:03:31,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.054972, valid_loss 1.291234, train_metric nan, valid_metric 0.142279
[2648869:MainThread](2024-03-27 12:03:31,631) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.068461, valid_loss 1.295794, train_metric nan, valid_metric 0.140300
[2648869:MainThread](2024-03-27 12:03:31,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.050630, valid_loss 1.291737, train_metric nan, valid_metric 0.141714
[2648869:MainThread](2024-03-27 12:03:32,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.064459, valid_loss 1.293850, train_metric nan, valid_metric 0.141367
[2648869:MainThread](2024-03-27 12:03:32,250) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.054071, valid_loss 1.287518, train_metric nan, valid_metric 0.142436
[2648869:MainThread](2024-03-27 12:03:32,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 1.056359, valid_loss 1.291267, train_metric nan, valid_metric 0.141635
[2648869:MainThread](2024-03-27 12:03:32,676) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 1.054392, valid_loss 1.286956, train_metric nan, valid_metric 0.141792
[2648869:MainThread](2024-03-27 12:03:32,677) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.286993 to 1.286956, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:32,894) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 1.060830, valid_loss 1.292838, train_metric nan, valid_metric 0.140666
[2648869:MainThread](2024-03-27 12:03:33,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 1.053945, valid_loss 1.291068, train_metric nan, valid_metric 0.142430
[2648869:MainThread](2024-03-27 12:03:33,369) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 1.060655, valid_loss 1.287610, train_metric nan, valid_metric 0.142051
[2648869:MainThread](2024-03-27 12:03:33,583) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 1.055158, valid_loss 1.290734, train_metric nan, valid_metric 0.142483
[2648869:MainThread](2024-03-27 12:03:33,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 1.067212, valid_loss 1.293880, train_metric nan, valid_metric 0.141184
[2648869:MainThread](2024-03-27 12:03:34,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 1.055832, valid_loss 1.294818, train_metric nan, valid_metric 0.141830
[2648869:MainThread](2024-03-27 12:03:34,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 1.057197, valid_loss 1.292881, train_metric nan, valid_metric 0.139998
[2648869:MainThread](2024-03-27 12:03:34,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 1.051877, valid_loss 1.295252, train_metric nan, valid_metric 0.141025
[2648869:MainThread](2024-03-27 12:03:34,732) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 1.067058, valid_loss 1.293304, train_metric nan, valid_metric 0.141465
[2648869:MainThread](2024-03-27 12:03:34,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 1.068377, valid_loss 1.291696, train_metric nan, valid_metric 0.141160
[2648869:MainThread](2024-03-27 12:03:35,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 1.066525, valid_loss 1.296352, train_metric nan, valid_metric 0.139249
[2648869:MainThread](2024-03-27 12:03:35,369) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 1.050952, valid_loss 1.295145, train_metric nan, valid_metric 0.139163
[2648869:MainThread](2024-03-27 12:03:35,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 1.059915, valid_loss 1.289497, train_metric nan, valid_metric 0.142098
[2648869:MainThread](2024-03-27 12:03:35,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 1.060259, valid_loss 1.297741, train_metric nan, valid_metric 0.138559
[2648869:MainThread](2024-03-27 12:03:35,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 1.060642, valid_loss 1.291805, train_metric nan, valid_metric 0.140406
[2648869:MainThread](2024-03-27 12:03:36,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 1.065050, valid_loss 1.290897, train_metric nan, valid_metric 0.140914
[2648869:MainThread](2024-03-27 12:03:36,394) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 1.048987, valid_loss 1.292122, train_metric nan, valid_metric 0.140152
[2648869:MainThread](2024-03-27 12:03:36,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 1.062836, valid_loss 1.291641, train_metric nan, valid_metric 0.141460
[2648869:MainThread](2024-03-27 12:03:36,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 1.061156, valid_loss 1.290452, train_metric nan, valid_metric 0.141236
[2648869:MainThread](2024-03-27 12:03:37,004) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2760]: train_loss 1.051912, valid_loss 1.292441, train_metric nan, valid_metric 0.140305
[2648869:MainThread](2024-03-27 12:03:37,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2780]: train_loss 1.059176, valid_loss 1.296063, train_metric nan, valid_metric 0.139970
[2648869:MainThread](2024-03-27 12:03:37,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2800]: train_loss 1.075699, valid_loss 1.291489, train_metric nan, valid_metric 0.141653
[2648869:MainThread](2024-03-27 12:03:37,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2820]: train_loss 1.064968, valid_loss 1.292600, train_metric nan, valid_metric 0.141871
[2648869:MainThread](2024-03-27 12:03:37,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2840]: train_loss 1.054067, valid_loss 1.287821, train_metric nan, valid_metric 0.142078
[2648869:MainThread](2024-03-27 12:03:38,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2860]: train_loss 1.053154, valid_loss 1.290709, train_metric nan, valid_metric 0.141679
[2648869:MainThread](2024-03-27 12:03:38,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2880]: train_loss 1.057868, valid_loss 1.294582, train_metric nan, valid_metric 0.140241
[2648869:MainThread](2024-03-27 12:03:38,437) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2900]: train_loss 1.064408, valid_loss 1.292589, train_metric nan, valid_metric 0.140721
[2648869:MainThread](2024-03-27 12:03:38,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2920]: train_loss 1.053404, valid_loss 1.297145, train_metric nan, valid_metric 0.139505
[2648869:MainThread](2024-03-27 12:03:38,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2940]: train_loss 1.053453, valid_loss 1.292342, train_metric nan, valid_metric 0.140243
[2648869:MainThread](2024-03-27 12:03:39,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2960]: train_loss 1.051195, valid_loss 1.293249, train_metric nan, valid_metric 0.139922
[2648869:MainThread](2024-03-27 12:03:39,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2980]: train_loss 1.066738, valid_loss 1.291367, train_metric nan, valid_metric 0.140688
[2648869:MainThread](2024-03-27 12:03:39,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3000]: train_loss 1.071893, valid_loss 1.295953, train_metric nan, valid_metric 0.139765
[2648869:MainThread](2024-03-27 12:03:39,659) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3020]: train_loss 1.049533, valid_loss 1.292289, train_metric nan, valid_metric 0.140873
[2648869:MainThread](2024-03-27 12:03:39,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3040]: train_loss 1.060514, valid_loss 1.295168, train_metric nan, valid_metric 0.140917
[2648869:MainThread](2024-03-27 12:03:40,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3060]: train_loss 1.060743, valid_loss 1.294934, train_metric nan, valid_metric 0.141188
[2648869:MainThread](2024-03-27 12:03:40,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3080]: train_loss 1.052151, valid_loss 1.293997, train_metric nan, valid_metric 0.139123
[2648869:MainThread](2024-03-27 12:03:40,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3100]: train_loss 1.060387, valid_loss 1.290525, train_metric nan, valid_metric 0.141741
[2648869:MainThread](2024-03-27 12:03:40,690) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3120]: train_loss 1.063940, valid_loss 1.291825, train_metric nan, valid_metric 0.141762
[2648869:MainThread](2024-03-27 12:03:40,894) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3140]: train_loss 1.060101, valid_loss 1.292768, train_metric nan, valid_metric 0.142215
[2648869:MainThread](2024-03-27 12:03:41,098) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3160]: train_loss 1.073355, valid_loss 1.291454, train_metric nan, valid_metric 0.142086
[2648869:MainThread](2024-03-27 12:03:41,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3180]: train_loss 1.057623, valid_loss 1.290750, train_metric nan, valid_metric 0.142169
[2648869:MainThread](2024-03-27 12:03:41,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3200]: train_loss 1.060191, valid_loss 1.289839, train_metric nan, valid_metric 0.142185
[2648869:MainThread](2024-03-27 12:03:41,712) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3220]: train_loss 1.055060, valid_loss 1.294250, train_metric nan, valid_metric 0.141167
[2648869:MainThread](2024-03-27 12:03:41,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3240]: train_loss 1.055110, valid_loss 1.296466, train_metric nan, valid_metric 0.138657
[2648869:MainThread](2024-03-27 12:03:42,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3260]: train_loss 1.051008, valid_loss 1.292926, train_metric nan, valid_metric 0.140713
[2648869:MainThread](2024-03-27 12:03:42,327) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3280]: train_loss 1.060783, valid_loss 1.295524, train_metric nan, valid_metric 0.141094
[2648869:MainThread](2024-03-27 12:03:42,530) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3300]: train_loss 1.055759, valid_loss 1.296612, train_metric nan, valid_metric 0.140328
[2648869:MainThread](2024-03-27 12:03:42,732) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3320]: train_loss 1.060278, valid_loss 1.293604, train_metric nan, valid_metric 0.141063
[2648869:MainThread](2024-03-27 12:03:42,936) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3340]: train_loss 1.059587, valid_loss 1.289544, train_metric nan, valid_metric 0.142413
[2648869:MainThread](2024-03-27 12:03:43,146) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3360]: train_loss 1.072802, valid_loss 1.292348, train_metric nan, valid_metric 0.141949
[2648869:MainThread](2024-03-27 12:03:43,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:03:43,822) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:03:44,520) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  48%|████▊     | 21/44 [11:06<12:56, 33.76s/it][2648869:MainThread](2024-03-27 12:03:44,527) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:03:44,538) INFO - qlib.workflow - [recorder.py:341] - Recorder 76e1faf531734edb94320b704ec4c5d3 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:03:45,158) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:03:45,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:03:45,163) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:03:45,163) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:03:46,900) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.858295
            SH600004      1.858295
            SH600006      1.858295
            SH600007      1.858295
            SH600008      1.858295
                            ...   
2016-11-10  SZ300144      0.752262
            SZ300146      0.752262
            SZ300168      0.752262
            SZ300251      0.752262
            SZ300315      0.752262
Length: 537043, dtype: float64
[2648869:MainThread](2024-03-27 12:03:47,837) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2016-11-11  SH600000      0.752262
            SH600008      0.752262
            SH600009      0.752262
            SH600010      0.752262
            SH600011      0.752262
                            ...   
2018-08-21  SZ300136      0.803304
            SZ300144      0.803304
            SZ300251      0.803304
            SZ300408      0.803304
            SZ300433      0.803304
Length: 115924, dtype: float64
[2648869:MainThread](2024-03-27 12:03:47,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:03:48,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.909277, valid_loss 1.261168, train_metric nan, valid_metric 0.063049
[2648869:MainThread](2024-03-27 12:03:48,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.261168, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:03:48,624) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.321902, valid_loss 1.257182, train_metric nan, valid_metric 0.040105
[2648869:MainThread](2024-03-27 12:03:48,624) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.261168 to 1.257182, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:48,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.184566, valid_loss 1.246579, train_metric nan, valid_metric 0.087846
[2648869:MainThread](2024-03-27 12:03:48,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.257182 to 1.246579, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:49,039) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.168773, valid_loss 1.245504, train_metric nan, valid_metric 0.091074
[2648869:MainThread](2024-03-27 12:03:49,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.246579 to 1.245504, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:49,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.162347, valid_loss 1.243406, train_metric nan, valid_metric 0.100009
[2648869:MainThread](2024-03-27 12:03:49,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.245504 to 1.243406, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:49,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.189396, valid_loss 1.244642, train_metric nan, valid_metric 0.090847
[2648869:MainThread](2024-03-27 12:03:49,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.201201, valid_loss 1.242496, train_metric nan, valid_metric 0.095093
[2648869:MainThread](2024-03-27 12:03:49,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.243406 to 1.242496, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:49,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.156165, valid_loss 1.243915, train_metric nan, valid_metric 0.095645
[2648869:MainThread](2024-03-27 12:03:50,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.145863, valid_loss 1.244503, train_metric nan, valid_metric 0.099881
[2648869:MainThread](2024-03-27 12:03:50,306) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.167064, valid_loss 1.244488, train_metric nan, valid_metric 0.103987
[2648869:MainThread](2024-03-27 12:03:50,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.122320, valid_loss 1.243060, train_metric nan, valid_metric 0.101797
[2648869:MainThread](2024-03-27 12:03:50,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.107949, valid_loss 1.238861, train_metric nan, valid_metric 0.102690
[2648869:MainThread](2024-03-27 12:03:50,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.242496 to 1.238861, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:50,941) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.124367, valid_loss 1.244557, train_metric nan, valid_metric 0.107801
[2648869:MainThread](2024-03-27 12:03:51,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.137200, valid_loss 1.239625, train_metric nan, valid_metric 0.114121
[2648869:MainThread](2024-03-27 12:03:51,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.115967, valid_loss 1.247447, train_metric nan, valid_metric 0.103796
[2648869:MainThread](2024-03-27 12:03:51,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.113011, valid_loss 1.242638, train_metric nan, valid_metric 0.099925
[2648869:MainThread](2024-03-27 12:03:51,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.088145, valid_loss 1.244783, train_metric nan, valid_metric 0.115824
[2648869:MainThread](2024-03-27 12:03:51,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.092718, valid_loss 1.239332, train_metric nan, valid_metric 0.118641
[2648869:MainThread](2024-03-27 12:03:52,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.108737, valid_loss 1.247875, train_metric nan, valid_metric 0.091270
[2648869:MainThread](2024-03-27 12:03:52,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.115109, valid_loss 1.238509, train_metric nan, valid_metric 0.121854
[2648869:MainThread](2024-03-27 12:03:52,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.238861 to 1.238509, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:52,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.081140, valid_loss 1.242258, train_metric nan, valid_metric 0.120549
[2648869:MainThread](2024-03-27 12:03:52,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.097813, valid_loss 1.242030, train_metric nan, valid_metric 0.114490
[2648869:MainThread](2024-03-27 12:03:53,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.159204, valid_loss 1.239440, train_metric nan, valid_metric 0.121715
[2648869:MainThread](2024-03-27 12:03:53,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.135763, valid_loss 1.237554, train_metric nan, valid_metric 0.121395
[2648869:MainThread](2024-03-27 12:03:53,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.238509 to 1.237554, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:53,434) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.110030, valid_loss 1.238949, train_metric nan, valid_metric 0.118421
[2648869:MainThread](2024-03-27 12:03:53,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.082850, valid_loss 1.239449, train_metric nan, valid_metric 0.120497
[2648869:MainThread](2024-03-27 12:03:53,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.095488, valid_loss 1.238782, train_metric nan, valid_metric 0.121996
[2648869:MainThread](2024-03-27 12:03:54,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.090344, valid_loss 1.240121, train_metric nan, valid_metric 0.126182
[2648869:MainThread](2024-03-27 12:03:54,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.095587, valid_loss 1.241483, train_metric nan, valid_metric 0.124715
[2648869:MainThread](2024-03-27 12:03:54,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.105938, valid_loss 1.241013, train_metric nan, valid_metric 0.121634
[2648869:MainThread](2024-03-27 12:03:54,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.071817, valid_loss 1.235275, train_metric nan, valid_metric 0.128265
[2648869:MainThread](2024-03-27 12:03:54,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.237554 to 1.235275, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:54,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.091132, valid_loss 1.236221, train_metric nan, valid_metric 0.125367
[2648869:MainThread](2024-03-27 12:03:55,073) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.127409, valid_loss 1.235411, train_metric nan, valid_metric 0.128829
[2648869:MainThread](2024-03-27 12:03:55,278) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.090686, valid_loss 1.240236, train_metric nan, valid_metric 0.123081
[2648869:MainThread](2024-03-27 12:03:55,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.099773, valid_loss 1.234565, train_metric nan, valid_metric 0.122149
[2648869:MainThread](2024-03-27 12:03:55,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.235275 to 1.234565, save checkpoint.
[2648869:MainThread](2024-03-27 12:03:55,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.094229, valid_loss 1.237408, train_metric nan, valid_metric 0.124102
[2648869:MainThread](2024-03-27 12:03:55,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.070110, valid_loss 1.235682, train_metric nan, valid_metric 0.120257
[2648869:MainThread](2024-03-27 12:03:56,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.122033, valid_loss 1.238718, train_metric nan, valid_metric 0.124177
[2648869:MainThread](2024-03-27 12:03:56,297) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.072741, valid_loss 1.235159, train_metric nan, valid_metric 0.127328
[2648869:MainThread](2024-03-27 12:03:56,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.099830, valid_loss 1.243276, train_metric nan, valid_metric 0.118816
[2648869:MainThread](2024-03-27 12:03:56,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.080255, valid_loss 1.237985, train_metric nan, valid_metric 0.121976
[2648869:MainThread](2024-03-27 12:03:56,895) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.054319, valid_loss 1.238227, train_metric nan, valid_metric 0.126760
[2648869:MainThread](2024-03-27 12:03:57,102) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.073255, valid_loss 1.237293, train_metric nan, valid_metric 0.129574
[2648869:MainThread](2024-03-27 12:03:57,306) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.108782, valid_loss 1.240352, train_metric nan, valid_metric 0.131450
[2648869:MainThread](2024-03-27 12:03:57,508) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.090225, valid_loss 1.242141, train_metric nan, valid_metric 0.120784
[2648869:MainThread](2024-03-27 12:03:57,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.081728, valid_loss 1.238359, train_metric nan, valid_metric 0.126019
[2648869:MainThread](2024-03-27 12:03:57,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.061794, valid_loss 1.234654, train_metric nan, valid_metric 0.124835
[2648869:MainThread](2024-03-27 12:03:58,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.067329, valid_loss 1.239997, train_metric nan, valid_metric 0.128227
[2648869:MainThread](2024-03-27 12:03:58,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.087165, valid_loss 1.237983, train_metric nan, valid_metric 0.125225
[2648869:MainThread](2024-03-27 12:03:58,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.067522, valid_loss 1.237988, train_metric nan, valid_metric 0.127862
[2648869:MainThread](2024-03-27 12:03:58,762) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.071819, valid_loss 1.237535, train_metric nan, valid_metric 0.131098
[2648869:MainThread](2024-03-27 12:03:58,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.049537, valid_loss 1.235461, train_metric nan, valid_metric 0.130821
[2648869:MainThread](2024-03-27 12:03:59,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.075078, valid_loss 1.237162, train_metric nan, valid_metric 0.130294
[2648869:MainThread](2024-03-27 12:03:59,378) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.076014, valid_loss 1.234968, train_metric nan, valid_metric 0.128976
[2648869:MainThread](2024-03-27 12:03:59,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.070632, valid_loss 1.240274, train_metric nan, valid_metric 0.121202
[2648869:MainThread](2024-03-27 12:03:59,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.083617, valid_loss 1.237961, train_metric nan, valid_metric 0.124262
[2648869:MainThread](2024-03-27 12:04:00,004) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.069628, valid_loss 1.235752, train_metric nan, valid_metric 0.130040
[2648869:MainThread](2024-03-27 12:04:00,213) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.058847, valid_loss 1.240192, train_metric nan, valid_metric 0.122803
[2648869:MainThread](2024-03-27 12:04:00,425) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.065348, valid_loss 1.236177, train_metric nan, valid_metric 0.127105
[2648869:MainThread](2024-03-27 12:04:00,638) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.056786, valid_loss 1.235895, train_metric nan, valid_metric 0.130654
[2648869:MainThread](2024-03-27 12:04:00,885) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.069005, valid_loss 1.235420, train_metric nan, valid_metric 0.128110
[2648869:MainThread](2024-03-27 12:04:01,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.067636, valid_loss 1.235056, train_metric nan, valid_metric 0.130915
[2648869:MainThread](2024-03-27 12:04:01,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.073908, valid_loss 1.237028, train_metric nan, valid_metric 0.126465
[2648869:MainThread](2024-03-27 12:04:01,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.070454, valid_loss 1.235894, train_metric nan, valid_metric 0.130890
[2648869:MainThread](2024-03-27 12:04:01,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.052912, valid_loss 1.240652, train_metric nan, valid_metric 0.127914
[2648869:MainThread](2024-03-27 12:04:02,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.062096, valid_loss 1.238641, train_metric nan, valid_metric 0.127772
[2648869:MainThread](2024-03-27 12:04:02,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.066119, valid_loss 1.239971, train_metric nan, valid_metric 0.128179
[2648869:MainThread](2024-03-27 12:04:02,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.075700, valid_loss 1.235600, train_metric nan, valid_metric 0.127963
[2648869:MainThread](2024-03-27 12:04:02,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.064630, valid_loss 1.238833, train_metric nan, valid_metric 0.128830
[2648869:MainThread](2024-03-27 12:04:03,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.084203, valid_loss 1.238739, train_metric nan, valid_metric 0.130406
[2648869:MainThread](2024-03-27 12:04:03,413) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.071643, valid_loss 1.237157, train_metric nan, valid_metric 0.130884
[2648869:MainThread](2024-03-27 12:04:03,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.055706, valid_loss 1.235902, train_metric nan, valid_metric 0.131388
[2648869:MainThread](2024-03-27 12:04:03,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.061907, valid_loss 1.234490, train_metric nan, valid_metric 0.131504
[2648869:MainThread](2024-03-27 12:04:03,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.234565 to 1.234490, save checkpoint.
[2648869:MainThread](2024-03-27 12:04:04,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.058351, valid_loss 1.236038, train_metric nan, valid_metric 0.132086
[2648869:MainThread](2024-03-27 12:04:04,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.070970, valid_loss 1.235497, train_metric nan, valid_metric 0.130859
[2648869:MainThread](2024-03-27 12:04:04,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.071092, valid_loss 1.236124, train_metric nan, valid_metric 0.130516
[2648869:MainThread](2024-03-27 12:04:04,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.066008, valid_loss 1.238568, train_metric nan, valid_metric 0.129092
[2648869:MainThread](2024-03-27 12:04:05,143) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.069077, valid_loss 1.235412, train_metric nan, valid_metric 0.130356
[2648869:MainThread](2024-03-27 12:04:05,349) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.060009, valid_loss 1.240569, train_metric nan, valid_metric 0.128146
[2648869:MainThread](2024-03-27 12:04:05,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.076916, valid_loss 1.234725, train_metric nan, valid_metric 0.131983
[2648869:MainThread](2024-03-27 12:04:05,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.060810, valid_loss 1.237862, train_metric nan, valid_metric 0.130999
[2648869:MainThread](2024-03-27 12:04:05,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.065680, valid_loss 1.236664, train_metric nan, valid_metric 0.132258
[2648869:MainThread](2024-03-27 12:04:06,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.069775, valid_loss 1.240559, train_metric nan, valid_metric 0.127174
[2648869:MainThread](2024-03-27 12:04:06,371) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.057716, valid_loss 1.240637, train_metric nan, valid_metric 0.126707
[2648869:MainThread](2024-03-27 12:04:06,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.064542, valid_loss 1.236072, train_metric nan, valid_metric 0.131994
[2648869:MainThread](2024-03-27 12:04:06,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.054033, valid_loss 1.240403, train_metric nan, valid_metric 0.128498
[2648869:MainThread](2024-03-27 12:04:06,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.057100, valid_loss 1.240273, train_metric nan, valid_metric 0.128966
[2648869:MainThread](2024-03-27 12:04:07,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.055153, valid_loss 1.237896, train_metric nan, valid_metric 0.129394
[2648869:MainThread](2024-03-27 12:04:07,385) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.054266, valid_loss 1.236227, train_metric nan, valid_metric 0.131514
[2648869:MainThread](2024-03-27 12:04:07,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.049228, valid_loss 1.238342, train_metric nan, valid_metric 0.130483
[2648869:MainThread](2024-03-27 12:04:07,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.064735, valid_loss 1.235700, train_metric nan, valid_metric 0.132196
[2648869:MainThread](2024-03-27 12:04:07,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.046415, valid_loss 1.238753, train_metric nan, valid_metric 0.131615
[2648869:MainThread](2024-03-27 12:04:08,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.053779, valid_loss 1.235566, train_metric nan, valid_metric 0.131452
[2648869:MainThread](2024-03-27 12:04:08,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.053246, valid_loss 1.236683, train_metric nan, valid_metric 0.130358
[2648869:MainThread](2024-03-27 12:04:08,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.056044, valid_loss 1.236126, train_metric nan, valid_metric 0.131835
[2648869:MainThread](2024-03-27 12:04:08,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.062629, valid_loss 1.238692, train_metric nan, valid_metric 0.129934
[2648869:MainThread](2024-03-27 12:04:09,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.058762, valid_loss 1.234891, train_metric nan, valid_metric 0.131945
[2648869:MainThread](2024-03-27 12:04:09,214) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.064117, valid_loss 1.235556, train_metric nan, valid_metric 0.131450
[2648869:MainThread](2024-03-27 12:04:09,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.048780, valid_loss 1.236325, train_metric nan, valid_metric 0.130874
[2648869:MainThread](2024-03-27 12:04:09,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.060839, valid_loss 1.241014, train_metric nan, valid_metric 0.130135
[2648869:MainThread](2024-03-27 12:04:09,817) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.051685, valid_loss 1.237128, train_metric nan, valid_metric 0.132231
[2648869:MainThread](2024-03-27 12:04:10,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.048973, valid_loss 1.237711, train_metric nan, valid_metric 0.131073
[2648869:MainThread](2024-03-27 12:04:10,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.059521, valid_loss 1.238504, train_metric nan, valid_metric 0.129371
[2648869:MainThread](2024-03-27 12:04:10,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.063453, valid_loss 1.240438, train_metric nan, valid_metric 0.129770
[2648869:MainThread](2024-03-27 12:04:10,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.054380, valid_loss 1.237701, train_metric nan, valid_metric 0.130708
[2648869:MainThread](2024-03-27 12:04:10,895) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.057193, valid_loss 1.240060, train_metric nan, valid_metric 0.130007
[2648869:MainThread](2024-03-27 12:04:11,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.066936, valid_loss 1.240891, train_metric nan, valid_metric 0.129647
[2648869:MainThread](2024-03-27 12:04:11,306) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.065278, valid_loss 1.236229, train_metric nan, valid_metric 0.131604
[2648869:MainThread](2024-03-27 12:04:11,511) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.047885, valid_loss 1.240412, train_metric nan, valid_metric 0.128678
[2648869:MainThread](2024-03-27 12:04:11,716) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.052000, valid_loss 1.236564, train_metric nan, valid_metric 0.131150
[2648869:MainThread](2024-03-27 12:04:11,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.057625, valid_loss 1.238894, train_metric nan, valid_metric 0.131507
[2648869:MainThread](2024-03-27 12:04:12,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.054022, valid_loss 1.242423, train_metric nan, valid_metric 0.128906
[2648869:MainThread](2024-03-27 12:04:12,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.046211, valid_loss 1.240269, train_metric nan, valid_metric 0.129870
[2648869:MainThread](2024-03-27 12:04:12,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.055311, valid_loss 1.238763, train_metric nan, valid_metric 0.130416
[2648869:MainThread](2024-03-27 12:04:12,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.058801, valid_loss 1.233255, train_metric nan, valid_metric 0.132424
[2648869:MainThread](2024-03-27 12:04:12,746) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.234490 to 1.233255, save checkpoint.
[2648869:MainThread](2024-03-27 12:04:12,953) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.072383, valid_loss 1.237002, train_metric nan, valid_metric 0.131601
[2648869:MainThread](2024-03-27 12:04:13,156) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 1.060168, valid_loss 1.236375, train_metric nan, valid_metric 0.131565
[2648869:MainThread](2024-03-27 12:04:13,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 1.053181, valid_loss 1.235150, train_metric nan, valid_metric 0.132113
[2648869:MainThread](2024-03-27 12:04:13,623) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 1.055360, valid_loss 1.238944, train_metric nan, valid_metric 0.129483
[2648869:MainThread](2024-03-27 12:04:13,876) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 1.056198, valid_loss 1.235879, train_metric nan, valid_metric 0.131564
[2648869:MainThread](2024-03-27 12:04:14,125) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 1.057094, valid_loss 1.236109, train_metric nan, valid_metric 0.131209
[2648869:MainThread](2024-03-27 12:04:14,378) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 1.051835, valid_loss 1.234201, train_metric nan, valid_metric 0.131794
[2648869:MainThread](2024-03-27 12:04:14,629) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 1.052167, valid_loss 1.237342, train_metric nan, valid_metric 0.130195
[2648869:MainThread](2024-03-27 12:04:14,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 1.065714, valid_loss 1.241378, train_metric nan, valid_metric 0.127155
[2648869:MainThread](2024-03-27 12:04:15,132) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 1.060913, valid_loss 1.236233, train_metric nan, valid_metric 0.130861
[2648869:MainThread](2024-03-27 12:04:15,383) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 1.084226, valid_loss 1.239648, train_metric nan, valid_metric 0.130179
[2648869:MainThread](2024-03-27 12:04:15,635) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 1.055372, valid_loss 1.234953, train_metric nan, valid_metric 0.131968
[2648869:MainThread](2024-03-27 12:04:15,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 1.069902, valid_loss 1.238724, train_metric nan, valid_metric 0.129858
[2648869:MainThread](2024-03-27 12:04:16,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 1.062189, valid_loss 1.237137, train_metric nan, valid_metric 0.131270
[2648869:MainThread](2024-03-27 12:04:16,257) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 1.057850, valid_loss 1.235232, train_metric nan, valid_metric 0.130629
[2648869:MainThread](2024-03-27 12:04:16,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 1.062556, valid_loss 1.238525, train_metric nan, valid_metric 0.130717
[2648869:MainThread](2024-03-27 12:04:16,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 1.056144, valid_loss 1.238711, train_metric nan, valid_metric 0.129574
[2648869:MainThread](2024-03-27 12:04:16,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 1.065847, valid_loss 1.237695, train_metric nan, valid_metric 0.130349
[2648869:MainThread](2024-03-27 12:04:17,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 1.048475, valid_loss 1.234217, train_metric nan, valid_metric 0.132718
[2648869:MainThread](2024-03-27 12:04:17,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 1.051326, valid_loss 1.239925, train_metric nan, valid_metric 0.129524
[2648869:MainThread](2024-03-27 12:04:17,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 1.058568, valid_loss 1.237424, train_metric nan, valid_metric 0.131117
[2648869:MainThread](2024-03-27 12:04:17,691) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 1.069037, valid_loss 1.239534, train_metric nan, valid_metric 0.129831
[2648869:MainThread](2024-03-27 12:04:17,894) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2760]: train_loss 1.047046, valid_loss 1.236593, train_metric nan, valid_metric 0.132149
[2648869:MainThread](2024-03-27 12:04:18,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2780]: train_loss 1.056856, valid_loss 1.236712, train_metric nan, valid_metric 0.131539
[2648869:MainThread](2024-03-27 12:04:18,300) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2800]: train_loss 1.061327, valid_loss 1.236327, train_metric nan, valid_metric 0.131626
[2648869:MainThread](2024-03-27 12:04:18,505) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2820]: train_loss 1.059955, valid_loss 1.241803, train_metric nan, valid_metric 0.128298
[2648869:MainThread](2024-03-27 12:04:18,710) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2840]: train_loss 1.075035, valid_loss 1.236835, train_metric nan, valid_metric 0.130709
[2648869:MainThread](2024-03-27 12:04:18,912) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2860]: train_loss 1.049765, valid_loss 1.237824, train_metric nan, valid_metric 0.132203
[2648869:MainThread](2024-03-27 12:04:19,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2880]: train_loss 1.052247, valid_loss 1.237864, train_metric nan, valid_metric 0.131128
[2648869:MainThread](2024-03-27 12:04:19,327) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2900]: train_loss 1.056524, valid_loss 1.239414, train_metric nan, valid_metric 0.130753
[2648869:MainThread](2024-03-27 12:04:19,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2920]: train_loss 1.060331, valid_loss 1.238530, train_metric nan, valid_metric 0.131352
[2648869:MainThread](2024-03-27 12:04:19,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2940]: train_loss 1.054602, valid_loss 1.234797, train_metric nan, valid_metric 0.132063
[2648869:MainThread](2024-03-27 12:04:19,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2960]: train_loss 1.063134, valid_loss 1.237670, train_metric nan, valid_metric 0.132048
[2648869:MainThread](2024-03-27 12:04:20,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2980]: train_loss 1.061526, valid_loss 1.237563, train_metric nan, valid_metric 0.130388
[2648869:MainThread](2024-03-27 12:04:20,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3000]: train_loss 1.041621, valid_loss 1.237186, train_metric nan, valid_metric 0.132261
[2648869:MainThread](2024-03-27 12:04:20,550) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3020]: train_loss 1.065393, valid_loss 1.238631, train_metric nan, valid_metric 0.130476
[2648869:MainThread](2024-03-27 12:04:20,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3040]: train_loss 1.078350, valid_loss 1.238083, train_metric nan, valid_metric 0.130537
[2648869:MainThread](2024-03-27 12:04:20,957) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3060]: train_loss 1.050597, valid_loss 1.234809, train_metric nan, valid_metric 0.132166
[2648869:MainThread](2024-03-27 12:04:21,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3080]: train_loss 1.052838, valid_loss 1.231715, train_metric nan, valid_metric 0.132450
[2648869:MainThread](2024-03-27 12:04:21,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.233255 to 1.231715, save checkpoint.
[2648869:MainThread](2024-03-27 12:04:21,369) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3100]: train_loss 1.061677, valid_loss 1.236201, train_metric nan, valid_metric 0.131276
[2648869:MainThread](2024-03-27 12:04:21,578) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3120]: train_loss 1.070821, valid_loss 1.231923, train_metric nan, valid_metric 0.132706
[2648869:MainThread](2024-03-27 12:04:21,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3140]: train_loss 1.063528, valid_loss 1.240214, train_metric nan, valid_metric 0.130608
[2648869:MainThread](2024-03-27 12:04:21,996) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3160]: train_loss 1.069600, valid_loss 1.240926, train_metric nan, valid_metric 0.129962
[2648869:MainThread](2024-03-27 12:04:22,205) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3180]: train_loss 1.059430, valid_loss 1.241153, train_metric nan, valid_metric 0.130531
[2648869:MainThread](2024-03-27 12:04:22,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3200]: train_loss 1.056660, valid_loss 1.239287, train_metric nan, valid_metric 0.130628
[2648869:MainThread](2024-03-27 12:04:22,621) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3220]: train_loss 1.051810, valid_loss 1.236889, train_metric nan, valid_metric 0.130507
[2648869:MainThread](2024-03-27 12:04:22,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3240]: train_loss 1.055286, valid_loss 1.234871, train_metric nan, valid_metric 0.133001
[2648869:MainThread](2024-03-27 12:04:23,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3260]: train_loss 1.057261, valid_loss 1.236619, train_metric nan, valid_metric 0.130148
[2648869:MainThread](2024-03-27 12:04:23,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3280]: train_loss 1.064282, valid_loss 1.234380, train_metric nan, valid_metric 0.132556
[2648869:MainThread](2024-03-27 12:04:23,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3300]: train_loss 1.064526, valid_loss 1.238084, train_metric nan, valid_metric 0.131117
[2648869:MainThread](2024-03-27 12:04:23,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3320]: train_loss 1.061083, valid_loss 1.237653, train_metric nan, valid_metric 0.132371
[2648869:MainThread](2024-03-27 12:04:23,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3340]: train_loss 1.052462, valid_loss 1.236022, train_metric nan, valid_metric 0.132499
[2648869:MainThread](2024-03-27 12:04:24,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3360]: train_loss 1.062949, valid_loss 1.237638, train_metric nan, valid_metric 0.132433
[2648869:MainThread](2024-03-27 12:04:24,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3380]: train_loss 1.063447, valid_loss 1.235233, train_metric nan, valid_metric 0.131538
[2648869:MainThread](2024-03-27 12:04:24,484) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3400]: train_loss 1.060645, valid_loss 1.241199, train_metric nan, valid_metric 0.130640
[2648869:MainThread](2024-03-27 12:04:24,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3420]: train_loss 1.069640, valid_loss 1.237791, train_metric nan, valid_metric 0.130243
[2648869:MainThread](2024-03-27 12:04:24,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3440]: train_loss 1.045749, valid_loss 1.239166, train_metric nan, valid_metric 0.129891
[2648869:MainThread](2024-03-27 12:04:25,196) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3460]: train_loss 1.050058, valid_loss 1.237779, train_metric nan, valid_metric 0.130946
[2648869:MainThread](2024-03-27 12:04:25,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3480]: train_loss 1.057901, valid_loss 1.238670, train_metric nan, valid_metric 0.130425
[2648869:MainThread](2024-03-27 12:04:25,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3500]: train_loss 1.057813, valid_loss 1.238362, train_metric nan, valid_metric 0.131070
[2648869:MainThread](2024-03-27 12:04:25,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3520]: train_loss 1.062818, valid_loss 1.236033, train_metric nan, valid_metric 0.130640
[2648869:MainThread](2024-03-27 12:04:26,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3540]: train_loss 1.063427, valid_loss 1.239003, train_metric nan, valid_metric 0.130932
[2648869:MainThread](2024-03-27 12:04:26,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3560]: train_loss 1.048681, valid_loss 1.235232, train_metric nan, valid_metric 0.131784
[2648869:MainThread](2024-03-27 12:04:26,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3580]: train_loss 1.058544, valid_loss 1.240798, train_metric nan, valid_metric 0.129224
[2648869:MainThread](2024-03-27 12:04:26,744) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3600]: train_loss 1.056391, valid_loss 1.233437, train_metric nan, valid_metric 0.132974
[2648869:MainThread](2024-03-27 12:04:26,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3620]: train_loss 1.060454, valid_loss 1.237998, train_metric nan, valid_metric 0.130034
[2648869:MainThread](2024-03-27 12:04:27,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3640]: train_loss 1.066096, valid_loss 1.235790, train_metric nan, valid_metric 0.131730
[2648869:MainThread](2024-03-27 12:04:27,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3660]: train_loss 1.055043, valid_loss 1.237060, train_metric nan, valid_metric 0.129813
[2648869:MainThread](2024-03-27 12:04:27,567) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3680]: train_loss 1.064139, valid_loss 1.235948, train_metric nan, valid_metric 0.132772
[2648869:MainThread](2024-03-27 12:04:27,771) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3700]: train_loss 1.072462, valid_loss 1.234675, train_metric nan, valid_metric 0.132101
[2648869:MainThread](2024-03-27 12:04:27,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3720]: train_loss 1.060026, valid_loss 1.238829, train_metric nan, valid_metric 0.130756
[2648869:MainThread](2024-03-27 12:04:28,223) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3740]: train_loss 1.051549, valid_loss 1.233041, train_metric nan, valid_metric 0.133271
[2648869:MainThread](2024-03-27 12:04:28,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3760]: train_loss 1.076155, valid_loss 1.238351, train_metric nan, valid_metric 0.131459
[2648869:MainThread](2024-03-27 12:04:28,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3780]: train_loss 1.054771, valid_loss 1.239588, train_metric nan, valid_metric 0.128516
[2648869:MainThread](2024-03-27 12:04:28,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3800]: train_loss 1.065675, valid_loss 1.237261, train_metric nan, valid_metric 0.129186
[2648869:MainThread](2024-03-27 12:04:29,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3820]: train_loss 1.056256, valid_loss 1.234505, train_metric nan, valid_metric 0.131378
[2648869:MainThread](2024-03-27 12:04:29,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3840]: train_loss 1.059087, valid_loss 1.235933, train_metric nan, valid_metric 0.132429
[2648869:MainThread](2024-03-27 12:04:29,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3860]: train_loss 1.062565, valid_loss 1.234382, train_metric nan, valid_metric 0.132732
[2648869:MainThread](2024-03-27 12:04:29,756) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3880]: train_loss 1.052788, valid_loss 1.241818, train_metric nan, valid_metric 0.127641
[2648869:MainThread](2024-03-27 12:04:30,005) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3900]: train_loss 1.044445, valid_loss 1.238749, train_metric nan, valid_metric 0.131164
[2648869:MainThread](2024-03-27 12:04:30,255) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3920]: train_loss 1.060314, valid_loss 1.237810, train_metric nan, valid_metric 0.132198
[2648869:MainThread](2024-03-27 12:04:30,470) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3940]: train_loss 1.056285, valid_loss 1.236046, train_metric nan, valid_metric 0.132726
[2648869:MainThread](2024-03-27 12:04:30,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3960]: train_loss 1.063317, valid_loss 1.234269, train_metric nan, valid_metric 0.132398
[2648869:MainThread](2024-03-27 12:04:30,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3980]: train_loss 1.055604, valid_loss 1.238948, train_metric nan, valid_metric 0.130711
[2648869:MainThread](2024-03-27 12:04:31,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4000]: train_loss 1.060654, valid_loss 1.236760, train_metric nan, valid_metric 0.131598
[2648869:MainThread](2024-03-27 12:04:31,300) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4020]: train_loss 1.047083, valid_loss 1.239272, train_metric nan, valid_metric 0.129725
[2648869:MainThread](2024-03-27 12:04:31,508) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4040]: train_loss 1.065105, valid_loss 1.234237, train_metric nan, valid_metric 0.132799
[2648869:MainThread](2024-03-27 12:04:31,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4060]: train_loss 1.054934, valid_loss 1.237211, train_metric nan, valid_metric 0.132054
[2648869:MainThread](2024-03-27 12:04:31,970) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4080]: train_loss 1.064728, valid_loss 1.239252, train_metric nan, valid_metric 0.130750
[2648869:MainThread](2024-03-27 12:04:31,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:04:32,646) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:04:33,344) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  50%|█████     | 22/44 [11:55<14:02, 38.28s/it][2648869:MainThread](2024-03-27 12:04:33,351) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:04:33,362) INFO - qlib.workflow - [recorder.py:341] - Recorder e4ea0059f7664843a14f2fa41f58024c starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:04:33,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:04:33,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:04:33,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:04:33,983) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:04:35,721) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.496143
            SH600004      1.496143
            SH600006      1.496143
            SH600007      1.496143
            SH600008      1.496143
                            ...   
2016-12-08  SZ300144      1.774225
            SZ300146      1.774225
            SZ300168      1.774225
            SZ300251      1.774225
            SZ300315      1.774225
Length: 542499, dtype: float64
[2648869:MainThread](2024-03-27 12:04:36,659) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2016-12-09  SH600000      1.774225
            SH600008      1.774225
            SH600009      1.774225
            SH600010      1.774225
            SH600011      1.774225
                            ...   
2018-09-18  SZ300136      0.782767
            SZ300144      0.782767
            SZ300251      0.782767
            SZ300408      0.782767
            SZ300433      0.782767
Length: 116014, dtype: float64
[2648869:MainThread](2024-03-27 12:04:36,762) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:04:37,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.462951, valid_loss 1.247065, train_metric nan, valid_metric 0.051723
[2648869:MainThread](2024-03-27 12:04:37,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.247065, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:04:37,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.181284, valid_loss 1.225900, train_metric nan, valid_metric 0.085269
[2648869:MainThread](2024-03-27 12:04:37,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.247065 to 1.225900, save checkpoint.
[2648869:MainThread](2024-03-27 12:04:37,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.159030, valid_loss 1.226673, train_metric nan, valid_metric 0.086593
[2648869:MainThread](2024-03-27 12:04:37,941) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.126106, valid_loss 1.225869, train_metric nan, valid_metric 0.098506
[2648869:MainThread](2024-03-27 12:04:37,941) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.225900 to 1.225869, save checkpoint.
[2648869:MainThread](2024-03-27 12:04:38,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.124469, valid_loss 1.224302, train_metric nan, valid_metric 0.104979
[2648869:MainThread](2024-03-27 12:04:38,148) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.225869 to 1.224302, save checkpoint.
[2648869:MainThread](2024-03-27 12:04:38,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.105208, valid_loss 1.221814, train_metric nan, valid_metric 0.102364
[2648869:MainThread](2024-03-27 12:04:38,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.224302 to 1.221814, save checkpoint.
[2648869:MainThread](2024-03-27 12:04:38,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.083567, valid_loss 1.223840, train_metric nan, valid_metric 0.112846
[2648869:MainThread](2024-03-27 12:04:38,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.097597, valid_loss 1.219918, train_metric nan, valid_metric 0.117263
[2648869:MainThread](2024-03-27 12:04:38,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.221814 to 1.219918, save checkpoint.
[2648869:MainThread](2024-03-27 12:04:38,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.074537, valid_loss 1.230131, train_metric nan, valid_metric 0.110906
[2648869:MainThread](2024-03-27 12:04:39,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.073355, valid_loss 1.217369, train_metric nan, valid_metric 0.121896
[2648869:MainThread](2024-03-27 12:04:39,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.219918 to 1.217369, save checkpoint.
[2648869:MainThread](2024-03-27 12:04:39,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.069190, valid_loss 1.222972, train_metric nan, valid_metric 0.117873
[2648869:MainThread](2024-03-27 12:04:39,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.055379, valid_loss 1.218678, train_metric nan, valid_metric 0.120998
[2648869:MainThread](2024-03-27 12:04:39,909) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.073118, valid_loss 1.220308, train_metric nan, valid_metric 0.121581
[2648869:MainThread](2024-03-27 12:04:40,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.044163, valid_loss 1.225033, train_metric nan, valid_metric 0.109072
[2648869:MainThread](2024-03-27 12:04:40,316) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.078312, valid_loss 1.214880, train_metric nan, valid_metric 0.125848
[2648869:MainThread](2024-03-27 12:04:40,316) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.217369 to 1.214880, save checkpoint.
[2648869:MainThread](2024-03-27 12:04:40,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.068581, valid_loss 1.220063, train_metric nan, valid_metric 0.128746
[2648869:MainThread](2024-03-27 12:04:40,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.052500, valid_loss 1.218577, train_metric nan, valid_metric 0.125325
[2648869:MainThread](2024-03-27 12:04:40,980) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.060407, valid_loss 1.215392, train_metric nan, valid_metric 0.128910
[2648869:MainThread](2024-03-27 12:04:41,187) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.067310, valid_loss 1.221280, train_metric nan, valid_metric 0.116860
[2648869:MainThread](2024-03-27 12:04:41,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.048389, valid_loss 1.220174, train_metric nan, valid_metric 0.123794
[2648869:MainThread](2024-03-27 12:04:41,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.043254, valid_loss 1.219386, train_metric nan, valid_metric 0.132146
[2648869:MainThread](2024-03-27 12:04:41,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.043087, valid_loss 1.217252, train_metric nan, valid_metric 0.127991
[2648869:MainThread](2024-03-27 12:04:42,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.031756, valid_loss 1.216078, train_metric nan, valid_metric 0.133242
[2648869:MainThread](2024-03-27 12:04:42,214) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.033766, valid_loss 1.217703, train_metric nan, valid_metric 0.131728
[2648869:MainThread](2024-03-27 12:04:42,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.039972, valid_loss 1.217989, train_metric nan, valid_metric 0.132522
[2648869:MainThread](2024-03-27 12:04:42,624) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.043029, valid_loss 1.219853, train_metric nan, valid_metric 0.132435
[2648869:MainThread](2024-03-27 12:04:42,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.038607, valid_loss 1.218511, train_metric nan, valid_metric 0.130451
[2648869:MainThread](2024-03-27 12:04:43,031) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.040447, valid_loss 1.217842, train_metric nan, valid_metric 0.132426
[2648869:MainThread](2024-03-27 12:04:43,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.043715, valid_loss 1.216999, train_metric nan, valid_metric 0.133334
[2648869:MainThread](2024-03-27 12:04:43,442) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.025706, valid_loss 1.218722, train_metric nan, valid_metric 0.135638
[2648869:MainThread](2024-03-27 12:04:43,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.044813, valid_loss 1.217275, train_metric nan, valid_metric 0.135009
[2648869:MainThread](2024-03-27 12:04:43,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.027662, valid_loss 1.218020, train_metric nan, valid_metric 0.136106
[2648869:MainThread](2024-03-27 12:04:44,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.035020, valid_loss 1.217231, train_metric nan, valid_metric 0.136795
[2648869:MainThread](2024-03-27 12:04:44,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.027121, valid_loss 1.214552, train_metric nan, valid_metric 0.134291
[2648869:MainThread](2024-03-27 12:04:44,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.214880 to 1.214552, save checkpoint.
[2648869:MainThread](2024-03-27 12:04:44,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.035178, valid_loss 1.214010, train_metric nan, valid_metric 0.133155
[2648869:MainThread](2024-03-27 12:04:44,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.214552 to 1.214010, save checkpoint.
[2648869:MainThread](2024-03-27 12:04:44,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.029083, valid_loss 1.215343, train_metric nan, valid_metric 0.134652
[2648869:MainThread](2024-03-27 12:04:44,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.038760, valid_loss 1.214556, train_metric nan, valid_metric 0.133759
[2648869:MainThread](2024-03-27 12:04:45,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.031744, valid_loss 1.214493, train_metric nan, valid_metric 0.135134
[2648869:MainThread](2024-03-27 12:04:45,325) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.030991, valid_loss 1.218537, train_metric nan, valid_metric 0.132988
[2648869:MainThread](2024-03-27 12:04:45,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.042631, valid_loss 1.213585, train_metric nan, valid_metric 0.137626
[2648869:MainThread](2024-03-27 12:04:45,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.214010 to 1.213585, save checkpoint.
[2648869:MainThread](2024-03-27 12:04:45,755) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.019673, valid_loss 1.216382, train_metric nan, valid_metric 0.133784
[2648869:MainThread](2024-03-27 12:04:45,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.040961, valid_loss 1.216487, train_metric nan, valid_metric 0.137009
[2648869:MainThread](2024-03-27 12:04:46,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.021651, valid_loss 1.214861, train_metric nan, valid_metric 0.137141
[2648869:MainThread](2024-03-27 12:04:46,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.030314, valid_loss 1.215757, train_metric nan, valid_metric 0.133705
[2648869:MainThread](2024-03-27 12:04:46,691) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.030606, valid_loss 1.216150, train_metric nan, valid_metric 0.134473
[2648869:MainThread](2024-03-27 12:04:46,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.034538, valid_loss 1.214223, train_metric nan, valid_metric 0.133898
[2648869:MainThread](2024-03-27 12:04:47,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.026108, valid_loss 1.216563, train_metric nan, valid_metric 0.132058
[2648869:MainThread](2024-03-27 12:04:47,321) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.034206, valid_loss 1.212448, train_metric nan, valid_metric 0.134945
[2648869:MainThread](2024-03-27 12:04:47,322) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.213585 to 1.212448, save checkpoint.
[2648869:MainThread](2024-03-27 12:04:47,580) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.028488, valid_loss 1.214595, train_metric nan, valid_metric 0.134455
[2648869:MainThread](2024-03-27 12:04:47,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.025967, valid_loss 1.216839, train_metric nan, valid_metric 0.135244
[2648869:MainThread](2024-03-27 12:04:48,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.016718, valid_loss 1.216482, train_metric nan, valid_metric 0.133861
[2648869:MainThread](2024-03-27 12:04:48,349) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.027469, valid_loss 1.215965, train_metric nan, valid_metric 0.136394
[2648869:MainThread](2024-03-27 12:04:48,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.021006, valid_loss 1.216524, train_metric nan, valid_metric 0.136731
[2648869:MainThread](2024-03-27 12:04:48,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.024640, valid_loss 1.212864, train_metric nan, valid_metric 0.138764
[2648869:MainThread](2024-03-27 12:04:49,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.025545, valid_loss 1.210959, train_metric nan, valid_metric 0.139911
[2648869:MainThread](2024-03-27 12:04:49,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.212448 to 1.210959, save checkpoint.
[2648869:MainThread](2024-03-27 12:04:49,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.024016, valid_loss 1.215324, train_metric nan, valid_metric 0.138124
[2648869:MainThread](2024-03-27 12:04:49,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.028629, valid_loss 1.215283, train_metric nan, valid_metric 0.136011
[2648869:MainThread](2024-03-27 12:04:49,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.032833, valid_loss 1.217773, train_metric nan, valid_metric 0.136356
[2648869:MainThread](2024-03-27 12:04:49,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.027630, valid_loss 1.214189, train_metric nan, valid_metric 0.137611
[2648869:MainThread](2024-03-27 12:04:50,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.018739, valid_loss 1.214340, train_metric nan, valid_metric 0.137023
[2648869:MainThread](2024-03-27 12:04:50,243) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.024193, valid_loss 1.218162, train_metric nan, valid_metric 0.135575
[2648869:MainThread](2024-03-27 12:04:50,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.027667, valid_loss 1.213605, train_metric nan, valid_metric 0.135954
[2648869:MainThread](2024-03-27 12:04:50,659) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.030748, valid_loss 1.214892, train_metric nan, valid_metric 0.138745
[2648869:MainThread](2024-03-27 12:04:50,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.017720, valid_loss 1.217801, train_metric nan, valid_metric 0.133405
[2648869:MainThread](2024-03-27 12:04:51,075) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.031178, valid_loss 1.217909, train_metric nan, valid_metric 0.136933
[2648869:MainThread](2024-03-27 12:04:51,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.032431, valid_loss 1.215459, train_metric nan, valid_metric 0.137795
[2648869:MainThread](2024-03-27 12:04:51,486) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.022904, valid_loss 1.212115, train_metric nan, valid_metric 0.138603
[2648869:MainThread](2024-03-27 12:04:51,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.025380, valid_loss 1.215167, train_metric nan, valid_metric 0.137137
[2648869:MainThread](2024-03-27 12:04:51,898) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.021896, valid_loss 1.216285, train_metric nan, valid_metric 0.136973
[2648869:MainThread](2024-03-27 12:04:52,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.035165, valid_loss 1.214409, train_metric nan, valid_metric 0.135460
[2648869:MainThread](2024-03-27 12:04:52,307) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.015184, valid_loss 1.214692, train_metric nan, valid_metric 0.134571
[2648869:MainThread](2024-03-27 12:04:52,517) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.028548, valid_loss 1.213292, train_metric nan, valid_metric 0.138461
[2648869:MainThread](2024-03-27 12:04:52,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.030124, valid_loss 1.214080, train_metric nan, valid_metric 0.134919
[2648869:MainThread](2024-03-27 12:04:52,928) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.018549, valid_loss 1.213659, train_metric nan, valid_metric 0.139031
[2648869:MainThread](2024-03-27 12:04:53,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.026177, valid_loss 1.212897, train_metric nan, valid_metric 0.137900
[2648869:MainThread](2024-03-27 12:04:53,346) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.021577, valid_loss 1.211271, train_metric nan, valid_metric 0.138482
[2648869:MainThread](2024-03-27 12:04:53,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.022488, valid_loss 1.217677, train_metric nan, valid_metric 0.136184
[2648869:MainThread](2024-03-27 12:04:53,754) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.027034, valid_loss 1.214236, train_metric nan, valid_metric 0.136966
[2648869:MainThread](2024-03-27 12:04:53,957) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.035628, valid_loss 1.216126, train_metric nan, valid_metric 0.137503
[2648869:MainThread](2024-03-27 12:04:54,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.030652, valid_loss 1.214845, train_metric nan, valid_metric 0.139241
[2648869:MainThread](2024-03-27 12:04:54,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.025444, valid_loss 1.211406, train_metric nan, valid_metric 0.140512
[2648869:MainThread](2024-03-27 12:04:54,579) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.027726, valid_loss 1.213282, train_metric nan, valid_metric 0.138905
[2648869:MainThread](2024-03-27 12:04:54,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.027522, valid_loss 1.215098, train_metric nan, valid_metric 0.138588
[2648869:MainThread](2024-03-27 12:04:54,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.029545, valid_loss 1.214023, train_metric nan, valid_metric 0.139506
[2648869:MainThread](2024-03-27 12:04:55,192) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.023016, valid_loss 1.213246, train_metric nan, valid_metric 0.139022
[2648869:MainThread](2024-03-27 12:04:55,398) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.024044, valid_loss 1.210963, train_metric nan, valid_metric 0.139593
[2648869:MainThread](2024-03-27 12:04:55,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.020967, valid_loss 1.210780, train_metric nan, valid_metric 0.140324
[2648869:MainThread](2024-03-27 12:04:55,602) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.210959 to 1.210780, save checkpoint.
[2648869:MainThread](2024-03-27 12:04:55,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.024692, valid_loss 1.213356, train_metric nan, valid_metric 0.139298
[2648869:MainThread](2024-03-27 12:04:56,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.038587, valid_loss 1.211703, train_metric nan, valid_metric 0.139624
[2648869:MainThread](2024-03-27 12:04:56,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.019226, valid_loss 1.213799, train_metric nan, valid_metric 0.139660
[2648869:MainThread](2024-03-27 12:04:56,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.031295, valid_loss 1.212169, train_metric nan, valid_metric 0.139486
[2648869:MainThread](2024-03-27 12:04:56,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.020664, valid_loss 1.213918, train_metric nan, valid_metric 0.138707
[2648869:MainThread](2024-03-27 12:04:56,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.024257, valid_loss 1.215325, train_metric nan, valid_metric 0.139376
[2648869:MainThread](2024-03-27 12:04:57,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.021438, valid_loss 1.216360, train_metric nan, valid_metric 0.139133
[2648869:MainThread](2024-03-27 12:04:57,250) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.020216, valid_loss 1.213149, train_metric nan, valid_metric 0.140270
[2648869:MainThread](2024-03-27 12:04:57,453) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.017122, valid_loss 1.212673, train_metric nan, valid_metric 0.135701
[2648869:MainThread](2024-03-27 12:04:57,659) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.016641, valid_loss 1.213205, train_metric nan, valid_metric 0.139674
[2648869:MainThread](2024-03-27 12:04:57,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.029061, valid_loss 1.214437, train_metric nan, valid_metric 0.139404
[2648869:MainThread](2024-03-27 12:04:58,067) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.011121, valid_loss 1.214877, train_metric nan, valid_metric 0.139788
[2648869:MainThread](2024-03-27 12:04:58,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.028747, valid_loss 1.215259, train_metric nan, valid_metric 0.138241
[2648869:MainThread](2024-03-27 12:04:58,487) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.028913, valid_loss 1.214117, train_metric nan, valid_metric 0.139977
[2648869:MainThread](2024-03-27 12:04:58,691) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.028872, valid_loss 1.213860, train_metric nan, valid_metric 0.140002
[2648869:MainThread](2024-03-27 12:04:58,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.017516, valid_loss 1.213209, train_metric nan, valid_metric 0.139537
[2648869:MainThread](2024-03-27 12:04:59,102) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.022231, valid_loss 1.213768, train_metric nan, valid_metric 0.139854
[2648869:MainThread](2024-03-27 12:04:59,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.027520, valid_loss 1.215110, train_metric nan, valid_metric 0.140946
[2648869:MainThread](2024-03-27 12:04:59,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.025374, valid_loss 1.211737, train_metric nan, valid_metric 0.141736
[2648869:MainThread](2024-03-27 12:04:59,718) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.010641, valid_loss 1.215230, train_metric nan, valid_metric 0.139914
[2648869:MainThread](2024-03-27 12:04:59,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.028000, valid_loss 1.214142, train_metric nan, valid_metric 0.140996
[2648869:MainThread](2024-03-27 12:05:00,129) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.021591, valid_loss 1.212572, train_metric nan, valid_metric 0.141529
[2648869:MainThread](2024-03-27 12:05:00,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.011446, valid_loss 1.210367, train_metric nan, valid_metric 0.142643
[2648869:MainThread](2024-03-27 12:05:00,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.210780 to 1.210367, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:00,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.026877, valid_loss 1.209740, train_metric nan, valid_metric 0.142134
[2648869:MainThread](2024-03-27 12:05:00,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.210367 to 1.209740, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:00,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.021672, valid_loss 1.216144, train_metric nan, valid_metric 0.139251
[2648869:MainThread](2024-03-27 12:05:00,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.029354, valid_loss 1.213602, train_metric nan, valid_metric 0.140015
[2648869:MainThread](2024-03-27 12:05:01,169) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.018208, valid_loss 1.212259, train_metric nan, valid_metric 0.140562
[2648869:MainThread](2024-03-27 12:05:01,375) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.021761, valid_loss 1.211387, train_metric nan, valid_metric 0.141037
[2648869:MainThread](2024-03-27 12:05:01,581) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.018191, valid_loss 1.210385, train_metric nan, valid_metric 0.140761
[2648869:MainThread](2024-03-27 12:05:01,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 1.022162, valid_loss 1.212894, train_metric nan, valid_metric 0.140419
[2648869:MainThread](2024-03-27 12:05:01,995) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 1.015164, valid_loss 1.217120, train_metric nan, valid_metric 0.139590
[2648869:MainThread](2024-03-27 12:05:02,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 1.011946, valid_loss 1.212277, train_metric nan, valid_metric 0.141504
[2648869:MainThread](2024-03-27 12:05:02,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 1.023251, valid_loss 1.211461, train_metric nan, valid_metric 0.141490
[2648869:MainThread](2024-03-27 12:05:02,615) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 1.027775, valid_loss 1.211775, train_metric nan, valid_metric 0.139754
[2648869:MainThread](2024-03-27 12:05:02,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 1.021667, valid_loss 1.210248, train_metric nan, valid_metric 0.141259
[2648869:MainThread](2024-03-27 12:05:03,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 1.028792, valid_loss 1.214211, train_metric nan, valid_metric 0.140680
[2648869:MainThread](2024-03-27 12:05:03,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 1.027552, valid_loss 1.213268, train_metric nan, valid_metric 0.141904
[2648869:MainThread](2024-03-27 12:05:03,438) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 1.020516, valid_loss 1.213287, train_metric nan, valid_metric 0.139875
[2648869:MainThread](2024-03-27 12:05:03,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 1.021368, valid_loss 1.209487, train_metric nan, valid_metric 0.141882
[2648869:MainThread](2024-03-27 12:05:03,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.209740 to 1.209487, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:03,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 1.026708, valid_loss 1.213097, train_metric nan, valid_metric 0.140792
[2648869:MainThread](2024-03-27 12:05:04,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 1.020169, valid_loss 1.211052, train_metric nan, valid_metric 0.141300
[2648869:MainThread](2024-03-27 12:05:04,255) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 1.039726, valid_loss 1.211258, train_metric nan, valid_metric 0.139260
[2648869:MainThread](2024-03-27 12:05:04,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 1.016823, valid_loss 1.211254, train_metric nan, valid_metric 0.140804
[2648869:MainThread](2024-03-27 12:05:04,716) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 1.028011, valid_loss 1.213319, train_metric nan, valid_metric 0.141271
[2648869:MainThread](2024-03-27 12:05:04,931) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 1.013540, valid_loss 1.213075, train_metric nan, valid_metric 0.140349
[2648869:MainThread](2024-03-27 12:05:05,132) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 1.022641, valid_loss 1.216260, train_metric nan, valid_metric 0.139015
[2648869:MainThread](2024-03-27 12:05:05,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 1.024788, valid_loss 1.213838, train_metric nan, valid_metric 0.141921
[2648869:MainThread](2024-03-27 12:05:05,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 1.023869, valid_loss 1.211567, train_metric nan, valid_metric 0.141414
[2648869:MainThread](2024-03-27 12:05:05,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 1.018792, valid_loss 1.213758, train_metric nan, valid_metric 0.140049
[2648869:MainThread](2024-03-27 12:05:06,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 1.016114, valid_loss 1.212561, train_metric nan, valid_metric 0.138307
[2648869:MainThread](2024-03-27 12:05:06,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2760]: train_loss 1.010967, valid_loss 1.213363, train_metric nan, valid_metric 0.140474
[2648869:MainThread](2024-03-27 12:05:06,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2780]: train_loss 1.019895, valid_loss 1.214611, train_metric nan, valid_metric 0.140226
[2648869:MainThread](2024-03-27 12:05:06,770) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2800]: train_loss 1.022593, valid_loss 1.215347, train_metric nan, valid_metric 0.139527
[2648869:MainThread](2024-03-27 12:05:06,985) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2820]: train_loss 1.018144, valid_loss 1.215607, train_metric nan, valid_metric 0.138523
[2648869:MainThread](2024-03-27 12:05:07,191) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2840]: train_loss 1.024278, valid_loss 1.210965, train_metric nan, valid_metric 0.140834
[2648869:MainThread](2024-03-27 12:05:07,394) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2860]: train_loss 1.017083, valid_loss 1.212158, train_metric nan, valid_metric 0.139052
[2648869:MainThread](2024-03-27 12:05:07,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2880]: train_loss 1.015982, valid_loss 1.213248, train_metric nan, valid_metric 0.141038
[2648869:MainThread](2024-03-27 12:05:07,804) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2900]: train_loss 1.013903, valid_loss 1.210712, train_metric nan, valid_metric 0.141729
[2648869:MainThread](2024-03-27 12:05:08,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2920]: train_loss 1.019725, valid_loss 1.216166, train_metric nan, valid_metric 0.139197
[2648869:MainThread](2024-03-27 12:05:08,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2940]: train_loss 1.022355, valid_loss 1.216854, train_metric nan, valid_metric 0.139188
[2648869:MainThread](2024-03-27 12:05:08,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2960]: train_loss 1.022793, valid_loss 1.214492, train_metric nan, valid_metric 0.137997
[2648869:MainThread](2024-03-27 12:05:08,726) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2980]: train_loss 1.020880, valid_loss 1.212402, train_metric nan, valid_metric 0.141669
[2648869:MainThread](2024-03-27 12:05:08,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3000]: train_loss 1.016526, valid_loss 1.212830, train_metric nan, valid_metric 0.141804
[2648869:MainThread](2024-03-27 12:05:09,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3020]: train_loss 1.029423, valid_loss 1.213646, train_metric nan, valid_metric 0.140743
[2648869:MainThread](2024-03-27 12:05:09,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3040]: train_loss 1.023763, valid_loss 1.213456, train_metric nan, valid_metric 0.141429
[2648869:MainThread](2024-03-27 12:05:09,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3060]: train_loss 1.018345, valid_loss 1.218090, train_metric nan, valid_metric 0.137744
[2648869:MainThread](2024-03-27 12:05:09,953) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3080]: train_loss 1.023363, valid_loss 1.211963, train_metric nan, valid_metric 0.141577
[2648869:MainThread](2024-03-27 12:05:10,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3100]: train_loss 1.023032, valid_loss 1.214955, train_metric nan, valid_metric 0.139322
[2648869:MainThread](2024-03-27 12:05:10,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3120]: train_loss 1.018466, valid_loss 1.213688, train_metric nan, valid_metric 0.140685
[2648869:MainThread](2024-03-27 12:05:10,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3140]: train_loss 1.023764, valid_loss 1.210769, train_metric nan, valid_metric 0.141633
[2648869:MainThread](2024-03-27 12:05:10,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3160]: train_loss 1.015449, valid_loss 1.211350, train_metric nan, valid_metric 0.141314
[2648869:MainThread](2024-03-27 12:05:11,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3180]: train_loss 1.013005, valid_loss 1.212317, train_metric nan, valid_metric 0.140860
[2648869:MainThread](2024-03-27 12:05:11,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3200]: train_loss 1.024015, valid_loss 1.211546, train_metric nan, valid_metric 0.140024
[2648869:MainThread](2024-03-27 12:05:11,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3220]: train_loss 1.016810, valid_loss 1.213300, train_metric nan, valid_metric 0.138389
[2648869:MainThread](2024-03-27 12:05:11,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3240]: train_loss 1.016834, valid_loss 1.215258, train_metric nan, valid_metric 0.139510
[2648869:MainThread](2024-03-27 12:05:12,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3260]: train_loss 1.016539, valid_loss 1.218012, train_metric nan, valid_metric 0.137946
[2648869:MainThread](2024-03-27 12:05:12,255) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3280]: train_loss 1.016455, valid_loss 1.214484, train_metric nan, valid_metric 0.140802
[2648869:MainThread](2024-03-27 12:05:12,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3300]: train_loss 1.018384, valid_loss 1.216493, train_metric nan, valid_metric 0.138720
[2648869:MainThread](2024-03-27 12:05:12,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3320]: train_loss 1.029685, valid_loss 1.211231, train_metric nan, valid_metric 0.141209
[2648869:MainThread](2024-03-27 12:05:12,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3340]: train_loss 1.026127, valid_loss 1.212248, train_metric nan, valid_metric 0.141559
[2648869:MainThread](2024-03-27 12:05:13,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3360]: train_loss 1.019001, valid_loss 1.211794, train_metric nan, valid_metric 0.141190
[2648869:MainThread](2024-03-27 12:05:13,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3380]: train_loss 1.017840, valid_loss 1.214883, train_metric nan, valid_metric 0.140077
[2648869:MainThread](2024-03-27 12:05:13,510) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3400]: train_loss 1.021183, valid_loss 1.216980, train_metric nan, valid_metric 0.139035
[2648869:MainThread](2024-03-27 12:05:13,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3420]: train_loss 1.021144, valid_loss 1.213313, train_metric nan, valid_metric 0.139734
[2648869:MainThread](2024-03-27 12:05:13,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3440]: train_loss 1.015473, valid_loss 1.215177, train_metric nan, valid_metric 0.138416
[2648869:MainThread](2024-03-27 12:05:14,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3460]: train_loss 1.020908, valid_loss 1.212228, train_metric nan, valid_metric 0.140738
[2648869:MainThread](2024-03-27 12:05:14,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3480]: train_loss 1.017696, valid_loss 1.212225, train_metric nan, valid_metric 0.140333
[2648869:MainThread](2024-03-27 12:05:14,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3500]: train_loss 1.024855, valid_loss 1.211050, train_metric nan, valid_metric 0.141261
[2648869:MainThread](2024-03-27 12:05:14,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3520]: train_loss 1.017346, valid_loss 1.215874, train_metric nan, valid_metric 0.139615
[2648869:MainThread](2024-03-27 12:05:14,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:05:15,605) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:05:16,302) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  52%|█████▏    | 23/44 [12:38<13:53, 39.69s/it][2648869:MainThread](2024-03-27 12:05:16,309) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:05:16,320) INFO - qlib.workflow - [recorder.py:341] - Recorder 8c7b9c3d8b804deb99e03d45cc2a9af2 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:05:16,941) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:05:16,942) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:05:16,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:05:16,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:05:18,700) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.752382
            SH600004      0.752382
            SH600006      0.752382
            SH600007      0.752382
            SH600008      0.752382
                            ...   
2017-01-06  SZ300144      1.165180
            SZ300146      1.165180
            SZ300168      1.165180
            SZ300182      1.165180
            SZ300251      1.165180
Length: 547849, dtype: float64
[2648869:MainThread](2024-03-27 12:05:19,647) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2017-01-09  SH600000      1.165180
            SH600008      1.165180
            SH600009      1.165180
            SH600010      1.165180
            SH600015      1.165180
                            ...   
2018-10-24  SZ300136      0.814819
            SZ300144      0.814819
            SZ300251      0.814819
            SZ300408      0.814819
            SZ300433      0.814819
Length: 116250, dtype: float64
[2648869:MainThread](2024-03-27 12:05:19,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:05:20,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.327402, valid_loss 1.165069, train_metric nan, valid_metric 0.020841
[2648869:MainThread](2024-03-27 12:05:20,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.165069, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:05:20,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.134476, valid_loss 1.124720, train_metric nan, valid_metric 0.046414
[2648869:MainThread](2024-03-27 12:05:20,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.165069 to 1.124720, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:20,661) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.122567, valid_loss 1.117766, train_metric nan, valid_metric 0.090571
[2648869:MainThread](2024-03-27 12:05:20,661) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.124720 to 1.117766, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:20,873) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.121335, valid_loss 1.115186, train_metric nan, valid_metric 0.099474
[2648869:MainThread](2024-03-27 12:05:20,873) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.117766 to 1.115186, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:21,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.082416, valid_loss 1.115904, train_metric nan, valid_metric 0.094528
[2648869:MainThread](2024-03-27 12:05:21,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.089461, valid_loss 1.119463, train_metric nan, valid_metric 0.069637
[2648869:MainThread](2024-03-27 12:05:21,524) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.089925, valid_loss 1.112885, train_metric nan, valid_metric 0.105820
[2648869:MainThread](2024-03-27 12:05:21,525) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.115186 to 1.112885, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:21,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.063765, valid_loss 1.124598, train_metric nan, valid_metric 0.066334
[2648869:MainThread](2024-03-27 12:05:21,968) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.068648, valid_loss 1.113237, train_metric nan, valid_metric 0.117951
[2648869:MainThread](2024-03-27 12:05:22,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.098974, valid_loss 1.116260, train_metric nan, valid_metric 0.099754
[2648869:MainThread](2024-03-27 12:05:22,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.057184, valid_loss 1.114421, train_metric nan, valid_metric 0.098309
[2648869:MainThread](2024-03-27 12:05:22,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.080327, valid_loss 1.111918, train_metric nan, valid_metric 0.128091
[2648869:MainThread](2024-03-27 12:05:22,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.112885 to 1.111918, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:22,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.059568, valid_loss 1.112844, train_metric nan, valid_metric 0.105155
[2648869:MainThread](2024-03-27 12:05:23,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.087656, valid_loss 1.113761, train_metric nan, valid_metric 0.123426
[2648869:MainThread](2024-03-27 12:05:23,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.069681, valid_loss 1.114182, train_metric nan, valid_metric 0.105560
[2648869:MainThread](2024-03-27 12:05:23,585) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.054177, valid_loss 1.113757, train_metric nan, valid_metric 0.096654
[2648869:MainThread](2024-03-27 12:05:23,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.062730, valid_loss 1.115480, train_metric nan, valid_metric 0.104253
[2648869:MainThread](2024-03-27 12:05:24,059) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.051077, valid_loss 1.111649, train_metric nan, valid_metric 0.128741
[2648869:MainThread](2024-03-27 12:05:24,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.111918 to 1.111649, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:24,320) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.070390, valid_loss 1.114919, train_metric nan, valid_metric 0.110552
[2648869:MainThread](2024-03-27 12:05:24,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.053511, valid_loss 1.115190, train_metric nan, valid_metric 0.133060
[2648869:MainThread](2024-03-27 12:05:24,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.044321, valid_loss 1.111675, train_metric nan, valid_metric 0.136908
[2648869:MainThread](2024-03-27 12:05:25,091) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.040526, valid_loss 1.107395, train_metric nan, valid_metric 0.133705
[2648869:MainThread](2024-03-27 12:05:25,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.111649 to 1.107395, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:25,336) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.040282, valid_loss 1.109646, train_metric nan, valid_metric 0.133337
[2648869:MainThread](2024-03-27 12:05:25,538) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.036977, valid_loss 1.110716, train_metric nan, valid_metric 0.130152
[2648869:MainThread](2024-03-27 12:05:25,733) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.043583, valid_loss 1.112666, train_metric nan, valid_metric 0.129964
[2648869:MainThread](2024-03-27 12:05:25,972) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.041159, valid_loss 1.111691, train_metric nan, valid_metric 0.120189
[2648869:MainThread](2024-03-27 12:05:26,215) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.035580, valid_loss 1.113332, train_metric nan, valid_metric 0.117133
[2648869:MainThread](2024-03-27 12:05:26,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.026302, valid_loss 1.111627, train_metric nan, valid_metric 0.128348
[2648869:MainThread](2024-03-27 12:05:26,631) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.042148, valid_loss 1.113680, train_metric nan, valid_metric 0.110285
[2648869:MainThread](2024-03-27 12:05:26,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.028725, valid_loss 1.110139, train_metric nan, valid_metric 0.131373
[2648869:MainThread](2024-03-27 12:05:27,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.045107, valid_loss 1.111847, train_metric nan, valid_metric 0.116102
[2648869:MainThread](2024-03-27 12:05:27,326) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.028077, valid_loss 1.109536, train_metric nan, valid_metric 0.135554
[2648869:MainThread](2024-03-27 12:05:27,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.038670, valid_loss 1.112112, train_metric nan, valid_metric 0.139416
[2648869:MainThread](2024-03-27 12:05:27,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.036128, valid_loss 1.111376, train_metric nan, valid_metric 0.135545
[2648869:MainThread](2024-03-27 12:05:28,080) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.045050, valid_loss 1.110629, train_metric nan, valid_metric 0.128695
[2648869:MainThread](2024-03-27 12:05:28,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.024858, valid_loss 1.107350, train_metric nan, valid_metric 0.134955
[2648869:MainThread](2024-03-27 12:05:28,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.107395 to 1.107350, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:28,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.031734, valid_loss 1.111357, train_metric nan, valid_metric 0.117858
[2648869:MainThread](2024-03-27 12:05:28,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.045987, valid_loss 1.111465, train_metric nan, valid_metric 0.134099
[2648869:MainThread](2024-03-27 12:05:29,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.041515, valid_loss 1.110714, train_metric nan, valid_metric 0.134935
[2648869:MainThread](2024-03-27 12:05:29,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.020558, valid_loss 1.107339, train_metric nan, valid_metric 0.140109
[2648869:MainThread](2024-03-27 12:05:29,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.107350 to 1.107339, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:29,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.039097, valid_loss 1.111771, train_metric nan, valid_metric 0.129200
[2648869:MainThread](2024-03-27 12:05:29,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.031491, valid_loss 1.112599, train_metric nan, valid_metric 0.116492
[2648869:MainThread](2024-03-27 12:05:30,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.041232, valid_loss 1.112096, train_metric nan, valid_metric 0.125934
[2648869:MainThread](2024-03-27 12:05:30,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.030442, valid_loss 1.107328, train_metric nan, valid_metric 0.141536
[2648869:MainThread](2024-03-27 12:05:30,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.107339 to 1.107328, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:30,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.019476, valid_loss 1.108252, train_metric nan, valid_metric 0.135393
[2648869:MainThread](2024-03-27 12:05:30,621) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.024868, valid_loss 1.108467, train_metric nan, valid_metric 0.131993
[2648869:MainThread](2024-03-27 12:05:30,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.026298, valid_loss 1.111102, train_metric nan, valid_metric 0.126028
[2648869:MainThread](2024-03-27 12:05:31,039) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.038047, valid_loss 1.111021, train_metric nan, valid_metric 0.127081
[2648869:MainThread](2024-03-27 12:05:31,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.022476, valid_loss 1.110286, train_metric nan, valid_metric 0.137392
[2648869:MainThread](2024-03-27 12:05:31,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.047762, valid_loss 1.111561, train_metric nan, valid_metric 0.133947
[2648869:MainThread](2024-03-27 12:05:31,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.030633, valid_loss 1.112245, train_metric nan, valid_metric 0.123281
[2648869:MainThread](2024-03-27 12:05:31,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.026701, valid_loss 1.110619, train_metric nan, valid_metric 0.126304
[2648869:MainThread](2024-03-27 12:05:32,154) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.024369, valid_loss 1.110726, train_metric nan, valid_metric 0.122239
[2648869:MainThread](2024-03-27 12:05:32,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.037140, valid_loss 1.110444, train_metric nan, valid_metric 0.123876
[2648869:MainThread](2024-03-27 12:05:32,583) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.020804, valid_loss 1.112762, train_metric nan, valid_metric 0.114236
Epoch   820: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1040: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1260: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1540: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1760: reducing learning rate of group 0 to 3.1250e-05.
Epoch  1980: reducing learning rate of group 0 to 1.5625e-05.
Epoch  2200: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2017-12-26 SH600000   -0.155126
           SH600008    0.041059
           SH600009    0.075819
           SH600010    0.040539
           SH600011    0.085233
Epoch   660: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1020: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1400: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1840: reducing learning rate of group 0 to 1.2500e-04.
Epoch  2060: reducing learning rate of group 0 to 6.2500e-05.
Epoch  2280: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2500: reducing learning rate of group 0 to 1.5625e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2018-01-24 SH600000   -0.033416
           SH600008   -0.062090
           SH600009   -0.013114
           SH600010   -0.065093
           SH600011    0.041910
Epoch   780: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1060: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1300: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1520: reducing learning rate of group 0 to 1.2500e-04.
Epoch  2120: reducing learning rate of group 0 to 6.2500e-05.
Epoch  2340: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2560: reducing learning rate of group 0 to 1.5625e-05.
Epoch  2780: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2018-02-28 SH600000   -0.142328
           SH600008    0.097660
           SH600009    0.022128
           SH600010    0.019193
           SH600011    0.093899
Epoch  1140: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1420: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1640: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1860: reducing learning rate of group 0 to 1.2500e-04.
Epoch  2080: reducing learning rate of group 0 to 6.2500e-05.
Epoch  2520: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2740: reducing learning rate of group 0 to 1.5625e-05.
Epoch  2960: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2018-03-28 SH600000    0.010220
           SH600008   -0.007987
           SH600009    0.090270
           SH600010    0.084996
           SH600011   -0.027909
Epoch   660: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1000: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1700: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1920: reducing learning rate of group 0 to 1.2500e-04.
Epoch  2140: reducing learning rate of group 0 to 6.2500e-05.
Epoch  2360: reducing learning rate of group 0 to 3.1250e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2018-04-27 SH600000   -0.010757
           SH600008   -0.105574
           SH600009    0.058176
           SH600010    0.040628
           SH600011   -0.028679
Epoch   940: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1160: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1380: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1600: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2018-05-29 SH600000    0.044218
           SH600008   -0.073314
           SH600009    0.032423
           SH600010    0.178531
           SH600011   -0.089152
Epoch   540: reducing learning rate of group 0 to 1.0000e-03.
Epoch   920: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1200: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1560: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1780: reducing learning rate of group 0 to 6.2500e-05.
Epoch  2000: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2220: reducing learning rate of group 0 to 1.5625e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2018-06-27 SH600000    0.087027
           SH600008   -0.219363
           SH600009    0.056064
           SH600010    0.165490
           SH600011   -0.046143
Epoch   740: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1040: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1260: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1580: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1800: reducing learning rate of group 0 to 6.2500e-05.
Epoch  2020: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2240: reducing learning rate of group 0 to 1.5625e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2018-07-25 SH600000    0.155782
           SH600008   -0.099242
           SH600009    0.174633
           SH600010    0.001326
           SH600011   -0.014179
Epoch   600: reducing learning rate of group 0 to 1.0000e-03.
Epoch   860: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1080: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1460: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1820: reducing learning rate of group 0 to 6.2500e-05.
Epoch  2040: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2260: reducing learning rate of group 0 to 1.5625e-05.
Epoch  2480: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2018-08-22 SH600000   -0.020736
           SH600008   -0.134764
           SH600009    0.235341
           SH600010   -0.053262
           SH600011    0.037328
Epoch   920: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1140: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1360: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1580: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1800: reducing learning rate of group 0 to 6.2500e-05.
Epoch  2020: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2240: reducing learning rate of group 0 to 1.5625e-05.
Epoch  2520: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2018-09-19 SH600000    0.087063
           SH600008   -0.018101
           SH600009   -0.033892
           SH600010    0.010414
           SH600011    0.043590
Epoch   520: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1320: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1540: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1960: reducing learning rate of group 0 to 1.2500e-04.
Epoch  2180: reducing learning rate of group 0 to 6.2500e-05.
Epoch  2440: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2740: reducing learning rate of group 0 to 1.5625e-05.
Epoch  2960: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2018-10-25 SH600000    0.045580
           SH600008   -0.008248
           SH600009   -0.006676
           SH600010   -0.128220
           SH600011   -0.011886
Epoch   660: reducing learning rate of group 0 to 1.0000e-03.
Epoch   880: reducing learning rate of group 0 to 5.0000e-04.
[2648869:MainThread](2024-03-27 12:05:32,796) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.026351, valid_loss 1.109624, train_metric nan, valid_metric 0.124128
[2648869:MainThread](2024-03-27 12:05:33,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.019868, valid_loss 1.110868, train_metric nan, valid_metric 0.118734
[2648869:MainThread](2024-03-27 12:05:33,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.020845, valid_loss 1.108993, train_metric nan, valid_metric 0.129004
[2648869:MainThread](2024-03-27 12:05:33,433) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.026595, valid_loss 1.110022, train_metric nan, valid_metric 0.130196
[2648869:MainThread](2024-03-27 12:05:33,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.025964, valid_loss 1.110616, train_metric nan, valid_metric 0.127260
[2648869:MainThread](2024-03-27 12:05:33,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.016546, valid_loss 1.109608, train_metric nan, valid_metric 0.128720
[2648869:MainThread](2024-03-27 12:05:34,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.027752, valid_loss 1.110795, train_metric nan, valid_metric 0.133342
[2648869:MainThread](2024-03-27 12:05:34,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.022275, valid_loss 1.109970, train_metric nan, valid_metric 0.129120
[2648869:MainThread](2024-03-27 12:05:34,471) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.023280, valid_loss 1.109423, train_metric nan, valid_metric 0.134326
[2648869:MainThread](2024-03-27 12:05:34,677) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.025193, valid_loss 1.105839, train_metric nan, valid_metric 0.137458
[2648869:MainThread](2024-03-27 12:05:34,678) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.107328 to 1.105839, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:34,887) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.020601, valid_loss 1.110345, train_metric nan, valid_metric 0.129122
[2648869:MainThread](2024-03-27 12:05:35,091) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.018800, valid_loss 1.112334, train_metric nan, valid_metric 0.127080
[2648869:MainThread](2024-03-27 12:05:35,297) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.037765, valid_loss 1.112157, train_metric nan, valid_metric 0.130477
[2648869:MainThread](2024-03-27 12:05:35,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.022544, valid_loss 1.110347, train_metric nan, valid_metric 0.127471
[2648869:MainThread](2024-03-27 12:05:35,793) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.034110, valid_loss 1.110716, train_metric nan, valid_metric 0.127830
[2648869:MainThread](2024-03-27 12:05:36,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.029767, valid_loss 1.111430, train_metric nan, valid_metric 0.128160
[2648869:MainThread](2024-03-27 12:05:36,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.017536, valid_loss 1.111416, train_metric nan, valid_metric 0.128605
[2648869:MainThread](2024-03-27 12:05:36,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.025500, valid_loss 1.111418, train_metric nan, valid_metric 0.130467
[2648869:MainThread](2024-03-27 12:05:36,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.026646, valid_loss 1.108104, train_metric nan, valid_metric 0.136690
[2648869:MainThread](2024-03-27 12:05:36,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.023625, valid_loss 1.108267, train_metric nan, valid_metric 0.137605
[2648869:MainThread](2024-03-27 12:05:37,176) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.025932, valid_loss 1.109731, train_metric nan, valid_metric 0.134298
[2648869:MainThread](2024-03-27 12:05:37,385) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.031560, valid_loss 1.108043, train_metric nan, valid_metric 0.134697
[2648869:MainThread](2024-03-27 12:05:37,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.027458, valid_loss 1.110837, train_metric nan, valid_metric 0.127511
[2648869:MainThread](2024-03-27 12:05:37,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.031529, valid_loss 1.109150, train_metric nan, valid_metric 0.137486
[2648869:MainThread](2024-03-27 12:05:38,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.028217, valid_loss 1.110938, train_metric nan, valid_metric 0.124637
[2648869:MainThread](2024-03-27 12:05:38,220) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.032031, valid_loss 1.110955, train_metric nan, valid_metric 0.127927
[2648869:MainThread](2024-03-27 12:05:38,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.029593, valid_loss 1.109972, train_metric nan, valid_metric 0.131429
[2648869:MainThread](2024-03-27 12:05:38,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.033598, valid_loss 1.111595, train_metric nan, valid_metric 0.127673
[2648869:MainThread](2024-03-27 12:05:38,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.024067, valid_loss 1.108446, train_metric nan, valid_metric 0.135085
[2648869:MainThread](2024-03-27 12:05:39,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.027861, valid_loss 1.108782, train_metric nan, valid_metric 0.133746
[2648869:MainThread](2024-03-27 12:05:39,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.034917, valid_loss 1.111231, train_metric nan, valid_metric 0.125354
[2648869:MainThread](2024-03-27 12:05:39,468) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.022920, valid_loss 1.110459, train_metric nan, valid_metric 0.128819
[2648869:MainThread](2024-03-27 12:05:39,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.027001, valid_loss 1.108154, train_metric nan, valid_metric 0.132024
[2648869:MainThread](2024-03-27 12:05:39,878) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.020042, valid_loss 1.108131, train_metric nan, valid_metric 0.134333
[2648869:MainThread](2024-03-27 12:05:40,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.039127, valid_loss 1.111764, train_metric nan, valid_metric 0.125174
[2648869:MainThread](2024-03-27 12:05:40,287) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.021929, valid_loss 1.109841, train_metric nan, valid_metric 0.129034
[2648869:MainThread](2024-03-27 12:05:40,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.030087, valid_loss 1.110706, train_metric nan, valid_metric 0.129794
[2648869:MainThread](2024-03-27 12:05:40,702) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.027968, valid_loss 1.110642, train_metric nan, valid_metric 0.128483
[2648869:MainThread](2024-03-27 12:05:40,907) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.026022, valid_loss 1.108780, train_metric nan, valid_metric 0.135696
[2648869:MainThread](2024-03-27 12:05:41,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.022730, valid_loss 1.109480, train_metric nan, valid_metric 0.126885
[2648869:MainThread](2024-03-27 12:05:41,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.015731, valid_loss 1.111866, train_metric nan, valid_metric 0.123119
[2648869:MainThread](2024-03-27 12:05:41,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.020987, valid_loss 1.109895, train_metric nan, valid_metric 0.128821
[2648869:MainThread](2024-03-27 12:05:41,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.031495, valid_loss 1.108050, train_metric nan, valid_metric 0.136498
[2648869:MainThread](2024-03-27 12:05:41,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.024919, valid_loss 1.108276, train_metric nan, valid_metric 0.135802
[2648869:MainThread](2024-03-27 12:05:42,127) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.034828, valid_loss 1.109944, train_metric nan, valid_metric 0.132982
[2648869:MainThread](2024-03-27 12:05:42,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.031757, valid_loss 1.109912, train_metric nan, valid_metric 0.136857
[2648869:MainThread](2024-03-27 12:05:42,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.024073, valid_loss 1.111410, train_metric nan, valid_metric 0.125707
[2648869:MainThread](2024-03-27 12:05:42,744) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.018299, valid_loss 1.107653, train_metric nan, valid_metric 0.135576
[2648869:MainThread](2024-03-27 12:05:42,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.016772, valid_loss 1.107840, train_metric nan, valid_metric 0.131981
[2648869:MainThread](2024-03-27 12:05:43,154) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.027831, valid_loss 1.111670, train_metric nan, valid_metric 0.124606
[2648869:MainThread](2024-03-27 12:05:43,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.018404, valid_loss 1.112256, train_metric nan, valid_metric 0.121645
[2648869:MainThread](2024-03-27 12:05:43,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.032587, valid_loss 1.109779, train_metric nan, valid_metric 0.129096
[2648869:MainThread](2024-03-27 12:05:43,770) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.019748, valid_loss 1.110809, train_metric nan, valid_metric 0.128171
[2648869:MainThread](2024-03-27 12:05:43,976) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.028299, valid_loss 1.110184, train_metric nan, valid_metric 0.132890
[2648869:MainThread](2024-03-27 12:05:44,179) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.030569, valid_loss 1.111478, train_metric nan, valid_metric 0.124089
[2648869:MainThread](2024-03-27 12:05:44,378) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.036501, valid_loss 1.113475, train_metric nan, valid_metric 0.117062
[2648869:MainThread](2024-03-27 12:05:44,585) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.017220, valid_loss 1.110937, train_metric nan, valid_metric 0.125734
[2648869:MainThread](2024-03-27 12:05:44,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.034764, valid_loss 1.111178, train_metric nan, valid_metric 0.123627
[2648869:MainThread](2024-03-27 12:05:44,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.015982, valid_loss 1.110309, train_metric nan, valid_metric 0.127942
[2648869:MainThread](2024-03-27 12:05:45,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.019587, valid_loss 1.111906, train_metric nan, valid_metric 0.127280
[2648869:MainThread](2024-03-27 12:05:45,203) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:05:45,868) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:05:46,527) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  55%|█████▍    | 24/44 [13:08<12:16, 36.85s/it][2648869:MainThread](2024-03-27 12:05:46,534) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:05:46,545) INFO - qlib.workflow - [recorder.py:341] - Recorder 9093159e5df84cccbce720acf444b61d starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:05:47,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:05:47,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:05:47,227) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:05:47,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:05:48,871) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.758681
            SH600004      0.758681
            SH600006      0.758681
            SH600007      0.758681
            SH600008      0.758681
                            ...   
2017-02-10  SZ300144      0.802384
            SZ300146      0.802384
            SZ300168      0.802384
            SZ300182      0.802384
            SZ300251      0.802384
Length: 553160, dtype: float64
[2648869:MainThread](2024-03-27 12:05:49,777) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2017-02-13  SH600000      0.802384
            SH600008      0.802384
            SH600009      0.802384
            SH600010      0.802384
            SH600015      0.802384
                            ...   
2018-11-21  SZ300136      1.874219
            SZ300144      1.874219
            SZ300251      1.874219
            SZ300408      1.874219
            SZ300433      1.874219
Length: 116530, dtype: float64
[2648869:MainThread](2024-03-27 12:05:49,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:05:50,359) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.592899, valid_loss 1.156106, train_metric nan, valid_metric 0.016361
[2648869:MainThread](2024-03-27 12:05:50,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.156106, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:05:50,551) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.461836, valid_loss 1.113311, train_metric nan, valid_metric 0.055066
[2648869:MainThread](2024-03-27 12:05:50,552) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.156106 to 1.113311, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:50,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.204267, valid_loss 1.107689, train_metric nan, valid_metric 0.078284
[2648869:MainThread](2024-03-27 12:05:50,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.113311 to 1.107689, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:50,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.253829, valid_loss 1.114756, train_metric nan, valid_metric 0.083870
[2648869:MainThread](2024-03-27 12:05:51,161) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.207783, valid_loss 1.104138, train_metric nan, valid_metric 0.094130
[2648869:MainThread](2024-03-27 12:05:51,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.107689 to 1.104138, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:51,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.231398, valid_loss 1.104839, train_metric nan, valid_metric 0.087862
[2648869:MainThread](2024-03-27 12:05:51,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.194300, valid_loss 1.101866, train_metric nan, valid_metric 0.078065
[2648869:MainThread](2024-03-27 12:05:51,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.104138 to 1.101866, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:51,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.196658, valid_loss 1.104803, train_metric nan, valid_metric 0.078904
[2648869:MainThread](2024-03-27 12:05:51,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.219059, valid_loss 1.101162, train_metric nan, valid_metric 0.077774
[2648869:MainThread](2024-03-27 12:05:51,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.101866 to 1.101162, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:52,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.254306, valid_loss 1.108117, train_metric nan, valid_metric 0.076636
[2648869:MainThread](2024-03-27 12:05:52,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.223399, valid_loss 1.102292, train_metric nan, valid_metric 0.104191
[2648869:MainThread](2024-03-27 12:05:52,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.209211, valid_loss 1.099076, train_metric nan, valid_metric 0.082090
[2648869:MainThread](2024-03-27 12:05:52,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.101162 to 1.099076, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:52,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.197258, valid_loss 1.103393, train_metric nan, valid_metric 0.060954
[2648869:MainThread](2024-03-27 12:05:53,018) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.196343, valid_loss 1.103596, train_metric nan, valid_metric 0.058542
[2648869:MainThread](2024-03-27 12:05:53,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.140719, valid_loss 1.099991, train_metric nan, valid_metric 0.091794
[2648869:MainThread](2024-03-27 12:05:53,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.155801, valid_loss 1.099267, train_metric nan, valid_metric 0.095812
[2648869:MainThread](2024-03-27 12:05:53,633) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.170519, valid_loss 1.098493, train_metric nan, valid_metric 0.108442
[2648869:MainThread](2024-03-27 12:05:53,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.099076 to 1.098493, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:53,842) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.159595, valid_loss 1.099472, train_metric nan, valid_metric 0.098588
[2648869:MainThread](2024-03-27 12:05:54,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.159765, valid_loss 1.100972, train_metric nan, valid_metric 0.089286
[2648869:MainThread](2024-03-27 12:05:54,251) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.147398, valid_loss 1.099102, train_metric nan, valid_metric 0.082221
[2648869:MainThread](2024-03-27 12:05:54,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.133773, valid_loss 1.096007, train_metric nan, valid_metric 0.107512
[2648869:MainThread](2024-03-27 12:05:54,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.098493 to 1.096007, save checkpoint.
[2648869:MainThread](2024-03-27 12:05:54,661) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.129593, valid_loss 1.102521, train_metric nan, valid_metric 0.062359
[2648869:MainThread](2024-03-27 12:05:54,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.137232, valid_loss 1.098508, train_metric nan, valid_metric 0.087007
[2648869:MainThread](2024-03-27 12:05:55,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.117360, valid_loss 1.098366, train_metric nan, valid_metric 0.103695
[2648869:MainThread](2024-03-27 12:05:55,275) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.115458, valid_loss 1.098782, train_metric nan, valid_metric 0.094698
[2648869:MainThread](2024-03-27 12:05:55,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.160808, valid_loss 1.100727, train_metric nan, valid_metric 0.078830
[2648869:MainThread](2024-03-27 12:05:55,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.145028, valid_loss 1.099443, train_metric nan, valid_metric 0.095877
[2648869:MainThread](2024-03-27 12:05:55,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.134753, valid_loss 1.098060, train_metric nan, valid_metric 0.107764
[2648869:MainThread](2024-03-27 12:05:56,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.124934, valid_loss 1.100483, train_metric nan, valid_metric 0.093607
[2648869:MainThread](2024-03-27 12:05:56,295) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.112042, valid_loss 1.097657, train_metric nan, valid_metric 0.097686
[2648869:MainThread](2024-03-27 12:05:56,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.134251, valid_loss 1.100629, train_metric nan, valid_metric 0.100286
[2648869:MainThread](2024-03-27 12:05:56,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.128739, valid_loss 1.099762, train_metric nan, valid_metric 0.094375
[2648869:MainThread](2024-03-27 12:05:56,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.103411, valid_loss 1.098419, train_metric nan, valid_metric 0.100540
[2648869:MainThread](2024-03-27 12:05:57,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.111421, valid_loss 1.099114, train_metric nan, valid_metric 0.095884
[2648869:MainThread](2024-03-27 12:05:57,327) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.140819, valid_loss 1.097836, train_metric nan, valid_metric 0.100579
[2648869:MainThread](2024-03-27 12:05:57,530) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.141404, valid_loss 1.099090, train_metric nan, valid_metric 0.084972
[2648869:MainThread](2024-03-27 12:05:57,733) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.088990, valid_loss 1.097698, train_metric nan, valid_metric 0.105267
[2648869:MainThread](2024-03-27 12:05:57,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.097020, valid_loss 1.099298, train_metric nan, valid_metric 0.086337
[2648869:MainThread](2024-03-27 12:05:58,142) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.115536, valid_loss 1.098264, train_metric nan, valid_metric 0.104054
[2648869:MainThread](2024-03-27 12:05:58,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.135734, valid_loss 1.099206, train_metric nan, valid_metric 0.088841
[2648869:MainThread](2024-03-27 12:05:58,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.114582, valid_loss 1.098395, train_metric nan, valid_metric 0.103185
[2648869:MainThread](2024-03-27 12:05:58,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.154566, valid_loss 1.101134, train_metric nan, valid_metric 0.084188
[2648869:MainThread](2024-03-27 12:05:58,967) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.135579, valid_loss 1.098999, train_metric nan, valid_metric 0.096374
[2648869:MainThread](2024-03-27 12:05:59,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.114048, valid_loss 1.097412, train_metric nan, valid_metric 0.103918
[2648869:MainThread](2024-03-27 12:05:59,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.108659, valid_loss 1.099255, train_metric nan, valid_metric 0.098726
[2648869:MainThread](2024-03-27 12:05:59,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.106293, valid_loss 1.099274, train_metric nan, valid_metric 0.097040
[2648869:MainThread](2024-03-27 12:05:59,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.114736, valid_loss 1.097521, train_metric nan, valid_metric 0.107305
[2648869:MainThread](2024-03-27 12:06:00,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.121684, valid_loss 1.099554, train_metric nan, valid_metric 0.093785
[2648869:MainThread](2024-03-27 12:06:00,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.091155, valid_loss 1.099340, train_metric nan, valid_metric 0.094400
[2648869:MainThread](2024-03-27 12:06:00,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.112883, valid_loss 1.098668, train_metric nan, valid_metric 0.092647
[2648869:MainThread](2024-03-27 12:06:00,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.095514, valid_loss 1.098190, train_metric nan, valid_metric 0.103427
[2648869:MainThread](2024-03-27 12:06:01,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.098089, valid_loss 1.098252, train_metric nan, valid_metric 0.088219
[2648869:MainThread](2024-03-27 12:06:01,483) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.087887, valid_loss 1.097497, train_metric nan, valid_metric 0.097610
[2648869:MainThread](2024-03-27 12:06:01,737) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.098643, valid_loss 1.096833, train_metric nan, valid_metric 0.097143
[2648869:MainThread](2024-03-27 12:06:01,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.111980, valid_loss 1.097484, train_metric nan, valid_metric 0.096577
[2648869:MainThread](2024-03-27 12:06:02,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.106044, valid_loss 1.097142, train_metric nan, valid_metric 0.095763
[2648869:MainThread](2024-03-27 12:06:02,492) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.088048, valid_loss 1.097957, train_metric nan, valid_metric 0.097543
[2648869:MainThread](2024-03-27 12:06:02,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.117301, valid_loss 1.097853, train_metric nan, valid_metric 0.096645
[2648869:MainThread](2024-03-27 12:06:02,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.117723, valid_loss 1.098191, train_metric nan, valid_metric 0.102081
[2648869:MainThread](2024-03-27 12:06:03,108) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.100969, valid_loss 1.098761, train_metric nan, valid_metric 0.099839
[2648869:MainThread](2024-03-27 12:06:03,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.093586, valid_loss 1.097730, train_metric nan, valid_metric 0.102920
[2648869:MainThread](2024-03-27 12:06:03,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.089385, valid_loss 1.097090, train_metric nan, valid_metric 0.093252
[2648869:MainThread](2024-03-27 12:06:03,727) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.104541, valid_loss 1.098483, train_metric nan, valid_metric 0.093986
[2648869:MainThread](2024-03-27 12:06:03,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.106057, valid_loss 1.098198, train_metric nan, valid_metric 0.098048
[2648869:MainThread](2024-03-27 12:06:04,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.123126, valid_loss 1.098060, train_metric nan, valid_metric 0.105800
[2648869:MainThread](2024-03-27 12:06:04,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.093700, valid_loss 1.098415, train_metric nan, valid_metric 0.105034
[2648869:MainThread](2024-03-27 12:06:04,550) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.117035, valid_loss 1.097113, train_metric nan, valid_metric 0.104620
[2648869:MainThread](2024-03-27 12:06:04,759) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.092211, valid_loss 1.097660, train_metric nan, valid_metric 0.099186
[2648869:MainThread](2024-03-27 12:06:04,967) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.106249, valid_loss 1.097801, train_metric nan, valid_metric 0.096913
[2648869:MainThread](2024-03-27 12:06:05,172) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.107155, valid_loss 1.098119, train_metric nan, valid_metric 0.103527
[2648869:MainThread](2024-03-27 12:06:05,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.098999, valid_loss 1.098058, train_metric nan, valid_metric 0.104166
[2648869:MainThread](2024-03-27 12:06:05,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:06:06,049) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:06:06,748) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  57%|█████▋    | 25/44 [13:28<10:05, 31.86s/it][2648869:MainThread](2024-03-27 12:06:06,755) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:06:06,766) INFO - qlib.workflow - [recorder.py:341] - Recorder 2a928dfa97104dc59083105a3aca2408 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:06:07,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:06:07,390) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:06:07,393) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:06:07,394) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:06:09,147) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.785028
            SH600004      0.785028
            SH600006      0.785028
            SH600007      0.785028
            SH600008      0.785028
                            ...   
2017-03-10  SZ300144      0.548940
            SZ300146      0.548940
            SZ300168      0.548940
            SZ300182      0.548940
            SZ300251      0.548940
Length: 558454, dtype: float64
[2648869:MainThread](2024-03-27 12:06:10,079) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2017-03-13  SH600000      0.548940
            SH600009      0.548940
            SH600010      0.548940
            SH600015      0.548940
            SH600016      0.548940
                            ...   
2018-12-19  SZ300144      0.572331
            SZ300251      0.572331
            SZ300296      0.572331
            SZ300408      0.572331
            SZ300433      0.572331
Length: 116906, dtype: float64
[2648869:MainThread](2024-03-27 12:06:10,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:06:10,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.483749, valid_loss 1.179733, train_metric nan, valid_metric 0.052137
[2648869:MainThread](2024-03-27 12:06:10,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.179733, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:06:10,898) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.337169, valid_loss 1.146313, train_metric nan, valid_metric 0.074146
[2648869:MainThread](2024-03-27 12:06:10,899) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.179733 to 1.146313, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:11,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.164654, valid_loss 1.144351, train_metric nan, valid_metric 0.086851
[2648869:MainThread](2024-03-27 12:06:11,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.146313 to 1.144351, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:11,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.174290, valid_loss 1.154179, train_metric nan, valid_metric 0.064616
[2648869:MainThread](2024-03-27 12:06:11,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.229932, valid_loss 1.142554, train_metric nan, valid_metric 0.063893
[2648869:MainThread](2024-03-27 12:06:11,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.144351 to 1.142554, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:11,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.229156, valid_loss 1.141306, train_metric nan, valid_metric 0.082530
[2648869:MainThread](2024-03-27 12:06:11,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.142554 to 1.141306, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:11,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.151242, valid_loss 1.142847, train_metric nan, valid_metric 0.085210
[2648869:MainThread](2024-03-27 12:06:12,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.201476, valid_loss 1.142981, train_metric nan, valid_metric 0.081033
[2648869:MainThread](2024-03-27 12:06:12,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.148443, valid_loss 1.139524, train_metric nan, valid_metric 0.084214
[2648869:MainThread](2024-03-27 12:06:12,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.141306 to 1.139524, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:12,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.116312, valid_loss 1.138656, train_metric nan, valid_metric 0.090429
[2648869:MainThread](2024-03-27 12:06:12,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.139524 to 1.138656, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:12,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.089887, valid_loss 1.139994, train_metric nan, valid_metric 0.071714
[2648869:MainThread](2024-03-27 12:06:12,976) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.116183, valid_loss 1.139216, train_metric nan, valid_metric 0.093344
[2648869:MainThread](2024-03-27 12:06:13,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.139216, valid_loss 1.142477, train_metric nan, valid_metric 0.086926
[2648869:MainThread](2024-03-27 12:06:13,393) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.122055, valid_loss 1.140271, train_metric nan, valid_metric 0.088646
[2648869:MainThread](2024-03-27 12:06:13,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.118818, valid_loss 1.138945, train_metric nan, valid_metric 0.110250
[2648869:MainThread](2024-03-27 12:06:13,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.104784, valid_loss 1.137858, train_metric nan, valid_metric 0.101343
[2648869:MainThread](2024-03-27 12:06:13,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.138656 to 1.137858, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:14,015) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.124838, valid_loss 1.138111, train_metric nan, valid_metric 0.082118
[2648869:MainThread](2024-03-27 12:06:14,220) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.107868, valid_loss 1.139509, train_metric nan, valid_metric 0.096959
[2648869:MainThread](2024-03-27 12:06:14,424) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.099142, valid_loss 1.142470, train_metric nan, valid_metric 0.095447
[2648869:MainThread](2024-03-27 12:06:14,630) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.097297, valid_loss 1.146873, train_metric nan, valid_metric 0.076517
[2648869:MainThread](2024-03-27 12:06:14,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.137257, valid_loss 1.139431, train_metric nan, valid_metric 0.082116
[2648869:MainThread](2024-03-27 12:06:15,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.116124, valid_loss 1.141019, train_metric nan, valid_metric 0.061582
[2648869:MainThread](2024-03-27 12:06:15,243) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.123671, valid_loss 1.138001, train_metric nan, valid_metric 0.088999
[2648869:MainThread](2024-03-27 12:06:15,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.125338, valid_loss 1.141805, train_metric nan, valid_metric 0.087715
[2648869:MainThread](2024-03-27 12:06:15,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.114679, valid_loss 1.136928, train_metric nan, valid_metric 0.106185
[2648869:MainThread](2024-03-27 12:06:15,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.137858 to 1.136928, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:15,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.089815, valid_loss 1.139397, train_metric nan, valid_metric 0.100753
[2648869:MainThread](2024-03-27 12:06:16,065) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.084189, valid_loss 1.137481, train_metric nan, valid_metric 0.118279
[2648869:MainThread](2024-03-27 12:06:16,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.092936, valid_loss 1.137270, train_metric nan, valid_metric 0.104474
[2648869:MainThread](2024-03-27 12:06:16,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.082989, valid_loss 1.141259, train_metric nan, valid_metric 0.097864
[2648869:MainThread](2024-03-27 12:06:16,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.111771, valid_loss 1.137361, train_metric nan, valid_metric 0.107459
[2648869:MainThread](2024-03-27 12:06:16,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.082316, valid_loss 1.139851, train_metric nan, valid_metric 0.091825
[2648869:MainThread](2024-03-27 12:06:17,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.076719, valid_loss 1.139069, train_metric nan, valid_metric 0.086024
[2648869:MainThread](2024-03-27 12:06:17,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.078050, valid_loss 1.139556, train_metric nan, valid_metric 0.086506
[2648869:MainThread](2024-03-27 12:06:17,507) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.089517, valid_loss 1.139814, train_metric nan, valid_metric 0.088279
[2648869:MainThread](2024-03-27 12:06:17,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.093238, valid_loss 1.137319, train_metric nan, valid_metric 0.103103
[2648869:MainThread](2024-03-27 12:06:17,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.091265, valid_loss 1.149424, train_metric nan, valid_metric 0.088125
[2648869:MainThread](2024-03-27 12:06:18,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.077860, valid_loss 1.136785, train_metric nan, valid_metric 0.094486
[2648869:MainThread](2024-03-27 12:06:18,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.136928 to 1.136785, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:18,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.093321, valid_loss 1.139625, train_metric nan, valid_metric 0.088849
[2648869:MainThread](2024-03-27 12:06:18,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.081798, valid_loss 1.137958, train_metric nan, valid_metric 0.089029
[2648869:MainThread](2024-03-27 12:06:18,742) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.069817, valid_loss 1.139259, train_metric nan, valid_metric 0.098049
[2648869:MainThread](2024-03-27 12:06:18,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.093445, valid_loss 1.140748, train_metric nan, valid_metric 0.086832
[2648869:MainThread](2024-03-27 12:06:19,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.080242, valid_loss 1.135582, train_metric nan, valid_metric 0.102529
[2648869:MainThread](2024-03-27 12:06:19,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.136785 to 1.135582, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:19,353) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.073674, valid_loss 1.137644, train_metric nan, valid_metric 0.093339
[2648869:MainThread](2024-03-27 12:06:19,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.113757, valid_loss 1.140869, train_metric nan, valid_metric 0.075327
[2648869:MainThread](2024-03-27 12:06:19,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.106489, valid_loss 1.138130, train_metric nan, valid_metric 0.096649
[2648869:MainThread](2024-03-27 12:06:19,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.073541, valid_loss 1.138505, train_metric nan, valid_metric 0.094696
[2648869:MainThread](2024-03-27 12:06:20,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.072569, valid_loss 1.137355, train_metric nan, valid_metric 0.105294
[2648869:MainThread](2024-03-27 12:06:20,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.066615, valid_loss 1.137894, train_metric nan, valid_metric 0.108945
[2648869:MainThread](2024-03-27 12:06:20,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.073905, valid_loss 1.138924, train_metric nan, valid_metric 0.100669
[2648869:MainThread](2024-03-27 12:06:20,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.076530, valid_loss 1.140107, train_metric nan, valid_metric 0.091229
[2648869:MainThread](2024-03-27 12:06:20,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.060235, valid_loss 1.138777, train_metric nan, valid_metric 0.102516
[2648869:MainThread](2024-03-27 12:06:21,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.069522, valid_loss 1.138326, train_metric nan, valid_metric 0.098423
[2648869:MainThread](2024-03-27 12:06:21,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.082623, valid_loss 1.139981, train_metric nan, valid_metric 0.087408
[2648869:MainThread](2024-03-27 12:06:21,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.078984, valid_loss 1.139412, train_metric nan, valid_metric 0.097341
[2648869:MainThread](2024-03-27 12:06:21,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.078930, valid_loss 1.139856, train_metric nan, valid_metric 0.099287
[2648869:MainThread](2024-03-27 12:06:22,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.076371, valid_loss 1.139724, train_metric nan, valid_metric 0.104336
[2648869:MainThread](2024-03-27 12:06:22,211) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.086120, valid_loss 1.138713, train_metric nan, valid_metric 0.110408
[2648869:MainThread](2024-03-27 12:06:22,410) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.063460, valid_loss 1.139377, train_metric nan, valid_metric 0.094838
[2648869:MainThread](2024-03-27 12:06:22,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.077081, valid_loss 1.138275, train_metric nan, valid_metric 0.101396
[2648869:MainThread](2024-03-27 12:06:22,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.075844, valid_loss 1.136781, train_metric nan, valid_metric 0.111822
[2648869:MainThread](2024-03-27 12:06:23,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.078600, valid_loss 1.140329, train_metric nan, valid_metric 0.090855
[2648869:MainThread](2024-03-27 12:06:23,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.073782, valid_loss 1.140030, train_metric nan, valid_metric 0.092172
[2648869:MainThread](2024-03-27 12:06:23,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.080209, valid_loss 1.140418, train_metric nan, valid_metric 0.098386
[2648869:MainThread](2024-03-27 12:06:23,638) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.074871, valid_loss 1.140872, train_metric nan, valid_metric 0.089006
[2648869:MainThread](2024-03-27 12:06:23,846) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.060445, valid_loss 1.139369, train_metric nan, valid_metric 0.096321
[2648869:MainThread](2024-03-27 12:06:24,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.075545, valid_loss 1.139145, train_metric nan, valid_metric 0.095886
[2648869:MainThread](2024-03-27 12:06:24,268) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.087542, valid_loss 1.138957, train_metric nan, valid_metric 0.102563
[2648869:MainThread](2024-03-27 12:06:24,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.072867, valid_loss 1.138729, train_metric nan, valid_metric 0.101380
[2648869:MainThread](2024-03-27 12:06:24,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.061870, valid_loss 1.139318, train_metric nan, valid_metric 0.097050
[2648869:MainThread](2024-03-27 12:06:24,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.080390, valid_loss 1.138724, train_metric nan, valid_metric 0.096413
[2648869:MainThread](2024-03-27 12:06:25,114) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.064382, valid_loss 1.138371, train_metric nan, valid_metric 0.102875
[2648869:MainThread](2024-03-27 12:06:25,322) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.073103, valid_loss 1.137685, train_metric nan, valid_metric 0.103186
[2648869:MainThread](2024-03-27 12:06:25,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.080394, valid_loss 1.137280, train_metric nan, valid_metric 0.109214
[2648869:MainThread](2024-03-27 12:06:25,744) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.064934, valid_loss 1.140019, train_metric nan, valid_metric 0.090968
[2648869:MainThread](2024-03-27 12:06:25,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.062082, valid_loss 1.138913, train_metric nan, valid_metric 0.100661
[2648869:MainThread](2024-03-27 12:06:26,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.067198, valid_loss 1.137733, train_metric nan, valid_metric 0.104924
[2648869:MainThread](2024-03-27 12:06:26,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.082233, valid_loss 1.138295, train_metric nan, valid_metric 0.105444
[2648869:MainThread](2024-03-27 12:06:26,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.066582, valid_loss 1.137630, train_metric nan, valid_metric 0.101225
[2648869:MainThread](2024-03-27 12:06:26,778) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.070516, valid_loss 1.136444, train_metric nan, valid_metric 0.107871
[2648869:MainThread](2024-03-27 12:06:26,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.067847, valid_loss 1.136059, train_metric nan, valid_metric 0.111941
[2648869:MainThread](2024-03-27 12:06:27,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.078964, valid_loss 1.138738, train_metric nan, valid_metric 0.102817
[2648869:MainThread](2024-03-27 12:06:27,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.071521, valid_loss 1.138623, train_metric nan, valid_metric 0.100204
[2648869:MainThread](2024-03-27 12:06:27,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.071364, valid_loss 1.137231, train_metric nan, valid_metric 0.106533
[2648869:MainThread](2024-03-27 12:06:27,812) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.069269, valid_loss 1.137506, train_metric nan, valid_metric 0.110472
[2648869:MainThread](2024-03-27 12:06:28,014) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.076222, valid_loss 1.139697, train_metric nan, valid_metric 0.104426
[2648869:MainThread](2024-03-27 12:06:28,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.077048, valid_loss 1.138522, train_metric nan, valid_metric 0.104602
[2648869:MainThread](2024-03-27 12:06:28,427) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.069291, valid_loss 1.135983, train_metric nan, valid_metric 0.112006
[2648869:MainThread](2024-03-27 12:06:28,629) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.074916, valid_loss 1.137088, train_metric nan, valid_metric 0.111785
[2648869:MainThread](2024-03-27 12:06:28,838) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.073886, valid_loss 1.139834, train_metric nan, valid_metric 0.103344
[2648869:MainThread](2024-03-27 12:06:29,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.075756, valid_loss 1.138301, train_metric nan, valid_metric 0.117132
[2648869:MainThread](2024-03-27 12:06:29,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.081904, valid_loss 1.138607, train_metric nan, valid_metric 0.104385
[2648869:MainThread](2024-03-27 12:06:29,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.072999, valid_loss 1.139968, train_metric nan, valid_metric 0.095549
[2648869:MainThread](2024-03-27 12:06:29,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:06:29,977) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:06:30,544) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  59%|█████▉    | 26/44 [13:52<08:49, 29.44s/it][2648869:MainThread](2024-03-27 12:06:30,551) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:06:30,563) INFO - qlib.workflow - [recorder.py:341] - Recorder 76f1406632984c5fb0d2a0ca86d15b21 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:06:31,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:06:31,195) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:06:31,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:06:31,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:06:32,929) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.794727
            SH600004      0.794727
            SH600006      0.794727
            SH600007      0.794727
            SH600008      0.794727
                            ...   
2017-04-11  SZ300133      1.644956
            SZ300144      1.644956
            SZ300146      1.644956
            SZ300182      1.644956
            SZ300251      1.644956
Length: 563713, dtype: float64
[2648869:MainThread](2024-03-27 12:06:33,820) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2017-04-12  SH600000      1.644956
            SH600009      1.644956
            SH600010      1.644956
            SH600015      1.644956
            SH600016      1.644956
                            ...   
2019-01-18  SZ300144      1.120592
            SZ300251      1.120592
            SZ300296      1.120592
            SZ300408      1.120592
            SZ300433      1.120592
Length: 117346, dtype: float64
[2648869:MainThread](2024-03-27 12:06:33,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:06:34,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.538756, valid_loss 1.283396, train_metric nan, valid_metric 0.059369
[2648869:MainThread](2024-03-27 12:06:34,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.283396, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:06:34,603) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.160782, valid_loss 1.265332, train_metric nan, valid_metric 0.059372
[2648869:MainThread](2024-03-27 12:06:34,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.283396 to 1.265332, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:34,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.172805, valid_loss 1.254778, train_metric nan, valid_metric 0.077324
[2648869:MainThread](2024-03-27 12:06:34,799) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.265332 to 1.254778, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:35,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.114247, valid_loss 1.253767, train_metric nan, valid_metric 0.082492
[2648869:MainThread](2024-03-27 12:06:35,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.254778 to 1.253767, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:35,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.135628, valid_loss 1.248244, train_metric nan, valid_metric 0.090442
[2648869:MainThread](2024-03-27 12:06:35,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.253767 to 1.248244, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:35,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.131133, valid_loss 1.255037, train_metric nan, valid_metric 0.084343
[2648869:MainThread](2024-03-27 12:06:35,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.115350, valid_loss 1.248692, train_metric nan, valid_metric 0.100590
[2648869:MainThread](2024-03-27 12:06:35,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.093999, valid_loss 1.249847, train_metric nan, valid_metric 0.095828
[2648869:MainThread](2024-03-27 12:06:36,047) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.119777, valid_loss 1.248555, train_metric nan, valid_metric 0.099194
[2648869:MainThread](2024-03-27 12:06:36,250) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.114231, valid_loss 1.265364, train_metric nan, valid_metric 0.086548
[2648869:MainThread](2024-03-27 12:06:36,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.172301, valid_loss 1.247810, train_metric nan, valid_metric 0.109854
[2648869:MainThread](2024-03-27 12:06:36,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.248244 to 1.247810, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:36,659) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.089519, valid_loss 1.257724, train_metric nan, valid_metric 0.098607
[2648869:MainThread](2024-03-27 12:06:36,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.107353, valid_loss 1.247182, train_metric nan, valid_metric 0.109496
[2648869:MainThread](2024-03-27 12:06:36,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.247810 to 1.247182, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:37,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.093020, valid_loss 1.251280, train_metric nan, valid_metric 0.098634
[2648869:MainThread](2024-03-27 12:06:37,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.071184, valid_loss 1.246083, train_metric nan, valid_metric 0.110034
[2648869:MainThread](2024-03-27 12:06:37,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.247182 to 1.246083, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:37,492) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.072126, valid_loss 1.245084, train_metric nan, valid_metric 0.117184
[2648869:MainThread](2024-03-27 12:06:37,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.246083 to 1.245084, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:37,701) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.086327, valid_loss 1.244663, train_metric nan, valid_metric 0.115676
[2648869:MainThread](2024-03-27 12:06:37,701) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.245084 to 1.244663, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:37,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.068754, valid_loss 1.242533, train_metric nan, valid_metric 0.115399
[2648869:MainThread](2024-03-27 12:06:37,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.244663 to 1.242533, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:38,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.085112, valid_loss 1.246098, train_metric nan, valid_metric 0.115416
[2648869:MainThread](2024-03-27 12:06:38,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.072314, valid_loss 1.243791, train_metric nan, valid_metric 0.117954
[2648869:MainThread](2024-03-27 12:06:38,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.075861, valid_loss 1.249074, train_metric nan, valid_metric 0.116445
[2648869:MainThread](2024-03-27 12:06:38,742) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.067121, valid_loss 1.244919, train_metric nan, valid_metric 0.117844
[2648869:MainThread](2024-03-27 12:06:38,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.067097, valid_loss 1.244871, train_metric nan, valid_metric 0.115292
[2648869:MainThread](2024-03-27 12:06:39,153) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.071135, valid_loss 1.244796, train_metric nan, valid_metric 0.118053
[2648869:MainThread](2024-03-27 12:06:39,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.072347, valid_loss 1.245238, train_metric nan, valid_metric 0.114444
[2648869:MainThread](2024-03-27 12:06:39,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.054154, valid_loss 1.244045, train_metric nan, valid_metric 0.119174
[2648869:MainThread](2024-03-27 12:06:39,762) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.069326, valid_loss 1.247306, train_metric nan, valid_metric 0.120919
[2648869:MainThread](2024-03-27 12:06:39,970) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.074386, valid_loss 1.245247, train_metric nan, valid_metric 0.115464
[2648869:MainThread](2024-03-27 12:06:40,175) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.086526, valid_loss 1.248204, train_metric nan, valid_metric 0.107060
[2648869:MainThread](2024-03-27 12:06:40,385) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.074136, valid_loss 1.245351, train_metric nan, valid_metric 0.120563
[2648869:MainThread](2024-03-27 12:06:40,590) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.065405, valid_loss 1.243818, train_metric nan, valid_metric 0.121693
[2648869:MainThread](2024-03-27 12:06:40,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.069679, valid_loss 1.244716, train_metric nan, valid_metric 0.120620
[2648869:MainThread](2024-03-27 12:06:40,995) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.070324, valid_loss 1.244262, train_metric nan, valid_metric 0.117448
[2648869:MainThread](2024-03-27 12:06:41,196) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.081702, valid_loss 1.242438, train_metric nan, valid_metric 0.120532
[2648869:MainThread](2024-03-27 12:06:41,196) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.242533 to 1.242438, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:41,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.078744, valid_loss 1.242196, train_metric nan, valid_metric 0.118734
[2648869:MainThread](2024-03-27 12:06:41,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.242438 to 1.242196, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:41,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.064604, valid_loss 1.244699, train_metric nan, valid_metric 0.121800
[2648869:MainThread](2024-03-27 12:06:41,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.052236, valid_loss 1.243425, train_metric nan, valid_metric 0.122068
[2648869:MainThread](2024-03-27 12:06:42,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.056276, valid_loss 1.244212, train_metric nan, valid_metric 0.122750
[2648869:MainThread](2024-03-27 12:06:42,229) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.058721, valid_loss 1.244868, train_metric nan, valid_metric 0.122994
[2648869:MainThread](2024-03-27 12:06:42,433) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.046239, valid_loss 1.245692, train_metric nan, valid_metric 0.122061
[2648869:MainThread](2024-03-27 12:06:42,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.052031, valid_loss 1.244812, train_metric nan, valid_metric 0.122305
[2648869:MainThread](2024-03-27 12:06:42,842) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.068476, valid_loss 1.242254, train_metric nan, valid_metric 0.122166
[2648869:MainThread](2024-03-27 12:06:43,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.059163, valid_loss 1.243679, train_metric nan, valid_metric 0.122832
[2648869:MainThread](2024-03-27 12:06:43,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.058845, valid_loss 1.243011, train_metric nan, valid_metric 0.121899
[2648869:MainThread](2024-03-27 12:06:43,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.050643, valid_loss 1.242499, train_metric nan, valid_metric 0.123070
[2648869:MainThread](2024-03-27 12:06:43,663) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.046726, valid_loss 1.239498, train_metric nan, valid_metric 0.124186
[2648869:MainThread](2024-03-27 12:06:43,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.242196 to 1.239498, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:43,873) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.069445, valid_loss 1.241627, train_metric nan, valid_metric 0.122793
[2648869:MainThread](2024-03-27 12:06:44,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.066831, valid_loss 1.240047, train_metric nan, valid_metric 0.122568
[2648869:MainThread](2024-03-27 12:06:44,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.057697, valid_loss 1.242519, train_metric nan, valid_metric 0.120729
[2648869:MainThread](2024-03-27 12:06:44,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.062208, valid_loss 1.247562, train_metric nan, valid_metric 0.116608
[2648869:MainThread](2024-03-27 12:06:44,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.053393, valid_loss 1.242310, train_metric nan, valid_metric 0.122323
[2648869:MainThread](2024-03-27 12:06:44,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.059772, valid_loss 1.242344, train_metric nan, valid_metric 0.123056
[2648869:MainThread](2024-03-27 12:06:45,108) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.059572, valid_loss 1.242238, train_metric nan, valid_metric 0.124131
[2648869:MainThread](2024-03-27 12:06:45,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.075246, valid_loss 1.238858, train_metric nan, valid_metric 0.123380
[2648869:MainThread](2024-03-27 12:06:45,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.239498 to 1.238858, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:45,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.055109, valid_loss 1.240307, train_metric nan, valid_metric 0.123126
[2648869:MainThread](2024-03-27 12:06:45,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.048979, valid_loss 1.242961, train_metric nan, valid_metric 0.123730
[2648869:MainThread](2024-03-27 12:06:46,119) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.048707, valid_loss 1.243631, train_metric nan, valid_metric 0.121896
[2648869:MainThread](2024-03-27 12:06:46,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.052996, valid_loss 1.239976, train_metric nan, valid_metric 0.123181
[2648869:MainThread](2024-03-27 12:06:46,623) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.054190, valid_loss 1.240401, train_metric nan, valid_metric 0.123237
[2648869:MainThread](2024-03-27 12:06:46,876) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.054851, valid_loss 1.241608, train_metric nan, valid_metric 0.122326
[2648869:MainThread](2024-03-27 12:06:47,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.050116, valid_loss 1.246832, train_metric nan, valid_metric 0.118524
[2648869:MainThread](2024-03-27 12:06:47,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.048151, valid_loss 1.241461, train_metric nan, valid_metric 0.122580
[2648869:MainThread](2024-03-27 12:06:47,629) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.068738, valid_loss 1.240470, train_metric nan, valid_metric 0.121529
[2648869:MainThread](2024-03-27 12:06:47,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.052274, valid_loss 1.241665, train_metric nan, valid_metric 0.121396
[2648869:MainThread](2024-03-27 12:06:48,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.060757, valid_loss 1.238840, train_metric nan, valid_metric 0.122516
[2648869:MainThread](2024-03-27 12:06:48,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.238858 to 1.238840, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:48,298) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.053730, valid_loss 1.241153, train_metric nan, valid_metric 0.121954
[2648869:MainThread](2024-03-27 12:06:48,507) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.058474, valid_loss 1.242600, train_metric nan, valid_metric 0.122229
[2648869:MainThread](2024-03-27 12:06:48,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.058217, valid_loss 1.243680, train_metric nan, valid_metric 0.122914
[2648869:MainThread](2024-03-27 12:06:48,920) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.050395, valid_loss 1.241459, train_metric nan, valid_metric 0.121392
[2648869:MainThread](2024-03-27 12:06:49,169) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.055002, valid_loss 1.242057, train_metric nan, valid_metric 0.122959
[2648869:MainThread](2024-03-27 12:06:49,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.064270, valid_loss 1.244493, train_metric nan, valid_metric 0.122523
[2648869:MainThread](2024-03-27 12:06:49,676) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.047346, valid_loss 1.237861, train_metric nan, valid_metric 0.124198
[2648869:MainThread](2024-03-27 12:06:49,676) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.238840 to 1.237861, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:49,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.043104, valid_loss 1.241014, train_metric nan, valid_metric 0.123030
[2648869:MainThread](2024-03-27 12:06:50,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.053913, valid_loss 1.239586, train_metric nan, valid_metric 0.122418
[2648869:MainThread](2024-03-27 12:06:50,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.060230, valid_loss 1.241535, train_metric nan, valid_metric 0.122632
[2648869:MainThread](2024-03-27 12:06:50,612) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.042233, valid_loss 1.240293, train_metric nan, valid_metric 0.121409
[2648869:MainThread](2024-03-27 12:06:50,818) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.066900, valid_loss 1.242706, train_metric nan, valid_metric 0.122894
[2648869:MainThread](2024-03-27 12:06:51,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.063665, valid_loss 1.243467, train_metric nan, valid_metric 0.121168
[2648869:MainThread](2024-03-27 12:06:51,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.048808, valid_loss 1.243324, train_metric nan, valid_metric 0.122386
[2648869:MainThread](2024-03-27 12:06:51,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.049527, valid_loss 1.241566, train_metric nan, valid_metric 0.121930
[2648869:MainThread](2024-03-27 12:06:51,774) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.059512, valid_loss 1.241012, train_metric nan, valid_metric 0.122870
[2648869:MainThread](2024-03-27 12:06:52,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.054130, valid_loss 1.243334, train_metric nan, valid_metric 0.122147
[2648869:MainThread](2024-03-27 12:06:52,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.056767, valid_loss 1.238380, train_metric nan, valid_metric 0.122843
[2648869:MainThread](2024-03-27 12:06:52,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.049830, valid_loss 1.239003, train_metric nan, valid_metric 0.123191
[2648869:MainThread](2024-03-27 12:06:52,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.057040, valid_loss 1.244190, train_metric nan, valid_metric 0.121014
[2648869:MainThread](2024-03-27 12:06:52,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.048454, valid_loss 1.240279, train_metric nan, valid_metric 0.122110
[2648869:MainThread](2024-03-27 12:06:53,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.060078, valid_loss 1.240534, train_metric nan, valid_metric 0.122756
[2648869:MainThread](2024-03-27 12:06:53,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.051807, valid_loss 1.242521, train_metric nan, valid_metric 0.122078
[2648869:MainThread](2024-03-27 12:06:53,739) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.038960, valid_loss 1.244495, train_metric nan, valid_metric 0.121474
[2648869:MainThread](2024-03-27 12:06:53,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.040181, valid_loss 1.237204, train_metric nan, valid_metric 0.123377
[2648869:MainThread](2024-03-27 12:06:53,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.237861 to 1.237204, save checkpoint.
[2648869:MainThread](2024-03-27 12:06:54,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.042004, valid_loss 1.238438, train_metric nan, valid_metric 0.121830
[2648869:MainThread](2024-03-27 12:06:54,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.040632, valid_loss 1.239877, train_metric nan, valid_metric 0.123378
[2648869:MainThread](2024-03-27 12:06:54,568) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.057091, valid_loss 1.240463, train_metric nan, valid_metric 0.123195
[2648869:MainThread](2024-03-27 12:06:54,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.043318, valid_loss 1.243059, train_metric nan, valid_metric 0.122060
[2648869:MainThread](2024-03-27 12:06:54,980) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.050369, valid_loss 1.237432, train_metric nan, valid_metric 0.122574
[2648869:MainThread](2024-03-27 12:06:55,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.058474, valid_loss 1.241238, train_metric nan, valid_metric 0.122717
[2648869:MainThread](2024-03-27 12:06:55,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.048352, valid_loss 1.239969, train_metric nan, valid_metric 0.122780
[2648869:MainThread](2024-03-27 12:06:55,599) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.044590, valid_loss 1.241030, train_metric nan, valid_metric 0.123687
[2648869:MainThread](2024-03-27 12:06:55,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.056611, valid_loss 1.241083, train_metric nan, valid_metric 0.122748
[2648869:MainThread](2024-03-27 12:06:56,008) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.059596, valid_loss 1.242096, train_metric nan, valid_metric 0.121693
[2648869:MainThread](2024-03-27 12:06:56,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.049455, valid_loss 1.237366, train_metric nan, valid_metric 0.123035
[2648869:MainThread](2024-03-27 12:06:56,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.040914, valid_loss 1.238557, train_metric nan, valid_metric 0.123423
[2648869:MainThread](2024-03-27 12:06:56,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.040479, valid_loss 1.243710, train_metric nan, valid_metric 0.123149
[2648869:MainThread](2024-03-27 12:06:56,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.040582, valid_loss 1.239195, train_metric nan, valid_metric 0.124153
[2648869:MainThread](2024-03-27 12:06:57,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.054092, valid_loss 1.238101, train_metric nan, valid_metric 0.123699
[2648869:MainThread](2024-03-27 12:06:57,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.051257, valid_loss 1.240742, train_metric nan, valid_metric 0.124587
[2648869:MainThread](2024-03-27 12:06:57,453) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.050995, valid_loss 1.240482, train_metric nan, valid_metric 0.122560
[2648869:MainThread](2024-03-27 12:06:57,659) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.054318, valid_loss 1.237304, train_metric nan, valid_metric 0.122580
[2648869:MainThread](2024-03-27 12:06:57,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.041467, valid_loss 1.241036, train_metric nan, valid_metric 0.122873
[2648869:MainThread](2024-03-27 12:06:58,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.040354, valid_loss 1.243714, train_metric nan, valid_metric 0.122337
[2648869:MainThread](2024-03-27 12:06:58,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.052217, valid_loss 1.238716, train_metric nan, valid_metric 0.123709
[2648869:MainThread](2024-03-27 12:06:58,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.057055, valid_loss 1.238814, train_metric nan, valid_metric 0.123582
[2648869:MainThread](2024-03-27 12:06:58,690) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.051724, valid_loss 1.239919, train_metric nan, valid_metric 0.123187
[2648869:MainThread](2024-03-27 12:06:58,895) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.053695, valid_loss 1.241513, train_metric nan, valid_metric 0.123402
[2648869:MainThread](2024-03-27 12:06:59,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.040304, valid_loss 1.243034, train_metric nan, valid_metric 0.122528
[2648869:MainThread](2024-03-27 12:06:59,305) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.046641, valid_loss 1.241312, train_metric nan, valid_metric 0.122896
[2648869:MainThread](2024-03-27 12:06:59,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 1.045373, valid_loss 1.242162, train_metric nan, valid_metric 0.122164
[2648869:MainThread](2024-03-27 12:06:59,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 1.050499, valid_loss 1.238353, train_metric nan, valid_metric 0.123018
[2648869:MainThread](2024-03-27 12:06:59,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 1.046378, valid_loss 1.242024, train_metric nan, valid_metric 0.122864
[2648869:MainThread](2024-03-27 12:07:00,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 1.048720, valid_loss 1.239142, train_metric nan, valid_metric 0.123167
[2648869:MainThread](2024-03-27 12:07:00,344) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 1.059201, valid_loss 1.242863, train_metric nan, valid_metric 0.123697
[2648869:MainThread](2024-03-27 12:07:00,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 1.058482, valid_loss 1.240181, train_metric nan, valid_metric 0.123160
[2648869:MainThread](2024-03-27 12:07:00,754) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 1.052767, valid_loss 1.243668, train_metric nan, valid_metric 0.122650
[2648869:MainThread](2024-03-27 12:07:00,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 1.049969, valid_loss 1.240226, train_metric nan, valid_metric 0.124010
[2648869:MainThread](2024-03-27 12:07:01,171) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 1.056284, valid_loss 1.243594, train_metric nan, valid_metric 0.123431
[2648869:MainThread](2024-03-27 12:07:01,376) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 1.046095, valid_loss 1.241813, train_metric nan, valid_metric 0.123096
[2648869:MainThread](2024-03-27 12:07:01,579) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 1.050894, valid_loss 1.239099, train_metric nan, valid_metric 0.123334
[2648869:MainThread](2024-03-27 12:07:01,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 1.050115, valid_loss 1.242451, train_metric nan, valid_metric 0.123572
[2648869:MainThread](2024-03-27 12:07:01,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 1.053834, valid_loss 1.240960, train_metric nan, valid_metric 0.122969
[2648869:MainThread](2024-03-27 12:07:02,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 1.037148, valid_loss 1.240533, train_metric nan, valid_metric 0.123517
[2648869:MainThread](2024-03-27 12:07:02,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 1.045167, valid_loss 1.238239, train_metric nan, valid_metric 0.123653
[2648869:MainThread](2024-03-27 12:07:02,602) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 1.034193, valid_loss 1.240376, train_metric nan, valid_metric 0.123065
[2648869:MainThread](2024-03-27 12:07:02,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 1.040226, valid_loss 1.238841, train_metric nan, valid_metric 0.123367
[2648869:MainThread](2024-03-27 12:07:03,016) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 1.040890, valid_loss 1.240066, train_metric nan, valid_metric 0.123103
[2648869:MainThread](2024-03-27 12:07:03,223) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 1.045952, valid_loss 1.237259, train_metric nan, valid_metric 0.123875
[2648869:MainThread](2024-03-27 12:07:03,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 1.050287, valid_loss 1.239280, train_metric nan, valid_metric 0.123162
[2648869:MainThread](2024-03-27 12:07:03,628) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 1.056215, valid_loss 1.241264, train_metric nan, valid_metric 0.123516
[2648869:MainThread](2024-03-27 12:07:03,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2760]: train_loss 1.040336, valid_loss 1.237728, train_metric nan, valid_metric 0.123218
[2648869:MainThread](2024-03-27 12:07:04,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2780]: train_loss 1.042615, valid_loss 1.242354, train_metric nan, valid_metric 0.122736
[2648869:MainThread](2024-03-27 12:07:04,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2800]: train_loss 1.048956, valid_loss 1.240716, train_metric nan, valid_metric 0.122442
[2648869:MainThread](2024-03-27 12:07:04,237) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:07:04,766) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:07:05,332) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  61%|██████▏   | 27/44 [14:27<08:47, 31.04s/it][2648869:MainThread](2024-03-27 12:07:05,339) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:07:05,350) INFO - qlib.workflow - [recorder.py:341] - Recorder 49d890fbcaeb466c9e946154b0a49caa starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:07:05,970) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:07:05,970) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:07:05,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:07:05,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:07:07,707) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.642397
            SH600004      0.642397
            SH600006      0.642397
            SH600007      0.642397
            SH600008      0.642397
                            ...   
2017-05-10  SZ300133      1.481220
            SZ300144      1.481220
            SZ300146      1.481220
            SZ300182      1.481220
            SZ300251      1.481220
Length: 568928, dtype: float64
[2648869:MainThread](2024-03-27 12:07:08,636) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2017-05-11  SH600000      1.481220
            SH600008      1.481220
            SH600009      1.481220
            SH600010      1.481220
            SH600015      1.481220
                            ...   
2019-02-22  SZ300144      0.531431
            SZ300251      0.531431
            SZ300296      0.531431
            SZ300408      0.531431
            SZ300433      0.531431
Length: 117859, dtype: float64
[2648869:MainThread](2024-03-27 12:07:08,726) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:07:09,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.384682, valid_loss 1.279831, train_metric nan, valid_metric 0.027611
[2648869:MainThread](2024-03-27 12:07:09,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.279831, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:07:09,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.225677, valid_loss 1.236597, train_metric nan, valid_metric 0.029282
[2648869:MainThread](2024-03-27 12:07:09,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.279831 to 1.236597, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:09,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.200238, valid_loss 1.230119, train_metric nan, valid_metric 0.048439
[2648869:MainThread](2024-03-27 12:07:09,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.236597 to 1.230119, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:09,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.193273, valid_loss 1.225786, train_metric nan, valid_metric 0.051903
[2648869:MainThread](2024-03-27 12:07:09,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.230119 to 1.225786, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:10,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.182948, valid_loss 1.220385, train_metric nan, valid_metric 0.073488
[2648869:MainThread](2024-03-27 12:07:10,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.225786 to 1.220385, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:10,242) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.117572, valid_loss 1.224049, train_metric nan, valid_metric 0.066526
[2648869:MainThread](2024-03-27 12:07:10,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.125796, valid_loss 1.219867, train_metric nan, valid_metric 0.070513
[2648869:MainThread](2024-03-27 12:07:10,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.220385 to 1.219867, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:10,651) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.142239, valid_loss 1.232561, train_metric nan, valid_metric 0.074025
[2648869:MainThread](2024-03-27 12:07:10,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.168743, valid_loss 1.215057, train_metric nan, valid_metric 0.077819
[2648869:MainThread](2024-03-27 12:07:10,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.219867 to 1.215057, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:11,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.111195, valid_loss 1.216158, train_metric nan, valid_metric 0.075119
[2648869:MainThread](2024-03-27 12:07:11,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.141916, valid_loss 1.218389, train_metric nan, valid_metric 0.078867
[2648869:MainThread](2024-03-27 12:07:11,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.120701, valid_loss 1.218929, train_metric nan, valid_metric 0.079531
[2648869:MainThread](2024-03-27 12:07:11,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.134692, valid_loss 1.215984, train_metric nan, valid_metric 0.081771
[2648869:MainThread](2024-03-27 12:07:11,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.113485, valid_loss 1.215988, train_metric nan, valid_metric 0.085400
[2648869:MainThread](2024-03-27 12:07:12,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.117404, valid_loss 1.217217, train_metric nan, valid_metric 0.082488
[2648869:MainThread](2024-03-27 12:07:12,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.110114, valid_loss 1.216889, train_metric nan, valid_metric 0.081866
[2648869:MainThread](2024-03-27 12:07:12,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.096936, valid_loss 1.218578, train_metric nan, valid_metric 0.086369
[2648869:MainThread](2024-03-27 12:07:12,696) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.105228, valid_loss 1.217013, train_metric nan, valid_metric 0.083901
[2648869:MainThread](2024-03-27 12:07:12,895) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.090815, valid_loss 1.217922, train_metric nan, valid_metric 0.083977
[2648869:MainThread](2024-03-27 12:07:13,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.082537, valid_loss 1.214858, train_metric nan, valid_metric 0.083153
[2648869:MainThread](2024-03-27 12:07:13,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.215057 to 1.214858, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:13,296) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.104053, valid_loss 1.217627, train_metric nan, valid_metric 0.083648
[2648869:MainThread](2024-03-27 12:07:13,502) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.083978, valid_loss 1.216429, train_metric nan, valid_metric 0.087231
[2648869:MainThread](2024-03-27 12:07:13,705) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.104929, valid_loss 1.214720, train_metric nan, valid_metric 0.086910
[2648869:MainThread](2024-03-27 12:07:13,705) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.214858 to 1.214720, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:13,912) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.090614, valid_loss 1.216761, train_metric nan, valid_metric 0.083174
[2648869:MainThread](2024-03-27 12:07:14,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.097178, valid_loss 1.216829, train_metric nan, valid_metric 0.084082
[2648869:MainThread](2024-03-27 12:07:14,325) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.091175, valid_loss 1.220174, train_metric nan, valid_metric 0.079838
[2648869:MainThread](2024-03-27 12:07:14,528) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.108519, valid_loss 1.215899, train_metric nan, valid_metric 0.086864
[2648869:MainThread](2024-03-27 12:07:14,735) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.083265, valid_loss 1.214211, train_metric nan, valid_metric 0.089734
[2648869:MainThread](2024-03-27 12:07:14,735) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.214720 to 1.214211, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:14,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.092203, valid_loss 1.214660, train_metric nan, valid_metric 0.088175
[2648869:MainThread](2024-03-27 12:07:15,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.102580, valid_loss 1.218650, train_metric nan, valid_metric 0.089300
[2648869:MainThread](2024-03-27 12:07:15,354) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.104106, valid_loss 1.214377, train_metric nan, valid_metric 0.085500
[2648869:MainThread](2024-03-27 12:07:15,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.081233, valid_loss 1.214015, train_metric nan, valid_metric 0.087641
[2648869:MainThread](2024-03-27 12:07:15,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.214211 to 1.214015, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:15,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.081206, valid_loss 1.216282, train_metric nan, valid_metric 0.089385
[2648869:MainThread](2024-03-27 12:07:15,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.087929, valid_loss 1.213708, train_metric nan, valid_metric 0.088999
[2648869:MainThread](2024-03-27 12:07:15,970) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.214015 to 1.213708, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:16,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.081393, valid_loss 1.214329, train_metric nan, valid_metric 0.088127
[2648869:MainThread](2024-03-27 12:07:16,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.098796, valid_loss 1.217485, train_metric nan, valid_metric 0.083264
[2648869:MainThread](2024-03-27 12:07:16,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.088198, valid_loss 1.218380, train_metric nan, valid_metric 0.088967
[2648869:MainThread](2024-03-27 12:07:16,779) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.084920, valid_loss 1.217493, train_metric nan, valid_metric 0.087252
[2648869:MainThread](2024-03-27 12:07:16,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.083618, valid_loss 1.215085, train_metric nan, valid_metric 0.087977
[2648869:MainThread](2024-03-27 12:07:17,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.080537, valid_loss 1.215552, train_metric nan, valid_metric 0.086456
[2648869:MainThread](2024-03-27 12:07:17,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.090041, valid_loss 1.214331, train_metric nan, valid_metric 0.089680
[2648869:MainThread](2024-03-27 12:07:17,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.073462, valid_loss 1.213817, train_metric nan, valid_metric 0.092719
[2648869:MainThread](2024-03-27 12:07:17,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.072247, valid_loss 1.213753, train_metric nan, valid_metric 0.092034
[2648869:MainThread](2024-03-27 12:07:18,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.086123, valid_loss 1.214475, train_metric nan, valid_metric 0.090072
[2648869:MainThread](2024-03-27 12:07:18,227) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.084979, valid_loss 1.217736, train_metric nan, valid_metric 0.086611
[2648869:MainThread](2024-03-27 12:07:18,437) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.077869, valid_loss 1.214636, train_metric nan, valid_metric 0.089389
[2648869:MainThread](2024-03-27 12:07:18,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.087981, valid_loss 1.215593, train_metric nan, valid_metric 0.091294
[2648869:MainThread](2024-03-27 12:07:18,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.066473, valid_loss 1.215384, train_metric nan, valid_metric 0.090821
[2648869:MainThread](2024-03-27 12:07:19,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.072270, valid_loss 1.212974, train_metric nan, valid_metric 0.090262
[2648869:MainThread](2024-03-27 12:07:19,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.213708 to 1.212974, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:19,333) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.072865, valid_loss 1.211766, train_metric nan, valid_metric 0.090220
[2648869:MainThread](2024-03-27 12:07:19,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.212974 to 1.211766, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:19,541) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.061506, valid_loss 1.211394, train_metric nan, valid_metric 0.090071
[2648869:MainThread](2024-03-27 12:07:19,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.211766 to 1.211394, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:19,757) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.078565, valid_loss 1.213406, train_metric nan, valid_metric 0.090911
[2648869:MainThread](2024-03-27 12:07:19,963) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.074042, valid_loss 1.212301, train_metric nan, valid_metric 0.089596
[2648869:MainThread](2024-03-27 12:07:20,169) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.078682, valid_loss 1.212910, train_metric nan, valid_metric 0.089226
[2648869:MainThread](2024-03-27 12:07:20,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.067399, valid_loss 1.215550, train_metric nan, valid_metric 0.087833
[2648869:MainThread](2024-03-27 12:07:20,582) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.067202, valid_loss 1.214556, train_metric nan, valid_metric 0.089710
[2648869:MainThread](2024-03-27 12:07:20,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.064697, valid_loss 1.214353, train_metric nan, valid_metric 0.088699
[2648869:MainThread](2024-03-27 12:07:20,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.065642, valid_loss 1.212956, train_metric nan, valid_metric 0.091267
[2648869:MainThread](2024-03-27 12:07:21,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.065052, valid_loss 1.212130, train_metric nan, valid_metric 0.090987
[2648869:MainThread](2024-03-27 12:07:21,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.083454, valid_loss 1.214603, train_metric nan, valid_metric 0.089264
[2648869:MainThread](2024-03-27 12:07:21,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.073443, valid_loss 1.212378, train_metric nan, valid_metric 0.088794
[2648869:MainThread](2024-03-27 12:07:21,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.072345, valid_loss 1.212983, train_metric nan, valid_metric 0.091199
[2648869:MainThread](2024-03-27 12:07:22,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.062147, valid_loss 1.212705, train_metric nan, valid_metric 0.090741
[2648869:MainThread](2024-03-27 12:07:22,235) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.071664, valid_loss 1.213722, train_metric nan, valid_metric 0.091275
[2648869:MainThread](2024-03-27 12:07:22,440) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.074425, valid_loss 1.212427, train_metric nan, valid_metric 0.090917
[2648869:MainThread](2024-03-27 12:07:22,646) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.072235, valid_loss 1.212840, train_metric nan, valid_metric 0.092015
[2648869:MainThread](2024-03-27 12:07:22,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.067568, valid_loss 1.217060, train_metric nan, valid_metric 0.089671
[2648869:MainThread](2024-03-27 12:07:23,058) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.064868, valid_loss 1.214036, train_metric nan, valid_metric 0.090228
[2648869:MainThread](2024-03-27 12:07:23,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.064907, valid_loss 1.214432, train_metric nan, valid_metric 0.091323
[2648869:MainThread](2024-03-27 12:07:23,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.076958, valid_loss 1.213724, train_metric nan, valid_metric 0.091999
[2648869:MainThread](2024-03-27 12:07:23,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.074435, valid_loss 1.214808, train_metric nan, valid_metric 0.090814
[2648869:MainThread](2024-03-27 12:07:23,895) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.079989, valid_loss 1.211210, train_metric nan, valid_metric 0.090242
[2648869:MainThread](2024-03-27 12:07:23,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.211394 to 1.211210, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:24,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.058782, valid_loss 1.214670, train_metric nan, valid_metric 0.090902
[2648869:MainThread](2024-03-27 12:07:24,307) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.077254, valid_loss 1.211009, train_metric nan, valid_metric 0.092494
[2648869:MainThread](2024-03-27 12:07:24,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.211210 to 1.211009, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:24,517) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.073350, valid_loss 1.213215, train_metric nan, valid_metric 0.090065
[2648869:MainThread](2024-03-27 12:07:24,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.072990, valid_loss 1.213395, train_metric nan, valid_metric 0.091400
[2648869:MainThread](2024-03-27 12:07:24,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.070447, valid_loss 1.212624, train_metric nan, valid_metric 0.090057
[2648869:MainThread](2024-03-27 12:07:25,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.071558, valid_loss 1.212151, train_metric nan, valid_metric 0.089434
[2648869:MainThread](2024-03-27 12:07:25,354) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.066021, valid_loss 1.214745, train_metric nan, valid_metric 0.090169
[2648869:MainThread](2024-03-27 12:07:25,567) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.072297, valid_loss 1.211059, train_metric nan, valid_metric 0.091130
[2648869:MainThread](2024-03-27 12:07:25,778) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.067133, valid_loss 1.214966, train_metric nan, valid_metric 0.091050
[2648869:MainThread](2024-03-27 12:07:25,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.072269, valid_loss 1.213039, train_metric nan, valid_metric 0.090672
[2648869:MainThread](2024-03-27 12:07:26,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.077032, valid_loss 1.212880, train_metric nan, valid_metric 0.090884
[2648869:MainThread](2024-03-27 12:07:26,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.077550, valid_loss 1.212106, train_metric nan, valid_metric 0.091008
[2648869:MainThread](2024-03-27 12:07:26,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.067522, valid_loss 1.212005, train_metric nan, valid_metric 0.090079
[2648869:MainThread](2024-03-27 12:07:26,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.070745, valid_loss 1.212719, train_metric nan, valid_metric 0.091122
[2648869:MainThread](2024-03-27 12:07:27,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.068657, valid_loss 1.212826, train_metric nan, valid_metric 0.090826
[2648869:MainThread](2024-03-27 12:07:27,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.079190, valid_loss 1.214755, train_metric nan, valid_metric 0.089945
[2648869:MainThread](2024-03-27 12:07:27,434) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.077719, valid_loss 1.211327, train_metric nan, valid_metric 0.091590
[2648869:MainThread](2024-03-27 12:07:27,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.083586, valid_loss 1.214694, train_metric nan, valid_metric 0.090808
[2648869:MainThread](2024-03-27 12:07:27,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.077031, valid_loss 1.213945, train_metric nan, valid_metric 0.090909
[2648869:MainThread](2024-03-27 12:07:28,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.068712, valid_loss 1.212297, train_metric nan, valid_metric 0.091595
[2648869:MainThread](2024-03-27 12:07:28,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.077224, valid_loss 1.212640, train_metric nan, valid_metric 0.091691
[2648869:MainThread](2024-03-27 12:07:28,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.069796, valid_loss 1.212871, train_metric nan, valid_metric 0.090028
[2648869:MainThread](2024-03-27 12:07:28,684) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.061565, valid_loss 1.212333, train_metric nan, valid_metric 0.091397
[2648869:MainThread](2024-03-27 12:07:28,892) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.065979, valid_loss 1.212680, train_metric nan, valid_metric 0.091126
[2648869:MainThread](2024-03-27 12:07:29,099) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.074146, valid_loss 1.213696, train_metric nan, valid_metric 0.090239
[2648869:MainThread](2024-03-27 12:07:29,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.062624, valid_loss 1.211453, train_metric nan, valid_metric 0.090400
[2648869:MainThread](2024-03-27 12:07:29,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.069089, valid_loss 1.213564, train_metric nan, valid_metric 0.090296
[2648869:MainThread](2024-03-27 12:07:29,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.073487, valid_loss 1.211337, train_metric nan, valid_metric 0.091115
[2648869:MainThread](2024-03-27 12:07:29,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.075282, valid_loss 1.212727, train_metric nan, valid_metric 0.091282
[2648869:MainThread](2024-03-27 12:07:30,129) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.070238, valid_loss 1.211696, train_metric nan, valid_metric 0.091243
[2648869:MainThread](2024-03-27 12:07:30,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.074935, valid_loss 1.210309, train_metric nan, valid_metric 0.091716
[2648869:MainThread](2024-03-27 12:07:30,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.211009 to 1.210309, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:30,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.071220, valid_loss 1.213507, train_metric nan, valid_metric 0.090625
[2648869:MainThread](2024-03-27 12:07:30,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.073711, valid_loss 1.211715, train_metric nan, valid_metric 0.090818
[2648869:MainThread](2024-03-27 12:07:30,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.069594, valid_loss 1.215095, train_metric nan, valid_metric 0.089379
[2648869:MainThread](2024-03-27 12:07:31,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.076379, valid_loss 1.213232, train_metric nan, valid_metric 0.090681
[2648869:MainThread](2024-03-27 12:07:31,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.069906, valid_loss 1.212909, train_metric nan, valid_metric 0.090988
[2648869:MainThread](2024-03-27 12:07:31,582) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.071930, valid_loss 1.214240, train_metric nan, valid_metric 0.090265
[2648869:MainThread](2024-03-27 12:07:31,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.068600, valid_loss 1.215968, train_metric nan, valid_metric 0.090812
[2648869:MainThread](2024-03-27 12:07:32,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.079731, valid_loss 1.217274, train_metric nan, valid_metric 0.089816
[2648869:MainThread](2024-03-27 12:07:32,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.067175, valid_loss 1.215811, train_metric nan, valid_metric 0.090177
[2648869:MainThread](2024-03-27 12:07:32,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.068226, valid_loss 1.213006, train_metric nan, valid_metric 0.091559
[2648869:MainThread](2024-03-27 12:07:32,608) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.073981, valid_loss 1.214716, train_metric nan, valid_metric 0.090977
[2648869:MainThread](2024-03-27 12:07:32,818) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.062394, valid_loss 1.210321, train_metric nan, valid_metric 0.091111
[2648869:MainThread](2024-03-27 12:07:33,028) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.084720, valid_loss 1.213212, train_metric nan, valid_metric 0.091370
[2648869:MainThread](2024-03-27 12:07:33,237) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 1.061658, valid_loss 1.213681, train_metric nan, valid_metric 0.090853
[2648869:MainThread](2024-03-27 12:07:33,492) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 1.081075, valid_loss 1.214081, train_metric nan, valid_metric 0.092052
[2648869:MainThread](2024-03-27 12:07:33,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 1.070150, valid_loss 1.215099, train_metric nan, valid_metric 0.091009
[2648869:MainThread](2024-03-27 12:07:33,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 1.077354, valid_loss 1.212928, train_metric nan, valid_metric 0.090700
[2648869:MainThread](2024-03-27 12:07:34,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 1.069447, valid_loss 1.210586, train_metric nan, valid_metric 0.091521
[2648869:MainThread](2024-03-27 12:07:34,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 1.072517, valid_loss 1.214346, train_metric nan, valid_metric 0.091335
[2648869:MainThread](2024-03-27 12:07:34,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 1.076107, valid_loss 1.213156, train_metric nan, valid_metric 0.091161
[2648869:MainThread](2024-03-27 12:07:34,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 1.070723, valid_loss 1.213321, train_metric nan, valid_metric 0.091425
[2648869:MainThread](2024-03-27 12:07:35,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 1.068491, valid_loss 1.210657, train_metric nan, valid_metric 0.091605
[2648869:MainThread](2024-03-27 12:07:35,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 1.063149, valid_loss 1.210138, train_metric nan, valid_metric 0.090974
[2648869:MainThread](2024-03-27 12:07:35,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.210309 to 1.210138, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:35,576) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 1.069943, valid_loss 1.211714, train_metric nan, valid_metric 0.091490
[2648869:MainThread](2024-03-27 12:07:35,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 1.068825, valid_loss 1.213674, train_metric nan, valid_metric 0.090143
[2648869:MainThread](2024-03-27 12:07:35,996) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 1.068775, valid_loss 1.214054, train_metric nan, valid_metric 0.090973
[2648869:MainThread](2024-03-27 12:07:36,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 1.079114, valid_loss 1.213398, train_metric nan, valid_metric 0.090693
[2648869:MainThread](2024-03-27 12:07:36,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 1.069134, valid_loss 1.212484, train_metric nan, valid_metric 0.091530
[2648869:MainThread](2024-03-27 12:07:36,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 1.069996, valid_loss 1.215494, train_metric nan, valid_metric 0.091014
[2648869:MainThread](2024-03-27 12:07:36,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 1.072128, valid_loss 1.212311, train_metric nan, valid_metric 0.091570
[2648869:MainThread](2024-03-27 12:07:37,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 1.067228, valid_loss 1.212339, train_metric nan, valid_metric 0.090620
[2648869:MainThread](2024-03-27 12:07:37,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 1.077587, valid_loss 1.212404, train_metric nan, valid_metric 0.090941
[2648869:MainThread](2024-03-27 12:07:37,442) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 1.082138, valid_loss 1.213548, train_metric nan, valid_metric 0.091589
[2648869:MainThread](2024-03-27 12:07:37,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 1.069167, valid_loss 1.210861, train_metric nan, valid_metric 0.091633
[2648869:MainThread](2024-03-27 12:07:37,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2760]: train_loss 1.064878, valid_loss 1.210360, train_metric nan, valid_metric 0.091690
[2648869:MainThread](2024-03-27 12:07:38,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2780]: train_loss 1.073013, valid_loss 1.212838, train_metric nan, valid_metric 0.091197
[2648869:MainThread](2024-03-27 12:07:38,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2800]: train_loss 1.064101, valid_loss 1.213648, train_metric nan, valid_metric 0.091727
[2648869:MainThread](2024-03-27 12:07:38,468) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2820]: train_loss 1.076641, valid_loss 1.212188, train_metric nan, valid_metric 0.090896
[2648869:MainThread](2024-03-27 12:07:38,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2840]: train_loss 1.069978, valid_loss 1.214246, train_metric nan, valid_metric 0.091533
[2648869:MainThread](2024-03-27 12:07:38,881) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2860]: train_loss 1.074577, valid_loss 1.211839, train_metric nan, valid_metric 0.092013
[2648869:MainThread](2024-03-27 12:07:39,084) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2880]: train_loss 1.065307, valid_loss 1.212041, train_metric nan, valid_metric 0.091630
[2648869:MainThread](2024-03-27 12:07:39,297) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2900]: train_loss 1.065992, valid_loss 1.212855, train_metric nan, valid_metric 0.092246
[2648869:MainThread](2024-03-27 12:07:39,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2920]: train_loss 1.063908, valid_loss 1.210042, train_metric nan, valid_metric 0.092376
[2648869:MainThread](2024-03-27 12:07:39,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.210138 to 1.210042, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:39,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2940]: train_loss 1.076762, valid_loss 1.209829, train_metric nan, valid_metric 0.092513
[2648869:MainThread](2024-03-27 12:07:39,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.210042 to 1.209829, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:39,926) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2960]: train_loss 1.068394, valid_loss 1.211738, train_metric nan, valid_metric 0.091113
[2648869:MainThread](2024-03-27 12:07:40,130) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2980]: train_loss 1.079068, valid_loss 1.210016, train_metric nan, valid_metric 0.091478
[2648869:MainThread](2024-03-27 12:07:40,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3000]: train_loss 1.061585, valid_loss 1.211526, train_metric nan, valid_metric 0.092044
[2648869:MainThread](2024-03-27 12:07:40,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3020]: train_loss 1.080900, valid_loss 1.211431, train_metric nan, valid_metric 0.091749
[2648869:MainThread](2024-03-27 12:07:40,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3040]: train_loss 1.063988, valid_loss 1.209925, train_metric nan, valid_metric 0.091792
[2648869:MainThread](2024-03-27 12:07:40,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3060]: train_loss 1.070712, valid_loss 1.215749, train_metric nan, valid_metric 0.090711
[2648869:MainThread](2024-03-27 12:07:41,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3080]: train_loss 1.062285, valid_loss 1.214640, train_metric nan, valid_metric 0.091233
[2648869:MainThread](2024-03-27 12:07:41,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3100]: train_loss 1.076278, valid_loss 1.210461, train_metric nan, valid_metric 0.091566
[2648869:MainThread](2024-03-27 12:07:41,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3120]: train_loss 1.059714, valid_loss 1.210832, train_metric nan, valid_metric 0.091615
[2648869:MainThread](2024-03-27 12:07:41,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3140]: train_loss 1.066948, valid_loss 1.211639, train_metric nan, valid_metric 0.092544
[2648869:MainThread](2024-03-27 12:07:42,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3160]: train_loss 1.073980, valid_loss 1.216851, train_metric nan, valid_metric 0.092110
[2648869:MainThread](2024-03-27 12:07:42,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3180]: train_loss 1.073443, valid_loss 1.211276, train_metric nan, valid_metric 0.092004
[2648869:MainThread](2024-03-27 12:07:42,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3200]: train_loss 1.075817, valid_loss 1.215041, train_metric nan, valid_metric 0.090947
[2648869:MainThread](2024-03-27 12:07:42,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3220]: train_loss 1.077490, valid_loss 1.212935, train_metric nan, valid_metric 0.091905
[2648869:MainThread](2024-03-27 12:07:42,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3240]: train_loss 1.065377, valid_loss 1.213614, train_metric nan, valid_metric 0.092077
[2648869:MainThread](2024-03-27 12:07:43,125) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3260]: train_loss 1.066357, valid_loss 1.212602, train_metric nan, valid_metric 0.091689
[2648869:MainThread](2024-03-27 12:07:43,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3280]: train_loss 1.072182, valid_loss 1.211312, train_metric nan, valid_metric 0.091863
[2648869:MainThread](2024-03-27 12:07:43,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3300]: train_loss 1.068171, valid_loss 1.213216, train_metric nan, valid_metric 0.091829
[2648869:MainThread](2024-03-27 12:07:43,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3320]: train_loss 1.068938, valid_loss 1.211883, train_metric nan, valid_metric 0.092669
[2648869:MainThread](2024-03-27 12:07:43,962) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3340]: train_loss 1.074915, valid_loss 1.212942, train_metric nan, valid_metric 0.091343
[2648869:MainThread](2024-03-27 12:07:44,171) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3360]: train_loss 1.070949, valid_loss 1.210001, train_metric nan, valid_metric 0.091946
[2648869:MainThread](2024-03-27 12:07:44,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3380]: train_loss 1.068263, valid_loss 1.210809, train_metric nan, valid_metric 0.092715
[2648869:MainThread](2024-03-27 12:07:44,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3400]: train_loss 1.073596, valid_loss 1.212700, train_metric nan, valid_metric 0.091361
[2648869:MainThread](2024-03-27 12:07:44,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3420]: train_loss 1.065114, valid_loss 1.214241, train_metric nan, valid_metric 0.091207
[2648869:MainThread](2024-03-27 12:07:45,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3440]: train_loss 1.067337, valid_loss 1.212202, train_metric nan, valid_metric 0.091281
[2648869:MainThread](2024-03-27 12:07:45,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3460]: train_loss 1.073766, valid_loss 1.214836, train_metric nan, valid_metric 0.091072
[2648869:MainThread](2024-03-27 12:07:45,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3480]: train_loss 1.070626, valid_loss 1.212866, train_metric nan, valid_metric 0.091905
[2648869:MainThread](2024-03-27 12:07:45,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3500]: train_loss 1.089006, valid_loss 1.213133, train_metric nan, valid_metric 0.092212
[2648869:MainThread](2024-03-27 12:07:45,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3520]: train_loss 1.076488, valid_loss 1.212487, train_metric nan, valid_metric 0.091394
[2648869:MainThread](2024-03-27 12:07:46,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3540]: train_loss 1.080134, valid_loss 1.212250, train_metric nan, valid_metric 0.091476
[2648869:MainThread](2024-03-27 12:07:46,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3560]: train_loss 1.070670, valid_loss 1.211637, train_metric nan, valid_metric 0.092249
[2648869:MainThread](2024-03-27 12:07:46,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3580]: train_loss 1.071374, valid_loss 1.213381, train_metric nan, valid_metric 0.091766
[2648869:MainThread](2024-03-27 12:07:46,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3600]: train_loss 1.079462, valid_loss 1.210866, train_metric nan, valid_metric 0.092562
[2648869:MainThread](2024-03-27 12:07:46,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3620]: train_loss 1.062356, valid_loss 1.211263, train_metric nan, valid_metric 0.091751
[2648869:MainThread](2024-03-27 12:07:47,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3640]: train_loss 1.076704, valid_loss 1.211273, train_metric nan, valid_metric 0.091172
[2648869:MainThread](2024-03-27 12:07:47,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3660]: train_loss 1.072707, valid_loss 1.210392, train_metric nan, valid_metric 0.091423
[2648869:MainThread](2024-03-27 12:07:47,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3680]: train_loss 1.075507, valid_loss 1.213592, train_metric nan, valid_metric 0.090665
[2648869:MainThread](2024-03-27 12:07:47,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3700]: train_loss 1.059231, valid_loss 1.212860, train_metric nan, valid_metric 0.091571
[2648869:MainThread](2024-03-27 12:07:47,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3720]: train_loss 1.074979, valid_loss 1.210520, train_metric nan, valid_metric 0.091364
[2648869:MainThread](2024-03-27 12:07:48,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3740]: train_loss 1.079761, valid_loss 1.210614, train_metric nan, valid_metric 0.091978
[2648869:MainThread](2024-03-27 12:07:48,342) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3760]: train_loss 1.071173, valid_loss 1.213424, train_metric nan, valid_metric 0.091086
[2648869:MainThread](2024-03-27 12:07:48,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3780]: train_loss 1.078170, valid_loss 1.210707, train_metric nan, valid_metric 0.091048
[2648869:MainThread](2024-03-27 12:07:48,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3800]: train_loss 1.064096, valid_loss 1.214468, train_metric nan, valid_metric 0.091556
[2648869:MainThread](2024-03-27 12:07:48,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3820]: train_loss 1.070136, valid_loss 1.214337, train_metric nan, valid_metric 0.091181
[2648869:MainThread](2024-03-27 12:07:49,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3840]: train_loss 1.070489, valid_loss 1.212389, train_metric nan, valid_metric 0.091686
[2648869:MainThread](2024-03-27 12:07:49,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3860]: train_loss 1.058156, valid_loss 1.211627, train_metric nan, valid_metric 0.092338
[2648869:MainThread](2024-03-27 12:07:49,561) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3880]: train_loss 1.075816, valid_loss 1.215056, train_metric nan, valid_metric 0.092749
[2648869:MainThread](2024-03-27 12:07:49,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3900]: train_loss 1.076320, valid_loss 1.213542, train_metric nan, valid_metric 0.091763
[2648869:MainThread](2024-03-27 12:07:49,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3920]: train_loss 1.059528, valid_loss 1.212744, train_metric nan, valid_metric 0.091223
[2648869:MainThread](2024-03-27 12:07:50,183) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3940]: train_loss 1.083132, valid_loss 1.213284, train_metric nan, valid_metric 0.091420
[2648869:MainThread](2024-03-27 12:07:50,184) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:07:50,840) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:07:51,525) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  64%|██████▎   | 28/44 [15:13<09:29, 35.59s/it][2648869:MainThread](2024-03-27 12:07:51,532) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:07:51,543) INFO - qlib.workflow - [recorder.py:341] - Recorder c87c9a281f4e4b429007b1e46feb5799 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:07:52,169) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:07:52,170) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:07:52,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:07:52,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:07:53,905) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.646948
            SH600004      0.646948
            SH600006      0.646948
            SH600007      0.646948
            SH600008      0.646948
                            ...   
2017-06-09  SZ300133      1.225427
            SZ300144      1.225427
            SZ300146      1.225427
            SZ300182      1.225427
            SZ300251      1.225427
Length: 573998, dtype: float64
[2648869:MainThread](2024-03-27 12:07:54,814) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2017-06-12  SH600000      1.225427
            SH600008      1.225427
            SH600009      1.225427
            SH600010      1.225427
            SH600015      1.225427
                            ...   
2019-03-22  SZ300144      0.639206
            SZ300251      0.639206
            SZ300296      0.639206
            SZ300408      0.639206
            SZ300433      0.639206
Length: 118546, dtype: float64
[2648869:MainThread](2024-03-27 12:07:54,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:07:55,383) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.515947, valid_loss 1.248245, train_metric nan, valid_metric 0.010602
[2648869:MainThread](2024-03-27 12:07:55,383) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.248245, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:07:55,590) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.344084, valid_loss 1.227271, train_metric nan, valid_metric 0.032043
[2648869:MainThread](2024-03-27 12:07:55,591) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.248245 to 1.227271, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:55,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.164094, valid_loss 1.228103, train_metric nan, valid_metric 0.020794
[2648869:MainThread](2024-03-27 12:07:56,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.266154, valid_loss 1.234399, train_metric nan, valid_metric 0.021716
[2648869:MainThread](2024-03-27 12:07:56,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.190302, valid_loss 1.231551, train_metric nan, valid_metric 0.043855
[2648869:MainThread](2024-03-27 12:07:56,415) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.209465, valid_loss 1.229436, train_metric nan, valid_metric 0.045801
[2648869:MainThread](2024-03-27 12:07:56,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.138269, valid_loss 1.219757, train_metric nan, valid_metric 0.048531
[2648869:MainThread](2024-03-27 12:07:56,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.227271 to 1.219757, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:56,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.194339, valid_loss 1.229614, train_metric nan, valid_metric 0.028547
[2648869:MainThread](2024-03-27 12:07:57,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.315868, valid_loss 1.229868, train_metric nan, valid_metric 0.016062
[2648869:MainThread](2024-03-27 12:07:57,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.241485, valid_loss 1.219224, train_metric nan, valid_metric 0.042904
[2648869:MainThread](2024-03-27 12:07:57,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.219757 to 1.219224, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:57,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.124156, valid_loss 1.217661, train_metric nan, valid_metric 0.057679
[2648869:MainThread](2024-03-27 12:07:57,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.219224 to 1.217661, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:57,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.104921, valid_loss 1.220600, train_metric nan, valid_metric 0.041991
[2648869:MainThread](2024-03-27 12:07:57,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.193470, valid_loss 1.225029, train_metric nan, valid_metric 0.032181
[2648869:MainThread](2024-03-27 12:07:58,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.177484, valid_loss 1.219141, train_metric nan, valid_metric 0.055258
[2648869:MainThread](2024-03-27 12:07:58,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.130020, valid_loss 1.220377, train_metric nan, valid_metric 0.048655
[2648869:MainThread](2024-03-27 12:07:58,487) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.134492, valid_loss 1.232429, train_metric nan, valid_metric 0.054920
[2648869:MainThread](2024-03-27 12:07:58,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.093480, valid_loss 1.216099, train_metric nan, valid_metric 0.054475
[2648869:MainThread](2024-03-27 12:07:58,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.217661 to 1.216099, save checkpoint.
[2648869:MainThread](2024-03-27 12:07:58,892) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.162205, valid_loss 1.220580, train_metric nan, valid_metric 0.061225
[2648869:MainThread](2024-03-27 12:07:59,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.205146, valid_loss 1.217239, train_metric nan, valid_metric 0.068399
[2648869:MainThread](2024-03-27 12:07:59,305) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.101651, valid_loss 1.217215, train_metric nan, valid_metric 0.055738
[2648869:MainThread](2024-03-27 12:07:59,511) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.138138, valid_loss 1.220272, train_metric nan, valid_metric 0.049395
[2648869:MainThread](2024-03-27 12:07:59,716) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.174737, valid_loss 1.217268, train_metric nan, valid_metric 0.054714
[2648869:MainThread](2024-03-27 12:07:59,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.115775, valid_loss 1.216991, train_metric nan, valid_metric 0.065507
[2648869:MainThread](2024-03-27 12:08:00,127) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.098851, valid_loss 1.217124, train_metric nan, valid_metric 0.060169
[2648869:MainThread](2024-03-27 12:08:00,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.079302, valid_loss 1.216288, train_metric nan, valid_metric 0.062616
[2648869:MainThread](2024-03-27 12:08:00,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.070710, valid_loss 1.215781, train_metric nan, valid_metric 0.071657
[2648869:MainThread](2024-03-27 12:08:00,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.216099 to 1.215781, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:00,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.092786, valid_loss 1.216025, train_metric nan, valid_metric 0.068561
[2648869:MainThread](2024-03-27 12:08:00,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.080570, valid_loss 1.214263, train_metric nan, valid_metric 0.074251
[2648869:MainThread](2024-03-27 12:08:00,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.215781 to 1.214263, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:01,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.091460, valid_loss 1.215890, train_metric nan, valid_metric 0.067531
[2648869:MainThread](2024-03-27 12:08:01,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.089873, valid_loss 1.215525, train_metric nan, valid_metric 0.073155
[2648869:MainThread](2024-03-27 12:08:01,567) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.102444, valid_loss 1.215651, train_metric nan, valid_metric 0.069425
[2648869:MainThread](2024-03-27 12:08:01,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.081520, valid_loss 1.214239, train_metric nan, valid_metric 0.077855
[2648869:MainThread](2024-03-27 12:08:01,782) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.214263 to 1.214239, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:01,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.072409, valid_loss 1.215472, train_metric nan, valid_metric 0.070237
[2648869:MainThread](2024-03-27 12:08:02,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.079053, valid_loss 1.215030, train_metric nan, valid_metric 0.080218
[2648869:MainThread](2024-03-27 12:08:02,395) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.074224, valid_loss 1.215334, train_metric nan, valid_metric 0.071165
[2648869:MainThread](2024-03-27 12:08:02,598) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.092078, valid_loss 1.213602, train_metric nan, valid_metric 0.079080
[2648869:MainThread](2024-03-27 12:08:02,599) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.214239 to 1.213602, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:02,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.111076, valid_loss 1.214461, train_metric nan, valid_metric 0.075549
[2648869:MainThread](2024-03-27 12:08:03,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.077626, valid_loss 1.215005, train_metric nan, valid_metric 0.077723
[2648869:MainThread](2024-03-27 12:08:03,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.119312, valid_loss 1.215125, train_metric nan, valid_metric 0.071669
[2648869:MainThread](2024-03-27 12:08:03,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.117298, valid_loss 1.214600, train_metric nan, valid_metric 0.076658
[2648869:MainThread](2024-03-27 12:08:03,628) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.064188, valid_loss 1.217790, train_metric nan, valid_metric 0.075949
[2648869:MainThread](2024-03-27 12:08:03,835) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.078030, valid_loss 1.212950, train_metric nan, valid_metric 0.078032
[2648869:MainThread](2024-03-27 12:08:03,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.213602 to 1.212950, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:04,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.073653, valid_loss 1.215226, train_metric nan, valid_metric 0.062367
[2648869:MainThread](2024-03-27 12:08:04,250) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.061674, valid_loss 1.214303, train_metric nan, valid_metric 0.077200
[2648869:MainThread](2024-03-27 12:08:04,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.079052, valid_loss 1.214324, train_metric nan, valid_metric 0.080842
[2648869:MainThread](2024-03-27 12:08:04,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.067968, valid_loss 1.214385, train_metric nan, valid_metric 0.072060
[2648869:MainThread](2024-03-27 12:08:04,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.079278, valid_loss 1.214092, train_metric nan, valid_metric 0.081722
[2648869:MainThread](2024-03-27 12:08:05,065) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.074251, valid_loss 1.214454, train_metric nan, valid_metric 0.077841
[2648869:MainThread](2024-03-27 12:08:05,270) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.086943, valid_loss 1.214293, train_metric nan, valid_metric 0.070104
[2648869:MainThread](2024-03-27 12:08:05,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.079457, valid_loss 1.213904, train_metric nan, valid_metric 0.075176
[2648869:MainThread](2024-03-27 12:08:05,684) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.068042, valid_loss 1.213257, train_metric nan, valid_metric 0.076328
[2648869:MainThread](2024-03-27 12:08:05,887) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.070966, valid_loss 1.213849, train_metric nan, valid_metric 0.077080
[2648869:MainThread](2024-03-27 12:08:06,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.102564, valid_loss 1.215110, train_metric nan, valid_metric 0.070284
[2648869:MainThread](2024-03-27 12:08:06,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.066908, valid_loss 1.214396, train_metric nan, valid_metric 0.075022
[2648869:MainThread](2024-03-27 12:08:06,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.042331, valid_loss 1.213867, train_metric nan, valid_metric 0.071001
[2648869:MainThread](2024-03-27 12:08:06,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.047475, valid_loss 1.213372, train_metric nan, valid_metric 0.079045
[2648869:MainThread](2024-03-27 12:08:06,909) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.060989, valid_loss 1.214306, train_metric nan, valid_metric 0.074676
[2648869:MainThread](2024-03-27 12:08:07,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.034083, valid_loss 1.213723, train_metric nan, valid_metric 0.076108
[2648869:MainThread](2024-03-27 12:08:07,321) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.045725, valid_loss 1.215582, train_metric nan, valid_metric 0.071206
[2648869:MainThread](2024-03-27 12:08:07,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.045360, valid_loss 1.213862, train_metric nan, valid_metric 0.077302
[2648869:MainThread](2024-03-27 12:08:07,737) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.063002, valid_loss 1.214561, train_metric nan, valid_metric 0.077148
[2648869:MainThread](2024-03-27 12:08:07,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.072439, valid_loss 1.214522, train_metric nan, valid_metric 0.074476
[2648869:MainThread](2024-03-27 12:08:08,156) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.046990, valid_loss 1.214134, train_metric nan, valid_metric 0.075733
[2648869:MainThread](2024-03-27 12:08:08,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.055770, valid_loss 1.214236, train_metric nan, valid_metric 0.076657
[2648869:MainThread](2024-03-27 12:08:08,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.045785, valid_loss 1.214608, train_metric nan, valid_metric 0.076386
[2648869:MainThread](2024-03-27 12:08:08,909) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.040510, valid_loss 1.214077, train_metric nan, valid_metric 0.079313
[2648869:MainThread](2024-03-27 12:08:09,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.050484, valid_loss 1.214305, train_metric nan, valid_metric 0.072636
[2648869:MainThread](2024-03-27 12:08:09,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.051089, valid_loss 1.214295, train_metric nan, valid_metric 0.077233
[2648869:MainThread](2024-03-27 12:08:09,580) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.039727, valid_loss 1.214434, train_metric nan, valid_metric 0.072575
[2648869:MainThread](2024-03-27 12:08:09,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.049782, valid_loss 1.213736, train_metric nan, valid_metric 0.078655
[2648869:MainThread](2024-03-27 12:08:10,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.043303, valid_loss 1.214820, train_metric nan, valid_metric 0.072142
[2648869:MainThread](2024-03-27 12:08:10,250) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.070432, valid_loss 1.214659, train_metric nan, valid_metric 0.079191
[2648869:MainThread](2024-03-27 12:08:10,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.040014, valid_loss 1.214014, train_metric nan, valid_metric 0.076883
[2648869:MainThread](2024-03-27 12:08:10,669) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.047657, valid_loss 1.214530, train_metric nan, valid_metric 0.077423
[2648869:MainThread](2024-03-27 12:08:10,881) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.041500, valid_loss 1.214053, train_metric nan, valid_metric 0.077244
[2648869:MainThread](2024-03-27 12:08:11,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.044880, valid_loss 1.213717, train_metric nan, valid_metric 0.083888
[2648869:MainThread](2024-03-27 12:08:11,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.054236, valid_loss 1.214692, train_metric nan, valid_metric 0.074187
[2648869:MainThread](2024-03-27 12:08:11,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.047043, valid_loss 1.214309, train_metric nan, valid_metric 0.076069
[2648869:MainThread](2024-03-27 12:08:11,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.050428, valid_loss 1.214018, train_metric nan, valid_metric 0.073709
[2648869:MainThread](2024-03-27 12:08:12,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.041023, valid_loss 1.213946, train_metric nan, valid_metric 0.077033
[2648869:MainThread](2024-03-27 12:08:12,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.036913, valid_loss 1.213590, train_metric nan, valid_metric 0.080333
[2648869:MainThread](2024-03-27 12:08:12,612) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.049744, valid_loss 1.213845, train_metric nan, valid_metric 0.078215
[2648869:MainThread](2024-03-27 12:08:12,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.031502, valid_loss 1.213784, train_metric nan, valid_metric 0.080077
[2648869:MainThread](2024-03-27 12:08:13,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.045553, valid_loss 1.213501, train_metric nan, valid_metric 0.081026
[2648869:MainThread](2024-03-27 12:08:13,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.040396, valid_loss 1.213069, train_metric nan, valid_metric 0.081202
[2648869:MainThread](2024-03-27 12:08:13,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.039665, valid_loss 1.213732, train_metric nan, valid_metric 0.081910
[2648869:MainThread](2024-03-27 12:08:13,707) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.054200, valid_loss 1.214551, train_metric nan, valid_metric 0.078513
[2648869:MainThread](2024-03-27 12:08:13,912) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.049224, valid_loss 1.214563, train_metric nan, valid_metric 0.077788
[2648869:MainThread](2024-03-27 12:08:14,119) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.047253, valid_loss 1.213734, train_metric nan, valid_metric 0.077571
[2648869:MainThread](2024-03-27 12:08:14,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.053447, valid_loss 1.213802, train_metric nan, valid_metric 0.078065
[2648869:MainThread](2024-03-27 12:08:14,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.060731, valid_loss 1.214278, train_metric nan, valid_metric 0.076193
[2648869:MainThread](2024-03-27 12:08:14,739) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.054547, valid_loss 1.214545, train_metric nan, valid_metric 0.076224
[2648869:MainThread](2024-03-27 12:08:14,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:08:15,267) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:08:15,836) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  66%|██████▌   | 29/44 [15:37<08:03, 32.21s/it][2648869:MainThread](2024-03-27 12:08:15,843) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:08:15,854) INFO - qlib.workflow - [recorder.py:341] - Recorder a620d27bee484162865af7ca4fa9190c starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:08:16,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:08:16,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:08:16,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:08:16,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:08:18,213) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.006572
            SH600004      1.006572
            SH600006      1.006572
            SH600007      1.006572
            SH600008      1.006572
                            ...   
2017-07-07  SZ300072      1.821424
            SZ300124      1.821424
            SZ300133      1.821424
            SZ300144      1.821424
            SZ300251      1.821424
Length: 578828, dtype: float64
[2648869:MainThread](2024-03-27 12:08:19,147) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2017-07-10  SH600000      1.821424
            SH600008      1.821424
            SH600009      1.821424
            SH600010      1.821424
            SH600015      1.821424
                            ...   
2019-04-22  SZ300144      0.554400
            SZ300251      0.554400
            SZ300296      0.554400
            SZ300408      0.554400
            SZ300433      0.554400
Length: 118861, dtype: float64
[2648869:MainThread](2024-03-27 12:08:19,250) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:08:19,742) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.771529, valid_loss 1.256729, train_metric nan, valid_metric 0.025654
[2648869:MainThread](2024-03-27 12:08:19,742) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.256729, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:08:19,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.408075, valid_loss 1.122324, train_metric nan, valid_metric 0.043713
[2648869:MainThread](2024-03-27 12:08:19,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.256729 to 1.122324, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:20,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.268424, valid_loss 1.128105, train_metric nan, valid_metric 0.043987
[2648869:MainThread](2024-03-27 12:08:20,325) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.256423, valid_loss 1.121359, train_metric nan, valid_metric 0.036197
[2648869:MainThread](2024-03-27 12:08:20,325) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.122324 to 1.121359, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:20,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.204268, valid_loss 1.120271, train_metric nan, valid_metric 0.053845
[2648869:MainThread](2024-03-27 12:08:20,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.121359 to 1.120271, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:20,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.218694, valid_loss 1.123017, train_metric nan, valid_metric 0.041066
[2648869:MainThread](2024-03-27 12:08:20,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.353826, valid_loss 1.126762, train_metric nan, valid_metric 0.037476
[2648869:MainThread](2024-03-27 12:08:21,114) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.397459, valid_loss 1.127437, train_metric nan, valid_metric 0.047968
[2648869:MainThread](2024-03-27 12:08:21,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.279637, valid_loss 1.123700, train_metric nan, valid_metric 0.063600
[2648869:MainThread](2024-03-27 12:08:21,515) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.239250, valid_loss 1.122503, train_metric nan, valid_metric 0.041082
[2648869:MainThread](2024-03-27 12:08:21,718) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.166268, valid_loss 1.120784, train_metric nan, valid_metric 0.053015
[2648869:MainThread](2024-03-27 12:08:21,926) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.153980, valid_loss 1.123224, train_metric nan, valid_metric 0.051931
[2648869:MainThread](2024-03-27 12:08:22,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.179537, valid_loss 1.122571, train_metric nan, valid_metric 0.062308
[2648869:MainThread](2024-03-27 12:08:22,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.120153, valid_loss 1.121045, train_metric nan, valid_metric 0.058427
[2648869:MainThread](2024-03-27 12:08:22,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.149572, valid_loss 1.121012, train_metric nan, valid_metric 0.069237
[2648869:MainThread](2024-03-27 12:08:22,750) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.111263, valid_loss 1.120677, train_metric nan, valid_metric 0.065127
[2648869:MainThread](2024-03-27 12:08:22,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.145446, valid_loss 1.123191, train_metric nan, valid_metric 0.051225
[2648869:MainThread](2024-03-27 12:08:23,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.133589, valid_loss 1.121850, train_metric nan, valid_metric 0.070249
[2648869:MainThread](2024-03-27 12:08:23,364) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.106711, valid_loss 1.120065, train_metric nan, valid_metric 0.067765
[2648869:MainThread](2024-03-27 12:08:23,364) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.120271 to 1.120065, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:23,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.131546, valid_loss 1.118370, train_metric nan, valid_metric 0.071654
[2648869:MainThread](2024-03-27 12:08:23,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.120065 to 1.118370, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:23,779) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.115582, valid_loss 1.118980, train_metric nan, valid_metric 0.070477
[2648869:MainThread](2024-03-27 12:08:23,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.116001, valid_loss 1.118476, train_metric nan, valid_metric 0.071983
[2648869:MainThread](2024-03-27 12:08:24,195) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.139221, valid_loss 1.119888, train_metric nan, valid_metric 0.069429
[2648869:MainThread](2024-03-27 12:08:24,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.110346, valid_loss 1.120093, train_metric nan, valid_metric 0.062829
[2648869:MainThread](2024-03-27 12:08:24,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.130414, valid_loss 1.120398, train_metric nan, valid_metric 0.062796
[2648869:MainThread](2024-03-27 12:08:24,810) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.095087, valid_loss 1.119830, train_metric nan, valid_metric 0.068029
[2648869:MainThread](2024-03-27 12:08:25,014) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.122367, valid_loss 1.119250, train_metric nan, valid_metric 0.069139
[2648869:MainThread](2024-03-27 12:08:25,220) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.121655, valid_loss 1.119184, train_metric nan, valid_metric 0.071089
[2648869:MainThread](2024-03-27 12:08:25,425) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.113328, valid_loss 1.119007, train_metric nan, valid_metric 0.073897
[2648869:MainThread](2024-03-27 12:08:25,630) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.122561, valid_loss 1.119091, train_metric nan, valid_metric 0.066809
[2648869:MainThread](2024-03-27 12:08:25,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.105743, valid_loss 1.119413, train_metric nan, valid_metric 0.066157
[2648869:MainThread](2024-03-27 12:08:26,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.110254, valid_loss 1.119208, train_metric nan, valid_metric 0.070301
[2648869:MainThread](2024-03-27 12:08:26,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.107644, valid_loss 1.118359, train_metric nan, valid_metric 0.080484
[2648869:MainThread](2024-03-27 12:08:26,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.118370 to 1.118359, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:26,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.141213, valid_loss 1.118463, train_metric nan, valid_metric 0.076909
[2648869:MainThread](2024-03-27 12:08:26,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.099226, valid_loss 1.119252, train_metric nan, valid_metric 0.074686
[2648869:MainThread](2024-03-27 12:08:26,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.103378, valid_loss 1.117802, train_metric nan, valid_metric 0.084384
[2648869:MainThread](2024-03-27 12:08:26,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.118359 to 1.117802, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:27,079) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.102253, valid_loss 1.120306, train_metric nan, valid_metric 0.070282
[2648869:MainThread](2024-03-27 12:08:27,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.098127, valid_loss 1.120436, train_metric nan, valid_metric 0.070907
[2648869:MainThread](2024-03-27 12:08:27,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.134632, valid_loss 1.119672, train_metric nan, valid_metric 0.067346
[2648869:MainThread](2024-03-27 12:08:27,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.073814, valid_loss 1.118746, train_metric nan, valid_metric 0.074691
[2648869:MainThread](2024-03-27 12:08:27,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.085592, valid_loss 1.119022, train_metric nan, valid_metric 0.076364
[2648869:MainThread](2024-03-27 12:08:28,108) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.079286, valid_loss 1.118818, train_metric nan, valid_metric 0.074237
[2648869:MainThread](2024-03-27 12:08:28,310) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.079296, valid_loss 1.118287, train_metric nan, valid_metric 0.078626
[2648869:MainThread](2024-03-27 12:08:28,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.090897, valid_loss 1.118218, train_metric nan, valid_metric 0.079440
[2648869:MainThread](2024-03-27 12:08:28,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.073206, valid_loss 1.119020, train_metric nan, valid_metric 0.072596
[2648869:MainThread](2024-03-27 12:08:28,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.093213, valid_loss 1.119040, train_metric nan, valid_metric 0.075819
[2648869:MainThread](2024-03-27 12:08:29,126) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.086015, valid_loss 1.119090, train_metric nan, valid_metric 0.078072
[2648869:MainThread](2024-03-27 12:08:29,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.100694, valid_loss 1.119079, train_metric nan, valid_metric 0.076971
[2648869:MainThread](2024-03-27 12:08:29,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.103251, valid_loss 1.118866, train_metric nan, valid_metric 0.075061
[2648869:MainThread](2024-03-27 12:08:29,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.094020, valid_loss 1.119235, train_metric nan, valid_metric 0.077555
[2648869:MainThread](2024-03-27 12:08:29,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.084322, valid_loss 1.118313, train_metric nan, valid_metric 0.079007
[2648869:MainThread](2024-03-27 12:08:30,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.115193, valid_loss 1.118824, train_metric nan, valid_metric 0.074838
[2648869:MainThread](2024-03-27 12:08:30,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.079852, valid_loss 1.118833, train_metric nan, valid_metric 0.077712
[2648869:MainThread](2024-03-27 12:08:30,568) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.112170, valid_loss 1.118407, train_metric nan, valid_metric 0.078295
[2648869:MainThread](2024-03-27 12:08:30,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.080878, valid_loss 1.118299, train_metric nan, valid_metric 0.080753
[2648869:MainThread](2024-03-27 12:08:30,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.086252, valid_loss 1.118304, train_metric nan, valid_metric 0.077040
[2648869:MainThread](2024-03-27 12:08:31,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.092849, valid_loss 1.118718, train_metric nan, valid_metric 0.076041
[2648869:MainThread](2024-03-27 12:08:31,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.095186, valid_loss 1.118585, train_metric nan, valid_metric 0.077933
[2648869:MainThread](2024-03-27 12:08:31,602) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.091366, valid_loss 1.118696, train_metric nan, valid_metric 0.073364
[2648869:MainThread](2024-03-27 12:08:31,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.096674, valid_loss 1.118403, train_metric nan, valid_metric 0.077848
[2648869:MainThread](2024-03-27 12:08:32,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.088149, valid_loss 1.117937, train_metric nan, valid_metric 0.080814
[2648869:MainThread](2024-03-27 12:08:32,215) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.088446, valid_loss 1.119377, train_metric nan, valid_metric 0.072393
[2648869:MainThread](2024-03-27 12:08:32,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.096821, valid_loss 1.118671, train_metric nan, valid_metric 0.076391
[2648869:MainThread](2024-03-27 12:08:32,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.074549, valid_loss 1.118690, train_metric nan, valid_metric 0.074547
[2648869:MainThread](2024-03-27 12:08:32,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.072345, valid_loss 1.118154, train_metric nan, valid_metric 0.079912
[2648869:MainThread](2024-03-27 12:08:33,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.098079, valid_loss 1.118670, train_metric nan, valid_metric 0.076854
[2648869:MainThread](2024-03-27 12:08:33,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.082450, valid_loss 1.118270, train_metric nan, valid_metric 0.079067
[2648869:MainThread](2024-03-27 12:08:33,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.089608, valid_loss 1.119152, train_metric nan, valid_metric 0.072013
[2648869:MainThread](2024-03-27 12:08:33,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.092174, valid_loss 1.118596, train_metric nan, valid_metric 0.078135
[2648869:MainThread](2024-03-27 12:08:33,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.090835, valid_loss 1.118301, train_metric nan, valid_metric 0.079968
[2648869:MainThread](2024-03-27 12:08:34,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.108593, valid_loss 1.118874, train_metric nan, valid_metric 0.073553
[2648869:MainThread](2024-03-27 12:08:34,260) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.119276, valid_loss 1.118835, train_metric nan, valid_metric 0.075998
[2648869:MainThread](2024-03-27 12:08:34,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.075825, valid_loss 1.117853, train_metric nan, valid_metric 0.082846
[2648869:MainThread](2024-03-27 12:08:34,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.080160, valid_loss 1.118627, train_metric nan, valid_metric 0.078970
[2648869:MainThread](2024-03-27 12:08:34,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.100140, valid_loss 1.118436, train_metric nan, valid_metric 0.073906
[2648869:MainThread](2024-03-27 12:08:35,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.084750, valid_loss 1.118539, train_metric nan, valid_metric 0.079598
[2648869:MainThread](2024-03-27 12:08:35,281) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.086795, valid_loss 1.118561, train_metric nan, valid_metric 0.078997
[2648869:MainThread](2024-03-27 12:08:35,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.075000, valid_loss 1.118488, train_metric nan, valid_metric 0.076879
[2648869:MainThread](2024-03-27 12:08:35,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.082394, valid_loss 1.119282, train_metric nan, valid_metric 0.074343
[2648869:MainThread](2024-03-27 12:08:35,892) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.082175, valid_loss 1.119120, train_metric nan, valid_metric 0.077626
[2648869:MainThread](2024-03-27 12:08:36,098) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.074382, valid_loss 1.118656, train_metric nan, valid_metric 0.077253
[2648869:MainThread](2024-03-27 12:08:36,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.090561, valid_loss 1.118420, train_metric nan, valid_metric 0.075742
[2648869:MainThread](2024-03-27 12:08:36,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.079987, valid_loss 1.118109, train_metric nan, valid_metric 0.077498
[2648869:MainThread](2024-03-27 12:08:36,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.073800, valid_loss 1.117905, train_metric nan, valid_metric 0.083130
[2648869:MainThread](2024-03-27 12:08:36,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.103584, valid_loss 1.118864, train_metric nan, valid_metric 0.077590
[2648869:MainThread](2024-03-27 12:08:37,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.087755, valid_loss 1.118517, train_metric nan, valid_metric 0.075884
[2648869:MainThread](2024-03-27 12:08:37,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:08:37,663) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:08:38,300) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  68%|██████▊   | 30/44 [16:00<06:49, 29.28s/it][2648869:MainThread](2024-03-27 12:08:38,307) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:08:38,318) INFO - qlib.workflow - [recorder.py:341] - Recorder ff7d507e7a8a4120bc912c5960df50d3 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:08:38,942) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:08:38,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:08:38,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:08:38,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:08:40,758) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.014669
            SH600004      1.014669
            SH600006      1.014669
            SH600007      1.014669
            SH600008      1.014669
                            ...   
2017-08-04  SZ300072      0.728988
            SZ300124      0.728988
            SZ300133      0.728988
            SZ300144      0.728988
            SZ300251      0.728988
Length: 583868, dtype: float64
[2648869:MainThread](2024-03-27 12:08:41,690) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2017-08-07  SH600000      0.728988
            SH600008      0.728988
            SH600009      0.728988
            SH600010      0.728988
            SH600015      0.728988
                            ...   
2019-05-23  SZ300144      1.318143
            SZ300251      1.318143
            SZ300296      1.318143
            SZ300408      1.318143
            SZ300433      1.318143
Length: 117562, dtype: float64
[2648869:MainThread](2024-03-27 12:08:41,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:08:42,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.554010, valid_loss 1.175303, train_metric nan, valid_metric 0.027652
[2648869:MainThread](2024-03-27 12:08:42,285) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.175303, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:08:42,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.226307, valid_loss 1.161192, train_metric nan, valid_metric 0.059840
[2648869:MainThread](2024-03-27 12:08:42,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.175303 to 1.161192, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:42,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.194851, valid_loss 1.166322, train_metric nan, valid_metric 0.059281
[2648869:MainThread](2024-03-27 12:08:42,895) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.182623, valid_loss 1.161165, train_metric nan, valid_metric 0.070970
[2648869:MainThread](2024-03-27 12:08:42,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.161192 to 1.161165, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:43,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.141507, valid_loss 1.163030, train_metric nan, valid_metric 0.092506
[2648869:MainThread](2024-03-27 12:08:43,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.111630, valid_loss 1.155587, train_metric nan, valid_metric 0.082339
[2648869:MainThread](2024-03-27 12:08:43,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.161165 to 1.155587, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:43,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.124478, valid_loss 1.156475, train_metric nan, valid_metric 0.074410
[2648869:MainThread](2024-03-27 12:08:43,726) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.110763, valid_loss 1.159703, train_metric nan, valid_metric 0.069850
[2648869:MainThread](2024-03-27 12:08:43,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.113508, valid_loss 1.157657, train_metric nan, valid_metric 0.080407
[2648869:MainThread](2024-03-27 12:08:44,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.118868, valid_loss 1.158082, train_metric nan, valid_metric 0.068229
[2648869:MainThread](2024-03-27 12:08:44,342) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.099784, valid_loss 1.160932, train_metric nan, valid_metric 0.056022
[2648869:MainThread](2024-03-27 12:08:44,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.111775, valid_loss 1.155594, train_metric nan, valid_metric 0.088874
[2648869:MainThread](2024-03-27 12:08:44,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.082213, valid_loss 1.155822, train_metric nan, valid_metric 0.075759
[2648869:MainThread](2024-03-27 12:08:44,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.089296, valid_loss 1.155817, train_metric nan, valid_metric 0.077272
[2648869:MainThread](2024-03-27 12:08:45,163) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.091663, valid_loss 1.156795, train_metric nan, valid_metric 0.071329
[2648869:MainThread](2024-03-27 12:08:45,371) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.090592, valid_loss 1.155330, train_metric nan, valid_metric 0.092695
[2648869:MainThread](2024-03-27 12:08:45,371) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.155587 to 1.155330, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:45,578) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.098686, valid_loss 1.154936, train_metric nan, valid_metric 0.090774
[2648869:MainThread](2024-03-27 12:08:45,579) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.155330 to 1.154936, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:45,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.086278, valid_loss 1.155271, train_metric nan, valid_metric 0.077850
[2648869:MainThread](2024-03-27 12:08:45,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.066366, valid_loss 1.153892, train_metric nan, valid_metric 0.090433
[2648869:MainThread](2024-03-27 12:08:45,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.154936 to 1.153892, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:46,195) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.056535, valid_loss 1.155998, train_metric nan, valid_metric 0.090047
[2648869:MainThread](2024-03-27 12:08:46,400) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.072263, valid_loss 1.156413, train_metric nan, valid_metric 0.081540
[2648869:MainThread](2024-03-27 12:08:46,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.112772, valid_loss 1.162462, train_metric nan, valid_metric 0.074961
[2648869:MainThread](2024-03-27 12:08:46,812) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.071110, valid_loss 1.158617, train_metric nan, valid_metric 0.079169
[2648869:MainThread](2024-03-27 12:08:47,058) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.092241, valid_loss 1.154913, train_metric nan, valid_metric 0.085288
[2648869:MainThread](2024-03-27 12:08:47,309) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.091443, valid_loss 1.155160, train_metric nan, valid_metric 0.088730
[2648869:MainThread](2024-03-27 12:08:47,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.075365, valid_loss 1.155068, train_metric nan, valid_metric 0.086734
[2648869:MainThread](2024-03-27 12:08:47,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.055113, valid_loss 1.154792, train_metric nan, valid_metric 0.076561
[2648869:MainThread](2024-03-27 12:08:48,017) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.076956, valid_loss 1.158138, train_metric nan, valid_metric 0.079336
[2648869:MainThread](2024-03-27 12:08:48,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.065307, valid_loss 1.156410, train_metric nan, valid_metric 0.083377
[2648869:MainThread](2024-03-27 12:08:48,425) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.055761, valid_loss 1.155073, train_metric nan, valid_metric 0.077136
[2648869:MainThread](2024-03-27 12:08:48,630) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.058443, valid_loss 1.154144, train_metric nan, valid_metric 0.088057
[2648869:MainThread](2024-03-27 12:08:48,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.039373, valid_loss 1.154629, train_metric nan, valid_metric 0.080544
[2648869:MainThread](2024-03-27 12:08:49,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.060319, valid_loss 1.155034, train_metric nan, valid_metric 0.091285
[2648869:MainThread](2024-03-27 12:08:49,238) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.066793, valid_loss 1.155940, train_metric nan, valid_metric 0.087250
[2648869:MainThread](2024-03-27 12:08:49,440) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.058690, valid_loss 1.154267, train_metric nan, valid_metric 0.090530
[2648869:MainThread](2024-03-27 12:08:49,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.053427, valid_loss 1.155568, train_metric nan, valid_metric 0.090090
[2648869:MainThread](2024-03-27 12:08:49,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.052462, valid_loss 1.154615, train_metric nan, valid_metric 0.086109
[2648869:MainThread](2024-03-27 12:08:50,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.048380, valid_loss 1.154740, train_metric nan, valid_metric 0.087807
[2648869:MainThread](2024-03-27 12:08:50,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.041077, valid_loss 1.155396, train_metric nan, valid_metric 0.078818
[2648869:MainThread](2024-03-27 12:08:50,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.055411, valid_loss 1.154183, train_metric nan, valid_metric 0.087953
[2648869:MainThread](2024-03-27 12:08:50,669) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.051454, valid_loss 1.155064, train_metric nan, valid_metric 0.091705
[2648869:MainThread](2024-03-27 12:08:50,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.048611, valid_loss 1.154501, train_metric nan, valid_metric 0.095769
[2648869:MainThread](2024-03-27 12:08:51,075) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.041271, valid_loss 1.153974, train_metric nan, valid_metric 0.093084
[2648869:MainThread](2024-03-27 12:08:51,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.042496, valid_loss 1.153264, train_metric nan, valid_metric 0.097579
[2648869:MainThread](2024-03-27 12:08:51,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.153892 to 1.153264, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:51,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.043608, valid_loss 1.154928, train_metric nan, valid_metric 0.098145
[2648869:MainThread](2024-03-27 12:08:51,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.052227, valid_loss 1.153967, train_metric nan, valid_metric 0.099847
[2648869:MainThread](2024-03-27 12:08:51,895) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.036076, valid_loss 1.154356, train_metric nan, valid_metric 0.097393
[2648869:MainThread](2024-03-27 12:08:52,098) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.040907, valid_loss 1.154193, train_metric nan, valid_metric 0.089932
[2648869:MainThread](2024-03-27 12:08:52,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.046639, valid_loss 1.154148, train_metric nan, valid_metric 0.094331
[2648869:MainThread](2024-03-27 12:08:52,505) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.064448, valid_loss 1.154425, train_metric nan, valid_metric 0.096084
[2648869:MainThread](2024-03-27 12:08:52,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.041717, valid_loss 1.153605, train_metric nan, valid_metric 0.100367
[2648869:MainThread](2024-03-27 12:08:52,909) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.049810, valid_loss 1.154695, train_metric nan, valid_metric 0.092134
[2648869:MainThread](2024-03-27 12:08:53,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.042404, valid_loss 1.153933, train_metric nan, valid_metric 0.094833
[2648869:MainThread](2024-03-27 12:08:53,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.060518, valid_loss 1.153792, train_metric nan, valid_metric 0.097903
[2648869:MainThread](2024-03-27 12:08:53,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.056758, valid_loss 1.153906, train_metric nan, valid_metric 0.095340
[2648869:MainThread](2024-03-27 12:08:53,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.040255, valid_loss 1.154278, train_metric nan, valid_metric 0.095212
[2648869:MainThread](2024-03-27 12:08:53,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.037312, valid_loss 1.153810, train_metric nan, valid_metric 0.095329
[2648869:MainThread](2024-03-27 12:08:54,130) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.047698, valid_loss 1.153620, train_metric nan, valid_metric 0.095412
[2648869:MainThread](2024-03-27 12:08:54,333) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.047908, valid_loss 1.154861, train_metric nan, valid_metric 0.090660
[2648869:MainThread](2024-03-27 12:08:54,536) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.049924, valid_loss 1.154564, train_metric nan, valid_metric 0.093917
[2648869:MainThread](2024-03-27 12:08:54,737) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.046144, valid_loss 1.154762, train_metric nan, valid_metric 0.092394
[2648869:MainThread](2024-03-27 12:08:54,941) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.050782, valid_loss 1.154404, train_metric nan, valid_metric 0.095508
[2648869:MainThread](2024-03-27 12:08:55,143) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.035450, valid_loss 1.153176, train_metric nan, valid_metric 0.097985
[2648869:MainThread](2024-03-27 12:08:55,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.153264 to 1.153176, save checkpoint.
[2648869:MainThread](2024-03-27 12:08:55,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.042525, valid_loss 1.154362, train_metric nan, valid_metric 0.092031
[2648869:MainThread](2024-03-27 12:08:55,555) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.041728, valid_loss 1.154477, train_metric nan, valid_metric 0.093941
[2648869:MainThread](2024-03-27 12:08:55,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.043667, valid_loss 1.154439, train_metric nan, valid_metric 0.094791
[2648869:MainThread](2024-03-27 12:08:55,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.038880, valid_loss 1.153934, train_metric nan, valid_metric 0.093923
[2648869:MainThread](2024-03-27 12:08:56,169) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.042855, valid_loss 1.154198, train_metric nan, valid_metric 0.094252
[2648869:MainThread](2024-03-27 12:08:56,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.034771, valid_loss 1.153563, train_metric nan, valid_metric 0.095694
[2648869:MainThread](2024-03-27 12:08:56,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.042808, valid_loss 1.153930, train_metric nan, valid_metric 0.094584
[2648869:MainThread](2024-03-27 12:08:56,759) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.038576, valid_loss 1.154492, train_metric nan, valid_metric 0.090127
[2648869:MainThread](2024-03-27 12:08:56,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.037918, valid_loss 1.153929, train_metric nan, valid_metric 0.093045
[2648869:MainThread](2024-03-27 12:08:57,158) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.049670, valid_loss 1.153672, train_metric nan, valid_metric 0.097616
[2648869:MainThread](2024-03-27 12:08:57,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.037427, valid_loss 1.154005, train_metric nan, valid_metric 0.096339
[2648869:MainThread](2024-03-27 12:08:57,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.043135, valid_loss 1.153417, train_metric nan, valid_metric 0.097809
[2648869:MainThread](2024-03-27 12:08:57,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.026256, valid_loss 1.153611, train_metric nan, valid_metric 0.098287
[2648869:MainThread](2024-03-27 12:08:57,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.046528, valid_loss 1.154197, train_metric nan, valid_metric 0.094200
[2648869:MainThread](2024-03-27 12:08:58,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.057111, valid_loss 1.153955, train_metric nan, valid_metric 0.096137
[2648869:MainThread](2024-03-27 12:08:58,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.051027, valid_loss 1.153829, train_metric nan, valid_metric 0.097993
[2648869:MainThread](2024-03-27 12:08:58,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.052051, valid_loss 1.153951, train_metric nan, valid_metric 0.093993
[2648869:MainThread](2024-03-27 12:08:58,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.043408, valid_loss 1.153995, train_metric nan, valid_metric 0.095560
[2648869:MainThread](2024-03-27 12:08:58,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.027688, valid_loss 1.153648, train_metric nan, valid_metric 0.098052
[2648869:MainThread](2024-03-27 12:08:59,170) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.042517, valid_loss 1.153865, train_metric nan, valid_metric 0.096690
[2648869:MainThread](2024-03-27 12:08:59,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.053661, valid_loss 1.154366, train_metric nan, valid_metric 0.095860
[2648869:MainThread](2024-03-27 12:08:59,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.035770, valid_loss 1.154179, train_metric nan, valid_metric 0.095175
[2648869:MainThread](2024-03-27 12:08:59,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.049079, valid_loss 1.153794, train_metric nan, valid_metric 0.096169
[2648869:MainThread](2024-03-27 12:08:59,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.052289, valid_loss 1.154373, train_metric nan, valid_metric 0.095333
[2648869:MainThread](2024-03-27 12:09:00,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.034766, valid_loss 1.153720, train_metric nan, valid_metric 0.092018
[2648869:MainThread](2024-03-27 12:09:00,386) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.054265, valid_loss 1.154515, train_metric nan, valid_metric 0.082965
[2648869:MainThread](2024-03-27 12:09:00,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.042430, valid_loss 1.153627, train_metric nan, valid_metric 0.094809
[2648869:MainThread](2024-03-27 12:09:00,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.043878, valid_loss 1.154536, train_metric nan, valid_metric 0.091513
[2648869:MainThread](2024-03-27 12:09:00,996) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.041417, valid_loss 1.154009, train_metric nan, valid_metric 0.094657
[2648869:MainThread](2024-03-27 12:09:01,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.050015, valid_loss 1.154257, train_metric nan, valid_metric 0.089188
[2648869:MainThread](2024-03-27 12:09:01,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.037781, valid_loss 1.153868, train_metric nan, valid_metric 0.092848
[2648869:MainThread](2024-03-27 12:09:01,607) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.036585, valid_loss 1.154638, train_metric nan, valid_metric 0.093205
[2648869:MainThread](2024-03-27 12:09:01,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.041505, valid_loss 1.154432, train_metric nan, valid_metric 0.096015
[2648869:MainThread](2024-03-27 12:09:02,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.031510, valid_loss 1.154321, train_metric nan, valid_metric 0.092832
[2648869:MainThread](2024-03-27 12:09:02,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.047175, valid_loss 1.154675, train_metric nan, valid_metric 0.093019
[2648869:MainThread](2024-03-27 12:09:02,415) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.034190, valid_loss 1.153978, train_metric nan, valid_metric 0.092532
[2648869:MainThread](2024-03-27 12:09:02,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.044841, valid_loss 1.154019, train_metric nan, valid_metric 0.093843
[2648869:MainThread](2024-03-27 12:09:02,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.042013, valid_loss 1.153765, train_metric nan, valid_metric 0.093303
[2648869:MainThread](2024-03-27 12:09:03,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.050291, valid_loss 1.153919, train_metric nan, valid_metric 0.096002
[2648869:MainThread](2024-03-27 12:09:03,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.050401, valid_loss 1.153643, train_metric nan, valid_metric 0.097795
[2648869:MainThread](2024-03-27 12:09:03,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.044735, valid_loss 1.153701, train_metric nan, valid_metric 0.098877
[2648869:MainThread](2024-03-27 12:09:03,638) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.042856, valid_loss 1.154788, train_metric nan, valid_metric 0.095071
[2648869:MainThread](2024-03-27 12:09:03,842) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.041397, valid_loss 1.154387, train_metric nan, valid_metric 0.093638
[2648869:MainThread](2024-03-27 12:09:04,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.043608, valid_loss 1.153431, train_metric nan, valid_metric 0.097987
[2648869:MainThread](2024-03-27 12:09:04,295) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.037663, valid_loss 1.154289, train_metric nan, valid_metric 0.096003
[2648869:MainThread](2024-03-27 12:09:04,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.039527, valid_loss 1.154523, train_metric nan, valid_metric 0.095567
[2648869:MainThread](2024-03-27 12:09:04,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.028720, valid_loss 1.153954, train_metric nan, valid_metric 0.096229
[2648869:MainThread](2024-03-27 12:09:05,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.035643, valid_loss 1.154673, train_metric nan, valid_metric 0.093977
[2648869:MainThread](2024-03-27 12:09:05,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.048608, valid_loss 1.154203, train_metric nan, valid_metric 0.095370
[2648869:MainThread](2024-03-27 12:09:05,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.050317, valid_loss 1.154169, train_metric nan, valid_metric 0.094365
[2648869:MainThread](2024-03-27 12:09:05,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:09:06,107) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:09:06,643) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  70%|███████   | 31/44 [16:28<06:17, 29.00s/it][2648869:MainThread](2024-03-27 12:09:06,650) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:09:06,663) INFO - qlib.workflow - [recorder.py:341] - Recorder b548f241b3e04e81aea44b73767638bf starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:09:07,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:09:07,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:09:07,342) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:09:07,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:09:08,994) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.741813
            SH600004      0.741813
            SH600006      0.741813
            SH600007      0.741813
            SH600008      0.741813
                            ...   
2017-09-01  SZ300072      0.907864
            SZ300124      0.907864
            SZ300133      0.907864
            SZ300144      0.907864
            SZ300251      0.907864
Length: 589154, dtype: float64
[2648869:MainThread](2024-03-27 12:09:09,923) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2017-09-04  SH600000      0.907864
            SH600008      0.907864
            SH600009      0.907864
            SH600010      0.907864
            SH600015      0.907864
                            ...   
2019-06-21  SZ300296      1.548855
            SZ300408      1.548855
            SZ300413      1.548855
            SZ300433      1.548855
            SZ300498      1.548855
Length: 116931, dtype: float64
[2648869:MainThread](2024-03-27 12:09:10,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:09:10,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.854695, valid_loss 1.155760, train_metric nan, valid_metric 0.058752
[2648869:MainThread](2024-03-27 12:09:10,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.155760, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:09:10,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.442943, valid_loss 1.167055, train_metric nan, valid_metric 0.040688
[2648869:MainThread](2024-03-27 12:09:10,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.279891, valid_loss 1.158422, train_metric nan, valid_metric 0.035682
[2648869:MainThread](2024-03-27 12:09:11,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.158253, valid_loss 1.160106, train_metric nan, valid_metric 0.037518
[2648869:MainThread](2024-03-27 12:09:11,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.180824, valid_loss 1.150601, train_metric nan, valid_metric 0.062464
[2648869:MainThread](2024-03-27 12:09:11,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.155760 to 1.150601, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:11,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.117449, valid_loss 1.150527, train_metric nan, valid_metric 0.054424
[2648869:MainThread](2024-03-27 12:09:11,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.150601 to 1.150527, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:11,718) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.181176, valid_loss 1.151458, train_metric nan, valid_metric 0.060280
[2648869:MainThread](2024-03-27 12:09:11,912) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.124094, valid_loss 1.147191, train_metric nan, valid_metric 0.079749
[2648869:MainThread](2024-03-27 12:09:11,913) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.150527 to 1.147191, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:12,108) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.151900, valid_loss 1.165421, train_metric nan, valid_metric 0.069558
[2648869:MainThread](2024-03-27 12:09:12,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.121507, valid_loss 1.161144, train_metric nan, valid_metric 0.075053
[2648869:MainThread](2024-03-27 12:09:12,536) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.116577, valid_loss 1.147626, train_metric nan, valid_metric 0.073618
[2648869:MainThread](2024-03-27 12:09:12,732) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.108465, valid_loss 1.149826, train_metric nan, valid_metric 0.086542
[2648869:MainThread](2024-03-27 12:09:12,931) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.165945, valid_loss 1.147398, train_metric nan, valid_metric 0.081799
[2648869:MainThread](2024-03-27 12:09:13,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.121304, valid_loss 1.150927, train_metric nan, valid_metric 0.084612
[2648869:MainThread](2024-03-27 12:09:13,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.100528, valid_loss 1.147521, train_metric nan, valid_metric 0.078031
[2648869:MainThread](2024-03-27 12:09:13,536) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.093966, valid_loss 1.144974, train_metric nan, valid_metric 0.095428
[2648869:MainThread](2024-03-27 12:09:13,536) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.147191 to 1.144974, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:13,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.081743, valid_loss 1.145709, train_metric nan, valid_metric 0.092288
[2648869:MainThread](2024-03-27 12:09:13,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.183071, valid_loss 1.148491, train_metric nan, valid_metric 0.087544
[2648869:MainThread](2024-03-27 12:09:14,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.085017, valid_loss 1.145093, train_metric nan, valid_metric 0.085109
[2648869:MainThread](2024-03-27 12:09:14,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.056608, valid_loss 1.144516, train_metric nan, valid_metric 0.100409
[2648869:MainThread](2024-03-27 12:09:14,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.144974 to 1.144516, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:14,755) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.072539, valid_loss 1.145695, train_metric nan, valid_metric 0.086135
[2648869:MainThread](2024-03-27 12:09:14,968) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.106742, valid_loss 1.146006, train_metric nan, valid_metric 0.086304
[2648869:MainThread](2024-03-27 12:09:15,171) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.066747, valid_loss 1.145267, train_metric nan, valid_metric 0.094271
[2648869:MainThread](2024-03-27 12:09:15,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.082186, valid_loss 1.145674, train_metric nan, valid_metric 0.103677
[2648869:MainThread](2024-03-27 12:09:15,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.073703, valid_loss 1.145551, train_metric nan, valid_metric 0.096581
[2648869:MainThread](2024-03-27 12:09:15,782) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.059265, valid_loss 1.147406, train_metric nan, valid_metric 0.091049
[2648869:MainThread](2024-03-27 12:09:15,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.074781, valid_loss 1.145735, train_metric nan, valid_metric 0.083813
[2648869:MainThread](2024-03-27 12:09:16,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.063867, valid_loss 1.146282, train_metric nan, valid_metric 0.099455
[2648869:MainThread](2024-03-27 12:09:16,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.098263, valid_loss 1.147577, train_metric nan, valid_metric 0.102725
[2648869:MainThread](2024-03-27 12:09:16,611) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.069643, valid_loss 1.145365, train_metric nan, valid_metric 0.099888
[2648869:MainThread](2024-03-27 12:09:16,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.059009, valid_loss 1.144005, train_metric nan, valid_metric 0.097011
[2648869:MainThread](2024-03-27 12:09:16,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.144516 to 1.144005, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:17,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.066563, valid_loss 1.145076, train_metric nan, valid_metric 0.105861
[2648869:MainThread](2024-03-27 12:09:17,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.152373, valid_loss 1.148188, train_metric nan, valid_metric 0.102887
[2648869:MainThread](2024-03-27 12:09:17,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.094446, valid_loss 1.146085, train_metric nan, valid_metric 0.099108
[2648869:MainThread](2024-03-27 12:09:17,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.041049, valid_loss 1.146246, train_metric nan, valid_metric 0.095420
[2648869:MainThread](2024-03-27 12:09:17,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.053576, valid_loss 1.145419, train_metric nan, valid_metric 0.101830
[2648869:MainThread](2024-03-27 12:09:18,035) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.078786, valid_loss 1.145487, train_metric nan, valid_metric 0.090274
[2648869:MainThread](2024-03-27 12:09:18,237) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.076077, valid_loss 1.146555, train_metric nan, valid_metric 0.090085
[2648869:MainThread](2024-03-27 12:09:18,440) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.063751, valid_loss 1.145112, train_metric nan, valid_metric 0.102887
[2648869:MainThread](2024-03-27 12:09:18,643) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.068020, valid_loss 1.145424, train_metric nan, valid_metric 0.089757
[2648869:MainThread](2024-03-27 12:09:18,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.067206, valid_loss 1.148070, train_metric nan, valid_metric 0.070828
[2648869:MainThread](2024-03-27 12:09:19,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.065532, valid_loss 1.143595, train_metric nan, valid_metric 0.110380
[2648869:MainThread](2024-03-27 12:09:19,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.144005 to 1.143595, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:19,261) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.051579, valid_loss 1.144277, train_metric nan, valid_metric 0.105477
[2648869:MainThread](2024-03-27 12:09:19,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.047269, valid_loss 1.145429, train_metric nan, valid_metric 0.109266
[2648869:MainThread](2024-03-27 12:09:19,669) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.067675, valid_loss 1.146152, train_metric nan, valid_metric 0.106567
[2648869:MainThread](2024-03-27 12:09:19,869) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.049663, valid_loss 1.145070, train_metric nan, valid_metric 0.090746
[2648869:MainThread](2024-03-27 12:09:20,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.050134, valid_loss 1.145379, train_metric nan, valid_metric 0.102327
[2648869:MainThread](2024-03-27 12:09:20,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.062835, valid_loss 1.146538, train_metric nan, valid_metric 0.095088
[2648869:MainThread](2024-03-27 12:09:20,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.061847, valid_loss 1.143706, train_metric nan, valid_metric 0.111604
[2648869:MainThread](2024-03-27 12:09:20,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.079645, valid_loss 1.145509, train_metric nan, valid_metric 0.102821
[2648869:MainThread](2024-03-27 12:09:20,876) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.055659, valid_loss 1.144644, train_metric nan, valid_metric 0.103705
[2648869:MainThread](2024-03-27 12:09:21,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.056191, valid_loss 1.146597, train_metric nan, valid_metric 0.090806
[2648869:MainThread](2024-03-27 12:09:21,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.057924, valid_loss 1.143608, train_metric nan, valid_metric 0.103612
[2648869:MainThread](2024-03-27 12:09:21,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.035796, valid_loss 1.144578, train_metric nan, valid_metric 0.106068
[2648869:MainThread](2024-03-27 12:09:21,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.062935, valid_loss 1.145806, train_metric nan, valid_metric 0.111357
[2648869:MainThread](2024-03-27 12:09:21,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.068386, valid_loss 1.144434, train_metric nan, valid_metric 0.095870
[2648869:MainThread](2024-03-27 12:09:22,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.051909, valid_loss 1.144197, train_metric nan, valid_metric 0.095449
[2648869:MainThread](2024-03-27 12:09:22,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.058576, valid_loss 1.145032, train_metric nan, valid_metric 0.101960
[2648869:MainThread](2024-03-27 12:09:22,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.035398, valid_loss 1.144916, train_metric nan, valid_metric 0.112701
[2648869:MainThread](2024-03-27 12:09:22,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.053919, valid_loss 1.143761, train_metric nan, valid_metric 0.112324
[2648869:MainThread](2024-03-27 12:09:22,920) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.053408, valid_loss 1.144306, train_metric nan, valid_metric 0.108861
[2648869:MainThread](2024-03-27 12:09:23,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.035378, valid_loss 1.143348, train_metric nan, valid_metric 0.106368
[2648869:MainThread](2024-03-27 12:09:23,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.143595 to 1.143348, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:23,326) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.038830, valid_loss 1.144545, train_metric nan, valid_metric 0.108878
[2648869:MainThread](2024-03-27 12:09:23,528) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.041055, valid_loss 1.143769, train_metric nan, valid_metric 0.108882
[2648869:MainThread](2024-03-27 12:09:23,731) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.038192, valid_loss 1.143756, train_metric nan, valid_metric 0.107385
[2648869:MainThread](2024-03-27 12:09:23,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.041565, valid_loss 1.144063, train_metric nan, valid_metric 0.111326
[2648869:MainThread](2024-03-27 12:09:24,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.027883, valid_loss 1.143444, train_metric nan, valid_metric 0.103885
[2648869:MainThread](2024-03-27 12:09:24,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.058970, valid_loss 1.144344, train_metric nan, valid_metric 0.109986
[2648869:MainThread](2024-03-27 12:09:24,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.054645, valid_loss 1.143545, train_metric nan, valid_metric 0.104971
[2648869:MainThread](2024-03-27 12:09:24,742) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.031695, valid_loss 1.144341, train_metric nan, valid_metric 0.104776
[2648869:MainThread](2024-03-27 12:09:24,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.026474, valid_loss 1.144959, train_metric nan, valid_metric 0.103960
[2648869:MainThread](2024-03-27 12:09:25,148) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.034270, valid_loss 1.144103, train_metric nan, valid_metric 0.105105
[2648869:MainThread](2024-03-27 12:09:25,354) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.050639, valid_loss 1.144087, train_metric nan, valid_metric 0.105583
[2648869:MainThread](2024-03-27 12:09:25,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.026809, valid_loss 1.145075, train_metric nan, valid_metric 0.109003
[2648869:MainThread](2024-03-27 12:09:25,771) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.035475, valid_loss 1.143294, train_metric nan, valid_metric 0.106018
[2648869:MainThread](2024-03-27 12:09:25,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.143348 to 1.143294, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:25,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.036377, valid_loss 1.143689, train_metric nan, valid_metric 0.108200
[2648869:MainThread](2024-03-27 12:09:26,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.042422, valid_loss 1.144471, train_metric nan, valid_metric 0.107524
[2648869:MainThread](2024-03-27 12:09:26,400) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.038291, valid_loss 1.144547, train_metric nan, valid_metric 0.103759
[2648869:MainThread](2024-03-27 12:09:26,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.040306, valid_loss 1.144198, train_metric nan, valid_metric 0.108908
[2648869:MainThread](2024-03-27 12:09:26,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.041497, valid_loss 1.143739, train_metric nan, valid_metric 0.111129
[2648869:MainThread](2024-03-27 12:09:27,004) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.044041, valid_loss 1.143754, train_metric nan, valid_metric 0.110086
[2648869:MainThread](2024-03-27 12:09:27,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.033167, valid_loss 1.143872, train_metric nan, valid_metric 0.104896
[2648869:MainThread](2024-03-27 12:09:27,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.047767, valid_loss 1.144357, train_metric nan, valid_metric 0.114665
[2648869:MainThread](2024-03-27 12:09:27,608) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.050207, valid_loss 1.143711, train_metric nan, valid_metric 0.113110
[2648869:MainThread](2024-03-27 12:09:27,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.039772, valid_loss 1.146035, train_metric nan, valid_metric 0.108699
[2648869:MainThread](2024-03-27 12:09:28,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.057339, valid_loss 1.144924, train_metric nan, valid_metric 0.110291
[2648869:MainThread](2024-03-27 12:09:28,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.030476, valid_loss 1.144151, train_metric nan, valid_metric 0.106488
[2648869:MainThread](2024-03-27 12:09:28,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.038948, valid_loss 1.143905, train_metric nan, valid_metric 0.104924
[2648869:MainThread](2024-03-27 12:09:28,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.036178, valid_loss 1.144358, train_metric nan, valid_metric 0.109335
[2648869:MainThread](2024-03-27 12:09:28,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.045939, valid_loss 1.144226, train_metric nan, valid_metric 0.109035
[2648869:MainThread](2024-03-27 12:09:29,021) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.033998, valid_loss 1.143408, train_metric nan, valid_metric 0.107493
[2648869:MainThread](2024-03-27 12:09:29,220) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.038542, valid_loss 1.143358, train_metric nan, valid_metric 0.110899
[2648869:MainThread](2024-03-27 12:09:29,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.037929, valid_loss 1.143991, train_metric nan, valid_metric 0.110706
[2648869:MainThread](2024-03-27 12:09:29,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.038976, valid_loss 1.143281, train_metric nan, valid_metric 0.108880
[2648869:MainThread](2024-03-27 12:09:29,628) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.143294 to 1.143281, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:29,835) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.040319, valid_loss 1.144849, train_metric nan, valid_metric 0.110767
[2648869:MainThread](2024-03-27 12:09:30,039) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.047388, valid_loss 1.144677, train_metric nan, valid_metric 0.109341
[2648869:MainThread](2024-03-27 12:09:30,250) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.046054, valid_loss 1.144183, train_metric nan, valid_metric 0.107002
[2648869:MainThread](2024-03-27 12:09:30,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.032144, valid_loss 1.144294, train_metric nan, valid_metric 0.109787
[2648869:MainThread](2024-03-27 12:09:30,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.033866, valid_loss 1.144744, train_metric nan, valid_metric 0.107490
[2648869:MainThread](2024-03-27 12:09:30,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.039068, valid_loss 1.144465, train_metric nan, valid_metric 0.104090
[2648869:MainThread](2024-03-27 12:09:31,073) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.039709, valid_loss 1.144519, train_metric nan, valid_metric 0.108207
[2648869:MainThread](2024-03-27 12:09:31,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.039897, valid_loss 1.144395, train_metric nan, valid_metric 0.109935
[2648869:MainThread](2024-03-27 12:09:31,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.027195, valid_loss 1.144554, train_metric nan, valid_metric 0.108008
[2648869:MainThread](2024-03-27 12:09:31,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.028013, valid_loss 1.145268, train_metric nan, valid_metric 0.101094
[2648869:MainThread](2024-03-27 12:09:31,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.045353, valid_loss 1.143463, train_metric nan, valid_metric 0.107496
[2648869:MainThread](2024-03-27 12:09:32,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.039225, valid_loss 1.143580, train_metric nan, valid_metric 0.106824
[2648869:MainThread](2024-03-27 12:09:32,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.035497, valid_loss 1.144720, train_metric nan, valid_metric 0.111466
[2648869:MainThread](2024-03-27 12:09:32,483) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.030838, valid_loss 1.144302, train_metric nan, valid_metric 0.113758
[2648869:MainThread](2024-03-27 12:09:32,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.025458, valid_loss 1.144216, train_metric nan, valid_metric 0.107249
[2648869:MainThread](2024-03-27 12:09:32,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.029784, valid_loss 1.144712, train_metric nan, valid_metric 0.107831
[2648869:MainThread](2024-03-27 12:09:33,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.040731, valid_loss 1.143091, train_metric nan, valid_metric 0.107756
[2648869:MainThread](2024-03-27 12:09:33,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.143281 to 1.143091, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:33,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.044663, valid_loss 1.144633, train_metric nan, valid_metric 0.109897
[2648869:MainThread](2024-03-27 12:09:33,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.026587, valid_loss 1.144998, train_metric nan, valid_metric 0.111250
[2648869:MainThread](2024-03-27 12:09:33,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.044882, valid_loss 1.144738, train_metric nan, valid_metric 0.111375
[2648869:MainThread](2024-03-27 12:09:33,907) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.040024, valid_loss 1.144540, train_metric nan, valid_metric 0.105431
[2648869:MainThread](2024-03-27 12:09:34,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.035156, valid_loss 1.143432, train_metric nan, valid_metric 0.105793
[2648869:MainThread](2024-03-27 12:09:34,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 1.043598, valid_loss 1.143787, train_metric nan, valid_metric 0.108514
[2648869:MainThread](2024-03-27 12:09:34,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 1.034202, valid_loss 1.143857, train_metric nan, valid_metric 0.108685
[2648869:MainThread](2024-03-27 12:09:34,726) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 1.040462, valid_loss 1.144609, train_metric nan, valid_metric 0.104641
[2648869:MainThread](2024-03-27 12:09:34,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 1.051960, valid_loss 1.144157, train_metric nan, valid_metric 0.107631
[2648869:MainThread](2024-03-27 12:09:35,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 1.046450, valid_loss 1.144631, train_metric nan, valid_metric 0.106436
[2648869:MainThread](2024-03-27 12:09:35,344) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 1.030059, valid_loss 1.144382, train_metric nan, valid_metric 0.104684
[2648869:MainThread](2024-03-27 12:09:35,551) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 1.046491, valid_loss 1.143985, train_metric nan, valid_metric 0.106977
[2648869:MainThread](2024-03-27 12:09:35,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 1.029586, valid_loss 1.143281, train_metric nan, valid_metric 0.108627
[2648869:MainThread](2024-03-27 12:09:35,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 1.039591, valid_loss 1.143673, train_metric nan, valid_metric 0.110404
[2648869:MainThread](2024-03-27 12:09:36,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 1.037611, valid_loss 1.143459, train_metric nan, valid_metric 0.107837
[2648869:MainThread](2024-03-27 12:09:36,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 1.047393, valid_loss 1.143643, train_metric nan, valid_metric 0.103054
[2648869:MainThread](2024-03-27 12:09:36,581) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 1.033098, valid_loss 1.145037, train_metric nan, valid_metric 0.108745
[2648869:MainThread](2024-03-27 12:09:36,784) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 1.037828, valid_loss 1.145208, train_metric nan, valid_metric 0.106345
[2648869:MainThread](2024-03-27 12:09:36,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 1.025690, valid_loss 1.144462, train_metric nan, valid_metric 0.108175
[2648869:MainThread](2024-03-27 12:09:37,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 1.043608, valid_loss 1.144365, train_metric nan, valid_metric 0.105204
[2648869:MainThread](2024-03-27 12:09:37,393) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 1.040461, valid_loss 1.144483, train_metric nan, valid_metric 0.108853
[2648869:MainThread](2024-03-27 12:09:37,594) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 1.034645, valid_loss 1.144750, train_metric nan, valid_metric 0.102273
[2648869:MainThread](2024-03-27 12:09:37,793) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 1.045509, valid_loss 1.143908, train_metric nan, valid_metric 0.104350
[2648869:MainThread](2024-03-27 12:09:37,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 1.038588, valid_loss 1.143218, train_metric nan, valid_metric 0.108039
[2648869:MainThread](2024-03-27 12:09:38,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 1.032661, valid_loss 1.144301, train_metric nan, valid_metric 0.109693
[2648869:MainThread](2024-03-27 12:09:38,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 1.029110, valid_loss 1.144184, train_metric nan, valid_metric 0.108034
[2648869:MainThread](2024-03-27 12:09:38,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2760]: train_loss 1.057514, valid_loss 1.144332, train_metric nan, valid_metric 0.107459
[2648869:MainThread](2024-03-27 12:09:38,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2780]: train_loss 1.033993, valid_loss 1.144668, train_metric nan, valid_metric 0.109053
[2648869:MainThread](2024-03-27 12:09:38,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2800]: train_loss 1.043248, valid_loss 1.144350, train_metric nan, valid_metric 0.106943
[2648869:MainThread](2024-03-27 12:09:39,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2820]: train_loss 1.036223, valid_loss 1.144567, train_metric nan, valid_metric 0.111128
[2648869:MainThread](2024-03-27 12:09:39,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2840]: train_loss 1.031359, valid_loss 1.143518, train_metric nan, valid_metric 0.108818
[2648869:MainThread](2024-03-27 12:09:39,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2860]: train_loss 1.034747, valid_loss 1.143644, train_metric nan, valid_metric 0.106469
[2648869:MainThread](2024-03-27 12:09:39,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2880]: train_loss 1.038166, valid_loss 1.144212, train_metric nan, valid_metric 0.106827
[2648869:MainThread](2024-03-27 12:09:39,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2900]: train_loss 1.039030, valid_loss 1.144042, train_metric nan, valid_metric 0.106594
[2648869:MainThread](2024-03-27 12:09:40,187) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2920]: train_loss 1.029993, valid_loss 1.143410, train_metric nan, valid_metric 0.106597
[2648869:MainThread](2024-03-27 12:09:40,385) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2940]: train_loss 1.040430, valid_loss 1.144247, train_metric nan, valid_metric 0.104769
[2648869:MainThread](2024-03-27 12:09:40,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2960]: train_loss 1.028592, valid_loss 1.144601, train_metric nan, valid_metric 0.105897
[2648869:MainThread](2024-03-27 12:09:40,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2980]: train_loss 1.043937, valid_loss 1.144093, train_metric nan, valid_metric 0.106445
[2648869:MainThread](2024-03-27 12:09:40,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3000]: train_loss 1.032591, valid_loss 1.143805, train_metric nan, valid_metric 0.110389
[2648869:MainThread](2024-03-27 12:09:41,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3020]: train_loss 1.040213, valid_loss 1.143981, train_metric nan, valid_metric 0.108971
[2648869:MainThread](2024-03-27 12:09:41,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3040]: train_loss 1.041983, valid_loss 1.144651, train_metric nan, valid_metric 0.108821
[2648869:MainThread](2024-03-27 12:09:41,599) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3060]: train_loss 1.026208, valid_loss 1.145696, train_metric nan, valid_metric 0.106402
[2648869:MainThread](2024-03-27 12:09:41,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3080]: train_loss 1.032950, valid_loss 1.145254, train_metric nan, valid_metric 0.107812
[2648869:MainThread](2024-03-27 12:09:42,015) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3100]: train_loss 1.024142, valid_loss 1.143857, train_metric nan, valid_metric 0.107555
[2648869:MainThread](2024-03-27 12:09:42,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3120]: train_loss 1.036905, valid_loss 1.144132, train_metric nan, valid_metric 0.108344
[2648869:MainThread](2024-03-27 12:09:42,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3140]: train_loss 1.027130, valid_loss 1.145266, train_metric nan, valid_metric 0.106345
[2648869:MainThread](2024-03-27 12:09:42,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3160]: train_loss 1.047056, valid_loss 1.143499, train_metric nan, valid_metric 0.108047
[2648869:MainThread](2024-03-27 12:09:42,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3180]: train_loss 1.031710, valid_loss 1.143607, train_metric nan, valid_metric 0.105153
[2648869:MainThread](2024-03-27 12:09:43,035) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3200]: train_loss 1.045232, valid_loss 1.143796, train_metric nan, valid_metric 0.107660
[2648869:MainThread](2024-03-27 12:09:43,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3220]: train_loss 1.037500, valid_loss 1.144623, train_metric nan, valid_metric 0.105999
[2648869:MainThread](2024-03-27 12:09:43,237) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:09:43,891) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:09:44,580) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  73%|███████▎  | 32/44 [17:06<06:20, 31.68s/it][2648869:MainThread](2024-03-27 12:09:44,587) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:09:44,598) INFO - qlib.workflow - [recorder.py:341] - Recorder 309ddba2fcff4c59825050bdbe93c99d starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:09:45,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:09:45,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:09:45,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:09:45,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:09:46,964) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.662608
            SH600004      0.662608
            SH600006      0.662608
            SH600007      0.662608
            SH600008      0.662608
                            ...   
2017-09-29  SZ300133      0.622707
            SZ300144      0.622707
            SZ300168      0.622707
            SZ300251      0.622707
            SZ300315      0.622707
Length: 594300, dtype: float64
[2648869:MainThread](2024-03-27 12:09:47,901) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2017-10-09  SH600000      0.622707
            SH600008      0.622707
            SH600009      0.622707
            SH600010      0.622707
            SH600015      0.622707
                            ...   
2019-07-19  SZ300296      0.569785
            SZ300408      0.569785
            SZ300413      0.569785
            SZ300433      0.569785
            SZ300498      0.569785
Length: 117644, dtype: float64
[2648869:MainThread](2024-03-27 12:09:48,005) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:09:48,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.607288, valid_loss 1.152175, train_metric nan, valid_metric 0.019071
[2648869:MainThread](2024-03-27 12:09:48,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.152175, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:09:48,684) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.409803, valid_loss 1.132153, train_metric nan, valid_metric 0.039671
[2648869:MainThread](2024-03-27 12:09:48,684) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.152175 to 1.132153, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:48,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.231609, valid_loss 1.131983, train_metric nan, valid_metric 0.046654
[2648869:MainThread](2024-03-27 12:09:48,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.132153 to 1.131983, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:49,058) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.171617, valid_loss 1.131157, train_metric nan, valid_metric 0.049999
[2648869:MainThread](2024-03-27 12:09:49,058) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.131983 to 1.131157, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:49,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.211443, valid_loss 1.131758, train_metric nan, valid_metric 0.035816
[2648869:MainThread](2024-03-27 12:09:49,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.165156, valid_loss 1.125982, train_metric nan, valid_metric 0.062256
[2648869:MainThread](2024-03-27 12:09:49,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.131157 to 1.125982, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:49,628) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.211004, valid_loss 1.123752, train_metric nan, valid_metric 0.068589
[2648869:MainThread](2024-03-27 12:09:49,628) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.125982 to 1.123752, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:49,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.173818, valid_loss 1.124848, train_metric nan, valid_metric 0.064187
[2648869:MainThread](2024-03-27 12:09:50,013) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.326253, valid_loss 1.139776, train_metric nan, valid_metric 0.050127
[2648869:MainThread](2024-03-27 12:09:50,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.264474, valid_loss 1.131034, train_metric nan, valid_metric 0.076560
[2648869:MainThread](2024-03-27 12:09:50,415) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.174682, valid_loss 1.125482, train_metric nan, valid_metric 0.075890
[2648869:MainThread](2024-03-27 12:09:50,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.143448, valid_loss 1.125842, train_metric nan, valid_metric 0.060323
[2648869:MainThread](2024-03-27 12:09:50,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.125446, valid_loss 1.124187, train_metric nan, valid_metric 0.074358
[2648869:MainThread](2024-03-27 12:09:51,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.164227, valid_loss 1.122156, train_metric nan, valid_metric 0.078533
[2648869:MainThread](2024-03-27 12:09:51,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.123752 to 1.122156, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:51,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.137192, valid_loss 1.124072, train_metric nan, valid_metric 0.070266
[2648869:MainThread](2024-03-27 12:09:51,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.145028, valid_loss 1.122747, train_metric nan, valid_metric 0.063994
[2648869:MainThread](2024-03-27 12:09:51,631) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.136997, valid_loss 1.127205, train_metric nan, valid_metric 0.065681
[2648869:MainThread](2024-03-27 12:09:51,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.148311, valid_loss 1.124173, train_metric nan, valid_metric 0.067674
[2648869:MainThread](2024-03-27 12:09:52,037) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.164274, valid_loss 1.122071, train_metric nan, valid_metric 0.070502
[2648869:MainThread](2024-03-27 12:09:52,037) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.122156 to 1.122071, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:52,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.127323, valid_loss 1.121995, train_metric nan, valid_metric 0.067890
[2648869:MainThread](2024-03-27 12:09:52,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.122071 to 1.121995, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:52,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.108370, valid_loss 1.122791, train_metric nan, valid_metric 0.075955
[2648869:MainThread](2024-03-27 12:09:52,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.071682, valid_loss 1.121277, train_metric nan, valid_metric 0.069889
[2648869:MainThread](2024-03-27 12:09:52,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.121995 to 1.121277, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:52,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.103596, valid_loss 1.124043, train_metric nan, valid_metric 0.078367
[2648869:MainThread](2024-03-27 12:09:53,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.099042, valid_loss 1.125877, train_metric nan, valid_metric 0.075991
[2648869:MainThread](2024-03-27 12:09:53,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.092294, valid_loss 1.121147, train_metric nan, valid_metric 0.080565
[2648869:MainThread](2024-03-27 12:09:53,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.121277 to 1.121147, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:53,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.103832, valid_loss 1.121096, train_metric nan, valid_metric 0.077629
[2648869:MainThread](2024-03-27 12:09:53,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.121147 to 1.121096, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:53,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.075583, valid_loss 1.122750, train_metric nan, valid_metric 0.082920
[2648869:MainThread](2024-03-27 12:09:53,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.099084, valid_loss 1.120150, train_metric nan, valid_metric 0.081598
[2648869:MainThread](2024-03-27 12:09:53,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.121096 to 1.120150, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:54,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.091953, valid_loss 1.121782, train_metric nan, valid_metric 0.067533
[2648869:MainThread](2024-03-27 12:09:54,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.078029, valid_loss 1.122326, train_metric nan, valid_metric 0.074523
[2648869:MainThread](2024-03-27 12:09:54,453) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.087344, valid_loss 1.120583, train_metric nan, valid_metric 0.080013
[2648869:MainThread](2024-03-27 12:09:54,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.075798, valid_loss 1.120339, train_metric nan, valid_metric 0.078466
[2648869:MainThread](2024-03-27 12:09:54,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.096830, valid_loss 1.123587, train_metric nan, valid_metric 0.083967
[2648869:MainThread](2024-03-27 12:09:55,065) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.077392, valid_loss 1.121644, train_metric nan, valid_metric 0.078995
[2648869:MainThread](2024-03-27 12:09:55,275) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.090449, valid_loss 1.122374, train_metric nan, valid_metric 0.073842
[2648869:MainThread](2024-03-27 12:09:55,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.087463, valid_loss 1.121524, train_metric nan, valid_metric 0.072338
[2648869:MainThread](2024-03-27 12:09:55,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.093161, valid_loss 1.121533, train_metric nan, valid_metric 0.077312
[2648869:MainThread](2024-03-27 12:09:55,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.082643, valid_loss 1.120921, train_metric nan, valid_metric 0.080293
[2648869:MainThread](2024-03-27 12:09:56,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.083952, valid_loss 1.121483, train_metric nan, valid_metric 0.082523
[2648869:MainThread](2024-03-27 12:09:56,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.086815, valid_loss 1.120938, train_metric nan, valid_metric 0.080593
[2648869:MainThread](2024-03-27 12:09:56,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.080260, valid_loss 1.122192, train_metric nan, valid_metric 0.079774
[2648869:MainThread](2024-03-27 12:09:56,712) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.073872, valid_loss 1.120305, train_metric nan, valid_metric 0.080770
[2648869:MainThread](2024-03-27 12:09:56,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.050053, valid_loss 1.121180, train_metric nan, valid_metric 0.081041
[2648869:MainThread](2024-03-27 12:09:57,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.088845, valid_loss 1.120784, train_metric nan, valid_metric 0.084691
[2648869:MainThread](2024-03-27 12:09:57,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.071514, valid_loss 1.121371, train_metric nan, valid_metric 0.078789
[2648869:MainThread](2024-03-27 12:09:57,530) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.092850, valid_loss 1.123463, train_metric nan, valid_metric 0.076653
[2648869:MainThread](2024-03-27 12:09:57,733) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.069221, valid_loss 1.120672, train_metric nan, valid_metric 0.079895
[2648869:MainThread](2024-03-27 12:09:57,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.078446, valid_loss 1.119598, train_metric nan, valid_metric 0.089965
[2648869:MainThread](2024-03-27 12:09:57,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.120150 to 1.119598, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:58,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.066115, valid_loss 1.120175, train_metric nan, valid_metric 0.083707
[2648869:MainThread](2024-03-27 12:09:58,346) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.093201, valid_loss 1.122390, train_metric nan, valid_metric 0.082278
[2648869:MainThread](2024-03-27 12:09:58,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.068541, valid_loss 1.121280, train_metric nan, valid_metric 0.087311
[2648869:MainThread](2024-03-27 12:09:58,756) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.080447, valid_loss 1.119962, train_metric nan, valid_metric 0.083800
[2648869:MainThread](2024-03-27 12:09:58,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.090042, valid_loss 1.120084, train_metric nan, valid_metric 0.084213
[2648869:MainThread](2024-03-27 12:09:59,163) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.072215, valid_loss 1.119930, train_metric nan, valid_metric 0.083634
[2648869:MainThread](2024-03-27 12:09:59,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.084880, valid_loss 1.120008, train_metric nan, valid_metric 0.084504
[2648869:MainThread](2024-03-27 12:09:59,569) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.072946, valid_loss 1.119190, train_metric nan, valid_metric 0.086777
[2648869:MainThread](2024-03-27 12:09:59,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.119598 to 1.119190, save checkpoint.
[2648869:MainThread](2024-03-27 12:09:59,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.079377, valid_loss 1.120924, train_metric nan, valid_metric 0.085123
[2648869:MainThread](2024-03-27 12:09:59,980) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.079238, valid_loss 1.120806, train_metric nan, valid_metric 0.089047
[2648869:MainThread](2024-03-27 12:10:00,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.074062, valid_loss 1.121163, train_metric nan, valid_metric 0.085412
[2648869:MainThread](2024-03-27 12:10:00,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.077313, valid_loss 1.120124, train_metric nan, valid_metric 0.082064
[2648869:MainThread](2024-03-27 12:10:00,590) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.066502, valid_loss 1.120210, train_metric nan, valid_metric 0.086302
[2648869:MainThread](2024-03-27 12:10:00,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.070072, valid_loss 1.121093, train_metric nan, valid_metric 0.085533
[2648869:MainThread](2024-03-27 12:10:01,006) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.069595, valid_loss 1.120464, train_metric nan, valid_metric 0.084586
[2648869:MainThread](2024-03-27 12:10:01,213) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.078520, valid_loss 1.120408, train_metric nan, valid_metric 0.084702
[2648869:MainThread](2024-03-27 12:10:01,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.073011, valid_loss 1.120628, train_metric nan, valid_metric 0.081325
[2648869:MainThread](2024-03-27 12:10:01,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.061293, valid_loss 1.118929, train_metric nan, valid_metric 0.088829
[2648869:MainThread](2024-03-27 12:10:01,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.119190 to 1.118929, save checkpoint.
[2648869:MainThread](2024-03-27 12:10:01,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.077748, valid_loss 1.121067, train_metric nan, valid_metric 0.084554
[2648869:MainThread](2024-03-27 12:10:02,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.087543, valid_loss 1.119832, train_metric nan, valid_metric 0.085444
[2648869:MainThread](2024-03-27 12:10:02,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.064461, valid_loss 1.120375, train_metric nan, valid_metric 0.079642
[2648869:MainThread](2024-03-27 12:10:02,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.062310, valid_loss 1.119851, train_metric nan, valid_metric 0.083026
[2648869:MainThread](2024-03-27 12:10:02,631) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.086246, valid_loss 1.120025, train_metric nan, valid_metric 0.087065
[2648869:MainThread](2024-03-27 12:10:02,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.059332, valid_loss 1.120608, train_metric nan, valid_metric 0.086702
[2648869:MainThread](2024-03-27 12:10:03,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.078169, valid_loss 1.119165, train_metric nan, valid_metric 0.090719
[2648869:MainThread](2024-03-27 12:10:03,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.053099, valid_loss 1.121016, train_metric nan, valid_metric 0.087078
[2648869:MainThread](2024-03-27 12:10:03,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.076829, valid_loss 1.120633, train_metric nan, valid_metric 0.088055
[2648869:MainThread](2024-03-27 12:10:03,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.073121, valid_loss 1.119714, train_metric nan, valid_metric 0.085860
[2648869:MainThread](2024-03-27 12:10:03,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.065998, valid_loss 1.120392, train_metric nan, valid_metric 0.081538
[2648869:MainThread](2024-03-27 12:10:04,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.064586, valid_loss 1.120670, train_metric nan, valid_metric 0.084664
[2648869:MainThread](2024-03-27 12:10:04,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.060261, valid_loss 1.121337, train_metric nan, valid_metric 0.079012
[2648869:MainThread](2024-03-27 12:10:04,474) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.070941, valid_loss 1.121125, train_metric nan, valid_metric 0.083444
[2648869:MainThread](2024-03-27 12:10:04,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.063883, valid_loss 1.121026, train_metric nan, valid_metric 0.085691
[2648869:MainThread](2024-03-27 12:10:04,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.067513, valid_loss 1.120284, train_metric nan, valid_metric 0.085212
[2648869:MainThread](2024-03-27 12:10:05,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.056696, valid_loss 1.120134, train_metric nan, valid_metric 0.086737
[2648869:MainThread](2024-03-27 12:10:05,297) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.055324, valid_loss 1.119694, train_metric nan, valid_metric 0.089298
[2648869:MainThread](2024-03-27 12:10:05,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.068738, valid_loss 1.120915, train_metric nan, valid_metric 0.086939
[2648869:MainThread](2024-03-27 12:10:05,701) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.066031, valid_loss 1.120303, train_metric nan, valid_metric 0.082891
[2648869:MainThread](2024-03-27 12:10:05,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.056293, valid_loss 1.120360, train_metric nan, valid_metric 0.084445
[2648869:MainThread](2024-03-27 12:10:06,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.053877, valid_loss 1.120631, train_metric nan, valid_metric 0.085230
[2648869:MainThread](2024-03-27 12:10:06,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.060063, valid_loss 1.120517, train_metric nan, valid_metric 0.088518
[2648869:MainThread](2024-03-27 12:10:06,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.064524, valid_loss 1.120772, train_metric nan, valid_metric 0.085473
[2648869:MainThread](2024-03-27 12:10:06,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.061644, valid_loss 1.119798, train_metric nan, valid_metric 0.090179
[2648869:MainThread](2024-03-27 12:10:06,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.061185, valid_loss 1.120276, train_metric nan, valid_metric 0.088495
[2648869:MainThread](2024-03-27 12:10:07,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.054097, valid_loss 1.120538, train_metric nan, valid_metric 0.082844
[2648869:MainThread](2024-03-27 12:10:07,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.057783, valid_loss 1.119072, train_metric nan, valid_metric 0.088484
[2648869:MainThread](2024-03-27 12:10:07,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.071643, valid_loss 1.119750, train_metric nan, valid_metric 0.084141
[2648869:MainThread](2024-03-27 12:10:07,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.074508, valid_loss 1.120909, train_metric nan, valid_metric 0.087701
[2648869:MainThread](2024-03-27 12:10:07,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.077926, valid_loss 1.120777, train_metric nan, valid_metric 0.085106
[2648869:MainThread](2024-03-27 12:10:08,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.072890, valid_loss 1.120814, train_metric nan, valid_metric 0.086483
[2648869:MainThread](2024-03-27 12:10:08,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.064622, valid_loss 1.120228, train_metric nan, valid_metric 0.087951
[2648869:MainThread](2024-03-27 12:10:08,571) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.050407, valid_loss 1.120687, train_metric nan, valid_metric 0.083411
[2648869:MainThread](2024-03-27 12:10:08,784) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.061970, valid_loss 1.120623, train_metric nan, valid_metric 0.084317
[2648869:MainThread](2024-03-27 12:10:08,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.071557, valid_loss 1.119981, train_metric nan, valid_metric 0.086548
[2648869:MainThread](2024-03-27 12:10:09,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.049943, valid_loss 1.120157, train_metric nan, valid_metric 0.086066
[2648869:MainThread](2024-03-27 12:10:09,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.082287, valid_loss 1.119761, train_metric nan, valid_metric 0.086587
[2648869:MainThread](2024-03-27 12:10:09,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.078316, valid_loss 1.120272, train_metric nan, valid_metric 0.084021
[2648869:MainThread](2024-03-27 12:10:09,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.064041, valid_loss 1.119689, train_metric nan, valid_metric 0.086637
[2648869:MainThread](2024-03-27 12:10:10,033) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.057937, valid_loss 1.120538, train_metric nan, valid_metric 0.081662
[2648869:MainThread](2024-03-27 12:10:10,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.067133, valid_loss 1.119648, train_metric nan, valid_metric 0.087742
[2648869:MainThread](2024-03-27 12:10:10,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.063843, valid_loss 1.120097, train_metric nan, valid_metric 0.085800
[2648869:MainThread](2024-03-27 12:10:10,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.069405, valid_loss 1.119526, train_metric nan, valid_metric 0.087744
[2648869:MainThread](2024-03-27 12:10:10,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.062834, valid_loss 1.119880, train_metric nan, valid_metric 0.086246
[2648869:MainThread](2024-03-27 12:10:11,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.068520, valid_loss 1.119534, train_metric nan, valid_metric 0.087815
[2648869:MainThread](2024-03-27 12:10:11,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.060208, valid_loss 1.119316, train_metric nan, valid_metric 0.091692
[2648869:MainThread](2024-03-27 12:10:11,552) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.062429, valid_loss 1.119593, train_metric nan, valid_metric 0.087902
[2648869:MainThread](2024-03-27 12:10:11,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.055970, valid_loss 1.119423, train_metric nan, valid_metric 0.088455
[2648869:MainThread](2024-03-27 12:10:12,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.067108, valid_loss 1.119939, train_metric nan, valid_metric 0.088002
[2648869:MainThread](2024-03-27 12:10:12,008) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:10:12,681) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:10:13,376) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  75%|███████▌  | 33/44 [17:35<05:38, 30.82s/it][2648869:MainThread](2024-03-27 12:10:13,383) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:10:13,394) INFO - qlib.workflow - [recorder.py:341] - Recorder 004996ef50a849c6a5b560c61dfb3903 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:10:14,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:10:14,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:10:14,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:10:14,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:10:15,775) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.168606
            SH600004      1.168606
            SH600006      1.168606
            SH600007      1.168606
            SH600008      1.168606
                            ...   
2017-11-03  SZ300133      0.830975
            SZ300144      0.830975
            SZ300168      0.830975
            SZ300251      0.830975
            SZ300315      0.830975
Length: 599623, dtype: float64
[2648869:MainThread](2024-03-27 12:10:16,690) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2017-11-06  SH600000      0.830975
            SH600008      0.830975
            SH600009      0.830975
            SH600010      0.830975
            SH600015      0.830975
                            ...   
2019-08-16  SZ300296      0.707081
            SZ300408      0.707081
            SZ300413      0.707081
            SZ300433      0.707081
            SZ300498      0.707081
Length: 117619, dtype: float64
[2648869:MainThread](2024-03-27 12:10:16,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:10:17,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.465612, valid_loss 1.195551, train_metric nan, valid_metric 0.038423
[2648869:MainThread](2024-03-27 12:10:17,257) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.195551, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:10:17,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.188076, valid_loss 1.167964, train_metric nan, valid_metric 0.028921
[2648869:MainThread](2024-03-27 12:10:17,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.195551 to 1.167964, save checkpoint.
[2648869:MainThread](2024-03-27 12:10:17,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.110101, valid_loss 1.148784, train_metric nan, valid_metric 0.055724
[2648869:MainThread](2024-03-27 12:10:17,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.167964 to 1.148784, save checkpoint.
[2648869:MainThread](2024-03-27 12:10:17,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.090334, valid_loss 1.159101, train_metric nan, valid_metric 0.067347
[2648869:MainThread](2024-03-27 12:10:18,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.070069, valid_loss 1.149052, train_metric nan, valid_metric 0.068990
[2648869:MainThread](2024-03-27 12:10:18,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.067138, valid_loss 1.149316, train_metric nan, valid_metric 0.081400
[2648869:MainThread](2024-03-27 12:10:18,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.060347, valid_loss 1.144897, train_metric nan, valid_metric 0.076316
[2648869:MainThread](2024-03-27 12:10:18,452) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.148784 to 1.144897, save checkpoint.
[2648869:MainThread](2024-03-27 12:10:18,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.062317, valid_loss 1.148090, train_metric nan, valid_metric 0.056445
[2648869:MainThread](2024-03-27 12:10:18,856) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.087321, valid_loss 1.143779, train_metric nan, valid_metric 0.083005
[2648869:MainThread](2024-03-27 12:10:18,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.144897 to 1.143779, save checkpoint.
[2648869:MainThread](2024-03-27 12:10:19,059) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.046831, valid_loss 1.145380, train_metric nan, valid_metric 0.065972
[2648869:MainThread](2024-03-27 12:10:19,270) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.078426, valid_loss 1.146634, train_metric nan, valid_metric 0.072454
[2648869:MainThread](2024-03-27 12:10:19,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.047975, valid_loss 1.140724, train_metric nan, valid_metric 0.087233
[2648869:MainThread](2024-03-27 12:10:19,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.143779 to 1.140724, save checkpoint.
[2648869:MainThread](2024-03-27 12:10:19,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.058343, valid_loss 1.140790, train_metric nan, valid_metric 0.088203
[2648869:MainThread](2024-03-27 12:10:19,878) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.057407, valid_loss 1.143603, train_metric nan, valid_metric 0.080594
[2648869:MainThread](2024-03-27 12:10:20,082) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.051918, valid_loss 1.144399, train_metric nan, valid_metric 0.081971
[2648869:MainThread](2024-03-27 12:10:20,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.031841, valid_loss 1.140643, train_metric nan, valid_metric 0.085384
[2648869:MainThread](2024-03-27 12:10:20,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.140724 to 1.140643, save checkpoint.
[2648869:MainThread](2024-03-27 12:10:20,492) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.037851, valid_loss 1.145198, train_metric nan, valid_metric 0.082268
[2648869:MainThread](2024-03-27 12:10:20,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.041000, valid_loss 1.145867, train_metric nan, valid_metric 0.078165
[2648869:MainThread](2024-03-27 12:10:20,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.058339, valid_loss 1.147895, train_metric nan, valid_metric 0.068042
[2648869:MainThread](2024-03-27 12:10:21,104) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.041939, valid_loss 1.142020, train_metric nan, valid_metric 0.089862
[2648869:MainThread](2024-03-27 12:10:21,306) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.038329, valid_loss 1.146638, train_metric nan, valid_metric 0.072040
[2648869:MainThread](2024-03-27 12:10:21,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.046328, valid_loss 1.141856, train_metric nan, valid_metric 0.082861
[2648869:MainThread](2024-03-27 12:10:21,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.065675, valid_loss 1.142060, train_metric nan, valid_metric 0.084579
[2648869:MainThread](2024-03-27 12:10:21,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.042247, valid_loss 1.143627, train_metric nan, valid_metric 0.077316
[2648869:MainThread](2024-03-27 12:10:22,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.023216, valid_loss 1.142965, train_metric nan, valid_metric 0.083498
[2648869:MainThread](2024-03-27 12:10:22,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.016765, valid_loss 1.142200, train_metric nan, valid_metric 0.086557
[2648869:MainThread](2024-03-27 12:10:22,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.019414, valid_loss 1.140366, train_metric nan, valid_metric 0.093000
[2648869:MainThread](2024-03-27 12:10:22,533) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.140643 to 1.140366, save checkpoint.
[2648869:MainThread](2024-03-27 12:10:22,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.026976, valid_loss 1.142128, train_metric nan, valid_metric 0.090840
[2648869:MainThread](2024-03-27 12:10:22,937) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.012793, valid_loss 1.142956, train_metric nan, valid_metric 0.078294
[2648869:MainThread](2024-03-27 12:10:23,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.021519, valid_loss 1.141977, train_metric nan, valid_metric 0.094283
[2648869:MainThread](2024-03-27 12:10:23,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.020580, valid_loss 1.143625, train_metric nan, valid_metric 0.088059
[2648869:MainThread](2024-03-27 12:10:23,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.034906, valid_loss 1.141923, train_metric nan, valid_metric 0.089126
[2648869:MainThread](2024-03-27 12:10:23,743) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.021672, valid_loss 1.141627, train_metric nan, valid_metric 0.087976
[2648869:MainThread](2024-03-27 12:10:23,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.023377, valid_loss 1.142759, train_metric nan, valid_metric 0.084185
[2648869:MainThread](2024-03-27 12:10:24,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.023900, valid_loss 1.141289, train_metric nan, valid_metric 0.090166
[2648869:MainThread](2024-03-27 12:10:24,352) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.027105, valid_loss 1.141385, train_metric nan, valid_metric 0.087337
[2648869:MainThread](2024-03-27 12:10:24,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.019656, valid_loss 1.142908, train_metric nan, valid_metric 0.088167
[2648869:MainThread](2024-03-27 12:10:24,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.019323, valid_loss 1.141717, train_metric nan, valid_metric 0.090865
[2648869:MainThread](2024-03-27 12:10:24,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.017700, valid_loss 1.141618, train_metric nan, valid_metric 0.087299
[2648869:MainThread](2024-03-27 12:10:25,164) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.025653, valid_loss 1.141143, train_metric nan, valid_metric 0.088455
[2648869:MainThread](2024-03-27 12:10:25,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.015924, valid_loss 1.140150, train_metric nan, valid_metric 0.088611
[2648869:MainThread](2024-03-27 12:10:25,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.140366 to 1.140150, save checkpoint.
[2648869:MainThread](2024-03-27 12:10:25,571) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.029332, valid_loss 1.142410, train_metric nan, valid_metric 0.086669
[2648869:MainThread](2024-03-27 12:10:25,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.038691, valid_loss 1.142542, train_metric nan, valid_metric 0.085975
[2648869:MainThread](2024-03-27 12:10:25,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.019620, valid_loss 1.141648, train_metric nan, valid_metric 0.082884
[2648869:MainThread](2024-03-27 12:10:26,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.021874, valid_loss 1.140324, train_metric nan, valid_metric 0.088241
[2648869:MainThread](2024-03-27 12:10:26,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.007656, valid_loss 1.140416, train_metric nan, valid_metric 0.091762
[2648869:MainThread](2024-03-27 12:10:26,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.017862, valid_loss 1.141248, train_metric nan, valid_metric 0.088720
[2648869:MainThread](2024-03-27 12:10:26,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.017772, valid_loss 1.141393, train_metric nan, valid_metric 0.084988
[2648869:MainThread](2024-03-27 12:10:27,126) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.012808, valid_loss 1.139421, train_metric nan, valid_metric 0.089338
[2648869:MainThread](2024-03-27 12:10:27,126) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.140150 to 1.139421, save checkpoint.
[2648869:MainThread](2024-03-27 12:10:27,369) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.008463, valid_loss 1.141877, train_metric nan, valid_metric 0.087389
[2648869:MainThread](2024-03-27 12:10:27,615) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.003684, valid_loss 1.141681, train_metric nan, valid_metric 0.086845
[2648869:MainThread](2024-03-27 12:10:27,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.025389, valid_loss 1.139326, train_metric nan, valid_metric 0.090833
[2648869:MainThread](2024-03-27 12:10:27,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.139421 to 1.139326, save checkpoint.
[2648869:MainThread](2024-03-27 12:10:28,119) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.035372, valid_loss 1.142627, train_metric nan, valid_metric 0.084609
[2648869:MainThread](2024-03-27 12:10:28,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.017291, valid_loss 1.142528, train_metric nan, valid_metric 0.085362
[2648869:MainThread](2024-03-27 12:10:28,568) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.015992, valid_loss 1.141588, train_metric nan, valid_metric 0.087448
[2648869:MainThread](2024-03-27 12:10:28,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.010305, valid_loss 1.140042, train_metric nan, valid_metric 0.088329
[2648869:MainThread](2024-03-27 12:10:28,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.021239, valid_loss 1.141740, train_metric nan, valid_metric 0.085257
[2648869:MainThread](2024-03-27 12:10:29,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.026642, valid_loss 1.142463, train_metric nan, valid_metric 0.084028
[2648869:MainThread](2024-03-27 12:10:29,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.025932, valid_loss 1.140049, train_metric nan, valid_metric 0.088643
[2648869:MainThread](2024-03-27 12:10:29,626) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.018193, valid_loss 1.141392, train_metric nan, valid_metric 0.085777
[2648869:MainThread](2024-03-27 12:10:29,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.006808, valid_loss 1.142983, train_metric nan, valid_metric 0.088978
[2648869:MainThread](2024-03-27 12:10:30,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.006565, valid_loss 1.140613, train_metric nan, valid_metric 0.086779
[2648869:MainThread](2024-03-27 12:10:30,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.015424, valid_loss 1.139697, train_metric nan, valid_metric 0.087365
[2648869:MainThread](2024-03-27 12:10:30,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.012947, valid_loss 1.140517, train_metric nan, valid_metric 0.087481
[2648869:MainThread](2024-03-27 12:10:30,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.025136, valid_loss 1.140126, train_metric nan, valid_metric 0.088324
[2648869:MainThread](2024-03-27 12:10:30,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.028444, valid_loss 1.141454, train_metric nan, valid_metric 0.087443
[2648869:MainThread](2024-03-27 12:10:31,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.007889, valid_loss 1.141441, train_metric nan, valid_metric 0.086680
[2648869:MainThread](2024-03-27 12:10:31,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.015615, valid_loss 1.141459, train_metric nan, valid_metric 0.086650
[2648869:MainThread](2024-03-27 12:10:31,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.021083, valid_loss 1.139986, train_metric nan, valid_metric 0.089505
[2648869:MainThread](2024-03-27 12:10:31,778) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.015761, valid_loss 1.142444, train_metric nan, valid_metric 0.087654
[2648869:MainThread](2024-03-27 12:10:32,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.020048, valid_loss 1.140311, train_metric nan, valid_metric 0.088670
[2648869:MainThread](2024-03-27 12:10:32,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.008435, valid_loss 1.140912, train_metric nan, valid_metric 0.088001
[2648869:MainThread](2024-03-27 12:10:32,474) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.013769, valid_loss 1.140782, train_metric nan, valid_metric 0.088652
[2648869:MainThread](2024-03-27 12:10:32,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.016570, valid_loss 1.140381, train_metric nan, valid_metric 0.088573
[2648869:MainThread](2024-03-27 12:10:32,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.002984, valid_loss 1.140452, train_metric nan, valid_metric 0.087270
[2648869:MainThread](2024-03-27 12:10:33,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.011767, valid_loss 1.141043, train_metric nan, valid_metric 0.086780
[2648869:MainThread](2024-03-27 12:10:33,366) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.012147, valid_loss 1.140661, train_metric nan, valid_metric 0.086670
[2648869:MainThread](2024-03-27 12:10:33,571) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.010630, valid_loss 1.141757, train_metric nan, valid_metric 0.089026
[2648869:MainThread](2024-03-27 12:10:33,774) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.010250, valid_loss 1.141266, train_metric nan, valid_metric 0.089496
[2648869:MainThread](2024-03-27 12:10:33,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.017785, valid_loss 1.141207, train_metric nan, valid_metric 0.090504
[2648869:MainThread](2024-03-27 12:10:34,175) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.998026, valid_loss 1.140281, train_metric nan, valid_metric 0.088743
[2648869:MainThread](2024-03-27 12:10:34,415) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.016832, valid_loss 1.141233, train_metric nan, valid_metric 0.087357
[2648869:MainThread](2024-03-27 12:10:34,667) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.008902, valid_loss 1.140503, train_metric nan, valid_metric 0.089538
[2648869:MainThread](2024-03-27 12:10:34,880) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.014240, valid_loss 1.140427, train_metric nan, valid_metric 0.090509
[2648869:MainThread](2024-03-27 12:10:35,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.015294, valid_loss 1.140001, train_metric nan, valid_metric 0.088575
[2648869:MainThread](2024-03-27 12:10:35,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.020030, valid_loss 1.139612, train_metric nan, valid_metric 0.090119
[2648869:MainThread](2024-03-27 12:10:35,586) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.011414, valid_loss 1.140197, train_metric nan, valid_metric 0.089446
[2648869:MainThread](2024-03-27 12:10:35,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.003012, valid_loss 1.140097, train_metric nan, valid_metric 0.087416
[2648869:MainThread](2024-03-27 12:10:36,014) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.024331, valid_loss 1.141202, train_metric nan, valid_metric 0.088709
[2648869:MainThread](2024-03-27 12:10:36,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.014482, valid_loss 1.139284, train_metric nan, valid_metric 0.090058
[2648869:MainThread](2024-03-27 12:10:36,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.139326 to 1.139284, save checkpoint.
[2648869:MainThread](2024-03-27 12:10:36,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.014338, valid_loss 1.141563, train_metric nan, valid_metric 0.086839
[2648869:MainThread](2024-03-27 12:10:36,629) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.015933, valid_loss 1.139854, train_metric nan, valid_metric 0.088478
[2648869:MainThread](2024-03-27 12:10:36,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.011455, valid_loss 1.141327, train_metric nan, valid_metric 0.085854
[2648869:MainThread](2024-03-27 12:10:37,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.002384, valid_loss 1.141117, train_metric nan, valid_metric 0.088249
[2648869:MainThread](2024-03-27 12:10:37,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.016517, valid_loss 1.140433, train_metric nan, valid_metric 0.089454
[2648869:MainThread](2024-03-27 12:10:37,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.009307, valid_loss 1.140389, train_metric nan, valid_metric 0.090003
[2648869:MainThread](2024-03-27 12:10:37,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.011525, valid_loss 1.141954, train_metric nan, valid_metric 0.086555
[2648869:MainThread](2024-03-27 12:10:37,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.013395, valid_loss 1.141037, train_metric nan, valid_metric 0.088361
[2648869:MainThread](2024-03-27 12:10:38,053) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.009246, valid_loss 1.139524, train_metric nan, valid_metric 0.087687
[2648869:MainThread](2024-03-27 12:10:38,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.000491, valid_loss 1.139465, train_metric nan, valid_metric 0.089831
[2648869:MainThread](2024-03-27 12:10:38,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.006147, valid_loss 1.140097, train_metric nan, valid_metric 0.088122
[2648869:MainThread](2024-03-27 12:10:38,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.008131, valid_loss 1.139877, train_metric nan, valid_metric 0.087831
[2648869:MainThread](2024-03-27 12:10:38,967) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.027367, valid_loss 1.140399, train_metric nan, valid_metric 0.088153
[2648869:MainThread](2024-03-27 12:10:39,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.006095, valid_loss 1.140294, train_metric nan, valid_metric 0.086173
[2648869:MainThread](2024-03-27 12:10:39,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.017512, valid_loss 1.140084, train_metric nan, valid_metric 0.087968
[2648869:MainThread](2024-03-27 12:10:39,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.008251, valid_loss 1.140424, train_metric nan, valid_metric 0.088170
[2648869:MainThread](2024-03-27 12:10:39,960) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.000555, valid_loss 1.140526, train_metric nan, valid_metric 0.088072
[2648869:MainThread](2024-03-27 12:10:40,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.012999, valid_loss 1.139583, train_metric nan, valid_metric 0.088686
[2648869:MainThread](2024-03-27 12:10:40,453) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.011492, valid_loss 1.141181, train_metric nan, valid_metric 0.087367
[2648869:MainThread](2024-03-27 12:10:40,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.000089, valid_loss 1.141809, train_metric nan, valid_metric 0.089028
[2648869:MainThread](2024-03-27 12:10:40,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.015461, valid_loss 1.140558, train_metric nan, valid_metric 0.090240
[2648869:MainThread](2024-03-27 12:10:41,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.000552, valid_loss 1.141588, train_metric nan, valid_metric 0.090051
[2648869:MainThread](2024-03-27 12:10:41,438) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.008960, valid_loss 1.141035, train_metric nan, valid_metric 0.088598
[2648869:MainThread](2024-03-27 12:10:41,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 0.994759, valid_loss 1.139189, train_metric nan, valid_metric 0.087458
[2648869:MainThread](2024-03-27 12:10:41,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.139284 to 1.139189, save checkpoint.
[2648869:MainThread](2024-03-27 12:10:41,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.004774, valid_loss 1.138741, train_metric nan, valid_metric 0.088615
[2648869:MainThread](2024-03-27 12:10:41,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.139189 to 1.138741, save checkpoint.
[2648869:MainThread](2024-03-27 12:10:42,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.016857, valid_loss 1.140279, train_metric nan, valid_metric 0.086552
[2648869:MainThread](2024-03-27 12:10:42,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 1.023086, valid_loss 1.140046, train_metric nan, valid_metric 0.088320
[2648869:MainThread](2024-03-27 12:10:42,638) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 1.009546, valid_loss 1.139339, train_metric nan, valid_metric 0.088117
[2648869:MainThread](2024-03-27 12:10:42,839) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 1.015137, valid_loss 1.140522, train_metric nan, valid_metric 0.088478
[2648869:MainThread](2024-03-27 12:10:43,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 1.015197, valid_loss 1.140175, train_metric nan, valid_metric 0.087730
[2648869:MainThread](2024-03-27 12:10:43,243) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 1.012804, valid_loss 1.139920, train_metric nan, valid_metric 0.088037
[2648869:MainThread](2024-03-27 12:10:43,444) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 1.022186, valid_loss 1.141706, train_metric nan, valid_metric 0.087334
[2648869:MainThread](2024-03-27 12:10:43,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 1.014140, valid_loss 1.140360, train_metric nan, valid_metric 0.086502
[2648869:MainThread](2024-03-27 12:10:43,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 1.006266, valid_loss 1.139424, train_metric nan, valid_metric 0.088695
[2648869:MainThread](2024-03-27 12:10:44,187) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 1.010761, valid_loss 1.139891, train_metric nan, valid_metric 0.089284
[2648869:MainThread](2024-03-27 12:10:44,433) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 1.002004, valid_loss 1.140670, train_metric nan, valid_metric 0.089120
[2648869:MainThread](2024-03-27 12:10:44,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 1.014182, valid_loss 1.141972, train_metric nan, valid_metric 0.088812
[2648869:MainThread](2024-03-27 12:10:44,926) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 1.010290, valid_loss 1.140886, train_metric nan, valid_metric 0.088048
[2648869:MainThread](2024-03-27 12:10:45,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 1.002569, valid_loss 1.141871, train_metric nan, valid_metric 0.087675
[2648869:MainThread](2024-03-27 12:10:45,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 1.007051, valid_loss 1.141547, train_metric nan, valid_metric 0.085780
[2648869:MainThread](2024-03-27 12:10:45,629) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 1.016889, valid_loss 1.141341, train_metric nan, valid_metric 0.084964
[2648869:MainThread](2024-03-27 12:10:45,876) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 1.001247, valid_loss 1.139742, train_metric nan, valid_metric 0.087159
[2648869:MainThread](2024-03-27 12:10:46,125) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 1.009861, valid_loss 1.141460, train_metric nan, valid_metric 0.088440
[2648869:MainThread](2024-03-27 12:10:46,371) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 1.009953, valid_loss 1.139847, train_metric nan, valid_metric 0.087940
[2648869:MainThread](2024-03-27 12:10:46,580) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 0.999035, valid_loss 1.140403, train_metric nan, valid_metric 0.088986
[2648869:MainThread](2024-03-27 12:10:46,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 1.013142, valid_loss 1.141350, train_metric nan, valid_metric 0.085986
[2648869:MainThread](2024-03-27 12:10:46,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 1.011804, valid_loss 1.140916, train_metric nan, valid_metric 0.088127
[2648869:MainThread](2024-03-27 12:10:47,191) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2760]: train_loss 1.004278, valid_loss 1.139376, train_metric nan, valid_metric 0.086959
[2648869:MainThread](2024-03-27 12:10:47,395) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2780]: train_loss 1.009041, valid_loss 1.140548, train_metric nan, valid_metric 0.085663
[2648869:MainThread](2024-03-27 12:10:47,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2800]: train_loss 1.005689, valid_loss 1.140573, train_metric nan, valid_metric 0.088356
[2648869:MainThread](2024-03-27 12:10:47,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2820]: train_loss 1.006438, valid_loss 1.140159, train_metric nan, valid_metric 0.089031
[2648869:MainThread](2024-03-27 12:10:48,006) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2840]: train_loss 1.009760, valid_loss 1.140388, train_metric nan, valid_metric 0.088311
[2648869:MainThread](2024-03-27 12:10:48,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2860]: train_loss 1.001519, valid_loss 1.142315, train_metric nan, valid_metric 0.085124
[2648869:MainThread](2024-03-27 12:10:48,416) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2880]: train_loss 1.016015, valid_loss 1.140348, train_metric nan, valid_metric 0.086303
[2648869:MainThread](2024-03-27 12:10:48,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2900]: train_loss 1.017811, valid_loss 1.141866, train_metric nan, valid_metric 0.088623
[2648869:MainThread](2024-03-27 12:10:48,818) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2920]: train_loss 1.012228, valid_loss 1.140247, train_metric nan, valid_metric 0.089240
[2648869:MainThread](2024-03-27 12:10:49,018) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2940]: train_loss 1.021772, valid_loss 1.139516, train_metric nan, valid_metric 0.087087
[2648869:MainThread](2024-03-27 12:10:49,220) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2960]: train_loss 1.012718, valid_loss 1.141672, train_metric nan, valid_metric 0.084354
[2648869:MainThread](2024-03-27 12:10:49,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2980]: train_loss 1.008420, valid_loss 1.141718, train_metric nan, valid_metric 0.087027
[2648869:MainThread](2024-03-27 12:10:49,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3000]: train_loss 1.012321, valid_loss 1.140099, train_metric nan, valid_metric 0.089473
[2648869:MainThread](2024-03-27 12:10:49,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3020]: train_loss 1.011231, valid_loss 1.139827, train_metric nan, valid_metric 0.088248
[2648869:MainThread](2024-03-27 12:10:50,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3040]: train_loss 1.009343, valid_loss 1.140987, train_metric nan, valid_metric 0.087775
[2648869:MainThread](2024-03-27 12:10:50,223) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3060]: train_loss 1.007553, valid_loss 1.140110, train_metric nan, valid_metric 0.089350
[2648869:MainThread](2024-03-27 12:10:50,425) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3080]: train_loss 1.025300, valid_loss 1.140822, train_metric nan, valid_metric 0.088224
[2648869:MainThread](2024-03-27 12:10:50,626) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3100]: train_loss 1.019562, valid_loss 1.141519, train_metric nan, valid_metric 0.088910
[2648869:MainThread](2024-03-27 12:10:50,830) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3120]: train_loss 1.005817, valid_loss 1.141708, train_metric nan, valid_metric 0.087462
[2648869:MainThread](2024-03-27 12:10:51,031) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3140]: train_loss 1.021821, valid_loss 1.141299, train_metric nan, valid_metric 0.088105
[2648869:MainThread](2024-03-27 12:10:51,234) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3160]: train_loss 1.006449, valid_loss 1.141709, train_metric nan, valid_metric 0.087970
[2648869:MainThread](2024-03-27 12:10:51,437) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3180]: train_loss 1.016876, valid_loss 1.139894, train_metric nan, valid_metric 0.090041
[2648869:MainThread](2024-03-27 12:10:51,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3200]: train_loss 0.997243, valid_loss 1.139768, train_metric nan, valid_metric 0.088986
[2648869:MainThread](2024-03-27 12:10:51,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3220]: train_loss 1.020214, valid_loss 1.141961, train_metric nan, valid_metric 0.087602
[2648869:MainThread](2024-03-27 12:10:52,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3240]: train_loss 1.012183, valid_loss 1.140452, train_metric nan, valid_metric 0.087932
[2648869:MainThread](2024-03-27 12:10:52,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3260]: train_loss 1.004018, valid_loss 1.140860, train_metric nan, valid_metric 0.088336
[2648869:MainThread](2024-03-27 12:10:52,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3280]: train_loss 1.003961, valid_loss 1.139401, train_metric nan, valid_metric 0.088761
[2648869:MainThread](2024-03-27 12:10:52,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3300]: train_loss 1.003387, valid_loss 1.139104, train_metric nan, valid_metric 0.088868
[2648869:MainThread](2024-03-27 12:10:52,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:10:53,316) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:10:54,004) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  77%|███████▋  | 34/44 [18:16<05:37, 33.76s/it][2648869:MainThread](2024-03-27 12:10:54,011) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:10:54,023) INFO - qlib.workflow - [recorder.py:341] - Recorder c9908df0c5e04490bd9d952b4456d430 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:10:54,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:10:54,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:10:54,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:10:54,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:10:56,416) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.713428
            SH600004      1.713428
            SH600006      1.713428
            SH600007      1.713428
            SH600008      1.713428
                            ...   
2017-12-01  SZ300133      1.689554
            SZ300144      1.689554
            SZ300168      1.689554
            SZ300251      1.689554
            SZ300315      1.689554
Length: 604926, dtype: float64
[2648869:MainThread](2024-03-27 12:10:57,368) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2017-12-04  SH600000      1.689554
            SH600009      1.689554
            SH600010      1.689554
            SH600015      1.689554
            SH600016      1.689554
                            ...   
2019-09-16  SZ300296      0.769210
            SZ300408      0.769210
            SZ300413      0.769210
            SZ300433      0.769210
            SZ300498      0.769210
Length: 118233, dtype: float64
[2648869:MainThread](2024-03-27 12:10:57,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:10:57,962) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.311456, valid_loss 1.199991, train_metric nan, valid_metric 0.028281
[2648869:MainThread](2024-03-27 12:10:57,962) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.199991, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:10:58,153) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.217536, valid_loss 1.242219, train_metric nan, valid_metric -0.002630
[2648869:MainThread](2024-03-27 12:10:58,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.240517, valid_loss 1.172895, train_metric nan, valid_metric 0.050071
[2648869:MainThread](2024-03-27 12:10:58,344) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.199991 to 1.172895, save checkpoint.
[2648869:MainThread](2024-03-27 12:10:58,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.102321, valid_loss 1.167919, train_metric nan, valid_metric 0.058940
[2648869:MainThread](2024-03-27 12:10:58,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.172895 to 1.167919, save checkpoint.
[2648869:MainThread](2024-03-27 12:10:58,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.185291, valid_loss 1.173171, train_metric nan, valid_metric 0.045466
[2648869:MainThread](2024-03-27 12:10:58,953) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.103741, valid_loss 1.166913, train_metric nan, valid_metric 0.061605
[2648869:MainThread](2024-03-27 12:10:58,953) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.167919 to 1.166913, save checkpoint.
[2648869:MainThread](2024-03-27 12:10:59,156) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.187668, valid_loss 1.168294, train_metric nan, valid_metric 0.056367
[2648869:MainThread](2024-03-27 12:10:59,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.119288, valid_loss 1.168384, train_metric nan, valid_metric 0.057401
[2648869:MainThread](2024-03-27 12:10:59,564) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.074163, valid_loss 1.169446, train_metric nan, valid_metric 0.048127
[2648869:MainThread](2024-03-27 12:10:59,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.066148, valid_loss 1.167123, train_metric nan, valid_metric 0.052119
[2648869:MainThread](2024-03-27 12:10:59,972) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.083075, valid_loss 1.164015, train_metric nan, valid_metric 0.072300
[2648869:MainThread](2024-03-27 12:10:59,972) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.166913 to 1.164015, save checkpoint.
[2648869:MainThread](2024-03-27 12:11:00,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.075325, valid_loss 1.165074, train_metric nan, valid_metric 0.057253
[2648869:MainThread](2024-03-27 12:11:00,386) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.067505, valid_loss 1.164518, train_metric nan, valid_metric 0.061666
[2648869:MainThread](2024-03-27 12:11:00,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.048164, valid_loss 1.162606, train_metric nan, valid_metric 0.074712
[2648869:MainThread](2024-03-27 12:11:00,590) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.164015 to 1.162606, save checkpoint.
[2648869:MainThread](2024-03-27 12:11:00,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.066565, valid_loss 1.163251, train_metric nan, valid_metric 0.066164
[2648869:MainThread](2024-03-27 12:11:01,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.069104, valid_loss 1.163013, train_metric nan, valid_metric 0.066844
[2648869:MainThread](2024-03-27 12:11:01,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.051606, valid_loss 1.162175, train_metric nan, valid_metric 0.077627
[2648869:MainThread](2024-03-27 12:11:01,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.162606 to 1.162175, save checkpoint.
[2648869:MainThread](2024-03-27 12:11:01,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.041207, valid_loss 1.161856, train_metric nan, valid_metric 0.075257
[2648869:MainThread](2024-03-27 12:11:01,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.162175 to 1.161856, save checkpoint.
[2648869:MainThread](2024-03-27 12:11:01,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.071423, valid_loss 1.164460, train_metric nan, valid_metric 0.066207
[2648869:MainThread](2024-03-27 12:11:01,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.085332, valid_loss 1.164237, train_metric nan, valid_metric 0.075221
[2648869:MainThread](2024-03-27 12:11:02,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.067475, valid_loss 1.162754, train_metric nan, valid_metric 0.069156
[2648869:MainThread](2024-03-27 12:11:02,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.081618, valid_loss 1.161055, train_metric nan, valid_metric 0.081273
[2648869:MainThread](2024-03-27 12:11:02,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.161856 to 1.161055, save checkpoint.
[2648869:MainThread](2024-03-27 12:11:02,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.052396, valid_loss 1.162555, train_metric nan, valid_metric 0.081698
[2648869:MainThread](2024-03-27 12:11:02,633) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.035670, valid_loss 1.161895, train_metric nan, valid_metric 0.075204
[2648869:MainThread](2024-03-27 12:11:02,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.053506, valid_loss 1.163397, train_metric nan, valid_metric 0.071303
[2648869:MainThread](2024-03-27 12:11:03,039) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.043221, valid_loss 1.161559, train_metric nan, valid_metric 0.081700
[2648869:MainThread](2024-03-27 12:11:03,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.040318, valid_loss 1.161279, train_metric nan, valid_metric 0.080725
[2648869:MainThread](2024-03-27 12:11:03,442) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.034126, valid_loss 1.164204, train_metric nan, valid_metric 0.072588
[2648869:MainThread](2024-03-27 12:11:03,643) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.051567, valid_loss 1.163398, train_metric nan, valid_metric 0.076886
[2648869:MainThread](2024-03-27 12:11:03,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.040745, valid_loss 1.163134, train_metric nan, valid_metric 0.073147
[2648869:MainThread](2024-03-27 12:11:04,047) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.025186, valid_loss 1.161634, train_metric nan, valid_metric 0.081115
[2648869:MainThread](2024-03-27 12:11:04,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.047784, valid_loss 1.161376, train_metric nan, valid_metric 0.076162
[2648869:MainThread](2024-03-27 12:11:04,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.046853, valid_loss 1.162771, train_metric nan, valid_metric 0.073477
[2648869:MainThread](2024-03-27 12:11:04,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.043362, valid_loss 1.160731, train_metric nan, valid_metric 0.082844
[2648869:MainThread](2024-03-27 12:11:04,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.161055 to 1.160731, save checkpoint.
[2648869:MainThread](2024-03-27 12:11:04,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.043017, valid_loss 1.161077, train_metric nan, valid_metric 0.082310
[2648869:MainThread](2024-03-27 12:11:05,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.030494, valid_loss 1.162519, train_metric nan, valid_metric 0.084572
[2648869:MainThread](2024-03-27 12:11:05,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.027289, valid_loss 1.160928, train_metric nan, valid_metric 0.080527
[2648869:MainThread](2024-03-27 12:11:05,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.034284, valid_loss 1.161207, train_metric nan, valid_metric 0.084356
[2648869:MainThread](2024-03-27 12:11:05,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.026934, valid_loss 1.161734, train_metric nan, valid_metric 0.077886
[2648869:MainThread](2024-03-27 12:11:05,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.039547, valid_loss 1.161377, train_metric nan, valid_metric 0.080184
[2648869:MainThread](2024-03-27 12:11:06,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.039439, valid_loss 1.161457, train_metric nan, valid_metric 0.085372
[2648869:MainThread](2024-03-27 12:11:06,263) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.042263, valid_loss 1.162770, train_metric nan, valid_metric 0.075848
[2648869:MainThread](2024-03-27 12:11:06,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.038329, valid_loss 1.162822, train_metric nan, valid_metric 0.080217
[2648869:MainThread](2024-03-27 12:11:06,672) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.025136, valid_loss 1.161804, train_metric nan, valid_metric 0.077242
[2648869:MainThread](2024-03-27 12:11:06,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.030912, valid_loss 1.162317, train_metric nan, valid_metric 0.073611
[2648869:MainThread](2024-03-27 12:11:07,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.051881, valid_loss 1.162120, train_metric nan, valid_metric 0.077337
[2648869:MainThread](2024-03-27 12:11:07,278) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.031972, valid_loss 1.161085, train_metric nan, valid_metric 0.076954
[2648869:MainThread](2024-03-27 12:11:07,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.040974, valid_loss 1.161659, train_metric nan, valid_metric 0.075424
[2648869:MainThread](2024-03-27 12:11:07,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.036809, valid_loss 1.161143, train_metric nan, valid_metric 0.079690
[2648869:MainThread](2024-03-27 12:11:07,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.033172, valid_loss 1.162018, train_metric nan, valid_metric 0.074777
[2648869:MainThread](2024-03-27 12:11:08,091) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.033912, valid_loss 1.161833, train_metric nan, valid_metric 0.079597
[2648869:MainThread](2024-03-27 12:11:08,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.031684, valid_loss 1.161988, train_metric nan, valid_metric 0.072717
[2648869:MainThread](2024-03-27 12:11:08,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.042344, valid_loss 1.161034, train_metric nan, valid_metric 0.080074
[2648869:MainThread](2024-03-27 12:11:08,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.040041, valid_loss 1.162064, train_metric nan, valid_metric 0.073948
[2648869:MainThread](2024-03-27 12:11:08,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.023888, valid_loss 1.161053, train_metric nan, valid_metric 0.078258
[2648869:MainThread](2024-03-27 12:11:09,091) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.051307, valid_loss 1.161421, train_metric nan, valid_metric 0.080479
[2648869:MainThread](2024-03-27 12:11:09,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.031835, valid_loss 1.160826, train_metric nan, valid_metric 0.077388
[2648869:MainThread](2024-03-27 12:11:09,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.029479, valid_loss 1.161263, train_metric nan, valid_metric 0.077894
[2648869:MainThread](2024-03-27 12:11:09,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.039398, valid_loss 1.161936, train_metric nan, valid_metric 0.079005
[2648869:MainThread](2024-03-27 12:11:09,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.027200, valid_loss 1.161349, train_metric nan, valid_metric 0.080041
[2648869:MainThread](2024-03-27 12:11:10,130) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.027355, valid_loss 1.162266, train_metric nan, valid_metric 0.078309
[2648869:MainThread](2024-03-27 12:11:10,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.037704, valid_loss 1.162669, train_metric nan, valid_metric 0.078426
[2648869:MainThread](2024-03-27 12:11:10,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.028351, valid_loss 1.161386, train_metric nan, valid_metric 0.077551
[2648869:MainThread](2024-03-27 12:11:10,739) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.045585, valid_loss 1.161049, train_metric nan, valid_metric 0.076257
[2648869:MainThread](2024-03-27 12:11:10,985) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.033837, valid_loss 1.160939, train_metric nan, valid_metric 0.080143
[2648869:MainThread](2024-03-27 12:11:11,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.029681, valid_loss 1.161500, train_metric nan, valid_metric 0.077582
[2648869:MainThread](2024-03-27 12:11:11,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.034731, valid_loss 1.160770, train_metric nan, valid_metric 0.078583
[2648869:MainThread](2024-03-27 12:11:11,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.032679, valid_loss 1.161559, train_metric nan, valid_metric 0.076237
[2648869:MainThread](2024-03-27 12:11:11,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.033277, valid_loss 1.160378, train_metric nan, valid_metric 0.080498
[2648869:MainThread](2024-03-27 12:11:11,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.160731 to 1.160378, save checkpoint.
[2648869:MainThread](2024-03-27 12:11:12,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.028476, valid_loss 1.161647, train_metric nan, valid_metric 0.078590
[2648869:MainThread](2024-03-27 12:11:12,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.025094, valid_loss 1.161835, train_metric nan, valid_metric 0.077297
[2648869:MainThread](2024-03-27 12:11:12,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.030241, valid_loss 1.161131, train_metric nan, valid_metric 0.080695
[2648869:MainThread](2024-03-27 12:11:12,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.043851, valid_loss 1.161075, train_metric nan, valid_metric 0.078331
[2648869:MainThread](2024-03-27 12:11:13,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.035190, valid_loss 1.162238, train_metric nan, valid_metric 0.080487
[2648869:MainThread](2024-03-27 12:11:13,470) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.025678, valid_loss 1.161193, train_metric nan, valid_metric 0.078787
[2648869:MainThread](2024-03-27 12:11:13,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.035623, valid_loss 1.161419, train_metric nan, valid_metric 0.077403
[2648869:MainThread](2024-03-27 12:11:13,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.031096, valid_loss 1.162943, train_metric nan, valid_metric 0.079668
[2648869:MainThread](2024-03-27 12:11:14,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.027320, valid_loss 1.161245, train_metric nan, valid_metric 0.078836
[2648869:MainThread](2024-03-27 12:11:14,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.029782, valid_loss 1.160527, train_metric nan, valid_metric 0.077748
[2648869:MainThread](2024-03-27 12:11:14,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.035582, valid_loss 1.160777, train_metric nan, valid_metric 0.079870
[2648869:MainThread](2024-03-27 12:11:14,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.040686, valid_loss 1.161741, train_metric nan, valid_metric 0.078534
[2648869:MainThread](2024-03-27 12:11:14,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.030543, valid_loss 1.162751, train_metric nan, valid_metric 0.075803
[2648869:MainThread](2024-03-27 12:11:15,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.026254, valid_loss 1.161668, train_metric nan, valid_metric 0.078216
[2648869:MainThread](2024-03-27 12:11:15,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.025042, valid_loss 1.161342, train_metric nan, valid_metric 0.077842
[2648869:MainThread](2024-03-27 12:11:15,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.023909, valid_loss 1.162045, train_metric nan, valid_metric 0.079442
[2648869:MainThread](2024-03-27 12:11:15,701) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.030362, valid_loss 1.162380, train_metric nan, valid_metric 0.081045
[2648869:MainThread](2024-03-27 12:11:15,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.037866, valid_loss 1.161937, train_metric nan, valid_metric 0.080131
[2648869:MainThread](2024-03-27 12:11:16,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.032814, valid_loss 1.161291, train_metric nan, valid_metric 0.079840
[2648869:MainThread](2024-03-27 12:11:16,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.037617, valid_loss 1.161929, train_metric nan, valid_metric 0.080315
[2648869:MainThread](2024-03-27 12:11:16,507) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.030428, valid_loss 1.161433, train_metric nan, valid_metric 0.079371
[2648869:MainThread](2024-03-27 12:11:16,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.029377, valid_loss 1.162293, train_metric nan, valid_metric 0.079653
[2648869:MainThread](2024-03-27 12:11:16,926) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.025104, valid_loss 1.160747, train_metric nan, valid_metric 0.080974
[2648869:MainThread](2024-03-27 12:11:17,129) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.033961, valid_loss 1.160650, train_metric nan, valid_metric 0.078052
[2648869:MainThread](2024-03-27 12:11:17,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.033337, valid_loss 1.161783, train_metric nan, valid_metric 0.079410
[2648869:MainThread](2024-03-27 12:11:17,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.032377, valid_loss 1.162366, train_metric nan, valid_metric 0.080090
[2648869:MainThread](2024-03-27 12:11:17,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.028054, valid_loss 1.160659, train_metric nan, valid_metric 0.078422
[2648869:MainThread](2024-03-27 12:11:17,942) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.020719, valid_loss 1.161262, train_metric nan, valid_metric 0.076950
[2648869:MainThread](2024-03-27 12:11:18,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.034819, valid_loss 1.161138, train_metric nan, valid_metric 0.078074
[2648869:MainThread](2024-03-27 12:11:18,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.023525, valid_loss 1.161814, train_metric nan, valid_metric 0.080953
[2648869:MainThread](2024-03-27 12:11:18,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.043405, valid_loss 1.162783, train_metric nan, valid_metric 0.080921
[2648869:MainThread](2024-03-27 12:11:18,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.024138, valid_loss 1.161820, train_metric nan, valid_metric 0.080540
[2648869:MainThread](2024-03-27 12:11:18,953) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.034763, valid_loss 1.161738, train_metric nan, valid_metric 0.081114
[2648869:MainThread](2024-03-27 12:11:19,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.026335, valid_loss 1.161349, train_metric nan, valid_metric 0.079172
[2648869:MainThread](2024-03-27 12:11:19,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.040437, valid_loss 1.161192, train_metric nan, valid_metric 0.079019
[2648869:MainThread](2024-03-27 12:11:19,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.032545, valid_loss 1.160734, train_metric nan, valid_metric 0.079799
[2648869:MainThread](2024-03-27 12:11:19,765) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.024629, valid_loss 1.160862, train_metric nan, valid_metric 0.079787
[2648869:MainThread](2024-03-27 12:11:19,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.043492, valid_loss 1.162501, train_metric nan, valid_metric 0.079476
[2648869:MainThread](2024-03-27 12:11:20,171) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.020848, valid_loss 1.161143, train_metric nan, valid_metric 0.078177
[2648869:MainThread](2024-03-27 12:11:20,376) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.029948, valid_loss 1.161635, train_metric nan, valid_metric 0.078666
[2648869:MainThread](2024-03-27 12:11:20,582) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.035611, valid_loss 1.161567, train_metric nan, valid_metric 0.079940
[2648869:MainThread](2024-03-27 12:11:20,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.029085, valid_loss 1.160477, train_metric nan, valid_metric 0.078855
[2648869:MainThread](2024-03-27 12:11:20,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.031955, valid_loss 1.160996, train_metric nan, valid_metric 0.081838
[2648869:MainThread](2024-03-27 12:11:21,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.015559, valid_loss 1.160860, train_metric nan, valid_metric 0.079139
[2648869:MainThread](2024-03-27 12:11:21,396) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.023609, valid_loss 1.161099, train_metric nan, valid_metric 0.081173
[2648869:MainThread](2024-03-27 12:11:21,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.033622, valid_loss 1.160832, train_metric nan, valid_metric 0.078482
[2648869:MainThread](2024-03-27 12:11:21,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.020020, valid_loss 1.161104, train_metric nan, valid_metric 0.080772
[2648869:MainThread](2024-03-27 12:11:22,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 1.024168, valid_loss 1.160282, train_metric nan, valid_metric 0.078544
[2648869:MainThread](2024-03-27 12:11:22,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.160378 to 1.160282, save checkpoint.
[2648869:MainThread](2024-03-27 12:11:22,214) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 1.025185, valid_loss 1.161106, train_metric nan, valid_metric 0.077018
[2648869:MainThread](2024-03-27 12:11:22,415) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 1.030564, valid_loss 1.161321, train_metric nan, valid_metric 0.077616
[2648869:MainThread](2024-03-27 12:11:22,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 1.030238, valid_loss 1.161104, train_metric nan, valid_metric 0.078672
[2648869:MainThread](2024-03-27 12:11:22,832) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 1.030658, valid_loss 1.161896, train_metric nan, valid_metric 0.078384
[2648869:MainThread](2024-03-27 12:11:23,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 1.035408, valid_loss 1.160769, train_metric nan, valid_metric 0.076921
[2648869:MainThread](2024-03-27 12:11:23,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 1.025352, valid_loss 1.160943, train_metric nan, valid_metric 0.078529
[2648869:MainThread](2024-03-27 12:11:23,442) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 1.044831, valid_loss 1.161543, train_metric nan, valid_metric 0.080100
[2648869:MainThread](2024-03-27 12:11:23,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 1.028573, valid_loss 1.162306, train_metric nan, valid_metric 0.081181
[2648869:MainThread](2024-03-27 12:11:23,850) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 1.033966, valid_loss 1.162772, train_metric nan, valid_metric 0.076636
[2648869:MainThread](2024-03-27 12:11:24,050) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 1.026767, valid_loss 1.161488, train_metric nan, valid_metric 0.079855
[2648869:MainThread](2024-03-27 12:11:24,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 1.032992, valid_loss 1.161074, train_metric nan, valid_metric 0.079252
[2648869:MainThread](2024-03-27 12:11:24,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 1.032234, valid_loss 1.161382, train_metric nan, valid_metric 0.080060
[2648869:MainThread](2024-03-27 12:11:24,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 1.028826, valid_loss 1.161693, train_metric nan, valid_metric 0.078235
[2648869:MainThread](2024-03-27 12:11:24,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 1.023289, valid_loss 1.161719, train_metric nan, valid_metric 0.078529
[2648869:MainThread](2024-03-27 12:11:25,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 1.026828, valid_loss 1.161192, train_metric nan, valid_metric 0.078353
[2648869:MainThread](2024-03-27 12:11:25,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 1.032569, valid_loss 1.161069, train_metric nan, valid_metric 0.078066
[2648869:MainThread](2024-03-27 12:11:25,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 1.026620, valid_loss 1.160907, train_metric nan, valid_metric 0.079038
[2648869:MainThread](2024-03-27 12:11:25,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 1.025052, valid_loss 1.161082, train_metric nan, valid_metric 0.079860
[2648869:MainThread](2024-03-27 12:11:25,869) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 1.027043, valid_loss 1.162293, train_metric nan, valid_metric 0.079763
[2648869:MainThread](2024-03-27 12:11:26,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 1.041630, valid_loss 1.161554, train_metric nan, valid_metric 0.079793
[2648869:MainThread](2024-03-27 12:11:26,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2760]: train_loss 1.033232, valid_loss 1.160939, train_metric nan, valid_metric 0.078559
[2648869:MainThread](2024-03-27 12:11:26,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2780]: train_loss 1.029699, valid_loss 1.161414, train_metric nan, valid_metric 0.079683
[2648869:MainThread](2024-03-27 12:11:26,673) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2800]: train_loss 1.018799, valid_loss 1.161137, train_metric nan, valid_metric 0.078863
[2648869:MainThread](2024-03-27 12:11:26,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2820]: train_loss 1.028575, valid_loss 1.161531, train_metric nan, valid_metric 0.077633
[2648869:MainThread](2024-03-27 12:11:27,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2840]: train_loss 1.017905, valid_loss 1.161391, train_metric nan, valid_metric 0.077855
[2648869:MainThread](2024-03-27 12:11:27,275) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2860]: train_loss 1.031700, valid_loss 1.161942, train_metric nan, valid_metric 0.079405
[2648869:MainThread](2024-03-27 12:11:27,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2880]: train_loss 1.015990, valid_loss 1.161799, train_metric nan, valid_metric 0.078658
[2648869:MainThread](2024-03-27 12:11:27,678) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2900]: train_loss 1.024703, valid_loss 1.161581, train_metric nan, valid_metric 0.079773
[2648869:MainThread](2024-03-27 12:11:27,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2920]: train_loss 1.025186, valid_loss 1.160956, train_metric nan, valid_metric 0.079006
[2648869:MainThread](2024-03-27 12:11:28,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2940]: train_loss 1.032463, valid_loss 1.162124, train_metric nan, valid_metric 0.077758
[2648869:MainThread](2024-03-27 12:11:28,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2960]: train_loss 1.039195, valid_loss 1.161625, train_metric nan, valid_metric 0.078512
[2648869:MainThread](2024-03-27 12:11:28,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2980]: train_loss 1.042124, valid_loss 1.160529, train_metric nan, valid_metric 0.080880
[2648869:MainThread](2024-03-27 12:11:28,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3000]: train_loss 1.030354, valid_loss 1.160450, train_metric nan, valid_metric 0.078670
[2648869:MainThread](2024-03-27 12:11:28,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3020]: train_loss 1.031402, valid_loss 1.161043, train_metric nan, valid_metric 0.079122
[2648869:MainThread](2024-03-27 12:11:29,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3040]: train_loss 1.014022, valid_loss 1.160525, train_metric nan, valid_metric 0.079507
[2648869:MainThread](2024-03-27 12:11:29,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3060]: train_loss 1.029669, valid_loss 1.161664, train_metric nan, valid_metric 0.081389
[2648869:MainThread](2024-03-27 12:11:29,502) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3080]: train_loss 1.021519, valid_loss 1.160822, train_metric nan, valid_metric 0.078516
[2648869:MainThread](2024-03-27 12:11:29,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3100]: train_loss 1.019847, valid_loss 1.161054, train_metric nan, valid_metric 0.080197
[2648869:MainThread](2024-03-27 12:11:29,910) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3120]: train_loss 1.028352, valid_loss 1.161592, train_metric nan, valid_metric 0.079985
[2648869:MainThread](2024-03-27 12:11:30,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3140]: train_loss 1.041459, valid_loss 1.160975, train_metric nan, valid_metric 0.080238
[2648869:MainThread](2024-03-27 12:11:30,321) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3160]: train_loss 1.039492, valid_loss 1.161807, train_metric nan, valid_metric 0.080672
[2648869:MainThread](2024-03-27 12:11:30,528) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3180]: train_loss 1.030382, valid_loss 1.161680, train_metric nan, valid_metric 0.080316
[2648869:MainThread](2024-03-27 12:11:30,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3200]: train_loss 1.035836, valid_loss 1.161138, train_metric nan, valid_metric 0.077870
[2648869:MainThread](2024-03-27 12:11:30,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3220]: train_loss 1.023713, valid_loss 1.160311, train_metric nan, valid_metric 0.078747
[2648869:MainThread](2024-03-27 12:11:31,134) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3240]: train_loss 1.017886, valid_loss 1.161091, train_metric nan, valid_metric 0.079115
[2648869:MainThread](2024-03-27 12:11:31,335) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3260]: train_loss 1.025084, valid_loss 1.162213, train_metric nan, valid_metric 0.080624
[2648869:MainThread](2024-03-27 12:11:31,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3280]: train_loss 1.019854, valid_loss 1.161686, train_metric nan, valid_metric 0.080274
[2648869:MainThread](2024-03-27 12:11:31,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3300]: train_loss 1.021534, valid_loss 1.161100, train_metric nan, valid_metric 0.078241
[2648869:MainThread](2024-03-27 12:11:31,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3320]: train_loss 1.038857, valid_loss 1.161293, train_metric nan, valid_metric 0.078169
[2648869:MainThread](2024-03-27 12:11:32,143) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3340]: train_loss 1.017006, valid_loss 1.160685, train_metric nan, valid_metric 0.075718
[2648869:MainThread](2024-03-27 12:11:32,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:11:32,809) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
Epoch  1100: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1520: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1740: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1960: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2180: reducing learning rate of group 0 to 1.5625e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2018-11-22 SH600000    0.084554
           SH600008   -0.035585
           SH600009    0.107064
           SH600010    0.039536
           SH600011    0.113104
Epoch   640: reducing learning rate of group 0 to 1.0000e-03.
Epoch   860: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1080: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1300: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2018-12-20 SH600000   -0.008322
           SH600004    0.018139
           SH600009   -0.035209
           SH600010   -0.022623
           SH600011    0.002911
Epoch   720: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1060: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1280: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1500: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1720: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2019-01-21 SH600000    0.083354
           SH600004   -0.043477
           SH600009    0.020172
           SH600010    0.042444
           SH600011    0.013641
Epoch   580: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1300: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1660: reducing learning rate of group 0 to 2.5000e-04.
Epoch  2020: reducing learning rate of group 0 to 1.2500e-04.
Epoch  2240: reducing learning rate of group 0 to 6.2500e-05.
Epoch  2460: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2680: reducing learning rate of group 0 to 1.5625e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2019-02-25 SH600000   -0.031583
           SH600004    0.051146
           SH600009    0.126305
           SH600010   -0.010733
           SH600011    0.157427
Epoch   900: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1240: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1700: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1920: reducing learning rate of group 0 to 1.2500e-04.
Epoch  2280: reducing learning rate of group 0 to 6.2500e-05.
Epoch  2500: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2740: reducing learning rate of group 0 to 1.5625e-05.
Epoch  3160: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2019-03-25 SH600000   -0.031002
           SH600004   -0.042221
           SH600009    0.040663
           SH600010   -0.056366
           SH600011    0.024663
Epoch  1060: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1280: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1500: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1720: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2019-04-23 SH600000   -0.001857
           SH600004    0.031651
           SH600009   -0.107017
           SH600010   -0.048995
           SH600011   -0.044372
Epoch   320: reducing learning rate of group 0 to 1.0000e-03.
Epoch   620: reducing learning rate of group 0 to 5.0000e-04.
Epoch   940: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1160: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1380: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1600: reducing learning rate of group 0 to 3.1250e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2019-05-24 SH600000   -0.068275
           SH600004    0.001181
           SH600009    0.112600
           SH600010   -0.058583
           SH600011   -0.027820
Epoch   600: reducing learning rate of group 0 to 1.0000e-03.
Epoch   820: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1100: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1320: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1540: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1760: reducing learning rate of group 0 to 3.1250e-05.
Epoch  1980: reducing learning rate of group 0 to 1.5625e-05.
Epoch  2200: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2019-06-24 SH600000    0.054293
           SH600004    0.023488
           SH600009   -0.068890
           SH600010   -0.053215
           SH600011    0.068479
Epoch  1060: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1460: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1680: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1900: reducing learning rate of group 0 to 1.2500e-04.
Epoch  2120: reducing learning rate of group 0 to 6.2500e-05.
Epoch  2440: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2660: reducing learning rate of group 0 to 1.5625e-05.
Epoch  2880: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2019-07-22 SH600000    0.109486
           SH600004    0.093310
           SH600009    0.083094
           SH600010   -0.046408
           SH600011    0.014447
Epoch   780: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1540: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1760: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1980: reducing learning rate of group 0 to 1.2500e-04.
Epoch  2200: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2019-08-19 SH600000   -0.024477
           SH600004   -0.054816
           SH600009    0.071458
           SH600010   -0.023739
           SH600011   -0.081814
Epoch   460: reducing learning rate of group 0 to 1.0000e-03.
Epoch   760: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1200: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1420: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1640: reducing learning rate of group 0 to 6.2500e-05.
Epoch  2020: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2240: reducing learning rate of group 0 to 1.5625e-05.
Epoch  2520: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2019-09-17 SH600000    0.269337
           SH600004    0.306061
           SH600009    0.260622
           SH600010    0.018159
           SH600011    0.070851
Epoch   660: reducing learning rate of group 0 to 1.0000e-03.
Epoch   900: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1120: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1340: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1600: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1820: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2040: reducing learning rate of group 0 to 1.5625e-05.
Epoch  2260: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
[2648869:MainThread](2024-03-27 12:11:33,501) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  80%|███████▉  | 35/44 [18:55<05:19, 35.48s/it][2648869:MainThread](2024-03-27 12:11:33,508) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:11:33,520) INFO - qlib.workflow - [recorder.py:341] - Recorder a3cf4c3e7ca540438e9a42058a748545 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:11:34,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:11:34,140) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:11:34,143) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:11:34,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:11:35,912) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.609019
            SH600004      1.609019
            SH600006      1.609019
            SH600007      1.609019
            SH600008      1.609019
                            ...   
2017-12-29  SZ300124      0.563739
            SZ300136      0.563739
            SZ300144      0.563739
            SZ300251      0.563739
            SZ300315      0.563739
Length: 610345, dtype: float64
[2648869:MainThread](2024-03-27 12:11:36,843) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2018-01-02  SH600000      0.563739
            SH600009      0.563739
            SH600010      0.563739
            SH600011      0.563739
            SH600015      0.563739
                            ...   
2019-10-21  SZ300296      0.548124
            SZ300408      0.548124
            SZ300413      0.548124
            SZ300433      0.548124
            SZ300498      0.548124
Length: 118740, dtype: float64
[2648869:MainThread](2024-03-27 12:11:36,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:11:37,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.366510, valid_loss 1.059879, train_metric nan, valid_metric 0.028849
[2648869:MainThread](2024-03-27 12:11:37,442) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.059879, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:11:37,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.293468, valid_loss 1.054072, train_metric nan, valid_metric 0.038937
[2648869:MainThread](2024-03-27 12:11:37,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.059879 to 1.054072, save checkpoint.
[2648869:MainThread](2024-03-27 12:11:37,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.243538, valid_loss 1.034178, train_metric nan, valid_metric 0.040040
[2648869:MainThread](2024-03-27 12:11:37,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.054072 to 1.034178, save checkpoint.
[2648869:MainThread](2024-03-27 12:11:38,058) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.156886, valid_loss 1.042726, train_metric nan, valid_metric 0.048210
[2648869:MainThread](2024-03-27 12:11:38,261) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.256178, valid_loss 1.038015, train_metric nan, valid_metric 0.050254
[2648869:MainThread](2024-03-27 12:11:38,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.162010, valid_loss 1.032198, train_metric nan, valid_metric 0.060571
[2648869:MainThread](2024-03-27 12:11:38,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.034178 to 1.032198, save checkpoint.
[2648869:MainThread](2024-03-27 12:11:38,666) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.142962, valid_loss 1.033904, train_metric nan, valid_metric 0.065805
[2648869:MainThread](2024-03-27 12:11:38,869) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.266280, valid_loss 1.041277, train_metric nan, valid_metric 0.042306
[2648869:MainThread](2024-03-27 12:11:39,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.164181, valid_loss 1.034739, train_metric nan, valid_metric 0.065329
[2648869:MainThread](2024-03-27 12:11:39,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.155221, valid_loss 1.029979, train_metric nan, valid_metric 0.081891
[2648869:MainThread](2024-03-27 12:11:39,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.032198 to 1.029979, save checkpoint.
[2648869:MainThread](2024-03-27 12:11:39,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.146131, valid_loss 1.031155, train_metric nan, valid_metric 0.081524
[2648869:MainThread](2024-03-27 12:11:39,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.159944, valid_loss 1.034251, train_metric nan, valid_metric 0.077527
[2648869:MainThread](2024-03-27 12:11:39,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.196344, valid_loss 1.033136, train_metric nan, valid_metric 0.067370
[2648869:MainThread](2024-03-27 12:11:40,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.188487, valid_loss 1.029543, train_metric nan, valid_metric 0.086173
[2648869:MainThread](2024-03-27 12:11:40,084) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.029979 to 1.029543, save checkpoint.
[2648869:MainThread](2024-03-27 12:11:40,287) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.125325, valid_loss 1.036432, train_metric nan, valid_metric 0.066910
[2648869:MainThread](2024-03-27 12:11:40,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.103637, valid_loss 1.030140, train_metric nan, valid_metric 0.082409
[2648869:MainThread](2024-03-27 12:11:40,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.093031, valid_loss 1.032583, train_metric nan, valid_metric 0.073497
[2648869:MainThread](2024-03-27 12:11:40,898) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.118699, valid_loss 1.032186, train_metric nan, valid_metric 0.076063
[2648869:MainThread](2024-03-27 12:11:41,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.092926, valid_loss 1.035994, train_metric nan, valid_metric 0.052187
[2648869:MainThread](2024-03-27 12:11:41,305) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.104877, valid_loss 1.031720, train_metric nan, valid_metric 0.083520
[2648869:MainThread](2024-03-27 12:11:41,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.101371, valid_loss 1.030853, train_metric nan, valid_metric 0.086376
[2648869:MainThread](2024-03-27 12:11:41,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.092219, valid_loss 1.031314, train_metric nan, valid_metric 0.090119
[2648869:MainThread](2024-03-27 12:11:41,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.109848, valid_loss 1.033342, train_metric nan, valid_metric 0.080124
[2648869:MainThread](2024-03-27 12:11:42,105) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.130832, valid_loss 1.035426, train_metric nan, valid_metric 0.080829
[2648869:MainThread](2024-03-27 12:11:42,309) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.107940, valid_loss 1.032690, train_metric nan, valid_metric 0.078103
[2648869:MainThread](2024-03-27 12:11:42,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.111750, valid_loss 1.030318, train_metric nan, valid_metric 0.090863
[2648869:MainThread](2024-03-27 12:11:42,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.076312, valid_loss 1.029732, train_metric nan, valid_metric 0.093789
[2648869:MainThread](2024-03-27 12:11:42,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.082353, valid_loss 1.031013, train_metric nan, valid_metric 0.090351
[2648869:MainThread](2024-03-27 12:11:43,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.116362, valid_loss 1.031061, train_metric nan, valid_metric 0.088628
[2648869:MainThread](2024-03-27 12:11:43,333) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.076573, valid_loss 1.029681, train_metric nan, valid_metric 0.096287
[2648869:MainThread](2024-03-27 12:11:43,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.076878, valid_loss 1.030248, train_metric nan, valid_metric 0.091074
[2648869:MainThread](2024-03-27 12:11:43,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.099073, valid_loss 1.029079, train_metric nan, valid_metric 0.090997
[2648869:MainThread](2024-03-27 12:11:43,737) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.029543 to 1.029079, save checkpoint.
[2648869:MainThread](2024-03-27 12:11:43,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.076331, valid_loss 1.028866, train_metric nan, valid_metric 0.095249
[2648869:MainThread](2024-03-27 12:11:43,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.029079 to 1.028866, save checkpoint.
[2648869:MainThread](2024-03-27 12:11:44,149) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.104634, valid_loss 1.029890, train_metric nan, valid_metric 0.093598
[2648869:MainThread](2024-03-27 12:11:44,353) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.107639, valid_loss 1.030457, train_metric nan, valid_metric 0.091005
[2648869:MainThread](2024-03-27 12:11:44,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.074574, valid_loss 1.029674, train_metric nan, valid_metric 0.091514
[2648869:MainThread](2024-03-27 12:11:44,757) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.070044, valid_loss 1.030706, train_metric nan, valid_metric 0.087705
[2648869:MainThread](2024-03-27 12:11:44,962) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.097172, valid_loss 1.031744, train_metric nan, valid_metric 0.089015
[2648869:MainThread](2024-03-27 12:11:45,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.075056, valid_loss 1.030589, train_metric nan, valid_metric 0.088660
[2648869:MainThread](2024-03-27 12:11:45,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.086559, valid_loss 1.030256, train_metric nan, valid_metric 0.090365
[2648869:MainThread](2024-03-27 12:11:45,569) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.097287, valid_loss 1.030500, train_metric nan, valid_metric 0.090915
[2648869:MainThread](2024-03-27 12:11:45,782) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.077240, valid_loss 1.030630, train_metric nan, valid_metric 0.089116
[2648869:MainThread](2024-03-27 12:11:45,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.090798, valid_loss 1.030627, train_metric nan, valid_metric 0.088455
[2648869:MainThread](2024-03-27 12:11:46,188) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.080544, valid_loss 1.030409, train_metric nan, valid_metric 0.090183
[2648869:MainThread](2024-03-27 12:11:46,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.086111, valid_loss 1.030341, train_metric nan, valid_metric 0.093020
[2648869:MainThread](2024-03-27 12:11:46,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.080812, valid_loss 1.029008, train_metric nan, valid_metric 0.093364
[2648869:MainThread](2024-03-27 12:11:46,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.087835, valid_loss 1.030992, train_metric nan, valid_metric 0.090117
[2648869:MainThread](2024-03-27 12:11:47,005) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.070198, valid_loss 1.029994, train_metric nan, valid_metric 0.091645
[2648869:MainThread](2024-03-27 12:11:47,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.063308, valid_loss 1.030184, train_metric nan, valid_metric 0.091559
[2648869:MainThread](2024-03-27 12:11:47,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.079304, valid_loss 1.029351, train_metric nan, valid_metric 0.093971
[2648869:MainThread](2024-03-27 12:11:47,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.076237, valid_loss 1.031260, train_metric nan, valid_metric 0.090947
[2648869:MainThread](2024-03-27 12:11:47,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.067589, valid_loss 1.030083, train_metric nan, valid_metric 0.090951
[2648869:MainThread](2024-03-27 12:11:48,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.079750, valid_loss 1.029721, train_metric nan, valid_metric 0.093789
[2648869:MainThread](2024-03-27 12:11:48,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.080716, valid_loss 1.029582, train_metric nan, valid_metric 0.089708
[2648869:MainThread](2024-03-27 12:11:48,424) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.076630, valid_loss 1.029636, train_metric nan, valid_metric 0.092851
[2648869:MainThread](2024-03-27 12:11:48,628) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.073336, valid_loss 1.029182, train_metric nan, valid_metric 0.093641
[2648869:MainThread](2024-03-27 12:11:48,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.064646, valid_loss 1.029462, train_metric nan, valid_metric 0.093659
[2648869:MainThread](2024-03-27 12:11:49,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.070334, valid_loss 1.030825, train_metric nan, valid_metric 0.087014
[2648869:MainThread](2024-03-27 12:11:49,233) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.096010, valid_loss 1.030853, train_metric nan, valid_metric 0.088772
[2648869:MainThread](2024-03-27 12:11:49,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.067273, valid_loss 1.030085, train_metric nan, valid_metric 0.092137
[2648869:MainThread](2024-03-27 12:11:49,638) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.061954, valid_loss 1.029473, train_metric nan, valid_metric 0.093972
[2648869:MainThread](2024-03-27 12:11:49,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.073841, valid_loss 1.030287, train_metric nan, valid_metric 0.090990
[2648869:MainThread](2024-03-27 12:11:50,039) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.083573, valid_loss 1.030079, train_metric nan, valid_metric 0.092997
[2648869:MainThread](2024-03-27 12:11:50,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.079058, valid_loss 1.030307, train_metric nan, valid_metric 0.091628
[2648869:MainThread](2024-03-27 12:11:50,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.080988, valid_loss 1.029530, train_metric nan, valid_metric 0.093677
[2648869:MainThread](2024-03-27 12:11:50,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.092726, valid_loss 1.030439, train_metric nan, valid_metric 0.089248
[2648869:MainThread](2024-03-27 12:11:50,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.077151, valid_loss 1.030321, train_metric nan, valid_metric 0.092318
[2648869:MainThread](2024-03-27 12:11:51,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.072182, valid_loss 1.030038, train_metric nan, valid_metric 0.091648
[2648869:MainThread](2024-03-27 12:11:51,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.077042, valid_loss 1.030502, train_metric nan, valid_metric 0.090829
[2648869:MainThread](2024-03-27 12:11:51,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.063471, valid_loss 1.030378, train_metric nan, valid_metric 0.092274
[2648869:MainThread](2024-03-27 12:11:51,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.066006, valid_loss 1.030286, train_metric nan, valid_metric 0.090319
[2648869:MainThread](2024-03-27 12:11:51,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.069894, valid_loss 1.029927, train_metric nan, valid_metric 0.090343
[2648869:MainThread](2024-03-27 12:11:52,064) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.075619, valid_loss 1.030493, train_metric nan, valid_metric 0.088507
[2648869:MainThread](2024-03-27 12:11:52,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.065863, valid_loss 1.030053, train_metric nan, valid_metric 0.091736
[2648869:MainThread](2024-03-27 12:11:52,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.069891, valid_loss 1.030102, train_metric nan, valid_metric 0.094037
[2648869:MainThread](2024-03-27 12:11:52,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.081611, valid_loss 1.030447, train_metric nan, valid_metric 0.091532
[2648869:MainThread](2024-03-27 12:11:52,880) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.071224, valid_loss 1.029824, train_metric nan, valid_metric 0.093201
[2648869:MainThread](2024-03-27 12:11:53,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.083045, valid_loss 1.030565, train_metric nan, valid_metric 0.090739
[2648869:MainThread](2024-03-27 12:11:53,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.087782, valid_loss 1.030242, train_metric nan, valid_metric 0.089291
[2648869:MainThread](2024-03-27 12:11:53,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.074492, valid_loss 1.030394, train_metric nan, valid_metric 0.090469
[2648869:MainThread](2024-03-27 12:11:53,710) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.071637, valid_loss 1.030031, train_metric nan, valid_metric 0.091188
[2648869:MainThread](2024-03-27 12:11:53,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.064910, valid_loss 1.030254, train_metric nan, valid_metric 0.089470
[2648869:MainThread](2024-03-27 12:11:54,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.061589, valid_loss 1.030537, train_metric nan, valid_metric 0.089315
[2648869:MainThread](2024-03-27 12:11:54,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:11:54,778) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:11:55,418) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  82%|████████▏ | 36/44 [19:17<04:11, 31.41s/it][2648869:MainThread](2024-03-27 12:11:55,425) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:11:55,436) INFO - qlib.workflow - [recorder.py:341] - Recorder 338d7f49fd7f4edfa36ebb9d9c4eb2b9 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:11:56,066) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:11:56,066) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:11:56,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:11:56,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:11:57,814) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.837404
            SH600004      0.837404
            SH600006      0.837404
            SH600007      0.837404
            SH600008      0.837404
                            ...   
2018-01-29  SZ300124      1.415710
            SZ300136      1.415710
            SZ300144      1.415710
            SZ300251      1.415710
            SZ300315      1.415710
Length: 615791, dtype: float64
[2648869:MainThread](2024-03-27 12:11:58,753) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2018-01-30  SH600000      1.41571
            SH600008      1.41571
            SH600009      1.41571
            SH600010      1.41571
            SH600011      1.41571
                           ...   
2019-11-18  SZ300296      0.94107
            SZ300408      0.94107
            SZ300413      0.94107
            SZ300433      0.94107
            SZ300498      0.94107
Length: 119225, dtype: float64
[2648869:MainThread](2024-03-27 12:11:58,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:11:59,385) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.327587, valid_loss 1.127336, train_metric nan, valid_metric -0.026005
[2648869:MainThread](2024-03-27 12:11:59,385) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.127336, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:11:59,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.293928, valid_loss 1.120162, train_metric nan, valid_metric 0.001206
[2648869:MainThread](2024-03-27 12:11:59,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.127336 to 1.120162, save checkpoint.
[2648869:MainThread](2024-03-27 12:11:59,895) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.175509, valid_loss 1.129450, train_metric nan, valid_metric 0.018377
[2648869:MainThread](2024-03-27 12:12:00,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.115681, valid_loss 1.111114, train_metric nan, valid_metric 0.043879
[2648869:MainThread](2024-03-27 12:12:00,148) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.120162 to 1.111114, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:00,356) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.160979, valid_loss 1.107122, train_metric nan, valid_metric 0.048819
[2648869:MainThread](2024-03-27 12:12:00,356) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.111114 to 1.107122, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:00,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.162192, valid_loss 1.107006, train_metric nan, valid_metric 0.060687
[2648869:MainThread](2024-03-27 12:12:00,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.107122 to 1.107006, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:00,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.175195, valid_loss 1.102933, train_metric nan, valid_metric 0.062044
[2648869:MainThread](2024-03-27 12:12:00,759) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.107006 to 1.102933, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:00,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.111732, valid_loss 1.102059, train_metric nan, valid_metric 0.063353
[2648869:MainThread](2024-03-27 12:12:00,960) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.102933 to 1.102059, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:01,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.112891, valid_loss 1.105342, train_metric nan, valid_metric 0.063715
[2648869:MainThread](2024-03-27 12:12:01,359) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.085856, valid_loss 1.104276, train_metric nan, valid_metric 0.073478
[2648869:MainThread](2024-03-27 12:12:01,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.083278, valid_loss 1.102961, train_metric nan, valid_metric 0.069427
[2648869:MainThread](2024-03-27 12:12:01,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.066620, valid_loss 1.107490, train_metric nan, valid_metric 0.055070
[2648869:MainThread](2024-03-27 12:12:01,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.086234, valid_loss 1.104455, train_metric nan, valid_metric 0.066653
[2648869:MainThread](2024-03-27 12:12:02,158) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.163686, valid_loss 1.105445, train_metric nan, valid_metric 0.069277
[2648869:MainThread](2024-03-27 12:12:02,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.120516, valid_loss 1.102670, train_metric nan, valid_metric 0.068667
[2648869:MainThread](2024-03-27 12:12:02,555) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.065221, valid_loss 1.101990, train_metric nan, valid_metric 0.068165
[2648869:MainThread](2024-03-27 12:12:02,555) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.102059 to 1.101990, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:02,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.055219, valid_loss 1.104167, train_metric nan, valid_metric 0.067080
[2648869:MainThread](2024-03-27 12:12:03,013) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.059923, valid_loss 1.103139, train_metric nan, valid_metric 0.068041
[2648869:MainThread](2024-03-27 12:12:03,210) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.088515, valid_loss 1.100639, train_metric nan, valid_metric 0.079437
[2648869:MainThread](2024-03-27 12:12:03,211) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.101990 to 1.100639, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:03,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.072403, valid_loss 1.102210, train_metric nan, valid_metric 0.071252
[2648869:MainThread](2024-03-27 12:12:03,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.049514, valid_loss 1.101604, train_metric nan, valid_metric 0.077242
[2648869:MainThread](2024-03-27 12:12:03,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.044872, valid_loss 1.101897, train_metric nan, valid_metric 0.076294
[2648869:MainThread](2024-03-27 12:12:03,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.070188, valid_loss 1.111982, train_metric nan, valid_metric 0.068639
[2648869:MainThread](2024-03-27 12:12:04,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.054737, valid_loss 1.105802, train_metric nan, valid_metric 0.075187
[2648869:MainThread](2024-03-27 12:12:04,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.055936, valid_loss 1.101290, train_metric nan, valid_metric 0.084456
[2648869:MainThread](2024-03-27 12:12:04,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.047672, valid_loss 1.102107, train_metric nan, valid_metric 0.078194
[2648869:MainThread](2024-03-27 12:12:04,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.047748, valid_loss 1.100103, train_metric nan, valid_metric 0.080323
[2648869:MainThread](2024-03-27 12:12:04,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.100639 to 1.100103, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:05,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.046118, valid_loss 1.103157, train_metric nan, valid_metric 0.069473
[2648869:MainThread](2024-03-27 12:12:05,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.046620, valid_loss 1.102097, train_metric nan, valid_metric 0.077140
[2648869:MainThread](2024-03-27 12:12:05,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.085913, valid_loss 1.109104, train_metric nan, valid_metric 0.076947
[2648869:MainThread](2024-03-27 12:12:05,852) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.027112, valid_loss 1.102713, train_metric nan, valid_metric 0.081944
[2648869:MainThread](2024-03-27 12:12:06,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.134017, valid_loss 1.099259, train_metric nan, valid_metric 0.080999
[2648869:MainThread](2024-03-27 12:12:06,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.100103 to 1.099259, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:06,309) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.065952, valid_loss 1.099852, train_metric nan, valid_metric 0.077026
[2648869:MainThread](2024-03-27 12:12:06,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.052037, valid_loss 1.102862, train_metric nan, valid_metric 0.079777
[2648869:MainThread](2024-03-27 12:12:06,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.034534, valid_loss 1.100977, train_metric nan, valid_metric 0.080283
[2648869:MainThread](2024-03-27 12:12:06,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.040612, valid_loss 1.098741, train_metric nan, valid_metric 0.087520
[2648869:MainThread](2024-03-27 12:12:06,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.099259 to 1.098741, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:07,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.038615, valid_loss 1.101418, train_metric nan, valid_metric 0.080345
[2648869:MainThread](2024-03-27 12:12:07,277) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.031517, valid_loss 1.099658, train_metric nan, valid_metric 0.084949
[2648869:MainThread](2024-03-27 12:12:07,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.044692, valid_loss 1.101351, train_metric nan, valid_metric 0.080815
[2648869:MainThread](2024-03-27 12:12:07,666) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.027707, valid_loss 1.101673, train_metric nan, valid_metric 0.079277
[2648869:MainThread](2024-03-27 12:12:07,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.035232, valid_loss 1.100271, train_metric nan, valid_metric 0.083733
[2648869:MainThread](2024-03-27 12:12:08,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.023125, valid_loss 1.100889, train_metric nan, valid_metric 0.083978
[2648869:MainThread](2024-03-27 12:12:08,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.041398, valid_loss 1.099142, train_metric nan, valid_metric 0.088395
[2648869:MainThread](2024-03-27 12:12:08,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.039923, valid_loss 1.099574, train_metric nan, valid_metric 0.084509
[2648869:MainThread](2024-03-27 12:12:08,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.034745, valid_loss 1.099852, train_metric nan, valid_metric 0.082185
[2648869:MainThread](2024-03-27 12:12:08,892) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.043631, valid_loss 1.098344, train_metric nan, valid_metric 0.089369
[2648869:MainThread](2024-03-27 12:12:08,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.098741 to 1.098344, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:09,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.031454, valid_loss 1.100550, train_metric nan, valid_metric 0.086296
[2648869:MainThread](2024-03-27 12:12:09,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.037111, valid_loss 1.100627, train_metric nan, valid_metric 0.087764
[2648869:MainThread](2024-03-27 12:12:09,507) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.020413, valid_loss 1.099856, train_metric nan, valid_metric 0.090618
[2648869:MainThread](2024-03-27 12:12:09,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.025104, valid_loss 1.100035, train_metric nan, valid_metric 0.087911
[2648869:MainThread](2024-03-27 12:12:09,909) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.032208, valid_loss 1.100368, train_metric nan, valid_metric 0.085288
[2648869:MainThread](2024-03-27 12:12:10,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.031620, valid_loss 1.099313, train_metric nan, valid_metric 0.088485
[2648869:MainThread](2024-03-27 12:12:10,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.041323, valid_loss 1.098631, train_metric nan, valid_metric 0.089393
[2648869:MainThread](2024-03-27 12:12:10,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.036835, valid_loss 1.099751, train_metric nan, valid_metric 0.086631
[2648869:MainThread](2024-03-27 12:12:10,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.024650, valid_loss 1.101502, train_metric nan, valid_metric 0.081698
[2648869:MainThread](2024-03-27 12:12:10,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.019934, valid_loss 1.099091, train_metric nan, valid_metric 0.086583
[2648869:MainThread](2024-03-27 12:12:11,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.012841, valid_loss 1.100035, train_metric nan, valid_metric 0.084146
[2648869:MainThread](2024-03-27 12:12:11,327) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.020447, valid_loss 1.101096, train_metric nan, valid_metric 0.084268
[2648869:MainThread](2024-03-27 12:12:11,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.021323, valid_loss 1.099985, train_metric nan, valid_metric 0.085784
[2648869:MainThread](2024-03-27 12:12:11,733) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.018412, valid_loss 1.098851, train_metric nan, valid_metric 0.086586
[2648869:MainThread](2024-03-27 12:12:11,935) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.034935, valid_loss 1.099947, train_metric nan, valid_metric 0.085540
[2648869:MainThread](2024-03-27 12:12:12,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.035972, valid_loss 1.099980, train_metric nan, valid_metric 0.087179
[2648869:MainThread](2024-03-27 12:12:12,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.021235, valid_loss 1.100256, train_metric nan, valid_metric 0.084714
[2648869:MainThread](2024-03-27 12:12:12,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.023261, valid_loss 1.099424, train_metric nan, valid_metric 0.088045
[2648869:MainThread](2024-03-27 12:12:12,743) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.014458, valid_loss 1.100139, train_metric nan, valid_metric 0.085918
[2648869:MainThread](2024-03-27 12:12:12,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.030518, valid_loss 1.099890, train_metric nan, valid_metric 0.087232
[2648869:MainThread](2024-03-27 12:12:13,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.015413, valid_loss 1.099569, train_metric nan, valid_metric 0.086498
[2648869:MainThread](2024-03-27 12:12:13,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.023933, valid_loss 1.099281, train_metric nan, valid_metric 0.084908
[2648869:MainThread](2024-03-27 12:12:13,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.031060, valid_loss 1.099204, train_metric nan, valid_metric 0.086949
[2648869:MainThread](2024-03-27 12:12:13,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.029838, valid_loss 1.099503, train_metric nan, valid_metric 0.086627
[2648869:MainThread](2024-03-27 12:12:13,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.024418, valid_loss 1.099858, train_metric nan, valid_metric 0.086339
[2648869:MainThread](2024-03-27 12:12:14,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.043704, valid_loss 1.099758, train_metric nan, valid_metric 0.088418
[2648869:MainThread](2024-03-27 12:12:14,374) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.022513, valid_loss 1.099739, train_metric nan, valid_metric 0.085974
[2648869:MainThread](2024-03-27 12:12:14,576) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.020311, valid_loss 1.099745, train_metric nan, valid_metric 0.088072
[2648869:MainThread](2024-03-27 12:12:14,778) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.019710, valid_loss 1.099355, train_metric nan, valid_metric 0.086728
[2648869:MainThread](2024-03-27 12:12:14,984) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.020399, valid_loss 1.099343, train_metric nan, valid_metric 0.087356
[2648869:MainThread](2024-03-27 12:12:15,191) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.018377, valid_loss 1.100435, train_metric nan, valid_metric 0.086346
[2648869:MainThread](2024-03-27 12:12:15,395) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.018193, valid_loss 1.099402, train_metric nan, valid_metric 0.088118
[2648869:MainThread](2024-03-27 12:12:15,603) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.027480, valid_loss 1.100437, train_metric nan, valid_metric 0.085467
[2648869:MainThread](2024-03-27 12:12:15,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.023313, valid_loss 1.099525, train_metric nan, valid_metric 0.087550
[2648869:MainThread](2024-03-27 12:12:16,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.015924, valid_loss 1.099667, train_metric nan, valid_metric 0.086545
[2648869:MainThread](2024-03-27 12:12:16,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.023666, valid_loss 1.100390, train_metric nan, valid_metric 0.085076
[2648869:MainThread](2024-03-27 12:12:16,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.028513, valid_loss 1.100161, train_metric nan, valid_metric 0.085935
[2648869:MainThread](2024-03-27 12:12:16,677) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.023298, valid_loss 1.100267, train_metric nan, valid_metric 0.086026
[2648869:MainThread](2024-03-27 12:12:16,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.020558, valid_loss 1.100077, train_metric nan, valid_metric 0.084052
[2648869:MainThread](2024-03-27 12:12:17,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.019373, valid_loss 1.099801, train_metric nan, valid_metric 0.086578
[2648869:MainThread](2024-03-27 12:12:17,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.020940, valid_loss 1.099468, train_metric nan, valid_metric 0.088992
[2648869:MainThread](2024-03-27 12:12:17,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.023717, valid_loss 1.100610, train_metric nan, valid_metric 0.087588
[2648869:MainThread](2024-03-27 12:12:17,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.015675, valid_loss 1.099676, train_metric nan, valid_metric 0.086309
[2648869:MainThread](2024-03-27 12:12:18,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.026503, valid_loss 1.099668, train_metric nan, valid_metric 0.087153
[2648869:MainThread](2024-03-27 12:12:18,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.014461, valid_loss 1.099277, train_metric nan, valid_metric 0.088294
[2648869:MainThread](2024-03-27 12:12:18,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.018679, valid_loss 1.099537, train_metric nan, valid_metric 0.086645
[2648869:MainThread](2024-03-27 12:12:18,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.020667, valid_loss 1.099809, train_metric nan, valid_metric 0.087613
[2648869:MainThread](2024-03-27 12:12:18,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.019199, valid_loss 1.099236, train_metric nan, valid_metric 0.088546
[2648869:MainThread](2024-03-27 12:12:19,107) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.007808, valid_loss 1.100126, train_metric nan, valid_metric 0.086297
[2648869:MainThread](2024-03-27 12:12:19,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.017455, valid_loss 1.099364, train_metric nan, valid_metric 0.088472
[2648869:MainThread](2024-03-27 12:12:19,309) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:12:19,984) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:12:20,686) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  84%|████████▍ | 37/44 [19:42<03:26, 29.57s/it][2648869:MainThread](2024-03-27 12:12:20,693) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:12:20,704) INFO - qlib.workflow - [recorder.py:341] - Recorder 46444994d8214b15b83c2ed2f7de4f2b starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:12:21,328) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:12:21,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:12:21,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:12:21,333) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:12:23,116) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.705046
            SH600004      0.705046
            SH600006      0.705046
            SH600007      0.705046
            SH600008      0.705046
                            ...   
2018-03-05  SZ300124      0.986229
            SZ300136      0.986229
            SZ300144      0.986229
            SZ300251      0.986229
            SZ300315      0.986229
Length: 621305, dtype: float64
[2648869:MainThread](2024-03-27 12:12:24,050) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2018-03-06  SH600000      0.986229
            SH600008      0.986229
            SH600009      0.986229
            SH600010      0.986229
            SH600011      0.986229
                            ...   
2019-12-16  SZ300347      0.642595
            SZ300408      0.642595
            SZ300413      0.642595
            SZ300433      0.642595
            SZ300498      0.642595
Length: 119625, dtype: float64
[2648869:MainThread](2024-03-27 12:12:24,142) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:12:24,630) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.376817, valid_loss 1.132674, train_metric nan, valid_metric 0.009695
[2648869:MainThread](2024-03-27 12:12:24,631) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.132674, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:12:24,830) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.167422, valid_loss 1.113695, train_metric nan, valid_metric 0.014443
[2648869:MainThread](2024-03-27 12:12:24,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.132674 to 1.113695, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:25,066) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.191081, valid_loss 1.120336, train_metric nan, valid_metric 0.010176
[2648869:MainThread](2024-03-27 12:12:25,304) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.171067, valid_loss 1.116909, train_metric nan, valid_metric 0.033016
[2648869:MainThread](2024-03-27 12:12:25,510) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.181126, valid_loss 1.136367, train_metric nan, valid_metric 0.036995
[2648869:MainThread](2024-03-27 12:12:25,718) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.123420, valid_loss 1.109510, train_metric nan, valid_metric 0.034140
[2648869:MainThread](2024-03-27 12:12:25,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.113695 to 1.109510, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:25,928) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.108402, valid_loss 1.108852, train_metric nan, valid_metric 0.039976
[2648869:MainThread](2024-03-27 12:12:25,928) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.109510 to 1.108852, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:26,134) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.128871, valid_loss 1.107639, train_metric nan, valid_metric 0.052061
[2648869:MainThread](2024-03-27 12:12:26,134) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.108852 to 1.107639, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:26,380) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.091966, valid_loss 1.108817, train_metric nan, valid_metric 0.052564
[2648869:MainThread](2024-03-27 12:12:26,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.097271, valid_loss 1.107879, train_metric nan, valid_metric 0.050340
[2648869:MainThread](2024-03-27 12:12:26,873) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.089097, valid_loss 1.107356, train_metric nan, valid_metric 0.048887
[2648869:MainThread](2024-03-27 12:12:26,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.107639 to 1.107356, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:27,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.108088, valid_loss 1.107198, train_metric nan, valid_metric 0.046969
[2648869:MainThread](2024-03-27 12:12:27,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.107356 to 1.107198, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:27,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.083372, valid_loss 1.106868, train_metric nan, valid_metric 0.056992
[2648869:MainThread](2024-03-27 12:12:27,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.107198 to 1.106868, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:27,581) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.083291, valid_loss 1.108642, train_metric nan, valid_metric 0.047497
[2648869:MainThread](2024-03-27 12:12:27,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.070550, valid_loss 1.109054, train_metric nan, valid_metric 0.039677
[2648869:MainThread](2024-03-27 12:12:27,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.064874, valid_loss 1.107817, train_metric nan, valid_metric 0.054253
[2648869:MainThread](2024-03-27 12:12:28,188) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.088278, valid_loss 1.108867, train_metric nan, valid_metric 0.044568
[2648869:MainThread](2024-03-27 12:12:28,396) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.100494, valid_loss 1.126940, train_metric nan, valid_metric 0.036608
[2648869:MainThread](2024-03-27 12:12:28,599) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.079224, valid_loss 1.107387, train_metric nan, valid_metric 0.056384
[2648869:MainThread](2024-03-27 12:12:28,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.061864, valid_loss 1.106794, train_metric nan, valid_metric 0.053936
[2648869:MainThread](2024-03-27 12:12:28,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.106868 to 1.106794, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:29,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.065382, valid_loss 1.108792, train_metric nan, valid_metric 0.052405
[2648869:MainThread](2024-03-27 12:12:29,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.062906, valid_loss 1.106734, train_metric nan, valid_metric 0.054076
[2648869:MainThread](2024-03-27 12:12:29,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.106794 to 1.106734, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:29,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.052075, valid_loss 1.106800, train_metric nan, valid_metric 0.059626
[2648869:MainThread](2024-03-27 12:12:29,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.061381, valid_loss 1.106322, train_metric nan, valid_metric 0.059872
[2648869:MainThread](2024-03-27 12:12:29,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.106734 to 1.106322, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:29,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.077023, valid_loss 1.106654, train_metric nan, valid_metric 0.054725
[2648869:MainThread](2024-03-27 12:12:30,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.077582, valid_loss 1.109837, train_metric nan, valid_metric 0.059507
[2648869:MainThread](2024-03-27 12:12:30,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.057270, valid_loss 1.106483, train_metric nan, valid_metric 0.061360
[2648869:MainThread](2024-03-27 12:12:30,579) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.076819, valid_loss 1.107609, train_metric nan, valid_metric 0.058807
[2648869:MainThread](2024-03-27 12:12:30,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.060300, valid_loss 1.107237, train_metric nan, valid_metric 0.053973
[2648869:MainThread](2024-03-27 12:12:30,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.061339, valid_loss 1.106951, train_metric nan, valid_metric 0.058888
[2648869:MainThread](2024-03-27 12:12:31,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.076936, valid_loss 1.108716, train_metric nan, valid_metric 0.059374
[2648869:MainThread](2024-03-27 12:12:31,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.059260, valid_loss 1.107304, train_metric nan, valid_metric 0.057228
[2648869:MainThread](2024-03-27 12:12:31,612) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.051673, valid_loss 1.106893, train_metric nan, valid_metric 0.061534
[2648869:MainThread](2024-03-27 12:12:31,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.056961, valid_loss 1.107334, train_metric nan, valid_metric 0.052117
[2648869:MainThread](2024-03-27 12:12:32,018) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.061859, valid_loss 1.107478, train_metric nan, valid_metric 0.056673
[2648869:MainThread](2024-03-27 12:12:32,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.058289, valid_loss 1.106709, train_metric nan, valid_metric 0.061170
[2648869:MainThread](2024-03-27 12:12:32,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.044030, valid_loss 1.105748, train_metric nan, valid_metric 0.060978
[2648869:MainThread](2024-03-27 12:12:32,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.106322 to 1.105748, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:32,747) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.048322, valid_loss 1.106463, train_metric nan, valid_metric 0.061568
[2648869:MainThread](2024-03-27 12:12:33,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.063492, valid_loss 1.106950, train_metric nan, valid_metric 0.056719
[2648869:MainThread](2024-03-27 12:12:33,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.056885, valid_loss 1.106609, train_metric nan, valid_metric 0.057244
[2648869:MainThread](2024-03-27 12:12:33,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.039781, valid_loss 1.106307, train_metric nan, valid_metric 0.060860
[2648869:MainThread](2024-03-27 12:12:33,757) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.051170, valid_loss 1.106778, train_metric nan, valid_metric 0.058583
[2648869:MainThread](2024-03-27 12:12:34,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.041441, valid_loss 1.106054, train_metric nan, valid_metric 0.059969
[2648869:MainThread](2024-03-27 12:12:34,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.056876, valid_loss 1.106058, train_metric nan, valid_metric 0.059918
[2648869:MainThread](2024-03-27 12:12:34,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.054088, valid_loss 1.106637, train_metric nan, valid_metric 0.057456
[2648869:MainThread](2024-03-27 12:12:34,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.055423, valid_loss 1.106319, train_metric nan, valid_metric 0.060233
[2648869:MainThread](2024-03-27 12:12:34,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.048354, valid_loss 1.106102, train_metric nan, valid_metric 0.061900
[2648869:MainThread](2024-03-27 12:12:35,127) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.059677, valid_loss 1.106277, train_metric nan, valid_metric 0.062140
[2648869:MainThread](2024-03-27 12:12:35,378) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.052930, valid_loss 1.106306, train_metric nan, valid_metric 0.061368
[2648869:MainThread](2024-03-27 12:12:35,628) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.038627, valid_loss 1.106050, train_metric nan, valid_metric 0.062023
[2648869:MainThread](2024-03-27 12:12:35,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.032746, valid_loss 1.106323, train_metric nan, valid_metric 0.061776
[2648869:MainThread](2024-03-27 12:12:36,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.047331, valid_loss 1.105928, train_metric nan, valid_metric 0.062646
[2648869:MainThread](2024-03-27 12:12:36,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.046713, valid_loss 1.105918, train_metric nan, valid_metric 0.062973
[2648869:MainThread](2024-03-27 12:12:36,552) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.058271, valid_loss 1.106086, train_metric nan, valid_metric 0.062192
[2648869:MainThread](2024-03-27 12:12:36,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.049546, valid_loss 1.106007, train_metric nan, valid_metric 0.061742
[2648869:MainThread](2024-03-27 12:12:36,963) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.044902, valid_loss 1.106425, train_metric nan, valid_metric 0.060547
[2648869:MainThread](2024-03-27 12:12:37,167) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.044558, valid_loss 1.106376, train_metric nan, valid_metric 0.062259
[2648869:MainThread](2024-03-27 12:12:37,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.053963, valid_loss 1.106388, train_metric nan, valid_metric 0.059959
[2648869:MainThread](2024-03-27 12:12:37,577) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.055918, valid_loss 1.106714, train_metric nan, valid_metric 0.059319
[2648869:MainThread](2024-03-27 12:12:37,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.047131, valid_loss 1.106181, train_metric nan, valid_metric 0.062025
[2648869:MainThread](2024-03-27 12:12:38,029) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.041231, valid_loss 1.105978, train_metric nan, valid_metric 0.060632
[2648869:MainThread](2024-03-27 12:12:38,237) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.044258, valid_loss 1.106093, train_metric nan, valid_metric 0.060009
[2648869:MainThread](2024-03-27 12:12:38,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.050057, valid_loss 1.106499, train_metric nan, valid_metric 0.059797
[2648869:MainThread](2024-03-27 12:12:38,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.046522, valid_loss 1.105855, train_metric nan, valid_metric 0.061375
[2648869:MainThread](2024-03-27 12:12:38,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.050827, valid_loss 1.106395, train_metric nan, valid_metric 0.060038
[2648869:MainThread](2024-03-27 12:12:39,154) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.061027, valid_loss 1.105943, train_metric nan, valid_metric 0.061213
[2648869:MainThread](2024-03-27 12:12:39,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.047812, valid_loss 1.105862, train_metric nan, valid_metric 0.060765
[2648869:MainThread](2024-03-27 12:12:39,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.035091, valid_loss 1.106047, train_metric nan, valid_metric 0.060597
[2648869:MainThread](2024-03-27 12:12:39,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.049005, valid_loss 1.106233, train_metric nan, valid_metric 0.061013
[2648869:MainThread](2024-03-27 12:12:40,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.045504, valid_loss 1.106211, train_metric nan, valid_metric 0.059322
[2648869:MainThread](2024-03-27 12:12:40,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.035286, valid_loss 1.106055, train_metric nan, valid_metric 0.060551
[2648869:MainThread](2024-03-27 12:12:40,438) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.038244, valid_loss 1.106107, train_metric nan, valid_metric 0.060621
[2648869:MainThread](2024-03-27 12:12:40,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.054796, valid_loss 1.106007, train_metric nan, valid_metric 0.062835
[2648869:MainThread](2024-03-27 12:12:40,928) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.046251, valid_loss 1.106048, train_metric nan, valid_metric 0.061660
[2648869:MainThread](2024-03-27 12:12:41,179) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.040702, valid_loss 1.106138, train_metric nan, valid_metric 0.064073
[2648869:MainThread](2024-03-27 12:12:41,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.047529, valid_loss 1.106030, train_metric nan, valid_metric 0.062237
[2648869:MainThread](2024-03-27 12:12:41,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.052805, valid_loss 1.106177, train_metric nan, valid_metric 0.060907
[2648869:MainThread](2024-03-27 12:12:41,935) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.042637, valid_loss 1.106286, train_metric nan, valid_metric 0.062850
[2648869:MainThread](2024-03-27 12:12:42,188) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.045441, valid_loss 1.106074, train_metric nan, valid_metric 0.061155
[2648869:MainThread](2024-03-27 12:12:42,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.034996, valid_loss 1.105801, train_metric nan, valid_metric 0.062935
[2648869:MainThread](2024-03-27 12:12:42,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.039626, valid_loss 1.105841, train_metric nan, valid_metric 0.062204
[2648869:MainThread](2024-03-27 12:12:42,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.041368, valid_loss 1.106029, train_metric nan, valid_metric 0.063792
[2648869:MainThread](2024-03-27 12:12:43,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.051171, valid_loss 1.105857, train_metric nan, valid_metric 0.063665
[2648869:MainThread](2024-03-27 12:12:43,403) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.047545, valid_loss 1.105903, train_metric nan, valid_metric 0.062343
[2648869:MainThread](2024-03-27 12:12:43,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.041601, valid_loss 1.106236, train_metric nan, valid_metric 0.060815
[2648869:MainThread](2024-03-27 12:12:43,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.040651, valid_loss 1.106102, train_metric nan, valid_metric 0.060748
[2648869:MainThread](2024-03-27 12:12:44,158) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.045819, valid_loss 1.106143, train_metric nan, valid_metric 0.060861
[2648869:MainThread](2024-03-27 12:12:44,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:12:44,696) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:12:45,273) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  86%|████████▋ | 38/44 [20:07<02:48, 28.07s/it][2648869:MainThread](2024-03-27 12:12:45,280) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:12:45,291) INFO - qlib.workflow - [recorder.py:341] - Recorder ce9fdb8a083446cfa57b4b6738391442 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:12:45,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:12:45,912) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:12:45,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:12:45,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:12:47,695) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.310623
            SH600004      1.310623
            SH600006      1.310623
            SH600007      1.310623
            SH600008      1.310623
                            ...   
2018-04-02  SZ300124      1.008397
            SZ300136      1.008397
            SZ300144      1.008397
            SZ300251      1.008397
            SZ300315      1.008397
Length: 626776, dtype: float64
[2648869:MainThread](2024-03-27 12:12:48,644) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2018-04-03  SH600000      1.008397
            SH600008      1.008397
            SH600009      1.008397
            SH600010      1.008397
            SH600011      1.008397
                            ...   
2020-01-14  SZ300347      0.614810
            SZ300408      0.614810
            SZ300413      0.614810
            SZ300433      0.614810
            SZ300498      0.614810
Length: 120092, dtype: float64
[2648869:MainThread](2024-03-27 12:12:48,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:12:49,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.479186, valid_loss 1.110910, train_metric nan, valid_metric -0.017325
[2648869:MainThread](2024-03-27 12:12:49,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.110910, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:12:49,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.174251, valid_loss 1.103261, train_metric nan, valid_metric 0.043214
[2648869:MainThread](2024-03-27 12:12:49,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.110910 to 1.103261, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:49,633) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.150489, valid_loss 1.091017, train_metric nan, valid_metric 0.045066
[2648869:MainThread](2024-03-27 12:12:49,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.103261 to 1.091017, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:49,832) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.165955, valid_loss 1.088486, train_metric nan, valid_metric 0.048567
[2648869:MainThread](2024-03-27 12:12:49,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.091017 to 1.088486, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:50,030) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.146583, valid_loss 1.092629, train_metric nan, valid_metric 0.052929
[2648869:MainThread](2024-03-27 12:12:50,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.185966, valid_loss 1.089979, train_metric nan, valid_metric 0.048261
[2648869:MainThread](2024-03-27 12:12:50,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.142253, valid_loss 1.094149, train_metric nan, valid_metric 0.044538
[2648869:MainThread](2024-03-27 12:12:50,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.111063, valid_loss 1.096051, train_metric nan, valid_metric 0.045586
[2648869:MainThread](2024-03-27 12:12:50,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.093559, valid_loss 1.093018, train_metric nan, valid_metric 0.041842
[2648869:MainThread](2024-03-27 12:12:51,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.105234, valid_loss 1.091313, train_metric nan, valid_metric 0.028878
[2648869:MainThread](2024-03-27 12:12:51,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.107735, valid_loss 1.088272, train_metric nan, valid_metric 0.044645
[2648869:MainThread](2024-03-27 12:12:51,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.088486 to 1.088272, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:51,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.112204, valid_loss 1.087100, train_metric nan, valid_metric 0.046315
[2648869:MainThread](2024-03-27 12:12:51,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.088272 to 1.087100, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:51,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.091104, valid_loss 1.092155, train_metric nan, valid_metric 0.055314
[2648869:MainThread](2024-03-27 12:12:51,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.109510, valid_loss 1.088974, train_metric nan, valid_metric 0.050231
[2648869:MainThread](2024-03-27 12:12:52,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.130788, valid_loss 1.087618, train_metric nan, valid_metric 0.050653
[2648869:MainThread](2024-03-27 12:12:52,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.166013, valid_loss 1.099695, train_metric nan, valid_metric 0.006307
[2648869:MainThread](2024-03-27 12:12:52,486) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.096640, valid_loss 1.089376, train_metric nan, valid_metric 0.047241
[2648869:MainThread](2024-03-27 12:12:52,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.080962, valid_loss 1.087965, train_metric nan, valid_metric 0.041661
[2648869:MainThread](2024-03-27 12:12:52,894) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.082707, valid_loss 1.087414, train_metric nan, valid_metric 0.048984
[2648869:MainThread](2024-03-27 12:12:53,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.078451, valid_loss 1.086800, train_metric nan, valid_metric 0.050321
[2648869:MainThread](2024-03-27 12:12:53,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.087100 to 1.086800, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:53,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.080605, valid_loss 1.086469, train_metric nan, valid_metric 0.050343
[2648869:MainThread](2024-03-27 12:12:53,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.086800 to 1.086469, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:53,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.067788, valid_loss 1.087190, train_metric nan, valid_metric 0.055033
[2648869:MainThread](2024-03-27 12:12:53,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.073234, valid_loss 1.087889, train_metric nan, valid_metric 0.042878
[2648869:MainThread](2024-03-27 12:12:53,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.072402, valid_loss 1.086681, train_metric nan, valid_metric 0.050688
[2648869:MainThread](2024-03-27 12:12:54,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.080132, valid_loss 1.086809, train_metric nan, valid_metric 0.054879
[2648869:MainThread](2024-03-27 12:12:54,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.084367, valid_loss 1.090266, train_metric nan, valid_metric 0.046011
[2648869:MainThread](2024-03-27 12:12:54,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.081634, valid_loss 1.089579, train_metric nan, valid_metric 0.038107
[2648869:MainThread](2024-03-27 12:12:54,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.078320, valid_loss 1.087003, train_metric nan, valid_metric 0.047801
[2648869:MainThread](2024-03-27 12:12:54,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.074980, valid_loss 1.086808, train_metric nan, valid_metric 0.051951
[2648869:MainThread](2024-03-27 12:12:55,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.076715, valid_loss 1.087824, train_metric nan, valid_metric 0.043570
[2648869:MainThread](2024-03-27 12:12:55,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.087914, valid_loss 1.087177, train_metric nan, valid_metric 0.051823
[2648869:MainThread](2024-03-27 12:12:55,568) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.064134, valid_loss 1.087283, train_metric nan, valid_metric 0.050229
[2648869:MainThread](2024-03-27 12:12:55,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.074834, valid_loss 1.086236, train_metric nan, valid_metric 0.061341
[2648869:MainThread](2024-03-27 12:12:55,774) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.086469 to 1.086236, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:55,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.083424, valid_loss 1.086145, train_metric nan, valid_metric 0.056004
[2648869:MainThread](2024-03-27 12:12:55,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.086236 to 1.086145, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:56,184) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.062566, valid_loss 1.086232, train_metric nan, valid_metric 0.056339
[2648869:MainThread](2024-03-27 12:12:56,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.058287, valid_loss 1.086689, train_metric nan, valid_metric 0.053076
[2648869:MainThread](2024-03-27 12:12:56,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.078536, valid_loss 1.086016, train_metric nan, valid_metric 0.054156
[2648869:MainThread](2024-03-27 12:12:56,593) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.086145 to 1.086016, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:56,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.061349, valid_loss 1.086164, train_metric nan, valid_metric 0.054405
[2648869:MainThread](2024-03-27 12:12:56,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.059272, valid_loss 1.086250, train_metric nan, valid_metric 0.055138
[2648869:MainThread](2024-03-27 12:12:57,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.063377, valid_loss 1.086578, train_metric nan, valid_metric 0.051065
[2648869:MainThread](2024-03-27 12:12:57,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.060796, valid_loss 1.085584, train_metric nan, valid_metric 0.059800
[2648869:MainThread](2024-03-27 12:12:57,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.086016 to 1.085584, save checkpoint.
[2648869:MainThread](2024-03-27 12:12:57,608) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.074383, valid_loss 1.087767, train_metric nan, valid_metric 0.050168
[2648869:MainThread](2024-03-27 12:12:57,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.054782, valid_loss 1.086217, train_metric nan, valid_metric 0.054403
[2648869:MainThread](2024-03-27 12:12:58,015) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.059935, valid_loss 1.086258, train_metric nan, valid_metric 0.052265
[2648869:MainThread](2024-03-27 12:12:58,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.066565, valid_loss 1.087388, train_metric nan, valid_metric 0.052858
[2648869:MainThread](2024-03-27 12:12:58,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.068902, valid_loss 1.085916, train_metric nan, valid_metric 0.054843
[2648869:MainThread](2024-03-27 12:12:58,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.062398, valid_loss 1.087442, train_metric nan, valid_metric 0.055299
[2648869:MainThread](2024-03-27 12:12:58,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.056149, valid_loss 1.086455, train_metric nan, valid_metric 0.057137
[2648869:MainThread](2024-03-27 12:12:59,029) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.064163, valid_loss 1.087424, train_metric nan, valid_metric 0.050316
[2648869:MainThread](2024-03-27 12:12:59,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.065180, valid_loss 1.086816, train_metric nan, valid_metric 0.056440
[2648869:MainThread](2024-03-27 12:12:59,434) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.048686, valid_loss 1.087344, train_metric nan, valid_metric 0.047076
[2648869:MainThread](2024-03-27 12:12:59,643) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.051759, valid_loss 1.085876, train_metric nan, valid_metric 0.058758
[2648869:MainThread](2024-03-27 12:12:59,846) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.053484, valid_loss 1.085895, train_metric nan, valid_metric 0.060228
[2648869:MainThread](2024-03-27 12:13:00,047) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.062276, valid_loss 1.085789, train_metric nan, valid_metric 0.055763
[2648869:MainThread](2024-03-27 12:13:00,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.067202, valid_loss 1.086037, train_metric nan, valid_metric 0.055848
[2648869:MainThread](2024-03-27 12:13:00,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.059029, valid_loss 1.086256, train_metric nan, valid_metric 0.054957
[2648869:MainThread](2024-03-27 12:13:00,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.058810, valid_loss 1.086261, train_metric nan, valid_metric 0.053521
[2648869:MainThread](2024-03-27 12:13:00,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.055910, valid_loss 1.086340, train_metric nan, valid_metric 0.054882
[2648869:MainThread](2024-03-27 12:13:01,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.054835, valid_loss 1.086285, train_metric nan, valid_metric 0.054365
[2648869:MainThread](2024-03-27 12:13:01,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.063375, valid_loss 1.086236, train_metric nan, valid_metric 0.052426
[2648869:MainThread](2024-03-27 12:13:01,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.059293, valid_loss 1.086072, train_metric nan, valid_metric 0.057241
[2648869:MainThread](2024-03-27 12:13:01,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.058265, valid_loss 1.086198, train_metric nan, valid_metric 0.052002
[2648869:MainThread](2024-03-27 12:13:01,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.065601, valid_loss 1.086245, train_metric nan, valid_metric 0.054178
[2648869:MainThread](2024-03-27 12:13:02,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.066334, valid_loss 1.086568, train_metric nan, valid_metric 0.051277
[2648869:MainThread](2024-03-27 12:13:02,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.038988, valid_loss 1.085955, train_metric nan, valid_metric 0.053653
[2648869:MainThread](2024-03-27 12:13:02,483) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.048699, valid_loss 1.086080, train_metric nan, valid_metric 0.052135
[2648869:MainThread](2024-03-27 12:13:02,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.061048, valid_loss 1.085952, train_metric nan, valid_metric 0.057636
[2648869:MainThread](2024-03-27 12:13:02,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.053655, valid_loss 1.086059, train_metric nan, valid_metric 0.056645
[2648869:MainThread](2024-03-27 12:13:03,086) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.051536, valid_loss 1.086343, train_metric nan, valid_metric 0.053712
[2648869:MainThread](2024-03-27 12:13:03,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.045058, valid_loss 1.086107, train_metric nan, valid_metric 0.055984
[2648869:MainThread](2024-03-27 12:13:03,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.048606, valid_loss 1.086263, train_metric nan, valid_metric 0.054980
[2648869:MainThread](2024-03-27 12:13:03,691) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.062968, valid_loss 1.085968, train_metric nan, valid_metric 0.057389
[2648869:MainThread](2024-03-27 12:13:03,895) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.054504, valid_loss 1.086465, train_metric nan, valid_metric 0.051450
[2648869:MainThread](2024-03-27 12:13:04,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.058039, valid_loss 1.085990, train_metric nan, valid_metric 0.054769
[2648869:MainThread](2024-03-27 12:13:04,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.058656, valid_loss 1.085807, train_metric nan, valid_metric 0.058012
[2648869:MainThread](2024-03-27 12:13:04,502) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.060140, valid_loss 1.085932, train_metric nan, valid_metric 0.056389
[2648869:MainThread](2024-03-27 12:13:04,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.049380, valid_loss 1.086720, train_metric nan, valid_metric 0.049719
[2648869:MainThread](2024-03-27 12:13:04,910) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.051308, valid_loss 1.086347, train_metric nan, valid_metric 0.051895
[2648869:MainThread](2024-03-27 12:13:05,114) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.049600, valid_loss 1.086111, train_metric nan, valid_metric 0.054850
[2648869:MainThread](2024-03-27 12:13:05,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.053492, valid_loss 1.086187, train_metric nan, valid_metric 0.053134
[2648869:MainThread](2024-03-27 12:13:05,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.056937, valid_loss 1.086198, train_metric nan, valid_metric 0.053406
[2648869:MainThread](2024-03-27 12:13:05,718) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.056223, valid_loss 1.086228, train_metric nan, valid_metric 0.053264
[2648869:MainThread](2024-03-27 12:13:05,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.062264, valid_loss 1.085925, train_metric nan, valid_metric 0.055881
[2648869:MainThread](2024-03-27 12:13:06,129) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.054607, valid_loss 1.085941, train_metric nan, valid_metric 0.056829
[2648869:MainThread](2024-03-27 12:13:06,333) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.071275, valid_loss 1.086052, train_metric nan, valid_metric 0.055413
[2648869:MainThread](2024-03-27 12:13:06,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.053818, valid_loss 1.086226, train_metric nan, valid_metric 0.056388
[2648869:MainThread](2024-03-27 12:13:06,741) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.064481, valid_loss 1.086333, train_metric nan, valid_metric 0.052942
[2648869:MainThread](2024-03-27 12:13:06,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.059232, valid_loss 1.086054, train_metric nan, valid_metric 0.054895
[2648869:MainThread](2024-03-27 12:13:07,148) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.059682, valid_loss 1.086154, train_metric nan, valid_metric 0.054750
[2648869:MainThread](2024-03-27 12:13:07,350) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.056059, valid_loss 1.086126, train_metric nan, valid_metric 0.055002
[2648869:MainThread](2024-03-27 12:13:07,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.050807, valid_loss 1.086043, train_metric nan, valid_metric 0.055141
[2648869:MainThread](2024-03-27 12:13:07,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:13:08,211) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:13:08,893) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  89%|████████▊ | 39/44 [20:30<02:13, 26.74s/it][2648869:MainThread](2024-03-27 12:13:08,900) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:13:08,911) INFO - qlib.workflow - [recorder.py:341] - Recorder bfc2c0ffe8ca4a298ff89e255b5a1249 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:13:09,536) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:13:09,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:13:09,541) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:13:09,541) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:13:11,291) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.627597
            SH600004      1.627597
            SH600006      1.627597
            SH600007      1.627597
            SH600008      1.627597
                            ...   
2018-05-04  SZ300124      0.995084
            SZ300136      0.995084
            SZ300144      0.995084
            SZ300251      0.995084
            SZ300315      0.995084
Length: 632238, dtype: float64
[2648869:MainThread](2024-03-27 12:13:12,213) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2018-05-07  SH600000      0.995084
            SH600008      0.995084
            SH600009      0.995084
            SH600011      0.995084
            SH600015      0.995084
                            ...   
2020-02-19  SZ300347      0.583824
            SZ300408      0.583824
            SZ300413      0.583824
            SZ300433      0.583824
            SZ300498      0.583824
Length: 120584, dtype: float64
[2648869:MainThread](2024-03-27 12:13:12,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:13:12,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.451994, valid_loss 1.076157, train_metric nan, valid_metric 0.016557
[2648869:MainThread](2024-03-27 12:13:12,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.076157, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:13:13,098) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.169893, valid_loss 1.079940, train_metric nan, valid_metric 0.040199
[2648869:MainThread](2024-03-27 12:13:13,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.156606, valid_loss 1.075137, train_metric nan, valid_metric 0.037004
[2648869:MainThread](2024-03-27 12:13:13,346) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.076157 to 1.075137, save checkpoint.
[2648869:MainThread](2024-03-27 12:13:13,581) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.201084, valid_loss 1.075953, train_metric nan, valid_metric 0.039718
[2648869:MainThread](2024-03-27 12:13:13,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.134064, valid_loss 1.067170, train_metric nan, valid_metric 0.047884
[2648869:MainThread](2024-03-27 12:13:13,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.075137 to 1.067170, save checkpoint.
[2648869:MainThread](2024-03-27 12:13:14,064) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.108254, valid_loss 1.069085, train_metric nan, valid_metric 0.034062
[2648869:MainThread](2024-03-27 12:13:14,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.109246, valid_loss 1.075224, train_metric nan, valid_metric 0.045672
[2648869:MainThread](2024-03-27 12:13:14,470) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.078978, valid_loss 1.067919, train_metric nan, valid_metric 0.043282
[2648869:MainThread](2024-03-27 12:13:14,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.084629, valid_loss 1.067945, train_metric nan, valid_metric 0.042965
[2648869:MainThread](2024-03-27 12:13:14,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.084649, valid_loss 1.069578, train_metric nan, valid_metric 0.039137
[2648869:MainThread](2024-03-27 12:13:15,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.082056, valid_loss 1.068403, train_metric nan, valid_metric 0.048703
[2648869:MainThread](2024-03-27 12:13:15,260) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.092061, valid_loss 1.069271, train_metric nan, valid_metric 0.042225
[2648869:MainThread](2024-03-27 12:13:15,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.059171, valid_loss 1.066977, train_metric nan, valid_metric 0.051453
[2648869:MainThread](2024-03-27 12:13:15,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.067170 to 1.066977, save checkpoint.
[2648869:MainThread](2024-03-27 12:13:15,707) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.119842, valid_loss 1.065978, train_metric nan, valid_metric 0.049933
[2648869:MainThread](2024-03-27 12:13:15,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.066977 to 1.065978, save checkpoint.
[2648869:MainThread](2024-03-27 12:13:15,957) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.067262, valid_loss 1.066294, train_metric nan, valid_metric 0.051054
[2648869:MainThread](2024-03-27 12:13:16,204) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.096471, valid_loss 1.068653, train_metric nan, valid_metric 0.046446
[2648869:MainThread](2024-03-27 12:13:16,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.073781, valid_loss 1.068030, train_metric nan, valid_metric 0.042435
[2648869:MainThread](2024-03-27 12:13:16,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.053891, valid_loss 1.068309, train_metric nan, valid_metric 0.049985
[2648869:MainThread](2024-03-27 12:13:16,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.052153, valid_loss 1.065501, train_metric nan, valid_metric 0.057305
[2648869:MainThread](2024-03-27 12:13:16,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.065978 to 1.065501, save checkpoint.
[2648869:MainThread](2024-03-27 12:13:17,195) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.048900, valid_loss 1.067003, train_metric nan, valid_metric 0.043168
[2648869:MainThread](2024-03-27 12:13:17,442) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.068784, valid_loss 1.067475, train_metric nan, valid_metric 0.047082
[2648869:MainThread](2024-03-27 12:13:17,690) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.031141, valid_loss 1.067749, train_metric nan, valid_metric 0.053505
[2648869:MainThread](2024-03-27 12:13:17,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.067354, valid_loss 1.070682, train_metric nan, valid_metric 0.050785
[2648869:MainThread](2024-03-27 12:13:18,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.032741, valid_loss 1.064752, train_metric nan, valid_metric 0.057431
[2648869:MainThread](2024-03-27 12:13:18,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.065501 to 1.064752, save checkpoint.
[2648869:MainThread](2024-03-27 12:13:18,403) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.069055, valid_loss 1.065575, train_metric nan, valid_metric 0.049615
[2648869:MainThread](2024-03-27 12:13:18,602) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.038980, valid_loss 1.065323, train_metric nan, valid_metric 0.051802
[2648869:MainThread](2024-03-27 12:13:18,835) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.048938, valid_loss 1.067724, train_metric nan, valid_metric 0.049311
[2648869:MainThread](2024-03-27 12:13:19,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.063124, valid_loss 1.065351, train_metric nan, valid_metric 0.052486
[2648869:MainThread](2024-03-27 12:13:19,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.046782, valid_loss 1.067073, train_metric nan, valid_metric 0.051855
[2648869:MainThread](2024-03-27 12:13:19,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.056794, valid_loss 1.066035, train_metric nan, valid_metric 0.049492
[2648869:MainThread](2024-03-27 12:13:19,646) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.036809, valid_loss 1.068215, train_metric nan, valid_metric 0.050190
[2648869:MainThread](2024-03-27 12:13:19,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.053511, valid_loss 1.065680, train_metric nan, valid_metric 0.050530
[2648869:MainThread](2024-03-27 12:13:20,050) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.033358, valid_loss 1.065776, train_metric nan, valid_metric 0.054785
[2648869:MainThread](2024-03-27 12:13:20,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.034901, valid_loss 1.065491, train_metric nan, valid_metric 0.052219
[2648869:MainThread](2024-03-27 12:13:20,440) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.045115, valid_loss 1.066273, train_metric nan, valid_metric 0.051146
[2648869:MainThread](2024-03-27 12:13:20,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.055321, valid_loss 1.066331, train_metric nan, valid_metric 0.048134
[2648869:MainThread](2024-03-27 12:13:20,830) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.040701, valid_loss 1.066224, train_metric nan, valid_metric 0.048863
[2648869:MainThread](2024-03-27 12:13:21,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.062625, valid_loss 1.066694, train_metric nan, valid_metric 0.050126
[2648869:MainThread](2024-03-27 12:13:21,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.033285, valid_loss 1.064995, train_metric nan, valid_metric 0.053424
[2648869:MainThread](2024-03-27 12:13:21,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.034598, valid_loss 1.065819, train_metric nan, valid_metric 0.049952
[2648869:MainThread](2024-03-27 12:13:21,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.033745, valid_loss 1.065604, train_metric nan, valid_metric 0.051818
[2648869:MainThread](2024-03-27 12:13:21,813) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.024226, valid_loss 1.065147, train_metric nan, valid_metric 0.051843
[2648869:MainThread](2024-03-27 12:13:22,008) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.025078, valid_loss 1.064957, train_metric nan, valid_metric 0.053588
[2648869:MainThread](2024-03-27 12:13:22,203) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.040451, valid_loss 1.065087, train_metric nan, valid_metric 0.054725
[2648869:MainThread](2024-03-27 12:13:22,410) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.029816, valid_loss 1.064999, train_metric nan, valid_metric 0.055963
[2648869:MainThread](2024-03-27 12:13:22,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.023110, valid_loss 1.065180, train_metric nan, valid_metric 0.053269
[2648869:MainThread](2024-03-27 12:13:22,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.021413, valid_loss 1.064788, train_metric nan, valid_metric 0.055736
[2648869:MainThread](2024-03-27 12:13:23,028) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.018958, valid_loss 1.065029, train_metric nan, valid_metric 0.054408
[2648869:MainThread](2024-03-27 12:13:23,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.025413, valid_loss 1.064875, train_metric nan, valid_metric 0.058190
[2648869:MainThread](2024-03-27 12:13:23,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.006437, valid_loss 1.065381, train_metric nan, valid_metric 0.051180
[2648869:MainThread](2024-03-27 12:13:23,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.027590, valid_loss 1.064871, train_metric nan, valid_metric 0.055588
[2648869:MainThread](2024-03-27 12:13:23,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.028993, valid_loss 1.064453, train_metric nan, valid_metric 0.058469
[2648869:MainThread](2024-03-27 12:13:23,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.064752 to 1.064453, save checkpoint.
[2648869:MainThread](2024-03-27 12:13:24,043) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.027472, valid_loss 1.065302, train_metric nan, valid_metric 0.055291
[2648869:MainThread](2024-03-27 12:13:24,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.031499, valid_loss 1.065313, train_metric nan, valid_metric 0.053062
[2648869:MainThread](2024-03-27 12:13:24,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.031891, valid_loss 1.065254, train_metric nan, valid_metric 0.053237
[2648869:MainThread](2024-03-27 12:13:24,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.026341, valid_loss 1.065306, train_metric nan, valid_metric 0.055300
[2648869:MainThread](2024-03-27 12:13:24,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.013886, valid_loss 1.065227, train_metric nan, valid_metric 0.054133
[2648869:MainThread](2024-03-27 12:13:25,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.026211, valid_loss 1.065012, train_metric nan, valid_metric 0.054760
[2648869:MainThread](2024-03-27 12:13:25,278) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.025036, valid_loss 1.065172, train_metric nan, valid_metric 0.053007
[2648869:MainThread](2024-03-27 12:13:25,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.029919, valid_loss 1.064650, train_metric nan, valid_metric 0.056936
[2648869:MainThread](2024-03-27 12:13:25,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.017009, valid_loss 1.064652, train_metric nan, valid_metric 0.058203
[2648869:MainThread](2024-03-27 12:13:25,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.008103, valid_loss 1.065112, train_metric nan, valid_metric 0.053554
[2648869:MainThread](2024-03-27 12:13:26,089) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.022357, valid_loss 1.065122, train_metric nan, valid_metric 0.056077
[2648869:MainThread](2024-03-27 12:13:26,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.008880, valid_loss 1.064979, train_metric nan, valid_metric 0.054460
[2648869:MainThread](2024-03-27 12:13:26,494) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.013122, valid_loss 1.064829, train_metric nan, valid_metric 0.055726
[2648869:MainThread](2024-03-27 12:13:26,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.013586, valid_loss 1.064791, train_metric nan, valid_metric 0.055624
[2648869:MainThread](2024-03-27 12:13:26,897) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.024313, valid_loss 1.064729, train_metric nan, valid_metric 0.056589
[2648869:MainThread](2024-03-27 12:13:27,099) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.048214, valid_loss 1.064861, train_metric nan, valid_metric 0.054789
[2648869:MainThread](2024-03-27 12:13:27,300) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.020580, valid_loss 1.065096, train_metric nan, valid_metric 0.053320
[2648869:MainThread](2024-03-27 12:13:27,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.031379, valid_loss 1.065046, train_metric nan, valid_metric 0.054930
[2648869:MainThread](2024-03-27 12:13:27,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.018411, valid_loss 1.065030, train_metric nan, valid_metric 0.055089
[2648869:MainThread](2024-03-27 12:13:27,912) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.013686, valid_loss 1.065547, train_metric nan, valid_metric 0.053563
[2648869:MainThread](2024-03-27 12:13:28,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.023583, valid_loss 1.064991, train_metric nan, valid_metric 0.054973
[2648869:MainThread](2024-03-27 12:13:28,321) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.011824, valid_loss 1.065177, train_metric nan, valid_metric 0.054954
[2648869:MainThread](2024-03-27 12:13:28,524) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.012198, valid_loss 1.065133, train_metric nan, valid_metric 0.054792
[2648869:MainThread](2024-03-27 12:13:28,726) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.021727, valid_loss 1.064896, train_metric nan, valid_metric 0.055178
[2648869:MainThread](2024-03-27 12:13:28,928) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.024076, valid_loss 1.064702, train_metric nan, valid_metric 0.056250
[2648869:MainThread](2024-03-27 12:13:29,141) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.021650, valid_loss 1.064935, train_metric nan, valid_metric 0.054869
[2648869:MainThread](2024-03-27 12:13:29,344) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.014393, valid_loss 1.065215, train_metric nan, valid_metric 0.052969
[2648869:MainThread](2024-03-27 12:13:29,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.022459, valid_loss 1.065048, train_metric nan, valid_metric 0.053681
[2648869:MainThread](2024-03-27 12:13:29,747) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.024419, valid_loss 1.065103, train_metric nan, valid_metric 0.053300
[2648869:MainThread](2024-03-27 12:13:29,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.008719, valid_loss 1.064990, train_metric nan, valid_metric 0.055412
[2648869:MainThread](2024-03-27 12:13:30,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.020065, valid_loss 1.064974, train_metric nan, valid_metric 0.053761
[2648869:MainThread](2024-03-27 12:13:30,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.012339, valid_loss 1.065322, train_metric nan, valid_metric 0.054778
[2648869:MainThread](2024-03-27 12:13:30,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.045286, valid_loss 1.064757, train_metric nan, valid_metric 0.058145
[2648869:MainThread](2024-03-27 12:13:30,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.012131, valid_loss 1.064937, train_metric nan, valid_metric 0.056339
[2648869:MainThread](2024-03-27 12:13:30,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.024145, valid_loss 1.065072, train_metric nan, valid_metric 0.053216
[2648869:MainThread](2024-03-27 12:13:31,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.019999, valid_loss 1.064891, train_metric nan, valid_metric 0.055101
[2648869:MainThread](2024-03-27 12:13:31,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.012742, valid_loss 1.065583, train_metric nan, valid_metric 0.052822
[2648869:MainThread](2024-03-27 12:13:31,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.015776, valid_loss 1.064998, train_metric nan, valid_metric 0.055052
[2648869:MainThread](2024-03-27 12:13:31,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.013641, valid_loss 1.064856, train_metric nan, valid_metric 0.055261
[2648869:MainThread](2024-03-27 12:13:31,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.022182, valid_loss 1.064889, train_metric nan, valid_metric 0.055617
[2648869:MainThread](2024-03-27 12:13:32,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.015727, valid_loss 1.064828, train_metric nan, valid_metric 0.056402
[2648869:MainThread](2024-03-27 12:13:32,380) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.023933, valid_loss 1.065255, train_metric nan, valid_metric 0.054089
[2648869:MainThread](2024-03-27 12:13:32,580) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.021541, valid_loss 1.064962, train_metric nan, valid_metric 0.054810
[2648869:MainThread](2024-03-27 12:13:32,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.019519, valid_loss 1.065020, train_metric nan, valid_metric 0.056232
[2648869:MainThread](2024-03-27 12:13:32,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.011198, valid_loss 1.064883, train_metric nan, valid_metric 0.055035
[2648869:MainThread](2024-03-27 12:13:33,184) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.010026, valid_loss 1.065258, train_metric nan, valid_metric 0.052737
[2648869:MainThread](2024-03-27 12:13:33,390) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.020977, valid_loss 1.065288, train_metric nan, valid_metric 0.053667
[2648869:MainThread](2024-03-27 12:13:33,594) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.026477, valid_loss 1.065115, train_metric nan, valid_metric 0.053095
[2648869:MainThread](2024-03-27 12:13:33,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.018213, valid_loss 1.065106, train_metric nan, valid_metric 0.054112
[2648869:MainThread](2024-03-27 12:13:34,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.023631, valid_loss 1.065326, train_metric nan, valid_metric 0.052020
[2648869:MainThread](2024-03-27 12:13:34,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:13:34,535) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:13:35,106) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  91%|█████████ | 40/44 [20:57<01:46, 26.58s/it][2648869:MainThread](2024-03-27 12:13:35,113) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:13:35,124) INFO - qlib.workflow - [recorder.py:341] - Recorder c62b4bded4794b3ea3e880e5cc604473 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:13:35,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:13:35,750) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:13:35,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:13:35,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:13:37,514) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.848297
            SH600004      1.848297
            SH600006      1.848297
            SH600007      1.848297
            SH600008      1.848297
                            ...   
2018-06-01  SZ300124      1.463936
            SZ300136      1.463936
            SZ300144      1.463936
            SZ300251      1.463936
            SZ300315      1.463936
Length: 637602, dtype: float64
[2648869:MainThread](2024-03-27 12:13:38,453) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2018-06-04  SH600000      1.463936
            SH600008      1.463936
            SH600009      1.463936
            SH600011      1.463936
            SH600015      1.463936
                            ...   
2020-03-18  SZ300347      0.615301
            SZ300408      0.615301
            SZ300413      0.615301
            SZ300433      0.615301
            SZ300498      0.615301
Length: 121158, dtype: float64
[2648869:MainThread](2024-03-27 12:13:38,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:13:39,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.899941, valid_loss 1.176126, train_metric nan, valid_metric 0.025482
[2648869:MainThread](2024-03-27 12:13:39,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.176126, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:13:39,229) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.316721, valid_loss 1.201156, train_metric nan, valid_metric 0.036377
[2648869:MainThread](2024-03-27 12:13:39,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.210425, valid_loss 1.160537, train_metric nan, valid_metric 0.029148
[2648869:MainThread](2024-03-27 12:13:39,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.176126 to 1.160537, save checkpoint.
[2648869:MainThread](2024-03-27 12:13:39,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.183909, valid_loss 1.151528, train_metric nan, valid_metric 0.036242
[2648869:MainThread](2024-03-27 12:13:39,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.160537 to 1.151528, save checkpoint.
[2648869:MainThread](2024-03-27 12:13:39,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.119448, valid_loss 1.153980, train_metric nan, valid_metric 0.034635
[2648869:MainThread](2024-03-27 12:13:40,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.134571, valid_loss 1.152956, train_metric nan, valid_metric 0.033735
[2648869:MainThread](2024-03-27 12:13:40,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.102020, valid_loss 1.167657, train_metric nan, valid_metric 0.025446
[2648869:MainThread](2024-03-27 12:13:40,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.129228, valid_loss 1.152525, train_metric nan, valid_metric 0.037018
[2648869:MainThread](2024-03-27 12:13:40,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.138300, valid_loss 1.160379, train_metric nan, valid_metric 0.025634
[2648869:MainThread](2024-03-27 12:13:40,887) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.140327, valid_loss 1.153100, train_metric nan, valid_metric 0.036370
[2648869:MainThread](2024-03-27 12:13:41,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.105250, valid_loss 1.156183, train_metric nan, valid_metric 0.039043
[2648869:MainThread](2024-03-27 12:13:41,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.083239, valid_loss 1.156904, train_metric nan, valid_metric 0.046137
[2648869:MainThread](2024-03-27 12:13:41,486) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.137248, valid_loss 1.151786, train_metric nan, valid_metric 0.039571
[2648869:MainThread](2024-03-27 12:13:41,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.114071, valid_loss 1.148694, train_metric nan, valid_metric 0.056409
[2648869:MainThread](2024-03-27 12:13:41,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.151528 to 1.148694, save checkpoint.
[2648869:MainThread](2024-03-27 12:13:41,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.137634, valid_loss 1.148057, train_metric nan, valid_metric 0.052546
[2648869:MainThread](2024-03-27 12:13:41,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.148694 to 1.148057, save checkpoint.
[2648869:MainThread](2024-03-27 12:13:42,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.077620, valid_loss 1.150056, train_metric nan, valid_metric 0.049961
[2648869:MainThread](2024-03-27 12:13:42,321) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.075614, valid_loss 1.150337, train_metric nan, valid_metric 0.049934
[2648869:MainThread](2024-03-27 12:13:42,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.095114, valid_loss 1.150180, train_metric nan, valid_metric 0.050392
[2648869:MainThread](2024-03-27 12:13:42,735) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.069122, valid_loss 1.148765, train_metric nan, valid_metric 0.051071
[2648869:MainThread](2024-03-27 12:13:42,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.096927, valid_loss 1.148217, train_metric nan, valid_metric 0.056670
[2648869:MainThread](2024-03-27 12:13:43,158) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.071879, valid_loss 1.152030, train_metric nan, valid_metric 0.044398
[2648869:MainThread](2024-03-27 12:13:43,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.103055, valid_loss 1.149948, train_metric nan, valid_metric 0.046488
[2648869:MainThread](2024-03-27 12:13:43,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.051794, valid_loss 1.148905, train_metric nan, valid_metric 0.051881
[2648869:MainThread](2024-03-27 12:13:43,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.053246, valid_loss 1.151969, train_metric nan, valid_metric 0.043730
[2648869:MainThread](2024-03-27 12:13:44,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.042293, valid_loss 1.151319, train_metric nan, valid_metric 0.047438
[2648869:MainThread](2024-03-27 12:13:44,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.055389, valid_loss 1.150427, train_metric nan, valid_metric 0.051603
[2648869:MainThread](2024-03-27 12:13:44,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.079824, valid_loss 1.149768, train_metric nan, valid_metric 0.047964
[2648869:MainThread](2024-03-27 12:13:44,750) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.060132, valid_loss 1.151179, train_metric nan, valid_metric 0.053189
[2648869:MainThread](2024-03-27 12:13:44,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.065607, valid_loss 1.149742, train_metric nan, valid_metric 0.048455
[2648869:MainThread](2024-03-27 12:13:45,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.057585, valid_loss 1.148303, train_metric nan, valid_metric 0.050719
[2648869:MainThread](2024-03-27 12:13:45,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.066082, valid_loss 1.150301, train_metric nan, valid_metric 0.050007
[2648869:MainThread](2024-03-27 12:13:45,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.073487, valid_loss 1.149732, train_metric nan, valid_metric 0.048509
[2648869:MainThread](2024-03-27 12:13:45,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.072326, valid_loss 1.150098, train_metric nan, valid_metric 0.050225
[2648869:MainThread](2024-03-27 12:13:46,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.044738, valid_loss 1.148212, train_metric nan, valid_metric 0.054131
[2648869:MainThread](2024-03-27 12:13:46,340) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.047200, valid_loss 1.149035, train_metric nan, valid_metric 0.052258
[2648869:MainThread](2024-03-27 12:13:46,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.061118, valid_loss 1.149031, train_metric nan, valid_metric 0.055871
[2648869:MainThread](2024-03-27 12:13:46,746) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.050659, valid_loss 1.149214, train_metric nan, valid_metric 0.057138
[2648869:MainThread](2024-03-27 12:13:46,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.044184, valid_loss 1.148412, train_metric nan, valid_metric 0.054034
[2648869:MainThread](2024-03-27 12:13:47,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.050930, valid_loss 1.149823, train_metric nan, valid_metric 0.055548
[2648869:MainThread](2024-03-27 12:13:47,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.074432, valid_loss 1.147286, train_metric nan, valid_metric 0.057072
[2648869:MainThread](2024-03-27 12:13:47,352) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.148057 to 1.147286, save checkpoint.
[2648869:MainThread](2024-03-27 12:13:47,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.057837, valid_loss 1.147747, train_metric nan, valid_metric 0.054275
[2648869:MainThread](2024-03-27 12:13:47,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.037222, valid_loss 1.151645, train_metric nan, valid_metric 0.047975
[2648869:MainThread](2024-03-27 12:13:47,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.049887, valid_loss 1.149150, train_metric nan, valid_metric 0.050120
[2648869:MainThread](2024-03-27 12:13:48,163) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.049999, valid_loss 1.148106, train_metric nan, valid_metric 0.054860
[2648869:MainThread](2024-03-27 12:13:48,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.054229, valid_loss 1.148014, train_metric nan, valid_metric 0.055365
[2648869:MainThread](2024-03-27 12:13:48,567) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.053853, valid_loss 1.147923, train_metric nan, valid_metric 0.055200
[2648869:MainThread](2024-03-27 12:13:48,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.043494, valid_loss 1.147486, train_metric nan, valid_metric 0.057731
[2648869:MainThread](2024-03-27 12:13:48,973) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.069921, valid_loss 1.148007, train_metric nan, valid_metric 0.060111
[2648869:MainThread](2024-03-27 12:13:49,175) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.064535, valid_loss 1.147490, train_metric nan, valid_metric 0.057768
[2648869:MainThread](2024-03-27 12:13:49,380) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.048385, valid_loss 1.147975, train_metric nan, valid_metric 0.059798
[2648869:MainThread](2024-03-27 12:13:49,583) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.036082, valid_loss 1.148880, train_metric nan, valid_metric 0.056122
[2648869:MainThread](2024-03-27 12:13:49,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.043963, valid_loss 1.147282, train_metric nan, valid_metric 0.057611
[2648869:MainThread](2024-03-27 12:13:49,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.147286 to 1.147282, save checkpoint.
[2648869:MainThread](2024-03-27 12:13:49,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.032817, valid_loss 1.147460, train_metric nan, valid_metric 0.058204
[2648869:MainThread](2024-03-27 12:13:50,195) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.037210, valid_loss 1.147584, train_metric nan, valid_metric 0.056608
[2648869:MainThread](2024-03-27 12:13:50,400) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.038475, valid_loss 1.147435, train_metric nan, valid_metric 0.059104
[2648869:MainThread](2024-03-27 12:13:50,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.052964, valid_loss 1.147737, train_metric nan, valid_metric 0.056109
[2648869:MainThread](2024-03-27 12:13:50,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.047705, valid_loss 1.148480, train_metric nan, valid_metric 0.053280
[2648869:MainThread](2024-03-27 12:13:51,008) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.035805, valid_loss 1.147441, train_metric nan, valid_metric 0.056600
[2648869:MainThread](2024-03-27 12:13:51,214) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.037447, valid_loss 1.148636, train_metric nan, valid_metric 0.054731
[2648869:MainThread](2024-03-27 12:13:51,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.031933, valid_loss 1.147738, train_metric nan, valid_metric 0.056830
[2648869:MainThread](2024-03-27 12:13:51,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.036540, valid_loss 1.148914, train_metric nan, valid_metric 0.056240
[2648869:MainThread](2024-03-27 12:13:51,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.070835, valid_loss 1.147328, train_metric nan, valid_metric 0.060825
[2648869:MainThread](2024-03-27 12:13:52,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.066354, valid_loss 1.147653, train_metric nan, valid_metric 0.057442
[2648869:MainThread](2024-03-27 12:13:52,255) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.055212, valid_loss 1.147066, train_metric nan, valid_metric 0.059893
[2648869:MainThread](2024-03-27 12:13:52,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.147282 to 1.147066, save checkpoint.
[2648869:MainThread](2024-03-27 12:13:52,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.035950, valid_loss 1.147189, train_metric nan, valid_metric 0.057705
[2648869:MainThread](2024-03-27 12:13:52,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.038283, valid_loss 1.149171, train_metric nan, valid_metric 0.054553
[2648869:MainThread](2024-03-27 12:13:52,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.043741, valid_loss 1.148099, train_metric nan, valid_metric 0.055992
[2648869:MainThread](2024-03-27 12:13:53,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.063024, valid_loss 1.147986, train_metric nan, valid_metric 0.058331
[2648869:MainThread](2024-03-27 12:13:53,277) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.050090, valid_loss 1.147845, train_metric nan, valid_metric 0.058921
[2648869:MainThread](2024-03-27 12:13:53,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.043553, valid_loss 1.147977, train_metric nan, valid_metric 0.056635
[2648869:MainThread](2024-03-27 12:13:53,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.045220, valid_loss 1.148285, train_metric nan, valid_metric 0.055294
[2648869:MainThread](2024-03-27 12:13:53,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.040814, valid_loss 1.148494, train_metric nan, valid_metric 0.052217
[2648869:MainThread](2024-03-27 12:13:54,086) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.032936, valid_loss 1.148102, train_metric nan, valid_metric 0.055309
[2648869:MainThread](2024-03-27 12:13:54,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.048040, valid_loss 1.148189, train_metric nan, valid_metric 0.053987
[2648869:MainThread](2024-03-27 12:13:54,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.062901, valid_loss 1.148600, train_metric nan, valid_metric 0.054997
[2648869:MainThread](2024-03-27 12:13:54,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.035221, valid_loss 1.148423, train_metric nan, valid_metric 0.056041
[2648869:MainThread](2024-03-27 12:13:54,898) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.035710, valid_loss 1.149766, train_metric nan, valid_metric 0.054456
[2648869:MainThread](2024-03-27 12:13:55,102) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.045610, valid_loss 1.150147, train_metric nan, valid_metric 0.055534
[2648869:MainThread](2024-03-27 12:13:55,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.036309, valid_loss 1.148658, train_metric nan, valid_metric 0.056278
[2648869:MainThread](2024-03-27 12:13:55,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.033487, valid_loss 1.147158, train_metric nan, valid_metric 0.057555
[2648869:MainThread](2024-03-27 12:13:55,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.026932, valid_loss 1.148695, train_metric nan, valid_metric 0.054630
[2648869:MainThread](2024-03-27 12:13:55,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.031095, valid_loss 1.148538, train_metric nan, valid_metric 0.054345
[2648869:MainThread](2024-03-27 12:13:56,102) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.048477, valid_loss 1.147829, train_metric nan, valid_metric 0.055757
[2648869:MainThread](2024-03-27 12:13:56,304) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.050407, valid_loss 1.148501, train_metric nan, valid_metric 0.054553
[2648869:MainThread](2024-03-27 12:13:56,505) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.049361, valid_loss 1.148372, train_metric nan, valid_metric 0.056381
[2648869:MainThread](2024-03-27 12:13:56,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.055742, valid_loss 1.148764, train_metric nan, valid_metric 0.051357
[2648869:MainThread](2024-03-27 12:13:56,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.036998, valid_loss 1.148098, train_metric nan, valid_metric 0.056297
[2648869:MainThread](2024-03-27 12:13:57,120) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.047693, valid_loss 1.148010, train_metric nan, valid_metric 0.054449
[2648869:MainThread](2024-03-27 12:13:57,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.043883, valid_loss 1.147427, train_metric nan, valid_metric 0.057338
[2648869:MainThread](2024-03-27 12:13:57,525) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.041006, valid_loss 1.148256, train_metric nan, valid_metric 0.054106
[2648869:MainThread](2024-03-27 12:13:57,726) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.043406, valid_loss 1.147870, train_metric nan, valid_metric 0.056186
[2648869:MainThread](2024-03-27 12:13:57,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.054106, valid_loss 1.148126, train_metric nan, valid_metric 0.055213
[2648869:MainThread](2024-03-27 12:13:58,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.039007, valid_loss 1.147762, train_metric nan, valid_metric 0.056414
[2648869:MainThread](2024-03-27 12:13:58,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.054346, valid_loss 1.148597, train_metric nan, valid_metric 0.053026
[2648869:MainThread](2024-03-27 12:13:58,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.037590, valid_loss 1.147832, train_metric nan, valid_metric 0.056415
[2648869:MainThread](2024-03-27 12:13:58,739) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.042002, valid_loss 1.148376, train_metric nan, valid_metric 0.056172
[2648869:MainThread](2024-03-27 12:13:58,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.045196, valid_loss 1.148193, train_metric nan, valid_metric 0.054266
[2648869:MainThread](2024-03-27 12:13:59,142) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.049882, valid_loss 1.148962, train_metric nan, valid_metric 0.054531
[2648869:MainThread](2024-03-27 12:13:59,344) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.034810, valid_loss 1.147866, train_metric nan, valid_metric 0.056562
[2648869:MainThread](2024-03-27 12:13:59,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.040174, valid_loss 1.147698, train_metric nan, valid_metric 0.056425
[2648869:MainThread](2024-03-27 12:13:59,750) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.048047, valid_loss 1.149750, train_metric nan, valid_metric 0.054685
[2648869:MainThread](2024-03-27 12:13:59,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.041431, valid_loss 1.147795, train_metric nan, valid_metric 0.056085
[2648869:MainThread](2024-03-27 12:14:00,153) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.028166, valid_loss 1.148317, train_metric nan, valid_metric 0.056444
[2648869:MainThread](2024-03-27 12:14:00,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.050745, valid_loss 1.147237, train_metric nan, valid_metric 0.058760
[2648869:MainThread](2024-03-27 12:14:00,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.038720, valid_loss 1.149500, train_metric nan, valid_metric 0.051730
[2648869:MainThread](2024-03-27 12:14:00,765) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.031988, valid_loss 1.147661, train_metric nan, valid_metric 0.057821
[2648869:MainThread](2024-03-27 12:14:00,967) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.043369, valid_loss 1.147815, train_metric nan, valid_metric 0.055859
[2648869:MainThread](2024-03-27 12:14:01,169) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.052298, valid_loss 1.148340, train_metric nan, valid_metric 0.055144
[2648869:MainThread](2024-03-27 12:14:01,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.037279, valid_loss 1.148858, train_metric nan, valid_metric 0.054495
[2648869:MainThread](2024-03-27 12:14:01,571) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.041579, valid_loss 1.149170, train_metric nan, valid_metric 0.055536
[2648869:MainThread](2024-03-27 12:14:01,774) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.049011, valid_loss 1.147940, train_metric nan, valid_metric 0.057008
[2648869:MainThread](2024-03-27 12:14:01,985) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.039738, valid_loss 1.147861, train_metric nan, valid_metric 0.057289
[2648869:MainThread](2024-03-27 12:14:02,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.039634, valid_loss 1.149374, train_metric nan, valid_metric 0.056462
[2648869:MainThread](2024-03-27 12:14:02,390) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.036237, valid_loss 1.148107, train_metric nan, valid_metric 0.056843
[2648869:MainThread](2024-03-27 12:14:02,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:14:03,056) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:14:03,747) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  93%|█████████▎| 41/44 [21:25<01:21, 27.20s/it][2648869:MainThread](2024-03-27 12:14:03,754) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:14:03,766) INFO - qlib.workflow - [recorder.py:341] - Recorder 7bdf7e51a37a4080810cb7fbc3b7083c starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:14:04,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:14:04,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:14:04,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:14:04,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:14:06,146) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      1.110735
            SH600004      1.110735
            SH600006      1.110735
            SH600007      1.110735
            SH600008      1.110735
                            ...   
2018-07-02  SZ300136      1.074423
            SZ300144      1.074423
            SZ300251      1.074423
            SZ300408      1.074423
            SZ300433      1.074423
Length: 643032, dtype: float64
[2648869:MainThread](2024-03-27 12:14:07,071) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2018-07-03  SH600000      1.074423
            SH600008      1.074423
            SH600009      1.074423
            SH600010      1.074423
            SH600011      1.074423
                            ...   
2020-04-16  SZ300347      0.599827
            SZ300408      0.599827
            SZ300413      0.599827
            SZ300433      0.599827
            SZ300498      0.599827
Length: 121658, dtype: float64
[2648869:MainThread](2024-03-27 12:14:07,163) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:14:07,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.619678, valid_loss 1.254435, train_metric nan, valid_metric 0.025709
[2648869:MainThread](2024-03-27 12:14:07,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.254435, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:14:07,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.194409, valid_loss 1.252795, train_metric nan, valid_metric 0.044877
[2648869:MainThread](2024-03-27 12:14:07,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.254435 to 1.252795, save checkpoint.
[2648869:MainThread](2024-03-27 12:14:08,029) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.130790, valid_loss 1.239628, train_metric nan, valid_metric 0.036611
[2648869:MainThread](2024-03-27 12:14:08,030) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.252795 to 1.239628, save checkpoint.
[2648869:MainThread](2024-03-27 12:14:08,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.149638, valid_loss 1.241673, train_metric nan, valid_metric 0.042732
[2648869:MainThread](2024-03-27 12:14:08,417) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.219807, valid_loss 1.244003, train_metric nan, valid_metric 0.042299
[2648869:MainThread](2024-03-27 12:14:08,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.282962, valid_loss 1.234542, train_metric nan, valid_metric 0.033308
[2648869:MainThread](2024-03-27 12:14:08,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.239628 to 1.234542, save checkpoint.
[2648869:MainThread](2024-03-27 12:14:08,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.155285, valid_loss 1.241179, train_metric nan, valid_metric 0.036555
[2648869:MainThread](2024-03-27 12:14:09,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.112744, valid_loss 1.235868, train_metric nan, valid_metric 0.039580
[2648869:MainThread](2024-03-27 12:14:09,229) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.109349, valid_loss 1.231804, train_metric nan, valid_metric 0.040503
[2648869:MainThread](2024-03-27 12:14:09,229) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.234542 to 1.231804, save checkpoint.
[2648869:MainThread](2024-03-27 12:14:09,438) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.100278, valid_loss 1.235323, train_metric nan, valid_metric 0.045408
[2648869:MainThread](2024-03-27 12:14:09,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.110000, valid_loss 1.229571, train_metric nan, valid_metric 0.047985
[2648869:MainThread](2024-03-27 12:14:09,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.231804 to 1.229571, save checkpoint.
[2648869:MainThread](2024-03-27 12:14:09,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.139511, valid_loss 1.230914, train_metric nan, valid_metric 0.043351
[2648869:MainThread](2024-03-27 12:14:10,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.154121, valid_loss 1.233345, train_metric nan, valid_metric 0.047308
[2648869:MainThread](2024-03-27 12:14:10,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.129962, valid_loss 1.239485, train_metric nan, valid_metric 0.035067
[2648869:MainThread](2024-03-27 12:14:10,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.098654, valid_loss 1.231838, train_metric nan, valid_metric 0.045802
[2648869:MainThread](2024-03-27 12:14:10,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.082892, valid_loss 1.231173, train_metric nan, valid_metric 0.052604
[2648869:MainThread](2024-03-27 12:14:10,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.089410, valid_loss 1.229414, train_metric nan, valid_metric 0.049725
[2648869:MainThread](2024-03-27 12:14:10,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.229571 to 1.229414, save checkpoint.
[2648869:MainThread](2024-03-27 12:14:11,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.070430, valid_loss 1.229664, train_metric nan, valid_metric 0.053902
[2648869:MainThread](2024-03-27 12:14:11,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.078257, valid_loss 1.229413, train_metric nan, valid_metric 0.054099
[2648869:MainThread](2024-03-27 12:14:11,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.229414 to 1.229413, save checkpoint.
[2648869:MainThread](2024-03-27 12:14:11,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.081908, valid_loss 1.233481, train_metric nan, valid_metric 0.047174
[2648869:MainThread](2024-03-27 12:14:11,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.093312, valid_loss 1.230054, train_metric nan, valid_metric 0.050508
[2648869:MainThread](2024-03-27 12:14:11,887) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.088561, valid_loss 1.230358, train_metric nan, valid_metric 0.054020
[2648869:MainThread](2024-03-27 12:14:12,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.146444, valid_loss 1.233052, train_metric nan, valid_metric 0.054943
[2648869:MainThread](2024-03-27 12:14:12,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.115532, valid_loss 1.236268, train_metric nan, valid_metric 0.054430
[2648869:MainThread](2024-03-27 12:14:12,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.080645, valid_loss 1.238676, train_metric nan, valid_metric 0.046621
[2648869:MainThread](2024-03-27 12:14:12,707) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.064156, valid_loss 1.232043, train_metric nan, valid_metric 0.048582
[2648869:MainThread](2024-03-27 12:14:12,914) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.075048, valid_loss 1.230035, train_metric nan, valid_metric 0.049954
[2648869:MainThread](2024-03-27 12:14:13,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.091394, valid_loss 1.230604, train_metric nan, valid_metric 0.049818
[2648869:MainThread](2024-03-27 12:14:13,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.061144, valid_loss 1.228793, train_metric nan, valid_metric 0.053588
[2648869:MainThread](2024-03-27 12:14:13,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.229413 to 1.228793, save checkpoint.
[2648869:MainThread](2024-03-27 12:14:13,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.064340, valid_loss 1.228716, train_metric nan, valid_metric 0.055433
[2648869:MainThread](2024-03-27 12:14:13,541) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.228793 to 1.228716, save checkpoint.
[2648869:MainThread](2024-03-27 12:14:13,755) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.063567, valid_loss 1.230366, train_metric nan, valid_metric 0.051818
[2648869:MainThread](2024-03-27 12:14:13,963) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.054422, valid_loss 1.229491, train_metric nan, valid_metric 0.051474
[2648869:MainThread](2024-03-27 12:14:14,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.045812, valid_loss 1.228635, train_metric nan, valid_metric 0.055121
[2648869:MainThread](2024-03-27 12:14:14,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.228716 to 1.228635, save checkpoint.
[2648869:MainThread](2024-03-27 12:14:14,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.070747, valid_loss 1.229217, train_metric nan, valid_metric 0.051761
[2648869:MainThread](2024-03-27 12:14:14,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.077035, valid_loss 1.229478, train_metric nan, valid_metric 0.052382
[2648869:MainThread](2024-03-27 12:14:14,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.037967, valid_loss 1.229055, train_metric nan, valid_metric 0.050218
[2648869:MainThread](2024-03-27 12:14:15,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.056997, valid_loss 1.229906, train_metric nan, valid_metric 0.051938
[2648869:MainThread](2024-03-27 12:14:15,214) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.052950, valid_loss 1.229046, train_metric nan, valid_metric 0.055108
[2648869:MainThread](2024-03-27 12:14:15,415) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.055735, valid_loss 1.228661, train_metric nan, valid_metric 0.054916
[2648869:MainThread](2024-03-27 12:14:15,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.068749, valid_loss 1.228633, train_metric nan, valid_metric 0.058851
[2648869:MainThread](2024-03-27 12:14:15,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.228635 to 1.228633, save checkpoint.
[2648869:MainThread](2024-03-27 12:14:15,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.049388, valid_loss 1.230798, train_metric nan, valid_metric 0.053122
[2648869:MainThread](2024-03-27 12:14:16,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.054363, valid_loss 1.229876, train_metric nan, valid_metric 0.057512
[2648869:MainThread](2024-03-27 12:14:16,235) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.055891, valid_loss 1.230102, train_metric nan, valid_metric 0.052674
[2648869:MainThread](2024-03-27 12:14:16,437) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.068410, valid_loss 1.230747, train_metric nan, valid_metric 0.051022
[2648869:MainThread](2024-03-27 12:14:16,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.060388, valid_loss 1.229387, train_metric nan, valid_metric 0.055427
[2648869:MainThread](2024-03-27 12:14:16,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.059483, valid_loss 1.229146, train_metric nan, valid_metric 0.054167
[2648869:MainThread](2024-03-27 12:14:17,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.051630, valid_loss 1.229173, train_metric nan, valid_metric 0.053159
[2648869:MainThread](2024-03-27 12:14:17,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.059419, valid_loss 1.229948, train_metric nan, valid_metric 0.053199
[2648869:MainThread](2024-03-27 12:14:17,463) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.059145, valid_loss 1.229277, train_metric nan, valid_metric 0.052992
[2648869:MainThread](2024-03-27 12:14:17,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.042420, valid_loss 1.229975, train_metric nan, valid_metric 0.056280
[2648869:MainThread](2024-03-27 12:14:17,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.056218, valid_loss 1.231902, train_metric nan, valid_metric 0.053627
[2648869:MainThread](2024-03-27 12:14:18,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.060436, valid_loss 1.228630, train_metric nan, valid_metric 0.055133
[2648869:MainThread](2024-03-27 12:14:18,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.228633 to 1.228630, save checkpoint.
[2648869:MainThread](2024-03-27 12:14:18,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.048616, valid_loss 1.229098, train_metric nan, valid_metric 0.054124
[2648869:MainThread](2024-03-27 12:14:18,483) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.044766, valid_loss 1.230571, train_metric nan, valid_metric 0.050944
[2648869:MainThread](2024-03-27 12:14:18,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.055882, valid_loss 1.228452, train_metric nan, valid_metric 0.055387
[2648869:MainThread](2024-03-27 12:14:18,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.228630 to 1.228452, save checkpoint.
[2648869:MainThread](2024-03-27 12:14:18,892) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.079039, valid_loss 1.228691, train_metric nan, valid_metric 0.053914
[2648869:MainThread](2024-03-27 12:14:19,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.038692, valid_loss 1.228655, train_metric nan, valid_metric 0.056443
[2648869:MainThread](2024-03-27 12:14:19,297) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.046739, valid_loss 1.230369, train_metric nan, valid_metric 0.054434
[2648869:MainThread](2024-03-27 12:14:19,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.038052, valid_loss 1.229456, train_metric nan, valid_metric 0.054690
[2648869:MainThread](2024-03-27 12:14:19,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.035942, valid_loss 1.229610, train_metric nan, valid_metric 0.055753
[2648869:MainThread](2024-03-27 12:14:19,910) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.051385, valid_loss 1.229002, train_metric nan, valid_metric 0.052095
[2648869:MainThread](2024-03-27 12:14:20,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.057709, valid_loss 1.228987, train_metric nan, valid_metric 0.053585
[2648869:MainThread](2024-03-27 12:14:20,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.042650, valid_loss 1.229166, train_metric nan, valid_metric 0.053349
[2648869:MainThread](2024-03-27 12:14:20,525) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.052157, valid_loss 1.228937, train_metric nan, valid_metric 0.055311
[2648869:MainThread](2024-03-27 12:14:20,727) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.046707, valid_loss 1.230226, train_metric nan, valid_metric 0.052113
[2648869:MainThread](2024-03-27 12:14:20,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.044195, valid_loss 1.230510, train_metric nan, valid_metric 0.050764
[2648869:MainThread](2024-03-27 12:14:21,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.061768, valid_loss 1.229481, train_metric nan, valid_metric 0.053552
[2648869:MainThread](2024-03-27 12:14:21,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.048717, valid_loss 1.231072, train_metric nan, valid_metric 0.053199
[2648869:MainThread](2024-03-27 12:14:21,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.028151, valid_loss 1.228801, train_metric nan, valid_metric 0.052441
[2648869:MainThread](2024-03-27 12:14:21,755) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.039669, valid_loss 1.230584, train_metric nan, valid_metric 0.054011
[2648869:MainThread](2024-03-27 12:14:21,963) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 1.056365, valid_loss 1.228912, train_metric nan, valid_metric 0.054924
[2648869:MainThread](2024-03-27 12:14:22,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.042464, valid_loss 1.231098, train_metric nan, valid_metric 0.053282
[2648869:MainThread](2024-03-27 12:14:22,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.041947, valid_loss 1.229000, train_metric nan, valid_metric 0.055718
[2648869:MainThread](2024-03-27 12:14:22,569) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 1.048334, valid_loss 1.229060, train_metric nan, valid_metric 0.054133
[2648869:MainThread](2024-03-27 12:14:22,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 1.048994, valid_loss 1.229344, train_metric nan, valid_metric 0.052232
[2648869:MainThread](2024-03-27 12:14:22,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.032810, valid_loss 1.230302, train_metric nan, valid_metric 0.052466
[2648869:MainThread](2024-03-27 12:14:23,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.046086, valid_loss 1.229627, train_metric nan, valid_metric 0.054868
[2648869:MainThread](2024-03-27 12:14:23,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.037517, valid_loss 1.229824, train_metric nan, valid_metric 0.054529
[2648869:MainThread](2024-03-27 12:14:23,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.051865, valid_loss 1.229775, train_metric nan, valid_metric 0.053014
[2648869:MainThread](2024-03-27 12:14:23,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 1.052839, valid_loss 1.228904, train_metric nan, valid_metric 0.055405
[2648869:MainThread](2024-03-27 12:14:23,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 1.044733, valid_loss 1.228473, train_metric nan, valid_metric 0.054873
[2648869:MainThread](2024-03-27 12:14:24,195) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.044423, valid_loss 1.228654, train_metric nan, valid_metric 0.054043
[2648869:MainThread](2024-03-27 12:14:24,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.048822, valid_loss 1.228645, train_metric nan, valid_metric 0.056480
[2648869:MainThread](2024-03-27 12:14:24,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.035841, valid_loss 1.229153, train_metric nan, valid_metric 0.055624
[2648869:MainThread](2024-03-27 12:14:24,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 1.045564, valid_loss 1.230108, train_metric nan, valid_metric 0.051398
[2648869:MainThread](2024-03-27 12:14:25,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 1.030701, valid_loss 1.229568, train_metric nan, valid_metric 0.052901
[2648869:MainThread](2024-03-27 12:14:25,214) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 1.043313, valid_loss 1.228538, train_metric nan, valid_metric 0.054342
[2648869:MainThread](2024-03-27 12:14:25,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 1.041202, valid_loss 1.229135, train_metric nan, valid_metric 0.052881
[2648869:MainThread](2024-03-27 12:14:25,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 1.047454, valid_loss 1.229358, train_metric nan, valid_metric 0.053814
[2648869:MainThread](2024-03-27 12:14:25,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.042910, valid_loss 1.228424, train_metric nan, valid_metric 0.055525
[2648869:MainThread](2024-03-27 12:14:25,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.228452 to 1.228424, save checkpoint.
[2648869:MainThread](2024-03-27 12:14:26,033) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 1.036443, valid_loss 1.229761, train_metric nan, valid_metric 0.053475
[2648869:MainThread](2024-03-27 12:14:26,238) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.042004, valid_loss 1.229432, train_metric nan, valid_metric 0.054784
[2648869:MainThread](2024-03-27 12:14:26,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 1.045364, valid_loss 1.228819, train_metric nan, valid_metric 0.054497
[2648869:MainThread](2024-03-27 12:14:26,646) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 1.039797, valid_loss 1.229435, train_metric nan, valid_metric 0.051648
[2648869:MainThread](2024-03-27 12:14:26,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 1.044089, valid_loss 1.230137, train_metric nan, valid_metric 0.053703
[2648869:MainThread](2024-03-27 12:14:27,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 1.044531, valid_loss 1.228759, train_metric nan, valid_metric 0.053118
[2648869:MainThread](2024-03-27 12:14:27,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 1.031853, valid_loss 1.230297, train_metric nan, valid_metric 0.053135
[2648869:MainThread](2024-03-27 12:14:27,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.045294, valid_loss 1.229090, train_metric nan, valid_metric 0.053254
[2648869:MainThread](2024-03-27 12:14:27,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.071214, valid_loss 1.228846, train_metric nan, valid_metric 0.055088
[2648869:MainThread](2024-03-27 12:14:27,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 1.054246, valid_loss 1.229060, train_metric nan, valid_metric 0.054148
[2648869:MainThread](2024-03-27 12:14:28,080) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.049801, valid_loss 1.230402, train_metric nan, valid_metric 0.054281
[2648869:MainThread](2024-03-27 12:14:28,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 1.040663, valid_loss 1.229501, train_metric nan, valid_metric 0.055832
[2648869:MainThread](2024-03-27 12:14:28,487) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 1.026391, valid_loss 1.231067, train_metric nan, valid_metric 0.055142
[2648869:MainThread](2024-03-27 12:14:28,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 1.045909, valid_loss 1.229825, train_metric nan, valid_metric 0.053522
[2648869:MainThread](2024-03-27 12:14:28,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 1.043724, valid_loss 1.230159, train_metric nan, valid_metric 0.053450
[2648869:MainThread](2024-03-27 12:14:29,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.030386, valid_loss 1.228768, train_metric nan, valid_metric 0.055392
[2648869:MainThread](2024-03-27 12:14:29,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 1.046815, valid_loss 1.228369, train_metric nan, valid_metric 0.053949
[2648869:MainThread](2024-03-27 12:14:29,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.228424 to 1.228369, save checkpoint.
[2648869:MainThread](2024-03-27 12:14:29,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 1.054083, valid_loss 1.229049, train_metric nan, valid_metric 0.055277
[2648869:MainThread](2024-03-27 12:14:29,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 1.041575, valid_loss 1.230916, train_metric nan, valid_metric 0.053686
[2648869:MainThread](2024-03-27 12:14:29,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 1.036242, valid_loss 1.230798, train_metric nan, valid_metric 0.054581
[2648869:MainThread](2024-03-27 12:14:30,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.023312, valid_loss 1.229373, train_metric nan, valid_metric 0.055199
[2648869:MainThread](2024-03-27 12:14:30,342) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.059120, valid_loss 1.228704, train_metric nan, valid_metric 0.054628
[2648869:MainThread](2024-03-27 12:14:30,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 1.043927, valid_loss 1.228616, train_metric nan, valid_metric 0.052840
[2648869:MainThread](2024-03-27 12:14:30,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 1.051651, valid_loss 1.228704, train_metric nan, valid_metric 0.054743
[2648869:MainThread](2024-03-27 12:14:30,953) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 1.050769, valid_loss 1.228719, train_metric nan, valid_metric 0.054499
[2648869:MainThread](2024-03-27 12:14:31,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 1.049543, valid_loss 1.228730, train_metric nan, valid_metric 0.054328
[2648869:MainThread](2024-03-27 12:14:31,359) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 1.051128, valid_loss 1.228564, train_metric nan, valid_metric 0.056012
[2648869:MainThread](2024-03-27 12:14:31,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 1.049494, valid_loss 1.228866, train_metric nan, valid_metric 0.054142
[2648869:MainThread](2024-03-27 12:14:31,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 1.054408, valid_loss 1.228512, train_metric nan, valid_metric 0.054012
[2648869:MainThread](2024-03-27 12:14:31,972) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 1.039474, valid_loss 1.229245, train_metric nan, valid_metric 0.053392
[2648869:MainThread](2024-03-27 12:14:32,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 1.046842, valid_loss 1.228731, train_metric nan, valid_metric 0.055598
[2648869:MainThread](2024-03-27 12:14:32,378) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 1.036136, valid_loss 1.228620, train_metric nan, valid_metric 0.055074
[2648869:MainThread](2024-03-27 12:14:32,579) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 1.046696, valid_loss 1.230212, train_metric nan, valid_metric 0.054677
[2648869:MainThread](2024-03-27 12:14:32,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 1.045627, valid_loss 1.229066, train_metric nan, valid_metric 0.053484
[2648869:MainThread](2024-03-27 12:14:32,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 1.054433, valid_loss 1.229244, train_metric nan, valid_metric 0.054584
[2648869:MainThread](2024-03-27 12:14:33,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 1.052849, valid_loss 1.229414, train_metric nan, valid_metric 0.054696
[2648869:MainThread](2024-03-27 12:14:33,394) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 1.046484, valid_loss 1.230433, train_metric nan, valid_metric 0.053196
[2648869:MainThread](2024-03-27 12:14:33,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 1.043300, valid_loss 1.228971, train_metric nan, valid_metric 0.054408
[2648869:MainThread](2024-03-27 12:14:33,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 1.049074, valid_loss 1.230235, train_metric nan, valid_metric 0.052639
[2648869:MainThread](2024-03-27 12:14:34,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 1.055716, valid_loss 1.228949, train_metric nan, valid_metric 0.054762
[2648869:MainThread](2024-03-27 12:14:34,210) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 1.034162, valid_loss 1.230468, train_metric nan, valid_metric 0.052868
[2648869:MainThread](2024-03-27 12:14:34,413) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 1.038739, valid_loss 1.229059, train_metric nan, valid_metric 0.054091
[2648869:MainThread](2024-03-27 12:14:34,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 1.038052, valid_loss 1.230952, train_metric nan, valid_metric 0.053446
[2648869:MainThread](2024-03-27 12:14:34,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 1.036994, valid_loss 1.228765, train_metric nan, valid_metric 0.053614
[2648869:MainThread](2024-03-27 12:14:35,031) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 1.025317, valid_loss 1.229820, train_metric nan, valid_metric 0.053802
[2648869:MainThread](2024-03-27 12:14:35,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 1.041980, valid_loss 1.228742, train_metric nan, valid_metric 0.054240
[2648869:MainThread](2024-03-27 12:14:35,434) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 1.058389, valid_loss 1.228882, train_metric nan, valid_metric 0.053546
[2648869:MainThread](2024-03-27 12:14:35,635) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2760]: train_loss 1.035552, valid_loss 1.228954, train_metric nan, valid_metric 0.055601
[2648869:MainThread](2024-03-27 12:14:35,838) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2780]: train_loss 1.040214, valid_loss 1.229307, train_metric nan, valid_metric 0.057003
[2648869:MainThread](2024-03-27 12:14:36,043) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2800]: train_loss 1.045536, valid_loss 1.230386, train_metric nan, valid_metric 0.054269
[2648869:MainThread](2024-03-27 12:14:36,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2820]: train_loss 1.040363, valid_loss 1.229022, train_metric nan, valid_metric 0.054540
[2648869:MainThread](2024-03-27 12:14:36,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2840]: train_loss 1.048238, valid_loss 1.228705, train_metric nan, valid_metric 0.054365
[2648869:MainThread](2024-03-27 12:14:36,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2860]: train_loss 1.047261, valid_loss 1.229443, train_metric nan, valid_metric 0.054278
[2648869:MainThread](2024-03-27 12:14:36,852) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2880]: train_loss 1.041279, valid_loss 1.229122, train_metric nan, valid_metric 0.055588
[2648869:MainThread](2024-03-27 12:14:37,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2900]: train_loss 1.038961, valid_loss 1.228812, train_metric nan, valid_metric 0.054480
[2648869:MainThread](2024-03-27 12:14:37,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2920]: train_loss 1.039343, valid_loss 1.229265, train_metric nan, valid_metric 0.055022
[2648869:MainThread](2024-03-27 12:14:37,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2940]: train_loss 1.046553, valid_loss 1.229136, train_metric nan, valid_metric 0.054160
[2648869:MainThread](2024-03-27 12:14:37,666) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2960]: train_loss 1.056264, valid_loss 1.230537, train_metric nan, valid_metric 0.053621
[2648869:MainThread](2024-03-27 12:14:37,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2980]: train_loss 1.034427, valid_loss 1.229472, train_metric nan, valid_metric 0.054788
[2648869:MainThread](2024-03-27 12:14:38,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3000]: train_loss 1.042791, valid_loss 1.229028, train_metric nan, valid_metric 0.055079
[2648869:MainThread](2024-03-27 12:14:38,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3020]: train_loss 1.049586, valid_loss 1.229757, train_metric nan, valid_metric 0.054601
[2648869:MainThread](2024-03-27 12:14:38,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3040]: train_loss 1.047787, valid_loss 1.230513, train_metric nan, valid_metric 0.053616
[2648869:MainThread](2024-03-27 12:14:38,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3060]: train_loss 1.037226, valid_loss 1.230141, train_metric nan, valid_metric 0.053158
[2648869:MainThread](2024-03-27 12:14:38,885) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3080]: train_loss 1.054302, valid_loss 1.229240, train_metric nan, valid_metric 0.054136
[2648869:MainThread](2024-03-27 12:14:39,086) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3100]: train_loss 1.035458, valid_loss 1.230221, train_metric nan, valid_metric 0.053728
[2648869:MainThread](2024-03-27 12:14:39,287) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3120]: train_loss 1.044168, valid_loss 1.229639, train_metric nan, valid_metric 0.053372
[2648869:MainThread](2024-03-27 12:14:39,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3140]: train_loss 1.041104, valid_loss 1.229019, train_metric nan, valid_metric 0.056851
[2648869:MainThread](2024-03-27 12:14:39,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:14:40,165) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:14:40,866) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  95%|█████████▌| 42/44 [22:02<01:00, 30.17s/it][2648869:MainThread](2024-03-27 12:14:40,873) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:14:40,884) INFO - qlib.workflow - [recorder.py:341] - Recorder 7791228ef32d48429137588b168c3071 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:14:41,507) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:14:41,508) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:14:41,511) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:14:41,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:14:43,292) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.847174
            SH600004      0.847174
            SH600006      0.847174
            SH600007      0.847174
            SH600008      0.847174
                            ...   
2018-07-30  SZ300136      0.840945
            SZ300144      0.840945
            SZ300251      0.840945
            SZ300408      0.840945
            SZ300433      0.840945
Length: 648518, dtype: float64
[2648869:MainThread](2024-03-27 12:14:44,227) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2018-07-31  SH600000      0.840945
            SH600008      0.840945
            SH600009      0.840945
            SH600010      0.840945
            SH600011      0.840945
                            ...   
2020-05-19  SZ300347      1.014658
            SZ300408      1.014658
            SZ300413      1.014658
            SZ300433      1.014658
            SZ300498      1.014658
Length: 122120, dtype: float64
[2648869:MainThread](2024-03-27 12:14:44,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:14:44,799) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.555683, valid_loss 1.328211, train_metric nan, valid_metric 0.003742
[2648869:MainThread](2024-03-27 12:14:44,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.328211, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:14:45,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.206271, valid_loss 1.314071, train_metric nan, valid_metric 0.025609
[2648869:MainThread](2024-03-27 12:14:45,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.328211 to 1.314071, save checkpoint.
[2648869:MainThread](2024-03-27 12:14:45,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.147334, valid_loss 1.315572, train_metric nan, valid_metric 0.045318
[2648869:MainThread](2024-03-27 12:14:45,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.102863, valid_loss 1.303716, train_metric nan, valid_metric 0.056175
[2648869:MainThread](2024-03-27 12:14:45,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.314071 to 1.303716, save checkpoint.
[2648869:MainThread](2024-03-27 12:14:45,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.120881, valid_loss 1.305830, train_metric nan, valid_metric 0.056883
[2648869:MainThread](2024-03-27 12:14:45,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.204745, valid_loss 1.304444, train_metric nan, valid_metric 0.054311
[2648869:MainThread](2024-03-27 12:14:46,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.111434, valid_loss 1.311323, train_metric nan, valid_metric 0.047043
[2648869:MainThread](2024-03-27 12:14:46,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.091804, valid_loss 1.307775, train_metric nan, valid_metric 0.036584
[2648869:MainThread](2024-03-27 12:14:46,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.161366, valid_loss 1.304280, train_metric nan, valid_metric 0.048186
[2648869:MainThread](2024-03-27 12:14:46,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.142608, valid_loss 1.305493, train_metric nan, valid_metric 0.048214
[2648869:MainThread](2024-03-27 12:14:47,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.146534, valid_loss 1.304961, train_metric nan, valid_metric 0.044659
[2648869:MainThread](2024-03-27 12:14:47,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.069280, valid_loss 1.305366, train_metric nan, valid_metric 0.043304
[2648869:MainThread](2024-03-27 12:14:47,643) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.063045, valid_loss 1.303700, train_metric nan, valid_metric 0.051928
[2648869:MainThread](2024-03-27 12:14:47,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.303716 to 1.303700, save checkpoint.
[2648869:MainThread](2024-03-27 12:14:47,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.043462, valid_loss 1.306581, train_metric nan, valid_metric 0.052266
[2648869:MainThread](2024-03-27 12:14:48,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.100001, valid_loss 1.301609, train_metric nan, valid_metric 0.062210
[2648869:MainThread](2024-03-27 12:14:48,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.303700 to 1.301609, save checkpoint.
[2648869:MainThread](2024-03-27 12:14:48,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.109728, valid_loss 1.303576, train_metric nan, valid_metric 0.053066
[2648869:MainThread](2024-03-27 12:14:48,555) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.046096, valid_loss 1.304839, train_metric nan, valid_metric 0.054275
[2648869:MainThread](2024-03-27 12:14:48,759) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.055916, valid_loss 1.303107, train_metric nan, valid_metric 0.057924
[2648869:MainThread](2024-03-27 12:14:48,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.047753, valid_loss 1.303639, train_metric nan, valid_metric 0.054095
[2648869:MainThread](2024-03-27 12:14:49,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.044435, valid_loss 1.303686, train_metric nan, valid_metric 0.056981
[2648869:MainThread](2024-03-27 12:14:49,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.056480, valid_loss 1.307089, train_metric nan, valid_metric 0.045136
[2648869:MainThread](2024-03-27 12:14:49,573) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.080571, valid_loss 1.302904, train_metric nan, valid_metric 0.053737
[2648869:MainThread](2024-03-27 12:14:49,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.065209, valid_loss 1.305203, train_metric nan, valid_metric 0.053832
[2648869:MainThread](2024-03-27 12:14:49,985) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.031197, valid_loss 1.303760, train_metric nan, valid_metric 0.053609
[2648869:MainThread](2024-03-27 12:14:50,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.040979, valid_loss 1.303002, train_metric nan, valid_metric 0.049551
[2648869:MainThread](2024-03-27 12:14:50,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.032385, valid_loss 1.303871, train_metric nan, valid_metric 0.052017
[2648869:MainThread](2024-03-27 12:14:50,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.041991, valid_loss 1.302671, train_metric nan, valid_metric 0.056501
[2648869:MainThread](2024-03-27 12:14:50,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.033469, valid_loss 1.304005, train_metric nan, valid_metric 0.052778
[2648869:MainThread](2024-03-27 12:14:51,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.015841, valid_loss 1.303057, train_metric nan, valid_metric 0.053232
[2648869:MainThread](2024-03-27 12:14:51,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.049484, valid_loss 1.302973, train_metric nan, valid_metric 0.053643
[2648869:MainThread](2024-03-27 12:14:51,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.017326, valid_loss 1.303952, train_metric nan, valid_metric 0.052667
[2648869:MainThread](2024-03-27 12:14:51,756) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.043921, valid_loss 1.304336, train_metric nan, valid_metric 0.049902
[2648869:MainThread](2024-03-27 12:14:51,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.034082, valid_loss 1.302354, train_metric nan, valid_metric 0.055154
[2648869:MainThread](2024-03-27 12:14:52,176) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.037871, valid_loss 1.304159, train_metric nan, valid_metric 0.058025
[2648869:MainThread](2024-03-27 12:14:52,425) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.041055, valid_loss 1.303481, train_metric nan, valid_metric 0.048315
[2648869:MainThread](2024-03-27 12:14:52,678) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.063556, valid_loss 1.303772, train_metric nan, valid_metric 0.054556
[2648869:MainThread](2024-03-27 12:14:52,929) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.041356, valid_loss 1.303289, train_metric nan, valid_metric 0.051658
[2648869:MainThread](2024-03-27 12:14:53,180) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.021077, valid_loss 1.302869, train_metric nan, valid_metric 0.053566
[2648869:MainThread](2024-03-27 12:14:53,434) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.024792, valid_loss 1.303860, train_metric nan, valid_metric 0.049820
[2648869:MainThread](2024-03-27 12:14:53,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.039358, valid_loss 1.303671, train_metric nan, valid_metric 0.048854
[2648869:MainThread](2024-03-27 12:14:53,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.031564, valid_loss 1.302392, train_metric nan, valid_metric 0.057004
[2648869:MainThread](2024-03-27 12:14:54,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.029920, valid_loss 1.303041, train_metric nan, valid_metric 0.050227
[2648869:MainThread](2024-03-27 12:14:54,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.028389, valid_loss 1.303218, train_metric nan, valid_metric 0.053646
[2648869:MainThread](2024-03-27 12:14:54,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.029370, valid_loss 1.303976, train_metric nan, valid_metric 0.052848
[2648869:MainThread](2024-03-27 12:14:54,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.024154, valid_loss 1.302963, train_metric nan, valid_metric 0.051388
[2648869:MainThread](2024-03-27 12:14:54,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.021847, valid_loss 1.303183, train_metric nan, valid_metric 0.052922
[2648869:MainThread](2024-03-27 12:14:55,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.018682, valid_loss 1.302966, train_metric nan, valid_metric 0.055465
[2648869:MainThread](2024-03-27 12:14:55,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.008396, valid_loss 1.304218, train_metric nan, valid_metric 0.056499
[2648869:MainThread](2024-03-27 12:14:55,628) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.022582, valid_loss 1.302986, train_metric nan, valid_metric 0.058496
[2648869:MainThread](2024-03-27 12:14:55,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.025336, valid_loss 1.303139, train_metric nan, valid_metric 0.054366
[2648869:MainThread](2024-03-27 12:14:56,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.023800, valid_loss 1.302579, train_metric nan, valid_metric 0.059523
[2648869:MainThread](2024-03-27 12:14:56,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.051879, valid_loss 1.302556, train_metric nan, valid_metric 0.057151
[2648869:MainThread](2024-03-27 12:14:56,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.015795, valid_loss 1.302397, train_metric nan, valid_metric 0.058507
[2648869:MainThread](2024-03-27 12:14:56,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.019185, valid_loss 1.303865, train_metric nan, valid_metric 0.053084
[2648869:MainThread](2024-03-27 12:14:56,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.019250, valid_loss 1.303136, train_metric nan, valid_metric 0.053497
[2648869:MainThread](2024-03-27 12:14:57,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.012200, valid_loss 1.304179, train_metric nan, valid_metric 0.056437
[2648869:MainThread](2024-03-27 12:14:57,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.008603, valid_loss 1.303361, train_metric nan, valid_metric 0.054992
[2648869:MainThread](2024-03-27 12:14:57,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.019952, valid_loss 1.304015, train_metric nan, valid_metric 0.055808
[2648869:MainThread](2024-03-27 12:14:57,667) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 1.022013, valid_loss 1.303391, train_metric nan, valid_metric 0.055471
[2648869:MainThread](2024-03-27 12:14:57,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.043808, valid_loss 1.303608, train_metric nan, valid_metric 0.053390
[2648869:MainThread](2024-03-27 12:14:58,077) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 1.019173, valid_loss 1.303113, train_metric nan, valid_metric 0.055081
[2648869:MainThread](2024-03-27 12:14:58,281) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.032585, valid_loss 1.303535, train_metric nan, valid_metric 0.054302
[2648869:MainThread](2024-03-27 12:14:58,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.026837, valid_loss 1.304137, train_metric nan, valid_metric 0.057728
[2648869:MainThread](2024-03-27 12:14:58,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 1.021119, valid_loss 1.303526, train_metric nan, valid_metric 0.056129
[2648869:MainThread](2024-03-27 12:14:58,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.016612, valid_loss 1.302577, train_metric nan, valid_metric 0.057246
[2648869:MainThread](2024-03-27 12:14:58,892) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:14:59,570) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:15:00,272) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  98%|█████████▊| 43/44 [22:22<00:26, 26.94s/it][2648869:MainThread](2024-03-27 12:15:00,279) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[2648869:MainThread](2024-03-27 12:15:00,290) INFO - qlib.workflow - [recorder.py:341] - Recorder 0a9b9ca40a1845208751f292b27ef5f1 starts running under Experiment 9 ...
[2648869:MainThread](2024-03-27 12:15:00,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[2648869:MainThread](2024-03-27 12:15:00,920) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[2648869:MainThread](2024-03-27 12:15:00,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[2648869:MainThread](2024-03-27 12:15:00,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[2648869:MainThread](2024-03-27 12:15:02,717) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2008-01-02  SH600000      0.912458
            SH600004      0.912458
            SH600006      0.912458
            SH600007      0.912458
            SH600008      0.912458
                            ...   
2018-08-27  SZ300136      0.614116
            SZ300144      0.614116
            SZ300251      0.614116
            SZ300408      0.614116
            SZ300433      0.614116
Length: 654080, dtype: float64
[2648869:MainThread](2024-03-27 12:15:03,681) INFO - qlib.data selection - [model.py:36] - Reweighting result:
datetime    instrument
2018-08-28  SH600000      0.614116
            SH600008      0.614116
            SH600009      0.614116
            SH600010      0.614116
            SH600011      0.614116
                            ...   
2020-06-16  SZ300413      1.606761
            SZ300433      1.606761
            SZ300498      1.606761
            SZ300601      1.606761
            SZ300628      1.606761
Length: 122495, dtype: float64
[2648869:MainThread](2024-03-27 12:15:03,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[2648869:MainThread](2024-03-27 12:15:04,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.442983, valid_loss 1.389758, train_metric nan, valid_metric 0.035008
[2648869:MainThread](2024-03-27 12:15:04,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.389758, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[2648869:MainThread](2024-03-27 12:15:04,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.236186, valid_loss 1.370024, train_metric nan, valid_metric 0.013538
[2648869:MainThread](2024-03-27 12:15:04,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.389758 to 1.370024, save checkpoint.
[2648869:MainThread](2024-03-27 12:15:04,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.173037, valid_loss 1.383832, train_metric nan, valid_metric 0.002065
[2648869:MainThread](2024-03-27 12:15:04,869) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.126702, valid_loss 1.387143, train_metric nan, valid_metric 0.042378
[2648869:MainThread](2024-03-27 12:15:05,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.072758, valid_loss 1.372316, train_metric nan, valid_metric 0.035692
[2648869:MainThread](2024-03-27 12:15:05,277) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.098088, valid_loss 1.364392, train_metric nan, valid_metric 0.049406
[2648869:MainThread](2024-03-27 12:15:05,277) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.370024 to 1.364392, save checkpoint.
[2648869:MainThread](2024-03-27 12:15:05,487) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.065208, valid_loss 1.365515, train_metric nan, valid_metric 0.051493
[2648869:MainThread](2024-03-27 12:15:05,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.098340, valid_loss 1.366234, train_metric nan, valid_metric 0.048436
[2648869:MainThread](2024-03-27 12:15:05,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.095449, valid_loss 1.379648, train_metric nan, valid_metric 0.051011
[2648869:MainThread](2024-03-27 12:15:06,104) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.097433, valid_loss 1.367734, train_metric nan, valid_metric 0.049356
[2648869:MainThread](2024-03-27 12:15:06,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.068319, valid_loss 1.368900, train_metric nan, valid_metric 0.060660
[2648869:MainThread](2024-03-27 12:15:06,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.091432, valid_loss 1.362712, train_metric nan, valid_metric 0.057769
[2648869:MainThread](2024-03-27 12:15:06,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.364392 to 1.362712, save checkpoint.
[2648869:MainThread](2024-03-27 12:15:06,731) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.029660, valid_loss 1.366056, train_metric nan, valid_metric 0.053337
[2648869:MainThread](2024-03-27 12:15:06,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.031570, valid_loss 1.362017, train_metric nan, valid_metric 0.063913
[2648869:MainThread](2024-03-27 12:15:06,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.362712 to 1.362017, save checkpoint.
[2648869:MainThread](2024-03-27 12:15:07,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.038949, valid_loss 1.365267, train_metric nan, valid_metric 0.060918
[2648869:MainThread](2024-03-27 12:15:07,341) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.041627, valid_loss 1.362742, train_metric nan, valid_metric 0.058878
[2648869:MainThread](2024-03-27 12:15:07,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.051089, valid_loss 1.362654, train_metric nan, valid_metric 0.056600
[2648869:MainThread](2024-03-27 12:15:07,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.065556, valid_loss 1.365033, train_metric nan, valid_metric 0.056254
[2648869:MainThread](2024-03-27 12:15:07,953) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.038569, valid_loss 1.360523, train_metric nan, valid_metric 0.069432
[2648869:MainThread](2024-03-27 12:15:07,953) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.362017 to 1.360523, save checkpoint.
[2648869:MainThread](2024-03-27 12:15:08,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.016049, valid_loss 1.367011, train_metric nan, valid_metric 0.069206
[2648869:MainThread](2024-03-27 12:15:08,359) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.013051, valid_loss 1.360928, train_metric nan, valid_metric 0.067471
[2648869:MainThread](2024-03-27 12:15:08,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.013223, valid_loss 1.360441, train_metric nan, valid_metric 0.071255
[2648869:MainThread](2024-03-27 12:15:08,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.360523 to 1.360441, save checkpoint.
[2648869:MainThread](2024-03-27 12:15:08,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.023166, valid_loss 1.360331, train_metric nan, valid_metric 0.069249
[2648869:MainThread](2024-03-27 12:15:08,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.360441 to 1.360331, save checkpoint.
[2648869:MainThread](2024-03-27 12:15:08,972) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.051476, valid_loss 1.360738, train_metric nan, valid_metric 0.066074
[2648869:MainThread](2024-03-27 12:15:09,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.028897, valid_loss 1.362650, train_metric nan, valid_metric 0.059808
[2648869:MainThread](2024-03-27 12:15:09,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.024964, valid_loss 1.360307, train_metric nan, valid_metric 0.071266
[2648869:MainThread](2024-03-27 12:15:09,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.360331 to 1.360307, save checkpoint.
[2648869:MainThread](2024-03-27 12:15:09,583) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.030976, valid_loss 1.360320, train_metric nan, valid_metric 0.067605
[2648869:MainThread](2024-03-27 12:15:09,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.998632, valid_loss 1.362544, train_metric nan, valid_metric 0.064886
[2648869:MainThread](2024-03-27 12:15:09,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.052449, valid_loss 1.364622, train_metric nan, valid_metric 0.055117
[2648869:MainThread](2024-03-27 12:15:10,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.050759, valid_loss 1.363778, train_metric nan, valid_metric 0.056277
[2648869:MainThread](2024-03-27 12:15:10,395) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.014568, valid_loss 1.360808, train_metric nan, valid_metric 0.073974
[2648869:MainThread](2024-03-27 12:15:10,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.021370, valid_loss 1.364552, train_metric nan, valid_metric 0.066675
[2648869:MainThread](2024-03-27 12:15:10,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.030245, valid_loss 1.359921, train_metric nan, valid_metric 0.074120
[2648869:MainThread](2024-03-27 12:15:10,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.360307 to 1.359921, save checkpoint.
[2648869:MainThread](2024-03-27 12:15:10,996) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.013503, valid_loss 1.359778, train_metric nan, valid_metric 0.072774
[2648869:MainThread](2024-03-27 12:15:10,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.359921 to 1.359778, save checkpoint.
[2648869:MainThread](2024-03-27 12:15:11,204) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.012582, valid_loss 1.360491, train_metric nan, valid_metric 0.072491
[2648869:MainThread](2024-03-27 12:15:11,410) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.020438, valid_loss 1.359761, train_metric nan, valid_metric 0.072938
[2648869:MainThread](2024-03-27 12:15:11,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.359778 to 1.359761, save checkpoint.
[2648869:MainThread](2024-03-27 12:15:11,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.017602, valid_loss 1.359647, train_metric nan, valid_metric 0.072182
[2648869:MainThread](2024-03-27 12:15:11,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.359761 to 1.359647, save checkpoint.
[2648869:MainThread](2024-03-27 12:15:11,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.000267, valid_loss 1.360035, train_metric nan, valid_metric 0.071399
[2648869:MainThread](2024-03-27 12:15:12,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.038388, valid_loss 1.359903, train_metric nan, valid_metric 0.072271
[2648869:MainThread](2024-03-27 12:15:12,229) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.002742, valid_loss 1.360530, train_metric nan, valid_metric 0.071249
[2648869:MainThread](2024-03-27 12:15:12,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.000770, valid_loss 1.359527, train_metric nan, valid_metric 0.074429
[2648869:MainThread](2024-03-27 12:15:12,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.359647 to 1.359527, save checkpoint.
[2648869:MainThread](2024-03-27 12:15:12,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.000724, valid_loss 1.361730, train_metric nan, valid_metric 0.074608
[2648869:MainThread](2024-03-27 12:15:12,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.019675, valid_loss 1.360659, train_metric nan, valid_metric 0.072566
[2648869:MainThread](2024-03-27 12:15:13,043) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.999245, valid_loss 1.359849, train_metric nan, valid_metric 0.073510
[2648869:MainThread](2024-03-27 12:15:13,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.009795, valid_loss 1.359793, train_metric nan, valid_metric 0.075189
[2648869:MainThread](2024-03-27 12:15:13,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.995678, valid_loss 1.359753, train_metric nan, valid_metric 0.072955
[2648869:MainThread](2024-03-27 12:15:13,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.003267, valid_loss 1.360121, train_metric nan, valid_metric 0.071823
[2648869:MainThread](2024-03-27 12:15:13,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.012208, valid_loss 1.359703, train_metric nan, valid_metric 0.074025
[2648869:MainThread](2024-03-27 12:15:14,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 1.002349, valid_loss 1.359523, train_metric nan, valid_metric 0.074350
[2648869:MainThread](2024-03-27 12:15:14,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.359527 to 1.359523, save checkpoint.
[2648869:MainThread](2024-03-27 12:15:14,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.999431, valid_loss 1.359517, train_metric nan, valid_metric 0.073537
[2648869:MainThread](2024-03-27 12:15:14,268) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.359523 to 1.359517, save checkpoint.
[2648869:MainThread](2024-03-27 12:15:14,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.998204, valid_loss 1.360890, train_metric nan, valid_metric 0.071580
[2648869:MainThread](2024-03-27 12:15:14,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.989199, valid_loss 1.360091, train_metric nan, valid_metric 0.074918
[2648869:MainThread](2024-03-27 12:15:14,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.983091, valid_loss 1.359468, train_metric nan, valid_metric 0.076003
[2648869:MainThread](2024-03-27 12:15:14,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.359517 to 1.359468, save checkpoint.
[2648869:MainThread](2024-03-27 12:15:15,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.992118, valid_loss 1.359557, train_metric nan, valid_metric 0.075600
[2648869:MainThread](2024-03-27 12:15:15,395) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.004638, valid_loss 1.360034, train_metric nan, valid_metric 0.073921
[2648869:MainThread](2024-03-27 12:15:15,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.001362, valid_loss 1.360074, train_metric nan, valid_metric 0.074197
[2648869:MainThread](2024-03-27 12:15:15,817) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.995443, valid_loss 1.359141, train_metric nan, valid_metric 0.077361
[2648869:MainThread](2024-03-27 12:15:15,818) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.359468 to 1.359141, save checkpoint.
[2648869:MainThread](2024-03-27 12:15:16,029) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.990195, valid_loss 1.360180, train_metric nan, valid_metric 0.072231
[2648869:MainThread](2024-03-27 12:15:16,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.995702, valid_loss 1.359431, train_metric nan, valid_metric 0.075364
[2648869:MainThread](2024-03-27 12:15:16,452) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.995042, valid_loss 1.359540, train_metric nan, valid_metric 0.075047
[2648869:MainThread](2024-03-27 12:15:16,661) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.999517, valid_loss 1.360059, train_metric nan, valid_metric 0.075064
[2648869:MainThread](2024-03-27 12:15:16,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.997656, valid_loss 1.359320, train_metric nan, valid_metric 0.076811
[2648869:MainThread](2024-03-27 12:15:17,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.992630, valid_loss 1.359232, train_metric nan, valid_metric 0.075364
[2648869:MainThread](2024-03-27 12:15:17,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.995693, valid_loss 1.359389, train_metric nan, valid_metric 0.075099
[2648869:MainThread](2024-03-27 12:15:17,500) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.995162, valid_loss 1.360798, train_metric nan, valid_metric 0.070376
[2648869:MainThread](2024-03-27 12:15:17,712) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.994341, valid_loss 1.359707, train_metric nan, valid_metric 0.074747
[2648869:MainThread](2024-03-27 12:15:17,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.986154, valid_loss 1.359789, train_metric nan, valid_metric 0.072475
[2648869:MainThread](2024-03-27 12:15:18,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 1.005307, valid_loss 1.359323, train_metric nan, valid_metric 0.074876
[2648869:MainThread](2024-03-27 12:15:18,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.999505, valid_loss 1.359504, train_metric nan, valid_metric 0.075776
[2648869:MainThread](2024-03-27 12:15:18,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.985661, valid_loss 1.360879, train_metric nan, valid_metric 0.072664
[2648869:MainThread](2024-03-27 12:15:18,759) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.996880, valid_loss 1.359756, train_metric nan, valid_metric 0.073303
[2648869:MainThread](2024-03-27 12:15:18,968) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 1.005882, valid_loss 1.359486, train_metric nan, valid_metric 0.075212
[2648869:MainThread](2024-03-27 12:15:19,176) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.001299, valid_loss 1.360975, train_metric nan, valid_metric 0.071126
[2648869:MainThread](2024-03-27 12:15:19,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.992247, valid_loss 1.359318, train_metric nan, valid_metric 0.075918
[2648869:MainThread](2024-03-27 12:15:19,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.978294, valid_loss 1.359653, train_metric nan, valid_metric 0.073036
[2648869:MainThread](2024-03-27 12:15:19,804) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 1.002415, valid_loss 1.359820, train_metric nan, valid_metric 0.073542
[2648869:MainThread](2024-03-27 12:15:20,013) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.991941, valid_loss 1.360191, train_metric nan, valid_metric 0.072430
[2648869:MainThread](2024-03-27 12:15:20,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.990839, valid_loss 1.360409, train_metric nan, valid_metric 0.071263
[2648869:MainThread](2024-03-27 12:15:20,433) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.006252, valid_loss 1.359751, train_metric nan, valid_metric 0.074310
[2648869:MainThread](2024-03-27 12:15:20,641) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.993507, valid_loss 1.359552, train_metric nan, valid_metric 0.074377
[2648869:MainThread](2024-03-27 12:15:20,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.997378, valid_loss 1.359244, train_metric nan, valid_metric 0.075879
[2648869:MainThread](2024-03-27 12:15:21,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 1.006380, valid_loss 1.359739, train_metric nan, valid_metric 0.074055
[2648869:MainThread](2024-03-27 12:15:21,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.997045, valid_loss 1.360259, train_metric nan, valid_metric 0.070711
[2648869:MainThread](2024-03-27 12:15:21,463) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.990915, valid_loss 1.359389, train_metric nan, valid_metric 0.075257
[2648869:MainThread](2024-03-27 12:15:21,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.991916, valid_loss 1.359247, train_metric nan, valid_metric 0.076425
[2648869:MainThread](2024-03-27 12:15:21,876) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.986440, valid_loss 1.359757, train_metric nan, valid_metric 0.074890
[2648869:MainThread](2024-03-27 12:15:22,082) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.998848, valid_loss 1.359360, train_metric nan, valid_metric 0.075400
[2648869:MainThread](2024-03-27 12:15:22,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.991186, valid_loss 1.359332, train_metric nan, valid_metric 0.075200
[2648869:MainThread](2024-03-27 12:15:22,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.989200, valid_loss 1.359172, train_metric nan, valid_metric 0.076712
[2648869:MainThread](2024-03-27 12:15:22,690) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.995347, valid_loss 1.359841, train_metric nan, valid_metric 0.074656
[2648869:MainThread](2024-03-27 12:15:22,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.986831, valid_loss 1.359370, train_metric nan, valid_metric 0.076167
[2648869:MainThread](2024-03-27 12:15:23,098) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.989810, valid_loss 1.359502, train_metric nan, valid_metric 0.075122
[2648869:MainThread](2024-03-27 12:15:23,306) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.997170, valid_loss 1.359359, train_metric nan, valid_metric 0.075597
[2648869:MainThread](2024-03-27 12:15:23,511) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.989691, valid_loss 1.359653, train_metric nan, valid_metric 0.074042
[2648869:MainThread](2024-03-27 12:15:23,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.992891, valid_loss 1.359316, train_metric nan, valid_metric 0.075582
[2648869:MainThread](2024-03-27 12:15:23,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.994761, valid_loss 1.359379, train_metric nan, valid_metric 0.075492
[2648869:MainThread](2024-03-27 12:15:24,120) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.996064, valid_loss 1.359471, train_metric nan, valid_metric 0.074790
[2648869:MainThread](2024-03-27 12:15:24,321) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 1.000689, valid_loss 1.359333, train_metric nan, valid_metric 0.075366
[2648869:MainThread](2024-03-27 12:15:24,527) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 1.000932, valid_loss 1.359500, train_metric nan, valid_metric 0.075805
[2648869:MainThread](2024-03-27 12:15:24,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.992034, valid_loss 1.359319, train_metric nan, valid_metric 0.075398
[2648869:MainThread](2024-03-27 12:15:24,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 1.002353, valid_loss 1.359255, train_metric nan, valid_metric 0.075732
[2648869:MainThread](2024-03-27 12:15:25,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.988977, valid_loss 1.359631, train_metric nan, valid_metric 0.074615
[2648869:MainThread](2024-03-27 12:15:25,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.989796, valid_loss 1.359445, train_metric nan, valid_metric 0.075318
[2648869:MainThread](2024-03-27 12:15:25,550) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.989209, valid_loss 1.359737, train_metric nan, valid_metric 0.074960
[2648869:MainThread](2024-03-27 12:15:25,755) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.994840, valid_loss 1.359528, train_metric nan, valid_metric 0.074716
[2648869:MainThread](2024-03-27 12:15:25,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 0.991888, valid_loss 1.359774, train_metric nan, valid_metric 0.073033
[2648869:MainThread](2024-03-27 12:15:26,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.991717, valid_loss 1.359485, train_metric nan, valid_metric 0.075238
[2648869:MainThread](2024-03-27 12:15:26,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[2648869:MainThread](2024-03-27 12:15:26,841) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 9
[2648869:MainThread](2024-03-27 12:15:27,540) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks: 100%|██████████| 44/44 [22:49<00:00, 27.04s/it]train tasks: 100%|██████████| 44/44 [22:49<00:00, 31.13s/it]
[2648869:MainThread](2024-03-27 12:15:27,978) INFO - qlib.timer - [log.py:127] - Time cost: 0.380s | Time to `list_recorders` in RecorderCollector Done
[2648869:MainThread](2024-03-27 12:15:27,978) INFO - qlib.RecorderCollector - [collect.py:226] - Nubmer of recorders after filter: defaultdict(<class 'int'>, {'FINISHED': 44})
[2648869:MainThread](2024-03-27 12:15:28,016) INFO - qlib.RollingEnsemble - [ensemble.py:81] - keys in group: ['0a9b9ca40a1845208751f292b27ef5f1', '7791228ef32d48429137588b168c3071', '7bdf7e51a37a4080810cb7fbc3b7083c', 'c62b4bded4794b3ea3e880e5cc604473', 'bfc2c0ffe8ca4a298ff89e255b5a1249', 'ce9fdb8a083446cfa57b4b6738391442', '46444994d8214b15b83c2ed2f7de4f2b', '338d7f49fd7f4edfa36ebb9d9c4eb2b9', 'a3cf4c3e7ca540438e9a42058a748545', 'c9908df0c5e04490bd9d952b4456d430', '004996ef50a849c6a5b560c61dfb3903', '309ddba2fcff4c59825050bdbe93c99d', 'b548f241b3e04e81aea44b73767638bf', 'ff7d507e7a8a4120bc912c5960df50d3', 'a620d27bee484162865af7ca4fa9190c', 'c87c9a281f4e4b429007b1e46feb5799', '49d890fbcaeb466c9e946154b0a49caa', '76f1406632984c5fb0d2a0ca86d15b21', '2a928dfa97104dc59083105a3aca2408', '9093159e5df84cccbce720acf444b61d', '8c7b9c3d8b804deb99e03d45cc2a9af2', 'e4ea0059f7664843a14f2fa41f58024c', '76e1faf531734edb94320b704ec4c5d3', '8c1b75cd9a1c435eb011d5146f2b7467', 'b897185c7101488586d2f7eef5f72e10', '7dec7b618bc64133a92bcb5719c78a55', 'a7606ea379364b709b27ecba2a199521', '156afd7f61804e2cb6ee8738b76d8d6b', '3b04ea29b8514bfc8b7ea392c97bb0e4', '3811c7bbaf48479e8682937852766ff3', 'f00332a79e3e4f96b0d57dbf386db4ad', 'f81d714a0ad542e3a9f0d17f4a6bdf13', '08dcdb1d284447139b0e965d4b490706', 'a170077e0246430797c1449904c6b244', '986edaba7c3849be98977178c0c8f807', 'd5d4c4e35a4245ba9a36300cac13e252', '8a507d1984a34920bc119febedb2e23e', 'e4342e0484bd48ac8af49c53ddec3d4e', '3c2821810452479b81d0e1c90442ca8f', '9d5de9ff8c7749ffba5b8e9f614235d0', '74e15740e0304b50a47075800f810d58', 'c4082269e86b4a37be8163e2aa3a8160', '36e310a0d26345d0855bb6c386d8fa72', 'd962efd420af4ac1b0c2557fafc8efad']
[2648869:MainThread](2024-03-27 12:15:28,110) INFO - qlib.RollingEnsemble - [ensemble.py:81] - keys in group: ['0a9b9ca40a1845208751f292b27ef5f1', '7791228ef32d48429137588b168c3071', '7bdf7e51a37a4080810cb7fbc3b7083c', 'c62b4bded4794b3ea3e880e5cc604473', 'bfc2c0ffe8ca4a298ff89e255b5a1249', 'ce9fdb8a083446cfa57b4b6738391442', '46444994d8214b15b83c2ed2f7de4f2b', '338d7f49fd7f4edfa36ebb9d9c4eb2b9', 'a3cf4c3e7ca540438e9a42058a748545', 'c9908df0c5e04490bd9d952b4456d430', '004996ef50a849c6a5b560c61dfb3903', '309ddba2fcff4c59825050bdbe93c99d', 'b548f241b3e04e81aea44b73767638bf', 'ff7d507e7a8a4120bc912c5960df50d3', 'a620d27bee484162865af7ca4fa9190c', 'c87c9a281f4e4b429007b1e46feb5799', '49d890fbcaeb466c9e946154b0a49caa', '76f1406632984c5fb0d2a0ca86d15b21', '2a928dfa97104dc59083105a3aca2408', '9093159e5df84cccbce720acf444b61d', '8c7b9c3d8b804deb99e03d45cc2a9af2', 'e4ea0059f7664843a14f2fa41f58024c', '76e1faf531734edb94320b704ec4c5d3', '8c1b75cd9a1c435eb011d5146f2b7467', 'b897185c7101488586d2f7eef5f72e10', '7dec7b618bc64133a92bcb5719c78a55', 'a7606ea379364b709b27ecba2a199521', '156afd7f61804e2cb6ee8738b76d8d6b', '3b04ea29b8514bfc8b7ea392c97bb0e4', '3811c7bbaf48479e8682937852766ff3', 'f00332a79e3e4f96b0d57dbf386db4ad', 'f81d714a0ad542e3a9f0d17f4a6bdf13', '08dcdb1d284447139b0e965d4b490706', 'a170077e0246430797c1449904c6b244', '986edaba7c3849be98977178c0c8f807', 'd5d4c4e35a4245ba9a36300cac13e252', '8a507d1984a34920bc119febedb2e23e', 'e4342e0484bd48ac8af49c53ddec3d4e', '3c2821810452479b81d0e1c90442ca8f', '9d5de9ff8c7749ffba5b8e9f614235d0', '74e15740e0304b50a47075800f810d58', 'c4082269e86b4a37be8163e2aa3a8160', '36e310a0d26345d0855bb6c386d8fa72', 'd962efd420af4ac1b0c2557fafc8efad']
[2648869:MainThread](2024-03-27 12:15:28,206) INFO - qlib.workflow - [exp.py:258] - Experiment 5 starts running ...
[2648869:MainThread](2024-03-27 12:15:28,217) INFO - qlib.workflow - [recorder.py:341] - Recorder aba6ff9d257849e88330c6f27326d108 starts running under Experiment 5 ...
[2648869:MainThread](2024-03-27 12:15:28,949) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
[2648869:MainThread](2024-03-27 12:15:30,560) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
                          score
datetime   instrument          
2019-10-22 SH600000    0.169517
           SH600004    0.269095
           SH600009   -0.000913
           SH600010   -0.045108
           SH600011   -0.073814
Epoch   500: reducing learning rate of group 0 to 1.0000e-03.
Epoch   880: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1100: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1320: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1540: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2019-11-19 SH600000   -0.033515
           SH600004    0.064968
           SH600009    0.037032
           SH600010    0.065726
           SH600011   -0.063110
Epoch  1140: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1360: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1580: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1800: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2019-12-17 SH600000   -0.051488
           SH600004   -0.024804
           SH600009   -0.064638
           SH600010   -0.041556
           SH600011    0.000877
Epoch   700: reducing learning rate of group 0 to 1.0000e-03.
Epoch   960: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1180: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1400: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1620: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2020-01-15 SH600000    0.088237
           SH600004    0.090797
           SH600009    0.059369
           SH600010   -0.012408
           SH600011    0.035459
Epoch   640: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1040: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1260: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1480: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1700: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2020-02-20 SH600000    0.036440
           SH600004    0.044278
           SH600009    0.064654
           SH600010    0.054254
           SH600011    0.005381
Epoch   700: reducing learning rate of group 0 to 1.0000e-03.
Epoch   920: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1260: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1480: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1700: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1920: reducing learning rate of group 0 to 3.1250e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2020-03-19 SH600000    0.041207
           SH600004    0.089222
           SH600009    0.137896
           SH600010   -0.034579
           SH600011    0.102031
Epoch   520: reducing learning rate of group 0 to 1.0000e-03.
Epoch   740: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1020: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1240: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1500: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1720: reducing learning rate of group 0 to 3.1250e-05.
Epoch  1940: reducing learning rate of group 0 to 1.5625e-05.
Epoch  2160: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2020-04-17 SH600000   -0.069381
           SH600004    0.032995
           SH600009    0.052209
           SH600010   -0.045896
           SH600011    0.071723
Epoch   560: reducing learning rate of group 0 to 1.0000e-03.
Epoch   880: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1320: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1540: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1760: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1980: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2200: reducing learning rate of group 0 to 1.5625e-05.
Epoch  2420: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2020-05-20 SH600000   -0.039480
           SH600004   -0.039081
           SH600009    0.021412
           SH600010    0.028170
           SH600011   -0.037406
Epoch   520: reducing learning rate of group 0 to 1.0000e-03.
Epoch   740: reducing learning rate of group 0 to 5.0000e-04.
Epoch   960: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1180: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2020-06-17 SH600000    0.067298
           SH600004    0.076109
           SH600009    0.046531
           SH600010    0.020195
           SH600011   -0.031903
Epoch  1040: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1360: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1580: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1800: reducing learning rate of group 0 to 1.2500e-04.
Epoch  2020: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2020-07-17 SH600000   -0.115769
           SH600004   -0.008940
           SH600009    0.070413
           SH600010   -0.068648
           SH600011    0.018168
{'IC': 0.08087838138231697,
 'ICIR': 0.5611275542289964,
 'Rank IC': 0.09302527453535261,
 'Rank ICIR': 0.6209893400627864}
[2648869:MainThread](2024-03-27 12:15:37,929) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2648869:MainThread](2024-03-27 12:15:37,931) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2648869:MainThread](2024-03-27 12:15:37,937) WARNING - qlib.online operator - [exchange.py:226] - factor.day.bin file not exists or factor contains `nan`. Order using adjusted_price.
[2648869:MainThread](2024-03-27 12:15:37,938) WARNING - qlib.online operator - [exchange.py:228] - trade unit 100 is not supported in adjusted_price mode.
[2648869:MainThread](2024-03-27 12:15:42,136) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f91c68700d0>
backtest loop:   0%|          | 0/871 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 6/871 [00:00<00:16, 53.54it/s]backtest loop:   1%|▏         | 12/871 [00:00<00:15, 55.21it/s]backtest loop:   2%|▏         | 18/871 [00:00<00:16, 51.02it/s]backtest loop:   3%|▎         | 24/871 [00:00<00:17, 49.16it/s]backtest loop:   3%|▎         | 30/871 [00:00<00:16, 50.89it/s]backtest loop:   4%|▍         | 36/871 [00:00<00:15, 52.23it/s]backtest loop:   5%|▍         | 42/871 [00:00<00:15, 53.46it/s]backtest loop:   6%|▌         | 48/871 [00:01<00:20, 40.82it/s]backtest loop:   6%|▌         | 54/871 [00:01<00:19, 42.92it/s]backtest loop:   7%|▋         | 60/871 [00:01<00:17, 46.59it/s]backtest loop:   8%|▊         | 67/871 [00:01<00:16, 48.31it/s]backtest loop:   8%|▊         | 73/871 [00:01<00:15, 50.92it/s]backtest loop:   9%|▉         | 79/871 [00:01<00:15, 52.62it/s]backtest loop:  10%|▉         | 85/871 [00:01<00:14, 54.13it/s]backtest loop:  10%|█         | 91/871 [00:01<00:14, 52.39it/s]backtest loop:  11%|█         | 97/871 [00:01<00:14, 54.10it/s]backtest loop:  12%|█▏        | 104/871 [00:02<00:14, 53.62it/s]backtest loop:  13%|█▎        | 111/871 [00:02<00:13, 56.16it/s]backtest loop:  13%|█▎        | 117/871 [00:02<00:13, 56.87it/s]backtest loop:  14%|█▍        | 123/871 [00:02<00:13, 57.13it/s]backtest loop:  15%|█▍        | 129/871 [00:02<00:13, 54.99it/s]backtest loop:  15%|█▌        | 135/871 [00:02<00:13, 55.55it/s]backtest loop:  16%|█▌        | 141/871 [00:02<00:12, 56.60it/s]backtest loop:  17%|█▋        | 147/871 [00:02<00:12, 57.39it/s]backtest loop:  18%|█▊        | 153/871 [00:02<00:12, 56.99it/s]backtest loop:  18%|█▊        | 159/871 [00:03<00:13, 54.10it/s]backtest loop:  19%|█▉        | 165/871 [00:03<00:12, 55.12it/s]backtest loop:  20%|█▉        | 171/871 [00:03<00:12, 56.25it/s]backtest loop:  20%|██        | 178/871 [00:03<00:11, 57.95it/s]backtest loop:  21%|██        | 184/871 [00:03<00:12, 55.59it/s]backtest loop:  22%|██▏       | 190/871 [00:03<00:11, 56.77it/s]backtest loop:  23%|██▎       | 196/871 [00:03<00:11, 57.43it/s]backtest loop:  23%|██▎       | 202/871 [00:03<00:11, 57.87it/s]backtest loop:  24%|██▍       | 209/871 [00:03<00:11, 55.97it/s]backtest loop:  25%|██▍       | 215/871 [00:04<00:11, 56.57it/s]backtest loop:  25%|██▌       | 222/871 [00:04<00:11, 58.68it/s]backtest loop:  26%|██▌       | 228/871 [00:04<00:11, 58.10it/s]backtest loop:  27%|██▋       | 234/871 [00:04<00:11, 54.13it/s]backtest loop:  28%|██▊       | 240/871 [00:04<00:11, 54.80it/s]backtest loop:  28%|██▊       | 246/871 [00:04<00:11, 55.42it/s]backtest loop:  29%|██▉       | 252/871 [00:04<00:11, 55.62it/s]backtest loop:  30%|██▉       | 258/871 [00:04<00:11, 53.31it/s]backtest loop:  30%|███       | 264/871 [00:04<00:11, 53.98it/s]backtest loop:  31%|███       | 270/871 [00:05<00:10, 54.95it/s]backtest loop:  32%|███▏      | 276/871 [00:05<00:11, 53.41it/s]backtest loop:  32%|███▏      | 282/871 [00:05<00:10, 55.13it/s]backtest loop:  33%|███▎      | 288/871 [00:05<00:10, 53.60it/s]backtest loop:  34%|███▍      | 295/871 [00:05<00:10, 56.30it/s]backtest loop:  35%|███▍      | 301/871 [00:05<00:09, 57.01it/s]backtest loop:  35%|███▌      | 307/871 [00:05<00:10, 55.39it/s]backtest loop:  36%|███▌      | 313/871 [00:05<00:09, 56.40it/s]backtest loop:  37%|███▋      | 319/871 [00:05<00:09, 57.39it/s]backtest loop:  37%|███▋      | 325/871 [00:06<00:10, 54.51it/s]backtest loop:  38%|███▊      | 331/871 [00:06<00:09, 55.62it/s]backtest loop:  39%|███▊      | 337/871 [00:06<00:09, 56.14it/s]backtest loop:  39%|███▉      | 343/871 [00:06<00:09, 56.35it/s]backtest loop:  40%|████      | 349/871 [00:06<00:09, 53.67it/s]backtest loop:  41%|████      | 356/871 [00:06<00:09, 56.21it/s]backtest loop:  42%|████▏     | 363/871 [00:06<00:09, 55.47it/s]backtest loop:  42%|████▏     | 370/871 [00:06<00:08, 57.65it/s]backtest loop:  43%|████▎     | 377/871 [00:06<00:08, 60.01it/s]backtest loop:  44%|████▍     | 384/871 [00:07<00:08, 56.87it/s]backtest loop:  45%|████▍     | 390/871 [00:07<00:08, 57.64it/s]backtest loop:  45%|████▌     | 396/871 [00:07<00:08, 57.79it/s]backtest loop:  46%|████▌     | 402/871 [00:07<00:08, 57.89it/s]backtest loop:  47%|████▋     | 408/871 [00:07<00:08, 54.76it/s]backtest loop:  48%|████▊     | 414/871 [00:07<00:08, 55.96it/s]backtest loop:  48%|████▊     | 420/871 [00:07<00:07, 56.72it/s]backtest loop:  49%|████▉     | 426/871 [00:07<00:07, 56.89it/s]backtest loop:  50%|████▉     | 432/871 [00:07<00:08, 53.92it/s]backtest loop:  50%|█████     | 438/871 [00:08<00:07, 55.31it/s]backtest loop:  51%|█████     | 444/871 [00:08<00:07, 56.39it/s]backtest loop:  52%|█████▏    | 450/871 [00:08<00:07, 57.11it/s]backtest loop:  52%|█████▏    | 456/871 [00:08<00:07, 57.22it/s]backtest loop:  53%|█████▎    | 462/871 [00:08<00:07, 54.09it/s]backtest loop:  54%|█████▎    | 468/871 [00:08<00:07, 54.60it/s]backtest loop:  54%|█████▍    | 474/871 [00:08<00:07, 54.95it/s]backtest loop:  55%|█████▌    | 480/871 [00:08<00:07, 55.57it/s]backtest loop:  56%|█████▌    | 486/871 [00:08<00:06, 55.43it/s]backtest loop:  56%|█████▋    | 492/871 [00:08<00:07, 52.51it/s]backtest loop:  57%|█████▋    | 498/871 [00:09<00:06, 53.58it/s]backtest loop:  58%|█████▊    | 504/871 [00:09<00:06, 54.58it/s]backtest loop:  59%|█████▊    | 510/871 [00:09<00:07, 51.54it/s]backtest loop:  59%|█████▉    | 516/871 [00:09<00:06, 53.02it/s]backtest loop:  60%|█████▉    | 522/871 [00:09<00:06, 54.35it/s]backtest loop:  61%|██████    | 528/871 [00:09<00:06, 54.56it/s]backtest loop:  61%|██████▏   | 534/871 [00:09<00:06, 55.14it/s]backtest loop:  62%|██████▏   | 540/871 [00:09<00:06, 52.44it/s]backtest loop:  63%|██████▎   | 546/871 [00:09<00:06, 53.04it/s]backtest loop:  63%|██████▎   | 552/871 [00:10<00:05, 53.83it/s]backtest loop:  64%|██████▍   | 558/871 [00:10<00:05, 54.52it/s]backtest loop:  65%|██████▍   | 564/871 [00:10<00:05, 51.73it/s]/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:  66%|██████▌   | 571/871 [00:10<00:05, 54.78it/s]backtest loop:  66%|██████▌   | 577/871 [00:10<00:05, 55.12it/s]backtest loop:  67%|██████▋   | 583/871 [00:10<00:05, 55.42it/s]backtest loop:  68%|██████▊   | 589/871 [00:10<00:05, 55.97it/s]backtest loop:  68%|██████▊   | 595/871 [00:10<00:05, 52.94it/s]backtest loop:  69%|██████▉   | 601/871 [00:11<00:05, 53.88it/s]backtest loop:  70%|██████▉   | 607/871 [00:11<00:04, 54.48it/s]backtest loop:  70%|███████   | 613/871 [00:11<00:04, 54.87it/s]backtest loop:  71%|███████   | 619/871 [00:11<00:04, 55.13it/s]backtest loop:  72%|███████▏  | 625/871 [00:11<00:04, 52.19it/s]backtest loop:  72%|███████▏  | 631/871 [00:11<00:04, 53.29it/s]backtest loop:  73%|███████▎  | 637/871 [00:11<00:04, 54.05it/s]backtest loop:  74%|███████▍  | 643/871 [00:11<00:04, 55.05it/s]backtest loop:  75%|███████▍  | 649/871 [00:11<00:04, 55.34it/s]backtest loop:  75%|███████▌  | 655/871 [00:12<00:04, 52.25it/s]backtest loop:  76%|███████▌  | 661/871 [00:12<00:03, 53.30it/s]backtest loop:  77%|███████▋  | 667/871 [00:12<00:03, 54.00it/s]backtest loop:  77%|███████▋  | 673/871 [00:12<00:03, 51.25it/s]backtest loop:  78%|███████▊  | 679/871 [00:12<00:03, 49.63it/s]backtest loop:  79%|███████▊  | 685/871 [00:12<00:03, 51.23it/s]backtest loop:  79%|███████▉  | 691/871 [00:12<00:03, 52.18it/s]backtest loop:  80%|████████  | 697/871 [00:12<00:03, 53.25it/s]backtest loop:  81%|████████  | 703/871 [00:12<00:03, 54.01it/s]backtest loop:  81%|████████▏ | 709/871 [00:13<00:03, 51.44it/s]backtest loop:  82%|████████▏ | 715/871 [00:13<00:02, 52.22it/s]backtest loop:  83%|████████▎ | 721/871 [00:13<00:02, 53.23it/s]backtest loop:  83%|████████▎ | 727/871 [00:13<00:02, 54.00it/s]backtest loop:  84%|████████▍ | 733/871 [00:13<00:02, 48.68it/s]backtest loop:  85%|████████▍ | 739/871 [00:13<00:02, 50.39it/s]backtest loop:  86%|████████▌ | 745/871 [00:13<00:02, 51.96it/s]backtest loop:  86%|████████▌ | 751/871 [00:13<00:02, 53.44it/s]backtest loop:  87%|████████▋ | 757/871 [00:13<00:02, 51.09it/s]backtest loop:  88%|████████▊ | 763/871 [00:14<00:02, 52.49it/s]backtest loop:  88%|████████▊ | 769/871 [00:14<00:01, 53.52it/s]backtest loop:  89%|████████▉ | 775/871 [00:14<00:01, 54.35it/s]backtest loop:  90%|████████▉ | 781/871 [00:14<00:01, 55.06it/s]backtest loop:  90%|█████████ | 787/871 [00:14<00:01, 52.09it/s]backtest loop:  91%|█████████ | 793/871 [00:14<00:01, 53.20it/s]backtest loop:  92%|█████████▏| 799/871 [00:14<00:01, 53.94it/s]backtest loop:  92%|█████████▏| 805/871 [00:14<00:01, 54.45it/s]backtest loop:  93%|█████████▎| 811/871 [00:14<00:01, 51.65it/s]backtest loop:  94%|█████████▍| 817/871 [00:15<00:01, 52.87it/s]backtest loop:  94%|█████████▍| 823/871 [00:15<00:00, 50.73it/s]backtest loop:  95%|█████████▌| 829/871 [00:15<00:00, 52.15it/s]backtest loop:  96%|█████████▌| 835/871 [00:15<00:00, 53.38it/s]backtest loop:  97%|█████████▋| 841/871 [00:15<00:00, 54.17it/s]backtest loop:  97%|█████████▋| 847/871 [00:15<00:00, 51.55it/s]backtest loop:  98%|█████████▊| 853/871 [00:15<00:00, 52.84it/s]backtest loop:  99%|█████████▊| 859/871 [00:15<00:00, 53.72it/s]backtest loop:  99%|█████████▉| 865/871 [00:15<00:00, 54.42it/s]backtest loop: 100%|██████████| 871/871 [00:16<00:00, 51.84it/s]backtest loop: 100%|██████████| 871/871 [00:16<00:00, 54.00it/s]
[2648869:MainThread](2024-03-27 12:15:58,334) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
[2648869:MainThread](2024-03-27 12:15:58,350) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000477
std                0.012295
annualized_return  0.113561
information_ratio  0.598699
max_drawdown      -0.370479
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000681
std                0.004933
annualized_return  0.162106
information_ratio  2.130124
max_drawdown      -0.059229
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000498
std                0.004933
annualized_return  0.118425
information_ratio  1.556062
max_drawdown      -0.068435
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `None`.

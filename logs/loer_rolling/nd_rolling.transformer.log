[852901:MainThread](2024-04-06 19:22:02,582) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[852901:MainThread](2024-04-06 19:22:02,586) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[852901:MainThread](2024-04-06 19:22:02,587) INFO - qlib.Initialization - [__init__.py:76] - data_path={'day': PosixPath('/home/zhonghao/.qlib/qlib_data/my_data')}
[852901:MainThread](2024-04-06 19:22:02,590) WARNING - qlib.Rolling - [base.py:104] - Using user specifiied name for rolling models. So the experiment names duplicateds. Please manually remove your experiment for rolling model with command like `rm -r mlruns`. Otherwise it will prevents the creating of experimen with same name
[852901:MainThread](2024-04-06 19:22:02,590) WARNING - qlib.Rolling - [rolling_benchmark.py:32] - Model type is not in the benchmark!
[852901:MainThread](2024-04-06 19:22:02,609) INFO - qlib.Rolling - [base.py:162] - The prediction horizon is overrided
[852901:MainThread](2024-04-06 19:24:46,344) INFO - qlib.timer - [log.py:127] - Time cost: 163.731s | Loading data Done
[852901:MainThread](2024-04-06 19:24:47,816) INFO - qlib.timer - [log.py:127] - Time cost: 0.057s | FilterCol Done
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/qlib/data/dataset/processor.py:313: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[self.cols] = X
[852901:MainThread](2024-04-06 19:24:49,961) INFO - qlib.timer - [log.py:127] - Time cost: 2.144s | RobustZScoreNorm Done
[852901:MainThread](2024-04-06 19:24:50,157) INFO - qlib.timer - [log.py:127] - Time cost: 0.195s | Fillna Done
[852901:MainThread](2024-04-06 19:24:50,306) INFO - qlib.timer - [log.py:127] - Time cost: 0.092s | DropnaLabel Done
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/qlib/data/dataset/processor.py:379: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[cols] = t
[852901:MainThread](2024-04-06 19:24:50,934) INFO - qlib.timer - [log.py:127] - Time cost: 0.627s | CSRankNorm Done
[852901:MainThread](2024-04-06 19:24:50,935) INFO - qlib.timer - [log.py:127] - Time cost: 4.590s | fit & process data Done
[852901:MainThread](2024-04-06 19:24:50,936) INFO - qlib.timer - [log.py:127] - Time cost: 168.324s | Init data Done
[852901:MainThread](2024-04-06 19:24:54,108) INFO - qlib.Rolling - [base.py:173] - {'model': {'class': 'TransformerModel', 'module_path': 'qlib.contrib.model.pytorch_transformer_ts', 'kwargs': {'seed': 0, 'n_jobs': 20, 'GPU': 1}}, 'dataset': {'class': 'TSDatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/code/qlib/exp_yaml/longer_data/Alpha158.3c4b50182e.pkl', 'segments': {'train': [datetime.date(2008, 1, 1), datetime.date(2021, 3, 30)], 'valid': [datetime.date(2021, 3, 31), datetime.date(2022, 3, 31)], 'test': [datetime.date(2022, 4, 1), datetime.date(2024, 4, 1)]}, 'step_len': 20}}, 'record': [{'class': 'SignalRecord', 'module_path': 'qlib.workflow.record_temp', 'kwargs': {'model': '<MODEL>', 'dataset': '<DATASET>'}}, {'class': 'SigAnaRecord', 'module_path': 'qlib.workflow.record_temp', 'kwargs': {'ana_long_short': False, 'ann_scaler': 252}}, {'class': 'PortAnaRecord', 'module_path': 'qlib.workflow.record_temp', 'kwargs': {'config': {'strategy': {'class': 'TopkDropoutStrategy', 'module_path': 'qlib.contrib.strategy', 'kwargs': {'signal': '<PRED>', 'topk': 50, 'n_drop': 5}}, 'backtest': {'start_time': datetime.date(2022, 4, 1), 'end_time': datetime.date(2024, 4, 1), 'account': 100000000, 'benchmark': 'SH000300', 'exchange_kwargs': {'limit_threshold': 0.095, 'deal_price': 'close', 'open_cost': 0.0005, 'close_cost': 0.0015, 'min_cost': 5}}}}}]}
[852901:MainThread](2024-04-06 19:24:54,138) INFO - qlib.Rolling - [base.py:190] - Deleting previous Rolling results
[852901:MainThread](2024-04-06 19:24:54,140) INFO - qlib.Rolling - [base.py:196] - No previous rolling results
train tasks:   0%|          | 0/25 [00:00<?, ?it/s][852901:MainThread](2024-04-06 19:24:54,143) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name rolling_transformer_20240406192200673361561.
[852901:MainThread](2024-04-06 19:24:54,147) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 19:24:54,418) INFO - qlib.workflow - [recorder.py:341] - Recorder 62b60be659f74d589c3293f946ca6162 starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 19:24:56,144) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 19:25:06,498) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 19:25:16,309) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 19:25:16,310) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 19:25:16,312) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
ModuleNotFoundError. CatBoostModel are skipped. (optional: maybe installing CatBoostModel can fix it.)
[852901:MainThread](2024-04-06 19:25:44,697) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:26:15,967) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986413, valid -0.999626
[852901:MainThread](2024-04-06 19:26:15,973) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 19:26:15,975) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:26:43,264) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:27:15,294) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983414, valid -1.003049
[852901:MainThread](2024-04-06 19:27:15,295) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 19:27:15,295) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:27:43,491) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:28:18,214) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979951, valid -1.003223
[852901:MainThread](2024-04-06 19:28:18,217) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 19:28:18,218) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:28:46,305) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:29:30,008) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979390, valid -1.000859
[852901:MainThread](2024-04-06 19:29:30,027) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 19:29:30,028) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:30:01,807) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:30:46,569) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976587, valid -1.004093
[852901:MainThread](2024-04-06 19:30:46,572) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 19:30:46,575) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:31:22,800) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:32:01,607) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976884, valid -1.006320
[852901:MainThread](2024-04-06 19:32:01,607) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 19:32:01,608) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.999626 @ 0
[852901:MainThread](2024-04-06 19:32:13,873) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 19:32:15,368) INFO - qlib.timer - [log.py:127] - Time cost: 0.001s | waiting `async_log` Done
train tasks:   4%|▍         | 1/25 [07:21<2:56:29, 441.24s/it][852901:MainThread](2024-04-06 19:32:15,396) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 19:32:15,431) INFO - qlib.workflow - [recorder.py:341] - Recorder 519554dc6c1b45ad89f76cf940eac889 starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 19:32:16,583) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 19:32:18,470) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 19:32:42,268) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 19:32:42,286) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 19:32:42,287) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-04-01 SH600000    0.184140
2022-04-06 SH600000    0.174861
2022-04-07 SH600000    0.165100
2022-04-08 SH600000    0.166365
2022-04-11 SH600000    0.178219
[852901:MainThread](2024-04-06 19:33:19,128) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:33:55,028) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986522, valid -0.998884
[852901:MainThread](2024-04-06 19:33:55,033) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 19:33:55,035) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:34:23,987) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:35:08,767) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983053, valid -1.001368
[852901:MainThread](2024-04-06 19:35:08,768) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 19:35:08,773) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:35:50,254) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:36:23,166) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979986, valid -1.002854
[852901:MainThread](2024-04-06 19:36:23,169) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 19:36:23,171) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:36:56,036) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:37:34,028) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977728, valid -1.005838
[852901:MainThread](2024-04-06 19:37:34,033) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 19:37:34,035) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:38:00,683) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:38:31,291) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976133, valid -1.002373
[852901:MainThread](2024-04-06 19:38:31,303) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 19:38:31,311) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:38:58,885) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:39:29,854) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986350, valid -1.018207
[852901:MainThread](2024-04-06 19:39:29,858) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 19:39:29,860) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.998884 @ 0
[852901:MainThread](2024-04-06 19:39:35,849) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 19:39:37,204) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   8%|▊         | 2/25 [14:43<2:49:16, 441.59s/it][852901:MainThread](2024-04-06 19:39:37,222) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 19:39:37,246) INFO - qlib.workflow - [recorder.py:341] - Recorder 5744e58ef84448d4ae8aceb482775bd9 starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 19:39:38,367) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 19:39:40,403) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 19:39:59,635) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 19:39:59,636) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 19:39:59,637) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-05-06 SH600000    0.201324
2022-05-09 SH600000    0.143817
2022-05-10 SH600000    0.137226
2022-05-11 SH600000    0.139741
2022-05-12 SH600000    0.149638
[852901:MainThread](2024-04-06 19:40:29,167) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:41:02,759) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986701, valid -0.999280
[852901:MainThread](2024-04-06 19:41:02,766) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 19:41:02,771) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:41:27,799) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:42:02,570) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982919, valid -1.001318
[852901:MainThread](2024-04-06 19:42:02,573) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 19:42:02,573) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:42:30,279) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:43:02,384) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980335, valid -0.997976
[852901:MainThread](2024-04-06 19:43:02,401) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 19:43:02,402) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:43:28,794) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:44:03,755) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980573, valid -0.999597
[852901:MainThread](2024-04-06 19:44:03,756) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 19:44:03,757) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:44:32,284) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:44:59,902) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976473, valid -1.001186
[852901:MainThread](2024-04-06 19:44:59,905) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 19:44:59,910) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:45:28,961) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:46:02,964) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977588, valid -1.004188
[852901:MainThread](2024-04-06 19:46:02,970) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 19:46:02,972) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:46:28,549) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:47:01,063) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973247, valid -1.003562
[852901:MainThread](2024-04-06 19:47:01,064) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[852901:MainThread](2024-04-06 19:47:01,065) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:47:28,673) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:48:00,530) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971930, valid -1.002597
[852901:MainThread](2024-04-06 19:48:00,533) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 19:48:00,533) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.997976 @ 2
[852901:MainThread](2024-04-06 19:48:06,246) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 19:48:07,838) INFO - qlib.timer - [log.py:127] - Time cost: 0.002s | waiting `async_log` Done
train tasks:  12%|█▏        | 3/25 [23:13<2:53:28, 473.11s/it][852901:MainThread](2024-04-06 19:48:07,871) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 19:48:07,904) INFO - qlib.workflow - [recorder.py:341] - Recorder c7edb48a99fc46569ad349ad7a891678 starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 19:48:09,057) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 19:48:10,913) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 19:48:32,127) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 19:48:32,136) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 19:48:32,138) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-06-06 SH600000    0.129533
2022-06-07 SH600000    0.100910
2022-06-08 SH600000    0.103896
2022-06-09 SH600000    0.152261
2022-06-10 SH600000    0.121915
[852901:MainThread](2024-04-06 19:48:58,945) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:49:33,742) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987086, valid -0.997554
[852901:MainThread](2024-04-06 19:49:33,750) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 19:49:33,756) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:49:59,511) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:50:35,830) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983831, valid -0.998532
[852901:MainThread](2024-04-06 19:50:35,832) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 19:50:35,834) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:51:01,432) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:51:29,649) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980460, valid -0.995011
[852901:MainThread](2024-04-06 19:51:29,659) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 19:51:29,660) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:51:54,159) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:52:21,604) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979798, valid -0.993169
[852901:MainThread](2024-04-06 19:52:21,610) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 19:52:21,611) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:52:41,804) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:53:12,252) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977345, valid -0.993388
[852901:MainThread](2024-04-06 19:53:12,253) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 19:53:12,253) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:53:29,665) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:53:58,751) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976743, valid -0.998144
[852901:MainThread](2024-04-06 19:53:58,752) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 19:53:58,753) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:54:22,128) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:54:46,609) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975597, valid -0.996714
[852901:MainThread](2024-04-06 19:54:46,610) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[852901:MainThread](2024-04-06 19:54:46,610) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:55:10,716) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:55:36,687) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973628, valid -0.993317
[852901:MainThread](2024-04-06 19:55:36,688) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[852901:MainThread](2024-04-06 19:55:36,689) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:55:58,387) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:56:27,891) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972467, valid -0.996112
[852901:MainThread](2024-04-06 19:56:27,892) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 19:56:27,892) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.993169 @ 3
[852901:MainThread](2024-04-06 19:56:32,313) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 19:56:33,842) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  16%|█▌        | 4/25 [31:39<2:50:08, 486.10s/it][852901:MainThread](2024-04-06 19:56:33,858) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 19:56:33,879) INFO - qlib.workflow - [recorder.py:341] - Recorder b995d39696924bd28c042e4feb28aa81 starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 19:56:34,601) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 19:56:36,045) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 19:56:46,803) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 19:56:46,804) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 19:56:46,805) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-07-04 SH600000    0.227767
2022-07-05 SH600000    0.214156
2022-07-06 SH600000    0.213893
2022-07-07 SH600000    0.218161
2022-07-08 SH600000    0.209253
[852901:MainThread](2024-04-06 19:57:10,742) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:57:38,187) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988024, valid -0.988537
[852901:MainThread](2024-04-06 19:57:38,194) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 19:57:38,195) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:58:02,342) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:58:29,951) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983801, valid -0.986986
[852901:MainThread](2024-04-06 19:58:29,956) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 19:58:29,958) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:58:54,056) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 19:59:19,523) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980928, valid -0.985537
[852901:MainThread](2024-04-06 19:59:19,529) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 19:59:19,530) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 19:59:42,275) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:00:06,569) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978893, valid -0.985541
[852901:MainThread](2024-04-06 20:00:06,571) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 20:00:06,572) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:00:24,191) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:00:47,438) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978121, valid -0.986796
[852901:MainThread](2024-04-06 20:00:47,438) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 20:00:47,439) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:01:06,002) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:01:26,439) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975887, valid -0.984737
[852901:MainThread](2024-04-06 20:01:26,445) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 20:01:26,445) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:01:43,796) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:02:04,909) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974767, valid -0.986810
[852901:MainThread](2024-04-06 20:02:04,911) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[852901:MainThread](2024-04-06 20:02:04,912) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:02:22,190) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:02:44,977) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973367, valid -0.986459
[852901:MainThread](2024-04-06 20:02:44,983) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[852901:MainThread](2024-04-06 20:02:44,984) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:03:02,035) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:03:22,460) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971624, valid -0.988019
[852901:MainThread](2024-04-06 20:03:22,461) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[852901:MainThread](2024-04-06 20:03:22,462) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:03:37,693) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:03:58,421) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970586, valid -0.985921
[852901:MainThread](2024-04-06 20:03:58,422) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[852901:MainThread](2024-04-06 20:03:58,423) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:04:14,821) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:04:31,448) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.969400, valid -0.988344
[852901:MainThread](2024-04-06 20:04:31,448) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 20:04:31,449) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.984737 @ 5
[852901:MainThread](2024-04-06 20:04:35,387) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 20:04:36,516) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  20%|██        | 5/25 [39:42<2:41:37, 484.86s/it][852901:MainThread](2024-04-06 20:04:36,532) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 20:04:36,555) INFO - qlib.workflow - [recorder.py:341] - Recorder 08c1ec685c894836b2f40a93b8ffead5 starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 20:04:37,147) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 20:04:38,190) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 20:04:45,127) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 20:04:45,128) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 20:04:45,129) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-08-01 SH600000    0.207496
2022-08-02 SH600000    0.175516
2022-08-03 SH600000    0.165946
2022-08-04 SH600000    0.107376
2022-08-05 SH600000    0.141457
[852901:MainThread](2024-04-06 20:05:03,913) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:05:25,843) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987609, valid -0.984427
[852901:MainThread](2024-04-06 20:05:25,847) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 20:05:25,847) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:05:44,425) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:06:07,856) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983858, valid -0.982253
[852901:MainThread](2024-04-06 20:06:07,860) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 20:06:07,861) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:06:26,915) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:06:49,238) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982231, valid -0.980628
[852901:MainThread](2024-04-06 20:06:49,245) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 20:06:49,246) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:07:09,092) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:07:31,652) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979582, valid -0.981399
[852901:MainThread](2024-04-06 20:07:31,653) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 20:07:31,654) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:07:51,738) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:08:14,020) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977546, valid -0.982888
[852901:MainThread](2024-04-06 20:08:14,020) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 20:08:14,021) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:08:32,418) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:08:55,079) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976766, valid -0.986887
[852901:MainThread](2024-04-06 20:08:55,080) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 20:08:55,081) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:09:12,828) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:09:35,108) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974677, valid -0.983820
[852901:MainThread](2024-04-06 20:09:35,109) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[852901:MainThread](2024-04-06 20:09:35,109) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:09:53,338) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:10:16,225) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973677, valid -0.982295
[852901:MainThread](2024-04-06 20:10:16,227) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 20:10:16,227) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.980628 @ 2
[852901:MainThread](2024-04-06 20:10:20,779) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 20:10:21,697) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  24%|██▍       | 6/25 [45:27<2:18:30, 437.37s/it][852901:MainThread](2024-04-06 20:10:21,712) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 20:10:21,728) INFO - qlib.workflow - [recorder.py:341] - Recorder b3eaf5dfefcc48cf89c74d9f269a6d36 starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 20:10:22,351) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 20:10:23,334) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 20:10:30,377) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 20:10:30,379) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 20:10:30,380) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-08-29 SH600000    0.118644
2022-08-30 SH600000    0.079627
2022-08-31 SH600000    0.053253
2022-09-01 SH600000    0.054070
2022-09-02 SH600000    0.040488
[852901:MainThread](2024-04-06 20:10:50,700) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:11:10,928) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987135, valid -0.985165
[852901:MainThread](2024-04-06 20:11:10,932) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 20:11:10,933) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:11:32,738) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:11:52,735) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983361, valid -0.986637
[852901:MainThread](2024-04-06 20:11:52,735) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 20:11:52,736) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:12:15,547) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:12:36,805) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981016, valid -0.983610
[852901:MainThread](2024-04-06 20:12:36,810) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 20:12:36,810) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:12:51,496) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:13:13,660) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979995, valid -0.988491
[852901:MainThread](2024-04-06 20:13:13,661) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 20:13:13,661) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:13:32,531) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:13:55,054) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980590, valid -0.989500
[852901:MainThread](2024-04-06 20:13:55,055) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 20:13:55,055) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:14:13,963) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:14:37,679) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976240, valid -0.985362
[852901:MainThread](2024-04-06 20:14:37,681) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 20:14:37,682) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:14:54,705) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:15:17,851) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975681, valid -0.987521
[852901:MainThread](2024-04-06 20:15:17,853) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[852901:MainThread](2024-04-06 20:15:17,854) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:15:35,685) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:15:59,674) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974261, valid -0.990465
[852901:MainThread](2024-04-06 20:15:59,675) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 20:15:59,676) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.983610 @ 2
[852901:MainThread](2024-04-06 20:16:03,701) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 20:16:04,939) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  28%|██▊       | 7/25 [51:10<2:01:58, 406.60s/it][852901:MainThread](2024-04-06 20:16:04,953) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 20:16:04,965) INFO - qlib.workflow - [recorder.py:341] - Recorder e673c3b7d5be4d81978e325549f1ee26 starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 20:16:05,589) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 20:16:06,370) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 20:16:15,753) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 20:16:15,754) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 20:16:15,754) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-09-27 SH600000    0.050264
2022-09-28 SH600000    0.042307
2022-09-29 SH600000    0.047345
2022-09-30 SH600000    0.065942
2022-10-10 SH600000    0.071494
[852901:MainThread](2024-04-06 20:16:35,388) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:16:55,719) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987305, valid -0.984056
[852901:MainThread](2024-04-06 20:16:55,723) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 20:16:55,723) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:17:14,709) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:17:35,409) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.984139, valid -0.981360
[852901:MainThread](2024-04-06 20:17:35,417) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 20:17:35,418) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:17:54,803) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:18:14,796) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981296, valid -0.980703
[852901:MainThread](2024-04-06 20:18:14,800) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 20:18:14,801) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:18:32,702) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:18:49,846) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979798, valid -0.984488
[852901:MainThread](2024-04-06 20:18:49,846) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 20:18:49,847) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:19:04,344) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:19:25,558) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979850, valid -0.985118
[852901:MainThread](2024-04-06 20:19:25,558) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 20:19:25,559) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:19:41,589) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:20:03,139) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975968, valid -0.978769
[852901:MainThread](2024-04-06 20:20:03,145) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 20:20:03,146) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:20:20,068) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:20:43,393) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976403, valid -0.980685
[852901:MainThread](2024-04-06 20:20:43,394) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[852901:MainThread](2024-04-06 20:20:43,395) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:21:00,983) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:21:22,734) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973519, valid -0.984032
[852901:MainThread](2024-04-06 20:21:22,735) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[852901:MainThread](2024-04-06 20:21:22,736) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:21:40,468) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:22:00,180) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972466, valid -0.981933
[852901:MainThread](2024-04-06 20:22:00,181) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[852901:MainThread](2024-04-06 20:22:00,182) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:22:16,851) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:22:38,639) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972100, valid -0.984430
[852901:MainThread](2024-04-06 20:22:38,640) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[852901:MainThread](2024-04-06 20:22:38,640) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:22:56,009) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:23:17,614) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970576, valid -0.984998
[852901:MainThread](2024-04-06 20:23:17,615) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 20:23:17,615) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.978769 @ 5
[852901:MainThread](2024-04-06 20:23:21,031) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 20:23:22,700) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  32%|███▏      | 8/25 [58:28<1:58:00, 416.52s/it][852901:MainThread](2024-04-06 20:23:22,717) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 20:23:22,735) INFO - qlib.workflow - [recorder.py:341] - Recorder bc587074e2274ca79b85941a941606c8 starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 20:23:23,339) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 20:23:24,141) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 20:23:33,327) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 20:23:33,329) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 20:23:33,330) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-11-01 SH600000    0.024223
2022-11-02 SH600000    0.037105
2022-11-03 SH600000    0.055172
2022-11-04 SH600000    0.056547
2022-11-07 SH600000    0.101573
[852901:MainThread](2024-04-06 20:23:54,261) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:24:12,470) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987177, valid -0.983723
[852901:MainThread](2024-04-06 20:24:12,475) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 20:24:12,475) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:24:30,211) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:24:49,023) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983947, valid -0.982187
[852901:MainThread](2024-04-06 20:24:49,030) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 20:24:49,030) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:25:07,070) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:25:25,963) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981297, valid -0.982883
[852901:MainThread](2024-04-06 20:25:25,965) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 20:25:25,966) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:25:45,362) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:26:04,401) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979717, valid -0.980348
[852901:MainThread](2024-04-06 20:26:04,416) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 20:26:04,417) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:26:23,936) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:26:44,095) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978181, valid -0.985559
[852901:MainThread](2024-04-06 20:26:44,097) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 20:26:44,097) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:27:04,070) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:27:22,231) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977420, valid -0.979296
[852901:MainThread](2024-04-06 20:27:22,234) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 20:27:22,235) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:27:35,798) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:27:58,998) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975739, valid -0.984100
[852901:MainThread](2024-04-06 20:27:59,002) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[852901:MainThread](2024-04-06 20:27:59,003) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:28:15,636) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:28:37,035) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976921, valid -0.986757
[852901:MainThread](2024-04-06 20:28:37,037) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[852901:MainThread](2024-04-06 20:28:37,038) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:28:53,069) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:29:14,365) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972609, valid -0.982054
[852901:MainThread](2024-04-06 20:29:14,367) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[852901:MainThread](2024-04-06 20:29:14,367) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:29:30,583) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:29:54,259) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971119, valid -0.986105
[852901:MainThread](2024-04-06 20:29:54,260) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[852901:MainThread](2024-04-06 20:29:54,260) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:30:10,033) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:30:31,225) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975264, valid -0.984725
[852901:MainThread](2024-04-06 20:30:31,228) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 20:30:31,229) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.979296 @ 5
[852901:MainThread](2024-04-06 20:30:35,325) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 20:30:36,423) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  36%|███▌      | 9/25 [1:05:42<1:52:30, 421.90s/it][852901:MainThread](2024-04-06 20:30:36,440) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 20:30:36,461) INFO - qlib.workflow - [recorder.py:341] - Recorder e7892f41129048f1961a8fd257e223da starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 20:30:36,977) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 20:30:37,850) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 20:30:45,815) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 20:30:45,817) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 20:30:45,818) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-11-29 SH600000    0.166654
2022-11-30 SH600000    0.142466
2022-12-01 SH600000    0.199451
2022-12-02 SH600000    0.208776
2022-12-05 SH600000    0.205256
[852901:MainThread](2024-04-06 20:31:06,186) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:31:28,083) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988346, valid -0.987192
[852901:MainThread](2024-04-06 20:31:28,089) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 20:31:28,090) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:31:47,355) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:32:06,341) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983887, valid -0.981925
[852901:MainThread](2024-04-06 20:32:06,348) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 20:32:06,349) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:32:28,917) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:32:46,948) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981881, valid -0.985881
[852901:MainThread](2024-04-06 20:32:46,949) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 20:32:46,949) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:33:05,042) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:33:27,544) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980084, valid -0.986882
[852901:MainThread](2024-04-06 20:33:27,545) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 20:33:27,545) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:33:48,281) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:34:08,673) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977778, valid -0.981833
[852901:MainThread](2024-04-06 20:34:08,678) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 20:34:08,678) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:34:28,362) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:34:50,810) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977215, valid -0.983610
[852901:MainThread](2024-04-06 20:34:50,811) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 20:34:50,811) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:35:12,098) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:35:33,029) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975222, valid -0.983524
[852901:MainThread](2024-04-06 20:35:33,030) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[852901:MainThread](2024-04-06 20:35:33,031) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:35:55,353) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:36:16,582) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975217, valid -0.987572
[852901:MainThread](2024-04-06 20:36:16,582) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[852901:MainThread](2024-04-06 20:36:16,583) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:36:40,110) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:37:01,698) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975817, valid -0.990453
[852901:MainThread](2024-04-06 20:37:01,699) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[852901:MainThread](2024-04-06 20:37:01,699) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:37:24,309) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:37:45,692) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972386, valid -0.985786
[852901:MainThread](2024-04-06 20:37:45,693) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 20:37:45,694) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.981833 @ 4
[852901:MainThread](2024-04-06 20:37:49,366) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 20:37:51,063) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  40%|████      | 10/25 [1:12:56<1:46:27, 425.83s/it][852901:MainThread](2024-04-06 20:37:51,075) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 20:37:51,086) INFO - qlib.workflow - [recorder.py:341] - Recorder 35633ddd50bb44afba6a67f53febb7a6 starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 20:37:51,620) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 20:37:52,369) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 20:37:58,747) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 20:37:58,747) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 20:37:58,747) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-12-27 SH600000    0.144821
2022-12-28 SH600000    0.166174
2022-12-29 SH600000    0.150790
2022-12-30 SH600000    0.074392
2023-01-03 SH600000    0.090459
[852901:MainThread](2024-04-06 20:38:22,716) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:38:43,948) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987202, valid -0.982798
[852901:MainThread](2024-04-06 20:38:43,953) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 20:38:43,953) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:39:04,385) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:39:24,421) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988211, valid -0.989046
[852901:MainThread](2024-04-06 20:39:24,422) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 20:39:24,422) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:39:45,524) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:40:07,046) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981542, valid -0.980142
[852901:MainThread](2024-04-06 20:40:07,051) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 20:40:07,052) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:40:27,035) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:40:47,439) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981181, valid -0.977917
[852901:MainThread](2024-04-06 20:40:47,449) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 20:40:47,451) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:41:07,441) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:41:29,309) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978827, valid -0.982486
[852901:MainThread](2024-04-06 20:41:29,311) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 20:41:29,312) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:41:49,075) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:42:09,914) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977868, valid -0.977266
[852901:MainThread](2024-04-06 20:42:09,920) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 20:42:09,920) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:42:30,724) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:42:48,169) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976550, valid -0.985281
[852901:MainThread](2024-04-06 20:42:48,170) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[852901:MainThread](2024-04-06 20:42:48,170) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:43:08,948) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:43:30,449) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976178, valid -0.986130
[852901:MainThread](2024-04-06 20:43:30,449) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[852901:MainThread](2024-04-06 20:43:30,450) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:43:51,643) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:44:16,093) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973812, valid -0.979208
[852901:MainThread](2024-04-06 20:44:16,094) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[852901:MainThread](2024-04-06 20:44:16,095) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:44:39,509) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:45:00,699) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972187, valid -0.980982
[852901:MainThread](2024-04-06 20:45:00,700) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[852901:MainThread](2024-04-06 20:45:00,700) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:45:23,449) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:45:46,326) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971354, valid -0.980392
[852901:MainThread](2024-04-06 20:45:46,327) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 20:45:46,328) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.977266 @ 5
[852901:MainThread](2024-04-06 20:45:49,992) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 20:45:51,137) INFO - qlib.timer - [log.py:127] - Time cost: 0.001s | waiting `async_log` Done
train tasks:  44%|████▍     | 11/25 [1:20:57<1:43:14, 442.43s/it][852901:MainThread](2024-04-06 20:45:51,154) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 20:45:51,170) INFO - qlib.workflow - [recorder.py:341] - Recorder 31d23d2f83da4d7badb920a60e658582 starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 20:45:52,108) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 20:45:53,310) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 20:46:02,100) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 20:46:02,100) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 20:46:02,101) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-02-01 SH600000    0.078164
2023-02-02 SH600000    0.079023
2023-02-03 SH600000    0.079270
2023-02-06 SH600000    0.053321
2023-02-07 SH600000    0.056568
[852901:MainThread](2024-04-06 20:46:22,433) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:46:47,019) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987180, valid -0.982277
[852901:MainThread](2024-04-06 20:46:47,029) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 20:46:47,029) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:47:05,285) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:47:21,059) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983588, valid -0.981019
[852901:MainThread](2024-04-06 20:47:21,064) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 20:47:21,064) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:47:43,137) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:48:03,124) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981234, valid -0.977662
[852901:MainThread](2024-04-06 20:48:03,127) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 20:48:03,128) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:48:24,795) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:48:46,071) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979435, valid -0.977193
[852901:MainThread](2024-04-06 20:48:46,080) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 20:48:46,081) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:49:05,696) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:49:28,503) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977440, valid -0.980240
[852901:MainThread](2024-04-06 20:49:28,504) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 20:49:28,505) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:49:48,271) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:50:09,128) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976418, valid -0.980751
[852901:MainThread](2024-04-06 20:50:09,129) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 20:50:09,130) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:50:29,219) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:50:49,032) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975520, valid -0.981114
[852901:MainThread](2024-04-06 20:50:49,034) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[852901:MainThread](2024-04-06 20:50:49,034) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:51:08,415) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:51:29,233) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976434, valid -0.979221
[852901:MainThread](2024-04-06 20:51:29,235) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[852901:MainThread](2024-04-06 20:51:29,235) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:51:49,714) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:52:08,285) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973895, valid -0.981545
[852901:MainThread](2024-04-06 20:52:08,287) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 20:52:08,288) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.977193 @ 3
[852901:MainThread](2024-04-06 20:52:12,894) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 20:52:14,638) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  48%|████▊     | 12/25 [1:27:20<1:31:58, 424.50s/it][852901:MainThread](2024-04-06 20:52:14,649) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 20:52:14,660) INFO - qlib.workflow - [recorder.py:341] - Recorder cfa1a5c12165488dbba3aa2ee5334ccf starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 20:52:15,177) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 20:52:15,909) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 20:52:25,613) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 20:52:25,614) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 20:52:25,614) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-03-01 SH600000    0.191577
2023-03-02 SH600000    0.192160
2023-03-03 SH600000    0.229585
2023-03-06 SH600000    0.239470
2023-03-07 SH600000    0.250210
[852901:MainThread](2024-04-06 20:52:43,759) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:53:07,297) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987286, valid -0.981064
[852901:MainThread](2024-04-06 20:53:07,305) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 20:53:07,305) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:53:25,614) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:53:48,032) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983575, valid -0.982436
[852901:MainThread](2024-04-06 20:53:48,032) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 20:53:48,032) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:54:05,240) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:54:28,208) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981915, valid -0.985905
[852901:MainThread](2024-04-06 20:54:28,209) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 20:54:28,215) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:54:44,329) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:55:00,724) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979825, valid -0.983284
[852901:MainThread](2024-04-06 20:55:00,725) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 20:55:00,726) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:55:14,906) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:55:30,831) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977728, valid -0.979055
[852901:MainThread](2024-04-06 20:55:30,834) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 20:55:30,835) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:55:44,882) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:56:01,478) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977273, valid -0.980319
[852901:MainThread](2024-04-06 20:56:01,479) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 20:56:01,479) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:56:15,685) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:56:31,532) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976040, valid -0.986450
[852901:MainThread](2024-04-06 20:56:31,532) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[852901:MainThread](2024-04-06 20:56:31,533) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:56:45,910) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:57:04,044) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974280, valid -0.982848
[852901:MainThread](2024-04-06 20:57:04,045) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[852901:MainThread](2024-04-06 20:57:04,045) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:57:18,154) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:57:33,295) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975603, valid -0.982131
[852901:MainThread](2024-04-06 20:57:33,296) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[852901:MainThread](2024-04-06 20:57:33,296) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:57:47,210) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:58:04,248) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971901, valid -0.986147
[852901:MainThread](2024-04-06 20:58:04,248) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 20:58:04,249) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.979055 @ 4
[852901:MainThread](2024-04-06 20:58:07,373) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 20:58:08,403) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  52%|█████▏    | 13/25 [1:33:14<1:20:36, 403.08s/it][852901:MainThread](2024-04-06 20:58:08,418) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 20:58:08,439) INFO - qlib.workflow - [recorder.py:341] - Recorder 26bece9acf10447796391031ded6feba starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 20:58:08,900) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 20:58:09,806) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 20:58:15,999) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 20:58:15,999) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 20:58:16,000) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-03-29 SH600000    0.250032
2023-03-30 SH600000    0.250259
2023-03-31 SH600000    0.247920
2023-04-03 SH600000    0.210694
2023-04-04 SH600000    0.198424
[852901:MainThread](2024-04-06 20:58:30,820) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:58:48,221) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986978, valid -0.987442
[852901:MainThread](2024-04-06 20:58:48,225) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 20:58:48,225) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:59:02,588) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:59:18,441) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.984542, valid -0.985085
[852901:MainThread](2024-04-06 20:59:18,445) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 20:59:18,446) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 20:59:33,175) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 20:59:50,709) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981052, valid -0.983946
[852901:MainThread](2024-04-06 20:59:50,712) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 20:59:50,713) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:00:05,350) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:00:21,494) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979793, valid -0.986577
[852901:MainThread](2024-04-06 21:00:21,495) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 21:00:21,496) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:00:39,172) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:00:54,535) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977770, valid -0.984883
[852901:MainThread](2024-04-06 21:00:54,536) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 21:00:54,536) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:01:09,381) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:01:25,955) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976689, valid -0.985227
[852901:MainThread](2024-04-06 21:01:25,956) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 21:01:25,957) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:01:40,416) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:01:57,417) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975096, valid -0.986573
[852901:MainThread](2024-04-06 21:01:57,417) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[852901:MainThread](2024-04-06 21:01:57,418) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:02:11,817) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:02:30,076) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974205, valid -0.984485
[852901:MainThread](2024-04-06 21:02:30,076) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 21:02:30,077) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.983946 @ 2
[852901:MainThread](2024-04-06 21:02:33,770) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 21:02:34,816) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  56%|█████▌    | 14/25 [1:37:40<1:06:19, 361.80s/it][852901:MainThread](2024-04-06 21:02:34,826) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 21:02:34,837) INFO - qlib.workflow - [recorder.py:341] - Recorder 0bb0ca46bde747dabc48e07e243a0235 starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 21:02:35,345) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 21:02:36,093) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 21:02:42,953) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 21:02:42,954) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 21:02:42,954) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-04-27 SH600000    0.131293
2023-04-28 SH600000    0.157925
2023-05-04 SH600000   -0.055944
2023-05-05 SH600000    0.112645
2023-05-08 SH600000    0.009084
[852901:MainThread](2024-04-06 21:02:58,051) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:03:15,847) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987355, valid -0.984008
[852901:MainThread](2024-04-06 21:03:15,851) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 21:03:15,852) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:03:30,652) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:03:46,260) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.984329, valid -0.986537
[852901:MainThread](2024-04-06 21:03:46,260) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 21:03:46,261) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:04:00,972) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:04:17,451) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982647, valid -0.987340
[852901:MainThread](2024-04-06 21:04:17,453) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 21:04:17,454) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:04:32,527) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:04:48,265) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979458, valid -0.982658
[852901:MainThread](2024-04-06 21:04:48,268) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 21:04:48,269) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:05:04,540) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:05:20,574) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977546, valid -0.980555
[852901:MainThread](2024-04-06 21:05:20,578) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 21:05:20,578) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:05:34,919) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:05:53,031) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977817, valid -0.990959
[852901:MainThread](2024-04-06 21:05:53,032) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 21:05:53,032) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:06:07,270) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:06:22,936) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975460, valid -0.978743
[852901:MainThread](2024-04-06 21:06:22,940) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[852901:MainThread](2024-04-06 21:06:22,941) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:06:37,432) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:06:55,341) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973738, valid -0.986268
[852901:MainThread](2024-04-06 21:06:55,342) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[852901:MainThread](2024-04-06 21:06:55,342) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:07:10,259) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:07:26,229) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972333, valid -0.981832
[852901:MainThread](2024-04-06 21:07:26,230) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[852901:MainThread](2024-04-06 21:07:26,230) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:07:41,789) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:07:57,536) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971309, valid -0.986356
[852901:MainThread](2024-04-06 21:07:57,537) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[852901:MainThread](2024-04-06 21:07:57,537) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:08:12,632) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:08:28,913) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970220, valid -0.985624
[852901:MainThread](2024-04-06 21:08:28,914) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch11:
[852901:MainThread](2024-04-06 21:08:28,914) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:08:43,045) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:08:58,828) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971163, valid -0.989824
[852901:MainThread](2024-04-06 21:08:58,829) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 21:08:58,829) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.978743 @ 6
[852901:MainThread](2024-04-06 21:09:02,119) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 21:09:03,844) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  60%|██████    | 15/25 [1:44:09<1:01:40, 370.01s/it][852901:MainThread](2024-04-06 21:09:03,860) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 21:09:03,876) INFO - qlib.workflow - [recorder.py:341] - Recorder 11cc0f3a24774888945b4a07eaa72115 starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 21:09:04,276) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 21:09:05,254) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 21:09:11,489) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 21:09:11,490) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 21:09:11,490) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-05-30 SH600000    0.032312
2023-05-31 SH600000    0.033754
2023-06-01 SH600000    0.010993
2023-06-02 SH600000    0.004281
2023-06-05 SH600000   -0.004206
[852901:MainThread](2024-04-06 21:09:27,136) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:09:42,530) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986899, valid -0.988023
[852901:MainThread](2024-04-06 21:09:42,533) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 21:09:42,534) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:09:56,502) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:10:13,409) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.984391, valid -0.985458
[852901:MainThread](2024-04-06 21:10:13,413) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 21:10:13,414) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:10:27,415) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:10:43,011) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981280, valid -0.986429
[852901:MainThread](2024-04-06 21:10:43,012) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 21:10:43,012) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:10:57,072) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:11:12,149) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979785, valid -0.986602
[852901:MainThread](2024-04-06 21:11:12,150) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 21:11:12,150) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:11:26,107) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:11:41,521) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978039, valid -0.987633
[852901:MainThread](2024-04-06 21:11:41,521) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 21:11:41,522) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:11:57,759) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:12:13,384) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976718, valid -0.988507
[852901:MainThread](2024-04-06 21:12:13,384) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 21:12:13,385) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:12:27,612) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:12:44,458) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975601, valid -0.989010
[852901:MainThread](2024-04-06 21:12:44,459) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 21:12:44,459) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.985458 @ 1
[852901:MainThread](2024-04-06 21:12:47,127) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 21:12:48,129) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  64%|██████▍   | 16/25 [1:47:53<48:55, 326.14s/it]  [852901:MainThread](2024-04-06 21:12:48,141) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 21:12:48,152) INFO - qlib.workflow - [recorder.py:341] - Recorder 15ab4149ad2041c9b8584689bf66711d starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 21:12:48,585) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 21:12:49,317) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 21:12:55,344) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 21:12:55,344) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 21:12:55,345) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-06-29 SH600000    0.096899
2023-06-30 SH600000    0.094105
2023-07-03 SH600000    0.151580
2023-07-04 SH600000    0.155498
2023-07-05 SH600000    0.162902
[852901:MainThread](2024-04-06 21:13:09,816) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:13:25,977) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987125, valid -0.984793
[852901:MainThread](2024-04-06 21:13:25,981) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 21:13:25,981) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:13:40,112) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:13:56,065) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983770, valid -0.982670
[852901:MainThread](2024-04-06 21:13:56,068) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 21:13:56,068) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:14:10,645) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:14:26,834) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982085, valid -0.986791
[852901:MainThread](2024-04-06 21:14:26,835) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 21:14:26,835) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:14:41,187) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:14:56,834) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980881, valid -0.989399
[852901:MainThread](2024-04-06 21:14:56,834) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 21:14:56,835) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:15:12,376) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:15:27,636) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978960, valid -0.987678
[852901:MainThread](2024-04-06 21:15:27,637) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 21:15:27,637) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:15:42,373) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:15:59,895) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976822, valid -0.986598
[852901:MainThread](2024-04-06 21:15:59,896) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 21:15:59,896) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:16:14,002) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:16:29,449) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975123, valid -0.987361
[852901:MainThread](2024-04-06 21:16:29,450) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 21:16:29,450) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.982670 @ 1
[852901:MainThread](2024-04-06 21:16:32,144) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 21:16:33,158) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  68%|██████▊   | 17/25 [1:51:39<39:25, 295.74s/it][852901:MainThread](2024-04-06 21:16:33,169) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 21:16:33,180) INFO - qlib.workflow - [recorder.py:341] - Recorder 707729f4bf3a41a48bcc19f3d5bd519f starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 21:16:33,595) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 21:16:34,333) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 21:16:41,409) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 21:16:41,410) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 21:16:41,410) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-07-27 SH600000    0.126715
2023-07-28 SH600000    0.143888
2023-07-31 SH600000    0.116050
2023-08-01 SH600000    0.080559
2023-08-02 SH600000    0.094167
[852901:MainThread](2024-04-06 21:16:55,771) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:17:11,410) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986848, valid -0.987483
[852901:MainThread](2024-04-06 21:17:11,414) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 21:17:11,414) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:17:25,338) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:17:40,691) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986495, valid -0.985605
[852901:MainThread](2024-04-06 21:17:40,697) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 21:17:40,697) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:17:54,960) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:18:12,616) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981088, valid -0.984612
[852901:MainThread](2024-04-06 21:18:12,623) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 21:18:12,624) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:18:28,353) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:18:44,221) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979304, valid -0.986565
[852901:MainThread](2024-04-06 21:18:44,221) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 21:18:44,222) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:18:58,623) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:19:15,027) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977998, valid -0.983874
[852901:MainThread](2024-04-06 21:19:15,031) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 21:19:15,031) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:19:30,636) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:19:45,850) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977672, valid -0.985880
[852901:MainThread](2024-04-06 21:19:45,850) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 21:19:45,851) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:20:00,079) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:20:15,274) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975251, valid -0.987028
[852901:MainThread](2024-04-06 21:20:15,275) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[852901:MainThread](2024-04-06 21:20:15,275) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:20:29,078) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:20:44,968) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974176, valid -0.982884
[852901:MainThread](2024-04-06 21:20:44,973) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[852901:MainThread](2024-04-06 21:20:44,974) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:21:00,300) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:21:15,636) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973318, valid -0.984324
[852901:MainThread](2024-04-06 21:21:15,637) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[852901:MainThread](2024-04-06 21:21:15,638) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:21:29,771) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:21:46,612) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972116, valid -0.986486
[852901:MainThread](2024-04-06 21:21:46,613) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[852901:MainThread](2024-04-06 21:21:46,613) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:22:01,131) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:22:16,302) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970716, valid -0.990390
[852901:MainThread](2024-04-06 21:22:16,303) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch11:
[852901:MainThread](2024-04-06 21:22:16,304) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:22:30,497) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:22:47,550) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970730, valid -0.989301
[852901:MainThread](2024-04-06 21:22:47,551) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch12:
[852901:MainThread](2024-04-06 21:22:47,551) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:23:02,001) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:23:18,670) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971678, valid -0.992552
[852901:MainThread](2024-04-06 21:23:18,671) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 21:23:18,671) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.982884 @ 7
[852901:MainThread](2024-04-06 21:23:22,552) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 21:23:23,554) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  72%|███████▏  | 18/25 [1:58:29<38:31, 330.19s/it][852901:MainThread](2024-04-06 21:23:23,564) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 21:23:23,575) INFO - qlib.workflow - [recorder.py:341] - Recorder 0e709662fc084276854dd0a7cc87af70 starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 21:23:23,965) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 21:23:24,686) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 21:23:31,124) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 21:23:31,125) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 21:23:31,125) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-08-24 SH600000    0.159805
2023-08-25 SH600000    0.159887
2023-08-28 SH600000    0.126702
2023-08-29 SH600000    0.131516
2023-08-30 SH600000    0.142124
[852901:MainThread](2024-04-06 21:23:45,915) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:24:02,095) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986622, valid -0.986498
[852901:MainThread](2024-04-06 21:24:02,098) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 21:24:02,098) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:24:17,409) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:24:33,981) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983197, valid -0.988036
[852901:MainThread](2024-04-06 21:24:33,982) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 21:24:33,983) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:24:48,546) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:25:04,191) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981013, valid -0.984178
[852901:MainThread](2024-04-06 21:25:04,197) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 21:25:04,203) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:25:19,235) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:25:35,676) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979697, valid -0.983844
[852901:MainThread](2024-04-06 21:25:35,680) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 21:25:35,680) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:25:50,780) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:26:07,916) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977499, valid -0.983890
[852901:MainThread](2024-04-06 21:26:07,917) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 21:26:07,917) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:26:22,027) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:26:37,723) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976535, valid -0.988130
[852901:MainThread](2024-04-06 21:26:37,724) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 21:26:37,724) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:26:54,308) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:27:09,748) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976586, valid -0.987755
[852901:MainThread](2024-04-06 21:27:09,749) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[852901:MainThread](2024-04-06 21:27:09,750) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:27:24,909) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:27:40,844) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973951, valid -0.985185
[852901:MainThread](2024-04-06 21:27:40,844) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[852901:MainThread](2024-04-06 21:27:40,845) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:27:55,421) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:28:11,614) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973330, valid -0.988493
[852901:MainThread](2024-04-06 21:28:11,615) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 21:28:11,615) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.983844 @ 3
[852901:MainThread](2024-04-06 21:28:14,426) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 21:28:15,430) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  76%|███████▌  | 19/25 [2:03:21<31:52, 318.68s/it][852901:MainThread](2024-04-06 21:28:15,440) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 21:28:15,451) INFO - qlib.workflow - [recorder.py:341] - Recorder aebda68ace1a42ab962f5b16f820a8e0 starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 21:28:15,883) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 21:28:16,616) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 21:28:22,880) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 21:28:22,881) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 21:28:22,881) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-09-21 SH600000    0.222395
2023-09-22 SH600000    0.195232
2023-09-25 SH600000    0.196192
2023-09-26 SH600000    0.224279
2023-09-27 SH600000    0.211355
[852901:MainThread](2024-04-06 21:28:38,609) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:28:53,725) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986934, valid -0.983708
[852901:MainThread](2024-04-06 21:28:53,729) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 21:28:53,729) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:29:09,096) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:29:28,785) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983436, valid -0.979970
[852901:MainThread](2024-04-06 21:29:28,790) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 21:29:28,791) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:29:42,835) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:29:58,609) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981540, valid -0.982262
[852901:MainThread](2024-04-06 21:29:58,610) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 21:29:58,611) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:30:13,612) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:30:29,528) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979275, valid -0.984486
[852901:MainThread](2024-04-06 21:30:29,528) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 21:30:29,529) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:30:44,685) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:31:00,474) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977953, valid -0.983716
[852901:MainThread](2024-04-06 21:31:00,477) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 21:31:00,478) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:31:15,638) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:31:31,507) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979063, valid -0.990574
[852901:MainThread](2024-04-06 21:31:31,507) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 21:31:31,508) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:31:45,949) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:32:03,142) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975361, valid -0.986000
[852901:MainThread](2024-04-06 21:32:03,143) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 21:32:03,143) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.979970 @ 1
[852901:MainThread](2024-04-06 21:32:06,046) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 21:32:06,900) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  80%|████████  | 20/25 [2:07:12<24:22, 292.50s/it][852901:MainThread](2024-04-06 21:32:06,911) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 21:32:06,922) INFO - qlib.workflow - [recorder.py:341] - Recorder 10a108f93a214c379d0843d9fbc8d3e1 starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 21:32:07,328) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 21:32:08,049) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 21:32:14,278) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 21:32:14,279) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 21:32:14,279) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-10-27 SH600000    0.103777
2023-10-30 SH600000    0.130070
2023-10-31 SH600000    0.146594
2023-11-01 SH600000    0.137002
2023-11-02 SH600000    0.158302
[852901:MainThread](2024-04-06 21:32:28,431) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:32:44,351) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987199, valid -0.987460
[852901:MainThread](2024-04-06 21:32:44,354) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 21:32:44,355) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:32:59,855) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:33:15,899) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983974, valid -0.985058
[852901:MainThread](2024-04-06 21:33:15,904) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 21:33:15,904) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:33:30,771) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:33:46,897) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981189, valid -0.984756
[852901:MainThread](2024-04-06 21:33:46,903) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 21:33:46,903) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:34:01,153) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:34:18,601) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979612, valid -0.983747
[852901:MainThread](2024-04-06 21:34:18,604) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 21:34:18,605) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:34:33,723) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:34:49,748) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979730, valid -0.984558
[852901:MainThread](2024-04-06 21:34:49,749) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 21:34:49,749) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:35:04,482) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:35:22,612) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976649, valid -0.989519
[852901:MainThread](2024-04-06 21:35:22,613) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 21:35:22,613) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:35:37,568) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:35:53,299) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975759, valid -0.984886
[852901:MainThread](2024-04-06 21:35:53,299) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[852901:MainThread](2024-04-06 21:35:53,299) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:36:09,726) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:36:25,855) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974956, valid -0.985053
[852901:MainThread](2024-04-06 21:36:25,856) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[852901:MainThread](2024-04-06 21:36:25,856) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:36:40,807) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:36:57,511) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972916, valid -0.986549
[852901:MainThread](2024-04-06 21:36:57,512) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 21:36:57,512) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.983747 @ 3
[852901:MainThread](2024-04-06 21:37:00,298) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 21:37:01,391) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  84%|████████▍ | 21/25 [2:12:07<19:32, 293.10s/it][852901:MainThread](2024-04-06 21:37:01,402) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 21:37:01,413) INFO - qlib.workflow - [recorder.py:341] - Recorder b5a40231432f4c6fa1a2327089838b1a starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 21:37:01,894) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 21:37:02,635) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 21:37:08,915) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 21:37:08,916) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 21:37:08,916) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-11-24 SH600000    0.134508
2023-11-27 SH600000    0.166597
2023-11-28 SH600000    0.142851
2023-11-29 SH600000    0.147671
2023-11-30 SH600000    0.123763
[852901:MainThread](2024-04-06 21:37:23,410) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:37:40,158) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986420, valid -0.989187
[852901:MainThread](2024-04-06 21:37:40,162) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 21:37:40,163) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:37:55,408) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:38:11,503) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983073, valid -0.988719
[852901:MainThread](2024-04-06 21:38:11,508) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 21:38:11,508) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:38:26,210) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:38:43,495) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980821, valid -0.988164
[852901:MainThread](2024-04-06 21:38:43,500) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 21:38:43,500) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:38:58,558) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:39:16,077) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982069, valid -0.987656
[852901:MainThread](2024-04-06 21:39:16,081) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 21:39:16,082) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:39:32,943) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:39:48,636) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977367, valid -0.990823
[852901:MainThread](2024-04-06 21:39:48,637) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 21:39:48,638) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:40:03,418) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:40:21,964) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977543, valid -0.991716
[852901:MainThread](2024-04-06 21:40:21,964) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 21:40:21,965) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:40:36,873) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:40:53,225) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977252, valid -0.991272
[852901:MainThread](2024-04-06 21:40:53,226) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[852901:MainThread](2024-04-06 21:40:53,226) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:41:09,138) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:41:25,021) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973711, valid -0.991917
[852901:MainThread](2024-04-06 21:41:25,021) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[852901:MainThread](2024-04-06 21:41:25,021) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:41:40,608) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:41:57,700) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973775, valid -0.990144
[852901:MainThread](2024-04-06 21:41:57,701) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 21:41:57,701) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.987656 @ 3
[852901:MainThread](2024-04-06 21:42:00,668) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 21:42:01,717) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  88%|████████▊ | 22/25 [2:17:07<14:45, 295.27s/it][852901:MainThread](2024-04-06 21:42:01,728) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 21:42:01,739) INFO - qlib.workflow - [recorder.py:341] - Recorder 436f372e74fd40f2a36ecf5a35fe2306 starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 21:42:02,314) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 21:42:03,052) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 21:42:09,481) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 21:42:09,482) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 21:42:09,482) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-12-22 SH600000    0.058120
2023-12-25 SH600000    0.126622
2023-12-26 SH600000    0.128584
2023-12-27 SH600000    0.087925
2023-12-28 SH600000    0.080404
[852901:MainThread](2024-04-06 21:42:24,385) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:42:41,953) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986883, valid -0.985928
[852901:MainThread](2024-04-06 21:42:41,961) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 21:42:41,961) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:42:58,140) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:43:15,837) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983692, valid -0.981485
[852901:MainThread](2024-04-06 21:43:15,842) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 21:43:15,842) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:43:30,769) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:43:48,607) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981253, valid -0.980550
[852901:MainThread](2024-04-06 21:43:48,612) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 21:43:48,612) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:44:04,491) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:44:20,881) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979790, valid -0.983627
[852901:MainThread](2024-04-06 21:44:20,882) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 21:44:20,882) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:44:37,383) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:44:54,263) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977804, valid -0.983061
[852901:MainThread](2024-04-06 21:44:54,264) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 21:44:54,264) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:45:10,310) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:45:27,865) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977110, valid -0.984596
[852901:MainThread](2024-04-06 21:45:27,866) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 21:45:27,866) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:45:42,353) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:45:58,512) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974944, valid -0.983544
[852901:MainThread](2024-04-06 21:45:58,513) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[852901:MainThread](2024-04-06 21:45:58,514) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:46:13,609) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:46:30,638) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974446, valid -0.986597
[852901:MainThread](2024-04-06 21:46:30,639) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 21:46:30,639) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.980550 @ 2
[852901:MainThread](2024-04-06 21:46:33,676) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 21:46:34,630) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  92%|█████████▏| 23/25 [2:21:40<09:37, 288.56s/it][852901:MainThread](2024-04-06 21:46:34,640) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 21:46:34,651) INFO - qlib.workflow - [recorder.py:341] - Recorder 0290f01934ab46b0a5601ede15c1a63d starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 21:46:35,138) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 21:46:35,838) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 21:46:42,390) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 21:46:42,390) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 21:46:42,391) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2024-01-22 SH600000    0.006460
2024-01-23 SH600000    0.028216
2024-01-24 SH600000    0.035838
2024-01-25 SH600000    0.064325
2024-01-26 SH600000    0.059388
[852901:MainThread](2024-04-06 21:46:57,713) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:47:15,979) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987255, valid -0.981816
[852901:MainThread](2024-04-06 21:47:15,986) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 21:47:15,986) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:47:31,329) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:47:49,133) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983336, valid -0.978328
[852901:MainThread](2024-04-06 21:47:49,137) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 21:47:49,138) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:48:04,516) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:48:21,107) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982451, valid -0.979895
[852901:MainThread](2024-04-06 21:48:21,108) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 21:48:21,108) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:48:36,959) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:48:54,532) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979396, valid -0.979938
[852901:MainThread](2024-04-06 21:48:54,532) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 21:48:54,533) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:49:10,301) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:49:25,650) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979069, valid -0.978816
[852901:MainThread](2024-04-06 21:49:25,651) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 21:49:25,651) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:49:40,485) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:49:58,042) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977668, valid -0.982249
[852901:MainThread](2024-04-06 21:49:58,043) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 21:49:58,044) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:50:13,414) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:50:29,032) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975402, valid -0.980739
[852901:MainThread](2024-04-06 21:50:29,033) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 21:50:29,033) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.978328 @ 1
[852901:MainThread](2024-04-06 21:50:31,944) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 21:50:32,957) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  96%|█████████▌| 24/25 [2:25:38<04:33, 273.49s/it][852901:MainThread](2024-04-06 21:50:32,968) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[852901:MainThread](2024-04-06 21:50:32,980) INFO - qlib.workflow - [recorder.py:341] - Recorder 6f68bc10627d4eeca336bbcae6731e54 starts running under Experiment 4 ...
[852901:MainThread](2024-04-06 21:50:33,461) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[852901:MainThread](2024-04-06 21:50:34,266) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[852901:MainThread](2024-04-06 21:50:41,120) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[852901:MainThread](2024-04-06 21:50:41,121) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[852901:MainThread](2024-04-06 21:50:41,121) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2024-02-27 SH600000    0.236129
2024-02-28 SH600000    0.214386
2024-02-29 SH600000    0.201540
2024-03-01 SH600000    0.158814
2024-03-04 SH600000    0.147403
[852901:MainThread](2024-04-06 21:50:56,986) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:51:13,209) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987394, valid -0.975978
[852901:MainThread](2024-04-06 21:51:13,213) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[852901:MainThread](2024-04-06 21:51:13,213) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:51:28,691) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:51:47,550) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.984754, valid -0.976188
[852901:MainThread](2024-04-06 21:51:47,551) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[852901:MainThread](2024-04-06 21:51:47,552) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:52:02,042) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:52:18,841) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981884, valid -0.974031
[852901:MainThread](2024-04-06 21:52:18,845) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[852901:MainThread](2024-04-06 21:52:18,845) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:52:34,844) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:52:53,459) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980061, valid -0.978861
[852901:MainThread](2024-04-06 21:52:53,460) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[852901:MainThread](2024-04-06 21:52:53,460) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:53:08,876) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:53:25,861) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978107, valid -0.978202
[852901:MainThread](2024-04-06 21:53:25,862) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[852901:MainThread](2024-04-06 21:53:25,862) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:53:42,434) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:53:59,550) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977308, valid -0.976561
[852901:MainThread](2024-04-06 21:53:59,550) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[852901:MainThread](2024-04-06 21:53:59,551) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:54:14,787) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:54:32,003) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975974, valid -0.978964
[852901:MainThread](2024-04-06 21:54:32,003) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[852901:MainThread](2024-04-06 21:54:32,004) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[852901:MainThread](2024-04-06 21:54:46,904) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[852901:MainThread](2024-04-06 21:55:03,347) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975025, valid -0.979429
[852901:MainThread](2024-04-06 21:55:03,348) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[852901:MainThread](2024-04-06 21:55:03,348) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.974031 @ 2
[852901:MainThread](2024-04-06 21:55:05,582) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 4
[852901:MainThread](2024-04-06 21:55:06,971) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks: 100%|██████████| 25/25 [2:30:12<00:00, 273.64s/it]train tasks: 100%|██████████| 25/25 [2:30:12<00:00, 360.51s/it]
[852901:MainThread](2024-04-06 21:55:07,049) INFO - qlib.timer - [log.py:127] - Time cost: 0.041s | Time to `list_recorders` in RecorderCollector Done
[852901:MainThread](2024-04-06 21:55:07,049) INFO - qlib.RecorderCollector - [collect.py:226] - Nubmer of recorders after filter: defaultdict(<class 'int'>, {'FINISHED': 25})
[852901:MainThread](2024-04-06 21:55:07,076) INFO - qlib.RollingEnsemble - [ensemble.py:81] - keys in group: ['6f68bc10627d4eeca336bbcae6731e54', '0290f01934ab46b0a5601ede15c1a63d', '436f372e74fd40f2a36ecf5a35fe2306', 'b5a40231432f4c6fa1a2327089838b1a', '10a108f93a214c379d0843d9fbc8d3e1', 'aebda68ace1a42ab962f5b16f820a8e0', '0e709662fc084276854dd0a7cc87af70', '707729f4bf3a41a48bcc19f3d5bd519f', '15ab4149ad2041c9b8584689bf66711d', '11cc0f3a24774888945b4a07eaa72115', '0bb0ca46bde747dabc48e07e243a0235', '26bece9acf10447796391031ded6feba', 'cfa1a5c12165488dbba3aa2ee5334ccf', '31d23d2f83da4d7badb920a60e658582', '35633ddd50bb44afba6a67f53febb7a6', 'e7892f41129048f1961a8fd257e223da', 'bc587074e2274ca79b85941a941606c8', 'e673c3b7d5be4d81978e325549f1ee26', 'b3eaf5dfefcc48cf89c74d9f269a6d36', '08c1ec685c894836b2f40a93b8ffead5', 'b995d39696924bd28c042e4feb28aa81', 'c7edb48a99fc46569ad349ad7a891678', '5744e58ef84448d4ae8aceb482775bd9', '519554dc6c1b45ad89f76cf940eac889', '62b60be659f74d589c3293f946ca6162']
[852901:MainThread](2024-04-06 21:55:07,142) INFO - qlib.RollingEnsemble - [ensemble.py:81] - keys in group: ['6f68bc10627d4eeca336bbcae6731e54', '0290f01934ab46b0a5601ede15c1a63d', '436f372e74fd40f2a36ecf5a35fe2306', 'b5a40231432f4c6fa1a2327089838b1a', '10a108f93a214c379d0843d9fbc8d3e1', 'aebda68ace1a42ab962f5b16f820a8e0', '0e709662fc084276854dd0a7cc87af70', '707729f4bf3a41a48bcc19f3d5bd519f', '15ab4149ad2041c9b8584689bf66711d', '11cc0f3a24774888945b4a07eaa72115', '0bb0ca46bde747dabc48e07e243a0235', '26bece9acf10447796391031ded6feba', 'cfa1a5c12165488dbba3aa2ee5334ccf', '31d23d2f83da4d7badb920a60e658582', '35633ddd50bb44afba6a67f53febb7a6', 'e7892f41129048f1961a8fd257e223da', 'bc587074e2274ca79b85941a941606c8', 'e673c3b7d5be4d81978e325549f1ee26', 'b3eaf5dfefcc48cf89c74d9f269a6d36', '08c1ec685c894836b2f40a93b8ffead5', 'b995d39696924bd28c042e4feb28aa81', 'c7edb48a99fc46569ad349ad7a891678', '5744e58ef84448d4ae8aceb482775bd9', '519554dc6c1b45ad89f76cf940eac889', '62b60be659f74d589c3293f946ca6162']
[852901:MainThread](2024-04-06 21:55:07,212) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name transformer_20240406192200671586695.
[852901:MainThread](2024-04-06 21:55:07,226) INFO - qlib.workflow - [exp.py:258] - Experiment 21 starts running ...
[852901:MainThread](2024-04-06 21:55:07,239) INFO - qlib.workflow - [recorder.py:341] - Recorder b08ade537be34283a23b1471189351a7 starts running under Experiment 21 ...
[852901:MainThread](2024-04-06 21:55:07,676) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
[852901:MainThread](2024-04-06 21:55:08,641) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2024-03-26 SH600000    0.209570
2024-03-27 SH600000    0.179343
2024-03-28 SH600000    0.177108
2024-03-29 SH600000    0.189716
2024-04-01 SH600000    0.210616
{'IC': 0.09046409403198137,
 'ICIR': 0.6047262243801327,
 'Rank IC': 0.10419786341578598,
 'Rank ICIR': 0.7836638279323024}
[852901:MainThread](2024-04-06 21:55:20,580) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[852901:MainThread](2024-04-06 21:55:20,583) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[852901:MainThread](2024-04-06 21:55:25,999) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fd7728a9520>
backtest loop:   0%|          | 0/485 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 4/485 [00:00<00:12, 37.27it/s]backtest loop:   2%|▏         | 9/485 [00:00<00:10, 43.82it/s]backtest loop:   3%|▎         | 15/485 [00:00<00:09, 47.82it/s]backtest loop:   4%|▍         | 20/485 [00:00<00:09, 48.28it/s]backtest loop:   5%|▌         | 25/485 [00:00<00:09, 48.06it/s]backtest loop:   6%|▌         | 30/485 [00:00<00:09, 48.00it/s]backtest loop:   7%|▋         | 35/485 [00:00<00:10, 42.57it/s]backtest loop:   8%|▊         | 40/485 [00:00<00:12, 34.79it/s]backtest loop:   9%|▉         | 45/485 [00:01<00:12, 34.59it/s]backtest loop:  10%|█         | 50/485 [00:01<00:11, 37.88it/s]backtest loop:  11%|█▏        | 55/485 [00:01<00:10, 39.50it/s]backtest loop:  12%|█▏        | 60/485 [00:01<00:11, 36.29it/s]backtest loop:  13%|█▎        | 65/485 [00:01<00:11, 35.19it/s]backtest loop:  14%|█▍        | 70/485 [00:01<00:11, 36.49it/s]backtest loop:  15%|█▌        | 75/485 [00:01<00:10, 39.30it/s]backtest loop:  16%|█▋        | 80/485 [00:01<00:09, 41.50it/s]backtest loop:  18%|█▊        | 85/485 [00:02<00:09, 43.21it/s]backtest loop:  19%|█▊        | 90/485 [00:02<00:08, 44.39it/s]backtest loop:  20%|█▉        | 95/485 [00:02<00:09, 42.77it/s]backtest loop:  21%|██        | 100/485 [00:02<00:10, 37.97it/s]backtest loop:  22%|██▏       | 105/485 [00:02<00:10, 36.44it/s]backtest loop:  23%|██▎       | 110/485 [00:02<00:10, 36.57it/s]backtest loop:  24%|██▎       | 115/485 [00:02<00:09, 39.37it/s]backtest loop:  25%|██▍       | 120/485 [00:03<00:09, 39.44it/s]backtest loop:  26%|██▌       | 125/485 [00:03<00:09, 36.40it/s]backtest loop:  27%|██▋       | 129/485 [00:03<00:10, 35.33it/s]backtest loop:  28%|██▊       | 134/485 [00:03<00:09, 37.12it/s]backtest loop:  29%|██▉       | 140/485 [00:03<00:08, 41.20it/s]backtest loop:  30%|██▉       | 145/485 [00:03<00:07, 42.89it/s]backtest loop:  31%|███       | 150/485 [00:03<00:07, 44.40it/s]backtest loop:  32%|███▏      | 156/485 [00:03<00:06, 47.18it/s]backtest loop:  33%|███▎      | 161/485 [00:03<00:06, 46.33it/s]backtest loop:  34%|███▍      | 166/485 [00:04<00:07, 42.96it/s]backtest loop:  35%|███▌      | 171/485 [00:04<00:07, 41.35it/s]backtest loop:  36%|███▋      | 177/485 [00:04<00:06, 44.90it/s]backtest loop:  38%|███▊      | 183/485 [00:04<00:06, 47.94it/s]backtest loop:  39%|███▉      | 188/485 [00:04<00:06, 46.45it/s]backtest loop:  40%|███▉      | 193/485 [00:04<00:06, 46.88it/s]backtest loop:  41%|████      | 198/485 [00:04<00:06, 47.65it/s]backtest loop:  42%|████▏     | 203/485 [00:04<00:05, 48.07it/s]backtest loop:  43%|████▎     | 208/485 [00:04<00:05, 48.56it/s]backtest loop:  44%|████▍     | 213/485 [00:05<00:05, 48.73it/s]backtest loop:  45%|████▍     | 218/485 [00:05<00:05, 49.09it/s]backtest loop:  46%|████▌     | 223/485 [00:05<00:05, 49.14it/s]backtest loop:  47%|████▋     | 228/485 [00:05<00:05, 48.61it/s]backtest loop:  48%|████▊     | 233/485 [00:05<00:05, 47.95it/s]backtest loop:  49%|████▉     | 238/485 [00:05<00:05, 47.78it/s]backtest loop:  50%|█████     | 243/485 [00:05<00:05, 48.15it/s]backtest loop:  51%|█████     | 248/485 [00:05<00:05, 45.25it/s]backtest loop:  52%|█████▏    | 253/485 [00:05<00:05, 43.39it/s]backtest loop:  53%|█████▎    | 258/485 [00:06<00:05, 40.05it/s]backtest loop:  54%|█████▍    | 263/485 [00:06<00:05, 41.64it/s]backtest loop:  55%|█████▌    | 268/485 [00:06<00:05, 42.97it/s]backtest loop:  56%|█████▋    | 273/485 [00:06<00:05, 38.37it/s]backtest loop:  57%|█████▋    | 277/485 [00:06<00:05, 35.62it/s]backtest loop:  58%|█████▊    | 281/485 [00:06<00:05, 34.87it/s]backtest loop:  59%|█████▉    | 286/485 [00:06<00:05, 38.63it/s]backtest loop:  60%|██████    | 291/485 [00:06<00:04, 40.87it/s]backtest loop:  61%|██████    | 296/485 [00:07<00:04, 42.61it/s]backtest loop:  62%|██████▏   | 301/485 [00:07<00:04, 43.88it/s]backtest loop:  63%|██████▎   | 306/485 [00:07<00:03, 44.87it/s]backtest loop:  64%|██████▍   | 311/485 [00:07<00:04, 39.34it/s]backtest loop:  65%|██████▌   | 316/485 [00:07<00:04, 36.76it/s]backtest loop:  66%|██████▋   | 322/485 [00:07<00:04, 37.40it/s]backtest loop:  67%|██████▋   | 327/485 [00:07<00:04, 39.43it/s]backtest loop:  69%|██████▊   | 333/485 [00:07<00:03, 42.96it/s]backtest loop:  70%|██████▉   | 339/485 [00:08<00:03, 45.99it/s]backtest loop:  71%|███████   | 345/485 [00:08<00:02, 47.91it/s]backtest loop:  72%|███████▏  | 351/485 [00:08<00:02, 49.31it/s]backtest loop:  74%|███████▎  | 357/485 [00:08<00:02, 48.33it/s]backtest loop:  75%|███████▍  | 363/485 [00:08<00:02, 49.91it/s]backtest loop:  76%|███████▌  | 369/485 [00:08<00:02, 51.49it/s]backtest loop:  77%|███████▋  | 375/485 [00:08<00:02, 52.34it/s]backtest loop:  79%|███████▊  | 381/485 [00:08<00:02, 50.54it/s]backtest loop:  80%|███████▉  | 387/485 [00:08<00:01, 51.81it/s]backtest loop:  81%|████████  | 393/485 [00:09<00:01, 52.72it/s]backtest loop:  82%|████████▏ | 399/485 [00:09<00:01, 51.37it/s]backtest loop:  84%|████████▎ | 405/485 [00:09<00:01, 48.04it/s]backtest loop:  85%|████████▍ | 410/485 [00:09<00:01, 47.47it/s]backtest loop:  86%|████████▌ | 415/485 [00:09<00:01, 47.24it/s]backtest loop:  87%|████████▋ | 421/485 [00:09<00:01, 47.26it/s]backtest loop:  88%|████████▊ | 427/485 [00:09<00:01, 50.13it/s]backtest loop:  89%|████████▉ | 433/485 [00:09<00:01, 51.69it/s]backtest loop:  91%|█████████ | 439/485 [00:10<00:00, 52.57it/s]backtest loop:  92%|█████████▏| 445/485 [00:10<00:00, 50.47it/s]backtest loop:  93%|█████████▎| 451/485 [00:10<00:00, 50.66it/s]backtest loop:  94%|█████████▍| 457/485 [00:10<00:00, 50.69it/s]backtest loop:  95%|█████████▌| 463/485 [00:10<00:00, 50.88it/s]backtest loop:  97%|█████████▋| 469/485 [00:10<00:00, 49.60it/s]backtest loop:  98%|█████████▊| 475/485 [00:10<00:00, 51.66it/s]backtest loop:  99%|█████████▉| 481/485 [00:10<00:00, 53.34it/s]backtest loop: 100%|██████████| 485/485 [00:10<00:00, 44.33it/s]
[852901:MainThread](2024-04-06 21:55:37,000) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 21
[852901:MainThread](2024-04-06 21:55:37,017) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 21
[852901:MainThread](2024-04-06 21:55:37,632) INFO - qlib.Rolling - [base.py:233] - Your evaluation results can be found in the experiment named `transformer_20240406192200671586695`, rid=b08ade537be34283a23b1471189351a7
'The following are analysis results of benchmark return(1day).'
                       risk
mean              -0.000278
std                0.010303
annualized_return -0.066260
information_ratio -0.416884
max_drawdown      -0.328619
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000965
std                0.004385
annualized_return  0.229576
information_ratio  3.393470
max_drawdown      -0.034327
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000765
std                0.004383
annualized_return  0.182171
information_ratio  2.694127
max_drawdown      -0.038191
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0

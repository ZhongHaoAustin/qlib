[852895:MainThread](2024-04-06 19:22:02,409) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[852895:MainThread](2024-04-06 19:22:02,412) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[852895:MainThread](2024-04-06 19:22:02,412) INFO - qlib.Initialization - [__init__.py:76] - data_path={'day': PosixPath('/home/zhonghao/.qlib/qlib_data/my_data')}
[852895:MainThread](2024-04-06 19:22:02,414) WARNING - qlib.Rolling - [base.py:104] - Using user specifiied name for rolling models. So the experiment names duplicateds. Please manually remove your experiment for rolling model with command like `rm -r mlruns`. Otherwise it will prevents the creating of experimen with same name
[852895:MainThread](2024-04-06 19:22:02,415) WARNING - qlib.Rolling - [rolling_benchmark.py:32] - Model type is not in the benchmark!
[852895:MainThread](2024-04-06 19:22:02,430) INFO - qlib.Rolling - [base.py:162] - The prediction horizon is overrided
[852895:MainThread](2024-04-06 19:24:47,915) INFO - qlib.timer - [log.py:127] - Time cost: 165.482s | Loading data Done
[852895:MainThread](2024-04-06 19:24:49,727) INFO - qlib.timer - [log.py:127] - Time cost: 0.426s | DropCol Done
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/qlib/data/dataset/processor.py:391: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[cols] = (
[852895:MainThread](2024-04-06 19:46:25,971) INFO - qlib.timer - [log.py:127] - Time cost: 1296.241s | CSZFillna Done
[852895:MainThread](2024-04-06 19:46:28,185) INFO - qlib.timer - [log.py:127] - Time cost: 0.554s | DropCol Done
[852895:MainThread](2024-04-06 19:46:29,822) INFO - qlib.timer - [log.py:127] - Time cost: 1.635s | DropnaProcessor Done
[852895:MainThread](2024-04-06 19:46:30,476) INFO - qlib.timer - [log.py:127] - Time cost: 0.653s | DropnaLabel Done
[852895:MainThread](2024-04-06 19:46:52,840) INFO - qlib.timer - [log.py:127] - Time cost: 22.357s | CSZScoreNorm Done
[852895:MainThread](2024-04-06 19:46:52,849) INFO - qlib.timer - [log.py:127] - Time cost: 1324.930s | fit & process data Done
[852895:MainThread](2024-04-06 19:46:52,852) INFO - qlib.timer - [log.py:127] - Time cost: 1490.419s | Init data Done
[852895:MainThread](2024-04-06 19:47:01,199) INFO - qlib.Rolling - [base.py:173] - {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.002, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 8192, 'GPU': 0, 'weight_decay': 0.0002, 'pt_model_kwargs': {'input_dim': 157}}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/code/qlib/exp_yaml/longer_data/Alpha158.1809b85c46.pkl', 'segments': {'train': [datetime.date(2008, 1, 1), datetime.date(2021, 3, 30)], 'valid': [datetime.date(2021, 3, 31), datetime.date(2022, 3, 31)], 'test': [datetime.date(2022, 4, 1), datetime.date(2024, 4, 1)]}}}, 'record': [{'class': 'SignalRecord', 'module_path': 'qlib.workflow.record_temp', 'kwargs': {'model': '<MODEL>', 'dataset': '<DATASET>'}}, {'class': 'SigAnaRecord', 'module_path': 'qlib.workflow.record_temp', 'kwargs': {'ana_long_short': False, 'ann_scaler': 252}}, {'class': 'PortAnaRecord', 'module_path': 'qlib.workflow.record_temp', 'kwargs': {'config': {'strategy': {'class': 'TopkDropoutStrategy', 'module_path': 'qlib.contrib.strategy', 'kwargs': {'signal': '<PRED>', 'topk': 50, 'n_drop': 5}}, 'backtest': {'start_time': datetime.date(2022, 4, 1), 'end_time': datetime.date(2024, 4, 1), 'account': 100000000, 'benchmark': 'SH000300', 'exchange_kwargs': {'limit_threshold': 0.095, 'deal_price': 'close', 'open_cost': 0.0005, 'close_cost': 0.0015, 'min_cost': 5}}}}}]}
[852895:MainThread](2024-04-06 19:47:01,239) INFO - qlib.Rolling - [base.py:190] - Deleting previous Rolling results
[852895:MainThread](2024-04-06 19:47:01,249) INFO - qlib.Rolling - [base.py:196] - No previous rolling results
train tasks:   0%|          | 0/25 [00:00<?, ?it/s][852895:MainThread](2024-04-06 19:47:01,263) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name rolling_mlp_20240406192200672314232.
[852895:MainThread](2024-04-06 19:47:01,286) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 19:47:02,300) INFO - qlib.workflow - [recorder.py:341] - Recorder 370f8063880a4c8f8a79475263ca9cce starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 19:47:12,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 19:47:12,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 19:47:12,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 19:47:12,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 19:47:31,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 19:47:34,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.213621, valid_loss 1.201473, train_metric nan, valid_metric 0.007441
[852895:MainThread](2024-04-06 19:47:34,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.201473, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 19:47:35,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.077210, valid_loss 1.046026, train_metric nan, valid_metric 0.022236
[852895:MainThread](2024-04-06 19:47:35,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.201473 to 1.046026, save checkpoint.
[852895:MainThread](2024-04-06 19:47:35,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.041668, valid_loss 1.043039, train_metric nan, valid_metric 0.024686
[852895:MainThread](2024-04-06 19:47:35,646) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.046026 to 1.043039, save checkpoint.
[852895:MainThread](2024-04-06 19:47:35,942) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.037719, valid_loss 1.006356, train_metric nan, valid_metric 0.031787
[852895:MainThread](2024-04-06 19:47:35,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.043039 to 1.006356, save checkpoint.
[852895:MainThread](2024-04-06 19:47:36,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.079592, valid_loss 1.006006, train_metric nan, valid_metric 0.013067
[852895:MainThread](2024-04-06 19:47:36,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006356 to 1.006006, save checkpoint.
[852895:MainThread](2024-04-06 19:47:37,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.023031, valid_loss 1.010596, train_metric nan, valid_metric 0.012887
[852895:MainThread](2024-04-06 19:47:37,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.009767, valid_loss 1.007999, train_metric nan, valid_metric 0.013830
[852895:MainThread](2024-04-06 19:47:38,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.011220, valid_loss 1.003909, train_metric nan, valid_metric 0.022205
[852895:MainThread](2024-04-06 19:47:38,016) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006006 to 1.003909, save checkpoint.
[852895:MainThread](2024-04-06 19:47:38,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.007584, valid_loss 1.005023, train_metric nan, valid_metric 0.016462
[852895:MainThread](2024-04-06 19:47:38,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.017210, valid_loss 1.003958, train_metric nan, valid_metric 0.021146
[852895:MainThread](2024-04-06 19:47:39,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.035641, valid_loss 1.010767, train_metric nan, valid_metric 0.010020
[852895:MainThread](2024-04-06 19:47:39,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.009573, valid_loss 1.007929, train_metric nan, valid_metric -0.001500
[852895:MainThread](2024-04-06 19:47:40,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.010707, valid_loss 1.014408, train_metric nan, valid_metric 0.012223
[852895:MainThread](2024-04-06 19:47:40,760) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 0.989139, valid_loss 1.006094, train_metric nan, valid_metric 0.018674
[852895:MainThread](2024-04-06 19:47:41,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.999543, valid_loss 1.007725, train_metric nan, valid_metric 0.010791
[852895:MainThread](2024-04-06 19:47:42,880) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.995159, valid_loss 1.006041, train_metric nan, valid_metric 0.013866
[852895:MainThread](2024-04-06 19:47:43,483) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.998810, valid_loss 1.004339, train_metric nan, valid_metric 0.017611
[852895:MainThread](2024-04-06 19:47:43,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.999213, valid_loss 1.004596, train_metric nan, valid_metric 0.014879
[852895:MainThread](2024-04-06 19:47:44,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.006349, valid_loss 1.003726, train_metric nan, valid_metric 0.015659
[852895:MainThread](2024-04-06 19:47:44,561) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003909 to 1.003726, save checkpoint.
[852895:MainThread](2024-04-06 19:47:45,037) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.996477, valid_loss 1.004720, train_metric nan, valid_metric -0.000282
[852895:MainThread](2024-04-06 19:47:45,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.997978, valid_loss 1.004222, train_metric nan, valid_metric 0.019921
[852895:MainThread](2024-04-06 19:47:46,028) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.995686, valid_loss 1.001993, train_metric nan, valid_metric 0.018405
[852895:MainThread](2024-04-06 19:47:46,034) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003726 to 1.001993, save checkpoint.
[852895:MainThread](2024-04-06 19:47:46,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.992114, valid_loss 1.004730, train_metric nan, valid_metric 0.009422
[852895:MainThread](2024-04-06 19:47:47,211) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.993673, valid_loss 1.005136, train_metric nan, valid_metric 0.010309
[852895:MainThread](2024-04-06 19:47:47,505) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.995354, valid_loss 1.001653, train_metric nan, valid_metric 0.017990
[852895:MainThread](2024-04-06 19:47:47,515) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001993 to 1.001653, save checkpoint.
[852895:MainThread](2024-04-06 19:47:47,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.992369, valid_loss 1.001560, train_metric nan, valid_metric 0.006191
[852895:MainThread](2024-04-06 19:47:47,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001653 to 1.001560, save checkpoint.
[852895:MainThread](2024-04-06 19:47:48,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.989928, valid_loss 1.007728, train_metric nan, valid_metric 0.018007
[852895:MainThread](2024-04-06 19:47:48,931) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.981135, valid_loss 1.000528, train_metric nan, valid_metric 0.012660
[852895:MainThread](2024-04-06 19:47:48,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001560 to 1.000528, save checkpoint.
[852895:MainThread](2024-04-06 19:47:49,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.000544, valid_loss 1.001953, train_metric nan, valid_metric 0.006570
[852895:MainThread](2024-04-06 19:47:49,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.981233, valid_loss 1.001765, train_metric nan, valid_metric 0.021494
[852895:MainThread](2024-04-06 19:47:49,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.999331, valid_loss 1.005640, train_metric nan, valid_metric 0.018121
[852895:MainThread](2024-04-06 19:47:50,366) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.997453, valid_loss 1.002969, train_metric nan, valid_metric 0.018668
[852895:MainThread](2024-04-06 19:47:50,899) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.997190, valid_loss 1.003449, train_metric nan, valid_metric 0.020918
[852895:MainThread](2024-04-06 19:47:51,149) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.990379, valid_loss 1.003404, train_metric nan, valid_metric 0.012619
[852895:MainThread](2024-04-06 19:47:51,394) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.994691, valid_loss 1.002428, train_metric nan, valid_metric 0.014120
[852895:MainThread](2024-04-06 19:47:51,691) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.994369, valid_loss 1.003653, train_metric nan, valid_metric 0.010650
[852895:MainThread](2024-04-06 19:47:51,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.990651, valid_loss 1.003486, train_metric nan, valid_metric 0.013977
[852895:MainThread](2024-04-06 19:47:52,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.987037, valid_loss 1.004103, train_metric nan, valid_metric 0.012645
[852895:MainThread](2024-04-06 19:47:52,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.988524, valid_loss 1.001776, train_metric nan, valid_metric 0.017279
[852895:MainThread](2024-04-06 19:47:52,897) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.985830, valid_loss 1.005731, train_metric nan, valid_metric 0.011457
[852895:MainThread](2024-04-06 19:47:53,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.986876, valid_loss 1.002624, train_metric nan, valid_metric 0.017455
[852895:MainThread](2024-04-06 19:47:53,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.995909, valid_loss 1.001796, train_metric nan, valid_metric 0.016308
[852895:MainThread](2024-04-06 19:47:53,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.985236, valid_loss 1.002631, train_metric nan, valid_metric 0.011968
[852895:MainThread](2024-04-06 19:47:53,984) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.972340, valid_loss 1.002362, train_metric nan, valid_metric 0.014814
[852895:MainThread](2024-04-06 19:47:54,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.986389, valid_loss 1.003176, train_metric nan, valid_metric 0.014422
[852895:MainThread](2024-04-06 19:47:54,585) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.995044, valid_loss 1.004168, train_metric nan, valid_metric 0.014702
[852895:MainThread](2024-04-06 19:47:55,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.985628, valid_loss 1.001785, train_metric nan, valid_metric 0.017545
[852895:MainThread](2024-04-06 19:47:55,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.982973, valid_loss 1.002952, train_metric nan, valid_metric 0.016265
[852895:MainThread](2024-04-06 19:47:55,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.980347, valid_loss 1.005073, train_metric nan, valid_metric 0.014060
[852895:MainThread](2024-04-06 19:47:55,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.992583, valid_loss 1.002557, train_metric nan, valid_metric 0.011995
[852895:MainThread](2024-04-06 19:47:56,161) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.983673, valid_loss 1.002998, train_metric nan, valid_metric 0.012976
[852895:MainThread](2024-04-06 19:47:56,538) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.980826, valid_loss 1.000973, train_metric nan, valid_metric 0.015483
[852895:MainThread](2024-04-06 19:47:56,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.985487, valid_loss 1.002815, train_metric nan, valid_metric 0.015042
[852895:MainThread](2024-04-06 19:47:57,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.986439, valid_loss 1.001855, train_metric nan, valid_metric 0.013896
[852895:MainThread](2024-04-06 19:47:57,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.981577, valid_loss 1.001714, train_metric nan, valid_metric 0.018708
[852895:MainThread](2024-04-06 19:47:57,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.975826, valid_loss 1.002578, train_metric nan, valid_metric 0.019178
[852895:MainThread](2024-04-06 19:47:58,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.994172, valid_loss 1.004233, train_metric nan, valid_metric 0.018284
[852895:MainThread](2024-04-06 19:47:58,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.986889, valid_loss 1.003893, train_metric nan, valid_metric 0.019870
[852895:MainThread](2024-04-06 19:47:58,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.980661, valid_loss 1.002094, train_metric nan, valid_metric 0.016356
[852895:MainThread](2024-04-06 19:47:59,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.987396, valid_loss 1.001833, train_metric nan, valid_metric 0.019396
[852895:MainThread](2024-04-06 19:47:59,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.984152, valid_loss 1.002289, train_metric nan, valid_metric 0.013814
[852895:MainThread](2024-04-06 19:47:59,983) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.990591, valid_loss 1.001929, train_metric nan, valid_metric 0.016304
[852895:MainThread](2024-04-06 19:48:00,292) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.983512, valid_loss 1.002101, train_metric nan, valid_metric 0.009162
[852895:MainThread](2024-04-06 19:48:00,550) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.976638, valid_loss 1.003057, train_metric nan, valid_metric 0.015453
[852895:MainThread](2024-04-06 19:48:00,812) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.980149, valid_loss 1.001861, train_metric nan, valid_metric 0.015462
[852895:MainThread](2024-04-06 19:48:01,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.986869, valid_loss 1.003250, train_metric nan, valid_metric 0.014148
[852895:MainThread](2024-04-06 19:48:01,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.996610, valid_loss 1.002824, train_metric nan, valid_metric 0.017685
[852895:MainThread](2024-04-06 19:48:01,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.980522, valid_loss 1.002389, train_metric nan, valid_metric 0.014949
[852895:MainThread](2024-04-06 19:48:01,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.991972, valid_loss 1.002633, train_metric nan, valid_metric 0.015125
[852895:MainThread](2024-04-06 19:48:02,188) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.982705, valid_loss 1.004378, train_metric nan, valid_metric 0.015689
[852895:MainThread](2024-04-06 19:48:02,452) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.977419, valid_loss 1.004524, train_metric nan, valid_metric 0.017731
[852895:MainThread](2024-04-06 19:48:02,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.989419, valid_loss 1.003777, train_metric nan, valid_metric 0.019303
[852895:MainThread](2024-04-06 19:48:03,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.986798, valid_loss 1.002516, train_metric nan, valid_metric 0.020255
[852895:MainThread](2024-04-06 19:48:03,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.988563, valid_loss 1.002059, train_metric nan, valid_metric 0.020412
[852895:MainThread](2024-04-06 19:48:03,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.985065, valid_loss 1.003212, train_metric nan, valid_metric 0.018170
[852895:MainThread](2024-04-06 19:48:04,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.977461, valid_loss 1.002670, train_metric nan, valid_metric 0.018942
[852895:MainThread](2024-04-06 19:48:04,309) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.982929, valid_loss 1.003200, train_metric nan, valid_metric 0.017688
[852895:MainThread](2024-04-06 19:48:04,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.983010, valid_loss 1.003623, train_metric nan, valid_metric 0.016916
[852895:MainThread](2024-04-06 19:48:04,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 19:48:07,056) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 19:48:09,131) INFO - qlib.timer - [log.py:127] - Time cost: 0.001s | waiting `async_log` Done
train tasks:   4%|▍         | 1/25 [01:07<27:09, 67.89s/it][852895:MainThread](2024-04-06 19:48:09,167) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 19:48:09,225) INFO - qlib.workflow - [recorder.py:341] - Recorder 00baf4e7c0f2498dad5f1d66fb4270b2 starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 19:48:10,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 19:48:10,727) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 19:48:10,733) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 19:48:10,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 19:48:19,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 19:48:20,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.584411, valid_loss 1.062451, train_metric nan, valid_metric 0.027532
[852895:MainThread](2024-04-06 19:48:20,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.062451, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 19:48:20,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.136884, valid_loss 1.190402, train_metric nan, valid_metric 0.001431
[852895:MainThread](2024-04-06 19:48:21,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.141204, valid_loss 1.058697, train_metric nan, valid_metric 0.008163
[852895:MainThread](2024-04-06 19:48:21,393) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.062451 to 1.058697, save checkpoint.
[852895:MainThread](2024-04-06 19:48:21,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.074400, valid_loss 1.088079, train_metric nan, valid_metric 0.006316
[852895:MainThread](2024-04-06 19:48:22,143) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.134525, valid_loss 1.072421, train_metric nan, valid_metric 0.014680
[852895:MainThread](2024-04-06 19:48:22,378) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.071325, valid_loss 1.011951, train_metric nan, valid_metric 0.003066
[852895:MainThread](2024-04-06 19:48:22,383) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.058697 to 1.011951, save checkpoint.
[852895:MainThread](2024-04-06 19:48:22,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.044971, valid_loss 1.013402, train_metric nan, valid_metric 0.002693
[852895:MainThread](2024-04-06 19:48:22,873) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.051247, valid_loss 1.014873, train_metric nan, valid_metric 0.018730
[852895:MainThread](2024-04-06 19:48:23,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.058627, valid_loss 1.010153, train_metric nan, valid_metric 0.022784
[852895:MainThread](2024-04-06 19:48:23,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.011951 to 1.010153, save checkpoint.
[852895:MainThread](2024-04-06 19:48:23,395) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.042165, valid_loss 1.034619, train_metric nan, valid_metric 0.009676
[852895:MainThread](2024-04-06 19:48:23,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.038763, valid_loss 1.012446, train_metric nan, valid_metric 0.011752
[852895:MainThread](2024-04-06 19:48:24,309) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.022933, valid_loss 1.017450, train_metric nan, valid_metric 0.009237
[852895:MainThread](2024-04-06 19:48:24,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.025977, valid_loss 1.011264, train_metric nan, valid_metric 0.008184
[852895:MainThread](2024-04-06 19:48:25,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.025093, valid_loss 1.010874, train_metric nan, valid_metric 0.013142
[852895:MainThread](2024-04-06 19:48:26,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.017350, valid_loss 1.015544, train_metric nan, valid_metric 0.013398
[852895:MainThread](2024-04-06 19:48:26,881) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.027818, valid_loss 1.006856, train_metric nan, valid_metric 0.020637
[852895:MainThread](2024-04-06 19:48:26,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.010153 to 1.006856, save checkpoint.
[852895:MainThread](2024-04-06 19:48:27,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.009071, valid_loss 1.014184, train_metric nan, valid_metric 0.015234
[852895:MainThread](2024-04-06 19:48:27,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.008938, valid_loss 1.007761, train_metric nan, valid_metric 0.015068
[852895:MainThread](2024-04-06 19:48:28,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.006474, valid_loss 1.006051, train_metric nan, valid_metric 0.015449
[852895:MainThread](2024-04-06 19:48:28,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006856 to 1.006051, save checkpoint.
[852895:MainThread](2024-04-06 19:48:28,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.020152, valid_loss 1.005229, train_metric nan, valid_metric 0.014682
[852895:MainThread](2024-04-06 19:48:28,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006051 to 1.005229, save checkpoint.
[852895:MainThread](2024-04-06 19:48:29,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.013877, valid_loss 1.035622, train_metric nan, valid_metric -0.002295
[852895:MainThread](2024-04-06 19:48:29,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.016680, valid_loss 1.008034, train_metric nan, valid_metric 0.011595
[852895:MainThread](2024-04-06 19:48:30,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.024202, valid_loss 1.004852, train_metric nan, valid_metric 0.014147
[852895:MainThread](2024-04-06 19:48:30,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.005229 to 1.004852, save checkpoint.
[852895:MainThread](2024-04-06 19:48:30,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.008751, valid_loss 1.019080, train_metric nan, valid_metric 0.019650
[852895:MainThread](2024-04-06 19:48:30,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.004623, valid_loss 1.005462, train_metric nan, valid_metric 0.013272
[852895:MainThread](2024-04-06 19:48:31,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.000001, valid_loss 1.007126, train_metric nan, valid_metric 0.025906
[852895:MainThread](2024-04-06 19:48:31,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.996464, valid_loss 1.009617, train_metric nan, valid_metric 0.012377
[852895:MainThread](2024-04-06 19:48:31,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.998857, valid_loss 1.010904, train_metric nan, valid_metric 0.021185
[852895:MainThread](2024-04-06 19:48:32,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.999725, valid_loss 1.008784, train_metric nan, valid_metric 0.019689
[852895:MainThread](2024-04-06 19:48:32,942) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.007598, valid_loss 1.009062, train_metric nan, valid_metric 0.012409
[852895:MainThread](2024-04-06 19:48:33,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.016358, valid_loss 1.019337, train_metric nan, valid_metric 0.010620
[852895:MainThread](2024-04-06 19:48:33,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.000337, valid_loss 1.008938, train_metric nan, valid_metric 0.015150
[852895:MainThread](2024-04-06 19:48:33,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.992596, valid_loss 1.026150, train_metric nan, valid_metric 0.014620
[852895:MainThread](2024-04-06 19:48:34,033) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.996800, valid_loss 1.010012, train_metric nan, valid_metric 0.002452
[852895:MainThread](2024-04-06 19:48:34,298) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.995395, valid_loss 1.003907, train_metric nan, valid_metric 0.005754
[852895:MainThread](2024-04-06 19:48:34,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.004852 to 1.003907, save checkpoint.
[852895:MainThread](2024-04-06 19:48:34,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.998308, valid_loss 1.008375, train_metric nan, valid_metric 0.004745
[852895:MainThread](2024-04-06 19:48:34,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.002775, valid_loss 1.008995, train_metric nan, valid_metric 0.009964
[852895:MainThread](2024-04-06 19:48:35,300) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.989348, valid_loss 1.005862, train_metric nan, valid_metric 0.016252
[852895:MainThread](2024-04-06 19:48:35,741) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.991056, valid_loss 1.002705, train_metric nan, valid_metric 0.006866
[852895:MainThread](2024-04-06 19:48:35,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003907 to 1.002705, save checkpoint.
[852895:MainThread](2024-04-06 19:48:36,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.990387, valid_loss 1.005704, train_metric nan, valid_metric 0.010731
[852895:MainThread](2024-04-06 19:48:36,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.988893, valid_loss 1.006951, train_metric nan, valid_metric 0.007359
[852895:MainThread](2024-04-06 19:48:36,579) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.997202, valid_loss 1.003369, train_metric nan, valid_metric 0.018084
[852895:MainThread](2024-04-06 19:48:36,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.992958, valid_loss 1.007020, train_metric nan, valid_metric 0.007734
[852895:MainThread](2024-04-06 19:48:37,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.992572, valid_loss 1.005351, train_metric nan, valid_metric 0.005136
[852895:MainThread](2024-04-06 19:48:37,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.995485, valid_loss 1.010985, train_metric nan, valid_metric 0.006123
[852895:MainThread](2024-04-06 19:48:37,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.998653, valid_loss 1.005768, train_metric nan, valid_metric 0.014377
[852895:MainThread](2024-04-06 19:48:38,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.993411, valid_loss 1.006927, train_metric nan, valid_metric 0.014319
[852895:MainThread](2024-04-06 19:48:38,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.992888, valid_loss 1.005022, train_metric nan, valid_metric 0.009733
[852895:MainThread](2024-04-06 19:48:39,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.994249, valid_loss 1.006484, train_metric nan, valid_metric 0.006286
[852895:MainThread](2024-04-06 19:48:39,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.997963, valid_loss 1.004049, train_metric nan, valid_metric 0.015583
[852895:MainThread](2024-04-06 19:48:40,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.987968, valid_loss 1.006184, train_metric nan, valid_metric 0.011974
[852895:MainThread](2024-04-06 19:48:40,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.994491, valid_loss 1.008554, train_metric nan, valid_metric 0.006408
[852895:MainThread](2024-04-06 19:48:40,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.987599, valid_loss 1.007821, train_metric nan, valid_metric 0.006602
[852895:MainThread](2024-04-06 19:48:41,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.009099, valid_loss 1.004887, train_metric nan, valid_metric 0.012164
[852895:MainThread](2024-04-06 19:48:42,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.988260, valid_loss 1.006894, train_metric nan, valid_metric 0.007528
[852895:MainThread](2024-04-06 19:48:42,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.986880, valid_loss 1.005387, train_metric nan, valid_metric 0.014906
[852895:MainThread](2024-04-06 19:48:43,242) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.979390, valid_loss 1.006712, train_metric nan, valid_metric 0.010632
[852895:MainThread](2024-04-06 19:48:43,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.977304, valid_loss 1.009927, train_metric nan, valid_metric 0.010171
[852895:MainThread](2024-04-06 19:48:44,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.991439, valid_loss 1.005011, train_metric nan, valid_metric 0.011593
[852895:MainThread](2024-04-06 19:48:44,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.003058, valid_loss 1.006619, train_metric nan, valid_metric 0.017440
[852895:MainThread](2024-04-06 19:48:44,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.982163, valid_loss 1.008444, train_metric nan, valid_metric 0.009677
[852895:MainThread](2024-04-06 19:48:45,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.986524, valid_loss 1.006476, train_metric nan, valid_metric 0.013406
[852895:MainThread](2024-04-06 19:48:45,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.989637, valid_loss 1.006145, train_metric nan, valid_metric 0.013014
[852895:MainThread](2024-04-06 19:48:45,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.975603, valid_loss 1.005496, train_metric nan, valid_metric 0.012802
[852895:MainThread](2024-04-06 19:48:45,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.979555, valid_loss 1.004728, train_metric nan, valid_metric 0.004621
[852895:MainThread](2024-04-06 19:48:46,211) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.992629, valid_loss 1.006349, train_metric nan, valid_metric 0.008175
[852895:MainThread](2024-04-06 19:48:46,468) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.993738, valid_loss 1.005992, train_metric nan, valid_metric 0.013727
[852895:MainThread](2024-04-06 19:48:46,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.995803, valid_loss 1.007246, train_metric nan, valid_metric 0.011936
[852895:MainThread](2024-04-06 19:48:47,214) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.990921, valid_loss 1.005866, train_metric nan, valid_metric 0.006907
[852895:MainThread](2024-04-06 19:48:47,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.991302, valid_loss 1.006507, train_metric nan, valid_metric 0.011203
[852895:MainThread](2024-04-06 19:48:47,838) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.978816, valid_loss 1.006973, train_metric nan, valid_metric 0.008684
[852895:MainThread](2024-04-06 19:48:48,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.978346, valid_loss 1.004544, train_metric nan, valid_metric 0.009434
[852895:MainThread](2024-04-06 19:48:48,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.985978, valid_loss 1.006672, train_metric nan, valid_metric 0.010232
[852895:MainThread](2024-04-06 19:48:49,037) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.984871, valid_loss 1.006371, train_metric nan, valid_metric 0.010110
[852895:MainThread](2024-04-06 19:48:49,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.988915, valid_loss 1.004676, train_metric nan, valid_metric 0.005572
[852895:MainThread](2024-04-06 19:48:49,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.998824, valid_loss 1.006441, train_metric nan, valid_metric 0.009254
[852895:MainThread](2024-04-06 19:48:50,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.991699, valid_loss 1.004006, train_metric nan, valid_metric 0.004536
[852895:MainThread](2024-04-06 19:48:50,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.991881, valid_loss 1.006032, train_metric nan, valid_metric 0.007982
[852895:MainThread](2024-04-06 19:48:51,099) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.990490, valid_loss 1.004948, train_metric nan, valid_metric 0.007336
[852895:MainThread](2024-04-06 19:48:51,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.989899, valid_loss 1.005015, train_metric nan, valid_metric 0.010843
[852895:MainThread](2024-04-06 19:48:51,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.982227, valid_loss 1.003384, train_metric nan, valid_metric 0.015028
[852895:MainThread](2024-04-06 19:48:52,364) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.991030, valid_loss 1.005596, train_metric nan, valid_metric 0.012613
[852895:MainThread](2024-04-06 19:48:52,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.982094, valid_loss 1.007550, train_metric nan, valid_metric 0.013401
[852895:MainThread](2024-04-06 19:48:53,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.976411, valid_loss 1.006523, train_metric nan, valid_metric 0.013587
[852895:MainThread](2024-04-06 19:48:53,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.983145, valid_loss 1.006557, train_metric nan, valid_metric 0.011096
[852895:MainThread](2024-04-06 19:48:54,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.985900, valid_loss 1.006197, train_metric nan, valid_metric 0.007985
[852895:MainThread](2024-04-06 19:48:54,515) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.986445, valid_loss 1.005312, train_metric nan, valid_metric 0.009265
[852895:MainThread](2024-04-06 19:48:55,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.978493, valid_loss 1.005987, train_metric nan, valid_metric 0.011503
[852895:MainThread](2024-04-06 19:48:55,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.993417, valid_loss 1.005615, train_metric nan, valid_metric 0.012307
[852895:MainThread](2024-04-06 19:48:55,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 19:48:56,695) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 19:48:59,024) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   8%|▊         | 2/25 [01:57<21:58, 57.30s/it][852895:MainThread](2024-04-06 19:48:59,049) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 19:48:59,097) INFO - qlib.workflow - [recorder.py:341] - Recorder f278febcb3354bf09232ec8e0bb5ec1a starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 19:49:00,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 19:49:00,510) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 19:49:00,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 19:49:00,515) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 19:49:09,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 19:49:10,716) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.282876, valid_loss 1.044020, train_metric nan, valid_metric -0.000198
[852895:MainThread](2024-04-06 19:49:10,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.044020, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 19:49:11,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.130491, valid_loss 1.038638, train_metric nan, valid_metric 0.016968
[852895:MainThread](2024-04-06 19:49:11,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.044020 to 1.038638, save checkpoint.
[852895:MainThread](2024-04-06 19:49:11,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.074790, valid_loss 1.017879, train_metric nan, valid_metric 0.009406
[852895:MainThread](2024-04-06 19:49:11,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.038638 to 1.017879, save checkpoint.
[852895:MainThread](2024-04-06 19:49:12,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.056949, valid_loss 1.017365, train_metric nan, valid_metric 0.025331
[852895:MainThread](2024-04-06 19:49:12,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.017879 to 1.017365, save checkpoint.
[852895:MainThread](2024-04-06 19:49:13,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.060819, valid_loss 1.019339, train_metric nan, valid_metric 0.013322
[852895:MainThread](2024-04-06 19:49:13,957) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.046953, valid_loss 1.020807, train_metric nan, valid_metric 0.041951
[852895:MainThread](2024-04-06 19:49:14,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.042358, valid_loss 1.023373, train_metric nan, valid_metric 0.004387
[852895:MainThread](2024-04-06 19:49:15,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.026294, valid_loss 1.006795, train_metric nan, valid_metric 0.034921
[852895:MainThread](2024-04-06 19:49:15,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.017365 to 1.006795, save checkpoint.
[852895:MainThread](2024-04-06 19:49:16,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.036459, valid_loss 1.004612, train_metric nan, valid_metric 0.047050
[852895:MainThread](2024-04-06 19:49:16,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006795 to 1.004612, save checkpoint.
[852895:MainThread](2024-04-06 19:49:16,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.017259, valid_loss 1.002625, train_metric nan, valid_metric 0.033791
[852895:MainThread](2024-04-06 19:49:16,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.004612 to 1.002625, save checkpoint.
[852895:MainThread](2024-04-06 19:49:17,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.014485, valid_loss 1.005004, train_metric nan, valid_metric 0.042203
[852895:MainThread](2024-04-06 19:49:17,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.003897, valid_loss 1.003397, train_metric nan, valid_metric 0.037426
[852895:MainThread](2024-04-06 19:49:17,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.029235, valid_loss 1.001120, train_metric nan, valid_metric 0.030872
[852895:MainThread](2024-04-06 19:49:17,955) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.002625 to 1.001120, save checkpoint.
[852895:MainThread](2024-04-06 19:49:18,378) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.024408, valid_loss 1.011738, train_metric nan, valid_metric 0.021597
[852895:MainThread](2024-04-06 19:49:18,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.006349, valid_loss 1.005335, train_metric nan, valid_metric 0.026026
[852895:MainThread](2024-04-06 19:49:19,326) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.015137, valid_loss 1.005938, train_metric nan, valid_metric 0.020339
[852895:MainThread](2024-04-06 19:49:19,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.025880, valid_loss 1.019428, train_metric nan, valid_metric -0.002793
[852895:MainThread](2024-04-06 19:49:20,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.988418, valid_loss 1.006759, train_metric nan, valid_metric 0.022593
[852895:MainThread](2024-04-06 19:49:20,876) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.995543, valid_loss 1.001425, train_metric nan, valid_metric 0.037001
[852895:MainThread](2024-04-06 19:49:21,376) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.003708, valid_loss 1.001503, train_metric nan, valid_metric 0.035305
[852895:MainThread](2024-04-06 19:49:21,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.993396, valid_loss 1.001118, train_metric nan, valid_metric 0.046123
[852895:MainThread](2024-04-06 19:49:21,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001120 to 1.001118, save checkpoint.
[852895:MainThread](2024-04-06 19:49:22,086) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.996324, valid_loss 1.002459, train_metric nan, valid_metric 0.031379
[852895:MainThread](2024-04-06 19:49:22,643) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.000188, valid_loss 0.999921, train_metric nan, valid_metric 0.031569
[852895:MainThread](2024-04-06 19:49:22,643) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001118 to 0.999921, save checkpoint.
[852895:MainThread](2024-04-06 19:49:23,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.996998, valid_loss 1.001571, train_metric nan, valid_metric 0.028817
[852895:MainThread](2024-04-06 19:49:23,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.990752, valid_loss 1.001830, train_metric nan, valid_metric 0.036900
[852895:MainThread](2024-04-06 19:49:24,047) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.994083, valid_loss 1.000573, train_metric nan, valid_metric 0.041397
[852895:MainThread](2024-04-06 19:49:24,774) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.985540, valid_loss 1.000913, train_metric nan, valid_metric 0.037952
[852895:MainThread](2024-04-06 19:49:25,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.987880, valid_loss 1.006200, train_metric nan, valid_metric 0.025821
[852895:MainThread](2024-04-06 19:49:25,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.994349, valid_loss 1.002653, train_metric nan, valid_metric 0.038571
[852895:MainThread](2024-04-06 19:49:26,132) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.992281, valid_loss 1.004239, train_metric nan, valid_metric 0.035512
[852895:MainThread](2024-04-06 19:49:26,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.995439, valid_loss 0.998916, train_metric nan, valid_metric 0.034596
[852895:MainThread](2024-04-06 19:49:26,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999921 to 0.998916, save checkpoint.
[852895:MainThread](2024-04-06 19:49:26,743) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.994179, valid_loss 1.002439, train_metric nan, valid_metric 0.030460
[852895:MainThread](2024-04-06 19:49:27,142) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.986796, valid_loss 1.004115, train_metric nan, valid_metric 0.044409
[852895:MainThread](2024-04-06 19:49:27,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.989139, valid_loss 1.002674, train_metric nan, valid_metric 0.025736
[852895:MainThread](2024-04-06 19:49:27,743) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.979281, valid_loss 0.999875, train_metric nan, valid_metric 0.038321
[852895:MainThread](2024-04-06 19:49:28,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.992131, valid_loss 1.003648, train_metric nan, valid_metric 0.031706
[852895:MainThread](2024-04-06 19:49:28,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.982404, valid_loss 1.002086, train_metric nan, valid_metric 0.022078
[852895:MainThread](2024-04-06 19:49:28,599) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.995984, valid_loss 1.000469, train_metric nan, valid_metric 0.010224
[852895:MainThread](2024-04-06 19:49:28,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.984561, valid_loss 1.000772, train_metric nan, valid_metric 0.025370
[852895:MainThread](2024-04-06 19:49:29,242) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.988686, valid_loss 1.001103, train_metric nan, valid_metric 0.027640
[852895:MainThread](2024-04-06 19:49:29,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.987541, valid_loss 1.001126, train_metric nan, valid_metric 0.036230
[852895:MainThread](2024-04-06 19:49:29,869) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.986921, valid_loss 1.002380, train_metric nan, valid_metric 0.041024
[852895:MainThread](2024-04-06 19:49:30,146) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.996811, valid_loss 1.000510, train_metric nan, valid_metric 0.033425
[852895:MainThread](2024-04-06 19:49:30,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.980404, valid_loss 1.000199, train_metric nan, valid_metric 0.038116
[852895:MainThread](2024-04-06 19:49:30,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.986002, valid_loss 0.999710, train_metric nan, valid_metric 0.024731
[852895:MainThread](2024-04-06 19:49:31,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.980729, valid_loss 1.002792, train_metric nan, valid_metric 0.029529
[852895:MainThread](2024-04-06 19:49:31,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.976155, valid_loss 1.000079, train_metric nan, valid_metric 0.028617
[852895:MainThread](2024-04-06 19:49:32,108) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.974194, valid_loss 0.999217, train_metric nan, valid_metric 0.032847
[852895:MainThread](2024-04-06 19:49:32,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.978570, valid_loss 0.999845, train_metric nan, valid_metric 0.032523
[852895:MainThread](2024-04-06 19:49:32,973) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.989197, valid_loss 0.998864, train_metric nan, valid_metric 0.031028
[852895:MainThread](2024-04-06 19:49:32,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998916 to 0.998864, save checkpoint.
[852895:MainThread](2024-04-06 19:49:33,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.994481, valid_loss 1.000632, train_metric nan, valid_metric 0.033376
[852895:MainThread](2024-04-06 19:49:33,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.984348, valid_loss 1.002071, train_metric nan, valid_metric 0.034928
[852895:MainThread](2024-04-06 19:49:34,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.981434, valid_loss 1.001667, train_metric nan, valid_metric 0.045517
[852895:MainThread](2024-04-06 19:49:34,383) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.986701, valid_loss 0.999776, train_metric nan, valid_metric 0.035938
[852895:MainThread](2024-04-06 19:49:34,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.975835, valid_loss 1.002200, train_metric nan, valid_metric 0.032496
[852895:MainThread](2024-04-06 19:49:35,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.971085, valid_loss 1.000363, train_metric nan, valid_metric 0.036790
[852895:MainThread](2024-04-06 19:49:35,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.989566, valid_loss 0.999511, train_metric nan, valid_metric 0.041736
[852895:MainThread](2024-04-06 19:49:35,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.982645, valid_loss 1.000977, train_metric nan, valid_metric 0.039354
[852895:MainThread](2024-04-06 19:49:35,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.984458, valid_loss 1.000955, train_metric nan, valid_metric 0.034998
[852895:MainThread](2024-04-06 19:49:36,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.998295, valid_loss 0.998107, train_metric nan, valid_metric 0.032110
[852895:MainThread](2024-04-06 19:49:36,356) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998864 to 0.998107, save checkpoint.
[852895:MainThread](2024-04-06 19:49:36,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.973821, valid_loss 1.000955, train_metric nan, valid_metric 0.030926
[852895:MainThread](2024-04-06 19:49:37,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.980191, valid_loss 1.001046, train_metric nan, valid_metric 0.034193
[852895:MainThread](2024-04-06 19:49:37,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.985908, valid_loss 1.001374, train_metric nan, valid_metric 0.038682
[852895:MainThread](2024-04-06 19:49:38,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.979091, valid_loss 1.001836, train_metric nan, valid_metric 0.032103
[852895:MainThread](2024-04-06 19:49:38,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.977277, valid_loss 1.002155, train_metric nan, valid_metric 0.031287
[852895:MainThread](2024-04-06 19:49:38,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.981904, valid_loss 1.003359, train_metric nan, valid_metric 0.030566
[852895:MainThread](2024-04-06 19:49:39,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.984692, valid_loss 1.002198, train_metric nan, valid_metric 0.032996
[852895:MainThread](2024-04-06 19:49:39,707) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.990252, valid_loss 0.999197, train_metric nan, valid_metric 0.029523
[852895:MainThread](2024-04-06 19:49:40,187) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.982347, valid_loss 0.999828, train_metric nan, valid_metric 0.033343
[852895:MainThread](2024-04-06 19:49:40,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.983381, valid_loss 1.001029, train_metric nan, valid_metric 0.029146
[852895:MainThread](2024-04-06 19:49:40,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.985061, valid_loss 1.002186, train_metric nan, valid_metric 0.032345
[852895:MainThread](2024-04-06 19:49:41,227) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.982039, valid_loss 0.999656, train_metric nan, valid_metric 0.035679
[852895:MainThread](2024-04-06 19:49:41,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.979691, valid_loss 1.000775, train_metric nan, valid_metric 0.029926
[852895:MainThread](2024-04-06 19:49:42,153) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.980674, valid_loss 0.998982, train_metric nan, valid_metric 0.029749
[852895:MainThread](2024-04-06 19:49:42,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.983469, valid_loss 0.999748, train_metric nan, valid_metric 0.035704
[852895:MainThread](2024-04-06 19:49:43,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.972411, valid_loss 1.000939, train_metric nan, valid_metric 0.030041
[852895:MainThread](2024-04-06 19:49:43,663) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.990348, valid_loss 0.998816, train_metric nan, valid_metric 0.031682
[852895:MainThread](2024-04-06 19:49:44,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.975993, valid_loss 1.001004, train_metric nan, valid_metric 0.034712
[852895:MainThread](2024-04-06 19:49:45,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.979461, valid_loss 1.000803, train_metric nan, valid_metric 0.031118
[852895:MainThread](2024-04-06 19:49:45,983) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.987937, valid_loss 1.001669, train_metric nan, valid_metric 0.023205
[852895:MainThread](2024-04-06 19:49:46,427) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.986002, valid_loss 1.001472, train_metric nan, valid_metric 0.033638
[852895:MainThread](2024-04-06 19:49:47,163) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.981396, valid_loss 1.001632, train_metric nan, valid_metric 0.035326
[852895:MainThread](2024-04-06 19:49:47,793) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.981315, valid_loss 0.999596, train_metric nan, valid_metric 0.023575
[852895:MainThread](2024-04-06 19:49:48,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.988889, valid_loss 1.001218, train_metric nan, valid_metric 0.032575
[852895:MainThread](2024-04-06 19:49:49,383) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.982184, valid_loss 1.001879, train_metric nan, valid_metric 0.033442
[852895:MainThread](2024-04-06 19:49:49,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.989970, valid_loss 1.000602, train_metric nan, valid_metric 0.037196
[852895:MainThread](2024-04-06 19:49:50,374) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.981571, valid_loss 1.000642, train_metric nan, valid_metric 0.036378
[852895:MainThread](2024-04-06 19:49:50,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.980712, valid_loss 0.998577, train_metric nan, valid_metric 0.030871
[852895:MainThread](2024-04-06 19:49:51,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.971661, valid_loss 1.000770, train_metric nan, valid_metric 0.030700
[852895:MainThread](2024-04-06 19:49:51,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.966996, valid_loss 1.001839, train_metric nan, valid_metric 0.027323
[852895:MainThread](2024-04-06 19:49:52,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.974304, valid_loss 1.002556, train_metric nan, valid_metric 0.035175
[852895:MainThread](2024-04-06 19:49:52,799) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.978932, valid_loss 1.001584, train_metric nan, valid_metric 0.032942
[852895:MainThread](2024-04-06 19:49:53,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.984449, valid_loss 1.000805, train_metric nan, valid_metric 0.030240
[852895:MainThread](2024-04-06 19:49:53,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.984570, valid_loss 1.001444, train_metric nan, valid_metric 0.030917
[852895:MainThread](2024-04-06 19:49:54,237) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.990688, valid_loss 1.000447, train_metric nan, valid_metric 0.031385
[852895:MainThread](2024-04-06 19:49:54,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.982853, valid_loss 1.001515, train_metric nan, valid_metric 0.026280
[852895:MainThread](2024-04-06 19:49:54,856) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.983654, valid_loss 1.001159, train_metric nan, valid_metric 0.031887
[852895:MainThread](2024-04-06 19:49:55,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.980959, valid_loss 1.001536, train_metric nan, valid_metric 0.035377
[852895:MainThread](2024-04-06 19:49:56,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.979841, valid_loss 1.001453, train_metric nan, valid_metric 0.036060
[852895:MainThread](2024-04-06 19:49:56,378) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.983422, valid_loss 1.001210, train_metric nan, valid_metric 0.034056
[852895:MainThread](2024-04-06 19:49:56,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.982525, valid_loss 1.001328, train_metric nan, valid_metric 0.036632
[852895:MainThread](2024-04-06 19:49:57,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.983101, valid_loss 1.000762, train_metric nan, valid_metric 0.034117
[852895:MainThread](2024-04-06 19:49:57,270) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.986056, valid_loss 1.001379, train_metric nan, valid_metric 0.034721
[852895:MainThread](2024-04-06 19:49:57,732) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.986316, valid_loss 1.001056, train_metric nan, valid_metric 0.035440
[852895:MainThread](2024-04-06 19:49:58,204) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.985610, valid_loss 1.000037, train_metric nan, valid_metric 0.032173
[852895:MainThread](2024-04-06 19:49:58,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 0.989235, valid_loss 0.998765, train_metric nan, valid_metric 0.031383
[852895:MainThread](2024-04-06 19:49:58,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.978973, valid_loss 0.999854, train_metric nan, valid_metric 0.030857
[852895:MainThread](2024-04-06 19:49:59,062) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 0.984803, valid_loss 1.001309, train_metric nan, valid_metric 0.031928
[852895:MainThread](2024-04-06 19:49:59,561) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 0.991369, valid_loss 1.001154, train_metric nan, valid_metric 0.032958
[852895:MainThread](2024-04-06 19:49:59,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 0.989147, valid_loss 1.001544, train_metric nan, valid_metric 0.034752
[852895:MainThread](2024-04-06 19:49:59,885) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 19:50:01,288) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 19:50:04,235) INFO - qlib.timer - [log.py:127] - Time cost: 0.004s | waiting `async_log` Done
train tasks:  12%|█▏        | 3/25 [03:03<22:20, 60.92s/it][852895:MainThread](2024-04-06 19:50:04,278) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 19:50:04,357) INFO - qlib.workflow - [recorder.py:341] - Recorder 0491cef5ffeb40199dbaf44d2869c8a5 starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 19:50:06,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 19:50:06,366) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 19:50:06,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 19:50:06,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 19:50:18,261) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 19:50:20,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.267752, valid_loss 1.115111, train_metric nan, valid_metric 0.017766
[852895:MainThread](2024-04-06 19:50:20,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.115111, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 19:50:21,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.091139, valid_loss 1.027156, train_metric nan, valid_metric 0.004294
[852895:MainThread](2024-04-06 19:50:21,941) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.115111 to 1.027156, save checkpoint.
[852895:MainThread](2024-04-06 19:50:22,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.054960, valid_loss 1.036961, train_metric nan, valid_metric -0.003643
[852895:MainThread](2024-04-06 19:50:23,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.053095, valid_loss 1.037120, train_metric nan, valid_metric -0.030731
[852895:MainThread](2024-04-06 19:50:23,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.040957, valid_loss 1.016459, train_metric nan, valid_metric 0.006709
[852895:MainThread](2024-04-06 19:50:23,624) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.027156 to 1.016459, save checkpoint.
[852895:MainThread](2024-04-06 19:50:23,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.051658, valid_loss 1.063227, train_metric nan, valid_metric 0.001277
[852895:MainThread](2024-04-06 19:50:24,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.031520, valid_loss 1.018977, train_metric nan, valid_metric 0.011002
[852895:MainThread](2024-04-06 19:50:24,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.001660, valid_loss 1.000311, train_metric nan, valid_metric 0.053699
[852895:MainThread](2024-04-06 19:50:24,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.016459 to 1.000311, save checkpoint.
[852895:MainThread](2024-04-06 19:50:24,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 0.995701, valid_loss 1.002618, train_metric nan, valid_metric 0.047302
[852895:MainThread](2024-04-06 19:50:24,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.010161, valid_loss 1.003115, train_metric nan, valid_metric 0.036698
[852895:MainThread](2024-04-06 19:50:25,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.002368, valid_loss 1.004573, train_metric nan, valid_metric 0.030731
[852895:MainThread](2024-04-06 19:50:26,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.010840, valid_loss 1.020031, train_metric nan, valid_metric 0.040248
[852895:MainThread](2024-04-06 19:50:26,796) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.001878, valid_loss 0.999096, train_metric nan, valid_metric 0.054762
[852895:MainThread](2024-04-06 19:50:26,796) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000311 to 0.999096, save checkpoint.
[852895:MainThread](2024-04-06 19:50:27,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.008560, valid_loss 0.999184, train_metric nan, valid_metric 0.038758
[852895:MainThread](2024-04-06 19:50:27,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.024593, valid_loss 1.039159, train_metric nan, valid_metric 0.031996
[852895:MainThread](2024-04-06 19:50:27,504) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.019472, valid_loss 0.999668, train_metric nan, valid_metric 0.058687
[852895:MainThread](2024-04-06 19:50:27,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.990799, valid_loss 0.993371, train_metric nan, valid_metric 0.060660
[852895:MainThread](2024-04-06 19:50:27,746) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999096 to 0.993371, save checkpoint.
[852895:MainThread](2024-04-06 19:50:27,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.990152, valid_loss 1.019277, train_metric nan, valid_metric 0.036962
[852895:MainThread](2024-04-06 19:50:28,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.998839, valid_loss 0.996333, train_metric nan, valid_metric 0.058483
[852895:MainThread](2024-04-06 19:50:28,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.986452, valid_loss 0.996273, train_metric nan, valid_metric 0.050782
[852895:MainThread](2024-04-06 19:50:28,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.993211, valid_loss 0.999540, train_metric nan, valid_metric 0.036465
[852895:MainThread](2024-04-06 19:50:28,996) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.988077, valid_loss 0.998230, train_metric nan, valid_metric 0.035376
[852895:MainThread](2024-04-06 19:50:29,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.987293, valid_loss 1.001147, train_metric nan, valid_metric 0.044559
[852895:MainThread](2024-04-06 19:50:29,433) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.000290, valid_loss 1.001767, train_metric nan, valid_metric 0.052960
[852895:MainThread](2024-04-06 19:50:29,709) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.996517, valid_loss 0.998233, train_metric nan, valid_metric 0.036452
[852895:MainThread](2024-04-06 19:50:30,006) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.993531, valid_loss 1.005850, train_metric nan, valid_metric 0.049350
[852895:MainThread](2024-04-06 19:50:30,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.984254, valid_loss 0.995245, train_metric nan, valid_metric 0.057384
[852895:MainThread](2024-04-06 19:50:30,878) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.995739, valid_loss 0.996837, train_metric nan, valid_metric 0.046829
[852895:MainThread](2024-04-06 19:50:31,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.991088, valid_loss 0.996654, train_metric nan, valid_metric 0.049886
[852895:MainThread](2024-04-06 19:50:31,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.990380, valid_loss 0.999793, train_metric nan, valid_metric 0.044382
[852895:MainThread](2024-04-06 19:50:32,359) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.994270, valid_loss 0.999028, train_metric nan, valid_metric 0.045963
[852895:MainThread](2024-04-06 19:50:32,677) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.993935, valid_loss 0.999447, train_metric nan, valid_metric 0.038236
[852895:MainThread](2024-04-06 19:50:33,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.979118, valid_loss 0.999257, train_metric nan, valid_metric 0.033578
[852895:MainThread](2024-04-06 19:50:33,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.989752, valid_loss 0.996652, train_metric nan, valid_metric 0.048852
[852895:MainThread](2024-04-06 19:50:34,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.993669, valid_loss 1.001190, train_metric nan, valid_metric 0.029202
[852895:MainThread](2024-04-06 19:50:34,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.990450, valid_loss 0.998166, train_metric nan, valid_metric 0.050173
[852895:MainThread](2024-04-06 19:50:34,794) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.990965, valid_loss 0.998631, train_metric nan, valid_metric 0.036447
[852895:MainThread](2024-04-06 19:50:35,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.994231, valid_loss 0.998513, train_metric nan, valid_metric 0.040004
[852895:MainThread](2024-04-06 19:50:35,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.989877, valid_loss 0.999189, train_metric nan, valid_metric 0.044659
[852895:MainThread](2024-04-06 19:50:35,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.991626, valid_loss 1.000064, train_metric nan, valid_metric 0.043885
[852895:MainThread](2024-04-06 19:50:36,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.985690, valid_loss 0.998409, train_metric nan, valid_metric 0.044788
[852895:MainThread](2024-04-06 19:50:36,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.978787, valid_loss 1.000278, train_metric nan, valid_metric 0.035482
[852895:MainThread](2024-04-06 19:50:36,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.986620, valid_loss 0.998488, train_metric nan, valid_metric 0.040180
[852895:MainThread](2024-04-06 19:50:37,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.990290, valid_loss 0.996590, train_metric nan, valid_metric 0.046459
[852895:MainThread](2024-04-06 19:50:37,561) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.997971, valid_loss 1.000242, train_metric nan, valid_metric 0.023103
[852895:MainThread](2024-04-06 19:50:37,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.981603, valid_loss 0.999795, train_metric nan, valid_metric 0.042402
[852895:MainThread](2024-04-06 19:50:38,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.980276, valid_loss 0.997795, train_metric nan, valid_metric 0.052337
[852895:MainThread](2024-04-06 19:50:38,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.979705, valid_loss 0.998060, train_metric nan, valid_metric 0.043472
[852895:MainThread](2024-04-06 19:50:38,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.985031, valid_loss 0.999477, train_metric nan, valid_metric 0.038990
[852895:MainThread](2024-04-06 19:50:39,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.984208, valid_loss 0.997556, train_metric nan, valid_metric 0.049453
[852895:MainThread](2024-04-06 19:50:39,676) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.998408, valid_loss 0.998192, train_metric nan, valid_metric 0.040044
[852895:MainThread](2024-04-06 19:50:40,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.985761, valid_loss 0.998206, train_metric nan, valid_metric 0.037401
[852895:MainThread](2024-04-06 19:50:40,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.977583, valid_loss 0.998167, train_metric nan, valid_metric 0.043534
[852895:MainThread](2024-04-06 19:50:41,394) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.984951, valid_loss 0.998908, train_metric nan, valid_metric 0.043421
[852895:MainThread](2024-04-06 19:50:41,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.987219, valid_loss 0.999680, train_metric nan, valid_metric 0.041834
[852895:MainThread](2024-04-06 19:50:42,233) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.995368, valid_loss 0.999652, train_metric nan, valid_metric 0.040778
[852895:MainThread](2024-04-06 19:50:42,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.973994, valid_loss 0.998711, train_metric nan, valid_metric 0.042773
[852895:MainThread](2024-04-06 19:50:43,091) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.980392, valid_loss 0.998578, train_metric nan, valid_metric 0.041043
[852895:MainThread](2024-04-06 19:50:43,442) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.984384, valid_loss 0.997876, train_metric nan, valid_metric 0.052481
[852895:MainThread](2024-04-06 19:50:43,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.984898, valid_loss 0.997945, train_metric nan, valid_metric 0.040495
[852895:MainThread](2024-04-06 19:50:44,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.985513, valid_loss 0.999059, train_metric nan, valid_metric 0.038066
[852895:MainThread](2024-04-06 19:50:44,799) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.993168, valid_loss 1.000777, train_metric nan, valid_metric 0.039261
[852895:MainThread](2024-04-06 19:50:45,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.981046, valid_loss 0.999762, train_metric nan, valid_metric 0.040453
[852895:MainThread](2024-04-06 19:50:46,018) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.988495, valid_loss 0.998489, train_metric nan, valid_metric 0.039536
[852895:MainThread](2024-04-06 19:50:46,424) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.984202, valid_loss 0.999589, train_metric nan, valid_metric 0.041658
[852895:MainThread](2024-04-06 19:50:46,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.988488, valid_loss 0.996656, train_metric nan, valid_metric 0.040120
[852895:MainThread](2024-04-06 19:50:47,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.984778, valid_loss 0.997089, train_metric nan, valid_metric 0.048078
[852895:MainThread](2024-04-06 19:50:47,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 19:50:50,555) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 19:50:54,512) INFO - qlib.timer - [log.py:127] - Time cost: 0.001s | waiting `async_log` Done
train tasks:  16%|█▌        | 4/25 [03:53<19:50, 56.71s/it][852895:MainThread](2024-04-06 19:50:54,526) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 19:50:54,568) INFO - qlib.workflow - [recorder.py:341] - Recorder dfe4571af187479f853dfc542260c965 starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 19:50:55,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 19:50:55,590) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 19:50:55,602) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 19:50:55,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 19:51:03,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 19:51:03,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.214830, valid_loss 1.163836, train_metric nan, valid_metric -0.017319
[852895:MainThread](2024-04-06 19:51:03,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.163836, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 19:51:04,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.077614, valid_loss 1.102925, train_metric nan, valid_metric 0.057219
[852895:MainThread](2024-04-06 19:51:04,180) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.163836 to 1.102925, save checkpoint.
[852895:MainThread](2024-04-06 19:51:04,504) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.046558, valid_loss 1.032572, train_metric nan, valid_metric -0.005403
[852895:MainThread](2024-04-06 19:51:04,505) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.102925 to 1.032572, save checkpoint.
[852895:MainThread](2024-04-06 19:51:04,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.045588, valid_loss 1.010414, train_metric nan, valid_metric 0.013605
[852895:MainThread](2024-04-06 19:51:04,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.032572 to 1.010414, save checkpoint.
[852895:MainThread](2024-04-06 19:51:05,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.030895, valid_loss 1.005597, train_metric nan, valid_metric 0.045715
[852895:MainThread](2024-04-06 19:51:05,082) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.010414 to 1.005597, save checkpoint.
[852895:MainThread](2024-04-06 19:51:05,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.026050, valid_loss 1.010016, train_metric nan, valid_metric -0.007437
[852895:MainThread](2024-04-06 19:51:05,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.020815, valid_loss 1.019827, train_metric nan, valid_metric 0.031725
[852895:MainThread](2024-04-06 19:51:06,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.034289, valid_loss 1.028505, train_metric nan, valid_metric 0.013077
[852895:MainThread](2024-04-06 19:51:07,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.008042, valid_loss 1.001479, train_metric nan, valid_metric 0.041681
[852895:MainThread](2024-04-06 19:51:07,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.005597 to 1.001479, save checkpoint.
[852895:MainThread](2024-04-06 19:51:07,487) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.003658, valid_loss 0.996839, train_metric nan, valid_metric 0.068590
[852895:MainThread](2024-04-06 19:51:07,494) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001479 to 0.996839, save checkpoint.
[852895:MainThread](2024-04-06 19:51:08,130) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 0.996024, valid_loss 1.010788, train_metric nan, valid_metric 0.006948
[852895:MainThread](2024-04-06 19:51:08,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.010006, valid_loss 1.006029, train_metric nan, valid_metric 0.047828
[852895:MainThread](2024-04-06 19:51:09,161) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.990583, valid_loss 0.993793, train_metric nan, valid_metric 0.081246
[852895:MainThread](2024-04-06 19:51:09,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996839 to 0.993793, save checkpoint.
[852895:MainThread](2024-04-06 19:51:09,876) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.002156, valid_loss 0.998363, train_metric nan, valid_metric 0.054588
[852895:MainThread](2024-04-06 19:51:10,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.996389, valid_loss 0.993860, train_metric nan, valid_metric 0.064549
[852895:MainThread](2024-04-06 19:51:10,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.998636, valid_loss 1.002222, train_metric nan, valid_metric 0.031720
[852895:MainThread](2024-04-06 19:51:11,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.002837, valid_loss 1.009620, train_metric nan, valid_metric 0.042460
[852895:MainThread](2024-04-06 19:51:11,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.998615, valid_loss 1.002466, train_metric nan, valid_metric 0.037324
[852895:MainThread](2024-04-06 19:51:12,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.993169, valid_loss 0.996950, train_metric nan, valid_metric 0.049308
[852895:MainThread](2024-04-06 19:51:12,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.996351, valid_loss 0.998808, train_metric nan, valid_metric 0.047114
[852895:MainThread](2024-04-06 19:51:12,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.999784, valid_loss 0.997353, train_metric nan, valid_metric 0.081716
[852895:MainThread](2024-04-06 19:51:13,234) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.998091, valid_loss 0.993751, train_metric nan, valid_metric 0.063621
[852895:MainThread](2024-04-06 19:51:13,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993793 to 0.993751, save checkpoint.
[852895:MainThread](2024-04-06 19:51:13,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.988218, valid_loss 0.997177, train_metric nan, valid_metric 0.057066
[852895:MainThread](2024-04-06 19:51:14,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.997566, valid_loss 0.993031, train_metric nan, valid_metric 0.080290
[852895:MainThread](2024-04-06 19:51:14,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993751 to 0.993031, save checkpoint.
[852895:MainThread](2024-04-06 19:51:14,354) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.989433, valid_loss 0.994172, train_metric nan, valid_metric 0.062529
[852895:MainThread](2024-04-06 19:51:14,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.992706, valid_loss 0.991404, train_metric nan, valid_metric 0.077576
[852895:MainThread](2024-04-06 19:51:14,621) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993031 to 0.991404, save checkpoint.
[852895:MainThread](2024-04-06 19:51:15,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.981217, valid_loss 1.007850, train_metric nan, valid_metric 0.019014
[852895:MainThread](2024-04-06 19:51:15,530) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.994264, valid_loss 0.996300, train_metric nan, valid_metric 0.055036
[852895:MainThread](2024-04-06 19:51:15,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.983194, valid_loss 0.991716, train_metric nan, valid_metric 0.081740
[852895:MainThread](2024-04-06 19:51:16,484) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.986896, valid_loss 0.997257, train_metric nan, valid_metric 0.060539
[852895:MainThread](2024-04-06 19:51:16,980) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.984987, valid_loss 0.996163, train_metric nan, valid_metric 0.051990
[852895:MainThread](2024-04-06 19:51:17,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.988775, valid_loss 0.997455, train_metric nan, valid_metric 0.051028
[852895:MainThread](2024-04-06 19:51:18,089) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.994520, valid_loss 1.000835, train_metric nan, valid_metric 0.038503
[852895:MainThread](2024-04-06 19:51:18,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.990705, valid_loss 0.999795, train_metric nan, valid_metric 0.046100
[852895:MainThread](2024-04-06 19:51:19,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.980271, valid_loss 0.994092, train_metric nan, valid_metric 0.054460
[852895:MainThread](2024-04-06 19:51:19,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.983735, valid_loss 0.991486, train_metric nan, valid_metric 0.084130
[852895:MainThread](2024-04-06 19:51:19,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.983073, valid_loss 0.994376, train_metric nan, valid_metric 0.063570
[852895:MainThread](2024-04-06 19:51:20,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.987811, valid_loss 0.992590, train_metric nan, valid_metric 0.067305
[852895:MainThread](2024-04-06 19:51:20,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.977960, valid_loss 0.992464, train_metric nan, valid_metric 0.071932
[852895:MainThread](2024-04-06 19:51:20,980) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.987453, valid_loss 0.996004, train_metric nan, valid_metric 0.051637
[852895:MainThread](2024-04-06 19:51:21,255) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.987621, valid_loss 0.992824, train_metric nan, valid_metric 0.078166
[852895:MainThread](2024-04-06 19:51:21,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.990441, valid_loss 0.993276, train_metric nan, valid_metric 0.062734
[852895:MainThread](2024-04-06 19:51:21,973) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.994743, valid_loss 0.990391, train_metric nan, valid_metric 0.083038
[852895:MainThread](2024-04-06 19:51:21,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991404 to 0.990391, save checkpoint.
[852895:MainThread](2024-04-06 19:51:22,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.987999, valid_loss 0.992605, train_metric nan, valid_metric 0.074058
[852895:MainThread](2024-04-06 19:51:22,567) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.000179, valid_loss 0.997696, train_metric nan, valid_metric 0.044045
[852895:MainThread](2024-04-06 19:51:22,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.989679, valid_loss 0.992050, train_metric nan, valid_metric 0.073589
[852895:MainThread](2024-04-06 19:51:23,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.982653, valid_loss 0.994095, train_metric nan, valid_metric 0.065538
[852895:MainThread](2024-04-06 19:51:23,602) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.993380, valid_loss 0.992636, train_metric nan, valid_metric 0.072014
[852895:MainThread](2024-04-06 19:51:23,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.982593, valid_loss 0.992667, train_metric nan, valid_metric 0.078289
[852895:MainThread](2024-04-06 19:51:24,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.989523, valid_loss 0.997812, train_metric nan, valid_metric 0.066875
[852895:MainThread](2024-04-06 19:51:24,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.983340, valid_loss 0.992481, train_metric nan, valid_metric 0.082246
[852895:MainThread](2024-04-06 19:51:24,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.981535, valid_loss 0.994302, train_metric nan, valid_metric 0.066360
[852895:MainThread](2024-04-06 19:51:25,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.991724, valid_loss 0.996581, train_metric nan, valid_metric 0.044787
[852895:MainThread](2024-04-06 19:51:25,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.985033, valid_loss 0.991827, train_metric nan, valid_metric 0.074593
[852895:MainThread](2024-04-06 19:51:25,812) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.978593, valid_loss 0.992843, train_metric nan, valid_metric 0.075550
[852895:MainThread](2024-04-06 19:51:26,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.983625, valid_loss 0.994051, train_metric nan, valid_metric 0.063585
[852895:MainThread](2024-04-06 19:51:26,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.988628, valid_loss 0.991549, train_metric nan, valid_metric 0.075501
[852895:MainThread](2024-04-06 19:51:26,677) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.986720, valid_loss 0.994061, train_metric nan, valid_metric 0.062780
[852895:MainThread](2024-04-06 19:51:27,140) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.987863, valid_loss 0.995393, train_metric nan, valid_metric 0.070516
[852895:MainThread](2024-04-06 19:51:27,581) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.985769, valid_loss 0.989825, train_metric nan, valid_metric 0.086417
[852895:MainThread](2024-04-06 19:51:27,586) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990391 to 0.989825, save checkpoint.
[852895:MainThread](2024-04-06 19:51:27,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.982815, valid_loss 0.992687, train_metric nan, valid_metric 0.068081
[852895:MainThread](2024-04-06 19:51:28,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.995197, valid_loss 0.992663, train_metric nan, valid_metric 0.068857
[852895:MainThread](2024-04-06 19:51:28,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.993714, valid_loss 0.992300, train_metric nan, valid_metric 0.071467
[852895:MainThread](2024-04-06 19:51:29,148) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.986090, valid_loss 0.992605, train_metric nan, valid_metric 0.073092
[852895:MainThread](2024-04-06 19:51:29,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.978799, valid_loss 0.994297, train_metric nan, valid_metric 0.065661
[852895:MainThread](2024-04-06 19:51:29,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.985321, valid_loss 0.991674, train_metric nan, valid_metric 0.075462
[852895:MainThread](2024-04-06 19:51:30,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.987799, valid_loss 0.991145, train_metric nan, valid_metric 0.083410
[852895:MainThread](2024-04-06 19:51:30,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.987193, valid_loss 0.997033, train_metric nan, valid_metric 0.064371
[852895:MainThread](2024-04-06 19:51:30,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.983000, valid_loss 0.993169, train_metric nan, valid_metric 0.062425
[852895:MainThread](2024-04-06 19:51:31,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.983733, valid_loss 0.995111, train_metric nan, valid_metric 0.053900
[852895:MainThread](2024-04-06 19:51:31,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.973879, valid_loss 0.994013, train_metric nan, valid_metric 0.065341
[852895:MainThread](2024-04-06 19:51:31,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.986504, valid_loss 0.993350, train_metric nan, valid_metric 0.071771
[852895:MainThread](2024-04-06 19:51:32,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.972097, valid_loss 0.991365, train_metric nan, valid_metric 0.080505
[852895:MainThread](2024-04-06 19:51:32,484) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.993216, valid_loss 0.992809, train_metric nan, valid_metric 0.070275
[852895:MainThread](2024-04-06 19:51:32,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.978251, valid_loss 0.992356, train_metric nan, valid_metric 0.074412
[852895:MainThread](2024-04-06 19:51:33,344) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.987865, valid_loss 0.992747, train_metric nan, valid_metric 0.075220
[852895:MainThread](2024-04-06 19:51:33,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.989833, valid_loss 0.992822, train_metric nan, valid_metric 0.074862
[852895:MainThread](2024-04-06 19:51:34,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.996397, valid_loss 0.991328, train_metric nan, valid_metric 0.079991
[852895:MainThread](2024-04-06 19:51:34,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.979640, valid_loss 0.991346, train_metric nan, valid_metric 0.080771
[852895:MainThread](2024-04-06 19:51:34,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.984024, valid_loss 0.993786, train_metric nan, valid_metric 0.063997
[852895:MainThread](2024-04-06 19:51:35,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.984209, valid_loss 0.994964, train_metric nan, valid_metric 0.049392
[852895:MainThread](2024-04-06 19:51:35,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.984649, valid_loss 0.991307, train_metric nan, valid_metric 0.077480
[852895:MainThread](2024-04-06 19:51:35,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.976845, valid_loss 0.992554, train_metric nan, valid_metric 0.073369
[852895:MainThread](2024-04-06 19:51:36,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.987593, valid_loss 0.991764, train_metric nan, valid_metric 0.078450
[852895:MainThread](2024-04-06 19:51:36,757) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.976194, valid_loss 0.992599, train_metric nan, valid_metric 0.073090
[852895:MainThread](2024-04-06 19:51:37,149) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.987050, valid_loss 0.991544, train_metric nan, valid_metric 0.078407
[852895:MainThread](2024-04-06 19:51:37,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.990704, valid_loss 0.992912, train_metric nan, valid_metric 0.073387
[852895:MainThread](2024-04-06 19:51:38,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.986418, valid_loss 0.991146, train_metric nan, valid_metric 0.078897
[852895:MainThread](2024-04-06 19:51:38,667) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.981424, valid_loss 0.992063, train_metric nan, valid_metric 0.078563
[852895:MainThread](2024-04-06 19:51:39,039) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.995427, valid_loss 0.992195, train_metric nan, valid_metric 0.076882
[852895:MainThread](2024-04-06 19:51:39,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.982456, valid_loss 0.991472, train_metric nan, valid_metric 0.077410
[852895:MainThread](2024-04-06 19:51:39,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.977159, valid_loss 0.992503, train_metric nan, valid_metric 0.071982
[852895:MainThread](2024-04-06 19:51:40,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.982159, valid_loss 0.992323, train_metric nan, valid_metric 0.074834
[852895:MainThread](2024-04-06 19:51:40,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.979528, valid_loss 0.993446, train_metric nan, valid_metric 0.068648
[852895:MainThread](2024-04-06 19:51:41,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.977199, valid_loss 0.993165, train_metric nan, valid_metric 0.070153
[852895:MainThread](2024-04-06 19:51:41,756) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.989526, valid_loss 0.992727, train_metric nan, valid_metric 0.072098
[852895:MainThread](2024-04-06 19:51:42,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.988410, valid_loss 0.993343, train_metric nan, valid_metric 0.068151
[852895:MainThread](2024-04-06 19:51:42,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.978646, valid_loss 0.991996, train_metric nan, valid_metric 0.076463
[852895:MainThread](2024-04-06 19:51:43,149) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.984863, valid_loss 0.991109, train_metric nan, valid_metric 0.080211
[852895:MainThread](2024-04-06 19:51:43,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.985319, valid_loss 0.991913, train_metric nan, valid_metric 0.077125
[852895:MainThread](2024-04-06 19:51:43,880) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.978893, valid_loss 0.992192, train_metric nan, valid_metric 0.076041
[852895:MainThread](2024-04-06 19:51:44,164) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.990890, valid_loss 0.993205, train_metric nan, valid_metric 0.069839
[852895:MainThread](2024-04-06 19:51:44,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.984774, valid_loss 0.993331, train_metric nan, valid_metric 0.068707
[852895:MainThread](2024-04-06 19:51:44,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.980880, valid_loss 0.992173, train_metric nan, valid_metric 0.072451
[852895:MainThread](2024-04-06 19:51:45,366) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.983379, valid_loss 0.992177, train_metric nan, valid_metric 0.075257
[852895:MainThread](2024-04-06 19:51:45,771) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 0.983332, valid_loss 0.991517, train_metric nan, valid_metric 0.078496
[852895:MainThread](2024-04-06 19:51:46,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.984013, valid_loss 0.991010, train_metric nan, valid_metric 0.080040
[852895:MainThread](2024-04-06 19:51:46,295) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 0.990906, valid_loss 0.991034, train_metric nan, valid_metric 0.078298
[852895:MainThread](2024-04-06 19:51:47,091) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 0.972958, valid_loss 0.991870, train_metric nan, valid_metric 0.074913
[852895:MainThread](2024-04-06 19:51:47,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 0.975733, valid_loss 0.992370, train_metric nan, valid_metric 0.073662
[852895:MainThread](2024-04-06 19:51:47,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 19:51:51,138) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 19:51:52,846) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  20%|██        | 5/25 [04:51<19:06, 57.30s/it][852895:MainThread](2024-04-06 19:51:52,894) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 19:51:52,961) INFO - qlib.workflow - [recorder.py:341] - Recorder 557c959fe34d4f289097fa94f41c67fc starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 19:51:54,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 19:51:54,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 19:51:54,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 19:51:54,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 19:52:02,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 19:52:04,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.193615, valid_loss 1.027662, train_metric nan, valid_metric 0.048005
[852895:MainThread](2024-04-06 19:52:04,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.027662, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 19:52:04,417) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.066922, valid_loss 1.029781, train_metric nan, valid_metric 0.060061
[852895:MainThread](2024-04-06 19:52:04,895) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.037842, valid_loss 1.001020, train_metric nan, valid_metric 0.064053
[852895:MainThread](2024-04-06 19:52:04,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.027662 to 1.001020, save checkpoint.
[852895:MainThread](2024-04-06 19:52:05,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.018115, valid_loss 0.992961, train_metric nan, valid_metric 0.078346
[852895:MainThread](2024-04-06 19:52:05,134) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001020 to 0.992961, save checkpoint.
[852895:MainThread](2024-04-06 19:52:05,716) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.015836, valid_loss 1.010392, train_metric nan, valid_metric 0.035680
[852895:MainThread](2024-04-06 19:52:06,598) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.022817, valid_loss 1.018121, train_metric nan, valid_metric 0.009828
[852895:MainThread](2024-04-06 19:52:07,438) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.019146, valid_loss 1.002525, train_metric nan, valid_metric 0.046247
[852895:MainThread](2024-04-06 19:52:08,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.009035, valid_loss 0.994084, train_metric nan, valid_metric 0.069976
[852895:MainThread](2024-04-06 19:52:08,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.000792, valid_loss 0.994779, train_metric nan, valid_metric 0.082294
[852895:MainThread](2024-04-06 19:52:09,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.029998, valid_loss 0.999456, train_metric nan, valid_metric 0.074566
[852895:MainThread](2024-04-06 19:52:09,738) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.012745, valid_loss 1.003396, train_metric nan, valid_metric 0.066692
[852895:MainThread](2024-04-06 19:52:10,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.015841, valid_loss 0.993838, train_metric nan, valid_metric 0.074451
[852895:MainThread](2024-04-06 19:52:10,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.998762, valid_loss 0.995787, train_metric nan, valid_metric 0.060703
[852895:MainThread](2024-04-06 19:52:11,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 0.990135, valid_loss 0.991123, train_metric nan, valid_metric 0.076263
[852895:MainThread](2024-04-06 19:52:11,433) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.992961 to 0.991123, save checkpoint.
[852895:MainThread](2024-04-06 19:52:12,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.982694, valid_loss 0.991194, train_metric nan, valid_metric 0.077039
[852895:MainThread](2024-04-06 19:52:12,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.986452, valid_loss 0.994711, train_metric nan, valid_metric 0.061456
[852895:MainThread](2024-04-06 19:52:13,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.990223, valid_loss 1.000206, train_metric nan, valid_metric 0.024232
[852895:MainThread](2024-04-06 19:52:13,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.998086, valid_loss 0.991393, train_metric nan, valid_metric 0.088173
[852895:MainThread](2024-04-06 19:52:14,310) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.988517, valid_loss 0.989948, train_metric nan, valid_metric 0.081711
[852895:MainThread](2024-04-06 19:52:14,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991123 to 0.989948, save checkpoint.
[852895:MainThread](2024-04-06 19:52:14,707) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.001444, valid_loss 1.000498, train_metric nan, valid_metric 0.099894
[852895:MainThread](2024-04-06 19:52:15,064) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.997790, valid_loss 0.988064, train_metric nan, valid_metric 0.104758
[852895:MainThread](2024-04-06 19:52:15,073) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.989948 to 0.988064, save checkpoint.
[852895:MainThread](2024-04-06 19:52:15,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.992515, valid_loss 0.991276, train_metric nan, valid_metric 0.079241
[852895:MainThread](2024-04-06 19:52:15,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.992220, valid_loss 0.992135, train_metric nan, valid_metric 0.077033
[852895:MainThread](2024-04-06 19:52:16,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.985376, valid_loss 0.991024, train_metric nan, valid_metric 0.074981
[852895:MainThread](2024-04-06 19:52:16,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.991485, valid_loss 0.994139, train_metric nan, valid_metric 0.072725
[852895:MainThread](2024-04-06 19:52:16,985) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.992134, valid_loss 0.990683, train_metric nan, valid_metric 0.090638
[852895:MainThread](2024-04-06 19:52:17,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.003270, valid_loss 0.993286, train_metric nan, valid_metric 0.074589
[852895:MainThread](2024-04-06 19:52:17,602) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.989886, valid_loss 0.994613, train_metric nan, valid_metric 0.070382
[852895:MainThread](2024-04-06 19:52:17,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.983182, valid_loss 0.994840, train_metric nan, valid_metric 0.053572
[852895:MainThread](2024-04-06 19:52:18,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.988087, valid_loss 0.990464, train_metric nan, valid_metric 0.082493
[852895:MainThread](2024-04-06 19:52:18,297) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.990932, valid_loss 0.988855, train_metric nan, valid_metric 0.096731
[852895:MainThread](2024-04-06 19:52:18,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.992804, valid_loss 0.987533, train_metric nan, valid_metric 0.102697
[852895:MainThread](2024-04-06 19:52:18,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.988064 to 0.987533, save checkpoint.
[852895:MainThread](2024-04-06 19:52:18,885) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.981544, valid_loss 0.994247, train_metric nan, valid_metric 0.059078
[852895:MainThread](2024-04-06 19:52:19,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.985973, valid_loss 0.990994, train_metric nan, valid_metric 0.099712
[852895:MainThread](2024-04-06 19:52:19,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.982444, valid_loss 0.990173, train_metric nan, valid_metric 0.082420
[852895:MainThread](2024-04-06 19:52:19,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.988390, valid_loss 0.993107, train_metric nan, valid_metric 0.105446
[852895:MainThread](2024-04-06 19:52:19,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.979351, valid_loss 0.993962, train_metric nan, valid_metric 0.058495
[852895:MainThread](2024-04-06 19:52:20,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.976372, valid_loss 0.999348, train_metric nan, valid_metric 0.032667
[852895:MainThread](2024-04-06 19:52:20,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.993522, valid_loss 0.988569, train_metric nan, valid_metric 0.093148
[852895:MainThread](2024-04-06 19:52:20,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.979667, valid_loss 0.985647, train_metric nan, valid_metric 0.115137
[852895:MainThread](2024-04-06 19:52:20,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.987533 to 0.985647, save checkpoint.
[852895:MainThread](2024-04-06 19:52:21,065) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.988549, valid_loss 0.992857, train_metric nan, valid_metric 0.064782
[852895:MainThread](2024-04-06 19:52:21,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.983318, valid_loss 0.989417, train_metric nan, valid_metric 0.087363
[852895:MainThread](2024-04-06 19:52:21,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.986412, valid_loss 0.988129, train_metric nan, valid_metric 0.097999
[852895:MainThread](2024-04-06 19:52:22,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.986404, valid_loss 0.992749, train_metric nan, valid_metric 0.080196
[852895:MainThread](2024-04-06 19:52:22,438) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.984504, valid_loss 0.988999, train_metric nan, valid_metric 0.091806
[852895:MainThread](2024-04-06 19:52:22,756) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.981379, valid_loss 0.993857, train_metric nan, valid_metric 0.097992
[852895:MainThread](2024-04-06 19:52:23,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.984976, valid_loss 0.990787, train_metric nan, valid_metric 0.086938
[852895:MainThread](2024-04-06 19:52:23,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.979391, valid_loss 0.994886, train_metric nan, valid_metric 0.059614
[852895:MainThread](2024-04-06 19:52:23,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.975965, valid_loss 0.998471, train_metric nan, valid_metric 0.104274
[852895:MainThread](2024-04-06 19:52:24,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.982815, valid_loss 0.987114, train_metric nan, valid_metric 0.098512
[852895:MainThread](2024-04-06 19:52:24,504) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.977276, valid_loss 0.993092, train_metric nan, valid_metric 0.062532
[852895:MainThread](2024-04-06 19:52:24,750) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.982931, valid_loss 0.992747, train_metric nan, valid_metric 0.092958
[852895:MainThread](2024-04-06 19:52:25,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.974783, valid_loss 0.993752, train_metric nan, valid_metric 0.062718
[852895:MainThread](2024-04-06 19:52:25,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.995355, valid_loss 0.993835, train_metric nan, valid_metric 0.062319
[852895:MainThread](2024-04-06 19:52:25,504) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.987909, valid_loss 0.991983, train_metric nan, valid_metric 0.073166
[852895:MainThread](2024-04-06 19:52:25,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.994601, valid_loss 0.989557, train_metric nan, valid_metric 0.092628
[852895:MainThread](2024-04-06 19:52:26,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.993451, valid_loss 0.993199, train_metric nan, valid_metric 0.067215
[852895:MainThread](2024-04-06 19:52:26,765) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.995942, valid_loss 0.991582, train_metric nan, valid_metric 0.073090
[852895:MainThread](2024-04-06 19:52:27,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.979661, valid_loss 0.991981, train_metric nan, valid_metric 0.074267
[852895:MainThread](2024-04-06 19:52:27,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.977901, valid_loss 0.990460, train_metric nan, valid_metric 0.081198
[852895:MainThread](2024-04-06 19:52:28,156) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.977428, valid_loss 0.993788, train_metric nan, valid_metric 0.062475
[852895:MainThread](2024-04-06 19:52:28,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.985557, valid_loss 0.990285, train_metric nan, valid_metric 0.081544
[852895:MainThread](2024-04-06 19:52:28,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.985733, valid_loss 0.991099, train_metric nan, valid_metric 0.080210
[852895:MainThread](2024-04-06 19:52:29,050) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.988833, valid_loss 0.989107, train_metric nan, valid_metric 0.087558
[852895:MainThread](2024-04-06 19:52:29,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.982274, valid_loss 0.991494, train_metric nan, valid_metric 0.077392
[852895:MainThread](2024-04-06 19:52:29,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.987153, valid_loss 0.987579, train_metric nan, valid_metric 0.099341
[852895:MainThread](2024-04-06 19:52:30,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.991825, valid_loss 0.992564, train_metric nan, valid_metric 0.071296
[852895:MainThread](2024-04-06 19:52:30,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.983860, valid_loss 0.989779, train_metric nan, valid_metric 0.083033
[852895:MainThread](2024-04-06 19:52:30,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.984953, valid_loss 0.987124, train_metric nan, valid_metric 0.097195
[852895:MainThread](2024-04-06 19:52:31,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.979352, valid_loss 0.990445, train_metric nan, valid_metric 0.083248
[852895:MainThread](2024-04-06 19:52:31,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.983242, valid_loss 0.988392, train_metric nan, valid_metric 0.093197
[852895:MainThread](2024-04-06 19:52:31,425) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.977537, valid_loss 0.989047, train_metric nan, valid_metric 0.087851
[852895:MainThread](2024-04-06 19:52:31,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.972800, valid_loss 0.988549, train_metric nan, valid_metric 0.093285
[852895:MainThread](2024-04-06 19:52:31,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.985073, valid_loss 0.990180, train_metric nan, valid_metric 0.085291
[852895:MainThread](2024-04-06 19:52:32,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.978773, valid_loss 0.988679, train_metric nan, valid_metric 0.091646
[852895:MainThread](2024-04-06 19:52:32,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.973230, valid_loss 0.989711, train_metric nan, valid_metric 0.090331
[852895:MainThread](2024-04-06 19:52:32,525) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.985996, valid_loss 0.990444, train_metric nan, valid_metric 0.081123
[852895:MainThread](2024-04-06 19:52:32,756) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.987296, valid_loss 0.991464, train_metric nan, valid_metric 0.080425
[852895:MainThread](2024-04-06 19:52:32,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.982346, valid_loss 0.990850, train_metric nan, valid_metric 0.077121
[852895:MainThread](2024-04-06 19:52:33,295) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.987157, valid_loss 0.990891, train_metric nan, valid_metric 0.076151
[852895:MainThread](2024-04-06 19:52:33,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.983847, valid_loss 0.989064, train_metric nan, valid_metric 0.086139
[852895:MainThread](2024-04-06 19:52:33,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.988893, valid_loss 0.989168, train_metric nan, valid_metric 0.093667
[852895:MainThread](2024-04-06 19:52:34,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.973943, valid_loss 0.989785, train_metric nan, valid_metric 0.085897
[852895:MainThread](2024-04-06 19:52:34,326) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.988207, valid_loss 0.991524, train_metric nan, valid_metric 0.078320
[852895:MainThread](2024-04-06 19:52:34,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.981200, valid_loss 0.993193, train_metric nan, valid_metric 0.070212
[852895:MainThread](2024-04-06 19:52:34,765) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.988189, valid_loss 0.990982, train_metric nan, valid_metric 0.076665
[852895:MainThread](2024-04-06 19:52:35,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.974789, valid_loss 0.989648, train_metric nan, valid_metric 0.084979
[852895:MainThread](2024-04-06 19:52:35,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.981315, valid_loss 0.990813, train_metric nan, valid_metric 0.076832
[852895:MainThread](2024-04-06 19:52:35,669) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.986913, valid_loss 0.987882, train_metric nan, valid_metric 0.096582
[852895:MainThread](2024-04-06 19:52:35,898) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.986568, valid_loss 0.990645, train_metric nan, valid_metric 0.084573
[852895:MainThread](2024-04-06 19:52:35,899) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 19:52:37,740) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 19:52:39,963) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  24%|██▍       | 6/25 [05:38<17:02, 53.83s/it][852895:MainThread](2024-04-06 19:52:39,981) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 19:52:40,003) INFO - qlib.workflow - [recorder.py:341] - Recorder c4bc940997ae4f0e8650769505dabdec starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 19:52:40,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 19:52:40,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 19:52:40,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 19:52:40,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 19:52:49,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 19:52:50,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.288996, valid_loss 1.059854, train_metric nan, valid_metric 0.075825
[852895:MainThread](2024-04-06 19:52:50,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.059854, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 19:52:50,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.117031, valid_loss 1.008093, train_metric nan, valid_metric 0.056761
[852895:MainThread](2024-04-06 19:52:50,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.059854 to 1.008093, save checkpoint.
[852895:MainThread](2024-04-06 19:52:51,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.062320, valid_loss 1.032831, train_metric nan, valid_metric 0.013344
[852895:MainThread](2024-04-06 19:52:51,599) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.062307, valid_loss 1.025411, train_metric nan, valid_metric 0.060013
[852895:MainThread](2024-04-06 19:52:52,037) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.046964, valid_loss 1.006443, train_metric nan, valid_metric 0.078076
[852895:MainThread](2024-04-06 19:52:52,047) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.008093 to 1.006443, save checkpoint.
[852895:MainThread](2024-04-06 19:52:52,778) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.028042, valid_loss 1.004510, train_metric nan, valid_metric 0.041250
[852895:MainThread](2024-04-06 19:52:52,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006443 to 1.004510, save checkpoint.
[852895:MainThread](2024-04-06 19:52:53,442) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.030531, valid_loss 1.000684, train_metric nan, valid_metric 0.038338
[852895:MainThread](2024-04-06 19:52:53,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.004510 to 1.000684, save checkpoint.
[852895:MainThread](2024-04-06 19:52:53,894) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.015169, valid_loss 1.014327, train_metric nan, valid_metric 0.058026
[852895:MainThread](2024-04-06 19:52:54,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.018975, valid_loss 1.009799, train_metric nan, valid_metric 0.038417
[852895:MainThread](2024-04-06 19:52:55,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.017943, valid_loss 0.996446, train_metric nan, valid_metric 0.067654
[852895:MainThread](2024-04-06 19:52:55,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000684 to 0.996446, save checkpoint.
[852895:MainThread](2024-04-06 19:52:56,098) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.011912, valid_loss 0.999649, train_metric nan, valid_metric 0.048574
[852895:MainThread](2024-04-06 19:52:56,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.001307, valid_loss 0.991671, train_metric nan, valid_metric 0.078685
[852895:MainThread](2024-04-06 19:52:56,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996446 to 0.991671, save checkpoint.
[852895:MainThread](2024-04-06 19:52:56,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.011943, valid_loss 0.995478, train_metric nan, valid_metric 0.079704
[852895:MainThread](2024-04-06 19:52:57,080) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.001288, valid_loss 0.996584, train_metric nan, valid_metric 0.076260
[852895:MainThread](2024-04-06 19:52:57,335) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.002706, valid_loss 0.994097, train_metric nan, valid_metric 0.074895
[852895:MainThread](2024-04-06 19:52:57,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.999758, valid_loss 0.994161, train_metric nan, valid_metric 0.076175
[852895:MainThread](2024-04-06 19:52:57,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.005486, valid_loss 0.997720, train_metric nan, valid_metric 0.043113
[852895:MainThread](2024-04-06 19:52:58,119) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.014109, valid_loss 1.013965, train_metric nan, valid_metric -0.002765
[852895:MainThread](2024-04-06 19:52:58,341) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.999970, valid_loss 0.997475, train_metric nan, valid_metric 0.075820
[852895:MainThread](2024-04-06 19:52:58,666) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.010010, valid_loss 1.002954, train_metric nan, valid_metric 0.004387
[852895:MainThread](2024-04-06 19:52:59,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.983254, valid_loss 0.996220, train_metric nan, valid_metric 0.060051
[852895:MainThread](2024-04-06 19:52:59,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.002551, valid_loss 0.999591, train_metric nan, valid_metric 0.043245
[852895:MainThread](2024-04-06 19:52:59,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.990934, valid_loss 0.992909, train_metric nan, valid_metric 0.072024
[852895:MainThread](2024-04-06 19:52:59,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.987688, valid_loss 0.995138, train_metric nan, valid_metric 0.057138
[852895:MainThread](2024-04-06 19:53:00,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.995689, valid_loss 0.994576, train_metric nan, valid_metric 0.065975
[852895:MainThread](2024-04-06 19:53:00,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.002611, valid_loss 0.993969, train_metric nan, valid_metric 0.067403
[852895:MainThread](2024-04-06 19:53:00,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.992325, valid_loss 0.995245, train_metric nan, valid_metric 0.056286
[852895:MainThread](2024-04-06 19:53:01,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.998614, valid_loss 0.995653, train_metric nan, valid_metric 0.065384
[852895:MainThread](2024-04-06 19:53:01,354) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.992056, valid_loss 0.994164, train_metric nan, valid_metric 0.072167
[852895:MainThread](2024-04-06 19:53:01,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.978710, valid_loss 0.994532, train_metric nan, valid_metric 0.054287
[852895:MainThread](2024-04-06 19:53:02,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.001403, valid_loss 0.994745, train_metric nan, valid_metric 0.073752
[852895:MainThread](2024-04-06 19:53:02,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.990625, valid_loss 0.998126, train_metric nan, valid_metric 0.070890
[852895:MainThread](2024-04-06 19:53:02,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.989569, valid_loss 0.995086, train_metric nan, valid_metric 0.060920
[852895:MainThread](2024-04-06 19:53:03,342) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.998739, valid_loss 0.994910, train_metric nan, valid_metric 0.054506
[852895:MainThread](2024-04-06 19:53:03,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.989901, valid_loss 0.994794, train_metric nan, valid_metric 0.055034
[852895:MainThread](2024-04-06 19:53:04,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.988008, valid_loss 0.990787, train_metric nan, valid_metric 0.089763
[852895:MainThread](2024-04-06 19:53:04,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991671 to 0.990787, save checkpoint.
[852895:MainThread](2024-04-06 19:53:05,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.990506, valid_loss 0.994431, train_metric nan, valid_metric 0.067602
[852895:MainThread](2024-04-06 19:53:05,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.987612, valid_loss 0.993415, train_metric nan, valid_metric 0.073103
[852895:MainThread](2024-04-06 19:53:06,326) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.002566, valid_loss 0.993664, train_metric nan, valid_metric 0.073199
[852895:MainThread](2024-04-06 19:53:06,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.986322, valid_loss 0.993856, train_metric nan, valid_metric 0.068939
[852895:MainThread](2024-04-06 19:53:07,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.983031, valid_loss 0.993431, train_metric nan, valid_metric 0.065570
[852895:MainThread](2024-04-06 19:53:07,937) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.982494, valid_loss 0.994368, train_metric nan, valid_metric 0.058656
[852895:MainThread](2024-04-06 19:53:08,306) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.988294, valid_loss 0.993655, train_metric nan, valid_metric 0.070701
[852895:MainThread](2024-04-06 19:53:08,731) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.980636, valid_loss 0.996287, train_metric nan, valid_metric 0.049386
[852895:MainThread](2024-04-06 19:53:09,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.989575, valid_loss 0.994539, train_metric nan, valid_metric 0.064735
[852895:MainThread](2024-04-06 19:53:09,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.988941, valid_loss 0.993041, train_metric nan, valid_metric 0.074550
[852895:MainThread](2024-04-06 19:53:10,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.980554, valid_loss 0.993633, train_metric nan, valid_metric 0.062698
[852895:MainThread](2024-04-06 19:53:10,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.983439, valid_loss 0.991723, train_metric nan, valid_metric 0.076224
[852895:MainThread](2024-04-06 19:53:10,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.991120, valid_loss 0.993224, train_metric nan, valid_metric 0.065541
[852895:MainThread](2024-04-06 19:53:11,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.987327, valid_loss 0.993295, train_metric nan, valid_metric 0.069067
[852895:MainThread](2024-04-06 19:53:12,031) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.999960, valid_loss 0.994404, train_metric nan, valid_metric 0.062660
[852895:MainThread](2024-04-06 19:53:12,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.986356, valid_loss 0.994635, train_metric nan, valid_metric 0.064206
[852895:MainThread](2024-04-06 19:53:12,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.989528, valid_loss 0.994012, train_metric nan, valid_metric 0.063752
[852895:MainThread](2024-04-06 19:53:13,599) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.986523, valid_loss 0.991586, train_metric nan, valid_metric 0.073563
[852895:MainThread](2024-04-06 19:53:14,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.989617, valid_loss 0.992717, train_metric nan, valid_metric 0.072246
[852895:MainThread](2024-04-06 19:53:14,651) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.984183, valid_loss 0.994116, train_metric nan, valid_metric 0.063433
[852895:MainThread](2024-04-06 19:53:15,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.983928, valid_loss 0.994119, train_metric nan, valid_metric 0.068144
[852895:MainThread](2024-04-06 19:53:15,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.987675, valid_loss 0.995296, train_metric nan, valid_metric 0.056010
[852895:MainThread](2024-04-06 19:53:15,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.986982, valid_loss 0.994227, train_metric nan, valid_metric 0.062409
[852895:MainThread](2024-04-06 19:53:16,292) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.002359, valid_loss 0.993999, train_metric nan, valid_metric 0.065381
[852895:MainThread](2024-04-06 19:53:16,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.992163, valid_loss 0.994384, train_metric nan, valid_metric 0.063571
[852895:MainThread](2024-04-06 19:53:16,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.992258, valid_loss 0.994612, train_metric nan, valid_metric 0.059675
[852895:MainThread](2024-04-06 19:53:17,172) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.979443, valid_loss 0.994023, train_metric nan, valid_metric 0.064170
[852895:MainThread](2024-04-06 19:53:17,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.990397, valid_loss 0.995534, train_metric nan, valid_metric 0.057212
[852895:MainThread](2024-04-06 19:53:17,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.984774, valid_loss 0.993626, train_metric nan, valid_metric 0.069576
[852895:MainThread](2024-04-06 19:53:18,073) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.986373, valid_loss 0.992694, train_metric nan, valid_metric 0.071545
[852895:MainThread](2024-04-06 19:53:18,413) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.986991, valid_loss 0.992372, train_metric nan, valid_metric 0.073910
[852895:MainThread](2024-04-06 19:53:18,953) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.986268, valid_loss 0.992536, train_metric nan, valid_metric 0.073467
[852895:MainThread](2024-04-06 19:53:19,237) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.981947, valid_loss 0.993121, train_metric nan, valid_metric 0.068321
[852895:MainThread](2024-04-06 19:53:19,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.994948, valid_loss 0.993466, train_metric nan, valid_metric 0.065466
[852895:MainThread](2024-04-06 19:53:19,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.986017, valid_loss 0.994002, train_metric nan, valid_metric 0.062105
[852895:MainThread](2024-04-06 19:53:20,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.977063, valid_loss 0.992370, train_metric nan, valid_metric 0.072052
[852895:MainThread](2024-04-06 19:53:20,486) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.988454, valid_loss 0.992828, train_metric nan, valid_metric 0.070812
[852895:MainThread](2024-04-06 19:53:20,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.990328, valid_loss 0.993166, train_metric nan, valid_metric 0.069702
[852895:MainThread](2024-04-06 19:53:21,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.980110, valid_loss 0.993010, train_metric nan, valid_metric 0.070981
[852895:MainThread](2024-04-06 19:53:21,342) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.991704, valid_loss 0.991669, train_metric nan, valid_metric 0.077730
[852895:MainThread](2024-04-06 19:53:21,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.980507, valid_loss 0.993169, train_metric nan, valid_metric 0.068115
[852895:MainThread](2024-04-06 19:53:22,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.987787, valid_loss 0.994053, train_metric nan, valid_metric 0.064323
[852895:MainThread](2024-04-06 19:53:22,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.985524, valid_loss 0.993058, train_metric nan, valid_metric 0.069533
[852895:MainThread](2024-04-06 19:53:23,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.987916, valid_loss 0.993678, train_metric nan, valid_metric 0.065137
[852895:MainThread](2024-04-06 19:53:23,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.989336, valid_loss 0.994404, train_metric nan, valid_metric 0.061560
[852895:MainThread](2024-04-06 19:53:23,750) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.985595, valid_loss 0.994560, train_metric nan, valid_metric 0.061313
[852895:MainThread](2024-04-06 19:53:24,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.985148, valid_loss 0.994454, train_metric nan, valid_metric 0.061178
[852895:MainThread](2024-04-06 19:53:24,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.985698, valid_loss 0.993418, train_metric nan, valid_metric 0.066616
[852895:MainThread](2024-04-06 19:53:24,565) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.982441, valid_loss 0.993403, train_metric nan, valid_metric 0.065882
[852895:MainThread](2024-04-06 19:53:24,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.992449, valid_loss 0.991727, train_metric nan, valid_metric 0.088342
[852895:MainThread](2024-04-06 19:53:24,812) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 19:53:25,948) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 19:53:27,195) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  28%|██▊       | 7/25 [06:25<15:30, 51.68s/it][852895:MainThread](2024-04-06 19:53:27,210) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 19:53:27,227) INFO - qlib.workflow - [recorder.py:341] - Recorder 6f275149f4ef4e0d8d5265ad73ceeaad starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 19:53:28,233) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 19:53:28,237) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 19:53:28,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 19:53:28,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 19:53:36,203) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 19:53:37,203) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.299674, valid_loss 1.149632, train_metric nan, valid_metric 0.013235
[852895:MainThread](2024-04-06 19:53:37,205) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.149632, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 19:53:37,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.142628, valid_loss 1.137906, train_metric nan, valid_metric 0.032269
[852895:MainThread](2024-04-06 19:53:37,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.149632 to 1.137906, save checkpoint.
[852895:MainThread](2024-04-06 19:53:38,183) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.089166, valid_loss 1.007048, train_metric nan, valid_metric 0.053359
[852895:MainThread](2024-04-06 19:53:38,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.137906 to 1.007048, save checkpoint.
[852895:MainThread](2024-04-06 19:53:38,760) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.063557, valid_loss 1.003676, train_metric nan, valid_metric 0.053012
[852895:MainThread](2024-04-06 19:53:38,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.007048 to 1.003676, save checkpoint.
[852895:MainThread](2024-04-06 19:53:39,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.052778, valid_loss 1.000344, train_metric nan, valid_metric 0.060562
[852895:MainThread](2024-04-06 19:53:39,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003676 to 1.000344, save checkpoint.
[852895:MainThread](2024-04-06 19:53:39,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.100578, valid_loss 1.047273, train_metric nan, valid_metric 0.037319
[852895:MainThread](2024-04-06 19:53:39,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.130676, valid_loss 1.075809, train_metric nan, valid_metric 0.063498
[852895:MainThread](2024-04-06 19:53:40,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.030982, valid_loss 1.003716, train_metric nan, valid_metric 0.048256
[852895:MainThread](2024-04-06 19:53:40,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.034912, valid_loss 0.998437, train_metric nan, valid_metric 0.047641
[852895:MainThread](2024-04-06 19:53:40,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000344 to 0.998437, save checkpoint.
[852895:MainThread](2024-04-06 19:53:41,175) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.024562, valid_loss 1.000821, train_metric nan, valid_metric 0.049090
[852895:MainThread](2024-04-06 19:53:41,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.039403, valid_loss 0.993088, train_metric nan, valid_metric 0.065992
[852895:MainThread](2024-04-06 19:53:41,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998437 to 0.993088, save checkpoint.
[852895:MainThread](2024-04-06 19:53:41,691) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.020065, valid_loss 0.997487, train_metric nan, valid_metric 0.061229
[852895:MainThread](2024-04-06 19:53:41,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.011758, valid_loss 1.007473, train_metric nan, valid_metric 0.078603
[852895:MainThread](2024-04-06 19:53:42,120) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.016931, valid_loss 0.999325, train_metric nan, valid_metric 0.036991
[852895:MainThread](2024-04-06 19:53:42,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.015801, valid_loss 0.994764, train_metric nan, valid_metric 0.069312
[852895:MainThread](2024-04-06 19:53:42,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.997513, valid_loss 1.009735, train_metric nan, valid_metric 0.068187
[852895:MainThread](2024-04-06 19:53:43,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.999012, valid_loss 1.002078, train_metric nan, valid_metric 0.068170
[852895:MainThread](2024-04-06 19:53:43,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.996610, valid_loss 0.992426, train_metric nan, valid_metric 0.084856
[852895:MainThread](2024-04-06 19:53:43,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993088 to 0.992426, save checkpoint.
[852895:MainThread](2024-04-06 19:53:43,528) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.000283, valid_loss 0.994880, train_metric nan, valid_metric 0.072096
[852895:MainThread](2024-04-06 19:53:43,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.998409, valid_loss 1.015749, train_metric nan, valid_metric 0.048982
[852895:MainThread](2024-04-06 19:53:44,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.998949, valid_loss 0.995131, train_metric nan, valid_metric 0.056841
[852895:MainThread](2024-04-06 19:53:44,643) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.007955, valid_loss 0.996817, train_metric nan, valid_metric 0.065118
[852895:MainThread](2024-04-06 19:53:44,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.008607, valid_loss 0.996974, train_metric nan, valid_metric 0.064835
[852895:MainThread](2024-04-06 19:53:45,172) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.006674, valid_loss 1.003815, train_metric nan, valid_metric 0.078960
[852895:MainThread](2024-04-06 19:53:45,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.998894, valid_loss 0.997949, train_metric nan, valid_metric 0.043956
[852895:MainThread](2024-04-06 19:53:45,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.020844, valid_loss 1.003569, train_metric nan, valid_metric 0.048998
[852895:MainThread](2024-04-06 19:53:46,082) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.992027, valid_loss 0.988065, train_metric nan, valid_metric 0.101274
[852895:MainThread](2024-04-06 19:53:46,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.992426 to 0.988065, save checkpoint.
[852895:MainThread](2024-04-06 19:53:46,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.991742, valid_loss 0.993521, train_metric nan, valid_metric 0.098564
[852895:MainThread](2024-04-06 19:53:47,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.985901, valid_loss 0.991732, train_metric nan, valid_metric 0.075146
[852895:MainThread](2024-04-06 19:53:47,757) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.000463, valid_loss 0.992973, train_metric nan, valid_metric 0.071764
[852895:MainThread](2024-04-06 19:53:48,310) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.994534, valid_loss 0.992571, train_metric nan, valid_metric 0.079348
[852895:MainThread](2024-04-06 19:53:48,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.006165, valid_loss 0.996313, train_metric nan, valid_metric 0.047359
[852895:MainThread](2024-04-06 19:53:49,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.995642, valid_loss 0.997129, train_metric nan, valid_metric 0.088948
[852895:MainThread](2024-04-06 19:53:49,300) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.998599, valid_loss 0.993830, train_metric nan, valid_metric 0.075323
[852895:MainThread](2024-04-06 19:53:49,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.996440, valid_loss 0.992100, train_metric nan, valid_metric 0.074022
[852895:MainThread](2024-04-06 19:53:49,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.990918, valid_loss 0.996117, train_metric nan, valid_metric 0.059776
[852895:MainThread](2024-04-06 19:53:50,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.996637, valid_loss 0.995895, train_metric nan, valid_metric 0.071199
[852895:MainThread](2024-04-06 19:53:51,277) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.003311, valid_loss 0.993831, train_metric nan, valid_metric 0.076881
[852895:MainThread](2024-04-06 19:53:51,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.992219, valid_loss 0.991503, train_metric nan, valid_metric 0.077118
[852895:MainThread](2024-04-06 19:53:52,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.996235, valid_loss 0.993820, train_metric nan, valid_metric 0.071042
[852895:MainThread](2024-04-06 19:53:52,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.996723, valid_loss 0.994246, train_metric nan, valid_metric 0.058580
[852895:MainThread](2024-04-06 19:53:52,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.983242, valid_loss 0.996170, train_metric nan, valid_metric 0.063533
[852895:MainThread](2024-04-06 19:53:53,356) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.991891, valid_loss 0.993593, train_metric nan, valid_metric 0.069081
[852895:MainThread](2024-04-06 19:53:53,760) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.993783, valid_loss 0.994339, train_metric nan, valid_metric 0.065367
[852895:MainThread](2024-04-06 19:53:54,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.981934, valid_loss 0.995371, train_metric nan, valid_metric 0.059665
[852895:MainThread](2024-04-06 19:53:54,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.992457, valid_loss 0.998181, train_metric nan, valid_metric 0.074137
[852895:MainThread](2024-04-06 19:53:55,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.980351, valid_loss 0.998725, train_metric nan, valid_metric 0.068720
[852895:MainThread](2024-04-06 19:53:55,839) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.982384, valid_loss 0.994415, train_metric nan, valid_metric 0.070501
[852895:MainThread](2024-04-06 19:53:56,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.998357, valid_loss 0.996818, train_metric nan, valid_metric 0.073071
[852895:MainThread](2024-04-06 19:53:56,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.993911, valid_loss 0.993975, train_metric nan, valid_metric 0.069482
[852895:MainThread](2024-04-06 19:53:56,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.995963, valid_loss 0.994164, train_metric nan, valid_metric 0.058909
[852895:MainThread](2024-04-06 19:53:57,417) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.981208, valid_loss 0.993575, train_metric nan, valid_metric 0.070213
[852895:MainThread](2024-04-06 19:53:57,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.993281, valid_loss 0.995079, train_metric nan, valid_metric 0.062147
[852895:MainThread](2024-04-06 19:53:57,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.994872, valid_loss 0.995495, train_metric nan, valid_metric 0.071753
[852895:MainThread](2024-04-06 19:53:58,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.993338, valid_loss 0.992084, train_metric nan, valid_metric 0.073496
[852895:MainThread](2024-04-06 19:53:58,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.994052, valid_loss 0.992385, train_metric nan, valid_metric 0.072812
[852895:MainThread](2024-04-06 19:53:58,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.989867, valid_loss 0.994203, train_metric nan, valid_metric 0.062283
[852895:MainThread](2024-04-06 19:53:59,169) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.986872, valid_loss 0.994522, train_metric nan, valid_metric 0.063706
[852895:MainThread](2024-04-06 19:53:59,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.990261, valid_loss 0.995523, train_metric nan, valid_metric 0.059269
[852895:MainThread](2024-04-06 19:53:59,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.992430, valid_loss 0.992641, train_metric nan, valid_metric 0.071531
[852895:MainThread](2024-04-06 19:53:59,960) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.992186, valid_loss 0.994039, train_metric nan, valid_metric 0.069324
[852895:MainThread](2024-04-06 19:54:00,167) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.985382, valid_loss 0.992663, train_metric nan, valid_metric 0.074161
[852895:MainThread](2024-04-06 19:54:00,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.985048, valid_loss 0.992961, train_metric nan, valid_metric 0.068892
[852895:MainThread](2024-04-06 19:54:00,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.983457, valid_loss 0.993353, train_metric nan, valid_metric 0.071520
[852895:MainThread](2024-04-06 19:54:00,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.990714, valid_loss 0.993235, train_metric nan, valid_metric 0.068891
[852895:MainThread](2024-04-06 19:54:01,233) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.991159, valid_loss 0.994326, train_metric nan, valid_metric 0.063384
[852895:MainThread](2024-04-06 19:54:01,510) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 1.004274, valid_loss 0.993634, train_metric nan, valid_metric 0.070755
[852895:MainThread](2024-04-06 19:54:01,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.991160, valid_loss 0.992653, train_metric nan, valid_metric 0.075149
[852895:MainThread](2024-04-06 19:54:02,298) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.979453, valid_loss 0.993910, train_metric nan, valid_metric 0.062156
[852895:MainThread](2024-04-06 19:54:02,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.985403, valid_loss 0.993895, train_metric nan, valid_metric 0.076236
[852895:MainThread](2024-04-06 19:54:03,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.989171, valid_loss 0.992886, train_metric nan, valid_metric 0.074991
[852895:MainThread](2024-04-06 19:54:03,453) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.991970, valid_loss 0.993406, train_metric nan, valid_metric 0.071573
[852895:MainThread](2024-04-06 19:54:04,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.984429, valid_loss 0.992572, train_metric nan, valid_metric 0.072770
[852895:MainThread](2024-04-06 19:54:04,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.987410, valid_loss 0.992167, train_metric nan, valid_metric 0.072777
[852895:MainThread](2024-04-06 19:54:04,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.989607, valid_loss 0.992552, train_metric nan, valid_metric 0.072718
[852895:MainThread](2024-04-06 19:54:04,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.989041, valid_loss 0.992935, train_metric nan, valid_metric 0.072040
[852895:MainThread](2024-04-06 19:54:05,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.987152, valid_loss 0.993571, train_metric nan, valid_metric 0.066195
[852895:MainThread](2024-04-06 19:54:05,306) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 19:54:06,549) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 19:54:07,862) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  32%|███▏      | 8/25 [07:06<13:38, 48.17s/it][852895:MainThread](2024-04-06 19:54:07,884) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 19:54:07,909) INFO - qlib.workflow - [recorder.py:341] - Recorder f5237be4d2bf49a89999b4b4fac7e6b0 starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 19:54:08,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 19:54:08,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 19:54:08,897) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 19:54:08,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 19:54:18,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 19:54:19,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.248920, valid_loss 1.008003, train_metric nan, valid_metric 0.055444
[852895:MainThread](2024-04-06 19:54:19,580) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.008003, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 19:54:20,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.100232, valid_loss 1.041626, train_metric nan, valid_metric 0.026946
[852895:MainThread](2024-04-06 19:54:20,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.060659, valid_loss 1.011348, train_metric nan, valid_metric 0.049130
[852895:MainThread](2024-04-06 19:54:21,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.043982, valid_loss 1.011121, train_metric nan, valid_metric 0.052377
[852895:MainThread](2024-04-06 19:54:21,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.033982, valid_loss 1.013402, train_metric nan, valid_metric 0.068546
[852895:MainThread](2024-04-06 19:54:21,813) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.034352, valid_loss 1.005222, train_metric nan, valid_metric 0.029972
[852895:MainThread](2024-04-06 19:54:21,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.008003 to 1.005222, save checkpoint.
[852895:MainThread](2024-04-06 19:54:22,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.031426, valid_loss 1.013087, train_metric nan, valid_metric 0.065396
[852895:MainThread](2024-04-06 19:54:23,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.021098, valid_loss 1.006224, train_metric nan, valid_metric 0.070135
[852895:MainThread](2024-04-06 19:54:23,774) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.012540, valid_loss 1.017465, train_metric nan, valid_metric 0.053451
[852895:MainThread](2024-04-06 19:54:23,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.008119, valid_loss 0.996569, train_metric nan, valid_metric 0.060178
[852895:MainThread](2024-04-06 19:54:23,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.005222 to 0.996569, save checkpoint.
[852895:MainThread](2024-04-06 19:54:24,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.004763, valid_loss 1.007519, train_metric nan, valid_metric 0.041797
[852895:MainThread](2024-04-06 19:54:24,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.019135, valid_loss 1.033113, train_metric nan, valid_metric 0.050479
[852895:MainThread](2024-04-06 19:54:24,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.074357, valid_loss 1.041014, train_metric nan, valid_metric 0.003937
[852895:MainThread](2024-04-06 19:54:25,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.024811, valid_loss 0.995115, train_metric nan, valid_metric 0.053585
[852895:MainThread](2024-04-06 19:54:25,494) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996569 to 0.995115, save checkpoint.
[852895:MainThread](2024-04-06 19:54:25,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.012413, valid_loss 0.998413, train_metric nan, valid_metric 0.050671
[852895:MainThread](2024-04-06 19:54:26,167) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.004377, valid_loss 1.004982, train_metric nan, valid_metric 0.035441
[852895:MainThread](2024-04-06 19:54:26,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.999818, valid_loss 0.995222, train_metric nan, valid_metric 0.086580
[852895:MainThread](2024-04-06 19:54:26,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.000386, valid_loss 0.995044, train_metric nan, valid_metric 0.085187
[852895:MainThread](2024-04-06 19:54:26,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995115 to 0.995044, save checkpoint.
[852895:MainThread](2024-04-06 19:54:27,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.991505, valid_loss 0.997262, train_metric nan, valid_metric 0.042038
[852895:MainThread](2024-04-06 19:54:27,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.993173, valid_loss 1.003854, train_metric nan, valid_metric 0.082314
[852895:MainThread](2024-04-06 19:54:27,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.993384, valid_loss 0.993484, train_metric nan, valid_metric 0.065914
[852895:MainThread](2024-04-06 19:54:27,765) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995044 to 0.993484, save checkpoint.
[852895:MainThread](2024-04-06 19:54:28,064) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.999129, valid_loss 0.995312, train_metric nan, valid_metric 0.053800
[852895:MainThread](2024-04-06 19:54:28,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.986588, valid_loss 0.996997, train_metric nan, valid_metric 0.074648
[852895:MainThread](2024-04-06 19:54:28,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.993680, valid_loss 0.999762, train_metric nan, valid_metric 0.050615
[852895:MainThread](2024-04-06 19:54:29,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.982885, valid_loss 0.996708, train_metric nan, valid_metric 0.054023
[852895:MainThread](2024-04-06 19:54:29,427) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.991977, valid_loss 1.001888, train_metric nan, valid_metric 0.072011
[852895:MainThread](2024-04-06 19:54:29,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.988482, valid_loss 0.995608, train_metric nan, valid_metric 0.062342
[852895:MainThread](2024-04-06 19:54:29,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.998934, valid_loss 1.003597, train_metric nan, valid_metric 0.062762
[852895:MainThread](2024-04-06 19:54:30,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.993280, valid_loss 1.003819, train_metric nan, valid_metric 0.043761
[852895:MainThread](2024-04-06 19:54:30,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.987683, valid_loss 0.996037, train_metric nan, valid_metric 0.056583
[852895:MainThread](2024-04-06 19:54:31,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.984522, valid_loss 0.999009, train_metric nan, valid_metric 0.040798
[852895:MainThread](2024-04-06 19:54:31,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.984911, valid_loss 0.995579, train_metric nan, valid_metric 0.056953
[852895:MainThread](2024-04-06 19:54:32,310) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.991102, valid_loss 0.994732, train_metric nan, valid_metric 0.056102
[852895:MainThread](2024-04-06 19:54:32,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.982704, valid_loss 0.997062, train_metric nan, valid_metric 0.058518
[852895:MainThread](2024-04-06 19:54:33,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.987762, valid_loss 0.993415, train_metric nan, valid_metric 0.067184
[852895:MainThread](2024-04-06 19:54:33,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993484 to 0.993415, save checkpoint.
[852895:MainThread](2024-04-06 19:54:33,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.992689, valid_loss 0.998026, train_metric nan, valid_metric 0.070292
[852895:MainThread](2024-04-06 19:54:34,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.984765, valid_loss 0.996829, train_metric nan, valid_metric 0.068721
[852895:MainThread](2024-04-06 19:54:35,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.988452, valid_loss 0.993997, train_metric nan, valid_metric 0.062082
[852895:MainThread](2024-04-06 19:54:36,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.995969, valid_loss 0.991516, train_metric nan, valid_metric 0.078849
[852895:MainThread](2024-04-06 19:54:36,141) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993415 to 0.991516, save checkpoint.
[852895:MainThread](2024-04-06 19:54:36,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.985155, valid_loss 0.994570, train_metric nan, valid_metric 0.059981
[852895:MainThread](2024-04-06 19:54:37,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.981377, valid_loss 0.992783, train_metric nan, valid_metric 0.069101
[852895:MainThread](2024-04-06 19:54:38,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.987036, valid_loss 0.995382, train_metric nan, valid_metric 0.065471
[852895:MainThread](2024-04-06 19:54:38,976) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.987903, valid_loss 0.993413, train_metric nan, valid_metric 0.070341
[852895:MainThread](2024-04-06 19:54:39,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.991222, valid_loss 0.994984, train_metric nan, valid_metric 0.060437
[852895:MainThread](2024-04-06 19:54:39,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.976712, valid_loss 0.994271, train_metric nan, valid_metric 0.061701
[852895:MainThread](2024-04-06 19:54:40,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.978543, valid_loss 0.996024, train_metric nan, valid_metric 0.057736
[852895:MainThread](2024-04-06 19:54:40,344) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.982640, valid_loss 0.994515, train_metric nan, valid_metric 0.059612
[852895:MainThread](2024-04-06 19:54:40,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.994016, valid_loss 0.997071, train_metric nan, valid_metric 0.065721
[852895:MainThread](2024-04-06 19:54:41,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.990896, valid_loss 0.996525, train_metric nan, valid_metric 0.060583
[852895:MainThread](2024-04-06 19:54:41,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.982011, valid_loss 0.994215, train_metric nan, valid_metric 0.060311
[852895:MainThread](2024-04-06 19:54:42,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.988312, valid_loss 0.994901, train_metric nan, valid_metric 0.058880
[852895:MainThread](2024-04-06 19:54:42,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.982059, valid_loss 0.995229, train_metric nan, valid_metric 0.065292
[852895:MainThread](2024-04-06 19:54:42,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.981908, valid_loss 0.994919, train_metric nan, valid_metric 0.065645
[852895:MainThread](2024-04-06 19:54:42,832) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.986143, valid_loss 0.994926, train_metric nan, valid_metric 0.059922
[852895:MainThread](2024-04-06 19:54:43,089) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.991941, valid_loss 0.994381, train_metric nan, valid_metric 0.074928
[852895:MainThread](2024-04-06 19:54:43,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.988914, valid_loss 0.994040, train_metric nan, valid_metric 0.061704
[852895:MainThread](2024-04-06 19:54:43,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.986609, valid_loss 0.994695, train_metric nan, valid_metric 0.061565
[852895:MainThread](2024-04-06 19:54:43,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.980759, valid_loss 0.994252, train_metric nan, valid_metric 0.063489
[852895:MainThread](2024-04-06 19:54:44,179) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.987150, valid_loss 0.994904, train_metric nan, valid_metric 0.056935
[852895:MainThread](2024-04-06 19:54:44,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.983049, valid_loss 0.994597, train_metric nan, valid_metric 0.065588
[852895:MainThread](2024-04-06 19:54:44,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.979337, valid_loss 0.993861, train_metric nan, valid_metric 0.067330
[852895:MainThread](2024-04-06 19:54:45,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.986409, valid_loss 0.993585, train_metric nan, valid_metric 0.068354
[852895:MainThread](2024-04-06 19:54:45,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.980721, valid_loss 0.994855, train_metric nan, valid_metric 0.056612
[852895:MainThread](2024-04-06 19:54:45,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.982112, valid_loss 0.994151, train_metric nan, valid_metric 0.060431
[852895:MainThread](2024-04-06 19:54:45,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.986248, valid_loss 0.993522, train_metric nan, valid_metric 0.070286
[852895:MainThread](2024-04-06 19:54:46,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.985239, valid_loss 0.993876, train_metric nan, valid_metric 0.063746
[852895:MainThread](2024-04-06 19:54:46,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.981624, valid_loss 0.993718, train_metric nan, valid_metric 0.071186
[852895:MainThread](2024-04-06 19:54:46,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.982422, valid_loss 0.993211, train_metric nan, valid_metric 0.069568
[852895:MainThread](2024-04-06 19:54:46,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.988608, valid_loss 0.995710, train_metric nan, valid_metric 0.048992
[852895:MainThread](2024-04-06 19:54:47,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.979565, valid_loss 0.996966, train_metric nan, valid_metric 0.048479
[852895:MainThread](2024-04-06 19:54:47,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.989012, valid_loss 0.995551, train_metric nan, valid_metric 0.059197
[852895:MainThread](2024-04-06 19:54:47,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.995196, valid_loss 0.993605, train_metric nan, valid_metric 0.071018
[852895:MainThread](2024-04-06 19:54:48,028) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.984000, valid_loss 0.995275, train_metric nan, valid_metric 0.060245
[852895:MainThread](2024-04-06 19:54:48,353) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.987730, valid_loss 0.994910, train_metric nan, valid_metric 0.061152
[852895:MainThread](2024-04-06 19:54:48,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.986805, valid_loss 0.993910, train_metric nan, valid_metric 0.061500
[852895:MainThread](2024-04-06 19:54:48,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.970542, valid_loss 0.992747, train_metric nan, valid_metric 0.069638
[852895:MainThread](2024-04-06 19:54:49,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.972074, valid_loss 0.993494, train_metric nan, valid_metric 0.064441
[852895:MainThread](2024-04-06 19:54:49,316) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.981796, valid_loss 0.994783, train_metric nan, valid_metric 0.056271
[852895:MainThread](2024-04-06 19:54:49,571) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.980671, valid_loss 0.994026, train_metric nan, valid_metric 0.066988
[852895:MainThread](2024-04-06 19:54:49,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.983959, valid_loss 0.994388, train_metric nan, valid_metric 0.065872
[852895:MainThread](2024-04-06 19:54:50,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.982018, valid_loss 0.993726, train_metric nan, valid_metric 0.072634
[852895:MainThread](2024-04-06 19:54:50,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.988210, valid_loss 0.994716, train_metric nan, valid_metric 0.061918
[852895:MainThread](2024-04-06 19:54:50,440) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.973521, valid_loss 0.993967, train_metric nan, valid_metric 0.061617
[852895:MainThread](2024-04-06 19:54:50,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.984296, valid_loss 0.992851, train_metric nan, valid_metric 0.068401
[852895:MainThread](2024-04-06 19:54:51,108) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.986708, valid_loss 0.993326, train_metric nan, valid_metric 0.067908
[852895:MainThread](2024-04-06 19:54:51,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.979523, valid_loss 0.994749, train_metric nan, valid_metric 0.057533
[852895:MainThread](2024-04-06 19:54:51,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.988048, valid_loss 0.993918, train_metric nan, valid_metric 0.064081
[852895:MainThread](2024-04-06 19:54:51,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.984489, valid_loss 0.994066, train_metric nan, valid_metric 0.063027
[852895:MainThread](2024-04-06 19:54:52,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.986186, valid_loss 0.994294, train_metric nan, valid_metric 0.062958
[852895:MainThread](2024-04-06 19:54:52,047) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 19:54:53,579) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 19:54:54,805) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  36%|███▌      | 9/25 [07:53<12:44, 47.79s/it][852895:MainThread](2024-04-06 19:54:54,829) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 19:54:54,865) INFO - qlib.workflow - [recorder.py:341] - Recorder e49bf0c2c4bf4ab39e7c048152c34846 starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 19:54:57,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 19:54:57,794) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 19:54:57,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 19:54:57,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 19:55:07,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 19:55:08,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.363302, valid_loss 1.030718, train_metric nan, valid_metric 0.015645
[852895:MainThread](2024-04-06 19:55:08,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.030718, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 19:55:09,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.168142, valid_loss 1.123488, train_metric nan, valid_metric -0.001075
[852895:MainThread](2024-04-06 19:55:10,170) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.166070, valid_loss 1.023612, train_metric nan, valid_metric 0.056151
[852895:MainThread](2024-04-06 19:55:10,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.030718 to 1.023612, save checkpoint.
[852895:MainThread](2024-04-06 19:55:10,691) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.084580, valid_loss 1.005413, train_metric nan, valid_metric 0.061627
[852895:MainThread](2024-04-06 19:55:10,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.023612 to 1.005413, save checkpoint.
[852895:MainThread](2024-04-06 19:55:10,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.070177, valid_loss 1.013695, train_metric nan, valid_metric 0.053185
[852895:MainThread](2024-04-06 19:55:11,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.044151, valid_loss 1.010782, train_metric nan, valid_metric 0.070284
[852895:MainThread](2024-04-06 19:55:11,550) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.048020, valid_loss 0.997741, train_metric nan, valid_metric 0.074531
[852895:MainThread](2024-04-06 19:55:11,552) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.005413 to 0.997741, save checkpoint.
[852895:MainThread](2024-04-06 19:55:11,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.061802, valid_loss 0.995170, train_metric nan, valid_metric 0.070434
[852895:MainThread](2024-04-06 19:55:11,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997741 to 0.995170, save checkpoint.
[852895:MainThread](2024-04-06 19:55:12,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.081208, valid_loss 1.024482, train_metric nan, valid_metric 0.061725
[852895:MainThread](2024-04-06 19:55:12,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.059332, valid_loss 0.994331, train_metric nan, valid_metric 0.065735
[852895:MainThread](2024-04-06 19:55:12,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995170 to 0.994331, save checkpoint.
[852895:MainThread](2024-04-06 19:55:12,709) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.028767, valid_loss 1.020350, train_metric nan, valid_metric 0.093414
[852895:MainThread](2024-04-06 19:55:13,080) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.025758, valid_loss 0.995634, train_metric nan, valid_metric 0.084795
[852895:MainThread](2024-04-06 19:55:13,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.030275, valid_loss 1.015339, train_metric nan, valid_metric 0.080642
[852895:MainThread](2024-04-06 19:55:13,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.023191, valid_loss 0.988854, train_metric nan, valid_metric 0.091447
[852895:MainThread](2024-04-06 19:55:13,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994331 to 0.988854, save checkpoint.
[852895:MainThread](2024-04-06 19:55:13,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.032835, valid_loss 0.993858, train_metric nan, valid_metric 0.073477
[852895:MainThread](2024-04-06 19:55:14,251) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.018711, valid_loss 1.000503, train_metric nan, valid_metric 0.077861
[852895:MainThread](2024-04-06 19:55:14,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.010669, valid_loss 0.991954, train_metric nan, valid_metric 0.080505
[852895:MainThread](2024-04-06 19:55:14,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.007064, valid_loss 0.989947, train_metric nan, valid_metric 0.086782
[852895:MainThread](2024-04-06 19:55:15,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.012662, valid_loss 0.999958, train_metric nan, valid_metric 0.063787
[852895:MainThread](2024-04-06 19:55:16,914) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.995615, valid_loss 0.999496, train_metric nan, valid_metric 0.078760
[852895:MainThread](2024-04-06 19:55:17,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.011070, valid_loss 1.004516, train_metric nan, valid_metric 0.066414
[852895:MainThread](2024-04-06 19:55:18,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.006015, valid_loss 0.992579, train_metric nan, valid_metric 0.102799
[852895:MainThread](2024-04-06 19:55:18,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.015240, valid_loss 0.992741, train_metric nan, valid_metric 0.098153
[852895:MainThread](2024-04-06 19:55:19,385) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.011274, valid_loss 0.990863, train_metric nan, valid_metric 0.084482
[852895:MainThread](2024-04-06 19:55:20,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.999472, valid_loss 0.989222, train_metric nan, valid_metric 0.092460
[852895:MainThread](2024-04-06 19:55:21,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.001559, valid_loss 0.993232, train_metric nan, valid_metric 0.107177
[852895:MainThread](2024-04-06 19:55:21,868) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.000009, valid_loss 0.992125, train_metric nan, valid_metric 0.085074
[852895:MainThread](2024-04-06 19:55:22,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.000995, valid_loss 0.993133, train_metric nan, valid_metric 0.079707
[852895:MainThread](2024-04-06 19:55:23,511) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.994243, valid_loss 0.989830, train_metric nan, valid_metric 0.085725
[852895:MainThread](2024-04-06 19:55:24,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.996226, valid_loss 0.993785, train_metric nan, valid_metric 0.085924
[852895:MainThread](2024-04-06 19:55:25,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.000669, valid_loss 0.993225, train_metric nan, valid_metric 0.078600
[852895:MainThread](2024-04-06 19:55:25,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.992869, valid_loss 0.989147, train_metric nan, valid_metric 0.090682
[852895:MainThread](2024-04-06 19:55:26,030) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.003389, valid_loss 0.990528, train_metric nan, valid_metric 0.086759
[852895:MainThread](2024-04-06 19:55:26,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.987985, valid_loss 0.992285, train_metric nan, valid_metric 0.073822
[852895:MainThread](2024-04-06 19:55:26,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.991167, valid_loss 0.992696, train_metric nan, valid_metric 0.069004
[852895:MainThread](2024-04-06 19:55:27,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.995746, valid_loss 0.991195, train_metric nan, valid_metric 0.089071
[852895:MainThread](2024-04-06 19:55:27,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.993948, valid_loss 0.991631, train_metric nan, valid_metric 0.082303
[852895:MainThread](2024-04-06 19:55:28,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.988783, valid_loss 0.990233, train_metric nan, valid_metric 0.092151
[852895:MainThread](2024-04-06 19:55:28,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.998813, valid_loss 0.991437, train_metric nan, valid_metric 0.093211
[852895:MainThread](2024-04-06 19:55:28,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.999916, valid_loss 0.991080, train_metric nan, valid_metric 0.091518
[852895:MainThread](2024-04-06 19:55:29,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.000837, valid_loss 0.992596, train_metric nan, valid_metric 0.082589
[852895:MainThread](2024-04-06 19:55:29,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.992377, valid_loss 0.992362, train_metric nan, valid_metric 0.086681
[852895:MainThread](2024-04-06 19:55:29,794) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.997648, valid_loss 0.991220, train_metric nan, valid_metric 0.078743
[852895:MainThread](2024-04-06 19:55:30,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.999691, valid_loss 0.990294, train_metric nan, valid_metric 0.088541
[852895:MainThread](2024-04-06 19:55:30,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.003779, valid_loss 0.994864, train_metric nan, valid_metric 0.087489
[852895:MainThread](2024-04-06 19:55:30,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.991451, valid_loss 0.990366, train_metric nan, valid_metric 0.099614
[852895:MainThread](2024-04-06 19:55:30,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.990981, valid_loss 0.988535, train_metric nan, valid_metric 0.095728
[852895:MainThread](2024-04-06 19:55:30,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.988854 to 0.988535, save checkpoint.
[852895:MainThread](2024-04-06 19:55:31,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.988273, valid_loss 0.989617, train_metric nan, valid_metric 0.088804
[852895:MainThread](2024-04-06 19:55:31,437) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.991216, valid_loss 0.990024, train_metric nan, valid_metric 0.093593
[852895:MainThread](2024-04-06 19:55:31,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.993446, valid_loss 0.992451, train_metric nan, valid_metric 0.094333
[852895:MainThread](2024-04-06 19:55:32,188) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.992816, valid_loss 0.991418, train_metric nan, valid_metric 0.078538
[852895:MainThread](2024-04-06 19:55:32,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.992878, valid_loss 0.991127, train_metric nan, valid_metric 0.082561
[852895:MainThread](2024-04-06 19:55:32,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.991927, valid_loss 0.990320, train_metric nan, valid_metric 0.092687
[852895:MainThread](2024-04-06 19:55:32,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.978434, valid_loss 0.993555, train_metric nan, valid_metric 0.092836
[852895:MainThread](2024-04-06 19:55:33,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.999036, valid_loss 0.992720, train_metric nan, valid_metric 0.083256
[852895:MainThread](2024-04-06 19:55:33,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.997197, valid_loss 0.994190, train_metric nan, valid_metric 0.093197
[852895:MainThread](2024-04-06 19:55:33,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.992606, valid_loss 0.992249, train_metric nan, valid_metric 0.073006
[852895:MainThread](2024-04-06 19:55:34,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.989932, valid_loss 0.989340, train_metric nan, valid_metric 0.091122
[852895:MainThread](2024-04-06 19:55:34,364) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.986353, valid_loss 0.989691, train_metric nan, valid_metric 0.098272
[852895:MainThread](2024-04-06 19:55:34,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.986451, valid_loss 0.990798, train_metric nan, valid_metric 0.085523
[852895:MainThread](2024-04-06 19:55:35,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.985843, valid_loss 0.991190, train_metric nan, valid_metric 0.083188
[852895:MainThread](2024-04-06 19:55:35,500) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.984173, valid_loss 0.989809, train_metric nan, valid_metric 0.086100
[852895:MainThread](2024-04-06 19:55:35,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.996321, valid_loss 0.988838, train_metric nan, valid_metric 0.093799
[852895:MainThread](2024-04-06 19:55:36,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.991544, valid_loss 0.991952, train_metric nan, valid_metric 0.086606
[852895:MainThread](2024-04-06 19:55:36,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.986381, valid_loss 0.990553, train_metric nan, valid_metric 0.086403
[852895:MainThread](2024-04-06 19:55:36,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.988838, valid_loss 0.988751, train_metric nan, valid_metric 0.105910
[852895:MainThread](2024-04-06 19:55:36,813) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.992824, valid_loss 0.990410, train_metric nan, valid_metric 0.087434
[852895:MainThread](2024-04-06 19:55:37,064) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.988086, valid_loss 0.989811, train_metric nan, valid_metric 0.095731
[852895:MainThread](2024-04-06 19:55:37,237) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 1.000626, valid_loss 0.991031, train_metric nan, valid_metric 0.094096
[852895:MainThread](2024-04-06 19:55:37,474) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.999395, valid_loss 0.991543, train_metric nan, valid_metric 0.089716
[852895:MainThread](2024-04-06 19:55:37,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.984709, valid_loss 0.991597, train_metric nan, valid_metric 0.088965
[852895:MainThread](2024-04-06 19:55:38,014) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.992905, valid_loss 0.989669, train_metric nan, valid_metric 0.090324
[852895:MainThread](2024-04-06 19:55:38,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.994693, valid_loss 0.991299, train_metric nan, valid_metric 0.081303
[852895:MainThread](2024-04-06 19:55:38,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.991234, valid_loss 0.991617, train_metric nan, valid_metric 0.088696
[852895:MainThread](2024-04-06 19:55:39,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.988092, valid_loss 0.989694, train_metric nan, valid_metric 0.089178
[852895:MainThread](2024-04-06 19:55:39,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.998387, valid_loss 0.991378, train_metric nan, valid_metric 0.086522
[852895:MainThread](2024-04-06 19:55:40,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.993920, valid_loss 0.991622, train_metric nan, valid_metric 0.083138
[852895:MainThread](2024-04-06 19:55:40,487) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.982318, valid_loss 0.991045, train_metric nan, valid_metric 0.083939
[852895:MainThread](2024-04-06 19:55:41,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.980560, valid_loss 0.991422, train_metric nan, valid_metric 0.084362
[852895:MainThread](2024-04-06 19:55:41,335) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.987915, valid_loss 0.991534, train_metric nan, valid_metric 0.083718
[852895:MainThread](2024-04-06 19:55:42,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.980943, valid_loss 0.990401, train_metric nan, valid_metric 0.089086
[852895:MainThread](2024-04-06 19:55:42,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.995381, valid_loss 0.990660, train_metric nan, valid_metric 0.085599
[852895:MainThread](2024-04-06 19:55:43,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.985062, valid_loss 0.990949, train_metric nan, valid_metric 0.088284
[852895:MainThread](2024-04-06 19:55:43,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.992945, valid_loss 0.990907, train_metric nan, valid_metric 0.092835
[852895:MainThread](2024-04-06 19:55:43,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.995827, valid_loss 0.992537, train_metric nan, valid_metric 0.070062
[852895:MainThread](2024-04-06 19:55:44,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.994656, valid_loss 0.990795, train_metric nan, valid_metric 0.084687
[852895:MainThread](2024-04-06 19:55:44,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.990597, valid_loss 0.991545, train_metric nan, valid_metric 0.087503
[852895:MainThread](2024-04-06 19:55:45,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.988327, valid_loss 0.990827, train_metric nan, valid_metric 0.086850
[852895:MainThread](2024-04-06 19:55:45,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.982017, valid_loss 0.989971, train_metric nan, valid_metric 0.092214
[852895:MainThread](2024-04-06 19:55:46,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.987845, valid_loss 0.990713, train_metric nan, valid_metric 0.085007
[852895:MainThread](2024-04-06 19:55:47,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.983020, valid_loss 0.990789, train_metric nan, valid_metric 0.084061
[852895:MainThread](2024-04-06 19:55:47,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.983180, valid_loss 0.989970, train_metric nan, valid_metric 0.093201
[852895:MainThread](2024-04-06 19:55:48,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.989111, valid_loss 0.991334, train_metric nan, valid_metric 0.088857
[852895:MainThread](2024-04-06 19:55:49,342) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.979951, valid_loss 0.989359, train_metric nan, valid_metric 0.098553
[852895:MainThread](2024-04-06 19:55:49,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.986138, valid_loss 0.990115, train_metric nan, valid_metric 0.092308
[852895:MainThread](2024-04-06 19:55:50,277) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.994520, valid_loss 0.990060, train_metric nan, valid_metric 0.094853
[852895:MainThread](2024-04-06 19:55:50,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.985395, valid_loss 0.990594, train_metric nan, valid_metric 0.085674
[852895:MainThread](2024-04-06 19:55:50,741) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 19:55:52,427) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 19:55:53,580) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  40%|████      | 10/25 [08:52<12:47, 51.18s/it][852895:MainThread](2024-04-06 19:55:53,595) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 19:55:53,613) INFO - qlib.workflow - [recorder.py:341] - Recorder 23c9679ca929492cbd5fc0c536e9adf3 starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 19:55:55,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 19:55:55,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 19:55:55,322) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 19:55:55,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 19:56:00,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 19:56:01,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.219605, valid_loss 1.024713, train_metric nan, valid_metric 0.071771
[852895:MainThread](2024-04-06 19:56:01,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.024713, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 19:56:01,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.075860, valid_loss 1.012409, train_metric nan, valid_metric 0.040914
[852895:MainThread](2024-04-06 19:56:01,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.024713 to 1.012409, save checkpoint.
[852895:MainThread](2024-04-06 19:56:02,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.041665, valid_loss 1.000459, train_metric nan, valid_metric 0.058003
[852895:MainThread](2024-04-06 19:56:02,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.012409 to 1.000459, save checkpoint.
[852895:MainThread](2024-04-06 19:56:02,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.025627, valid_loss 1.014950, train_metric nan, valid_metric 0.073706
[852895:MainThread](2024-04-06 19:56:03,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.068124, valid_loss 1.038265, train_metric nan, valid_metric 0.019897
[852895:MainThread](2024-04-06 19:56:04,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.037223, valid_loss 0.996222, train_metric nan, valid_metric 0.077295
[852895:MainThread](2024-04-06 19:56:04,089) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000459 to 0.996222, save checkpoint.
[852895:MainThread](2024-04-06 19:56:04,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.017304, valid_loss 0.995622, train_metric nan, valid_metric 0.087982
[852895:MainThread](2024-04-06 19:56:04,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996222 to 0.995622, save checkpoint.
[852895:MainThread](2024-04-06 19:56:05,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.013320, valid_loss 0.991722, train_metric nan, valid_metric 0.081895
[852895:MainThread](2024-04-06 19:56:05,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995622 to 0.991722, save checkpoint.
[852895:MainThread](2024-04-06 19:56:06,416) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.007761, valid_loss 0.987109, train_metric nan, valid_metric 0.107890
[852895:MainThread](2024-04-06 19:56:06,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991722 to 0.987109, save checkpoint.
[852895:MainThread](2024-04-06 19:56:07,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.010495, valid_loss 0.999297, train_metric nan, valid_metric 0.088362
[852895:MainThread](2024-04-06 19:56:07,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 0.991316, valid_loss 1.004198, train_metric nan, valid_metric 0.036313
[852895:MainThread](2024-04-06 19:56:08,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 0.998891, valid_loss 0.988882, train_metric nan, valid_metric 0.092727
[852895:MainThread](2024-04-06 19:56:08,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.002613, valid_loss 0.989593, train_metric nan, valid_metric 0.092861
[852895:MainThread](2024-04-06 19:56:08,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.028128, valid_loss 1.002163, train_metric nan, valid_metric 0.088674
[852895:MainThread](2024-04-06 19:56:09,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.993862, valid_loss 1.001029, train_metric nan, valid_metric 0.067121
[852895:MainThread](2024-04-06 19:56:09,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.996768, valid_loss 0.990767, train_metric nan, valid_metric 0.088239
[852895:MainThread](2024-04-06 19:56:10,565) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.988662, valid_loss 0.993753, train_metric nan, valid_metric 0.107199
[852895:MainThread](2024-04-06 19:56:10,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.992160, valid_loss 0.988193, train_metric nan, valid_metric 0.094891
[852895:MainThread](2024-04-06 19:56:11,590) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.997693, valid_loss 0.990936, train_metric nan, valid_metric 0.081164
[852895:MainThread](2024-04-06 19:56:12,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.992938, valid_loss 0.994169, train_metric nan, valid_metric 0.111630
[852895:MainThread](2024-04-06 19:56:12,396) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.997077, valid_loss 0.987819, train_metric nan, valid_metric 0.099965
[852895:MainThread](2024-04-06 19:56:13,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.993311, valid_loss 0.989909, train_metric nan, valid_metric 0.090973
[852895:MainThread](2024-04-06 19:56:13,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.994468, valid_loss 0.993285, train_metric nan, valid_metric 0.110235
[852895:MainThread](2024-04-06 19:56:14,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.986604, valid_loss 0.990633, train_metric nan, valid_metric 0.101764
[852895:MainThread](2024-04-06 19:56:14,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.993487, valid_loss 0.989774, train_metric nan, valid_metric 0.096091
[852895:MainThread](2024-04-06 19:56:14,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.995753, valid_loss 0.986727, train_metric nan, valid_metric 0.104048
[852895:MainThread](2024-04-06 19:56:14,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.987109 to 0.986727, save checkpoint.
[852895:MainThread](2024-04-06 19:56:14,920) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.983126, valid_loss 0.988691, train_metric nan, valid_metric 0.107840
[852895:MainThread](2024-04-06 19:56:15,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.992219, valid_loss 0.989083, train_metric nan, valid_metric 0.091761
[852895:MainThread](2024-04-06 19:56:15,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.004762, valid_loss 0.993131, train_metric nan, valid_metric 0.100547
[852895:MainThread](2024-04-06 19:56:15,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.988696, valid_loss 0.989198, train_metric nan, valid_metric 0.094485
[852895:MainThread](2024-04-06 19:56:16,017) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.992714, valid_loss 0.987156, train_metric nan, valid_metric 0.104188
[852895:MainThread](2024-04-06 19:56:16,400) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.982685, valid_loss 0.988842, train_metric nan, valid_metric 0.094973
[852895:MainThread](2024-04-06 19:56:16,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.986335, valid_loss 0.987837, train_metric nan, valid_metric 0.103691
[852895:MainThread](2024-04-06 19:56:17,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.990682, valid_loss 0.991398, train_metric nan, valid_metric 0.104250
[852895:MainThread](2024-04-06 19:56:17,434) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.984847, valid_loss 0.989902, train_metric nan, valid_metric 0.087189
[852895:MainThread](2024-04-06 19:56:17,737) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.990785, valid_loss 0.993606, train_metric nan, valid_metric 0.101836
[852895:MainThread](2024-04-06 19:56:18,035) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.976467, valid_loss 0.989613, train_metric nan, valid_metric 0.090187
[852895:MainThread](2024-04-06 19:56:18,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.994108, valid_loss 0.991028, train_metric nan, valid_metric 0.080085
[852895:MainThread](2024-04-06 19:56:18,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.981275, valid_loss 0.990396, train_metric nan, valid_metric 0.091645
[852895:MainThread](2024-04-06 19:56:19,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.982940, valid_loss 0.987983, train_metric nan, valid_metric 0.099329
[852895:MainThread](2024-04-06 19:56:19,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.992151, valid_loss 0.989470, train_metric nan, valid_metric 0.091311
[852895:MainThread](2024-04-06 19:56:19,812) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.988035, valid_loss 0.988895, train_metric nan, valid_metric 0.100472
[852895:MainThread](2024-04-06 19:56:20,050) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.989424, valid_loss 0.991065, train_metric nan, valid_metric 0.084559
[852895:MainThread](2024-04-06 19:56:20,321) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.992560, valid_loss 0.988009, train_metric nan, valid_metric 0.101337
[852895:MainThread](2024-04-06 19:56:20,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.981121, valid_loss 0.988600, train_metric nan, valid_metric 0.104620
[852895:MainThread](2024-04-06 19:56:21,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.982899, valid_loss 0.991234, train_metric nan, valid_metric 0.100890
[852895:MainThread](2024-04-06 19:56:21,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.986479, valid_loss 0.990287, train_metric nan, valid_metric 0.088002
[852895:MainThread](2024-04-06 19:56:21,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.979587, valid_loss 0.989355, train_metric nan, valid_metric 0.098066
[852895:MainThread](2024-04-06 19:56:22,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.987536, valid_loss 0.989296, train_metric nan, valid_metric 0.097821
[852895:MainThread](2024-04-06 19:56:22,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.991191, valid_loss 0.989512, train_metric nan, valid_metric 0.096316
[852895:MainThread](2024-04-06 19:56:22,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.995885, valid_loss 0.988504, train_metric nan, valid_metric 0.102097
[852895:MainThread](2024-04-06 19:56:23,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.985592, valid_loss 0.987747, train_metric nan, valid_metric 0.100223
[852895:MainThread](2024-04-06 19:56:23,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.985552, valid_loss 0.988020, train_metric nan, valid_metric 0.099968
[852895:MainThread](2024-04-06 19:56:23,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.995937, valid_loss 0.989983, train_metric nan, valid_metric 0.089880
[852895:MainThread](2024-04-06 19:56:24,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.986856, valid_loss 0.987589, train_metric nan, valid_metric 0.101564
[852895:MainThread](2024-04-06 19:56:25,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.991669, valid_loss 0.988190, train_metric nan, valid_metric 0.100608
[852895:MainThread](2024-04-06 19:56:25,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.994703, valid_loss 0.988020, train_metric nan, valid_metric 0.113596
[852895:MainThread](2024-04-06 19:56:26,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.979665, valid_loss 0.987821, train_metric nan, valid_metric 0.102387
[852895:MainThread](2024-04-06 19:56:26,707) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.992531, valid_loss 0.988744, train_metric nan, valid_metric 0.101125
[852895:MainThread](2024-04-06 19:56:26,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.987637, valid_loss 0.988494, train_metric nan, valid_metric 0.102398
[852895:MainThread](2024-04-06 19:56:27,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.972526, valid_loss 0.988387, train_metric nan, valid_metric 0.102339
[852895:MainThread](2024-04-06 19:56:27,912) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.979765, valid_loss 0.989378, train_metric nan, valid_metric 0.097722
[852895:MainThread](2024-04-06 19:56:28,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.980566, valid_loss 0.988542, train_metric nan, valid_metric 0.099097
[852895:MainThread](2024-04-06 19:56:28,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.977071, valid_loss 0.988710, train_metric nan, valid_metric 0.102360
[852895:MainThread](2024-04-06 19:56:28,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.989192, valid_loss 0.988506, train_metric nan, valid_metric 0.098968
[852895:MainThread](2024-04-06 19:56:29,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.983468, valid_loss 0.988898, train_metric nan, valid_metric 0.098355
[852895:MainThread](2024-04-06 19:56:29,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.986615, valid_loss 0.988194, train_metric nan, valid_metric 0.106188
[852895:MainThread](2024-04-06 19:56:29,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.988145, valid_loss 0.988558, train_metric nan, valid_metric 0.098026
[852895:MainThread](2024-04-06 19:56:30,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.981378, valid_loss 0.988212, train_metric nan, valid_metric 0.102982
[852895:MainThread](2024-04-06 19:56:30,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.989218, valid_loss 0.988332, train_metric nan, valid_metric 0.100405
[852895:MainThread](2024-04-06 19:56:30,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.987909, valid_loss 0.987512, train_metric nan, valid_metric 0.106986
[852895:MainThread](2024-04-06 19:56:31,175) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.990342, valid_loss 0.988026, train_metric nan, valid_metric 0.102372
[852895:MainThread](2024-04-06 19:56:31,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.984884, valid_loss 0.988498, train_metric nan, valid_metric 0.098584
[852895:MainThread](2024-04-06 19:56:31,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.986151, valid_loss 0.988272, train_metric nan, valid_metric 0.101270
[852895:MainThread](2024-04-06 19:56:32,172) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.985798, valid_loss 0.987842, train_metric nan, valid_metric 0.103699
[852895:MainThread](2024-04-06 19:56:32,471) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.981017, valid_loss 0.987703, train_metric nan, valid_metric 0.105406
[852895:MainThread](2024-04-06 19:56:32,477) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 19:56:33,961) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 19:56:35,931) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  44%|████▍     | 11/25 [09:34<11:18, 48.48s/it][852895:MainThread](2024-04-06 19:56:35,953) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 19:56:35,975) INFO - qlib.workflow - [recorder.py:341] - Recorder a687caed1b4c4299897d9fb84009db7e starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 19:56:37,346) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 19:56:37,349) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 19:56:37,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 19:56:37,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 19:56:42,364) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 19:56:43,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.234216, valid_loss 1.053525, train_metric nan, valid_metric 0.027949
[852895:MainThread](2024-04-06 19:56:43,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.053525, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 19:56:43,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.121164, valid_loss 1.017961, train_metric nan, valid_metric 0.037157
[852895:MainThread](2024-04-06 19:56:43,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.053525 to 1.017961, save checkpoint.
[852895:MainThread](2024-04-06 19:56:44,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.067387, valid_loss 1.047940, train_metric nan, valid_metric 0.053681
[852895:MainThread](2024-04-06 19:56:44,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.049099, valid_loss 1.009758, train_metric nan, valid_metric 0.062716
[852895:MainThread](2024-04-06 19:56:44,550) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.017961 to 1.009758, save checkpoint.
[852895:MainThread](2024-04-06 19:56:44,953) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.039584, valid_loss 0.997423, train_metric nan, valid_metric 0.080215
[852895:MainThread](2024-04-06 19:56:44,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.009758 to 0.997423, save checkpoint.
[852895:MainThread](2024-04-06 19:56:45,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.031666, valid_loss 1.001451, train_metric nan, valid_metric 0.056762
[852895:MainThread](2024-04-06 19:56:45,565) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.031399, valid_loss 0.998115, train_metric nan, valid_metric 0.090392
[852895:MainThread](2024-04-06 19:56:45,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.021961, valid_loss 1.011346, train_metric nan, valid_metric 0.008722
[852895:MainThread](2024-04-06 19:56:46,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.040453, valid_loss 0.995619, train_metric nan, valid_metric 0.076391
[852895:MainThread](2024-04-06 19:56:46,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997423 to 0.995619, save checkpoint.
[852895:MainThread](2024-04-06 19:56:46,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.032830, valid_loss 0.992823, train_metric nan, valid_metric 0.101355
[852895:MainThread](2024-04-06 19:56:46,260) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995619 to 0.992823, save checkpoint.
[852895:MainThread](2024-04-06 19:56:46,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.022433, valid_loss 0.997485, train_metric nan, valid_metric 0.081773
[852895:MainThread](2024-04-06 19:56:46,747) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.010558, valid_loss 1.008873, train_metric nan, valid_metric 0.065120
[852895:MainThread](2024-04-06 19:56:47,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.005355, valid_loss 0.991288, train_metric nan, valid_metric 0.084345
[852895:MainThread](2024-04-06 19:56:47,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.992823 to 0.991288, save checkpoint.
[852895:MainThread](2024-04-06 19:56:47,234) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.004706, valid_loss 1.002279, train_metric nan, valid_metric 0.036794
[852895:MainThread](2024-04-06 19:56:47,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.024258, valid_loss 1.033201, train_metric nan, valid_metric 0.073580
[852895:MainThread](2024-04-06 19:56:47,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.013056, valid_loss 0.995160, train_metric nan, valid_metric 0.086677
[852895:MainThread](2024-04-06 19:56:48,515) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.006711, valid_loss 0.990224, train_metric nan, valid_metric 0.108174
[852895:MainThread](2024-04-06 19:56:48,516) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991288 to 0.990224, save checkpoint.
[852895:MainThread](2024-04-06 19:56:48,876) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.998397, valid_loss 0.993438, train_metric nan, valid_metric 0.071127
[852895:MainThread](2024-04-06 19:56:49,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.009371, valid_loss 1.010766, train_metric nan, valid_metric 0.061802
[852895:MainThread](2024-04-06 19:56:49,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.003023, valid_loss 0.993274, train_metric nan, valid_metric 0.076353
[852895:MainThread](2024-04-06 19:56:50,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.982823, valid_loss 0.988754, train_metric nan, valid_metric 0.096143
[852895:MainThread](2024-04-06 19:56:50,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990224 to 0.988754, save checkpoint.
[852895:MainThread](2024-04-06 19:56:50,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.992264, valid_loss 0.995585, train_metric nan, valid_metric 0.070000
[852895:MainThread](2024-04-06 19:56:51,028) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.992312, valid_loss 0.987806, train_metric nan, valid_metric 0.101856
[852895:MainThread](2024-04-06 19:56:51,034) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.988754 to 0.987806, save checkpoint.
[852895:MainThread](2024-04-06 19:56:51,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.985715, valid_loss 0.991174, train_metric nan, valid_metric 0.083726
[852895:MainThread](2024-04-06 19:56:51,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.988462, valid_loss 0.993226, train_metric nan, valid_metric 0.091836
[852895:MainThread](2024-04-06 19:56:52,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.002357, valid_loss 0.992101, train_metric nan, valid_metric 0.084664
[852895:MainThread](2024-04-06 19:56:52,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.996553, valid_loss 0.985790, train_metric nan, valid_metric 0.110394
[852895:MainThread](2024-04-06 19:56:52,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.987806 to 0.985790, save checkpoint.
[852895:MainThread](2024-04-06 19:56:53,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.001975, valid_loss 0.996632, train_metric nan, valid_metric 0.089653
[852895:MainThread](2024-04-06 19:56:53,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.995306, valid_loss 0.986832, train_metric nan, valid_metric 0.108302
[852895:MainThread](2024-04-06 19:56:54,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.994901, valid_loss 0.987048, train_metric nan, valid_metric 0.104118
[852895:MainThread](2024-04-06 19:56:54,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.984046, valid_loss 0.991725, train_metric nan, valid_metric 0.081033
[852895:MainThread](2024-04-06 19:56:54,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.987459, valid_loss 1.000593, train_metric nan, valid_metric 0.066999
[852895:MainThread](2024-04-06 19:56:55,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.990371, valid_loss 0.991191, train_metric nan, valid_metric 0.085701
[852895:MainThread](2024-04-06 19:56:55,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.986039, valid_loss 0.994886, train_metric nan, valid_metric 0.070510
[852895:MainThread](2024-04-06 19:56:55,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.989264, valid_loss 0.988746, train_metric nan, valid_metric 0.093874
[852895:MainThread](2024-04-06 19:56:56,067) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.982854, valid_loss 0.989150, train_metric nan, valid_metric 0.094079
[852895:MainThread](2024-04-06 19:56:56,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.985453, valid_loss 0.996184, train_metric nan, valid_metric 0.086091
[852895:MainThread](2024-04-06 19:56:56,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.988473, valid_loss 0.991883, train_metric nan, valid_metric 0.076619
[852895:MainThread](2024-04-06 19:56:56,877) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.991549, valid_loss 0.989119, train_metric nan, valid_metric 0.095183
[852895:MainThread](2024-04-06 19:56:57,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.989825, valid_loss 0.989975, train_metric nan, valid_metric 0.089595
[852895:MainThread](2024-04-06 19:56:57,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.988922, valid_loss 0.988708, train_metric nan, valid_metric 0.099967
[852895:MainThread](2024-04-06 19:56:57,839) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.978206, valid_loss 0.996575, train_metric nan, valid_metric 0.066934
[852895:MainThread](2024-04-06 19:56:58,204) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.995186, valid_loss 0.992482, train_metric nan, valid_metric 0.073640
[852895:MainThread](2024-04-06 19:56:58,492) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.984603, valid_loss 0.989087, train_metric nan, valid_metric 0.090401
[852895:MainThread](2024-04-06 19:56:58,937) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.990839, valid_loss 0.993868, train_metric nan, valid_metric 0.061402
[852895:MainThread](2024-04-06 19:56:59,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.987841, valid_loss 0.992086, train_metric nan, valid_metric 0.077603
[852895:MainThread](2024-04-06 19:56:59,646) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.981114, valid_loss 0.991057, train_metric nan, valid_metric 0.079679
[852895:MainThread](2024-04-06 19:57:00,352) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.990054, valid_loss 0.996253, train_metric nan, valid_metric 0.066557
[852895:MainThread](2024-04-06 19:57:00,710) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.996543, valid_loss 0.990640, train_metric nan, valid_metric 0.081564
[852895:MainThread](2024-04-06 19:57:00,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.972199, valid_loss 0.992708, train_metric nan, valid_metric 0.082146
[852895:MainThread](2024-04-06 19:57:01,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.992457, valid_loss 0.991361, train_metric nan, valid_metric 0.082259
[852895:MainThread](2024-04-06 19:57:01,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.978957, valid_loss 0.991086, train_metric nan, valid_metric 0.083325
[852895:MainThread](2024-04-06 19:57:01,929) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.993722, valid_loss 0.991800, train_metric nan, valid_metric 0.081028
[852895:MainThread](2024-04-06 19:57:02,213) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.971349, valid_loss 0.993182, train_metric nan, valid_metric 0.076337
[852895:MainThread](2024-04-06 19:57:02,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.980436, valid_loss 0.991089, train_metric nan, valid_metric 0.078034
[852895:MainThread](2024-04-06 19:57:02,756) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.983851, valid_loss 0.992263, train_metric nan, valid_metric 0.073315
[852895:MainThread](2024-04-06 19:57:03,120) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.988250, valid_loss 0.990216, train_metric nan, valid_metric 0.085647
[852895:MainThread](2024-04-06 19:57:03,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.001500, valid_loss 0.989970, train_metric nan, valid_metric 0.089243
[852895:MainThread](2024-04-06 19:57:03,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.982644, valid_loss 0.989973, train_metric nan, valid_metric 0.089318
[852895:MainThread](2024-04-06 19:57:03,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.991428, valid_loss 0.993231, train_metric nan, valid_metric 0.075725
[852895:MainThread](2024-04-06 19:57:04,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.985556, valid_loss 0.991916, train_metric nan, valid_metric 0.081351
[852895:MainThread](2024-04-06 19:57:04,510) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.988584, valid_loss 0.991683, train_metric nan, valid_metric 0.079637
[852895:MainThread](2024-04-06 19:57:04,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.987103, valid_loss 0.989955, train_metric nan, valid_metric 0.092492
[852895:MainThread](2024-04-06 19:57:05,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.992204, valid_loss 0.989494, train_metric nan, valid_metric 0.091122
[852895:MainThread](2024-04-06 19:57:05,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.990209, valid_loss 0.990827, train_metric nan, valid_metric 0.087248
[852895:MainThread](2024-04-06 19:57:05,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.981160, valid_loss 0.992454, train_metric nan, valid_metric 0.081710
[852895:MainThread](2024-04-06 19:57:06,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.987448, valid_loss 0.990563, train_metric nan, valid_metric 0.085739
[852895:MainThread](2024-04-06 19:57:07,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.988925, valid_loss 0.991379, train_metric nan, valid_metric 0.082665
[852895:MainThread](2024-04-06 19:57:07,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.979697, valid_loss 0.992074, train_metric nan, valid_metric 0.078986
[852895:MainThread](2024-04-06 19:57:08,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.993810, valid_loss 0.990048, train_metric nan, valid_metric 0.087709
[852895:MainThread](2024-04-06 19:57:08,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.984891, valid_loss 0.990227, train_metric nan, valid_metric 0.086288
[852895:MainThread](2024-04-06 19:57:08,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.997040, valid_loss 0.992530, train_metric nan, valid_metric 0.071826
[852895:MainThread](2024-04-06 19:57:09,307) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.992445, valid_loss 0.990670, train_metric nan, valid_metric 0.083021
[852895:MainThread](2024-04-06 19:57:09,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.978609, valid_loss 0.991659, train_metric nan, valid_metric 0.080298
[852895:MainThread](2024-04-06 19:57:10,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.983233, valid_loss 0.990495, train_metric nan, valid_metric 0.087878
[852895:MainThread](2024-04-06 19:57:10,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.997689, valid_loss 0.991259, train_metric nan, valid_metric 0.080178
[852895:MainThread](2024-04-06 19:57:11,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.990233, valid_loss 0.990887, train_metric nan, valid_metric 0.082357
[852895:MainThread](2024-04-06 19:57:11,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 19:57:14,567) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 19:57:17,197) INFO - qlib.timer - [log.py:127] - Time cost: 0.006s | waiting `async_log` Done
train tasks:  48%|████▊     | 12/25 [10:15<10:01, 46.29s/it][852895:MainThread](2024-04-06 19:57:17,245) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 19:57:17,318) INFO - qlib.workflow - [recorder.py:341] - Recorder 2e2e445cd5794f33abfe17444342f254 starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 19:57:19,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 19:57:19,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 19:57:19,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 19:57:19,126) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 19:57:24,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 19:57:25,161) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.294341, valid_loss 1.020942, train_metric nan, valid_metric 0.021381
[852895:MainThread](2024-04-06 19:57:25,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.020942, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 19:57:25,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.157159, valid_loss 1.017910, train_metric nan, valid_metric 0.024322
[852895:MainThread](2024-04-06 19:57:25,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.020942 to 1.017910, save checkpoint.
[852895:MainThread](2024-04-06 19:57:26,346) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.078024, valid_loss 1.009367, train_metric nan, valid_metric 0.052610
[852895:MainThread](2024-04-06 19:57:26,353) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.017910 to 1.009367, save checkpoint.
[852895:MainThread](2024-04-06 19:57:27,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.045412, valid_loss 1.009552, train_metric nan, valid_metric 0.037103
[852895:MainThread](2024-04-06 19:57:27,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.046350, valid_loss 1.003181, train_metric nan, valid_metric 0.051814
[852895:MainThread](2024-04-06 19:57:27,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.009367 to 1.003181, save checkpoint.
[852895:MainThread](2024-04-06 19:57:28,132) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.041804, valid_loss 0.993195, train_metric nan, valid_metric 0.078564
[852895:MainThread](2024-04-06 19:57:28,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003181 to 0.993195, save checkpoint.
[852895:MainThread](2024-04-06 19:57:28,516) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.030664, valid_loss 1.023342, train_metric nan, valid_metric 0.052431
[852895:MainThread](2024-04-06 19:57:29,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.022076, valid_loss 1.011601, train_metric nan, valid_metric 0.054869
[852895:MainThread](2024-04-06 19:57:29,672) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.020280, valid_loss 0.990687, train_metric nan, valid_metric 0.104083
[852895:MainThread](2024-04-06 19:57:29,678) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993195 to 0.990687, save checkpoint.
[852895:MainThread](2024-04-06 19:57:30,084) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.013679, valid_loss 0.993424, train_metric nan, valid_metric 0.073636
[852895:MainThread](2024-04-06 19:57:30,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.012337, valid_loss 0.996648, train_metric nan, valid_metric 0.075713
[852895:MainThread](2024-04-06 19:57:30,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.012071, valid_loss 1.014406, train_metric nan, valid_metric 0.030302
[852895:MainThread](2024-04-06 19:57:31,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.026272, valid_loss 0.995000, train_metric nan, valid_metric 0.073727
[852895:MainThread](2024-04-06 19:57:31,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.008043, valid_loss 1.000787, train_metric nan, valid_metric 0.031810
[852895:MainThread](2024-04-06 19:57:31,524) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.998109, valid_loss 0.992676, train_metric nan, valid_metric 0.075298
[852895:MainThread](2024-04-06 19:57:31,929) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.005881, valid_loss 0.999353, train_metric nan, valid_metric 0.030711
[852895:MainThread](2024-04-06 19:57:32,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.998163, valid_loss 0.993981, train_metric nan, valid_metric 0.064053
[852895:MainThread](2024-04-06 19:57:32,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.002823, valid_loss 0.996038, train_metric nan, valid_metric 0.078894
[852895:MainThread](2024-04-06 19:57:33,229) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.008444, valid_loss 0.990611, train_metric nan, valid_metric 0.087248
[852895:MainThread](2024-04-06 19:57:33,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990687 to 0.990611, save checkpoint.
[852895:MainThread](2024-04-06 19:57:33,673) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.011029, valid_loss 0.999730, train_metric nan, valid_metric 0.059827
[852895:MainThread](2024-04-06 19:57:34,243) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.000303, valid_loss 0.990682, train_metric nan, valid_metric 0.078536
[852895:MainThread](2024-04-06 19:57:34,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.997908, valid_loss 0.994156, train_metric nan, valid_metric 0.071483
[852895:MainThread](2024-04-06 19:57:34,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.986494, valid_loss 0.995704, train_metric nan, valid_metric 0.058349
[852895:MainThread](2024-04-06 19:57:35,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.989746, valid_loss 0.993687, train_metric nan, valid_metric 0.060078
[852895:MainThread](2024-04-06 19:57:35,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.992427, valid_loss 0.994137, train_metric nan, valid_metric 0.076986
[852895:MainThread](2024-04-06 19:57:35,980) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.998199, valid_loss 0.994747, train_metric nan, valid_metric 0.057245
[852895:MainThread](2024-04-06 19:57:36,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.990846, valid_loss 0.993532, train_metric nan, valid_metric 0.066254
[852895:MainThread](2024-04-06 19:57:36,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.996442, valid_loss 0.994442, train_metric nan, valid_metric 0.063894
[852895:MainThread](2024-04-06 19:57:37,089) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.005302, valid_loss 0.998257, train_metric nan, valid_metric 0.093333
[852895:MainThread](2024-04-06 19:57:37,433) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.993086, valid_loss 0.990277, train_metric nan, valid_metric 0.085830
[852895:MainThread](2024-04-06 19:57:37,434) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990611 to 0.990277, save checkpoint.
[852895:MainThread](2024-04-06 19:57:37,784) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.987173, valid_loss 0.994449, train_metric nan, valid_metric 0.066058
[852895:MainThread](2024-04-06 19:57:38,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.990115, valid_loss 0.992634, train_metric nan, valid_metric 0.079428
[852895:MainThread](2024-04-06 19:57:38,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.992861, valid_loss 0.997190, train_metric nan, valid_metric 0.052849
[852895:MainThread](2024-04-06 19:57:38,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.993017, valid_loss 0.999089, train_metric nan, valid_metric 0.050795
[852895:MainThread](2024-04-06 19:57:39,126) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.999821, valid_loss 0.989788, train_metric nan, valid_metric 0.091422
[852895:MainThread](2024-04-06 19:57:39,127) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990277 to 0.989788, save checkpoint.
[852895:MainThread](2024-04-06 19:57:39,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.997948, valid_loss 0.991461, train_metric nan, valid_metric 0.094362
[852895:MainThread](2024-04-06 19:57:39,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.992664, valid_loss 0.990241, train_metric nan, valid_metric 0.082003
[852895:MainThread](2024-04-06 19:57:39,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.991846, valid_loss 0.989168, train_metric nan, valid_metric 0.087747
[852895:MainThread](2024-04-06 19:57:39,907) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.989788 to 0.989168, save checkpoint.
[852895:MainThread](2024-04-06 19:57:40,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.999139, valid_loss 0.991852, train_metric nan, valid_metric 0.071640
[852895:MainThread](2024-04-06 19:57:40,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.990117, valid_loss 0.992139, train_metric nan, valid_metric 0.077308
[852895:MainThread](2024-04-06 19:57:40,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.989653, valid_loss 0.994768, train_metric nan, valid_metric 0.065418
[852895:MainThread](2024-04-06 19:57:41,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.983233, valid_loss 0.988960, train_metric nan, valid_metric 0.086563
[852895:MainThread](2024-04-06 19:57:41,146) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.989168 to 0.988960, save checkpoint.
[852895:MainThread](2024-04-06 19:57:41,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.983431, valid_loss 0.990027, train_metric nan, valid_metric 0.079684
[852895:MainThread](2024-04-06 19:57:42,005) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.983712, valid_loss 0.991612, train_metric nan, valid_metric 0.079150
[852895:MainThread](2024-04-06 19:57:42,369) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.982944, valid_loss 0.992988, train_metric nan, valid_metric 0.076848
[852895:MainThread](2024-04-06 19:57:42,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.988399, valid_loss 0.990761, train_metric nan, valid_metric 0.078669
[852895:MainThread](2024-04-06 19:57:43,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.992467, valid_loss 0.992657, train_metric nan, valid_metric 0.071438
[852895:MainThread](2024-04-06 19:57:43,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.980022, valid_loss 0.989079, train_metric nan, valid_metric 0.085744
[852895:MainThread](2024-04-06 19:57:43,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.988826, valid_loss 0.993160, train_metric nan, valid_metric 0.070140
[852895:MainThread](2024-04-06 19:57:44,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.989333, valid_loss 0.994056, train_metric nan, valid_metric 0.070921
[852895:MainThread](2024-04-06 19:57:44,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.991999, valid_loss 0.992232, train_metric nan, valid_metric 0.068989
[852895:MainThread](2024-04-06 19:57:44,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.990374, valid_loss 0.992369, train_metric nan, valid_metric 0.070371
[852895:MainThread](2024-04-06 19:57:45,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.988299, valid_loss 0.989941, train_metric nan, valid_metric 0.087799
[852895:MainThread](2024-04-06 19:57:45,635) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.999038, valid_loss 0.989863, train_metric nan, valid_metric 0.082218
[852895:MainThread](2024-04-06 19:57:45,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.993477, valid_loss 0.995012, train_metric nan, valid_metric 0.056962
[852895:MainThread](2024-04-06 19:57:46,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.991718, valid_loss 0.993072, train_metric nan, valid_metric 0.063913
[852895:MainThread](2024-04-06 19:57:46,709) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.995074, valid_loss 0.991522, train_metric nan, valid_metric 0.075854
[852895:MainThread](2024-04-06 19:57:47,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.987379, valid_loss 0.992302, train_metric nan, valid_metric 0.071794
[852895:MainThread](2024-04-06 19:57:47,585) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.994032, valid_loss 0.996473, train_metric nan, valid_metric 0.050369
[852895:MainThread](2024-04-06 19:57:48,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.988243, valid_loss 0.993999, train_metric nan, valid_metric 0.065643
[852895:MainThread](2024-04-06 19:57:49,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.980833, valid_loss 0.992289, train_metric nan, valid_metric 0.069266
[852895:MainThread](2024-04-06 19:57:49,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.987989, valid_loss 0.992132, train_metric nan, valid_metric 0.070676
[852895:MainThread](2024-04-06 19:57:50,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.992916, valid_loss 0.994074, train_metric nan, valid_metric 0.060994
[852895:MainThread](2024-04-06 19:57:50,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.986148, valid_loss 0.990343, train_metric nan, valid_metric 0.079418
[852895:MainThread](2024-04-06 19:57:51,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.990380, valid_loss 0.992029, train_metric nan, valid_metric 0.074193
[852895:MainThread](2024-04-06 19:57:52,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.989501, valid_loss 0.991290, train_metric nan, valid_metric 0.074885
[852895:MainThread](2024-04-06 19:57:52,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.985516, valid_loss 0.993831, train_metric nan, valid_metric 0.076259
[852895:MainThread](2024-04-06 19:57:52,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.977206, valid_loss 0.992129, train_metric nan, valid_metric 0.071803
[852895:MainThread](2024-04-06 19:57:53,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.993029, valid_loss 0.992786, train_metric nan, valid_metric 0.066974
[852895:MainThread](2024-04-06 19:57:53,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.993595, valid_loss 0.990715, train_metric nan, valid_metric 0.078754
[852895:MainThread](2024-04-06 19:57:53,960) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.982302, valid_loss 0.991271, train_metric nan, valid_metric 0.074155
[852895:MainThread](2024-04-06 19:57:54,335) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.983591, valid_loss 0.990127, train_metric nan, valid_metric 0.080827
[852895:MainThread](2024-04-06 19:57:54,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.988978, valid_loss 0.993468, train_metric nan, valid_metric 0.062675
[852895:MainThread](2024-04-06 19:57:55,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.973764, valid_loss 0.991798, train_metric nan, valid_metric 0.074764
[852895:MainThread](2024-04-06 19:57:56,346) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.990428, valid_loss 0.991088, train_metric nan, valid_metric 0.074976
[852895:MainThread](2024-04-06 19:57:56,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.992909, valid_loss 0.992334, train_metric nan, valid_metric 0.071739
[852895:MainThread](2024-04-06 19:57:57,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.979729, valid_loss 0.992801, train_metric nan, valid_metric 0.067486
[852895:MainThread](2024-04-06 19:57:57,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.979638, valid_loss 0.991646, train_metric nan, valid_metric 0.073051
[852895:MainThread](2024-04-06 19:57:57,709) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.977848, valid_loss 0.989317, train_metric nan, valid_metric 0.088675
[852895:MainThread](2024-04-06 19:57:58,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.993222, valid_loss 0.990231, train_metric nan, valid_metric 0.080494
[852895:MainThread](2024-04-06 19:57:58,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.986527, valid_loss 0.990113, train_metric nan, valid_metric 0.081549
[852895:MainThread](2024-04-06 19:57:59,080) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.992809, valid_loss 0.992575, train_metric nan, valid_metric 0.069502
[852895:MainThread](2024-04-06 19:57:59,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.993012, valid_loss 0.990180, train_metric nan, valid_metric 0.082271
[852895:MainThread](2024-04-06 19:57:59,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.986053, valid_loss 0.991126, train_metric nan, valid_metric 0.075138
[852895:MainThread](2024-04-06 19:58:00,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.984228, valid_loss 0.991690, train_metric nan, valid_metric 0.074539
[852895:MainThread](2024-04-06 19:58:00,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.985502, valid_loss 0.991830, train_metric nan, valid_metric 0.071815
[852895:MainThread](2024-04-06 19:58:00,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.986227, valid_loss 0.989060, train_metric nan, valid_metric 0.088603
[852895:MainThread](2024-04-06 19:58:01,167) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.993303, valid_loss 0.991466, train_metric nan, valid_metric 0.074355
[852895:MainThread](2024-04-06 19:58:01,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.980311, valid_loss 0.991246, train_metric nan, valid_metric 0.076106
[852895:MainThread](2024-04-06 19:58:01,593) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.995562, valid_loss 0.991482, train_metric nan, valid_metric 0.073634
[852895:MainThread](2024-04-06 19:58:01,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.990464, valid_loss 0.992573, train_metric nan, valid_metric 0.068969
[852895:MainThread](2024-04-06 19:58:02,175) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.987884, valid_loss 0.991920, train_metric nan, valid_metric 0.071750
[852895:MainThread](2024-04-06 19:58:02,180) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 19:58:03,495) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 19:58:05,066) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  52%|█████▏    | 13/25 [11:03<09:21, 46.76s/it][852895:MainThread](2024-04-06 19:58:05,076) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 19:58:05,088) INFO - qlib.workflow - [recorder.py:341] - Recorder 31eeab9719bb41e28ac866254ba43db5 starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 19:58:06,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 19:58:06,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 19:58:06,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 19:58:06,073) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 19:58:14,442) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 19:58:15,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.219328, valid_loss 1.353878, train_metric nan, valid_metric 0.010059
[852895:MainThread](2024-04-06 19:58:15,702) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.353878, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 19:58:16,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.079556, valid_loss 1.080207, train_metric nan, valid_metric 0.017195
[852895:MainThread](2024-04-06 19:58:16,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.353878 to 1.080207, save checkpoint.
[852895:MainThread](2024-04-06 19:58:16,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.056180, valid_loss 1.013065, train_metric nan, valid_metric 0.022781
[852895:MainThread](2024-04-06 19:58:16,651) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.080207 to 1.013065, save checkpoint.
[852895:MainThread](2024-04-06 19:58:17,039) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.038114, valid_loss 1.028453, train_metric nan, valid_metric 0.019686
[852895:MainThread](2024-04-06 19:58:17,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.051649, valid_loss 1.038521, train_metric nan, valid_metric 0.025046
[852895:MainThread](2024-04-06 19:58:17,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.030008, valid_loss 1.011891, train_metric nan, valid_metric 0.028388
[852895:MainThread](2024-04-06 19:58:17,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.013065 to 1.011891, save checkpoint.
[852895:MainThread](2024-04-06 19:58:18,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.027083, valid_loss 1.026374, train_metric nan, valid_metric 0.019958
[852895:MainThread](2024-04-06 19:58:18,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.100470, valid_loss 1.095893, train_metric nan, valid_metric -0.005880
[852895:MainThread](2024-04-06 19:58:19,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.053886, valid_loss 1.012710, train_metric nan, valid_metric 0.020040
[852895:MainThread](2024-04-06 19:58:20,104) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.005254, valid_loss 1.000094, train_metric nan, valid_metric 0.038551
[852895:MainThread](2024-04-06 19:58:20,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.011891 to 1.000094, save checkpoint.
[852895:MainThread](2024-04-06 19:58:20,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 0.996470, valid_loss 1.002004, train_metric nan, valid_metric 0.045783
[852895:MainThread](2024-04-06 19:58:20,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.008206, valid_loss 0.995569, train_metric nan, valid_metric 0.058863
[852895:MainThread](2024-04-06 19:58:20,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000094 to 0.995569, save checkpoint.
[852895:MainThread](2024-04-06 19:58:21,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.996096, valid_loss 1.010269, train_metric nan, valid_metric 0.029386
[852895:MainThread](2024-04-06 19:58:21,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.017645, valid_loss 0.999546, train_metric nan, valid_metric 0.020467
[852895:MainThread](2024-04-06 19:58:21,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.000152, valid_loss 0.998327, train_metric nan, valid_metric 0.036050
[852895:MainThread](2024-04-06 19:58:22,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.998740, valid_loss 1.010650, train_metric nan, valid_metric 0.053434
[852895:MainThread](2024-04-06 19:58:22,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.997852, valid_loss 0.998895, train_metric nan, valid_metric 0.029826
[852895:MainThread](2024-04-06 19:58:22,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.986529, valid_loss 0.996869, train_metric nan, valid_metric 0.045303
[852895:MainThread](2024-04-06 19:58:23,129) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.000796, valid_loss 1.001596, train_metric nan, valid_metric 0.038443
[852895:MainThread](2024-04-06 19:58:23,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.995086, valid_loss 0.997295, train_metric nan, valid_metric 0.037922
[852895:MainThread](2024-04-06 19:58:23,691) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.999685, valid_loss 0.995036, train_metric nan, valid_metric 0.051154
[852895:MainThread](2024-04-06 19:58:23,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995569 to 0.995036, save checkpoint.
[852895:MainThread](2024-04-06 19:58:23,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.992708, valid_loss 0.997687, train_metric nan, valid_metric 0.050465
[852895:MainThread](2024-04-06 19:58:24,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.001149, valid_loss 1.000023, train_metric nan, valid_metric 0.035706
[852895:MainThread](2024-04-06 19:58:24,526) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.996781, valid_loss 0.994464, train_metric nan, valid_metric 0.056051
[852895:MainThread](2024-04-06 19:58:24,527) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995036 to 0.994464, save checkpoint.
[852895:MainThread](2024-04-06 19:58:24,784) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.985334, valid_loss 0.996045, train_metric nan, valid_metric 0.043900
[852895:MainThread](2024-04-06 19:58:25,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.998482, valid_loss 1.003799, train_metric nan, valid_metric 0.042073
[852895:MainThread](2024-04-06 19:58:25,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.994053, valid_loss 0.997119, train_metric nan, valid_metric 0.041590
[852895:MainThread](2024-04-06 19:58:25,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.988234, valid_loss 0.997710, train_metric nan, valid_metric 0.034954
[852895:MainThread](2024-04-06 19:58:26,192) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.993335, valid_loss 0.997994, train_metric nan, valid_metric 0.048969
[852895:MainThread](2024-04-06 19:58:26,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.001288, valid_loss 0.994597, train_metric nan, valid_metric 0.046869
[852895:MainThread](2024-04-06 19:58:26,929) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.985562, valid_loss 0.994458, train_metric nan, valid_metric 0.052286
[852895:MainThread](2024-04-06 19:58:26,935) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994464 to 0.994458, save checkpoint.
[852895:MainThread](2024-04-06 19:58:27,390) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.986879, valid_loss 0.997746, train_metric nan, valid_metric 0.027183
[852895:MainThread](2024-04-06 19:58:27,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.994367, valid_loss 0.999510, train_metric nan, valid_metric 0.049234
[852895:MainThread](2024-04-06 19:58:27,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.987968, valid_loss 0.996315, train_metric nan, valid_metric 0.045599
[852895:MainThread](2024-04-06 19:58:28,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.990576, valid_loss 1.001038, train_metric nan, valid_metric 0.029688
[852895:MainThread](2024-04-06 19:58:28,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.992067, valid_loss 0.994985, train_metric nan, valid_metric 0.051104
[852895:MainThread](2024-04-06 19:58:28,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.985659, valid_loss 0.996478, train_metric nan, valid_metric 0.051547
[852895:MainThread](2024-04-06 19:58:28,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.985854, valid_loss 0.995605, train_metric nan, valid_metric 0.049370
[852895:MainThread](2024-04-06 19:58:29,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.986144, valid_loss 0.996238, train_metric nan, valid_metric 0.045288
[852895:MainThread](2024-04-06 19:58:29,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.988378, valid_loss 0.997784, train_metric nan, valid_metric 0.054025
[852895:MainThread](2024-04-06 19:58:30,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.982122, valid_loss 0.994629, train_metric nan, valid_metric 0.050899
[852895:MainThread](2024-04-06 19:58:30,261) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.981675, valid_loss 0.995277, train_metric nan, valid_metric 0.049565
[852895:MainThread](2024-04-06 19:58:30,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.987478, valid_loss 0.995703, train_metric nan, valid_metric 0.040337
[852895:MainThread](2024-04-06 19:58:30,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.987086, valid_loss 0.995349, train_metric nan, valid_metric 0.050773
[852895:MainThread](2024-04-06 19:58:31,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.989274, valid_loss 0.995862, train_metric nan, valid_metric 0.055384
[852895:MainThread](2024-04-06 19:58:31,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.991667, valid_loss 0.995624, train_metric nan, valid_metric 0.047945
[852895:MainThread](2024-04-06 19:58:31,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.981439, valid_loss 0.995827, train_metric nan, valid_metric 0.050731
[852895:MainThread](2024-04-06 19:58:31,983) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.983869, valid_loss 0.997371, train_metric nan, valid_metric 0.045004
[852895:MainThread](2024-04-06 19:58:32,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.991558, valid_loss 0.997505, train_metric nan, valid_metric 0.044800
[852895:MainThread](2024-04-06 19:58:32,565) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.978933, valid_loss 0.996169, train_metric nan, valid_metric 0.045078
[852895:MainThread](2024-04-06 19:58:32,895) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.989939, valid_loss 0.995568, train_metric nan, valid_metric 0.048059
[852895:MainThread](2024-04-06 19:58:33,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.982658, valid_loss 0.996622, train_metric nan, valid_metric 0.043800
[852895:MainThread](2024-04-06 19:58:34,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.989671, valid_loss 0.998267, train_metric nan, valid_metric 0.045702
[852895:MainThread](2024-04-06 19:58:34,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.989478, valid_loss 0.996218, train_metric nan, valid_metric 0.049599
[852895:MainThread](2024-04-06 19:58:35,146) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.978424, valid_loss 0.994663, train_metric nan, valid_metric 0.047954
[852895:MainThread](2024-04-06 19:58:35,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.990082, valid_loss 0.995236, train_metric nan, valid_metric 0.052374
[852895:MainThread](2024-04-06 19:58:36,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.980167, valid_loss 0.995378, train_metric nan, valid_metric 0.046274
[852895:MainThread](2024-04-06 19:58:36,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.000239, valid_loss 0.995582, train_metric nan, valid_metric 0.047761
[852895:MainThread](2024-04-06 19:58:37,164) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.984725, valid_loss 0.995937, train_metric nan, valid_metric 0.044057
[852895:MainThread](2024-04-06 19:58:37,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.988667, valid_loss 0.995481, train_metric nan, valid_metric 0.047776
[852895:MainThread](2024-04-06 19:58:37,754) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.985699, valid_loss 0.995664, train_metric nan, valid_metric 0.049088
[852895:MainThread](2024-04-06 19:58:38,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.983455, valid_loss 0.995352, train_metric nan, valid_metric 0.048089
[852895:MainThread](2024-04-06 19:58:39,004) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.979613, valid_loss 0.995941, train_metric nan, valid_metric 0.046125
[852895:MainThread](2024-04-06 19:58:39,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.986733, valid_loss 0.996279, train_metric nan, valid_metric 0.046730
[852895:MainThread](2024-04-06 19:58:40,028) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.000236, valid_loss 0.996322, train_metric nan, valid_metric 0.047049
[852895:MainThread](2024-04-06 19:58:40,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.990029, valid_loss 0.995337, train_metric nan, valid_metric 0.046122
[852895:MainThread](2024-04-06 19:58:40,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.983346, valid_loss 0.995740, train_metric nan, valid_metric 0.049735
[852895:MainThread](2024-04-06 19:58:40,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.986020, valid_loss 0.996319, train_metric nan, valid_metric 0.048126
[852895:MainThread](2024-04-06 19:58:41,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.980569, valid_loss 0.994819, train_metric nan, valid_metric 0.047162
[852895:MainThread](2024-04-06 19:58:41,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.985193, valid_loss 0.995260, train_metric nan, valid_metric 0.049076
[852895:MainThread](2024-04-06 19:58:41,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.979330, valid_loss 0.994522, train_metric nan, valid_metric 0.044171
[852895:MainThread](2024-04-06 19:58:42,127) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.981125, valid_loss 0.995519, train_metric nan, valid_metric 0.045083
[852895:MainThread](2024-04-06 19:58:42,434) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.983941, valid_loss 0.995498, train_metric nan, valid_metric 0.042002
[852895:MainThread](2024-04-06 19:58:42,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.989179, valid_loss 0.996038, train_metric nan, valid_metric 0.044069
[852895:MainThread](2024-04-06 19:58:42,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.982867, valid_loss 0.996333, train_metric nan, valid_metric 0.043813
[852895:MainThread](2024-04-06 19:58:43,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.983665, valid_loss 0.995199, train_metric nan, valid_metric 0.045614
[852895:MainThread](2024-04-06 19:58:43,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.983922, valid_loss 0.995836, train_metric nan, valid_metric 0.044278
[852895:MainThread](2024-04-06 19:58:44,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.985049, valid_loss 0.996089, train_metric nan, valid_metric 0.047047
[852895:MainThread](2024-04-06 19:58:45,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.987013, valid_loss 0.996152, train_metric nan, valid_metric 0.042476
[852895:MainThread](2024-04-06 19:58:45,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.975583, valid_loss 0.995292, train_metric nan, valid_metric 0.048639
[852895:MainThread](2024-04-06 19:58:46,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.988463, valid_loss 0.994963, train_metric nan, valid_metric 0.049323
[852895:MainThread](2024-04-06 19:58:46,567) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 19:58:48,965) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
ModuleNotFoundError. CatBoostModel are skipped. (optional: maybe installing CatBoostModel can fix it.)
Epoch 00780: reducing learning rate of group 0 to 1.0000e-03.
Epoch 01000: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01220: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01440: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-04-01 SH600000    0.102972
           SH600009    0.056108
           SH600010   -0.046365
           SH600011    0.022420
           SH600015    0.138795
Epoch 00680: reducing learning rate of group 0 to 1.0000e-03.
Epoch 01000: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01220: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01440: reducing learning rate of group 0 to 1.2500e-04.
Epoch 01660: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-05-06 SH600000    0.079796
           SH600009    0.016407
           SH600010    0.085030
           SH600011   -0.053106
           SH600015   -0.051922
Epoch 00840: reducing learning rate of group 0 to 1.0000e-03.
Epoch 01060: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01420: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01640: reducing learning rate of group 0 to 1.2500e-04.
Epoch 01860: reducing learning rate of group 0 to 6.2500e-05.
Epoch 02080: reducing learning rate of group 0 to 3.1250e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-06-06 SH600000    0.025888
           SH600009    0.008953
           SH600010   -0.033208
           SH600011   -0.010752
           SH600015    0.044072
Epoch 00560: reducing learning rate of group 0 to 1.0000e-03.
Epoch 00780: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01000: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01220: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-07-04 SH600000    0.076471
           SH600009   -0.159845
           SH600010   -0.154350
           SH600011   -0.054411
           SH600015    0.048425
Epoch 00740: reducing learning rate of group 0 to 1.0000e-03.
Epoch 01080: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01420: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01640: reducing learning rate of group 0 to 1.2500e-04.
Epoch 01860: reducing learning rate of group 0 to 6.2500e-05.
Epoch 02080: reducing learning rate of group 0 to 3.1250e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-08-01 SH600000    0.082554
           SH600009   -0.056552
           SH600010   -0.068693
           SH600011    0.006718
           SH600015    0.080357
Epoch 01020: reducing learning rate of group 0 to 1.0000e-03.
Epoch 01240: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01460: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01680: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-08-29 SH600000    0.011010
           SH600009   -0.017908
           SH600010    0.023066
           SH600011   -0.052646
           SH600015    0.000643
Epoch 00460: reducing learning rate of group 0 to 1.0000e-03.
Epoch 00680: reducing learning rate of group 0 to 5.0000e-04.
Epoch 00940: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01160: reducing learning rate of group 0 to 1.2500e-04.
Epoch 01380: reducing learning rate of group 0 to 6.2500e-05.
Epoch 01600: reducing learning rate of group 0 to 3.1250e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-09-27 SH600000    0.051663
           SH600009   -0.006680
           SH600010    0.136983
           SH600011    0.077093
           SH600015   -0.010873
Epoch 00760: reducing learning rate of group 0 to 1.0000e-03.
Epoch 00980: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01200: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01420: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-11-01 SH600000    0.136569
           SH600009   -0.002192
           SH600010    0.118838
           SH600011    0.162098
           SH600015    0.127812
Epoch 00640: reducing learning rate of group 0 to 1.0000e-03.
Epoch 01000: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01220: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01440: reducing learning rate of group 0 to 1.2500e-04.
Epoch 01660: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-11-29 SH600000   -0.072589
           SH600009    0.028565
           SH600010   -0.117324
           SH600011    0.095881
           SH600015   -0.010657
Epoch 00500: reducing learning rate of group 0 to 1.0000e-03.
Epoch 00720: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01160: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01380: reducing learning rate of group 0 to 1.2500e-04.
Epoch 01600: reducing learning rate of group 0 to 6.2500e-05.
Epoch 01820: reducing learning rate of group 0 to 3.1250e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-12-27 SH600000    0.083896
           SH600009    0.132702
           SH600010    0.043655
           SH600011   -0.023316
           SH600015   -0.010928
Epoch 00400: reducing learning rate of group 0 to 1.0000e-03.
Epoch 00740: reducing learning rate of group 0 to 5.0000e-04.
Epoch 00960: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01180: reducing learning rate of group 0 to 1.2500e-04.
Epoch 01400: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-02-01 SH600000    0.044289
           SH600009    0.017193
           SH600010   -0.038370
           SH600011   -0.024960
           SH600015   -0.063729
Epoch 00760: reducing learning rate of group 0 to 1.0000e-03.
Epoch 00980: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01200: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01420: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-03-01 SH600000    0.084897
           SH600009    0.059006
           SH600010   -0.017262
           SH600011    0.027014
           SH600015    0.042213
Epoch 00400: reducing learning rate of group 0 to 1.0000e-03.
Epoch 01060: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01280: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01500: reducing learning rate of group 0 to 1.2500e-04.
Epoch 01720: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-03-29 SH600000    0.160603
           SH600009   -0.034472
           SH600010   -0.009007
           SH600011    0.085645
           SH600015    0.116817
Epoch 00700: reducing learning rate of group 0 to 1.0000e-03.
Epoch 00920: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01140: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01360: reducing learning rate of group 0 to 1.2500e-04.
Epoch 01580: reducing learning rate of group 0 to 6.2500e-05.
[852895:MainThread](2024-04-06 19:58:50,189) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  56%|█████▌    | 14/25 [11:48<08:28, 46.27s/it][852895:MainThread](2024-04-06 19:58:50,204) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 19:58:50,225) INFO - qlib.workflow - [recorder.py:341] - Recorder bda1680d283e40e395dfd751b9cea45b starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 19:58:51,227) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 19:58:51,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 19:58:51,242) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 19:58:51,243) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 19:58:57,307) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 19:58:58,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.267195, valid_loss 1.029933, train_metric nan, valid_metric 0.004333
[852895:MainThread](2024-04-06 19:58:58,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.029933, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 19:58:59,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.094988, valid_loss 1.027383, train_metric nan, valid_metric 0.036824
[852895:MainThread](2024-04-06 19:58:59,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.029933 to 1.027383, save checkpoint.
[852895:MainThread](2024-04-06 19:59:00,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.062062, valid_loss 1.021994, train_metric nan, valid_metric 0.035513
[852895:MainThread](2024-04-06 19:59:00,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.027383 to 1.021994, save checkpoint.
[852895:MainThread](2024-04-06 19:59:00,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.060907, valid_loss 1.030288, train_metric nan, valid_metric 0.041321
[852895:MainThread](2024-04-06 19:59:01,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.033811, valid_loss 1.005939, train_metric nan, valid_metric 0.024273
[852895:MainThread](2024-04-06 19:59:01,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.021994 to 1.005939, save checkpoint.
[852895:MainThread](2024-04-06 19:59:01,754) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.050570, valid_loss 1.003202, train_metric nan, valid_metric 0.042372
[852895:MainThread](2024-04-06 19:59:01,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.005939 to 1.003202, save checkpoint.
[852895:MainThread](2024-04-06 19:59:02,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.028836, valid_loss 1.008783, train_metric nan, valid_metric 0.022454
[852895:MainThread](2024-04-06 19:59:02,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.021744, valid_loss 1.000709, train_metric nan, valid_metric 0.044024
[852895:MainThread](2024-04-06 19:59:02,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003202 to 1.000709, save checkpoint.
[852895:MainThread](2024-04-06 19:59:03,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.019470, valid_loss 1.001124, train_metric nan, valid_metric 0.043576
[852895:MainThread](2024-04-06 19:59:04,149) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.017619, valid_loss 1.008023, train_metric nan, valid_metric 0.037966
[852895:MainThread](2024-04-06 19:59:04,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.009293, valid_loss 0.999747, train_metric nan, valid_metric 0.036992
[852895:MainThread](2024-04-06 19:59:04,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000709 to 0.999747, save checkpoint.
[852895:MainThread](2024-04-06 19:59:04,578) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.007469, valid_loss 0.998358, train_metric nan, valid_metric 0.042820
[852895:MainThread](2024-04-06 19:59:04,583) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999747 to 0.998358, save checkpoint.
[852895:MainThread](2024-04-06 19:59:04,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.007539, valid_loss 1.004134, train_metric nan, valid_metric 0.044794
[852895:MainThread](2024-04-06 19:59:05,507) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.003976, valid_loss 0.996948, train_metric nan, valid_metric 0.047932
[852895:MainThread](2024-04-06 19:59:05,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998358 to 0.996948, save checkpoint.
[852895:MainThread](2024-04-06 19:59:05,782) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.002401, valid_loss 0.999230, train_metric nan, valid_metric 0.049324
[852895:MainThread](2024-04-06 19:59:06,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.995793, valid_loss 1.006022, train_metric nan, valid_metric 0.060709
[852895:MainThread](2024-04-06 19:59:06,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.991784, valid_loss 0.997689, train_metric nan, valid_metric 0.051092
[852895:MainThread](2024-04-06 19:59:06,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.013946, valid_loss 0.997196, train_metric nan, valid_metric 0.049123
[852895:MainThread](2024-04-06 19:59:06,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.018415, valid_loss 1.003761, train_metric nan, valid_metric 0.041323
[852895:MainThread](2024-04-06 19:59:07,132) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.005000, valid_loss 0.995735, train_metric nan, valid_metric 0.058343
[852895:MainThread](2024-04-06 19:59:07,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996948 to 0.995735, save checkpoint.
[852895:MainThread](2024-04-06 19:59:07,565) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.994070, valid_loss 0.997320, train_metric nan, valid_metric 0.053721
[852895:MainThread](2024-04-06 19:59:07,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.995649, valid_loss 0.999705, train_metric nan, valid_metric 0.043211
[852895:MainThread](2024-04-06 19:59:08,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.993426, valid_loss 1.005513, train_metric nan, valid_metric 0.043965
[852895:MainThread](2024-04-06 19:59:08,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.001854, valid_loss 0.997135, train_metric nan, valid_metric 0.050169
[852895:MainThread](2024-04-06 19:59:08,742) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.986996, valid_loss 0.998059, train_metric nan, valid_metric 0.043458
[852895:MainThread](2024-04-06 19:59:09,102) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.987011, valid_loss 0.996308, train_metric nan, valid_metric 0.046965
[852895:MainThread](2024-04-06 19:59:09,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.995421, valid_loss 0.998686, train_metric nan, valid_metric 0.040118
[852895:MainThread](2024-04-06 19:59:09,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.988449, valid_loss 1.002639, train_metric nan, valid_metric 0.054249
[852895:MainThread](2024-04-06 19:59:10,013) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.992596, valid_loss 0.996362, train_metric nan, valid_metric 0.045510
[852895:MainThread](2024-04-06 19:59:10,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.989979, valid_loss 0.997274, train_metric nan, valid_metric 0.053778
[852895:MainThread](2024-04-06 19:59:11,223) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.989616, valid_loss 0.995915, train_metric nan, valid_metric 0.045995
[852895:MainThread](2024-04-06 19:59:11,471) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.999581, valid_loss 0.995715, train_metric nan, valid_metric 0.046527
[852895:MainThread](2024-04-06 19:59:11,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995735 to 0.995715, save checkpoint.
[852895:MainThread](2024-04-06 19:59:11,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.987238, valid_loss 0.997703, train_metric nan, valid_metric 0.042754
[852895:MainThread](2024-04-06 19:59:12,187) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.994353, valid_loss 0.995516, train_metric nan, valid_metric 0.048015
[852895:MainThread](2024-04-06 19:59:12,188) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995715 to 0.995516, save checkpoint.
[852895:MainThread](2024-04-06 19:59:12,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.987111, valid_loss 0.998277, train_metric nan, valid_metric 0.039380
[852895:MainThread](2024-04-06 19:59:12,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.980604, valid_loss 0.996806, train_metric nan, valid_metric 0.042287
[852895:MainThread](2024-04-06 19:59:13,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.976138, valid_loss 0.999525, train_metric nan, valid_metric 0.041058
[852895:MainThread](2024-04-06 19:59:13,569) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.988327, valid_loss 0.995424, train_metric nan, valid_metric 0.053130
[852895:MainThread](2024-04-06 19:59:13,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995516 to 0.995424, save checkpoint.
[852895:MainThread](2024-04-06 19:59:13,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.993423, valid_loss 0.994899, train_metric nan, valid_metric 0.048224
[852895:MainThread](2024-04-06 19:59:13,877) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995424 to 0.994899, save checkpoint.
[852895:MainThread](2024-04-06 19:59:14,142) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.999756, valid_loss 0.998284, train_metric nan, valid_metric 0.047076
[852895:MainThread](2024-04-06 19:59:14,394) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.986042, valid_loss 0.996346, train_metric nan, valid_metric 0.045128
[852895:MainThread](2024-04-06 19:59:14,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.993288, valid_loss 0.996194, train_metric nan, valid_metric 0.043971
[852895:MainThread](2024-04-06 19:59:14,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.991996, valid_loss 0.996959, train_metric nan, valid_metric 0.040614
[852895:MainThread](2024-04-06 19:59:15,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.980397, valid_loss 0.998808, train_metric nan, valid_metric 0.033326
[852895:MainThread](2024-04-06 19:59:15,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.985789, valid_loss 0.994875, train_metric nan, valid_metric 0.047476
[852895:MainThread](2024-04-06 19:59:15,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994899 to 0.994875, save checkpoint.
[852895:MainThread](2024-04-06 19:59:15,793) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.990314, valid_loss 0.998275, train_metric nan, valid_metric 0.043266
[852895:MainThread](2024-04-06 19:59:16,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.993062, valid_loss 0.995190, train_metric nan, valid_metric 0.043675
[852895:MainThread](2024-04-06 19:59:16,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.984829, valid_loss 0.996708, train_metric nan, valid_metric 0.047936
[852895:MainThread](2024-04-06 19:59:16,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.979799, valid_loss 0.997292, train_metric nan, valid_metric 0.041328
[852895:MainThread](2024-04-06 19:59:16,913) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.986353, valid_loss 0.994503, train_metric nan, valid_metric 0.046546
[852895:MainThread](2024-04-06 19:59:16,914) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994875 to 0.994503, save checkpoint.
[852895:MainThread](2024-04-06 19:59:17,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.989444, valid_loss 0.994254, train_metric nan, valid_metric 0.053033
[852895:MainThread](2024-04-06 19:59:17,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994503 to 0.994254, save checkpoint.
[852895:MainThread](2024-04-06 19:59:17,375) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.988234, valid_loss 0.995834, train_metric nan, valid_metric 0.049291
[852895:MainThread](2024-04-06 19:59:17,641) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.981891, valid_loss 0.997857, train_metric nan, valid_metric 0.039148
[852895:MainThread](2024-04-06 19:59:18,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.981204, valid_loss 0.996012, train_metric nan, valid_metric 0.044728
[852895:MainThread](2024-04-06 19:59:18,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.987552, valid_loss 0.995955, train_metric nan, valid_metric 0.045835
[852895:MainThread](2024-04-06 19:59:18,899) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.974038, valid_loss 0.999137, train_metric nan, valid_metric 0.030059
[852895:MainThread](2024-04-06 19:59:19,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.987544, valid_loss 0.995913, train_metric nan, valid_metric 0.047136
[852895:MainThread](2024-04-06 19:59:19,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.986803, valid_loss 0.999686, train_metric nan, valid_metric 0.046415
[852895:MainThread](2024-04-06 19:59:20,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.982674, valid_loss 0.998825, train_metric nan, valid_metric 0.049249
[852895:MainThread](2024-04-06 19:59:20,336) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.984926, valid_loss 0.995470, train_metric nan, valid_metric 0.049071
[852895:MainThread](2024-04-06 19:59:20,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.992275, valid_loss 0.998791, train_metric nan, valid_metric 0.031229
[852895:MainThread](2024-04-06 19:59:20,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.987317, valid_loss 0.995838, train_metric nan, valid_metric 0.045377
[852895:MainThread](2024-04-06 19:59:21,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.993513, valid_loss 0.996849, train_metric nan, valid_metric 0.045735
[852895:MainThread](2024-04-06 19:59:21,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.989484, valid_loss 0.997145, train_metric nan, valid_metric 0.039782
[852895:MainThread](2024-04-06 19:59:21,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.978086, valid_loss 0.996619, train_metric nan, valid_metric 0.043241
[852895:MainThread](2024-04-06 19:59:21,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.984529, valid_loss 0.995757, train_metric nan, valid_metric 0.048302
[852895:MainThread](2024-04-06 19:59:22,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.992693, valid_loss 0.997118, train_metric nan, valid_metric 0.048877
[852895:MainThread](2024-04-06 19:59:22,564) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.980680, valid_loss 0.994177, train_metric nan, valid_metric 0.048020
[852895:MainThread](2024-04-06 19:59:22,564) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994254 to 0.994177, save checkpoint.
[852895:MainThread](2024-04-06 19:59:22,914) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.983258, valid_loss 0.995862, train_metric nan, valid_metric 0.043190
[852895:MainThread](2024-04-06 19:59:23,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.978793, valid_loss 0.997179, train_metric nan, valid_metric 0.041004
[852895:MainThread](2024-04-06 19:59:23,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.985355, valid_loss 0.997039, train_metric nan, valid_metric 0.040934
[852895:MainThread](2024-04-06 19:59:23,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.985236, valid_loss 0.996257, train_metric nan, valid_metric 0.044904
[852895:MainThread](2024-04-06 19:59:24,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.986648, valid_loss 0.996633, train_metric nan, valid_metric 0.042891
[852895:MainThread](2024-04-06 19:59:24,667) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.984118, valid_loss 0.995041, train_metric nan, valid_metric 0.048691
[852895:MainThread](2024-04-06 19:59:25,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.978550, valid_loss 0.996834, train_metric nan, valid_metric 0.044337
[852895:MainThread](2024-04-06 19:59:25,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.996241, valid_loss 0.996621, train_metric nan, valid_metric 0.043786
[852895:MainThread](2024-04-06 19:59:25,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.979397, valid_loss 0.995171, train_metric nan, valid_metric 0.046449
[852895:MainThread](2024-04-06 19:59:26,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.977051, valid_loss 0.995344, train_metric nan, valid_metric 0.049752
[852895:MainThread](2024-04-06 19:59:26,590) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.976469, valid_loss 0.997018, train_metric nan, valid_metric 0.044413
[852895:MainThread](2024-04-06 19:59:26,873) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.989635, valid_loss 0.995898, train_metric nan, valid_metric 0.046509
[852895:MainThread](2024-04-06 19:59:27,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.982843, valid_loss 0.995161, train_metric nan, valid_metric 0.047549
[852895:MainThread](2024-04-06 19:59:27,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.985187, valid_loss 0.994826, train_metric nan, valid_metric 0.049343
[852895:MainThread](2024-04-06 19:59:28,052) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.976303, valid_loss 0.995792, train_metric nan, valid_metric 0.045223
[852895:MainThread](2024-04-06 19:59:28,364) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.976394, valid_loss 0.997233, train_metric nan, valid_metric 0.040294
[852895:MainThread](2024-04-06 19:59:28,667) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.977618, valid_loss 0.996875, train_metric nan, valid_metric 0.041114
[852895:MainThread](2024-04-06 19:59:29,028) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.984384, valid_loss 0.997118, train_metric nan, valid_metric 0.041220
[852895:MainThread](2024-04-06 19:59:29,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.990155, valid_loss 0.997070, train_metric nan, valid_metric 0.041639
[852895:MainThread](2024-04-06 19:59:29,576) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.979891, valid_loss 0.995017, train_metric nan, valid_metric 0.045429
[852895:MainThread](2024-04-06 19:59:29,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.982334, valid_loss 0.996151, train_metric nan, valid_metric 0.045998
[852895:MainThread](2024-04-06 19:59:30,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.994929, valid_loss 0.997128, train_metric nan, valid_metric 0.042666
[852895:MainThread](2024-04-06 19:59:30,354) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.977440, valid_loss 0.995079, train_metric nan, valid_metric 0.047503
[852895:MainThread](2024-04-06 19:59:30,626) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.983918, valid_loss 0.994346, train_metric nan, valid_metric 0.051009
[852895:MainThread](2024-04-06 19:59:30,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.986625, valid_loss 0.995607, train_metric nan, valid_metric 0.043001
[852895:MainThread](2024-04-06 19:59:31,204) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.992152, valid_loss 0.996686, train_metric nan, valid_metric 0.043209
[852895:MainThread](2024-04-06 19:59:31,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.974997, valid_loss 0.995378, train_metric nan, valid_metric 0.042761
[852895:MainThread](2024-04-06 19:59:32,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.983832, valid_loss 0.996331, train_metric nan, valid_metric 0.043145
[852895:MainThread](2024-04-06 19:59:32,298) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.985105, valid_loss 0.997127, train_metric nan, valid_metric 0.041571
[852895:MainThread](2024-04-06 19:59:32,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.982037, valid_loss 0.997099, train_metric nan, valid_metric 0.042549
[852895:MainThread](2024-04-06 19:59:33,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.982074, valid_loss 0.995528, train_metric nan, valid_metric 0.044918
[852895:MainThread](2024-04-06 19:59:33,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.979284, valid_loss 0.996530, train_metric nan, valid_metric 0.044030
[852895:MainThread](2024-04-06 19:59:33,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.988551, valid_loss 0.997016, train_metric nan, valid_metric 0.041688
[852895:MainThread](2024-04-06 19:59:34,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.983745, valid_loss 0.997014, train_metric nan, valid_metric 0.041921
[852895:MainThread](2024-04-06 19:59:34,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.985804, valid_loss 0.997158, train_metric nan, valid_metric 0.040963
[852895:MainThread](2024-04-06 19:59:35,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.984122, valid_loss 0.997126, train_metric nan, valid_metric 0.041394
[852895:MainThread](2024-04-06 19:59:36,016) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.990782, valid_loss 0.997109, train_metric nan, valid_metric 0.041902
[852895:MainThread](2024-04-06 19:59:36,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 1.002905, valid_loss 0.996226, train_metric nan, valid_metric 0.043666
[852895:MainThread](2024-04-06 19:59:37,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.982010, valid_loss 0.996802, train_metric nan, valid_metric 0.042826
[852895:MainThread](2024-04-06 19:59:37,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 0.979773, valid_loss 0.994467, train_metric nan, valid_metric 0.049897
[852895:MainThread](2024-04-06 19:59:38,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 0.982695, valid_loss 0.993970, train_metric nan, valid_metric 0.048725
[852895:MainThread](2024-04-06 19:59:38,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994177 to 0.993970, save checkpoint.
[852895:MainThread](2024-04-06 19:59:38,624) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 0.994256, valid_loss 0.995576, train_metric nan, valid_metric 0.045697
[852895:MainThread](2024-04-06 19:59:39,098) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 0.986378, valid_loss 0.995088, train_metric nan, valid_metric 0.044937
[852895:MainThread](2024-04-06 19:59:39,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 0.978987, valid_loss 0.996553, train_metric nan, valid_metric 0.042160
[852895:MainThread](2024-04-06 19:59:39,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 0.997573, valid_loss 0.996432, train_metric nan, valid_metric 0.036878
[852895:MainThread](2024-04-06 19:59:39,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 0.973740, valid_loss 0.996503, train_metric nan, valid_metric 0.041284
[852895:MainThread](2024-04-06 19:59:40,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 0.983796, valid_loss 0.996868, train_metric nan, valid_metric 0.041747
[852895:MainThread](2024-04-06 19:59:40,577) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 0.986246, valid_loss 0.995882, train_metric nan, valid_metric 0.044217
[852895:MainThread](2024-04-06 19:59:41,132) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 0.979930, valid_loss 0.996858, train_metric nan, valid_metric 0.042275
[852895:MainThread](2024-04-06 19:59:41,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 0.985001, valid_loss 0.995065, train_metric nan, valid_metric 0.044192
[852895:MainThread](2024-04-06 19:59:42,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 0.986076, valid_loss 0.996455, train_metric nan, valid_metric 0.043174
[852895:MainThread](2024-04-06 19:59:42,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 0.991877, valid_loss 0.997016, train_metric nan, valid_metric 0.042448
[852895:MainThread](2024-04-06 19:59:43,050) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 0.989019, valid_loss 0.995393, train_metric nan, valid_metric 0.047356
[852895:MainThread](2024-04-06 19:59:43,320) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 0.989442, valid_loss 0.996502, train_metric nan, valid_metric 0.044285
[852895:MainThread](2024-04-06 19:59:43,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 0.979058, valid_loss 0.997010, train_metric nan, valid_metric 0.042588
[852895:MainThread](2024-04-06 19:59:43,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 0.981986, valid_loss 0.997016, train_metric nan, valid_metric 0.042760
[852895:MainThread](2024-04-06 19:59:43,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 0.982427, valid_loss 0.997131, train_metric nan, valid_metric 0.041041
[852895:MainThread](2024-04-06 19:59:44,238) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 0.978508, valid_loss 0.997145, train_metric nan, valid_metric 0.042039
[852895:MainThread](2024-04-06 19:59:44,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 0.990858, valid_loss 0.997108, train_metric nan, valid_metric 0.041770
[852895:MainThread](2024-04-06 19:59:44,881) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 0.985374, valid_loss 0.996754, train_metric nan, valid_metric 0.042356
[852895:MainThread](2024-04-06 19:59:45,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 0.987052, valid_loss 0.995285, train_metric nan, valid_metric 0.045322
[852895:MainThread](2024-04-06 19:59:46,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 0.987819, valid_loss 0.995895, train_metric nan, valid_metric 0.045039
[852895:MainThread](2024-04-06 19:59:46,400) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 0.979248, valid_loss 0.996908, train_metric nan, valid_metric 0.042236
[852895:MainThread](2024-04-06 19:59:46,779) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 0.977477, valid_loss 0.996935, train_metric nan, valid_metric 0.043259
[852895:MainThread](2024-04-06 19:59:47,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 0.984193, valid_loss 0.996891, train_metric nan, valid_metric 0.042868
[852895:MainThread](2024-04-06 19:59:47,567) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 0.980148, valid_loss 0.996978, train_metric nan, valid_metric 0.042920
[852895:MainThread](2024-04-06 19:59:48,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 0.990058, valid_loss 0.996057, train_metric nan, valid_metric 0.045016
[852895:MainThread](2024-04-06 19:59:48,910) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 0.984007, valid_loss 0.996882, train_metric nan, valid_metric 0.042432
[852895:MainThread](2024-04-06 19:59:49,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 0.978745, valid_loss 0.996195, train_metric nan, valid_metric 0.044341
[852895:MainThread](2024-04-06 19:59:49,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2760]: train_loss 0.981627, valid_loss 0.995689, train_metric nan, valid_metric 0.045494
[852895:MainThread](2024-04-06 19:59:50,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2780]: train_loss 0.982950, valid_loss 0.995943, train_metric nan, valid_metric 0.044801
[852895:MainThread](2024-04-06 19:59:50,972) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2800]: train_loss 0.989868, valid_loss 0.996131, train_metric nan, valid_metric 0.044793
[852895:MainThread](2024-04-06 19:59:51,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2820]: train_loss 0.982275, valid_loss 0.995614, train_metric nan, valid_metric 0.045282
[852895:MainThread](2024-04-06 19:59:51,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2840]: train_loss 0.985551, valid_loss 0.996666, train_metric nan, valid_metric 0.043526
[852895:MainThread](2024-04-06 19:59:51,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2860]: train_loss 0.989063, valid_loss 0.996930, train_metric nan, valid_metric 0.043098
[852895:MainThread](2024-04-06 19:59:52,098) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2880]: train_loss 0.979899, valid_loss 0.996832, train_metric nan, valid_metric 0.042593
[852895:MainThread](2024-04-06 19:59:52,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2900]: train_loss 0.981592, valid_loss 0.995034, train_metric nan, valid_metric 0.046133
[852895:MainThread](2024-04-06 19:59:52,525) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2920]: train_loss 0.979704, valid_loss 0.995612, train_metric nan, valid_metric 0.046940
[852895:MainThread](2024-04-06 19:59:52,735) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2940]: train_loss 0.977844, valid_loss 0.996756, train_metric nan, valid_metric 0.043088
[852895:MainThread](2024-04-06 19:59:52,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2960]: train_loss 0.987580, valid_loss 0.996951, train_metric nan, valid_metric 0.042340
[852895:MainThread](2024-04-06 19:59:53,322) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2980]: train_loss 0.983285, valid_loss 0.997041, train_metric nan, valid_metric 0.042433
[852895:MainThread](2024-04-06 19:59:53,894) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3000]: train_loss 0.988272, valid_loss 0.997124, train_metric nan, valid_metric 0.041988
[852895:MainThread](2024-04-06 19:59:54,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3020]: train_loss 0.973950, valid_loss 0.995175, train_metric nan, valid_metric 0.045455
[852895:MainThread](2024-04-06 19:59:54,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3040]: train_loss 0.989177, valid_loss 0.995665, train_metric nan, valid_metric 0.044727
[852895:MainThread](2024-04-06 19:59:54,907) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3060]: train_loss 0.980208, valid_loss 0.996723, train_metric nan, valid_metric 0.042761
[852895:MainThread](2024-04-06 19:59:55,191) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3080]: train_loss 0.984717, valid_loss 0.996992, train_metric nan, valid_metric 0.042109
[852895:MainThread](2024-04-06 19:59:55,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3100]: train_loss 0.993626, valid_loss 0.996193, train_metric nan, valid_metric 0.043411
[852895:MainThread](2024-04-06 19:59:56,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3120]: train_loss 0.976045, valid_loss 0.996118, train_metric nan, valid_metric 0.042456
[852895:MainThread](2024-04-06 19:59:56,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3140]: train_loss 0.988869, valid_loss 0.996836, train_metric nan, valid_metric 0.042245
[852895:MainThread](2024-04-06 19:59:56,850) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3160]: train_loss 0.986910, valid_loss 0.997089, train_metric nan, valid_metric 0.041588
[852895:MainThread](2024-04-06 19:59:57,359) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3180]: train_loss 0.990275, valid_loss 0.997082, train_metric nan, valid_metric 0.039783
[852895:MainThread](2024-04-06 19:59:57,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 19:59:59,403) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 20:00:01,796) INFO - qlib.timer - [log.py:127] - Time cost: 0.003s | waiting `async_log` Done
train tasks:  60%|██████    | 15/25 [13:00<08:59, 53.91s/it][852895:MainThread](2024-04-06 20:00:01,823) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 20:00:01,852) INFO - qlib.workflow - [recorder.py:341] - Recorder 61aae0827a724298a4b45a636d75f1c6 starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 20:00:02,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 20:00:02,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 20:00:03,015) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 20:00:03,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 20:00:08,172) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 20:00:08,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.336468, valid_loss 1.045773, train_metric nan, valid_metric 0.010367
[852895:MainThread](2024-04-06 20:00:08,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.045773, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 20:00:08,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.120469, valid_loss 1.156911, train_metric nan, valid_metric 0.016684
[852895:MainThread](2024-04-06 20:00:09,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.090682, valid_loss 1.033515, train_metric nan, valid_metric 0.046888
[852895:MainThread](2024-04-06 20:00:09,167) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.045773 to 1.033515, save checkpoint.
[852895:MainThread](2024-04-06 20:00:09,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.081550, valid_loss 1.068528, train_metric nan, valid_metric 0.046634
[852895:MainThread](2024-04-06 20:00:09,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.064817, valid_loss 1.009973, train_metric nan, valid_metric 0.038009
[852895:MainThread](2024-04-06 20:00:09,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.033515 to 1.009973, save checkpoint.
[852895:MainThread](2024-04-06 20:00:10,229) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.076287, valid_loss 1.042878, train_metric nan, valid_metric 0.029064
[852895:MainThread](2024-04-06 20:00:10,516) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.070832, valid_loss 1.113194, train_metric nan, valid_metric 0.013256
[852895:MainThread](2024-04-06 20:00:10,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.077022, valid_loss 1.068190, train_metric nan, valid_metric 0.025235
[852895:MainThread](2024-04-06 20:00:11,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.034661, valid_loss 1.054153, train_metric nan, valid_metric 0.027232
[852895:MainThread](2024-04-06 20:00:11,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.016129, valid_loss 1.004364, train_metric nan, valid_metric 0.028263
[852895:MainThread](2024-04-06 20:00:11,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.009973 to 1.004364, save checkpoint.
[852895:MainThread](2024-04-06 20:00:12,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.014903, valid_loss 1.003111, train_metric nan, valid_metric 0.036007
[852895:MainThread](2024-04-06 20:00:12,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.004364 to 1.003111, save checkpoint.
[852895:MainThread](2024-04-06 20:00:12,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.018861, valid_loss 1.002961, train_metric nan, valid_metric 0.032061
[852895:MainThread](2024-04-06 20:00:12,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003111 to 1.002961, save checkpoint.
[852895:MainThread](2024-04-06 20:00:12,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.017064, valid_loss 1.008492, train_metric nan, valid_metric 0.022527
[852895:MainThread](2024-04-06 20:00:12,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.014884, valid_loss 1.000470, train_metric nan, valid_metric 0.032004
[852895:MainThread](2024-04-06 20:00:12,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.002961 to 1.000470, save checkpoint.
[852895:MainThread](2024-04-06 20:00:13,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.010673, valid_loss 1.004142, train_metric nan, valid_metric 0.041062
[852895:MainThread](2024-04-06 20:00:13,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.005671, valid_loss 1.013654, train_metric nan, valid_metric 0.035374
[852895:MainThread](2024-04-06 20:00:13,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.017724, valid_loss 1.030248, train_metric nan, valid_metric 0.030616
[852895:MainThread](2024-04-06 20:00:14,064) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.014165, valid_loss 1.010181, train_metric nan, valid_metric 0.041260
[852895:MainThread](2024-04-06 20:00:14,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.997277, valid_loss 0.999252, train_metric nan, valid_metric 0.039600
[852895:MainThread](2024-04-06 20:00:14,326) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000470 to 0.999252, save checkpoint.
[852895:MainThread](2024-04-06 20:00:14,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.999638, valid_loss 1.001970, train_metric nan, valid_metric 0.037697
[852895:MainThread](2024-04-06 20:00:14,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.004742, valid_loss 1.003506, train_metric nan, valid_metric 0.016162
[852895:MainThread](2024-04-06 20:00:15,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.995824, valid_loss 1.004133, train_metric nan, valid_metric 0.036976
[852895:MainThread](2024-04-06 20:00:15,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.995013, valid_loss 1.002232, train_metric nan, valid_metric 0.041366
[852895:MainThread](2024-04-06 20:00:16,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.009470, valid_loss 1.002010, train_metric nan, valid_metric 0.030519
[852895:MainThread](2024-04-06 20:00:16,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.995886, valid_loss 0.997897, train_metric nan, valid_metric 0.031201
[852895:MainThread](2024-04-06 20:00:16,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999252 to 0.997897, save checkpoint.
[852895:MainThread](2024-04-06 20:00:16,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.983652, valid_loss 0.996606, train_metric nan, valid_metric 0.043394
[852895:MainThread](2024-04-06 20:00:16,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997897 to 0.996606, save checkpoint.
[852895:MainThread](2024-04-06 20:00:17,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.001678, valid_loss 0.997227, train_metric nan, valid_metric 0.043566
[852895:MainThread](2024-04-06 20:00:17,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.994006, valid_loss 0.996598, train_metric nan, valid_metric 0.045704
[852895:MainThread](2024-04-06 20:00:17,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996606 to 0.996598, save checkpoint.
[852895:MainThread](2024-04-06 20:00:18,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.990350, valid_loss 1.003827, train_metric nan, valid_metric 0.023742
[852895:MainThread](2024-04-06 20:00:18,590) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.987477, valid_loss 0.996812, train_metric nan, valid_metric 0.049166
[852895:MainThread](2024-04-06 20:00:19,059) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.985487, valid_loss 0.996923, train_metric nan, valid_metric 0.053564
[852895:MainThread](2024-04-06 20:00:19,561) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.990974, valid_loss 0.998991, train_metric nan, valid_metric 0.042142
[852895:MainThread](2024-04-06 20:00:20,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.992548, valid_loss 1.015480, train_metric nan, valid_metric 0.038318
[852895:MainThread](2024-04-06 20:00:20,364) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.990838, valid_loss 0.994868, train_metric nan, valid_metric 0.052811
[852895:MainThread](2024-04-06 20:00:20,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996598 to 0.994868, save checkpoint.
[852895:MainThread](2024-04-06 20:00:20,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.998109, valid_loss 0.999399, train_metric nan, valid_metric 0.040019
[852895:MainThread](2024-04-06 20:00:20,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.985377, valid_loss 0.997621, train_metric nan, valid_metric 0.047624
[852895:MainThread](2024-04-06 20:00:21,214) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.988355, valid_loss 0.999783, train_metric nan, valid_metric 0.034200
[852895:MainThread](2024-04-06 20:00:21,483) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.001117, valid_loss 0.995657, train_metric nan, valid_metric 0.055180
[852895:MainThread](2024-04-06 20:00:21,842) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.999146, valid_loss 0.996911, train_metric nan, valid_metric 0.044050
[852895:MainThread](2024-04-06 20:00:22,170) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.993904, valid_loss 0.999131, train_metric nan, valid_metric 0.032368
[852895:MainThread](2024-04-06 20:00:22,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.983221, valid_loss 0.995428, train_metric nan, valid_metric 0.052769
[852895:MainThread](2024-04-06 20:00:22,746) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.993358, valid_loss 1.002586, train_metric nan, valid_metric 0.033901
[852895:MainThread](2024-04-06 20:00:22,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.981336, valid_loss 0.995752, train_metric nan, valid_metric 0.042988
[852895:MainThread](2024-04-06 20:00:23,223) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.990420, valid_loss 0.997500, train_metric nan, valid_metric 0.038183
[852895:MainThread](2024-04-06 20:00:23,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.982785, valid_loss 1.000263, train_metric nan, valid_metric 0.037153
[852895:MainThread](2024-04-06 20:00:24,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.982630, valid_loss 0.996573, train_metric nan, valid_metric 0.045025
[852895:MainThread](2024-04-06 20:00:24,603) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.993065, valid_loss 0.998082, train_metric nan, valid_metric 0.041539
[852895:MainThread](2024-04-06 20:00:24,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.982572, valid_loss 0.997044, train_metric nan, valid_metric 0.044148
[852895:MainThread](2024-04-06 20:00:25,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.984355, valid_loss 0.997932, train_metric nan, valid_metric 0.032713
[852895:MainThread](2024-04-06 20:00:25,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.993208, valid_loss 0.998576, train_metric nan, valid_metric 0.033359
[852895:MainThread](2024-04-06 20:00:26,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.992573, valid_loss 0.997145, train_metric nan, valid_metric 0.041266
[852895:MainThread](2024-04-06 20:00:26,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.994961, valid_loss 0.996234, train_metric nan, valid_metric 0.036279
[852895:MainThread](2024-04-06 20:00:26,760) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.994442, valid_loss 0.997948, train_metric nan, valid_metric 0.032348
[852895:MainThread](2024-04-06 20:00:27,066) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.983863, valid_loss 0.997841, train_metric nan, valid_metric 0.035996
[852895:MainThread](2024-04-06 20:00:27,374) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.992523, valid_loss 0.997996, train_metric nan, valid_metric 0.039114
[852895:MainThread](2024-04-06 20:00:27,739) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.986685, valid_loss 1.003063, train_metric nan, valid_metric 0.040941
[852895:MainThread](2024-04-06 20:00:28,059) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.979747, valid_loss 0.997260, train_metric nan, valid_metric 0.037575
[852895:MainThread](2024-04-06 20:00:28,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.000623, valid_loss 0.997889, train_metric nan, valid_metric 0.034655
[852895:MainThread](2024-04-06 20:00:28,733) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.985437, valid_loss 0.997666, train_metric nan, valid_metric 0.041260
[852895:MainThread](2024-04-06 20:00:29,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.983965, valid_loss 0.997561, train_metric nan, valid_metric 0.040078
[852895:MainThread](2024-04-06 20:00:29,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.985920, valid_loss 0.996722, train_metric nan, valid_metric 0.039912
[852895:MainThread](2024-04-06 20:00:29,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.979382, valid_loss 0.996863, train_metric nan, valid_metric 0.043690
[852895:MainThread](2024-04-06 20:00:29,910) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.987013, valid_loss 0.996825, train_metric nan, valid_metric 0.046203
[852895:MainThread](2024-04-06 20:00:30,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.997049, valid_loss 0.997302, train_metric nan, valid_metric 0.039998
[852895:MainThread](2024-04-06 20:00:30,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.986212, valid_loss 0.996488, train_metric nan, valid_metric 0.040979
[852895:MainThread](2024-04-06 20:00:30,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.987096, valid_loss 0.997778, train_metric nan, valid_metric 0.037873
[852895:MainThread](2024-04-06 20:00:30,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.989281, valid_loss 0.997620, train_metric nan, valid_metric 0.036782
[852895:MainThread](2024-04-06 20:00:31,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.996740, valid_loss 0.996870, train_metric nan, valid_metric 0.038803
[852895:MainThread](2024-04-06 20:00:31,352) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.978007, valid_loss 0.997472, train_metric nan, valid_metric 0.037346
[852895:MainThread](2024-04-06 20:00:31,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.983120, valid_loss 0.998830, train_metric nan, valid_metric 0.034926
[852895:MainThread](2024-04-06 20:00:31,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.983067, valid_loss 0.997876, train_metric nan, valid_metric 0.037202
[852895:MainThread](2024-04-06 20:00:32,031) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.988137, valid_loss 0.997720, train_metric nan, valid_metric 0.038034
[852895:MainThread](2024-04-06 20:00:32,296) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.988647, valid_loss 0.996833, train_metric nan, valid_metric 0.043824
[852895:MainThread](2024-04-06 20:00:32,586) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.985023, valid_loss 0.997365, train_metric nan, valid_metric 0.040818
[852895:MainThread](2024-04-06 20:00:32,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.983097, valid_loss 0.997537, train_metric nan, valid_metric 0.037656
[852895:MainThread](2024-04-06 20:00:33,126) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.988553, valid_loss 0.996701, train_metric nan, valid_metric 0.042284
[852895:MainThread](2024-04-06 20:00:33,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.983150, valid_loss 0.996046, train_metric nan, valid_metric 0.038907
[852895:MainThread](2024-04-06 20:00:33,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.982462, valid_loss 0.997408, train_metric nan, valid_metric 0.038501
[852895:MainThread](2024-04-06 20:00:33,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.987561, valid_loss 0.997511, train_metric nan, valid_metric 0.032530
[852895:MainThread](2024-04-06 20:00:34,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.984930, valid_loss 0.998534, train_metric nan, valid_metric 0.038313
[852895:MainThread](2024-04-06 20:00:34,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.982695, valid_loss 0.998058, train_metric nan, valid_metric 0.037527
[852895:MainThread](2024-04-06 20:00:34,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.990814, valid_loss 0.997636, train_metric nan, valid_metric 0.036787
[852895:MainThread](2024-04-06 20:00:34,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.979109, valid_loss 0.997520, train_metric nan, valid_metric 0.038411
[852895:MainThread](2024-04-06 20:00:35,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.985456, valid_loss 0.997213, train_metric nan, valid_metric 0.038450
[852895:MainThread](2024-04-06 20:00:35,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 20:00:36,209) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 20:00:37,879) INFO - qlib.timer - [log.py:127] - Time cost: 0.004s | waiting `async_log` Done
train tasks:  64%|██████▍   | 16/25 [13:36<07:16, 48.54s/it][852895:MainThread](2024-04-06 20:00:37,930) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 20:00:37,989) INFO - qlib.workflow - [recorder.py:341] - Recorder 9cb9b9bc85cc47388fee2c4695f26856 starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 20:00:39,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 20:00:39,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 20:00:39,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 20:00:39,440) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 20:00:46,065) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 20:00:46,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.189994, valid_loss 1.045774, train_metric nan, valid_metric 0.026598
[852895:MainThread](2024-04-06 20:00:46,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.045774, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 20:00:46,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.075634, valid_loss 1.034492, train_metric nan, valid_metric 0.003888
[852895:MainThread](2024-04-06 20:00:46,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.045774 to 1.034492, save checkpoint.
[852895:MainThread](2024-04-06 20:00:47,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.048305, valid_loss 1.010949, train_metric nan, valid_metric 0.021864
[852895:MainThread](2024-04-06 20:00:47,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.034492 to 1.010949, save checkpoint.
[852895:MainThread](2024-04-06 20:00:47,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.026140, valid_loss 1.013804, train_metric nan, valid_metric 0.030010
[852895:MainThread](2024-04-06 20:00:47,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.030011, valid_loss 1.008490, train_metric nan, valid_metric 0.034766
[852895:MainThread](2024-04-06 20:00:47,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.010949 to 1.008490, save checkpoint.
[852895:MainThread](2024-04-06 20:00:47,594) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.019551, valid_loss 1.005253, train_metric nan, valid_metric 0.036059
[852895:MainThread](2024-04-06 20:00:47,594) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.008490 to 1.005253, save checkpoint.
[852895:MainThread](2024-04-06 20:00:47,810) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.008400, valid_loss 1.003247, train_metric nan, valid_metric 0.028432
[852895:MainThread](2024-04-06 20:00:47,810) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.005253 to 1.003247, save checkpoint.
[852895:MainThread](2024-04-06 20:00:48,018) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 0.996116, valid_loss 1.001338, train_metric nan, valid_metric 0.031319
[852895:MainThread](2024-04-06 20:00:48,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003247 to 1.001338, save checkpoint.
[852895:MainThread](2024-04-06 20:00:48,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.004621, valid_loss 1.001412, train_metric nan, valid_metric 0.052638
[852895:MainThread](2024-04-06 20:00:48,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.004731, valid_loss 0.995376, train_metric nan, valid_metric 0.050673
[852895:MainThread](2024-04-06 20:00:48,359) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001338 to 0.995376, save checkpoint.
[852895:MainThread](2024-04-06 20:00:48,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.044389, valid_loss 1.027672, train_metric nan, valid_metric 0.023329
[852895:MainThread](2024-04-06 20:00:48,676) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 0.999903, valid_loss 0.996304, train_metric nan, valid_metric 0.044586
[852895:MainThread](2024-04-06 20:00:48,839) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.001208, valid_loss 0.999033, train_metric nan, valid_metric 0.040840
[852895:MainThread](2024-04-06 20:00:49,047) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.000965, valid_loss 1.013751, train_metric nan, valid_metric 0.041283
[852895:MainThread](2024-04-06 20:00:49,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.994652, valid_loss 1.002901, train_metric nan, valid_metric 0.018422
[852895:MainThread](2024-04-06 20:00:49,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.990472, valid_loss 0.997132, train_metric nan, valid_metric 0.038882
[852895:MainThread](2024-04-06 20:00:49,677) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.979606, valid_loss 0.998401, train_metric nan, valid_metric 0.041169
[852895:MainThread](2024-04-06 20:00:49,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.992474, valid_loss 0.996870, train_metric nan, valid_metric 0.043447
[852895:MainThread](2024-04-06 20:00:50,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.992375, valid_loss 0.998602, train_metric nan, valid_metric 0.031498
[852895:MainThread](2024-04-06 20:00:50,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.999237, valid_loss 0.999605, train_metric nan, valid_metric 0.042182
[852895:MainThread](2024-04-06 20:00:50,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.988717, valid_loss 0.998697, train_metric nan, valid_metric 0.038688
[852895:MainThread](2024-04-06 20:00:51,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.979942, valid_loss 0.996617, train_metric nan, valid_metric 0.036213
[852895:MainThread](2024-04-06 20:00:51,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.994756, valid_loss 0.997232, train_metric nan, valid_metric 0.041465
[852895:MainThread](2024-04-06 20:00:51,646) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.993854, valid_loss 0.998004, train_metric nan, valid_metric 0.030551
[852895:MainThread](2024-04-06 20:00:52,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.998779, valid_loss 0.995999, train_metric nan, valid_metric 0.041619
[852895:MainThread](2024-04-06 20:00:52,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.978977, valid_loss 0.996350, train_metric nan, valid_metric 0.039265
[852895:MainThread](2024-04-06 20:00:52,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.984284, valid_loss 0.996088, train_metric nan, valid_metric 0.039792
[852895:MainThread](2024-04-06 20:00:53,089) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.998239, valid_loss 0.995655, train_metric nan, valid_metric 0.043602
[852895:MainThread](2024-04-06 20:00:53,383) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.001425, valid_loss 0.996655, train_metric nan, valid_metric 0.038154
[852895:MainThread](2024-04-06 20:00:53,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.990667, valid_loss 0.996469, train_metric nan, valid_metric 0.044468
[852895:MainThread](2024-04-06 20:00:53,830) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.991258, valid_loss 0.995518, train_metric nan, valid_metric 0.046344
[852895:MainThread](2024-04-06 20:00:54,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.986848, valid_loss 0.996581, train_metric nan, valid_metric 0.040995
[852895:MainThread](2024-04-06 20:00:54,287) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.990605, valid_loss 0.997833, train_metric nan, valid_metric 0.042275
[852895:MainThread](2024-04-06 20:00:54,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.988594, valid_loss 0.996514, train_metric nan, valid_metric 0.040237
[852895:MainThread](2024-04-06 20:00:54,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.991366, valid_loss 0.996972, train_metric nan, valid_metric 0.038175
[852895:MainThread](2024-04-06 20:00:55,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.987276, valid_loss 0.996836, train_metric nan, valid_metric 0.042123
[852895:MainThread](2024-04-06 20:00:55,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.995864, valid_loss 0.995305, train_metric nan, valid_metric 0.042801
[852895:MainThread](2024-04-06 20:00:55,366) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995376 to 0.995305, save checkpoint.
[852895:MainThread](2024-04-06 20:00:55,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.991920, valid_loss 0.996332, train_metric nan, valid_metric 0.041259
[852895:MainThread](2024-04-06 20:00:55,955) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.983872, valid_loss 0.996285, train_metric nan, valid_metric 0.043360
[852895:MainThread](2024-04-06 20:00:56,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.991473, valid_loss 0.997168, train_metric nan, valid_metric 0.035583
[852895:MainThread](2024-04-06 20:00:56,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.983996, valid_loss 0.995806, train_metric nan, valid_metric 0.037804
[852895:MainThread](2024-04-06 20:00:56,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.989832, valid_loss 0.997729, train_metric nan, valid_metric 0.038781
[852895:MainThread](2024-04-06 20:00:57,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.988753, valid_loss 0.997027, train_metric nan, valid_metric 0.042817
[852895:MainThread](2024-04-06 20:00:57,470) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.984711, valid_loss 0.995951, train_metric nan, valid_metric 0.045712
[852895:MainThread](2024-04-06 20:00:57,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.993847, valid_loss 0.996656, train_metric nan, valid_metric 0.038235
[852895:MainThread](2024-04-06 20:00:58,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.991089, valid_loss 0.996977, train_metric nan, valid_metric 0.038525
[852895:MainThread](2024-04-06 20:00:58,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.986032, valid_loss 0.996190, train_metric nan, valid_metric 0.042581
[852895:MainThread](2024-04-06 20:00:59,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.977558, valid_loss 0.996551, train_metric nan, valid_metric 0.040465
[852895:MainThread](2024-04-06 20:00:59,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.978122, valid_loss 0.997055, train_metric nan, valid_metric 0.038797
[852895:MainThread](2024-04-06 20:01:00,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.981042, valid_loss 0.996458, train_metric nan, valid_metric 0.040946
[852895:MainThread](2024-04-06 20:01:00,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.988359, valid_loss 0.996686, train_metric nan, valid_metric 0.039623
[852895:MainThread](2024-04-06 20:01:00,762) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.980806, valid_loss 0.996629, train_metric nan, valid_metric 0.041148
[852895:MainThread](2024-04-06 20:01:01,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.998099, valid_loss 0.995974, train_metric nan, valid_metric 0.042287
[852895:MainThread](2024-04-06 20:01:01,590) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.978919, valid_loss 0.996086, train_metric nan, valid_metric 0.041924
[852895:MainThread](2024-04-06 20:01:01,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.971674, valid_loss 0.995509, train_metric nan, valid_metric 0.043506
[852895:MainThread](2024-04-06 20:01:02,227) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.986390, valid_loss 0.996634, train_metric nan, valid_metric 0.042701
[852895:MainThread](2024-04-06 20:01:02,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.985254, valid_loss 0.997160, train_metric nan, valid_metric 0.040288
[852895:MainThread](2024-04-06 20:01:02,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.985841, valid_loss 0.996101, train_metric nan, valid_metric 0.043788
[852895:MainThread](2024-04-06 20:01:03,371) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.976528, valid_loss 0.996418, train_metric nan, valid_metric 0.042409
[852895:MainThread](2024-04-06 20:01:03,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.990118, valid_loss 0.995970, train_metric nan, valid_metric 0.042337
[852895:MainThread](2024-04-06 20:01:03,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.974350, valid_loss 0.996489, train_metric nan, valid_metric 0.042236
[852895:MainThread](2024-04-06 20:01:04,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.992115, valid_loss 0.996410, train_metric nan, valid_metric 0.043021
[852895:MainThread](2024-04-06 20:01:04,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.976469, valid_loss 0.996563, train_metric nan, valid_metric 0.040785
[852895:MainThread](2024-04-06 20:01:05,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.982152, valid_loss 0.996286, train_metric nan, valid_metric 0.041224
[852895:MainThread](2024-04-06 20:01:05,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.987958, valid_loss 0.996080, train_metric nan, valid_metric 0.039108
[852895:MainThread](2024-04-06 20:01:05,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.989715, valid_loss 0.996862, train_metric nan, valid_metric 0.038070
[852895:MainThread](2024-04-06 20:01:05,873) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.987359, valid_loss 0.996856, train_metric nan, valid_metric 0.037669
[852895:MainThread](2024-04-06 20:01:06,215) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.981648, valid_loss 0.996679, train_metric nan, valid_metric 0.040435
[852895:MainThread](2024-04-06 20:01:06,536) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.990049, valid_loss 0.996704, train_metric nan, valid_metric 0.041920
[852895:MainThread](2024-04-06 20:01:06,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.992144, valid_loss 0.996725, train_metric nan, valid_metric 0.040757
[852895:MainThread](2024-04-06 20:01:07,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.982718, valid_loss 0.996480, train_metric nan, valid_metric 0.042124
[852895:MainThread](2024-04-06 20:01:07,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.981085, valid_loss 0.996560, train_metric nan, valid_metric 0.039076
[852895:MainThread](2024-04-06 20:01:07,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.982624, valid_loss 0.996563, train_metric nan, valid_metric 0.041051
[852895:MainThread](2024-04-06 20:01:07,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.992612, valid_loss 0.996372, train_metric nan, valid_metric 0.042352
[852895:MainThread](2024-04-06 20:01:08,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.985399, valid_loss 0.996782, train_metric nan, valid_metric 0.041034
[852895:MainThread](2024-04-06 20:01:08,403) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.990852, valid_loss 0.996902, train_metric nan, valid_metric 0.039914
[852895:MainThread](2024-04-06 20:01:08,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.975859, valid_loss 0.996626, train_metric nan, valid_metric 0.041270
[852895:MainThread](2024-04-06 20:01:08,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.981872, valid_loss 0.996345, train_metric nan, valid_metric 0.040858
[852895:MainThread](2024-04-06 20:01:09,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.992865, valid_loss 0.996165, train_metric nan, valid_metric 0.039456
[852895:MainThread](2024-04-06 20:01:09,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.981064, valid_loss 0.996454, train_metric nan, valid_metric 0.040035
[852895:MainThread](2024-04-06 20:01:09,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.981236, valid_loss 0.996379, train_metric nan, valid_metric 0.041913
[852895:MainThread](2024-04-06 20:01:09,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.988765, valid_loss 0.996400, train_metric nan, valid_metric 0.042397
[852895:MainThread](2024-04-06 20:01:10,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.995588, valid_loss 0.996743, train_metric nan, valid_metric 0.041697
[852895:MainThread](2024-04-06 20:01:10,541) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.992531, valid_loss 0.996599, train_metric nan, valid_metric 0.041289
[852895:MainThread](2024-04-06 20:01:10,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.982941, valid_loss 0.996504, train_metric nan, valid_metric 0.037232
[852895:MainThread](2024-04-06 20:01:11,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.985170, valid_loss 0.996722, train_metric nan, valid_metric 0.039166
[852895:MainThread](2024-04-06 20:01:11,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.978102, valid_loss 0.996553, train_metric nan, valid_metric 0.041802
[852895:MainThread](2024-04-06 20:01:11,336) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 20:01:12,470) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 20:01:13,720) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  68%|██████▊   | 17/25 [14:12<05:57, 44.72s/it][852895:MainThread](2024-04-06 20:01:13,736) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 20:01:13,759) INFO - qlib.workflow - [recorder.py:341] - Recorder 5e36ad034629469c87154f95806b229e starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 20:01:14,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 20:01:14,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 20:01:14,661) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 20:01:14,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 20:01:20,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 20:01:21,064) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.327101, valid_loss 1.161384, train_metric nan, valid_metric -0.002551
[852895:MainThread](2024-04-06 20:01:21,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.161384, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 20:01:21,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.116281, valid_loss 1.043760, train_metric nan, valid_metric 0.031208
[852895:MainThread](2024-04-06 20:01:21,507) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.161384 to 1.043760, save checkpoint.
[852895:MainThread](2024-04-06 20:01:21,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.063904, valid_loss 1.016426, train_metric nan, valid_metric 0.037480
[852895:MainThread](2024-04-06 20:01:21,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.043760 to 1.016426, save checkpoint.
[852895:MainThread](2024-04-06 20:01:22,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.063512, valid_loss 1.110199, train_metric nan, valid_metric 0.007277
[852895:MainThread](2024-04-06 20:01:22,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.094673, valid_loss 1.053282, train_metric nan, valid_metric 0.008426
[852895:MainThread](2024-04-06 20:01:22,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.064870, valid_loss 1.017801, train_metric nan, valid_metric 0.044729
[852895:MainThread](2024-04-06 20:01:23,031) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.024869, valid_loss 1.016069, train_metric nan, valid_metric 0.038943
[852895:MainThread](2024-04-06 20:01:23,035) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.016426 to 1.016069, save checkpoint.
[852895:MainThread](2024-04-06 20:01:23,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.037263, valid_loss 1.005266, train_metric nan, valid_metric 0.030851
[852895:MainThread](2024-04-06 20:01:23,305) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.016069 to 1.005266, save checkpoint.
[852895:MainThread](2024-04-06 20:01:23,631) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.007442, valid_loss 1.010010, train_metric nan, valid_metric 0.049965
[852895:MainThread](2024-04-06 20:01:23,926) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.024843, valid_loss 1.014621, train_metric nan, valid_metric 0.037070
[852895:MainThread](2024-04-06 20:01:24,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.006120, valid_loss 1.001775, train_metric nan, valid_metric 0.042368
[852895:MainThread](2024-04-06 20:01:24,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.005266 to 1.001775, save checkpoint.
[852895:MainThread](2024-04-06 20:01:24,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.018439, valid_loss 0.999460, train_metric nan, valid_metric 0.045807
[852895:MainThread](2024-04-06 20:01:24,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001775 to 0.999460, save checkpoint.
[852895:MainThread](2024-04-06 20:01:24,942) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.003002, valid_loss 1.002162, train_metric nan, valid_metric 0.044873
[852895:MainThread](2024-04-06 20:01:25,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.000828, valid_loss 1.003744, train_metric nan, valid_metric 0.032771
[852895:MainThread](2024-04-06 20:01:25,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.013105, valid_loss 0.998641, train_metric nan, valid_metric 0.039834
[852895:MainThread](2024-04-06 20:01:25,470) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999460 to 0.998641, save checkpoint.
[852895:MainThread](2024-04-06 20:01:25,709) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.004662, valid_loss 0.997419, train_metric nan, valid_metric 0.037537
[852895:MainThread](2024-04-06 20:01:25,716) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998641 to 0.997419, save checkpoint.
[852895:MainThread](2024-04-06 20:01:25,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.013381, valid_loss 1.006763, train_metric nan, valid_metric 0.033472
[852895:MainThread](2024-04-06 20:01:26,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.010147, valid_loss 1.009031, train_metric nan, valid_metric 0.044031
[852895:MainThread](2024-04-06 20:01:26,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.005716, valid_loss 0.996620, train_metric nan, valid_metric 0.043477
[852895:MainThread](2024-04-06 20:01:26,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997419 to 0.996620, save checkpoint.
[852895:MainThread](2024-04-06 20:01:26,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.998032, valid_loss 0.995537, train_metric nan, valid_metric 0.047214
[852895:MainThread](2024-04-06 20:01:26,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996620 to 0.995537, save checkpoint.
[852895:MainThread](2024-04-06 20:01:27,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.996762, valid_loss 1.000996, train_metric nan, valid_metric 0.059057
[852895:MainThread](2024-04-06 20:01:27,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.995557, valid_loss 0.995451, train_metric nan, valid_metric 0.050552
[852895:MainThread](2024-04-06 20:01:27,309) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995537 to 0.995451, save checkpoint.
[852895:MainThread](2024-04-06 20:01:27,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.009357, valid_loss 1.001268, train_metric nan, valid_metric 0.036183
[852895:MainThread](2024-04-06 20:01:27,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.995806, valid_loss 0.999528, train_metric nan, valid_metric 0.032481
[852895:MainThread](2024-04-06 20:01:28,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.989621, valid_loss 0.995726, train_metric nan, valid_metric 0.049657
[852895:MainThread](2024-04-06 20:01:28,289) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.991944, valid_loss 0.997493, train_metric nan, valid_metric 0.045342
[852895:MainThread](2024-04-06 20:01:28,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.000305, valid_loss 1.001857, train_metric nan, valid_metric 0.038382
[852895:MainThread](2024-04-06 20:01:28,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.987889, valid_loss 0.999587, train_metric nan, valid_metric 0.034556
[852895:MainThread](2024-04-06 20:01:29,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.998775, valid_loss 0.997089, train_metric nan, valid_metric 0.040659
[852895:MainThread](2024-04-06 20:01:29,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.992998, valid_loss 0.994729, train_metric nan, valid_metric 0.051549
[852895:MainThread](2024-04-06 20:01:29,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995451 to 0.994729, save checkpoint.
[852895:MainThread](2024-04-06 20:01:29,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.993252, valid_loss 0.995782, train_metric nan, valid_metric 0.047105
[852895:MainThread](2024-04-06 20:01:30,015) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.990613, valid_loss 0.998592, train_metric nan, valid_metric 0.041001
[852895:MainThread](2024-04-06 20:01:30,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.988501, valid_loss 0.995221, train_metric nan, valid_metric 0.051622
[852895:MainThread](2024-04-06 20:01:30,626) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.996448, valid_loss 0.995305, train_metric nan, valid_metric 0.048111
[852895:MainThread](2024-04-06 20:01:30,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.996067, valid_loss 0.997695, train_metric nan, valid_metric 0.041081
[852895:MainThread](2024-04-06 20:01:31,255) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.986385, valid_loss 0.994975, train_metric nan, valid_metric 0.051282
[852895:MainThread](2024-04-06 20:01:31,796) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.982376, valid_loss 0.996499, train_metric nan, valid_metric 0.050311
[852895:MainThread](2024-04-06 20:01:32,013) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.978521, valid_loss 0.993971, train_metric nan, valid_metric 0.055007
[852895:MainThread](2024-04-06 20:01:32,018) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994729 to 0.993971, save checkpoint.
[852895:MainThread](2024-04-06 20:01:32,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.990285, valid_loss 0.994361, train_metric nan, valid_metric 0.056939
[852895:MainThread](2024-04-06 20:01:32,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.990913, valid_loss 0.994371, train_metric nan, valid_metric 0.051301
[852895:MainThread](2024-04-06 20:01:32,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.993237, valid_loss 0.995418, train_metric nan, valid_metric 0.049225
[852895:MainThread](2024-04-06 20:01:32,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.994592, valid_loss 0.996105, train_metric nan, valid_metric 0.050503
[852895:MainThread](2024-04-06 20:01:33,215) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.984090, valid_loss 0.997842, train_metric nan, valid_metric 0.043852
[852895:MainThread](2024-04-06 20:01:33,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.979730, valid_loss 0.994118, train_metric nan, valid_metric 0.054408
[852895:MainThread](2024-04-06 20:01:33,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.975749, valid_loss 0.995723, train_metric nan, valid_metric 0.057074
[852895:MainThread](2024-04-06 20:01:34,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.990177, valid_loss 0.995741, train_metric nan, valid_metric 0.046764
[852895:MainThread](2024-04-06 20:01:34,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.983606, valid_loss 0.998234, train_metric nan, valid_metric 0.044502
[852895:MainThread](2024-04-06 20:01:34,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.986379, valid_loss 0.996221, train_metric nan, valid_metric 0.043489
[852895:MainThread](2024-04-06 20:01:35,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.992886, valid_loss 0.994113, train_metric nan, valid_metric 0.053370
[852895:MainThread](2024-04-06 20:01:35,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.985051, valid_loss 0.997363, train_metric nan, valid_metric 0.039541
[852895:MainThread](2024-04-06 20:01:35,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.992186, valid_loss 0.997375, train_metric nan, valid_metric 0.045435
[852895:MainThread](2024-04-06 20:01:35,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.978647, valid_loss 0.995103, train_metric nan, valid_metric 0.050066
[852895:MainThread](2024-04-06 20:01:36,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.985404, valid_loss 0.995362, train_metric nan, valid_metric 0.048563
[852895:MainThread](2024-04-06 20:01:36,633) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.985055, valid_loss 0.995242, train_metric nan, valid_metric 0.048744
[852895:MainThread](2024-04-06 20:01:37,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.988371, valid_loss 0.995140, train_metric nan, valid_metric 0.046996
[852895:MainThread](2024-04-06 20:01:37,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.981107, valid_loss 0.996021, train_metric nan, valid_metric 0.039815
[852895:MainThread](2024-04-06 20:01:37,690) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.991874, valid_loss 0.998657, train_metric nan, valid_metric 0.040526
[852895:MainThread](2024-04-06 20:01:38,187) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.986935, valid_loss 0.997544, train_metric nan, valid_metric 0.040182
[852895:MainThread](2024-04-06 20:01:38,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.992309, valid_loss 0.997522, train_metric nan, valid_metric 0.051448
[852895:MainThread](2024-04-06 20:01:38,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.998492, valid_loss 0.994255, train_metric nan, valid_metric 0.050516
[852895:MainThread](2024-04-06 20:01:39,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.990756, valid_loss 0.995011, train_metric nan, valid_metric 0.047482
[852895:MainThread](2024-04-06 20:01:39,577) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.991932, valid_loss 0.994867, train_metric nan, valid_metric 0.052739
[852895:MainThread](2024-04-06 20:01:39,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.983519, valid_loss 0.995286, train_metric nan, valid_metric 0.055155
[852895:MainThread](2024-04-06 20:01:40,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.992944, valid_loss 0.995008, train_metric nan, valid_metric 0.050255
[852895:MainThread](2024-04-06 20:01:40,340) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.976717, valid_loss 0.996722, train_metric nan, valid_metric 0.045231
[852895:MainThread](2024-04-06 20:01:40,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.984450, valid_loss 0.995262, train_metric nan, valid_metric 0.042487
[852895:MainThread](2024-04-06 20:01:40,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.993787, valid_loss 0.996214, train_metric nan, valid_metric 0.046526
[852895:MainThread](2024-04-06 20:01:41,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.983505, valid_loss 0.997394, train_metric nan, valid_metric 0.035700
[852895:MainThread](2024-04-06 20:01:41,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.979698, valid_loss 0.998124, train_metric nan, valid_metric 0.042969
[852895:MainThread](2024-04-06 20:01:41,882) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.979435, valid_loss 0.995197, train_metric nan, valid_metric 0.048849
[852895:MainThread](2024-04-06 20:01:42,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.987938, valid_loss 0.996054, train_metric nan, valid_metric 0.046457
[852895:MainThread](2024-04-06 20:01:42,492) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.985513, valid_loss 0.996131, train_metric nan, valid_metric 0.047950
[852895:MainThread](2024-04-06 20:01:42,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.995586, valid_loss 0.993857, train_metric nan, valid_metric 0.054357
[852895:MainThread](2024-04-06 20:01:42,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993971 to 0.993857, save checkpoint.
[852895:MainThread](2024-04-06 20:01:43,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.988433, valid_loss 0.995327, train_metric nan, valid_metric 0.048393
[852895:MainThread](2024-04-06 20:01:43,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.993196, valid_loss 0.995565, train_metric nan, valid_metric 0.047275
[852895:MainThread](2024-04-06 20:01:43,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.987512, valid_loss 0.995756, train_metric nan, valid_metric 0.046017
[852895:MainThread](2024-04-06 20:01:44,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.988198, valid_loss 0.996018, train_metric nan, valid_metric 0.045950
[852895:MainThread](2024-04-06 20:01:44,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.991708, valid_loss 0.996005, train_metric nan, valid_metric 0.044048
[852895:MainThread](2024-04-06 20:01:44,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.981185, valid_loss 0.996297, train_metric nan, valid_metric 0.041594
[852895:MainThread](2024-04-06 20:01:44,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.984578, valid_loss 0.996720, train_metric nan, valid_metric 0.045690
[852895:MainThread](2024-04-06 20:01:45,204) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.989005, valid_loss 0.994288, train_metric nan, valid_metric 0.053629
[852895:MainThread](2024-04-06 20:01:45,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.993285, valid_loss 0.996305, train_metric nan, valid_metric 0.046140
[852895:MainThread](2024-04-06 20:01:45,641) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.991982, valid_loss 0.996984, train_metric nan, valid_metric 0.044502
[852895:MainThread](2024-04-06 20:01:45,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.992096, valid_loss 0.995888, train_metric nan, valid_metric 0.046607
[852895:MainThread](2024-04-06 20:01:46,310) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.976709, valid_loss 0.995852, train_metric nan, valid_metric 0.047068
[852895:MainThread](2024-04-06 20:01:46,590) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.977929, valid_loss 0.994745, train_metric nan, valid_metric 0.048357
[852895:MainThread](2024-04-06 20:01:46,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.978332, valid_loss 0.994945, train_metric nan, valid_metric 0.046761
[852895:MainThread](2024-04-06 20:01:47,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.989758, valid_loss 0.995811, train_metric nan, valid_metric 0.043775
[852895:MainThread](2024-04-06 20:01:47,204) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.988345, valid_loss 0.994529, train_metric nan, valid_metric 0.051357
[852895:MainThread](2024-04-06 20:01:47,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.993077, valid_loss 0.995130, train_metric nan, valid_metric 0.049428
[852895:MainThread](2024-04-06 20:01:47,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.993544, valid_loss 0.996305, train_metric nan, valid_metric 0.047595
[852895:MainThread](2024-04-06 20:01:47,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.972733, valid_loss 0.995941, train_metric nan, valid_metric 0.047384
[852895:MainThread](2024-04-06 20:01:48,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.983332, valid_loss 0.996355, train_metric nan, valid_metric 0.043708
[852895:MainThread](2024-04-06 20:01:48,571) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.983644, valid_loss 0.996410, train_metric nan, valid_metric 0.042227
[852895:MainThread](2024-04-06 20:01:49,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.986102, valid_loss 0.995380, train_metric nan, valid_metric 0.051861
[852895:MainThread](2024-04-06 20:01:49,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.979305, valid_loss 0.995717, train_metric nan, valid_metric 0.047018
[852895:MainThread](2024-04-06 20:01:49,810) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.988190, valid_loss 0.996768, train_metric nan, valid_metric 0.042596
[852895:MainThread](2024-04-06 20:01:50,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.985110, valid_loss 0.996626, train_metric nan, valid_metric 0.043707
[852895:MainThread](2024-04-06 20:01:50,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.980638, valid_loss 0.995439, train_metric nan, valid_metric 0.047971
[852895:MainThread](2024-04-06 20:01:50,624) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.993862, valid_loss 0.996455, train_metric nan, valid_metric 0.044654
[852895:MainThread](2024-04-06 20:01:50,907) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.979358, valid_loss 0.996395, train_metric nan, valid_metric 0.045367
[852895:MainThread](2024-04-06 20:01:51,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.979378, valid_loss 0.993928, train_metric nan, valid_metric 0.053305
[852895:MainThread](2024-04-06 20:01:51,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.983972, valid_loss 0.995501, train_metric nan, valid_metric 0.047045
[852895:MainThread](2024-04-06 20:01:51,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.984548, valid_loss 0.996044, train_metric nan, valid_metric 0.045762
[852895:MainThread](2024-04-06 20:01:52,140) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.987738, valid_loss 0.995863, train_metric nan, valid_metric 0.047264
[852895:MainThread](2024-04-06 20:01:52,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 0.990062, valid_loss 0.996153, train_metric nan, valid_metric 0.046166
[852895:MainThread](2024-04-06 20:01:52,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.991967, valid_loss 0.995228, train_metric nan, valid_metric 0.047782
[852895:MainThread](2024-04-06 20:01:53,037) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 0.997179, valid_loss 0.996034, train_metric nan, valid_metric 0.046859
[852895:MainThread](2024-04-06 20:01:53,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 0.983947, valid_loss 0.996028, train_metric nan, valid_metric 0.046843
[852895:MainThread](2024-04-06 20:01:53,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 0.992827, valid_loss 0.995050, train_metric nan, valid_metric 0.050486
[852895:MainThread](2024-04-06 20:01:53,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 0.977916, valid_loss 0.995898, train_metric nan, valid_metric 0.044620
[852895:MainThread](2024-04-06 20:01:54,062) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 0.988129, valid_loss 0.995824, train_metric nan, valid_metric 0.047020
[852895:MainThread](2024-04-06 20:01:54,327) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 0.983251, valid_loss 0.994102, train_metric nan, valid_metric 0.053013
[852895:MainThread](2024-04-06 20:01:54,673) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 0.992843, valid_loss 0.995824, train_metric nan, valid_metric 0.044697
[852895:MainThread](2024-04-06 20:01:55,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 0.982159, valid_loss 0.996296, train_metric nan, valid_metric 0.044978
[852895:MainThread](2024-04-06 20:01:55,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 0.987964, valid_loss 0.996576, train_metric nan, valid_metric 0.044285
[852895:MainThread](2024-04-06 20:01:56,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 0.972849, valid_loss 0.996493, train_metric nan, valid_metric 0.044442
[852895:MainThread](2024-04-06 20:01:56,565) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 0.990800, valid_loss 0.996468, train_metric nan, valid_metric 0.044059
[852895:MainThread](2024-04-06 20:01:56,984) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 0.990947, valid_loss 0.995782, train_metric nan, valid_metric 0.043877
[852895:MainThread](2024-04-06 20:01:57,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 0.983958, valid_loss 0.996101, train_metric nan, valid_metric 0.045137
[852895:MainThread](2024-04-06 20:01:57,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 0.995228, valid_loss 0.996039, train_metric nan, valid_metric 0.047001
[852895:MainThread](2024-04-06 20:01:58,125) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 0.995046, valid_loss 0.995285, train_metric nan, valid_metric 0.047430
[852895:MainThread](2024-04-06 20:01:58,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 0.978173, valid_loss 0.995980, train_metric nan, valid_metric 0.046374
[852895:MainThread](2024-04-06 20:01:58,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 20:02:00,553) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 20:02:01,947) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  72%|███████▏  | 18/25 [15:00<05:20, 45.78s/it][852895:MainThread](2024-04-06 20:02:01,967) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 20:02:01,991) INFO - qlib.workflow - [recorder.py:341] - Recorder 3f6353a0924d4ee4b50e3c42e6b492b4 starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 20:02:03,304) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 20:02:03,305) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 20:02:03,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 20:02:03,309) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 20:02:07,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 20:02:08,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.372862, valid_loss 1.053741, train_metric nan, valid_metric -0.006271
[852895:MainThread](2024-04-06 20:02:08,356) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.053741, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 20:02:08,578) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.133559, valid_loss 1.056447, train_metric nan, valid_metric 0.017176
[852895:MainThread](2024-04-06 20:02:08,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.106071, valid_loss 1.090339, train_metric nan, valid_metric 0.034645
[852895:MainThread](2024-04-06 20:02:09,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.085075, valid_loss 1.017446, train_metric nan, valid_metric 0.024791
[852895:MainThread](2024-04-06 20:02:09,148) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.053741 to 1.017446, save checkpoint.
[852895:MainThread](2024-04-06 20:02:09,551) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.058442, valid_loss 1.009551, train_metric nan, valid_metric 0.033112
[852895:MainThread](2024-04-06 20:02:09,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.017446 to 1.009551, save checkpoint.
[852895:MainThread](2024-04-06 20:02:09,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.037642, valid_loss 1.007525, train_metric nan, valid_metric 0.036190
[852895:MainThread](2024-04-06 20:02:09,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.009551 to 1.007525, save checkpoint.
[852895:MainThread](2024-04-06 20:02:10,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.044410, valid_loss 1.006975, train_metric nan, valid_metric 0.029558
[852895:MainThread](2024-04-06 20:02:10,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.007525 to 1.006975, save checkpoint.
[852895:MainThread](2024-04-06 20:02:10,598) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.039350, valid_loss 1.005273, train_metric nan, valid_metric 0.036616
[852895:MainThread](2024-04-06 20:02:10,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006975 to 1.005273, save checkpoint.
[852895:MainThread](2024-04-06 20:02:10,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.066464, valid_loss 1.030834, train_metric nan, valid_metric 0.033971
[852895:MainThread](2024-04-06 20:02:11,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.037609, valid_loss 1.008726, train_metric nan, valid_metric 0.041422
[852895:MainThread](2024-04-06 20:02:11,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.075004, valid_loss 1.070785, train_metric nan, valid_metric 0.037528
[852895:MainThread](2024-04-06 20:02:11,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.037363, valid_loss 1.006733, train_metric nan, valid_metric 0.041717
[852895:MainThread](2024-04-06 20:02:12,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.015676, valid_loss 1.001506, train_metric nan, valid_metric 0.053031
[852895:MainThread](2024-04-06 20:02:12,183) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.005273 to 1.001506, save checkpoint.
[852895:MainThread](2024-04-06 20:02:12,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.016073, valid_loss 1.001018, train_metric nan, valid_metric 0.029607
[852895:MainThread](2024-04-06 20:02:12,453) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001506 to 1.001018, save checkpoint.
[852895:MainThread](2024-04-06 20:02:13,047) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.033636, valid_loss 0.998210, train_metric nan, valid_metric 0.033929
[852895:MainThread](2024-04-06 20:02:13,047) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001018 to 0.998210, save checkpoint.
[852895:MainThread](2024-04-06 20:02:13,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.014623, valid_loss 1.022022, train_metric nan, valid_metric 0.032765
[852895:MainThread](2024-04-06 20:02:13,635) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.998503, valid_loss 1.003570, train_metric nan, valid_metric 0.026553
[852895:MainThread](2024-04-06 20:02:14,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.016721, valid_loss 1.010506, train_metric nan, valid_metric 0.052126
[852895:MainThread](2024-04-06 20:02:14,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.004499, valid_loss 0.999494, train_metric nan, valid_metric 0.054787
[852895:MainThread](2024-04-06 20:02:14,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.002214, valid_loss 1.012025, train_metric nan, valid_metric 0.051940
[852895:MainThread](2024-04-06 20:02:14,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.011396, valid_loss 0.998951, train_metric nan, valid_metric 0.036044
[852895:MainThread](2024-04-06 20:02:14,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.009721, valid_loss 1.000528, train_metric nan, valid_metric 0.028600
[852895:MainThread](2024-04-06 20:02:15,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.026122, valid_loss 0.998680, train_metric nan, valid_metric 0.030942
[852895:MainThread](2024-04-06 20:02:15,666) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.023889, valid_loss 1.001642, train_metric nan, valid_metric 0.034925
[852895:MainThread](2024-04-06 20:02:15,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.996323, valid_loss 1.007994, train_metric nan, valid_metric 0.036503
[852895:MainThread](2024-04-06 20:02:16,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.002496, valid_loss 1.000222, train_metric nan, valid_metric 0.049708
[852895:MainThread](2024-04-06 20:02:16,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.011814, valid_loss 1.000513, train_metric nan, valid_metric 0.048520
[852895:MainThread](2024-04-06 20:02:16,850) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.998873, valid_loss 0.995699, train_metric nan, valid_metric 0.044865
[852895:MainThread](2024-04-06 20:02:16,856) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998210 to 0.995699, save checkpoint.
[852895:MainThread](2024-04-06 20:02:17,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.986638, valid_loss 0.994687, train_metric nan, valid_metric 0.048581
[852895:MainThread](2024-04-06 20:02:17,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995699 to 0.994687, save checkpoint.
[852895:MainThread](2024-04-06 20:02:17,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.991659, valid_loss 0.996307, train_metric nan, valid_metric 0.042877
[852895:MainThread](2024-04-06 20:02:17,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.990275, valid_loss 0.997688, train_metric nan, valid_metric 0.039550
[852895:MainThread](2024-04-06 20:02:18,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.990219, valid_loss 0.995702, train_metric nan, valid_metric 0.052590
[852895:MainThread](2024-04-06 20:02:18,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.000809, valid_loss 0.997576, train_metric nan, valid_metric 0.042729
[852895:MainThread](2024-04-06 20:02:19,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.987752, valid_loss 0.999475, train_metric nan, valid_metric 0.048655
[852895:MainThread](2024-04-06 20:02:19,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.986903, valid_loss 0.999394, train_metric nan, valid_metric 0.037488
[852895:MainThread](2024-04-06 20:02:20,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.998590, valid_loss 0.995644, train_metric nan, valid_metric 0.044735
[852895:MainThread](2024-04-06 20:02:20,541) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.994751, valid_loss 0.996873, train_metric nan, valid_metric 0.043616
[852895:MainThread](2024-04-06 20:02:20,810) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.986869, valid_loss 0.995320, train_metric nan, valid_metric 0.048621
[852895:MainThread](2024-04-06 20:02:21,089) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.988883, valid_loss 0.997152, train_metric nan, valid_metric 0.042195
[852895:MainThread](2024-04-06 20:02:21,569) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.998258, valid_loss 0.996990, train_metric nan, valid_metric 0.048336
[852895:MainThread](2024-04-06 20:02:22,073) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.994533, valid_loss 0.996473, train_metric nan, valid_metric 0.043008
[852895:MainThread](2024-04-06 20:02:22,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.986987, valid_loss 0.995640, train_metric nan, valid_metric 0.050437
[852895:MainThread](2024-04-06 20:02:22,615) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.993131, valid_loss 0.995628, train_metric nan, valid_metric 0.048079
[852895:MainThread](2024-04-06 20:02:22,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.987363, valid_loss 0.996497, train_metric nan, valid_metric 0.035281
[852895:MainThread](2024-04-06 20:02:23,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.992079, valid_loss 0.996714, train_metric nan, valid_metric 0.043099
[852895:MainThread](2024-04-06 20:02:23,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.981667, valid_loss 0.996734, train_metric nan, valid_metric 0.043479
[852895:MainThread](2024-04-06 20:02:23,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.995903, valid_loss 0.995986, train_metric nan, valid_metric 0.037896
[852895:MainThread](2024-04-06 20:02:24,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.990237, valid_loss 0.996043, train_metric nan, valid_metric 0.045598
[852895:MainThread](2024-04-06 20:02:24,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.999449, valid_loss 0.996073, train_metric nan, valid_metric 0.043382
[852895:MainThread](2024-04-06 20:02:24,818) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.001815, valid_loss 0.996125, train_metric nan, valid_metric 0.043542
[852895:MainThread](2024-04-06 20:02:25,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.994608, valid_loss 0.995660, train_metric nan, valid_metric 0.047789
[852895:MainThread](2024-04-06 20:02:25,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.998184, valid_loss 0.995361, train_metric nan, valid_metric 0.049500
[852895:MainThread](2024-04-06 20:02:25,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.990322, valid_loss 0.995302, train_metric nan, valid_metric 0.045973
[852895:MainThread](2024-04-06 20:02:25,907) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.991255, valid_loss 0.995877, train_metric nan, valid_metric 0.045363
[852895:MainThread](2024-04-06 20:02:26,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.995194, valid_loss 0.995482, train_metric nan, valid_metric 0.044919
[852895:MainThread](2024-04-06 20:02:26,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.990393, valid_loss 0.995587, train_metric nan, valid_metric 0.042368
[852895:MainThread](2024-04-06 20:02:26,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.987365, valid_loss 0.995780, train_metric nan, valid_metric 0.044963
[852895:MainThread](2024-04-06 20:02:27,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.989683, valid_loss 0.994995, train_metric nan, valid_metric 0.049797
[852895:MainThread](2024-04-06 20:02:27,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.989602, valid_loss 0.995583, train_metric nan, valid_metric 0.045877
[852895:MainThread](2024-04-06 20:02:27,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.984096, valid_loss 0.995293, train_metric nan, valid_metric 0.049619
[852895:MainThread](2024-04-06 20:02:28,104) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.997461, valid_loss 0.995200, train_metric nan, valid_metric 0.050332
[852895:MainThread](2024-04-06 20:02:28,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.989604, valid_loss 0.995204, train_metric nan, valid_metric 0.050000
[852895:MainThread](2024-04-06 20:02:28,502) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.981085, valid_loss 0.995516, train_metric nan, valid_metric 0.044822
[852895:MainThread](2024-04-06 20:02:28,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.991782, valid_loss 0.995535, train_metric nan, valid_metric 0.047651
[852895:MainThread](2024-04-06 20:02:29,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.987505, valid_loss 0.995545, train_metric nan, valid_metric 0.043662
[852895:MainThread](2024-04-06 20:02:29,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.986400, valid_loss 0.995336, train_metric nan, valid_metric 0.049448
[852895:MainThread](2024-04-06 20:02:30,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.992563, valid_loss 0.995555, train_metric nan, valid_metric 0.042395
[852895:MainThread](2024-04-06 20:02:30,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.990592, valid_loss 0.995403, train_metric nan, valid_metric 0.044033
[852895:MainThread](2024-04-06 20:02:30,757) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.994519, valid_loss 0.995310, train_metric nan, valid_metric 0.049179
[852895:MainThread](2024-04-06 20:02:31,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.992787, valid_loss 0.995712, train_metric nan, valid_metric 0.045373
[852895:MainThread](2024-04-06 20:02:31,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.988919, valid_loss 0.995277, train_metric nan, valid_metric 0.050733
[852895:MainThread](2024-04-06 20:02:31,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.995697, valid_loss 0.995274, train_metric nan, valid_metric 0.047877
[852895:MainThread](2024-04-06 20:02:32,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.984181, valid_loss 0.995412, train_metric nan, valid_metric 0.046806
[852895:MainThread](2024-04-06 20:02:32,545) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.991291, valid_loss 0.995168, train_metric nan, valid_metric 0.049194
[852895:MainThread](2024-04-06 20:02:32,838) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.989132, valid_loss 0.995167, train_metric nan, valid_metric 0.050000
[852895:MainThread](2024-04-06 20:02:33,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.997829, valid_loss 0.994957, train_metric nan, valid_metric 0.051449
[852895:MainThread](2024-04-06 20:02:33,484) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.997947, valid_loss 0.995350, train_metric nan, valid_metric 0.049179
[852895:MainThread](2024-04-06 20:02:33,750) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.987730, valid_loss 0.994984, train_metric nan, valid_metric 0.051321
[852895:MainThread](2024-04-06 20:02:34,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 1.000955, valid_loss 0.995174, train_metric nan, valid_metric 0.048456
[852895:MainThread](2024-04-06 20:02:34,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 20:02:35,193) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 20:02:36,811) INFO - qlib.timer - [log.py:127] - Time cost: 0.001s | waiting `async_log` Done
train tasks:  76%|███████▌  | 19/25 [15:35<04:15, 42.50s/it][852895:MainThread](2024-04-06 20:02:36,864) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 20:02:36,918) INFO - qlib.workflow - [recorder.py:341] - Recorder a082c409426d4091beee8eff43483048 starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 20:02:38,442) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 20:02:38,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 20:02:38,468) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 20:02:38,471) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 20:02:44,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 20:02:45,511) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.394217, valid_loss 1.175737, train_metric nan, valid_metric 0.005979
[852895:MainThread](2024-04-06 20:02:45,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.175737, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 20:02:45,796) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.131175, valid_loss 1.228395, train_metric nan, valid_metric 0.016931
[852895:MainThread](2024-04-06 20:02:46,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.085322, valid_loss 1.047487, train_metric nan, valid_metric 0.023809
[852895:MainThread](2024-04-06 20:02:46,084) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.175737 to 1.047487, save checkpoint.
[852895:MainThread](2024-04-06 20:02:46,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.063992, valid_loss 1.046734, train_metric nan, valid_metric 0.018779
[852895:MainThread](2024-04-06 20:02:46,374) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.047487 to 1.046734, save checkpoint.
[852895:MainThread](2024-04-06 20:02:46,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.052288, valid_loss 1.010119, train_metric nan, valid_metric 0.023686
[852895:MainThread](2024-04-06 20:02:46,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.046734 to 1.010119, save checkpoint.
[852895:MainThread](2024-04-06 20:02:46,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.030101, valid_loss 1.012997, train_metric nan, valid_metric 0.031164
[852895:MainThread](2024-04-06 20:02:47,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.054457, valid_loss 1.011544, train_metric nan, valid_metric 0.033572
[852895:MainThread](2024-04-06 20:02:47,292) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.034479, valid_loss 1.001589, train_metric nan, valid_metric 0.036578
[852895:MainThread](2024-04-06 20:02:47,292) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.010119 to 1.001589, save checkpoint.
[852895:MainThread](2024-04-06 20:02:47,593) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.023557, valid_loss 1.013901, train_metric nan, valid_metric 0.040877
[852895:MainThread](2024-04-06 20:02:47,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.015144, valid_loss 0.998964, train_metric nan, valid_metric 0.044349
[852895:MainThread](2024-04-06 20:02:47,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001589 to 0.998964, save checkpoint.
[852895:MainThread](2024-04-06 20:02:48,242) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.010666, valid_loss 0.999599, train_metric nan, valid_metric 0.042662
[852895:MainThread](2024-04-06 20:02:48,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.015112, valid_loss 1.000531, train_metric nan, valid_metric 0.039704
[852895:MainThread](2024-04-06 20:02:48,892) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.018705, valid_loss 1.006795, train_metric nan, valid_metric 0.025687
[852895:MainThread](2024-04-06 20:02:49,278) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.006487, valid_loss 0.999716, train_metric nan, valid_metric 0.043200
[852895:MainThread](2024-04-06 20:02:49,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.001331, valid_loss 1.009153, train_metric nan, valid_metric 0.036221
[852895:MainThread](2024-04-06 20:02:49,813) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.011573, valid_loss 1.000514, train_metric nan, valid_metric 0.034682
[852895:MainThread](2024-04-06 20:02:50,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.016224, valid_loss 1.008371, train_metric nan, valid_metric 0.034974
[852895:MainThread](2024-04-06 20:02:50,349) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.000473, valid_loss 1.007109, train_metric nan, valid_metric 0.028249
[852895:MainThread](2024-04-06 20:02:50,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.999877, valid_loss 1.000211, train_metric nan, valid_metric 0.032705
[852895:MainThread](2024-04-06 20:02:50,928) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.003043, valid_loss 0.999002, train_metric nan, valid_metric 0.032914
[852895:MainThread](2024-04-06 20:02:51,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.001705, valid_loss 0.996264, train_metric nan, valid_metric 0.042921
[852895:MainThread](2024-04-06 20:02:51,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998964 to 0.996264, save checkpoint.
[852895:MainThread](2024-04-06 20:02:51,378) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.009511, valid_loss 1.000466, train_metric nan, valid_metric 0.026114
[852895:MainThread](2024-04-06 20:02:51,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.002274, valid_loss 0.997555, train_metric nan, valid_metric 0.044725
[852895:MainThread](2024-04-06 20:02:51,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.005866, valid_loss 1.002316, train_metric nan, valid_metric 0.020185
[852895:MainThread](2024-04-06 20:02:52,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.994584, valid_loss 0.996796, train_metric nan, valid_metric 0.045798
[852895:MainThread](2024-04-06 20:02:52,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.993140, valid_loss 0.999100, train_metric nan, valid_metric 0.032996
[852895:MainThread](2024-04-06 20:02:52,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.993669, valid_loss 1.000405, train_metric nan, valid_metric 0.052371
[852895:MainThread](2024-04-06 20:02:53,251) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.988211, valid_loss 0.994788, train_metric nan, valid_metric 0.055529
[852895:MainThread](2024-04-06 20:02:53,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996264 to 0.994788, save checkpoint.
[852895:MainThread](2024-04-06 20:02:53,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.997687, valid_loss 1.004630, train_metric nan, valid_metric 0.043780
[852895:MainThread](2024-04-06 20:02:53,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.988859, valid_loss 0.997728, train_metric nan, valid_metric 0.036099
[852895:MainThread](2024-04-06 20:02:54,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.997043, valid_loss 0.998169, train_metric nan, valid_metric 0.040676
[852895:MainThread](2024-04-06 20:02:54,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.000752, valid_loss 0.995687, train_metric nan, valid_metric 0.041630
[852895:MainThread](2024-04-06 20:02:54,621) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.993147, valid_loss 0.999416, train_metric nan, valid_metric 0.042551
[852895:MainThread](2024-04-06 20:02:54,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.994166, valid_loss 0.998102, train_metric nan, valid_metric 0.044398
[852895:MainThread](2024-04-06 20:02:55,028) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.984187, valid_loss 1.003533, train_metric nan, valid_metric 0.030240
[852895:MainThread](2024-04-06 20:02:55,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.985494, valid_loss 0.999351, train_metric nan, valid_metric 0.031105
[852895:MainThread](2024-04-06 20:02:55,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.988688, valid_loss 1.001169, train_metric nan, valid_metric 0.038454
[852895:MainThread](2024-04-06 20:02:56,086) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.988225, valid_loss 0.995893, train_metric nan, valid_metric 0.043908
[852895:MainThread](2024-04-06 20:02:56,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.986316, valid_loss 0.995818, train_metric nan, valid_metric 0.045855
[852895:MainThread](2024-04-06 20:02:56,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.990873, valid_loss 0.996379, train_metric nan, valid_metric 0.042230
[852895:MainThread](2024-04-06 20:02:57,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.988075, valid_loss 0.997885, train_metric nan, valid_metric 0.039862
[852895:MainThread](2024-04-06 20:02:57,641) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.989189, valid_loss 0.995790, train_metric nan, valid_metric 0.044141
[852895:MainThread](2024-04-06 20:02:58,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.984659, valid_loss 0.998413, train_metric nan, valid_metric 0.037904
[852895:MainThread](2024-04-06 20:02:58,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.989740, valid_loss 1.000232, train_metric nan, valid_metric 0.037464
[852895:MainThread](2024-04-06 20:02:59,079) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.995542, valid_loss 0.997110, train_metric nan, valid_metric 0.027769
[852895:MainThread](2024-04-06 20:02:59,586) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.995605, valid_loss 0.996523, train_metric nan, valid_metric 0.036936
[852895:MainThread](2024-04-06 20:02:59,980) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.984278, valid_loss 0.996750, train_metric nan, valid_metric 0.035514
[852895:MainThread](2024-04-06 20:03:00,298) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.990494, valid_loss 0.996875, train_metric nan, valid_metric 0.037760
[852895:MainThread](2024-04-06 20:03:00,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.983930, valid_loss 0.996721, train_metric nan, valid_metric 0.037870
[852895:MainThread](2024-04-06 20:03:00,907) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.988832, valid_loss 0.997378, train_metric nan, valid_metric 0.032379
[852895:MainThread](2024-04-06 20:03:01,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.982902, valid_loss 0.996816, train_metric nan, valid_metric 0.034840
[852895:MainThread](2024-04-06 20:03:01,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.982423, valid_loss 0.996804, train_metric nan, valid_metric 0.038299
[852895:MainThread](2024-04-06 20:03:02,141) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.990707, valid_loss 0.996031, train_metric nan, valid_metric 0.039587
[852895:MainThread](2024-04-06 20:03:02,395) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.986071, valid_loss 0.997497, train_metric nan, valid_metric 0.036082
[852895:MainThread](2024-04-06 20:03:02,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.982148, valid_loss 0.996902, train_metric nan, valid_metric 0.040095
[852895:MainThread](2024-04-06 20:03:03,079) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.984357, valid_loss 0.995999, train_metric nan, valid_metric 0.045320
[852895:MainThread](2024-04-06 20:03:03,417) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.991045, valid_loss 0.996569, train_metric nan, valid_metric 0.041672
[852895:MainThread](2024-04-06 20:03:03,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.978698, valid_loss 0.995692, train_metric nan, valid_metric 0.042930
[852895:MainThread](2024-04-06 20:03:04,204) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.989217, valid_loss 0.996966, train_metric nan, valid_metric 0.042788
[852895:MainThread](2024-04-06 20:03:04,524) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.983381, valid_loss 0.995319, train_metric nan, valid_metric 0.046368
[852895:MainThread](2024-04-06 20:03:04,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.986673, valid_loss 0.994969, train_metric nan, valid_metric 0.046964
[852895:MainThread](2024-04-06 20:03:05,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.987320, valid_loss 0.995533, train_metric nan, valid_metric 0.047502
[852895:MainThread](2024-04-06 20:03:05,742) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.971688, valid_loss 0.995253, train_metric nan, valid_metric 0.044392
[852895:MainThread](2024-04-06 20:03:06,067) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.992379, valid_loss 0.995666, train_metric nan, valid_metric 0.042752
[852895:MainThread](2024-04-06 20:03:06,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.985325, valid_loss 0.995572, train_metric nan, valid_metric 0.040104
[852895:MainThread](2024-04-06 20:03:06,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.982942, valid_loss 0.996308, train_metric nan, valid_metric 0.041644
[852895:MainThread](2024-04-06 20:03:07,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.998489, valid_loss 0.996699, train_metric nan, valid_metric 0.042756
[852895:MainThread](2024-04-06 20:03:07,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.990660, valid_loss 0.996397, train_metric nan, valid_metric 0.041455
[852895:MainThread](2024-04-06 20:03:08,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.983190, valid_loss 0.996714, train_metric nan, valid_metric 0.039560
[852895:MainThread](2024-04-06 20:03:08,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.972104, valid_loss 0.996168, train_metric nan, valid_metric 0.039771
[852895:MainThread](2024-04-06 20:03:08,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.986813, valid_loss 0.997152, train_metric nan, valid_metric 0.036757
[852895:MainThread](2024-04-06 20:03:09,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.984019, valid_loss 0.996746, train_metric nan, valid_metric 0.040860
[852895:MainThread](2024-04-06 20:03:09,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.983504, valid_loss 0.995981, train_metric nan, valid_metric 0.043995
[852895:MainThread](2024-04-06 20:03:09,442) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.986717, valid_loss 0.996864, train_metric nan, valid_metric 0.041210
[852895:MainThread](2024-04-06 20:03:09,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.991133, valid_loss 0.996798, train_metric nan, valid_metric 0.042032
[852895:MainThread](2024-04-06 20:03:09,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.991305, valid_loss 0.996785, train_metric nan, valid_metric 0.040944
[852895:MainThread](2024-04-06 20:03:10,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.981599, valid_loss 0.996116, train_metric nan, valid_metric 0.033077
[852895:MainThread](2024-04-06 20:03:10,767) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.992346, valid_loss 0.995990, train_metric nan, valid_metric 0.034992
[852895:MainThread](2024-04-06 20:03:10,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 20:03:11,829) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 20:03:13,054) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  80%|████████  | 20/25 [16:11<03:23, 40.62s/it][852895:MainThread](2024-04-06 20:03:13,070) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 20:03:13,094) INFO - qlib.workflow - [recorder.py:341] - Recorder b30042701dc344b4b8a31d806ba7906d starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 20:03:14,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 20:03:14,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 20:03:14,052) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 20:03:14,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 20:03:19,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 20:03:20,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.399581, valid_loss 1.213446, train_metric nan, valid_metric -0.006453
[852895:MainThread](2024-04-06 20:03:20,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.213446, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 20:03:20,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.153355, valid_loss 1.059972, train_metric nan, valid_metric 0.014720
[852895:MainThread](2024-04-06 20:03:20,774) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.213446 to 1.059972, save checkpoint.
[852895:MainThread](2024-04-06 20:03:21,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.083938, valid_loss 1.035227, train_metric nan, valid_metric -0.005058
[852895:MainThread](2024-04-06 20:03:21,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.059972 to 1.035227, save checkpoint.
[852895:MainThread](2024-04-06 20:03:21,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.065528, valid_loss 1.028421, train_metric nan, valid_metric -0.003845
[852895:MainThread](2024-04-06 20:03:21,335) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.035227 to 1.028421, save checkpoint.
[852895:MainThread](2024-04-06 20:03:21,583) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.073870, valid_loss 1.026534, train_metric nan, valid_metric -0.001168
[852895:MainThread](2024-04-06 20:03:21,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.028421 to 1.026534, save checkpoint.
[852895:MainThread](2024-04-06 20:03:22,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.060279, valid_loss 1.021385, train_metric nan, valid_metric -0.001771
[852895:MainThread](2024-04-06 20:03:22,298) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.026534 to 1.021385, save checkpoint.
[852895:MainThread](2024-04-06 20:03:22,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.068396, valid_loss 1.008814, train_metric nan, valid_metric 0.020634
[852895:MainThread](2024-04-06 20:03:22,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.021385 to 1.008814, save checkpoint.
[852895:MainThread](2024-04-06 20:03:23,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.090453, valid_loss 1.057253, train_metric nan, valid_metric 0.010456
[852895:MainThread](2024-04-06 20:03:23,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.056230, valid_loss 1.011599, train_metric nan, valid_metric 0.017251
[852895:MainThread](2024-04-06 20:03:23,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.030601, valid_loss 1.002931, train_metric nan, valid_metric 0.022199
[852895:MainThread](2024-04-06 20:03:23,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.008814 to 1.002931, save checkpoint.
[852895:MainThread](2024-04-06 20:03:24,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.033197, valid_loss 1.001945, train_metric nan, valid_metric 0.029507
[852895:MainThread](2024-04-06 20:03:24,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.002931 to 1.001945, save checkpoint.
[852895:MainThread](2024-04-06 20:03:24,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.035987, valid_loss 1.011979, train_metric nan, valid_metric 0.032863
[852895:MainThread](2024-04-06 20:03:24,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.026524, valid_loss 1.004149, train_metric nan, valid_metric 0.027659
[852895:MainThread](2024-04-06 20:03:25,143) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.034508, valid_loss 1.000926, train_metric nan, valid_metric 0.026452
[852895:MainThread](2024-04-06 20:03:25,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001945 to 1.000926, save checkpoint.
[852895:MainThread](2024-04-06 20:03:25,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.017811, valid_loss 1.014819, train_metric nan, valid_metric 0.010305
[852895:MainThread](2024-04-06 20:03:25,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.023137, valid_loss 1.009853, train_metric nan, valid_metric -0.003196
[852895:MainThread](2024-04-06 20:03:26,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.009114, valid_loss 1.010077, train_metric nan, valid_metric 0.004899
[852895:MainThread](2024-04-06 20:03:26,573) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.042712, valid_loss 1.003076, train_metric nan, valid_metric 0.002956
[852895:MainThread](2024-04-06 20:03:26,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.026549, valid_loss 1.011792, train_metric nan, valid_metric -0.002295
[852895:MainThread](2024-04-06 20:03:27,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.042173, valid_loss 1.014635, train_metric nan, valid_metric -0.000686
[852895:MainThread](2024-04-06 20:03:27,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.014346, valid_loss 1.001303, train_metric nan, valid_metric 0.025155
[852895:MainThread](2024-04-06 20:03:27,551) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.995166, valid_loss 1.001087, train_metric nan, valid_metric 0.018241
[852895:MainThread](2024-04-06 20:03:27,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.997663, valid_loss 0.999705, train_metric nan, valid_metric 0.021699
[852895:MainThread](2024-04-06 20:03:27,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000926 to 0.999705, save checkpoint.
[852895:MainThread](2024-04-06 20:03:28,158) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.008121, valid_loss 1.004614, train_metric nan, valid_metric 0.016367
[852895:MainThread](2024-04-06 20:03:28,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.004457, valid_loss 1.002583, train_metric nan, valid_metric 0.017516
[852895:MainThread](2024-04-06 20:03:28,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.009840, valid_loss 1.002211, train_metric nan, valid_metric 0.016276
[852895:MainThread](2024-04-06 20:03:29,114) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.998790, valid_loss 1.008552, train_metric nan, valid_metric 0.017639
[852895:MainThread](2024-04-06 20:03:29,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.998117, valid_loss 0.997427, train_metric nan, valid_metric 0.024962
[852895:MainThread](2024-04-06 20:03:29,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999705 to 0.997427, save checkpoint.
[852895:MainThread](2024-04-06 20:03:29,710) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.997217, valid_loss 1.002798, train_metric nan, valid_metric 0.018574
[852895:MainThread](2024-04-06 20:03:30,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.999954, valid_loss 1.002647, train_metric nan, valid_metric 0.019140
[852895:MainThread](2024-04-06 20:03:30,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.990369, valid_loss 1.001382, train_metric nan, valid_metric 0.016036
[852895:MainThread](2024-04-06 20:03:30,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.989733, valid_loss 1.005743, train_metric nan, valid_metric 0.010497
[852895:MainThread](2024-04-06 20:03:30,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.994056, valid_loss 1.000412, train_metric nan, valid_metric 0.016834
[852895:MainThread](2024-04-06 20:03:31,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.988306, valid_loss 1.003404, train_metric nan, valid_metric 0.012867
[852895:MainThread](2024-04-06 20:03:31,403) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.989797, valid_loss 1.005044, train_metric nan, valid_metric 0.005704
[852895:MainThread](2024-04-06 20:03:31,643) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.991488, valid_loss 1.012267, train_metric nan, valid_metric 0.016965
[852895:MainThread](2024-04-06 20:03:31,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.996318, valid_loss 1.001583, train_metric nan, valid_metric 0.024481
[852895:MainThread](2024-04-06 20:03:32,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.980323, valid_loss 1.000042, train_metric nan, valid_metric 0.023292
[852895:MainThread](2024-04-06 20:03:32,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.971502, valid_loss 1.000519, train_metric nan, valid_metric 0.016974
[852895:MainThread](2024-04-06 20:03:32,744) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.000474, valid_loss 0.999194, train_metric nan, valid_metric 0.024181
[852895:MainThread](2024-04-06 20:03:33,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.990968, valid_loss 1.000079, train_metric nan, valid_metric 0.020583
[852895:MainThread](2024-04-06 20:03:33,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.995029, valid_loss 1.001432, train_metric nan, valid_metric 0.019610
[852895:MainThread](2024-04-06 20:03:33,612) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.994099, valid_loss 1.001038, train_metric nan, valid_metric 0.018290
[852895:MainThread](2024-04-06 20:03:34,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.993980, valid_loss 1.001441, train_metric nan, valid_metric 0.017088
[852895:MainThread](2024-04-06 20:03:34,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.986117, valid_loss 1.000881, train_metric nan, valid_metric 0.016913
[852895:MainThread](2024-04-06 20:03:34,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.990107, valid_loss 0.999338, train_metric nan, valid_metric 0.020250
[852895:MainThread](2024-04-06 20:03:34,804) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.994255, valid_loss 1.000912, train_metric nan, valid_metric 0.020244
[852895:MainThread](2024-04-06 20:03:35,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.991235, valid_loss 1.000028, train_metric nan, valid_metric 0.020412
[852895:MainThread](2024-04-06 20:03:35,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.998705, valid_loss 1.000039, train_metric nan, valid_metric 0.019776
[852895:MainThread](2024-04-06 20:03:35,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.992881, valid_loss 1.000744, train_metric nan, valid_metric 0.019751
[852895:MainThread](2024-04-06 20:03:35,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.987728, valid_loss 0.999785, train_metric nan, valid_metric 0.012788
[852895:MainThread](2024-04-06 20:03:36,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.975656, valid_loss 0.999272, train_metric nan, valid_metric 0.020551
[852895:MainThread](2024-04-06 20:03:36,586) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.990704, valid_loss 0.999370, train_metric nan, valid_metric 0.022126
[852895:MainThread](2024-04-06 20:03:36,885) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.981880, valid_loss 0.999689, train_metric nan, valid_metric 0.013382
[852895:MainThread](2024-04-06 20:03:37,250) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.994677, valid_loss 0.999937, train_metric nan, valid_metric 0.017990
[852895:MainThread](2024-04-06 20:03:37,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.989125, valid_loss 1.000509, train_metric nan, valid_metric 0.021495
[852895:MainThread](2024-04-06 20:03:38,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.984717, valid_loss 0.999697, train_metric nan, valid_metric 0.019486
[852895:MainThread](2024-04-06 20:03:38,346) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.984516, valid_loss 0.999656, train_metric nan, valid_metric 0.015880
[852895:MainThread](2024-04-06 20:03:38,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.993130, valid_loss 1.000371, train_metric nan, valid_metric 0.016826
[852895:MainThread](2024-04-06 20:03:38,842) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.987964, valid_loss 1.000495, train_metric nan, valid_metric 0.017529
[852895:MainThread](2024-04-06 20:03:39,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.991420, valid_loss 0.999970, train_metric nan, valid_metric 0.020798
[852895:MainThread](2024-04-06 20:03:39,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.991040, valid_loss 1.000205, train_metric nan, valid_metric 0.017725
[852895:MainThread](2024-04-06 20:03:39,500) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 1.001257, valid_loss 1.000178, train_metric nan, valid_metric 0.015100
[852895:MainThread](2024-04-06 20:03:39,796) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.983800, valid_loss 1.001088, train_metric nan, valid_metric 0.015719
[852895:MainThread](2024-04-06 20:03:40,120) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.984248, valid_loss 0.998780, train_metric nan, valid_metric 0.012619
[852895:MainThread](2024-04-06 20:03:40,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.987907, valid_loss 0.999112, train_metric nan, valid_metric 0.019997
[852895:MainThread](2024-04-06 20:03:40,869) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.989225, valid_loss 1.000147, train_metric nan, valid_metric 0.018700
[852895:MainThread](2024-04-06 20:03:41,184) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.990742, valid_loss 1.000025, train_metric nan, valid_metric 0.017995
[852895:MainThread](2024-04-06 20:03:41,424) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.993422, valid_loss 0.999463, train_metric nan, valid_metric 0.013197
[852895:MainThread](2024-04-06 20:03:41,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.986073, valid_loss 1.000649, train_metric nan, valid_metric 0.018696
[852895:MainThread](2024-04-06 20:03:41,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.993527, valid_loss 0.999445, train_metric nan, valid_metric 0.022418
[852895:MainThread](2024-04-06 20:03:42,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.981390, valid_loss 1.000711, train_metric nan, valid_metric 0.017674
[852895:MainThread](2024-04-06 20:03:42,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.988477, valid_loss 1.000626, train_metric nan, valid_metric 0.017908
[852895:MainThread](2024-04-06 20:03:42,732) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.989269, valid_loss 0.999893, train_metric nan, valid_metric 0.016851
[852895:MainThread](2024-04-06 20:03:43,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.987349, valid_loss 1.000358, train_metric nan, valid_metric 0.019142
[852895:MainThread](2024-04-06 20:03:43,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.992433, valid_loss 0.999689, train_metric nan, valid_metric 0.013303
[852895:MainThread](2024-04-06 20:03:43,621) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.995926, valid_loss 1.000830, train_metric nan, valid_metric 0.017718
[852895:MainThread](2024-04-06 20:03:43,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.987726, valid_loss 1.000782, train_metric nan, valid_metric 0.019265
[852895:MainThread](2024-04-06 20:03:43,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 20:03:45,892) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 20:03:48,085) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  84%|████████▍ | 21/25 [16:46<02:35, 38.94s/it][852895:MainThread](2024-04-06 20:03:48,121) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 20:03:48,170) INFO - qlib.workflow - [recorder.py:341] - Recorder 4c251d86b570439e9cd6a925e1e4a965 starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 20:03:50,180) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 20:03:50,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 20:03:50,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 20:03:50,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 20:03:55,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 20:03:55,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.169584, valid_loss 1.026980, train_metric nan, valid_metric -0.001856
[852895:MainThread](2024-04-06 20:03:55,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.026980, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 20:03:56,176) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.058200, valid_loss 1.017467, train_metric nan, valid_metric -0.003236
[852895:MainThread](2024-04-06 20:03:56,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.026980 to 1.017467, save checkpoint.
[852895:MainThread](2024-04-06 20:03:56,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.032079, valid_loss 1.024000, train_metric nan, valid_metric -0.004205
[852895:MainThread](2024-04-06 20:03:56,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.026450, valid_loss 1.028787, train_metric nan, valid_metric 0.003745
[852895:MainThread](2024-04-06 20:03:57,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.020090, valid_loss 1.013994, train_metric nan, valid_metric 0.019997
[852895:MainThread](2024-04-06 20:03:57,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.017467 to 1.013994, save checkpoint.
[852895:MainThread](2024-04-06 20:03:57,541) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.003043, valid_loss 1.010649, train_metric nan, valid_metric -0.009121
[852895:MainThread](2024-04-06 20:03:57,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.013994 to 1.010649, save checkpoint.
[852895:MainThread](2024-04-06 20:03:57,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.002872, valid_loss 1.011217, train_metric nan, valid_metric 0.029582
[852895:MainThread](2024-04-06 20:03:58,050) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.002811, valid_loss 1.005722, train_metric nan, valid_metric 0.021874
[852895:MainThread](2024-04-06 20:03:58,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.010649 to 1.005722, save checkpoint.
[852895:MainThread](2024-04-06 20:03:58,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 0.990869, valid_loss 1.004635, train_metric nan, valid_metric 0.012262
[852895:MainThread](2024-04-06 20:03:58,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.005722 to 1.004635, save checkpoint.
[852895:MainThread](2024-04-06 20:03:58,762) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 0.996657, valid_loss 1.007608, train_metric nan, valid_metric 0.005196
[852895:MainThread](2024-04-06 20:03:59,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 0.999322, valid_loss 1.004839, train_metric nan, valid_metric 0.004171
[852895:MainThread](2024-04-06 20:03:59,564) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.001549, valid_loss 1.007102, train_metric nan, valid_metric -0.016979
[852895:MainThread](2024-04-06 20:03:59,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.002431, valid_loss 1.006138, train_metric nan, valid_metric -0.000176
[852895:MainThread](2024-04-06 20:04:00,229) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.002438, valid_loss 1.000440, train_metric nan, valid_metric 0.016529
[852895:MainThread](2024-04-06 20:04:00,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.004635 to 1.000440, save checkpoint.
[852895:MainThread](2024-04-06 20:04:00,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.992104, valid_loss 1.000129, train_metric nan, valid_metric 0.025684
[852895:MainThread](2024-04-06 20:04:00,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000440 to 1.000129, save checkpoint.
[852895:MainThread](2024-04-06 20:04:01,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.997683, valid_loss 1.000137, train_metric nan, valid_metric 0.020420
[852895:MainThread](2024-04-06 20:04:01,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.983650, valid_loss 1.005325, train_metric nan, valid_metric 0.003037
[852895:MainThread](2024-04-06 20:04:01,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.975884, valid_loss 1.002793, train_metric nan, valid_metric 0.013492
[852895:MainThread](2024-04-06 20:04:02,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.993141, valid_loss 1.002618, train_metric nan, valid_metric 0.009791
[852895:MainThread](2024-04-06 20:04:02,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.995006, valid_loss 1.005300, train_metric nan, valid_metric -0.000044
[852895:MainThread](2024-04-06 20:04:02,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.995497, valid_loss 1.003750, train_metric nan, valid_metric 0.011756
[852895:MainThread](2024-04-06 20:04:03,183) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.990685, valid_loss 1.005500, train_metric nan, valid_metric -0.003835
[852895:MainThread](2024-04-06 20:04:03,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.987869, valid_loss 1.001515, train_metric nan, valid_metric 0.011782
[852895:MainThread](2024-04-06 20:04:03,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.004815, valid_loss 1.001122, train_metric nan, valid_metric 0.018631
[852895:MainThread](2024-04-06 20:04:04,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.979382, valid_loss 1.005378, train_metric nan, valid_metric -0.004338
[852895:MainThread](2024-04-06 20:04:04,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.981189, valid_loss 1.003448, train_metric nan, valid_metric 0.002477
[852895:MainThread](2024-04-06 20:04:05,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.981241, valid_loss 1.000772, train_metric nan, valid_metric 0.014092
[852895:MainThread](2024-04-06 20:04:05,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.985133, valid_loss 1.001057, train_metric nan, valid_metric 0.014362
[852895:MainThread](2024-04-06 20:04:05,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.991105, valid_loss 0.998727, train_metric nan, valid_metric 0.025036
[852895:MainThread](2024-04-06 20:04:05,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000129 to 0.998727, save checkpoint.
[852895:MainThread](2024-04-06 20:04:05,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.993532, valid_loss 1.002243, train_metric nan, valid_metric 0.007197
[852895:MainThread](2024-04-06 20:04:06,084) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.984828, valid_loss 1.001329, train_metric nan, valid_metric 0.012555
[852895:MainThread](2024-04-06 20:04:06,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.990734, valid_loss 0.999726, train_metric nan, valid_metric 0.007031
[852895:MainThread](2024-04-06 20:04:06,579) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.982850, valid_loss 1.000216, train_metric nan, valid_metric 0.010138
[852895:MainThread](2024-04-06 20:04:06,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.976582, valid_loss 1.003488, train_metric nan, valid_metric 0.000915
[852895:MainThread](2024-04-06 20:04:07,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.993122, valid_loss 1.003321, train_metric nan, valid_metric 0.004647
[852895:MainThread](2024-04-06 20:04:07,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.986017, valid_loss 0.999890, train_metric nan, valid_metric 0.021878
[852895:MainThread](2024-04-06 20:04:07,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.989353, valid_loss 0.999910, train_metric nan, valid_metric 0.021952
[852895:MainThread](2024-04-06 20:04:08,008) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.988757, valid_loss 1.001166, train_metric nan, valid_metric 0.010958
[852895:MainThread](2024-04-06 20:04:08,257) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.987661, valid_loss 1.003474, train_metric nan, valid_metric 0.017310
[852895:MainThread](2024-04-06 20:04:08,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.990730, valid_loss 1.003473, train_metric nan, valid_metric 0.002278
[852895:MainThread](2024-04-06 20:04:08,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.971073, valid_loss 1.003144, train_metric nan, valid_metric 0.001333
[852895:MainThread](2024-04-06 20:04:09,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.978104, valid_loss 1.000095, train_metric nan, valid_metric 0.016635
[852895:MainThread](2024-04-06 20:04:09,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.988430, valid_loss 0.999372, train_metric nan, valid_metric 0.012140
[852895:MainThread](2024-04-06 20:04:09,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.988090, valid_loss 1.000972, train_metric nan, valid_metric 0.004076
[852895:MainThread](2024-04-06 20:04:10,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.980656, valid_loss 1.001420, train_metric nan, valid_metric 0.007621
[852895:MainThread](2024-04-06 20:04:11,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.986778, valid_loss 1.003051, train_metric nan, valid_metric 0.006994
[852895:MainThread](2024-04-06 20:04:11,322) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.984173, valid_loss 1.002325, train_metric nan, valid_metric 0.010111
[852895:MainThread](2024-04-06 20:04:11,590) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.975797, valid_loss 1.004157, train_metric nan, valid_metric 0.003008
[852895:MainThread](2024-04-06 20:04:11,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.984128, valid_loss 1.002965, train_metric nan, valid_metric 0.003983
[852895:MainThread](2024-04-06 20:04:12,183) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.988252, valid_loss 1.002894, train_metric nan, valid_metric -0.005960
[852895:MainThread](2024-04-06 20:04:12,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.985411, valid_loss 1.002466, train_metric nan, valid_metric 0.006704
[852895:MainThread](2024-04-06 20:04:12,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.993080, valid_loss 1.002346, train_metric nan, valid_metric 0.012890
[852895:MainThread](2024-04-06 20:04:13,052) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.985796, valid_loss 1.001589, train_metric nan, valid_metric -0.004784
[852895:MainThread](2024-04-06 20:04:13,220) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.005995, valid_loss 1.003342, train_metric nan, valid_metric -0.004905
[852895:MainThread](2024-04-06 20:04:13,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.985703, valid_loss 1.003252, train_metric nan, valid_metric 0.005595
[852895:MainThread](2024-04-06 20:04:13,760) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.991435, valid_loss 1.002773, train_metric nan, valid_metric 0.000829
[852895:MainThread](2024-04-06 20:04:14,114) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.986467, valid_loss 1.004560, train_metric nan, valid_metric -0.001746
[852895:MainThread](2024-04-06 20:04:14,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.991549, valid_loss 1.002246, train_metric nan, valid_metric -0.002649
[852895:MainThread](2024-04-06 20:04:14,630) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.981133, valid_loss 1.002906, train_metric nan, valid_metric 0.002895
[852895:MainThread](2024-04-06 20:04:14,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.985391, valid_loss 1.002646, train_metric nan, valid_metric 0.005737
[852895:MainThread](2024-04-06 20:04:15,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.982550, valid_loss 1.003292, train_metric nan, valid_metric 0.004404
[852895:MainThread](2024-04-06 20:04:15,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.987673, valid_loss 1.002653, train_metric nan, valid_metric 0.008186
[852895:MainThread](2024-04-06 20:04:15,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.982609, valid_loss 1.002926, train_metric nan, valid_metric 0.003263
[852895:MainThread](2024-04-06 20:04:16,053) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.990303, valid_loss 1.002291, train_metric nan, valid_metric 0.002695
[852895:MainThread](2024-04-06 20:04:16,336) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.985461, valid_loss 1.001489, train_metric nan, valid_metric 0.006799
[852895:MainThread](2024-04-06 20:04:16,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.980009, valid_loss 1.000673, train_metric nan, valid_metric 0.002489
[852895:MainThread](2024-04-06 20:04:16,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.988666, valid_loss 1.003128, train_metric nan, valid_metric 0.001618
[852895:MainThread](2024-04-06 20:04:17,134) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.988866, valid_loss 1.000867, train_metric nan, valid_metric -0.000636
[852895:MainThread](2024-04-06 20:04:17,398) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.985560, valid_loss 1.002315, train_metric nan, valid_metric 0.005473
[852895:MainThread](2024-04-06 20:04:17,594) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.977978, valid_loss 1.003361, train_metric nan, valid_metric -0.005182
[852895:MainThread](2024-04-06 20:04:17,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.984146, valid_loss 1.004368, train_metric nan, valid_metric 0.001162
[852895:MainThread](2024-04-06 20:04:18,114) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.978156, valid_loss 1.001484, train_metric nan, valid_metric 0.000560
[852895:MainThread](2024-04-06 20:04:18,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.987021, valid_loss 1.003131, train_metric nan, valid_metric 0.001115
[852895:MainThread](2024-04-06 20:04:18,635) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.988130, valid_loss 1.002948, train_metric nan, valid_metric 0.006194
[852895:MainThread](2024-04-06 20:04:18,983) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.992133, valid_loss 1.002541, train_metric nan, valid_metric 0.009499
[852895:MainThread](2024-04-06 20:04:19,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.986341, valid_loss 1.002667, train_metric nan, valid_metric 0.007285
[852895:MainThread](2024-04-06 20:04:19,726) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.988864, valid_loss 1.002486, train_metric nan, valid_metric 0.003574
[852895:MainThread](2024-04-06 20:04:19,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.984750, valid_loss 1.003231, train_metric nan, valid_metric 0.004681
[852895:MainThread](2024-04-06 20:04:20,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.984249, valid_loss 1.002639, train_metric nan, valid_metric 0.008140
[852895:MainThread](2024-04-06 20:04:20,257) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 20:04:21,426) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 20:04:22,563) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  88%|████████▊ | 22/25 [17:21<01:52, 37.60s/it][852895:MainThread](2024-04-06 20:04:22,579) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 20:04:22,601) INFO - qlib.workflow - [recorder.py:341] - Recorder 19909a0165264b7da2808bff22a34c18 starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 20:04:23,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 20:04:23,468) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 20:04:23,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 20:04:23,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 20:04:27,899) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 20:04:28,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.231925, valid_loss 1.117736, train_metric nan, valid_metric -0.006141
[852895:MainThread](2024-04-06 20:04:28,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.117736, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 20:04:28,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.118584, valid_loss 1.031681, train_metric nan, valid_metric 0.023468
[852895:MainThread](2024-04-06 20:04:28,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.117736 to 1.031681, save checkpoint.
[852895:MainThread](2024-04-06 20:04:28,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.073686, valid_loss 1.016090, train_metric nan, valid_metric 0.026738
[852895:MainThread](2024-04-06 20:04:28,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.031681 to 1.016090, save checkpoint.
[852895:MainThread](2024-04-06 20:04:28,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.102317, valid_loss 1.015856, train_metric nan, valid_metric 0.041264
[852895:MainThread](2024-04-06 20:04:28,885) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.016090 to 1.015856, save checkpoint.
[852895:MainThread](2024-04-06 20:04:29,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.078923, valid_loss 1.050361, train_metric nan, valid_metric 0.029944
[852895:MainThread](2024-04-06 20:04:29,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.039498, valid_loss 1.006993, train_metric nan, valid_metric 0.020935
[852895:MainThread](2024-04-06 20:04:29,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.015856 to 1.006993, save checkpoint.
[852895:MainThread](2024-04-06 20:04:29,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.022682, valid_loss 1.004614, train_metric nan, valid_metric 0.030176
[852895:MainThread](2024-04-06 20:04:29,576) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006993 to 1.004614, save checkpoint.
[852895:MainThread](2024-04-06 20:04:29,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.027780, valid_loss 1.010291, train_metric nan, valid_metric 0.013346
[852895:MainThread](2024-04-06 20:04:30,004) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.028769, valid_loss 1.017725, train_metric nan, valid_metric 0.043555
[852895:MainThread](2024-04-06 20:04:30,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.016374, valid_loss 1.017945, train_metric nan, valid_metric 0.026648
[852895:MainThread](2024-04-06 20:04:30,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.019225, valid_loss 1.007396, train_metric nan, valid_metric 0.050037
[852895:MainThread](2024-04-06 20:04:30,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.009855, valid_loss 1.003510, train_metric nan, valid_metric 0.026797
[852895:MainThread](2024-04-06 20:04:30,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.004614 to 1.003510, save checkpoint.
[852895:MainThread](2024-04-06 20:04:30,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.008612, valid_loss 1.001155, train_metric nan, valid_metric 0.029960
[852895:MainThread](2024-04-06 20:04:30,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003510 to 1.001155, save checkpoint.
[852895:MainThread](2024-04-06 20:04:31,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.004253, valid_loss 1.018183, train_metric nan, valid_metric 0.025829
[852895:MainThread](2024-04-06 20:04:31,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.007738, valid_loss 1.000316, train_metric nan, valid_metric 0.033299
[852895:MainThread](2024-04-06 20:04:31,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001155 to 1.000316, save checkpoint.
[852895:MainThread](2024-04-06 20:04:32,047) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.999352, valid_loss 1.002683, train_metric nan, valid_metric 0.023446
[852895:MainThread](2024-04-06 20:04:32,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.018651, valid_loss 1.012725, train_metric nan, valid_metric 0.026326
[852895:MainThread](2024-04-06 20:04:32,838) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.000830, valid_loss 1.005839, train_metric nan, valid_metric 0.010428
[852895:MainThread](2024-04-06 20:04:33,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.010298, valid_loss 1.009483, train_metric nan, valid_metric 0.009208
[852895:MainThread](2024-04-06 20:04:33,608) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.015942, valid_loss 1.059427, train_metric nan, valid_metric -0.000209
[852895:MainThread](2024-04-06 20:04:33,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.004387, valid_loss 1.020888, train_metric nan, valid_metric 0.039234
[852895:MainThread](2024-04-06 20:04:34,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.005989, valid_loss 1.013999, train_metric nan, valid_metric 0.028332
[852895:MainThread](2024-04-06 20:04:34,778) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.005414, valid_loss 1.005258, train_metric nan, valid_metric 0.016878
[852895:MainThread](2024-04-06 20:04:35,260) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.011351, valid_loss 1.001812, train_metric nan, valid_metric 0.011335
[852895:MainThread](2024-04-06 20:04:35,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.991829, valid_loss 1.008124, train_metric nan, valid_metric 0.002189
[852895:MainThread](2024-04-06 20:04:35,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.996098, valid_loss 1.005910, train_metric nan, valid_metric 0.017082
[852895:MainThread](2024-04-06 20:04:36,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.991634, valid_loss 1.010220, train_metric nan, valid_metric 0.024533
[852895:MainThread](2024-04-06 20:04:36,741) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.990271, valid_loss 1.002076, train_metric nan, valid_metric 0.021705
[852895:MainThread](2024-04-06 20:04:37,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.002167, valid_loss 1.002474, train_metric nan, valid_metric 0.019276
[852895:MainThread](2024-04-06 20:04:37,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.990003, valid_loss 0.998607, train_metric nan, valid_metric 0.029784
[852895:MainThread](2024-04-06 20:04:37,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000316 to 0.998607, save checkpoint.
[852895:MainThread](2024-04-06 20:04:37,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.989847, valid_loss 0.997466, train_metric nan, valid_metric 0.036812
[852895:MainThread](2024-04-06 20:04:37,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998607 to 0.997466, save checkpoint.
[852895:MainThread](2024-04-06 20:04:38,172) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.989378, valid_loss 0.997618, train_metric nan, valid_metric 0.038472
[852895:MainThread](2024-04-06 20:04:38,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.998643, valid_loss 0.999546, train_metric nan, valid_metric 0.032107
[852895:MainThread](2024-04-06 20:04:38,910) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.997697, valid_loss 1.005279, train_metric nan, valid_metric 0.029444
[852895:MainThread](2024-04-06 20:04:39,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.995783, valid_loss 1.000621, train_metric nan, valid_metric 0.027912
[852895:MainThread](2024-04-06 20:04:39,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.994751, valid_loss 0.999165, train_metric nan, valid_metric 0.022630
[852895:MainThread](2024-04-06 20:04:39,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.990927, valid_loss 1.000133, train_metric nan, valid_metric 0.023281
[852895:MainThread](2024-04-06 20:04:40,205) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.986319, valid_loss 1.000504, train_metric nan, valid_metric 0.029403
[852895:MainThread](2024-04-06 20:04:40,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.988960, valid_loss 0.999485, train_metric nan, valid_metric 0.027553
[852895:MainThread](2024-04-06 20:04:40,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.997384, valid_loss 0.998977, train_metric nan, valid_metric 0.028632
[852895:MainThread](2024-04-06 20:04:40,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.986862, valid_loss 0.998718, train_metric nan, valid_metric 0.030891
[852895:MainThread](2024-04-06 20:04:41,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.991135, valid_loss 1.002001, train_metric nan, valid_metric 0.023566
[852895:MainThread](2024-04-06 20:04:41,500) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.992418, valid_loss 0.998189, train_metric nan, valid_metric 0.026854
[852895:MainThread](2024-04-06 20:04:41,757) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.986500, valid_loss 1.000043, train_metric nan, valid_metric 0.022481
[852895:MainThread](2024-04-06 20:04:42,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.992877, valid_loss 0.999314, train_metric nan, valid_metric 0.026486
[852895:MainThread](2024-04-06 20:04:42,328) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.995635, valid_loss 0.999053, train_metric nan, valid_metric 0.028935
[852895:MainThread](2024-04-06 20:04:42,494) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.992471, valid_loss 0.996876, train_metric nan, valid_metric 0.032137
[852895:MainThread](2024-04-06 20:04:42,494) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997466 to 0.996876, save checkpoint.
[852895:MainThread](2024-04-06 20:04:42,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.998788, valid_loss 0.998311, train_metric nan, valid_metric 0.029326
[852895:MainThread](2024-04-06 20:04:42,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.995117, valid_loss 0.998222, train_metric nan, valid_metric 0.032418
[852895:MainThread](2024-04-06 20:04:43,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.983668, valid_loss 0.997088, train_metric nan, valid_metric 0.037512
[852895:MainThread](2024-04-06 20:04:43,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.987938, valid_loss 0.999210, train_metric nan, valid_metric 0.029379
[852895:MainThread](2024-04-06 20:04:43,667) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.982138, valid_loss 1.000162, train_metric nan, valid_metric 0.025030
[852895:MainThread](2024-04-06 20:04:43,842) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.982770, valid_loss 1.000798, train_metric nan, valid_metric 0.023882
[852895:MainThread](2024-04-06 20:04:44,129) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.981701, valid_loss 1.000352, train_metric nan, valid_metric 0.022595
[852895:MainThread](2024-04-06 20:04:44,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.995193, valid_loss 1.000238, train_metric nan, valid_metric 0.021380
[852895:MainThread](2024-04-06 20:04:44,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.988498, valid_loss 0.997651, train_metric nan, valid_metric 0.034978
[852895:MainThread](2024-04-06 20:04:44,898) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.988107, valid_loss 0.999462, train_metric nan, valid_metric 0.031969
[852895:MainThread](2024-04-06 20:04:45,153) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.985958, valid_loss 0.997433, train_metric nan, valid_metric 0.033065
[852895:MainThread](2024-04-06 20:04:45,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.994500, valid_loss 1.000014, train_metric nan, valid_metric 0.027211
[852895:MainThread](2024-04-06 20:04:45,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.986611, valid_loss 0.998619, train_metric nan, valid_metric 0.027114
[852895:MainThread](2024-04-06 20:04:46,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.992406, valid_loss 0.998320, train_metric nan, valid_metric 0.029365
[852895:MainThread](2024-04-06 20:04:46,487) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.992908, valid_loss 1.000249, train_metric nan, valid_metric 0.025537
[852895:MainThread](2024-04-06 20:04:46,877) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.982964, valid_loss 0.999849, train_metric nan, valid_metric 0.026138
[852895:MainThread](2024-04-06 20:04:47,278) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.992539, valid_loss 1.000964, train_metric nan, valid_metric 0.017745
[852895:MainThread](2024-04-06 20:04:47,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.991025, valid_loss 0.999031, train_metric nan, valid_metric 0.024593
[852895:MainThread](2024-04-06 20:04:48,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.992426, valid_loss 0.997718, train_metric nan, valid_metric 0.028089
[852895:MainThread](2024-04-06 20:04:48,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.994559, valid_loss 0.999594, train_metric nan, valid_metric 0.021469
[852895:MainThread](2024-04-06 20:04:48,842) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.987662, valid_loss 0.997668, train_metric nan, valid_metric 0.025111
[852895:MainThread](2024-04-06 20:04:49,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.990277, valid_loss 0.997546, train_metric nan, valid_metric 0.031968
[852895:MainThread](2024-04-06 20:04:49,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.991889, valid_loss 0.997662, train_metric nan, valid_metric 0.032959
[852895:MainThread](2024-04-06 20:04:50,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.991608, valid_loss 0.998743, train_metric nan, valid_metric 0.028132
[852895:MainThread](2024-04-06 20:04:50,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.986817, valid_loss 0.998909, train_metric nan, valid_metric 0.030368
[852895:MainThread](2024-04-06 20:04:50,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.999374, valid_loss 0.998443, train_metric nan, valid_metric 0.029158
[852895:MainThread](2024-04-06 20:04:51,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.976497, valid_loss 0.997662, train_metric nan, valid_metric 0.029248
[852895:MainThread](2024-04-06 20:04:51,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.994587, valid_loss 0.998278, train_metric nan, valid_metric 0.032583
[852895:MainThread](2024-04-06 20:04:52,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.995468, valid_loss 0.998241, train_metric nan, valid_metric 0.032402
[852895:MainThread](2024-04-06 20:04:52,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.992200, valid_loss 1.000040, train_metric nan, valid_metric 0.026784
[852895:MainThread](2024-04-06 20:04:53,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.997344, valid_loss 0.998918, train_metric nan, valid_metric 0.029975
[852895:MainThread](2024-04-06 20:04:53,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.985960, valid_loss 0.999569, train_metric nan, valid_metric 0.027561
[852895:MainThread](2024-04-06 20:04:53,899) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.980886, valid_loss 0.997649, train_metric nan, valid_metric 0.032907
[852895:MainThread](2024-04-06 20:04:54,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.990244, valid_loss 0.998843, train_metric nan, valid_metric 0.029909
[852895:MainThread](2024-04-06 20:04:54,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.977645, valid_loss 0.999041, train_metric nan, valid_metric 0.028208
[852895:MainThread](2024-04-06 20:04:54,892) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.993268, valid_loss 0.999206, train_metric nan, valid_metric 0.027243
[852895:MainThread](2024-04-06 20:04:55,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.989633, valid_loss 0.999227, train_metric nan, valid_metric 0.028475
[852895:MainThread](2024-04-06 20:04:55,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.987504, valid_loss 0.999158, train_metric nan, valid_metric 0.029438
[852895:MainThread](2024-04-06 20:04:56,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.993043, valid_loss 0.999039, train_metric nan, valid_metric 0.029372
[852895:MainThread](2024-04-06 20:04:56,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.995806, valid_loss 0.999000, train_metric nan, valid_metric 0.029461
[852895:MainThread](2024-04-06 20:04:56,709) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.989884, valid_loss 0.999983, train_metric nan, valid_metric 0.025778
[852895:MainThread](2024-04-06 20:04:57,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.985789, valid_loss 0.999180, train_metric nan, valid_metric 0.027622
[852895:MainThread](2024-04-06 20:04:57,743) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.996867, valid_loss 0.997597, train_metric nan, valid_metric 0.029590
[852895:MainThread](2024-04-06 20:04:58,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.985696, valid_loss 0.999575, train_metric nan, valid_metric 0.023722
[852895:MainThread](2024-04-06 20:04:58,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.988009, valid_loss 0.999071, train_metric nan, valid_metric 0.028801
[852895:MainThread](2024-04-06 20:04:58,615) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.978322, valid_loss 0.999080, train_metric nan, valid_metric 0.029184
[852895:MainThread](2024-04-06 20:04:58,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.996845, valid_loss 0.999474, train_metric nan, valid_metric 0.027770
[852895:MainThread](2024-04-06 20:04:59,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.983925, valid_loss 0.998622, train_metric nan, valid_metric 0.028463
[852895:MainThread](2024-04-06 20:04:59,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.988096, valid_loss 0.998321, train_metric nan, valid_metric 0.030000
[852895:MainThread](2024-04-06 20:04:59,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.993345, valid_loss 0.997862, train_metric nan, valid_metric 0.029254
[852895:MainThread](2024-04-06 20:04:59,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 20:05:01,091) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 20:05:02,451) INFO - qlib.timer - [log.py:127] - Time cost: 0.004s | waiting `async_log` Done
train tasks:  92%|█████████▏| 23/25 [18:01<01:16, 38.29s/it][852895:MainThread](2024-04-06 20:05:02,476) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 20:05:02,510) INFO - qlib.workflow - [recorder.py:341] - Recorder 1c461ce6a15b4c55b1b62bd89de72786 starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 20:05:03,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 20:05:03,477) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 20:05:03,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 20:05:03,483) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 20:05:08,143) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 20:05:08,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.274850, valid_loss 1.075780, train_metric nan, valid_metric -0.012667
[852895:MainThread](2024-04-06 20:05:08,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.075780, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 20:05:09,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.098563, valid_loss 1.065758, train_metric nan, valid_metric 0.019831
[852895:MainThread](2024-04-06 20:05:09,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.075780 to 1.065758, save checkpoint.
[852895:MainThread](2024-04-06 20:05:09,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.063846, valid_loss 1.014869, train_metric nan, valid_metric 0.024105
[852895:MainThread](2024-04-06 20:05:09,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.065758 to 1.014869, save checkpoint.
[852895:MainThread](2024-04-06 20:05:10,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.046650, valid_loss 1.005165, train_metric nan, valid_metric 0.051521
[852895:MainThread](2024-04-06 20:05:10,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.014869 to 1.005165, save checkpoint.
[852895:MainThread](2024-04-06 20:05:10,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.034647, valid_loss 1.013784, train_metric nan, valid_metric 0.056747
[852895:MainThread](2024-04-06 20:05:10,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.068424, valid_loss 1.050965, train_metric nan, valid_metric 0.020875
[852895:MainThread](2024-04-06 20:05:10,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.041742, valid_loss 1.034336, train_metric nan, valid_metric 0.038069
[852895:MainThread](2024-04-06 20:05:11,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.041514, valid_loss 1.006140, train_metric nan, valid_metric 0.015071
[852895:MainThread](2024-04-06 20:05:11,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.024212, valid_loss 1.068976, train_metric nan, valid_metric 0.020761
[852895:MainThread](2024-04-06 20:05:12,073) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.044841, valid_loss 1.075420, train_metric nan, valid_metric 0.021404
[852895:MainThread](2024-04-06 20:05:12,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.073365, valid_loss 1.003228, train_metric nan, valid_metric 0.055271
[852895:MainThread](2024-04-06 20:05:12,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.005165 to 1.003228, save checkpoint.
[852895:MainThread](2024-04-06 20:05:13,052) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.010394, valid_loss 1.000964, train_metric nan, valid_metric 0.037124
[852895:MainThread](2024-04-06 20:05:13,052) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003228 to 1.000964, save checkpoint.
[852895:MainThread](2024-04-06 20:05:13,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.997035, valid_loss 0.994755, train_metric nan, valid_metric 0.057300
[852895:MainThread](2024-04-06 20:05:13,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000964 to 0.994755, save checkpoint.
[852895:MainThread](2024-04-06 20:05:14,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 0.995946, valid_loss 0.996566, train_metric nan, valid_metric 0.033128
[852895:MainThread](2024-04-06 20:05:14,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.002128, valid_loss 1.007149, train_metric nan, valid_metric 0.051218
[852895:MainThread](2024-04-06 20:05:15,180) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.996503, valid_loss 0.995112, train_metric nan, valid_metric 0.059932
[852895:MainThread](2024-04-06 20:05:15,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.998984, valid_loss 0.997075, train_metric nan, valid_metric 0.034766
[852895:MainThread](2024-04-06 20:05:15,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.997590, valid_loss 0.996535, train_metric nan, valid_metric 0.045438
[852895:MainThread](2024-04-06 20:05:16,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.992158, valid_loss 1.004257, train_metric nan, valid_metric 0.035618
[852895:MainThread](2024-04-06 20:05:16,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.002300, valid_loss 1.003183, train_metric nan, valid_metric 0.058071
[852895:MainThread](2024-04-06 20:05:17,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.004495, valid_loss 1.011748, train_metric nan, valid_metric -0.001242
[852895:MainThread](2024-04-06 20:05:17,779) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.999989, valid_loss 0.993767, train_metric nan, valid_metric 0.061251
[852895:MainThread](2024-04-06 20:05:17,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994755 to 0.993767, save checkpoint.
[852895:MainThread](2024-04-06 20:05:18,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.989991, valid_loss 0.994478, train_metric nan, valid_metric 0.060370
[852895:MainThread](2024-04-06 20:05:18,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.000163, valid_loss 0.994566, train_metric nan, valid_metric 0.057803
[852895:MainThread](2024-04-06 20:05:18,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.990229, valid_loss 0.997650, train_metric nan, valid_metric 0.043901
[852895:MainThread](2024-04-06 20:05:19,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.992284, valid_loss 0.997639, train_metric nan, valid_metric 0.045703
[852895:MainThread](2024-04-06 20:05:19,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.995881, valid_loss 0.993767, train_metric nan, valid_metric 0.057967
[852895:MainThread](2024-04-06 20:05:19,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.991207, valid_loss 0.997095, train_metric nan, valid_metric 0.059862
[852895:MainThread](2024-04-06 20:05:20,018) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.001744, valid_loss 1.003335, train_metric nan, valid_metric -0.004501
[852895:MainThread](2024-04-06 20:05:20,243) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.003994, valid_loss 1.017761, train_metric nan, valid_metric 0.014941
[852895:MainThread](2024-04-06 20:05:20,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.989158, valid_loss 0.995717, train_metric nan, valid_metric 0.042439
[852895:MainThread](2024-04-06 20:05:20,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.991030, valid_loss 0.995329, train_metric nan, valid_metric 0.060596
[852895:MainThread](2024-04-06 20:05:20,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.991832, valid_loss 0.996579, train_metric nan, valid_metric 0.047900
[852895:MainThread](2024-04-06 20:05:21,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.986829, valid_loss 0.999767, train_metric nan, valid_metric 0.046045
[852895:MainThread](2024-04-06 20:05:21,573) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.991655, valid_loss 0.995424, train_metric nan, valid_metric 0.048993
[852895:MainThread](2024-04-06 20:05:21,877) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.995663, valid_loss 0.995362, train_metric nan, valid_metric 0.047324
[852895:MainThread](2024-04-06 20:05:22,129) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.990562, valid_loss 0.993288, train_metric nan, valid_metric 0.066589
[852895:MainThread](2024-04-06 20:05:22,134) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993767 to 0.993288, save checkpoint.
[852895:MainThread](2024-04-06 20:05:22,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.991169, valid_loss 0.992580, train_metric nan, valid_metric 0.064866
[852895:MainThread](2024-04-06 20:05:22,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993288 to 0.992580, save checkpoint.
[852895:MainThread](2024-04-06 20:05:22,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.989325, valid_loss 0.998397, train_metric nan, valid_metric 0.049606
[852895:MainThread](2024-04-06 20:05:22,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.975514, valid_loss 0.996397, train_metric nan, valid_metric 0.044528
[852895:MainThread](2024-04-06 20:05:23,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.984866, valid_loss 0.999031, train_metric nan, valid_metric 0.042448
[852895:MainThread](2024-04-06 20:05:23,552) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.983729, valid_loss 0.993755, train_metric nan, valid_metric 0.058227
[852895:MainThread](2024-04-06 20:05:23,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.991695, valid_loss 0.994695, train_metric nan, valid_metric 0.056674
[852895:MainThread](2024-04-06 20:05:24,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.989000, valid_loss 0.994519, train_metric nan, valid_metric 0.047114
[852895:MainThread](2024-04-06 20:05:24,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.988913, valid_loss 0.994022, train_metric nan, valid_metric 0.057399
[852895:MainThread](2024-04-06 20:05:24,504) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.991869, valid_loss 0.994370, train_metric nan, valid_metric 0.057933
[852895:MainThread](2024-04-06 20:05:24,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.993583, valid_loss 0.997137, train_metric nan, valid_metric 0.042545
[852895:MainThread](2024-04-06 20:05:25,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.992487, valid_loss 0.993104, train_metric nan, valid_metric 0.060916
[852895:MainThread](2024-04-06 20:05:25,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.984749, valid_loss 0.995549, train_metric nan, valid_metric 0.049208
[852895:MainThread](2024-04-06 20:05:25,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.989400, valid_loss 0.997561, train_metric nan, valid_metric 0.033722
[852895:MainThread](2024-04-06 20:05:25,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.983392, valid_loss 0.996743, train_metric nan, valid_metric 0.041660
[852895:MainThread](2024-04-06 20:05:26,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.993962, valid_loss 0.995241, train_metric nan, valid_metric 0.042580
[852895:MainThread](2024-04-06 20:05:26,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.985252, valid_loss 0.996463, train_metric nan, valid_metric 0.034205
[852895:MainThread](2024-04-06 20:05:26,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.985698, valid_loss 0.995487, train_metric nan, valid_metric 0.047980
[852895:MainThread](2024-04-06 20:05:27,052) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.994596, valid_loss 0.995730, train_metric nan, valid_metric 0.047473
[852895:MainThread](2024-04-06 20:05:27,335) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.988227, valid_loss 0.995488, train_metric nan, valid_metric 0.044972
[852895:MainThread](2024-04-06 20:05:27,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.985592, valid_loss 1.001308, train_metric nan, valid_metric 0.013162
[852895:MainThread](2024-04-06 20:05:27,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.987478, valid_loss 0.996557, train_metric nan, valid_metric 0.046945
[852895:MainThread](2024-04-06 20:05:28,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.991208, valid_loss 0.993333, train_metric nan, valid_metric 0.057784
[852895:MainThread](2024-04-06 20:05:28,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.987187, valid_loss 0.995214, train_metric nan, valid_metric 0.045956
[852895:MainThread](2024-04-06 20:05:28,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.997604, valid_loss 0.994544, train_metric nan, valid_metric 0.052011
[852895:MainThread](2024-04-06 20:05:29,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.998967, valid_loss 0.995948, train_metric nan, valid_metric 0.049312
[852895:MainThread](2024-04-06 20:05:29,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.995515, valid_loss 0.995835, train_metric nan, valid_metric 0.047607
[852895:MainThread](2024-04-06 20:05:29,881) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.988915, valid_loss 0.993912, train_metric nan, valid_metric 0.055278
[852895:MainThread](2024-04-06 20:05:30,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.984529, valid_loss 0.994281, train_metric nan, valid_metric 0.050992
[852895:MainThread](2024-04-06 20:05:30,551) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.980694, valid_loss 0.996443, train_metric nan, valid_metric 0.037687
[852895:MainThread](2024-04-06 20:05:30,887) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.992910, valid_loss 0.995428, train_metric nan, valid_metric 0.049019
[852895:MainThread](2024-04-06 20:05:31,154) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.983793, valid_loss 0.994734, train_metric nan, valid_metric 0.057753
[852895:MainThread](2024-04-06 20:05:31,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.982014, valid_loss 0.993005, train_metric nan, valid_metric 0.059301
[852895:MainThread](2024-04-06 20:05:31,739) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.991574, valid_loss 0.992733, train_metric nan, valid_metric 0.062168
[852895:MainThread](2024-04-06 20:05:31,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.998175, valid_loss 0.994013, train_metric nan, valid_metric 0.056490
[852895:MainThread](2024-04-06 20:05:32,214) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.990315, valid_loss 0.994166, train_metric nan, valid_metric 0.052025
[852895:MainThread](2024-04-06 20:05:32,477) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.980887, valid_loss 0.994068, train_metric nan, valid_metric 0.054767
[852895:MainThread](2024-04-06 20:05:32,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.984559, valid_loss 0.993716, train_metric nan, valid_metric 0.058848
[852895:MainThread](2024-04-06 20:05:33,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.977978, valid_loss 0.992495, train_metric nan, valid_metric 0.061859
[852895:MainThread](2024-04-06 20:05:33,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.992580 to 0.992495, save checkpoint.
[852895:MainThread](2024-04-06 20:05:33,561) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.991531, valid_loss 0.993524, train_metric nan, valid_metric 0.058938
[852895:MainThread](2024-04-06 20:05:34,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.974447, valid_loss 0.993464, train_metric nan, valid_metric 0.058760
[852895:MainThread](2024-04-06 20:05:34,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.987386, valid_loss 0.995089, train_metric nan, valid_metric 0.045412
[852895:MainThread](2024-04-06 20:05:34,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.985034, valid_loss 0.995844, train_metric nan, valid_metric 0.041465
[852895:MainThread](2024-04-06 20:05:35,375) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.995190, valid_loss 0.993623, train_metric nan, valid_metric 0.057546
[852895:MainThread](2024-04-06 20:05:35,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.980565, valid_loss 0.994200, train_metric nan, valid_metric 0.056060
[852895:MainThread](2024-04-06 20:05:36,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.989295, valid_loss 0.992956, train_metric nan, valid_metric 0.062071
[852895:MainThread](2024-04-06 20:05:37,053) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.996519, valid_loss 0.994005, train_metric nan, valid_metric 0.056954
[852895:MainThread](2024-04-06 20:05:37,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.995222, valid_loss 0.994393, train_metric nan, valid_metric 0.054246
[852895:MainThread](2024-04-06 20:05:37,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.984998, valid_loss 0.996233, train_metric nan, valid_metric 0.038945
[852895:MainThread](2024-04-06 20:05:38,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.984623, valid_loss 0.994875, train_metric nan, valid_metric 0.050754
[852895:MainThread](2024-04-06 20:05:38,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.983980, valid_loss 0.994631, train_metric nan, valid_metric 0.050324
[852895:MainThread](2024-04-06 20:05:39,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.980619, valid_loss 0.994543, train_metric nan, valid_metric 0.049649
[852895:MainThread](2024-04-06 20:05:39,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.995877, valid_loss 0.994689, train_metric nan, valid_metric 0.053206
[852895:MainThread](2024-04-06 20:05:39,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.993900, valid_loss 0.994977, train_metric nan, valid_metric 0.051644
[852895:MainThread](2024-04-06 20:05:40,243) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.987644, valid_loss 0.994564, train_metric nan, valid_metric 0.053899
[852895:MainThread](2024-04-06 20:05:40,541) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.986685, valid_loss 0.995418, train_metric nan, valid_metric 0.050922
[852895:MainThread](2024-04-06 20:05:40,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.984665, valid_loss 0.995224, train_metric nan, valid_metric 0.050452
[852895:MainThread](2024-04-06 20:05:41,277) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.992173, valid_loss 0.993509, train_metric nan, valid_metric 0.057573
[852895:MainThread](2024-04-06 20:05:41,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.980920, valid_loss 0.994139, train_metric nan, valid_metric 0.053487
[852895:MainThread](2024-04-06 20:05:41,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.988079, valid_loss 0.994556, train_metric nan, valid_metric 0.053242
[852895:MainThread](2024-04-06 20:05:42,082) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.986790, valid_loss 0.994275, train_metric nan, valid_metric 0.052189
[852895:MainThread](2024-04-06 20:05:42,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.992135, valid_loss 0.994059, train_metric nan, valid_metric 0.055533
[852895:MainThread](2024-04-06 20:05:42,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.983508, valid_loss 0.994993, train_metric nan, valid_metric 0.051977
[852895:MainThread](2024-04-06 20:05:42,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.979412, valid_loss 0.994825, train_metric nan, valid_metric 0.050136
[852895:MainThread](2024-04-06 20:05:43,134) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.986440, valid_loss 0.994509, train_metric nan, valid_metric 0.054643
[852895:MainThread](2024-04-06 20:05:43,321) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.984384, valid_loss 0.993764, train_metric nan, valid_metric 0.054452
[852895:MainThread](2024-04-06 20:05:43,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.988847, valid_loss 0.994173, train_metric nan, valid_metric 0.055415
[852895:MainThread](2024-04-06 20:05:43,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.993310, valid_loss 0.995806, train_metric nan, valid_metric 0.048422
[852895:MainThread](2024-04-06 20:05:44,120) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.981268, valid_loss 0.994536, train_metric nan, valid_metric 0.054625
[852895:MainThread](2024-04-06 20:05:44,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 0.982222, valid_loss 0.995258, train_metric nan, valid_metric 0.050662
[852895:MainThread](2024-04-06 20:05:44,793) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.974224, valid_loss 0.994390, train_metric nan, valid_metric 0.055521
[852895:MainThread](2024-04-06 20:05:45,043) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 0.992262, valid_loss 0.994117, train_metric nan, valid_metric 0.053869
[852895:MainThread](2024-04-06 20:05:45,340) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 0.977461, valid_loss 0.994310, train_metric nan, valid_metric 0.049540
[852895:MainThread](2024-04-06 20:05:45,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 0.988334, valid_loss 0.994288, train_metric nan, valid_metric 0.052887
[852895:MainThread](2024-04-06 20:05:45,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 0.986941, valid_loss 0.994672, train_metric nan, valid_metric 0.052862
[852895:MainThread](2024-04-06 20:05:46,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 0.982660, valid_loss 0.994474, train_metric nan, valid_metric 0.054800
[852895:MainThread](2024-04-06 20:05:46,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 0.989496, valid_loss 0.994702, train_metric nan, valid_metric 0.053489
[852895:MainThread](2024-04-06 20:05:46,628) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 0.989260, valid_loss 0.995044, train_metric nan, valid_metric 0.051104
[852895:MainThread](2024-04-06 20:05:46,880) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 0.992694, valid_loss 0.994582, train_metric nan, valid_metric 0.054140
[852895:MainThread](2024-04-06 20:05:47,142) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 0.984869, valid_loss 0.995083, train_metric nan, valid_metric 0.048430
[852895:MainThread](2024-04-06 20:05:47,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 0.985073, valid_loss 0.994544, train_metric nan, valid_metric 0.054291
[852895:MainThread](2024-04-06 20:05:47,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 0.972848, valid_loss 0.995633, train_metric nan, valid_metric 0.044432
[852895:MainThread](2024-04-06 20:05:48,014) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 0.998548, valid_loss 0.994505, train_metric nan, valid_metric 0.049734
[852895:MainThread](2024-04-06 20:05:48,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 0.981872, valid_loss 0.994520, train_metric nan, valid_metric 0.053941
[852895:MainThread](2024-04-06 20:05:48,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 0.983605, valid_loss 0.994257, train_metric nan, valid_metric 0.051970
[852895:MainThread](2024-04-06 20:05:48,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 0.989762, valid_loss 0.994308, train_metric nan, valid_metric 0.055075
[852895:MainThread](2024-04-06 20:05:49,296) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 0.991810, valid_loss 0.994102, train_metric nan, valid_metric 0.056613
[852895:MainThread](2024-04-06 20:05:49,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 0.981928, valid_loss 0.994250, train_metric nan, valid_metric 0.052133
[852895:MainThread](2024-04-06 20:05:50,149) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 0.979722, valid_loss 0.994387, train_metric nan, valid_metric 0.054561
[852895:MainThread](2024-04-06 20:05:50,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 20:05:52,232) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 20:05:56,409) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  96%|█████████▌| 24/25 [18:55<00:42, 42.99s/it][852895:MainThread](2024-04-06 20:05:56,431) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[852895:MainThread](2024-04-06 20:05:56,461) INFO - qlib.workflow - [recorder.py:341] - Recorder 31a71376816049f0bb550dcd0185a0b5 starts running under Experiment 17 ...
[852895:MainThread](2024-04-06 20:05:58,336) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[852895:MainThread](2024-04-06 20:05:58,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[852895:MainThread](2024-04-06 20:05:58,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[852895:MainThread](2024-04-06 20:05:58,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[852895:MainThread](2024-04-06 20:06:04,995) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[852895:MainThread](2024-04-06 20:06:05,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.259148, valid_loss 1.194192, train_metric nan, valid_metric 0.009735
[852895:MainThread](2024-04-06 20:06:05,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.194192, save checkpoint.
/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:925: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[852895:MainThread](2024-04-06 20:06:05,701) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.099375, valid_loss 1.013788, train_metric nan, valid_metric 0.055068
[852895:MainThread](2024-04-06 20:06:05,701) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.194192 to 1.013788, save checkpoint.
[852895:MainThread](2024-04-06 20:06:05,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.072642, valid_loss 1.013857, train_metric nan, valid_metric 0.064186
[852895:MainThread](2024-04-06 20:06:06,167) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.041411, valid_loss 0.999973, train_metric nan, valid_metric 0.072273
[852895:MainThread](2024-04-06 20:06:06,169) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.013788 to 0.999973, save checkpoint.
[852895:MainThread](2024-04-06 20:06:06,386) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.039262, valid_loss 0.995925, train_metric nan, valid_metric 0.075220
[852895:MainThread](2024-04-06 20:06:06,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999973 to 0.995925, save checkpoint.
[852895:MainThread](2024-04-06 20:06:06,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.041475, valid_loss 0.996227, train_metric nan, valid_metric 0.060125
[852895:MainThread](2024-04-06 20:06:06,955) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.042561, valid_loss 1.001240, train_metric nan, valid_metric 0.078002
[852895:MainThread](2024-04-06 20:06:07,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.033425, valid_loss 0.998271, train_metric nan, valid_metric 0.065799
[852895:MainThread](2024-04-06 20:06:07,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.059389, valid_loss 1.020588, train_metric nan, valid_metric 0.045663
[852895:MainThread](2024-04-06 20:06:07,474) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.020450, valid_loss 0.994208, train_metric nan, valid_metric 0.069902
[852895:MainThread](2024-04-06 20:06:07,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995925 to 0.994208, save checkpoint.
[852895:MainThread](2024-04-06 20:06:07,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.014866, valid_loss 0.994111, train_metric nan, valid_metric 0.069170
[852895:MainThread](2024-04-06 20:06:07,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994208 to 0.994111, save checkpoint.
[852895:MainThread](2024-04-06 20:06:07,909) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.006838, valid_loss 0.989205, train_metric nan, valid_metric 0.088366
[852895:MainThread](2024-04-06 20:06:07,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994111 to 0.989205, save checkpoint.
[852895:MainThread](2024-04-06 20:06:08,105) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.998266, valid_loss 0.991117, train_metric nan, valid_metric 0.083103
[852895:MainThread](2024-04-06 20:06:08,261) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.005320, valid_loss 0.996026, train_metric nan, valid_metric 0.067782
[852895:MainThread](2024-04-06 20:06:08,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.991271, valid_loss 0.999783, train_metric nan, valid_metric 0.064060
[852895:MainThread](2024-04-06 20:06:08,663) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.004036, valid_loss 0.995969, train_metric nan, valid_metric 0.088704
[852895:MainThread](2024-04-06 20:06:08,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.987495, valid_loss 0.990083, train_metric nan, valid_metric 0.085369
[852895:MainThread](2024-04-06 20:06:09,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.993367, valid_loss 0.992630, train_metric nan, valid_metric 0.079125
[852895:MainThread](2024-04-06 20:06:09,327) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.988677, valid_loss 0.991829, train_metric nan, valid_metric 0.072993
[852895:MainThread](2024-04-06 20:06:09,602) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.999239, valid_loss 1.006983, train_metric nan, valid_metric 0.073674
[852895:MainThread](2024-04-06 20:06:09,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.994001, valid_loss 0.992215, train_metric nan, valid_metric 0.073255
[852895:MainThread](2024-04-06 20:06:10,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.013842, valid_loss 0.991792, train_metric nan, valid_metric 0.076421
[852895:MainThread](2024-04-06 20:06:10,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.983039, valid_loss 0.990987, train_metric nan, valid_metric 0.077615
[852895:MainThread](2024-04-06 20:06:11,444) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.992281, valid_loss 0.990447, train_metric nan, valid_metric 0.088556
[852895:MainThread](2024-04-06 20:06:11,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.991524, valid_loss 0.991560, train_metric nan, valid_metric 0.077754
[852895:MainThread](2024-04-06 20:06:12,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.004399, valid_loss 0.990861, train_metric nan, valid_metric 0.081045
[852895:MainThread](2024-04-06 20:06:12,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.983147, valid_loss 0.991164, train_metric nan, valid_metric 0.087215
[852895:MainThread](2024-04-06 20:06:12,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.987741, valid_loss 0.991272, train_metric nan, valid_metric 0.077235
[852895:MainThread](2024-04-06 20:06:13,352) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.995724, valid_loss 0.989842, train_metric nan, valid_metric 0.085438
[852895:MainThread](2024-04-06 20:06:13,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.000141, valid_loss 0.989255, train_metric nan, valid_metric 0.089639
[852895:MainThread](2024-04-06 20:06:13,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.991374, valid_loss 0.992469, train_metric nan, valid_metric 0.091549
[852895:MainThread](2024-04-06 20:06:14,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.990587, valid_loss 0.991502, train_metric nan, valid_metric 0.077676
[852895:MainThread](2024-04-06 20:06:14,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.984892, valid_loss 0.989953, train_metric nan, valid_metric 0.085176
[852895:MainThread](2024-04-06 20:06:15,084) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.985303, valid_loss 0.989528, train_metric nan, valid_metric 0.088019
[852895:MainThread](2024-04-06 20:06:15,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.997253, valid_loss 0.989243, train_metric nan, valid_metric 0.089803
[852895:MainThread](2024-04-06 20:06:15,793) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.986453, valid_loss 0.990115, train_metric nan, valid_metric 0.084328
[852895:MainThread](2024-04-06 20:06:16,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.993168, valid_loss 0.989644, train_metric nan, valid_metric 0.086347
[852895:MainThread](2024-04-06 20:06:16,508) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.991983, valid_loss 0.992495, train_metric nan, valid_metric 0.082867
[852895:MainThread](2024-04-06 20:06:16,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.989723, valid_loss 0.989959, train_metric nan, valid_metric 0.089075
[852895:MainThread](2024-04-06 20:06:17,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.993559, valid_loss 0.989879, train_metric nan, valid_metric 0.084721
[852895:MainThread](2024-04-06 20:06:17,832) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.989099, valid_loss 0.989543, train_metric nan, valid_metric 0.085167
[852895:MainThread](2024-04-06 20:06:18,437) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.980707, valid_loss 0.990604, train_metric nan, valid_metric 0.082306
[852895:MainThread](2024-04-06 20:06:18,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.994981, valid_loss 0.989977, train_metric nan, valid_metric 0.083347
[852895:MainThread](2024-04-06 20:06:19,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.978389, valid_loss 0.990031, train_metric nan, valid_metric 0.084201
[852895:MainThread](2024-04-06 20:06:19,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.984018, valid_loss 0.990658, train_metric nan, valid_metric 0.081534
[852895:MainThread](2024-04-06 20:06:19,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.988879, valid_loss 0.989612, train_metric nan, valid_metric 0.089143
[852895:MainThread](2024-04-06 20:06:20,342) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.990816, valid_loss 0.990979, train_metric nan, valid_metric 0.083211
[852895:MainThread](2024-04-06 20:06:20,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.991424, valid_loss 0.990311, train_metric nan, valid_metric 0.080361
[852895:MainThread](2024-04-06 20:06:21,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.997307, valid_loss 0.989910, train_metric nan, valid_metric 0.085693
[852895:MainThread](2024-04-06 20:06:21,899) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.990707, valid_loss 0.989661, train_metric nan, valid_metric 0.087603
[852895:MainThread](2024-04-06 20:06:22,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.986943, valid_loss 0.990194, train_metric nan, valid_metric 0.084970
[852895:MainThread](2024-04-06 20:06:22,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.995618, valid_loss 0.990020, train_metric nan, valid_metric 0.085707
[852895:MainThread](2024-04-06 20:06:23,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.994577, valid_loss 0.991602, train_metric nan, valid_metric 0.082078
[852895:MainThread](2024-04-06 20:06:23,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.986912, valid_loss 0.990401, train_metric nan, valid_metric 0.081893
[852895:MainThread](2024-04-06 20:06:24,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.980721, valid_loss 0.989166, train_metric nan, valid_metric 0.086314
[852895:MainThread](2024-04-06 20:06:24,184) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.989205 to 0.989166, save checkpoint.
[852895:MainThread](2024-04-06 20:06:24,505) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.989878, valid_loss 0.989034, train_metric nan, valid_metric 0.086501
[852895:MainThread](2024-04-06 20:06:24,510) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.989166 to 0.989034, save checkpoint.
[852895:MainThread](2024-04-06 20:06:24,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.994688, valid_loss 0.989338, train_metric nan, valid_metric 0.089821
[852895:MainThread](2024-04-06 20:06:25,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.981119, valid_loss 0.989613, train_metric nan, valid_metric 0.085610
[852895:MainThread](2024-04-06 20:06:25,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.992029, valid_loss 0.989883, train_metric nan, valid_metric 0.084898
[852895:MainThread](2024-04-06 20:06:25,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.977444, valid_loss 0.989368, train_metric nan, valid_metric 0.087224
[852895:MainThread](2024-04-06 20:06:25,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.980155, valid_loss 0.990684, train_metric nan, valid_metric 0.084210
[852895:MainThread](2024-04-06 20:06:26,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.998754, valid_loss 0.989867, train_metric nan, valid_metric 0.084766
[852895:MainThread](2024-04-06 20:06:26,394) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.981603, valid_loss 0.988950, train_metric nan, valid_metric 0.087658
[852895:MainThread](2024-04-06 20:06:26,400) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.989034 to 0.988950, save checkpoint.
[852895:MainThread](2024-04-06 20:06:26,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.996676, valid_loss 0.989983, train_metric nan, valid_metric 0.082669
[852895:MainThread](2024-04-06 20:06:26,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.989447, valid_loss 0.990193, train_metric nan, valid_metric 0.082624
[852895:MainThread](2024-04-06 20:06:27,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.977372, valid_loss 0.989414, train_metric nan, valid_metric 0.089293
[852895:MainThread](2024-04-06 20:06:27,470) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.976593, valid_loss 0.990413, train_metric nan, valid_metric 0.082417
[852895:MainThread](2024-04-06 20:06:27,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.988845, valid_loss 0.990372, train_metric nan, valid_metric 0.081237
[852895:MainThread](2024-04-06 20:06:28,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.996898, valid_loss 0.989598, train_metric nan, valid_metric 0.084137
[852895:MainThread](2024-04-06 20:06:28,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.980991, valid_loss 0.989484, train_metric nan, valid_metric 0.087992
[852895:MainThread](2024-04-06 20:06:28,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.986472, valid_loss 0.990262, train_metric nan, valid_metric 0.085813
[852895:MainThread](2024-04-06 20:06:28,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.991478, valid_loss 0.990741, train_metric nan, valid_metric 0.084971
[852895:MainThread](2024-04-06 20:06:29,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.976318, valid_loss 0.989366, train_metric nan, valid_metric 0.085370
[852895:MainThread](2024-04-06 20:06:29,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.985638, valid_loss 0.989321, train_metric nan, valid_metric 0.085845
[852895:MainThread](2024-04-06 20:06:29,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.985836, valid_loss 0.989493, train_metric nan, valid_metric 0.087946
[852895:MainThread](2024-04-06 20:06:30,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.970407, valid_loss 0.989737, train_metric nan, valid_metric 0.085141
[852895:MainThread](2024-04-06 20:06:30,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.980363, valid_loss 0.989074, train_metric nan, valid_metric 0.087413
[852895:MainThread](2024-04-06 20:06:30,705) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.984881, valid_loss 0.989277, train_metric nan, valid_metric 0.085110
[852895:MainThread](2024-04-06 20:06:31,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.992489, valid_loss 0.989336, train_metric nan, valid_metric 0.090100
[852895:MainThread](2024-04-06 20:06:31,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.990627, valid_loss 0.990019, train_metric nan, valid_metric 0.085993
[852895:MainThread](2024-04-06 20:06:31,755) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.992308, valid_loss 0.989601, train_metric nan, valid_metric 0.085366
[852895:MainThread](2024-04-06 20:06:32,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.985934, valid_loss 0.989759, train_metric nan, valid_metric 0.085505
[852895:MainThread](2024-04-06 20:06:32,612) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.988426, valid_loss 0.989761, train_metric nan, valid_metric 0.085202
[852895:MainThread](2024-04-06 20:06:32,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.986807, valid_loss 0.990053, train_metric nan, valid_metric 0.083840
[852895:MainThread](2024-04-06 20:06:33,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.998066, valid_loss 0.989687, train_metric nan, valid_metric 0.088710
[852895:MainThread](2024-04-06 20:06:33,784) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.996441, valid_loss 0.989744, train_metric nan, valid_metric 0.086454
[852895:MainThread](2024-04-06 20:06:34,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.995903, valid_loss 0.989610, train_metric nan, valid_metric 0.086263
[852895:MainThread](2024-04-06 20:06:34,746) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.979415, valid_loss 0.989437, train_metric nan, valid_metric 0.085793
[852895:MainThread](2024-04-06 20:06:35,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.989609, valid_loss 0.989410, train_metric nan, valid_metric 0.085642
[852895:MainThread](2024-04-06 20:06:35,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.993775, valid_loss 0.990042, train_metric nan, valid_metric 0.088476
[852895:MainThread](2024-04-06 20:06:35,631) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.987001, valid_loss 0.989726, train_metric nan, valid_metric 0.086734
[852895:MainThread](2024-04-06 20:06:36,005) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.991288, valid_loss 0.989808, train_metric nan, valid_metric 0.085767
[852895:MainThread](2024-04-06 20:06:36,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.989145, valid_loss 0.989570, train_metric nan, valid_metric 0.088082
[852895:MainThread](2024-04-06 20:06:36,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.990777, valid_loss 0.989760, train_metric nan, valid_metric 0.085219
[852895:MainThread](2024-04-06 20:06:37,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.990933, valid_loss 0.989943, train_metric nan, valid_metric 0.084169
[852895:MainThread](2024-04-06 20:06:37,550) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.989705, valid_loss 0.989739, train_metric nan, valid_metric 0.086250
[852895:MainThread](2024-04-06 20:06:38,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.992281, valid_loss 0.989748, train_metric nan, valid_metric 0.084186
[852895:MainThread](2024-04-06 20:06:38,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.981323, valid_loss 0.989925, train_metric nan, valid_metric 0.083073
[852895:MainThread](2024-04-06 20:06:38,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.994438, valid_loss 0.990082, train_metric nan, valid_metric 0.083951
[852895:MainThread](2024-04-06 20:06:39,505) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.984240, valid_loss 0.990019, train_metric nan, valid_metric 0.082756
[852895:MainThread](2024-04-06 20:06:40,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.987321, valid_loss 0.990632, train_metric nan, valid_metric 0.083002
[852895:MainThread](2024-04-06 20:06:40,839) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.997363, valid_loss 0.990026, train_metric nan, valid_metric 0.083004
[852895:MainThread](2024-04-06 20:06:41,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.982052, valid_loss 0.989860, train_metric nan, valid_metric 0.083350
[852895:MainThread](2024-04-06 20:06:42,014) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.986350, valid_loss 0.990027, train_metric nan, valid_metric 0.082727
[852895:MainThread](2024-04-06 20:06:42,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.984123, valid_loss 0.990009, train_metric nan, valid_metric 0.088328
[852895:MainThread](2024-04-06 20:06:42,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 0.996243, valid_loss 0.989973, train_metric nan, valid_metric 0.084230
[852895:MainThread](2024-04-06 20:06:42,868) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.989348, valid_loss 0.989791, train_metric nan, valid_metric 0.083744
[852895:MainThread](2024-04-06 20:06:43,210) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 0.987025, valid_loss 0.989702, train_metric nan, valid_metric 0.084784
[852895:MainThread](2024-04-06 20:06:43,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 0.982325, valid_loss 0.990484, train_metric nan, valid_metric 0.082646
[852895:MainThread](2024-04-06 20:06:43,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 0.992708, valid_loss 0.989791, train_metric nan, valid_metric 0.085323
[852895:MainThread](2024-04-06 20:06:44,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 0.988073, valid_loss 0.989707, train_metric nan, valid_metric 0.089309
[852895:MainThread](2024-04-06 20:06:44,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 0.992615, valid_loss 0.989821, train_metric nan, valid_metric 0.085268
[852895:MainThread](2024-04-06 20:06:44,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 0.976485, valid_loss 0.989970, train_metric nan, valid_metric 0.084381
[852895:MainThread](2024-04-06 20:06:44,767) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[852895:MainThread](2024-04-06 20:06:45,846) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[852895:MainThread](2024-04-06 20:06:46,987) INFO - qlib.timer - [log.py:127] - Time cost: 0.002s | waiting `async_log` Done
train tasks: 100%|██████████| 25/25 [19:45<00:00, 45.27s/it]train tasks: 100%|██████████| 25/25 [19:45<00:00, 47.43s/it]
[852895:MainThread](2024-04-06 20:06:47,334) INFO - qlib.timer - [log.py:127] - Time cost: 0.231s | Time to `list_recorders` in RecorderCollector Done
[852895:MainThread](2024-04-06 20:06:47,334) INFO - qlib.RecorderCollector - [collect.py:226] - Nubmer of recorders after filter: defaultdict(<class 'int'>, {'FINISHED': 25})
[852895:MainThread](2024-04-06 20:06:47,358) INFO - qlib.RollingEnsemble - [ensemble.py:81] - keys in group: ['31a71376816049f0bb550dcd0185a0b5', '1c461ce6a15b4c55b1b62bd89de72786', '19909a0165264b7da2808bff22a34c18', '4c251d86b570439e9cd6a925e1e4a965', 'b30042701dc344b4b8a31d806ba7906d', 'a082c409426d4091beee8eff43483048', '3f6353a0924d4ee4b50e3c42e6b492b4', '5e36ad034629469c87154f95806b229e', '9cb9b9bc85cc47388fee2c4695f26856', '61aae0827a724298a4b45a636d75f1c6', 'bda1680d283e40e395dfd751b9cea45b', '31eeab9719bb41e28ac866254ba43db5', '2e2e445cd5794f33abfe17444342f254', 'a687caed1b4c4299897d9fb84009db7e', '23c9679ca929492cbd5fc0c536e9adf3', 'e49bf0c2c4bf4ab39e7c048152c34846', 'f5237be4d2bf49a89999b4b4fac7e6b0', '6f275149f4ef4e0d8d5265ad73ceeaad', 'c4bc940997ae4f0e8650769505dabdec', '557c959fe34d4f289097fa94f41c67fc', 'dfe4571af187479f853dfc542260c965', '0491cef5ffeb40199dbaf44d2869c8a5', 'f278febcb3354bf09232ec8e0bb5ec1a', '00baf4e7c0f2498dad5f1d66fb4270b2', '370f8063880a4c8f8a79475263ca9cce']
[852895:MainThread](2024-04-06 20:06:47,421) INFO - qlib.RollingEnsemble - [ensemble.py:81] - keys in group: ['31a71376816049f0bb550dcd0185a0b5', '1c461ce6a15b4c55b1b62bd89de72786', '19909a0165264b7da2808bff22a34c18', '4c251d86b570439e9cd6a925e1e4a965', 'b30042701dc344b4b8a31d806ba7906d', 'a082c409426d4091beee8eff43483048', '3f6353a0924d4ee4b50e3c42e6b492b4', '5e36ad034629469c87154f95806b229e', '9cb9b9bc85cc47388fee2c4695f26856', '61aae0827a724298a4b45a636d75f1c6', 'bda1680d283e40e395dfd751b9cea45b', '31eeab9719bb41e28ac866254ba43db5', '2e2e445cd5794f33abfe17444342f254', 'a687caed1b4c4299897d9fb84009db7e', '23c9679ca929492cbd5fc0c536e9adf3', 'e49bf0c2c4bf4ab39e7c048152c34846', 'f5237be4d2bf49a89999b4b4fac7e6b0', '6f275149f4ef4e0d8d5265ad73ceeaad', 'c4bc940997ae4f0e8650769505dabdec', '557c959fe34d4f289097fa94f41c67fc', 'dfe4571af187479f853dfc542260c965', '0491cef5ffeb40199dbaf44d2869c8a5', 'f278febcb3354bf09232ec8e0bb5ec1a', '00baf4e7c0f2498dad5f1d66fb4270b2', '370f8063880a4c8f8a79475263ca9cce']
[852895:MainThread](2024-04-06 20:06:47,505) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name mlp_20240406192200670373223.
[852895:MainThread](2024-04-06 20:06:47,526) INFO - qlib.workflow - [exp.py:258] - Experiment 20 starts running ...
[852895:MainThread](2024-04-06 20:06:47,541) INFO - qlib.workflow - [recorder.py:341] - Recorder b8e9f43430664f6a9f90ec6349a81c32 starts running under Experiment 20 ...
[852895:MainThread](2024-04-06 20:06:48,255) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
[852895:MainThread](2024-04-06 20:06:49,268) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-04-27 SH600000   -0.036029
           SH600009    0.032053
           SH600010    0.070628
           SH600011    0.090186
           SH600015    0.022393
Epoch 00620: reducing learning rate of group 0 to 1.0000e-03.
Epoch 01240: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01460: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01680: reducing learning rate of group 0 to 1.2500e-04.
Epoch 01900: reducing learning rate of group 0 to 6.2500e-05.
Epoch 02120: reducing learning rate of group 0 to 3.1250e-05.
Epoch 02400: reducing learning rate of group 0 to 1.5625e-05.
Epoch 02620: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-05-30 SH600000   -0.047656
           SH600009    0.081352
           SH600010   -0.029389
           SH600011    0.024168
           SH600015   -0.106566
Epoch 00900: reducing learning rate of group 0 to 1.0000e-03.
Epoch 01120: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01340: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01560: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-06-29 SH600000   -0.043412
           SH600009    0.123264
           SH600010   -0.005861
           SH600011    0.103820
           SH600015    0.019661
Epoch 00420: reducing learning rate of group 0 to 1.0000e-03.
Epoch 00640: reducing learning rate of group 0 to 5.0000e-04.
Epoch 00860: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01080: reducing learning rate of group 0 to 1.2500e-04.
Epoch 01300: reducing learning rate of group 0 to 6.2500e-05.
Epoch 01520: reducing learning rate of group 0 to 3.1250e-05.
Epoch 01740: reducing learning rate of group 0 to 1.5625e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-07-27 SH600000    0.073625
           SH600009    0.018088
           SH600010    0.013885
           SH600011    0.099179
           SH600015    0.072114
Epoch 00980: reducing learning rate of group 0 to 1.0000e-03.
Epoch 01200: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01420: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01680: reducing learning rate of group 0 to 1.2500e-04.
Epoch 01900: reducing learning rate of group 0 to 6.2500e-05.
Epoch 02120: reducing learning rate of group 0 to 3.1250e-05.
Epoch 02340: reducing learning rate of group 0 to 1.5625e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-08-24 SH600000    0.003167
           SH600009   -0.022358
           SH600010   -0.113848
           SH600011    0.060024
           SH600015    0.047865
Epoch 00520: reducing learning rate of group 0 to 1.0000e-03.
Epoch 00800: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01020: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01240: reducing learning rate of group 0 to 1.2500e-04.
Epoch 01460: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-09-21 SH600000   -0.108326
           SH600009    0.025873
           SH600010   -0.034083
           SH600011    0.080532
           SH600015    0.008402
Epoch 00780: reducing learning rate of group 0 to 1.0000e-03.
Epoch 01000: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01220: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01440: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-10-27 SH600000    0.116157
           SH600009    0.004193
           SH600010    0.128547
           SH600011    0.027279
           SH600015   -0.006290
Epoch 00780: reducing learning rate of group 0 to 1.0000e-03.
Epoch 01000: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01220: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01440: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-11-24 SH600000    0.076739
           SH600009   -0.065559
           SH600010    0.042535
           SH600011   -0.053459
           SH600015    0.068469
Epoch 00520: reducing learning rate of group 0 to 1.0000e-03.
Epoch 00800: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01020: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01240: reducing learning rate of group 0 to 1.2500e-04.
Epoch 01460: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-12-22 SH600000   -0.028910
           SH600009   -0.012865
           SH600010   -0.040139
           SH600011    0.045372
           SH600015    0.096568
Epoch 00520: reducing learning rate of group 0 to 1.0000e-03.
Epoch 00840: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01160: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01380: reducing learning rate of group 0 to 1.2500e-04.
Epoch 01600: reducing learning rate of group 0 to 6.2500e-05.
Epoch 01820: reducing learning rate of group 0 to 3.1250e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2024-01-22 SH600000   -0.037272
           SH600009    0.033732
           SH600010    0.021961
           SH600011    0.094001
           SH600015    0.074246
Epoch 00660: reducing learning rate of group 0 to 1.0000e-03.
Epoch 00980: reducing learning rate of group 0 to 5.0000e-04.
Epoch 01200: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01420: reducing learning rate of group 0 to 1.2500e-04.
Epoch 01640: reducing learning rate of group 0 to 6.2500e-05.
Epoch 01860: reducing learning rate of group 0 to 3.1250e-05.
Epoch 02080: reducing learning rate of group 0 to 1.5625e-05.
Epoch 02300: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2024-02-27 SH600000    0.139930
           SH600009    0.065588
           SH600010    0.075340
           SH600011    0.171317
           SH600015    0.071786
Epoch 00460: reducing learning rate of group 0 to 1.0000e-03.
Epoch 00680: reducing learning rate of group 0 to 5.0000e-04.
Epoch 00900: reducing learning rate of group 0 to 2.5000e-04.
Epoch 01340: reducing learning rate of group 0 to 1.2500e-04.
Epoch 01560: reducing learning rate of group 0 to 6.2500e-05.
Epoch 01780: reducing learning rate of group 0 to 3.1250e-05.
Epoch 02000: reducing learning rate of group 0 to 1.5625e-05.
Epoch 02220: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2024-03-26 SH600000    0.065054
           SH600009    0.126491
           SH600010   -0.125381
           SH600011    0.029871
           SH600015    0.050195
{'IC': 0.07704908221378798,
 'ICIR': 0.560847527890373,
 'Rank IC': 0.08669428907419884,
 'Rank ICIR': 0.6654647211807906}
[852895:MainThread](2024-04-06 20:07:14,904) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[852895:MainThread](2024-04-06 20:07:14,909) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[852895:MainThread](2024-04-06 20:07:28,044) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7ff6dc7e87c0>
backtest loop:   0%|          | 0/485 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/exp_qlib_env/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 5/485 [00:00<00:09, 48.80it/s]backtest loop:   2%|▏         | 10/485 [00:00<00:10, 46.39it/s]backtest loop:   3%|▎         | 15/485 [00:00<00:10, 46.97it/s]backtest loop:   4%|▍         | 20/485 [00:00<00:09, 46.57it/s]backtest loop:   5%|▌         | 25/485 [00:00<00:09, 46.09it/s]backtest loop:   6%|▌         | 30/485 [00:00<00:10, 45.40it/s]backtest loop:   7%|▋         | 35/485 [00:00<00:13, 33.13it/s]backtest loop:   8%|▊         | 39/485 [00:01<00:13, 33.00it/s]backtest loop:   9%|▉         | 44/485 [00:01<00:12, 35.96it/s]backtest loop:  10%|█         | 49/485 [00:01<00:11, 39.12it/s]backtest loop:  11%|█         | 54/485 [00:01<00:10, 41.82it/s]backtest loop:  12%|█▏        | 59/485 [00:01<00:09, 43.31it/s]backtest loop:  13%|█▎        | 64/485 [00:01<00:09, 44.64it/s]backtest loop:  14%|█▍        | 69/485 [00:01<00:09, 45.67it/s]backtest loop:  15%|█▌        | 74/485 [00:01<00:09, 43.20it/s]backtest loop:  16%|█▋        | 79/485 [00:01<00:09, 43.65it/s]backtest loop:  17%|█▋        | 84/485 [00:02<00:10, 39.58it/s]backtest loop:  18%|█▊        | 89/485 [00:02<00:10, 38.60it/s]backtest loop:  19%|█▉        | 94/485 [00:02<00:09, 40.75it/s]backtest loop:  21%|██        | 100/485 [00:02<00:09, 41.90it/s]backtest loop:  22%|██▏       | 106/485 [00:02<00:08, 45.18it/s]backtest loop:  23%|██▎       | 112/485 [00:02<00:07, 47.66it/s]backtest loop:  24%|██▍       | 118/485 [00:02<00:07, 49.67it/s]backtest loop:  26%|██▌       | 124/485 [00:02<00:08, 44.87it/s]backtest loop:  27%|██▋       | 129/485 [00:03<00:08, 41.09it/s]backtest loop:  28%|██▊       | 135/485 [00:03<00:07, 44.86it/s]backtest loop:  29%|██▉       | 141/485 [00:03<00:07, 47.02it/s]backtest loop:  30%|███       | 146/485 [00:03<00:07, 44.12it/s]backtest loop:  31%|███       | 151/485 [00:03<00:08, 40.80it/s]backtest loop:  32%|███▏      | 156/485 [00:03<00:07, 42.83it/s]backtest loop:  33%|███▎      | 161/485 [00:03<00:07, 43.64it/s]backtest loop:  34%|███▍      | 167/485 [00:03<00:06, 46.63it/s]backtest loop:  36%|███▌      | 173/485 [00:03<00:06, 48.54it/s]backtest loop:  37%|███▋      | 178/485 [00:04<00:06, 48.80it/s]backtest loop:  38%|███▊      | 184/485 [00:04<00:06, 43.56it/s]backtest loop:  39%|███▉      | 189/485 [00:04<00:07, 41.24it/s]backtest loop:  40%|████      | 194/485 [00:04<00:07, 41.33it/s]backtest loop:  41%|████      | 200/485 [00:04<00:06, 45.51it/s]backtest loop:  42%|████▏     | 206/485 [00:04<00:05, 48.10it/s]backtest loop:  44%|████▎     | 212/485 [00:04<00:05, 49.35it/s]backtest loop:  45%|████▍     | 218/485 [00:05<00:06, 43.53it/s]backtest loop:  46%|████▌     | 223/485 [00:05<00:06, 39.23it/s]backtest loop:  47%|████▋     | 228/485 [00:05<00:07, 35.24it/s]backtest loop:  48%|████▊     | 232/485 [00:05<00:07, 34.80it/s]backtest loop:  49%|████▊     | 236/485 [00:05<00:07, 31.54it/s]backtest loop:  49%|████▉     | 240/485 [00:05<00:08, 29.88it/s]backtest loop:  50%|█████     | 244/485 [00:05<00:08, 27.89it/s]backtest loop:  51%|█████     | 247/485 [00:06<00:09, 25.05it/s]backtest loop:  52%|█████▏    | 251/485 [00:06<00:08, 28.08it/s]backtest loop:  52%|█████▏    | 254/485 [00:06<00:08, 27.27it/s]backtest loop:  53%|█████▎    | 257/485 [00:06<00:09, 23.07it/s]backtest loop:  54%|█████▎    | 260/485 [00:06<00:11, 20.38it/s]backtest loop:  54%|█████▍    | 263/485 [00:06<00:12, 18.32it/s]backtest loop:  55%|█████▍    | 265/485 [00:07<00:13, 16.67it/s]backtest loop:  55%|█████▌    | 269/485 [00:07<00:11, 19.29it/s]backtest loop:  56%|█████▋    | 274/485 [00:07<00:08, 24.05it/s]backtest loop:  57%|█████▋    | 278/485 [00:07<00:07, 27.34it/s]backtest loop:  58%|█████▊    | 281/485 [00:07<00:07, 27.21it/s]backtest loop:  59%|█████▊    | 284/485 [00:07<00:07, 26.52it/s]backtest loop:  59%|█████▉    | 287/485 [00:07<00:07, 24.86it/s]backtest loop:  60%|█████▉    | 290/485 [00:08<00:09, 19.92it/s]backtest loop:  60%|██████    | 293/485 [00:08<00:10, 18.96it/s]backtest loop:  61%|██████    | 296/485 [00:08<00:12, 15.43it/s]backtest loop:  61%|██████▏   | 298/485 [00:08<00:13, 13.69it/s]backtest loop:  62%|██████▏   | 300/485 [00:08<00:12, 14.54it/s]backtest loop:  62%|██████▏   | 302/485 [00:09<00:14, 12.69it/s]backtest loop:  63%|██████▎   | 304/485 [00:09<00:13, 13.69it/s]backtest loop:  63%|██████▎   | 307/485 [00:09<00:11, 15.52it/s]backtest loop:  64%|██████▍   | 312/485 [00:09<00:08, 20.36it/s]backtest loop:  65%|██████▌   | 317/485 [00:09<00:06, 24.08it/s]backtest loop:  66%|██████▌   | 320/485 [00:09<00:07, 21.77it/s]backtest loop:  67%|██████▋   | 323/485 [00:10<00:09, 16.48it/s]backtest loop:  67%|██████▋   | 327/485 [00:10<00:08, 19.27it/s]backtest loop:  68%|██████▊   | 331/485 [00:10<00:07, 20.73it/s]backtest loop:  69%|██████▉   | 334/485 [00:10<00:07, 19.69it/s]backtest loop:  69%|██████▉   | 337/485 [00:10<00:07, 19.00it/s]backtest loop:  70%|██████▉   | 339/485 [00:10<00:07, 18.85it/s]backtest loop:  71%|███████   | 342/485 [00:11<00:08, 16.36it/s]backtest loop:  71%|███████   | 344/485 [00:11<00:08, 16.93it/s]backtest loop:  72%|███████▏  | 347/485 [00:11<00:07, 17.46it/s]backtest loop:  73%|███████▎  | 352/485 [00:11<00:05, 22.92it/s]backtest loop:  73%|███████▎  | 356/485 [00:11<00:05, 24.93it/s]backtest loop:  74%|███████▍  | 359/485 [00:11<00:05, 21.44it/s]backtest loop:  75%|███████▍  | 362/485 [00:12<00:06, 18.88it/s]backtest loop:  75%|███████▌  | 366/485 [00:12<00:05, 19.89it/s]backtest loop:  76%|███████▌  | 369/485 [00:12<00:06, 18.92it/s]backtest loop:  77%|███████▋  | 372/485 [00:12<00:05, 20.38it/s]backtest loop:  78%|███████▊  | 376/485 [00:12<00:04, 22.42it/s]backtest loop:  78%|███████▊  | 379/485 [00:12<00:04, 23.54it/s]backtest loop:  79%|███████▉  | 382/485 [00:13<00:06, 17.03it/s]backtest loop:  79%|███████▉  | 385/485 [00:13<00:05, 19.15it/s]backtest loop:  80%|████████  | 388/485 [00:13<00:06, 15.43it/s]backtest loop:  81%|████████  | 391/485 [00:13<00:06, 14.67it/s]backtest loop:  81%|████████  | 393/485 [00:13<00:06, 14.25it/s]backtest loop:  81%|████████▏ | 395/485 [00:14<00:06, 12.94it/s]backtest loop:  82%|████████▏ | 397/485 [00:14<00:08,  9.87it/s]backtest loop:  83%|████████▎ | 401/485 [00:14<00:06, 12.63it/s]backtest loop:  84%|████████▎ | 405/485 [00:14<00:04, 16.85it/s]backtest loop:  84%|████████▍ | 408/485 [00:14<00:04, 18.50it/s]backtest loop:  85%|████████▍ | 411/485 [00:15<00:04, 16.27it/s]backtest loop:  85%|████████▌ | 413/485 [00:15<00:04, 16.16it/s]backtest loop:  86%|████████▌ | 415/485 [00:15<00:04, 15.74it/s]backtest loop:  86%|████████▌ | 417/485 [00:15<00:05, 13.17it/s]backtest loop:  86%|████████▋ | 419/485 [00:15<00:04, 13.69it/s]backtest loop:  87%|████████▋ | 421/485 [00:15<00:05, 11.37it/s]backtest loop:  88%|████████▊ | 426/485 [00:16<00:03, 17.69it/s]backtest loop:  89%|████████▊ | 430/485 [00:16<00:02, 21.80it/s]backtest loop:  90%|████████▉ | 435/485 [00:16<00:01, 26.27it/s]backtest loop:  91%|█████████ | 440/485 [00:16<00:01, 29.81it/s]backtest loop:  92%|█████████▏| 444/485 [00:16<00:01, 28.82it/s]backtest loop:  92%|█████████▏| 448/485 [00:16<00:01, 20.04it/s]backtest loop:  93%|█████████▎| 452/485 [00:17<00:01, 23.14it/s]backtest loop:  94%|█████████▍| 456/485 [00:17<00:01, 25.97it/s]backtest loop:  95%|█████████▍| 460/485 [00:17<00:00, 28.51it/s]backtest loop:  96%|█████████▌| 464/485 [00:17<00:00, 30.55it/s]backtest loop:  96%|█████████▋| 468/485 [00:17<00:00, 23.99it/s]backtest loop:  97%|█████████▋| 471/485 [00:17<00:00, 19.65it/s]backtest loop:  98%|█████████▊| 475/485 [00:17<00:00, 22.99it/s]backtest loop:  99%|█████████▉| 479/485 [00:18<00:00, 26.17it/s]backtest loop: 100%|█████████▉| 484/485 [00:18<00:00, 29.81it/s]backtest loop: 100%|██████████| 485/485 [00:18<00:00, 26.62it/s]
[852895:MainThread](2024-04-06 20:07:46,349) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 20
[852895:MainThread](2024-04-06 20:07:46,389) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 20
[852895:MainThread](2024-04-06 20:07:47,186) INFO - qlib.Rolling - [base.py:233] - Your evaluation results can be found in the experiment named `mlp_20240406192200670373223`, rid=b8e9f43430664f6a9f90ec6349a81c32
'The following are analysis results of benchmark return(1day).'
                       risk
mean              -0.000278
std                0.010303
annualized_return -0.066260
information_ratio -0.416884
max_drawdown      -0.328619
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000762
std                0.004931
annualized_return  0.181237
information_ratio  2.382545
max_drawdown      -0.047393
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000561
std                0.004928
annualized_return  0.133580
information_ratio  1.756888
max_drawdown      -0.060722
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0

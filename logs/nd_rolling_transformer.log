[4163996:MainThread](2024-04-06 16:59:54,317) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[4163996:MainThread](2024-04-06 16:59:54,319) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[4163996:MainThread](2024-04-06 16:59:54,320) INFO - qlib.Initialization - [__init__.py:76] - data_path={'day': PosixPath('/home/zhonghao/.qlib/qlib_data/my_data')}
[4163996:MainThread](2024-04-06 16:59:54,322) WARNING - qlib.Rolling - [rolling_benchmark.py:32] - Model type is not in the benchmark!
[4163996:MainThread](2024-04-06 16:59:54,334) INFO - qlib.Rolling - [base.py:162] - The prediction horizon is overrided
[4163996:MainThread](2024-04-06 16:59:54,335) INFO - qlib.Rolling - [base.py:173] - {'model': {'class': 'TransformerModel', 'module_path': 'qlib.contrib.model.pytorch_transformer_ts', 'kwargs': {'seed': 0, 'n_jobs': 20, 'GPU': 1}}, 'dataset': {'class': 'TSDatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/code/qlib/exp_yaml/new_data/Alpha158.0e6ab4cf23.pkl', 'segments': {'train': [datetime.date(2009, 1, 1), datetime.date(2018, 12, 31)], 'valid': [datetime.date(2019, 1, 1), datetime.date(2019, 12, 31)], 'test': [datetime.date(2020, 1, 1), datetime.date(2024, 3, 26)]}, 'step_len': 20}}, 'record': [{'class': 'SignalRecord', 'module_path': 'qlib.workflow.record_temp', 'kwargs': {'model': '<MODEL>', 'dataset': '<DATASET>'}}, {'class': 'SigAnaRecord', 'module_path': 'qlib.workflow.record_temp', 'kwargs': {'ana_long_short': False, 'ann_scaler': 252}}, {'class': 'PortAnaRecord', 'module_path': 'qlib.workflow.record_temp', 'kwargs': {'config': {'strategy': {'class': 'TopkDropoutStrategy', 'module_path': 'qlib.contrib.strategy', 'kwargs': {'signal': '<PRED>', 'topk': 50, 'n_drop': 5}}, 'backtest': {'start_time': datetime.date(2020, 1, 1), 'end_time': datetime.date(2024, 3, 26), 'account': 100000000, 'benchmark': 'SH000300', 'exchange_kwargs': {'limit_threshold': 0.095, 'deal_price': 'close', 'open_cost': 0.0005, 'close_cost': 0.0015, 'min_cost': 5}}}}}]}
[4163996:MainThread](2024-04-06 16:59:54,382) INFO - qlib.Rolling - [base.py:190] - Deleting previous Rolling results
[4163996:MainThread](2024-04-06 16:59:54,389) INFO - qlib.Rolling - [base.py:196] - No previous rolling results
train tasks:   0%|          | 0/52 [00:00<?, ?it/s][4163996:MainThread](2024-04-06 16:59:54,395) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name rolling_models_20240406165954.
[4163996:MainThread](2024-04-06 16:59:54,407) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 16:59:54,503) INFO - qlib.workflow - [recorder.py:341] - Recorder 33de6b94c31b40498c364f489e16272c starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 16:59:56,000) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:00:03,964) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:00:07,700) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:00:07,700) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:00:07,702) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
ModuleNotFoundError. CatBoostModel are skipped. (optional: maybe installing CatBoostModel can fix it.)
[4163996:MainThread](2024-04-06 17:00:18,923) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:00:31,581) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.985762, valid -0.988730
[4163996:MainThread](2024-04-06 17:00:31,585) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 17:00:31,585) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:00:42,296) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:00:55,039) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981030, valid -0.989292
[4163996:MainThread](2024-04-06 17:00:55,039) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 17:00:55,040) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:01:06,009) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:01:18,583) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979435, valid -0.989727
[4163996:MainThread](2024-04-06 17:01:18,584) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 17:01:18,584) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:01:29,020) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:01:42,060) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975931, valid -0.993183
[4163996:MainThread](2024-04-06 17:01:42,060) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 17:01:42,060) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:01:52,443) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:02:05,110) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972877, valid -0.992213
[4163996:MainThread](2024-04-06 17:02:05,111) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 17:02:05,111) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:02:15,991) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:02:29,206) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970704, valid -0.990613
[4163996:MainThread](2024-04-06 17:02:29,207) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 17:02:29,207) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.988730 @ 0
[4163996:MainThread](2024-04-06 17:02:40,510) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 17:02:41,392) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   2%|▏         | 1/52 [02:47<2:21:57, 167.01s/it][4163996:MainThread](2024-04-06 17:02:41,403) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 17:02:41,418) INFO - qlib.workflow - [recorder.py:341] - Recorder 33a75c87be80453c9eba52b45d0f6661 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 17:02:42,139) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:02:42,789) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:02:46,891) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:02:46,892) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:02:46,892) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2020-01-02 SH600000    0.096650
2020-01-03 SH600000   -0.008199
2020-01-06 SH600000    0.071815
2020-01-07 SH600000    0.065116
2020-01-08 SH600000    0.098521
[4163996:MainThread](2024-04-06 17:02:57,579) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:03:10,471) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986370, valid -0.987887
[4163996:MainThread](2024-04-06 17:03:10,474) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 17:03:10,475) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:03:21,435) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:03:34,705) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981571, valid -0.988687
[4163996:MainThread](2024-04-06 17:03:34,706) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 17:03:34,707) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:03:45,452) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:03:58,913) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978380, valid -0.991412
[4163996:MainThread](2024-04-06 17:03:58,913) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 17:03:58,914) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:04:09,574) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:04:23,088) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976397, valid -0.990938
[4163996:MainThread](2024-04-06 17:04:23,089) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 17:04:23,089) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:04:33,600) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:04:46,990) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973404, valid -0.994650
[4163996:MainThread](2024-04-06 17:04:46,990) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 17:04:46,991) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:04:57,539) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:05:10,420) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972230, valid -0.991346
[4163996:MainThread](2024-04-06 17:05:10,420) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 17:05:10,421) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.987887 @ 0
[4163996:MainThread](2024-04-06 17:05:13,913) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 17:05:14,808) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   4%|▍         | 2/52 [05:20<2:12:30, 159.01s/it][4163996:MainThread](2024-04-06 17:05:14,820) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 17:05:14,836) INFO - qlib.workflow - [recorder.py:341] - Recorder 968e61e2c7ee4001819bc5dfacf06971 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 17:05:15,563) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:05:16,178) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:05:19,806) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:05:19,807) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:05:19,807) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2020-02-07 SH600000    0.016408
2020-02-10 SH600000    0.073944
2020-02-11 SH600000    0.096281
2020-02-12 SH600000    0.079926
2020-02-13 SH600000    0.080296
[4163996:MainThread](2024-04-06 17:05:30,520) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:05:43,949) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986695, valid -0.986906
[4163996:MainThread](2024-04-06 17:05:43,954) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 17:05:43,954) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:05:55,093) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:06:08,415) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982573, valid -0.988033
[4163996:MainThread](2024-04-06 17:06:08,415) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 17:06:08,416) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:06:19,293) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:06:32,788) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979205, valid -0.990544
[4163996:MainThread](2024-04-06 17:06:32,788) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 17:06:32,789) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:06:43,710) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:06:57,010) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977459, valid -0.995322
[4163996:MainThread](2024-04-06 17:06:57,010) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 17:06:57,010) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:07:07,565) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:07:21,053) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974354, valid -0.989540
[4163996:MainThread](2024-04-06 17:07:21,053) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 17:07:21,054) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:07:32,376) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:07:46,773) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972100, valid -0.991096
[4163996:MainThread](2024-04-06 17:07:46,774) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 17:07:46,774) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.986906 @ 0
[4163996:MainThread](2024-04-06 17:07:50,240) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 17:07:51,153) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   6%|▌         | 3/52 [07:56<2:08:51, 157.79s/it][4163996:MainThread](2024-04-06 17:07:51,164) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 17:07:51,180) INFO - qlib.workflow - [recorder.py:341] - Recorder aa25195d07a04b7aa2a21f0342727b15 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 17:07:51,913) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:07:52,511) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:07:56,316) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:07:56,316) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:07:56,317) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2020-03-06 SH600000    0.098125
2020-03-09 SH600000    0.116013
2020-03-10 SH600000    0.117985
2020-03-11 SH600000    0.129686
2020-03-12 SH600000    0.115153
[4163996:MainThread](2024-04-06 17:08:06,639) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:08:20,029) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986584, valid -0.987801
[4163996:MainThread](2024-04-06 17:08:20,032) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 17:08:20,033) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:08:30,853) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:08:43,719) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981780, valid -0.989142
[4163996:MainThread](2024-04-06 17:08:43,720) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 17:08:43,720) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:08:54,672) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:09:08,219) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978730, valid -0.990534
[4163996:MainThread](2024-04-06 17:09:08,220) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 17:09:08,220) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:09:19,315) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:09:32,763) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975971, valid -0.988998
[4163996:MainThread](2024-04-06 17:09:32,764) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 17:09:32,764) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:09:43,719) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:09:56,917) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978739, valid -1.003205
[4163996:MainThread](2024-04-06 17:09:56,918) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 17:09:56,918) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:10:08,010) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:10:21,353) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971120, valid -0.993596
[4163996:MainThread](2024-04-06 17:10:21,353) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 17:10:21,353) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.987801 @ 0
[4163996:MainThread](2024-04-06 17:10:24,959) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 17:10:25,774) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   8%|▊         | 4/52 [10:31<2:05:13, 156.54s/it][4163996:MainThread](2024-04-06 17:10:25,785) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 17:10:25,800) INFO - qlib.workflow - [recorder.py:341] - Recorder 577fd27a49424c8a9c82258ea2dce314 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 17:10:26,576) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:10:27,152) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:10:30,794) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:10:30,794) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:10:30,795) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2020-04-03 SH600000    0.075483
2020-04-07 SH600000    0.072634
2020-04-08 SH600000    0.079325
2020-04-09 SH600000    0.037543
2020-04-10 SH600000    0.036543
[4163996:MainThread](2024-04-06 17:10:41,523) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:10:54,840) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.985856, valid -0.989210
[4163996:MainThread](2024-04-06 17:10:54,844) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 17:10:54,844) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:11:06,335) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:11:19,558) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981446, valid -0.988249
[4163996:MainThread](2024-04-06 17:11:19,563) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 17:11:19,564) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:11:30,745) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:11:45,245) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978480, valid -0.991799
[4163996:MainThread](2024-04-06 17:11:45,245) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 17:11:45,246) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:11:56,327) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:12:10,621) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975112, valid -0.993508
[4163996:MainThread](2024-04-06 17:12:10,621) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 17:12:10,622) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:12:21,929) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:12:36,036) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976360, valid -0.995155
[4163996:MainThread](2024-04-06 17:12:36,037) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 17:12:36,037) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:12:47,303) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:13:01,203) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971765, valid -1.002396
[4163996:MainThread](2024-04-06 17:13:01,203) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 17:13:01,204) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:13:12,240) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:13:26,709) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970724, valid -0.997173
[4163996:MainThread](2024-04-06 17:13:26,709) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 17:13:26,709) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.988249 @ 1
[4163996:MainThread](2024-04-06 17:13:30,262) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 17:13:31,006) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  10%|▉         | 5/52 [13:36<2:10:43, 166.89s/it][4163996:MainThread](2024-04-06 17:13:31,018) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 17:13:31,033) INFO - qlib.workflow - [recorder.py:341] - Recorder 83ebb2fd8ea543fab1f7dd816ca6b3cc starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 17:13:31,788) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:13:32,398) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:13:36,179) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:13:36,179) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:13:36,180) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2020-05-07 SH600000   -0.000946
2020-05-08 SH600000   -0.047445
2020-05-11 SH600000   -0.046638
2020-05-12 SH600000   -0.011460
2020-05-13 SH600000    0.012132
[4163996:MainThread](2024-04-06 17:13:47,423) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:14:00,794) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986475, valid -0.987080
[4163996:MainThread](2024-04-06 17:14:00,797) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 17:14:00,798) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:14:11,785) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:14:25,727) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981367, valid -0.987604
[4163996:MainThread](2024-04-06 17:14:25,728) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 17:14:25,728) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:14:37,189) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:14:50,758) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978372, valid -0.993450
[4163996:MainThread](2024-04-06 17:14:50,758) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 17:14:50,759) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:15:01,980) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:15:16,116) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976192, valid -0.989877
[4163996:MainThread](2024-04-06 17:15:16,116) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 17:15:16,117) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:15:27,546) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:15:41,729) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974004, valid -0.996552
[4163996:MainThread](2024-04-06 17:15:41,729) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 17:15:41,730) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:15:53,364) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:16:07,587) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971181, valid -0.992098
[4163996:MainThread](2024-04-06 17:16:07,587) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 17:16:07,588) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.987080 @ 0
[4163996:MainThread](2024-04-06 17:16:11,260) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 17:16:12,182) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  12%|█▏        | 6/52 [16:17<2:06:27, 164.95s/it][4163996:MainThread](2024-04-06 17:16:12,193) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 17:16:12,208) INFO - qlib.workflow - [recorder.py:341] - Recorder 4b5285a0bf074589897d3aacab992e50 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 17:16:12,939) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:16:13,559) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:16:17,536) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:16:17,536) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:16:17,536) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2020-06-04 SH600000    0.060785
2020-06-05 SH600000    0.004079
2020-06-08 SH600000    0.054320
2020-06-09 SH600000    0.033279
2020-06-10 SH600000    0.032644
[4163996:MainThread](2024-04-06 17:16:28,672) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:16:42,852) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.985759, valid -0.987895
[4163996:MainThread](2024-04-06 17:16:42,856) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 17:16:42,856) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:16:54,077) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:17:08,833) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981792, valid -0.995901
[4163996:MainThread](2024-04-06 17:17:08,834) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 17:17:08,834) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:17:21,177) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:17:34,739) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977963, valid -0.994231
[4163996:MainThread](2024-04-06 17:17:34,740) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 17:17:34,740) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:17:46,084) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:18:00,284) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975366, valid -0.994248
[4163996:MainThread](2024-04-06 17:18:00,285) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 17:18:00,285) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:18:11,295) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:18:24,502) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972961, valid -0.993498
[4163996:MainThread](2024-04-06 17:18:24,502) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 17:18:24,503) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:18:36,032) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:18:50,136) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971150, valid -0.996510
[4163996:MainThread](2024-04-06 17:18:50,136) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 17:18:50,137) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.987895 @ 0
[4163996:MainThread](2024-04-06 17:18:53,893) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 17:18:54,847) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  13%|█▎        | 7/52 [19:00<2:03:09, 164.20s/it][4163996:MainThread](2024-04-06 17:18:54,859) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 17:18:54,874) INFO - qlib.workflow - [recorder.py:341] - Recorder 84573874623f4794ad394437c28f1ada starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 17:18:55,680) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:18:56,310) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:19:00,105) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:19:00,105) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:19:00,105) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2020-07-06 SH600000   -0.076205
2020-07-07 SH600000   -0.027492
2020-07-08 SH600000   -0.029606
2020-07-09 SH600000    0.003874
2020-07-10 SH600000   -0.006699
[4163996:MainThread](2024-04-06 17:19:11,339) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:19:25,755) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.985560, valid -0.992969
[4163996:MainThread](2024-04-06 17:19:25,759) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 17:19:25,760) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:19:37,229) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:19:51,546) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981289, valid -0.994958
[4163996:MainThread](2024-04-06 17:19:51,547) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 17:19:51,547) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:20:02,973) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:20:17,405) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977870, valid -1.000143
[4163996:MainThread](2024-04-06 17:20:17,406) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 17:20:17,406) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:20:29,150) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:20:43,781) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975830, valid -1.007814
[4163996:MainThread](2024-04-06 17:20:43,781) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 17:20:43,781) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:20:55,421) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:21:09,336) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974793, valid -1.002004
[4163996:MainThread](2024-04-06 17:21:09,337) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 17:21:09,337) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:21:20,532) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:21:35,195) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973459, valid -0.996968
[4163996:MainThread](2024-04-06 17:21:35,195) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 17:21:35,196) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.992969 @ 0
[4163996:MainThread](2024-04-06 17:21:39,071) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 17:21:39,939) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  15%|█▌        | 8/52 [21:45<2:00:37, 164.48s/it][4163996:MainThread](2024-04-06 17:21:39,952) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 17:21:39,974) INFO - qlib.workflow - [recorder.py:341] - Recorder 7aed69baa7e744e7911981cdc52335d1 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 17:21:40,775) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:21:41,449) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:21:45,835) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:21:45,836) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:21:45,836) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2020-08-03 SH600000   -0.004827
2020-08-04 SH600000   -0.028259
2020-08-05 SH600000   -0.018082
2020-08-06 SH600000   -0.009961
2020-08-07 SH600000   -0.006756
[4163996:MainThread](2024-04-06 17:21:57,521) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:22:11,697) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986089, valid -0.987943
[4163996:MainThread](2024-04-06 17:22:11,701) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 17:22:11,701) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:22:23,312) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:22:37,508) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981827, valid -0.994683
[4163996:MainThread](2024-04-06 17:22:37,509) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 17:22:37,509) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:22:48,972) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:23:02,940) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978715, valid -0.992194
[4163996:MainThread](2024-04-06 17:23:02,941) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 17:23:02,941) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:23:14,362) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:23:28,499) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976879, valid -0.999793
[4163996:MainThread](2024-04-06 17:23:28,499) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 17:23:28,500) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:23:39,592) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:23:53,646) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973617, valid -0.994927
[4163996:MainThread](2024-04-06 17:23:53,647) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 17:23:53,647) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:24:04,854) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:24:18,694) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970791, valid -0.997075
[4163996:MainThread](2024-04-06 17:24:18,695) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 17:24:18,695) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.987943 @ 0
[4163996:MainThread](2024-04-06 17:24:22,470) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 17:24:23,413) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  17%|█▋        | 9/52 [24:29<1:57:39, 164.17s/it][4163996:MainThread](2024-04-06 17:24:23,425) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 17:24:23,440) INFO - qlib.workflow - [recorder.py:341] - Recorder 53f760bfd9ef4a48af1b119280b13e69 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 17:24:24,170) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:24:24,856) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:24:29,211) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:24:29,212) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:24:29,212) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2020-08-31 SH600000    0.054522
2020-09-01 SH600000    0.061084
2020-09-02 SH600000    0.020364
2020-09-03 SH600000    0.034346
2020-09-04 SH600000   -0.065947
[4163996:MainThread](2024-04-06 17:24:40,925) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:24:54,572) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986208, valid -0.990213
[4163996:MainThread](2024-04-06 17:24:54,576) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 17:24:54,576) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:25:05,999) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:25:20,665) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981508, valid -0.989420
[4163996:MainThread](2024-04-06 17:25:20,669) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 17:25:20,669) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:25:32,935) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:25:46,772) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978760, valid -0.990257
[4163996:MainThread](2024-04-06 17:25:46,773) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 17:25:46,773) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:25:57,329) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:26:12,075) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977375, valid -0.995671
[4163996:MainThread](2024-04-06 17:26:12,076) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 17:26:12,076) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:26:23,381) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:26:37,172) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974131, valid -0.994730
[4163996:MainThread](2024-04-06 17:26:37,172) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 17:26:37,173) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:26:48,435) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:27:02,396) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972023, valid -0.997447
[4163996:MainThread](2024-04-06 17:27:02,396) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 17:27:02,397) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:27:13,719) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:27:27,636) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970105, valid -0.991717
[4163996:MainThread](2024-04-06 17:27:27,637) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 17:27:27,637) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.989420 @ 1
[4163996:MainThread](2024-04-06 17:27:31,289) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 17:27:32,235) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  19%|█▉        | 10/52 [27:37<2:00:14, 171.78s/it][4163996:MainThread](2024-04-06 17:27:32,247) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 17:27:32,264) INFO - qlib.workflow - [recorder.py:341] - Recorder f7698f72e5df4ec0b0c3e53acffc7e67 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 17:27:33,002) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:27:33,615) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:27:37,550) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:27:37,551) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:27:37,551) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2020-09-28 SH600000    0.019391
2020-09-29 SH600000    0.085577
2020-09-30 SH600000    0.060614
2020-10-09 SH600000    0.099598
2020-10-12 SH600000    0.116748
[4163996:MainThread](2024-04-06 17:27:49,233) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:28:03,551) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.985672, valid -0.987616
[4163996:MainThread](2024-04-06 17:28:03,554) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 17:28:03,554) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:28:15,198) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:28:29,464) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981728, valid -0.988001
[4163996:MainThread](2024-04-06 17:28:29,465) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 17:28:29,465) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:28:40,719) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:28:54,789) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978094, valid -0.989870
[4163996:MainThread](2024-04-06 17:28:54,790) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 17:28:54,790) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:29:07,022) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:29:21,204) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976883, valid -0.991198
[4163996:MainThread](2024-04-06 17:29:21,205) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 17:29:21,205) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:29:32,778) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:29:46,841) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973496, valid -0.993051
[4163996:MainThread](2024-04-06 17:29:46,841) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 17:29:46,842) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:29:58,426) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:30:12,961) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971695, valid -0.994490
[4163996:MainThread](2024-04-06 17:30:12,962) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 17:30:12,962) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.987616 @ 0
[4163996:MainThread](2024-04-06 17:30:16,909) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 17:30:17,654) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  21%|██        | 11/52 [30:23<1:56:03, 169.83s/it][4163996:MainThread](2024-04-06 17:30:17,666) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 17:30:17,680) INFO - qlib.workflow - [recorder.py:341] - Recorder 6cd18440fdf44254b5aba0418a4c3111 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 17:30:18,443) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:30:19,047) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:30:23,341) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:30:23,341) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:30:23,342) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2020-11-03 SH600000    0.006633
2020-11-04 SH600000   -0.017749
2020-11-05 SH600000   -0.025109
2020-11-06 SH600000    0.024212
2020-11-09 SH600000    0.012962
[4163996:MainThread](2024-04-06 17:30:34,866) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:30:49,091) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986000, valid -0.985333
[4163996:MainThread](2024-04-06 17:30:49,094) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 17:30:49,095) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:31:00,760) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:31:14,884) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982301, valid -0.985311
[4163996:MainThread](2024-04-06 17:31:14,888) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 17:31:14,889) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:31:26,556) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:31:40,946) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978932, valid -0.988480
[4163996:MainThread](2024-04-06 17:31:40,946) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 17:31:40,947) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:31:52,843) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:32:07,211) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977246, valid -0.989212
[4163996:MainThread](2024-04-06 17:32:07,211) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 17:32:07,212) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:32:18,652) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:32:32,655) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974104, valid -0.987931
[4163996:MainThread](2024-04-06 17:32:32,656) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 17:32:32,657) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:32:44,101) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:32:58,423) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972586, valid -0.992174
[4163996:MainThread](2024-04-06 17:32:58,424) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 17:32:58,424) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:33:10,047) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:33:24,735) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971509, valid -0.993142
[4163996:MainThread](2024-04-06 17:33:24,735) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 17:33:24,735) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.985311 @ 1
[4163996:MainThread](2024-04-06 17:33:28,381) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 17:33:29,200) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  23%|██▎       | 12/52 [33:34<1:57:37, 176.44s/it][4163996:MainThread](2024-04-06 17:33:29,211) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 17:33:29,226) INFO - qlib.workflow - [recorder.py:341] - Recorder 6710ecdf2657428aa63ff4f3fa309899 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 17:33:29,963) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:33:30,592) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:33:34,584) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:33:34,584) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:33:34,585) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2020-12-01 SH600000   -0.035981
2020-12-02 SH600000    0.017474
2020-12-03 SH600000    0.046612
2020-12-04 SH600000    0.031391
2020-12-07 SH600000    0.002495
[4163996:MainThread](2024-04-06 17:33:46,207) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:34:00,461) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987401, valid -0.984980
[4163996:MainThread](2024-04-06 17:34:00,465) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 17:34:00,465) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:34:12,746) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:34:28,065) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982571, valid -0.984999
[4163996:MainThread](2024-04-06 17:34:28,066) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 17:34:28,067) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:34:39,508) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:34:52,773) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979627, valid -0.983743
[4163996:MainThread](2024-04-06 17:34:52,777) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 17:34:52,777) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:35:04,592) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:35:18,630) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976725, valid -0.985384
[4163996:MainThread](2024-04-06 17:35:18,631) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 17:35:18,631) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:35:30,242) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:35:44,349) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976070, valid -0.987820
[4163996:MainThread](2024-04-06 17:35:44,349) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 17:35:44,350) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:35:55,626) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:36:09,062) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972362, valid -0.988642
[4163996:MainThread](2024-04-06 17:36:09,063) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 17:36:09,063) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:36:20,406) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:36:34,039) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972844, valid -0.989217
[4163996:MainThread](2024-04-06 17:36:34,039) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 17:36:34,040) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:36:45,401) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:36:59,187) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971775, valid -0.992770
[4163996:MainThread](2024-04-06 17:36:59,188) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 17:36:59,188) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.983743 @ 2
[4163996:MainThread](2024-04-06 17:37:02,730) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 17:37:03,645) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  25%|██▌       | 13/52 [37:09<2:02:10, 187.95s/it][4163996:MainThread](2024-04-06 17:37:03,657) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 17:37:03,672) INFO - qlib.workflow - [recorder.py:341] - Recorder b02da833eca4479ab05b0f1bf8e5899f starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 17:37:04,416) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:37:05,014) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:37:09,205) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:37:09,205) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:37:09,205) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2020-12-29 SH600000   -0.096448
2020-12-30 SH600000   -0.100629
2020-12-31 SH600000    0.007339
2021-01-04 SH600000    0.005117
2021-01-05 SH600000   -0.013403
[4163996:MainThread](2024-04-06 17:37:20,601) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:37:34,644) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986726, valid -0.978181
[4163996:MainThread](2024-04-06 17:37:34,648) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 17:37:34,648) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:37:46,240) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:38:00,585) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982854, valid -0.977169
[4163996:MainThread](2024-04-06 17:38:00,589) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 17:38:00,589) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:38:12,224) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:38:26,416) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979946, valid -0.979443
[4163996:MainThread](2024-04-06 17:38:26,417) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 17:38:26,417) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:38:37,339) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:38:51,569) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978208, valid -0.978222
[4163996:MainThread](2024-04-06 17:38:51,570) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 17:38:51,570) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:39:03,357) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:39:17,267) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975742, valid -0.978142
[4163996:MainThread](2024-04-06 17:39:17,268) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 17:39:17,268) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:39:29,072) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:39:42,918) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973581, valid -0.980504
[4163996:MainThread](2024-04-06 17:39:42,919) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 17:39:42,919) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:39:54,614) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:40:08,612) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972304, valid -0.980225
[4163996:MainThread](2024-04-06 17:40:08,613) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 17:40:08,613) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.977169 @ 1
[4163996:MainThread](2024-04-06 17:40:12,131) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 17:40:13,044) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  27%|██▋       | 14/52 [40:18<1:59:18, 188.39s/it][4163996:MainThread](2024-04-06 17:40:13,056) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 17:40:13,071) INFO - qlib.workflow - [recorder.py:341] - Recorder 8446eb0bcdc2445ba879f50e7af1a486 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 17:40:13,810) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:40:14,391) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:40:18,452) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:40:18,452) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:40:18,453) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2021-01-27 SH600000    0.089064
2021-01-28 SH600000    0.076285
2021-01-29 SH600000    0.122340
2021-02-01 SH600000    0.130818
2021-02-02 SH600000    0.074990
[4163996:MainThread](2024-04-06 17:40:30,172) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:40:44,228) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986959, valid -0.980844
[4163996:MainThread](2024-04-06 17:40:44,232) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 17:40:44,232) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:40:55,853) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:41:10,453) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982647, valid -0.979102
[4163996:MainThread](2024-04-06 17:41:10,457) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 17:41:10,457) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:41:22,460) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:41:36,711) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979944, valid -0.979526
[4163996:MainThread](2024-04-06 17:41:36,711) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 17:41:36,712) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:41:48,196) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:42:02,355) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977432, valid -0.975338
[4163996:MainThread](2024-04-06 17:42:02,359) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 17:42:02,359) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:42:13,790) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:42:28,106) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977488, valid -0.977896
[4163996:MainThread](2024-04-06 17:42:28,106) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 17:42:28,107) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:42:39,839) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:42:54,384) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974430, valid -0.976736
[4163996:MainThread](2024-04-06 17:42:54,385) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 17:42:54,385) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:43:06,283) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:43:21,196) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972043, valid -0.976738
[4163996:MainThread](2024-04-06 17:43:21,196) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 17:43:21,197) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:43:33,017) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:43:47,231) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974199, valid -0.981150
[4163996:MainThread](2024-04-06 17:43:47,232) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 17:43:47,232) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:43:58,697) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:44:13,980) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.967984, valid -0.976999
[4163996:MainThread](2024-04-06 17:44:13,981) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 17:44:13,981) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.975338 @ 3
[4163996:MainThread](2024-04-06 17:44:17,660) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 17:44:18,577) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  29%|██▉       | 15/52 [44:24<2:06:47, 205.61s/it][4163996:MainThread](2024-04-06 17:44:18,589) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 17:44:18,604) INFO - qlib.workflow - [recorder.py:341] - Recorder 50161a2f7a964153a9b1488ee7bb3b65 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 17:44:19,339) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:44:19,942) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:44:24,122) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:44:24,123) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:44:24,123) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2021-03-03 SH600000    0.013249
2021-03-04 SH600000    0.013937
2021-03-05 SH600000    0.016102
2021-03-08 SH600000    0.030378
2021-03-09 SH600000    0.026408
[4163996:MainThread](2024-04-06 17:44:35,786) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:44:50,128) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986284, valid -0.982213
[4163996:MainThread](2024-04-06 17:44:50,131) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 17:44:50,132) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:45:02,170) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:45:17,106) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982899, valid -0.980639
[4163996:MainThread](2024-04-06 17:45:17,113) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 17:45:17,113) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:45:28,977) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:45:43,586) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979913, valid -0.979551
[4163996:MainThread](2024-04-06 17:45:43,591) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 17:45:43,591) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:45:55,246) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:46:09,732) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982548, valid -0.986193
[4163996:MainThread](2024-04-06 17:46:09,732) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 17:46:09,733) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:46:21,890) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:46:36,059) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975468, valid -0.981741
[4163996:MainThread](2024-04-06 17:46:36,060) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 17:46:36,060) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:46:47,745) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:47:01,913) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973727, valid -0.979837
[4163996:MainThread](2024-04-06 17:47:01,913) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 17:47:01,914) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:47:13,694) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:47:28,746) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977587, valid -0.988931
[4163996:MainThread](2024-04-06 17:47:28,747) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 17:47:28,747) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:47:40,404) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:47:53,945) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.969980, valid -0.981529
[4163996:MainThread](2024-04-06 17:47:53,946) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 17:47:53,946) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.979551 @ 2
[4163996:MainThread](2024-04-06 17:47:57,724) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 17:47:58,658) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  31%|███       | 16/52 [48:04<2:05:58, 209.97s/it][4163996:MainThread](2024-04-06 17:47:58,669) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 17:47:58,685) INFO - qlib.workflow - [recorder.py:341] - Recorder 5afddc41f75343798725f825d62b9b37 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 17:47:59,430) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:48:00,036) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:48:04,358) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:48:04,358) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:48:04,359) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2021-03-31 SH600000    0.177941
2021-04-01 SH600000    0.156410
2021-04-02 SH600000    0.168683
2021-04-06 SH600000    0.138989
2021-04-07 SH600000    0.159993
[4163996:MainThread](2024-04-06 17:48:16,167) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:48:30,668) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987673, valid -0.982988
[4163996:MainThread](2024-04-06 17:48:30,672) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 17:48:30,672) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:48:42,990) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:48:57,597) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982498, valid -0.979920
[4163996:MainThread](2024-04-06 17:48:57,602) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 17:48:57,603) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:49:09,178) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:49:23,856) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979558, valid -0.980232
[4163996:MainThread](2024-04-06 17:49:23,857) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 17:49:23,858) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:49:35,493) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:49:49,531) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978674, valid -0.980326
[4163996:MainThread](2024-04-06 17:49:49,532) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 17:49:49,532) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:50:01,032) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:50:15,322) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974694, valid -0.980966
[4163996:MainThread](2024-04-06 17:50:15,322) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 17:50:15,322) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:50:27,151) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:50:41,764) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975975, valid -0.983841
[4163996:MainThread](2024-04-06 17:50:41,764) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 17:50:41,765) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:50:54,175) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:51:08,824) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970661, valid -0.980087
[4163996:MainThread](2024-04-06 17:51:08,824) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 17:51:08,824) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.979920 @ 1
[4163996:MainThread](2024-04-06 17:51:12,865) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 17:51:13,793) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  33%|███▎      | 17/52 [51:19<1:59:52, 205.51s/it][4163996:MainThread](2024-04-06 17:51:13,805) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 17:51:13,820) INFO - qlib.workflow - [recorder.py:341] - Recorder 76138ce33bff43859552e34a3ab97e95 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 17:51:14,548) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:51:15,204) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:51:19,434) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:51:19,434) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:51:19,435) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2021-04-29 SH600000    0.136911
2021-04-30 SH600000    0.115120
2021-05-06 SH600000    0.148160
2021-05-07 SH600000    0.129347
2021-05-10 SH600000    0.120312
[4163996:MainThread](2024-04-06 17:51:31,304) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:51:46,000) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986586, valid -0.982807
[4163996:MainThread](2024-04-06 17:51:46,004) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 17:51:46,004) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:51:57,444) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:52:11,679) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982354, valid -0.979780
[4163996:MainThread](2024-04-06 17:52:11,682) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 17:52:11,683) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:52:23,653) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:52:38,682) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979328, valid -0.978393
[4163996:MainThread](2024-04-06 17:52:38,686) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 17:52:38,686) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:52:51,687) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:53:05,330) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979680, valid -0.982769
[4163996:MainThread](2024-04-06 17:53:05,331) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 17:53:05,332) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:53:16,895) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:53:31,534) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975894, valid -0.979857
[4163996:MainThread](2024-04-06 17:53:31,534) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 17:53:31,535) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:53:43,977) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:53:59,042) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973051, valid -0.978748
[4163996:MainThread](2024-04-06 17:53:59,043) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 17:53:59,043) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:54:10,743) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:54:25,172) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972470, valid -0.982337
[4163996:MainThread](2024-04-06 17:54:25,173) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 17:54:25,173) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:54:37,182) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:54:51,959) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970859, valid -0.979896
[4163996:MainThread](2024-04-06 17:54:51,959) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 17:54:51,960) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.978393 @ 2
[4163996:MainThread](2024-04-06 17:54:55,695) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 17:54:56,631) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  35%|███▍      | 18/52 [55:02<1:59:24, 210.72s/it][4163996:MainThread](2024-04-06 17:54:56,643) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 17:54:56,658) INFO - qlib.workflow - [recorder.py:341] - Recorder f98c643cbe2e4208868750a6e56e8ecd starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 17:54:57,400) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:54:58,012) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:55:02,197) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:55:02,197) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:55:02,197) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2021-06-01 SH600000    0.104227
2021-06-02 SH600000    0.116188
2021-06-03 SH600000    0.093172
2021-06-04 SH600000    0.093942
2021-06-07 SH600000    0.104807
[4163996:MainThread](2024-04-06 17:55:13,789) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:55:28,291) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988284, valid -0.983964
[4163996:MainThread](2024-04-06 17:55:28,295) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 17:55:28,296) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:55:40,236) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:55:54,577) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983068, valid -0.980165
[4163996:MainThread](2024-04-06 17:55:54,581) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 17:55:54,581) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:56:06,626) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:56:21,965) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980290, valid -0.979532
[4163996:MainThread](2024-04-06 17:56:21,969) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 17:56:21,970) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:56:34,953) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:56:49,769) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978744, valid -0.979670
[4163996:MainThread](2024-04-06 17:56:49,769) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 17:56:49,770) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:57:01,968) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:57:16,849) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975818, valid -0.978952
[4163996:MainThread](2024-04-06 17:57:16,856) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 17:57:16,856) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:57:29,909) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:57:44,599) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976064, valid -0.981619
[4163996:MainThread](2024-04-06 17:57:44,600) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 17:57:44,600) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:57:57,111) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:58:11,730) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972312, valid -0.979791
[4163996:MainThread](2024-04-06 17:58:11,730) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 17:58:11,731) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:58:24,109) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:58:38,694) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973457, valid -0.983966
[4163996:MainThread](2024-04-06 17:58:38,695) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 17:58:38,696) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:58:50,906) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:59:06,086) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971165, valid -0.984785
[4163996:MainThread](2024-04-06 17:59:06,087) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[4163996:MainThread](2024-04-06 17:59:06,087) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 17:59:18,672) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 17:59:33,516) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.966801, valid -0.981345
[4163996:MainThread](2024-04-06 17:59:33,516) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 17:59:33,517) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.978952 @ 4
[4163996:MainThread](2024-04-06 17:59:37,307) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 17:59:38,018) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  37%|███▋      | 19/52 [59:43<2:07:34, 231.94s/it][4163996:MainThread](2024-04-06 17:59:38,030) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 17:59:38,046) INFO - qlib.workflow - [recorder.py:341] - Recorder 17c752a1888f4e93be6b8e6e127f19b1 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 17:59:38,771) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 17:59:39,408) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 17:59:43,649) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 17:59:43,650) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 17:59:43,650) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2021-06-30 SH600000   -0.041741
2021-07-01 SH600000   -0.062160
2021-07-02 SH600000   -0.031703
2021-07-05 SH600000    0.004828
2021-07-06 SH600000   -0.002314
[4163996:MainThread](2024-04-06 17:59:55,917) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:00:10,820) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986401, valid -0.985158
[4163996:MainThread](2024-04-06 18:00:10,823) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 18:00:10,824) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:00:23,310) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:00:38,209) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982250, valid -0.984923
[4163996:MainThread](2024-04-06 18:00:38,213) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 18:00:38,213) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:00:50,684) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:01:05,507) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979586, valid -0.983432
[4163996:MainThread](2024-04-06 18:01:05,511) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 18:01:05,512) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:01:17,702) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:01:32,963) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977450, valid -0.983630
[4163996:MainThread](2024-04-06 18:01:32,964) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 18:01:32,964) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:01:45,114) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:02:00,089) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976005, valid -0.983935
[4163996:MainThread](2024-04-06 18:02:00,089) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 18:02:00,090) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:02:11,404) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:02:26,316) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975679, valid -0.986971
[4163996:MainThread](2024-04-06 18:02:26,316) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 18:02:26,317) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:02:39,070) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:02:53,220) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971295, valid -0.985921
[4163996:MainThread](2024-04-06 18:02:53,220) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 18:02:53,221) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:03:05,262) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:03:20,477) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970771, valid -0.986662
[4163996:MainThread](2024-04-06 18:03:20,477) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 18:03:20,478) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.983432 @ 2
[4163996:MainThread](2024-04-06 18:03:24,334) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 18:03:25,065) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  38%|███▊      | 20/52 [1:03:30<2:02:55, 230.47s/it][4163996:MainThread](2024-04-06 18:03:25,077) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 18:03:25,093) INFO - qlib.workflow - [recorder.py:341] - Recorder 6331ed00c09e461392423ccace729f01 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 18:03:25,916) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 18:03:26,519) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 18:03:30,912) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 18:03:30,912) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 18:03:30,913) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2021-07-28 SH600000    0.123726
2021-07-29 SH600000    0.176698
2021-07-30 SH600000    0.126830
2021-08-02 SH600000    0.132285
2021-08-03 SH600000    0.112203
[4163996:MainThread](2024-04-06 18:03:42,691) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:03:58,003) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986264, valid -0.994556
[4163996:MainThread](2024-04-06 18:03:58,006) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 18:03:58,007) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:04:10,522) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:04:25,317) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982053, valid -0.995536
[4163996:MainThread](2024-04-06 18:04:25,318) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 18:04:25,318) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:04:37,338) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:04:52,105) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981588, valid -0.999860
[4163996:MainThread](2024-04-06 18:04:52,106) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 18:04:52,106) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:05:04,499) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:05:20,658) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977010, valid -0.996860
[4163996:MainThread](2024-04-06 18:05:20,659) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 18:05:20,659) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:05:31,858) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:05:46,329) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975955, valid -0.997333
[4163996:MainThread](2024-04-06 18:05:46,330) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 18:05:46,330) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:05:58,462) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:06:12,915) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975426, valid -0.997035
[4163996:MainThread](2024-04-06 18:06:12,916) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 18:06:12,916) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.994556 @ 0
[4163996:MainThread](2024-04-06 18:06:16,540) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 18:06:17,267) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  40%|████      | 21/52 [1:06:22<1:50:02, 212.98s/it][4163996:MainThread](2024-04-06 18:06:17,278) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 18:06:17,295) INFO - qlib.workflow - [recorder.py:341] - Recorder 9d8d429443414898b436721b2eefb264 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 18:06:18,016) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 18:06:18,642) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 18:06:23,063) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 18:06:23,064) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 18:06:23,064) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2021-08-25 SH600000    0.020641
2021-08-26 SH600000    0.018956
2021-08-27 SH600000   -0.002528
2021-08-30 SH600000    0.115582
2021-08-31 SH600000    0.091793
[4163996:MainThread](2024-04-06 18:06:34,836) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:06:49,617) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986264, valid -1.000683
[4163996:MainThread](2024-04-06 18:06:49,621) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 18:06:49,622) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:07:02,063) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:07:16,676) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982886, valid -0.999374
[4163996:MainThread](2024-04-06 18:07:16,681) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 18:07:16,681) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:07:29,119) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:07:43,722) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979139, valid -0.999370
[4163996:MainThread](2024-04-06 18:07:43,725) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 18:07:43,726) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:07:56,143) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:08:11,145) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977156, valid -1.000420
[4163996:MainThread](2024-04-06 18:08:11,146) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 18:08:11,146) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:08:23,669) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:08:38,277) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974745, valid -1.005359
[4163996:MainThread](2024-04-06 18:08:38,277) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 18:08:38,278) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:08:50,620) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:09:04,772) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972929, valid -1.001062
[4163996:MainThread](2024-04-06 18:09:04,772) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 18:09:04,772) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:09:16,587) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:09:31,458) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972189, valid -1.005038
[4163996:MainThread](2024-04-06 18:09:31,458) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 18:09:31,459) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:09:43,438) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:09:57,865) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971139, valid -1.007969
[4163996:MainThread](2024-04-06 18:09:57,866) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 18:09:57,866) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.999370 @ 2
[4163996:MainThread](2024-04-06 18:10:01,572) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 18:10:02,507) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  42%|████▏     | 22/52 [1:10:08<1:48:19, 216.66s/it][4163996:MainThread](2024-04-06 18:10:02,519) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 18:10:02,535) INFO - qlib.workflow - [recorder.py:341] - Recorder 96a59b68366b4ae7b95097337fcf4223 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 18:10:03,281) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 18:10:03,900) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 18:10:08,848) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 18:10:08,848) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 18:10:08,848) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2021-09-24 SH600000    0.134852
2021-09-27 SH600000    0.162494
2021-09-28 SH600000    0.127212
2021-09-29 SH600000    0.064247
2021-09-30 SH600000    0.105383
[4163996:MainThread](2024-04-06 18:10:20,820) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:10:35,031) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987243, valid -0.993533
[4163996:MainThread](2024-04-06 18:10:35,035) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 18:10:35,035) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:10:46,970) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:11:01,323) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982786, valid -0.992550
[4163996:MainThread](2024-04-06 18:11:01,327) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 18:11:01,328) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:11:13,383) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:11:28,089) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979817, valid -0.992914
[4163996:MainThread](2024-04-06 18:11:28,090) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 18:11:28,090) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:11:40,447) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:11:54,775) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977719, valid -0.990950
[4163996:MainThread](2024-04-06 18:11:54,779) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 18:11:54,779) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:12:06,669) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:12:21,172) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978502, valid -0.993896
[4163996:MainThread](2024-04-06 18:12:21,173) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 18:12:21,173) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:12:33,213) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:12:47,606) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974514, valid -0.993977
[4163996:MainThread](2024-04-06 18:12:47,607) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 18:12:47,607) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:12:59,984) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:13:14,497) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976248, valid -1.001151
[4163996:MainThread](2024-04-06 18:13:14,498) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 18:13:14,499) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:13:26,977) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:13:41,830) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970577, valid -0.996093
[4163996:MainThread](2024-04-06 18:13:41,830) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 18:13:41,831) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:13:53,812) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:14:08,567) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.968902, valid -0.997530
[4163996:MainThread](2024-04-06 18:14:08,567) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 18:14:08,568) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.990950 @ 3
[4163996:MainThread](2024-04-06 18:14:12,220) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 18:14:13,156) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  44%|████▍     | 23/52 [1:14:18<1:49:38, 226.86s/it][4163996:MainThread](2024-04-06 18:14:13,168) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 18:14:13,183) INFO - qlib.workflow - [recorder.py:341] - Recorder 1baeaa0fe3784f04a619e907f5985130 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 18:14:13,917) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 18:14:14,580) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 18:14:19,082) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 18:14:19,082) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 18:14:19,083) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2021-10-29 SH600000    0.092281
2021-11-01 SH600000    0.082924
2021-11-02 SH600000    0.072872
2021-11-03 SH600000    0.114245
2021-11-04 SH600000    0.148065
[4163996:MainThread](2024-04-06 18:14:32,537) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:14:46,622) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986238, valid -0.990058
[4163996:MainThread](2024-04-06 18:14:46,628) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 18:14:46,628) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:14:59,136) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:15:13,440) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982175, valid -0.989291
[4163996:MainThread](2024-04-06 18:15:13,444) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 18:15:13,445) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:15:25,493) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:15:40,047) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979934, valid -0.990091
[4163996:MainThread](2024-04-06 18:15:40,047) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 18:15:40,048) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:15:52,502) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:16:07,121) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979623, valid -0.992768
[4163996:MainThread](2024-04-06 18:16:07,121) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 18:16:07,122) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:16:20,125) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:16:34,540) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975319, valid -0.992261
[4163996:MainThread](2024-04-06 18:16:34,540) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 18:16:34,541) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:16:47,254) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:17:01,351) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973612, valid -0.991967
[4163996:MainThread](2024-04-06 18:17:01,352) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 18:17:01,352) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:17:13,728) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:17:28,719) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972165, valid -0.993093
[4163996:MainThread](2024-04-06 18:17:28,719) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 18:17:28,720) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.989291 @ 1
[4163996:MainThread](2024-04-06 18:17:32,871) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 18:17:33,792) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  46%|████▌     | 24/52 [1:17:39<1:42:11, 218.99s/it][4163996:MainThread](2024-04-06 18:17:33,803) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 18:17:33,818) INFO - qlib.workflow - [recorder.py:341] - Recorder 58baf694358f4c0ca811c7be9db103bc starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 18:17:34,569) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 18:17:35,176) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 18:17:39,751) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 18:17:39,752) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 18:17:39,752) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2021-11-26 SH600000    0.071588
2021-11-29 SH600000    0.143318
2021-11-30 SH600000    0.144641
2021-12-01 SH600000    0.118320
2021-12-02 SH600000    0.102911
[4163996:MainThread](2024-04-06 18:17:52,787) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:18:07,701) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986176, valid -0.994205
[4163996:MainThread](2024-04-06 18:18:07,705) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 18:18:07,705) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:18:20,532) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:18:35,494) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982030, valid -0.989980
[4163996:MainThread](2024-04-06 18:18:35,497) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 18:18:35,498) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:18:48,135) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:19:03,055) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980924, valid -0.994953
[4163996:MainThread](2024-04-06 18:19:03,056) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 18:19:03,056) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:19:15,259) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:19:30,104) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980362, valid -0.994507
[4163996:MainThread](2024-04-06 18:19:30,104) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 18:19:30,105) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:19:42,798) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:19:57,478) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975141, valid -0.992613
[4163996:MainThread](2024-04-06 18:19:57,479) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 18:19:57,479) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:20:09,915) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:20:25,646) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973822, valid -0.994524
[4163996:MainThread](2024-04-06 18:20:25,646) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 18:20:25,647) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:20:38,338) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:20:53,815) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971770, valid -0.994943
[4163996:MainThread](2024-04-06 18:20:53,816) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 18:20:53,816) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.989980 @ 1
[4163996:MainThread](2024-04-06 18:20:57,835) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 18:20:58,750) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  48%|████▊     | 25/52 [1:21:04<1:36:39, 214.78s/it][4163996:MainThread](2024-04-06 18:20:58,761) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 18:20:58,776) INFO - qlib.workflow - [recorder.py:341] - Recorder 3fc1503f170c446287f5222435863eab starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 18:20:59,531) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 18:21:00,138) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 18:21:05,254) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 18:21:05,254) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 18:21:05,254) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2021-12-24 SH600000    0.001625
2021-12-27 SH600000    0.012156
2021-12-28 SH600000   -0.011174
2021-12-29 SH600000    0.019499
2021-12-30 SH600000    0.030497
[4163996:MainThread](2024-04-06 18:21:17,236) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:21:31,604) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986227, valid -0.997651
[4163996:MainThread](2024-04-06 18:21:31,608) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 18:21:31,609) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:21:43,632) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:21:58,366) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982486, valid -0.998730
[4163996:MainThread](2024-04-06 18:21:58,367) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 18:21:58,367) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:22:10,787) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:22:25,138) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979410, valid -0.995745
[4163996:MainThread](2024-04-06 18:22:25,141) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 18:22:25,141) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:22:37,251) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:22:51,720) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977589, valid -1.002475
[4163996:MainThread](2024-04-06 18:22:51,720) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 18:22:51,721) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:23:04,214) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:23:18,906) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975296, valid -0.994183
[4163996:MainThread](2024-04-06 18:23:18,910) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 18:23:18,910) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:23:31,201) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:23:45,730) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974216, valid -0.994972
[4163996:MainThread](2024-04-06 18:23:45,730) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 18:23:45,731) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:23:58,315) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:24:12,998) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972128, valid -1.004491
[4163996:MainThread](2024-04-06 18:24:12,998) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 18:24:12,999) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:24:24,912) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:24:39,134) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970427, valid -1.000146
[4163996:MainThread](2024-04-06 18:24:39,135) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 18:24:39,135) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:24:52,093) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:25:07,105) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.968216, valid -1.005134
[4163996:MainThread](2024-04-06 18:25:07,106) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[4163996:MainThread](2024-04-06 18:25:07,106) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:25:19,397) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:25:35,289) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.967638, valid -1.002374
[4163996:MainThread](2024-04-06 18:25:35,289) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 18:25:35,289) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.994183 @ 4
[4163996:MainThread](2024-04-06 18:25:39,003) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 18:25:39,860) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  50%|█████     | 26/52 [1:25:45<1:41:41, 234.68s/it][4163996:MainThread](2024-04-06 18:25:39,872) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 18:25:39,887) INFO - qlib.workflow - [recorder.py:341] - Recorder 765e7bc689fa4ca9a2b757d31daf3f13 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 18:25:40,618) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 18:25:41,219) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 18:25:45,781) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 18:25:45,782) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 18:25:45,782) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-01-24 SH600000    0.252800
2022-01-25 SH600000    0.215885
2022-01-26 SH600000    0.243718
2022-01-27 SH600000    0.121510
2022-01-28 SH600000    0.117548
[4163996:MainThread](2024-04-06 18:25:58,272) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:26:13,075) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986096, valid -0.994072
[4163996:MainThread](2024-04-06 18:26:13,079) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 18:26:13,080) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:26:25,644) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:26:41,021) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982452, valid -0.995230
[4163996:MainThread](2024-04-06 18:26:41,022) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 18:26:41,022) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:26:53,725) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:27:08,506) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979056, valid -0.997289
[4163996:MainThread](2024-04-06 18:27:08,506) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 18:27:08,507) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:27:20,825) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:27:36,182) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978356, valid -0.997432
[4163996:MainThread](2024-04-06 18:27:36,183) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 18:27:36,183) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:27:49,017) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:28:04,523) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976620, valid -0.999570
[4163996:MainThread](2024-04-06 18:28:04,524) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 18:28:04,524) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:28:16,650) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:28:31,740) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973640, valid -1.002644
[4163996:MainThread](2024-04-06 18:28:31,741) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 18:28:31,741) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.994072 @ 0
[4163996:MainThread](2024-04-06 18:28:35,599) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 18:28:36,470) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  52%|█████▏    | 27/52 [1:28:42<1:30:31, 217.26s/it][4163996:MainThread](2024-04-06 18:28:36,481) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 18:28:36,496) INFO - qlib.workflow - [recorder.py:341] - Recorder 4094d3452e4d43f39d2d2461f32c873f starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 18:28:37,241) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 18:28:37,854) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 18:28:42,476) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 18:28:42,476) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 18:28:42,476) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-02-28 SH600000    0.032648
2022-03-01 SH600000    0.034850
2022-03-02 SH600000    0.002979
2022-03-03 SH600000    0.061524
2022-03-04 SH600000    0.012408
[4163996:MainThread](2024-04-06 18:28:55,565) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:29:10,561) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.985841, valid -0.998677
[4163996:MainThread](2024-04-06 18:29:10,565) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 18:29:10,565) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:29:23,586) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:29:38,901) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982214, valid -1.002291
[4163996:MainThread](2024-04-06 18:29:38,902) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 18:29:38,902) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:29:51,620) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:30:06,756) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980150, valid -1.001743
[4163996:MainThread](2024-04-06 18:30:06,757) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 18:30:06,757) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:30:19,034) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:30:34,197) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976954, valid -1.002233
[4163996:MainThread](2024-04-06 18:30:34,198) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 18:30:34,198) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:30:47,716) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:31:04,238) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974951, valid -1.003409
[4163996:MainThread](2024-04-06 18:31:04,238) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 18:31:04,239) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:31:16,639) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:31:30,833) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973122, valid -1.004857
[4163996:MainThread](2024-04-06 18:31:30,834) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 18:31:30,834) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.998677 @ 0
[4163996:MainThread](2024-04-06 18:31:34,913) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 18:31:35,833) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  54%|█████▍    | 28/52 [1:31:41<1:22:21, 205.89s/it][4163996:MainThread](2024-04-06 18:31:35,844) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 18:31:35,860) INFO - qlib.workflow - [recorder.py:341] - Recorder 0b4c17f86f434f389b1e081221b5207a starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 18:31:36,602) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 18:31:37,216) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 18:31:42,097) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 18:31:42,098) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 18:31:42,098) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-03-28 SH600000    0.134326
2022-03-29 SH600000    0.136087
2022-03-30 SH600000    0.125523
2022-03-31 SH600000    0.149659
2022-04-01 SH600000    0.166483
[4163996:MainThread](2024-04-06 18:31:54,995) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:32:09,959) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.985983, valid -1.002218
[4163996:MainThread](2024-04-06 18:32:09,964) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 18:32:09,965) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:32:22,796) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:32:37,840) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981939, valid -1.001455
[4163996:MainThread](2024-04-06 18:32:37,843) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 18:32:37,844) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:32:50,531) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:33:05,243) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979335, valid -1.009512
[4163996:MainThread](2024-04-06 18:33:05,244) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 18:33:05,244) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:33:17,691) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:33:32,282) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976981, valid -1.002432
[4163996:MainThread](2024-04-06 18:33:32,283) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 18:33:32,284) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:33:44,800) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:34:00,376) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975720, valid -1.010252
[4163996:MainThread](2024-04-06 18:34:00,376) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 18:34:00,376) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:34:13,284) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:34:29,419) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973882, valid -1.008695
[4163996:MainThread](2024-04-06 18:34:29,419) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 18:34:29,420) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:34:41,754) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:34:56,494) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971927, valid -1.012596
[4163996:MainThread](2024-04-06 18:34:56,495) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 18:34:56,495) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -1.001455 @ 1
[4163996:MainThread](2024-04-06 18:35:00,372) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 18:35:01,302) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  56%|█████▌    | 29/52 [1:35:06<1:18:52, 205.76s/it][4163996:MainThread](2024-04-06 18:35:01,315) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 18:35:01,333) INFO - qlib.workflow - [recorder.py:341] - Recorder 7cca5b098cd341caae9d9148a1d8f100 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 18:35:02,317) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 18:35:03,023) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 18:35:08,113) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 18:35:08,113) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 18:35:08,114) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-04-27 SH600000    0.186600
2022-04-28 SH600000    0.168703
2022-04-29 SH600000    0.188508
2022-05-05 SH600000    0.188487
2022-05-06 SH600000    0.181042
[4163996:MainThread](2024-04-06 18:35:20,959) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:35:35,494) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.985774, valid -1.001339
[4163996:MainThread](2024-04-06 18:35:35,498) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 18:35:35,499) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:35:48,491) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:36:03,851) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981991, valid -1.002634
[4163996:MainThread](2024-04-06 18:36:03,852) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 18:36:03,852) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:36:16,856) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:36:32,188) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978940, valid -1.002662
[4163996:MainThread](2024-04-06 18:36:32,188) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 18:36:32,189) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:36:44,924) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:37:00,011) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977293, valid -0.999819
[4163996:MainThread](2024-04-06 18:37:00,015) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 18:37:00,015) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:37:12,704) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:37:28,013) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976973, valid -1.001872
[4163996:MainThread](2024-04-06 18:37:28,013) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 18:37:28,014) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:37:40,786) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:37:56,207) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976753, valid -1.006869
[4163996:MainThread](2024-04-06 18:37:56,208) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 18:37:56,208) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:38:08,716) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:38:23,770) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972126, valid -1.001991
[4163996:MainThread](2024-04-06 18:38:23,771) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 18:38:23,771) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:38:36,802) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:38:53,216) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971159, valid -1.002018
[4163996:MainThread](2024-04-06 18:38:53,217) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 18:38:53,217) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:39:06,103) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:39:21,938) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.969447, valid -1.003995
[4163996:MainThread](2024-04-06 18:39:21,939) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 18:39:21,940) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.999819 @ 3
[4163996:MainThread](2024-04-06 18:39:26,228) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 18:39:27,147) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  58%|█████▊    | 30/52 [1:39:32<1:22:03, 223.79s/it][4163996:MainThread](2024-04-06 18:39:27,158) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 18:39:27,180) INFO - qlib.workflow - [recorder.py:341] - Recorder 15f8d6c62c8149f7b5ecdd13d79c28d5 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 18:39:27,999) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 18:39:28,609) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 18:39:33,318) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 18:39:33,319) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 18:39:33,319) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-05-30 SH600000    0.106865
2022-05-31 SH600000    0.084333
2022-06-01 SH600000    0.118374
2022-06-02 SH600000    0.130679
2022-06-06 SH600000    0.162235
[4163996:MainThread](2024-04-06 18:39:45,896) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:40:01,360) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987345, valid -0.995076
[4163996:MainThread](2024-04-06 18:40:01,363) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 18:40:01,364) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:40:14,387) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:40:29,382) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982538, valid -0.996309
[4163996:MainThread](2024-04-06 18:40:29,383) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 18:40:29,383) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:40:41,760) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:40:57,011) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980573, valid -0.994633
[4163996:MainThread](2024-04-06 18:40:57,016) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 18:40:57,016) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:41:09,760) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:41:24,971) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977499, valid -0.994336
[4163996:MainThread](2024-04-06 18:41:24,975) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 18:41:24,975) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:41:36,759) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:41:51,366) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975639, valid -0.999428
[4163996:MainThread](2024-04-06 18:41:51,366) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 18:41:51,367) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:42:03,387) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:42:17,334) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974215, valid -0.999335
[4163996:MainThread](2024-04-06 18:42:17,335) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 18:42:17,335) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:42:29,427) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:42:43,388) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974503, valid -1.006305
[4163996:MainThread](2024-04-06 18:42:43,389) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 18:42:43,389) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:42:55,382) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:43:09,618) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971370, valid -0.996340
[4163996:MainThread](2024-04-06 18:43:09,619) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 18:43:09,619) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:43:21,476) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:43:35,301) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970046, valid -0.998354
[4163996:MainThread](2024-04-06 18:43:35,302) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 18:43:35,302) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.994336 @ 3
[4163996:MainThread](2024-04-06 18:43:39,228) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 18:43:40,616) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  60%|█████▉    | 31/52 [1:43:46<1:21:26, 232.69s/it][4163996:MainThread](2024-04-06 18:43:40,628) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 18:43:40,644) INFO - qlib.workflow - [recorder.py:341] - Recorder 2763fc093e0e4e76ad3372101533219f starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 18:43:41,421) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 18:43:42,077) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 18:43:46,992) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 18:43:46,992) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 18:43:46,993) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-06-28 SH600000    0.130188
2022-06-29 SH600000    0.156673
2022-06-30 SH600000    0.191816
2022-07-01 SH600000    0.218061
2022-07-04 SH600000    0.192853
[4163996:MainThread](2024-04-06 18:43:58,918) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:44:12,425) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988058, valid -0.994882
[4163996:MainThread](2024-04-06 18:44:12,429) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 18:44:12,430) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:44:24,467) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:44:37,833) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983217, valid -0.990476
[4163996:MainThread](2024-04-06 18:44:37,836) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 18:44:37,836) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:44:49,682) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:45:03,659) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980829, valid -0.992582
[4163996:MainThread](2024-04-06 18:45:03,660) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 18:45:03,660) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:45:15,535) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:45:29,264) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978754, valid -0.989036
[4163996:MainThread](2024-04-06 18:45:29,267) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 18:45:29,268) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:45:41,099) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:45:54,346) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976444, valid -0.985462
[4163996:MainThread](2024-04-06 18:45:54,350) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 18:45:54,351) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:46:06,646) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:46:20,285) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974873, valid -0.990027
[4163996:MainThread](2024-04-06 18:46:20,286) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 18:46:20,286) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:46:32,393) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:46:45,701) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973158, valid -0.987491
[4163996:MainThread](2024-04-06 18:46:45,702) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 18:46:45,702) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:46:57,196) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:47:10,506) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971744, valid -0.987924
[4163996:MainThread](2024-04-06 18:47:10,506) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 18:47:10,506) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:47:22,622) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:47:36,232) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.969983, valid -0.989379
[4163996:MainThread](2024-04-06 18:47:36,232) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[4163996:MainThread](2024-04-06 18:47:36,233) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:47:48,204) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:48:01,372) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971156, valid -0.987973
[4163996:MainThread](2024-04-06 18:48:01,373) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 18:48:01,374) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.985462 @ 4
[4163996:MainThread](2024-04-06 18:48:04,854) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 18:48:05,776) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  62%|██████▏   | 32/52 [1:48:11<1:20:48, 242.43s/it][4163996:MainThread](2024-04-06 18:48:05,788) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 18:48:05,803) INFO - qlib.workflow - [recorder.py:341] - Recorder 659d4d8f1aa348309cd1a1fa7c60c0cf starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 18:48:06,527) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 18:48:07,215) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 18:48:12,167) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 18:48:12,167) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 18:48:12,167) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-07-26 SH600000    0.208818
2022-07-27 SH600000    0.204091
2022-07-28 SH600000    0.100687
2022-07-29 SH600000    0.114189
2022-08-01 SH600000    0.156069
[4163996:MainThread](2024-04-06 18:48:24,097) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:48:37,459) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987052, valid -0.985006
[4163996:MainThread](2024-04-06 18:48:37,463) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 18:48:37,463) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:48:49,228) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:49:03,220) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983671, valid -0.983696
[4163996:MainThread](2024-04-06 18:49:03,224) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 18:49:03,224) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:49:15,280) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:49:28,640) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980914, valid -0.983955
[4163996:MainThread](2024-04-06 18:49:28,641) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 18:49:28,641) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:49:40,910) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:49:54,586) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978663, valid -0.983162
[4163996:MainThread](2024-04-06 18:49:54,590) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 18:49:54,590) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:50:06,844) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:50:20,914) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976804, valid -0.982957
[4163996:MainThread](2024-04-06 18:50:20,918) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 18:50:20,918) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:50:32,851) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:50:47,074) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975482, valid -0.980668
[4163996:MainThread](2024-04-06 18:50:47,078) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 18:50:47,079) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:50:59,435) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:51:12,977) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974419, valid -0.980312
[4163996:MainThread](2024-04-06 18:51:12,981) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 18:51:12,981) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:51:24,311) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:51:38,574) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972276, valid -0.981906
[4163996:MainThread](2024-04-06 18:51:38,574) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 18:51:38,575) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:51:50,672) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:52:04,874) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971788, valid -0.985114
[4163996:MainThread](2024-04-06 18:52:04,874) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[4163996:MainThread](2024-04-06 18:52:04,875) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:52:16,462) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:52:30,528) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.969103, valid -0.985584
[4163996:MainThread](2024-04-06 18:52:30,529) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[4163996:MainThread](2024-04-06 18:52:30,529) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:52:42,654) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:52:56,392) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.967973, valid -0.984216
[4163996:MainThread](2024-04-06 18:52:56,393) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch11:
[4163996:MainThread](2024-04-06 18:52:56,394) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:53:08,462) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:53:22,776) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.969775, valid -0.991910
[4163996:MainThread](2024-04-06 18:53:22,777) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 18:53:22,777) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.980312 @ 6
[4163996:MainThread](2024-04-06 18:53:26,658) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 18:53:27,631) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  63%|██████▎   | 33/52 [1:53:33<1:24:18, 266.26s/it][4163996:MainThread](2024-04-06 18:53:27,642) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 18:53:27,657) INFO - qlib.workflow - [recorder.py:341] - Recorder 95c58e557f224f6fabfd506ffa45d236 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 18:53:28,398) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 18:53:29,018) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 18:53:34,377) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 18:53:34,377) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 18:53:34,378) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-08-23 SH600000    0.137644
2022-08-24 SH600000    0.057734
2022-08-25 SH600000    0.046931
2022-08-26 SH600000    0.069611
2022-08-29 SH600000    0.136221
[4163996:MainThread](2024-04-06 18:53:46,248) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:54:00,158) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986633, valid -0.986043
[4163996:MainThread](2024-04-06 18:54:00,163) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 18:54:00,164) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:54:12,012) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:54:25,891) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983145, valid -0.981922
[4163996:MainThread](2024-04-06 18:54:25,896) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 18:54:25,896) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:54:37,961) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:54:51,628) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980414, valid -0.983509
[4163996:MainThread](2024-04-06 18:54:51,629) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 18:54:51,629) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:55:03,467) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:55:17,449) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979104, valid -0.987497
[4163996:MainThread](2024-04-06 18:55:17,450) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 18:55:17,450) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:55:29,192) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:55:43,148) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976530, valid -0.986533
[4163996:MainThread](2024-04-06 18:55:43,149) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 18:55:43,149) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:55:54,998) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:56:08,679) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974882, valid -0.986242
[4163996:MainThread](2024-04-06 18:56:08,679) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 18:56:08,679) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:56:20,542) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:56:34,846) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973678, valid -0.985590
[4163996:MainThread](2024-04-06 18:56:34,846) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 18:56:34,846) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.981922 @ 1
[4163996:MainThread](2024-04-06 18:56:38,579) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 18:56:39,495) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  65%|██████▌   | 34/52 [1:56:45<1:13:10, 243.94s/it][4163996:MainThread](2024-04-06 18:56:39,507) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 18:56:39,522) INFO - qlib.workflow - [recorder.py:341] - Recorder 023bd03859b049d2be974f180fc4fea4 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 18:56:40,256) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 18:56:40,869) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 18:56:46,358) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 18:56:46,358) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 18:56:46,359) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-09-21 SH600000    0.092933
2022-09-22 SH600000    0.040034
2022-09-23 SH600000    0.029911
2022-09-26 SH600000    0.034982
2022-09-27 SH600000    0.031374
[4163996:MainThread](2024-04-06 18:56:58,163) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:57:11,760) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987035, valid -0.982662
[4163996:MainThread](2024-04-06 18:57:11,767) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 18:57:11,767) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:57:23,818) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:57:37,277) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982921, valid -0.986149
[4163996:MainThread](2024-04-06 18:57:37,277) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 18:57:37,278) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:57:49,480) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:58:03,501) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980749, valid -0.983092
[4163996:MainThread](2024-04-06 18:58:03,502) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 18:58:03,502) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:58:15,829) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:58:30,017) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978368, valid -0.983145
[4163996:MainThread](2024-04-06 18:58:30,017) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 18:58:30,018) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:58:41,971) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:58:56,217) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976893, valid -0.981530
[4163996:MainThread](2024-04-06 18:58:56,220) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 18:58:56,221) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:59:08,014) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:59:21,777) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975071, valid -0.979430
[4163996:MainThread](2024-04-06 18:59:21,781) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 18:59:21,781) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 18:59:33,858) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 18:59:47,817) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973995, valid -0.979414
[4163996:MainThread](2024-04-06 18:59:47,825) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 18:59:47,825) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:00:00,132) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:00:14,125) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972344, valid -0.983842
[4163996:MainThread](2024-04-06 19:00:14,126) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 19:00:14,126) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:00:25,982) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:00:40,192) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972310, valid -0.984508
[4163996:MainThread](2024-04-06 19:00:40,193) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[4163996:MainThread](2024-04-06 19:00:40,193) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:00:51,877) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:01:05,843) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.968949, valid -0.983113
[4163996:MainThread](2024-04-06 19:01:05,844) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[4163996:MainThread](2024-04-06 19:01:05,844) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:01:18,203) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:01:32,237) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.967773, valid -0.982023
[4163996:MainThread](2024-04-06 19:01:32,237) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch11:
[4163996:MainThread](2024-04-06 19:01:32,238) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:01:44,601) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:01:58,667) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.967370, valid -0.982287
[4163996:MainThread](2024-04-06 19:01:58,668) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 19:01:58,668) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.979414 @ 6
[4163996:MainThread](2024-04-06 19:02:02,451) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 19:02:03,366) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  67%|██████▋   | 35/52 [2:02:08<1:15:54, 267.92s/it][4163996:MainThread](2024-04-06 19:02:03,378) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 19:02:03,394) INFO - qlib.workflow - [recorder.py:341] - Recorder 33afd7dcb7cc4b8d9d7925f71fe9c1f4 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 19:02:04,117) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 19:02:04,727) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 19:02:10,250) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 19:02:10,250) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 19:02:10,251) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-10-26 SH600000    0.070749
2022-10-27 SH600000    0.066016
2022-10-28 SH600000    0.066415
2022-10-31 SH600000    0.059355
2022-11-01 SH600000    0.053724
[4163996:MainThread](2024-04-06 19:02:22,157) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:02:35,932) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986856, valid -0.986222
[4163996:MainThread](2024-04-06 19:02:35,935) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 19:02:35,936) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:02:48,209) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:03:02,223) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983280, valid -0.984716
[4163996:MainThread](2024-04-06 19:03:02,226) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 19:03:02,227) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:03:14,299) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:03:28,341) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980802, valid -0.986263
[4163996:MainThread](2024-04-06 19:03:28,342) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 19:03:28,342) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:03:40,680) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:03:54,481) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978915, valid -0.984536
[4163996:MainThread](2024-04-06 19:03:54,485) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 19:03:54,485) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:04:06,589) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:04:20,953) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978748, valid -0.981907
[4163996:MainThread](2024-04-06 19:04:20,956) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 19:04:20,957) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:04:33,007) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:04:47,852) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976247, valid -0.985849
[4163996:MainThread](2024-04-06 19:04:47,853) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 19:04:47,853) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:04:59,814) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:05:14,064) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973964, valid -0.980920
[4163996:MainThread](2024-04-06 19:05:14,068) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 19:05:14,068) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:05:26,268) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:05:40,430) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972528, valid -0.980370
[4163996:MainThread](2024-04-06 19:05:40,434) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 19:05:40,434) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:05:52,698) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:06:06,717) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971254, valid -0.984999
[4163996:MainThread](2024-04-06 19:06:06,717) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[4163996:MainThread](2024-04-06 19:06:06,718) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:06:18,777) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:06:32,857) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971755, valid -0.984891
[4163996:MainThread](2024-04-06 19:06:32,858) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[4163996:MainThread](2024-04-06 19:06:32,858) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:06:44,820) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:06:58,490) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.969007, valid -0.986458
[4163996:MainThread](2024-04-06 19:06:58,491) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch11:
[4163996:MainThread](2024-04-06 19:06:58,491) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:07:10,861) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:07:25,174) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.967699, valid -0.983980
[4163996:MainThread](2024-04-06 19:07:25,175) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch12:
[4163996:MainThread](2024-04-06 19:07:25,175) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:07:37,759) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:07:52,256) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.966104, valid -0.982902
[4163996:MainThread](2024-04-06 19:07:52,256) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 19:07:52,256) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.980370 @ 7
[4163996:MainThread](2024-04-06 19:07:55,935) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 19:07:56,866) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  69%|██████▉   | 36/52 [2:08:02<1:18:17, 293.59s/it][4163996:MainThread](2024-04-06 19:07:56,877) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 19:07:56,892) INFO - qlib.workflow - [recorder.py:341] - Recorder 6e8c9e82a1514e00b1dbdc50b77b0b48 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 19:07:57,623) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 19:07:58,238) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 19:08:03,550) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 19:08:03,551) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 19:08:03,551) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-11-23 SH600000    0.162178
2022-11-24 SH600000    0.195625
2022-11-25 SH600000    0.126634
2022-11-28 SH600000    0.196770
2022-11-29 SH600000    0.092103
[4163996:MainThread](2024-04-06 19:08:15,661) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:08:29,657) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986653, valid -0.984472
[4163996:MainThread](2024-04-06 19:08:29,661) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 19:08:29,662) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:08:41,530) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:08:55,530) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982777, valid -0.982021
[4163996:MainThread](2024-04-06 19:08:55,534) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 19:08:55,535) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:09:07,861) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:09:21,804) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980894, valid -0.984713
[4163996:MainThread](2024-04-06 19:09:21,805) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 19:09:21,805) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:09:34,508) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:09:48,371) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979921, valid -0.981733
[4163996:MainThread](2024-04-06 19:09:48,375) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 19:09:48,375) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:10:01,043) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:10:14,907) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977690, valid -0.979541
[4163996:MainThread](2024-04-06 19:10:14,911) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 19:10:14,911) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:10:26,699) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:10:40,705) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975232, valid -0.979997
[4163996:MainThread](2024-04-06 19:10:40,706) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 19:10:40,706) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:10:52,480) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:11:06,692) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973546, valid -0.981878
[4163996:MainThread](2024-04-06 19:11:06,692) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 19:11:06,693) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:11:18,993) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:11:33,327) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972716, valid -0.983760
[4163996:MainThread](2024-04-06 19:11:33,327) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 19:11:33,328) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:11:46,088) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:12:00,418) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972166, valid -0.989418
[4163996:MainThread](2024-04-06 19:12:00,419) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[4163996:MainThread](2024-04-06 19:12:00,419) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:12:12,560) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:12:27,056) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.969897, valid -0.984961
[4163996:MainThread](2024-04-06 19:12:27,056) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 19:12:27,057) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.979541 @ 4
[4163996:MainThread](2024-04-06 19:12:30,823) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 19:12:32,213) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  71%|███████   | 37/52 [2:12:37<1:12:01, 288.12s/it][4163996:MainThread](2024-04-06 19:12:32,225) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 19:12:32,240) INFO - qlib.workflow - [recorder.py:341] - Recorder 213299159ac54346a6c5649fb284d928 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 19:12:33,003) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 19:12:33,650) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 19:12:38,934) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 19:12:38,934) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 19:12:38,935) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2022-12-21 SH600000    0.098250
2022-12-22 SH600000    0.117512
2022-12-23 SH600000    0.127967
2022-12-26 SH600000    0.073981
2022-12-27 SH600000    0.080063
[4163996:MainThread](2024-04-06 19:12:50,783) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:13:04,228) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986570, valid -0.980763
[4163996:MainThread](2024-04-06 19:13:04,232) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 19:13:04,232) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:13:15,979) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:13:29,192) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983042, valid -0.979557
[4163996:MainThread](2024-04-06 19:13:29,196) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 19:13:29,196) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:13:41,490) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:13:55,217) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980973, valid -0.977331
[4163996:MainThread](2024-04-06 19:13:55,221) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 19:13:55,221) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:14:07,128) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:14:20,857) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978501, valid -0.975959
[4163996:MainThread](2024-04-06 19:14:20,861) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 19:14:20,862) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:14:32,691) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:14:46,189) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977745, valid -0.978187
[4163996:MainThread](2024-04-06 19:14:46,189) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 19:14:46,190) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:14:57,807) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:15:11,427) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977854, valid -0.976069
[4163996:MainThread](2024-04-06 19:15:11,428) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 19:15:11,428) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:15:23,633) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:15:36,976) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973880, valid -0.975748
[4163996:MainThread](2024-04-06 19:15:36,980) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 19:15:36,981) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:15:49,454) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:16:03,138) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972612, valid -0.979967
[4163996:MainThread](2024-04-06 19:16:03,139) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 19:16:03,139) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:16:15,746) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:16:29,604) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973415, valid -0.975472
[4163996:MainThread](2024-04-06 19:16:29,609) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[4163996:MainThread](2024-04-06 19:16:29,610) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:16:42,145) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:16:55,870) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970773, valid -0.976792
[4163996:MainThread](2024-04-06 19:16:55,871) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[4163996:MainThread](2024-04-06 19:16:55,872) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:17:08,201) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:17:22,175) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970404, valid -0.977571
[4163996:MainThread](2024-04-06 19:17:22,176) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch11:
[4163996:MainThread](2024-04-06 19:17:22,176) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:17:34,097) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:17:47,876) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.966993, valid -0.979102
[4163996:MainThread](2024-04-06 19:17:47,877) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch12:
[4163996:MainThread](2024-04-06 19:17:47,877) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:18:00,108) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:18:13,627) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.966893, valid -0.976180
[4163996:MainThread](2024-04-06 19:18:13,627) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch13:
[4163996:MainThread](2024-04-06 19:18:13,628) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:18:25,498) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:18:39,327) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.966149, valid -0.983946
[4163996:MainThread](2024-04-06 19:18:39,327) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 19:18:39,328) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.975472 @ 8
[4163996:MainThread](2024-04-06 19:18:43,039) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 19:18:44,438) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  73%|███████▎  | 38/52 [2:18:50<1:13:06, 313.35s/it][4163996:MainThread](2024-04-06 19:18:44,450) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 19:18:44,466) INFO - qlib.workflow - [recorder.py:341] - Recorder d84cffe9ee42426e92e5756e42a74cd6 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 19:18:45,192) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 19:18:45,884) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 19:18:51,651) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 19:18:51,652) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 19:18:51,652) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-01-19 SH600000    0.079013
2023-01-20 SH600000    0.036617
2023-01-30 SH600000    0.000901
2023-01-31 SH600000    0.051803
2023-02-01 SH600000    0.031684
[4163996:MainThread](2024-04-06 19:19:03,959) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:19:17,836) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986983, valid -0.981855
[4163996:MainThread](2024-04-06 19:19:17,842) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 19:19:17,842) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:19:30,175) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:19:44,097) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.984195, valid -0.981168
[4163996:MainThread](2024-04-06 19:19:44,101) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 19:19:44,102) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:19:56,752) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:20:13,718) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982685, valid -0.979262
[4163996:MainThread](2024-04-06 19:20:13,726) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 19:20:13,727) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:20:28,497) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:20:43,112) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978779, valid -0.980549
[4163996:MainThread](2024-04-06 19:20:43,113) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 19:20:43,113) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:20:55,715) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:21:15,692) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977916, valid -0.983937
[4163996:MainThread](2024-04-06 19:21:15,692) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 19:21:15,693) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:21:28,668) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:21:45,043) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976905, valid -0.979118
[4163996:MainThread](2024-04-06 19:21:45,049) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 19:21:45,049) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:21:58,989) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:22:25,688) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975030, valid -0.986188
[4163996:MainThread](2024-04-06 19:22:25,689) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 19:22:25,690) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:22:48,043) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:23:16,697) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975223, valid -0.979323
[4163996:MainThread](2024-04-06 19:23:16,698) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 19:23:16,699) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:23:38,359) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:24:06,241) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971882, valid -0.985283
[4163996:MainThread](2024-04-06 19:24:06,242) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[4163996:MainThread](2024-04-06 19:24:06,247) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:24:27,957) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:24:50,948) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970063, valid -0.981282
[4163996:MainThread](2024-04-06 19:24:50,949) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[4163996:MainThread](2024-04-06 19:24:50,950) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:25:06,623) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:25:29,170) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.968767, valid -0.982986
[4163996:MainThread](2024-04-06 19:25:29,171) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 19:25:29,171) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.979118 @ 5
[4163996:MainThread](2024-04-06 19:25:35,213) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 19:25:36,396) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  75%|███████▌  | 39/52 [2:25:42<1:14:18, 342.93s/it][4163996:MainThread](2024-04-06 19:25:36,418) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 19:25:36,445) INFO - qlib.workflow - [recorder.py:341] - Recorder e7d1bff99bd844ab852b816f54272053 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 19:25:37,717) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 19:25:38,633) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 19:25:48,217) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 19:25:48,217) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 19:25:48,218) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-02-23 SH600000    0.066284
2023-02-24 SH600000    0.092410
2023-02-27 SH600000   -0.060110
2023-02-28 SH600000   -0.034172
2023-03-01 SH600000    0.081274
[4163996:MainThread](2024-04-06 19:26:07,834) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:26:34,183) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987078, valid -0.980890
[4163996:MainThread](2024-04-06 19:26:34,188) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 19:26:34,189) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:26:53,878) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:27:20,822) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983148, valid -0.979767
[4163996:MainThread](2024-04-06 19:27:20,827) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 19:27:20,827) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:27:43,205) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:28:07,523) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981089, valid -0.977028
[4163996:MainThread](2024-04-06 19:28:07,527) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 19:28:07,528) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:28:28,985) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:28:55,910) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979410, valid -0.981468
[4163996:MainThread](2024-04-06 19:28:55,911) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 19:28:55,911) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:29:15,851) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:29:42,986) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978293, valid -0.979357
[4163996:MainThread](2024-04-06 19:29:42,987) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 19:29:42,987) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:30:05,283) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:30:32,041) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976604, valid -0.980284
[4163996:MainThread](2024-04-06 19:30:32,046) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 19:30:32,047) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:30:53,890) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:31:21,315) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974632, valid -0.979803
[4163996:MainThread](2024-04-06 19:31:21,315) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 19:31:21,316) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:31:40,648) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:32:05,511) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973257, valid -0.976856
[4163996:MainThread](2024-04-06 19:32:05,517) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 19:32:05,518) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:32:24,979) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:32:51,921) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972853, valid -0.980736
[4163996:MainThread](2024-04-06 19:32:51,922) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[4163996:MainThread](2024-04-06 19:32:51,923) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:33:13,425) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:33:40,049) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971314, valid -0.982584
[4163996:MainThread](2024-04-06 19:33:40,049) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[4163996:MainThread](2024-04-06 19:33:40,050) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:34:00,486) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:34:27,117) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.969544, valid -0.978717
[4163996:MainThread](2024-04-06 19:34:27,117) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch11:
[4163996:MainThread](2024-04-06 19:34:27,118) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:34:47,903) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:35:12,143) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.968530, valid -0.983748
[4163996:MainThread](2024-04-06 19:35:12,144) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch12:
[4163996:MainThread](2024-04-06 19:35:12,144) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:35:33,437) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:35:59,280) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.969264, valid -0.978873
[4163996:MainThread](2024-04-06 19:35:59,281) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 19:35:59,281) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.976856 @ 7
[4163996:MainThread](2024-04-06 19:36:05,323) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 19:36:06,154) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  77%|███████▋  | 40/52 [2:36:11<1:25:47, 428.99s/it][4163996:MainThread](2024-04-06 19:36:06,193) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 19:36:06,220) INFO - qlib.workflow - [recorder.py:341] - Recorder 8d81bfe163f843d586a040c0cb786b03 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 19:36:07,400) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 19:36:08,297) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 19:36:18,203) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 19:36:18,204) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 19:36:18,204) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-03-23 SH600000    0.171816
2023-03-24 SH600000    0.150271
2023-03-27 SH600000    0.162567
2023-03-28 SH600000    0.154860
2023-03-29 SH600000    0.191702
[4163996:MainThread](2024-04-06 19:36:39,019) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:37:02,801) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987170, valid -0.984244
[4163996:MainThread](2024-04-06 19:37:02,805) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 19:37:02,805) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:37:22,852) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:37:49,264) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983107, valid -0.986020
[4163996:MainThread](2024-04-06 19:37:49,265) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 19:37:49,265) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:38:08,615) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:38:34,668) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980647, valid -0.982814
[4163996:MainThread](2024-04-06 19:38:34,679) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 19:38:34,679) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:38:55,637) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:39:21,393) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978885, valid -0.981138
[4163996:MainThread](2024-04-06 19:39:21,397) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 19:39:21,398) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:39:39,670) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:40:05,454) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977161, valid -0.982856
[4163996:MainThread](2024-04-06 19:40:05,456) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 19:40:05,457) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:40:26,761) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:40:50,819) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976123, valid -0.982019
[4163996:MainThread](2024-04-06 19:40:50,820) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 19:40:50,820) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:41:09,929) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:41:34,569) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974344, valid -0.981042
[4163996:MainThread](2024-04-06 19:41:34,574) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 19:41:34,575) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:41:55,296) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:42:19,852) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974173, valid -0.989457
[4163996:MainThread](2024-04-06 19:42:19,852) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 19:42:19,853) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:42:40,723) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:43:04,958) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972475, valid -0.984449
[4163996:MainThread](2024-04-06 19:43:04,959) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[4163996:MainThread](2024-04-06 19:43:04,960) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:43:26,431) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:43:50,664) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970382, valid -0.984098
[4163996:MainThread](2024-04-06 19:43:50,665) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[4163996:MainThread](2024-04-06 19:43:50,665) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:44:11,483) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:44:36,739) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970039, valid -0.987893
[4163996:MainThread](2024-04-06 19:44:36,740) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch11:
[4163996:MainThread](2024-04-06 19:44:36,740) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:44:55,979) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:45:21,935) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.968233, valid -0.988229
[4163996:MainThread](2024-04-06 19:45:21,936) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 19:45:21,937) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.981042 @ 6
[4163996:MainThread](2024-04-06 19:45:28,024) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 19:45:29,081) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  79%|███████▉  | 41/52 [2:45:34<1:26:00, 469.16s/it][4163996:MainThread](2024-04-06 19:45:29,099) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 19:45:29,122) INFO - qlib.workflow - [recorder.py:341] - Recorder 63ba0d9be5b9479d98193e9fdab84e0d starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 19:45:30,304) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 19:45:31,045) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 19:45:40,353) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 19:45:40,353) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 19:45:40,354) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-04-21 SH600000    0.168531
2023-04-24 SH600000    0.178940
2023-04-25 SH600000    0.212302
2023-04-26 SH600000    0.233723
2023-04-27 SH600000    0.151588
[4163996:MainThread](2024-04-06 19:46:01,035) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:46:25,647) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986452, valid -0.985965
[4163996:MainThread](2024-04-06 19:46:25,654) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 19:46:25,656) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:46:46,046) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:47:10,433) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982434, valid -0.981586
[4163996:MainThread](2024-04-06 19:47:10,437) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 19:47:10,438) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:47:31,309) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:47:56,691) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980331, valid -0.983715
[4163996:MainThread](2024-04-06 19:47:56,692) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 19:47:56,692) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:48:16,555) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:48:43,183) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978137, valid -0.979957
[4163996:MainThread](2024-04-06 19:48:43,188) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 19:48:43,188) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:49:03,541) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:49:29,026) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976914, valid -0.981823
[4163996:MainThread](2024-04-06 19:49:29,028) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 19:49:29,029) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:49:49,355) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:50:14,154) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975458, valid -0.982305
[4163996:MainThread](2024-04-06 19:50:14,155) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 19:50:14,155) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:50:34,085) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:51:00,955) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976393, valid -0.980615
[4163996:MainThread](2024-04-06 19:51:00,955) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 19:51:00,956) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:51:18,915) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:51:42,205) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972368, valid -0.985036
[4163996:MainThread](2024-04-06 19:51:42,206) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 19:51:42,206) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:52:00,664) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:52:22,300) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971283, valid -0.984956
[4163996:MainThread](2024-04-06 19:52:22,300) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 19:52:22,300) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.979957 @ 3
[4163996:MainThread](2024-04-06 19:52:28,243) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 19:52:29,053) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  81%|████████  | 42/52 [2:52:34<1:15:44, 454.41s/it][4163996:MainThread](2024-04-06 19:52:29,070) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 19:52:29,095) INFO - qlib.workflow - [recorder.py:341] - Recorder 1533374145a64087a8afc07a51a7de90 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 19:52:30,260) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 19:52:31,098) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 19:52:39,584) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 19:52:39,586) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 19:52:39,587) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-05-24 SH600000    0.102524
2023-05-25 SH600000    0.078912
2023-05-26 SH600000    0.074394
2023-05-29 SH600000    0.141477
2023-05-30 SH600000    0.062160
[4163996:MainThread](2024-04-06 19:52:59,201) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:53:23,772) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987771, valid -0.985364
[4163996:MainThread](2024-04-06 19:53:23,777) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 19:53:23,777) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:53:41,457) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:54:05,351) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.984265, valid -0.986961
[4163996:MainThread](2024-04-06 19:54:05,352) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 19:54:05,353) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:54:25,903) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:54:48,829) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981830, valid -0.984041
[4163996:MainThread](2024-04-06 19:54:48,834) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 19:54:48,835) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:55:10,999) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:55:35,079) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978413, valid -0.981065
[4163996:MainThread](2024-04-06 19:55:35,084) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 19:55:35,084) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:55:55,664) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:56:19,787) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977137, valid -0.984175
[4163996:MainThread](2024-04-06 19:56:19,788) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 19:56:19,788) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:56:37,968) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:57:00,947) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975654, valid -0.989073
[4163996:MainThread](2024-04-06 19:57:00,948) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 19:57:00,949) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:57:20,339) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:57:43,037) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974426, valid -0.986785
[4163996:MainThread](2024-04-06 19:57:43,038) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 19:57:43,038) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:58:03,976) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:58:28,034) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973272, valid -0.984527
[4163996:MainThread](2024-04-06 19:58:28,035) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 19:58:28,035) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 19:58:49,301) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 19:59:12,297) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971225, valid -0.987135
[4163996:MainThread](2024-04-06 19:59:12,298) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 19:59:12,298) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.981065 @ 3
[4163996:MainThread](2024-04-06 19:59:18,232) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 19:59:19,126) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  83%|████████▎ | 43/52 [2:59:24<1:06:09, 441.11s/it][4163996:MainThread](2024-04-06 19:59:19,138) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 19:59:19,163) INFO - qlib.workflow - [recorder.py:341] - Recorder 1937ba0ea8f24da39582325314e64671 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 19:59:20,408) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 19:59:21,151) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 19:59:30,544) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 19:59:30,545) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 19:59:30,546) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-06-21 SH600000    0.157015
2023-06-26 SH600000    0.131847
2023-06-27 SH600000    0.129865
2023-06-28 SH600000    0.123861
2023-06-29 SH600000    0.127653
[4163996:MainThread](2024-04-06 19:59:51,090) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:00:13,248) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986337, valid -0.986858
[4163996:MainThread](2024-04-06 20:00:13,254) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 20:00:13,259) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:00:31,673) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:00:52,644) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982721, valid -0.984901
[4163996:MainThread](2024-04-06 20:00:52,657) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 20:00:52,658) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:01:11,190) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:01:31,897) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979976, valid -0.985920
[4163996:MainThread](2024-04-06 20:01:31,897) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 20:01:31,898) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:01:50,018) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:02:12,264) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979274, valid -0.990474
[4163996:MainThread](2024-04-06 20:02:12,265) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 20:02:12,265) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:02:31,251) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:02:52,792) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978488, valid -0.989008
[4163996:MainThread](2024-04-06 20:02:52,792) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 20:02:52,793) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:03:11,196) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:03:32,585) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975150, valid -0.986925
[4163996:MainThread](2024-04-06 20:03:32,586) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 20:03:32,587) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:03:50,276) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:04:11,075) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974768, valid -0.985683
[4163996:MainThread](2024-04-06 20:04:11,076) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 20:04:11,076) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.984901 @ 1
[4163996:MainThread](2024-04-06 20:04:15,985) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 20:04:17,050) INFO - qlib.timer - [log.py:127] - Time cost: 0.005s | waiting `async_log` Done
train tasks:  85%|████████▍ | 44/52 [3:04:22<53:05, 398.15s/it]  [4163996:MainThread](2024-04-06 20:04:17,070) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 20:04:17,096) INFO - qlib.workflow - [recorder.py:341] - Recorder 4c369ed79e1944609c468784ddf408b7 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 20:04:18,175) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 20:04:18,925) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 20:04:27,287) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 20:04:27,290) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 20:04:27,291) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-07-21 SH600000    0.129002
2023-07-24 SH600000    0.167221
2023-07-25 SH600000    0.181924
2023-07-26 SH600000    0.179191
2023-07-27 SH600000    0.172686
[4163996:MainThread](2024-04-06 20:04:41,966) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:05:03,102) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986535, valid -0.986020
[4163996:MainThread](2024-04-06 20:05:03,106) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 20:05:03,106) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:05:22,623) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:05:44,769) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982747, valid -0.982544
[4163996:MainThread](2024-04-06 20:05:44,775) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 20:05:44,775) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:06:04,883) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:06:29,179) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980641, valid -0.988662
[4163996:MainThread](2024-04-06 20:06:29,179) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 20:06:29,180) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:06:47,466) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:07:10,171) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978666, valid -0.984264
[4163996:MainThread](2024-04-06 20:07:10,172) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 20:07:10,172) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:07:29,107) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:07:51,896) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977914, valid -0.983948
[4163996:MainThread](2024-04-06 20:07:51,896) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 20:07:51,896) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:08:10,304) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:08:31,367) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975381, valid -0.983678
[4163996:MainThread](2024-04-06 20:08:31,368) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 20:08:31,368) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:08:50,206) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:09:11,477) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974071, valid -0.982415
[4163996:MainThread](2024-04-06 20:09:11,482) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 20:09:11,482) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:09:31,003) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:09:52,137) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975024, valid -0.993278
[4163996:MainThread](2024-04-06 20:09:52,137) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 20:09:52,138) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:10:09,850) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:10:27,173) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972617, valid -0.985812
[4163996:MainThread](2024-04-06 20:10:27,174) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[4163996:MainThread](2024-04-06 20:10:27,174) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:10:45,557) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:11:08,832) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970331, valid -0.983575
[4163996:MainThread](2024-04-06 20:11:08,833) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[4163996:MainThread](2024-04-06 20:11:08,834) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:11:30,104) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:11:52,060) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.969978, valid -0.987866
[4163996:MainThread](2024-04-06 20:11:52,061) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch11:
[4163996:MainThread](2024-04-06 20:11:52,061) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:12:15,205) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:12:36,086) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.968235, valid -0.983659
[4163996:MainThread](2024-04-06 20:12:36,087) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 20:12:36,087) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.982415 @ 6
[4163996:MainThread](2024-04-06 20:12:40,820) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 20:12:41,904) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  87%|████████▋ | 45/52 [3:12:47<50:11, 430.16s/it][4163996:MainThread](2024-04-06 20:12:41,930) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 20:12:41,967) INFO - qlib.workflow - [recorder.py:341] - Recorder bff82328533b4e99afcab53ab38b6efe starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 20:12:43,110) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 20:12:44,086) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 20:12:52,249) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 20:12:52,249) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 20:12:52,250) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-08-18 SH600000    0.169249
2023-08-21 SH600000    0.112103
2023-08-22 SH600000    0.124893
2023-08-23 SH600000    0.119430
2023-08-24 SH600000    0.141184
[4163996:MainThread](2024-04-06 20:13:10,867) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:13:32,382) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986320, valid -0.984852
[4163996:MainThread](2024-04-06 20:13:32,386) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 20:13:32,387) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:13:50,366) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:14:10,663) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982809, valid -0.983442
[4163996:MainThread](2024-04-06 20:14:10,667) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 20:14:10,668) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:14:27,837) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:14:46,916) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981162, valid -0.989086
[4163996:MainThread](2024-04-06 20:14:46,916) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 20:14:46,917) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:15:04,409) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:15:24,904) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979416, valid -0.983287
[4163996:MainThread](2024-04-06 20:15:24,908) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 20:15:24,908) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:15:43,721) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:16:04,177) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977966, valid -0.988282
[4163996:MainThread](2024-04-06 20:16:04,178) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 20:16:04,178) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:16:18,310) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:16:41,831) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974979, valid -0.986270
[4163996:MainThread](2024-04-06 20:16:41,832) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 20:16:41,832) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:16:58,792) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:17:22,438) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974066, valid -0.985654
[4163996:MainThread](2024-04-06 20:17:22,439) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 20:17:22,440) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:17:39,163) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:18:02,060) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972723, valid -0.985105
[4163996:MainThread](2024-04-06 20:18:02,061) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 20:18:02,062) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:18:19,213) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:18:42,206) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971351, valid -0.985780
[4163996:MainThread](2024-04-06 20:18:42,209) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 20:18:42,210) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.983287 @ 3
[4163996:MainThread](2024-04-06 20:18:47,418) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 20:18:48,180) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  88%|████████▊ | 46/52 [3:18:53<41:05, 411.00s/it][4163996:MainThread](2024-04-06 20:18:48,192) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 20:18:48,207) INFO - qlib.workflow - [recorder.py:341] - Recorder bdd9c75686444078bb19db3d02dd4ca0 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 20:18:48,988) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 20:18:49,660) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 20:18:57,950) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 20:18:57,951) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 20:18:57,952) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-09-15 SH600000    0.124436
2023-09-18 SH600000    0.161264
2023-09-19 SH600000    0.152510
2023-09-20 SH600000    0.205610
2023-09-21 SH600000    0.176355
[4163996:MainThread](2024-04-06 20:19:15,095) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:19:35,264) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986221, valid -0.985450
[4163996:MainThread](2024-04-06 20:19:35,268) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 20:19:35,269) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:19:52,709) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:20:12,661) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982790, valid -0.985122
[4163996:MainThread](2024-04-06 20:20:12,666) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 20:20:12,667) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:20:29,881) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:20:50,586) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981376, valid -0.984792
[4163996:MainThread](2024-04-06 20:20:50,593) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 20:20:50,594) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:21:08,985) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:21:29,276) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978099, valid -0.980143
[4163996:MainThread](2024-04-06 20:21:29,283) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 20:21:29,284) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:21:47,751) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:22:08,481) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976669, valid -0.980065
[4163996:MainThread](2024-04-06 20:22:08,486) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 20:22:08,486) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:22:25,730) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:22:46,137) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975307, valid -0.984889
[4163996:MainThread](2024-04-06 20:22:46,138) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 20:22:46,138) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:23:03,641) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:23:23,583) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974503, valid -0.983187
[4163996:MainThread](2024-04-06 20:23:23,583) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 20:23:23,584) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:23:38,733) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:24:01,269) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973499, valid -0.977576
[4163996:MainThread](2024-04-06 20:24:01,273) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 20:24:01,274) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:24:16,890) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:24:39,035) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.971915, valid -0.980286
[4163996:MainThread](2024-04-06 20:24:39,035) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[4163996:MainThread](2024-04-06 20:24:39,036) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:24:55,421) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:25:18,326) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970634, valid -0.978588
[4163996:MainThread](2024-04-06 20:25:18,327) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[4163996:MainThread](2024-04-06 20:25:18,327) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:25:36,235) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:25:57,462) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.969139, valid -0.984083
[4163996:MainThread](2024-04-06 20:25:57,463) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch11:
[4163996:MainThread](2024-04-06 20:25:57,464) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:26:14,426) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:26:36,271) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970294, valid -0.989204
[4163996:MainThread](2024-04-06 20:26:36,271) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch12:
[4163996:MainThread](2024-04-06 20:26:36,272) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:26:53,250) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:27:14,996) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.968608, valid -0.989875
[4163996:MainThread](2024-04-06 20:27:14,996) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 20:27:14,997) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.977576 @ 7
[4163996:MainThread](2024-04-06 20:27:19,749) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 20:27:20,679) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  90%|█████████ | 47/52 [3:27:26<36:47, 441.45s/it][4163996:MainThread](2024-04-06 20:27:20,691) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 20:27:20,706) INFO - qlib.workflow - [recorder.py:341] - Recorder e4588e58d1c44de1b0fc4f1f0c319de1 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 20:27:21,533) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 20:27:22,208) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 20:27:30,423) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 20:27:30,424) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 20:27:30,424) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-10-23 SH600000    0.205965
2023-10-24 SH600000    0.205507
2023-10-25 SH600000    0.210813
2023-10-26 SH600000    0.089542
2023-10-27 SH600000    0.089525
[4163996:MainThread](2024-04-06 20:27:47,112) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:28:08,809) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986294, valid -0.987856
[4163996:MainThread](2024-04-06 20:28:08,813) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 20:28:08,813) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:28:26,396) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:28:47,030) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982637, valid -0.985979
[4163996:MainThread](2024-04-06 20:28:47,035) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 20:28:47,035) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:29:04,363) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:29:25,200) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980754, valid -0.985755
[4163996:MainThread](2024-04-06 20:29:25,205) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 20:29:25,205) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:29:44,157) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:30:04,943) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978357, valid -0.985758
[4163996:MainThread](2024-04-06 20:30:04,943) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 20:30:04,944) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:30:22,574) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:30:40,897) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977603, valid -0.991099
[4163996:MainThread](2024-04-06 20:30:40,898) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 20:30:40,898) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:30:57,693) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:31:19,711) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976564, valid -0.993816
[4163996:MainThread](2024-04-06 20:31:19,711) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 20:31:19,712) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:31:35,570) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:31:57,672) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973970, valid -0.986472
[4163996:MainThread](2024-04-06 20:31:57,673) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 20:31:57,673) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:32:14,909) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:32:37,803) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975094, valid -0.989148
[4163996:MainThread](2024-04-06 20:32:37,804) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 20:32:37,804) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.985755 @ 2
[4163996:MainThread](2024-04-06 20:32:43,271) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 20:32:44,254) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  92%|█████████▏| 48/52 [3:32:49<27:04, 406.09s/it][4163996:MainThread](2024-04-06 20:32:44,268) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 20:32:44,287) INFO - qlib.workflow - [recorder.py:341] - Recorder 448a5c43cba14874b150ca07f0a3e439 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 20:32:45,312) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 20:32:45,933) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 20:32:53,566) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 20:32:53,567) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 20:32:53,567) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-11-20 SH600000    0.174060
2023-11-21 SH600000    0.114664
2023-11-22 SH600000    0.168792
2023-11-23 SH600000    0.189091
2023-11-24 SH600000    0.172212
[4163996:MainThread](2024-04-06 20:33:11,836) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:33:32,644) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986073, valid -0.988489
[4163996:MainThread](2024-04-06 20:33:32,648) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 20:33:32,649) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:33:52,274) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:34:13,181) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982891, valid -0.987945
[4163996:MainThread](2024-04-06 20:34:13,189) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 20:34:13,190) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:34:33,001) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:34:53,749) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980005, valid -0.988390
[4163996:MainThread](2024-04-06 20:34:53,750) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 20:34:53,751) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:35:14,815) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:35:35,146) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979523, valid -0.998240
[4163996:MainThread](2024-04-06 20:35:35,146) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 20:35:35,147) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:35:56,352) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:36:17,523) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979391, valid -0.992422
[4163996:MainThread](2024-04-06 20:36:17,525) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 20:36:17,525) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:36:40,038) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:37:00,494) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974576, valid -0.989225
[4163996:MainThread](2024-04-06 20:37:00,495) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 20:37:00,496) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:37:22,167) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:37:44,023) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974242, valid -0.993522
[4163996:MainThread](2024-04-06 20:37:44,024) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 20:37:44,024) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.987945 @ 1
[4163996:MainThread](2024-04-06 20:37:47,973) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 20:37:48,903) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  94%|█████████▍| 49/52 [3:37:54<18:46, 375.65s/it][4163996:MainThread](2024-04-06 20:37:48,915) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 20:37:48,931) INFO - qlib.workflow - [recorder.py:341] - Recorder ff3a8326a5af405fbae45209dedf96ea starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 20:37:49,781) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 20:37:50,439) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 20:37:56,259) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 20:37:56,260) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 20:37:56,260) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2023-12-18 SH600000    0.199389
2023-12-19 SH600000    0.237758
2023-12-20 SH600000    0.232523
2023-12-21 SH600000    0.202138
2023-12-22 SH600000    0.202584
[4163996:MainThread](2024-04-06 20:38:14,698) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:38:37,344) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987327, valid -0.984968
[4163996:MainThread](2024-04-06 20:38:37,351) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 20:38:37,352) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:38:54,537) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:39:17,750) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.983212, valid -0.981053
[4163996:MainThread](2024-04-06 20:39:17,755) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 20:39:17,756) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:39:34,816) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:39:57,332) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.980248, valid -0.981769
[4163996:MainThread](2024-04-06 20:39:57,332) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 20:39:57,333) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:40:13,459) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:40:36,446) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978185, valid -0.986008
[4163996:MainThread](2024-04-06 20:40:36,447) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 20:40:36,448) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:40:52,341) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:41:15,409) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978415, valid -0.990479
[4163996:MainThread](2024-04-06 20:41:15,410) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 20:41:15,411) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:41:32,308) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:41:56,141) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976857, valid -0.990215
[4163996:MainThread](2024-04-06 20:41:56,142) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 20:41:56,142) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:42:12,634) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:42:36,144) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976106, valid -0.986312
[4163996:MainThread](2024-04-06 20:42:36,145) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 20:42:36,145) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.981053 @ 1
[4163996:MainThread](2024-04-06 20:42:41,793) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 20:42:42,915) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  96%|█████████▌| 50/52 [3:42:48<11:42, 351.16s/it][4163996:MainThread](2024-04-06 20:42:42,932) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 20:42:42,955) INFO - qlib.workflow - [recorder.py:341] - Recorder 01f33563f2e74a8b90fa43c4e55d5535 starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 20:42:44,084) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 20:42:44,772) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 20:42:51,789) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 20:42:51,790) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 20:42:51,790) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2024-01-16 SH600000    0.127712
2024-01-17 SH600000    0.087908
2024-01-18 SH600000   -0.027780
2024-01-19 SH600000   -0.004331
2024-01-22 SH600000   -0.006385
[4163996:MainThread](2024-04-06 20:43:12,243) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:43:33,919) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986386, valid -0.978353
[4163996:MainThread](2024-04-06 20:43:33,926) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 20:43:33,927) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:43:54,778) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:44:17,351) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982336, valid -0.979183
[4163996:MainThread](2024-04-06 20:44:17,351) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 20:44:17,352) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:44:40,050) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:45:01,803) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979822, valid -0.982042
[4163996:MainThread](2024-04-06 20:45:01,803) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 20:45:01,804) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:45:24,549) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:45:46,444) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978743, valid -0.983537
[4163996:MainThread](2024-04-06 20:45:46,444) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 20:45:46,445) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:46:00,631) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:46:22,595) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.979820, valid -0.982634
[4163996:MainThread](2024-04-06 20:46:22,596) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 20:46:22,596) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:46:41,680) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:47:02,860) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.976684, valid -0.983711
[4163996:MainThread](2024-04-06 20:47:02,861) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 20:47:02,861) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.978353 @ 0
[4163996:MainThread](2024-04-06 20:47:07,480) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 20:47:08,541) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  98%|█████████▊| 51/52 [3:47:14<05:25, 325.50s/it][4163996:MainThread](2024-04-06 20:47:08,564) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[4163996:MainThread](2024-04-06 20:47:08,594) INFO - qlib.workflow - [recorder.py:341] - Recorder 3c96f78e723f4f91b7c0b7ab197f4cde starts running under Experiment 17 ...
[4163996:MainThread](2024-04-06 20:47:09,774) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 8192
device : cuda:1
[4163996:MainThread](2024-04-06 20:47:10,596) WARNING - qlib.utils - [__init__.py:789] - The parameter `reweighter` with value `None` is ignored.
[4163996:MainThread](2024-04-06 20:47:18,943) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[4163996:MainThread](2024-04-06 20:47:18,943) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[4163996:MainThread](2024-04-06 20:47:18,944) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2024-02-21 SH600000    0.092813
2024-02-22 SH600000    0.128173
2024-02-23 SH600000    0.144167
2024-02-26 SH600000    0.181705
2024-02-27 SH600000    0.188472
[4163996:MainThread](2024-04-06 20:47:38,662) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:47:59,768) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986281, valid -0.977961
[4163996:MainThread](2024-04-06 20:47:59,779) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[4163996:MainThread](2024-04-06 20:47:59,780) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:48:17,660) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:48:39,640) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.982707, valid -0.979039
[4163996:MainThread](2024-04-06 20:48:39,641) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[4163996:MainThread](2024-04-06 20:48:39,641) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:48:58,653) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:49:20,335) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.981903, valid -0.977216
[4163996:MainThread](2024-04-06 20:49:20,339) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[4163996:MainThread](2024-04-06 20:49:20,339) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:49:37,788) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:50:00,050) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.978298, valid -0.977672
[4163996:MainThread](2024-04-06 20:50:00,051) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[4163996:MainThread](2024-04-06 20:50:00,052) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:50:16,907) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:50:39,837) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.977175, valid -0.976330
[4163996:MainThread](2024-04-06 20:50:39,843) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[4163996:MainThread](2024-04-06 20:50:39,843) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:50:57,411) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:51:19,865) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.975485, valid -0.975998
[4163996:MainThread](2024-04-06 20:51:19,871) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[4163996:MainThread](2024-04-06 20:51:19,871) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:51:35,722) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:51:58,676) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.974347, valid -0.977182
[4163996:MainThread](2024-04-06 20:51:58,677) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[4163996:MainThread](2024-04-06 20:51:58,678) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:52:14,435) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:52:32,175) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.973593, valid -0.984887
[4163996:MainThread](2024-04-06 20:52:32,176) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[4163996:MainThread](2024-04-06 20:52:32,176) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:52:52,136) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:53:13,618) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.972108, valid -0.979237
[4163996:MainThread](2024-04-06 20:53:13,619) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[4163996:MainThread](2024-04-06 20:53:13,620) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:53:33,469) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:53:54,623) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970833, valid -0.978889
[4163996:MainThread](2024-04-06 20:53:54,624) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[4163996:MainThread](2024-04-06 20:53:54,625) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[4163996:MainThread](2024-04-06 20:54:14,694) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[4163996:MainThread](2024-04-06 20:54:36,217) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.970130, valid -0.980632
[4163996:MainThread](2024-04-06 20:54:36,218) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[4163996:MainThread](2024-04-06 20:54:36,219) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.975998 @ 5
[4163996:MainThread](2024-04-06 20:54:40,881) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
[4163996:MainThread](2024-04-06 20:54:41,658) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks: 100%|██████████| 52/52 [3:54:47<00:00, 363.79s/it]train tasks: 100%|██████████| 52/52 [3:54:47<00:00, 270.91s/it]
[4163996:MainThread](2024-04-06 20:54:42,140) INFO - qlib.timer - [log.py:127] - Time cost: 0.357s | Time to `list_recorders` in RecorderCollector Done
[4163996:MainThread](2024-04-06 20:54:42,140) INFO - qlib.RecorderCollector - [collect.py:226] - Nubmer of recorders after filter: defaultdict(<class 'int'>, {'FINISHED': 52})
[4163996:MainThread](2024-04-06 20:54:42,286) INFO - qlib.RollingEnsemble - [ensemble.py:81] - keys in group: ['3c96f78e723f4f91b7c0b7ab197f4cde', '01f33563f2e74a8b90fa43c4e55d5535', 'ff3a8326a5af405fbae45209dedf96ea', '448a5c43cba14874b150ca07f0a3e439', 'e4588e58d1c44de1b0fc4f1f0c319de1', 'bdd9c75686444078bb19db3d02dd4ca0', 'bff82328533b4e99afcab53ab38b6efe', '4c369ed79e1944609c468784ddf408b7', '1937ba0ea8f24da39582325314e64671', '1533374145a64087a8afc07a51a7de90', '63ba0d9be5b9479d98193e9fdab84e0d', '8d81bfe163f843d586a040c0cb786b03', 'e7d1bff99bd844ab852b816f54272053', 'd84cffe9ee42426e92e5756e42a74cd6', '213299159ac54346a6c5649fb284d928', '6e8c9e82a1514e00b1dbdc50b77b0b48', '33afd7dcb7cc4b8d9d7925f71fe9c1f4', '023bd03859b049d2be974f180fc4fea4', '95c58e557f224f6fabfd506ffa45d236', '659d4d8f1aa348309cd1a1fa7c60c0cf', '2763fc093e0e4e76ad3372101533219f', '15f8d6c62c8149f7b5ecdd13d79c28d5', '7cca5b098cd341caae9d9148a1d8f100', '0b4c17f86f434f389b1e081221b5207a', '4094d3452e4d43f39d2d2461f32c873f', '765e7bc689fa4ca9a2b757d31daf3f13', '3fc1503f170c446287f5222435863eab', '58baf694358f4c0ca811c7be9db103bc', '1baeaa0fe3784f04a619e907f5985130', '96a59b68366b4ae7b95097337fcf4223', '9d8d429443414898b436721b2eefb264', '6331ed00c09e461392423ccace729f01', '17c752a1888f4e93be6b8e6e127f19b1', 'f98c643cbe2e4208868750a6e56e8ecd', '76138ce33bff43859552e34a3ab97e95', '5afddc41f75343798725f825d62b9b37', '50161a2f7a964153a9b1488ee7bb3b65', '8446eb0bcdc2445ba879f50e7af1a486', 'b02da833eca4479ab05b0f1bf8e5899f', '6710ecdf2657428aa63ff4f3fa309899', '6cd18440fdf44254b5aba0418a4c3111', 'f7698f72e5df4ec0b0c3e53acffc7e67', '53f760bfd9ef4a48af1b119280b13e69', '7aed69baa7e744e7911981cdc52335d1', '84573874623f4794ad394437c28f1ada', '4b5285a0bf074589897d3aacab992e50', '83ebb2fd8ea543fab1f7dd816ca6b3cc', '577fd27a49424c8a9c82258ea2dce314', 'aa25195d07a04b7aa2a21f0342727b15', '968e61e2c7ee4001819bc5dfacf06971', '33a75c87be80453c9eba52b45d0f6661', '33de6b94c31b40498c364f489e16272c']
[4163996:MainThread](2024-04-06 20:54:42,425) INFO - qlib.RollingEnsemble - [ensemble.py:81] - keys in group: ['3c96f78e723f4f91b7c0b7ab197f4cde', '01f33563f2e74a8b90fa43c4e55d5535', 'ff3a8326a5af405fbae45209dedf96ea', '448a5c43cba14874b150ca07f0a3e439', 'e4588e58d1c44de1b0fc4f1f0c319de1', 'bdd9c75686444078bb19db3d02dd4ca0', 'bff82328533b4e99afcab53ab38b6efe', '4c369ed79e1944609c468784ddf408b7', '1937ba0ea8f24da39582325314e64671', '1533374145a64087a8afc07a51a7de90', '63ba0d9be5b9479d98193e9fdab84e0d', '8d81bfe163f843d586a040c0cb786b03', 'e7d1bff99bd844ab852b816f54272053', 'd84cffe9ee42426e92e5756e42a74cd6', '213299159ac54346a6c5649fb284d928', '6e8c9e82a1514e00b1dbdc50b77b0b48', '33afd7dcb7cc4b8d9d7925f71fe9c1f4', '023bd03859b049d2be974f180fc4fea4', '95c58e557f224f6fabfd506ffa45d236', '659d4d8f1aa348309cd1a1fa7c60c0cf', '2763fc093e0e4e76ad3372101533219f', '15f8d6c62c8149f7b5ecdd13d79c28d5', '7cca5b098cd341caae9d9148a1d8f100', '0b4c17f86f434f389b1e081221b5207a', '4094d3452e4d43f39d2d2461f32c873f', '765e7bc689fa4ca9a2b757d31daf3f13', '3fc1503f170c446287f5222435863eab', '58baf694358f4c0ca811c7be9db103bc', '1baeaa0fe3784f04a619e907f5985130', '96a59b68366b4ae7b95097337fcf4223', '9d8d429443414898b436721b2eefb264', '6331ed00c09e461392423ccace729f01', '17c752a1888f4e93be6b8e6e127f19b1', 'f98c643cbe2e4208868750a6e56e8ecd', '76138ce33bff43859552e34a3ab97e95', '5afddc41f75343798725f825d62b9b37', '50161a2f7a964153a9b1488ee7bb3b65', '8446eb0bcdc2445ba879f50e7af1a486', 'b02da833eca4479ab05b0f1bf8e5899f', '6710ecdf2657428aa63ff4f3fa309899', '6cd18440fdf44254b5aba0418a4c3111', 'f7698f72e5df4ec0b0c3e53acffc7e67', '53f760bfd9ef4a48af1b119280b13e69', '7aed69baa7e744e7911981cdc52335d1', '84573874623f4794ad394437c28f1ada', '4b5285a0bf074589897d3aacab992e50', '83ebb2fd8ea543fab1f7dd816ca6b3cc', '577fd27a49424c8a9c82258ea2dce314', 'aa25195d07a04b7aa2a21f0342727b15', '968e61e2c7ee4001819bc5dfacf06971', '33a75c87be80453c9eba52b45d0f6661', '33de6b94c31b40498c364f489e16272c']
[4163996:MainThread](2024-04-06 20:54:42,592) INFO - qlib.workflow - [exp.py:258] - Experiment 3 starts running ...
[4163996:MainThread](2024-04-06 20:54:42,618) INFO - qlib.workflow - [recorder.py:341] - Recorder ce6fc84986f549378f2ad90f2acd52a6 starts running under Experiment 3 ...
[4163996:MainThread](2024-04-06 20:54:43,762) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
[4163996:MainThread](2024-04-06 20:54:45,653) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
'The following are prediction results of the TransformerModel model.'
                          score
datetime   instrument          
2024-03-20 SH600000    0.134688
2024-03-21 SH600000    0.153431
2024-03-22 SH600000    0.117808
2024-03-25 SH600000    0.128340
2024-03-26 SH600000    0.143128
{'IC': 0.07868436628258807,
 'ICIR': 0.5150940151886101,
 'Rank IC': 0.09390272910247344,
 'Rank ICIR': 0.6308276185833687}
[4163996:MainThread](2024-04-06 20:55:02,584) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[4163996:MainThread](2024-04-06 20:55:02,587) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[4163996:MainThread](2024-04-06 20:55:11,964) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fa3bd93c250>
backtest loop:   0%|          | 0/1025 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/1025 [00:00<00:37, 26.99it/s]backtest loop:   1%|          | 7/1025 [00:00<00:30, 32.99it/s]backtest loop:   1%|          | 12/1025 [00:00<00:28, 35.95it/s]backtest loop:   2%|▏         | 16/1025 [00:00<00:27, 36.06it/s]backtest loop:   2%|▏         | 21/1025 [00:00<00:26, 37.66it/s]backtest loop:   3%|▎         | 26/1025 [00:00<00:25, 39.00it/s]backtest loop:   3%|▎         | 31/1025 [00:00<00:25, 39.62it/s]backtest loop:   4%|▎         | 36/1025 [00:00<00:24, 39.90it/s]backtest loop:   4%|▍         | 41/1025 [00:01<00:24, 40.38it/s]backtest loop:   4%|▍         | 46/1025 [00:01<00:24, 40.61it/s]backtest loop:   5%|▍         | 51/1025 [00:01<00:23, 40.67it/s]backtest loop:   5%|▌         | 56/1025 [00:01<00:23, 40.44it/s]backtest loop:   6%|▌         | 61/1025 [00:01<00:25, 38.25it/s]backtest loop:   6%|▋         | 65/1025 [00:01<00:26, 36.44it/s]backtest loop:   7%|▋         | 70/1025 [00:01<00:26, 36.55it/s]backtest loop:   7%|▋         | 75/1025 [00:01<00:25, 36.63it/s]backtest loop:   8%|▊         | 79/1025 [00:02<00:26, 35.79it/s]backtest loop:   8%|▊         | 83/1025 [00:02<00:26, 35.26it/s]backtest loop:   8%|▊         | 87/1025 [00:02<00:26, 35.03it/s]backtest loop:   9%|▉         | 92/1025 [00:02<00:25, 36.31it/s]backtest loop:   9%|▉         | 97/1025 [00:02<00:24, 37.53it/s]backtest loop:  10%|▉         | 102/1025 [00:02<00:24, 38.30it/s]backtest loop:  10%|█         | 107/1025 [00:02<00:24, 38.10it/s]backtest loop:  11%|█         | 113/1025 [00:02<00:21, 42.36it/s]backtest loop:  12%|█▏        | 119/1025 [00:03<00:19, 46.84it/s]backtest loop:  12%|█▏        | 125/1025 [00:03<00:19, 46.74it/s]backtest loop:  13%|█▎        | 131/1025 [00:03<00:17, 49.78it/s]backtest loop:  13%|█▎        | 137/1025 [00:03<00:17, 51.29it/s]backtest loop:  14%|█▍        | 143/1025 [00:03<00:16, 53.02it/s]backtest loop:  15%|█▍        | 149/1025 [00:03<00:16, 53.89it/s]backtest loop:  15%|█▌        | 155/1025 [00:03<00:16, 51.52it/s]backtest loop:  16%|█▌        | 161/1025 [00:03<00:16, 53.14it/s]backtest loop:  16%|█▋        | 167/1025 [00:03<00:15, 54.51it/s]backtest loop:  17%|█▋        | 173/1025 [00:04<00:15, 55.29it/s]backtest loop:  17%|█▋        | 179/1025 [00:04<00:15, 55.58it/s]backtest loop:  18%|█▊        | 185/1025 [00:04<00:18, 44.98it/s]backtest loop:  19%|█▊        | 190/1025 [00:04<00:18, 44.36it/s]backtest loop:  19%|█▉        | 196/1025 [00:04<00:17, 47.27it/s]backtest loop:  20%|█▉        | 202/1025 [00:04<00:16, 49.92it/s]backtest loop:  20%|██        | 208/1025 [00:04<00:15, 51.69it/s]backtest loop:  21%|██        | 214/1025 [00:04<00:16, 50.42it/s]backtest loop:  21%|██▏       | 220/1025 [00:05<00:16, 49.80it/s]backtest loop:  22%|██▏       | 226/1025 [00:05<00:17, 46.16it/s]backtest loop:  23%|██▎       | 231/1025 [00:05<00:19, 40.73it/s]backtest loop:  23%|██▎       | 236/1025 [00:05<00:21, 37.39it/s]backtest loop:  23%|██▎       | 240/1025 [00:05<00:22, 34.98it/s]backtest loop:  24%|██▍       | 246/1025 [00:05<00:19, 39.34it/s]backtest loop:  24%|██▍       | 251/1025 [00:05<00:18, 41.80it/s]backtest loop:  25%|██▌       | 257/1025 [00:05<00:17, 44.70it/s]backtest loop:  26%|██▌       | 262/1025 [00:06<00:18, 41.75it/s]backtest loop:  26%|██▌       | 267/1025 [00:06<00:20, 37.59it/s]backtest loop:  26%|██▋       | 271/1025 [00:06<00:23, 31.84it/s]backtest loop:  27%|██▋       | 276/1025 [00:06<00:21, 34.71it/s]backtest loop:  27%|██▋       | 280/1025 [00:06<00:20, 35.65it/s]backtest loop:  28%|██▊       | 284/1025 [00:06<00:22, 33.66it/s]backtest loop:  28%|██▊       | 288/1025 [00:06<00:21, 34.18it/s]backtest loop:  29%|██▊       | 293/1025 [00:07<00:20, 35.44it/s]backtest loop:  29%|██▉       | 298/1025 [00:07<00:19, 36.66it/s]backtest loop:  30%|██▉       | 303/1025 [00:07<00:19, 37.51it/s]backtest loop:  30%|██▉       | 307/1025 [00:07<00:19, 37.45it/s]backtest loop:  30%|███       | 312/1025 [00:07<00:18, 37.99it/s]backtest loop:  31%|███       | 317/1025 [00:07<00:18, 38.06it/s]backtest loop:  31%|███▏      | 322/1025 [00:07<00:18, 38.67it/s]backtest loop:  32%|███▏      | 326/1025 [00:07<00:18, 37.87it/s]backtest loop:  32%|███▏      | 331/1025 [00:08<00:17, 39.12it/s]backtest loop:  33%|███▎      | 335/1025 [00:08<00:18, 38.00it/s]backtest loop:  33%|███▎      | 339/1025 [00:08<00:18, 37.61it/s]backtest loop:  34%|███▎      | 344/1025 [00:08<00:18, 36.72it/s]backtest loop:  34%|███▍      | 349/1025 [00:08<00:17, 37.96it/s]backtest loop:  34%|███▍      | 353/1025 [00:08<00:18, 36.97it/s]backtest loop:  35%|███▍      | 358/1025 [00:08<00:17, 37.85it/s]backtest loop:  35%|███▌      | 363/1025 [00:08<00:17, 37.91it/s]backtest loop:  36%|███▌      | 368/1025 [00:09<00:16, 38.85it/s]backtest loop:  36%|███▋      | 373/1025 [00:09<00:16, 39.06it/s]backtest loop:  37%|███▋      | 378/1025 [00:09<00:16, 38.55it/s]backtest loop:  37%|███▋      | 383/1025 [00:09<00:16, 38.25it/s]backtest loop:  38%|███▊      | 388/1025 [00:09<00:16, 38.64it/s]backtest loop:  38%|███▊      | 393/1025 [00:09<00:16, 38.93it/s]backtest loop:  39%|███▉      | 398/1025 [00:09<00:16, 37.78it/s]backtest loop:  39%|███▉      | 403/1025 [00:09<00:16, 37.19it/s]backtest loop:  40%|███▉      | 407/1025 [00:10<00:16, 37.53it/s]backtest loop:  40%|████      | 411/1025 [00:10<00:17, 35.81it/s]backtest loop:  40%|████      | 415/1025 [00:10<00:17, 35.68it/s]backtest loop:  41%|████      | 419/1025 [00:10<00:17, 33.98it/s]backtest loop:  41%|████▏     | 423/1025 [00:10<00:18, 32.90it/s]backtest loop:  42%|████▏     | 427/1025 [00:10<00:20, 29.80it/s]backtest loop:  42%|████▏     | 431/1025 [00:10<00:19, 30.41it/s]backtest loop:  43%|████▎     | 436/1025 [00:10<00:18, 31.92it/s]backtest loop:  43%|████▎     | 441/1025 [00:11<00:18, 31.70it/s]backtest loop:  44%|████▎     | 446/1025 [00:11<00:18, 31.29it/s]backtest loop:  44%|████▍     | 451/1025 [00:11<00:18, 30.92it/s]backtest loop:  44%|████▍     | 456/1025 [00:11<00:18, 30.99it/s]backtest loop:  45%|████▍     | 460/1025 [00:11<00:17, 32.71it/s]backtest loop:  45%|████▌     | 464/1025 [00:11<00:18, 31.06it/s]backtest loop:  46%|████▌     | 468/1025 [00:12<00:18, 29.61it/s]backtest loop:  46%|████▌     | 472/1025 [00:12<00:18, 30.21it/s]backtest loop:  46%|████▋     | 476/1025 [00:12<00:18, 29.66it/s]backtest loop:  47%|████▋     | 481/1025 [00:12<00:18, 29.91it/s]backtest loop:  47%|████▋     | 486/1025 [00:12<00:17, 29.95it/s]backtest loop:  48%|████▊     | 490/1025 [00:12<00:18, 29.60it/s]backtest loop:  48%|████▊     | 495/1025 [00:12<00:17, 30.04it/s]backtest loop:  49%|████▊     | 499/1025 [00:13<00:16, 32.12it/s]backtest loop:  49%|████▉     | 503/1025 [00:13<00:17, 30.51it/s]backtest loop:  49%|████▉     | 507/1025 [00:13<00:17, 29.73it/s]backtest loop:  50%|████▉     | 511/1025 [00:13<00:16, 30.26it/s]backtest loop:  50%|█████     | 517/1025 [00:13<00:13, 36.76it/s]backtest loop:  51%|█████     | 523/1025 [00:13<00:11, 41.92it/s]backtest loop:  52%|█████▏    | 529/1025 [00:13<00:10, 46.24it/s]backtest loop:  52%|█████▏    | 534/1025 [00:13<00:11, 43.21it/s]backtest loop:  53%|█████▎    | 539/1025 [00:14<00:11, 41.46it/s]backtest loop:  53%|█████▎    | 544/1025 [00:14<00:11, 41.29it/s]backtest loop:  54%|█████▎    | 549/1025 [00:14<00:11, 39.76it/s]backtest loop:  54%|█████▍    | 555/1025 [00:14<00:10, 44.35it/s]backtest loop:  55%|█████▍    | 561/1025 [00:14<00:09, 48.07it/s]backtest loop:  55%|█████▌    | 566/1025 [00:14<00:09, 47.23it/s]backtest loop:  56%|█████▌    | 571/1025 [00:14<00:09, 46.29it/s]backtest loop:  56%|█████▌    | 576/1025 [00:14<00:10, 43.77it/s]backtest loop:  57%|█████▋    | 581/1025 [00:15<00:10, 40.49it/s]backtest loop:  57%|█████▋    | 587/1025 [00:15<00:09, 45.23it/s]backtest loop:  58%|█████▊    | 594/1025 [00:15<00:09, 46.94it/s]backtest loop:  59%|█████▊    | 600/1025 [00:15<00:08, 49.27it/s]backtest loop:  59%|█████▉    | 606/1025 [00:15<00:08, 51.17it/s]backtest loop:  60%|█████▉    | 612/1025 [00:15<00:07, 52.73it/s]backtest loop:  60%|██████    | 618/1025 [00:15<00:07, 53.70it/s]backtest loop:  61%|██████    | 624/1025 [00:15<00:07, 51.12it/s]backtest loop:  61%|██████▏   | 630/1025 [00:15<00:07, 52.48it/s]backtest loop:  62%|██████▏   | 636/1025 [00:16<00:07, 53.44it/s]backtest loop:  63%|██████▎   | 642/1025 [00:16<00:07, 53.65it/s]backtest loop:  63%|██████▎   | 648/1025 [00:16<00:07, 51.59it/s]backtest loop:  64%|██████▍   | 654/1025 [00:16<00:08, 43.62it/s]backtest loop:  64%|██████▍   | 659/1025 [00:16<00:08, 43.15it/s]backtest loop:  65%|██████▍   | 664/1025 [00:16<00:08, 42.67it/s]backtest loop:  65%|██████▌   | 669/1025 [00:16<00:08, 42.65it/s]backtest loop:  66%|██████▌   | 675/1025 [00:16<00:07, 46.49it/s]backtest loop:  66%|██████▋   | 681/1025 [00:17<00:06, 49.33it/s]backtest loop:  67%|██████▋   | 687/1025 [00:17<00:06, 50.98it/s]backtest loop:  68%|██████▊   | 693/1025 [00:17<00:06, 50.01it/s]backtest loop:  68%|██████▊   | 699/1025 [00:17<00:06, 51.85it/s]backtest loop:  69%|██████▉   | 705/1025 [00:17<00:06, 53.04it/s]backtest loop:  69%|██████▉   | 712/1025 [00:17<00:05, 55.81it/s]backtest loop:  70%|███████   | 718/1025 [00:17<00:05, 53.74it/s]backtest loop:  71%|███████   | 725/1025 [00:17<00:07, 42.19it/s]backtest loop:  71%|███████▏  | 732/1025 [00:18<00:06, 44.74it/s]backtest loop:  72%|███████▏  | 738/1025 [00:18<00:06, 47.31it/s]backtest loop:  73%|███████▎  | 744/1025 [00:18<00:05, 48.68it/s]backtest loop:  73%|███████▎  | 750/1025 [00:18<00:05, 46.41it/s]backtest loop:  74%|███████▎  | 755/1025 [00:18<00:06, 44.43it/s]backtest loop:  74%|███████▍  | 760/1025 [00:18<00:06, 43.05it/s]backtest loop:  75%|███████▍  | 765/1025 [00:18<00:06, 41.87it/s]backtest loop:  75%|███████▌  | 771/1025 [00:18<00:05, 45.98it/s]backtest loop:  76%|███████▌  | 777/1025 [00:19<00:05, 45.71it/s]backtest loop:  76%|███████▋  | 783/1025 [00:19<00:05, 48.25it/s]backtest loop:  77%|███████▋  | 789/1025 [00:19<00:05, 47.03it/s]backtest loop:  78%|███████▊  | 795/1025 [00:19<00:04, 49.39it/s]backtest loop:  78%|███████▊  | 801/1025 [00:19<00:04, 48.56it/s]backtest loop:  79%|███████▊  | 807/1025 [00:19<00:04, 51.27it/s]backtest loop:  79%|███████▉  | 813/1025 [00:19<00:04, 49.87it/s]backtest loop:  80%|███████▉  | 819/1025 [00:19<00:03, 51.84it/s]backtest loop:  80%|████████  | 825/1025 [00:19<00:03, 52.81it/s]backtest loop:  81%|████████  | 831/1025 [00:20<00:03, 53.85it/s]backtest loop:  82%|████████▏ | 837/1025 [00:20<00:03, 54.32it/s]backtest loop:  82%|████████▏ | 843/1025 [00:20<00:03, 50.09it/s]backtest loop:  83%|████████▎ | 849/1025 [00:20<00:03, 51.63it/s]backtest loop:  83%|████████▎ | 855/1025 [00:20<00:03, 53.21it/s]backtest loop:  84%|████████▍ | 861/1025 [00:20<00:03, 51.30it/s]backtest loop:  85%|████████▍ | 867/1025 [00:20<00:03, 52.31it/s]backtest loop:  85%|████████▌ | 873/1025 [00:20<00:02, 53.30it/s]backtest loop:  86%|████████▌ | 879/1025 [00:21<00:02, 53.72it/s]backtest loop:  86%|████████▋ | 885/1025 [00:21<00:02, 51.70it/s]backtest loop:  87%|████████▋ | 891/1025 [00:21<00:03, 42.36it/s]backtest loop:  87%|████████▋ | 896/1025 [00:21<00:02, 44.10it/s]backtest loop:  88%|████████▊ | 901/1025 [00:21<00:02, 45.50it/s]backtest loop:  88%|████████▊ | 906/1025 [00:21<00:02, 46.65it/s]backtest loop:  89%|████████▉ | 911/1025 [00:21<00:02, 46.94it/s]backtest loop:  89%|████████▉ | 916/1025 [00:21<00:02, 40.54it/s]backtest loop:  90%|████████▉ | 921/1025 [00:22<00:02, 36.29it/s]backtest loop:  90%|█████████ | 925/1025 [00:22<00:02, 33.86it/s]backtest loop:  91%|█████████ | 930/1025 [00:22<00:02, 33.03it/s]backtest loop:  91%|█████████ | 935/1025 [00:22<00:02, 33.52it/s]backtest loop:  92%|█████████▏| 939/1025 [00:22<00:02, 34.59it/s]backtest loop:  92%|█████████▏| 943/1025 [00:22<00:02, 31.83it/s]backtest loop:  92%|█████████▏| 947/1025 [00:22<00:02, 29.84it/s]backtest loop:  93%|█████████▎| 951/1025 [00:23<00:02, 28.45it/s]backtest loop:  93%|█████████▎| 955/1025 [00:23<00:02, 27.71it/s]backtest loop:  94%|█████████▎| 959/1025 [00:23<00:02, 30.05it/s]backtest loop:  94%|█████████▍| 963/1025 [00:23<00:02, 28.35it/s]backtest loop:  94%|█████████▍| 966/1025 [00:23<00:02, 26.63it/s]backtest loop:  95%|█████████▍| 970/1025 [00:23<00:02, 27.13it/s]backtest loop:  95%|█████████▌| 974/1025 [00:23<00:01, 26.90it/s]backtest loop:  95%|█████████▌| 978/1025 [00:24<00:01, 29.90it/s]backtest loop:  96%|█████████▌| 982/1025 [00:24<00:01, 29.31it/s]backtest loop:  96%|█████████▌| 986/1025 [00:24<00:01, 28.95it/s]backtest loop:  96%|█████████▋| 989/1025 [00:24<00:01, 28.10it/s]backtest loop:  97%|█████████▋| 994/1025 [00:24<00:01, 29.10it/s]backtest loop:  97%|█████████▋| 998/1025 [00:24<00:00, 28.54it/s]backtest loop:  98%|█████████▊| 1003/1025 [00:24<00:00, 29.69it/s]backtest loop:  98%|█████████▊| 1008/1025 [00:25<00:00, 33.97it/s]backtest loop:  99%|█████████▉| 1013/1025 [00:25<00:00, 33.20it/s]backtest loop:  99%|█████████▉| 1017/1025 [00:25<00:00, 34.66it/s]backtest loop: 100%|█████████▉| 1021/1025 [00:25<00:00, 32.32it/s]backtest loop: 100%|██████████| 1025/1025 [00:25<00:00, 30.59it/s]backtest loop: 100%|██████████| 1025/1025 [00:25<00:00, 40.10it/s]
[4163996:MainThread](2024-04-06 20:55:37,672) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 3
[4163996:MainThread](2024-04-06 20:55:37,702) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 3
'The following are analysis results of benchmark return(1day).'
                       risk
mean              -0.000070
std                0.011971
annualized_return -0.016567
information_ratio -0.089706
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000875
std                0.004881
annualized_return  0.208187
information_ratio  2.764882
max_drawdown      -0.058362
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000674
std                0.004880
annualized_return  0.160358
information_ratio  2.129931
max_drawdown      -0.071687
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `None`.

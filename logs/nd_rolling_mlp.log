[4142451:MainThread](2024-04-06 16:13:08,424) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[4142451:MainThread](2024-04-06 16:13:08,426) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[4142451:MainThread](2024-04-06 16:13:08,426) INFO - qlib.Initialization - [__init__.py:76] - data_path={'day': PosixPath('/home/zhonghao/.qlib/qlib_data/my_data')}
[4142451:MainThread](2024-04-06 16:13:08,428) WARNING - qlib.Rolling - [rolling_benchmark.py:32] - Model type is not in the benchmark!
[4142451:MainThread](2024-04-06 16:13:08,440) INFO - qlib.Rolling - [base.py:162] - The prediction horizon is overrided
[4142451:MainThread](2024-04-06 16:13:28,088) INFO - qlib.timer - [log.py:127] - Time cost: 19.647s | Loading data Done
[4142451:MainThread](2024-04-06 16:13:29,371) INFO - qlib.timer - [log.py:127] - Time cost: 0.325s | DropCol Done
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/qlib/data/dataset/processor.py:391: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[cols] = (
[4142451:MainThread](2024-04-06 16:19:23,710) INFO - qlib.timer - [log.py:127] - Time cost: 354.338s | CSZFillna Done
[4142451:MainThread](2024-04-06 16:19:24,972) INFO - qlib.timer - [log.py:127] - Time cost: 0.323s | DropCol Done
[4142451:MainThread](2024-04-06 16:19:25,839) INFO - qlib.timer - [log.py:127] - Time cost: 0.866s | DropnaProcessor Done
[4142451:MainThread](2024-04-06 16:19:26,220) INFO - qlib.timer - [log.py:127] - Time cost: 0.380s | DropnaLabel Done
[4142451:MainThread](2024-04-06 16:19:32,672) INFO - qlib.timer - [log.py:127] - Time cost: 6.452s | CSZScoreNorm Done
[4142451:MainThread](2024-04-06 16:19:32,674) INFO - qlib.timer - [log.py:127] - Time cost: 364.585s | fit & process data Done
[4142451:MainThread](2024-04-06 16:19:32,675) INFO - qlib.timer - [log.py:127] - Time cost: 384.234s | Init data Done
[4142451:MainThread](2024-04-06 16:19:35,762) INFO - qlib.Rolling - [base.py:173] - {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.002, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 8192, 'GPU': 0, 'weight_decay': 0.0002, 'pt_model_kwargs': {'input_dim': 157}}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/code/qlib/exp_yaml/new_data/Alpha158.2fc0c8f6e5.pkl', 'segments': {'train': [datetime.date(2009, 1, 1), datetime.date(2018, 12, 31)], 'valid': [datetime.date(2019, 1, 1), datetime.date(2019, 12, 31)], 'test': [datetime.date(2020, 1, 1), datetime.date(2024, 3, 26)]}}}, 'record': [{'class': 'SignalRecord', 'module_path': 'qlib.workflow.record_temp', 'kwargs': {'model': '<MODEL>', 'dataset': '<DATASET>'}}, {'class': 'SigAnaRecord', 'module_path': 'qlib.workflow.record_temp', 'kwargs': {'ana_long_short': False, 'ann_scaler': 252}}, {'class': 'PortAnaRecord', 'module_path': 'qlib.workflow.record_temp', 'kwargs': {'config': {'strategy': {'class': 'TopkDropoutStrategy', 'module_path': 'qlib.contrib.strategy', 'kwargs': {'signal': '<PRED>', 'topk': 50, 'n_drop': 5}}, 'backtest': {'start_time': datetime.date(2020, 1, 1), 'end_time': datetime.date(2024, 3, 26), 'account': 100000000, 'benchmark': 'SH000300', 'exchange_kwargs': {'limit_threshold': 0.095, 'deal_price': 'close', 'open_cost': 0.0005, 'close_cost': 0.0015, 'min_cost': 5}}}}}]}
[4142451:MainThread](2024-04-06 16:19:35,789) INFO - qlib.Rolling - [base.py:190] - Deleting previous Rolling results
[4142451:MainThread](2024-04-06 16:19:35,794) INFO - qlib.Rolling - [base.py:196] - No previous rolling results
train tasks:   0%|          | 0/52 [00:00<?, ?it/s][4142451:MainThread](2024-04-06 16:19:35,800) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name rolling_models_20240406161308.
[4142451:MainThread](2024-04-06 16:19:35,809) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:19:36,189) INFO - qlib.workflow - [recorder.py:341] - Recorder 466badbc01a9426482b7d9ec8122ab1b starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:19:37,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:19:37,701) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:19:37,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:19:37,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:19:48,380) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:19:48,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.256927, valid_loss 1.694727, train_metric nan, valid_metric -0.011533
[4142451:MainThread](2024-04-06 16:19:48,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.694727, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:19:48,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.071841, valid_loss 1.341311, train_metric nan, valid_metric 0.037662
[4142451:MainThread](2024-04-06 16:19:48,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.694727 to 1.341311, save checkpoint.
[4142451:MainThread](2024-04-06 16:19:49,008) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.035593, valid_loss 1.277124, train_metric nan, valid_metric 0.034303
[4142451:MainThread](2024-04-06 16:19:49,008) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.341311 to 1.277124, save checkpoint.
[4142451:MainThread](2024-04-06 16:19:49,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.026314, valid_loss 1.141798, train_metric nan, valid_metric 0.031827
[4142451:MainThread](2024-04-06 16:19:49,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.277124 to 1.141798, save checkpoint.
[4142451:MainThread](2024-04-06 16:19:49,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.009944, valid_loss 1.006636, train_metric nan, valid_metric 0.066102
[4142451:MainThread](2024-04-06 16:19:49,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.141798 to 1.006636, save checkpoint.
[4142451:MainThread](2024-04-06 16:19:49,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.007915, valid_loss 1.076514, train_metric nan, valid_metric 0.053554
[4142451:MainThread](2024-04-06 16:19:49,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.012624, valid_loss 1.291910, train_metric nan, valid_metric 0.017519
[4142451:MainThread](2024-04-06 16:19:49,732) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.006712, valid_loss 1.132766, train_metric nan, valid_metric 0.040521
[4142451:MainThread](2024-04-06 16:19:49,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 0.991209, valid_loss 1.055332, train_metric nan, valid_metric 0.047796
[4142451:MainThread](2024-04-06 16:19:50,030) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.006108, valid_loss 1.005853, train_metric nan, valid_metric 0.054927
[4142451:MainThread](2024-04-06 16:19:50,031) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006636 to 1.005853, save checkpoint.
[4142451:MainThread](2024-04-06 16:19:50,171) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.001667, valid_loss 1.010561, train_metric nan, valid_metric 0.047168
[4142451:MainThread](2024-04-06 16:19:50,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 0.996019, valid_loss 1.000019, train_metric nan, valid_metric 0.055770
[4142451:MainThread](2024-04-06 16:19:50,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.005853 to 1.000019, save checkpoint.
[4142451:MainThread](2024-04-06 16:19:50,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.979657, valid_loss 0.995116, train_metric nan, valid_metric 0.064178
[4142451:MainThread](2024-04-06 16:19:50,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000019 to 0.995116, save checkpoint.
[4142451:MainThread](2024-04-06 16:19:50,607) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 0.995511, valid_loss 1.033442, train_metric nan, valid_metric 0.053321
[4142451:MainThread](2024-04-06 16:19:50,757) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.987162, valid_loss 1.035737, train_metric nan, valid_metric 0.056139
[4142451:MainThread](2024-04-06 16:19:50,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.991594, valid_loss 1.072024, train_metric nan, valid_metric 0.044637
[4142451:MainThread](2024-04-06 16:19:51,043) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.988275, valid_loss 1.001892, train_metric nan, valid_metric 0.050923
[4142451:MainThread](2024-04-06 16:19:51,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.983208, valid_loss 1.052315, train_metric nan, valid_metric 0.047372
[4142451:MainThread](2024-04-06 16:19:51,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.989233, valid_loss 1.000946, train_metric nan, valid_metric 0.063116
[4142451:MainThread](2024-04-06 16:19:51,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.983090, valid_loss 1.045882, train_metric nan, valid_metric 0.038781
[4142451:MainThread](2024-04-06 16:19:51,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.990243, valid_loss 1.088004, train_metric nan, valid_metric 0.035018
[4142451:MainThread](2024-04-06 16:19:51,762) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.983317, valid_loss 1.075233, train_metric nan, valid_metric 0.032319
[4142451:MainThread](2024-04-06 16:19:51,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.983524, valid_loss 1.007401, train_metric nan, valid_metric 0.053553
[4142451:MainThread](2024-04-06 16:19:52,043) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.984710, valid_loss 1.000344, train_metric nan, valid_metric 0.048367
[4142451:MainThread](2024-04-06 16:19:52,183) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.983921, valid_loss 1.013143, train_metric nan, valid_metric 0.055251
[4142451:MainThread](2024-04-06 16:19:52,349) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.979529, valid_loss 0.995893, train_metric nan, valid_metric 0.073169
[4142451:MainThread](2024-04-06 16:19:52,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.984982, valid_loss 0.997287, train_metric nan, valid_metric 0.063049
[4142451:MainThread](2024-04-06 16:19:52,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.976194, valid_loss 0.993711, train_metric nan, valid_metric 0.075042
[4142451:MainThread](2024-04-06 16:19:52,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995116 to 0.993711, save checkpoint.
[4142451:MainThread](2024-04-06 16:19:52,793) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.983489, valid_loss 1.003041, train_metric nan, valid_metric 0.069066
[4142451:MainThread](2024-04-06 16:19:52,937) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.977295, valid_loss 0.996521, train_metric nan, valid_metric 0.065926
[4142451:MainThread](2024-04-06 16:19:53,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.984995, valid_loss 1.001843, train_metric nan, valid_metric 0.052428
[4142451:MainThread](2024-04-06 16:19:53,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.982352, valid_loss 1.001820, train_metric nan, valid_metric 0.048420
[4142451:MainThread](2024-04-06 16:19:53,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.986493, valid_loss 1.019124, train_metric nan, valid_metric 0.039508
[4142451:MainThread](2024-04-06 16:19:53,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.990322, valid_loss 1.000837, train_metric nan, valid_metric 0.048553
[4142451:MainThread](2024-04-06 16:19:53,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.984867, valid_loss 1.014017, train_metric nan, valid_metric 0.045084
[4142451:MainThread](2024-04-06 16:19:53,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.975799, valid_loss 0.996125, train_metric nan, valid_metric 0.058255
[4142451:MainThread](2024-04-06 16:19:53,936) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.981851, valid_loss 0.997918, train_metric nan, valid_metric 0.066492
[4142451:MainThread](2024-04-06 16:19:54,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.980345, valid_loss 1.002670, train_metric nan, valid_metric 0.062456
[4142451:MainThread](2024-04-06 16:19:54,223) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.984798, valid_loss 1.000882, train_metric nan, valid_metric 0.055962
[4142451:MainThread](2024-04-06 16:19:54,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.982214, valid_loss 1.014435, train_metric nan, valid_metric 0.047588
[4142451:MainThread](2024-04-06 16:19:54,508) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.982375, valid_loss 1.014761, train_metric nan, valid_metric 0.036130
[4142451:MainThread](2024-04-06 16:19:54,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.979586, valid_loss 0.999927, train_metric nan, valid_metric 0.055747
[4142451:MainThread](2024-04-06 16:19:54,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.966833, valid_loss 0.999632, train_metric nan, valid_metric 0.065854
[4142451:MainThread](2024-04-06 16:19:54,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.972141, valid_loss 1.034136, train_metric nan, valid_metric 0.032798
[4142451:MainThread](2024-04-06 16:19:55,065) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.971776, valid_loss 1.044955, train_metric nan, valid_metric 0.041623
[4142451:MainThread](2024-04-06 16:19:55,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.976618, valid_loss 1.023624, train_metric nan, valid_metric 0.034481
[4142451:MainThread](2024-04-06 16:19:55,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.985413, valid_loss 1.009650, train_metric nan, valid_metric 0.057694
[4142451:MainThread](2024-04-06 16:19:55,486) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.977992, valid_loss 0.998410, train_metric nan, valid_metric 0.057307
[4142451:MainThread](2024-04-06 16:19:55,643) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.976171, valid_loss 1.067205, train_metric nan, valid_metric 0.034115
[4142451:MainThread](2024-04-06 16:19:55,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.970293, valid_loss 1.004269, train_metric nan, valid_metric 0.050511
[4142451:MainThread](2024-04-06 16:19:55,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.976010, valid_loss 1.006998, train_metric nan, valid_metric 0.042479
[4142451:MainThread](2024-04-06 16:19:56,066) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.972347, valid_loss 1.007347, train_metric nan, valid_metric 0.047164
[4142451:MainThread](2024-04-06 16:19:56,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.978075, valid_loss 0.995771, train_metric nan, valid_metric 0.064054
[4142451:MainThread](2024-04-06 16:19:56,354) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.980086, valid_loss 0.999088, train_metric nan, valid_metric 0.048804
[4142451:MainThread](2024-04-06 16:19:56,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.970833, valid_loss 0.999361, train_metric nan, valid_metric 0.067804
[4142451:MainThread](2024-04-06 16:19:56,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.968933, valid_loss 0.996922, train_metric nan, valid_metric 0.065878
[4142451:MainThread](2024-04-06 16:19:56,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.969055, valid_loss 0.997038, train_metric nan, valid_metric 0.061261
[4142451:MainThread](2024-04-06 16:19:56,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.984381, valid_loss 1.008497, train_metric nan, valid_metric 0.041659
[4142451:MainThread](2024-04-06 16:19:57,052) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.972094, valid_loss 1.005329, train_metric nan, valid_metric 0.043274
[4142451:MainThread](2024-04-06 16:19:57,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.967231, valid_loss 0.998854, train_metric nan, valid_metric 0.059256
[4142451:MainThread](2024-04-06 16:19:57,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.979873, valid_loss 1.012946, train_metric nan, valid_metric 0.040475
[4142451:MainThread](2024-04-06 16:19:57,438) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.982004, valid_loss 1.003217, train_metric nan, valid_metric 0.045091
[4142451:MainThread](2024-04-06 16:19:57,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.976664, valid_loss 0.999973, train_metric nan, valid_metric 0.061229
[4142451:MainThread](2024-04-06 16:19:57,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.981745, valid_loss 1.005355, train_metric nan, valid_metric 0.049050
[4142451:MainThread](2024-04-06 16:19:57,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.976782, valid_loss 1.018361, train_metric nan, valid_metric 0.041164
[4142451:MainThread](2024-04-06 16:19:58,028) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.982889, valid_loss 1.010134, train_metric nan, valid_metric 0.045351
[4142451:MainThread](2024-04-06 16:19:58,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.972179, valid_loss 1.009507, train_metric nan, valid_metric 0.045680
[4142451:MainThread](2024-04-06 16:19:58,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.974761, valid_loss 1.008938, train_metric nan, valid_metric 0.045337
[4142451:MainThread](2024-04-06 16:19:58,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.982123, valid_loss 1.006675, train_metric nan, valid_metric 0.047435
[4142451:MainThread](2024-04-06 16:19:58,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.984100, valid_loss 1.006139, train_metric nan, valid_metric 0.048346
[4142451:MainThread](2024-04-06 16:19:58,765) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.978387, valid_loss 1.008269, train_metric nan, valid_metric 0.047626
[4142451:MainThread](2024-04-06 16:19:58,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.981157, valid_loss 1.013152, train_metric nan, valid_metric 0.045418
[4142451:MainThread](2024-04-06 16:19:59,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.972273, valid_loss 1.008819, train_metric nan, valid_metric 0.047486
[4142451:MainThread](2024-04-06 16:19:59,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.971229, valid_loss 1.005692, train_metric nan, valid_metric 0.048910
[4142451:MainThread](2024-04-06 16:19:59,325) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.972814, valid_loss 1.011762, train_metric nan, valid_metric 0.046003
[4142451:MainThread](2024-04-06 16:19:59,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.975165, valid_loss 1.009640, train_metric nan, valid_metric 0.046117
[4142451:MainThread](2024-04-06 16:19:59,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.975742, valid_loss 1.011404, train_metric nan, valid_metric 0.043788
[4142451:MainThread](2024-04-06 16:19:59,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.975279, valid_loss 1.010341, train_metric nan, valid_metric 0.045005
[4142451:MainThread](2024-04-06 16:19:59,782) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:20:00,714) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:20:01,596) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   2%|▏         | 1/52 [00:25<21:55, 25.80s/it][4142451:MainThread](2024-04-06 16:20:01,604) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:20:01,614) INFO - qlib.workflow - [recorder.py:341] - Recorder f448a3bdd0fa4059bfb3ca10b8c9df4d starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:20:02,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:20:02,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:20:02,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:20:02,295) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:20:05,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:20:06,364) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.324208, valid_loss 2.083375, train_metric nan, valid_metric 0.001942
[4142451:MainThread](2024-04-06 16:20:06,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 2.083375, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:20:06,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.106748, valid_loss 1.361826, train_metric nan, valid_metric 0.032212
[4142451:MainThread](2024-04-06 16:20:06,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 2.083375 to 1.361826, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:06,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.067791, valid_loss 1.047779, train_metric nan, valid_metric 0.036980
[4142451:MainThread](2024-04-06 16:20:06,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.361826 to 1.047779, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:06,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.058369, valid_loss 1.134506, train_metric nan, valid_metric 0.027960
[4142451:MainThread](2024-04-06 16:20:07,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.049915, valid_loss 1.408405, train_metric nan, valid_metric 0.019676
[4142451:MainThread](2024-04-06 16:20:07,195) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.028407, valid_loss 1.091963, train_metric nan, valid_metric 0.031611
[4142451:MainThread](2024-04-06 16:20:07,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.051735, valid_loss 1.051705, train_metric nan, valid_metric 0.079927
[4142451:MainThread](2024-04-06 16:20:07,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.023793, valid_loss 1.068368, train_metric nan, valid_metric 0.047472
[4142451:MainThread](2024-04-06 16:20:07,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.017550, valid_loss 1.019690, train_metric nan, valid_metric 0.066653
[4142451:MainThread](2024-04-06 16:20:07,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.047779 to 1.019690, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:07,794) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.018640, valid_loss 1.278003, train_metric nan, valid_metric 0.034097
[4142451:MainThread](2024-04-06 16:20:07,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.023259, valid_loss 1.202386, train_metric nan, valid_metric 0.009483
[4142451:MainThread](2024-04-06 16:20:08,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.013070, valid_loss 1.093748, train_metric nan, valid_metric 0.026310
[4142451:MainThread](2024-04-06 16:20:08,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.007649, valid_loss 1.004565, train_metric nan, valid_metric 0.068818
[4142451:MainThread](2024-04-06 16:20:08,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.019690 to 1.004565, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:08,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.012489, valid_loss 0.998565, train_metric nan, valid_metric 0.057226
[4142451:MainThread](2024-04-06 16:20:08,444) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.004565 to 0.998565, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:08,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.012145, valid_loss 1.003474, train_metric nan, valid_metric 0.062267
[4142451:MainThread](2024-04-06 16:20:08,771) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.997255, valid_loss 1.002667, train_metric nan, valid_metric 0.049186
[4142451:MainThread](2024-04-06 16:20:08,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.997131, valid_loss 0.995488, train_metric nan, valid_metric 0.070377
[4142451:MainThread](2024-04-06 16:20:08,928) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998565 to 0.995488, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:09,082) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.991069, valid_loss 1.013840, train_metric nan, valid_metric 0.046642
[4142451:MainThread](2024-04-06 16:20:09,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.995863, valid_loss 1.032730, train_metric nan, valid_metric 0.048095
[4142451:MainThread](2024-04-06 16:20:09,369) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.997521, valid_loss 1.028252, train_metric nan, valid_metric 0.058274
[4142451:MainThread](2024-04-06 16:20:09,510) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.000142, valid_loss 1.001048, train_metric nan, valid_metric 0.064268
[4142451:MainThread](2024-04-06 16:20:09,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.988070, valid_loss 0.995863, train_metric nan, valid_metric 0.068745
[4142451:MainThread](2024-04-06 16:20:09,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.986833, valid_loss 0.996142, train_metric nan, valid_metric 0.070264
[4142451:MainThread](2024-04-06 16:20:09,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.987634, valid_loss 1.008335, train_metric nan, valid_metric 0.067740
[4142451:MainThread](2024-04-06 16:20:10,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.987592, valid_loss 0.999010, train_metric nan, valid_metric 0.073660
[4142451:MainThread](2024-04-06 16:20:10,255) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.979973, valid_loss 1.025851, train_metric nan, valid_metric 0.054211
[4142451:MainThread](2024-04-06 16:20:10,398) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.987551, valid_loss 0.996518, train_metric nan, valid_metric 0.065110
[4142451:MainThread](2024-04-06 16:20:10,536) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.984182, valid_loss 0.997175, train_metric nan, valid_metric 0.078809
[4142451:MainThread](2024-04-06 16:20:10,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.988225, valid_loss 0.994496, train_metric nan, valid_metric 0.075650
[4142451:MainThread](2024-04-06 16:20:10,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995488 to 0.994496, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:10,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.989035, valid_loss 0.995884, train_metric nan, valid_metric 0.064780
[4142451:MainThread](2024-04-06 16:20:11,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.975706, valid_loss 0.995253, train_metric nan, valid_metric 0.068943
[4142451:MainThread](2024-04-06 16:20:11,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.993972, valid_loss 1.001421, train_metric nan, valid_metric 0.054924
[4142451:MainThread](2024-04-06 16:20:11,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.986104, valid_loss 1.002220, train_metric nan, valid_metric 0.053172
[4142451:MainThread](2024-04-06 16:20:11,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.988353, valid_loss 0.993880, train_metric nan, valid_metric 0.067408
[4142451:MainThread](2024-04-06 16:20:11,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994496 to 0.993880, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:11,578) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.982054, valid_loss 1.006177, train_metric nan, valid_metric 0.053517
[4142451:MainThread](2024-04-06 16:20:11,716) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.993979, valid_loss 0.995154, train_metric nan, valid_metric 0.071346
[4142451:MainThread](2024-04-06 16:20:11,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.991392, valid_loss 0.999946, train_metric nan, valid_metric 0.059545
[4142451:MainThread](2024-04-06 16:20:12,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.991162, valid_loss 0.997386, train_metric nan, valid_metric 0.057156
[4142451:MainThread](2024-04-06 16:20:12,142) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.985725, valid_loss 0.994182, train_metric nan, valid_metric 0.072553
[4142451:MainThread](2024-04-06 16:20:12,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.989182, valid_loss 1.001418, train_metric nan, valid_metric 0.053388
[4142451:MainThread](2024-04-06 16:20:12,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.976544, valid_loss 0.997253, train_metric nan, valid_metric 0.062348
[4142451:MainThread](2024-04-06 16:20:12,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.979753, valid_loss 0.996219, train_metric nan, valid_metric 0.061580
[4142451:MainThread](2024-04-06 16:20:12,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.983308, valid_loss 0.992645, train_metric nan, valid_metric 0.071518
[4142451:MainThread](2024-04-06 16:20:12,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993880 to 0.992645, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:12,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.985276, valid_loss 1.004010, train_metric nan, valid_metric 0.071631
[4142451:MainThread](2024-04-06 16:20:12,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.982395, valid_loss 1.000725, train_metric nan, valid_metric 0.058698
[4142451:MainThread](2024-04-06 16:20:13,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.979278, valid_loss 0.997172, train_metric nan, valid_metric 0.064103
[4142451:MainThread](2024-04-06 16:20:13,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.976836, valid_loss 1.004144, train_metric nan, valid_metric 0.054692
[4142451:MainThread](2024-04-06 16:20:13,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.981599, valid_loss 1.000067, train_metric nan, valid_metric 0.058479
[4142451:MainThread](2024-04-06 16:20:13,538) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.979709, valid_loss 1.027791, train_metric nan, valid_metric 0.049316
[4142451:MainThread](2024-04-06 16:20:13,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.984752, valid_loss 0.998299, train_metric nan, valid_metric 0.061069
[4142451:MainThread](2024-04-06 16:20:13,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.973735, valid_loss 1.009326, train_metric nan, valid_metric 0.056149
[4142451:MainThread](2024-04-06 16:20:13,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.982227, valid_loss 1.014909, train_metric nan, valid_metric 0.034990
[4142451:MainThread](2024-04-06 16:20:14,098) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.991377, valid_loss 1.007007, train_metric nan, valid_metric 0.044592
[4142451:MainThread](2024-04-06 16:20:14,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.987034, valid_loss 1.001391, train_metric nan, valid_metric 0.049513
[4142451:MainThread](2024-04-06 16:20:14,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.978597, valid_loss 1.001431, train_metric nan, valid_metric 0.060003
[4142451:MainThread](2024-04-06 16:20:14,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.982731, valid_loss 1.017273, train_metric nan, valid_metric 0.044823
[4142451:MainThread](2024-04-06 16:20:14,676) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.978299, valid_loss 1.004560, train_metric nan, valid_metric 0.054363
[4142451:MainThread](2024-04-06 16:20:14,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.982983, valid_loss 1.026694, train_metric nan, valid_metric 0.047277
[4142451:MainThread](2024-04-06 16:20:14,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.973671, valid_loss 0.999770, train_metric nan, valid_metric 0.054329
[4142451:MainThread](2024-04-06 16:20:15,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.983174, valid_loss 1.012127, train_metric nan, valid_metric 0.050215
[4142451:MainThread](2024-04-06 16:20:15,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.967788, valid_loss 1.001710, train_metric nan, valid_metric 0.052037
[4142451:MainThread](2024-04-06 16:20:15,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.992018, valid_loss 1.017034, train_metric nan, valid_metric 0.043869
[4142451:MainThread](2024-04-06 16:20:15,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.986779, valid_loss 1.008800, train_metric nan, valid_metric 0.046989
[4142451:MainThread](2024-04-06 16:20:15,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.977369, valid_loss 1.016571, train_metric nan, valid_metric 0.050405
[4142451:MainThread](2024-04-06 16:20:15,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.978445, valid_loss 1.029335, train_metric nan, valid_metric 0.042123
[4142451:MainThread](2024-04-06 16:20:16,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.985061, valid_loss 1.028776, train_metric nan, valid_metric 0.043401
[4142451:MainThread](2024-04-06 16:20:16,148) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.980570, valid_loss 1.001991, train_metric nan, valid_metric 0.056422
[4142451:MainThread](2024-04-06 16:20:16,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.985850, valid_loss 1.012542, train_metric nan, valid_metric 0.046826
[4142451:MainThread](2024-04-06 16:20:16,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.981032, valid_loss 1.009183, train_metric nan, valid_metric 0.047583
[4142451:MainThread](2024-04-06 16:20:16,573) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.979531, valid_loss 1.013973, train_metric nan, valid_metric 0.050182
[4142451:MainThread](2024-04-06 16:20:16,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.983913, valid_loss 1.015150, train_metric nan, valid_metric 0.049530
[4142451:MainThread](2024-04-06 16:20:16,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.997964, valid_loss 1.026525, train_metric nan, valid_metric 0.046832
[4142451:MainThread](2024-04-06 16:20:16,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.981855, valid_loss 1.007897, train_metric nan, valid_metric 0.050471
[4142451:MainThread](2024-04-06 16:20:17,129) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.981687, valid_loss 1.014641, train_metric nan, valid_metric 0.051841
[4142451:MainThread](2024-04-06 16:20:17,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.974635, valid_loss 1.028161, train_metric nan, valid_metric 0.046211
[4142451:MainThread](2024-04-06 16:20:17,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.980167, valid_loss 1.011059, train_metric nan, valid_metric 0.052386
[4142451:MainThread](2024-04-06 16:20:17,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.982533, valid_loss 1.007600, train_metric nan, valid_metric 0.050374
[4142451:MainThread](2024-04-06 16:20:17,696) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.978123, valid_loss 1.013067, train_metric nan, valid_metric 0.047793
[4142451:MainThread](2024-04-06 16:20:17,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.986957, valid_loss 1.016049, train_metric nan, valid_metric 0.046489
[4142451:MainThread](2024-04-06 16:20:17,957) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.978344, valid_loss 1.014069, train_metric nan, valid_metric 0.048503
[4142451:MainThread](2024-04-06 16:20:18,086) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.985144, valid_loss 1.024683, train_metric nan, valid_metric 0.050836
[4142451:MainThread](2024-04-06 16:20:18,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.974017, valid_loss 1.008817, train_metric nan, valid_metric 0.052244
[4142451:MainThread](2024-04-06 16:20:18,359) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.977529, valid_loss 1.016294, train_metric nan, valid_metric 0.043787
[4142451:MainThread](2024-04-06 16:20:18,533) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.977508, valid_loss 1.013893, train_metric nan, valid_metric 0.044195
[4142451:MainThread](2024-04-06 16:20:18,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.975416, valid_loss 1.015889, train_metric nan, valid_metric 0.048034
[4142451:MainThread](2024-04-06 16:20:18,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.983869, valid_loss 1.022032, train_metric nan, valid_metric 0.045281
[4142451:MainThread](2024-04-06 16:20:19,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.978612, valid_loss 1.018635, train_metric nan, valid_metric 0.045796
[4142451:MainThread](2024-04-06 16:20:19,188) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.986056, valid_loss 1.022462, train_metric nan, valid_metric 0.045030
[4142451:MainThread](2024-04-06 16:20:19,350) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.972638, valid_loss 1.021506, train_metric nan, valid_metric 0.045234
[4142451:MainThread](2024-04-06 16:20:19,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.982222, valid_loss 1.016866, train_metric nan, valid_metric 0.047600
[4142451:MainThread](2024-04-06 16:20:19,684) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.962737, valid_loss 1.022007, train_metric nan, valid_metric 0.047500
[4142451:MainThread](2024-04-06 16:20:19,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.978671, valid_loss 1.020642, train_metric nan, valid_metric 0.048491
[4142451:MainThread](2024-04-06 16:20:19,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.975655, valid_loss 1.011195, train_metric nan, valid_metric 0.049273
[4142451:MainThread](2024-04-06 16:20:19,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:20:20,935) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:20:21,809) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   4%|▍         | 2/52 [00:46<18:45, 22.51s/it][4142451:MainThread](2024-04-06 16:20:21,817) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:20:21,826) INFO - qlib.workflow - [recorder.py:341] - Recorder f421c428e38d410e9b111d425171db39 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:20:22,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:20:22,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:20:22,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:20:22,496) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:20:25,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:20:26,261) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.262866, valid_loss 1.535154, train_metric nan, valid_metric 0.009462
[4142451:MainThread](2024-04-06 16:20:26,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.535154, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:20:26,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.093075, valid_loss 1.134160, train_metric nan, valid_metric 0.023559
[4142451:MainThread](2024-04-06 16:20:26,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.535154 to 1.134160, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:26,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.051132, valid_loss 1.060571, train_metric nan, valid_metric 0.034475
[4142451:MainThread](2024-04-06 16:20:26,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.134160 to 1.060571, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:26,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.028036, valid_loss 1.127869, train_metric nan, valid_metric 0.038688
[4142451:MainThread](2024-04-06 16:20:26,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.035567, valid_loss 1.018905, train_metric nan, valid_metric 0.057681
[4142451:MainThread](2024-04-06 16:20:26,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.060571 to 1.018905, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:26,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.016675, valid_loss 1.125050, train_metric nan, valid_metric 0.042876
[4142451:MainThread](2024-04-06 16:20:27,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.010574, valid_loss 1.032479, train_metric nan, valid_metric 0.052052
[4142451:MainThread](2024-04-06 16:20:27,235) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.003733, valid_loss 1.048617, train_metric nan, valid_metric 0.052688
[4142451:MainThread](2024-04-06 16:20:27,369) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.011071, valid_loss 1.076515, train_metric nan, valid_metric 0.040610
[4142451:MainThread](2024-04-06 16:20:27,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.003139, valid_loss 1.027312, train_metric nan, valid_metric 0.048761
[4142451:MainThread](2024-04-06 16:20:27,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 0.998286, valid_loss 1.001236, train_metric nan, valid_metric 0.061306
[4142451:MainThread](2024-04-06 16:20:27,672) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.018905 to 1.001236, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:27,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 0.991142, valid_loss 1.006798, train_metric nan, valid_metric 0.057228
[4142451:MainThread](2024-04-06 16:20:28,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.994492, valid_loss 1.000207, train_metric nan, valid_metric 0.070340
[4142451:MainThread](2024-04-06 16:20:28,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001236 to 1.000207, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:28,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 0.986253, valid_loss 1.005649, train_metric nan, valid_metric 0.069631
[4142451:MainThread](2024-04-06 16:20:28,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.995128, valid_loss 1.034673, train_metric nan, valid_metric 0.058841
[4142451:MainThread](2024-04-06 16:20:28,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.992281, valid_loss 0.995700, train_metric nan, valid_metric 0.069952
[4142451:MainThread](2024-04-06 16:20:28,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000207 to 0.995700, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:28,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.983581, valid_loss 0.996218, train_metric nan, valid_metric 0.075525
[4142451:MainThread](2024-04-06 16:20:28,673) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.984894, valid_loss 1.021142, train_metric nan, valid_metric 0.055819
[4142451:MainThread](2024-04-06 16:20:28,812) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.984792, valid_loss 1.000383, train_metric nan, valid_metric 0.053694
[4142451:MainThread](2024-04-06 16:20:28,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.986882, valid_loss 1.060918, train_metric nan, valid_metric 0.020001
[4142451:MainThread](2024-04-06 16:20:29,104) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.983881, valid_loss 1.031440, train_metric nan, valid_metric 0.053086
[4142451:MainThread](2024-04-06 16:20:29,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.992318, valid_loss 1.009591, train_metric nan, valid_metric 0.058517
[4142451:MainThread](2024-04-06 16:20:29,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.991511, valid_loss 1.025644, train_metric nan, valid_metric 0.046272
[4142451:MainThread](2024-04-06 16:20:29,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.997903, valid_loss 1.002056, train_metric nan, valid_metric 0.058973
[4142451:MainThread](2024-04-06 16:20:29,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.991866, valid_loss 1.007402, train_metric nan, valid_metric 0.046366
[4142451:MainThread](2024-04-06 16:20:29,830) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.986129, valid_loss 0.997516, train_metric nan, valid_metric 0.060362
[4142451:MainThread](2024-04-06 16:20:29,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.983469, valid_loss 0.997375, train_metric nan, valid_metric 0.064970
[4142451:MainThread](2024-04-06 16:20:30,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.986727, valid_loss 0.998346, train_metric nan, valid_metric 0.069631
[4142451:MainThread](2024-04-06 16:20:30,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.978403, valid_loss 1.002823, train_metric nan, valid_metric 0.052696
[4142451:MainThread](2024-04-06 16:20:30,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.988564, valid_loss 1.005142, train_metric nan, valid_metric 0.060114
[4142451:MainThread](2024-04-06 16:20:30,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.981422, valid_loss 0.999518, train_metric nan, valid_metric 0.052849
[4142451:MainThread](2024-04-06 16:20:30,762) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.978986, valid_loss 1.006602, train_metric nan, valid_metric 0.060508
[4142451:MainThread](2024-04-06 16:20:30,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.990473, valid_loss 1.015858, train_metric nan, valid_metric 0.037729
[4142451:MainThread](2024-04-06 16:20:31,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.996140, valid_loss 0.997165, train_metric nan, valid_metric 0.059143
[4142451:MainThread](2024-04-06 16:20:31,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.973708, valid_loss 0.998758, train_metric nan, valid_metric 0.044579
[4142451:MainThread](2024-04-06 16:20:31,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.982727, valid_loss 1.005510, train_metric nan, valid_metric 0.070469
[4142451:MainThread](2024-04-06 16:20:31,524) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.990708, valid_loss 0.996837, train_metric nan, valid_metric 0.058284
[4142451:MainThread](2024-04-06 16:20:31,663) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.989180, valid_loss 0.998565, train_metric nan, valid_metric 0.051696
[4142451:MainThread](2024-04-06 16:20:31,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.970812, valid_loss 0.999436, train_metric nan, valid_metric 0.049317
[4142451:MainThread](2024-04-06 16:20:31,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.986396, valid_loss 1.003348, train_metric nan, valid_metric 0.041471
[4142451:MainThread](2024-04-06 16:20:32,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.984526, valid_loss 1.002378, train_metric nan, valid_metric 0.042647
[4142451:MainThread](2024-04-06 16:20:32,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.971629, valid_loss 0.998226, train_metric nan, valid_metric 0.059749
[4142451:MainThread](2024-04-06 16:20:32,416) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.977383, valid_loss 1.001558, train_metric nan, valid_metric 0.049062
[4142451:MainThread](2024-04-06 16:20:32,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.975241, valid_loss 1.004545, train_metric nan, valid_metric 0.047968
[4142451:MainThread](2024-04-06 16:20:32,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.988535, valid_loss 1.006625, train_metric nan, valid_metric 0.046309
[4142451:MainThread](2024-04-06 16:20:32,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.974253, valid_loss 1.001907, train_metric nan, valid_metric 0.052485
[4142451:MainThread](2024-04-06 16:20:32,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.981462, valid_loss 0.998069, train_metric nan, valid_metric 0.049049
[4142451:MainThread](2024-04-06 16:20:33,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.978622, valid_loss 1.028581, train_metric nan, valid_metric 0.040234
[4142451:MainThread](2024-04-06 16:20:33,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.975950, valid_loss 1.000077, train_metric nan, valid_metric 0.045748
[4142451:MainThread](2024-04-06 16:20:33,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.967774, valid_loss 0.995766, train_metric nan, valid_metric 0.054249
[4142451:MainThread](2024-04-06 16:20:33,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.982326, valid_loss 0.998456, train_metric nan, valid_metric 0.047551
[4142451:MainThread](2024-04-06 16:20:33,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.976593, valid_loss 0.999993, train_metric nan, valid_metric 0.046695
[4142451:MainThread](2024-04-06 16:20:33,813) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.974927, valid_loss 1.004758, train_metric nan, valid_metric 0.042935
[4142451:MainThread](2024-04-06 16:20:33,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.976366, valid_loss 1.003140, train_metric nan, valid_metric 0.045082
[4142451:MainThread](2024-04-06 16:20:34,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.973571, valid_loss 1.007464, train_metric nan, valid_metric 0.042689
[4142451:MainThread](2024-04-06 16:20:34,242) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.976395, valid_loss 0.999149, train_metric nan, valid_metric 0.054367
[4142451:MainThread](2024-04-06 16:20:34,385) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.989956, valid_loss 1.005517, train_metric nan, valid_metric 0.040716
[4142451:MainThread](2024-04-06 16:20:34,527) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.976393, valid_loss 1.006607, train_metric nan, valid_metric 0.047018
[4142451:MainThread](2024-04-06 16:20:34,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.971705, valid_loss 1.025215, train_metric nan, valid_metric 0.034664
[4142451:MainThread](2024-04-06 16:20:34,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.979366, valid_loss 1.002021, train_metric nan, valid_metric 0.043771
[4142451:MainThread](2024-04-06 16:20:34,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.981167, valid_loss 1.006075, train_metric nan, valid_metric 0.040766
[4142451:MainThread](2024-04-06 16:20:35,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.982848, valid_loss 1.001732, train_metric nan, valid_metric 0.043987
[4142451:MainThread](2024-04-06 16:20:35,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.973677, valid_loss 0.999313, train_metric nan, valid_metric 0.049507
[4142451:MainThread](2024-04-06 16:20:35,403) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.972764, valid_loss 1.000378, train_metric nan, valid_metric 0.048143
[4142451:MainThread](2024-04-06 16:20:35,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.973413, valid_loss 0.997257, train_metric nan, valid_metric 0.051873
[4142451:MainThread](2024-04-06 16:20:35,696) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.976055, valid_loss 0.998565, train_metric nan, valid_metric 0.048129
[4142451:MainThread](2024-04-06 16:20:35,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:20:36,827) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:20:37,689) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   6%|▌         | 3/52 [01:01<15:54, 19.49s/it][4142451:MainThread](2024-04-06 16:20:37,697) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:20:37,707) INFO - qlib.workflow - [recorder.py:341] - Recorder 66fb0d4ba51a48e1a3507bb23f919aaa starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:20:38,333) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:20:38,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:20:38,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:20:38,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:20:41,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:20:41,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.215350, valid_loss 1.414930, train_metric nan, valid_metric 0.016324
[4142451:MainThread](2024-04-06 16:20:41,995) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.414930, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:20:42,143) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.076200, valid_loss 1.018168, train_metric nan, valid_metric 0.051093
[4142451:MainThread](2024-04-06 16:20:42,143) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.414930 to 1.018168, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:42,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.051462, valid_loss 1.182515, train_metric nan, valid_metric 0.018876
[4142451:MainThread](2024-04-06 16:20:42,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.031770, valid_loss 1.065322, train_metric nan, valid_metric 0.026367
[4142451:MainThread](2024-04-06 16:20:42,578) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.017178, valid_loss 1.281916, train_metric nan, valid_metric 0.074869
[4142451:MainThread](2024-04-06 16:20:42,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.032628, valid_loss 1.984554, train_metric nan, valid_metric 0.053489
[4142451:MainThread](2024-04-06 16:20:42,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.010494, valid_loss 1.260452, train_metric nan, valid_metric 0.048018
[4142451:MainThread](2024-04-06 16:20:43,030) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.008958, valid_loss 1.254011, train_metric nan, valid_metric 0.067521
[4142451:MainThread](2024-04-06 16:20:43,203) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.000013, valid_loss 1.005598, train_metric nan, valid_metric 0.047446
[4142451:MainThread](2024-04-06 16:20:43,203) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.018168 to 1.005598, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:43,376) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.013061, valid_loss 1.184333, train_metric nan, valid_metric 0.061716
[4142451:MainThread](2024-04-06 16:20:43,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 0.994386, valid_loss 1.250197, train_metric nan, valid_metric 0.065564
[4142451:MainThread](2024-04-06 16:20:43,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.006152, valid_loss 1.159232, train_metric nan, valid_metric 0.063448
[4142451:MainThread](2024-04-06 16:20:43,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.986613, valid_loss 1.182908, train_metric nan, valid_metric 0.060461
[4142451:MainThread](2024-04-06 16:20:44,015) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 0.999679, valid_loss 1.083361, train_metric nan, valid_metric 0.068419
[4142451:MainThread](2024-04-06 16:20:44,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.984787, valid_loss 1.048535, train_metric nan, valid_metric 0.072235
[4142451:MainThread](2024-04-06 16:20:44,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.983993, valid_loss 1.145460, train_metric nan, valid_metric 0.062313
[4142451:MainThread](2024-04-06 16:20:44,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.983934, valid_loss 1.068346, train_metric nan, valid_metric 0.069284
[4142451:MainThread](2024-04-06 16:20:44,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.991512, valid_loss 1.020271, train_metric nan, valid_metric 0.036339
[4142451:MainThread](2024-04-06 16:20:44,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.973102, valid_loss 1.005517, train_metric nan, valid_metric 0.061460
[4142451:MainThread](2024-04-06 16:20:44,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.005598 to 1.005517, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:44,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.993991, valid_loss 1.004139, train_metric nan, valid_metric 0.063371
[4142451:MainThread](2024-04-06 16:20:44,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.005517 to 1.004139, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:45,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.978284, valid_loss 1.036275, train_metric nan, valid_metric 0.032519
[4142451:MainThread](2024-04-06 16:20:45,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.991826, valid_loss 1.023916, train_metric nan, valid_metric 0.065881
[4142451:MainThread](2024-04-06 16:20:45,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.981844, valid_loss 1.050251, train_metric nan, valid_metric 0.071757
[4142451:MainThread](2024-04-06 16:20:45,551) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.980630, valid_loss 1.064618, train_metric nan, valid_metric 0.068501
[4142451:MainThread](2024-04-06 16:20:45,696) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.984443, valid_loss 1.006828, train_metric nan, valid_metric 0.053314
[4142451:MainThread](2024-04-06 16:20:45,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.983218, valid_loss 1.048555, train_metric nan, valid_metric 0.066076
[4142451:MainThread](2024-04-06 16:20:45,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.986316, valid_loss 1.058909, train_metric nan, valid_metric 0.069827
[4142451:MainThread](2024-04-06 16:20:46,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.974465, valid_loss 1.103218, train_metric nan, valid_metric 0.057491
[4142451:MainThread](2024-04-06 16:20:46,263) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.982999, valid_loss 1.045452, train_metric nan, valid_metric 0.055671
[4142451:MainThread](2024-04-06 16:20:46,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.986193, valid_loss 1.033577, train_metric nan, valid_metric 0.066047
[4142451:MainThread](2024-04-06 16:20:46,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.990678, valid_loss 1.005047, train_metric nan, valid_metric 0.042852
[4142451:MainThread](2024-04-06 16:20:46,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.985306, valid_loss 1.005613, train_metric nan, valid_metric 0.061087
[4142451:MainThread](2024-04-06 16:20:46,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.982086, valid_loss 1.108326, train_metric nan, valid_metric 0.062351
[4142451:MainThread](2024-04-06 16:20:46,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.989733, valid_loss 1.055739, train_metric nan, valid_metric 0.059606
[4142451:MainThread](2024-04-06 16:20:47,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.985985, valid_loss 1.032535, train_metric nan, valid_metric 0.065079
[4142451:MainThread](2024-04-06 16:20:47,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.977163, valid_loss 1.051101, train_metric nan, valid_metric 0.063109
[4142451:MainThread](2024-04-06 16:20:47,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.983799, valid_loss 1.064631, train_metric nan, valid_metric 0.067561
[4142451:MainThread](2024-04-06 16:20:47,541) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.979706, valid_loss 1.030529, train_metric nan, valid_metric 0.066997
[4142451:MainThread](2024-04-06 16:20:47,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.989776, valid_loss 0.999702, train_metric nan, valid_metric 0.054142
[4142451:MainThread](2024-04-06 16:20:47,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.004139 to 0.999702, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:47,830) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.984448, valid_loss 1.024734, train_metric nan, valid_metric 0.054832
[4142451:MainThread](2024-04-06 16:20:47,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.980020, valid_loss 1.040520, train_metric nan, valid_metric 0.060597
[4142451:MainThread](2024-04-06 16:20:48,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.988049, valid_loss 1.016115, train_metric nan, valid_metric 0.063056
[4142451:MainThread](2024-04-06 16:20:48,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.978959, valid_loss 1.035329, train_metric nan, valid_metric 0.061131
[4142451:MainThread](2024-04-06 16:20:48,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.980525, valid_loss 1.004149, train_metric nan, valid_metric 0.060395
[4142451:MainThread](2024-04-06 16:20:48,552) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.990036, valid_loss 1.071522, train_metric nan, valid_metric 0.058688
[4142451:MainThread](2024-04-06 16:20:48,696) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.980232, valid_loss 1.010844, train_metric nan, valid_metric 0.061293
[4142451:MainThread](2024-04-06 16:20:48,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.974254, valid_loss 0.998246, train_metric nan, valid_metric 0.052000
[4142451:MainThread](2024-04-06 16:20:48,835) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999702 to 0.998246, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:48,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.979393, valid_loss 1.020244, train_metric nan, valid_metric 0.056198
[4142451:MainThread](2024-04-06 16:20:49,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.971741, valid_loss 1.009872, train_metric nan, valid_metric 0.049953
[4142451:MainThread](2024-04-06 16:20:49,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.975776, valid_loss 0.999333, train_metric nan, valid_metric 0.044948
[4142451:MainThread](2024-04-06 16:20:49,413) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.981204, valid_loss 1.002771, train_metric nan, valid_metric 0.042901
[4142451:MainThread](2024-04-06 16:20:49,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.976178, valid_loss 1.019387, train_metric nan, valid_metric 0.049292
[4142451:MainThread](2024-04-06 16:20:49,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.988476, valid_loss 1.010684, train_metric nan, valid_metric 0.059451
[4142451:MainThread](2024-04-06 16:20:49,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.986932, valid_loss 1.095347, train_metric nan, valid_metric 0.064613
[4142451:MainThread](2024-04-06 16:20:49,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.978790, valid_loss 1.066260, train_metric nan, valid_metric 0.058589
[4142451:MainThread](2024-04-06 16:20:50,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.981100, valid_loss 1.002079, train_metric nan, valid_metric 0.045719
[4142451:MainThread](2024-04-06 16:20:50,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.970419, valid_loss 1.018633, train_metric nan, valid_metric 0.053533
[4142451:MainThread](2024-04-06 16:20:50,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.975500, valid_loss 1.007832, train_metric nan, valid_metric 0.029450
[4142451:MainThread](2024-04-06 16:20:50,568) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.976799, valid_loss 1.007601, train_metric nan, valid_metric 0.051880
[4142451:MainThread](2024-04-06 16:20:50,707) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.978104, valid_loss 1.015087, train_metric nan, valid_metric 0.059589
[4142451:MainThread](2024-04-06 16:20:50,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.973231, valid_loss 1.004808, train_metric nan, valid_metric 0.050484
[4142451:MainThread](2024-04-06 16:20:50,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.969874, valid_loss 0.999656, train_metric nan, valid_metric 0.049447
[4142451:MainThread](2024-04-06 16:20:51,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.972452, valid_loss 1.025004, train_metric nan, valid_metric 0.055399
[4142451:MainThread](2024-04-06 16:20:51,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.985382, valid_loss 1.030541, train_metric nan, valid_metric 0.057375
[4142451:MainThread](2024-04-06 16:20:51,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.979648, valid_loss 0.999361, train_metric nan, valid_metric 0.049497
[4142451:MainThread](2024-04-06 16:20:51,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.988071, valid_loss 1.003672, train_metric nan, valid_metric 0.048900
[4142451:MainThread](2024-04-06 16:20:51,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.968826, valid_loss 1.002301, train_metric nan, valid_metric 0.051980
[4142451:MainThread](2024-04-06 16:20:51,912) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.982566, valid_loss 1.002003, train_metric nan, valid_metric 0.034797
[4142451:MainThread](2024-04-06 16:20:52,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.986199, valid_loss 1.018472, train_metric nan, valid_metric 0.062156
[4142451:MainThread](2024-04-06 16:20:52,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.976752, valid_loss 1.012164, train_metric nan, valid_metric 0.057033
[4142451:MainThread](2024-04-06 16:20:52,344) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.978347, valid_loss 1.000744, train_metric nan, valid_metric 0.051417
[4142451:MainThread](2024-04-06 16:20:52,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.976087, valid_loss 0.999712, train_metric nan, valid_metric 0.042405
[4142451:MainThread](2024-04-06 16:20:52,628) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.970148, valid_loss 1.001266, train_metric nan, valid_metric 0.054416
[4142451:MainThread](2024-04-06 16:20:52,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.982955, valid_loss 0.999390, train_metric nan, valid_metric 0.044782
[4142451:MainThread](2024-04-06 16:20:52,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.978664, valid_loss 1.001161, train_metric nan, valid_metric 0.038926
[4142451:MainThread](2024-04-06 16:20:53,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.979084, valid_loss 1.004226, train_metric nan, valid_metric 0.049695
[4142451:MainThread](2024-04-06 16:20:53,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.977166, valid_loss 1.003213, train_metric nan, valid_metric 0.040548
[4142451:MainThread](2024-04-06 16:20:53,350) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.978845, valid_loss 1.019647, train_metric nan, valid_metric 0.055651
[4142451:MainThread](2024-04-06 16:20:53,515) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.979746, valid_loss 1.005390, train_metric nan, valid_metric 0.050376
[4142451:MainThread](2024-04-06 16:20:53,659) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.977347, valid_loss 1.000954, train_metric nan, valid_metric 0.039836
[4142451:MainThread](2024-04-06 16:20:53,810) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.972296, valid_loss 0.998005, train_metric nan, valid_metric 0.048454
[4142451:MainThread](2024-04-06 16:20:53,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998246 to 0.998005, save checkpoint.
[4142451:MainThread](2024-04-06 16:20:53,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.986685, valid_loss 0.999079, train_metric nan, valid_metric 0.049592
[4142451:MainThread](2024-04-06 16:20:54,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.982743, valid_loss 0.999596, train_metric nan, valid_metric 0.045710
[4142451:MainThread](2024-04-06 16:20:54,251) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.979440, valid_loss 1.001153, train_metric nan, valid_metric 0.053600
[4142451:MainThread](2024-04-06 16:20:54,394) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.980280, valid_loss 1.002188, train_metric nan, valid_metric 0.049135
[4142451:MainThread](2024-04-06 16:20:54,541) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.976262, valid_loss 1.001058, train_metric nan, valid_metric 0.053450
[4142451:MainThread](2024-04-06 16:20:54,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.968062, valid_loss 0.999533, train_metric nan, valid_metric 0.050171
[4142451:MainThread](2024-04-06 16:20:54,817) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.972572, valid_loss 0.999311, train_metric nan, valid_metric 0.048303
[4142451:MainThread](2024-04-06 16:20:54,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.970424, valid_loss 1.001341, train_metric nan, valid_metric 0.050834
[4142451:MainThread](2024-04-06 16:20:55,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.975551, valid_loss 1.001967, train_metric nan, valid_metric 0.048670
[4142451:MainThread](2024-04-06 16:20:55,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.976435, valid_loss 1.001107, train_metric nan, valid_metric 0.046873
[4142451:MainThread](2024-04-06 16:20:55,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.984417, valid_loss 0.999326, train_metric nan, valid_metric 0.046552
[4142451:MainThread](2024-04-06 16:20:55,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.983951, valid_loss 1.002696, train_metric nan, valid_metric 0.050581
[4142451:MainThread](2024-04-06 16:20:55,661) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.969036, valid_loss 1.000500, train_metric nan, valid_metric 0.048790
[4142451:MainThread](2024-04-06 16:20:55,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.978933, valid_loss 1.002200, train_metric nan, valid_metric 0.049027
[4142451:MainThread](2024-04-06 16:20:55,942) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.971018, valid_loss 1.003551, train_metric nan, valid_metric 0.048902
[4142451:MainThread](2024-04-06 16:20:56,084) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.975997, valid_loss 1.001361, train_metric nan, valid_metric 0.047365
[4142451:MainThread](2024-04-06 16:20:56,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.972498, valid_loss 1.001579, train_metric nan, valid_metric 0.036811
[4142451:MainThread](2024-04-06 16:20:56,371) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.988211, valid_loss 1.000956, train_metric nan, valid_metric 0.040158
[4142451:MainThread](2024-04-06 16:20:56,516) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.977197, valid_loss 0.999590, train_metric nan, valid_metric 0.047927
[4142451:MainThread](2024-04-06 16:20:56,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.977914, valid_loss 1.001916, train_metric nan, valid_metric 0.049292
[4142451:MainThread](2024-04-06 16:20:56,817) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.972962, valid_loss 1.000295, train_metric nan, valid_metric 0.047705
[4142451:MainThread](2024-04-06 16:20:56,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.970499, valid_loss 1.000569, train_metric nan, valid_metric 0.048769
[4142451:MainThread](2024-04-06 16:20:57,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.971071, valid_loss 1.000944, train_metric nan, valid_metric 0.049412
[4142451:MainThread](2024-04-06 16:20:57,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.973656, valid_loss 1.001463, train_metric nan, valid_metric 0.048664
[4142451:MainThread](2024-04-06 16:20:57,396) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 0.982138, valid_loss 1.001029, train_metric nan, valid_metric 0.047268
[4142451:MainThread](2024-04-06 16:20:57,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.969400, valid_loss 0.999184, train_metric nan, valid_metric 0.044274
[4142451:MainThread](2024-04-06 16:20:57,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 0.987670, valid_loss 1.002661, train_metric nan, valid_metric 0.048798
[4142451:MainThread](2024-04-06 16:20:57,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 0.972412, valid_loss 1.003118, train_metric nan, valid_metric 0.049667
[4142451:MainThread](2024-04-06 16:20:57,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 0.974819, valid_loss 1.002110, train_metric nan, valid_metric 0.049126
[4142451:MainThread](2024-04-06 16:20:58,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 0.979174, valid_loss 0.999975, train_metric nan, valid_metric 0.042866
[4142451:MainThread](2024-04-06 16:20:58,278) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 0.975536, valid_loss 0.999910, train_metric nan, valid_metric 0.044573
[4142451:MainThread](2024-04-06 16:20:58,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 0.968292, valid_loss 1.000447, train_metric nan, valid_metric 0.048421
[4142451:MainThread](2024-04-06 16:20:58,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 0.972767, valid_loss 1.002394, train_metric nan, valid_metric 0.034658
[4142451:MainThread](2024-04-06 16:20:58,707) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 0.977289, valid_loss 1.000745, train_metric nan, valid_metric 0.037380
[4142451:MainThread](2024-04-06 16:20:58,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 0.971408, valid_loss 0.999937, train_metric nan, valid_metric 0.046803
[4142451:MainThread](2024-04-06 16:20:58,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 0.976118, valid_loss 1.000088, train_metric nan, valid_metric 0.048079
[4142451:MainThread](2024-04-06 16:20:59,132) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 0.973747, valid_loss 0.999993, train_metric nan, valid_metric 0.048378
[4142451:MainThread](2024-04-06 16:20:59,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 0.979340, valid_loss 1.000298, train_metric nan, valid_metric 0.048878
[4142451:MainThread](2024-04-06 16:20:59,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 0.982259, valid_loss 1.000602, train_metric nan, valid_metric 0.049198
[4142451:MainThread](2024-04-06 16:20:59,555) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 0.972174, valid_loss 1.001228, train_metric nan, valid_metric 0.050200
[4142451:MainThread](2024-04-06 16:20:59,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 0.983693, valid_loss 1.000397, train_metric nan, valid_metric 0.049338
[4142451:MainThread](2024-04-06 16:20:59,842) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 0.976036, valid_loss 0.999827, train_metric nan, valid_metric 0.048325
[4142451:MainThread](2024-04-06 16:20:59,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 0.978286, valid_loss 0.999684, train_metric nan, valid_metric 0.047976
[4142451:MainThread](2024-04-06 16:21:00,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 0.972327, valid_loss 1.000240, train_metric nan, valid_metric 0.049482
[4142451:MainThread](2024-04-06 16:21:00,261) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 0.982163, valid_loss 0.999683, train_metric nan, valid_metric 0.048350
[4142451:MainThread](2024-04-06 16:21:00,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 0.976688, valid_loss 1.000219, train_metric nan, valid_metric 0.049520
[4142451:MainThread](2024-04-06 16:21:00,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 0.967949, valid_loss 0.999789, train_metric nan, valid_metric 0.048566
[4142451:MainThread](2024-04-06 16:21:00,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 0.982376, valid_loss 0.999491, train_metric nan, valid_metric 0.047136
[4142451:MainThread](2024-04-06 16:21:00,835) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 0.975443, valid_loss 1.000086, train_metric nan, valid_metric 0.048622
[4142451:MainThread](2024-04-06 16:21:00,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 0.985051, valid_loss 1.000476, train_metric nan, valid_metric 0.049282
[4142451:MainThread](2024-04-06 16:21:00,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:21:02,101) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:21:02,991) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   8%|▊         | 4/52 [01:27<17:25, 21.78s/it][4142451:MainThread](2024-04-06 16:21:02,999) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:21:03,009) INFO - qlib.workflow - [recorder.py:341] - Recorder c078c6d52d904e4cb1155d7e4ce18e3e starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:21:03,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:21:03,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:21:03,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:21:03,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:21:06,962) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:21:07,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.234348, valid_loss 1.135835, train_metric nan, valid_metric 0.030827
[4142451:MainThread](2024-04-06 16:21:07,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.135835, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:21:07,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.084289, valid_loss 1.060947, train_metric nan, valid_metric 0.040682
[4142451:MainThread](2024-04-06 16:21:07,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.135835 to 1.060947, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:07,552) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.059187, valid_loss 1.096865, train_metric nan, valid_metric 0.045555
[4142451:MainThread](2024-04-06 16:21:07,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.048498, valid_loss 1.051635, train_metric nan, valid_metric 0.032631
[4142451:MainThread](2024-04-06 16:21:07,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.060947 to 1.051635, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:07,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.030964, valid_loss 1.031618, train_metric nan, valid_metric 0.032479
[4142451:MainThread](2024-04-06 16:21:07,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.051635 to 1.031618, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:07,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.018159, valid_loss 1.013040, train_metric nan, valid_metric 0.039842
[4142451:MainThread](2024-04-06 16:21:07,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.031618 to 1.013040, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:08,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.011117, valid_loss 1.129174, train_metric nan, valid_metric 0.034865
[4142451:MainThread](2024-04-06 16:21:08,275) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.013464, valid_loss 1.033982, train_metric nan, valid_metric 0.043439
[4142451:MainThread](2024-04-06 16:21:08,413) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 0.998448, valid_loss 0.999999, train_metric nan, valid_metric 0.064209
[4142451:MainThread](2024-04-06 16:21:08,413) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.013040 to 0.999999, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:08,550) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 0.997652, valid_loss 1.059143, train_metric nan, valid_metric 0.051847
[4142451:MainThread](2024-04-06 16:21:08,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 0.995664, valid_loss 1.022579, train_metric nan, valid_metric 0.053712
[4142451:MainThread](2024-04-06 16:21:08,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 0.992973, valid_loss 1.029621, train_metric nan, valid_metric 0.037359
[4142451:MainThread](2024-04-06 16:21:08,980) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.984672, valid_loss 1.009427, train_metric nan, valid_metric 0.067295
[4142451:MainThread](2024-04-06 16:21:09,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 0.997824, valid_loss 1.010226, train_metric nan, valid_metric 0.078714
[4142451:MainThread](2024-04-06 16:21:09,287) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.994628, valid_loss 1.009204, train_metric nan, valid_metric 0.059177
[4142451:MainThread](2024-04-06 16:21:09,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.998948, valid_loss 0.996827, train_metric nan, valid_metric 0.078028
[4142451:MainThread](2024-04-06 16:21:09,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999999 to 0.996827, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:09,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.989851, valid_loss 0.994143, train_metric nan, valid_metric 0.068019
[4142451:MainThread](2024-04-06 16:21:09,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996827 to 0.994143, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:09,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.987168, valid_loss 1.001603, train_metric nan, valid_metric 0.065527
[4142451:MainThread](2024-04-06 16:21:09,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.990340, valid_loss 0.992911, train_metric nan, valid_metric 0.065667
[4142451:MainThread](2024-04-06 16:21:09,817) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994143 to 0.992911, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:09,960) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.987536, valid_loss 1.000921, train_metric nan, valid_metric 0.059046
[4142451:MainThread](2024-04-06 16:21:10,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.978635, valid_loss 0.994876, train_metric nan, valid_metric 0.064401
[4142451:MainThread](2024-04-06 16:21:10,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.985284, valid_loss 1.001607, train_metric nan, valid_metric 0.073890
[4142451:MainThread](2024-04-06 16:21:10,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.983724, valid_loss 0.995577, train_metric nan, valid_metric 0.070247
[4142451:MainThread](2024-04-06 16:21:10,538) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.984846, valid_loss 1.004556, train_metric nan, valid_metric 0.070580
[4142451:MainThread](2024-04-06 16:21:10,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.986868, valid_loss 0.992917, train_metric nan, valid_metric 0.074177
[4142451:MainThread](2024-04-06 16:21:10,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.986542, valid_loss 1.037661, train_metric nan, valid_metric 0.066568
[4142451:MainThread](2024-04-06 16:21:10,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.982649, valid_loss 0.992397, train_metric nan, valid_metric 0.070276
[4142451:MainThread](2024-04-06 16:21:10,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.992911 to 0.992397, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:11,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.980323, valid_loss 1.005166, train_metric nan, valid_metric 0.079337
[4142451:MainThread](2024-04-06 16:21:11,251) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.974124, valid_loss 1.017022, train_metric nan, valid_metric 0.053448
[4142451:MainThread](2024-04-06 16:21:11,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.974663, valid_loss 0.999433, train_metric nan, valid_metric 0.076673
[4142451:MainThread](2024-04-06 16:21:11,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.977289, valid_loss 0.998579, train_metric nan, valid_metric 0.054972
[4142451:MainThread](2024-04-06 16:21:11,659) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.977925, valid_loss 0.995206, train_metric nan, valid_metric 0.063174
[4142451:MainThread](2024-04-06 16:21:11,794) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.984300, valid_loss 0.997897, train_metric nan, valid_metric 0.062157
[4142451:MainThread](2024-04-06 16:21:11,931) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.978431, valid_loss 0.995312, train_metric nan, valid_metric 0.070746
[4142451:MainThread](2024-04-06 16:21:12,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.987440, valid_loss 1.006067, train_metric nan, valid_metric 0.062173
[4142451:MainThread](2024-04-06 16:21:12,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.989393, valid_loss 1.002304, train_metric nan, valid_metric 0.064739
[4142451:MainThread](2024-04-06 16:21:12,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.982771, valid_loss 1.004183, train_metric nan, valid_metric 0.069347
[4142451:MainThread](2024-04-06 16:21:12,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.989050, valid_loss 1.041918, train_metric nan, valid_metric 0.075951
[4142451:MainThread](2024-04-06 16:21:12,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.976535, valid_loss 1.033207, train_metric nan, valid_metric 0.069111
[4142451:MainThread](2024-04-06 16:21:12,892) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.971657, valid_loss 1.029292, train_metric nan, valid_metric 0.065885
[4142451:MainThread](2024-04-06 16:21:13,033) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.986443, valid_loss 1.000532, train_metric nan, valid_metric 0.069408
[4142451:MainThread](2024-04-06 16:21:13,180) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.975962, valid_loss 0.999328, train_metric nan, valid_metric 0.056902
[4142451:MainThread](2024-04-06 16:21:13,325) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.980903, valid_loss 0.994542, train_metric nan, valid_metric 0.062376
[4142451:MainThread](2024-04-06 16:21:13,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.979722, valid_loss 0.994615, train_metric nan, valid_metric 0.067850
[4142451:MainThread](2024-04-06 16:21:13,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.979442, valid_loss 1.001935, train_metric nan, valid_metric 0.055422
[4142451:MainThread](2024-04-06 16:21:13,732) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.979959, valid_loss 0.993759, train_metric nan, valid_metric 0.062547
[4142451:MainThread](2024-04-06 16:21:13,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.974573, valid_loss 0.999904, train_metric nan, valid_metric 0.061626
[4142451:MainThread](2024-04-06 16:21:14,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.975301, valid_loss 1.062867, train_metric nan, valid_metric 0.063843
[4142451:MainThread](2024-04-06 16:21:14,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.969522, valid_loss 0.995683, train_metric nan, valid_metric 0.064211
[4142451:MainThread](2024-04-06 16:21:14,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.976738, valid_loss 0.992393, train_metric nan, valid_metric 0.069733
[4142451:MainThread](2024-04-06 16:21:14,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.992397 to 0.992393, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:14,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.977788, valid_loss 0.994970, train_metric nan, valid_metric 0.060064
[4142451:MainThread](2024-04-06 16:21:14,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.974898, valid_loss 0.995079, train_metric nan, valid_metric 0.068141
[4142451:MainThread](2024-04-06 16:21:14,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.989236, valid_loss 0.994295, train_metric nan, valid_metric 0.065419
[4142451:MainThread](2024-04-06 16:21:14,868) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.980927, valid_loss 0.995162, train_metric nan, valid_metric 0.058669
[4142451:MainThread](2024-04-06 16:21:15,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.976837, valid_loss 0.996626, train_metric nan, valid_metric 0.064621
[4142451:MainThread](2024-04-06 16:21:15,184) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.973006, valid_loss 0.998804, train_metric nan, valid_metric 0.061058
[4142451:MainThread](2024-04-06 16:21:15,352) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.966433, valid_loss 0.995619, train_metric nan, valid_metric 0.066723
[4142451:MainThread](2024-04-06 16:21:15,508) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.980887, valid_loss 0.994046, train_metric nan, valid_metric 0.060188
[4142451:MainThread](2024-04-06 16:21:15,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.974151, valid_loss 0.995160, train_metric nan, valid_metric 0.056351
[4142451:MainThread](2024-04-06 16:21:15,774) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.977424, valid_loss 1.002103, train_metric nan, valid_metric 0.065047
[4142451:MainThread](2024-04-06 16:21:15,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.975817, valid_loss 1.005025, train_metric nan, valid_metric 0.066009
[4142451:MainThread](2024-04-06 16:21:16,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.976667, valid_loss 0.998183, train_metric nan, valid_metric 0.050502
[4142451:MainThread](2024-04-06 16:21:16,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.982188, valid_loss 0.996358, train_metric nan, valid_metric 0.059527
[4142451:MainThread](2024-04-06 16:21:16,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.979389, valid_loss 0.995190, train_metric nan, valid_metric 0.057536
[4142451:MainThread](2024-04-06 16:21:16,568) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.993591, valid_loss 0.997480, train_metric nan, valid_metric 0.047634
[4142451:MainThread](2024-04-06 16:21:16,739) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.973868, valid_loss 0.998423, train_metric nan, valid_metric 0.062220
[4142451:MainThread](2024-04-06 16:21:16,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.985529, valid_loss 0.999094, train_metric nan, valid_metric 0.064041
[4142451:MainThread](2024-04-06 16:21:17,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.968026, valid_loss 1.001258, train_metric nan, valid_metric 0.063860
[4142451:MainThread](2024-04-06 16:21:17,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.981542, valid_loss 0.996374, train_metric nan, valid_metric 0.062901
[4142451:MainThread](2024-04-06 16:21:17,433) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.982096, valid_loss 0.997005, train_metric nan, valid_metric 0.066239
[4142451:MainThread](2024-04-06 16:21:17,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.984361, valid_loss 1.002889, train_metric nan, valid_metric 0.061998
[4142451:MainThread](2024-04-06 16:21:17,778) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.984368, valid_loss 1.004991, train_metric nan, valid_metric 0.059674
[4142451:MainThread](2024-04-06 16:21:17,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.982422, valid_loss 0.995458, train_metric nan, valid_metric 0.057599
[4142451:MainThread](2024-04-06 16:21:18,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.980218, valid_loss 0.998503, train_metric nan, valid_metric 0.060931
[4142451:MainThread](2024-04-06 16:21:18,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.982223, valid_loss 1.001300, train_metric nan, valid_metric 0.063376
[4142451:MainThread](2024-04-06 16:21:18,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.973882, valid_loss 0.996282, train_metric nan, valid_metric 0.060921
[4142451:MainThread](2024-04-06 16:21:18,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.981983, valid_loss 0.996265, train_metric nan, valid_metric 0.059905
[4142451:MainThread](2024-04-06 16:21:18,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.978298, valid_loss 1.002148, train_metric nan, valid_metric 0.064019
[4142451:MainThread](2024-04-06 16:21:19,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.983973, valid_loss 0.996304, train_metric nan, valid_metric 0.060095
[4142451:MainThread](2024-04-06 16:21:19,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.977691, valid_loss 0.995643, train_metric nan, valid_metric 0.063613
[4142451:MainThread](2024-04-06 16:21:19,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.981910, valid_loss 0.995600, train_metric nan, valid_metric 0.059995
[4142451:MainThread](2024-04-06 16:21:19,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.976748, valid_loss 0.997016, train_metric nan, valid_metric 0.058816
[4142451:MainThread](2024-04-06 16:21:19,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.970921, valid_loss 0.998043, train_metric nan, valid_metric 0.060650
[4142451:MainThread](2024-04-06 16:21:19,738) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.978848, valid_loss 0.996196, train_metric nan, valid_metric 0.062624
[4142451:MainThread](2024-04-06 16:21:19,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.968184, valid_loss 0.997263, train_metric nan, valid_metric 0.061929
[4142451:MainThread](2024-04-06 16:21:20,021) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.969654, valid_loss 0.998347, train_metric nan, valid_metric 0.061723
[4142451:MainThread](2024-04-06 16:21:20,156) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.980639, valid_loss 0.996009, train_metric nan, valid_metric 0.058034
[4142451:MainThread](2024-04-06 16:21:20,295) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.970709, valid_loss 0.996571, train_metric nan, valid_metric 0.059339
[4142451:MainThread](2024-04-06 16:21:20,433) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.978117, valid_loss 0.998805, train_metric nan, valid_metric 0.059747
[4142451:MainThread](2024-04-06 16:21:20,582) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.978924, valid_loss 0.996729, train_metric nan, valid_metric 0.059717
[4142451:MainThread](2024-04-06 16:21:20,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.980578, valid_loss 0.996631, train_metric nan, valid_metric 0.062774
[4142451:MainThread](2024-04-06 16:21:20,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.971161, valid_loss 0.996638, train_metric nan, valid_metric 0.057866
[4142451:MainThread](2024-04-06 16:21:21,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.981952, valid_loss 0.997474, train_metric nan, valid_metric 0.051980
[4142451:MainThread](2024-04-06 16:21:21,171) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.976073, valid_loss 0.996370, train_metric nan, valid_metric 0.058992
[4142451:MainThread](2024-04-06 16:21:21,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.975350, valid_loss 0.996540, train_metric nan, valid_metric 0.060256
[4142451:MainThread](2024-04-06 16:21:21,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.978480, valid_loss 0.996355, train_metric nan, valid_metric 0.060529
[4142451:MainThread](2024-04-06 16:21:21,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.981407, valid_loss 0.996490, train_metric nan, valid_metric 0.060067
[4142451:MainThread](2024-04-06 16:21:21,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.975175, valid_loss 0.996531, train_metric nan, valid_metric 0.061172
[4142451:MainThread](2024-04-06 16:21:21,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.967071, valid_loss 0.996053, train_metric nan, valid_metric 0.059998
[4142451:MainThread](2024-04-06 16:21:22,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.980546, valid_loss 0.995983, train_metric nan, valid_metric 0.056563
[4142451:MainThread](2024-04-06 16:21:22,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:21:22,887) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:21:23,747) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  10%|▉         | 5/52 [01:47<16:46, 21.41s/it][4142451:MainThread](2024-04-06 16:21:23,755) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:21:23,765) INFO - qlib.workflow - [recorder.py:341] - Recorder 2105c29b66c340beb746d4b48024633d starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:21:24,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:21:24,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:21:24,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:21:24,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:21:27,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:21:28,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.476258, valid_loss 1.055815, train_metric nan, valid_metric 0.037947
[4142451:MainThread](2024-04-06 16:21:28,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.055815, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:21:28,180) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.138303, valid_loss 1.109948, train_metric nan, valid_metric 0.053037
[4142451:MainThread](2024-04-06 16:21:28,320) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.079569, valid_loss 1.013535, train_metric nan, valid_metric 0.045010
[4142451:MainThread](2024-04-06 16:21:28,321) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.055815 to 1.013535, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:28,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.061957, valid_loss 1.011731, train_metric nan, valid_metric 0.040261
[4142451:MainThread](2024-04-06 16:21:28,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.013535 to 1.011731, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:28,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.136557, valid_loss 1.029097, train_metric nan, valid_metric 0.019444
[4142451:MainThread](2024-04-06 16:21:28,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.057299, valid_loss 1.007125, train_metric nan, valid_metric 0.049589
[4142451:MainThread](2024-04-06 16:21:28,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.011731 to 1.007125, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:28,914) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.038700, valid_loss 1.004156, train_metric nan, valid_metric 0.048694
[4142451:MainThread](2024-04-06 16:21:28,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.007125 to 1.004156, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:29,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.041750, valid_loss 0.997815, train_metric nan, valid_metric 0.066406
[4142451:MainThread](2024-04-06 16:21:29,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.004156 to 0.997815, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:29,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.033543, valid_loss 1.017786, train_metric nan, valid_metric 0.059117
[4142451:MainThread](2024-04-06 16:21:29,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.027352, valid_loss 1.032841, train_metric nan, valid_metric 0.065508
[4142451:MainThread](2024-04-06 16:21:29,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.019895, valid_loss 0.999897, train_metric nan, valid_metric 0.061299
[4142451:MainThread](2024-04-06 16:21:29,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.043075, valid_loss 1.026740, train_metric nan, valid_metric 0.056000
[4142451:MainThread](2024-04-06 16:21:29,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.024635, valid_loss 1.001734, train_metric nan, valid_metric 0.060571
[4142451:MainThread](2024-04-06 16:21:29,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.052840, valid_loss 1.045150, train_metric nan, valid_metric 0.041074
[4142451:MainThread](2024-04-06 16:21:30,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.024090, valid_loss 1.002810, train_metric nan, valid_metric 0.073511
[4142451:MainThread](2024-04-06 16:21:30,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.027377, valid_loss 1.010866, train_metric nan, valid_metric 0.049800
[4142451:MainThread](2024-04-06 16:21:30,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.010257, valid_loss 1.001124, train_metric nan, valid_metric 0.046128
[4142451:MainThread](2024-04-06 16:21:30,593) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.015581, valid_loss 0.999576, train_metric nan, valid_metric 0.066309
[4142451:MainThread](2024-04-06 16:21:30,737) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.018601, valid_loss 0.999454, train_metric nan, valid_metric 0.067145
[4142451:MainThread](2024-04-06 16:21:30,910) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.009361, valid_loss 1.013954, train_metric nan, valid_metric 0.055657
[4142451:MainThread](2024-04-06 16:21:31,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.995517, valid_loss 0.995760, train_metric nan, valid_metric 0.068431
[4142451:MainThread](2024-04-06 16:21:31,075) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997815 to 0.995760, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:31,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.997121, valid_loss 0.995789, train_metric nan, valid_metric 0.074203
[4142451:MainThread](2024-04-06 16:21:31,364) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.006632, valid_loss 0.997469, train_metric nan, valid_metric 0.062272
[4142451:MainThread](2024-04-06 16:21:31,541) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.996805, valid_loss 1.010343, train_metric nan, valid_metric 0.054669
[4142451:MainThread](2024-04-06 16:21:31,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.007741, valid_loss 0.999801, train_metric nan, valid_metric 0.064040
[4142451:MainThread](2024-04-06 16:21:31,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.003586, valid_loss 0.992624, train_metric nan, valid_metric 0.067861
[4142451:MainThread](2024-04-06 16:21:31,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995760 to 0.992624, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:32,005) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.012698, valid_loss 0.996523, train_metric nan, valid_metric 0.068650
[4142451:MainThread](2024-04-06 16:21:32,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.010254, valid_loss 0.998218, train_metric nan, valid_metric 0.063392
[4142451:MainThread](2024-04-06 16:21:32,292) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.003854, valid_loss 0.994996, train_metric nan, valid_metric 0.073236
[4142451:MainThread](2024-04-06 16:21:32,434) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.991054, valid_loss 0.996804, train_metric nan, valid_metric 0.058117
[4142451:MainThread](2024-04-06 16:21:32,569) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.001566, valid_loss 0.994849, train_metric nan, valid_metric 0.069461
[4142451:MainThread](2024-04-06 16:21:32,705) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.996219, valid_loss 0.992926, train_metric nan, valid_metric 0.071230
[4142451:MainThread](2024-04-06 16:21:32,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.994559, valid_loss 0.991947, train_metric nan, valid_metric 0.074222
[4142451:MainThread](2024-04-06 16:21:32,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.992624 to 0.991947, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:32,996) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.990699, valid_loss 0.991884, train_metric nan, valid_metric 0.075216
[4142451:MainThread](2024-04-06 16:21:32,996) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991947 to 0.991884, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:33,140) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.988179, valid_loss 0.992910, train_metric nan, valid_metric 0.076369
[4142451:MainThread](2024-04-06 16:21:33,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.992220, valid_loss 0.994844, train_metric nan, valid_metric 0.062574
[4142451:MainThread](2024-04-06 16:21:33,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.987931, valid_loss 0.998588, train_metric nan, valid_metric 0.061551
[4142451:MainThread](2024-04-06 16:21:33,573) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.996037, valid_loss 0.991433, train_metric nan, valid_metric 0.076377
[4142451:MainThread](2024-04-06 16:21:33,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991884 to 0.991433, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:33,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.999104, valid_loss 1.000855, train_metric nan, valid_metric 0.060081
[4142451:MainThread](2024-04-06 16:21:33,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.988736, valid_loss 0.996867, train_metric nan, valid_metric 0.063724
[4142451:MainThread](2024-04-06 16:21:34,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.986835, valid_loss 0.992614, train_metric nan, valid_metric 0.076055
[4142451:MainThread](2024-04-06 16:21:34,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.007692, valid_loss 1.002684, train_metric nan, valid_metric 0.057458
[4142451:MainThread](2024-04-06 16:21:34,287) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.998134, valid_loss 0.993350, train_metric nan, valid_metric 0.071747
[4142451:MainThread](2024-04-06 16:21:34,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.004353, valid_loss 0.997964, train_metric nan, valid_metric 0.075966
[4142451:MainThread](2024-04-06 16:21:34,576) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.993149, valid_loss 0.993986, train_metric nan, valid_metric 0.071494
[4142451:MainThread](2024-04-06 16:21:34,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.995950, valid_loss 0.995890, train_metric nan, valid_metric 0.061604
[4142451:MainThread](2024-04-06 16:21:34,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.986284, valid_loss 0.992418, train_metric nan, valid_metric 0.070040
[4142451:MainThread](2024-04-06 16:21:35,004) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.998550, valid_loss 0.992277, train_metric nan, valid_metric 0.076217
[4142451:MainThread](2024-04-06 16:21:35,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.989648, valid_loss 0.991721, train_metric nan, valid_metric 0.077772
[4142451:MainThread](2024-04-06 16:21:35,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.985100, valid_loss 0.992295, train_metric nan, valid_metric 0.067060
[4142451:MainThread](2024-04-06 16:21:35,437) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.996431, valid_loss 0.995692, train_metric nan, valid_metric 0.068218
[4142451:MainThread](2024-04-06 16:21:35,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.989550, valid_loss 0.992236, train_metric nan, valid_metric 0.075230
[4142451:MainThread](2024-04-06 16:21:35,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.986983, valid_loss 0.992923, train_metric nan, valid_metric 0.070820
[4142451:MainThread](2024-04-06 16:21:35,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.989571, valid_loss 0.994637, train_metric nan, valid_metric 0.063794
[4142451:MainThread](2024-04-06 16:21:36,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.983362, valid_loss 0.992964, train_metric nan, valid_metric 0.070096
[4142451:MainThread](2024-04-06 16:21:36,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.991419, valid_loss 0.993442, train_metric nan, valid_metric 0.067108
[4142451:MainThread](2024-04-06 16:21:36,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.988865, valid_loss 0.993070, train_metric nan, valid_metric 0.070324
[4142451:MainThread](2024-04-06 16:21:36,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.989580, valid_loss 0.991436, train_metric nan, valid_metric 0.077071
[4142451:MainThread](2024-04-06 16:21:36,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.983169, valid_loss 0.995387, train_metric nan, valid_metric 0.064147
[4142451:MainThread](2024-04-06 16:21:36,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.986756, valid_loss 0.992796, train_metric nan, valid_metric 0.070939
[4142451:MainThread](2024-04-06 16:21:36,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.991055, valid_loss 0.993351, train_metric nan, valid_metric 0.069340
[4142451:MainThread](2024-04-06 16:21:37,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.988188, valid_loss 0.993266, train_metric nan, valid_metric 0.069151
[4142451:MainThread](2024-04-06 16:21:37,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.978677, valid_loss 0.993147, train_metric nan, valid_metric 0.071218
[4142451:MainThread](2024-04-06 16:21:37,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.985807, valid_loss 0.993798, train_metric nan, valid_metric 0.069697
[4142451:MainThread](2024-04-06 16:21:37,444) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.989760, valid_loss 0.993868, train_metric nan, valid_metric 0.066035
[4142451:MainThread](2024-04-06 16:21:37,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.989309, valid_loss 0.994411, train_metric nan, valid_metric 0.065601
[4142451:MainThread](2024-04-06 16:21:37,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.994970, valid_loss 0.994026, train_metric nan, valid_metric 0.067859
[4142451:MainThread](2024-04-06 16:21:37,894) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.994323, valid_loss 0.993127, train_metric nan, valid_metric 0.070506
[4142451:MainThread](2024-04-06 16:21:38,058) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.987351, valid_loss 0.993334, train_metric nan, valid_metric 0.070156
[4142451:MainThread](2024-04-06 16:21:38,191) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.993020, valid_loss 0.993445, train_metric nan, valid_metric 0.071721
[4142451:MainThread](2024-04-06 16:21:38,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.981678, valid_loss 0.994495, train_metric nan, valid_metric 0.069307
[4142451:MainThread](2024-04-06 16:21:38,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.994187, valid_loss 0.994150, train_metric nan, valid_metric 0.067007
[4142451:MainThread](2024-04-06 16:21:38,571) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.994830, valid_loss 0.992890, train_metric nan, valid_metric 0.072463
[4142451:MainThread](2024-04-06 16:21:38,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.982469, valid_loss 0.993103, train_metric nan, valid_metric 0.072134
[4142451:MainThread](2024-04-06 16:21:38,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.984698, valid_loss 0.992207, train_metric nan, valid_metric 0.074707
[4142451:MainThread](2024-04-06 16:21:39,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.983849, valid_loss 0.993440, train_metric nan, valid_metric 0.070231
[4142451:MainThread](2024-04-06 16:21:39,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.989147, valid_loss 0.992324, train_metric nan, valid_metric 0.072266
[4142451:MainThread](2024-04-06 16:21:39,327) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.987545, valid_loss 0.993825, train_metric nan, valid_metric 0.072542
[4142451:MainThread](2024-04-06 16:21:39,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.988412, valid_loss 0.992482, train_metric nan, valid_metric 0.074011
[4142451:MainThread](2024-04-06 16:21:39,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.977631, valid_loss 0.993642, train_metric nan, valid_metric 0.070965
[4142451:MainThread](2024-04-06 16:21:39,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.981117, valid_loss 0.994277, train_metric nan, valid_metric 0.065832
[4142451:MainThread](2024-04-06 16:21:39,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.978298, valid_loss 0.993697, train_metric nan, valid_metric 0.069178
[4142451:MainThread](2024-04-06 16:21:40,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.986875, valid_loss 0.994161, train_metric nan, valid_metric 0.067254
[4142451:MainThread](2024-04-06 16:21:40,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.990451, valid_loss 0.993591, train_metric nan, valid_metric 0.070830
[4142451:MainThread](2024-04-06 16:21:40,340) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.983023, valid_loss 0.992681, train_metric nan, valid_metric 0.073316
[4142451:MainThread](2024-04-06 16:21:40,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.991697, valid_loss 0.993256, train_metric nan, valid_metric 0.070986
[4142451:MainThread](2024-04-06 16:21:40,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.989125, valid_loss 0.992373, train_metric nan, valid_metric 0.072731
[4142451:MainThread](2024-04-06 16:21:40,818) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.989288, valid_loss 0.993830, train_metric nan, valid_metric 0.068151
[4142451:MainThread](2024-04-06 16:21:40,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:21:41,866) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:21:42,731) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  12%|█▏        | 6/52 [02:06<15:46, 20.59s/it][4142451:MainThread](2024-04-06 16:21:42,739) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:21:42,749) INFO - qlib.workflow - [recorder.py:341] - Recorder 94310cf21d164181bf3c8085c4697264 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:21:43,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:21:43,346) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:21:43,349) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:21:43,350) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:21:46,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:21:47,058) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.233628, valid_loss 1.108783, train_metric nan, valid_metric 0.019858
[4142451:MainThread](2024-04-06 16:21:47,059) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.108783, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:21:47,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.080182, valid_loss 1.032344, train_metric nan, valid_metric 0.024098
[4142451:MainThread](2024-04-06 16:21:47,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.108783 to 1.032344, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:47,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.055728, valid_loss 1.016176, train_metric nan, valid_metric 0.032144
[4142451:MainThread](2024-04-06 16:21:47,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.032344 to 1.016176, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:47,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.046354, valid_loss 1.003416, train_metric nan, valid_metric 0.038267
[4142451:MainThread](2024-04-06 16:21:47,502) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.016176 to 1.003416, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:47,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.025647, valid_loss 1.003162, train_metric nan, valid_metric 0.058694
[4142451:MainThread](2024-04-06 16:21:47,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003416 to 1.003162, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:47,818) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.035705, valid_loss 1.007841, train_metric nan, valid_metric 0.037460
[4142451:MainThread](2024-04-06 16:21:47,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.079713, valid_loss 1.030590, train_metric nan, valid_metric 0.036530
[4142451:MainThread](2024-04-06 16:21:48,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.025301, valid_loss 1.000283, train_metric nan, valid_metric 0.037588
[4142451:MainThread](2024-04-06 16:21:48,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003162 to 1.000283, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:48,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 0.994303, valid_loss 1.004498, train_metric nan, valid_metric 0.068292
[4142451:MainThread](2024-04-06 16:21:48,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 0.992070, valid_loss 0.992110, train_metric nan, valid_metric 0.073508
[4142451:MainThread](2024-04-06 16:21:48,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000283 to 0.992110, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:48,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.003776, valid_loss 1.007832, train_metric nan, valid_metric 0.060678
[4142451:MainThread](2024-04-06 16:21:48,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 0.994859, valid_loss 0.994229, train_metric nan, valid_metric 0.070681
[4142451:MainThread](2024-04-06 16:21:48,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.993982, valid_loss 0.991101, train_metric nan, valid_metric 0.083219
[4142451:MainThread](2024-04-06 16:21:48,784) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.992110 to 0.991101, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:48,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 0.998709, valid_loss 1.004265, train_metric nan, valid_metric 0.062432
[4142451:MainThread](2024-04-06 16:21:49,043) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.988897, valid_loss 0.997072, train_metric nan, valid_metric 0.074272
[4142451:MainThread](2024-04-06 16:21:49,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.001007, valid_loss 0.994461, train_metric nan, valid_metric 0.069375
[4142451:MainThread](2024-04-06 16:21:49,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.006859, valid_loss 0.996407, train_metric nan, valid_metric 0.067873
[4142451:MainThread](2024-04-06 16:21:49,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.991652, valid_loss 0.994266, train_metric nan, valid_metric 0.068637
[4142451:MainThread](2024-04-06 16:21:49,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.988712, valid_loss 0.996432, train_metric nan, valid_metric 0.072830
[4142451:MainThread](2024-04-06 16:21:49,784) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.981319, valid_loss 1.000383, train_metric nan, valid_metric 0.066329
[4142451:MainThread](2024-04-06 16:21:49,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.993887, valid_loss 0.996513, train_metric nan, valid_metric 0.056385
[4142451:MainThread](2024-04-06 16:21:50,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.990157, valid_loss 0.993630, train_metric nan, valid_metric 0.070333
[4142451:MainThread](2024-04-06 16:21:50,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.998582, valid_loss 1.001755, train_metric nan, valid_metric 0.081116
[4142451:MainThread](2024-04-06 16:21:50,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.988766, valid_loss 0.995300, train_metric nan, valid_metric 0.066936
[4142451:MainThread](2024-04-06 16:21:50,505) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.999112, valid_loss 0.998194, train_metric nan, valid_metric 0.063584
[4142451:MainThread](2024-04-06 16:21:50,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.982376, valid_loss 0.993872, train_metric nan, valid_metric 0.068941
[4142451:MainThread](2024-04-06 16:21:50,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.994049, valid_loss 0.995687, train_metric nan, valid_metric 0.070177
[4142451:MainThread](2024-04-06 16:21:50,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.989935, valid_loss 0.993287, train_metric nan, valid_metric 0.067642
[4142451:MainThread](2024-04-06 16:21:51,065) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.978933, valid_loss 0.994405, train_metric nan, valid_metric 0.063712
[4142451:MainThread](2024-04-06 16:21:51,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.985739, valid_loss 0.994847, train_metric nan, valid_metric 0.061781
[4142451:MainThread](2024-04-06 16:21:51,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.990579, valid_loss 0.994299, train_metric nan, valid_metric 0.065982
[4142451:MainThread](2024-04-06 16:21:51,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.995587, valid_loss 0.991499, train_metric nan, valid_metric 0.077461
[4142451:MainThread](2024-04-06 16:21:51,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.983002, valid_loss 0.994269, train_metric nan, valid_metric 0.069286
[4142451:MainThread](2024-04-06 16:21:51,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.985641, valid_loss 0.992440, train_metric nan, valid_metric 0.074384
[4142451:MainThread](2024-04-06 16:21:51,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.984093, valid_loss 0.992881, train_metric nan, valid_metric 0.072404
[4142451:MainThread](2024-04-06 16:21:52,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.976267, valid_loss 0.991602, train_metric nan, valid_metric 0.082925
[4142451:MainThread](2024-04-06 16:21:52,183) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.989540, valid_loss 0.990587, train_metric nan, valid_metric 0.085043
[4142451:MainThread](2024-04-06 16:21:52,184) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991101 to 0.990587, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:52,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.987945, valid_loss 0.990816, train_metric nan, valid_metric 0.080236
[4142451:MainThread](2024-04-06 16:21:52,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.986378, valid_loss 0.991187, train_metric nan, valid_metric 0.079211
[4142451:MainThread](2024-04-06 16:21:52,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.978507, valid_loss 0.993239, train_metric nan, valid_metric 0.069226
[4142451:MainThread](2024-04-06 16:21:52,741) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.979489, valid_loss 0.993166, train_metric nan, valid_metric 0.070690
[4142451:MainThread](2024-04-06 16:21:52,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.989493, valid_loss 0.995653, train_metric nan, valid_metric 0.059639
[4142451:MainThread](2024-04-06 16:21:52,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.986841, valid_loss 0.994227, train_metric nan, valid_metric 0.066424
[4142451:MainThread](2024-04-06 16:21:53,134) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.970126, valid_loss 0.993382, train_metric nan, valid_metric 0.070727
[4142451:MainThread](2024-04-06 16:21:53,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.981396, valid_loss 0.994091, train_metric nan, valid_metric 0.070854
[4142451:MainThread](2024-04-06 16:21:53,424) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.986080, valid_loss 0.994922, train_metric nan, valid_metric 0.064148
[4142451:MainThread](2024-04-06 16:21:53,579) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.977314, valid_loss 0.991779, train_metric nan, valid_metric 0.080768
[4142451:MainThread](2024-04-06 16:21:53,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.980752, valid_loss 0.990581, train_metric nan, valid_metric 0.082823
[4142451:MainThread](2024-04-06 16:21:53,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990587 to 0.990581, save checkpoint.
[4142451:MainThread](2024-04-06 16:21:53,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.974817, valid_loss 0.993497, train_metric nan, valid_metric 0.068083
[4142451:MainThread](2024-04-06 16:21:54,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.982225, valid_loss 0.990978, train_metric nan, valid_metric 0.080058
[4142451:MainThread](2024-04-06 16:21:54,176) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.977565, valid_loss 0.991327, train_metric nan, valid_metric 0.079827
[4142451:MainThread](2024-04-06 16:21:54,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.984314, valid_loss 0.993542, train_metric nan, valid_metric 0.070433
[4142451:MainThread](2024-04-06 16:21:54,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.971091, valid_loss 0.992353, train_metric nan, valid_metric 0.074937
[4142451:MainThread](2024-04-06 16:21:54,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.989085, valid_loss 0.991261, train_metric nan, valid_metric 0.079297
[4142451:MainThread](2024-04-06 16:21:54,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.980696, valid_loss 0.992749, train_metric nan, valid_metric 0.074707
[4142451:MainThread](2024-04-06 16:21:54,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.979599, valid_loss 0.994102, train_metric nan, valid_metric 0.067031
[4142451:MainThread](2024-04-06 16:21:55,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.990015, valid_loss 0.990949, train_metric nan, valid_metric 0.079479
[4142451:MainThread](2024-04-06 16:21:55,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.991005, valid_loss 0.991670, train_metric nan, valid_metric 0.076233
[4142451:MainThread](2024-04-06 16:21:55,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.974082, valid_loss 0.993693, train_metric nan, valid_metric 0.069771
[4142451:MainThread](2024-04-06 16:21:55,511) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.977040, valid_loss 0.993891, train_metric nan, valid_metric 0.068090
[4142451:MainThread](2024-04-06 16:21:55,673) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.985089, valid_loss 0.993669, train_metric nan, valid_metric 0.069683
[4142451:MainThread](2024-04-06 16:21:55,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.982294, valid_loss 0.990916, train_metric nan, valid_metric 0.081173
[4142451:MainThread](2024-04-06 16:21:55,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.980650, valid_loss 0.992776, train_metric nan, valid_metric 0.071816
[4142451:MainThread](2024-04-06 16:21:56,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.983973, valid_loss 0.994070, train_metric nan, valid_metric 0.067035
[4142451:MainThread](2024-04-06 16:21:56,257) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.972113, valid_loss 0.993242, train_metric nan, valid_metric 0.069943
[4142451:MainThread](2024-04-06 16:21:56,425) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.982947, valid_loss 0.992933, train_metric nan, valid_metric 0.070106
[4142451:MainThread](2024-04-06 16:21:56,599) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.992039, valid_loss 0.992590, train_metric nan, valid_metric 0.073776
[4142451:MainThread](2024-04-06 16:21:56,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.981960, valid_loss 0.993268, train_metric nan, valid_metric 0.068437
[4142451:MainThread](2024-04-06 16:21:56,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.978207, valid_loss 0.994083, train_metric nan, valid_metric 0.065561
[4142451:MainThread](2024-04-06 16:21:57,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.989805, valid_loss 0.994801, train_metric nan, valid_metric 0.063098
[4142451:MainThread](2024-04-06 16:21:57,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.982203, valid_loss 0.994076, train_metric nan, valid_metric 0.066010
[4142451:MainThread](2024-04-06 16:21:57,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.986586, valid_loss 0.991911, train_metric nan, valid_metric 0.076191
[4142451:MainThread](2024-04-06 16:21:57,505) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.980471, valid_loss 0.993245, train_metric nan, valid_metric 0.069450
[4142451:MainThread](2024-04-06 16:21:57,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.999337, valid_loss 0.993146, train_metric nan, valid_metric 0.071238
[4142451:MainThread](2024-04-06 16:21:57,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.986837, valid_loss 0.992604, train_metric nan, valid_metric 0.073745
[4142451:MainThread](2024-04-06 16:21:57,931) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.977131, valid_loss 0.991104, train_metric nan, valid_metric 0.079480
[4142451:MainThread](2024-04-06 16:21:58,080) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.980305, valid_loss 0.993288, train_metric nan, valid_metric 0.069607
[4142451:MainThread](2024-04-06 16:21:58,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.986686, valid_loss 0.993725, train_metric nan, valid_metric 0.067926
[4142451:MainThread](2024-04-06 16:21:58,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.980462, valid_loss 0.990586, train_metric nan, valid_metric 0.082615
[4142451:MainThread](2024-04-06 16:21:58,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.979345, valid_loss 0.992807, train_metric nan, valid_metric 0.071959
[4142451:MainThread](2024-04-06 16:21:58,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.985438, valid_loss 0.992183, train_metric nan, valid_metric 0.076015
[4142451:MainThread](2024-04-06 16:21:58,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.983513, valid_loss 0.993045, train_metric nan, valid_metric 0.072455
[4142451:MainThread](2024-04-06 16:21:58,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.976341, valid_loss 0.992341, train_metric nan, valid_metric 0.071866
[4142451:MainThread](2024-04-06 16:21:59,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.980941, valid_loss 0.993074, train_metric nan, valid_metric 0.070193
[4142451:MainThread](2024-04-06 16:21:59,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.975866, valid_loss 0.991953, train_metric nan, valid_metric 0.076555
[4142451:MainThread](2024-04-06 16:21:59,398) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.970460, valid_loss 0.993739, train_metric nan, valid_metric 0.068190
[4142451:MainThread](2024-04-06 16:21:59,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.981603, valid_loss 0.990660, train_metric nan, valid_metric 0.082913
[4142451:MainThread](2024-04-06 16:21:59,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.969640, valid_loss 0.992878, train_metric nan, valid_metric 0.071452
[4142451:MainThread](2024-04-06 16:21:59,830) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.979473, valid_loss 0.991998, train_metric nan, valid_metric 0.075719
[4142451:MainThread](2024-04-06 16:21:59,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.984430, valid_loss 0.993926, train_metric nan, valid_metric 0.067498
[4142451:MainThread](2024-04-06 16:22:00,130) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.984403, valid_loss 0.993235, train_metric nan, valid_metric 0.070882
[4142451:MainThread](2024-04-06 16:22:00,268) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.981414, valid_loss 0.994043, train_metric nan, valid_metric 0.066624
[4142451:MainThread](2024-04-06 16:22:00,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.978321, valid_loss 0.994584, train_metric nan, valid_metric 0.064925
[4142451:MainThread](2024-04-06 16:22:00,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.978484, valid_loss 0.992864, train_metric nan, valid_metric 0.072534
[4142451:MainThread](2024-04-06 16:22:00,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.975398, valid_loss 0.990435, train_metric nan, valid_metric 0.083617
[4142451:MainThread](2024-04-06 16:22:00,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990581 to 0.990435, save checkpoint.
[4142451:MainThread](2024-04-06 16:22:00,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.986043, valid_loss 0.991723, train_metric nan, valid_metric 0.078100
[4142451:MainThread](2024-04-06 16:22:00,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.975824, valid_loss 0.993553, train_metric nan, valid_metric 0.069516
[4142451:MainThread](2024-04-06 16:22:01,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.990105, valid_loss 0.991136, train_metric nan, valid_metric 0.079052
[4142451:MainThread](2024-04-06 16:22:01,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.995341, valid_loss 0.991779, train_metric nan, valid_metric 0.077356
[4142451:MainThread](2024-04-06 16:22:01,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.982518, valid_loss 0.990451, train_metric nan, valid_metric 0.082943
[4142451:MainThread](2024-04-06 16:22:01,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.983802, valid_loss 0.993261, train_metric nan, valid_metric 0.068387
[4142451:MainThread](2024-04-06 16:22:01,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.980615, valid_loss 0.992341, train_metric nan, valid_metric 0.073757
[4142451:MainThread](2024-04-06 16:22:01,842) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.982608, valid_loss 0.993557, train_metric nan, valid_metric 0.068572
[4142451:MainThread](2024-04-06 16:22:01,983) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.973756, valid_loss 0.994221, train_metric nan, valid_metric 0.066699
[4142451:MainThread](2024-04-06 16:22:02,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.981634, valid_loss 0.994241, train_metric nan, valid_metric 0.066802
[4142451:MainThread](2024-04-06 16:22:02,263) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 0.985783, valid_loss 0.993167, train_metric nan, valid_metric 0.071019
[4142451:MainThread](2024-04-06 16:22:02,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.988858, valid_loss 0.993227, train_metric nan, valid_metric 0.069693
[4142451:MainThread](2024-04-06 16:22:02,552) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 0.989307, valid_loss 0.994084, train_metric nan, valid_metric 0.066681
[4142451:MainThread](2024-04-06 16:22:02,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 0.979572, valid_loss 0.993254, train_metric nan, valid_metric 0.070768
[4142451:MainThread](2024-04-06 16:22:02,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 0.979212, valid_loss 0.990448, train_metric nan, valid_metric 0.083342
[4142451:MainThread](2024-04-06 16:22:02,970) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 0.975336, valid_loss 0.991622, train_metric nan, valid_metric 0.075304
[4142451:MainThread](2024-04-06 16:22:03,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 0.978846, valid_loss 0.992797, train_metric nan, valid_metric 0.071868
[4142451:MainThread](2024-04-06 16:22:03,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 0.983038, valid_loss 0.992832, train_metric nan, valid_metric 0.071250
[4142451:MainThread](2024-04-06 16:22:03,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 0.980940, valid_loss 0.990514, train_metric nan, valid_metric 0.083737
[4142451:MainThread](2024-04-06 16:22:03,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 0.983101, valid_loss 0.990646, train_metric nan, valid_metric 0.081920
[4142451:MainThread](2024-04-06 16:22:03,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 0.969914, valid_loss 0.992908, train_metric nan, valid_metric 0.071392
[4142451:MainThread](2024-04-06 16:22:03,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 0.977969, valid_loss 0.993220, train_metric nan, valid_metric 0.070621
[4142451:MainThread](2024-04-06 16:22:03,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 0.980062, valid_loss 0.992016, train_metric nan, valid_metric 0.075367
[4142451:MainThread](2024-04-06 16:22:04,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 0.984611, valid_loss 0.993829, train_metric nan, valid_metric 0.067984
[4142451:MainThread](2024-04-06 16:22:04,278) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 0.981272, valid_loss 0.992873, train_metric nan, valid_metric 0.072566
[4142451:MainThread](2024-04-06 16:22:04,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 0.990273, valid_loss 0.991751, train_metric nan, valid_metric 0.074682
[4142451:MainThread](2024-04-06 16:22:04,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 0.973411, valid_loss 0.992928, train_metric nan, valid_metric 0.071813
[4142451:MainThread](2024-04-06 16:22:04,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 0.990157, valid_loss 0.989897, train_metric nan, valid_metric 0.086595
[4142451:MainThread](2024-04-06 16:22:04,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990435 to 0.989897, save checkpoint.
[4142451:MainThread](2024-04-06 16:22:04,882) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 0.975116, valid_loss 0.992403, train_metric nan, valid_metric 0.073991
[4142451:MainThread](2024-04-06 16:22:05,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 0.977897, valid_loss 0.993517, train_metric nan, valid_metric 0.068611
[4142451:MainThread](2024-04-06 16:22:05,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 0.969871, valid_loss 0.994183, train_metric nan, valid_metric 0.066258
[4142451:MainThread](2024-04-06 16:22:05,354) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 0.987878, valid_loss 0.994319, train_metric nan, valid_metric 0.065570
[4142451:MainThread](2024-04-06 16:22:05,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 0.980482, valid_loss 0.993733, train_metric nan, valid_metric 0.069256
[4142451:MainThread](2024-04-06 16:22:05,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 0.987389, valid_loss 0.990656, train_metric nan, valid_metric 0.083091
[4142451:MainThread](2024-04-06 16:22:05,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 0.978083, valid_loss 0.990615, train_metric nan, valid_metric 0.081938
[4142451:MainThread](2024-04-06 16:22:05,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 0.990543, valid_loss 0.991775, train_metric nan, valid_metric 0.077210
[4142451:MainThread](2024-04-06 16:22:06,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 0.974012, valid_loss 0.993622, train_metric nan, valid_metric 0.068586
[4142451:MainThread](2024-04-06 16:22:06,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 0.973202, valid_loss 0.991602, train_metric nan, valid_metric 0.077982
[4142451:MainThread](2024-04-06 16:22:06,352) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 0.983412, valid_loss 0.990654, train_metric nan, valid_metric 0.082764
[4142451:MainThread](2024-04-06 16:22:06,494) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 0.978106, valid_loss 0.992363, train_metric nan, valid_metric 0.073597
[4142451:MainThread](2024-04-06 16:22:06,638) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 0.986330, valid_loss 0.991438, train_metric nan, valid_metric 0.077616
[4142451:MainThread](2024-04-06 16:22:06,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 0.975946, valid_loss 0.992940, train_metric nan, valid_metric 0.072282
[4142451:MainThread](2024-04-06 16:22:06,909) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2760]: train_loss 0.976092, valid_loss 0.994093, train_metric nan, valid_metric 0.067235
[4142451:MainThread](2024-04-06 16:22:07,052) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2780]: train_loss 0.978146, valid_loss 0.992973, train_metric nan, valid_metric 0.071972
[4142451:MainThread](2024-04-06 16:22:07,192) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2800]: train_loss 0.980141, valid_loss 0.992250, train_metric nan, valid_metric 0.074834
[4142451:MainThread](2024-04-06 16:22:07,328) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2820]: train_loss 0.980216, valid_loss 0.993809, train_metric nan, valid_metric 0.068326
[4142451:MainThread](2024-04-06 16:22:07,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2840]: train_loss 0.978874, valid_loss 0.992891, train_metric nan, valid_metric 0.072046
[4142451:MainThread](2024-04-06 16:22:07,599) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2860]: train_loss 0.991162, valid_loss 0.992517, train_metric nan, valid_metric 0.074668
[4142451:MainThread](2024-04-06 16:22:07,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2880]: train_loss 0.973342, valid_loss 0.992074, train_metric nan, valid_metric 0.076503
[4142451:MainThread](2024-04-06 16:22:07,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2900]: train_loss 0.977152, valid_loss 0.992492, train_metric nan, valid_metric 0.072275
[4142451:MainThread](2024-04-06 16:22:08,079) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2920]: train_loss 0.977392, valid_loss 0.993849, train_metric nan, valid_metric 0.067103
[4142451:MainThread](2024-04-06 16:22:08,227) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2940]: train_loss 0.973382, valid_loss 0.991843, train_metric nan, valid_metric 0.076521
[4142451:MainThread](2024-04-06 16:22:08,364) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2960]: train_loss 0.992634, valid_loss 0.992121, train_metric nan, valid_metric 0.075981
[4142451:MainThread](2024-04-06 16:22:08,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2980]: train_loss 0.977057, valid_loss 0.990824, train_metric nan, valid_metric 0.082535
[4142451:MainThread](2024-04-06 16:22:08,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3000]: train_loss 0.988563, valid_loss 0.993122, train_metric nan, valid_metric 0.071603
[4142451:MainThread](2024-04-06 16:22:08,796) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3020]: train_loss 0.982514, valid_loss 0.991188, train_metric nan, valid_metric 0.079704
[4142451:MainThread](2024-04-06 16:22:08,931) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3040]: train_loss 0.977233, valid_loss 0.990460, train_metric nan, valid_metric 0.083563
[4142451:MainThread](2024-04-06 16:22:09,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3060]: train_loss 0.981301, valid_loss 0.992836, train_metric nan, valid_metric 0.072466
[4142451:MainThread](2024-04-06 16:22:09,203) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3080]: train_loss 0.979632, valid_loss 0.994251, train_metric nan, valid_metric 0.066170
[4142451:MainThread](2024-04-06 16:22:09,344) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3100]: train_loss 0.983041, valid_loss 0.994047, train_metric nan, valid_metric 0.066264
[4142451:MainThread](2024-04-06 16:22:09,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3120]: train_loss 0.979811, valid_loss 0.993478, train_metric nan, valid_metric 0.068823
[4142451:MainThread](2024-04-06 16:22:09,641) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3140]: train_loss 0.974512, valid_loss 0.991754, train_metric nan, valid_metric 0.076872
[4142451:MainThread](2024-04-06 16:22:09,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3160]: train_loss 0.983320, valid_loss 0.989917, train_metric nan, valid_metric 0.086838
[4142451:MainThread](2024-04-06 16:22:09,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3180]: train_loss 0.980995, valid_loss 0.989773, train_metric nan, valid_metric 0.086387
[4142451:MainThread](2024-04-06 16:22:09,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.989897 to 0.989773, save checkpoint.
[4142451:MainThread](2024-04-06 16:22:10,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3200]: train_loss 0.980876, valid_loss 0.991975, train_metric nan, valid_metric 0.076179
[4142451:MainThread](2024-04-06 16:22:10,220) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3220]: train_loss 0.974161, valid_loss 0.991143, train_metric nan, valid_metric 0.080712
[4142451:MainThread](2024-04-06 16:22:10,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3240]: train_loss 0.987376, valid_loss 0.993447, train_metric nan, valid_metric 0.069660
[4142451:MainThread](2024-04-06 16:22:10,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3260]: train_loss 0.980434, valid_loss 0.992207, train_metric nan, valid_metric 0.074237
[4142451:MainThread](2024-04-06 16:22:10,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3280]: train_loss 0.985665, valid_loss 0.993471, train_metric nan, valid_metric 0.068825
[4142451:MainThread](2024-04-06 16:22:10,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3300]: train_loss 0.977760, valid_loss 0.994000, train_metric nan, valid_metric 0.067630
[4142451:MainThread](2024-04-06 16:22:10,928) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3320]: train_loss 0.974329, valid_loss 0.990498, train_metric nan, valid_metric 0.083699
[4142451:MainThread](2024-04-06 16:22:11,075) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3340]: train_loss 0.971805, valid_loss 0.992832, train_metric nan, valid_metric 0.072948
[4142451:MainThread](2024-04-06 16:22:11,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3360]: train_loss 0.983014, valid_loss 0.994215, train_metric nan, valid_metric 0.066554
[4142451:MainThread](2024-04-06 16:22:11,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3380]: train_loss 0.982606, valid_loss 0.992387, train_metric nan, valid_metric 0.073736
[4142451:MainThread](2024-04-06 16:22:11,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3400]: train_loss 0.979874, valid_loss 0.992720, train_metric nan, valid_metric 0.072817
[4142451:MainThread](2024-04-06 16:22:11,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3420]: train_loss 0.982846, valid_loss 0.993732, train_metric nan, valid_metric 0.068499
[4142451:MainThread](2024-04-06 16:22:11,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3440]: train_loss 0.977251, valid_loss 0.991840, train_metric nan, valid_metric 0.076405
[4142451:MainThread](2024-04-06 16:22:11,931) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3460]: train_loss 0.983039, valid_loss 0.989906, train_metric nan, valid_metric 0.086626
[4142451:MainThread](2024-04-06 16:22:12,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3480]: train_loss 0.975027, valid_loss 0.992048, train_metric nan, valid_metric 0.077097
[4142451:MainThread](2024-04-06 16:22:12,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3500]: train_loss 0.980116, valid_loss 0.993868, train_metric nan, valid_metric 0.068096
[4142451:MainThread](2024-04-06 16:22:12,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3520]: train_loss 0.976463, valid_loss 0.994067, train_metric nan, valid_metric 0.066696
[4142451:MainThread](2024-04-06 16:22:12,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3540]: train_loss 0.984045, valid_loss 0.994432, train_metric nan, valid_metric 0.065683
[4142451:MainThread](2024-04-06 16:22:12,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3560]: train_loss 0.983214, valid_loss 0.993226, train_metric nan, valid_metric 0.070820
[4142451:MainThread](2024-04-06 16:22:12,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3580]: train_loss 0.985308, valid_loss 0.993457, train_metric nan, valid_metric 0.070100
[4142451:MainThread](2024-04-06 16:22:12,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3600]: train_loss 0.981244, valid_loss 0.994208, train_metric nan, valid_metric 0.067169
[4142451:MainThread](2024-04-06 16:22:13,099) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3620]: train_loss 0.981645, valid_loss 0.991879, train_metric nan, valid_metric 0.078055
[4142451:MainThread](2024-04-06 16:22:13,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3640]: train_loss 0.985446, valid_loss 0.990955, train_metric nan, valid_metric 0.079755
[4142451:MainThread](2024-04-06 16:22:13,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3660]: train_loss 0.989835, valid_loss 0.992572, train_metric nan, valid_metric 0.073936
[4142451:MainThread](2024-04-06 16:22:13,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3680]: train_loss 0.981013, valid_loss 0.991217, train_metric nan, valid_metric 0.078386
[4142451:MainThread](2024-04-06 16:22:13,677) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3700]: train_loss 0.984023, valid_loss 0.993665, train_metric nan, valid_metric 0.068299
[4142451:MainThread](2024-04-06 16:22:13,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3720]: train_loss 0.977924, valid_loss 0.994489, train_metric nan, valid_metric 0.065293
[4142451:MainThread](2024-04-06 16:22:13,962) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3740]: train_loss 0.986460, valid_loss 0.994608, train_metric nan, valid_metric 0.064558
[4142451:MainThread](2024-04-06 16:22:14,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3760]: train_loss 0.986270, valid_loss 0.993579, train_metric nan, valid_metric 0.068887
[4142451:MainThread](2024-04-06 16:22:14,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3780]: train_loss 0.989362, valid_loss 0.994299, train_metric nan, valid_metric 0.065923
[4142451:MainThread](2024-04-06 16:22:14,434) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3800]: train_loss 0.981679, valid_loss 0.992882, train_metric nan, valid_metric 0.071636
[4142451:MainThread](2024-04-06 16:22:14,573) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3820]: train_loss 0.989742, valid_loss 0.994008, train_metric nan, valid_metric 0.067038
[4142451:MainThread](2024-04-06 16:22:14,710) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3840]: train_loss 0.976163, valid_loss 0.991424, train_metric nan, valid_metric 0.079624
[4142451:MainThread](2024-04-06 16:22:14,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3860]: train_loss 0.979631, valid_loss 0.993402, train_metric nan, valid_metric 0.070011
[4142451:MainThread](2024-04-06 16:22:15,014) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3880]: train_loss 0.982987, valid_loss 0.994475, train_metric nan, valid_metric 0.065567
[4142451:MainThread](2024-04-06 16:22:15,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3900]: train_loss 0.981778, valid_loss 0.990793, train_metric nan, valid_metric 0.081470
[4142451:MainThread](2024-04-06 16:22:15,326) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3920]: train_loss 0.977061, valid_loss 0.991205, train_metric nan, valid_metric 0.078735
[4142451:MainThread](2024-04-06 16:22:15,500) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3940]: train_loss 0.979805, valid_loss 0.993072, train_metric nan, valid_metric 0.071765
[4142451:MainThread](2024-04-06 16:22:15,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3960]: train_loss 0.975027, valid_loss 0.992627, train_metric nan, valid_metric 0.073630
[4142451:MainThread](2024-04-06 16:22:15,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3980]: train_loss 0.983226, valid_loss 0.994327, train_metric nan, valid_metric 0.066557
[4142451:MainThread](2024-04-06 16:22:16,034) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4000]: train_loss 0.966585, valid_loss 0.991351, train_metric nan, valid_metric 0.079965
[4142451:MainThread](2024-04-06 16:22:16,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4020]: train_loss 0.986114, valid_loss 0.993088, train_metric nan, valid_metric 0.071515
[4142451:MainThread](2024-04-06 16:22:16,349) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4040]: train_loss 0.981908, valid_loss 0.994012, train_metric nan, valid_metric 0.068002
[4142451:MainThread](2024-04-06 16:22:16,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4060]: train_loss 0.989741, valid_loss 0.994397, train_metric nan, valid_metric 0.066066
[4142451:MainThread](2024-04-06 16:22:16,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4080]: train_loss 0.987664, valid_loss 0.993912, train_metric nan, valid_metric 0.067785
[4142451:MainThread](2024-04-06 16:22:16,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4100]: train_loss 0.980274, valid_loss 0.992861, train_metric nan, valid_metric 0.072262
[4142451:MainThread](2024-04-06 16:22:16,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4120]: train_loss 0.991006, valid_loss 0.991498, train_metric nan, valid_metric 0.079182
[4142451:MainThread](2024-04-06 16:22:17,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4140]: train_loss 0.979763, valid_loss 0.993675, train_metric nan, valid_metric 0.069520
[4142451:MainThread](2024-04-06 16:22:17,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4160]: train_loss 0.977518, valid_loss 0.994269, train_metric nan, valid_metric 0.066745
[4142451:MainThread](2024-04-06 16:22:17,393) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 4180]: train_loss 0.976409, valid_loss 0.994442, train_metric nan, valid_metric 0.065665
[4142451:MainThread](2024-04-06 16:22:17,394) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:22:18,209) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:22:19,079) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  13%|█▎        | 7/52 [02:43<19:18, 25.74s/it][4142451:MainThread](2024-04-06 16:22:19,087) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:22:19,099) INFO - qlib.workflow - [recorder.py:341] - Recorder 5ed3e43083284ae4a9088717a301ef00 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:22:19,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:22:19,774) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:22:19,779) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:22:19,779) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:22:23,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:22:23,626) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.184565, valid_loss 1.095530, train_metric nan, valid_metric 0.028881
[4142451:MainThread](2024-04-06 16:22:23,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.095530, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:22:23,765) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.065642, valid_loss 1.017030, train_metric nan, valid_metric 0.044010
[4142451:MainThread](2024-04-06 16:22:23,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.095530 to 1.017030, save checkpoint.
[4142451:MainThread](2024-04-06 16:22:23,912) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.061912, valid_loss 1.013533, train_metric nan, valid_metric 0.057479
[4142451:MainThread](2024-04-06 16:22:23,912) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.017030 to 1.013533, save checkpoint.
[4142451:MainThread](2024-04-06 16:22:24,059) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.020168, valid_loss 1.014319, train_metric nan, valid_metric 0.061523
[4142451:MainThread](2024-04-06 16:22:24,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.030567, valid_loss 1.001718, train_metric nan, valid_metric 0.059522
[4142451:MainThread](2024-04-06 16:22:24,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.013533 to 1.001718, save checkpoint.
[4142451:MainThread](2024-04-06 16:22:24,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.041052, valid_loss 1.013351, train_metric nan, valid_metric 0.040795
[4142451:MainThread](2024-04-06 16:22:24,492) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.041534, valid_loss 1.075671, train_metric nan, valid_metric 0.045428
[4142451:MainThread](2024-04-06 16:22:24,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.006770, valid_loss 1.003305, train_metric nan, valid_metric 0.061813
[4142451:MainThread](2024-04-06 16:22:24,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.022156, valid_loss 0.995167, train_metric nan, valid_metric 0.065046
[4142451:MainThread](2024-04-06 16:22:24,799) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001718 to 0.995167, save checkpoint.
[4142451:MainThread](2024-04-06 16:22:24,937) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.011138, valid_loss 1.006451, train_metric nan, valid_metric 0.041002
[4142451:MainThread](2024-04-06 16:22:25,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.000265, valid_loss 0.996415, train_metric nan, valid_metric 0.053234
[4142451:MainThread](2024-04-06 16:22:25,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 0.992005, valid_loss 1.001320, train_metric nan, valid_metric 0.064168
[4142451:MainThread](2024-04-06 16:22:25,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.986528, valid_loss 0.996995, train_metric nan, valid_metric 0.058481
[4142451:MainThread](2024-04-06 16:22:25,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 0.995894, valid_loss 0.997110, train_metric nan, valid_metric 0.058195
[4142451:MainThread](2024-04-06 16:22:25,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.001556, valid_loss 1.005210, train_metric nan, valid_metric 0.067751
[4142451:MainThread](2024-04-06 16:22:25,920) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.996993, valid_loss 0.994724, train_metric nan, valid_metric 0.062301
[4142451:MainThread](2024-04-06 16:22:25,920) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995167 to 0.994724, save checkpoint.
[4142451:MainThread](2024-04-06 16:22:26,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.987596, valid_loss 0.994525, train_metric nan, valid_metric 0.071155
[4142451:MainThread](2024-04-06 16:22:26,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994724 to 0.994525, save checkpoint.
[4142451:MainThread](2024-04-06 16:22:26,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.983397, valid_loss 0.997088, train_metric nan, valid_metric 0.058396
[4142451:MainThread](2024-04-06 16:22:26,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.989999, valid_loss 0.994967, train_metric nan, valid_metric 0.065820
[4142451:MainThread](2024-04-06 16:22:26,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.992367, valid_loss 1.001005, train_metric nan, valid_metric 0.059027
[4142451:MainThread](2024-04-06 16:22:26,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.977200, valid_loss 0.994719, train_metric nan, valid_metric 0.065833
[4142451:MainThread](2024-04-06 16:22:26,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.988208, valid_loss 0.998220, train_metric nan, valid_metric 0.061122
[4142451:MainThread](2024-04-06 16:22:26,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.986102, valid_loss 1.000659, train_metric nan, valid_metric 0.057552
[4142451:MainThread](2024-04-06 16:22:27,169) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.984696, valid_loss 0.994133, train_metric nan, valid_metric 0.065016
[4142451:MainThread](2024-04-06 16:22:27,169) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994525 to 0.994133, save checkpoint.
[4142451:MainThread](2024-04-06 16:22:27,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.986742, valid_loss 1.004336, train_metric nan, valid_metric 0.048035
[4142451:MainThread](2024-04-06 16:22:27,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.001085, valid_loss 0.995479, train_metric nan, valid_metric 0.059799
[4142451:MainThread](2024-04-06 16:22:27,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.993527, valid_loss 0.993812, train_metric nan, valid_metric 0.070141
[4142451:MainThread](2024-04-06 16:22:27,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994133 to 0.993812, save checkpoint.
[4142451:MainThread](2024-04-06 16:22:27,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.985885, valid_loss 0.998002, train_metric nan, valid_metric 0.056988
[4142451:MainThread](2024-04-06 16:22:27,968) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.995159, valid_loss 1.002118, train_metric nan, valid_metric 0.050383
[4142451:MainThread](2024-04-06 16:22:28,108) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.986088, valid_loss 0.992494, train_metric nan, valid_metric 0.074581
[4142451:MainThread](2024-04-06 16:22:28,108) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993812 to 0.992494, save checkpoint.
[4142451:MainThread](2024-04-06 16:22:28,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.989444, valid_loss 0.997810, train_metric nan, valid_metric 0.054541
[4142451:MainThread](2024-04-06 16:22:28,396) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.981722, valid_loss 1.000454, train_metric nan, valid_metric 0.045793
[4142451:MainThread](2024-04-06 16:22:28,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.983205, valid_loss 0.996145, train_metric nan, valid_metric 0.062394
[4142451:MainThread](2024-04-06 16:22:28,705) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.991333, valid_loss 0.996741, train_metric nan, valid_metric 0.055561
[4142451:MainThread](2024-04-06 16:22:28,876) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.987933, valid_loss 0.995790, train_metric nan, valid_metric 0.060802
[4142451:MainThread](2024-04-06 16:22:29,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.982409, valid_loss 0.993777, train_metric nan, valid_metric 0.062639
[4142451:MainThread](2024-04-06 16:22:29,215) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.986013, valid_loss 0.993394, train_metric nan, valid_metric 0.062965
[4142451:MainThread](2024-04-06 16:22:29,386) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.989867, valid_loss 0.996661, train_metric nan, valid_metric 0.047480
[4142451:MainThread](2024-04-06 16:22:29,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.987619, valid_loss 1.001498, train_metric nan, valid_metric 0.057568
[4142451:MainThread](2024-04-06 16:22:29,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.984731, valid_loss 0.996400, train_metric nan, valid_metric 0.056788
[4142451:MainThread](2024-04-06 16:22:29,885) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.983946, valid_loss 1.000891, train_metric nan, valid_metric 0.044986
[4142451:MainThread](2024-04-06 16:22:30,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.989931, valid_loss 0.995929, train_metric nan, valid_metric 0.061067
[4142451:MainThread](2024-04-06 16:22:30,183) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.974805, valid_loss 0.995280, train_metric nan, valid_metric 0.061344
[4142451:MainThread](2024-04-06 16:22:30,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.973442, valid_loss 0.996582, train_metric nan, valid_metric 0.056539
[4142451:MainThread](2024-04-06 16:22:30,492) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.979076, valid_loss 0.996036, train_metric nan, valid_metric 0.052151
[4142451:MainThread](2024-04-06 16:22:30,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.975869, valid_loss 1.000333, train_metric nan, valid_metric 0.052798
[4142451:MainThread](2024-04-06 16:22:30,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.984061, valid_loss 0.995843, train_metric nan, valid_metric 0.061166
[4142451:MainThread](2024-04-06 16:22:30,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.982346, valid_loss 0.993885, train_metric nan, valid_metric 0.062964
[4142451:MainThread](2024-04-06 16:22:31,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.993355, valid_loss 0.993576, train_metric nan, valid_metric 0.061037
[4142451:MainThread](2024-04-06 16:22:31,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.977328, valid_loss 0.998585, train_metric nan, valid_metric 0.055467
[4142451:MainThread](2024-04-06 16:22:31,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.980635, valid_loss 0.997802, train_metric nan, valid_metric 0.051188
[4142451:MainThread](2024-04-06 16:22:31,510) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.982743, valid_loss 1.001154, train_metric nan, valid_metric 0.057915
[4142451:MainThread](2024-04-06 16:22:31,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.987599, valid_loss 0.994835, train_metric nan, valid_metric 0.061604
[4142451:MainThread](2024-04-06 16:22:31,812) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.979375, valid_loss 0.995602, train_metric nan, valid_metric 0.060449
[4142451:MainThread](2024-04-06 16:22:31,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.984125, valid_loss 0.994417, train_metric nan, valid_metric 0.064119
[4142451:MainThread](2024-04-06 16:22:32,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.974223, valid_loss 0.995249, train_metric nan, valid_metric 0.062440
[4142451:MainThread](2024-04-06 16:22:32,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.982564, valid_loss 0.994708, train_metric nan, valid_metric 0.061085
[4142451:MainThread](2024-04-06 16:22:32,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.973058, valid_loss 0.996804, train_metric nan, valid_metric 0.054772
[4142451:MainThread](2024-04-06 16:22:32,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.981498, valid_loss 0.996388, train_metric nan, valid_metric 0.055214
[4142451:MainThread](2024-04-06 16:22:32,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.983083, valid_loss 0.995313, train_metric nan, valid_metric 0.058162
[4142451:MainThread](2024-04-06 16:22:32,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.972637, valid_loss 0.995470, train_metric nan, valid_metric 0.058909
[4142451:MainThread](2024-04-06 16:22:32,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.981908, valid_loss 0.995151, train_metric nan, valid_metric 0.063931
[4142451:MainThread](2024-04-06 16:22:33,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.983462, valid_loss 0.997768, train_metric nan, valid_metric 0.061321
[4142451:MainThread](2024-04-06 16:22:33,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.976146, valid_loss 0.995537, train_metric nan, valid_metric 0.061807
[4142451:MainThread](2024-04-06 16:22:33,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.980632, valid_loss 0.995847, train_metric nan, valid_metric 0.059891
[4142451:MainThread](2024-04-06 16:22:33,571) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.972976, valid_loss 0.998170, train_metric nan, valid_metric 0.049178
[4142451:MainThread](2024-04-06 16:22:33,716) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.991265, valid_loss 0.995471, train_metric nan, valid_metric 0.059313
[4142451:MainThread](2024-04-06 16:22:33,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.972236, valid_loss 0.997512, train_metric nan, valid_metric 0.055814
[4142451:MainThread](2024-04-06 16:22:34,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.982267, valid_loss 0.997839, train_metric nan, valid_metric 0.052870
[4142451:MainThread](2024-04-06 16:22:34,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.979997, valid_loss 0.996323, train_metric nan, valid_metric 0.058699
[4142451:MainThread](2024-04-06 16:22:34,307) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.969087, valid_loss 0.996841, train_metric nan, valid_metric 0.060564
[4142451:MainThread](2024-04-06 16:22:34,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.974437, valid_loss 0.998306, train_metric nan, valid_metric 0.057921
[4142451:MainThread](2024-04-06 16:22:34,586) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.975879, valid_loss 0.995469, train_metric nan, valid_metric 0.057826
[4142451:MainThread](2024-04-06 16:22:34,726) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.977072, valid_loss 0.996723, train_metric nan, valid_metric 0.054030
[4142451:MainThread](2024-04-06 16:22:34,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.973669, valid_loss 0.997436, train_metric nan, valid_metric 0.054304
[4142451:MainThread](2024-04-06 16:22:35,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.983383, valid_loss 0.997216, train_metric nan, valid_metric 0.053860
[4142451:MainThread](2024-04-06 16:22:35,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.982998, valid_loss 0.997727, train_metric nan, valid_metric 0.053809
[4142451:MainThread](2024-04-06 16:22:35,335) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.971926, valid_loss 0.998356, train_metric nan, valid_metric 0.049922
[4142451:MainThread](2024-04-06 16:22:35,484) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.987891, valid_loss 0.996902, train_metric nan, valid_metric 0.052431
[4142451:MainThread](2024-04-06 16:22:35,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.975372, valid_loss 0.995788, train_metric nan, valid_metric 0.059351
[4142451:MainThread](2024-04-06 16:22:35,626) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:22:36,449) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:22:37,308) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  15%|█▌        | 8/52 [03:01<17:07, 23.35s/it][4142451:MainThread](2024-04-06 16:22:37,316) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:22:37,326) INFO - qlib.workflow - [recorder.py:341] - Recorder cc062c10f27b4c8abb6373ae29d7fd57 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:22:37,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:22:38,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:22:38,005) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:22:38,005) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:22:41,380) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:22:41,746) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.210855, valid_loss 1.066596, train_metric nan, valid_metric 0.028218
[4142451:MainThread](2024-04-06 16:22:41,747) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.066596, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:22:41,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.099100, valid_loss 1.006344, train_metric nan, valid_metric 0.044108
[4142451:MainThread](2024-04-06 16:22:41,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.066596 to 1.006344, save checkpoint.
[4142451:MainThread](2024-04-06 16:22:42,016) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.044797, valid_loss 1.012153, train_metric nan, valid_metric 0.042440
[4142451:MainThread](2024-04-06 16:22:42,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.028205, valid_loss 1.007332, train_metric nan, valid_metric 0.039963
[4142451:MainThread](2024-04-06 16:22:42,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.015150, valid_loss 1.031618, train_metric nan, valid_metric 0.066432
[4142451:MainThread](2024-04-06 16:22:42,433) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.018652, valid_loss 1.025812, train_metric nan, valid_metric 0.053057
[4142451:MainThread](2024-04-06 16:22:42,569) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.042234, valid_loss 1.102087, train_metric nan, valid_metric 0.070244
[4142451:MainThread](2024-04-06 16:22:42,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.004755, valid_loss 1.000059, train_metric nan, valid_metric 0.059534
[4142451:MainThread](2024-04-06 16:22:42,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006344 to 1.000059, save checkpoint.
[4142451:MainThread](2024-04-06 16:22:42,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.003536, valid_loss 1.007105, train_metric nan, valid_metric 0.041782
[4142451:MainThread](2024-04-06 16:22:43,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.002637, valid_loss 0.995259, train_metric nan, valid_metric 0.066557
[4142451:MainThread](2024-04-06 16:22:43,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000059 to 0.995259, save checkpoint.
[4142451:MainThread](2024-04-06 16:22:43,142) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 0.994368, valid_loss 1.004948, train_metric nan, valid_metric 0.053101
[4142451:MainThread](2024-04-06 16:22:43,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.000189, valid_loss 1.000727, train_metric nan, valid_metric 0.046892
[4142451:MainThread](2024-04-06 16:22:43,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.004437, valid_loss 1.006821, train_metric nan, valid_metric 0.064383
[4142451:MainThread](2024-04-06 16:22:43,568) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.004139, valid_loss 1.008305, train_metric nan, valid_metric 0.072712
[4142451:MainThread](2024-04-06 16:22:43,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.008426, valid_loss 0.996964, train_metric nan, valid_metric 0.049488
[4142451:MainThread](2024-04-06 16:22:43,846) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.002525, valid_loss 0.998009, train_metric nan, valid_metric 0.061327
[4142451:MainThread](2024-04-06 16:22:43,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.989254, valid_loss 1.005918, train_metric nan, valid_metric 0.050018
[4142451:MainThread](2024-04-06 16:22:44,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.989292, valid_loss 1.005880, train_metric nan, valid_metric 0.045664
[4142451:MainThread](2024-04-06 16:22:44,270) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.998347, valid_loss 0.996962, train_metric nan, valid_metric 0.048168
[4142451:MainThread](2024-04-06 16:22:44,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.983752, valid_loss 1.004070, train_metric nan, valid_metric 0.062855
[4142451:MainThread](2024-04-06 16:22:44,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.000523, valid_loss 0.994351, train_metric nan, valid_metric 0.063507
[4142451:MainThread](2024-04-06 16:22:44,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995259 to 0.994351, save checkpoint.
[4142451:MainThread](2024-04-06 16:22:44,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.003564, valid_loss 0.998336, train_metric nan, valid_metric 0.057627
[4142451:MainThread](2024-04-06 16:22:44,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.989171, valid_loss 0.998132, train_metric nan, valid_metric 0.069024
[4142451:MainThread](2024-04-06 16:22:45,015) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.988704, valid_loss 0.998242, train_metric nan, valid_metric 0.072936
[4142451:MainThread](2024-04-06 16:22:45,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.985452, valid_loss 0.997553, train_metric nan, valid_metric 0.061025
[4142451:MainThread](2024-04-06 16:22:45,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.000291, valid_loss 0.997265, train_metric nan, valid_metric 0.066241
[4142451:MainThread](2024-04-06 16:22:45,511) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.987919, valid_loss 0.994043, train_metric nan, valid_metric 0.067011
[4142451:MainThread](2024-04-06 16:22:45,511) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994351 to 0.994043, save checkpoint.
[4142451:MainThread](2024-04-06 16:22:45,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.985583, valid_loss 0.999076, train_metric nan, valid_metric 0.061220
[4142451:MainThread](2024-04-06 16:22:45,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.981318, valid_loss 0.997716, train_metric nan, valid_metric 0.049862
[4142451:MainThread](2024-04-06 16:22:45,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.992145, valid_loss 0.992470, train_metric nan, valid_metric 0.074797
[4142451:MainThread](2024-04-06 16:22:45,970) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994043 to 0.992470, save checkpoint.
[4142451:MainThread](2024-04-06 16:22:46,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.989646, valid_loss 0.995246, train_metric nan, valid_metric 0.061291
[4142451:MainThread](2024-04-06 16:22:46,304) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.996995, valid_loss 0.992555, train_metric nan, valid_metric 0.073609
[4142451:MainThread](2024-04-06 16:22:46,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.988604, valid_loss 0.995390, train_metric nan, valid_metric 0.066109
[4142451:MainThread](2024-04-06 16:22:46,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.982155, valid_loss 0.996730, train_metric nan, valid_metric 0.060506
[4142451:MainThread](2024-04-06 16:22:46,744) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.982510, valid_loss 0.997187, train_metric nan, valid_metric 0.046921
[4142451:MainThread](2024-04-06 16:22:46,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.990261, valid_loss 0.999626, train_metric nan, valid_metric 0.062786
[4142451:MainThread](2024-04-06 16:22:47,102) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.991388, valid_loss 1.003512, train_metric nan, valid_metric 0.061927
[4142451:MainThread](2024-04-06 16:22:47,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.987516, valid_loss 0.994884, train_metric nan, valid_metric 0.063685
[4142451:MainThread](2024-04-06 16:22:47,415) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.984252, valid_loss 0.995560, train_metric nan, valid_metric 0.059514
[4142451:MainThread](2024-04-06 16:22:47,561) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.988268, valid_loss 0.995841, train_metric nan, valid_metric 0.071875
[4142451:MainThread](2024-04-06 16:22:47,710) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.987361, valid_loss 0.998010, train_metric nan, valid_metric 0.060800
[4142451:MainThread](2024-04-06 16:22:47,856) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.986845, valid_loss 0.996969, train_metric nan, valid_metric 0.055900
[4142451:MainThread](2024-04-06 16:22:48,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.993176, valid_loss 0.993930, train_metric nan, valid_metric 0.069049
[4142451:MainThread](2024-04-06 16:22:48,146) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.983079, valid_loss 0.994210, train_metric nan, valid_metric 0.069625
[4142451:MainThread](2024-04-06 16:22:48,287) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.984844, valid_loss 0.995964, train_metric nan, valid_metric 0.057964
[4142451:MainThread](2024-04-06 16:22:48,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.990585, valid_loss 0.994199, train_metric nan, valid_metric 0.064444
[4142451:MainThread](2024-04-06 16:22:48,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.988583, valid_loss 0.996917, train_metric nan, valid_metric 0.060034
[4142451:MainThread](2024-04-06 16:22:48,735) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.981202, valid_loss 1.000606, train_metric nan, valid_metric 0.060767
[4142451:MainThread](2024-04-06 16:22:48,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.980982, valid_loss 0.997020, train_metric nan, valid_metric 0.054607
[4142451:MainThread](2024-04-06 16:22:49,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.979233, valid_loss 0.995614, train_metric nan, valid_metric 0.062058
[4142451:MainThread](2024-04-06 16:22:49,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.973937, valid_loss 0.995446, train_metric nan, valid_metric 0.064048
[4142451:MainThread](2024-04-06 16:22:49,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.995428, valid_loss 0.996133, train_metric nan, valid_metric 0.065411
[4142451:MainThread](2024-04-06 16:22:49,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.977682, valid_loss 0.997995, train_metric nan, valid_metric 0.057163
[4142451:MainThread](2024-04-06 16:22:49,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.978172, valid_loss 0.997995, train_metric nan, valid_metric 0.055536
[4142451:MainThread](2024-04-06 16:22:49,710) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.978930, valid_loss 0.997843, train_metric nan, valid_metric 0.060195
[4142451:MainThread](2024-04-06 16:22:49,850) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.977880, valid_loss 0.997191, train_metric nan, valid_metric 0.053554
[4142451:MainThread](2024-04-06 16:22:49,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.982309, valid_loss 0.997172, train_metric nan, valid_metric 0.058610
[4142451:MainThread](2024-04-06 16:22:50,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.984800, valid_loss 0.995931, train_metric nan, valid_metric 0.059454
[4142451:MainThread](2024-04-06 16:22:50,289) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.975802, valid_loss 0.995287, train_metric nan, valid_metric 0.060758
[4142451:MainThread](2024-04-06 16:22:50,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.974769, valid_loss 0.996237, train_metric nan, valid_metric 0.060093
[4142451:MainThread](2024-04-06 16:22:50,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.975256, valid_loss 0.995220, train_metric nan, valid_metric 0.062958
[4142451:MainThread](2024-04-06 16:22:50,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.974360, valid_loss 0.996226, train_metric nan, valid_metric 0.057029
[4142451:MainThread](2024-04-06 16:22:50,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.986832, valid_loss 0.998199, train_metric nan, valid_metric 0.053164
[4142451:MainThread](2024-04-06 16:22:51,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.981861, valid_loss 0.996528, train_metric nan, valid_metric 0.059116
[4142451:MainThread](2024-04-06 16:22:51,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.978719, valid_loss 0.996436, train_metric nan, valid_metric 0.060543
[4142451:MainThread](2024-04-06 16:22:51,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.984768, valid_loss 0.996871, train_metric nan, valid_metric 0.059249
[4142451:MainThread](2024-04-06 16:22:51,527) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.985305, valid_loss 0.997953, train_metric nan, valid_metric 0.045212
[4142451:MainThread](2024-04-06 16:22:51,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.988271, valid_loss 0.995900, train_metric nan, valid_metric 0.057034
[4142451:MainThread](2024-04-06 16:22:51,818) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.997945, valid_loss 0.996639, train_metric nan, valid_metric 0.058276
[4142451:MainThread](2024-04-06 16:22:51,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.975732, valid_loss 0.997283, train_metric nan, valid_metric 0.056246
[4142451:MainThread](2024-04-06 16:22:52,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.976929, valid_loss 0.996952, train_metric nan, valid_metric 0.056709
[4142451:MainThread](2024-04-06 16:22:52,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.984871, valid_loss 0.998946, train_metric nan, valid_metric 0.052241
[4142451:MainThread](2024-04-06 16:22:52,390) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.974364, valid_loss 0.998654, train_metric nan, valid_metric 0.054348
[4142451:MainThread](2024-04-06 16:22:52,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.979430, valid_loss 0.998518, train_metric nan, valid_metric 0.051813
[4142451:MainThread](2024-04-06 16:22:52,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.989686, valid_loss 0.997727, train_metric nan, valid_metric 0.055277
[4142451:MainThread](2024-04-06 16:22:52,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.972800, valid_loss 0.997105, train_metric nan, valid_metric 0.050819
[4142451:MainThread](2024-04-06 16:22:52,983) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.975530, valid_loss 0.997502, train_metric nan, valid_metric 0.056508
[4142451:MainThread](2024-04-06 16:22:53,127) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.986280, valid_loss 0.997321, train_metric nan, valid_metric 0.056420
[4142451:MainThread](2024-04-06 16:22:53,270) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.978516, valid_loss 0.997242, train_metric nan, valid_metric 0.057626
[4142451:MainThread](2024-04-06 16:22:53,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.982788, valid_loss 0.996402, train_metric nan, valid_metric 0.056210
[4142451:MainThread](2024-04-06 16:22:53,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:22:54,269) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:22:55,154) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  17%|█▋        | 9/52 [03:19<15:30, 21.63s/it][4142451:MainThread](2024-04-06 16:22:55,163) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:22:55,172) INFO - qlib.workflow - [recorder.py:341] - Recorder 8f5abc035b5247c7b0dc6180a626314c starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:22:55,771) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:22:55,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:22:55,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:22:55,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:22:59,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:22:59,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.207592, valid_loss 1.030546, train_metric nan, valid_metric 0.018999
[4142451:MainThread](2024-04-06 16:22:59,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.030546, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:22:59,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.104211, valid_loss 1.047248, train_metric nan, valid_metric 0.005527
[4142451:MainThread](2024-04-06 16:23:00,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.057470, valid_loss 1.033446, train_metric nan, valid_metric 0.010914
[4142451:MainThread](2024-04-06 16:23:00,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.024257, valid_loss 1.014935, train_metric nan, valid_metric 0.034710
[4142451:MainThread](2024-04-06 16:23:00,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.030546 to 1.014935, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:00,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.047611, valid_loss 1.018224, train_metric nan, valid_metric 0.038980
[4142451:MainThread](2024-04-06 16:23:00,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.026585, valid_loss 1.009234, train_metric nan, valid_metric 0.076791
[4142451:MainThread](2024-04-06 16:23:00,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.014935 to 1.009234, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:00,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.012021, valid_loss 0.998384, train_metric nan, valid_metric 0.064256
[4142451:MainThread](2024-04-06 16:23:00,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.009234 to 0.998384, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:00,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.012252, valid_loss 1.002012, train_metric nan, valid_metric 0.065540
[4142451:MainThread](2024-04-06 16:23:00,937) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.008146, valid_loss 0.997034, train_metric nan, valid_metric 0.071668
[4142451:MainThread](2024-04-06 16:23:00,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998384 to 0.997034, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:01,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.004308, valid_loss 0.996351, train_metric nan, valid_metric 0.049097
[4142451:MainThread](2024-04-06 16:23:01,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997034 to 0.996351, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:01,238) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.013508, valid_loss 1.011037, train_metric nan, valid_metric 0.039046
[4142451:MainThread](2024-04-06 16:23:01,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.007452, valid_loss 1.008528, train_metric nan, valid_metric 0.068997
[4142451:MainThread](2024-04-06 16:23:01,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.010059, valid_loss 1.028443, train_metric nan, valid_metric 0.053633
[4142451:MainThread](2024-04-06 16:23:01,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 0.993952, valid_loss 0.997748, train_metric nan, valid_metric 0.068763
[4142451:MainThread](2024-04-06 16:23:01,818) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.996026, valid_loss 1.005589, train_metric nan, valid_metric 0.046572
[4142451:MainThread](2024-04-06 16:23:01,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.995834, valid_loss 0.992974, train_metric nan, valid_metric 0.079959
[4142451:MainThread](2024-04-06 16:23:01,955) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996351 to 0.992974, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:02,091) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.993859, valid_loss 0.996930, train_metric nan, valid_metric 0.057872
[4142451:MainThread](2024-04-06 16:23:02,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.995251, valid_loss 0.998028, train_metric nan, valid_metric 0.058839
[4142451:MainThread](2024-04-06 16:23:02,375) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.989523, valid_loss 0.992340, train_metric nan, valid_metric 0.074241
[4142451:MainThread](2024-04-06 16:23:02,375) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.992974 to 0.992340, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:02,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.980125, valid_loss 0.998146, train_metric nan, valid_metric 0.057684
[4142451:MainThread](2024-04-06 16:23:02,691) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.982338, valid_loss 0.995577, train_metric nan, valid_metric 0.059061
[4142451:MainThread](2024-04-06 16:23:02,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.988889, valid_loss 0.991244, train_metric nan, valid_metric 0.085891
[4142451:MainThread](2024-04-06 16:23:02,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.992340 to 0.991244, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:02,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.985966, valid_loss 0.994071, train_metric nan, valid_metric 0.070440
[4142451:MainThread](2024-04-06 16:23:03,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.993207, valid_loss 0.992226, train_metric nan, valid_metric 0.084144
[4142451:MainThread](2024-04-06 16:23:03,281) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.983499, valid_loss 0.993003, train_metric nan, valid_metric 0.070750
[4142451:MainThread](2024-04-06 16:23:03,403) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.993296, valid_loss 0.995009, train_metric nan, valid_metric 0.069794
[4142451:MainThread](2024-04-06 16:23:03,528) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.988160, valid_loss 0.995382, train_metric nan, valid_metric 0.080198
[4142451:MainThread](2024-04-06 16:23:03,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.989260, valid_loss 0.992446, train_metric nan, valid_metric 0.074576
[4142451:MainThread](2024-04-06 16:23:03,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.980769, valid_loss 0.995146, train_metric nan, valid_metric 0.084638
[4142451:MainThread](2024-04-06 16:23:03,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.993063, valid_loss 0.993189, train_metric nan, valid_metric 0.077668
[4142451:MainThread](2024-04-06 16:23:04,102) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.989339, valid_loss 0.994805, train_metric nan, valid_metric 0.067127
[4142451:MainThread](2024-04-06 16:23:04,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.991342, valid_loss 0.995478, train_metric nan, valid_metric 0.071460
[4142451:MainThread](2024-04-06 16:23:04,386) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.981331, valid_loss 0.994434, train_metric nan, valid_metric 0.073749
[4142451:MainThread](2024-04-06 16:23:04,524) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.972481, valid_loss 0.993600, train_metric nan, valid_metric 0.072747
[4142451:MainThread](2024-04-06 16:23:04,669) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.981599, valid_loss 0.990530, train_metric nan, valid_metric 0.086353
[4142451:MainThread](2024-04-06 16:23:04,669) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991244 to 0.990530, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:04,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.975117, valid_loss 0.992830, train_metric nan, valid_metric 0.080761
[4142451:MainThread](2024-04-06 16:23:04,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.994221, valid_loss 0.991896, train_metric nan, valid_metric 0.081204
[4142451:MainThread](2024-04-06 16:23:05,091) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.989366, valid_loss 0.993878, train_metric nan, valid_metric 0.072918
[4142451:MainThread](2024-04-06 16:23:05,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.988040, valid_loss 0.997472, train_metric nan, valid_metric 0.055037
[4142451:MainThread](2024-04-06 16:23:05,369) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.981138, valid_loss 0.992472, train_metric nan, valid_metric 0.080088
[4142451:MainThread](2024-04-06 16:23:05,510) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.981582, valid_loss 0.996625, train_metric nan, valid_metric 0.060664
[4142451:MainThread](2024-04-06 16:23:05,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.975956, valid_loss 0.991362, train_metric nan, valid_metric 0.084692
[4142451:MainThread](2024-04-06 16:23:05,804) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.981889, valid_loss 0.993193, train_metric nan, valid_metric 0.076628
[4142451:MainThread](2024-04-06 16:23:05,967) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.982547, valid_loss 0.995078, train_metric nan, valid_metric 0.072906
[4142451:MainThread](2024-04-06 16:23:06,108) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.987066, valid_loss 0.993718, train_metric nan, valid_metric 0.076907
[4142451:MainThread](2024-04-06 16:23:06,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.985122, valid_loss 0.997699, train_metric nan, valid_metric 0.054260
[4142451:MainThread](2024-04-06 16:23:06,394) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.985562, valid_loss 0.994381, train_metric nan, valid_metric 0.067470
[4142451:MainThread](2024-04-06 16:23:06,561) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.988527, valid_loss 0.993340, train_metric nan, valid_metric 0.070647
[4142451:MainThread](2024-04-06 16:23:06,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.994036, valid_loss 0.993043, train_metric nan, valid_metric 0.073209
[4142451:MainThread](2024-04-06 16:23:06,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.986750, valid_loss 0.992908, train_metric nan, valid_metric 0.077448
[4142451:MainThread](2024-04-06 16:23:06,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.984628, valid_loss 0.994982, train_metric nan, valid_metric 0.068226
[4142451:MainThread](2024-04-06 16:23:07,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.988012, valid_loss 0.992420, train_metric nan, valid_metric 0.077635
[4142451:MainThread](2024-04-06 16:23:07,278) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.976103, valid_loss 0.993539, train_metric nan, valid_metric 0.073863
[4142451:MainThread](2024-04-06 16:23:07,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.987900, valid_loss 0.993066, train_metric nan, valid_metric 0.073734
[4142451:MainThread](2024-04-06 16:23:07,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.977351, valid_loss 0.993875, train_metric nan, valid_metric 0.071823
[4142451:MainThread](2024-04-06 16:23:07,799) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.989215, valid_loss 0.991826, train_metric nan, valid_metric 0.074107
[4142451:MainThread](2024-04-06 16:23:07,968) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.981680, valid_loss 0.993321, train_metric nan, valid_metric 0.072402
[4142451:MainThread](2024-04-06 16:23:08,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.971462, valid_loss 0.991921, train_metric nan, valid_metric 0.080739
[4142451:MainThread](2024-04-06 16:23:08,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.984035, valid_loss 0.995600, train_metric nan, valid_metric 0.065549
[4142451:MainThread](2024-04-06 16:23:08,386) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.973447, valid_loss 0.995579, train_metric nan, valid_metric 0.066539
[4142451:MainThread](2024-04-06 16:23:08,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.982881, valid_loss 0.993478, train_metric nan, valid_metric 0.074026
[4142451:MainThread](2024-04-06 16:23:08,651) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.989380, valid_loss 0.992119, train_metric nan, valid_metric 0.077200
[4142451:MainThread](2024-04-06 16:23:08,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.979063, valid_loss 0.992833, train_metric nan, valid_metric 0.073043
[4142451:MainThread](2024-04-06 16:23:08,935) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.989365, valid_loss 0.994298, train_metric nan, valid_metric 0.070901
[4142451:MainThread](2024-04-06 16:23:09,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.985367, valid_loss 0.993352, train_metric nan, valid_metric 0.073560
[4142451:MainThread](2024-04-06 16:23:09,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.986875, valid_loss 0.993113, train_metric nan, valid_metric 0.072726
[4142451:MainThread](2024-04-06 16:23:09,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.981625, valid_loss 0.992930, train_metric nan, valid_metric 0.074011
[4142451:MainThread](2024-04-06 16:23:09,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.970918, valid_loss 0.994996, train_metric nan, valid_metric 0.067792
[4142451:MainThread](2024-04-06 16:23:09,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.980176, valid_loss 0.994912, train_metric nan, valid_metric 0.070368
[4142451:MainThread](2024-04-06 16:23:09,796) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.987725, valid_loss 0.995064, train_metric nan, valid_metric 0.068631
[4142451:MainThread](2024-04-06 16:23:09,935) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.995152, valid_loss 0.993019, train_metric nan, valid_metric 0.076971
[4142451:MainThread](2024-04-06 16:23:10,067) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.978874, valid_loss 0.993259, train_metric nan, valid_metric 0.073328
[4142451:MainThread](2024-04-06 16:23:10,196) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.977418, valid_loss 0.993590, train_metric nan, valid_metric 0.072431
[4142451:MainThread](2024-04-06 16:23:10,322) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.981510, valid_loss 0.994070, train_metric nan, valid_metric 0.071660
[4142451:MainThread](2024-04-06 16:23:10,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.974947, valid_loss 0.995576, train_metric nan, valid_metric 0.065691
[4142451:MainThread](2024-04-06 16:23:10,602) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.980811, valid_loss 0.995422, train_metric nan, valid_metric 0.066280
[4142451:MainThread](2024-04-06 16:23:10,746) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.984898, valid_loss 0.994815, train_metric nan, valid_metric 0.060823
[4142451:MainThread](2024-04-06 16:23:10,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.977355, valid_loss 0.992683, train_metric nan, valid_metric 0.073650
[4142451:MainThread](2024-04-06 16:23:11,021) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.977345, valid_loss 0.992882, train_metric nan, valid_metric 0.072063
[4142451:MainThread](2024-04-06 16:23:11,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.986108, valid_loss 0.994574, train_metric nan, valid_metric 0.068408
[4142451:MainThread](2024-04-06 16:23:11,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.986836, valid_loss 0.994652, train_metric nan, valid_metric 0.068968
[4142451:MainThread](2024-04-06 16:23:11,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.985060, valid_loss 0.992438, train_metric nan, valid_metric 0.078774
[4142451:MainThread](2024-04-06 16:23:11,585) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.982695, valid_loss 0.994432, train_metric nan, valid_metric 0.070756
[4142451:MainThread](2024-04-06 16:23:11,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.985087, valid_loss 0.994303, train_metric nan, valid_metric 0.068814
[4142451:MainThread](2024-04-06 16:23:11,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.984232, valid_loss 0.994123, train_metric nan, valid_metric 0.071520
[4142451:MainThread](2024-04-06 16:23:11,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:23:12,691) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:23:13,565) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  19%|█▉        | 10/52 [03:37<14:26, 20.64s/it][4142451:MainThread](2024-04-06 16:23:13,574) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:23:13,583) INFO - qlib.workflow - [recorder.py:341] - Recorder 0153c15684534dbb8f99c90beb32c4c6 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:23:14,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:23:14,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:23:14,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:23:14,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:23:17,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:23:18,146) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.260013, valid_loss 1.040529, train_metric nan, valid_metric 0.050921
[4142451:MainThread](2024-04-06 16:23:18,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.040529, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:23:18,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.121195, valid_loss 1.028177, train_metric nan, valid_metric 0.041950
[4142451:MainThread](2024-04-06 16:23:18,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.040529 to 1.028177, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:18,433) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.066808, valid_loss 1.033238, train_metric nan, valid_metric 0.023416
[4142451:MainThread](2024-04-06 16:23:18,581) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.088555, valid_loss 1.017718, train_metric nan, valid_metric 0.036990
[4142451:MainThread](2024-04-06 16:23:18,581) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.028177 to 1.017718, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:18,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.096016, valid_loss 1.030779, train_metric nan, valid_metric 0.020042
[4142451:MainThread](2024-04-06 16:23:18,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.045063, valid_loss 1.003229, train_metric nan, valid_metric 0.051009
[4142451:MainThread](2024-04-06 16:23:18,876) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.017718 to 1.003229, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:19,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.026726, valid_loss 1.004018, train_metric nan, valid_metric 0.039369
[4142451:MainThread](2024-04-06 16:23:19,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.030521, valid_loss 1.006670, train_metric nan, valid_metric 0.054630
[4142451:MainThread](2024-04-06 16:23:19,278) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.017788, valid_loss 0.999822, train_metric nan, valid_metric 0.065659
[4142451:MainThread](2024-04-06 16:23:19,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003229 to 0.999822, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:19,415) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.012952, valid_loss 1.002170, train_metric nan, valid_metric 0.064811
[4142451:MainThread](2024-04-06 16:23:19,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.003244, valid_loss 0.997068, train_metric nan, valid_metric 0.061686
[4142451:MainThread](2024-04-06 16:23:19,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999822 to 0.997068, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:19,705) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.050123, valid_loss 1.011556, train_metric nan, valid_metric 0.049916
[4142451:MainThread](2024-04-06 16:23:19,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.006876, valid_loss 1.000400, train_metric nan, valid_metric 0.061001
[4142451:MainThread](2024-04-06 16:23:19,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.002530, valid_loss 1.019220, train_metric nan, valid_metric 0.075168
[4142451:MainThread](2024-04-06 16:23:20,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.013609, valid_loss 1.011829, train_metric nan, valid_metric 0.051172
[4142451:MainThread](2024-04-06 16:23:20,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.001314, valid_loss 0.994682, train_metric nan, valid_metric 0.070817
[4142451:MainThread](2024-04-06 16:23:20,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997068 to 0.994682, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:20,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.004853, valid_loss 0.991896, train_metric nan, valid_metric 0.076171
[4142451:MainThread](2024-04-06 16:23:20,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994682 to 0.991896, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:20,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.996522, valid_loss 0.994609, train_metric nan, valid_metric 0.075360
[4142451:MainThread](2024-04-06 16:23:20,705) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.009933, valid_loss 0.992165, train_metric nan, valid_metric 0.074119
[4142451:MainThread](2024-04-06 16:23:20,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.006521, valid_loss 0.997650, train_metric nan, valid_metric 0.066483
[4142451:MainThread](2024-04-06 16:23:21,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.000376, valid_loss 0.993878, train_metric nan, valid_metric 0.076233
[4142451:MainThread](2024-04-06 16:23:21,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.987841, valid_loss 0.996337, train_metric nan, valid_metric 0.085115
[4142451:MainThread](2024-04-06 16:23:21,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.992971, valid_loss 0.997603, train_metric nan, valid_metric 0.077974
[4142451:MainThread](2024-04-06 16:23:21,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.986926, valid_loss 1.000746, train_metric nan, valid_metric 0.065540
[4142451:MainThread](2024-04-06 16:23:21,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.987588, valid_loss 0.992687, train_metric nan, valid_metric 0.073835
[4142451:MainThread](2024-04-06 16:23:21,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.985867, valid_loss 0.995751, train_metric nan, valid_metric 0.060423
[4142451:MainThread](2024-04-06 16:23:21,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.999679, valid_loss 0.994932, train_metric nan, valid_metric 0.063150
[4142451:MainThread](2024-04-06 16:23:22,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.998734, valid_loss 0.990210, train_metric nan, valid_metric 0.087625
[4142451:MainThread](2024-04-06 16:23:22,064) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991896 to 0.990210, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:22,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.984928, valid_loss 0.993827, train_metric nan, valid_metric 0.069550
[4142451:MainThread](2024-04-06 16:23:22,350) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.998867, valid_loss 0.993991, train_metric nan, valid_metric 0.070719
[4142451:MainThread](2024-04-06 16:23:22,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.984626, valid_loss 0.995798, train_metric nan, valid_metric 0.075341
[4142451:MainThread](2024-04-06 16:23:22,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.984803, valid_loss 0.994404, train_metric nan, valid_metric 0.069132
[4142451:MainThread](2024-04-06 16:23:22,779) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.987758, valid_loss 0.991902, train_metric nan, valid_metric 0.078746
[4142451:MainThread](2024-04-06 16:23:22,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.983684, valid_loss 0.994393, train_metric nan, valid_metric 0.070669
[4142451:MainThread](2024-04-06 16:23:23,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.989798, valid_loss 0.993191, train_metric nan, valid_metric 0.074653
[4142451:MainThread](2024-04-06 16:23:23,227) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.985964, valid_loss 0.992667, train_metric nan, valid_metric 0.069437
[4142451:MainThread](2024-04-06 16:23:23,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.986716, valid_loss 0.997726, train_metric nan, valid_metric 0.074139
[4142451:MainThread](2024-04-06 16:23:23,577) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.987495, valid_loss 0.991709, train_metric nan, valid_metric 0.080834
[4142451:MainThread](2024-04-06 16:23:23,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.984266, valid_loss 0.993617, train_metric nan, valid_metric 0.069303
[4142451:MainThread](2024-04-06 16:23:23,899) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.976241, valid_loss 0.993556, train_metric nan, valid_metric 0.071780
[4142451:MainThread](2024-04-06 16:23:24,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.983334, valid_loss 0.992395, train_metric nan, valid_metric 0.074921
[4142451:MainThread](2024-04-06 16:23:24,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.984627, valid_loss 0.992058, train_metric nan, valid_metric 0.077325
[4142451:MainThread](2024-04-06 16:23:24,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.993464, valid_loss 0.993474, train_metric nan, valid_metric 0.077046
[4142451:MainThread](2024-04-06 16:23:24,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.986646, valid_loss 0.994659, train_metric nan, valid_metric 0.067395
[4142451:MainThread](2024-04-06 16:23:24,586) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.983767, valid_loss 0.993660, train_metric nan, valid_metric 0.068624
[4142451:MainThread](2024-04-06 16:23:24,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.993583, valid_loss 0.994136, train_metric nan, valid_metric 0.073742
[4142451:MainThread](2024-04-06 16:23:24,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.980762, valid_loss 0.991348, train_metric nan, valid_metric 0.080702
[4142451:MainThread](2024-04-06 16:23:25,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.988415, valid_loss 0.991371, train_metric nan, valid_metric 0.078942
[4142451:MainThread](2024-04-06 16:23:25,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.986667, valid_loss 0.992509, train_metric nan, valid_metric 0.074645
[4142451:MainThread](2024-04-06 16:23:25,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.989920, valid_loss 0.992893, train_metric nan, valid_metric 0.066963
[4142451:MainThread](2024-04-06 16:23:25,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.990530, valid_loss 0.993266, train_metric nan, valid_metric 0.068642
[4142451:MainThread](2024-04-06 16:23:25,603) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.992242, valid_loss 0.993636, train_metric nan, valid_metric 0.069794
[4142451:MainThread](2024-04-06 16:23:25,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.976557, valid_loss 0.993311, train_metric nan, valid_metric 0.074471
[4142451:MainThread](2024-04-06 16:23:25,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.987021, valid_loss 0.992484, train_metric nan, valid_metric 0.074357
[4142451:MainThread](2024-04-06 16:23:26,030) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.981633, valid_loss 0.991868, train_metric nan, valid_metric 0.077543
[4142451:MainThread](2024-04-06 16:23:26,172) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.979268, valid_loss 0.992687, train_metric nan, valid_metric 0.073674
[4142451:MainThread](2024-04-06 16:23:26,316) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.989326, valid_loss 0.991404, train_metric nan, valid_metric 0.080966
[4142451:MainThread](2024-04-06 16:23:26,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.977656, valid_loss 0.992386, train_metric nan, valid_metric 0.077124
[4142451:MainThread](2024-04-06 16:23:26,628) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.982874, valid_loss 0.992899, train_metric nan, valid_metric 0.074502
[4142451:MainThread](2024-04-06 16:23:26,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.983339, valid_loss 0.993767, train_metric nan, valid_metric 0.067537
[4142451:MainThread](2024-04-06 16:23:26,957) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.975093, valid_loss 0.994022, train_metric nan, valid_metric 0.069793
[4142451:MainThread](2024-04-06 16:23:27,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.980038, valid_loss 0.992723, train_metric nan, valid_metric 0.072084
[4142451:MainThread](2024-04-06 16:23:27,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.995679, valid_loss 0.992671, train_metric nan, valid_metric 0.074342
[4142451:MainThread](2024-04-06 16:23:27,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.982135, valid_loss 0.992831, train_metric nan, valid_metric 0.071549
[4142451:MainThread](2024-04-06 16:23:27,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.977811, valid_loss 0.992729, train_metric nan, valid_metric 0.071018
[4142451:MainThread](2024-04-06 16:23:27,661) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.974524, valid_loss 0.992226, train_metric nan, valid_metric 0.078115
[4142451:MainThread](2024-04-06 16:23:27,793) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.979020, valid_loss 0.993105, train_metric nan, valid_metric 0.072646
[4142451:MainThread](2024-04-06 16:23:27,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.987600, valid_loss 0.992262, train_metric nan, valid_metric 0.070954
[4142451:MainThread](2024-04-06 16:23:28,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.977660, valid_loss 0.992229, train_metric nan, valid_metric 0.076263
[4142451:MainThread](2024-04-06 16:23:28,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.979525, valid_loss 0.992036, train_metric nan, valid_metric 0.077732
[4142451:MainThread](2024-04-06 16:23:28,328) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.992033, valid_loss 0.992812, train_metric nan, valid_metric 0.073530
[4142451:MainThread](2024-04-06 16:23:28,471) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.988161, valid_loss 0.992998, train_metric nan, valid_metric 0.074294
[4142451:MainThread](2024-04-06 16:23:28,611) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.994057, valid_loss 0.992597, train_metric nan, valid_metric 0.073929
[4142451:MainThread](2024-04-06 16:23:28,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.992428, valid_loss 0.993736, train_metric nan, valid_metric 0.069433
[4142451:MainThread](2024-04-06 16:23:28,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.980024, valid_loss 0.993559, train_metric nan, valid_metric 0.068851
[4142451:MainThread](2024-04-06 16:23:29,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.984883, valid_loss 0.993561, train_metric nan, valid_metric 0.071593
[4142451:MainThread](2024-04-06 16:23:29,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.983551, valid_loss 0.994193, train_metric nan, valid_metric 0.069867
[4142451:MainThread](2024-04-06 16:23:29,386) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.975669, valid_loss 0.993201, train_metric nan, valid_metric 0.074794
[4142451:MainThread](2024-04-06 16:23:29,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:23:30,207) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:23:31,069) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  21%|██        | 11/52 [03:55<13:26, 19.68s/it][4142451:MainThread](2024-04-06 16:23:31,077) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:23:31,086) INFO - qlib.workflow - [recorder.py:341] - Recorder 5303bbfad59849a0ac451592e997cc4d starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:23:31,690) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:23:31,691) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:23:31,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:23:31,696) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:23:35,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:23:35,400) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.326088, valid_loss 1.152182, train_metric nan, valid_metric 0.022046
[4142451:MainThread](2024-04-06 16:23:35,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.152182, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:23:35,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.118575, valid_loss 1.027114, train_metric nan, valid_metric 0.063886
[4142451:MainThread](2024-04-06 16:23:35,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.152182 to 1.027114, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:35,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.048807, valid_loss 1.031195, train_metric nan, valid_metric 0.052010
[4142451:MainThread](2024-04-06 16:23:35,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.060970, valid_loss 1.021443, train_metric nan, valid_metric 0.041605
[4142451:MainThread](2024-04-06 16:23:35,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.027114 to 1.021443, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:35,968) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.047353, valid_loss 0.994916, train_metric nan, valid_metric 0.081703
[4142451:MainThread](2024-04-06 16:23:35,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.021443 to 0.994916, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:36,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.037310, valid_loss 0.991623, train_metric nan, valid_metric 0.085210
[4142451:MainThread](2024-04-06 16:23:36,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994916 to 0.991623, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:36,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.026906, valid_loss 1.025536, train_metric nan, valid_metric 0.096766
[4142451:MainThread](2024-04-06 16:23:36,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.014642, valid_loss 1.017736, train_metric nan, valid_metric 0.094663
[4142451:MainThread](2024-04-06 16:23:36,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.011242, valid_loss 1.005398, train_metric nan, valid_metric 0.073508
[4142451:MainThread](2024-04-06 16:23:36,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.023245, valid_loss 1.008335, train_metric nan, valid_metric 0.065376
[4142451:MainThread](2024-04-06 16:23:36,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.023588, valid_loss 0.999481, train_metric nan, valid_metric 0.093588
[4142451:MainThread](2024-04-06 16:23:36,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.013812, valid_loss 0.991770, train_metric nan, valid_metric 0.095672
[4142451:MainThread](2024-04-06 16:23:37,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.003723, valid_loss 0.995174, train_metric nan, valid_metric 0.086290
[4142451:MainThread](2024-04-06 16:23:37,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.012374, valid_loss 0.997872, train_metric nan, valid_metric 0.065332
[4142451:MainThread](2024-04-06 16:23:37,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.007199, valid_loss 1.010725, train_metric nan, valid_metric 0.052513
[4142451:MainThread](2024-04-06 16:23:37,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.011928, valid_loss 0.992248, train_metric nan, valid_metric 0.085613
[4142451:MainThread](2024-04-06 16:23:37,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.013341, valid_loss 0.999249, train_metric nan, valid_metric 0.087662
[4142451:MainThread](2024-04-06 16:23:37,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.994589, valid_loss 0.990518, train_metric nan, valid_metric 0.086129
[4142451:MainThread](2024-04-06 16:23:37,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991623 to 0.990518, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:38,183) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.993938, valid_loss 0.991404, train_metric nan, valid_metric 0.092654
[4142451:MainThread](2024-04-06 16:23:38,353) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.006162, valid_loss 0.991866, train_metric nan, valid_metric 0.081350
[4142451:MainThread](2024-04-06 16:23:38,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.996593, valid_loss 0.994885, train_metric nan, valid_metric 0.072395
[4142451:MainThread](2024-04-06 16:23:38,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.995685, valid_loss 0.988103, train_metric nan, valid_metric 0.097298
[4142451:MainThread](2024-04-06 16:23:38,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990518 to 0.988103, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:38,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.997954, valid_loss 0.990399, train_metric nan, valid_metric 0.093019
[4142451:MainThread](2024-04-06 16:23:39,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.996353, valid_loss 0.992318, train_metric nan, valid_metric 0.087734
[4142451:MainThread](2024-04-06 16:23:39,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.996639, valid_loss 0.992393, train_metric nan, valid_metric 0.080382
[4142451:MainThread](2024-04-06 16:23:39,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.989894, valid_loss 0.990546, train_metric nan, valid_metric 0.092556
[4142451:MainThread](2024-04-06 16:23:39,442) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.991079, valid_loss 0.995216, train_metric nan, valid_metric 0.075663
[4142451:MainThread](2024-04-06 16:23:39,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.992026, valid_loss 0.994577, train_metric nan, valid_metric 0.085178
[4142451:MainThread](2024-04-06 16:23:39,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.993119, valid_loss 0.989243, train_metric nan, valid_metric 0.093092
[4142451:MainThread](2024-04-06 16:23:39,962) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.996972, valid_loss 0.991657, train_metric nan, valid_metric 0.084913
[4142451:MainThread](2024-04-06 16:23:40,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.991141, valid_loss 0.989361, train_metric nan, valid_metric 0.090471
[4142451:MainThread](2024-04-06 16:23:40,281) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.991619, valid_loss 0.990318, train_metric nan, valid_metric 0.095806
[4142451:MainThread](2024-04-06 16:23:40,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.989302, valid_loss 0.992833, train_metric nan, valid_metric 0.086875
[4142451:MainThread](2024-04-06 16:23:40,611) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.991113, valid_loss 0.990901, train_metric nan, valid_metric 0.088079
[4142451:MainThread](2024-04-06 16:23:40,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.995907, valid_loss 0.990398, train_metric nan, valid_metric 0.087578
[4142451:MainThread](2024-04-06 16:23:40,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.990260, valid_loss 0.990756, train_metric nan, valid_metric 0.091943
[4142451:MainThread](2024-04-06 16:23:41,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.988830, valid_loss 0.991961, train_metric nan, valid_metric 0.082310
[4142451:MainThread](2024-04-06 16:23:41,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.982674, valid_loss 0.991652, train_metric nan, valid_metric 0.083646
[4142451:MainThread](2024-04-06 16:23:41,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.993768, valid_loss 0.989924, train_metric nan, valid_metric 0.090313
[4142451:MainThread](2024-04-06 16:23:41,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.983805, valid_loss 0.991411, train_metric nan, valid_metric 0.090471
[4142451:MainThread](2024-04-06 16:23:41,633) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.988792, valid_loss 0.989291, train_metric nan, valid_metric 0.092527
[4142451:MainThread](2024-04-06 16:23:41,835) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.983936, valid_loss 0.989845, train_metric nan, valid_metric 0.088433
[4142451:MainThread](2024-04-06 16:23:41,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.982201, valid_loss 0.990302, train_metric nan, valid_metric 0.087520
[4142451:MainThread](2024-04-06 16:23:42,108) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.989823, valid_loss 0.989060, train_metric nan, valid_metric 0.091148
[4142451:MainThread](2024-04-06 16:23:42,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.982587, valid_loss 0.990300, train_metric nan, valid_metric 0.082312
[4142451:MainThread](2024-04-06 16:23:42,349) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.986082, valid_loss 0.988713, train_metric nan, valid_metric 0.093852
[4142451:MainThread](2024-04-06 16:23:42,496) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.991392, valid_loss 0.988567, train_metric nan, valid_metric 0.096592
[4142451:MainThread](2024-04-06 16:23:42,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.991513, valid_loss 0.990169, train_metric nan, valid_metric 0.092281
[4142451:MainThread](2024-04-06 16:23:42,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.991507, valid_loss 0.990112, train_metric nan, valid_metric 0.091117
[4142451:MainThread](2024-04-06 16:23:42,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.987781, valid_loss 0.989954, train_metric nan, valid_metric 0.092853
[4142451:MainThread](2024-04-06 16:23:43,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.989058, valid_loss 0.987755, train_metric nan, valid_metric 0.100807
[4142451:MainThread](2024-04-06 16:23:43,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.988103 to 0.987755, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:43,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.981103, valid_loss 0.990531, train_metric nan, valid_metric 0.093803
[4142451:MainThread](2024-04-06 16:23:43,326) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.981524, valid_loss 0.989383, train_metric nan, valid_metric 0.090000
[4142451:MainThread](2024-04-06 16:23:43,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.983770, valid_loss 0.988481, train_metric nan, valid_metric 0.097043
[4142451:MainThread](2024-04-06 16:23:43,608) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.991060, valid_loss 0.988311, train_metric nan, valid_metric 0.098160
[4142451:MainThread](2024-04-06 16:23:43,743) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.985954, valid_loss 0.988668, train_metric nan, valid_metric 0.095363
[4142451:MainThread](2024-04-06 16:23:43,878) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.995828, valid_loss 0.989485, train_metric nan, valid_metric 0.092089
[4142451:MainThread](2024-04-06 16:23:44,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.992690, valid_loss 0.990636, train_metric nan, valid_metric 0.087420
[4142451:MainThread](2024-04-06 16:23:44,154) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.984593, valid_loss 0.988909, train_metric nan, valid_metric 0.092747
[4142451:MainThread](2024-04-06 16:23:44,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.990956, valid_loss 0.989101, train_metric nan, valid_metric 0.092638
[4142451:MainThread](2024-04-06 16:23:44,452) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.979557, valid_loss 0.989124, train_metric nan, valid_metric 0.094095
[4142451:MainThread](2024-04-06 16:23:44,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.985682, valid_loss 0.990911, train_metric nan, valid_metric 0.086283
[4142451:MainThread](2024-04-06 16:23:44,738) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.979287, valid_loss 0.991702, train_metric nan, valid_metric 0.078596
[4142451:MainThread](2024-04-06 16:23:44,882) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.980146, valid_loss 0.989806, train_metric nan, valid_metric 0.092781
[4142451:MainThread](2024-04-06 16:23:45,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.983002, valid_loss 0.989060, train_metric nan, valid_metric 0.094071
[4142451:MainThread](2024-04-06 16:23:45,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.987306, valid_loss 0.989261, train_metric nan, valid_metric 0.092435
[4142451:MainThread](2024-04-06 16:23:45,325) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.987678, valid_loss 0.990370, train_metric nan, valid_metric 0.087909
[4142451:MainThread](2024-04-06 16:23:45,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.985037, valid_loss 0.990769, train_metric nan, valid_metric 0.084781
[4142451:MainThread](2024-04-06 16:23:45,598) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.991824, valid_loss 0.990040, train_metric nan, valid_metric 0.090656
[4142451:MainThread](2024-04-06 16:23:45,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.988927, valid_loss 0.990450, train_metric nan, valid_metric 0.087427
[4142451:MainThread](2024-04-06 16:23:45,910) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.981303, valid_loss 0.991161, train_metric nan, valid_metric 0.084356
[4142451:MainThread](2024-04-06 16:23:46,073) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.982072, valid_loss 0.990021, train_metric nan, valid_metric 0.088610
[4142451:MainThread](2024-04-06 16:23:46,227) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.988003, valid_loss 0.990733, train_metric nan, valid_metric 0.084983
[4142451:MainThread](2024-04-06 16:23:46,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.987102, valid_loss 0.990440, train_metric nan, valid_metric 0.087558
[4142451:MainThread](2024-04-06 16:23:46,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.985885, valid_loss 0.989577, train_metric nan, valid_metric 0.093037
[4142451:MainThread](2024-04-06 16:23:46,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.987179, valid_loss 0.989914, train_metric nan, valid_metric 0.087771
[4142451:MainThread](2024-04-06 16:23:46,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.976088, valid_loss 0.989634, train_metric nan, valid_metric 0.091492
[4142451:MainThread](2024-04-06 16:23:46,914) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.984647, valid_loss 0.989772, train_metric nan, valid_metric 0.089181
[4142451:MainThread](2024-04-06 16:23:47,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.979650, valid_loss 0.989799, train_metric nan, valid_metric 0.089425
[4142451:MainThread](2024-04-06 16:23:47,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.979381, valid_loss 0.990253, train_metric nan, valid_metric 0.092195
[4142451:MainThread](2024-04-06 16:23:47,344) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.977310, valid_loss 0.989567, train_metric nan, valid_metric 0.090933
[4142451:MainThread](2024-04-06 16:23:47,511) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.982075, valid_loss 0.990348, train_metric nan, valid_metric 0.087687
[4142451:MainThread](2024-04-06 16:23:47,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.986035, valid_loss 0.990047, train_metric nan, valid_metric 0.087730
[4142451:MainThread](2024-04-06 16:23:47,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.998435, valid_loss 0.989333, train_metric nan, valid_metric 0.098199
[4142451:MainThread](2024-04-06 16:23:48,014) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.978912, valid_loss 0.988778, train_metric nan, valid_metric 0.094747
[4142451:MainThread](2024-04-06 16:23:48,183) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.987721, valid_loss 0.989312, train_metric nan, valid_metric 0.092564
[4142451:MainThread](2024-04-06 16:23:48,336) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.985464, valid_loss 0.990569, train_metric nan, valid_metric 0.086083
[4142451:MainThread](2024-04-06 16:23:48,492) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.975724, valid_loss 0.990272, train_metric nan, valid_metric 0.084135
[4142451:MainThread](2024-04-06 16:23:48,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.979793, valid_loss 0.989150, train_metric nan, valid_metric 0.093162
[4142451:MainThread](2024-04-06 16:23:48,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.980429, valid_loss 0.989821, train_metric nan, valid_metric 0.089639
[4142451:MainThread](2024-04-06 16:23:48,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.986533, valid_loss 0.990228, train_metric nan, valid_metric 0.087804
[4142451:MainThread](2024-04-06 16:23:49,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.978554, valid_loss 0.990111, train_metric nan, valid_metric 0.088116
[4142451:MainThread](2024-04-06 16:23:49,263) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.985153, valid_loss 0.988673, train_metric nan, valid_metric 0.096369
[4142451:MainThread](2024-04-06 16:23:49,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.982100, valid_loss 0.989646, train_metric nan, valid_metric 0.090130
[4142451:MainThread](2024-04-06 16:23:49,599) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.982586, valid_loss 0.989943, train_metric nan, valid_metric 0.087885
[4142451:MainThread](2024-04-06 16:23:49,782) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.979904, valid_loss 0.990167, train_metric nan, valid_metric 0.086020
[4142451:MainThread](2024-04-06 16:23:49,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.976073, valid_loss 0.989467, train_metric nan, valid_metric 0.091319
[4142451:MainThread](2024-04-06 16:23:50,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.981326, valid_loss 0.990164, train_metric nan, valid_metric 0.087534
[4142451:MainThread](2024-04-06 16:23:50,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.974607, valid_loss 0.990503, train_metric nan, valid_metric 0.086029
[4142451:MainThread](2024-04-06 16:23:50,366) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.994076, valid_loss 0.988763, train_metric nan, valid_metric 0.094848
[4142451:MainThread](2024-04-06 16:23:50,504) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.973551, valid_loss 0.989464, train_metric nan, valid_metric 0.092120
[4142451:MainThread](2024-04-06 16:23:50,504) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:23:51,346) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:23:52,227) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  23%|██▎       | 12/52 [04:16<13:25, 20.13s/it][4142451:MainThread](2024-04-06 16:23:52,246) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:23:52,255) INFO - qlib.workflow - [recorder.py:341] - Recorder dfc20677a10b4681b8f3307925bb2712 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:23:52,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:23:52,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:23:52,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:23:52,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:23:56,696) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:23:56,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.203102, valid_loss 1.020580, train_metric nan, valid_metric 0.078627
[4142451:MainThread](2024-04-06 16:23:56,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.020580, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:23:57,140) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.084247, valid_loss 1.028420, train_metric nan, valid_metric 0.069048
[4142451:MainThread](2024-04-06 16:23:57,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.062295, valid_loss 0.994153, train_metric nan, valid_metric 0.088458
[4142451:MainThread](2024-04-06 16:23:57,285) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.020580 to 0.994153, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:57,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.060971, valid_loss 1.004471, train_metric nan, valid_metric 0.069201
[4142451:MainThread](2024-04-06 16:23:57,569) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.039982, valid_loss 1.019543, train_metric nan, valid_metric 0.082967
[4142451:MainThread](2024-04-06 16:23:57,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.043519, valid_loss 1.003677, train_metric nan, valid_metric 0.084419
[4142451:MainThread](2024-04-06 16:23:57,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.119737, valid_loss 1.049859, train_metric nan, valid_metric 0.082060
[4142451:MainThread](2024-04-06 16:23:57,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.022002, valid_loss 0.991870, train_metric nan, valid_metric 0.087759
[4142451:MainThread](2024-04-06 16:23:57,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994153 to 0.991870, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:58,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.017811, valid_loss 0.998279, train_metric nan, valid_metric 0.061299
[4142451:MainThread](2024-04-06 16:23:58,243) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 0.994907, valid_loss 1.000996, train_metric nan, valid_metric 0.095152
[4142451:MainThread](2024-04-06 16:23:58,385) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.019731, valid_loss 0.995514, train_metric nan, valid_metric 0.092978
[4142451:MainThread](2024-04-06 16:23:58,527) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.004778, valid_loss 0.990743, train_metric nan, valid_metric 0.091233
[4142451:MainThread](2024-04-06 16:23:58,528) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991870 to 0.990743, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:58,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.010669, valid_loss 0.986668, train_metric nan, valid_metric 0.105843
[4142451:MainThread](2024-04-06 16:23:58,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990743 to 0.986668, save checkpoint.
[4142451:MainThread](2024-04-06 16:23:58,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.011313, valid_loss 0.990257, train_metric nan, valid_metric 0.085786
[4142451:MainThread](2024-04-06 16:23:59,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.010321, valid_loss 0.995211, train_metric nan, valid_metric 0.088505
[4142451:MainThread](2024-04-06 16:23:59,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.010060, valid_loss 1.003341, train_metric nan, valid_metric 0.087479
[4142451:MainThread](2024-04-06 16:23:59,306) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.999138, valid_loss 0.990318, train_metric nan, valid_metric 0.104673
[4142451:MainThread](2024-04-06 16:23:59,463) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.005003, valid_loss 0.998516, train_metric nan, valid_metric 0.084188
[4142451:MainThread](2024-04-06 16:23:59,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.031981, valid_loss 1.030001, train_metric nan, valid_metric 0.077925
[4142451:MainThread](2024-04-06 16:23:59,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.004000, valid_loss 0.991178, train_metric nan, valid_metric 0.100077
[4142451:MainThread](2024-04-06 16:23:59,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.998616, valid_loss 0.988272, train_metric nan, valid_metric 0.093518
[4142451:MainThread](2024-04-06 16:24:00,058) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.002760, valid_loss 1.000900, train_metric nan, valid_metric 0.079219
[4142451:MainThread](2024-04-06 16:24:00,203) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.996524, valid_loss 0.987456, train_metric nan, valid_metric 0.097625
[4142451:MainThread](2024-04-06 16:24:00,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.998085, valid_loss 0.986714, train_metric nan, valid_metric 0.104766
[4142451:MainThread](2024-04-06 16:24:00,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.999036, valid_loss 0.987159, train_metric nan, valid_metric 0.104529
[4142451:MainThread](2024-04-06 16:24:00,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.992911, valid_loss 0.986845, train_metric nan, valid_metric 0.102221
[4142451:MainThread](2024-04-06 16:24:00,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.001051, valid_loss 0.987549, train_metric nan, valid_metric 0.098341
[4142451:MainThread](2024-04-06 16:24:00,980) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.988571, valid_loss 0.986107, train_metric nan, valid_metric 0.111328
[4142451:MainThread](2024-04-06 16:24:00,980) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.986668 to 0.986107, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:01,154) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.002371, valid_loss 0.988236, train_metric nan, valid_metric 0.107241
[4142451:MainThread](2024-04-06 16:24:01,307) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.987825, valid_loss 0.987209, train_metric nan, valid_metric 0.101515
[4142451:MainThread](2024-04-06 16:24:01,442) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.989794, valid_loss 0.987803, train_metric nan, valid_metric 0.103919
[4142451:MainThread](2024-04-06 16:24:01,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.995827, valid_loss 0.987468, train_metric nan, valid_metric 0.107557
[4142451:MainThread](2024-04-06 16:24:01,701) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.996048, valid_loss 0.987507, train_metric nan, valid_metric 0.099189
[4142451:MainThread](2024-04-06 16:24:01,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.981841, valid_loss 0.988560, train_metric nan, valid_metric 0.095812
[4142451:MainThread](2024-04-06 16:24:01,984) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.985255, valid_loss 0.988007, train_metric nan, valid_metric 0.103982
[4142451:MainThread](2024-04-06 16:24:02,134) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.984051, valid_loss 0.987239, train_metric nan, valid_metric 0.104403
[4142451:MainThread](2024-04-06 16:24:02,281) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.994775, valid_loss 0.986919, train_metric nan, valid_metric 0.104395
[4142451:MainThread](2024-04-06 16:24:02,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.000569, valid_loss 0.987835, train_metric nan, valid_metric 0.107443
[4142451:MainThread](2024-04-06 16:24:02,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.981590, valid_loss 0.984863, train_metric nan, valid_metric 0.111620
[4142451:MainThread](2024-04-06 16:24:02,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.986107 to 0.984863, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:02,746) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.000601, valid_loss 0.985512, train_metric nan, valid_metric 0.115506
[4142451:MainThread](2024-04-06 16:24:02,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.989286, valid_loss 0.985836, train_metric nan, valid_metric 0.108638
[4142451:MainThread](2024-04-06 16:24:03,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.976868, valid_loss 0.987883, train_metric nan, valid_metric 0.102075
[4142451:MainThread](2024-04-06 16:24:03,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.996715, valid_loss 0.987053, train_metric nan, valid_metric 0.105790
[4142451:MainThread](2024-04-06 16:24:03,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.988432, valid_loss 0.989544, train_metric nan, valid_metric 0.087312
[4142451:MainThread](2024-04-06 16:24:03,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.998052, valid_loss 0.986204, train_metric nan, valid_metric 0.108057
[4142451:MainThread](2024-04-06 16:24:03,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.986213, valid_loss 0.988476, train_metric nan, valid_metric 0.094255
[4142451:MainThread](2024-04-06 16:24:03,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.998831, valid_loss 0.986922, train_metric nan, valid_metric 0.104753
[4142451:MainThread](2024-04-06 16:24:03,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.978948, valid_loss 0.990630, train_metric nan, valid_metric 0.098566
[4142451:MainThread](2024-04-06 16:24:04,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.991263, valid_loss 0.987760, train_metric nan, valid_metric 0.096862
[4142451:MainThread](2024-04-06 16:24:04,175) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.984665, valid_loss 0.986655, train_metric nan, valid_metric 0.101654
[4142451:MainThread](2024-04-06 16:24:04,316) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.984457, valid_loss 0.986207, train_metric nan, valid_metric 0.103948
[4142451:MainThread](2024-04-06 16:24:04,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.981835, valid_loss 0.985812, train_metric nan, valid_metric 0.108167
[4142451:MainThread](2024-04-06 16:24:04,607) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.996371, valid_loss 0.985340, train_metric nan, valid_metric 0.109694
[4142451:MainThread](2024-04-06 16:24:04,741) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.983253, valid_loss 0.987765, train_metric nan, valid_metric 0.101683
[4142451:MainThread](2024-04-06 16:24:04,878) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.994100, valid_loss 0.987481, train_metric nan, valid_metric 0.099221
[4142451:MainThread](2024-04-06 16:24:05,014) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.993527, valid_loss 0.987319, train_metric nan, valid_metric 0.100620
[4142451:MainThread](2024-04-06 16:24:05,153) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.994073, valid_loss 0.987502, train_metric nan, valid_metric 0.105720
[4142451:MainThread](2024-04-06 16:24:05,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.986379, valid_loss 0.987099, train_metric nan, valid_metric 0.100107
[4142451:MainThread](2024-04-06 16:24:05,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.976003, valid_loss 0.987525, train_metric nan, valid_metric 0.099300
[4142451:MainThread](2024-04-06 16:24:05,635) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.991931, valid_loss 0.989244, train_metric nan, valid_metric 0.090399
[4142451:MainThread](2024-04-06 16:24:05,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.973336, valid_loss 0.990144, train_metric nan, valid_metric 0.096509
[4142451:MainThread](2024-04-06 16:24:05,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.976485, valid_loss 0.987206, train_metric nan, valid_metric 0.099751
[4142451:MainThread](2024-04-06 16:24:06,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.991184, valid_loss 0.987089, train_metric nan, valid_metric 0.100890
[4142451:MainThread](2024-04-06 16:24:06,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.991457, valid_loss 0.987330, train_metric nan, valid_metric 0.098435
[4142451:MainThread](2024-04-06 16:24:06,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.987750, valid_loss 0.987321, train_metric nan, valid_metric 0.101568
[4142451:MainThread](2024-04-06 16:24:06,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.974912, valid_loss 0.986599, train_metric nan, valid_metric 0.107353
[4142451:MainThread](2024-04-06 16:24:06,676) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.977351, valid_loss 0.986383, train_metric nan, valid_metric 0.106560
[4142451:MainThread](2024-04-06 16:24:06,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.980125, valid_loss 0.987632, train_metric nan, valid_metric 0.102930
[4142451:MainThread](2024-04-06 16:24:06,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.987600, valid_loss 0.987396, train_metric nan, valid_metric 0.103407
[4142451:MainThread](2024-04-06 16:24:07,108) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.985958, valid_loss 0.986070, train_metric nan, valid_metric 0.106205
[4142451:MainThread](2024-04-06 16:24:07,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.986997, valid_loss 0.985931, train_metric nan, valid_metric 0.106904
[4142451:MainThread](2024-04-06 16:24:07,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.986445, valid_loss 0.987257, train_metric nan, valid_metric 0.101888
[4142451:MainThread](2024-04-06 16:24:07,515) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.980668, valid_loss 0.987015, train_metric nan, valid_metric 0.101699
[4142451:MainThread](2024-04-06 16:24:07,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.984220, valid_loss 0.987467, train_metric nan, valid_metric 0.099376
[4142451:MainThread](2024-04-06 16:24:07,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.986618, valid_loss 0.987361, train_metric nan, valid_metric 0.098967
[4142451:MainThread](2024-04-06 16:24:07,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.985553, valid_loss 0.985795, train_metric nan, valid_metric 0.106758
[4142451:MainThread](2024-04-06 16:24:08,077) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.978891, valid_loss 0.986536, train_metric nan, valid_metric 0.103703
[4142451:MainThread](2024-04-06 16:24:08,233) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.989352, valid_loss 0.987003, train_metric nan, valid_metric 0.104522
[4142451:MainThread](2024-04-06 16:24:08,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.986900, valid_loss 0.987534, train_metric nan, valid_metric 0.100469
[4142451:MainThread](2024-04-06 16:24:08,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.982587, valid_loss 0.987012, train_metric nan, valid_metric 0.101191
[4142451:MainThread](2024-04-06 16:24:08,678) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.975925, valid_loss 0.987800, train_metric nan, valid_metric 0.098833
[4142451:MainThread](2024-04-06 16:24:08,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.976705, valid_loss 0.986267, train_metric nan, valid_metric 0.109847
[4142451:MainThread](2024-04-06 16:24:08,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.988411, valid_loss 0.986172, train_metric nan, valid_metric 0.106189
[4142451:MainThread](2024-04-06 16:24:09,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.983398, valid_loss 0.987090, train_metric nan, valid_metric 0.101135
[4142451:MainThread](2024-04-06 16:24:09,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.978928, valid_loss 0.988140, train_metric nan, valid_metric 0.095968
[4142451:MainThread](2024-04-06 16:24:09,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.986646, valid_loss 0.987593, train_metric nan, valid_metric 0.099134
[4142451:MainThread](2024-04-06 16:24:09,505) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.986789, valid_loss 0.986676, train_metric nan, valid_metric 0.101733
[4142451:MainThread](2024-04-06 16:24:09,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.993961, valid_loss 0.986983, train_metric nan, valid_metric 0.102334
[4142451:MainThread](2024-04-06 16:24:09,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.978202, valid_loss 0.987192, train_metric nan, valid_metric 0.100021
[4142451:MainThread](2024-04-06 16:24:09,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:24:10,716) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
ModuleNotFoundError. CatBoostModel are skipped. (optional: maybe installing CatBoostModel can fix it.)
Epoch   480: reducing learning rate of group 0 to 1.0000e-03.
Epoch   780: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1000: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1220: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1440: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2020-01-02 SH600000   -0.027026
           SH600004    0.063149
           SH600009    0.077094
           SH600010   -0.038895
           SH600011    0.015962
Epoch   560: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1080: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1300: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1520: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1740: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2020-02-07 SH600000   -0.000840
           SH600004    0.110079
           SH600009    0.213076
           SH600010   -0.047823
           SH600011    0.058913
Epoch   540: reducing learning rate of group 0 to 1.0000e-03.
Epoch   760: reducing learning rate of group 0 to 5.0000e-04.
Epoch   980: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1200: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2020-03-06 SH600000   -0.089579
           SH600004    0.022970
           SH600009    0.065908
           SH600010    0.004707
           SH600011    0.065780
Epoch   620: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1160: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1380: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1600: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1840: reducing learning rate of group 0 to 6.2500e-05.
Epoch  2060: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2280: reducing learning rate of group 0 to 1.5625e-05.
Epoch  2500: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2020-04-03 SH600000    0.110380
           SH600004    0.075751
           SH600009    0.129799
           SH600010   -0.031995
           SH600011    0.105985
Epoch   760: reducing learning rate of group 0 to 1.0000e-03.
Epoch   980: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1200: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1420: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1640: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1860: reducing learning rate of group 0 to 3.1250e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2020-05-07 SH600000   -0.026903
           SH600004   -0.056843
           SH600009    0.094002
           SH600010    0.001348
           SH600011   -0.008641
Epoch   380: reducing learning rate of group 0 to 1.0000e-03.
Epoch   980: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1200: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1420: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1640: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2020-06-04 SH600000    0.104249
           SH600004   -0.084681
           SH600009    0.070540
           SH600010    0.075031
           SH600011   -0.102214
Epoch   480: reducing learning rate of group 0 to 1.0000e-03.
Epoch   700: reducing learning rate of group 0 to 5.0000e-04.
Epoch   960: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1180: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1400: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1620: reducing learning rate of group 0 to 3.1250e-05.
Epoch  1840: reducing learning rate of group 0 to 1.5625e-05.
Epoch  2120: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2020-07-06 SH600000   -0.084762
           SH600004    0.093446
           SH600009    0.111989
           SH600010    0.023781
           SH600011    0.070425
Epoch   820: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1040: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1260: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1480: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2020-08-03 SH600000   -0.267258
           SH600004   -0.190969
           SH600009   -0.114448
           SH600010   -0.162036
           SH600011   -0.039258
Epoch   820: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1040: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1260: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1480: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2020-08-31 SH600000   -0.234210
           SH600004   -0.009414
           SH600009    0.157153
           SH600010   -0.124600
           SH600011   -0.005897
Epoch   660: reducing learning rate of group 0 to 1.0000e-03.
Epoch   920: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1140: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1360: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1580: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2020-09-28 SH600000   -0.189705
           SH600004   -0.125990
           SH600009    0.021069
           SH600010   -0.224248
           SH600011   -0.142166
Epoch   780: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1000: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1220: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1440: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2020-11-03 SH600000   -0.078873
           SH600004    0.122467
           SH600009    0.205935
           SH600010   -0.057432
           SH600011    0.044504
Epoch   340: reducing learning rate of group 0 to 1.0000e-03.
Epoch   660: reducing learning rate of group 0 to 5.0000e-04.
Epoch   880: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1240: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1460: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1680: reducing learning rate of group 0 to 3.1250e-05.
Epoch  1900: reducing learning rate of group 0 to 1.5625e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2020-12-01 SH600000    0.002236
           SH600004    0.031517
           SH600009    0.183190
           SH600010   -0.024654
           SH600011   -0.136820
Epoch   480: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1000: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1220: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1440: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1660: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
[4142451:MainThread](2024-04-06 16:24:11,587) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  25%|██▌       | 13/52 [04:35<12:55, 19.89s/it][4142451:MainThread](2024-04-06 16:24:11,595) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:24:11,607) INFO - qlib.workflow - [recorder.py:341] - Recorder fd75c5f73baf4e5f8e3c2b33115e6e9e starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:24:12,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:24:12,250) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:24:12,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:24:12,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:24:15,676) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:24:15,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.358652, valid_loss 1.054124, train_metric nan, valid_metric 0.071369
[4142451:MainThread](2024-04-06 16:24:15,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.054124, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:24:16,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.131991, valid_loss 1.054400, train_metric nan, valid_metric 0.079985
[4142451:MainThread](2024-04-06 16:24:16,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.082363, valid_loss 1.003977, train_metric nan, valid_metric 0.094777
[4142451:MainThread](2024-04-06 16:24:16,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.054124 to 1.003977, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:16,474) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.059038, valid_loss 1.054378, train_metric nan, valid_metric 0.067565
[4142451:MainThread](2024-04-06 16:24:16,630) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.051017, valid_loss 1.024662, train_metric nan, valid_metric 0.071459
[4142451:MainThread](2024-04-06 16:24:16,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.044426, valid_loss 1.000481, train_metric nan, valid_metric 0.114110
[4142451:MainThread](2024-04-06 16:24:16,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003977 to 1.000481, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:16,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.044083, valid_loss 0.990018, train_metric nan, valid_metric 0.106649
[4142451:MainThread](2024-04-06 16:24:16,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000481 to 0.990018, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:17,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.027853, valid_loss 1.014709, train_metric nan, valid_metric 0.084586
[4142451:MainThread](2024-04-06 16:24:17,296) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.030089, valid_loss 1.004922, train_metric nan, valid_metric 0.110412
[4142451:MainThread](2024-04-06 16:24:17,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.036683, valid_loss 0.999599, train_metric nan, valid_metric 0.118730
[4142451:MainThread](2024-04-06 16:24:17,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.021029, valid_loss 0.994390, train_metric nan, valid_metric 0.083418
[4142451:MainThread](2024-04-06 16:24:17,796) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.006980, valid_loss 0.985453, train_metric nan, valid_metric 0.116591
[4142451:MainThread](2024-04-06 16:24:17,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990018 to 0.985453, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:17,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.003838, valid_loss 1.005966, train_metric nan, valid_metric 0.119756
[4142451:MainThread](2024-04-06 16:24:18,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.005482, valid_loss 0.986339, train_metric nan, valid_metric 0.121368
[4142451:MainThread](2024-04-06 16:24:18,238) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.006713, valid_loss 0.988886, train_metric nan, valid_metric 0.116929
[4142451:MainThread](2024-04-06 16:24:18,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.004764, valid_loss 1.012544, train_metric nan, valid_metric 0.097175
[4142451:MainThread](2024-04-06 16:24:18,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.996085, valid_loss 0.987407, train_metric nan, valid_metric 0.118647
[4142451:MainThread](2024-04-06 16:24:18,678) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.008992, valid_loss 0.989574, train_metric nan, valid_metric 0.105010
[4142451:MainThread](2024-04-06 16:24:18,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.017660, valid_loss 0.987585, train_metric nan, valid_metric 0.112592
[4142451:MainThread](2024-04-06 16:24:18,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.000064, valid_loss 1.001714, train_metric nan, valid_metric 0.104718
[4142451:MainThread](2024-04-06 16:24:19,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.990227, valid_loss 0.981366, train_metric nan, valid_metric 0.141143
[4142451:MainThread](2024-04-06 16:24:19,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.985453 to 0.981366, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:19,233) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.007235, valid_loss 0.993650, train_metric nan, valid_metric 0.128411
[4142451:MainThread](2024-04-06 16:24:19,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.003537, valid_loss 0.982321, train_metric nan, valid_metric 0.124068
[4142451:MainThread](2024-04-06 16:24:19,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.012275, valid_loss 0.984728, train_metric nan, valid_metric 0.124097
[4142451:MainThread](2024-04-06 16:24:19,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.992206, valid_loss 0.983281, train_metric nan, valid_metric 0.134419
[4142451:MainThread](2024-04-06 16:24:19,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.991186, valid_loss 0.981013, train_metric nan, valid_metric 0.131919
[4142451:MainThread](2024-04-06 16:24:19,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.981366 to 0.981013, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:19,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.997957, valid_loss 0.979294, train_metric nan, valid_metric 0.138995
[4142451:MainThread](2024-04-06 16:24:19,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.981013 to 0.979294, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:20,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.994602, valid_loss 0.986417, train_metric nan, valid_metric 0.112253
[4142451:MainThread](2024-04-06 16:24:20,242) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.995380, valid_loss 0.981897, train_metric nan, valid_metric 0.129360
[4142451:MainThread](2024-04-06 16:24:20,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.994397, valid_loss 0.994323, train_metric nan, valid_metric 0.121993
[4142451:MainThread](2024-04-06 16:24:20,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.986275, valid_loss 0.984698, train_metric nan, valid_metric 0.136250
[4142451:MainThread](2024-04-06 16:24:20,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.989638, valid_loss 0.987268, train_metric nan, valid_metric 0.112383
[4142451:MainThread](2024-04-06 16:24:20,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.001495, valid_loss 0.982255, train_metric nan, valid_metric 0.133449
[4142451:MainThread](2024-04-06 16:24:20,962) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.989916, valid_loss 0.983472, train_metric nan, valid_metric 0.132828
[4142451:MainThread](2024-04-06 16:24:21,107) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.990097, valid_loss 0.986309, train_metric nan, valid_metric 0.110471
[4142451:MainThread](2024-04-06 16:24:21,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.985615, valid_loss 0.980665, train_metric nan, valid_metric 0.134582
[4142451:MainThread](2024-04-06 16:24:21,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.981178, valid_loss 0.979456, train_metric nan, valid_metric 0.135911
[4142451:MainThread](2024-04-06 16:24:21,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.980621, valid_loss 0.984149, train_metric nan, valid_metric 0.121562
[4142451:MainThread](2024-04-06 16:24:21,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.987192, valid_loss 0.980799, train_metric nan, valid_metric 0.128774
[4142451:MainThread](2024-04-06 16:24:21,832) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.989245, valid_loss 0.984515, train_metric nan, valid_metric 0.120999
[4142451:MainThread](2024-04-06 16:24:21,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.976101, valid_loss 0.982712, train_metric nan, valid_metric 0.129540
[4142451:MainThread](2024-04-06 16:24:22,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.987946, valid_loss 0.981331, train_metric nan, valid_metric 0.130329
[4142451:MainThread](2024-04-06 16:24:22,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.980730, valid_loss 0.980881, train_metric nan, valid_metric 0.130753
[4142451:MainThread](2024-04-06 16:24:22,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.979739, valid_loss 0.983057, train_metric nan, valid_metric 0.129691
[4142451:MainThread](2024-04-06 16:24:22,568) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.988828, valid_loss 0.980876, train_metric nan, valid_metric 0.128797
[4142451:MainThread](2024-04-06 16:24:22,743) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.985568, valid_loss 0.981454, train_metric nan, valid_metric 0.128824
[4142451:MainThread](2024-04-06 16:24:22,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.977941, valid_loss 0.982493, train_metric nan, valid_metric 0.123062
[4142451:MainThread](2024-04-06 16:24:23,082) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.986110, valid_loss 0.983499, train_metric nan, valid_metric 0.120306
[4142451:MainThread](2024-04-06 16:24:23,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.968573, valid_loss 0.981686, train_metric nan, valid_metric 0.125178
[4142451:MainThread](2024-04-06 16:24:23,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.982255, valid_loss 0.983520, train_metric nan, valid_metric 0.136153
[4142451:MainThread](2024-04-06 16:24:23,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.987992, valid_loss 0.981277, train_metric nan, valid_metric 0.132984
[4142451:MainThread](2024-04-06 16:24:23,677) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.977373, valid_loss 0.980934, train_metric nan, valid_metric 0.129780
[4142451:MainThread](2024-04-06 16:24:23,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.992310, valid_loss 0.982544, train_metric nan, valid_metric 0.123656
[4142451:MainThread](2024-04-06 16:24:23,926) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.994132, valid_loss 0.982268, train_metric nan, valid_metric 0.123878
[4142451:MainThread](2024-04-06 16:24:24,052) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.979849, valid_loss 0.981038, train_metric nan, valid_metric 0.131923
[4142451:MainThread](2024-04-06 16:24:24,192) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.985616, valid_loss 0.983436, train_metric nan, valid_metric 0.128690
[4142451:MainThread](2024-04-06 16:24:24,341) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.983459, valid_loss 0.981327, train_metric nan, valid_metric 0.131325
[4142451:MainThread](2024-04-06 16:24:24,494) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.977449, valid_loss 0.982217, train_metric nan, valid_metric 0.126491
[4142451:MainThread](2024-04-06 16:24:24,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.986923, valid_loss 0.982596, train_metric nan, valid_metric 0.120782
[4142451:MainThread](2024-04-06 16:24:24,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.962655, valid_loss 0.982085, train_metric nan, valid_metric 0.125934
[4142451:MainThread](2024-04-06 16:24:24,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.991136, valid_loss 0.983605, train_metric nan, valid_metric 0.128510
[4142451:MainThread](2024-04-06 16:24:25,050) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.978359, valid_loss 0.981793, train_metric nan, valid_metric 0.129398
[4142451:MainThread](2024-04-06 16:24:25,205) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.970950, valid_loss 0.982264, train_metric nan, valid_metric 0.123680
[4142451:MainThread](2024-04-06 16:24:25,341) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.989980, valid_loss 0.984661, train_metric nan, valid_metric 0.134165
[4142451:MainThread](2024-04-06 16:24:25,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.984293, valid_loss 0.983019, train_metric nan, valid_metric 0.126591
[4142451:MainThread](2024-04-06 16:24:25,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.983869, valid_loss 0.981389, train_metric nan, valid_metric 0.128358
[4142451:MainThread](2024-04-06 16:24:25,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.994742, valid_loss 0.983754, train_metric nan, valid_metric 0.126113
[4142451:MainThread](2024-04-06 16:24:25,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.980793, valid_loss 0.981458, train_metric nan, valid_metric 0.130461
[4142451:MainThread](2024-04-06 16:24:26,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.985249, valid_loss 0.982079, train_metric nan, valid_metric 0.132846
[4142451:MainThread](2024-04-06 16:24:26,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.978910, valid_loss 0.981627, train_metric nan, valid_metric 0.129299
[4142451:MainThread](2024-04-06 16:24:26,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.983621, valid_loss 0.983734, train_metric nan, valid_metric 0.121215
[4142451:MainThread](2024-04-06 16:24:26,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.983868, valid_loss 0.981772, train_metric nan, valid_metric 0.127796
[4142451:MainThread](2024-04-06 16:24:26,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.982140, valid_loss 0.982424, train_metric nan, valid_metric 0.121998
[4142451:MainThread](2024-04-06 16:24:26,813) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.985172, valid_loss 0.981974, train_metric nan, valid_metric 0.128236
[4142451:MainThread](2024-04-06 16:24:26,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.986343, valid_loss 0.982269, train_metric nan, valid_metric 0.123010
[4142451:MainThread](2024-04-06 16:24:27,089) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.979227, valid_loss 0.981868, train_metric nan, valid_metric 0.124823
[4142451:MainThread](2024-04-06 16:24:27,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 1.002201, valid_loss 0.981470, train_metric nan, valid_metric 0.126358
[4142451:MainThread](2024-04-06 16:24:27,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:24:28,048) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:24:28,897) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  27%|██▋       | 14/52 [04:53<12:06, 19.11s/it][4142451:MainThread](2024-04-06 16:24:28,906) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:24:28,915) INFO - qlib.workflow - [recorder.py:341] - Recorder cd51cd3c13af488181726f462b2d4e2b starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:24:29,527) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:24:29,527) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:24:29,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:24:29,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:24:32,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:24:33,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.298084, valid_loss 1.033415, train_metric nan, valid_metric 0.075364
[4142451:MainThread](2024-04-06 16:24:33,510) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.033415, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:24:33,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.100046, valid_loss 1.031555, train_metric nan, valid_metric 0.078888
[4142451:MainThread](2024-04-06 16:24:33,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.033415 to 1.031555, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:33,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.057985, valid_loss 0.992860, train_metric nan, valid_metric 0.095053
[4142451:MainThread](2024-04-06 16:24:33,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.031555 to 0.992860, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:33,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.038077, valid_loss 0.993570, train_metric nan, valid_metric 0.090780
[4142451:MainThread](2024-04-06 16:24:34,089) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.035309, valid_loss 0.993564, train_metric nan, valid_metric 0.113207
[4142451:MainThread](2024-04-06 16:24:34,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.024221, valid_loss 0.989012, train_metric nan, valid_metric 0.097608
[4142451:MainThread](2024-04-06 16:24:34,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.992860 to 0.989012, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:34,371) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.015874, valid_loss 0.987444, train_metric nan, valid_metric 0.113326
[4142451:MainThread](2024-04-06 16:24:34,371) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.989012 to 0.987444, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:34,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.069525, valid_loss 1.023064, train_metric nan, valid_metric 0.084963
[4142451:MainThread](2024-04-06 16:24:34,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.037281, valid_loss 0.996378, train_metric nan, valid_metric 0.119744
[4142451:MainThread](2024-04-06 16:24:34,794) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.026339, valid_loss 1.009366, train_metric nan, valid_metric 0.118658
[4142451:MainThread](2024-04-06 16:24:34,931) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.041807, valid_loss 1.040963, train_metric nan, valid_metric 0.083183
[4142451:MainThread](2024-04-06 16:24:35,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.008800, valid_loss 0.985919, train_metric nan, valid_metric 0.125214
[4142451:MainThread](2024-04-06 16:24:35,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.987444 to 0.985919, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:35,214) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.005728, valid_loss 0.987808, train_metric nan, valid_metric 0.122178
[4142451:MainThread](2024-04-06 16:24:35,394) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.004072, valid_loss 0.992891, train_metric nan, valid_metric 0.120556
[4142451:MainThread](2024-04-06 16:24:35,533) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.012357, valid_loss 0.982030, train_metric nan, valid_metric 0.131812
[4142451:MainThread](2024-04-06 16:24:35,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.985919 to 0.982030, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:35,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.000821, valid_loss 0.986562, train_metric nan, valid_metric 0.112059
[4142451:MainThread](2024-04-06 16:24:35,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.994434, valid_loss 0.983526, train_metric nan, valid_metric 0.122949
[4142451:MainThread](2024-04-06 16:24:36,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.005001, valid_loss 0.983155, train_metric nan, valid_metric 0.123811
[4142451:MainThread](2024-04-06 16:24:36,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.995936, valid_loss 0.982676, train_metric nan, valid_metric 0.131913
[4142451:MainThread](2024-04-06 16:24:36,341) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.995122, valid_loss 0.979897, train_metric nan, valid_metric 0.137683
[4142451:MainThread](2024-04-06 16:24:36,342) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.982030 to 0.979897, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:36,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.997400, valid_loss 0.984844, train_metric nan, valid_metric 0.117710
[4142451:MainThread](2024-04-06 16:24:36,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.991780, valid_loss 0.983174, train_metric nan, valid_metric 0.129595
[4142451:MainThread](2024-04-06 16:24:36,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.984903, valid_loss 0.978904, train_metric nan, valid_metric 0.143157
[4142451:MainThread](2024-04-06 16:24:36,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.979897 to 0.978904, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:36,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.993515, valid_loss 0.985122, train_metric nan, valid_metric 0.122823
[4142451:MainThread](2024-04-06 16:24:37,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.990201, valid_loss 0.985220, train_metric nan, valid_metric 0.124261
[4142451:MainThread](2024-04-06 16:24:37,275) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.996223, valid_loss 0.986990, train_metric nan, valid_metric 0.119249
[4142451:MainThread](2024-04-06 16:24:37,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.989018, valid_loss 0.981926, train_metric nan, valid_metric 0.126623
[4142451:MainThread](2024-04-06 16:24:37,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.989513, valid_loss 0.979164, train_metric nan, valid_metric 0.135121
[4142451:MainThread](2024-04-06 16:24:37,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.987049, valid_loss 0.985125, train_metric nan, valid_metric 0.119820
[4142451:MainThread](2024-04-06 16:24:37,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.997096, valid_loss 0.987525, train_metric nan, valid_metric 0.105942
[4142451:MainThread](2024-04-06 16:24:37,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.989953, valid_loss 0.980985, train_metric nan, valid_metric 0.132179
[4142451:MainThread](2024-04-06 16:24:38,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.981136, valid_loss 0.987295, train_metric nan, valid_metric 0.131137
[4142451:MainThread](2024-04-06 16:24:38,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.990503, valid_loss 0.983084, train_metric nan, valid_metric 0.119293
[4142451:MainThread](2024-04-06 16:24:38,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.989275, valid_loss 0.987975, train_metric nan, valid_metric 0.124924
[4142451:MainThread](2024-04-06 16:24:38,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.988796, valid_loss 0.982565, train_metric nan, valid_metric 0.140256
[4142451:MainThread](2024-04-06 16:24:38,702) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.978002, valid_loss 0.979724, train_metric nan, valid_metric 0.138060
[4142451:MainThread](2024-04-06 16:24:38,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.979511, valid_loss 0.979315, train_metric nan, valid_metric 0.138066
[4142451:MainThread](2024-04-06 16:24:38,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.987824, valid_loss 0.983425, train_metric nan, valid_metric 0.116540
[4142451:MainThread](2024-04-06 16:24:39,129) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.992896, valid_loss 0.980862, train_metric nan, valid_metric 0.129230
[4142451:MainThread](2024-04-06 16:24:39,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.987750, valid_loss 0.985134, train_metric nan, valid_metric 0.108634
[4142451:MainThread](2024-04-06 16:24:39,444) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.995282, valid_loss 0.982111, train_metric nan, valid_metric 0.125856
[4142451:MainThread](2024-04-06 16:24:39,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.973442, valid_loss 0.981749, train_metric nan, valid_metric 0.128662
[4142451:MainThread](2024-04-06 16:24:39,754) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.978439, valid_loss 0.985094, train_metric nan, valid_metric 0.109274
[4142451:MainThread](2024-04-06 16:24:39,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.984082, valid_loss 0.982446, train_metric nan, valid_metric 0.127173
[4142451:MainThread](2024-04-06 16:24:40,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.990605, valid_loss 0.981182, train_metric nan, valid_metric 0.140508
[4142451:MainThread](2024-04-06 16:24:40,196) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.971797, valid_loss 0.980469, train_metric nan, valid_metric 0.134451
[4142451:MainThread](2024-04-06 16:24:40,341) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.987535, valid_loss 0.982132, train_metric nan, valid_metric 0.123734
[4142451:MainThread](2024-04-06 16:24:40,487) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.984667, valid_loss 0.980564, train_metric nan, valid_metric 0.128759
[4142451:MainThread](2024-04-06 16:24:40,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.980448, valid_loss 0.981327, train_metric nan, valid_metric 0.125808
[4142451:MainThread](2024-04-06 16:24:40,771) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.989535, valid_loss 0.979316, train_metric nan, valid_metric 0.138576
[4142451:MainThread](2024-04-06 16:24:40,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.973825, valid_loss 0.981374, train_metric nan, valid_metric 0.127438
[4142451:MainThread](2024-04-06 16:24:41,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.982334, valid_loss 0.979882, train_metric nan, valid_metric 0.134931
[4142451:MainThread](2024-04-06 16:24:41,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.986299, valid_loss 0.982756, train_metric nan, valid_metric 0.127939
[4142451:MainThread](2024-04-06 16:24:41,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.990104, valid_loss 0.982897, train_metric nan, valid_metric 0.127974
[4142451:MainThread](2024-04-06 16:24:41,486) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.983872, valid_loss 0.981526, train_metric nan, valid_metric 0.135545
[4142451:MainThread](2024-04-06 16:24:41,624) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.991343, valid_loss 0.981091, train_metric nan, valid_metric 0.133447
[4142451:MainThread](2024-04-06 16:24:41,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.992345, valid_loss 0.979448, train_metric nan, valid_metric 0.135987
[4142451:MainThread](2024-04-06 16:24:41,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.966083, valid_loss 0.980827, train_metric nan, valid_metric 0.134340
[4142451:MainThread](2024-04-06 16:24:42,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.980340, valid_loss 0.981116, train_metric nan, valid_metric 0.128589
[4142451:MainThread](2024-04-06 16:24:42,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.981416, valid_loss 0.981208, train_metric nan, valid_metric 0.135593
[4142451:MainThread](2024-04-06 16:24:42,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.973568, valid_loss 0.980816, train_metric nan, valid_metric 0.130595
[4142451:MainThread](2024-04-06 16:24:42,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.979582, valid_loss 0.980766, train_metric nan, valid_metric 0.133005
[4142451:MainThread](2024-04-06 16:24:42,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.991991, valid_loss 0.980502, train_metric nan, valid_metric 0.131960
[4142451:MainThread](2024-04-06 16:24:42,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.986352, valid_loss 0.980640, train_metric nan, valid_metric 0.128521
[4142451:MainThread](2024-04-06 16:24:43,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.986038, valid_loss 0.980709, train_metric nan, valid_metric 0.130705
[4142451:MainThread](2024-04-06 16:24:43,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.988315, valid_loss 0.980079, train_metric nan, valid_metric 0.134690
[4142451:MainThread](2024-04-06 16:24:43,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.985445, valid_loss 0.980456, train_metric nan, valid_metric 0.128973
[4142451:MainThread](2024-04-06 16:24:43,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.991991, valid_loss 0.980511, train_metric nan, valid_metric 0.131637
[4142451:MainThread](2024-04-06 16:24:43,663) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.995237, valid_loss 0.979448, train_metric nan, valid_metric 0.136329
[4142451:MainThread](2024-04-06 16:24:43,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.974378, valid_loss 0.981754, train_metric nan, valid_metric 0.126184
[4142451:MainThread](2024-04-06 16:24:43,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.982956, valid_loss 0.981058, train_metric nan, valid_metric 0.131799
[4142451:MainThread](2024-04-06 16:24:44,098) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.979540, valid_loss 0.981097, train_metric nan, valid_metric 0.128470
[4142451:MainThread](2024-04-06 16:24:44,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.981819, valid_loss 0.980771, train_metric nan, valid_metric 0.130605
[4142451:MainThread](2024-04-06 16:24:44,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:24:45,058) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:24:45,912) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  29%|██▉       | 15/52 [05:10<11:23, 18.48s/it][4142451:MainThread](2024-04-06 16:24:45,920) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:24:45,932) INFO - qlib.workflow - [recorder.py:341] - Recorder ed78e2d15f594f35bb846def681e309a starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:24:46,545) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:24:46,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:24:46,550) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:24:46,551) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:24:49,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:24:50,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.251391, valid_loss 1.011676, train_metric nan, valid_metric 0.073310
[4142451:MainThread](2024-04-06 16:24:50,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.011676, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:24:50,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.108127, valid_loss 1.031703, train_metric nan, valid_metric 0.073473
[4142451:MainThread](2024-04-06 16:24:50,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.070621, valid_loss 1.010393, train_metric nan, valid_metric 0.054721
[4142451:MainThread](2024-04-06 16:24:50,545) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.011676 to 1.010393, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:50,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.053034, valid_loss 1.007047, train_metric nan, valid_metric 0.068405
[4142451:MainThread](2024-04-06 16:24:50,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.010393 to 1.007047, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:50,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.039201, valid_loss 0.998686, train_metric nan, valid_metric 0.079245
[4142451:MainThread](2024-04-06 16:24:50,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.007047 to 0.998686, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:50,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.059386, valid_loss 1.008829, train_metric nan, valid_metric 0.059375
[4142451:MainThread](2024-04-06 16:24:51,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.055291, valid_loss 1.027216, train_metric nan, valid_metric 0.074197
[4142451:MainThread](2024-04-06 16:24:51,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.062325, valid_loss 1.065954, train_metric nan, valid_metric 0.088120
[4142451:MainThread](2024-04-06 16:24:51,477) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.034284, valid_loss 0.998726, train_metric nan, valid_metric 0.078887
[4142451:MainThread](2024-04-06 16:24:51,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.005827, valid_loss 0.990771, train_metric nan, valid_metric 0.092381
[4142451:MainThread](2024-04-06 16:24:51,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998686 to 0.990771, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:51,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.015581, valid_loss 0.990516, train_metric nan, valid_metric 0.089388
[4142451:MainThread](2024-04-06 16:24:51,770) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990771 to 0.990516, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:51,914) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.032118, valid_loss 1.013617, train_metric nan, valid_metric 0.097080
[4142451:MainThread](2024-04-06 16:24:52,082) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.015968, valid_loss 0.993251, train_metric nan, valid_metric 0.084586
[4142451:MainThread](2024-04-06 16:24:52,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.010780, valid_loss 0.996749, train_metric nan, valid_metric 0.083550
[4142451:MainThread](2024-04-06 16:24:52,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.010753, valid_loss 0.987170, train_metric nan, valid_metric 0.097545
[4142451:MainThread](2024-04-06 16:24:52,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990516 to 0.987170, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:52,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.005423, valid_loss 1.003123, train_metric nan, valid_metric 0.101499
[4142451:MainThread](2024-04-06 16:24:52,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.999963, valid_loss 0.989018, train_metric nan, valid_metric 0.093647
[4142451:MainThread](2024-04-06 16:24:52,856) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.001843, valid_loss 0.999774, train_metric nan, valid_metric 0.079323
[4142451:MainThread](2024-04-06 16:24:53,006) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.011922, valid_loss 0.997473, train_metric nan, valid_metric 0.080736
[4142451:MainThread](2024-04-06 16:24:53,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.996228, valid_loss 0.988784, train_metric nan, valid_metric 0.105403
[4142451:MainThread](2024-04-06 16:24:53,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.996456, valid_loss 0.988856, train_metric nan, valid_metric 0.091870
[4142451:MainThread](2024-04-06 16:24:53,437) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.000886, valid_loss 0.987405, train_metric nan, valid_metric 0.098953
[4142451:MainThread](2024-04-06 16:24:53,586) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.001074, valid_loss 0.990790, train_metric nan, valid_metric 0.099305
[4142451:MainThread](2024-04-06 16:24:53,731) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.002218, valid_loss 0.987532, train_metric nan, valid_metric 0.097960
[4142451:MainThread](2024-04-06 16:24:53,876) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.993469, valid_loss 0.986540, train_metric nan, valid_metric 0.106241
[4142451:MainThread](2024-04-06 16:24:53,877) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.987170 to 0.986540, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:54,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.995781, valid_loss 0.987146, train_metric nan, valid_metric 0.105474
[4142451:MainThread](2024-04-06 16:24:54,170) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.984129, valid_loss 0.993271, train_metric nan, valid_metric 0.086099
[4142451:MainThread](2024-04-06 16:24:54,321) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.980280, valid_loss 0.987363, train_metric nan, valid_metric 0.097701
[4142451:MainThread](2024-04-06 16:24:54,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.993876, valid_loss 0.987440, train_metric nan, valid_metric 0.099059
[4142451:MainThread](2024-04-06 16:24:54,673) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.986829, valid_loss 0.988046, train_metric nan, valid_metric 0.103829
[4142451:MainThread](2024-04-06 16:24:54,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.979483, valid_loss 0.987808, train_metric nan, valid_metric 0.096060
[4142451:MainThread](2024-04-06 16:24:54,963) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.988276, valid_loss 0.988622, train_metric nan, valid_metric 0.093557
[4142451:MainThread](2024-04-06 16:24:55,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.986576, valid_loss 0.995110, train_metric nan, valid_metric 0.084275
[4142451:MainThread](2024-04-06 16:24:55,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.995703, valid_loss 0.989458, train_metric nan, valid_metric 0.089613
[4142451:MainThread](2024-04-06 16:24:55,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.994213, valid_loss 0.994053, train_metric nan, valid_metric 0.093092
[4142451:MainThread](2024-04-06 16:24:55,567) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.986038, valid_loss 0.989824, train_metric nan, valid_metric 0.099647
[4142451:MainThread](2024-04-06 16:24:55,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.982121, valid_loss 0.988005, train_metric nan, valid_metric 0.104597
[4142451:MainThread](2024-04-06 16:24:55,846) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.001660, valid_loss 0.987983, train_metric nan, valid_metric 0.101276
[4142451:MainThread](2024-04-06 16:24:55,995) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.984262, valid_loss 0.986232, train_metric nan, valid_metric 0.104430
[4142451:MainThread](2024-04-06 16:24:55,995) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.986540 to 0.986232, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:56,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.984765, valid_loss 0.989638, train_metric nan, valid_metric 0.102073
[4142451:MainThread](2024-04-06 16:24:56,316) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.986125, valid_loss 0.987135, train_metric nan, valid_metric 0.099554
[4142451:MainThread](2024-04-06 16:24:56,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.990819, valid_loss 0.986499, train_metric nan, valid_metric 0.102408
[4142451:MainThread](2024-04-06 16:24:56,586) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.980426, valid_loss 0.985864, train_metric nan, valid_metric 0.104010
[4142451:MainThread](2024-04-06 16:24:56,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.986232 to 0.985864, save checkpoint.
[4142451:MainThread](2024-04-06 16:24:56,778) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.993735, valid_loss 0.986975, train_metric nan, valid_metric 0.102708
[4142451:MainThread](2024-04-06 16:24:56,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.990100, valid_loss 0.987516, train_metric nan, valid_metric 0.104327
[4142451:MainThread](2024-04-06 16:24:57,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.984638, valid_loss 0.987582, train_metric nan, valid_metric 0.097168
[4142451:MainThread](2024-04-06 16:24:57,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.997536, valid_loss 0.992294, train_metric nan, valid_metric 0.096768
[4142451:MainThread](2024-04-06 16:24:57,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.971627, valid_loss 0.987975, train_metric nan, valid_metric 0.095255
[4142451:MainThread](2024-04-06 16:24:57,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.978410, valid_loss 0.987746, train_metric nan, valid_metric 0.098217
[4142451:MainThread](2024-04-06 16:24:57,738) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.974598, valid_loss 0.988593, train_metric nan, valid_metric 0.098516
[4142451:MainThread](2024-04-06 16:24:57,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.973275, valid_loss 0.987474, train_metric nan, valid_metric 0.101720
[4142451:MainThread](2024-04-06 16:24:58,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.982639, valid_loss 0.987145, train_metric nan, valid_metric 0.101636
[4142451:MainThread](2024-04-06 16:24:58,175) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.977937, valid_loss 0.985998, train_metric nan, valid_metric 0.105813
[4142451:MainThread](2024-04-06 16:24:58,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.972416, valid_loss 0.987657, train_metric nan, valid_metric 0.095257
[4142451:MainThread](2024-04-06 16:24:58,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.980106, valid_loss 0.986494, train_metric nan, valid_metric 0.103144
[4142451:MainThread](2024-04-06 16:24:58,603) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.982555, valid_loss 0.987857, train_metric nan, valid_metric 0.096963
[4142451:MainThread](2024-04-06 16:24:58,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.977733, valid_loss 0.987528, train_metric nan, valid_metric 0.101078
[4142451:MainThread](2024-04-06 16:24:58,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.981883, valid_loss 0.986896, train_metric nan, valid_metric 0.102230
[4142451:MainThread](2024-04-06 16:24:59,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.977994, valid_loss 0.987265, train_metric nan, valid_metric 0.101118
[4142451:MainThread](2024-04-06 16:24:59,211) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.978499, valid_loss 0.990665, train_metric nan, valid_metric 0.093863
[4142451:MainThread](2024-04-06 16:24:59,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.985421, valid_loss 0.987974, train_metric nan, valid_metric 0.095095
[4142451:MainThread](2024-04-06 16:24:59,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.983618, valid_loss 0.986274, train_metric nan, valid_metric 0.104097
[4142451:MainThread](2024-04-06 16:24:59,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.973542, valid_loss 0.989612, train_metric nan, valid_metric 0.089162
[4142451:MainThread](2024-04-06 16:24:59,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.988739, valid_loss 0.987805, train_metric nan, valid_metric 0.096003
[4142451:MainThread](2024-04-06 16:25:00,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.990441, valid_loss 0.988064, train_metric nan, valid_metric 0.095616
[4142451:MainThread](2024-04-06 16:25:00,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.986327, valid_loss 0.987059, train_metric nan, valid_metric 0.100697
[4142451:MainThread](2024-04-06 16:25:00,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.987277, valid_loss 0.987919, train_metric nan, valid_metric 0.100651
[4142451:MainThread](2024-04-06 16:25:00,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.986660, valid_loss 0.987376, train_metric nan, valid_metric 0.103606
[4142451:MainThread](2024-04-06 16:25:00,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.982947, valid_loss 0.987285, train_metric nan, valid_metric 0.102998
[4142451:MainThread](2024-04-06 16:25:00,760) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.988440, valid_loss 0.987395, train_metric nan, valid_metric 0.098125
[4142451:MainThread](2024-04-06 16:25:00,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.975660, valid_loss 0.988364, train_metric nan, valid_metric 0.099278
[4142451:MainThread](2024-04-06 16:25:01,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.983001, valid_loss 0.986280, train_metric nan, valid_metric 0.104413
[4142451:MainThread](2024-04-06 16:25:01,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.977599, valid_loss 0.989017, train_metric nan, valid_metric 0.096458
[4142451:MainThread](2024-04-06 16:25:01,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.985309, valid_loss 0.987288, train_metric nan, valid_metric 0.098938
[4142451:MainThread](2024-04-06 16:25:01,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.985281, valid_loss 0.987313, train_metric nan, valid_metric 0.099831
[4142451:MainThread](2024-04-06 16:25:01,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.980922, valid_loss 0.987101, train_metric nan, valid_metric 0.104063
[4142451:MainThread](2024-04-06 16:25:01,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.980647, valid_loss 0.986269, train_metric nan, valid_metric 0.103891
[4142451:MainThread](2024-04-06 16:25:01,928) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.979421, valid_loss 0.987351, train_metric nan, valid_metric 0.098479
[4142451:MainThread](2024-04-06 16:25:02,073) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.988355, valid_loss 0.986544, train_metric nan, valid_metric 0.101249
[4142451:MainThread](2024-04-06 16:25:02,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.973208, valid_loss 0.987211, train_metric nan, valid_metric 0.099032
[4142451:MainThread](2024-04-06 16:25:02,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.987911, valid_loss 0.986956, train_metric nan, valid_metric 0.099907
[4142451:MainThread](2024-04-06 16:25:02,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.978491, valid_loss 0.987744, train_metric nan, valid_metric 0.098627
[4142451:MainThread](2024-04-06 16:25:02,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.987468, valid_loss 0.986231, train_metric nan, valid_metric 0.105834
[4142451:MainThread](2024-04-06 16:25:02,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.978514, valid_loss 0.985973, train_metric nan, valid_metric 0.105638
[4142451:MainThread](2024-04-06 16:25:02,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.976328, valid_loss 0.987443, train_metric nan, valid_metric 0.098497
[4142451:MainThread](2024-04-06 16:25:03,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.983647, valid_loss 0.986710, train_metric nan, valid_metric 0.101999
[4142451:MainThread](2024-04-06 16:25:03,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.976666, valid_loss 0.986271, train_metric nan, valid_metric 0.103472
[4142451:MainThread](2024-04-06 16:25:03,427) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.983132, valid_loss 0.986933, train_metric nan, valid_metric 0.102598
[4142451:MainThread](2024-04-06 16:25:03,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.978888, valid_loss 0.988080, train_metric nan, valid_metric 0.097475
[4142451:MainThread](2024-04-06 16:25:03,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.986068, valid_loss 0.987037, train_metric nan, valid_metric 0.102004
[4142451:MainThread](2024-04-06 16:25:03,842) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.976940, valid_loss 0.986741, train_metric nan, valid_metric 0.101513
[4142451:MainThread](2024-04-06 16:25:03,976) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.980335, valid_loss 0.986816, train_metric nan, valid_metric 0.102084
[4142451:MainThread](2024-04-06 16:25:04,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.976786, valid_loss 0.987458, train_metric nan, valid_metric 0.099751
[4142451:MainThread](2024-04-06 16:25:04,107) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:25:04,931) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:25:05,786) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  31%|███       | 16/52 [05:29<11:20, 18.90s/it][4142451:MainThread](2024-04-06 16:25:05,794) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:25:05,803) INFO - qlib.workflow - [recorder.py:341] - Recorder 3c7caaa4b5be4cf5a3249fa43a8f6456 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:25:06,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:25:06,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:25:06,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:25:06,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:25:09,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:25:10,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.404070, valid_loss 1.046007, train_metric nan, valid_metric 0.043531
[4142451:MainThread](2024-04-06 16:25:10,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.046007, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:25:10,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.119517, valid_loss 1.046857, train_metric nan, valid_metric 0.057800
[4142451:MainThread](2024-04-06 16:25:10,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.078652, valid_loss 1.009327, train_metric nan, valid_metric 0.061832
[4142451:MainThread](2024-04-06 16:25:10,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.046007 to 1.009327, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:10,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.039902, valid_loss 1.000825, train_metric nan, valid_metric 0.072391
[4142451:MainThread](2024-04-06 16:25:10,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.009327 to 1.000825, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:10,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.081881, valid_loss 1.025631, train_metric nan, valid_metric 0.069840
[4142451:MainThread](2024-04-06 16:25:10,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.050645, valid_loss 1.002425, train_metric nan, valid_metric 0.079435
[4142451:MainThread](2024-04-06 16:25:10,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.055485, valid_loss 1.000304, train_metric nan, valid_metric 0.074704
[4142451:MainThread](2024-04-06 16:25:10,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000825 to 1.000304, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:11,119) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.016284, valid_loss 0.991890, train_metric nan, valid_metric 0.081596
[4142451:MainThread](2024-04-06 16:25:11,120) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000304 to 0.991890, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:11,257) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.029128, valid_loss 0.994682, train_metric nan, valid_metric 0.084418
[4142451:MainThread](2024-04-06 16:25:11,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.009528, valid_loss 0.993564, train_metric nan, valid_metric 0.092431
[4142451:MainThread](2024-04-06 16:25:11,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.014077, valid_loss 0.996318, train_metric nan, valid_metric 0.089374
[4142451:MainThread](2024-04-06 16:25:11,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 0.998541, valid_loss 1.023489, train_metric nan, valid_metric 0.084832
[4142451:MainThread](2024-04-06 16:25:11,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.015349, valid_loss 1.001782, train_metric nan, valid_metric 0.090402
[4142451:MainThread](2024-04-06 16:25:11,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.010083, valid_loss 0.989399, train_metric nan, valid_metric 0.095103
[4142451:MainThread](2024-04-06 16:25:11,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991890 to 0.989399, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:12,089) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.004183, valid_loss 0.990060, train_metric nan, valid_metric 0.098625
[4142451:MainThread](2024-04-06 16:25:12,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.999415, valid_loss 0.990665, train_metric nan, valid_metric 0.085672
[4142451:MainThread](2024-04-06 16:25:12,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.005714, valid_loss 0.990331, train_metric nan, valid_metric 0.104553
[4142451:MainThread](2024-04-06 16:25:12,510) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.997447, valid_loss 0.989995, train_metric nan, valid_metric 0.100020
[4142451:MainThread](2024-04-06 16:25:12,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.993535, valid_loss 0.992654, train_metric nan, valid_metric 0.099070
[4142451:MainThread](2024-04-06 16:25:12,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.995881, valid_loss 0.990396, train_metric nan, valid_metric 0.095819
[4142451:MainThread](2024-04-06 16:25:12,926) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.996706, valid_loss 0.990592, train_metric nan, valid_metric 0.097164
[4142451:MainThread](2024-04-06 16:25:13,065) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.007799, valid_loss 0.994297, train_metric nan, valid_metric 0.087862
[4142451:MainThread](2024-04-06 16:25:13,205) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.030220, valid_loss 0.997303, train_metric nan, valid_metric 0.073204
[4142451:MainThread](2024-04-06 16:25:13,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.998237, valid_loss 0.988296, train_metric nan, valid_metric 0.097798
[4142451:MainThread](2024-04-06 16:25:13,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.989399 to 0.988296, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:13,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.008369, valid_loss 0.996035, train_metric nan, valid_metric 0.087137
[4142451:MainThread](2024-04-06 16:25:13,633) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.002007, valid_loss 0.987060, train_metric nan, valid_metric 0.105323
[4142451:MainThread](2024-04-06 16:25:13,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.988296 to 0.987060, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:13,770) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.988641, valid_loss 0.985400, train_metric nan, valid_metric 0.108910
[4142451:MainThread](2024-04-06 16:25:13,771) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.987060 to 0.985400, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:13,914) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.999163, valid_loss 0.986972, train_metric nan, valid_metric 0.100505
[4142451:MainThread](2024-04-06 16:25:14,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.984479, valid_loss 0.986376, train_metric nan, valid_metric 0.103378
[4142451:MainThread](2024-04-06 16:25:14,223) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.994421, valid_loss 0.988356, train_metric nan, valid_metric 0.092546
[4142451:MainThread](2024-04-06 16:25:14,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.987324, valid_loss 0.986441, train_metric nan, valid_metric 0.103503
[4142451:MainThread](2024-04-06 16:25:14,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.991746, valid_loss 0.995828, train_metric nan, valid_metric 0.105817
[4142451:MainThread](2024-04-06 16:25:14,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.984709, valid_loss 0.987237, train_metric nan, valid_metric 0.104688
[4142451:MainThread](2024-04-06 16:25:14,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.997970, valid_loss 0.989145, train_metric nan, valid_metric 0.101987
[4142451:MainThread](2024-04-06 16:25:14,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.986455, valid_loss 0.988537, train_metric nan, valid_metric 0.103186
[4142451:MainThread](2024-04-06 16:25:15,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.986747, valid_loss 0.990595, train_metric nan, valid_metric 0.100873
[4142451:MainThread](2024-04-06 16:25:15,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.993169, valid_loss 0.989014, train_metric nan, valid_metric 0.095710
[4142451:MainThread](2024-04-06 16:25:15,383) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.988384, valid_loss 0.992952, train_metric nan, valid_metric 0.101751
[4142451:MainThread](2024-04-06 16:25:15,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.993377, valid_loss 0.985981, train_metric nan, valid_metric 0.108009
[4142451:MainThread](2024-04-06 16:25:15,727) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.975802, valid_loss 0.986077, train_metric nan, valid_metric 0.105180
[4142451:MainThread](2024-04-06 16:25:15,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.983205, valid_loss 0.986474, train_metric nan, valid_metric 0.101554
[4142451:MainThread](2024-04-06 16:25:16,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.984973, valid_loss 0.987717, train_metric nan, valid_metric 0.100025
[4142451:MainThread](2024-04-06 16:25:16,146) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.988723, valid_loss 0.986969, train_metric nan, valid_metric 0.101782
[4142451:MainThread](2024-04-06 16:25:16,309) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.983664, valid_loss 0.987965, train_metric nan, valid_metric 0.095467
[4142451:MainThread](2024-04-06 16:25:16,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.995796, valid_loss 0.986466, train_metric nan, valid_metric 0.104813
[4142451:MainThread](2024-04-06 16:25:16,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.996182, valid_loss 0.987347, train_metric nan, valid_metric 0.102649
[4142451:MainThread](2024-04-06 16:25:16,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.989917, valid_loss 0.986407, train_metric nan, valid_metric 0.103523
[4142451:MainThread](2024-04-06 16:25:16,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.986893, valid_loss 0.986214, train_metric nan, valid_metric 0.102594
[4142451:MainThread](2024-04-06 16:25:17,043) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.982788, valid_loss 0.985903, train_metric nan, valid_metric 0.106509
[4142451:MainThread](2024-04-06 16:25:17,188) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.986173, valid_loss 0.985659, train_metric nan, valid_metric 0.108670
[4142451:MainThread](2024-04-06 16:25:17,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.971779, valid_loss 0.985991, train_metric nan, valid_metric 0.104989
[4142451:MainThread](2024-04-06 16:25:17,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.981123, valid_loss 0.985855, train_metric nan, valid_metric 0.105957
[4142451:MainThread](2024-04-06 16:25:17,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.988406, valid_loss 0.986155, train_metric nan, valid_metric 0.105949
[4142451:MainThread](2024-04-06 16:25:17,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.969642, valid_loss 0.985463, train_metric nan, valid_metric 0.107291
[4142451:MainThread](2024-04-06 16:25:17,892) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.980746, valid_loss 0.986129, train_metric nan, valid_metric 0.104491
[4142451:MainThread](2024-04-06 16:25:18,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.991151, valid_loss 0.986495, train_metric nan, valid_metric 0.105296
[4142451:MainThread](2024-04-06 16:25:18,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.970067, valid_loss 0.986902, train_metric nan, valid_metric 0.103068
[4142451:MainThread](2024-04-06 16:25:18,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.972409, valid_loss 0.986921, train_metric nan, valid_metric 0.101886
[4142451:MainThread](2024-04-06 16:25:18,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.991578, valid_loss 0.986486, train_metric nan, valid_metric 0.102577
[4142451:MainThread](2024-04-06 16:25:18,608) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.985850, valid_loss 0.985687, train_metric nan, valid_metric 0.106161
[4142451:MainThread](2024-04-06 16:25:18,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.979498, valid_loss 0.987278, train_metric nan, valid_metric 0.101456
[4142451:MainThread](2024-04-06 16:25:18,897) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.980585, valid_loss 0.985688, train_metric nan, valid_metric 0.107389
[4142451:MainThread](2024-04-06 16:25:19,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.971733, valid_loss 0.986104, train_metric nan, valid_metric 0.105050
[4142451:MainThread](2024-04-06 16:25:19,172) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.981894, valid_loss 0.986104, train_metric nan, valid_metric 0.105338
[4142451:MainThread](2024-04-06 16:25:19,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.977854, valid_loss 0.986143, train_metric nan, valid_metric 0.104275
[4142451:MainThread](2024-04-06 16:25:19,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.992534, valid_loss 0.986080, train_metric nan, valid_metric 0.104104
[4142451:MainThread](2024-04-06 16:25:19,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.983993, valid_loss 0.986315, train_metric nan, valid_metric 0.102924
[4142451:MainThread](2024-04-06 16:25:19,742) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.986011, valid_loss 0.986378, train_metric nan, valid_metric 0.102901
[4142451:MainThread](2024-04-06 16:25:19,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.985323, valid_loss 0.985838, train_metric nan, valid_metric 0.106147
[4142451:MainThread](2024-04-06 16:25:20,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.987497, valid_loss 0.985794, train_metric nan, valid_metric 0.105851
[4142451:MainThread](2024-04-06 16:25:20,156) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.988598, valid_loss 0.986387, train_metric nan, valid_metric 0.103255
[4142451:MainThread](2024-04-06 16:25:20,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.976906, valid_loss 0.986192, train_metric nan, valid_metric 0.105007
[4142451:MainThread](2024-04-06 16:25:20,471) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.982998, valid_loss 0.985757, train_metric nan, valid_metric 0.106872
[4142451:MainThread](2024-04-06 16:25:20,611) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.983962, valid_loss 0.985676, train_metric nan, valid_metric 0.107324
[4142451:MainThread](2024-04-06 16:25:20,743) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.980893, valid_loss 0.985959, train_metric nan, valid_metric 0.106066
[4142451:MainThread](2024-04-06 16:25:20,894) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.993049, valid_loss 0.985840, train_metric nan, valid_metric 0.104813
[4142451:MainThread](2024-04-06 16:25:21,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.982936, valid_loss 0.987151, train_metric nan, valid_metric 0.102775
[4142451:MainThread](2024-04-06 16:25:21,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:25:21,732) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:25:22,603) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  33%|███▎      | 17/52 [05:46<10:39, 18.27s/it][4142451:MainThread](2024-04-06 16:25:22,611) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:25:22,620) INFO - qlib.workflow - [recorder.py:341] - Recorder 10c6cdd0bc324cb2a392db945da96779 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:25:23,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:25:23,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:25:23,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:25:23,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:25:26,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:25:27,017) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.250571, valid_loss 1.042038, train_metric nan, valid_metric 0.045679
[4142451:MainThread](2024-04-06 16:25:27,018) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.042038, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:25:27,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.075921, valid_loss 1.018228, train_metric nan, valid_metric 0.071108
[4142451:MainThread](2024-04-06 16:25:27,167) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.042038 to 1.018228, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:27,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.138032, valid_loss 1.017897, train_metric nan, valid_metric 0.071253
[4142451:MainThread](2024-04-06 16:25:27,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.018228 to 1.017897, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:27,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.039470, valid_loss 0.993500, train_metric nan, valid_metric 0.082713
[4142451:MainThread](2024-04-06 16:25:27,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.017897 to 0.993500, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:27,678) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.024453, valid_loss 1.003562, train_metric nan, valid_metric 0.073485
[4142451:MainThread](2024-04-06 16:25:27,839) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.047462, valid_loss 1.012004, train_metric nan, valid_metric 0.079889
[4142451:MainThread](2024-04-06 16:25:27,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.022542, valid_loss 1.010521, train_metric nan, valid_metric 0.091470
[4142451:MainThread](2024-04-06 16:25:28,149) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.004074, valid_loss 0.998075, train_metric nan, valid_metric 0.088613
[4142451:MainThread](2024-04-06 16:25:28,306) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.013014, valid_loss 0.992086, train_metric nan, valid_metric 0.090976
[4142451:MainThread](2024-04-06 16:25:28,307) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993500 to 0.992086, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:28,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.002424, valid_loss 0.994244, train_metric nan, valid_metric 0.097015
[4142451:MainThread](2024-04-06 16:25:28,598) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.005034, valid_loss 0.989816, train_metric nan, valid_metric 0.092237
[4142451:MainThread](2024-04-06 16:25:28,598) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.992086 to 0.989816, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:28,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.031741, valid_loss 1.004609, train_metric nan, valid_metric 0.084524
[4142451:MainThread](2024-04-06 16:25:28,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.005514, valid_loss 0.992609, train_metric nan, valid_metric 0.088138
[4142451:MainThread](2024-04-06 16:25:29,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.000183, valid_loss 0.991489, train_metric nan, valid_metric 0.084050
[4142451:MainThread](2024-04-06 16:25:29,192) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.002506, valid_loss 1.002568, train_metric nan, valid_metric 0.096044
[4142451:MainThread](2024-04-06 16:25:29,366) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.998305, valid_loss 0.990030, train_metric nan, valid_metric 0.090992
[4142451:MainThread](2024-04-06 16:25:29,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.001313, valid_loss 0.990002, train_metric nan, valid_metric 0.089479
[4142451:MainThread](2024-04-06 16:25:29,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.004087, valid_loss 0.992707, train_metric nan, valid_metric 0.096235
[4142451:MainThread](2024-04-06 16:25:29,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.001625, valid_loss 0.991808, train_metric nan, valid_metric 0.087210
[4142451:MainThread](2024-04-06 16:25:29,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.991721, valid_loss 0.992323, train_metric nan, valid_metric 0.085626
[4142451:MainThread](2024-04-06 16:25:30,091) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.995718, valid_loss 0.989207, train_metric nan, valid_metric 0.094639
[4142451:MainThread](2024-04-06 16:25:30,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.989816 to 0.989207, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:30,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.999987, valid_loss 0.996397, train_metric nan, valid_metric 0.096813
[4142451:MainThread](2024-04-06 16:25:30,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.988892, valid_loss 0.988455, train_metric nan, valid_metric 0.092176
[4142451:MainThread](2024-04-06 16:25:30,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.989207 to 0.988455, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:30,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.991836, valid_loss 0.987440, train_metric nan, valid_metric 0.097780
[4142451:MainThread](2024-04-06 16:25:30,538) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.988455 to 0.987440, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:30,684) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.994170, valid_loss 0.990030, train_metric nan, valid_metric 0.082745
[4142451:MainThread](2024-04-06 16:25:30,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.991166, valid_loss 0.988602, train_metric nan, valid_metric 0.091644
[4142451:MainThread](2024-04-06 16:25:30,963) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.989103, valid_loss 0.991727, train_metric nan, valid_metric 0.081987
[4142451:MainThread](2024-04-06 16:25:31,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.991913, valid_loss 0.989337, train_metric nan, valid_metric 0.093988
[4142451:MainThread](2024-04-06 16:25:31,251) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.990019, valid_loss 0.990288, train_metric nan, valid_metric 0.089060
[4142451:MainThread](2024-04-06 16:25:31,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.987687, valid_loss 0.988642, train_metric nan, valid_metric 0.095541
[4142451:MainThread](2024-04-06 16:25:31,585) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.996193, valid_loss 0.988853, train_metric nan, valid_metric 0.093745
[4142451:MainThread](2024-04-06 16:25:31,747) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.994367, valid_loss 0.989769, train_metric nan, valid_metric 0.089083
[4142451:MainThread](2024-04-06 16:25:31,894) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.989267, valid_loss 0.990794, train_metric nan, valid_metric 0.084877
[4142451:MainThread](2024-04-06 16:25:32,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.979649, valid_loss 0.989198, train_metric nan, valid_metric 0.094269
[4142451:MainThread](2024-04-06 16:25:32,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.993364, valid_loss 0.989417, train_metric nan, valid_metric 0.099084
[4142451:MainThread](2024-04-06 16:25:32,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.983994, valid_loss 0.987401, train_metric nan, valid_metric 0.095430
[4142451:MainThread](2024-04-06 16:25:32,349) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.987440 to 0.987401, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:32,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.971315, valid_loss 0.988132, train_metric nan, valid_metric 0.095393
[4142451:MainThread](2024-04-06 16:25:32,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.988384, valid_loss 0.987778, train_metric nan, valid_metric 0.095962
[4142451:MainThread](2024-04-06 16:25:32,782) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.984586, valid_loss 0.988109, train_metric nan, valid_metric 0.098324
[4142451:MainThread](2024-04-06 16:25:32,929) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.991211, valid_loss 0.989050, train_metric nan, valid_metric 0.094821
[4142451:MainThread](2024-04-06 16:25:33,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.980100, valid_loss 0.989184, train_metric nan, valid_metric 0.095377
[4142451:MainThread](2024-04-06 16:25:33,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.988164, valid_loss 0.989084, train_metric nan, valid_metric 0.099131
[4142451:MainThread](2024-04-06 16:25:33,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.984713, valid_loss 0.991415, train_metric nan, valid_metric 0.092531
[4142451:MainThread](2024-04-06 16:25:33,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.979315, valid_loss 0.989578, train_metric nan, valid_metric 0.091187
[4142451:MainThread](2024-04-06 16:25:33,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.989399, valid_loss 0.990356, train_metric nan, valid_metric 0.095766
[4142451:MainThread](2024-04-06 16:25:33,796) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.984295, valid_loss 0.989134, train_metric nan, valid_metric 0.093453
[4142451:MainThread](2024-04-06 16:25:33,936) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.986143, valid_loss 0.987479, train_metric nan, valid_metric 0.097417
[4142451:MainThread](2024-04-06 16:25:34,075) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.985124, valid_loss 0.987802, train_metric nan, valid_metric 0.098841
[4142451:MainThread](2024-04-06 16:25:34,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.981661, valid_loss 0.988210, train_metric nan, valid_metric 0.092919
[4142451:MainThread](2024-04-06 16:25:34,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.984052, valid_loss 0.987365, train_metric nan, valid_metric 0.101036
[4142451:MainThread](2024-04-06 16:25:34,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.987401 to 0.987365, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:34,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.974400, valid_loss 0.987407, train_metric nan, valid_metric 0.096842
[4142451:MainThread](2024-04-06 16:25:34,673) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.981500, valid_loss 0.987559, train_metric nan, valid_metric 0.097005
[4142451:MainThread](2024-04-06 16:25:34,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.978424, valid_loss 0.988621, train_metric nan, valid_metric 0.093596
[4142451:MainThread](2024-04-06 16:25:34,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.976773, valid_loss 0.987780, train_metric nan, valid_metric 0.099639
[4142451:MainThread](2024-04-06 16:25:35,102) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.978772, valid_loss 0.987437, train_metric nan, valid_metric 0.100639
[4142451:MainThread](2024-04-06 16:25:35,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.990572, valid_loss 0.988927, train_metric nan, valid_metric 0.097318
[4142451:MainThread](2024-04-06 16:25:35,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.984448, valid_loss 0.987515, train_metric nan, valid_metric 0.098120
[4142451:MainThread](2024-04-06 16:25:35,528) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.991914, valid_loss 0.988079, train_metric nan, valid_metric 0.094231
[4142451:MainThread](2024-04-06 16:25:35,672) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.974827, valid_loss 0.987912, train_metric nan, valid_metric 0.095791
[4142451:MainThread](2024-04-06 16:25:35,817) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.982016, valid_loss 0.987489, train_metric nan, valid_metric 0.098698
[4142451:MainThread](2024-04-06 16:25:35,960) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.973251, valid_loss 0.988153, train_metric nan, valid_metric 0.094309
[4142451:MainThread](2024-04-06 16:25:36,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.984328, valid_loss 0.989472, train_metric nan, valid_metric 0.083083
[4142451:MainThread](2024-04-06 16:25:36,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.980063, valid_loss 0.988488, train_metric nan, valid_metric 0.091861
[4142451:MainThread](2024-04-06 16:25:36,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.971096, valid_loss 0.988151, train_metric nan, valid_metric 0.094107
[4142451:MainThread](2024-04-06 16:25:36,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.981091, valid_loss 0.988441, train_metric nan, valid_metric 0.094231
[4142451:MainThread](2024-04-06 16:25:36,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.987904, valid_loss 0.987420, train_metric nan, valid_metric 0.096346
[4142451:MainThread](2024-04-06 16:25:36,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.986123, valid_loss 0.987353, train_metric nan, valid_metric 0.098933
[4142451:MainThread](2024-04-06 16:25:36,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.987365 to 0.987353, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:36,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.985256, valid_loss 0.988219, train_metric nan, valid_metric 0.096414
[4142451:MainThread](2024-04-06 16:25:37,130) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.977349, valid_loss 0.987509, train_metric nan, valid_metric 0.097132
[4142451:MainThread](2024-04-06 16:25:37,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.982733, valid_loss 0.987382, train_metric nan, valid_metric 0.096860
[4142451:MainThread](2024-04-06 16:25:37,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.986263, valid_loss 0.988081, train_metric nan, valid_metric 0.096656
[4142451:MainThread](2024-04-06 16:25:37,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.975662, valid_loss 0.987226, train_metric nan, valid_metric 0.097535
[4142451:MainThread](2024-04-06 16:25:37,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.987353 to 0.987226, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:37,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.982292, valid_loss 0.987878, train_metric nan, valid_metric 0.093447
[4142451:MainThread](2024-04-06 16:25:37,850) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.978750, valid_loss 0.987732, train_metric nan, valid_metric 0.095814
[4142451:MainThread](2024-04-06 16:25:37,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.982007, valid_loss 0.987297, train_metric nan, valid_metric 0.097087
[4142451:MainThread](2024-04-06 16:25:38,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.985574, valid_loss 0.987940, train_metric nan, valid_metric 0.093444
[4142451:MainThread](2024-04-06 16:25:38,333) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.986237, valid_loss 0.987890, train_metric nan, valid_metric 0.092957
[4142451:MainThread](2024-04-06 16:25:38,500) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.976280, valid_loss 0.987588, train_metric nan, valid_metric 0.095182
[4142451:MainThread](2024-04-06 16:25:38,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.978221, valid_loss 0.987561, train_metric nan, valid_metric 0.095986
[4142451:MainThread](2024-04-06 16:25:38,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.985189, valid_loss 0.987886, train_metric nan, valid_metric 0.095938
[4142451:MainThread](2024-04-06 16:25:38,907) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.988757, valid_loss 0.987356, train_metric nan, valid_metric 0.097378
[4142451:MainThread](2024-04-06 16:25:39,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.972702, valid_loss 0.987750, train_metric nan, valid_metric 0.096575
[4142451:MainThread](2024-04-06 16:25:39,183) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.986691, valid_loss 0.988204, train_metric nan, valid_metric 0.097429
[4142451:MainThread](2024-04-06 16:25:39,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.982467, valid_loss 0.987590, train_metric nan, valid_metric 0.094341
[4142451:MainThread](2024-04-06 16:25:39,477) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.990753, valid_loss 0.987450, train_metric nan, valid_metric 0.096521
[4142451:MainThread](2024-04-06 16:25:39,621) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.980019, valid_loss 0.987775, train_metric nan, valid_metric 0.095700
[4142451:MainThread](2024-04-06 16:25:39,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.987036, valid_loss 0.987645, train_metric nan, valid_metric 0.096049
[4142451:MainThread](2024-04-06 16:25:39,920) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.985203, valid_loss 0.988013, train_metric nan, valid_metric 0.095966
[4142451:MainThread](2024-04-06 16:25:40,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.980943, valid_loss 0.987664, train_metric nan, valid_metric 0.097618
[4142451:MainThread](2024-04-06 16:25:40,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.979911, valid_loss 0.988334, train_metric nan, valid_metric 0.096883
[4142451:MainThread](2024-04-06 16:25:40,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.986360, valid_loss 0.988092, train_metric nan, valid_metric 0.096386
[4142451:MainThread](2024-04-06 16:25:40,477) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.982694, valid_loss 0.987916, train_metric nan, valid_metric 0.093161
[4142451:MainThread](2024-04-06 16:25:40,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.980021, valid_loss 0.987674, train_metric nan, valid_metric 0.096177
[4142451:MainThread](2024-04-06 16:25:40,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.980129, valid_loss 0.987754, train_metric nan, valid_metric 0.096820
[4142451:MainThread](2024-04-06 16:25:40,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.981120, valid_loss 0.987809, train_metric nan, valid_metric 0.094045
[4142451:MainThread](2024-04-06 16:25:41,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.985576, valid_loss 0.987921, train_metric nan, valid_metric 0.093293
[4142451:MainThread](2024-04-06 16:25:41,187) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.972522, valid_loss 0.987676, train_metric nan, valid_metric 0.095738
[4142451:MainThread](2024-04-06 16:25:41,322) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.976508, valid_loss 0.987651, train_metric nan, valid_metric 0.097173
[4142451:MainThread](2024-04-06 16:25:41,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.988914, valid_loss 0.987704, train_metric nan, valid_metric 0.094557
[4142451:MainThread](2024-04-06 16:25:41,631) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.986279, valid_loss 0.987462, train_metric nan, valid_metric 0.096781
[4142451:MainThread](2024-04-06 16:25:41,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.982270, valid_loss 0.988088, train_metric nan, valid_metric 0.096347
[4142451:MainThread](2024-04-06 16:25:41,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.985715, valid_loss 0.987550, train_metric nan, valid_metric 0.096014
[4142451:MainThread](2024-04-06 16:25:42,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.985898, valid_loss 0.987974, train_metric nan, valid_metric 0.096302
[4142451:MainThread](2024-04-06 16:25:42,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.982031, valid_loss 0.987892, train_metric nan, valid_metric 0.094609
[4142451:MainThread](2024-04-06 16:25:42,346) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.993462, valid_loss 0.987921, train_metric nan, valid_metric 0.095749
[4142451:MainThread](2024-04-06 16:25:42,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 0.980479, valid_loss 0.987768, train_metric nan, valid_metric 0.094026
[4142451:MainThread](2024-04-06 16:25:42,690) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.981766, valid_loss 0.987782, train_metric nan, valid_metric 0.096619
[4142451:MainThread](2024-04-06 16:25:42,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 0.995830, valid_loss 0.987681, train_metric nan, valid_metric 0.097017
[4142451:MainThread](2024-04-06 16:25:42,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 0.976426, valid_loss 0.987639, train_metric nan, valid_metric 0.096168
[4142451:MainThread](2024-04-06 16:25:43,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 0.995895, valid_loss 0.987655, train_metric nan, valid_metric 0.094595
[4142451:MainThread](2024-04-06 16:25:43,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 0.971391, valid_loss 0.987685, train_metric nan, valid_metric 0.097173
[4142451:MainThread](2024-04-06 16:25:43,434) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 0.978258, valid_loss 0.987763, train_metric nan, valid_metric 0.097368
[4142451:MainThread](2024-04-06 16:25:43,603) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 0.972148, valid_loss 0.987696, train_metric nan, valid_metric 0.096638
[4142451:MainThread](2024-04-06 16:25:43,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 0.974437, valid_loss 0.987702, train_metric nan, valid_metric 0.094254
[4142451:MainThread](2024-04-06 16:25:43,899) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 0.982999, valid_loss 0.987351, train_metric nan, valid_metric 0.096762
[4142451:MainThread](2024-04-06 16:25:44,053) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 0.979880, valid_loss 0.987544, train_metric nan, valid_metric 0.096478
[4142451:MainThread](2024-04-06 16:25:44,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 0.980614, valid_loss 0.987914, train_metric nan, valid_metric 0.097085
[4142451:MainThread](2024-04-06 16:25:44,341) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 0.985180, valid_loss 0.987552, train_metric nan, valid_metric 0.096120
[4142451:MainThread](2024-04-06 16:25:44,484) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 0.979587, valid_loss 0.987961, train_metric nan, valid_metric 0.096527
[4142451:MainThread](2024-04-06 16:25:44,621) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 0.971720, valid_loss 0.987933, train_metric nan, valid_metric 0.096860
[4142451:MainThread](2024-04-06 16:25:44,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 0.989793, valid_loss 0.987938, train_metric nan, valid_metric 0.093002
[4142451:MainThread](2024-04-06 16:25:44,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 0.982160, valid_loss 0.987596, train_metric nan, valid_metric 0.095310
[4142451:MainThread](2024-04-06 16:25:44,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:25:45,732) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:25:46,588) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  35%|███▍      | 18/52 [06:10<11:19, 19.99s/it][4142451:MainThread](2024-04-06 16:25:46,596) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:25:46,606) INFO - qlib.workflow - [recorder.py:341] - Recorder 4bc392b02e634238849db03385e8f0d0 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:25:47,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:25:47,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:25:47,342) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:25:47,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:25:50,746) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:25:51,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.290958, valid_loss 1.040307, train_metric nan, valid_metric 0.041951
[4142451:MainThread](2024-04-06 16:25:51,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.040307, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:25:51,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.115782, valid_loss 1.011036, train_metric nan, valid_metric 0.082629
[4142451:MainThread](2024-04-06 16:25:51,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.040307 to 1.011036, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:51,346) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.110462, valid_loss 1.050005, train_metric nan, valid_metric 0.084278
[4142451:MainThread](2024-04-06 16:25:51,517) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.091045, valid_loss 1.044053, train_metric nan, valid_metric 0.081355
[4142451:MainThread](2024-04-06 16:25:51,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.055675, valid_loss 0.992482, train_metric nan, valid_metric 0.086259
[4142451:MainThread](2024-04-06 16:25:51,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.011036 to 0.992482, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:51,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.031769, valid_loss 1.049725, train_metric nan, valid_metric 0.089659
[4142451:MainThread](2024-04-06 16:25:52,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.026519, valid_loss 1.025415, train_metric nan, valid_metric 0.092039
[4142451:MainThread](2024-04-06 16:25:52,187) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.015511, valid_loss 0.997341, train_metric nan, valid_metric 0.089548
[4142451:MainThread](2024-04-06 16:25:52,356) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.026760, valid_loss 0.991950, train_metric nan, valid_metric 0.097236
[4142451:MainThread](2024-04-06 16:25:52,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.992482 to 0.991950, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:52,526) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.018723, valid_loss 1.046729, train_metric nan, valid_metric 0.088101
[4142451:MainThread](2024-04-06 16:25:52,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.015659, valid_loss 1.028543, train_metric nan, valid_metric 0.088978
[4142451:MainThread](2024-04-06 16:25:52,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.014218, valid_loss 0.994330, train_metric nan, valid_metric 0.099561
[4142451:MainThread](2024-04-06 16:25:53,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.005648, valid_loss 0.993270, train_metric nan, valid_metric 0.096561
[4142451:MainThread](2024-04-06 16:25:53,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.014224, valid_loss 1.002760, train_metric nan, valid_metric 0.095575
[4142451:MainThread](2024-04-06 16:25:53,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.008825, valid_loss 0.989613, train_metric nan, valid_metric 0.102726
[4142451:MainThread](2024-04-06 16:25:53,349) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991950 to 0.989613, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:53,516) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.009092, valid_loss 0.995467, train_metric nan, valid_metric 0.090229
[4142451:MainThread](2024-04-06 16:25:53,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.006271, valid_loss 0.993045, train_metric nan, valid_metric 0.088567
[4142451:MainThread](2024-04-06 16:25:53,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.007835, valid_loss 0.991594, train_metric nan, valid_metric 0.084678
[4142451:MainThread](2024-04-06 16:25:53,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.987056, valid_loss 0.990493, train_metric nan, valid_metric 0.095191
[4142451:MainThread](2024-04-06 16:25:54,077) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.021312, valid_loss 1.000238, train_metric nan, valid_metric 0.095508
[4142451:MainThread](2024-04-06 16:25:54,223) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.993079, valid_loss 0.990453, train_metric nan, valid_metric 0.089080
[4142451:MainThread](2024-04-06 16:25:54,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.999096, valid_loss 0.991692, train_metric nan, valid_metric 0.083646
[4142451:MainThread](2024-04-06 16:25:54,526) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.999307, valid_loss 0.988618, train_metric nan, valid_metric 0.101916
[4142451:MainThread](2024-04-06 16:25:54,526) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.989613 to 0.988618, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:54,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.994534, valid_loss 0.985966, train_metric nan, valid_metric 0.102839
[4142451:MainThread](2024-04-06 16:25:54,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.988618 to 0.985966, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:54,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.002227, valid_loss 0.994416, train_metric nan, valid_metric 0.092535
[4142451:MainThread](2024-04-06 16:25:54,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.989579, valid_loss 0.995382, train_metric nan, valid_metric 0.097866
[4142451:MainThread](2024-04-06 16:25:55,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.997079, valid_loss 0.989941, train_metric nan, valid_metric 0.101236
[4142451:MainThread](2024-04-06 16:25:55,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.985159, valid_loss 0.990137, train_metric nan, valid_metric 0.095758
[4142451:MainThread](2024-04-06 16:25:55,416) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.987918, valid_loss 0.987399, train_metric nan, valid_metric 0.102941
[4142451:MainThread](2024-04-06 16:25:55,565) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.996451, valid_loss 0.990576, train_metric nan, valid_metric 0.088922
[4142451:MainThread](2024-04-06 16:25:55,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.996253, valid_loss 1.001374, train_metric nan, valid_metric 0.087710
[4142451:MainThread](2024-04-06 16:25:55,856) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.985803, valid_loss 0.992854, train_metric nan, valid_metric 0.095734
[4142451:MainThread](2024-04-06 16:25:56,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.993548, valid_loss 0.995516, train_metric nan, valid_metric 0.099576
[4142451:MainThread](2024-04-06 16:25:56,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.987543, valid_loss 0.988459, train_metric nan, valid_metric 0.104003
[4142451:MainThread](2024-04-06 16:25:56,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.986077, valid_loss 0.986803, train_metric nan, valid_metric 0.099978
[4142451:MainThread](2024-04-06 16:25:56,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.987780, valid_loss 0.987155, train_metric nan, valid_metric 0.102105
[4142451:MainThread](2024-04-06 16:25:56,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.986957, valid_loss 0.986413, train_metric nan, valid_metric 0.102863
[4142451:MainThread](2024-04-06 16:25:56,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.986963, valid_loss 0.988621, train_metric nan, valid_metric 0.092288
[4142451:MainThread](2024-04-06 16:25:56,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.985201, valid_loss 0.990852, train_metric nan, valid_metric 0.097707
[4142451:MainThread](2024-04-06 16:25:57,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.982782, valid_loss 0.990059, train_metric nan, valid_metric 0.099261
[4142451:MainThread](2024-04-06 16:25:57,234) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.010925, valid_loss 0.987067, train_metric nan, valid_metric 0.099793
[4142451:MainThread](2024-04-06 16:25:57,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.982586, valid_loss 0.986950, train_metric nan, valid_metric 0.101089
[4142451:MainThread](2024-04-06 16:25:57,533) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.989595, valid_loss 0.986734, train_metric nan, valid_metric 0.104420
[4142451:MainThread](2024-04-06 16:25:57,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.995065, valid_loss 0.987370, train_metric nan, valid_metric 0.100262
[4142451:MainThread](2024-04-06 16:25:57,830) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.988196, valid_loss 0.986781, train_metric nan, valid_metric 0.106780
[4142451:MainThread](2024-04-06 16:25:57,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.978705, valid_loss 0.986777, train_metric nan, valid_metric 0.101244
[4142451:MainThread](2024-04-06 16:25:58,120) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.986674, valid_loss 0.986947, train_metric nan, valid_metric 0.100940
[4142451:MainThread](2024-04-06 16:25:58,278) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.990162, valid_loss 0.986741, train_metric nan, valid_metric 0.103253
[4142451:MainThread](2024-04-06 16:25:58,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.986394, valid_loss 0.986356, train_metric nan, valid_metric 0.102720
[4142451:MainThread](2024-04-06 16:25:58,579) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.976996, valid_loss 0.985786, train_metric nan, valid_metric 0.105001
[4142451:MainThread](2024-04-06 16:25:58,580) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.985966 to 0.985786, save checkpoint.
[4142451:MainThread](2024-04-06 16:25:58,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.993129, valid_loss 0.986176, train_metric nan, valid_metric 0.103489
[4142451:MainThread](2024-04-06 16:25:58,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.975042, valid_loss 0.989087, train_metric nan, valid_metric 0.103706
[4142451:MainThread](2024-04-06 16:25:59,047) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.980258, valid_loss 0.987584, train_metric nan, valid_metric 0.103820
[4142451:MainThread](2024-04-06 16:25:59,196) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.999310, valid_loss 0.986073, train_metric nan, valid_metric 0.104815
[4142451:MainThread](2024-04-06 16:25:59,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.989952, valid_loss 0.986537, train_metric nan, valid_metric 0.100710
[4142451:MainThread](2024-04-06 16:25:59,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.973794, valid_loss 0.986252, train_metric nan, valid_metric 0.103901
[4142451:MainThread](2024-04-06 16:25:59,667) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.989363, valid_loss 0.987704, train_metric nan, valid_metric 0.097461
[4142451:MainThread](2024-04-06 16:25:59,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.984624, valid_loss 0.986083, train_metric nan, valid_metric 0.105362
[4142451:MainThread](2024-04-06 16:26:00,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.977885, valid_loss 0.986143, train_metric nan, valid_metric 0.103067
[4142451:MainThread](2024-04-06 16:26:00,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.984541, valid_loss 0.986853, train_metric nan, valid_metric 0.102239
[4142451:MainThread](2024-04-06 16:26:00,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.992689, valid_loss 0.986236, train_metric nan, valid_metric 0.103541
[4142451:MainThread](2024-04-06 16:26:00,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.978658, valid_loss 0.986808, train_metric nan, valid_metric 0.101489
[4142451:MainThread](2024-04-06 16:26:00,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.973470, valid_loss 0.987197, train_metric nan, valid_metric 0.101917
[4142451:MainThread](2024-04-06 16:26:00,817) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.992354, valid_loss 0.986808, train_metric nan, valid_metric 0.100935
[4142451:MainThread](2024-04-06 16:26:00,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.981800, valid_loss 0.987139, train_metric nan, valid_metric 0.100381
[4142451:MainThread](2024-04-06 16:26:01,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.988651, valid_loss 0.987737, train_metric nan, valid_metric 0.100633
[4142451:MainThread](2024-04-06 16:26:01,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.980389, valid_loss 0.987379, train_metric nan, valid_metric 0.099234
[4142451:MainThread](2024-04-06 16:26:01,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.984836, valid_loss 0.986976, train_metric nan, valid_metric 0.101428
[4142451:MainThread](2024-04-06 16:26:01,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.987709, valid_loss 0.986487, train_metric nan, valid_metric 0.104397
[4142451:MainThread](2024-04-06 16:26:01,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.973843, valid_loss 0.987293, train_metric nan, valid_metric 0.099091
[4142451:MainThread](2024-04-06 16:26:02,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.993119, valid_loss 0.986642, train_metric nan, valid_metric 0.102211
[4142451:MainThread](2024-04-06 16:26:02,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.986048, valid_loss 0.987383, train_metric nan, valid_metric 0.100321
[4142451:MainThread](2024-04-06 16:26:02,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.979573, valid_loss 0.987253, train_metric nan, valid_metric 0.100852
[4142451:MainThread](2024-04-06 16:26:02,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.986262, valid_loss 0.986402, train_metric nan, valid_metric 0.102975
[4142451:MainThread](2024-04-06 16:26:02,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.977939, valid_loss 0.986353, train_metric nan, valid_metric 0.102503
[4142451:MainThread](2024-04-06 16:26:03,052) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.980965, valid_loss 0.985912, train_metric nan, valid_metric 0.105065
[4142451:MainThread](2024-04-06 16:26:03,270) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.993201, valid_loss 0.986919, train_metric nan, valid_metric 0.099416
[4142451:MainThread](2024-04-06 16:26:03,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.988719, valid_loss 0.986252, train_metric nan, valid_metric 0.103352
[4142451:MainThread](2024-04-06 16:26:03,709) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.994311, valid_loss 0.986254, train_metric nan, valid_metric 0.103111
[4142451:MainThread](2024-04-06 16:26:03,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.982906, valid_loss 0.986696, train_metric nan, valid_metric 0.100892
[4142451:MainThread](2024-04-06 16:26:04,075) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.984692, valid_loss 0.986996, train_metric nan, valid_metric 0.100031
[4142451:MainThread](2024-04-06 16:26:04,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.975554, valid_loss 0.987330, train_metric nan, valid_metric 0.101120
[4142451:MainThread](2024-04-06 16:26:04,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.976640, valid_loss 0.987296, train_metric nan, valid_metric 0.102064
[4142451:MainThread](2024-04-06 16:26:04,496) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.988346, valid_loss 0.987005, train_metric nan, valid_metric 0.099659
[4142451:MainThread](2024-04-06 16:26:04,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.979677, valid_loss 0.986712, train_metric nan, valid_metric 0.101252
[4142451:MainThread](2024-04-06 16:26:04,762) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.983119, valid_loss 0.986875, train_metric nan, valid_metric 0.101582
[4142451:MainThread](2024-04-06 16:26:04,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.982059, valid_loss 0.985955, train_metric nan, valid_metric 0.104252
[4142451:MainThread](2024-04-06 16:26:05,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.988482, valid_loss 0.986428, train_metric nan, valid_metric 0.102105
[4142451:MainThread](2024-04-06 16:26:05,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.983967, valid_loss 0.986377, train_metric nan, valid_metric 0.102299
[4142451:MainThread](2024-04-06 16:26:05,305) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.976198, valid_loss 0.986447, train_metric nan, valid_metric 0.102211
[4142451:MainThread](2024-04-06 16:26:05,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.979627, valid_loss 0.986571, train_metric nan, valid_metric 0.102259
[4142451:MainThread](2024-04-06 16:26:05,598) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.987448, valid_loss 0.986556, train_metric nan, valid_metric 0.102512
[4142451:MainThread](2024-04-06 16:26:05,735) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.992338, valid_loss 0.986785, train_metric nan, valid_metric 0.102592
[4142451:MainThread](2024-04-06 16:26:05,873) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.979196, valid_loss 0.986835, train_metric nan, valid_metric 0.100915
[4142451:MainThread](2024-04-06 16:26:06,015) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.977030, valid_loss 0.986863, train_metric nan, valid_metric 0.101463
[4142451:MainThread](2024-04-06 16:26:06,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.978619, valid_loss 0.986850, train_metric nan, valid_metric 0.102046
[4142451:MainThread](2024-04-06 16:26:06,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.982831, valid_loss 0.985934, train_metric nan, valid_metric 0.104894
[4142451:MainThread](2024-04-06 16:26:06,427) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.981978, valid_loss 0.986492, train_metric nan, valid_metric 0.102442
[4142451:MainThread](2024-04-06 16:26:06,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.982188, valid_loss 0.987078, train_metric nan, valid_metric 0.100552
[4142451:MainThread](2024-04-06 16:26:06,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.980621, valid_loss 0.986708, train_metric nan, valid_metric 0.101649
[4142451:MainThread](2024-04-06 16:26:06,705) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:26:07,538) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:26:08,408) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  37%|███▋      | 19/52 [06:32<11:17, 20.54s/it][4142451:MainThread](2024-04-06 16:26:08,417) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:26:08,431) INFO - qlib.workflow - [recorder.py:341] - Recorder 841e27a7bad04e96adfad7efa303467c starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:26:09,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:26:09,037) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:26:09,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:26:09,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:26:12,582) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:26:12,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.215681, valid_loss 1.025677, train_metric nan, valid_metric 0.048528
[4142451:MainThread](2024-04-06 16:26:12,909) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.025677, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:26:13,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.074991, valid_loss 1.020305, train_metric nan, valid_metric 0.057034
[4142451:MainThread](2024-04-06 16:26:13,047) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.025677 to 1.020305, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:13,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.047049, valid_loss 1.018594, train_metric nan, valid_metric 0.057149
[4142451:MainThread](2024-04-06 16:26:13,183) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.020305 to 1.018594, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:13,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.032203, valid_loss 1.003532, train_metric nan, valid_metric 0.054227
[4142451:MainThread](2024-04-06 16:26:13,333) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.018594 to 1.003532, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:13,477) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.055070, valid_loss 1.011989, train_metric nan, valid_metric 0.047526
[4142451:MainThread](2024-04-06 16:26:13,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.024708, valid_loss 0.994527, train_metric nan, valid_metric 0.077220
[4142451:MainThread](2024-04-06 16:26:13,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003532 to 0.994527, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:13,744) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.061116, valid_loss 1.082751, train_metric nan, valid_metric 0.067603
[4142451:MainThread](2024-04-06 16:26:13,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.017836, valid_loss 0.993591, train_metric nan, valid_metric 0.088026
[4142451:MainThread](2024-04-06 16:26:13,887) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994527 to 0.993591, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:14,030) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.052900, valid_loss 1.037701, train_metric nan, valid_metric 0.064796
[4142451:MainThread](2024-04-06 16:26:14,170) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.037964, valid_loss 0.994821, train_metric nan, valid_metric 0.076032
[4142451:MainThread](2024-04-06 16:26:14,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.002861, valid_loss 0.991599, train_metric nan, valid_metric 0.087539
[4142451:MainThread](2024-04-06 16:26:14,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993591 to 0.991599, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:14,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 0.986425, valid_loss 0.993009, train_metric nan, valid_metric 0.080162
[4142451:MainThread](2024-04-06 16:26:14,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.994473, valid_loss 0.988380, train_metric nan, valid_metric 0.094283
[4142451:MainThread](2024-04-06 16:26:14,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991599 to 0.988380, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:14,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.007331, valid_loss 0.987469, train_metric nan, valid_metric 0.099040
[4142451:MainThread](2024-04-06 16:26:14,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.988380 to 0.987469, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:14,881) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.989752, valid_loss 0.988303, train_metric nan, valid_metric 0.094284
[4142451:MainThread](2024-04-06 16:26:15,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.998673, valid_loss 0.989109, train_metric nan, valid_metric 0.101849
[4142451:MainThread](2024-04-06 16:26:15,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.988666, valid_loss 0.991383, train_metric nan, valid_metric 0.079828
[4142451:MainThread](2024-04-06 16:26:15,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.990084, valid_loss 0.987785, train_metric nan, valid_metric 0.097074
[4142451:MainThread](2024-04-06 16:26:15,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.989348, valid_loss 0.988565, train_metric nan, valid_metric 0.091087
[4142451:MainThread](2024-04-06 16:26:15,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.995474, valid_loss 0.992892, train_metric nan, valid_metric 0.100510
[4142451:MainThread](2024-04-06 16:26:15,737) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.991323, valid_loss 0.988531, train_metric nan, valid_metric 0.094870
[4142451:MainThread](2024-04-06 16:26:15,869) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.993076, valid_loss 0.988676, train_metric nan, valid_metric 0.092215
[4142451:MainThread](2024-04-06 16:26:16,014) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.998274, valid_loss 0.990859, train_metric nan, valid_metric 0.093217
[4142451:MainThread](2024-04-06 16:26:16,153) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.989089, valid_loss 0.992299, train_metric nan, valid_metric 0.082253
[4142451:MainThread](2024-04-06 16:26:16,298) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.988858, valid_loss 0.988658, train_metric nan, valid_metric 0.096114
[4142451:MainThread](2024-04-06 16:26:16,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.985762, valid_loss 0.988312, train_metric nan, valid_metric 0.094385
[4142451:MainThread](2024-04-06 16:26:16,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.987205, valid_loss 0.987652, train_metric nan, valid_metric 0.094961
[4142451:MainThread](2024-04-06 16:26:16,731) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.983864, valid_loss 0.987140, train_metric nan, valid_metric 0.097963
[4142451:MainThread](2024-04-06 16:26:16,731) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.987469 to 0.987140, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:16,869) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.984902, valid_loss 0.987566, train_metric nan, valid_metric 0.095072
[4142451:MainThread](2024-04-06 16:26:17,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.995364, valid_loss 0.987675, train_metric nan, valid_metric 0.094364
[4142451:MainThread](2024-04-06 16:26:17,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.984522, valid_loss 0.988247, train_metric nan, valid_metric 0.092555
[4142451:MainThread](2024-04-06 16:26:17,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.984554, valid_loss 0.987002, train_metric nan, valid_metric 0.100198
[4142451:MainThread](2024-04-06 16:26:17,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.987140 to 0.987002, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:17,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.985293, valid_loss 0.987285, train_metric nan, valid_metric 0.096787
[4142451:MainThread](2024-04-06 16:26:17,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.989078, valid_loss 0.989319, train_metric nan, valid_metric 0.094643
[4142451:MainThread](2024-04-06 16:26:17,738) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.993907, valid_loss 0.988635, train_metric nan, valid_metric 0.091308
[4142451:MainThread](2024-04-06 16:26:17,892) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.997288, valid_loss 0.987390, train_metric nan, valid_metric 0.100652
[4142451:MainThread](2024-04-06 16:26:18,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.977103, valid_loss 0.989734, train_metric nan, valid_metric 0.099226
[4142451:MainThread](2024-04-06 16:26:18,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.984818, valid_loss 0.988729, train_metric nan, valid_metric 0.095372
[4142451:MainThread](2024-04-06 16:26:18,342) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.983830, valid_loss 0.988023, train_metric nan, valid_metric 0.094715
[4142451:MainThread](2024-04-06 16:26:18,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.985448, valid_loss 0.990144, train_metric nan, valid_metric 0.087336
[4142451:MainThread](2024-04-06 16:26:18,626) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.979673, valid_loss 0.990146, train_metric nan, valid_metric 0.091588
[4142451:MainThread](2024-04-06 16:26:18,759) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.986539, valid_loss 0.987279, train_metric nan, valid_metric 0.098896
[4142451:MainThread](2024-04-06 16:26:18,926) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.980725, valid_loss 0.990140, train_metric nan, valid_metric 0.087917
[4142451:MainThread](2024-04-06 16:26:19,084) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.978355, valid_loss 0.987866, train_metric nan, valid_metric 0.093064
[4142451:MainThread](2024-04-06 16:26:19,213) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.980241, valid_loss 0.989059, train_metric nan, valid_metric 0.089812
[4142451:MainThread](2024-04-06 16:26:19,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.989767, valid_loss 0.987317, train_metric nan, valid_metric 0.096924
[4142451:MainThread](2024-04-06 16:26:19,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.989131, valid_loss 0.988759, train_metric nan, valid_metric 0.088168
[4142451:MainThread](2024-04-06 16:26:19,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.985962, valid_loss 0.988606, train_metric nan, valid_metric 0.090939
[4142451:MainThread](2024-04-06 16:26:19,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.989567, valid_loss 0.988608, train_metric nan, valid_metric 0.088793
[4142451:MainThread](2024-04-06 16:26:19,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.976621, valid_loss 0.987708, train_metric nan, valid_metric 0.093962
[4142451:MainThread](2024-04-06 16:26:20,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.969409, valid_loss 0.988044, train_metric nan, valid_metric 0.094504
[4142451:MainThread](2024-04-06 16:26:20,184) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.985481, valid_loss 0.990880, train_metric nan, valid_metric 0.084666
[4142451:MainThread](2024-04-06 16:26:20,320) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.981761, valid_loss 0.988408, train_metric nan, valid_metric 0.093781
[4142451:MainThread](2024-04-06 16:26:20,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.988291, valid_loss 0.987846, train_metric nan, valid_metric 0.095970
[4142451:MainThread](2024-04-06 16:26:20,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.985029, valid_loss 0.987936, train_metric nan, valid_metric 0.093599
[4142451:MainThread](2024-04-06 16:26:20,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.989548, valid_loss 0.987620, train_metric nan, valid_metric 0.094471
[4142451:MainThread](2024-04-06 16:26:20,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.984340, valid_loss 0.988871, train_metric nan, valid_metric 0.093644
[4142451:MainThread](2024-04-06 16:26:21,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.992060, valid_loss 0.987795, train_metric nan, valid_metric 0.097412
[4142451:MainThread](2024-04-06 16:26:21,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.974950, valid_loss 0.987721, train_metric nan, valid_metric 0.094871
[4142451:MainThread](2024-04-06 16:26:21,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.986590, valid_loss 0.988446, train_metric nan, valid_metric 0.091359
[4142451:MainThread](2024-04-06 16:26:21,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.983488, valid_loss 0.988109, train_metric nan, valid_metric 0.094005
[4142451:MainThread](2024-04-06 16:26:21,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.993366, valid_loss 0.988260, train_metric nan, valid_metric 0.092264
[4142451:MainThread](2024-04-06 16:26:21,661) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.979474, valid_loss 0.988770, train_metric nan, valid_metric 0.087948
[4142451:MainThread](2024-04-06 16:26:21,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.987331, valid_loss 0.989132, train_metric nan, valid_metric 0.093496
[4142451:MainThread](2024-04-06 16:26:21,931) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.985937, valid_loss 0.988268, train_metric nan, valid_metric 0.094850
[4142451:MainThread](2024-04-06 16:26:22,075) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.979243, valid_loss 0.987717, train_metric nan, valid_metric 0.093769
[4142451:MainThread](2024-04-06 16:26:22,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.980000, valid_loss 0.987398, train_metric nan, valid_metric 0.095826
[4142451:MainThread](2024-04-06 16:26:22,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.976766, valid_loss 0.987406, train_metric nan, valid_metric 0.095486
[4142451:MainThread](2024-04-06 16:26:22,551) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.989505, valid_loss 0.988137, train_metric nan, valid_metric 0.091675
[4142451:MainThread](2024-04-06 16:26:22,702) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.990786, valid_loss 0.987553, train_metric nan, valid_metric 0.094745
[4142451:MainThread](2024-04-06 16:26:22,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.978561, valid_loss 0.988126, train_metric nan, valid_metric 0.091873
[4142451:MainThread](2024-04-06 16:26:22,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.980855, valid_loss 0.987231, train_metric nan, valid_metric 0.096046
[4142451:MainThread](2024-04-06 16:26:23,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.972881, valid_loss 0.987709, train_metric nan, valid_metric 0.094288
[4142451:MainThread](2024-04-06 16:26:23,316) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.976539, valid_loss 0.987561, train_metric nan, valid_metric 0.094587
[4142451:MainThread](2024-04-06 16:26:23,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.982526, valid_loss 0.988017, train_metric nan, valid_metric 0.093308
[4142451:MainThread](2024-04-06 16:26:23,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.977194, valid_loss 0.987642, train_metric nan, valid_metric 0.095025
[4142451:MainThread](2024-04-06 16:26:23,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.974574, valid_loss 0.987597, train_metric nan, valid_metric 0.094862
[4142451:MainThread](2024-04-06 16:26:23,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.986677, valid_loss 0.988176, train_metric nan, valid_metric 0.093075
[4142451:MainThread](2024-04-06 16:26:24,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.971278, valid_loss 0.987651, train_metric nan, valid_metric 0.094732
[4142451:MainThread](2024-04-06 16:26:24,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.987526, valid_loss 0.987211, train_metric nan, valid_metric 0.097319
[4142451:MainThread](2024-04-06 16:26:24,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.983482, valid_loss 0.987435, train_metric nan, valid_metric 0.095539
[4142451:MainThread](2024-04-06 16:26:24,502) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.979335, valid_loss 0.987055, train_metric nan, valid_metric 0.097348
[4142451:MainThread](2024-04-06 16:26:24,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:26:25,320) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:26:26,171) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  38%|███▊      | 20/52 [06:50<10:30, 19.71s/it][4142451:MainThread](2024-04-06 16:26:26,179) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:26:26,188) INFO - qlib.workflow - [recorder.py:341] - Recorder 4996a1d178354c2ea677c91ff06b49df starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:26:26,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:26:26,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:26:26,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:26:26,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:26:30,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:26:30,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.308180, valid_loss 1.034310, train_metric nan, valid_metric 0.042927
[4142451:MainThread](2024-04-06 16:26:30,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.034310, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:26:30,643) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.108029, valid_loss 1.021217, train_metric nan, valid_metric 0.040481
[4142451:MainThread](2024-04-06 16:26:30,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.034310 to 1.021217, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:30,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.070514, valid_loss 1.007648, train_metric nan, valid_metric 0.041051
[4142451:MainThread](2024-04-06 16:26:30,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.021217 to 1.007648, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:30,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.053328, valid_loss 1.024555, train_metric nan, valid_metric 0.036242
[4142451:MainThread](2024-04-06 16:26:31,075) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.042341, valid_loss 1.021685, train_metric nan, valid_metric 0.039278
[4142451:MainThread](2024-04-06 16:26:31,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.052666, valid_loss 1.032351, train_metric nan, valid_metric 0.037199
[4142451:MainThread](2024-04-06 16:26:31,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.026900, valid_loss 1.005677, train_metric nan, valid_metric 0.034751
[4142451:MainThread](2024-04-06 16:26:31,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.007648 to 1.005677, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:31,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.014276, valid_loss 1.014513, train_metric nan, valid_metric 0.018250
[4142451:MainThread](2024-04-06 16:26:31,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.024130, valid_loss 1.015066, train_metric nan, valid_metric 0.046501
[4142451:MainThread](2024-04-06 16:26:31,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.039902, valid_loss 1.011853, train_metric nan, valid_metric 0.041850
[4142451:MainThread](2024-04-06 16:26:31,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.029696, valid_loss 1.018343, train_metric nan, valid_metric 0.027464
[4142451:MainThread](2024-04-06 16:26:32,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.019845, valid_loss 0.997742, train_metric nan, valid_metric 0.064175
[4142451:MainThread](2024-04-06 16:26:32,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.005677 to 0.997742, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:32,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.005206, valid_loss 0.998695, train_metric nan, valid_metric 0.053519
[4142451:MainThread](2024-04-06 16:26:32,349) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.010317, valid_loss 1.011987, train_metric nan, valid_metric 0.036452
[4142451:MainThread](2024-04-06 16:26:32,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.010483, valid_loss 1.025741, train_metric nan, valid_metric 0.038012
[4142451:MainThread](2024-04-06 16:26:32,667) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.001755, valid_loss 0.998179, train_metric nan, valid_metric 0.058894
[4142451:MainThread](2024-04-06 16:26:32,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.001106, valid_loss 0.994440, train_metric nan, valid_metric 0.060118
[4142451:MainThread](2024-04-06 16:26:32,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997742 to 0.994440, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:32,931) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.011045, valid_loss 1.007087, train_metric nan, valid_metric 0.056791
[4142451:MainThread](2024-04-06 16:26:33,059) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.014637, valid_loss 1.000103, train_metric nan, valid_metric 0.042703
[4142451:MainThread](2024-04-06 16:26:33,195) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.992516, valid_loss 1.003482, train_metric nan, valid_metric 0.050120
[4142451:MainThread](2024-04-06 16:26:33,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.000440, valid_loss 0.994328, train_metric nan, valid_metric 0.071744
[4142451:MainThread](2024-04-06 16:26:33,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994440 to 0.994328, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:33,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.998524, valid_loss 0.995405, train_metric nan, valid_metric 0.055170
[4142451:MainThread](2024-04-06 16:26:33,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.016513, valid_loss 0.997138, train_metric nan, valid_metric 0.053528
[4142451:MainThread](2024-04-06 16:26:33,755) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.989308, valid_loss 0.995818, train_metric nan, valid_metric 0.058138
[4142451:MainThread](2024-04-06 16:26:33,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.992333, valid_loss 0.996701, train_metric nan, valid_metric 0.056024
[4142451:MainThread](2024-04-06 16:26:34,030) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.997922, valid_loss 1.005036, train_metric nan, valid_metric 0.040420
[4142451:MainThread](2024-04-06 16:26:34,164) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.989752, valid_loss 0.996110, train_metric nan, valid_metric 0.062467
[4142451:MainThread](2024-04-06 16:26:34,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.980095, valid_loss 0.992687, train_metric nan, valid_metric 0.065239
[4142451:MainThread](2024-04-06 16:26:34,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994328 to 0.992687, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:34,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.985921, valid_loss 0.994833, train_metric nan, valid_metric 0.066548
[4142451:MainThread](2024-04-06 16:26:34,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.997848, valid_loss 0.996300, train_metric nan, valid_metric 0.062315
[4142451:MainThread](2024-04-06 16:26:34,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.982947, valid_loss 0.998065, train_metric nan, valid_metric 0.051228
[4142451:MainThread](2024-04-06 16:26:34,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.990770, valid_loss 0.995366, train_metric nan, valid_metric 0.066184
[4142451:MainThread](2024-04-06 16:26:34,996) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.986911, valid_loss 0.999231, train_metric nan, valid_metric 0.046716
[4142451:MainThread](2024-04-06 16:26:35,132) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.996844, valid_loss 0.998507, train_metric nan, valid_metric 0.059083
[4142451:MainThread](2024-04-06 16:26:35,268) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.981040, valid_loss 0.997614, train_metric nan, valid_metric 0.047374
[4142451:MainThread](2024-04-06 16:26:35,413) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.986704, valid_loss 0.997556, train_metric nan, valid_metric 0.062166
[4142451:MainThread](2024-04-06 16:26:35,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.989170, valid_loss 1.001178, train_metric nan, valid_metric 0.039963
[4142451:MainThread](2024-04-06 16:26:35,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.985954, valid_loss 1.000712, train_metric nan, valid_metric 0.053155
[4142451:MainThread](2024-04-06 16:26:35,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.994054, valid_loss 0.998708, train_metric nan, valid_metric 0.056161
[4142451:MainThread](2024-04-06 16:26:35,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.977078, valid_loss 0.997509, train_metric nan, valid_metric 0.049424
[4142451:MainThread](2024-04-06 16:26:36,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.993645, valid_loss 1.000078, train_metric nan, valid_metric 0.045471
[4142451:MainThread](2024-04-06 16:26:36,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.983025, valid_loss 0.998332, train_metric nan, valid_metric 0.052559
[4142451:MainThread](2024-04-06 16:26:36,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.983253, valid_loss 0.996223, train_metric nan, valid_metric 0.056166
[4142451:MainThread](2024-04-06 16:26:36,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.992316, valid_loss 0.994902, train_metric nan, valid_metric 0.061886
[4142451:MainThread](2024-04-06 16:26:36,707) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.980015, valid_loss 0.998002, train_metric nan, valid_metric 0.055677
[4142451:MainThread](2024-04-06 16:26:36,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.976036, valid_loss 0.999925, train_metric nan, valid_metric 0.060269
[4142451:MainThread](2024-04-06 16:26:36,976) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.988783, valid_loss 0.997730, train_metric nan, valid_metric 0.063715
[4142451:MainThread](2024-04-06 16:26:37,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.984692, valid_loss 0.997119, train_metric nan, valid_metric 0.050705
[4142451:MainThread](2024-04-06 16:26:37,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.989079, valid_loss 0.995840, train_metric nan, valid_metric 0.058721
[4142451:MainThread](2024-04-06 16:26:37,413) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.985589, valid_loss 0.994368, train_metric nan, valid_metric 0.064811
[4142451:MainThread](2024-04-06 16:26:37,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.988267, valid_loss 0.997257, train_metric nan, valid_metric 0.065005
[4142451:MainThread](2024-04-06 16:26:37,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.987615, valid_loss 0.996178, train_metric nan, valid_metric 0.057599
[4142451:MainThread](2024-04-06 16:26:37,850) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.983623, valid_loss 0.996013, train_metric nan, valid_metric 0.058371
[4142451:MainThread](2024-04-06 16:26:37,995) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.982182, valid_loss 0.996759, train_metric nan, valid_metric 0.059738
[4142451:MainThread](2024-04-06 16:26:38,134) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.989510, valid_loss 0.995193, train_metric nan, valid_metric 0.059105
[4142451:MainThread](2024-04-06 16:26:38,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.982019, valid_loss 0.996859, train_metric nan, valid_metric 0.049291
[4142451:MainThread](2024-04-06 16:26:38,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.990742, valid_loss 0.997665, train_metric nan, valid_metric 0.053482
[4142451:MainThread](2024-04-06 16:26:38,561) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.985350, valid_loss 0.994310, train_metric nan, valid_metric 0.059896
[4142451:MainThread](2024-04-06 16:26:38,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.989331, valid_loss 0.994883, train_metric nan, valid_metric 0.058821
[4142451:MainThread](2024-04-06 16:26:38,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.982534, valid_loss 0.996190, train_metric nan, valid_metric 0.062773
[4142451:MainThread](2024-04-06 16:26:38,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.985465, valid_loss 0.997349, train_metric nan, valid_metric 0.052677
[4142451:MainThread](2024-04-06 16:26:39,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.985046, valid_loss 0.995737, train_metric nan, valid_metric 0.057163
[4142451:MainThread](2024-04-06 16:26:39,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.980509, valid_loss 0.994600, train_metric nan, valid_metric 0.056482
[4142451:MainThread](2024-04-06 16:26:39,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.978747, valid_loss 0.996549, train_metric nan, valid_metric 0.057547
[4142451:MainThread](2024-04-06 16:26:39,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.989518, valid_loss 0.995164, train_metric nan, valid_metric 0.052132
[4142451:MainThread](2024-04-06 16:26:39,735) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.989626, valid_loss 0.996327, train_metric nan, valid_metric 0.055022
[4142451:MainThread](2024-04-06 16:26:39,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.972854, valid_loss 0.996286, train_metric nan, valid_metric 0.055357
[4142451:MainThread](2024-04-06 16:26:40,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.977003, valid_loss 0.999070, train_metric nan, valid_metric 0.048057
[4142451:MainThread](2024-04-06 16:26:40,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.975035, valid_loss 0.995648, train_metric nan, valid_metric 0.051526
[4142451:MainThread](2024-04-06 16:26:40,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.981612, valid_loss 0.996935, train_metric nan, valid_metric 0.055433
[4142451:MainThread](2024-04-06 16:26:40,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.985902, valid_loss 0.995380, train_metric nan, valid_metric 0.055948
[4142451:MainThread](2024-04-06 16:26:40,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.982449, valid_loss 0.995699, train_metric nan, valid_metric 0.057801
[4142451:MainThread](2024-04-06 16:26:40,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.985742, valid_loss 0.995650, train_metric nan, valid_metric 0.050867
[4142451:MainThread](2024-04-06 16:26:40,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.986382, valid_loss 0.995208, train_metric nan, valid_metric 0.058695
[4142451:MainThread](2024-04-06 16:26:41,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.976209, valid_loss 0.994564, train_metric nan, valid_metric 0.056548
[4142451:MainThread](2024-04-06 16:26:41,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.975954, valid_loss 0.996768, train_metric nan, valid_metric 0.053683
[4142451:MainThread](2024-04-06 16:26:41,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.993948, valid_loss 0.995719, train_metric nan, valid_metric 0.055380
[4142451:MainThread](2024-04-06 16:26:41,623) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.979404, valid_loss 0.995459, train_metric nan, valid_metric 0.055875
[4142451:MainThread](2024-04-06 16:26:41,623) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:26:42,455) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:26:43,330) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  40%|████      | 21/52 [07:07<09:47, 18.94s/it][4142451:MainThread](2024-04-06 16:26:43,338) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:26:43,348) INFO - qlib.workflow - [recorder.py:341] - Recorder 580cb26f362a49c697f10875fc53c2ce starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:26:43,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:26:43,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:26:43,955) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:26:43,955) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:26:47,327) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:26:47,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.374076, valid_loss 1.067451, train_metric nan, valid_metric 0.006732
[4142451:MainThread](2024-04-06 16:26:47,716) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.067451, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:26:47,878) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.115485, valid_loss 1.071256, train_metric nan, valid_metric -0.020646
[4142451:MainThread](2024-04-06 16:26:48,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.082249, valid_loss 1.064607, train_metric nan, valid_metric 0.012878
[4142451:MainThread](2024-04-06 16:26:48,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.067451 to 1.064607, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:48,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.062688, valid_loss 1.024510, train_metric nan, valid_metric 0.004533
[4142451:MainThread](2024-04-06 16:26:48,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.064607 to 1.024510, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:48,386) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.040958, valid_loss 1.021863, train_metric nan, valid_metric 0.015381
[4142451:MainThread](2024-04-06 16:26:48,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.024510 to 1.021863, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:48,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.038172, valid_loss 1.009696, train_metric nan, valid_metric 0.017582
[4142451:MainThread](2024-04-06 16:26:48,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.021863 to 1.009696, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:48,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.072560, valid_loss 1.095138, train_metric nan, valid_metric 0.000128
[4142451:MainThread](2024-04-06 16:26:48,846) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.076408, valid_loss 1.046711, train_metric nan, valid_metric 0.035941
[4142451:MainThread](2024-04-06 16:26:48,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.032609, valid_loss 1.010454, train_metric nan, valid_metric 0.025781
[4142451:MainThread](2024-04-06 16:26:49,126) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.018673, valid_loss 1.017224, train_metric nan, valid_metric 0.024828
[4142451:MainThread](2024-04-06 16:26:49,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.007395, valid_loss 1.020376, train_metric nan, valid_metric 0.025675
[4142451:MainThread](2024-04-06 16:26:49,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.010559, valid_loss 1.007517, train_metric nan, valid_metric 0.026448
[4142451:MainThread](2024-04-06 16:26:49,433) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.009696 to 1.007517, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:49,611) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.010963, valid_loss 1.016026, train_metric nan, valid_metric 0.017647
[4142451:MainThread](2024-04-06 16:26:49,759) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.008999, valid_loss 1.018100, train_metric nan, valid_metric 0.026575
[4142451:MainThread](2024-04-06 16:26:49,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.992064, valid_loss 1.007472, train_metric nan, valid_metric 0.028270
[4142451:MainThread](2024-04-06 16:26:49,907) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.007517 to 1.007472, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:50,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.002697, valid_loss 1.005740, train_metric nan, valid_metric 0.032351
[4142451:MainThread](2024-04-06 16:26:50,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.007472 to 1.005740, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:50,180) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.001353, valid_loss 1.004802, train_metric nan, valid_metric 0.022698
[4142451:MainThread](2024-04-06 16:26:50,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.005740 to 1.004802, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:50,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.018207, valid_loss 1.008135, train_metric nan, valid_metric 0.024964
[4142451:MainThread](2024-04-06 16:26:50,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.000613, valid_loss 1.010714, train_metric nan, valid_metric 0.015687
[4142451:MainThread](2024-04-06 16:26:50,633) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.995711, valid_loss 1.012547, train_metric nan, valid_metric 0.011191
[4142451:MainThread](2024-04-06 16:26:50,779) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.007599, valid_loss 1.010603, train_metric nan, valid_metric 0.023890
[4142451:MainThread](2024-04-06 16:26:50,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.988924, valid_loss 0.999788, train_metric nan, valid_metric 0.036125
[4142451:MainThread](2024-04-06 16:26:50,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.004802 to 0.999788, save checkpoint.
[4142451:MainThread](2024-04-06 16:26:51,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.008747, valid_loss 1.006518, train_metric nan, valid_metric 0.024845
[4142451:MainThread](2024-04-06 16:26:51,235) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.984271, valid_loss 1.006837, train_metric nan, valid_metric 0.029154
[4142451:MainThread](2024-04-06 16:26:51,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.986257, valid_loss 1.010524, train_metric nan, valid_metric 0.021944
[4142451:MainThread](2024-04-06 16:26:51,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.994029, valid_loss 1.011599, train_metric nan, valid_metric 0.029668
[4142451:MainThread](2024-04-06 16:26:51,669) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.982343, valid_loss 1.002589, train_metric nan, valid_metric 0.030410
[4142451:MainThread](2024-04-06 16:26:51,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.987897, valid_loss 1.001868, train_metric nan, valid_metric 0.036175
[4142451:MainThread](2024-04-06 16:26:51,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.984589, valid_loss 1.009211, train_metric nan, valid_metric 0.022114
[4142451:MainThread](2024-04-06 16:26:52,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.985639, valid_loss 1.004161, train_metric nan, valid_metric 0.039347
[4142451:MainThread](2024-04-06 16:26:52,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.989939, valid_loss 1.005157, train_metric nan, valid_metric 0.023548
[4142451:MainThread](2024-04-06 16:26:52,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.987666, valid_loss 1.003594, train_metric nan, valid_metric 0.035812
[4142451:MainThread](2024-04-06 16:26:52,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.989326, valid_loss 1.006152, train_metric nan, valid_metric 0.026478
[4142451:MainThread](2024-04-06 16:26:52,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.982717, valid_loss 1.004987, train_metric nan, valid_metric 0.027823
[4142451:MainThread](2024-04-06 16:26:52,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.989061, valid_loss 1.003826, train_metric nan, valid_metric 0.027734
[4142451:MainThread](2024-04-06 16:26:52,972) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.999907, valid_loss 1.004725, train_metric nan, valid_metric 0.023543
[4142451:MainThread](2024-04-06 16:26:53,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.990818, valid_loss 1.008089, train_metric nan, valid_metric 0.020240
[4142451:MainThread](2024-04-06 16:26:53,268) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.982584, valid_loss 1.004393, train_metric nan, valid_metric 0.027368
[4142451:MainThread](2024-04-06 16:26:53,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.985916, valid_loss 1.003387, train_metric nan, valid_metric 0.029234
[4142451:MainThread](2024-04-06 16:26:53,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.995964, valid_loss 1.006615, train_metric nan, valid_metric 0.032113
[4142451:MainThread](2024-04-06 16:26:53,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.978977, valid_loss 1.009679, train_metric nan, valid_metric 0.022514
[4142451:MainThread](2024-04-06 16:26:53,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.993866, valid_loss 1.006184, train_metric nan, valid_metric 0.031153
[4142451:MainThread](2024-04-06 16:26:53,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.983262, valid_loss 1.008600, train_metric nan, valid_metric 0.016940
[4142451:MainThread](2024-04-06 16:26:54,132) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.991162, valid_loss 1.005738, train_metric nan, valid_metric 0.020290
[4142451:MainThread](2024-04-06 16:26:54,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.983811, valid_loss 1.002772, train_metric nan, valid_metric 0.028922
[4142451:MainThread](2024-04-06 16:26:54,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.994817, valid_loss 1.003292, train_metric nan, valid_metric 0.030372
[4142451:MainThread](2024-04-06 16:26:54,598) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.978033, valid_loss 1.002640, train_metric nan, valid_metric 0.025611
[4142451:MainThread](2024-04-06 16:26:54,744) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.982555, valid_loss 1.002235, train_metric nan, valid_metric 0.028143
[4142451:MainThread](2024-04-06 16:26:54,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.987448, valid_loss 1.004383, train_metric nan, valid_metric 0.031610
[4142451:MainThread](2024-04-06 16:26:55,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.985280, valid_loss 1.003824, train_metric nan, valid_metric 0.030659
[4142451:MainThread](2024-04-06 16:26:55,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.983267, valid_loss 1.004280, train_metric nan, valid_metric 0.022192
[4142451:MainThread](2024-04-06 16:26:55,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.971799, valid_loss 1.003759, train_metric nan, valid_metric 0.027391
[4142451:MainThread](2024-04-06 16:26:55,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.979207, valid_loss 1.001827, train_metric nan, valid_metric 0.035312
[4142451:MainThread](2024-04-06 16:26:55,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.986992, valid_loss 1.002147, train_metric nan, valid_metric 0.035684
[4142451:MainThread](2024-04-06 16:26:55,760) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.978770, valid_loss 1.000886, train_metric nan, valid_metric 0.025061
[4142451:MainThread](2024-04-06 16:26:55,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.980598, valid_loss 1.002914, train_metric nan, valid_metric 0.020198
[4142451:MainThread](2024-04-06 16:26:56,035) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.990921, valid_loss 1.004196, train_metric nan, valid_metric 0.025210
[4142451:MainThread](2024-04-06 16:26:56,172) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.985447, valid_loss 1.004930, train_metric nan, valid_metric 0.024512
[4142451:MainThread](2024-04-06 16:26:56,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.981129, valid_loss 1.003016, train_metric nan, valid_metric 0.029042
[4142451:MainThread](2024-04-06 16:26:56,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.983352, valid_loss 1.003820, train_metric nan, valid_metric 0.027202
[4142451:MainThread](2024-04-06 16:26:56,593) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.989241, valid_loss 1.004574, train_metric nan, valid_metric 0.026843
[4142451:MainThread](2024-04-06 16:26:56,738) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.985182, valid_loss 1.003408, train_metric nan, valid_metric 0.027600
[4142451:MainThread](2024-04-06 16:26:56,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.983082, valid_loss 1.004055, train_metric nan, valid_metric 0.025283
[4142451:MainThread](2024-04-06 16:26:57,033) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.989110, valid_loss 1.002005, train_metric nan, valid_metric 0.029035
[4142451:MainThread](2024-04-06 16:26:57,214) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.979336, valid_loss 1.003144, train_metric nan, valid_metric 0.030735
[4142451:MainThread](2024-04-06 16:26:57,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.989083, valid_loss 1.004300, train_metric nan, valid_metric 0.029663
[4142451:MainThread](2024-04-06 16:26:57,511) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.977828, valid_loss 1.004350, train_metric nan, valid_metric 0.029122
[4142451:MainThread](2024-04-06 16:26:57,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.985219, valid_loss 1.004586, train_metric nan, valid_metric 0.028228
[4142451:MainThread](2024-04-06 16:26:57,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.993012, valid_loss 1.003381, train_metric nan, valid_metric 0.020998
[4142451:MainThread](2024-04-06 16:26:57,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.983110, valid_loss 1.004523, train_metric nan, valid_metric 0.026295
[4142451:MainThread](2024-04-06 16:26:58,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.985621, valid_loss 1.004537, train_metric nan, valid_metric 0.026580
[4142451:MainThread](2024-04-06 16:26:58,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.987639, valid_loss 1.004412, train_metric nan, valid_metric 0.025760
[4142451:MainThread](2024-04-06 16:26:58,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:26:58,865) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:26:59,730) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  42%|████▏     | 22/52 [07:23<09:05, 18.18s/it][4142451:MainThread](2024-04-06 16:26:59,738) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:26:59,748) INFO - qlib.workflow - [recorder.py:341] - Recorder 80e9f859909a48fca6b52aad7032143e starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:27:00,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:27:00,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:27:00,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:27:00,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:27:03,885) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:27:04,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.195415, valid_loss 1.028160, train_metric nan, valid_metric 0.041045
[4142451:MainThread](2024-04-06 16:27:04,223) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.028160, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:27:04,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.064922, valid_loss 1.013304, train_metric nan, valid_metric 0.045545
[4142451:MainThread](2024-04-06 16:27:04,366) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.028160 to 1.013304, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:04,504) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.054196, valid_loss 1.027767, train_metric nan, valid_metric 0.026605
[4142451:MainThread](2024-04-06 16:27:04,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.036982, valid_loss 1.011681, train_metric nan, valid_metric 0.049759
[4142451:MainThread](2024-04-06 16:27:04,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.013304 to 1.011681, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:04,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.023750, valid_loss 1.011140, train_metric nan, valid_metric 0.043699
[4142451:MainThread](2024-04-06 16:27:04,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.011681 to 1.011140, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:04,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.031435, valid_loss 1.004282, train_metric nan, valid_metric 0.052183
[4142451:MainThread](2024-04-06 16:27:04,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.011140 to 1.004282, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:05,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.009895, valid_loss 1.013506, train_metric nan, valid_metric 0.050931
[4142451:MainThread](2024-04-06 16:27:05,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.008962, valid_loss 1.009746, train_metric nan, valid_metric 0.050121
[4142451:MainThread](2024-04-06 16:27:05,369) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.027018, valid_loss 1.056440, train_metric nan, valid_metric 0.026302
[4142451:MainThread](2024-04-06 16:27:05,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.021988, valid_loss 1.032289, train_metric nan, valid_metric 0.050300
[4142451:MainThread](2024-04-06 16:27:05,659) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.004083, valid_loss 1.010793, train_metric nan, valid_metric 0.041001
[4142451:MainThread](2024-04-06 16:27:05,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.001956, valid_loss 1.003985, train_metric nan, valid_metric 0.033787
[4142451:MainThread](2024-04-06 16:27:05,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.004282 to 1.003985, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:05,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.999708, valid_loss 0.998291, train_metric nan, valid_metric 0.044526
[4142451:MainThread](2024-04-06 16:27:05,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003985 to 0.998291, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:06,079) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 0.989806, valid_loss 1.001418, train_metric nan, valid_metric 0.053227
[4142451:MainThread](2024-04-06 16:27:06,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.993273, valid_loss 1.000287, train_metric nan, valid_metric 0.047852
[4142451:MainThread](2024-04-06 16:27:06,353) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.001008, valid_loss 1.002393, train_metric nan, valid_metric 0.050621
[4142451:MainThread](2024-04-06 16:27:06,504) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.992521, valid_loss 1.000841, train_metric nan, valid_metric 0.043537
[4142451:MainThread](2024-04-06 16:27:06,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.980305, valid_loss 0.999214, train_metric nan, valid_metric 0.053150
[4142451:MainThread](2024-04-06 16:27:06,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.980642, valid_loss 1.000730, train_metric nan, valid_metric 0.047810
[4142451:MainThread](2024-04-06 16:27:07,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.986994, valid_loss 1.000418, train_metric nan, valid_metric 0.043111
[4142451:MainThread](2024-04-06 16:27:07,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.992272, valid_loss 1.002457, train_metric nan, valid_metric 0.043904
[4142451:MainThread](2024-04-06 16:27:07,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.983555, valid_loss 0.995861, train_metric nan, valid_metric 0.055557
[4142451:MainThread](2024-04-06 16:27:07,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998291 to 0.995861, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:07,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.980877, valid_loss 0.997601, train_metric nan, valid_metric 0.049330
[4142451:MainThread](2024-04-06 16:27:07,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.986499, valid_loss 0.997957, train_metric nan, valid_metric 0.053916
[4142451:MainThread](2024-04-06 16:27:07,830) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.980196, valid_loss 0.995485, train_metric nan, valid_metric 0.056499
[4142451:MainThread](2024-04-06 16:27:07,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995861 to 0.995485, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:07,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.978179, valid_loss 0.999631, train_metric nan, valid_metric 0.042025
[4142451:MainThread](2024-04-06 16:27:08,149) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.985422, valid_loss 0.996656, train_metric nan, valid_metric 0.053732
[4142451:MainThread](2024-04-06 16:27:08,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.993465, valid_loss 1.004877, train_metric nan, valid_metric 0.043511
[4142451:MainThread](2024-04-06 16:27:08,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.994429, valid_loss 0.997427, train_metric nan, valid_metric 0.053810
[4142451:MainThread](2024-04-06 16:27:08,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.981366, valid_loss 1.003456, train_metric nan, valid_metric 0.042748
[4142451:MainThread](2024-04-06 16:27:08,757) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.986368, valid_loss 1.003081, train_metric nan, valid_metric 0.043009
[4142451:MainThread](2024-04-06 16:27:08,897) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.978511, valid_loss 0.998661, train_metric nan, valid_metric 0.054490
[4142451:MainThread](2024-04-06 16:27:09,035) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.990201, valid_loss 0.994527, train_metric nan, valid_metric 0.053514
[4142451:MainThread](2024-04-06 16:27:09,035) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995485 to 0.994527, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:09,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.984085, valid_loss 0.996936, train_metric nan, valid_metric 0.055596
[4142451:MainThread](2024-04-06 16:27:09,327) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.986669, valid_loss 1.004271, train_metric nan, valid_metric 0.042614
[4142451:MainThread](2024-04-06 16:27:09,505) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.992208, valid_loss 0.997856, train_metric nan, valid_metric 0.050998
[4142451:MainThread](2024-04-06 16:27:09,673) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.994896, valid_loss 0.995924, train_metric nan, valid_metric 0.057456
[4142451:MainThread](2024-04-06 16:27:09,838) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.985955, valid_loss 0.997068, train_metric nan, valid_metric 0.053833
[4142451:MainThread](2024-04-06 16:27:09,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.985512, valid_loss 1.000160, train_metric nan, valid_metric 0.047701
[4142451:MainThread](2024-04-06 16:27:10,154) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.978858, valid_loss 0.999210, train_metric nan, valid_metric 0.050017
[4142451:MainThread](2024-04-06 16:27:10,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.981536, valid_loss 1.013412, train_metric nan, valid_metric 0.045527
[4142451:MainThread](2024-04-06 16:27:10,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.001643, valid_loss 0.998211, train_metric nan, valid_metric 0.049893
[4142451:MainThread](2024-04-06 16:27:10,646) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.988531, valid_loss 0.999136, train_metric nan, valid_metric 0.049815
[4142451:MainThread](2024-04-06 16:27:10,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.970722, valid_loss 1.001929, train_metric nan, valid_metric 0.054328
[4142451:MainThread](2024-04-06 16:27:10,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.977748, valid_loss 0.996947, train_metric nan, valid_metric 0.053126
[4142451:MainThread](2024-04-06 16:27:11,134) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.988820, valid_loss 0.998619, train_metric nan, valid_metric 0.049226
[4142451:MainThread](2024-04-06 16:27:11,277) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.976920, valid_loss 0.998193, train_metric nan, valid_metric 0.050257
[4142451:MainThread](2024-04-06 16:27:11,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.980460, valid_loss 0.998817, train_metric nan, valid_metric 0.049891
[4142451:MainThread](2024-04-06 16:27:11,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.982691, valid_loss 0.999577, train_metric nan, valid_metric 0.046946
[4142451:MainThread](2024-04-06 16:27:11,696) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.994353, valid_loss 0.996732, train_metric nan, valid_metric 0.050395
[4142451:MainThread](2024-04-06 16:27:11,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.985987, valid_loss 0.999041, train_metric nan, valid_metric 0.052497
[4142451:MainThread](2024-04-06 16:27:11,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.978349, valid_loss 0.998784, train_metric nan, valid_metric 0.050992
[4142451:MainThread](2024-04-06 16:27:12,099) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.980039, valid_loss 1.001039, train_metric nan, valid_metric 0.048450
[4142451:MainThread](2024-04-06 16:27:12,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.986139, valid_loss 0.996998, train_metric nan, valid_metric 0.056371
[4142451:MainThread](2024-04-06 16:27:12,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.973955, valid_loss 0.996769, train_metric nan, valid_metric 0.053499
[4142451:MainThread](2024-04-06 16:27:12,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.974883, valid_loss 0.998427, train_metric nan, valid_metric 0.048937
[4142451:MainThread](2024-04-06 16:27:12,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.984448, valid_loss 0.998363, train_metric nan, valid_metric 0.050153
[4142451:MainThread](2024-04-06 16:27:12,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.972999, valid_loss 0.996749, train_metric nan, valid_metric 0.051970
[4142451:MainThread](2024-04-06 16:27:12,955) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.992974, valid_loss 0.995615, train_metric nan, valid_metric 0.053756
[4142451:MainThread](2024-04-06 16:27:13,105) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.976592, valid_loss 0.998958, train_metric nan, valid_metric 0.051120
[4142451:MainThread](2024-04-06 16:27:13,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.986497, valid_loss 0.997985, train_metric nan, valid_metric 0.050378
[4142451:MainThread](2024-04-06 16:27:13,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.988232, valid_loss 0.998603, train_metric nan, valid_metric 0.054539
[4142451:MainThread](2024-04-06 16:27:13,538) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.988299, valid_loss 0.998171, train_metric nan, valid_metric 0.051537
[4142451:MainThread](2024-04-06 16:27:13,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.981502, valid_loss 0.998462, train_metric nan, valid_metric 0.051462
[4142451:MainThread](2024-04-06 16:27:13,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.989667, valid_loss 0.998111, train_metric nan, valid_metric 0.052961
[4142451:MainThread](2024-04-06 16:27:13,960) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.985909, valid_loss 0.998065, train_metric nan, valid_metric 0.052377
[4142451:MainThread](2024-04-06 16:27:14,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.984550, valid_loss 0.997887, train_metric nan, valid_metric 0.053286
[4142451:MainThread](2024-04-06 16:27:14,257) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.981773, valid_loss 0.998943, train_metric nan, valid_metric 0.049236
[4142451:MainThread](2024-04-06 16:27:14,403) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.987833, valid_loss 0.997067, train_metric nan, valid_metric 0.050509
[4142451:MainThread](2024-04-06 16:27:14,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.972044, valid_loss 0.998738, train_metric nan, valid_metric 0.051265
[4142451:MainThread](2024-04-06 16:27:14,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.971911, valid_loss 0.998490, train_metric nan, valid_metric 0.050776
[4142451:MainThread](2024-04-06 16:27:14,838) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.982533, valid_loss 0.998495, train_metric nan, valid_metric 0.049801
[4142451:MainThread](2024-04-06 16:27:14,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.983438, valid_loss 0.998975, train_metric nan, valid_metric 0.050855
[4142451:MainThread](2024-04-06 16:27:15,127) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.982136, valid_loss 0.998234, train_metric nan, valid_metric 0.051933
[4142451:MainThread](2024-04-06 16:27:15,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.982402, valid_loss 0.997701, train_metric nan, valid_metric 0.051078
[4142451:MainThread](2024-04-06 16:27:15,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.982055, valid_loss 0.995701, train_metric nan, valid_metric 0.052075
[4142451:MainThread](2024-04-06 16:27:15,567) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.979630, valid_loss 0.997784, train_metric nan, valid_metric 0.052061
[4142451:MainThread](2024-04-06 16:27:15,709) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.986696, valid_loss 0.997585, train_metric nan, valid_metric 0.053030
[4142451:MainThread](2024-04-06 16:27:15,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.984868, valid_loss 0.998757, train_metric nan, valid_metric 0.050926
[4142451:MainThread](2024-04-06 16:27:15,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.989915, valid_loss 0.998022, train_metric nan, valid_metric 0.051184
[4142451:MainThread](2024-04-06 16:27:16,140) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.981943, valid_loss 0.999037, train_metric nan, valid_metric 0.052106
[4142451:MainThread](2024-04-06 16:27:16,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.968384, valid_loss 0.998842, train_metric nan, valid_metric 0.050172
[4142451:MainThread](2024-04-06 16:27:16,427) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.979084, valid_loss 0.998769, train_metric nan, valid_metric 0.051226
[4142451:MainThread](2024-04-06 16:27:16,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:27:17,489) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:27:18,350) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  44%|████▍     | 23/52 [07:42<08:51, 18.31s/it][4142451:MainThread](2024-04-06 16:27:18,359) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:27:18,370) INFO - qlib.workflow - [recorder.py:341] - Recorder bd9e809119be4be49b5b8d0709f65b0c starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:27:18,985) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:27:18,985) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:27:18,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:27:18,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:27:22,416) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:27:22,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.362223, valid_loss 1.030762, train_metric nan, valid_metric 0.041732
[4142451:MainThread](2024-04-06 16:27:22,701) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.030762, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:27:22,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.115986, valid_loss 1.023205, train_metric nan, valid_metric 0.049255
[4142451:MainThread](2024-04-06 16:27:22,846) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.030762 to 1.023205, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:22,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.068522, valid_loss 1.013493, train_metric nan, valid_metric 0.039599
[4142451:MainThread](2024-04-06 16:27:22,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.023205 to 1.013493, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:23,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.055510, valid_loss 1.010707, train_metric nan, valid_metric 0.036463
[4142451:MainThread](2024-04-06 16:27:23,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.013493 to 1.010707, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:23,281) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.041707, valid_loss 1.008326, train_metric nan, valid_metric 0.043774
[4142451:MainThread](2024-04-06 16:27:23,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.010707 to 1.008326, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:23,427) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.038403, valid_loss 1.034184, train_metric nan, valid_metric 0.029881
[4142451:MainThread](2024-04-06 16:27:23,571) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.048630, valid_loss 1.013560, train_metric nan, valid_metric 0.049826
[4142451:MainThread](2024-04-06 16:27:23,707) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.036608, valid_loss 1.016243, train_metric nan, valid_metric 0.054467
[4142451:MainThread](2024-04-06 16:27:23,852) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.017944, valid_loss 1.005937, train_metric nan, valid_metric 0.056832
[4142451:MainThread](2024-04-06 16:27:23,852) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.008326 to 1.005937, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:24,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.009069, valid_loss 1.004534, train_metric nan, valid_metric 0.058092
[4142451:MainThread](2024-04-06 16:27:24,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.005937 to 1.004534, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:24,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.015123, valid_loss 0.996734, train_metric nan, valid_metric 0.053314
[4142451:MainThread](2024-04-06 16:27:24,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.004534 to 0.996734, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:24,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.020060, valid_loss 1.016772, train_metric nan, valid_metric 0.045129
[4142451:MainThread](2024-04-06 16:27:24,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.011530, valid_loss 1.016434, train_metric nan, valid_metric 0.060643
[4142451:MainThread](2024-04-06 16:27:24,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.002242, valid_loss 1.007778, train_metric nan, valid_metric 0.053998
[4142451:MainThread](2024-04-06 16:27:24,754) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.005992, valid_loss 0.997133, train_metric nan, valid_metric 0.061513
[4142451:MainThread](2024-04-06 16:27:24,894) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.992886, valid_loss 0.998084, train_metric nan, valid_metric 0.057642
[4142451:MainThread](2024-04-06 16:27:25,028) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.997479, valid_loss 0.994337, train_metric nan, valid_metric 0.065265
[4142451:MainThread](2024-04-06 16:27:25,029) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996734 to 0.994337, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:25,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.990546, valid_loss 0.998065, train_metric nan, valid_metric 0.056834
[4142451:MainThread](2024-04-06 16:27:25,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.998397, valid_loss 0.996428, train_metric nan, valid_metric 0.060510
[4142451:MainThread](2024-04-06 16:27:25,470) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.995840, valid_loss 1.004794, train_metric nan, valid_metric 0.047880
[4142451:MainThread](2024-04-06 16:27:25,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.997590, valid_loss 0.999453, train_metric nan, valid_metric 0.057195
[4142451:MainThread](2024-04-06 16:27:25,778) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.987168, valid_loss 0.997882, train_metric nan, valid_metric 0.056778
[4142451:MainThread](2024-04-06 16:27:25,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.986323, valid_loss 0.997692, train_metric nan, valid_metric 0.056068
[4142451:MainThread](2024-04-06 16:27:26,064) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.989959, valid_loss 0.997181, train_metric nan, valid_metric 0.052570
[4142451:MainThread](2024-04-06 16:27:26,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.985788, valid_loss 0.996049, train_metric nan, valid_metric 0.058427
[4142451:MainThread](2024-04-06 16:27:26,349) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.984128, valid_loss 1.005490, train_metric nan, valid_metric 0.056343
[4142451:MainThread](2024-04-06 16:27:26,494) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.990847, valid_loss 1.000446, train_metric nan, valid_metric 0.046615
[4142451:MainThread](2024-04-06 16:27:26,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.984188, valid_loss 0.997255, train_metric nan, valid_metric 0.053238
[4142451:MainThread](2024-04-06 16:27:26,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.993470, valid_loss 0.994218, train_metric nan, valid_metric 0.060798
[4142451:MainThread](2024-04-06 16:27:26,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994337 to 0.994218, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:26,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.985385, valid_loss 0.995281, train_metric nan, valid_metric 0.056266
[4142451:MainThread](2024-04-06 16:27:27,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.003404, valid_loss 0.995053, train_metric nan, valid_metric 0.059848
[4142451:MainThread](2024-04-06 16:27:27,220) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.994431, valid_loss 0.998140, train_metric nan, valid_metric 0.045205
[4142451:MainThread](2024-04-06 16:27:27,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.988954, valid_loss 0.996742, train_metric nan, valid_metric 0.054278
[4142451:MainThread](2024-04-06 16:27:27,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.986090, valid_loss 0.996263, train_metric nan, valid_metric 0.051208
[4142451:MainThread](2024-04-06 16:27:27,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.998411, valid_loss 0.995086, train_metric nan, valid_metric 0.056353
[4142451:MainThread](2024-04-06 16:27:27,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.989338, valid_loss 0.994897, train_metric nan, valid_metric 0.062504
[4142451:MainThread](2024-04-06 16:27:27,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.999553, valid_loss 0.995778, train_metric nan, valid_metric 0.061401
[4142451:MainThread](2024-04-06 16:27:28,134) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.985310, valid_loss 0.995221, train_metric nan, valid_metric 0.058862
[4142451:MainThread](2024-04-06 16:27:28,304) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.991031, valid_loss 0.998832, train_metric nan, valid_metric 0.050302
[4142451:MainThread](2024-04-06 16:27:28,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.976743, valid_loss 0.995432, train_metric nan, valid_metric 0.052389
[4142451:MainThread](2024-04-06 16:27:28,646) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.976165, valid_loss 0.995766, train_metric nan, valid_metric 0.057063
[4142451:MainThread](2024-04-06 16:27:28,796) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.966382, valid_loss 0.995585, train_metric nan, valid_metric 0.056856
[4142451:MainThread](2024-04-06 16:27:28,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.990996, valid_loss 0.996734, train_metric nan, valid_metric 0.052118
[4142451:MainThread](2024-04-06 16:27:29,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.981604, valid_loss 0.997579, train_metric nan, valid_metric 0.054135
[4142451:MainThread](2024-04-06 16:27:29,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.988222, valid_loss 0.995983, train_metric nan, valid_metric 0.055157
[4142451:MainThread](2024-04-06 16:27:29,403) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.974928, valid_loss 0.995688, train_metric nan, valid_metric 0.054337
[4142451:MainThread](2024-04-06 16:27:29,551) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.997749, valid_loss 0.997149, train_metric nan, valid_metric 0.051484
[4142451:MainThread](2024-04-06 16:27:29,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.986581, valid_loss 0.996064, train_metric nan, valid_metric 0.052439
[4142451:MainThread](2024-04-06 16:27:29,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.989859, valid_loss 0.996469, train_metric nan, valid_metric 0.053810
[4142451:MainThread](2024-04-06 16:27:29,972) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.996865, valid_loss 0.995584, train_metric nan, valid_metric 0.056247
[4142451:MainThread](2024-04-06 16:27:30,120) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 1.001207, valid_loss 0.997308, train_metric nan, valid_metric 0.055894
[4142451:MainThread](2024-04-06 16:27:30,297) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.979324, valid_loss 0.996833, train_metric nan, valid_metric 0.053468
[4142451:MainThread](2024-04-06 16:27:30,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.981697, valid_loss 0.994674, train_metric nan, valid_metric 0.055901
[4142451:MainThread](2024-04-06 16:27:30,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.981881, valid_loss 0.995372, train_metric nan, valid_metric 0.059564
[4142451:MainThread](2024-04-06 16:27:30,746) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.989877, valid_loss 0.994776, train_metric nan, valid_metric 0.061260
[4142451:MainThread](2024-04-06 16:27:30,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.982405, valid_loss 0.996766, train_metric nan, valid_metric 0.056654
[4142451:MainThread](2024-04-06 16:27:31,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.990015, valid_loss 0.995925, train_metric nan, valid_metric 0.057328
[4142451:MainThread](2024-04-06 16:27:31,171) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.980726, valid_loss 0.997057, train_metric nan, valid_metric 0.053678
[4142451:MainThread](2024-04-06 16:27:31,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.974930, valid_loss 0.996803, train_metric nan, valid_metric 0.057046
[4142451:MainThread](2024-04-06 16:27:31,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.981185, valid_loss 0.995326, train_metric nan, valid_metric 0.050645
[4142451:MainThread](2024-04-06 16:27:31,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.986801, valid_loss 0.995961, train_metric nan, valid_metric 0.056911
[4142451:MainThread](2024-04-06 16:27:31,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.984563, valid_loss 0.996455, train_metric nan, valid_metric 0.056252
[4142451:MainThread](2024-04-06 16:27:31,936) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.985450, valid_loss 0.995487, train_metric nan, valid_metric 0.056325
[4142451:MainThread](2024-04-06 16:27:32,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.982578, valid_loss 0.996689, train_metric nan, valid_metric 0.055337
[4142451:MainThread](2024-04-06 16:27:32,275) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.984727, valid_loss 0.995088, train_metric nan, valid_metric 0.058846
[4142451:MainThread](2024-04-06 16:27:32,424) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.986262, valid_loss 0.995147, train_metric nan, valid_metric 0.056210
[4142451:MainThread](2024-04-06 16:27:32,567) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.971899, valid_loss 0.994884, train_metric nan, valid_metric 0.054923
[4142451:MainThread](2024-04-06 16:27:32,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.980276, valid_loss 0.994062, train_metric nan, valid_metric 0.058124
[4142451:MainThread](2024-04-06 16:27:32,712) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994218 to 0.994062, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:32,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.988109, valid_loss 0.995277, train_metric nan, valid_metric 0.056762
[4142451:MainThread](2024-04-06 16:27:33,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.985515, valid_loss 0.995708, train_metric nan, valid_metric 0.056088
[4142451:MainThread](2024-04-06 16:27:33,215) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.986667, valid_loss 0.995967, train_metric nan, valid_metric 0.057657
[4142451:MainThread](2024-04-06 16:27:33,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.989353, valid_loss 0.994065, train_metric nan, valid_metric 0.059545
[4142451:MainThread](2024-04-06 16:27:33,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.983218, valid_loss 0.995429, train_metric nan, valid_metric 0.060438
[4142451:MainThread](2024-04-06 16:27:33,742) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.982690, valid_loss 0.995841, train_metric nan, valid_metric 0.057897
[4142451:MainThread](2024-04-06 16:27:33,913) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.981332, valid_loss 0.997048, train_metric nan, valid_metric 0.056141
[4142451:MainThread](2024-04-06 16:27:34,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.988694, valid_loss 0.996647, train_metric nan, valid_metric 0.055803
[4142451:MainThread](2024-04-06 16:27:34,255) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.987499, valid_loss 0.995881, train_metric nan, valid_metric 0.055224
[4142451:MainThread](2024-04-06 16:27:34,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.972732, valid_loss 0.996274, train_metric nan, valid_metric 0.057118
[4142451:MainThread](2024-04-06 16:27:34,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.976211, valid_loss 0.996317, train_metric nan, valid_metric 0.056475
[4142451:MainThread](2024-04-06 16:27:34,757) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.987039, valid_loss 0.995832, train_metric nan, valid_metric 0.055625
[4142451:MainThread](2024-04-06 16:27:34,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.979899, valid_loss 0.996243, train_metric nan, valid_metric 0.058072
[4142451:MainThread](2024-04-06 16:27:35,034) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.985008, valid_loss 0.995386, train_metric nan, valid_metric 0.058611
[4142451:MainThread](2024-04-06 16:27:35,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.974532, valid_loss 0.994883, train_metric nan, valid_metric 0.059019
[4142451:MainThread](2024-04-06 16:27:35,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.982284, valid_loss 0.996723, train_metric nan, valid_metric 0.049049
[4142451:MainThread](2024-04-06 16:27:35,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.982279, valid_loss 0.995365, train_metric nan, valid_metric 0.056686
[4142451:MainThread](2024-04-06 16:27:35,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.973063, valid_loss 0.996398, train_metric nan, valid_metric 0.056107
[4142451:MainThread](2024-04-06 16:27:35,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.982896, valid_loss 0.996846, train_metric nan, valid_metric 0.055995
[4142451:MainThread](2024-04-06 16:27:35,913) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.989204, valid_loss 0.994272, train_metric nan, valid_metric 0.052668
[4142451:MainThread](2024-04-06 16:27:36,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.986875, valid_loss 0.994897, train_metric nan, valid_metric 0.058281
[4142451:MainThread](2024-04-06 16:27:36,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.978448, valid_loss 0.995474, train_metric nan, valid_metric 0.054729
[4142451:MainThread](2024-04-06 16:27:36,335) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.983986, valid_loss 0.996112, train_metric nan, valid_metric 0.054815
[4142451:MainThread](2024-04-06 16:27:36,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.977303, valid_loss 0.996152, train_metric nan, valid_metric 0.055657
[4142451:MainThread](2024-04-06 16:27:36,626) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.981286, valid_loss 0.996848, train_metric nan, valid_metric 0.055881
[4142451:MainThread](2024-04-06 16:27:36,770) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.987574, valid_loss 0.996169, train_metric nan, valid_metric 0.057170
[4142451:MainThread](2024-04-06 16:27:36,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.988657, valid_loss 0.995609, train_metric nan, valid_metric 0.055081
[4142451:MainThread](2024-04-06 16:27:37,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.986941, valid_loss 0.995568, train_metric nan, valid_metric 0.055085
[4142451:MainThread](2024-04-06 16:27:37,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.984755, valid_loss 0.996160, train_metric nan, valid_metric 0.056214
[4142451:MainThread](2024-04-06 16:27:37,444) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.982462, valid_loss 0.996576, train_metric nan, valid_metric 0.055589
[4142451:MainThread](2024-04-06 16:27:37,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.981244, valid_loss 0.995926, train_metric nan, valid_metric 0.057672
[4142451:MainThread](2024-04-06 16:27:37,756) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.989607, valid_loss 0.995028, train_metric nan, valid_metric 0.054874
[4142451:MainThread](2024-04-06 16:27:37,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.984897, valid_loss 0.995928, train_metric nan, valid_metric 0.057848
[4142451:MainThread](2024-04-06 16:27:38,075) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.989783, valid_loss 0.996675, train_metric nan, valid_metric 0.056627
[4142451:MainThread](2024-04-06 16:27:38,234) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.992168, valid_loss 0.996135, train_metric nan, valid_metric 0.056411
[4142451:MainThread](2024-04-06 16:27:38,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.986547, valid_loss 0.996641, train_metric nan, valid_metric 0.056288
[4142451:MainThread](2024-04-06 16:27:38,564) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.975604, valid_loss 0.996730, train_metric nan, valid_metric 0.054362
[4142451:MainThread](2024-04-06 16:27:38,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 0.986678, valid_loss 0.994253, train_metric nan, valid_metric 0.060943
[4142451:MainThread](2024-04-06 16:27:38,873) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.986992, valid_loss 0.996208, train_metric nan, valid_metric 0.058367
[4142451:MainThread](2024-04-06 16:27:39,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 0.982453, valid_loss 0.997176, train_metric nan, valid_metric 0.056062
[4142451:MainThread](2024-04-06 16:27:39,214) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 0.977424, valid_loss 0.996519, train_metric nan, valid_metric 0.057291
[4142451:MainThread](2024-04-06 16:27:39,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 0.970423, valid_loss 0.997030, train_metric nan, valid_metric 0.056170
[4142451:MainThread](2024-04-06 16:27:39,524) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 0.982785, valid_loss 0.995650, train_metric nan, valid_metric 0.052819
[4142451:MainThread](2024-04-06 16:27:39,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 0.984341, valid_loss 0.994523, train_metric nan, valid_metric 0.054637
[4142451:MainThread](2024-04-06 16:27:39,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 0.980554, valid_loss 0.995676, train_metric nan, valid_metric 0.058014
[4142451:MainThread](2024-04-06 16:27:40,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 0.978610, valid_loss 0.996365, train_metric nan, valid_metric 0.057128
[4142451:MainThread](2024-04-06 16:27:40,176) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 0.979366, valid_loss 0.995521, train_metric nan, valid_metric 0.056720
[4142451:MainThread](2024-04-06 16:27:40,352) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 0.978227, valid_loss 0.996363, train_metric nan, valid_metric 0.056964
[4142451:MainThread](2024-04-06 16:27:40,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 0.975314, valid_loss 0.996736, train_metric nan, valid_metric 0.056527
[4142451:MainThread](2024-04-06 16:27:40,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 0.987458, valid_loss 0.997042, train_metric nan, valid_metric 0.056070
[4142451:MainThread](2024-04-06 16:27:40,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:27:41,784) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:27:42,627) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  46%|████▌     | 24/52 [08:06<09:22, 20.10s/it][4142451:MainThread](2024-04-06 16:27:42,635) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:27:42,645) INFO - qlib.workflow - [recorder.py:341] - Recorder 245f4dcec5724d1c881feec2397fc0a2 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:27:43,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:27:43,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:27:43,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:27:43,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:27:46,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:27:47,453) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.199045, valid_loss 1.036708, train_metric nan, valid_metric 0.038952
[4142451:MainThread](2024-04-06 16:27:47,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.036708, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:27:47,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.079294, valid_loss 1.074234, train_metric nan, valid_metric 0.034069
[4142451:MainThread](2024-04-06 16:27:47,731) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.042889, valid_loss 1.031899, train_metric nan, valid_metric 0.028466
[4142451:MainThread](2024-04-06 16:27:47,731) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.036708 to 1.031899, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:47,881) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.040982, valid_loss 1.017680, train_metric nan, valid_metric 0.038015
[4142451:MainThread](2024-04-06 16:27:47,882) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.031899 to 1.017680, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:48,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.023355, valid_loss 1.011827, train_metric nan, valid_metric 0.025505
[4142451:MainThread](2024-04-06 16:27:48,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.017680 to 1.011827, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:48,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.057495, valid_loss 1.013239, train_metric nan, valid_metric 0.029118
[4142451:MainThread](2024-04-06 16:27:48,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.032519, valid_loss 1.035125, train_metric nan, valid_metric 0.031549
[4142451:MainThread](2024-04-06 16:27:48,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.059275, valid_loss 1.065755, train_metric nan, valid_metric 0.034598
[4142451:MainThread](2024-04-06 16:27:48,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.045240, valid_loss 1.023260, train_metric nan, valid_metric 0.033815
[4142451:MainThread](2024-04-06 16:27:48,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.005744, valid_loss 1.004975, train_metric nan, valid_metric 0.039262
[4142451:MainThread](2024-04-06 16:27:48,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.011827 to 1.004975, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:49,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.004152, valid_loss 1.003246, train_metric nan, valid_metric 0.037660
[4142451:MainThread](2024-04-06 16:27:49,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.004975 to 1.003246, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:49,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.009013, valid_loss 1.003092, train_metric nan, valid_metric 0.032219
[4142451:MainThread](2024-04-06 16:27:49,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003246 to 1.003092, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:49,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.996000, valid_loss 1.002949, train_metric nan, valid_metric 0.032290
[4142451:MainThread](2024-04-06 16:27:49,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003092 to 1.002949, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:49,602) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 0.993205, valid_loss 1.005086, train_metric nan, valid_metric 0.028747
[4142451:MainThread](2024-04-06 16:27:49,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.993568, valid_loss 1.002386, train_metric nan, valid_metric 0.035969
[4142451:MainThread](2024-04-06 16:27:49,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.002949 to 1.002386, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:49,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.992999, valid_loss 1.004282, train_metric nan, valid_metric 0.038567
[4142451:MainThread](2024-04-06 16:27:50,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.987346, valid_loss 1.010716, train_metric nan, valid_metric 0.032600
[4142451:MainThread](2024-04-06 16:27:50,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.994733, valid_loss 1.001010, train_metric nan, valid_metric 0.034447
[4142451:MainThread](2024-04-06 16:27:50,295) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.002386 to 1.001010, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:50,487) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.991825, valid_loss 1.000562, train_metric nan, valid_metric 0.034751
[4142451:MainThread](2024-04-06 16:27:50,487) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001010 to 1.000562, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:50,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.990111, valid_loss 1.003740, train_metric nan, valid_metric 0.031431
[4142451:MainThread](2024-04-06 16:27:50,794) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.993688, valid_loss 1.005127, train_metric nan, valid_metric 0.025507
[4142451:MainThread](2024-04-06 16:27:50,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.991898, valid_loss 1.003676, train_metric nan, valid_metric 0.027557
[4142451:MainThread](2024-04-06 16:27:51,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.987683, valid_loss 1.004024, train_metric nan, valid_metric 0.035992
[4142451:MainThread](2024-04-06 16:27:51,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.990270, valid_loss 1.002427, train_metric nan, valid_metric 0.041208
[4142451:MainThread](2024-04-06 16:27:51,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.990326, valid_loss 1.000944, train_metric nan, valid_metric 0.032899
[4142451:MainThread](2024-04-06 16:27:51,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.008031, valid_loss 1.001704, train_metric nan, valid_metric 0.038502
[4142451:MainThread](2024-04-06 16:27:51,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.995146, valid_loss 1.004557, train_metric nan, valid_metric 0.032361
[4142451:MainThread](2024-04-06 16:27:51,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.988955, valid_loss 1.001308, train_metric nan, valid_metric 0.046681
[4142451:MainThread](2024-04-06 16:27:51,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.994204, valid_loss 1.000366, train_metric nan, valid_metric 0.038826
[4142451:MainThread](2024-04-06 16:27:51,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000562 to 1.000366, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:52,130) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.975975, valid_loss 1.004187, train_metric nan, valid_metric 0.034537
[4142451:MainThread](2024-04-06 16:27:52,277) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.988975, valid_loss 1.001808, train_metric nan, valid_metric 0.024168
[4142451:MainThread](2024-04-06 16:27:52,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.996101, valid_loss 1.005036, train_metric nan, valid_metric 0.039591
[4142451:MainThread](2024-04-06 16:27:52,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.992070, valid_loss 1.004579, train_metric nan, valid_metric 0.032828
[4142451:MainThread](2024-04-06 16:27:52,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.984439, valid_loss 1.003828, train_metric nan, valid_metric 0.045148
[4142451:MainThread](2024-04-06 16:27:52,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.989597, valid_loss 0.999626, train_metric nan, valid_metric 0.033444
[4142451:MainThread](2024-04-06 16:27:52,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000366 to 0.999626, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:52,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.996646, valid_loss 1.005366, train_metric nan, valid_metric 0.030433
[4142451:MainThread](2024-04-06 16:27:53,130) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.986037, valid_loss 1.005356, train_metric nan, valid_metric 0.043009
[4142451:MainThread](2024-04-06 16:27:53,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.996851, valid_loss 1.001125, train_metric nan, valid_metric 0.029220
[4142451:MainThread](2024-04-06 16:27:53,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.983593, valid_loss 1.005674, train_metric nan, valid_metric 0.041160
[4142451:MainThread](2024-04-06 16:27:53,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.978463, valid_loss 0.998395, train_metric nan, valid_metric 0.038197
[4142451:MainThread](2024-04-06 16:27:53,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999626 to 0.998395, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:53,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.994380, valid_loss 1.004332, train_metric nan, valid_metric 0.038837
[4142451:MainThread](2024-04-06 16:27:53,852) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.988725, valid_loss 0.998254, train_metric nan, valid_metric 0.034659
[4142451:MainThread](2024-04-06 16:27:53,852) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998395 to 0.998254, save checkpoint.
[4142451:MainThread](2024-04-06 16:27:53,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.985971, valid_loss 0.998664, train_metric nan, valid_metric 0.043188
[4142451:MainThread](2024-04-06 16:27:54,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.986992, valid_loss 1.005073, train_metric nan, valid_metric 0.030163
[4142451:MainThread](2024-04-06 16:27:54,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.991137, valid_loss 1.005026, train_metric nan, valid_metric 0.037944
[4142451:MainThread](2024-04-06 16:27:54,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.981665, valid_loss 1.004097, train_metric nan, valid_metric 0.044930
[4142451:MainThread](2024-04-06 16:27:54,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.982900, valid_loss 1.000956, train_metric nan, valid_metric 0.038644
[4142451:MainThread](2024-04-06 16:27:54,835) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.985894, valid_loss 1.001225, train_metric nan, valid_metric 0.035052
[4142451:MainThread](2024-04-06 16:27:55,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.989155, valid_loss 1.002178, train_metric nan, valid_metric 0.041380
[4142451:MainThread](2024-04-06 16:27:55,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.983344, valid_loss 1.000851, train_metric nan, valid_metric 0.039796
[4142451:MainThread](2024-04-06 16:27:55,307) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.979805, valid_loss 1.006054, train_metric nan, valid_metric 0.035746
[4142451:MainThread](2024-04-06 16:27:55,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.976457, valid_loss 1.004789, train_metric nan, valid_metric 0.033879
[4142451:MainThread](2024-04-06 16:27:55,599) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.977980, valid_loss 1.001785, train_metric nan, valid_metric 0.039112
[4142451:MainThread](2024-04-06 16:27:55,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.981652, valid_loss 1.000051, train_metric nan, valid_metric 0.039106
[4142451:MainThread](2024-04-06 16:27:55,897) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.977777, valid_loss 1.002291, train_metric nan, valid_metric 0.036556
[4142451:MainThread](2024-04-06 16:27:56,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.979283, valid_loss 1.002391, train_metric nan, valid_metric 0.029178
[4142451:MainThread](2024-04-06 16:27:56,220) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.998458, valid_loss 0.999436, train_metric nan, valid_metric 0.038107
[4142451:MainThread](2024-04-06 16:27:56,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.981607, valid_loss 1.000176, train_metric nan, valid_metric 0.034866
[4142451:MainThread](2024-04-06 16:27:56,500) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.981688, valid_loss 1.001891, train_metric nan, valid_metric 0.037621
[4142451:MainThread](2024-04-06 16:27:56,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.991372, valid_loss 1.002932, train_metric nan, valid_metric 0.045021
[4142451:MainThread](2024-04-06 16:27:56,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.981679, valid_loss 0.999678, train_metric nan, valid_metric 0.042103
[4142451:MainThread](2024-04-06 16:27:56,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.976724, valid_loss 1.002633, train_metric nan, valid_metric 0.032711
[4142451:MainThread](2024-04-06 16:27:57,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.980322, valid_loss 1.002832, train_metric nan, valid_metric 0.031508
[4142451:MainThread](2024-04-06 16:27:57,227) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.987177, valid_loss 1.000543, train_metric nan, valid_metric 0.030589
[4142451:MainThread](2024-04-06 16:27:57,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.987094, valid_loss 0.998633, train_metric nan, valid_metric 0.045299
[4142451:MainThread](2024-04-06 16:27:57,505) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.991299, valid_loss 1.001224, train_metric nan, valid_metric 0.037957
[4142451:MainThread](2024-04-06 16:27:57,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.991751, valid_loss 1.000819, train_metric nan, valid_metric 0.037107
[4142451:MainThread](2024-04-06 16:27:57,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.988746, valid_loss 1.000202, train_metric nan, valid_metric 0.037688
[4142451:MainThread](2024-04-06 16:27:57,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.984542, valid_loss 1.000758, train_metric nan, valid_metric 0.041172
[4142451:MainThread](2024-04-06 16:27:58,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.969153, valid_loss 1.001993, train_metric nan, valid_metric 0.037124
[4142451:MainThread](2024-04-06 16:27:58,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.981753, valid_loss 0.999461, train_metric nan, valid_metric 0.034642
[4142451:MainThread](2024-04-06 16:27:58,386) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.988723, valid_loss 1.000445, train_metric nan, valid_metric 0.035890
[4142451:MainThread](2024-04-06 16:27:58,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.993706, valid_loss 1.001027, train_metric nan, valid_metric 0.035188
[4142451:MainThread](2024-04-06 16:27:58,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.981627, valid_loss 1.000584, train_metric nan, valid_metric 0.039076
[4142451:MainThread](2024-04-06 16:27:58,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.979951, valid_loss 1.000320, train_metric nan, valid_metric 0.045338
[4142451:MainThread](2024-04-06 16:27:58,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.986008, valid_loss 1.001376, train_metric nan, valid_metric 0.039710
[4142451:MainThread](2024-04-06 16:27:59,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.979021, valid_loss 1.000419, train_metric nan, valid_metric 0.038651
[4142451:MainThread](2024-04-06 16:27:59,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.990528, valid_loss 1.001624, train_metric nan, valid_metric 0.036708
[4142451:MainThread](2024-04-06 16:27:59,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.982648, valid_loss 1.001648, train_metric nan, valid_metric 0.038173
[4142451:MainThread](2024-04-06 16:27:59,580) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.988920, valid_loss 1.002656, train_metric nan, valid_metric 0.030318
[4142451:MainThread](2024-04-06 16:27:59,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.991793, valid_loss 1.002474, train_metric nan, valid_metric 0.036188
[4142451:MainThread](2024-04-06 16:27:59,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.972543, valid_loss 1.001096, train_metric nan, valid_metric 0.037421
[4142451:MainThread](2024-04-06 16:28:00,015) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.985583, valid_loss 1.002302, train_metric nan, valid_metric 0.036453
[4142451:MainThread](2024-04-06 16:28:00,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.976904, valid_loss 1.001983, train_metric nan, valid_metric 0.035736
[4142451:MainThread](2024-04-06 16:28:00,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.978610, valid_loss 1.001038, train_metric nan, valid_metric 0.036433
[4142451:MainThread](2024-04-06 16:28:00,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.984378, valid_loss 1.001030, train_metric nan, valid_metric 0.039385
[4142451:MainThread](2024-04-06 16:28:00,661) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.975444, valid_loss 0.999182, train_metric nan, valid_metric 0.042999
[4142451:MainThread](2024-04-06 16:28:00,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.974455, valid_loss 0.999666, train_metric nan, valid_metric 0.037575
[4142451:MainThread](2024-04-06 16:28:00,957) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.976501, valid_loss 0.998323, train_metric nan, valid_metric 0.035450
[4142451:MainThread](2024-04-06 16:28:01,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.991907, valid_loss 1.000261, train_metric nan, valid_metric 0.037774
[4142451:MainThread](2024-04-06 16:28:01,257) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.987276, valid_loss 1.001107, train_metric nan, valid_metric 0.039068
[4142451:MainThread](2024-04-06 16:28:01,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.979787, valid_loss 1.001816, train_metric nan, valid_metric 0.037117
[4142451:MainThread](2024-04-06 16:28:01,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:28:02,538) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:28:03,396) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  48%|████▊     | 25/52 [08:27<09:08, 20.30s/it][4142451:MainThread](2024-04-06 16:28:03,404) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:28:03,414) INFO - qlib.workflow - [recorder.py:341] - Recorder c0ff88b0bca94960b8fc89ea9836929e starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:28:04,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:28:04,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:28:04,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:28:04,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:28:07,486) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:28:07,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.289688, valid_loss 1.062582, train_metric nan, valid_metric 0.024716
[4142451:MainThread](2024-04-06 16:28:07,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.062582, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:28:07,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.091174, valid_loss 1.028687, train_metric nan, valid_metric -0.007314
[4142451:MainThread](2024-04-06 16:28:07,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.062582 to 1.028687, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:08,079) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.082653, valid_loss 1.048290, train_metric nan, valid_metric 0.013325
[4142451:MainThread](2024-04-06 16:28:08,229) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.049341, valid_loss 1.015801, train_metric nan, valid_metric 0.004340
[4142451:MainThread](2024-04-06 16:28:08,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.028687 to 1.015801, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:08,374) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.045226, valid_loss 1.031026, train_metric nan, valid_metric -0.008403
[4142451:MainThread](2024-04-06 16:28:08,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.042327, valid_loss 1.014046, train_metric nan, valid_metric 0.014293
[4142451:MainThread](2024-04-06 16:28:08,515) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.015801 to 1.014046, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:08,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.022006, valid_loss 1.015391, train_metric nan, valid_metric 0.005742
[4142451:MainThread](2024-04-06 16:28:08,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.033121, valid_loss 1.022887, train_metric nan, valid_metric 0.026208
[4142451:MainThread](2024-04-06 16:28:08,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.035741, valid_loss 1.017710, train_metric nan, valid_metric 0.022908
[4142451:MainThread](2024-04-06 16:28:09,052) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.025403, valid_loss 1.015120, train_metric nan, valid_metric 0.014904
[4142451:MainThread](2024-04-06 16:28:09,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.002989, valid_loss 1.008020, train_metric nan, valid_metric 0.018742
[4142451:MainThread](2024-04-06 16:28:09,183) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.014046 to 1.008020, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:09,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.004753, valid_loss 1.015552, train_metric nan, valid_metric -0.001354
[4142451:MainThread](2024-04-06 16:28:09,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.005792, valid_loss 1.008600, train_metric nan, valid_metric 0.015347
[4142451:MainThread](2024-04-06 16:28:09,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 0.993372, valid_loss 1.007461, train_metric nan, valid_metric 0.022840
[4142451:MainThread](2024-04-06 16:28:09,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.008020 to 1.007461, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:09,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.994174, valid_loss 1.022072, train_metric nan, valid_metric 0.012778
[4142451:MainThread](2024-04-06 16:28:09,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.002543, valid_loss 1.007757, train_metric nan, valid_metric 0.015594
[4142451:MainThread](2024-04-06 16:28:10,015) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.993617, valid_loss 1.013047, train_metric nan, valid_metric 0.002749
[4142451:MainThread](2024-04-06 16:28:10,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.024117, valid_loss 1.031474, train_metric nan, valid_metric 0.012438
[4142451:MainThread](2024-04-06 16:28:10,296) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.998464, valid_loss 1.012963, train_metric nan, valid_metric 0.012515
[4142451:MainThread](2024-04-06 16:28:10,438) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.040768, valid_loss 1.034559, train_metric nan, valid_metric 0.005095
[4142451:MainThread](2024-04-06 16:28:10,578) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.999316, valid_loss 1.001579, train_metric nan, valid_metric 0.034112
[4142451:MainThread](2024-04-06 16:28:10,578) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.007461 to 1.001579, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:10,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.986283, valid_loss 1.001692, train_metric nan, valid_metric 0.030910
[4142451:MainThread](2024-04-06 16:28:10,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.999269, valid_loss 1.011031, train_metric nan, valid_metric 0.008963
[4142451:MainThread](2024-04-06 16:28:11,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.978399, valid_loss 1.008329, train_metric nan, valid_metric 0.014470
[4142451:MainThread](2024-04-06 16:28:11,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.990275, valid_loss 1.006415, train_metric nan, valid_metric 0.010451
[4142451:MainThread](2024-04-06 16:28:11,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.997185, valid_loss 1.010527, train_metric nan, valid_metric -0.002457
[4142451:MainThread](2024-04-06 16:28:11,471) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.982824, valid_loss 1.014742, train_metric nan, valid_metric 0.004684
[4142451:MainThread](2024-04-06 16:28:11,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.990873, valid_loss 1.005464, train_metric nan, valid_metric 0.021449
[4142451:MainThread](2024-04-06 16:28:11,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.001956, valid_loss 1.002935, train_metric nan, valid_metric 0.023080
[4142451:MainThread](2024-04-06 16:28:11,909) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.986191, valid_loss 1.004088, train_metric nan, valid_metric 0.023711
[4142451:MainThread](2024-04-06 16:28:12,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.984184, valid_loss 1.005200, train_metric nan, valid_metric 0.019464
[4142451:MainThread](2024-04-06 16:28:12,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.009724, valid_loss 1.001495, train_metric nan, valid_metric 0.016060
[4142451:MainThread](2024-04-06 16:28:12,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001579 to 1.001495, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:12,342) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.002330, valid_loss 1.003104, train_metric nan, valid_metric 0.005388
[4142451:MainThread](2024-04-06 16:28:12,483) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.972684, valid_loss 1.004729, train_metric nan, valid_metric 0.018426
[4142451:MainThread](2024-04-06 16:28:12,630) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.994232, valid_loss 1.008933, train_metric nan, valid_metric 0.005246
[4142451:MainThread](2024-04-06 16:28:12,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.995215, valid_loss 1.003572, train_metric nan, valid_metric 0.015707
[4142451:MainThread](2024-04-06 16:28:12,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.978701, valid_loss 1.007927, train_metric nan, valid_metric 0.000429
[4142451:MainThread](2024-04-06 16:28:13,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.993741, valid_loss 1.006602, train_metric nan, valid_metric 0.014670
[4142451:MainThread](2024-04-06 16:28:13,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.986476, valid_loss 1.007278, train_metric nan, valid_metric 0.016711
[4142451:MainThread](2024-04-06 16:28:13,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.979450, valid_loss 1.008622, train_metric nan, valid_metric 0.007690
[4142451:MainThread](2024-04-06 16:28:13,494) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.985351, valid_loss 1.006364, train_metric nan, valid_metric 0.021275
[4142451:MainThread](2024-04-06 16:28:13,643) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.990404, valid_loss 1.010580, train_metric nan, valid_metric 0.002352
[4142451:MainThread](2024-04-06 16:28:13,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.990272, valid_loss 1.007282, train_metric nan, valid_metric 0.014996
[4142451:MainThread](2024-04-06 16:28:13,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.980812, valid_loss 1.007190, train_metric nan, valid_metric 0.012445
[4142451:MainThread](2024-04-06 16:28:14,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.993266, valid_loss 1.007904, train_metric nan, valid_metric 0.007659
[4142451:MainThread](2024-04-06 16:28:14,192) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.991882, valid_loss 1.006425, train_metric nan, valid_metric 0.008585
[4142451:MainThread](2024-04-06 16:28:14,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.981100, valid_loss 1.006500, train_metric nan, valid_metric 0.015032
[4142451:MainThread](2024-04-06 16:28:14,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.981919, valid_loss 1.002774, train_metric nan, valid_metric 0.012896
[4142451:MainThread](2024-04-06 16:28:14,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.987559, valid_loss 1.005267, train_metric nan, valid_metric 0.014620
[4142451:MainThread](2024-04-06 16:28:14,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.989019, valid_loss 1.006969, train_metric nan, valid_metric 0.012418
[4142451:MainThread](2024-04-06 16:28:14,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.983632, valid_loss 1.009167, train_metric nan, valid_metric 0.013141
[4142451:MainThread](2024-04-06 16:28:15,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.975720, valid_loss 1.008796, train_metric nan, valid_metric 0.003980
[4142451:MainThread](2024-04-06 16:28:15,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.976959, valid_loss 1.006304, train_metric nan, valid_metric 0.015729
[4142451:MainThread](2024-04-06 16:28:15,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.981854, valid_loss 1.004769, train_metric nan, valid_metric 0.006028
[4142451:MainThread](2024-04-06 16:28:15,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.983416, valid_loss 1.004866, train_metric nan, valid_metric 0.006652
[4142451:MainThread](2024-04-06 16:28:15,691) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.982792, valid_loss 1.003191, train_metric nan, valid_metric 0.011896
[4142451:MainThread](2024-04-06 16:28:15,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.981408, valid_loss 1.005187, train_metric nan, valid_metric 0.011413
[4142451:MainThread](2024-04-06 16:28:15,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.982185, valid_loss 1.003019, train_metric nan, valid_metric 0.018486
[4142451:MainThread](2024-04-06 16:28:16,132) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.985124, valid_loss 1.004078, train_metric nan, valid_metric 0.012098
[4142451:MainThread](2024-04-06 16:28:16,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.987783, valid_loss 1.007658, train_metric nan, valid_metric 0.011319
[4142451:MainThread](2024-04-06 16:28:16,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.984404, valid_loss 1.007090, train_metric nan, valid_metric 0.009719
[4142451:MainThread](2024-04-06 16:28:16,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.980894, valid_loss 1.007115, train_metric nan, valid_metric 0.012017
[4142451:MainThread](2024-04-06 16:28:16,731) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.989091, valid_loss 1.008075, train_metric nan, valid_metric 0.006728
[4142451:MainThread](2024-04-06 16:28:16,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.981909, valid_loss 1.005171, train_metric nan, valid_metric 0.005089
[4142451:MainThread](2024-04-06 16:28:17,034) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.979892, valid_loss 1.006346, train_metric nan, valid_metric 0.011256
[4142451:MainThread](2024-04-06 16:28:17,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.984053, valid_loss 1.006411, train_metric nan, valid_metric 0.009227
[4142451:MainThread](2024-04-06 16:28:17,326) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.981439, valid_loss 1.006178, train_metric nan, valid_metric 0.010413
[4142451:MainThread](2024-04-06 16:28:17,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.991074, valid_loss 1.004832, train_metric nan, valid_metric 0.007877
[4142451:MainThread](2024-04-06 16:28:17,635) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.984835, valid_loss 1.006919, train_metric nan, valid_metric 0.007446
[4142451:MainThread](2024-04-06 16:28:17,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.984764, valid_loss 1.006455, train_metric nan, valid_metric 0.009481
[4142451:MainThread](2024-04-06 16:28:17,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.978842, valid_loss 1.007546, train_metric nan, valid_metric 0.011374
[4142451:MainThread](2024-04-06 16:28:18,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.978672, valid_loss 1.006481, train_metric nan, valid_metric 0.013231
[4142451:MainThread](2024-04-06 16:28:18,261) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.972582, valid_loss 1.002706, train_metric nan, valid_metric 0.013207
[4142451:MainThread](2024-04-06 16:28:18,417) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.977415, valid_loss 1.002306, train_metric nan, valid_metric 0.011744
[4142451:MainThread](2024-04-06 16:28:18,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.979145, valid_loss 1.005421, train_metric nan, valid_metric 0.006123
[4142451:MainThread](2024-04-06 16:28:18,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.980467, valid_loss 1.007364, train_metric nan, valid_metric 0.010444
[4142451:MainThread](2024-04-06 16:28:18,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.979615, valid_loss 1.005444, train_metric nan, valid_metric 0.014508
[4142451:MainThread](2024-04-06 16:28:18,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.973920, valid_loss 1.003720, train_metric nan, valid_metric 0.011401
[4142451:MainThread](2024-04-06 16:28:19,127) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.980945, valid_loss 1.002328, train_metric nan, valid_metric 0.008366
[4142451:MainThread](2024-04-06 16:28:19,268) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.983463, valid_loss 1.005466, train_metric nan, valid_metric 0.010182
[4142451:MainThread](2024-04-06 16:28:19,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.988017, valid_loss 1.003944, train_metric nan, valid_metric 0.009543
[4142451:MainThread](2024-04-06 16:28:19,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.983262, valid_loss 1.004317, train_metric nan, valid_metric 0.010345
[4142451:MainThread](2024-04-06 16:28:19,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:28:20,614) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:28:21,466) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  50%|█████     | 26/52 [08:45<08:30, 19.63s/it][4142451:MainThread](2024-04-06 16:28:21,474) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:28:21,484) INFO - qlib.workflow - [recorder.py:341] - Recorder 4084159fdec04a4aac5f6bce890be82b starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:28:22,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:28:22,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:28:22,089) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:28:22,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:28:25,474) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:28:25,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.298199, valid_loss 1.070350, train_metric nan, valid_metric 0.026045
[4142451:MainThread](2024-04-06 16:28:25,767) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.070350, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:28:25,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.103237, valid_loss 1.026947, train_metric nan, valid_metric 0.030676
[4142451:MainThread](2024-04-06 16:28:25,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.070350 to 1.026947, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:26,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.058133, valid_loss 1.022466, train_metric nan, valid_metric 0.018725
[4142451:MainThread](2024-04-06 16:28:26,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.026947 to 1.022466, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:26,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.066047, valid_loss 1.014307, train_metric nan, valid_metric 0.011865
[4142451:MainThread](2024-04-06 16:28:26,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.022466 to 1.014307, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:26,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.031505, valid_loss 1.007496, train_metric nan, valid_metric 0.025582
[4142451:MainThread](2024-04-06 16:28:26,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.014307 to 1.007496, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:26,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.022880, valid_loss 1.032069, train_metric nan, valid_metric 0.020123
[4142451:MainThread](2024-04-06 16:28:26,737) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.042379, valid_loss 1.018182, train_metric nan, valid_metric 0.009567
[4142451:MainThread](2024-04-06 16:28:26,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.032603, valid_loss 1.014464, train_metric nan, valid_metric 0.027165
[4142451:MainThread](2024-04-06 16:28:27,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.043511, valid_loss 1.033472, train_metric nan, valid_metric 0.018313
[4142451:MainThread](2024-04-06 16:28:27,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.087046, valid_loss 1.019063, train_metric nan, valid_metric 0.009210
[4142451:MainThread](2024-04-06 16:28:27,398) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.040622, valid_loss 1.025346, train_metric nan, valid_metric 0.020870
[4142451:MainThread](2024-04-06 16:28:27,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.011943, valid_loss 1.003739, train_metric nan, valid_metric 0.029172
[4142451:MainThread](2024-04-06 16:28:27,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.007496 to 1.003739, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:27,793) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.008645, valid_loss 1.007531, train_metric nan, valid_metric 0.026251
[4142451:MainThread](2024-04-06 16:28:27,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.008908, valid_loss 1.009136, train_metric nan, valid_metric 0.028974
[4142451:MainThread](2024-04-06 16:28:28,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.004738, valid_loss 1.011919, train_metric nan, valid_metric 0.021504
[4142451:MainThread](2024-04-06 16:28:28,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.010393, valid_loss 1.011271, train_metric nan, valid_metric 0.019609
[4142451:MainThread](2024-04-06 16:28:28,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.004079, valid_loss 1.004141, train_metric nan, valid_metric 0.031110
[4142451:MainThread](2024-04-06 16:28:28,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.011342, valid_loss 1.007767, train_metric nan, valid_metric 0.021373
[4142451:MainThread](2024-04-06 16:28:28,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.989661, valid_loss 1.012335, train_metric nan, valid_metric 0.025476
[4142451:MainThread](2024-04-06 16:28:28,839) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.000131, valid_loss 1.005598, train_metric nan, valid_metric 0.029382
[4142451:MainThread](2024-04-06 16:28:28,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.999903, valid_loss 1.004261, train_metric nan, valid_metric 0.023164
[4142451:MainThread](2024-04-06 16:28:29,114) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.994358, valid_loss 1.002888, train_metric nan, valid_metric 0.023313
[4142451:MainThread](2024-04-06 16:28:29,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003739 to 1.002888, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:29,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.992668, valid_loss 1.003509, train_metric nan, valid_metric 0.027058
[4142451:MainThread](2024-04-06 16:28:29,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.991537, valid_loss 1.000461, train_metric nan, valid_metric 0.033031
[4142451:MainThread](2024-04-06 16:28:29,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.002888 to 1.000461, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:29,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.992324, valid_loss 1.011121, train_metric nan, valid_metric 0.027686
[4142451:MainThread](2024-04-06 16:28:29,747) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.994188, valid_loss 1.001331, train_metric nan, valid_metric 0.035480
[4142451:MainThread](2024-04-06 16:28:29,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.986059, valid_loss 1.009652, train_metric nan, valid_metric 0.030217
[4142451:MainThread](2024-04-06 16:28:30,033) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.989813, valid_loss 1.010085, train_metric nan, valid_metric 0.027699
[4142451:MainThread](2024-04-06 16:28:30,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.004508, valid_loss 1.008734, train_metric nan, valid_metric 0.029834
[4142451:MainThread](2024-04-06 16:28:30,327) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.992226, valid_loss 1.005163, train_metric nan, valid_metric 0.028448
[4142451:MainThread](2024-04-06 16:28:30,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.994928, valid_loss 1.003053, train_metric nan, valid_metric 0.034981
[4142451:MainThread](2024-04-06 16:28:30,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.990986, valid_loss 1.000928, train_metric nan, valid_metric 0.033677
[4142451:MainThread](2024-04-06 16:28:30,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.997373, valid_loss 1.001107, train_metric nan, valid_metric 0.043939
[4142451:MainThread](2024-04-06 16:28:30,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.992085, valid_loss 1.001426, train_metric nan, valid_metric 0.031753
[4142451:MainThread](2024-04-06 16:28:31,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.997828, valid_loss 1.005599, train_metric nan, valid_metric 0.027048
[4142451:MainThread](2024-04-06 16:28:31,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.985498, valid_loss 1.001116, train_metric nan, valid_metric 0.033122
[4142451:MainThread](2024-04-06 16:28:31,333) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.988604, valid_loss 1.001769, train_metric nan, valid_metric 0.029063
[4142451:MainThread](2024-04-06 16:28:31,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.980747, valid_loss 0.998717, train_metric nan, valid_metric 0.033282
[4142451:MainThread](2024-04-06 16:28:31,477) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000461 to 0.998717, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:31,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.992351, valid_loss 1.000022, train_metric nan, valid_metric 0.038464
[4142451:MainThread](2024-04-06 16:28:31,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.982517, valid_loss 1.002986, train_metric nan, valid_metric 0.023011
[4142451:MainThread](2024-04-06 16:28:31,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.983437, valid_loss 1.004827, train_metric nan, valid_metric 0.023264
[4142451:MainThread](2024-04-06 16:28:32,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.987971, valid_loss 1.002793, train_metric nan, valid_metric 0.028587
[4142451:MainThread](2024-04-06 16:28:32,192) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.996776, valid_loss 1.003446, train_metric nan, valid_metric 0.027335
[4142451:MainThread](2024-04-06 16:28:32,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.992748, valid_loss 1.003311, train_metric nan, valid_metric 0.032679
[4142451:MainThread](2024-04-06 16:28:32,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.994073, valid_loss 1.001286, train_metric nan, valid_metric 0.031508
[4142451:MainThread](2024-04-06 16:28:32,669) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.979998, valid_loss 1.003224, train_metric nan, valid_metric 0.022303
[4142451:MainThread](2024-04-06 16:28:32,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.983618, valid_loss 1.001878, train_metric nan, valid_metric 0.029493
[4142451:MainThread](2024-04-06 16:28:32,960) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.993085, valid_loss 0.999168, train_metric nan, valid_metric 0.034436
[4142451:MainThread](2024-04-06 16:28:33,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.985928, valid_loss 1.003147, train_metric nan, valid_metric 0.028252
[4142451:MainThread](2024-04-06 16:28:33,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.987220, valid_loss 1.001754, train_metric nan, valid_metric 0.031571
[4142451:MainThread](2024-04-06 16:28:33,394) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.980003, valid_loss 1.003358, train_metric nan, valid_metric 0.024310
[4142451:MainThread](2024-04-06 16:28:33,555) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.987977, valid_loss 1.003450, train_metric nan, valid_metric 0.030387
[4142451:MainThread](2024-04-06 16:28:33,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.981670, valid_loss 1.001088, train_metric nan, valid_metric 0.032094
[4142451:MainThread](2024-04-06 16:28:33,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.975489, valid_loss 0.999160, train_metric nan, valid_metric 0.032770
[4142451:MainThread](2024-04-06 16:28:33,955) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.985704, valid_loss 1.003078, train_metric nan, valid_metric 0.026260
[4142451:MainThread](2024-04-06 16:28:34,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.991298, valid_loss 0.999382, train_metric nan, valid_metric 0.034197
[4142451:MainThread](2024-04-06 16:28:34,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.997886, valid_loss 0.999718, train_metric nan, valid_metric 0.031101
[4142451:MainThread](2024-04-06 16:28:34,395) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.983706, valid_loss 0.998946, train_metric nan, valid_metric 0.036792
[4142451:MainThread](2024-04-06 16:28:34,551) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.990791, valid_loss 1.002610, train_metric nan, valid_metric 0.023079
[4142451:MainThread](2024-04-06 16:28:34,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.993913, valid_loss 1.000820, train_metric nan, valid_metric 0.031392
                          score
datetime   instrument          
2020-12-29 SH600000   -0.137600
           SH600004    0.075245
           SH600009    0.129698
           SH600010   -0.181302
           SH600011    0.009205
Epoch   760: reducing learning rate of group 0 to 1.0000e-03.
Epoch   980: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1200: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1420: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2021-01-27 SH600000    0.077205
           SH600004    0.044105
           SH600009   -0.004778
           SH600010   -0.123404
           SH600011   -0.058108
Epoch   680: reducing learning rate of group 0 to 1.0000e-03.
Epoch   900: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1120: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1340: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2021-03-03 SH600000   -0.005712
           SH600004    0.094086
           SH600009    0.034135
           SH600010   -0.138728
           SH600011    0.011823
Epoch   720: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1080: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1300: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1520: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1740: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2021-03-31 SH600000    0.315920
           SH600004    0.133409
           SH600009    0.058157
           SH600010    0.003959
           SH600011   -0.106075
Epoch   760: reducing learning rate of group 0 to 1.0000e-03.
Epoch   980: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1200: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1420: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2021-04-29 SH600000    0.013304
           SH600004    0.017915
           SH600009    0.094163
           SH600010    0.004764
           SH600011    0.028910
Epoch   700: reducing learning rate of group 0 to 1.0000e-03.
Epoch   920: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1140: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1360: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1660: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1880: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2100: reducing learning rate of group 0 to 1.5625e-05.
Epoch  2320: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2021-06-01 SH600000    0.105065
           SH600004    0.138466
           SH600009    0.063135
           SH600010   -0.051287
           SH600011   -0.039821
Epoch   700: reducing learning rate of group 0 to 1.0000e-03.
Epoch   920: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1220: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1440: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1660: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1880: reducing learning rate of group 0 to 3.1250e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2021-06-30 SH600000   -0.097826
           SH600009   -0.188280
           SH600010   -0.114491
           SH600011   -0.062500
           SH600015   -0.128478
Epoch   500: reducing learning rate of group 0 to 1.0000e-03.
Epoch   860: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1080: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1300: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1520: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2021-07-28 SH600000   -0.030166
           SH600009    0.088564
           SH600010   -0.201678
           SH600011   -0.201014
           SH600015   -0.036725
Epoch   780: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1000: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1220: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1440: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2021-08-25 SH600000    0.016723
           SH600009    0.057244
           SH600010   -0.072981
           SH600011    0.003482
           SH600015    0.012540
Epoch   660: reducing learning rate of group 0 to 1.0000e-03.
Epoch   880: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1100: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1320: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2021-09-24 SH600000   -0.071820
           SH600009   -0.070390
           SH600010   -0.082769
           SH600011   -0.250882
           SH600015   -0.056657
Epoch   880: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1100: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1320: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1540: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2021-10-29 SH600000   -0.047965
           SH600009   -0.039110
           SH600010   -0.003308
           SH600011   -0.055641
           SH600015   -0.015507
Epoch   560: reducing learning rate of group 0 to 1.0000e-03.
Epoch   800: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1020: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1240: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1580: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1800: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2020: reducing learning rate of group 0 to 1.5625e-05.
Epoch  2240: reducing learning rate of group 0 to 1.0000e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2021-11-26 SH600000    0.027698
           SH600009   -0.035095
           SH600010   -0.030461
           SH600011   -0.011887
           SH600015    0.051217
Epoch  1060: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1280: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1500: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1720: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2021-12-24 SH600000   -0.116695
           SH600009   -0.002164
           SH600010   -0.089749
           SH600011   -0.036798
           SH600015   -0.139746
Epoch   640: reducing learning rate of group 0 to 1.0000e-03.
Epoch   860: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1080: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1300: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1520: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-01-24 SH600000   -0.038962
           SH600009   -0.004168
           SH600010    0.092130
           SH600011    0.123224
           SH600015   -0.004585
Epoch   700: reducing learning rate of group 0 to 1.0000e-03.
Epoch   980: reducing learning rate of group 0 to 5.0000e-04.
[4142451:MainThread](2024-04-06 16:28:34,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.978532, valid_loss 1.001632, train_metric nan, valid_metric 0.023543
[4142451:MainThread](2024-04-06 16:28:34,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.986659, valid_loss 0.997333, train_metric nan, valid_metric 0.032057
[4142451:MainThread](2024-04-06 16:28:34,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998717 to 0.997333, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:35,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.984244, valid_loss 1.001124, train_metric nan, valid_metric 0.029823
[4142451:MainThread](2024-04-06 16:28:35,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.976529, valid_loss 1.001037, train_metric nan, valid_metric 0.031114
[4142451:MainThread](2024-04-06 16:28:35,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.989868, valid_loss 1.000740, train_metric nan, valid_metric 0.025273
[4142451:MainThread](2024-04-06 16:28:35,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.989197, valid_loss 0.998115, train_metric nan, valid_metric 0.031545
[4142451:MainThread](2024-04-06 16:28:35,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.986797, valid_loss 1.000830, train_metric nan, valid_metric 0.029437
[4142451:MainThread](2024-04-06 16:28:35,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.991512, valid_loss 0.999288, train_metric nan, valid_metric 0.031363
[4142451:MainThread](2024-04-06 16:28:35,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.977954, valid_loss 1.001020, train_metric nan, valid_metric 0.030402
[4142451:MainThread](2024-04-06 16:28:36,134) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.981518, valid_loss 1.001526, train_metric nan, valid_metric 0.029628
[4142451:MainThread](2024-04-06 16:28:36,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.983743, valid_loss 1.001904, train_metric nan, valid_metric 0.026114
[4142451:MainThread](2024-04-06 16:28:36,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.991803, valid_loss 1.001651, train_metric nan, valid_metric 0.029002
[4142451:MainThread](2024-04-06 16:28:36,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.978799, valid_loss 0.999660, train_metric nan, valid_metric 0.031219
[4142451:MainThread](2024-04-06 16:28:36,750) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.981213, valid_loss 1.000419, train_metric nan, valid_metric 0.031524
[4142451:MainThread](2024-04-06 16:28:36,892) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.998185, valid_loss 1.001494, train_metric nan, valid_metric 0.029113
[4142451:MainThread](2024-04-06 16:28:37,035) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.977145, valid_loss 1.002262, train_metric nan, valid_metric 0.029210
[4142451:MainThread](2024-04-06 16:28:37,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.990742, valid_loss 1.000573, train_metric nan, valid_metric 0.032635
[4142451:MainThread](2024-04-06 16:28:37,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.986305, valid_loss 0.999307, train_metric nan, valid_metric 0.030478
[4142451:MainThread](2024-04-06 16:28:37,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.989620, valid_loss 1.001015, train_metric nan, valid_metric 0.031191
[4142451:MainThread](2024-04-06 16:28:37,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.973155, valid_loss 1.000849, train_metric nan, valid_metric 0.032755
[4142451:MainThread](2024-04-06 16:28:37,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.991227, valid_loss 1.001500, train_metric nan, valid_metric 0.030799
[4142451:MainThread](2024-04-06 16:28:37,895) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.974639, valid_loss 1.001638, train_metric nan, valid_metric 0.030336
[4142451:MainThread](2024-04-06 16:28:38,030) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.979677, valid_loss 0.998671, train_metric nan, valid_metric 0.027997
[4142451:MainThread](2024-04-06 16:28:38,170) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.980895, valid_loss 1.001723, train_metric nan, valid_metric 0.028508
[4142451:MainThread](2024-04-06 16:28:38,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.981935, valid_loss 1.001815, train_metric nan, valid_metric 0.026624
[4142451:MainThread](2024-04-06 16:28:38,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.989444, valid_loss 1.001774, train_metric nan, valid_metric 0.027628
[4142451:MainThread](2024-04-06 16:28:38,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.997104, valid_loss 0.999894, train_metric nan, valid_metric 0.029244
[4142451:MainThread](2024-04-06 16:28:38,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.983361, valid_loss 1.000605, train_metric nan, valid_metric 0.028578
[4142451:MainThread](2024-04-06 16:28:38,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.998686, valid_loss 1.000462, train_metric nan, valid_metric 0.029170
[4142451:MainThread](2024-04-06 16:28:39,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.984933, valid_loss 1.001300, train_metric nan, valid_metric 0.027685
[4142451:MainThread](2024-04-06 16:28:39,169) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.990682, valid_loss 1.004034, train_metric nan, valid_metric 0.023392
[4142451:MainThread](2024-04-06 16:28:39,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.970788, valid_loss 1.002074, train_metric nan, valid_metric 0.027755
[4142451:MainThread](2024-04-06 16:28:39,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.985790, valid_loss 1.002041, train_metric nan, valid_metric 0.028763
[4142451:MainThread](2024-04-06 16:28:39,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.990457, valid_loss 1.001857, train_metric nan, valid_metric 0.028950
[4142451:MainThread](2024-04-06 16:28:39,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.984417, valid_loss 1.002527, train_metric nan, valid_metric 0.028572
[4142451:MainThread](2024-04-06 16:28:39,895) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.986874, valid_loss 1.000608, train_metric nan, valid_metric 0.030270
[4142451:MainThread](2024-04-06 16:28:40,037) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.985100, valid_loss 1.001886, train_metric nan, valid_metric 0.029441
[4142451:MainThread](2024-04-06 16:28:40,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.986611, valid_loss 1.000701, train_metric nan, valid_metric 0.031407
[4142451:MainThread](2024-04-06 16:28:40,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.976087, valid_loss 0.999192, train_metric nan, valid_metric 0.030007
[4142451:MainThread](2024-04-06 16:28:40,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.983159, valid_loss 1.001606, train_metric nan, valid_metric 0.029560
[4142451:MainThread](2024-04-06 16:28:40,608) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.971560, valid_loss 1.002110, train_metric nan, valid_metric 0.029992
[4142451:MainThread](2024-04-06 16:28:40,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.972189, valid_loss 1.001055, train_metric nan, valid_metric 0.029655
[4142451:MainThread](2024-04-06 16:28:40,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.984925, valid_loss 1.001863, train_metric nan, valid_metric 0.029905
[4142451:MainThread](2024-04-06 16:28:41,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.979223, valid_loss 1.002000, train_metric nan, valid_metric 0.028644
[4142451:MainThread](2024-04-06 16:28:41,188) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.977229, valid_loss 1.002486, train_metric nan, valid_metric 0.028278
[4142451:MainThread](2024-04-06 16:28:41,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 0.972618, valid_loss 1.002184, train_metric nan, valid_metric 0.028148
[4142451:MainThread](2024-04-06 16:28:41,477) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.972958, valid_loss 1.000805, train_metric nan, valid_metric 0.025853
[4142451:MainThread](2024-04-06 16:28:41,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 0.982509, valid_loss 1.000432, train_metric nan, valid_metric 0.027301
[4142451:MainThread](2024-04-06 16:28:41,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 0.986200, valid_loss 1.000549, train_metric nan, valid_metric 0.028373
[4142451:MainThread](2024-04-06 16:28:41,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 0.984568, valid_loss 1.002192, train_metric nan, valid_metric 0.028228
[4142451:MainThread](2024-04-06 16:28:42,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 0.986861, valid_loss 1.002674, train_metric nan, valid_metric 0.028359
[4142451:MainThread](2024-04-06 16:28:42,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 0.983937, valid_loss 1.002664, train_metric nan, valid_metric 0.028576
[4142451:MainThread](2024-04-06 16:28:42,213) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:28:43,231) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:28:44,076) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  52%|█████▏    | 27/52 [09:08<08:33, 20.53s/it][4142451:MainThread](2024-04-06 16:28:44,084) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:28:44,094) INFO - qlib.workflow - [recorder.py:341] - Recorder e6d4df03bbaa48a4b6d4e34d3d1d751a starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:28:44,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:28:44,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:28:44,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:28:44,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:28:48,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:28:48,477) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.259169, valid_loss 1.082529, train_metric nan, valid_metric 0.018358
[4142451:MainThread](2024-04-06 16:28:48,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.082529, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:28:48,633) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.111228, valid_loss 1.026855, train_metric nan, valid_metric 0.026114
[4142451:MainThread](2024-04-06 16:28:48,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.082529 to 1.026855, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:48,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.070751, valid_loss 1.043963, train_metric nan, valid_metric -0.004114
[4142451:MainThread](2024-04-06 16:28:48,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.052296, valid_loss 1.016614, train_metric nan, valid_metric 0.015609
[4142451:MainThread](2024-04-06 16:28:48,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.026855 to 1.016614, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:49,077) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.049155, valid_loss 1.085671, train_metric nan, valid_metric 0.022603
[4142451:MainThread](2024-04-06 16:28:49,214) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.060463, valid_loss 1.033759, train_metric nan, valid_metric 0.021973
[4142451:MainThread](2024-04-06 16:28:49,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.022147, valid_loss 1.014849, train_metric nan, valid_metric 0.019556
[4142451:MainThread](2024-04-06 16:28:49,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.016614 to 1.014849, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:49,511) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.013912, valid_loss 1.009658, train_metric nan, valid_metric 0.022167
[4142451:MainThread](2024-04-06 16:28:49,511) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.014849 to 1.009658, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:49,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.010510, valid_loss 1.005001, train_metric nan, valid_metric 0.028013
[4142451:MainThread](2024-04-06 16:28:49,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.009658 to 1.005001, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:49,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.000786, valid_loss 1.007722, train_metric nan, valid_metric 0.016253
[4142451:MainThread](2024-04-06 16:28:49,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.001327, valid_loss 1.012443, train_metric nan, valid_metric 0.014845
[4142451:MainThread](2024-04-06 16:28:50,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.007285, valid_loss 1.014686, train_metric nan, valid_metric 0.017397
[4142451:MainThread](2024-04-06 16:28:50,234) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.016533, valid_loss 1.005991, train_metric nan, valid_metric 0.028084
[4142451:MainThread](2024-04-06 16:28:50,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 0.999398, valid_loss 1.006457, train_metric nan, valid_metric 0.026714
[4142451:MainThread](2024-04-06 16:28:50,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.003648, valid_loss 1.009542, train_metric nan, valid_metric 0.019518
[4142451:MainThread](2024-04-06 16:28:50,661) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.995164, valid_loss 1.006973, train_metric nan, valid_metric 0.020116
[4142451:MainThread](2024-04-06 16:28:50,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.005642, valid_loss 1.003952, train_metric nan, valid_metric 0.015609
[4142451:MainThread](2024-04-06 16:28:50,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.005001 to 1.003952, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:50,931) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.008261, valid_loss 0.998482, train_metric nan, valid_metric 0.039658
[4142451:MainThread](2024-04-06 16:28:50,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003952 to 0.998482, save checkpoint.
[4142451:MainThread](2024-04-06 16:28:51,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.985043, valid_loss 1.008788, train_metric nan, valid_metric 0.020411
[4142451:MainThread](2024-04-06 16:28:51,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.995804, valid_loss 1.009751, train_metric nan, valid_metric 0.017510
[4142451:MainThread](2024-04-06 16:28:51,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.000980, valid_loss 1.007944, train_metric nan, valid_metric 0.009692
[4142451:MainThread](2024-04-06 16:28:51,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.999777, valid_loss 1.004203, train_metric nan, valid_metric 0.025201
[4142451:MainThread](2024-04-06 16:28:51,666) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.984900, valid_loss 1.002856, train_metric nan, valid_metric 0.024948
[4142451:MainThread](2024-04-06 16:28:51,804) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.986553, valid_loss 1.007746, train_metric nan, valid_metric 0.025226
[4142451:MainThread](2024-04-06 16:28:51,936) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.989597, valid_loss 1.008714, train_metric nan, valid_metric 0.018080
[4142451:MainThread](2024-04-06 16:28:52,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.988850, valid_loss 1.003721, train_metric nan, valid_metric 0.022782
[4142451:MainThread](2024-04-06 16:28:52,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.987625, valid_loss 1.007368, train_metric nan, valid_metric 0.030815
[4142451:MainThread](2024-04-06 16:28:52,346) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.986565, valid_loss 1.007841, train_metric nan, valid_metric 0.021971
[4142451:MainThread](2024-04-06 16:28:52,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.005023, valid_loss 1.002911, train_metric nan, valid_metric 0.026386
[4142451:MainThread](2024-04-06 16:28:52,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.976466, valid_loss 1.006830, train_metric nan, valid_metric 0.014440
[4142451:MainThread](2024-04-06 16:28:52,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.988031, valid_loss 1.002516, train_metric nan, valid_metric 0.024429
[4142451:MainThread](2024-04-06 16:28:52,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.987081, valid_loss 1.004517, train_metric nan, valid_metric 0.019409
[4142451:MainThread](2024-04-06 16:28:53,104) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.974799, valid_loss 1.003785, train_metric nan, valid_metric 0.024000
[4142451:MainThread](2024-04-06 16:28:53,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.975894, valid_loss 1.006279, train_metric nan, valid_metric 0.014673
[4142451:MainThread](2024-04-06 16:28:53,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.985536, valid_loss 1.004004, train_metric nan, valid_metric 0.023695
[4142451:MainThread](2024-04-06 16:28:53,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.992706, valid_loss 1.001064, train_metric nan, valid_metric 0.023192
[4142451:MainThread](2024-04-06 16:28:53,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.993890, valid_loss 1.001587, train_metric nan, valid_metric 0.021664
[4142451:MainThread](2024-04-06 16:28:53,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.984350, valid_loss 1.003943, train_metric nan, valid_metric 0.020433
[4142451:MainThread](2024-04-06 16:28:54,005) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.997704, valid_loss 1.002566, train_metric nan, valid_metric 0.014945
[4142451:MainThread](2024-04-06 16:28:54,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.982606, valid_loss 1.003569, train_metric nan, valid_metric 0.017597
[4142451:MainThread](2024-04-06 16:28:54,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.992819, valid_loss 1.003514, train_metric nan, valid_metric 0.015275
[4142451:MainThread](2024-04-06 16:28:54,474) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.987968, valid_loss 1.001959, train_metric nan, valid_metric 0.021537
[4142451:MainThread](2024-04-06 16:28:54,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.986871, valid_loss 1.003346, train_metric nan, valid_metric 0.018647
[4142451:MainThread](2024-04-06 16:28:54,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.982975, valid_loss 1.001881, train_metric nan, valid_metric 0.017499
[4142451:MainThread](2024-04-06 16:28:54,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.987262, valid_loss 1.002970, train_metric nan, valid_metric 0.018426
[4142451:MainThread](2024-04-06 16:28:55,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.981391, valid_loss 1.004197, train_metric nan, valid_metric 0.016028
[4142451:MainThread](2024-04-06 16:28:55,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.988732, valid_loss 1.004119, train_metric nan, valid_metric 0.014519
[4142451:MainThread](2024-04-06 16:28:55,417) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.982691, valid_loss 1.003672, train_metric nan, valid_metric 0.021401
[4142451:MainThread](2024-04-06 16:28:55,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.990096, valid_loss 1.002367, train_metric nan, valid_metric 0.022814
[4142451:MainThread](2024-04-06 16:28:55,754) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.994444, valid_loss 1.003554, train_metric nan, valid_metric 0.021049
[4142451:MainThread](2024-04-06 16:28:55,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.982353, valid_loss 1.003542, train_metric nan, valid_metric 0.019488
[4142451:MainThread](2024-04-06 16:28:56,035) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.975083, valid_loss 1.000919, train_metric nan, valid_metric 0.020765
[4142451:MainThread](2024-04-06 16:28:56,180) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.986447, valid_loss 1.002604, train_metric nan, valid_metric 0.018967
[4142451:MainThread](2024-04-06 16:28:56,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.986902, valid_loss 1.002357, train_metric nan, valid_metric 0.016008
[4142451:MainThread](2024-04-06 16:28:56,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.981968, valid_loss 1.002095, train_metric nan, valid_metric 0.017588
[4142451:MainThread](2024-04-06 16:28:56,684) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.981939, valid_loss 1.001069, train_metric nan, valid_metric 0.021123
[4142451:MainThread](2024-04-06 16:28:56,850) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.980317, valid_loss 1.001856, train_metric nan, valid_metric 0.020122
[4142451:MainThread](2024-04-06 16:28:57,016) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.966677, valid_loss 1.002970, train_metric nan, valid_metric 0.022003
[4142451:MainThread](2024-04-06 16:28:57,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.982996, valid_loss 1.002692, train_metric nan, valid_metric 0.021252
[4142451:MainThread](2024-04-06 16:28:57,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.989841, valid_loss 1.002440, train_metric nan, valid_metric 0.024045
[4142451:MainThread](2024-04-06 16:28:57,526) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.995576, valid_loss 1.001551, train_metric nan, valid_metric 0.020276
[4142451:MainThread](2024-04-06 16:28:57,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.988081, valid_loss 1.003202, train_metric nan, valid_metric 0.020504
[4142451:MainThread](2024-04-06 16:28:57,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.984005, valid_loss 1.002699, train_metric nan, valid_metric 0.022067
[4142451:MainThread](2024-04-06 16:28:57,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.982221, valid_loss 1.003347, train_metric nan, valid_metric 0.022043
[4142451:MainThread](2024-04-06 16:28:58,089) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.978512, valid_loss 1.002818, train_metric nan, valid_metric 0.020458
[4142451:MainThread](2024-04-06 16:28:58,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.978796, valid_loss 1.003624, train_metric nan, valid_metric 0.019482
[4142451:MainThread](2024-04-06 16:28:58,353) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.971217, valid_loss 1.003576, train_metric nan, valid_metric 0.020265
[4142451:MainThread](2024-04-06 16:28:58,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.973402, valid_loss 1.002359, train_metric nan, valid_metric 0.018963
[4142451:MainThread](2024-04-06 16:28:58,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:28:59,454) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:29:00,319) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  54%|█████▍    | 28/52 [09:24<07:41, 19.24s/it][4142451:MainThread](2024-04-06 16:29:00,327) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:29:00,337) INFO - qlib.workflow - [recorder.py:341] - Recorder 200724c977cb4542b86df935c8c5934d starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:29:00,942) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:29:00,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:29:00,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:29:00,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:29:04,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:29:04,667) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.226431, valid_loss 1.093816, train_metric nan, valid_metric 0.009348
[4142451:MainThread](2024-04-06 16:29:04,667) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.093816, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:29:04,813) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.097052, valid_loss 1.028473, train_metric nan, valid_metric -0.010415
[4142451:MainThread](2024-04-06 16:29:04,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.093816 to 1.028473, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:04,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.059460, valid_loss 1.070487, train_metric nan, valid_metric -0.007786
[4142451:MainThread](2024-04-06 16:29:05,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.041823, valid_loss 1.030881, train_metric nan, valid_metric 0.007843
[4142451:MainThread](2024-04-06 16:29:05,263) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.020986, valid_loss 1.014697, train_metric nan, valid_metric 0.006135
[4142451:MainThread](2024-04-06 16:29:05,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.028473 to 1.014697, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:05,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.027624, valid_loss 1.023313, train_metric nan, valid_metric 0.004780
[4142451:MainThread](2024-04-06 16:29:05,564) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.050811, valid_loss 1.012645, train_metric nan, valid_metric -0.007741
[4142451:MainThread](2024-04-06 16:29:05,564) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.014697 to 1.012645, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:05,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.032246, valid_loss 1.017434, train_metric nan, valid_metric 0.015498
[4142451:MainThread](2024-04-06 16:29:05,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.005147, valid_loss 1.024533, train_metric nan, valid_metric 0.003307
[4142451:MainThread](2024-04-06 16:29:06,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.002251, valid_loss 1.013826, train_metric nan, valid_metric 0.000130
[4142451:MainThread](2024-04-06 16:29:06,143) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.016422, valid_loss 1.016669, train_metric nan, valid_metric 0.001486
[4142451:MainThread](2024-04-06 16:29:06,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.019668, valid_loss 1.019165, train_metric nan, valid_metric 0.004181
[4142451:MainThread](2024-04-06 16:29:06,427) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.008345, valid_loss 1.011722, train_metric nan, valid_metric 0.011545
[4142451:MainThread](2024-04-06 16:29:06,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.012645 to 1.011722, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:06,591) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 0.995468, valid_loss 1.009576, train_metric nan, valid_metric 0.020442
[4142451:MainThread](2024-04-06 16:29:06,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.011722 to 1.009576, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:06,737) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.993460, valid_loss 1.009720, train_metric nan, valid_metric 0.018954
[4142451:MainThread](2024-04-06 16:29:06,885) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.985377, valid_loss 1.018641, train_metric nan, valid_metric 0.010245
[4142451:MainThread](2024-04-06 16:29:07,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.992283, valid_loss 1.004560, train_metric nan, valid_metric 0.013268
[4142451:MainThread](2024-04-06 16:29:07,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.009576 to 1.004560, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:07,169) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.993236, valid_loss 1.013110, train_metric nan, valid_metric 0.006312
[4142451:MainThread](2024-04-06 16:29:07,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.994788, valid_loss 1.007833, train_metric nan, valid_metric 0.012973
[4142451:MainThread](2024-04-06 16:29:07,452) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.982284, valid_loss 1.010022, train_metric nan, valid_metric 0.009529
[4142451:MainThread](2024-04-06 16:29:07,598) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.995603, valid_loss 1.007142, train_metric nan, valid_metric 0.018284
[4142451:MainThread](2024-04-06 16:29:07,755) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.990981, valid_loss 1.017772, train_metric nan, valid_metric 0.018020
[4142451:MainThread](2024-04-06 16:29:07,899) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.995490, valid_loss 1.008564, train_metric nan, valid_metric 0.010574
[4142451:MainThread](2024-04-06 16:29:08,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.995347, valid_loss 1.008743, train_metric nan, valid_metric 0.013343
[4142451:MainThread](2024-04-06 16:29:08,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.990076, valid_loss 1.018804, train_metric nan, valid_metric 0.012327
[4142451:MainThread](2024-04-06 16:29:08,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.997083, valid_loss 1.009246, train_metric nan, valid_metric 0.016218
[4142451:MainThread](2024-04-06 16:29:08,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.988445, valid_loss 1.002293, train_metric nan, valid_metric 0.017768
[4142451:MainThread](2024-04-06 16:29:08,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.004560 to 1.002293, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:08,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.989638, valid_loss 1.006030, train_metric nan, valid_metric 0.011407
[4142451:MainThread](2024-04-06 16:29:08,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.993075, valid_loss 1.007637, train_metric nan, valid_metric 0.007812
[4142451:MainThread](2024-04-06 16:29:09,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.980167, valid_loss 1.007532, train_metric nan, valid_metric 0.007119
[4142451:MainThread](2024-04-06 16:29:09,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.994837, valid_loss 1.006693, train_metric nan, valid_metric 0.015227
[4142451:MainThread](2024-04-06 16:29:09,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.001371, valid_loss 1.005294, train_metric nan, valid_metric 0.016802
[4142451:MainThread](2024-04-06 16:29:09,578) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.997105, valid_loss 1.002778, train_metric nan, valid_metric 0.013331
[4142451:MainThread](2024-04-06 16:29:09,762) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.988193, valid_loss 1.007845, train_metric nan, valid_metric 0.006458
[4142451:MainThread](2024-04-06 16:29:09,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.989057, valid_loss 1.007391, train_metric nan, valid_metric -0.002079
[4142451:MainThread](2024-04-06 16:29:10,114) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.986490, valid_loss 1.006248, train_metric nan, valid_metric 0.010281
[4142451:MainThread](2024-04-06 16:29:10,300) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.995604, valid_loss 1.013007, train_metric nan, valid_metric 0.014145
[4142451:MainThread](2024-04-06 16:29:10,474) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.997958, valid_loss 1.006485, train_metric nan, valid_metric 0.013786
[4142451:MainThread](2024-04-06 16:29:10,638) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.990306, valid_loss 1.004520, train_metric nan, valid_metric 0.006186
[4142451:MainThread](2024-04-06 16:29:10,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.994878, valid_loss 1.005662, train_metric nan, valid_metric -0.002997
[4142451:MainThread](2024-04-06 16:29:10,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.992750, valid_loss 1.005580, train_metric nan, valid_metric 0.012771
[4142451:MainThread](2024-04-06 16:29:11,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.988325, valid_loss 1.003194, train_metric nan, valid_metric 0.006352
[4142451:MainThread](2024-04-06 16:29:11,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.993609, valid_loss 1.004889, train_metric nan, valid_metric 0.007631
[4142451:MainThread](2024-04-06 16:29:11,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.979601, valid_loss 1.003574, train_metric nan, valid_metric 0.010113
[4142451:MainThread](2024-04-06 16:29:11,623) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.978087, valid_loss 1.008286, train_metric nan, valid_metric 0.009213
[4142451:MainThread](2024-04-06 16:29:11,794) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.986312, valid_loss 1.007582, train_metric nan, valid_metric 0.014574
[4142451:MainThread](2024-04-06 16:29:11,960) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.974408, valid_loss 1.007065, train_metric nan, valid_metric 0.011018
[4142451:MainThread](2024-04-06 16:29:12,132) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.989748, valid_loss 1.005546, train_metric nan, valid_metric 0.006104
[4142451:MainThread](2024-04-06 16:29:12,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.979894, valid_loss 1.006567, train_metric nan, valid_metric 0.007237
[4142451:MainThread](2024-04-06 16:29:12,470) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.988848, valid_loss 1.006349, train_metric nan, valid_metric 0.012763
[4142451:MainThread](2024-04-06 16:29:12,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.986113, valid_loss 1.005622, train_metric nan, valid_metric 0.012171
[4142451:MainThread](2024-04-06 16:29:12,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.988939, valid_loss 1.005917, train_metric nan, valid_metric 0.007433
[4142451:MainThread](2024-04-06 16:29:12,957) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.970678, valid_loss 1.005291, train_metric nan, valid_metric 0.013544
[4142451:MainThread](2024-04-06 16:29:13,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.990870, valid_loss 1.004769, train_metric nan, valid_metric 0.013522
[4142451:MainThread](2024-04-06 16:29:13,238) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.974458, valid_loss 1.007568, train_metric nan, valid_metric 0.007074
[4142451:MainThread](2024-04-06 16:29:13,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.984990, valid_loss 1.006008, train_metric nan, valid_metric 0.006544
[4142451:MainThread](2024-04-06 16:29:13,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.982976, valid_loss 1.007444, train_metric nan, valid_metric 0.008902
[4142451:MainThread](2024-04-06 16:29:13,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.989655, valid_loss 1.007028, train_metric nan, valid_metric 0.005195
[4142451:MainThread](2024-04-06 16:29:13,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.984452, valid_loss 1.007540, train_metric nan, valid_metric 0.010040
[4142451:MainThread](2024-04-06 16:29:13,941) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.986297, valid_loss 1.007819, train_metric nan, valid_metric 0.011384
[4142451:MainThread](2024-04-06 16:29:14,084) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.977909, valid_loss 1.004267, train_metric nan, valid_metric 0.011301
[4142451:MainThread](2024-04-06 16:29:14,229) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.972502, valid_loss 1.007060, train_metric nan, valid_metric 0.009204
[4142451:MainThread](2024-04-06 16:29:14,375) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.975620, valid_loss 1.006933, train_metric nan, valid_metric 0.010840
[4142451:MainThread](2024-04-06 16:29:14,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.987760, valid_loss 1.003733, train_metric nan, valid_metric 0.008217
[4142451:MainThread](2024-04-06 16:29:14,659) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.979725, valid_loss 1.006036, train_metric nan, valid_metric 0.008869
[4142451:MainThread](2024-04-06 16:29:14,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.985198, valid_loss 1.006932, train_metric nan, valid_metric 0.011111
[4142451:MainThread](2024-04-06 16:29:15,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.975428, valid_loss 1.006291, train_metric nan, valid_metric 0.013800
[4142451:MainThread](2024-04-06 16:29:15,180) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.971343, valid_loss 1.006827, train_metric nan, valid_metric 0.011416
[4142451:MainThread](2024-04-06 16:29:15,341) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.970919, valid_loss 1.007397, train_metric nan, valid_metric 0.011223
[4142451:MainThread](2024-04-06 16:29:15,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.973554, valid_loss 1.002567, train_metric nan, valid_metric 0.006889
[4142451:MainThread](2024-04-06 16:29:15,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.988893, valid_loss 1.003621, train_metric nan, valid_metric 0.010050
[4142451:MainThread](2024-04-06 16:29:15,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.987757, valid_loss 1.005603, train_metric nan, valid_metric 0.010934
[4142451:MainThread](2024-04-06 16:29:15,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.987838, valid_loss 1.006437, train_metric nan, valid_metric 0.010363
[4142451:MainThread](2024-04-06 16:29:16,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.981748, valid_loss 1.003266, train_metric nan, valid_metric 0.008721
[4142451:MainThread](2024-04-06 16:29:16,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.989893, valid_loss 1.006562, train_metric nan, valid_metric 0.011916
[4142451:MainThread](2024-04-06 16:29:16,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.984354, valid_loss 1.005631, train_metric nan, valid_metric 0.011492
[4142451:MainThread](2024-04-06 16:29:16,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.974857, valid_loss 1.005959, train_metric nan, valid_metric 0.011323
[4142451:MainThread](2024-04-06 16:29:16,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:29:17,377) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:29:18,238) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  56%|█████▌    | 29/52 [09:42<07:13, 18.84s/it][4142451:MainThread](2024-04-06 16:29:18,246) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:29:18,255) INFO - qlib.workflow - [recorder.py:341] - Recorder 0080389f9e0e4e89b8a285892a0379b0 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:29:18,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:29:18,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:29:18,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:29:18,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:29:22,322) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:29:22,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.277579, valid_loss 1.084236, train_metric nan, valid_metric 0.000437
[4142451:MainThread](2024-04-06 16:29:22,611) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.084236, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:29:22,755) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.087396, valid_loss 1.046290, train_metric nan, valid_metric 0.021044
[4142451:MainThread](2024-04-06 16:29:22,755) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.084236 to 1.046290, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:22,899) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.049394, valid_loss 1.022174, train_metric nan, valid_metric 0.023157
[4142451:MainThread](2024-04-06 16:29:22,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.046290 to 1.022174, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:23,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.041224, valid_loss 1.019115, train_metric nan, valid_metric 0.032036
[4142451:MainThread](2024-04-06 16:29:23,052) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.022174 to 1.019115, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:23,196) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.039295, valid_loss 1.023231, train_metric nan, valid_metric 0.019339
[4142451:MainThread](2024-04-06 16:29:23,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.045519, valid_loss 1.013886, train_metric nan, valid_metric 0.022955
[4142451:MainThread](2024-04-06 16:29:23,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.019115 to 1.013886, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:23,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.028408, valid_loss 1.014209, train_metric nan, valid_metric 0.021006
[4142451:MainThread](2024-04-06 16:29:23,624) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.033764, valid_loss 1.023669, train_metric nan, valid_metric 0.027149
[4142451:MainThread](2024-04-06 16:29:23,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.004802, valid_loss 1.010828, train_metric nan, valid_metric 0.018153
[4142451:MainThread](2024-04-06 16:29:23,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.013886 to 1.010828, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:23,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.008634, valid_loss 1.008598, train_metric nan, valid_metric -0.007398
[4142451:MainThread](2024-04-06 16:29:23,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.010828 to 1.008598, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:24,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.005990, valid_loss 1.007744, train_metric nan, valid_metric 0.029602
[4142451:MainThread](2024-04-06 16:29:24,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.008598 to 1.007744, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:24,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.001361, valid_loss 1.004475, train_metric nan, valid_metric 0.008101
[4142451:MainThread](2024-04-06 16:29:24,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.007744 to 1.004475, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:24,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.994733, valid_loss 1.001847, train_metric nan, valid_metric 0.033004
[4142451:MainThread](2024-04-06 16:29:24,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.004475 to 1.001847, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:24,496) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.007583, valid_loss 1.009102, train_metric nan, valid_metric 0.010060
[4142451:MainThread](2024-04-06 16:29:24,643) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.998819, valid_loss 1.009935, train_metric nan, valid_metric 0.026914
[4142451:MainThread](2024-04-06 16:29:24,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.007406, valid_loss 1.012782, train_metric nan, valid_metric 0.032021
[4142451:MainThread](2024-04-06 16:29:24,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.998254, valid_loss 1.012624, train_metric nan, valid_metric 0.037509
[4142451:MainThread](2024-04-06 16:29:25,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.993258, valid_loss 1.008997, train_metric nan, valid_metric 0.037845
[4142451:MainThread](2024-04-06 16:29:25,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.991021, valid_loss 1.005190, train_metric nan, valid_metric 0.030964
[4142451:MainThread](2024-04-06 16:29:25,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.989919, valid_loss 0.997234, train_metric nan, valid_metric 0.038839
[4142451:MainThread](2024-04-06 16:29:25,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001847 to 0.997234, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:25,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.987044, valid_loss 1.001262, train_metric nan, valid_metric 0.030849
[4142451:MainThread](2024-04-06 16:29:25,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.990548, valid_loss 1.008670, train_metric nan, valid_metric 0.026145
[4142451:MainThread](2024-04-06 16:29:25,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.995125, valid_loss 1.006637, train_metric nan, valid_metric 0.026690
[4142451:MainThread](2024-04-06 16:29:25,953) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.995112, valid_loss 0.999689, train_metric nan, valid_metric 0.032347
[4142451:MainThread](2024-04-06 16:29:26,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.983815, valid_loss 1.000968, train_metric nan, valid_metric 0.028744
[4142451:MainThread](2024-04-06 16:29:26,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.983005, valid_loss 1.005072, train_metric nan, valid_metric 0.033025
[4142451:MainThread](2024-04-06 16:29:26,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.985218, valid_loss 1.004440, train_metric nan, valid_metric 0.020846
[4142451:MainThread](2024-04-06 16:29:26,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.998955, valid_loss 1.002430, train_metric nan, valid_metric 0.018646
[4142451:MainThread](2024-04-06 16:29:26,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.995129, valid_loss 1.001922, train_metric nan, valid_metric 0.036450
[4142451:MainThread](2024-04-06 16:29:26,812) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.990290, valid_loss 1.006322, train_metric nan, valid_metric 0.045816
[4142451:MainThread](2024-04-06 16:29:26,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.983526, valid_loss 0.999589, train_metric nan, valid_metric 0.036456
[4142451:MainThread](2024-04-06 16:29:27,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.985227, valid_loss 1.001786, train_metric nan, valid_metric 0.031182
[4142451:MainThread](2024-04-06 16:29:27,238) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.996599, valid_loss 1.003501, train_metric nan, valid_metric 0.031035
[4142451:MainThread](2024-04-06 16:29:27,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.984790, valid_loss 1.001278, train_metric nan, valid_metric 0.032877
[4142451:MainThread](2024-04-06 16:29:27,528) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.989518, valid_loss 1.002192, train_metric nan, valid_metric 0.030095
[4142451:MainThread](2024-04-06 16:29:27,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.990678, valid_loss 1.000943, train_metric nan, valid_metric 0.026852
[4142451:MainThread](2024-04-06 16:29:27,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.976561, valid_loss 1.001197, train_metric nan, valid_metric 0.033349
[4142451:MainThread](2024-04-06 16:29:27,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.988358, valid_loss 0.997885, train_metric nan, valid_metric 0.031160
[4142451:MainThread](2024-04-06 16:29:28,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.979448, valid_loss 1.000997, train_metric nan, valid_metric 0.026418
[4142451:MainThread](2024-04-06 16:29:28,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.990886, valid_loss 1.003937, train_metric nan, valid_metric 0.035038
[4142451:MainThread](2024-04-06 16:29:28,396) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.981797, valid_loss 1.003636, train_metric nan, valid_metric 0.028794
[4142451:MainThread](2024-04-06 16:29:28,541) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.982479, valid_loss 1.002468, train_metric nan, valid_metric 0.037498
[4142451:MainThread](2024-04-06 16:29:28,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.980553, valid_loss 1.004496, train_metric nan, valid_metric 0.024208
[4142451:MainThread](2024-04-06 16:29:28,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.990764, valid_loss 1.002362, train_metric nan, valid_metric 0.030663
[4142451:MainThread](2024-04-06 16:29:28,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.981940, valid_loss 1.003526, train_metric nan, valid_metric 0.030987
[4142451:MainThread](2024-04-06 16:29:29,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.977255, valid_loss 1.003549, train_metric nan, valid_metric 0.024744
[4142451:MainThread](2024-04-06 16:29:29,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.986314, valid_loss 0.999906, train_metric nan, valid_metric 0.034752
[4142451:MainThread](2024-04-06 16:29:29,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.982399, valid_loss 1.002988, train_metric nan, valid_metric 0.026265
[4142451:MainThread](2024-04-06 16:29:29,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.976923, valid_loss 1.004544, train_metric nan, valid_metric 0.035987
[4142451:MainThread](2024-04-06 16:29:29,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.973856, valid_loss 1.002559, train_metric nan, valid_metric 0.030245
[4142451:MainThread](2024-04-06 16:29:29,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.992083, valid_loss 1.000938, train_metric nan, valid_metric 0.032674
[4142451:MainThread](2024-04-06 16:29:30,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.985320, valid_loss 1.003241, train_metric nan, valid_metric 0.027373
[4142451:MainThread](2024-04-06 16:29:30,270) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.984358, valid_loss 1.001021, train_metric nan, valid_metric 0.034960
[4142451:MainThread](2024-04-06 16:29:30,400) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.997158, valid_loss 1.002772, train_metric nan, valid_metric 0.034256
[4142451:MainThread](2024-04-06 16:29:30,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.989830, valid_loss 1.002713, train_metric nan, valid_metric 0.027894
[4142451:MainThread](2024-04-06 16:29:30,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.992666, valid_loss 0.999782, train_metric nan, valid_metric 0.030566
[4142451:MainThread](2024-04-06 16:29:30,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.981911, valid_loss 1.001867, train_metric nan, valid_metric 0.028531
[4142451:MainThread](2024-04-06 16:29:30,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.980487, valid_loss 1.002501, train_metric nan, valid_metric 0.031336
[4142451:MainThread](2024-04-06 16:29:31,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.987057, valid_loss 0.999497, train_metric nan, valid_metric 0.031022
[4142451:MainThread](2024-04-06 16:29:31,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.983229, valid_loss 0.999990, train_metric nan, valid_metric 0.027645
[4142451:MainThread](2024-04-06 16:29:31,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.983289, valid_loss 0.999463, train_metric nan, valid_metric 0.025422
[4142451:MainThread](2024-04-06 16:29:31,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.988784, valid_loss 0.998204, train_metric nan, valid_metric 0.029013
[4142451:MainThread](2024-04-06 16:29:31,712) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.990784, valid_loss 0.999470, train_metric nan, valid_metric 0.029980
[4142451:MainThread](2024-04-06 16:29:31,856) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.977525, valid_loss 1.002613, train_metric nan, valid_metric 0.030258
[4142451:MainThread](2024-04-06 16:29:31,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.988107, valid_loss 1.002957, train_metric nan, valid_metric 0.029490
[4142451:MainThread](2024-04-06 16:29:32,141) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.977486, valid_loss 1.000420, train_metric nan, valid_metric 0.025462
[4142451:MainThread](2024-04-06 16:29:32,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.980943, valid_loss 0.999303, train_metric nan, valid_metric 0.031802
[4142451:MainThread](2024-04-06 16:29:32,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.972092, valid_loss 1.002004, train_metric nan, valid_metric 0.030888
[4142451:MainThread](2024-04-06 16:29:32,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.979247, valid_loss 1.002855, train_metric nan, valid_metric 0.030297
[4142451:MainThread](2024-04-06 16:29:32,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.989344, valid_loss 0.999769, train_metric nan, valid_metric 0.033262
[4142451:MainThread](2024-04-06 16:29:32,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:29:33,564) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:29:34,271) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  58%|█████▊    | 30/52 [09:58<06:36, 18.00s/it][4142451:MainThread](2024-04-06 16:29:34,279) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:29:34,289) INFO - qlib.workflow - [recorder.py:341] - Recorder 4523a1396a8f465e940ac404182c4730 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:29:34,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:29:34,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:29:34,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:29:34,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:29:38,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:29:38,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.334151, valid_loss 1.103889, train_metric nan, valid_metric 0.016972
[4142451:MainThread](2024-04-06 16:29:38,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.103889, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:29:39,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.116855, valid_loss 1.034410, train_metric nan, valid_metric 0.008494
[4142451:MainThread](2024-04-06 16:29:39,064) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.103889 to 1.034410, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:39,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.109739, valid_loss 1.033193, train_metric nan, valid_metric -0.012340
[4142451:MainThread](2024-04-06 16:29:39,203) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.034410 to 1.033193, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:39,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.059379, valid_loss 1.047827, train_metric nan, valid_metric 0.030271
[4142451:MainThread](2024-04-06 16:29:39,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.040307, valid_loss 1.018800, train_metric nan, valid_metric 0.021980
[4142451:MainThread](2024-04-06 16:29:39,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.033193 to 1.018800, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:39,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.050968, valid_loss 1.040821, train_metric nan, valid_metric 0.025005
[4142451:MainThread](2024-04-06 16:29:39,762) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.027872, valid_loss 1.007038, train_metric nan, valid_metric 0.036162
[4142451:MainThread](2024-04-06 16:29:39,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.018800 to 1.007038, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:39,898) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.016884, valid_loss 1.007052, train_metric nan, valid_metric 0.033036
[4142451:MainThread](2024-04-06 16:29:40,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.081460, valid_loss 1.021187, train_metric nan, valid_metric 0.034078
[4142451:MainThread](2024-04-06 16:29:40,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.059511, valid_loss 1.020384, train_metric nan, valid_metric 0.013790
[4142451:MainThread](2024-04-06 16:29:40,325) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.021227, valid_loss 1.010821, train_metric nan, valid_metric 0.018970
[4142451:MainThread](2024-04-06 16:29:40,468) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.001850, valid_loss 1.020004, train_metric nan, valid_metric 0.030855
[4142451:MainThread](2024-04-06 16:29:40,611) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.005733, valid_loss 1.005097, train_metric nan, valid_metric 0.025752
[4142451:MainThread](2024-04-06 16:29:40,612) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.007038 to 1.005097, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:40,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.008702, valid_loss 1.009209, train_metric nan, valid_metric 0.006802
[4142451:MainThread](2024-04-06 16:29:40,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.012957, valid_loss 1.000178, train_metric nan, valid_metric 0.023539
[4142451:MainThread](2024-04-06 16:29:40,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.005097 to 1.000178, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:41,084) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.005784, valid_loss 1.024961, train_metric nan, valid_metric 0.036998
[4142451:MainThread](2024-04-06 16:29:41,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.003295, valid_loss 1.008587, train_metric nan, valid_metric 0.041487
[4142451:MainThread](2024-04-06 16:29:41,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.995052, valid_loss 1.022496, train_metric nan, valid_metric 0.042044
[4142451:MainThread](2024-04-06 16:29:41,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.006069, valid_loss 1.000779, train_metric nan, valid_metric 0.032723
[4142451:MainThread](2024-04-06 16:29:41,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.995190, valid_loss 1.000768, train_metric nan, valid_metric 0.051518
[4142451:MainThread](2024-04-06 16:29:41,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.000379, valid_loss 1.015317, train_metric nan, valid_metric 0.045178
[4142451:MainThread](2024-04-06 16:29:41,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.986138, valid_loss 1.001746, train_metric nan, valid_metric 0.039152
[4142451:MainThread](2024-04-06 16:29:42,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.999712, valid_loss 1.009529, train_metric nan, valid_metric 0.034672
[4142451:MainThread](2024-04-06 16:29:42,210) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.994501, valid_loss 1.001363, train_metric nan, valid_metric 0.047067
[4142451:MainThread](2024-04-06 16:29:42,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.990665, valid_loss 1.000702, train_metric nan, valid_metric 0.054818
[4142451:MainThread](2024-04-06 16:29:42,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.000599, valid_loss 0.996841, train_metric nan, valid_metric 0.049308
[4142451:MainThread](2024-04-06 16:29:42,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000178 to 0.996841, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:42,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.995551, valid_loss 1.000382, train_metric nan, valid_metric 0.045977
[4142451:MainThread](2024-04-06 16:29:42,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.984529, valid_loss 1.001793, train_metric nan, valid_metric 0.040314
[4142451:MainThread](2024-04-06 16:29:42,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.986557, valid_loss 1.004489, train_metric nan, valid_metric 0.050405
[4142451:MainThread](2024-04-06 16:29:43,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.987920, valid_loss 0.999958, train_metric nan, valid_metric 0.046853
[4142451:MainThread](2024-04-06 16:29:43,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.986814, valid_loss 1.002401, train_metric nan, valid_metric 0.037149
[4142451:MainThread](2024-04-06 16:29:43,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.988840, valid_loss 0.999846, train_metric nan, valid_metric 0.048043
[4142451:MainThread](2024-04-06 16:29:43,583) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.983460, valid_loss 1.003135, train_metric nan, valid_metric 0.034114
[4142451:MainThread](2024-04-06 16:29:43,726) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.988632, valid_loss 1.000399, train_metric nan, valid_metric 0.045560
[4142451:MainThread](2024-04-06 16:29:43,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.994911, valid_loss 1.004137, train_metric nan, valid_metric 0.050416
[4142451:MainThread](2024-04-06 16:29:44,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.988104, valid_loss 0.998084, train_metric nan, valid_metric 0.043578
[4142451:MainThread](2024-04-06 16:29:44,148) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.985760, valid_loss 1.004221, train_metric nan, valid_metric 0.035925
[4142451:MainThread](2024-04-06 16:29:44,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.983372, valid_loss 1.000414, train_metric nan, valid_metric 0.040551
[4142451:MainThread](2024-04-06 16:29:44,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.993102, valid_loss 1.005852, train_metric nan, valid_metric 0.049736
[4142451:MainThread](2024-04-06 16:29:44,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.989117, valid_loss 1.000632, train_metric nan, valid_metric 0.053313
[4142451:MainThread](2024-04-06 16:29:44,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.982037, valid_loss 0.998083, train_metric nan, valid_metric 0.053014
[4142451:MainThread](2024-04-06 16:29:44,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.981619, valid_loss 0.997794, train_metric nan, valid_metric 0.050739
[4142451:MainThread](2024-04-06 16:29:45,033) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.990996, valid_loss 0.998760, train_metric nan, valid_metric 0.047064
[4142451:MainThread](2024-04-06 16:29:45,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.980864, valid_loss 0.999493, train_metric nan, valid_metric 0.037487
[4142451:MainThread](2024-04-06 16:29:45,289) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.985876, valid_loss 1.000419, train_metric nan, valid_metric 0.052017
[4142451:MainThread](2024-04-06 16:29:45,417) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.981748, valid_loss 0.999226, train_metric nan, valid_metric 0.049176
[4142451:MainThread](2024-04-06 16:29:45,550) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 1.004415, valid_loss 1.003517, train_metric nan, valid_metric 0.048696
[4142451:MainThread](2024-04-06 16:29:45,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.982084, valid_loss 1.001047, train_metric nan, valid_metric 0.051946
[4142451:MainThread](2024-04-06 16:29:45,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.984729, valid_loss 0.998317, train_metric nan, valid_metric 0.056872
[4142451:MainThread](2024-04-06 16:29:45,984) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.981635, valid_loss 0.998116, train_metric nan, valid_metric 0.051087
[4142451:MainThread](2024-04-06 16:29:46,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.976510, valid_loss 0.998679, train_metric nan, valid_metric 0.054912
[4142451:MainThread](2024-04-06 16:29:46,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.980325, valid_loss 0.998109, train_metric nan, valid_metric 0.051763
[4142451:MainThread](2024-04-06 16:29:46,484) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.975849, valid_loss 0.998205, train_metric nan, valid_metric 0.050459
[4142451:MainThread](2024-04-06 16:29:46,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.986829, valid_loss 0.998929, train_metric nan, valid_metric 0.046988
[4142451:MainThread](2024-04-06 16:29:46,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.983581, valid_loss 0.998106, train_metric nan, valid_metric 0.051035
[4142451:MainThread](2024-04-06 16:29:46,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.969149, valid_loss 0.998794, train_metric nan, valid_metric 0.047490
[4142451:MainThread](2024-04-06 16:29:47,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.983009, valid_loss 0.999577, train_metric nan, valid_metric 0.050643
[4142451:MainThread](2024-04-06 16:29:47,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.973742, valid_loss 0.999954, train_metric nan, valid_metric 0.042838
[4142451:MainThread](2024-04-06 16:29:47,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.992270, valid_loss 0.999224, train_metric nan, valid_metric 0.051844
[4142451:MainThread](2024-04-06 16:29:47,525) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.990037, valid_loss 0.998474, train_metric nan, valid_metric 0.049181
[4142451:MainThread](2024-04-06 16:29:47,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.986351, valid_loss 0.998044, train_metric nan, valid_metric 0.052635
[4142451:MainThread](2024-04-06 16:29:47,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.987811, valid_loss 0.998228, train_metric nan, valid_metric 0.044831
[4142451:MainThread](2024-04-06 16:29:47,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.986089, valid_loss 0.999107, train_metric nan, valid_metric 0.050741
[4142451:MainThread](2024-04-06 16:29:48,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.982226, valid_loss 0.997965, train_metric nan, valid_metric 0.049861
[4142451:MainThread](2024-04-06 16:29:48,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.986911, valid_loss 0.999686, train_metric nan, valid_metric 0.049675
[4142451:MainThread](2024-04-06 16:29:48,424) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.979099, valid_loss 0.999601, train_metric nan, valid_metric 0.048196
[4142451:MainThread](2024-04-06 16:29:48,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.984216, valid_loss 0.998760, train_metric nan, valid_metric 0.050383
[4142451:MainThread](2024-04-06 16:29:48,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.986723, valid_loss 0.997342, train_metric nan, valid_metric 0.054357
[4142451:MainThread](2024-04-06 16:29:48,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.989848, valid_loss 0.999149, train_metric nan, valid_metric 0.049635
[4142451:MainThread](2024-04-06 16:29:49,099) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.981110, valid_loss 0.995636, train_metric nan, valid_metric 0.052533
[4142451:MainThread](2024-04-06 16:29:49,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996841 to 0.995636, save checkpoint.
[4142451:MainThread](2024-04-06 16:29:49,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.980020, valid_loss 0.998051, train_metric nan, valid_metric 0.051558
[4142451:MainThread](2024-04-06 16:29:49,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.979340, valid_loss 0.999580, train_metric nan, valid_metric 0.046801
[4142451:MainThread](2024-04-06 16:29:49,580) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.980368, valid_loss 0.998447, train_metric nan, valid_metric 0.049027
[4142451:MainThread](2024-04-06 16:29:49,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.986282, valid_loss 0.999268, train_metric nan, valid_metric 0.044840
[4142451:MainThread](2024-04-06 16:29:49,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.986437, valid_loss 0.999074, train_metric nan, valid_metric 0.051669
[4142451:MainThread](2024-04-06 16:29:49,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.978359, valid_loss 0.998491, train_metric nan, valid_metric 0.049133
[4142451:MainThread](2024-04-06 16:29:50,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.982730, valid_loss 1.000175, train_metric nan, valid_metric 0.045413
[4142451:MainThread](2024-04-06 16:29:50,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.991519, valid_loss 0.996957, train_metric nan, valid_metric 0.053074
[4142451:MainThread](2024-04-06 16:29:50,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.969158, valid_loss 0.997608, train_metric nan, valid_metric 0.049702
[4142451:MainThread](2024-04-06 16:29:50,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.989554, valid_loss 1.000260, train_metric nan, valid_metric 0.049831
[4142451:MainThread](2024-04-06 16:29:50,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.987596, valid_loss 0.999091, train_metric nan, valid_metric 0.046798
[4142451:MainThread](2024-04-06 16:29:50,881) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.982478, valid_loss 0.997855, train_metric nan, valid_metric 0.050433
[4142451:MainThread](2024-04-06 16:29:51,031) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.985455, valid_loss 0.997364, train_metric nan, valid_metric 0.041583
[4142451:MainThread](2024-04-06 16:29:51,176) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.989056, valid_loss 0.998834, train_metric nan, valid_metric 0.047921
[4142451:MainThread](2024-04-06 16:29:51,316) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.993494, valid_loss 0.998938, train_metric nan, valid_metric 0.049457
[4142451:MainThread](2024-04-06 16:29:51,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.995502, valid_loss 0.997873, train_metric nan, valid_metric 0.050098
[4142451:MainThread](2024-04-06 16:29:51,615) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.984663, valid_loss 0.998709, train_metric nan, valid_metric 0.047518
[4142451:MainThread](2024-04-06 16:29:51,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.987062, valid_loss 0.998441, train_metric nan, valid_metric 0.042426
[4142451:MainThread](2024-04-06 16:29:51,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.990291, valid_loss 0.999569, train_metric nan, valid_metric 0.046884
[4142451:MainThread](2024-04-06 16:29:52,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.977534, valid_loss 0.999823, train_metric nan, valid_metric 0.046226
[4142451:MainThread](2024-04-06 16:29:52,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.992304, valid_loss 0.999313, train_metric nan, valid_metric 0.046783
[4142451:MainThread](2024-04-06 16:29:52,353) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.988055, valid_loss 0.999108, train_metric nan, valid_metric 0.049123
[4142451:MainThread](2024-04-06 16:29:52,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.991959, valid_loss 0.999543, train_metric nan, valid_metric 0.048463
[4142451:MainThread](2024-04-06 16:29:52,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.979583, valid_loss 0.999556, train_metric nan, valid_metric 0.046422
[4142451:MainThread](2024-04-06 16:29:52,793) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.981991, valid_loss 0.997861, train_metric nan, valid_metric 0.053042
[4142451:MainThread](2024-04-06 16:29:52,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.985525, valid_loss 0.996313, train_metric nan, valid_metric 0.056701
[4142451:MainThread](2024-04-06 16:29:53,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.986024, valid_loss 0.997632, train_metric nan, valid_metric 0.048721
[4142451:MainThread](2024-04-06 16:29:53,220) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.979178, valid_loss 0.999191, train_metric nan, valid_metric 0.050030
[4142451:MainThread](2024-04-06 16:29:53,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.986919, valid_loss 0.999676, train_metric nan, valid_metric 0.046812
[4142451:MainThread](2024-04-06 16:29:53,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.987104, valid_loss 0.998312, train_metric nan, valid_metric 0.048755
[4142451:MainThread](2024-04-06 16:29:53,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.989063, valid_loss 0.998945, train_metric nan, valid_metric 0.048195
[4142451:MainThread](2024-04-06 16:29:53,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.991835, valid_loss 0.998485, train_metric nan, valid_metric 0.048626
[4142451:MainThread](2024-04-06 16:29:53,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.980647, valid_loss 0.998932, train_metric nan, valid_metric 0.049170
[4142451:MainThread](2024-04-06 16:29:54,086) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.976042, valid_loss 0.999641, train_metric nan, valid_metric 0.047175
[4142451:MainThread](2024-04-06 16:29:54,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.973088, valid_loss 0.998950, train_metric nan, valid_metric 0.048526
[4142451:MainThread](2024-04-06 16:29:54,383) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 0.970796, valid_loss 0.999233, train_metric nan, valid_metric 0.048605
[4142451:MainThread](2024-04-06 16:29:54,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.969726, valid_loss 0.999464, train_metric nan, valid_metric 0.047730
[4142451:MainThread](2024-04-06 16:29:54,673) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 0.994439, valid_loss 0.999016, train_metric nan, valid_metric 0.049649
[4142451:MainThread](2024-04-06 16:29:54,839) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 0.986290, valid_loss 0.998628, train_metric nan, valid_metric 0.052387
[4142451:MainThread](2024-04-06 16:29:55,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 0.983087, valid_loss 0.998431, train_metric nan, valid_metric 0.051678
[4142451:MainThread](2024-04-06 16:29:55,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 0.979929, valid_loss 0.997529, train_metric nan, valid_metric 0.050085
[4142451:MainThread](2024-04-06 16:29:55,350) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 0.985476, valid_loss 0.999345, train_metric nan, valid_metric 0.046972
[4142451:MainThread](2024-04-06 16:29:55,500) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 0.998093, valid_loss 0.999111, train_metric nan, valid_metric 0.048033
[4142451:MainThread](2024-04-06 16:29:55,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 0.980293, valid_loss 0.999224, train_metric nan, valid_metric 0.049649
[4142451:MainThread](2024-04-06 16:29:55,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 0.981911, valid_loss 0.999139, train_metric nan, valid_metric 0.049095
[4142451:MainThread](2024-04-06 16:29:55,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 0.978515, valid_loss 0.998229, train_metric nan, valid_metric 0.051709
[4142451:MainThread](2024-04-06 16:29:56,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 0.985213, valid_loss 0.999195, train_metric nan, valid_metric 0.049190
[4142451:MainThread](2024-04-06 16:29:56,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 0.981362, valid_loss 0.998729, train_metric nan, valid_metric 0.046702
[4142451:MainThread](2024-04-06 16:29:56,386) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 0.979611, valid_loss 0.998615, train_metric nan, valid_metric 0.048315
[4142451:MainThread](2024-04-06 16:29:56,533) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 0.983744, valid_loss 0.998565, train_metric nan, valid_metric 0.050865
[4142451:MainThread](2024-04-06 16:29:56,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:29:57,381) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:29:58,273) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  60%|█████▉    | 31/52 [10:22<06:55, 19.80s/it][4142451:MainThread](2024-04-06 16:29:58,282) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:29:58,293) INFO - qlib.workflow - [recorder.py:341] - Recorder 6766ee3902434adcbd08f1e3bd1401f8 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:29:58,913) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:29:58,914) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:29:58,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:29:58,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:30:02,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:30:02,937) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.378376, valid_loss 1.102703, train_metric nan, valid_metric 0.014371
[4142451:MainThread](2024-04-06 16:30:02,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.102703, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:30:03,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.109226, valid_loss 1.058640, train_metric nan, valid_metric -0.002712
[4142451:MainThread](2024-04-06 16:30:03,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.102703 to 1.058640, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:03,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.069119, valid_loss 1.014062, train_metric nan, valid_metric 0.026265
[4142451:MainThread](2024-04-06 16:30:03,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.058640 to 1.014062, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:03,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.047839, valid_loss 1.012009, train_metric nan, valid_metric 0.060318
[4142451:MainThread](2024-04-06 16:30:03,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.014062 to 1.012009, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:03,630) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.048339, valid_loss 1.004588, train_metric nan, valid_metric 0.054104
[4142451:MainThread](2024-04-06 16:30:03,630) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.012009 to 1.004588, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:03,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.037505, valid_loss 1.006086, train_metric nan, valid_metric 0.045006
[4142451:MainThread](2024-04-06 16:30:03,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.033966, valid_loss 1.019584, train_metric nan, valid_metric 0.019891
[4142451:MainThread](2024-04-06 16:30:04,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.024580, valid_loss 1.001411, train_metric nan, valid_metric 0.054586
[4142451:MainThread](2024-04-06 16:30:04,102) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.004588 to 1.001411, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:04,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.021448, valid_loss 1.008637, train_metric nan, valid_metric 0.059468
[4142451:MainThread](2024-04-06 16:30:04,393) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.018819, valid_loss 1.001407, train_metric nan, valid_metric 0.049880
[4142451:MainThread](2024-04-06 16:30:04,393) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001411 to 1.001407, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:04,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.021443, valid_loss 1.001965, train_metric nan, valid_metric 0.076949
[4142451:MainThread](2024-04-06 16:30:04,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.026195, valid_loss 1.003668, train_metric nan, valid_metric 0.055183
[4142451:MainThread](2024-04-06 16:30:04,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.025620, valid_loss 0.995502, train_metric nan, valid_metric 0.053299
[4142451:MainThread](2024-04-06 16:30:04,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001407 to 0.995502, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:04,996) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.006496, valid_loss 1.000538, train_metric nan, valid_metric 0.063275
[4142451:MainThread](2024-04-06 16:30:05,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.005807, valid_loss 0.997291, train_metric nan, valid_metric 0.069694
[4142451:MainThread](2024-04-06 16:30:05,304) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.993612, valid_loss 0.998105, train_metric nan, valid_metric 0.044174
[4142451:MainThread](2024-04-06 16:30:05,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.004191, valid_loss 0.999935, train_metric nan, valid_metric 0.070609
[4142451:MainThread](2024-04-06 16:30:05,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.004279, valid_loss 0.996253, train_metric nan, valid_metric 0.065557
[4142451:MainThread](2024-04-06 16:30:05,793) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.998712, valid_loss 0.993095, train_metric nan, valid_metric 0.073923
[4142451:MainThread](2024-04-06 16:30:05,793) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995502 to 0.993095, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:05,968) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.014083, valid_loss 0.998373, train_metric nan, valid_metric 0.066925
[4142451:MainThread](2024-04-06 16:30:06,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.994395, valid_loss 0.994785, train_metric nan, valid_metric 0.067845
[4142451:MainThread](2024-04-06 16:30:06,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.000400, valid_loss 1.001689, train_metric nan, valid_metric 0.066648
[4142451:MainThread](2024-04-06 16:30:06,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.989485, valid_loss 0.994557, train_metric nan, valid_metric 0.066735
[4142451:MainThread](2024-04-06 16:30:06,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.004918, valid_loss 0.993115, train_metric nan, valid_metric 0.069409
[4142451:MainThread](2024-04-06 16:30:06,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.985406, valid_loss 0.993946, train_metric nan, valid_metric 0.082059
[4142451:MainThread](2024-04-06 16:30:06,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.989820, valid_loss 1.001814, train_metric nan, valid_metric 0.062445
[4142451:MainThread](2024-04-06 16:30:07,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.989171, valid_loss 0.992852, train_metric nan, valid_metric 0.076205
[4142451:MainThread](2024-04-06 16:30:07,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993095 to 0.992852, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:07,164) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.985280, valid_loss 0.991467, train_metric nan, valid_metric 0.081050
[4142451:MainThread](2024-04-06 16:30:07,164) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.992852 to 0.991467, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:07,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.989328, valid_loss 0.997334, train_metric nan, valid_metric 0.051189
[4142451:MainThread](2024-04-06 16:30:07,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.002950, valid_loss 0.995398, train_metric nan, valid_metric 0.072956
[4142451:MainThread](2024-04-06 16:30:07,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.994886, valid_loss 1.003119, train_metric nan, valid_metric 0.071300
[4142451:MainThread](2024-04-06 16:30:07,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.980883, valid_loss 0.995727, train_metric nan, valid_metric 0.063230
[4142451:MainThread](2024-04-06 16:30:07,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.986497, valid_loss 0.996331, train_metric nan, valid_metric 0.086996
[4142451:MainThread](2024-04-06 16:30:08,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.994358, valid_loss 0.996438, train_metric nan, valid_metric 0.068348
[4142451:MainThread](2024-04-06 16:30:08,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.981888, valid_loss 0.992370, train_metric nan, valid_metric 0.077714
[4142451:MainThread](2024-04-06 16:30:08,336) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.007979, valid_loss 1.001535, train_metric nan, valid_metric 0.083179
[4142451:MainThread](2024-04-06 16:30:08,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.995114, valid_loss 0.993138, train_metric nan, valid_metric 0.084124
[4142451:MainThread](2024-04-06 16:30:08,624) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.981255, valid_loss 0.994259, train_metric nan, valid_metric 0.073413
[4142451:MainThread](2024-04-06 16:30:08,760) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.993748, valid_loss 1.003959, train_metric nan, valid_metric 0.036022
[4142451:MainThread](2024-04-06 16:30:08,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.973168, valid_loss 0.995692, train_metric nan, valid_metric 0.055017
[4142451:MainThread](2024-04-06 16:30:09,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.990037, valid_loss 0.994314, train_metric nan, valid_metric 0.065890
[4142451:MainThread](2024-04-06 16:30:09,188) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.991770, valid_loss 0.993318, train_metric nan, valid_metric 0.072305
[4142451:MainThread](2024-04-06 16:30:09,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.978174, valid_loss 0.993996, train_metric nan, valid_metric 0.071774
[4142451:MainThread](2024-04-06 16:30:09,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.985230, valid_loss 0.992200, train_metric nan, valid_metric 0.073806
[4142451:MainThread](2024-04-06 16:30:09,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.982681, valid_loss 0.990691, train_metric nan, valid_metric 0.084549
[4142451:MainThread](2024-04-06 16:30:09,623) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991467 to 0.990691, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:09,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.981564, valid_loss 0.993790, train_metric nan, valid_metric 0.070406
[4142451:MainThread](2024-04-06 16:30:09,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.988286, valid_loss 0.993432, train_metric nan, valid_metric 0.073153
[4142451:MainThread](2024-04-06 16:30:10,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.982343, valid_loss 0.994679, train_metric nan, valid_metric 0.057502
[4142451:MainThread](2024-04-06 16:30:10,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.982551, valid_loss 0.994153, train_metric nan, valid_metric 0.063888
[4142451:MainThread](2024-04-06 16:30:10,374) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.983109, valid_loss 0.993030, train_metric nan, valid_metric 0.073248
[4142451:MainThread](2024-04-06 16:30:10,551) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.983125, valid_loss 0.994168, train_metric nan, valid_metric 0.075583
[4142451:MainThread](2024-04-06 16:30:10,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.991031, valid_loss 0.994082, train_metric nan, valid_metric 0.068748
[4142451:MainThread](2024-04-06 16:30:10,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.984765, valid_loss 0.992640, train_metric nan, valid_metric 0.074800
[4142451:MainThread](2024-04-06 16:30:10,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.975467, valid_loss 0.996871, train_metric nan, valid_metric 0.065000
[4142451:MainThread](2024-04-06 16:30:11,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.988548, valid_loss 0.994306, train_metric nan, valid_metric 0.077770
[4142451:MainThread](2024-04-06 16:30:11,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.988459, valid_loss 0.993983, train_metric nan, valid_metric 0.086763
[4142451:MainThread](2024-04-06 16:30:11,415) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.995943, valid_loss 0.995549, train_metric nan, valid_metric 0.066887
[4142451:MainThread](2024-04-06 16:30:11,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.992743, valid_loss 0.992772, train_metric nan, valid_metric 0.068746
[4142451:MainThread](2024-04-06 16:30:11,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.974745, valid_loss 0.994187, train_metric nan, valid_metric 0.065739
[4142451:MainThread](2024-04-06 16:30:11,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.991378, valid_loss 0.995758, train_metric nan, valid_metric 0.075654
[4142451:MainThread](2024-04-06 16:30:11,996) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.983878, valid_loss 0.994300, train_metric nan, valid_metric 0.065433
[4142451:MainThread](2024-04-06 16:30:12,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.977212, valid_loss 0.993883, train_metric nan, valid_metric 0.067574
[4142451:MainThread](2024-04-06 16:30:12,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.982798, valid_loss 0.993219, train_metric nan, valid_metric 0.065536
[4142451:MainThread](2024-04-06 16:30:12,416) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.979319, valid_loss 0.995397, train_metric nan, valid_metric 0.068036
[4142451:MainThread](2024-04-06 16:30:12,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.989596, valid_loss 0.994860, train_metric nan, valid_metric 0.070258
[4142451:MainThread](2024-04-06 16:30:12,726) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.986465, valid_loss 0.993564, train_metric nan, valid_metric 0.069401
[4142451:MainThread](2024-04-06 16:30:12,868) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.972102, valid_loss 0.994403, train_metric nan, valid_metric 0.065871
[4142451:MainThread](2024-04-06 16:30:13,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.985476, valid_loss 0.993695, train_metric nan, valid_metric 0.074453
[4142451:MainThread](2024-04-06 16:30:13,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.974906, valid_loss 0.994128, train_metric nan, valid_metric 0.070724
[4142451:MainThread](2024-04-06 16:30:13,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.976491, valid_loss 0.994752, train_metric nan, valid_metric 0.068225
[4142451:MainThread](2024-04-06 16:30:13,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.977283, valid_loss 0.993706, train_metric nan, valid_metric 0.072756
[4142451:MainThread](2024-04-06 16:30:13,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.972859, valid_loss 0.993173, train_metric nan, valid_metric 0.073348
[4142451:MainThread](2024-04-06 16:30:13,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.981105, valid_loss 0.992688, train_metric nan, valid_metric 0.069447
[4142451:MainThread](2024-04-06 16:30:13,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.980285, valid_loss 0.992500, train_metric nan, valid_metric 0.076508
[4142451:MainThread](2024-04-06 16:30:14,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.979567, valid_loss 0.995922, train_metric nan, valid_metric 0.071674
[4142451:MainThread](2024-04-06 16:30:14,203) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.986060, valid_loss 0.994646, train_metric nan, valid_metric 0.070425
[4142451:MainThread](2024-04-06 16:30:14,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.981195, valid_loss 0.992770, train_metric nan, valid_metric 0.074632
[4142451:MainThread](2024-04-06 16:30:14,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.987870, valid_loss 0.994331, train_metric nan, valid_metric 0.069677
[4142451:MainThread](2024-04-06 16:30:14,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.982005, valid_loss 0.995074, train_metric nan, valid_metric 0.066410
[4142451:MainThread](2024-04-06 16:30:14,799) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.981523, valid_loss 0.993556, train_metric nan, valid_metric 0.073742
[4142451:MainThread](2024-04-06 16:30:14,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.976029, valid_loss 0.994232, train_metric nan, valid_metric 0.065769
[4142451:MainThread](2024-04-06 16:30:15,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.989987, valid_loss 0.993116, train_metric nan, valid_metric 0.073139
[4142451:MainThread](2024-04-06 16:30:15,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.980066, valid_loss 0.993657, train_metric nan, valid_metric 0.069489
[4142451:MainThread](2024-04-06 16:30:15,477) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.972469, valid_loss 0.994021, train_metric nan, valid_metric 0.067844
[4142451:MainThread](2024-04-06 16:30:15,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.974657, valid_loss 0.994272, train_metric nan, valid_metric 0.070919
[4142451:MainThread](2024-04-06 16:30:15,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.978854, valid_loss 0.994510, train_metric nan, valid_metric 0.069875
[4142451:MainThread](2024-04-06 16:30:15,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.989701, valid_loss 0.994051, train_metric nan, valid_metric 0.069021
[4142451:MainThread](2024-04-06 16:30:16,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.989696, valid_loss 0.994210, train_metric nan, valid_metric 0.068325
[4142451:MainThread](2024-04-06 16:30:16,243) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.981458, valid_loss 0.994456, train_metric nan, valid_metric 0.068983
[4142451:MainThread](2024-04-06 16:30:16,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.993422, valid_loss 0.994437, train_metric nan, valid_metric 0.070156
[4142451:MainThread](2024-04-06 16:30:16,527) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.987979, valid_loss 0.994143, train_metric nan, valid_metric 0.072692
[4142451:MainThread](2024-04-06 16:30:16,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.985551, valid_loss 0.994022, train_metric nan, valid_metric 0.065257
[4142451:MainThread](2024-04-06 16:30:16,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.980477, valid_loss 0.993473, train_metric nan, valid_metric 0.064872
[4142451:MainThread](2024-04-06 16:30:17,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.978152, valid_loss 0.994086, train_metric nan, valid_metric 0.071163
[4142451:MainThread](2024-04-06 16:30:17,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.987037, valid_loss 0.994335, train_metric nan, valid_metric 0.070374
[4142451:MainThread](2024-04-06 16:30:17,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:30:18,026) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:30:18,915) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  62%|██████▏   | 32/52 [10:43<06:41, 20.05s/it][4142451:MainThread](2024-04-06 16:30:18,924) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:30:18,935) INFO - qlib.workflow - [recorder.py:341] - Recorder 919834cbb311418291f2c9a3beed476e starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:30:19,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:30:19,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:30:19,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:30:19,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:30:22,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:30:23,281) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.307505, valid_loss 1.077425, train_metric nan, valid_metric 0.022951
[4142451:MainThread](2024-04-06 16:30:23,281) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.077425, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:30:23,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.133822, valid_loss 1.025262, train_metric nan, valid_metric 0.062767
[4142451:MainThread](2024-04-06 16:30:23,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.077425 to 1.025262, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:23,576) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.082732, valid_loss 1.017062, train_metric nan, valid_metric 0.035813
[4142451:MainThread](2024-04-06 16:30:23,577) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.025262 to 1.017062, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:23,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.048653, valid_loss 1.000100, train_metric nan, valid_metric 0.088027
[4142451:MainThread](2024-04-06 16:30:23,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.017062 to 1.000100, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:23,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.040601, valid_loss 1.008341, train_metric nan, valid_metric 0.048367
[4142451:MainThread](2024-04-06 16:30:24,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.036413, valid_loss 0.994072, train_metric nan, valid_metric 0.077899
[4142451:MainThread](2024-04-06 16:30:24,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000100 to 0.994072, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:24,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.025357, valid_loss 0.997908, train_metric nan, valid_metric 0.063742
[4142451:MainThread](2024-04-06 16:30:24,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.025096, valid_loss 1.006782, train_metric nan, valid_metric 0.068829
[4142451:MainThread](2024-04-06 16:30:24,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.015646, valid_loss 1.004531, train_metric nan, valid_metric 0.095575
[4142451:MainThread](2024-04-06 16:30:24,578) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.040898, valid_loss 1.040512, train_metric nan, valid_metric 0.048995
[4142451:MainThread](2024-04-06 16:30:24,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.024732, valid_loss 0.991713, train_metric nan, valid_metric 0.074441
[4142451:MainThread](2024-04-06 16:30:24,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994072 to 0.991713, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:24,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.028867, valid_loss 1.007849, train_metric nan, valid_metric 0.071322
[4142451:MainThread](2024-04-06 16:30:25,014) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.021886, valid_loss 0.997650, train_metric nan, valid_metric 0.074031
[4142451:MainThread](2024-04-06 16:30:25,161) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.009446, valid_loss 0.990289, train_metric nan, valid_metric 0.090073
[4142451:MainThread](2024-04-06 16:30:25,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991713 to 0.990289, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:25,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.004339, valid_loss 1.004798, train_metric nan, valid_metric 0.071983
[4142451:MainThread](2024-04-06 16:30:25,487) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.028629, valid_loss 0.986978, train_metric nan, valid_metric 0.098375
[4142451:MainThread](2024-04-06 16:30:25,487) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990289 to 0.986978, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:25,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.033809, valid_loss 0.997400, train_metric nan, valid_metric 0.112038
[4142451:MainThread](2024-04-06 16:30:25,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.006068, valid_loss 1.000187, train_metric nan, valid_metric 0.079020
[4142451:MainThread](2024-04-06 16:30:25,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.012188, valid_loss 0.992272, train_metric nan, valid_metric 0.100414
[4142451:MainThread](2024-04-06 16:30:26,156) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.005045, valid_loss 0.986660, train_metric nan, valid_metric 0.109959
[4142451:MainThread](2024-04-06 16:30:26,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.986978 to 0.986660, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:26,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.006394, valid_loss 0.989334, train_metric nan, valid_metric 0.087102
[4142451:MainThread](2024-04-06 16:30:26,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.000684, valid_loss 0.997099, train_metric nan, valid_metric 0.080049
[4142451:MainThread](2024-04-06 16:30:26,651) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.980504, valid_loss 0.995393, train_metric nan, valid_metric 0.076959
[4142451:MainThread](2024-04-06 16:30:26,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.990564, valid_loss 0.991149, train_metric nan, valid_metric 0.106519
[4142451:MainThread](2024-04-06 16:30:26,941) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.995882, valid_loss 0.993081, train_metric nan, valid_metric 0.076674
[4142451:MainThread](2024-04-06 16:30:27,075) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.993322, valid_loss 0.988220, train_metric nan, valid_metric 0.091912
[4142451:MainThread](2024-04-06 16:30:27,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.996735, valid_loss 0.989678, train_metric nan, valid_metric 0.101500
[4142451:MainThread](2024-04-06 16:30:27,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.998147, valid_loss 0.992187, train_metric nan, valid_metric 0.085486
[4142451:MainThread](2024-04-06 16:30:27,508) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.991485, valid_loss 0.991876, train_metric nan, valid_metric 0.096044
[4142451:MainThread](2024-04-06 16:30:27,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.992919, valid_loss 0.987454, train_metric nan, valid_metric 0.095956
[4142451:MainThread](2024-04-06 16:30:27,813) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.992359, valid_loss 0.995590, train_metric nan, valid_metric 0.102409
[4142451:MainThread](2024-04-06 16:30:27,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.990071, valid_loss 0.992353, train_metric nan, valid_metric 0.079116
[4142451:MainThread](2024-04-06 16:30:28,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.994543, valid_loss 0.991338, train_metric nan, valid_metric 0.082724
[4142451:MainThread](2024-04-06 16:30:28,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.990798, valid_loss 0.988183, train_metric nan, valid_metric 0.096675
[4142451:MainThread](2024-04-06 16:30:28,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.994929, valid_loss 0.987948, train_metric nan, valid_metric 0.095094
[4142451:MainThread](2024-04-06 16:30:28,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.979990, valid_loss 0.987997, train_metric nan, valid_metric 0.095229
[4142451:MainThread](2024-04-06 16:30:28,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.998643, valid_loss 0.990655, train_metric nan, valid_metric 0.088179
[4142451:MainThread](2024-04-06 16:30:28,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.979827, valid_loss 0.989616, train_metric nan, valid_metric 0.094612
[4142451:MainThread](2024-04-06 16:30:29,105) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.981962, valid_loss 0.987452, train_metric nan, valid_metric 0.097270
[4142451:MainThread](2024-04-06 16:30:29,255) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.993428, valid_loss 0.993399, train_metric nan, valid_metric 0.095830
[4142451:MainThread](2024-04-06 16:30:29,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.983872, valid_loss 0.991064, train_metric nan, valid_metric 0.094115
[4142451:MainThread](2024-04-06 16:30:29,577) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.993877, valid_loss 0.990525, train_metric nan, valid_metric 0.085072
[4142451:MainThread](2024-04-06 16:30:29,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.991820, valid_loss 0.988429, train_metric nan, valid_metric 0.090093
[4142451:MainThread](2024-04-06 16:30:29,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.976864, valid_loss 0.987513, train_metric nan, valid_metric 0.099045
[4142451:MainThread](2024-04-06 16:30:29,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.990015, valid_loss 0.989058, train_metric nan, valid_metric 0.091239
[4142451:MainThread](2024-04-06 16:30:30,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.991469, valid_loss 0.991015, train_metric nan, valid_metric 0.087461
[4142451:MainThread](2024-04-06 16:30:30,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.984068, valid_loss 0.989690, train_metric nan, valid_metric 0.084506
[4142451:MainThread](2024-04-06 16:30:30,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.994158, valid_loss 0.988032, train_metric nan, valid_metric 0.094245
[4142451:MainThread](2024-04-06 16:30:30,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.988562, valid_loss 0.988404, train_metric nan, valid_metric 0.093598
[4142451:MainThread](2024-04-06 16:30:30,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.988767, valid_loss 0.987494, train_metric nan, valid_metric 0.100160
[4142451:MainThread](2024-04-06 16:30:30,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.984508, valid_loss 0.989578, train_metric nan, valid_metric 0.084984
[4142451:MainThread](2024-04-06 16:30:31,014) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.989001, valid_loss 0.990444, train_metric nan, valid_metric 0.083015
[4142451:MainThread](2024-04-06 16:30:31,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.997654, valid_loss 0.988236, train_metric nan, valid_metric 0.091988
[4142451:MainThread](2024-04-06 16:30:31,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.988968, valid_loss 0.987649, train_metric nan, valid_metric 0.094813
[4142451:MainThread](2024-04-06 16:30:31,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.985498, valid_loss 0.988110, train_metric nan, valid_metric 0.092081
[4142451:MainThread](2024-04-06 16:30:31,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.991890, valid_loss 0.988624, train_metric nan, valid_metric 0.092704
[4142451:MainThread](2024-04-06 16:30:31,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.988622, valid_loss 0.990435, train_metric nan, valid_metric 0.084265
[4142451:MainThread](2024-04-06 16:30:31,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.990516, valid_loss 0.988636, train_metric nan, valid_metric 0.092976
[4142451:MainThread](2024-04-06 16:30:32,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.985877, valid_loss 0.988100, train_metric nan, valid_metric 0.092296
[4142451:MainThread](2024-04-06 16:30:32,169) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.997045, valid_loss 0.988789, train_metric nan, valid_metric 0.092356
[4142451:MainThread](2024-04-06 16:30:32,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.996944, valid_loss 0.988854, train_metric nan, valid_metric 0.089436
[4142451:MainThread](2024-04-06 16:30:32,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.987424, valid_loss 0.987415, train_metric nan, valid_metric 0.094806
[4142451:MainThread](2024-04-06 16:30:32,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.986231, valid_loss 0.988800, train_metric nan, valid_metric 0.089766
[4142451:MainThread](2024-04-06 16:30:32,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.971419, valid_loss 0.987937, train_metric nan, valid_metric 0.094048
[4142451:MainThread](2024-04-06 16:30:32,881) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.988586, valid_loss 0.990271, train_metric nan, valid_metric 0.083001
[4142451:MainThread](2024-04-06 16:30:33,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.975501, valid_loss 0.988846, train_metric nan, valid_metric 0.090709
[4142451:MainThread](2024-04-06 16:30:33,171) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.991456, valid_loss 0.990137, train_metric nan, valid_metric 0.083939
[4142451:MainThread](2024-04-06 16:30:33,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.979912, valid_loss 0.988667, train_metric nan, valid_metric 0.091591
[4142451:MainThread](2024-04-06 16:30:33,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.986173, valid_loss 0.987475, train_metric nan, valid_metric 0.095552
[4142451:MainThread](2024-04-06 16:30:33,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.988031, valid_loss 0.988712, train_metric nan, valid_metric 0.089806
[4142451:MainThread](2024-04-06 16:30:33,611) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:30:34,440) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:30:35,303) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  63%|██████▎   | 33/52 [10:59<06:00, 18.95s/it][4142451:MainThread](2024-04-06 16:30:35,311) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:30:35,321) INFO - qlib.workflow - [recorder.py:341] - Recorder 0884c29ef3bb41f29b8b19ca74866705 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:30:36,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:30:36,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:30:36,005) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:30:36,005) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:30:39,505) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:30:39,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.229971, valid_loss 1.090436, train_metric nan, valid_metric -0.051437
[4142451:MainThread](2024-04-06 16:30:39,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.090436, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:30:40,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.128362, valid_loss 1.013491, train_metric nan, valid_metric 0.050875
[4142451:MainThread](2024-04-06 16:30:40,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.090436 to 1.013491, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:40,255) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.066330, valid_loss 1.023074, train_metric nan, valid_metric 0.021208
[4142451:MainThread](2024-04-06 16:30:40,403) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.060481, valid_loss 0.997088, train_metric nan, valid_metric 0.084670
[4142451:MainThread](2024-04-06 16:30:40,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.013491 to 0.997088, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:40,550) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.111610, valid_loss 1.012676, train_metric nan, valid_metric 0.054547
[4142451:MainThread](2024-04-06 16:30:40,701) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.094479, valid_loss 1.030577, train_metric nan, valid_metric 0.047241
[4142451:MainThread](2024-04-06 16:30:40,873) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.028763, valid_loss 1.008570, train_metric nan, valid_metric 0.015572
[4142451:MainThread](2024-04-06 16:30:41,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.019482, valid_loss 0.998294, train_metric nan, valid_metric 0.056513
[4142451:MainThread](2024-04-06 16:30:41,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.008506, valid_loss 0.998075, train_metric nan, valid_metric 0.063947
[4142451:MainThread](2024-04-06 16:30:41,335) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.020683, valid_loss 1.009269, train_metric nan, valid_metric 0.060983
[4142451:MainThread](2024-04-06 16:30:41,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.009388, valid_loss 1.004310, train_metric nan, valid_metric 0.056638
[4142451:MainThread](2024-04-06 16:30:41,623) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 0.999032, valid_loss 0.993698, train_metric nan, valid_metric 0.088850
[4142451:MainThread](2024-04-06 16:30:41,623) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997088 to 0.993698, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:41,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.001670, valid_loss 0.995382, train_metric nan, valid_metric 0.056436
[4142451:MainThread](2024-04-06 16:30:41,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.007023, valid_loss 0.993373, train_metric nan, valid_metric 0.064532
[4142451:MainThread](2024-04-06 16:30:41,928) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993698 to 0.993373, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:42,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.010017, valid_loss 1.002116, train_metric nan, valid_metric 0.058562
[4142451:MainThread](2024-04-06 16:30:42,215) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.006408, valid_loss 0.991446, train_metric nan, valid_metric 0.080320
[4142451:MainThread](2024-04-06 16:30:42,215) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993373 to 0.991446, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:42,359) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.995646, valid_loss 0.993356, train_metric nan, valid_metric 0.067631
[4142451:MainThread](2024-04-06 16:30:42,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.995481, valid_loss 0.995915, train_metric nan, valid_metric 0.091051
[4142451:MainThread](2024-04-06 16:30:42,651) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.999579, valid_loss 0.994891, train_metric nan, valid_metric 0.081347
[4142451:MainThread](2024-04-06 16:30:42,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.009302, valid_loss 0.993891, train_metric nan, valid_metric 0.059076
[4142451:MainThread](2024-04-06 16:30:42,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.007631, valid_loss 1.016988, train_metric nan, valid_metric 0.093538
[4142451:MainThread](2024-04-06 16:30:43,079) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.993025, valid_loss 0.994554, train_metric nan, valid_metric 0.065924
[4142451:MainThread](2024-04-06 16:30:43,235) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.989538, valid_loss 0.987422, train_metric nan, valid_metric 0.097101
[4142451:MainThread](2024-04-06 16:30:43,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991446 to 0.987422, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:43,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.997445, valid_loss 1.000859, train_metric nan, valid_metric 0.061914
[4142451:MainThread](2024-04-06 16:30:43,536) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.004434, valid_loss 0.991142, train_metric nan, valid_metric 0.079953
[4142451:MainThread](2024-04-06 16:30:43,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.984808, valid_loss 0.992914, train_metric nan, valid_metric 0.068012
[4142451:MainThread](2024-04-06 16:30:43,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.993574, valid_loss 0.991766, train_metric nan, valid_metric 0.074713
[4142451:MainThread](2024-04-06 16:30:43,973) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.983894, valid_loss 0.999929, train_metric nan, valid_metric 0.034749
[4142451:MainThread](2024-04-06 16:30:44,142) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.977883, valid_loss 0.995207, train_metric nan, valid_metric 0.084124
[4142451:MainThread](2024-04-06 16:30:44,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.990044, valid_loss 0.993191, train_metric nan, valid_metric 0.090512
[4142451:MainThread](2024-04-06 16:30:44,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.994970, valid_loss 0.994094, train_metric nan, valid_metric 0.086369
[4142451:MainThread](2024-04-06 16:30:44,576) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.984739, valid_loss 0.993703, train_metric nan, valid_metric 0.077486
[4142451:MainThread](2024-04-06 16:30:44,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.989350, valid_loss 0.996258, train_metric nan, valid_metric 0.057037
[4142451:MainThread](2024-04-06 16:30:44,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.976420, valid_loss 0.997212, train_metric nan, valid_metric 0.081611
[4142451:MainThread](2024-04-06 16:30:45,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.988795, valid_loss 0.991906, train_metric nan, valid_metric 0.075154
[4142451:MainThread](2024-04-06 16:30:45,171) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.990057, valid_loss 0.991897, train_metric nan, valid_metric 0.069633
[4142451:MainThread](2024-04-06 16:30:45,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.980539, valid_loss 0.992386, train_metric nan, valid_metric 0.072226
[4142451:MainThread](2024-04-06 16:30:45,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.989861, valid_loss 0.994493, train_metric nan, valid_metric 0.068603
[4142451:MainThread](2024-04-06 16:30:45,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.993208, valid_loss 0.992835, train_metric nan, valid_metric 0.068674
[4142451:MainThread](2024-04-06 16:30:45,743) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.980768, valid_loss 0.990345, train_metric nan, valid_metric 0.081034
[4142451:MainThread](2024-04-06 16:30:45,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.985967, valid_loss 0.990471, train_metric nan, valid_metric 0.081632
[4142451:MainThread](2024-04-06 16:30:46,029) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.976415, valid_loss 0.990884, train_metric nan, valid_metric 0.079541
[4142451:MainThread](2024-04-06 16:30:46,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.980625, valid_loss 0.989759, train_metric nan, valid_metric 0.093639
[4142451:MainThread](2024-04-06 16:30:46,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.991968, valid_loss 0.992016, train_metric nan, valid_metric 0.077787
[4142451:MainThread](2024-04-06 16:30:46,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.985910, valid_loss 0.992142, train_metric nan, valid_metric 0.087329
[4142451:MainThread](2024-04-06 16:30:46,607) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.995471, valid_loss 0.989897, train_metric nan, valid_metric 0.084913
[4142451:MainThread](2024-04-06 16:30:46,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.984483, valid_loss 0.990968, train_metric nan, valid_metric 0.085149
[4142451:MainThread](2024-04-06 16:30:46,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.994048, valid_loss 0.993771, train_metric nan, valid_metric 0.083530
[4142451:MainThread](2024-04-06 16:30:47,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.988513, valid_loss 0.990542, train_metric nan, valid_metric 0.080432
[4142451:MainThread](2024-04-06 16:30:47,169) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.986822, valid_loss 0.993644, train_metric nan, valid_metric 0.064766
[4142451:MainThread](2024-04-06 16:30:47,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.983165, valid_loss 0.991006, train_metric nan, valid_metric 0.078365
[4142451:MainThread](2024-04-06 16:30:47,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.992278, valid_loss 0.991301, train_metric nan, valid_metric 0.079095
[4142451:MainThread](2024-04-06 16:30:47,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.987673, valid_loss 0.991392, train_metric nan, valid_metric 0.075260
[4142451:MainThread](2024-04-06 16:30:47,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.990444, valid_loss 0.990229, train_metric nan, valid_metric 0.087271
[4142451:MainThread](2024-04-06 16:30:47,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.984292, valid_loss 0.992161, train_metric nan, valid_metric 0.072599
[4142451:MainThread](2024-04-06 16:30:48,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.984870, valid_loss 0.992445, train_metric nan, valid_metric 0.078351
[4142451:MainThread](2024-04-06 16:30:48,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.975907, valid_loss 0.990625, train_metric nan, valid_metric 0.080735
[4142451:MainThread](2024-04-06 16:30:48,326) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.994470, valid_loss 0.992004, train_metric nan, valid_metric 0.072902
[4142451:MainThread](2024-04-06 16:30:48,471) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.995830, valid_loss 0.992248, train_metric nan, valid_metric 0.071242
[4142451:MainThread](2024-04-06 16:30:48,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.992713, valid_loss 0.992349, train_metric nan, valid_metric 0.072340
[4142451:MainThread](2024-04-06 16:30:48,755) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.973174, valid_loss 0.992863, train_metric nan, valid_metric 0.067886
[4142451:MainThread](2024-04-06 16:30:48,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.983094, valid_loss 0.994243, train_metric nan, valid_metric 0.060576
[4142451:MainThread](2024-04-06 16:30:49,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.985214, valid_loss 0.991752, train_metric nan, valid_metric 0.081615
[4142451:MainThread](2024-04-06 16:30:49,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.994202, valid_loss 0.991638, train_metric nan, valid_metric 0.078995
[4142451:MainThread](2024-04-06 16:30:49,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.988018, valid_loss 0.990762, train_metric nan, valid_metric 0.081984
[4142451:MainThread](2024-04-06 16:30:49,530) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.979518, valid_loss 0.990754, train_metric nan, valid_metric 0.085915
[4142451:MainThread](2024-04-06 16:30:49,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.990213, valid_loss 0.991917, train_metric nan, valid_metric 0.076822
[4142451:MainThread](2024-04-06 16:30:49,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.986160, valid_loss 0.991861, train_metric nan, valid_metric 0.074069
[4142451:MainThread](2024-04-06 16:30:50,037) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.978642, valid_loss 0.991794, train_metric nan, valid_metric 0.075644
[4142451:MainThread](2024-04-06 16:30:50,192) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.973850, valid_loss 0.991566, train_metric nan, valid_metric 0.076865
[4142451:MainThread](2024-04-06 16:30:50,341) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.981220, valid_loss 0.991713, train_metric nan, valid_metric 0.074364
[4142451:MainThread](2024-04-06 16:30:50,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.989487, valid_loss 0.990982, train_metric nan, valid_metric 0.077823
[4142451:MainThread](2024-04-06 16:30:50,630) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.988248, valid_loss 0.991997, train_metric nan, valid_metric 0.073777
[4142451:MainThread](2024-04-06 16:30:50,630) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:30:51,285) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:30:52,082) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  65%|██████▌   | 34/52 [11:16<05:29, 18.30s/it][4142451:MainThread](2024-04-06 16:30:52,090) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:30:52,100) INFO - qlib.workflow - [recorder.py:341] - Recorder a8a34c1b4cf946958381c07c2dff2676 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:30:52,813) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:30:52,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:30:52,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:30:52,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:30:56,354) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:30:56,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.351887, valid_loss 1.087638, train_metric nan, valid_metric 0.024748
[4142451:MainThread](2024-04-06 16:30:56,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.087638, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:30:56,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.106264, valid_loss 1.028734, train_metric nan, valid_metric 0.027558
[4142451:MainThread](2024-04-06 16:30:56,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.087638 to 1.028734, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:56,913) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.073638, valid_loss 1.016456, train_metric nan, valid_metric 0.059139
[4142451:MainThread](2024-04-06 16:30:56,913) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.028734 to 1.016456, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:57,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.067588, valid_loss 1.012334, train_metric nan, valid_metric 0.052685
[4142451:MainThread](2024-04-06 16:30:57,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.016456 to 1.012334, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:57,205) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.056514, valid_loss 1.003410, train_metric nan, valid_metric 0.049083
[4142451:MainThread](2024-04-06 16:30:57,205) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.012334 to 1.003410, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:57,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.090412, valid_loss 1.050401, train_metric nan, valid_metric 0.071588
[4142451:MainThread](2024-04-06 16:30:57,510) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.063549, valid_loss 1.036484, train_metric nan, valid_metric 0.037447
[4142451:MainThread](2024-04-06 16:30:57,651) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.053802, valid_loss 0.999276, train_metric nan, valid_metric 0.077705
[4142451:MainThread](2024-04-06 16:30:57,651) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003410 to 0.999276, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:57,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.081146, valid_loss 1.012470, train_metric nan, valid_metric 0.063378
[4142451:MainThread](2024-04-06 16:30:57,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.040900, valid_loss 1.010029, train_metric nan, valid_metric 0.079705
[4142451:MainThread](2024-04-06 16:30:58,077) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.018273, valid_loss 0.994796, train_metric nan, valid_metric 0.090851
[4142451:MainThread](2024-04-06 16:30:58,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999276 to 0.994796, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:58,223) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.011104, valid_loss 0.991991, train_metric nan, valid_metric 0.076861
[4142451:MainThread](2024-04-06 16:30:58,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994796 to 0.991991, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:58,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.007262, valid_loss 1.015992, train_metric nan, valid_metric 0.066605
[4142451:MainThread](2024-04-06 16:30:58,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.003748, valid_loss 0.987697, train_metric nan, valid_metric 0.098911
[4142451:MainThread](2024-04-06 16:30:58,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991991 to 0.987697, save checkpoint.
[4142451:MainThread](2024-04-06 16:30:58,707) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.010140, valid_loss 0.991387, train_metric nan, valid_metric 0.078318
[4142451:MainThread](2024-04-06 16:30:58,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.012657, valid_loss 0.990446, train_metric nan, valid_metric 0.095311
[4142451:MainThread](2024-04-06 16:30:59,050) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.008918, valid_loss 0.997255, train_metric nan, valid_metric 0.059372
[4142451:MainThread](2024-04-06 16:30:59,195) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.004460, valid_loss 0.992276, train_metric nan, valid_metric 0.090556
[4142451:MainThread](2024-04-06 16:30:59,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.994859, valid_loss 0.996467, train_metric nan, valid_metric 0.077454
[4142451:MainThread](2024-04-06 16:30:59,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.012047, valid_loss 1.001370, train_metric nan, valid_metric 0.064107
[4142451:MainThread](2024-04-06 16:30:59,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.005281, valid_loss 0.999631, train_metric nan, valid_metric 0.092414
[4142451:MainThread](2024-04-06 16:30:59,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.994525, valid_loss 0.988012, train_metric nan, valid_metric 0.096422
[4142451:MainThread](2024-04-06 16:30:59,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.991934, valid_loss 0.994728, train_metric nan, valid_metric 0.069930
[4142451:MainThread](2024-04-06 16:31:00,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.005772, valid_loss 0.995284, train_metric nan, valid_metric 0.089732
[4142451:MainThread](2024-04-06 16:31:00,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.996153, valid_loss 0.994003, train_metric nan, valid_metric 0.069038
[4142451:MainThread](2024-04-06 16:31:00,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.991635, valid_loss 0.990734, train_metric nan, valid_metric 0.083869
[4142451:MainThread](2024-04-06 16:31:00,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.996311, valid_loss 0.990237, train_metric nan, valid_metric 0.083204
[4142451:MainThread](2024-04-06 16:31:00,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.986197, valid_loss 0.993067, train_metric nan, valid_metric 0.082892
[4142451:MainThread](2024-04-06 16:31:00,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.981598, valid_loss 0.993168, train_metric nan, valid_metric 0.073116
[4142451:MainThread](2024-04-06 16:31:00,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.988488, valid_loss 0.992431, train_metric nan, valid_metric 0.079389
[4142451:MainThread](2024-04-06 16:31:01,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.988784, valid_loss 0.995167, train_metric nan, valid_metric 0.079838
[4142451:MainThread](2024-04-06 16:31:01,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.986634, valid_loss 0.993487, train_metric nan, valid_metric 0.066857
[4142451:MainThread](2024-04-06 16:31:01,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.996417, valid_loss 0.995403, train_metric nan, valid_metric 0.058591
[4142451:MainThread](2024-04-06 16:31:01,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.992189, valid_loss 0.991275, train_metric nan, valid_metric 0.075016
[4142451:MainThread](2024-04-06 16:31:01,690) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.983698, valid_loss 0.989511, train_metric nan, valid_metric 0.091849
[4142451:MainThread](2024-04-06 16:31:01,838) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.999154, valid_loss 0.990237, train_metric nan, valid_metric 0.082141
[4142451:MainThread](2024-04-06 16:31:01,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.992143, valid_loss 0.990637, train_metric nan, valid_metric 0.080125
[4142451:MainThread](2024-04-06 16:31:02,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.985399, valid_loss 0.993236, train_metric nan, valid_metric 0.070122
[4142451:MainThread](2024-04-06 16:31:02,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.991241, valid_loss 0.991431, train_metric nan, valid_metric 0.076302
[4142451:MainThread](2024-04-06 16:31:02,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.991229, valid_loss 0.991375, train_metric nan, valid_metric 0.076684
[4142451:MainThread](2024-04-06 16:31:02,593) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.995753, valid_loss 0.993842, train_metric nan, valid_metric 0.061420
[4142451:MainThread](2024-04-06 16:31:02,735) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.992600, valid_loss 0.989625, train_metric nan, valid_metric 0.088560
[4142451:MainThread](2024-04-06 16:31:02,882) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.987431, valid_loss 0.990518, train_metric nan, valid_metric 0.083581
[4142451:MainThread](2024-04-06 16:31:03,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.996699, valid_loss 0.991116, train_metric nan, valid_metric 0.086136
[4142451:MainThread](2024-04-06 16:31:03,163) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.988720, valid_loss 0.995072, train_metric nan, valid_metric 0.068570
[4142451:MainThread](2024-04-06 16:31:03,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.992528, valid_loss 0.990166, train_metric nan, valid_metric 0.084167
[4142451:MainThread](2024-04-06 16:31:03,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.989452, valid_loss 0.991921, train_metric nan, valid_metric 0.085317
[4142451:MainThread](2024-04-06 16:31:03,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.985566, valid_loss 0.991371, train_metric nan, valid_metric 0.077010
[4142451:MainThread](2024-04-06 16:31:03,744) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.990437, valid_loss 0.991543, train_metric nan, valid_metric 0.080590
[4142451:MainThread](2024-04-06 16:31:03,892) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.984556, valid_loss 0.990717, train_metric nan, valid_metric 0.078508
[4142451:MainThread](2024-04-06 16:31:04,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.987312, valid_loss 0.991384, train_metric nan, valid_metric 0.081092
[4142451:MainThread](2024-04-06 16:31:04,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.997181, valid_loss 0.991665, train_metric nan, valid_metric 0.080485
[4142451:MainThread](2024-04-06 16:31:04,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.001477, valid_loss 0.990975, train_metric nan, valid_metric 0.080534
[4142451:MainThread](2024-04-06 16:31:04,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.986876, valid_loss 0.992097, train_metric nan, valid_metric 0.077499
[4142451:MainThread](2024-04-06 16:31:04,598) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.991595, valid_loss 0.990770, train_metric nan, valid_metric 0.079584
[4142451:MainThread](2024-04-06 16:31:04,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.984949, valid_loss 0.991361, train_metric nan, valid_metric 0.079038
[4142451:MainThread](2024-04-06 16:31:04,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.989476, valid_loss 0.990022, train_metric nan, valid_metric 0.085268
[4142451:MainThread](2024-04-06 16:31:05,028) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.993254, valid_loss 0.992952, train_metric nan, valid_metric 0.074418
[4142451:MainThread](2024-04-06 16:31:05,179) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.992299, valid_loss 0.991500, train_metric nan, valid_metric 0.080237
[4142451:MainThread](2024-04-06 16:31:05,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.984187, valid_loss 0.991645, train_metric nan, valid_metric 0.078505
[4142451:MainThread](2024-04-06 16:31:05,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.997011, valid_loss 0.991385, train_metric nan, valid_metric 0.076873
[4142451:MainThread](2024-04-06 16:31:05,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.980511, valid_loss 0.991374, train_metric nan, valid_metric 0.082910
[4142451:MainThread](2024-04-06 16:31:05,760) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.985918, valid_loss 0.989806, train_metric nan, valid_metric 0.085972
[4142451:MainThread](2024-04-06 16:31:05,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.988792, valid_loss 0.992164, train_metric nan, valid_metric 0.080364
[4142451:MainThread](2024-04-06 16:31:05,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:31:06,754) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:31:07,642) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  67%|██████▋   | 35/52 [11:31<04:57, 17.48s/it][4142451:MainThread](2024-04-06 16:31:07,650) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:31:07,660) INFO - qlib.workflow - [recorder.py:341] - Recorder 03bf54c75f1942d88b12238f5486e7fe starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:31:08,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:31:08,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:31:08,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:31:08,270) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:31:11,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:31:12,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.292640, valid_loss 1.031911, train_metric nan, valid_metric -0.021558
[4142451:MainThread](2024-04-06 16:31:12,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.031911, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:31:12,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.094172, valid_loss 1.037155, train_metric nan, valid_metric 0.037706
[4142451:MainThread](2024-04-06 16:31:12,296) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.061712, valid_loss 1.008317, train_metric nan, valid_metric 0.042014
[4142451:MainThread](2024-04-06 16:31:12,296) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.031911 to 1.008317, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:12,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.055107, valid_loss 1.004031, train_metric nan, valid_metric 0.069087
[4142451:MainThread](2024-04-06 16:31:12,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.008317 to 1.004031, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:12,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.049727, valid_loss 1.040141, train_metric nan, valid_metric 0.057378
[4142451:MainThread](2024-04-06 16:31:12,684) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.066466, valid_loss 1.033427, train_metric nan, valid_metric 0.046223
[4142451:MainThread](2024-04-06 16:31:12,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.078953, valid_loss 1.009953, train_metric nan, valid_metric 0.057374
[4142451:MainThread](2024-04-06 16:31:12,980) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.032365, valid_loss 1.004825, train_metric nan, valid_metric 0.048916
[4142451:MainThread](2024-04-06 16:31:13,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.028757, valid_loss 1.002415, train_metric nan, valid_metric 0.039230
[4142451:MainThread](2024-04-06 16:31:13,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.004031 to 1.002415, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:13,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.023677, valid_loss 1.021119, train_metric nan, valid_metric 0.055972
[4142451:MainThread](2024-04-06 16:31:13,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.016164, valid_loss 1.022065, train_metric nan, valid_metric 0.074310
[4142451:MainThread](2024-04-06 16:31:13,564) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.009201, valid_loss 0.993467, train_metric nan, valid_metric 0.076683
[4142451:MainThread](2024-04-06 16:31:13,564) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.002415 to 0.993467, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:13,741) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.018204, valid_loss 1.007548, train_metric nan, valid_metric 0.016817
[4142451:MainThread](2024-04-06 16:31:13,887) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.009250, valid_loss 0.998282, train_metric nan, valid_metric 0.090057
[4142451:MainThread](2024-04-06 16:31:14,018) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.015083, valid_loss 0.996703, train_metric nan, valid_metric 0.067563
[4142451:MainThread](2024-04-06 16:31:14,146) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.002879, valid_loss 0.999497, train_metric nan, valid_metric 0.059549
[4142451:MainThread](2024-04-06 16:31:14,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.004988, valid_loss 0.998102, train_metric nan, valid_metric 0.041832
[4142451:MainThread](2024-04-06 16:31:14,417) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.999566, valid_loss 0.997169, train_metric nan, valid_metric 0.055933
[4142451:MainThread](2024-04-06 16:31:14,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.006386, valid_loss 0.993523, train_metric nan, valid_metric 0.071186
[4142451:MainThread](2024-04-06 16:31:14,712) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.002005, valid_loss 0.995866, train_metric nan, valid_metric 0.074687
[4142451:MainThread](2024-04-06 16:31:14,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.003006, valid_loss 0.996781, train_metric nan, valid_metric 0.060581
[4142451:MainThread](2024-04-06 16:31:15,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.011584, valid_loss 0.997639, train_metric nan, valid_metric 0.063938
[4142451:MainThread](2024-04-06 16:31:15,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.996508, valid_loss 1.019556, train_metric nan, valid_metric 0.061537
[4142451:MainThread](2024-04-06 16:31:15,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.001553, valid_loss 0.997072, train_metric nan, valid_metric 0.068819
[4142451:MainThread](2024-04-06 16:31:15,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.997850, valid_loss 0.994983, train_metric nan, valid_metric 0.062409
[4142451:MainThread](2024-04-06 16:31:15,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.004375, valid_loss 0.996509, train_metric nan, valid_metric 0.067829
[4142451:MainThread](2024-04-06 16:31:15,742) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.001101, valid_loss 0.992468, train_metric nan, valid_metric 0.068591
[4142451:MainThread](2024-04-06 16:31:15,743) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993467 to 0.992468, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:15,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.998374, valid_loss 0.991780, train_metric nan, valid_metric 0.078943
[4142451:MainThread](2024-04-06 16:31:15,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.992468 to 0.991780, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:16,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.991810, valid_loss 0.996904, train_metric nan, valid_metric 0.067767
[4142451:MainThread](2024-04-06 16:31:16,175) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.000150, valid_loss 0.999711, train_metric nan, valid_metric 0.052791
[4142451:MainThread](2024-04-06 16:31:16,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.992229, valid_loss 0.997150, train_metric nan, valid_metric 0.046293
[4142451:MainThread](2024-04-06 16:31:16,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.998056, valid_loss 0.993625, train_metric nan, valid_metric 0.061232
[4142451:MainThread](2024-04-06 16:31:16,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.988357, valid_loss 0.994164, train_metric nan, valid_metric 0.061798
[4142451:MainThread](2024-04-06 16:31:16,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.988649, valid_loss 0.995404, train_metric nan, valid_metric 0.069068
[4142451:MainThread](2024-04-06 16:31:16,909) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.985072, valid_loss 0.995440, train_metric nan, valid_metric 0.055703
[4142451:MainThread](2024-04-06 16:31:17,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.984445, valid_loss 0.997479, train_metric nan, valid_metric 0.057930
[4142451:MainThread](2024-04-06 16:31:17,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.999962, valid_loss 0.993410, train_metric nan, valid_metric 0.079713
[4142451:MainThread](2024-04-06 16:31:17,336) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.989541, valid_loss 0.995723, train_metric nan, valid_metric 0.060668
[4142451:MainThread](2024-04-06 16:31:17,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.989398, valid_loss 0.994953, train_metric nan, valid_metric 0.078521
[4142451:MainThread](2024-04-06 16:31:17,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.990804, valid_loss 0.992054, train_metric nan, valid_metric 0.068497
[4142451:MainThread](2024-04-06 16:31:17,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.988401, valid_loss 0.992375, train_metric nan, valid_metric 0.079703
[4142451:MainThread](2024-04-06 16:31:17,955) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.977298, valid_loss 0.992631, train_metric nan, valid_metric 0.068834
[4142451:MainThread](2024-04-06 16:31:18,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.994722, valid_loss 0.993463, train_metric nan, valid_metric 0.073934
[4142451:MainThread](2024-04-06 16:31:18,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.975531, valid_loss 0.992227, train_metric nan, valid_metric 0.072293
[4142451:MainThread](2024-04-06 16:31:18,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.991340, valid_loss 0.993941, train_metric nan, valid_metric 0.062839
[4142451:MainThread](2024-04-06 16:31:18,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.992164, valid_loss 0.992375, train_metric nan, valid_metric 0.070579
[4142451:MainThread](2024-04-06 16:31:18,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.998346, valid_loss 0.993948, train_metric nan, valid_metric 0.062971
[4142451:MainThread](2024-04-06 16:31:18,852) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.989935, valid_loss 0.995525, train_metric nan, valid_metric 0.060883
[4142451:MainThread](2024-04-06 16:31:18,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.984055, valid_loss 0.992463, train_metric nan, valid_metric 0.071618
[4142451:MainThread](2024-04-06 16:31:19,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.987791, valid_loss 0.991064, train_metric nan, valid_metric 0.076115
[4142451:MainThread](2024-04-06 16:31:19,146) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991780 to 0.991064, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:19,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.989017, valid_loss 0.992972, train_metric nan, valid_metric 0.069247
[4142451:MainThread](2024-04-06 16:31:19,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.979480, valid_loss 0.993369, train_metric nan, valid_metric 0.064074
[4142451:MainThread](2024-04-06 16:31:19,579) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.990152, valid_loss 0.993252, train_metric nan, valid_metric 0.067438
[4142451:MainThread](2024-04-06 16:31:19,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.977518, valid_loss 0.994168, train_metric nan, valid_metric 0.072753
[4142451:MainThread](2024-04-06 16:31:19,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.999122, valid_loss 0.994031, train_metric nan, valid_metric 0.059405
[4142451:MainThread](2024-04-06 16:31:20,016) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.987590, valid_loss 0.992471, train_metric nan, valid_metric 0.071462
[4142451:MainThread](2024-04-06 16:31:20,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.987861, valid_loss 0.997607, train_metric nan, valid_metric 0.066626
[4142451:MainThread](2024-04-06 16:31:20,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.986529, valid_loss 0.992997, train_metric nan, valid_metric 0.070436
[4142451:MainThread](2024-04-06 16:31:20,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.987957, valid_loss 0.995926, train_metric nan, valid_metric 0.063385
[4142451:MainThread](2024-04-06 16:31:20,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.988451, valid_loss 0.993217, train_metric nan, valid_metric 0.068317
[4142451:MainThread](2024-04-06 16:31:20,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.995025, valid_loss 0.994764, train_metric nan, valid_metric 0.072477
[4142451:MainThread](2024-04-06 16:31:20,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.988275, valid_loss 0.993732, train_metric nan, valid_metric 0.060459
[4142451:MainThread](2024-04-06 16:31:21,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.980527, valid_loss 0.994460, train_metric nan, valid_metric 0.074946
[4142451:MainThread](2024-04-06 16:31:21,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.983220, valid_loss 0.993436, train_metric nan, valid_metric 0.068048
[4142451:MainThread](2024-04-06 16:31:21,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 1.004493, valid_loss 0.994786, train_metric nan, valid_metric 0.058451
[4142451:MainThread](2024-04-06 16:31:21,593) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.987670, valid_loss 0.993364, train_metric nan, valid_metric 0.073898
[4142451:MainThread](2024-04-06 16:31:21,744) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.987502, valid_loss 0.994142, train_metric nan, valid_metric 0.063221
[4142451:MainThread](2024-04-06 16:31:21,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.989120, valid_loss 0.991875, train_metric nan, valid_metric 0.074630
[4142451:MainThread](2024-04-06 16:31:22,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.983137, valid_loss 0.993950, train_metric nan, valid_metric 0.060604
[4142451:MainThread](2024-04-06 16:31:22,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.995190, valid_loss 0.991575, train_metric nan, valid_metric 0.082625
[4142451:MainThread](2024-04-06 16:31:22,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.974608, valid_loss 0.992157, train_metric nan, valid_metric 0.070879
[4142451:MainThread](2024-04-06 16:31:22,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.996945, valid_loss 0.995437, train_metric nan, valid_metric 0.065267
[4142451:MainThread](2024-04-06 16:31:22,755) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.991486, valid_loss 0.992637, train_metric nan, valid_metric 0.072981
[4142451:MainThread](2024-04-06 16:31:22,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.981442, valid_loss 0.992980, train_metric nan, valid_metric 0.069002
[4142451:MainThread](2024-04-06 16:31:23,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.999611, valid_loss 0.992574, train_metric nan, valid_metric 0.071684
[4142451:MainThread](2024-04-06 16:31:23,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.985716, valid_loss 0.994236, train_metric nan, valid_metric 0.063605
[4142451:MainThread](2024-04-06 16:31:23,333) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.984645, valid_loss 0.993380, train_metric nan, valid_metric 0.069498
[4142451:MainThread](2024-04-06 16:31:23,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.995367, valid_loss 0.993410, train_metric nan, valid_metric 0.069531
[4142451:MainThread](2024-04-06 16:31:23,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.987674, valid_loss 0.993368, train_metric nan, valid_metric 0.067037
[4142451:MainThread](2024-04-06 16:31:23,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.982429, valid_loss 0.993581, train_metric nan, valid_metric 0.067839
[4142451:MainThread](2024-04-06 16:31:23,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.992525, valid_loss 0.992511, train_metric nan, valid_metric 0.071825
[4142451:MainThread](2024-04-06 16:31:24,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.979884, valid_loss 0.992926, train_metric nan, valid_metric 0.071916
[4142451:MainThread](2024-04-06 16:31:24,192) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.973940, valid_loss 0.992284, train_metric nan, valid_metric 0.072008
[4142451:MainThread](2024-04-06 16:31:24,335) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.988077, valid_loss 0.992297, train_metric nan, valid_metric 0.069183
[4142451:MainThread](2024-04-06 16:31:24,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.989494, valid_loss 0.992947, train_metric nan, valid_metric 0.068911
[4142451:MainThread](2024-04-06 16:31:24,621) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.987892, valid_loss 0.993446, train_metric nan, valid_metric 0.067683
[4142451:MainThread](2024-04-06 16:31:24,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.996255, valid_loss 0.994389, train_metric nan, valid_metric 0.062696
[4142451:MainThread](2024-04-06 16:31:24,909) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.985597, valid_loss 0.992997, train_metric nan, valid_metric 0.069231
[4142451:MainThread](2024-04-06 16:31:25,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.975998, valid_loss 0.993246, train_metric nan, valid_metric 0.068479
[4142451:MainThread](2024-04-06 16:31:25,204) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.980411, valid_loss 0.993279, train_metric nan, valid_metric 0.068926
[4142451:MainThread](2024-04-06 16:31:25,356) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.977077, valid_loss 0.992967, train_metric nan, valid_metric 0.068060
[4142451:MainThread](2024-04-06 16:31:25,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.988134, valid_loss 0.992976, train_metric nan, valid_metric 0.068761
[4142451:MainThread](2024-04-06 16:31:25,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.993302, valid_loss 0.992329, train_metric nan, valid_metric 0.071105
[4142451:MainThread](2024-04-06 16:31:25,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.992051, valid_loss 0.993300, train_metric nan, valid_metric 0.067457
[4142451:MainThread](2024-04-06 16:31:25,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.986320, valid_loss 0.993787, train_metric nan, valid_metric 0.064901
[4142451:MainThread](2024-04-06 16:31:26,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.986384, valid_loss 0.992116, train_metric nan, valid_metric 0.071300
[4142451:MainThread](2024-04-06 16:31:26,263) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.984573, valid_loss 0.991752, train_metric nan, valid_metric 0.076701
[4142451:MainThread](2024-04-06 16:31:26,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.980663, valid_loss 0.991653, train_metric nan, valid_metric 0.075541
[4142451:MainThread](2024-04-06 16:31:26,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.979838, valid_loss 0.993482, train_metric nan, valid_metric 0.067443
[4142451:MainThread](2024-04-06 16:31:26,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.995060, valid_loss 0.992688, train_metric nan, valid_metric 0.070879
[4142451:MainThread](2024-04-06 16:31:26,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:31:27,546) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:31:28,409) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  69%|██████▉   | 36/52 [11:52<04:55, 18.47s/it][4142451:MainThread](2024-04-06 16:31:28,417) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:31:28,428) INFO - qlib.workflow - [recorder.py:341] - Recorder bd0859cff2ae402e9025cea3288f4e81 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:31:29,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:31:29,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:31:29,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:31:29,114) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:31:32,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:31:33,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.304447, valid_loss 1.054356, train_metric nan, valid_metric 0.031696
[4142451:MainThread](2024-04-06 16:31:33,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.054356, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:31:33,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.156033, valid_loss 1.112839, train_metric nan, valid_metric 0.014960
[4142451:MainThread](2024-04-06 16:31:33,426) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.081898, valid_loss 1.016022, train_metric nan, valid_metric 0.026500
[4142451:MainThread](2024-04-06 16:31:33,427) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.054356 to 1.016022, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:33,580) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.082389, valid_loss 1.027821, train_metric nan, valid_metric 0.033345
[4142451:MainThread](2024-04-06 16:31:33,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.065407, valid_loss 1.029213, train_metric nan, valid_metric 0.056081
[4142451:MainThread](2024-04-06 16:31:33,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.041028, valid_loss 1.000476, train_metric nan, valid_metric 0.068200
[4142451:MainThread](2024-04-06 16:31:33,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.016022 to 1.000476, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:34,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.045643, valid_loss 0.998622, train_metric nan, valid_metric 0.066414
[4142451:MainThread](2024-04-06 16:31:34,037) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000476 to 0.998622, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:34,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.040405, valid_loss 1.004303, train_metric nan, valid_metric 0.047553
[4142451:MainThread](2024-04-06 16:31:34,316) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.038276, valid_loss 1.004099, train_metric nan, valid_metric 0.032061
[4142451:MainThread](2024-04-06 16:31:34,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.012250, valid_loss 1.001595, train_metric nan, valid_metric 0.045042
[4142451:MainThread](2024-04-06 16:31:34,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.007466, valid_loss 1.023501, train_metric nan, valid_metric 0.082315
[4142451:MainThread](2024-04-06 16:31:34,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.016845, valid_loss 0.995596, train_metric nan, valid_metric 0.064613
[4142451:MainThread](2024-04-06 16:31:34,770) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998622 to 0.995596, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:34,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.019665, valid_loss 0.998308, train_metric nan, valid_metric 0.045078
[4142451:MainThread](2024-04-06 16:31:35,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.015245, valid_loss 1.006032, train_metric nan, valid_metric 0.100164
[4142451:MainThread](2024-04-06 16:31:35,281) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.008024, valid_loss 0.993968, train_metric nan, valid_metric 0.076268
[4142451:MainThread](2024-04-06 16:31:35,281) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995596 to 0.993968, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:35,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.004120, valid_loss 0.991862, train_metric nan, valid_metric 0.079055
[4142451:MainThread](2024-04-06 16:31:35,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993968 to 0.991862, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:35,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.010653, valid_loss 0.991574, train_metric nan, valid_metric 0.100822
[4142451:MainThread](2024-04-06 16:31:35,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991862 to 0.991574, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:35,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.004120, valid_loss 1.001403, train_metric nan, valid_metric 0.087533
[4142451:MainThread](2024-04-06 16:31:35,953) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.009904, valid_loss 0.990914, train_metric nan, valid_metric 0.083327
[4142451:MainThread](2024-04-06 16:31:35,953) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991574 to 0.990914, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:36,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.006082, valid_loss 1.001257, train_metric nan, valid_metric 0.080049
[4142451:MainThread](2024-04-06 16:31:36,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.996835, valid_loss 1.000234, train_metric nan, valid_metric 0.078972
[4142451:MainThread](2024-04-06 16:31:36,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.007604, valid_loss 0.993813, train_metric nan, valid_metric 0.066696
[4142451:MainThread](2024-04-06 16:31:36,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.001424, valid_loss 0.991704, train_metric nan, valid_metric 0.085301
[4142451:MainThread](2024-04-06 16:31:36,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.039956, valid_loss 1.006483, train_metric nan, valid_metric 0.063518
[4142451:MainThread](2024-04-06 16:31:36,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.027759, valid_loss 0.997377, train_metric nan, valid_metric 0.100046
[4142451:MainThread](2024-04-06 16:31:37,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.008776, valid_loss 0.994396, train_metric nan, valid_metric 0.078616
[4142451:MainThread](2024-04-06 16:31:37,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.994865, valid_loss 0.990015, train_metric nan, valid_metric 0.087981
[4142451:MainThread](2024-04-06 16:31:37,237) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990914 to 0.990015, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:37,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.987123, valid_loss 0.993087, train_metric nan, valid_metric 0.074773
[4142451:MainThread](2024-04-06 16:31:37,528) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.999422, valid_loss 0.988980, train_metric nan, valid_metric 0.091987
[4142451:MainThread](2024-04-06 16:31:37,528) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990015 to 0.988980, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:37,673) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.004573, valid_loss 0.991958, train_metric nan, valid_metric 0.091008
[4142451:MainThread](2024-04-06 16:31:37,846) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.985573, valid_loss 0.992547, train_metric nan, valid_metric 0.077938
[4142451:MainThread](2024-04-06 16:31:38,021) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.000473, valid_loss 0.990427, train_metric nan, valid_metric 0.088303
[4142451:MainThread](2024-04-06 16:31:38,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.989649, valid_loss 0.990546, train_metric nan, valid_metric 0.087175
[4142451:MainThread](2024-04-06 16:31:38,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.008592, valid_loss 0.989916, train_metric nan, valid_metric 0.086179
[4142451:MainThread](2024-04-06 16:31:38,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.983597, valid_loss 0.989778, train_metric nan, valid_metric 0.088313
[4142451:MainThread](2024-04-06 16:31:38,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.986875, valid_loss 0.991179, train_metric nan, valid_metric 0.079080
[4142451:MainThread](2024-04-06 16:31:38,757) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.992945, valid_loss 0.992971, train_metric nan, valid_metric 0.075078
[4142451:MainThread](2024-04-06 16:31:38,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.995021, valid_loss 0.992124, train_metric nan, valid_metric 0.075641
[4142451:MainThread](2024-04-06 16:31:39,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.986887, valid_loss 0.990530, train_metric nan, valid_metric 0.080963
[4142451:MainThread](2024-04-06 16:31:39,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.989974, valid_loss 0.991753, train_metric nan, valid_metric 0.079788
[4142451:MainThread](2024-04-06 16:31:39,342) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.997278, valid_loss 0.990010, train_metric nan, valid_metric 0.084598
[4142451:MainThread](2024-04-06 16:31:39,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.987430, valid_loss 0.993097, train_metric nan, valid_metric 0.089528
[4142451:MainThread](2024-04-06 16:31:39,677) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.995941, valid_loss 0.993719, train_metric nan, valid_metric 0.080801
[4142451:MainThread](2024-04-06 16:31:39,810) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.978843, valid_loss 0.989555, train_metric nan, valid_metric 0.087107
[4142451:MainThread](2024-04-06 16:31:39,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.990431, valid_loss 0.991103, train_metric nan, valid_metric 0.090291
[4142451:MainThread](2024-04-06 16:31:40,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.985813, valid_loss 0.992341, train_metric nan, valid_metric 0.095437
[4142451:MainThread](2024-04-06 16:31:40,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.979514, valid_loss 0.989141, train_metric nan, valid_metric 0.094003
[4142451:MainThread](2024-04-06 16:31:40,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.990366, valid_loss 0.989308, train_metric nan, valid_metric 0.098593
[4142451:MainThread](2024-04-06 16:31:40,578) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.991469, valid_loss 0.989053, train_metric nan, valid_metric 0.091011
[4142451:MainThread](2024-04-06 16:31:40,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.982229, valid_loss 0.990463, train_metric nan, valid_metric 0.088123
[4142451:MainThread](2024-04-06 16:31:40,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.980805, valid_loss 0.993167, train_metric nan, valid_metric 0.075725
[4142451:MainThread](2024-04-06 16:31:41,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.981095, valid_loss 0.990981, train_metric nan, valid_metric 0.084333
[4142451:MainThread](2024-04-06 16:31:41,220) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.988706, valid_loss 0.989979, train_metric nan, valid_metric 0.089916
[4142451:MainThread](2024-04-06 16:31:41,393) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.994518, valid_loss 0.991336, train_metric nan, valid_metric 0.080233
[4142451:MainThread](2024-04-06 16:31:41,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.981752, valid_loss 0.990816, train_metric nan, valid_metric 0.084359
[4142451:MainThread](2024-04-06 16:31:41,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.982345, valid_loss 0.991400, train_metric nan, valid_metric 0.076888
[4142451:MainThread](2024-04-06 16:31:41,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.982674, valid_loss 0.992056, train_metric nan, valid_metric 0.081805
[4142451:MainThread](2024-04-06 16:31:41,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.986649, valid_loss 0.994268, train_metric nan, valid_metric 0.073002
[4142451:MainThread](2024-04-06 16:31:42,089) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.984271, valid_loss 0.989694, train_metric nan, valid_metric 0.088472
[4142451:MainThread](2024-04-06 16:31:42,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.984167, valid_loss 0.990789, train_metric nan, valid_metric 0.082590
[4142451:MainThread](2024-04-06 16:31:42,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.990651, valid_loss 0.989517, train_metric nan, valid_metric 0.094307
[4142451:MainThread](2024-04-06 16:31:42,504) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.989489, valid_loss 0.990573, train_metric nan, valid_metric 0.086497
[4142451:MainThread](2024-04-06 16:31:42,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.980682, valid_loss 0.991020, train_metric nan, valid_metric 0.086809
[4142451:MainThread](2024-04-06 16:31:42,852) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.981311, valid_loss 0.990633, train_metric nan, valid_metric 0.085043
[4142451:MainThread](2024-04-06 16:31:43,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.984704, valid_loss 0.991552, train_metric nan, valid_metric 0.084734
[4142451:MainThread](2024-04-06 16:31:43,191) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.987309, valid_loss 0.991603, train_metric nan, valid_metric 0.082029
[4142451:MainThread](2024-04-06 16:31:43,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.987802, valid_loss 0.989895, train_metric nan, valid_metric 0.088165
[4142451:MainThread](2024-04-06 16:31:43,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.977449, valid_loss 0.990081, train_metric nan, valid_metric 0.082420
[4142451:MainThread](2024-04-06 16:31:43,677) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.994414, valid_loss 0.989850, train_metric nan, valid_metric 0.087199
[4142451:MainThread](2024-04-06 16:31:43,818) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.990634, valid_loss 0.991405, train_metric nan, valid_metric 0.081872
[4142451:MainThread](2024-04-06 16:31:43,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.990618, valid_loss 0.992340, train_metric nan, valid_metric 0.077462
[4142451:MainThread](2024-04-06 16:31:44,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.992590, valid_loss 0.990827, train_metric nan, valid_metric 0.089286
[4142451:MainThread](2024-04-06 16:31:44,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.998504, valid_loss 0.991056, train_metric nan, valid_metric 0.081322
[4142451:MainThread](2024-04-06 16:31:44,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.978748, valid_loss 0.991031, train_metric nan, valid_metric 0.084038
[4142451:MainThread](2024-04-06 16:31:44,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.979819, valid_loss 0.989929, train_metric nan, valid_metric 0.086133
[4142451:MainThread](2024-04-06 16:31:44,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.993855, valid_loss 0.990995, train_metric nan, valid_metric 0.083802
[4142451:MainThread](2024-04-06 16:31:44,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.984570, valid_loss 0.990695, train_metric nan, valid_metric 0.085276
[4142451:MainThread](2024-04-06 16:31:45,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.973402, valid_loss 0.990882, train_metric nan, valid_metric 0.078013
[4142451:MainThread](2024-04-06 16:31:45,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.992319, valid_loss 0.991077, train_metric nan, valid_metric 0.081022
[4142451:MainThread](2024-04-06 16:31:45,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:31:46,043) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:31:46,903) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  71%|███████   | 37/52 [12:11<04:37, 18.47s/it][4142451:MainThread](2024-04-06 16:31:46,912) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:31:46,922) INFO - qlib.workflow - [recorder.py:341] - Recorder 42ccd2a6c5544b76b483fe0ccd45c95f starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:31:47,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:31:47,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:31:47,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:31:47,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:31:51,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:31:51,492) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.275321, valid_loss 1.040258, train_metric nan, valid_metric 0.098636
[4142451:MainThread](2024-04-06 16:31:51,492) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.040258, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:31:51,638) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.117563, valid_loss 1.018400, train_metric nan, valid_metric 0.015891
[4142451:MainThread](2024-04-06 16:31:51,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.040258 to 1.018400, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:51,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.061525, valid_loss 1.043881, train_metric nan, valid_metric 0.068544
[4142451:MainThread](2024-04-06 16:31:51,929) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.083067, valid_loss 1.020006, train_metric nan, valid_metric 0.074566
[4142451:MainThread](2024-04-06 16:31:52,073) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.043357, valid_loss 0.998533, train_metric nan, valid_metric 0.064347
[4142451:MainThread](2024-04-06 16:31:52,073) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.018400 to 0.998533, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:52,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.096881, valid_loss 0.992634, train_metric nan, valid_metric 0.088420
[4142451:MainThread](2024-04-06 16:31:52,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998533 to 0.992634, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:52,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.042757, valid_loss 0.998301, train_metric nan, valid_metric 0.085739
[4142451:MainThread](2024-04-06 16:31:52,538) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.029105, valid_loss 1.006908, train_metric nan, valid_metric 0.065735
[4142451:MainThread](2024-04-06 16:31:52,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.030915, valid_loss 1.002666, train_metric nan, valid_metric 0.088420
[4142451:MainThread](2024-04-06 16:31:52,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.017728, valid_loss 1.005036, train_metric nan, valid_metric 0.045850
[4142451:MainThread](2024-04-06 16:31:52,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.033986, valid_loss 1.014060, train_metric nan, valid_metric 0.075359
[4142451:MainThread](2024-04-06 16:31:53,114) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.029036, valid_loss 1.011994, train_metric nan, valid_metric 0.046653
[4142451:MainThread](2024-04-06 16:31:53,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.017594, valid_loss 1.075351, train_metric nan, valid_metric 0.093875
[4142451:MainThread](2024-04-06 16:31:53,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.036230, valid_loss 1.016087, train_metric nan, valid_metric 0.094497
[4142451:MainThread](2024-04-06 16:31:53,565) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.009110, valid_loss 0.993693, train_metric nan, valid_metric 0.092423
[4142451:MainThread](2024-04-06 16:31:53,741) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.006806, valid_loss 0.987366, train_metric nan, valid_metric 0.101373
[4142451:MainThread](2024-04-06 16:31:53,742) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.992634 to 0.987366, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:53,892) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.007788, valid_loss 0.998669, train_metric nan, valid_metric 0.109020
[4142451:MainThread](2024-04-06 16:31:54,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.006053, valid_loss 0.987468, train_metric nan, valid_metric 0.102293
[4142451:MainThread](2024-04-06 16:31:54,215) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.992041, valid_loss 0.988377, train_metric nan, valid_metric 0.106018
[4142451:MainThread](2024-04-06 16:31:54,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.001710, valid_loss 0.992379, train_metric nan, valid_metric 0.111622
[4142451:MainThread](2024-04-06 16:31:54,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.996845, valid_loss 0.994645, train_metric nan, valid_metric 0.063881
[4142451:MainThread](2024-04-06 16:31:54,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.998906, valid_loss 0.990012, train_metric nan, valid_metric 0.087409
[4142451:MainThread](2024-04-06 16:31:54,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.985226, valid_loss 0.995885, train_metric nan, valid_metric 0.068606
[4142451:MainThread](2024-04-06 16:31:54,955) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.991680, valid_loss 0.989011, train_metric nan, valid_metric 0.113247
[4142451:MainThread](2024-04-06 16:31:55,099) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.987957, valid_loss 0.994617, train_metric nan, valid_metric 0.099033
[4142451:MainThread](2024-04-06 16:31:55,243) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.999705, valid_loss 0.989625, train_metric nan, valid_metric 0.090085
[4142451:MainThread](2024-04-06 16:31:55,390) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.996368, valid_loss 0.987779, train_metric nan, valid_metric 0.097830
[4142451:MainThread](2024-04-06 16:31:55,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.999314, valid_loss 0.991417, train_metric nan, valid_metric 0.093427
[4142451:MainThread](2024-04-06 16:31:55,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.988384, valid_loss 0.989632, train_metric nan, valid_metric 0.092048
[4142451:MainThread](2024-04-06 16:31:55,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.997937, valid_loss 0.991558, train_metric nan, valid_metric 0.107499
[4142451:MainThread](2024-04-06 16:31:55,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.994536, valid_loss 0.986823, train_metric nan, valid_metric 0.101897
[4142451:MainThread](2024-04-06 16:31:55,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.987366 to 0.986823, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:56,129) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.992464, valid_loss 0.993081, train_metric nan, valid_metric 0.103105
[4142451:MainThread](2024-04-06 16:31:56,304) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.996128, valid_loss 0.989944, train_metric nan, valid_metric 0.086487
[4142451:MainThread](2024-04-06 16:31:56,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.986919, valid_loss 0.988588, train_metric nan, valid_metric 0.093047
[4142451:MainThread](2024-04-06 16:31:56,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.999002, valid_loss 0.986767, train_metric nan, valid_metric 0.102401
[4142451:MainThread](2024-04-06 16:31:56,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.986823 to 0.986767, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:56,760) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.988903, valid_loss 0.994067, train_metric nan, valid_metric 0.094538
[4142451:MainThread](2024-04-06 16:31:56,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.987118, valid_loss 0.991838, train_metric nan, valid_metric 0.097515
[4142451:MainThread](2024-04-06 16:31:57,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.990296, valid_loss 0.988765, train_metric nan, valid_metric 0.092396
[4142451:MainThread](2024-04-06 16:31:57,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.976493, valid_loss 0.988904, train_metric nan, valid_metric 0.110410
[4142451:MainThread](2024-04-06 16:31:57,304) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.982805, valid_loss 0.989084, train_metric nan, valid_metric 0.102030
[4142451:MainThread](2024-04-06 16:31:57,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.986397, valid_loss 0.995513, train_metric nan, valid_metric 0.104944
[4142451:MainThread](2024-04-06 16:31:57,571) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.982988, valid_loss 0.987342, train_metric nan, valid_metric 0.098282
[4142451:MainThread](2024-04-06 16:31:57,716) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.990984, valid_loss 0.986943, train_metric nan, valid_metric 0.101359
[4142451:MainThread](2024-04-06 16:31:57,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.989343, valid_loss 0.986976, train_metric nan, valid_metric 0.100710
[4142451:MainThread](2024-04-06 16:31:58,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.987965, valid_loss 0.986563, train_metric nan, valid_metric 0.105723
[4142451:MainThread](2024-04-06 16:31:58,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.986767 to 0.986563, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:58,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.987226, valid_loss 0.987332, train_metric nan, valid_metric 0.110179
[4142451:MainThread](2024-04-06 16:31:58,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.979350, valid_loss 0.989482, train_metric nan, valid_metric 0.104131
[4142451:MainThread](2024-04-06 16:31:58,434) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.986592, valid_loss 0.986029, train_metric nan, valid_metric 0.107895
[4142451:MainThread](2024-04-06 16:31:58,434) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.986563 to 0.986029, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:58,577) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.984670, valid_loss 0.986292, train_metric nan, valid_metric 0.108357
[4142451:MainThread](2024-04-06 16:31:58,727) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.981119, valid_loss 0.989897, train_metric nan, valid_metric 0.089582
[4142451:MainThread](2024-04-06 16:31:58,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.984554, valid_loss 0.988108, train_metric nan, valid_metric 0.104321
[4142451:MainThread](2024-04-06 16:31:59,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.988437, valid_loss 0.987978, train_metric nan, valid_metric 0.105124
[4142451:MainThread](2024-04-06 16:31:59,179) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.989261, valid_loss 0.990614, train_metric nan, valid_metric 0.101224
[4142451:MainThread](2024-04-06 16:31:59,326) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.988460, valid_loss 0.985891, train_metric nan, valid_metric 0.107342
[4142451:MainThread](2024-04-06 16:31:59,326) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.986029 to 0.985891, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:59,474) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.985782, valid_loss 0.988411, train_metric nan, valid_metric 0.100074
[4142451:MainThread](2024-04-06 16:31:59,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.993907, valid_loss 0.986500, train_metric nan, valid_metric 0.120037
[4142451:MainThread](2024-04-06 16:31:59,765) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.994253, valid_loss 0.984762, train_metric nan, valid_metric 0.115601
[4142451:MainThread](2024-04-06 16:31:59,765) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.985891 to 0.984762, save checkpoint.
[4142451:MainThread](2024-04-06 16:31:59,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.989057, valid_loss 0.990756, train_metric nan, valid_metric 0.096953
[4142451:MainThread](2024-04-06 16:32:00,053) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.997333, valid_loss 0.988899, train_metric nan, valid_metric 0.100702
[4142451:MainThread](2024-04-06 16:32:00,191) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.987624, valid_loss 0.987721, train_metric nan, valid_metric 0.101692
[4142451:MainThread](2024-04-06 16:32:00,333) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.991135, valid_loss 0.989735, train_metric nan, valid_metric 0.097484
[4142451:MainThread](2024-04-06 16:32:00,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.980220, valid_loss 0.989881, train_metric nan, valid_metric 0.090272
[4142451:MainThread](2024-04-06 16:32:00,633) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.996924, valid_loss 0.989967, train_metric nan, valid_metric 0.093419
[4142451:MainThread](2024-04-06 16:32:00,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.986922, valid_loss 0.987906, train_metric nan, valid_metric 0.097235
[4142451:MainThread](2024-04-06 16:32:00,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.990598, valid_loss 0.988808, train_metric nan, valid_metric 0.100576
[4142451:MainThread](2024-04-06 16:32:01,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.983654, valid_loss 0.988361, train_metric nan, valid_metric 0.104974
[4142451:MainThread](2024-04-06 16:32:01,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.979238, valid_loss 0.987321, train_metric nan, valid_metric 0.102996
[4142451:MainThread](2024-04-06 16:32:01,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.990517, valid_loss 0.988209, train_metric nan, valid_metric 0.104743
[4142451:MainThread](2024-04-06 16:32:01,507) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.981572, valid_loss 0.987386, train_metric nan, valid_metric 0.105631
[4142451:MainThread](2024-04-06 16:32:01,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.980628, valid_loss 0.985697, train_metric nan, valid_metric 0.110519
[4142451:MainThread](2024-04-06 16:32:01,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.983581, valid_loss 0.987416, train_metric nan, valid_metric 0.108624
[4142451:MainThread](2024-04-06 16:32:01,937) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.990503, valid_loss 0.987109, train_metric nan, valid_metric 0.105029
[4142451:MainThread](2024-04-06 16:32:02,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.994967, valid_loss 0.987992, train_metric nan, valid_metric 0.100108
[4142451:MainThread](2024-04-06 16:32:02,223) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.987306, valid_loss 0.988369, train_metric nan, valid_metric 0.098451
[4142451:MainThread](2024-04-06 16:32:02,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.982297, valid_loss 0.986266, train_metric nan, valid_metric 0.111625
[4142451:MainThread](2024-04-06 16:32:02,504) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.984085, valid_loss 0.987182, train_metric nan, valid_metric 0.100422
[4142451:MainThread](2024-04-06 16:32:02,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.977323, valid_loss 0.987826, train_metric nan, valid_metric 0.102957
[4142451:MainThread](2024-04-06 16:32:02,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.991647, valid_loss 0.987603, train_metric nan, valid_metric 0.105742
[4142451:MainThread](2024-04-06 16:32:02,936) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.986653, valid_loss 0.987588, train_metric nan, valid_metric 0.098751
[4142451:MainThread](2024-04-06 16:32:03,084) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.982881, valid_loss 0.985729, train_metric nan, valid_metric 0.114139
[4142451:MainThread](2024-04-06 16:32:03,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.993829, valid_loss 0.988098, train_metric nan, valid_metric 0.105786
[4142451:MainThread](2024-04-06 16:32:03,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.981812, valid_loss 0.985549, train_metric nan, valid_metric 0.112432
[4142451:MainThread](2024-04-06 16:32:03,567) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.996918, valid_loss 0.988586, train_metric nan, valid_metric 0.096475
[4142451:MainThread](2024-04-06 16:32:03,741) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.987868, valid_loss 0.988285, train_metric nan, valid_metric 0.100970
[4142451:MainThread](2024-04-06 16:32:03,913) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.983210, valid_loss 0.987722, train_metric nan, valid_metric 0.100462
[4142451:MainThread](2024-04-06 16:32:04,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.989077, valid_loss 0.987092, train_metric nan, valid_metric 0.104500
[4142451:MainThread](2024-04-06 16:32:04,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.986721, valid_loss 0.986480, train_metric nan, valid_metric 0.109356
[4142451:MainThread](2024-04-06 16:32:04,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.992115, valid_loss 0.988277, train_metric nan, valid_metric 0.104313
[4142451:MainThread](2024-04-06 16:32:04,608) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.978515, valid_loss 0.987257, train_metric nan, valid_metric 0.104100
[4142451:MainThread](2024-04-06 16:32:04,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.980595, valid_loss 0.986654, train_metric nan, valid_metric 0.106556
[4142451:MainThread](2024-04-06 16:32:04,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.996482, valid_loss 0.986686, train_metric nan, valid_metric 0.107141
[4142451:MainThread](2024-04-06 16:32:05,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.980914, valid_loss 0.986906, train_metric nan, valid_metric 0.106495
[4142451:MainThread](2024-04-06 16:32:05,306) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.982084, valid_loss 0.986907, train_metric nan, valid_metric 0.103625
[4142451:MainThread](2024-04-06 16:32:05,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.979830, valid_loss 0.987622, train_metric nan, valid_metric 0.102341
[4142451:MainThread](2024-04-06 16:32:05,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.983844, valid_loss 0.987993, train_metric nan, valid_metric 0.102018
[4142451:MainThread](2024-04-06 16:32:05,755) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.982411, valid_loss 0.987365, train_metric nan, valid_metric 0.105224
[4142451:MainThread](2024-04-06 16:32:05,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.977499, valid_loss 0.986894, train_metric nan, valid_metric 0.109086
[4142451:MainThread](2024-04-06 16:32:06,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.982895, valid_loss 0.985485, train_metric nan, valid_metric 0.114766
[4142451:MainThread](2024-04-06 16:32:06,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.994992, valid_loss 0.986400, train_metric nan, valid_metric 0.109064
[4142451:MainThread](2024-04-06 16:32:06,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.988896, valid_loss 0.985930, train_metric nan, valid_metric 0.108731
[4142451:MainThread](2024-04-06 16:32:06,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.986618, valid_loss 0.986872, train_metric nan, valid_metric 0.105301
[4142451:MainThread](2024-04-06 16:32:06,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.993621, valid_loss 0.987466, train_metric nan, valid_metric 0.101521
[4142451:MainThread](2024-04-06 16:32:06,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.986216, valid_loss 0.986853, train_metric nan, valid_metric 0.104793
[4142451:MainThread](2024-04-06 16:32:07,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.977418, valid_loss 0.986240, train_metric nan, valid_metric 0.109712
[4142451:MainThread](2024-04-06 16:32:07,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.983039, valid_loss 0.986874, train_metric nan, valid_metric 0.105309
[4142451:MainThread](2024-04-06 16:32:07,510) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 0.989251, valid_loss 0.986772, train_metric nan, valid_metric 0.105659
[4142451:MainThread](2024-04-06 16:32:07,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.989658, valid_loss 0.986974, train_metric nan, valid_metric 0.106010
[4142451:MainThread](2024-04-06 16:32:07,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:32:08,503) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:32:09,381) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  73%|███████▎  | 38/52 [12:33<04:35, 19.68s/it][4142451:MainThread](2024-04-06 16:32:09,389) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:32:09,399) INFO - qlib.workflow - [recorder.py:341] - Recorder 49fc3d8918ca43988e6f40362c162661 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:32:10,108) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:32:10,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:32:10,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:32:10,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:32:13,910) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:32:14,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.319138, valid_loss 1.078160, train_metric nan, valid_metric -0.036321
[4142451:MainThread](2024-04-06 16:32:14,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.078160, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:32:14,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.127474, valid_loss 1.029984, train_metric nan, valid_metric 0.098491
[4142451:MainThread](2024-04-06 16:32:14,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.078160 to 1.029984, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:14,551) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.091209, valid_loss 1.081085, train_metric nan, valid_metric 0.049562
[4142451:MainThread](2024-04-06 16:32:14,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.077270, valid_loss 1.062874, train_metric nan, valid_metric 0.065814
[4142451:MainThread](2024-04-06 16:32:14,881) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.049233, valid_loss 1.019283, train_metric nan, valid_metric 0.080609
[4142451:MainThread](2024-04-06 16:32:14,881) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.029984 to 1.019283, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:15,033) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.027652, valid_loss 0.997412, train_metric nan, valid_metric 0.070235
[4142451:MainThread](2024-04-06 16:32:15,033) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.019283 to 0.997412, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:15,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.027124, valid_loss 0.991580, train_metric nan, valid_metric 0.096244
[4142451:MainThread](2024-04-06 16:32:15,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997412 to 0.991580, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:15,383) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.024829, valid_loss 0.994808, train_metric nan, valid_metric 0.091067
[4142451:MainThread](2024-04-06 16:32:15,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.016503, valid_loss 1.003518, train_metric nan, valid_metric 0.070278
[4142451:MainThread](2024-04-06 16:32:15,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.021217, valid_loss 1.016529, train_metric nan, valid_metric 0.090766
[4142451:MainThread](2024-04-06 16:32:15,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.016381, valid_loss 0.990662, train_metric nan, valid_metric 0.096761
[4142451:MainThread](2024-04-06 16:32:15,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991580 to 0.990662, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:15,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 0.997358, valid_loss 0.993894, train_metric nan, valid_metric 0.079176
[4142451:MainThread](2024-04-06 16:32:16,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.014018, valid_loss 0.992453, train_metric nan, valid_metric 0.082865
[4142451:MainThread](2024-04-06 16:32:16,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.024471, valid_loss 1.055028, train_metric nan, valid_metric 0.037617
[4142451:MainThread](2024-04-06 16:32:16,508) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.003059, valid_loss 0.992266, train_metric nan, valid_metric 0.106215
[4142451:MainThread](2024-04-06 16:32:16,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.001155, valid_loss 0.992552, train_metric nan, valid_metric 0.110217
[4142451:MainThread](2024-04-06 16:32:16,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.997469, valid_loss 0.996135, train_metric nan, valid_metric 0.081382
[4142451:MainThread](2024-04-06 16:32:17,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.999032, valid_loss 0.990329, train_metric nan, valid_metric 0.090134
[4142451:MainThread](2024-04-06 16:32:17,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990662 to 0.990329, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:17,175) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.010489, valid_loss 1.001063, train_metric nan, valid_metric 0.038784
[4142451:MainThread](2024-04-06 16:32:17,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.996371, valid_loss 0.989819, train_metric nan, valid_metric 0.087790
[4142451:MainThread](2024-04-06 16:32:17,346) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990329 to 0.989819, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:17,492) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.998734, valid_loss 0.996630, train_metric nan, valid_metric 0.048794
[4142451:MainThread](2024-04-06 16:32:17,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.998829, valid_loss 0.989096, train_metric nan, valid_metric 0.092585
[4142451:MainThread](2024-04-06 16:32:17,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.989819 to 0.989096, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:17,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.995095, valid_loss 0.990328, train_metric nan, valid_metric 0.094242
[4142451:MainThread](2024-04-06 16:32:17,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.999489, valid_loss 0.993668, train_metric nan, valid_metric 0.065333
[4142451:MainThread](2024-04-06 16:32:18,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.985902, valid_loss 0.994307, train_metric nan, valid_metric 0.083249
[4142451:MainThread](2024-04-06 16:32:18,325) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.999998, valid_loss 0.993630, train_metric nan, valid_metric 0.085983
[4142451:MainThread](2024-04-06 16:32:18,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.994923, valid_loss 0.998297, train_metric nan, valid_metric 0.098050
[4142451:MainThread](2024-04-06 16:32:18,669) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.988496, valid_loss 0.992713, train_metric nan, valid_metric 0.080358
[4142451:MainThread](2024-04-06 16:32:18,839) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.997590, valid_loss 0.988624, train_metric nan, valid_metric 0.096980
[4142451:MainThread](2024-04-06 16:32:18,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.989096 to 0.988624, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:19,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.984250, valid_loss 0.998383, train_metric nan, valid_metric 0.109436
[4142451:MainThread](2024-04-06 16:32:19,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.981590, valid_loss 0.988985, train_metric nan, valid_metric 0.091790
[4142451:MainThread](2024-04-06 16:32:19,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.994068, valid_loss 0.988740, train_metric nan, valid_metric 0.093865
[4142451:MainThread](2024-04-06 16:32:19,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.997337, valid_loss 0.991067, train_metric nan, valid_metric 0.101408
[4142451:MainThread](2024-04-06 16:32:19,678) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.001380, valid_loss 0.997970, train_metric nan, valid_metric 0.092599
[4142451:MainThread](2024-04-06 16:32:19,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.994863, valid_loss 0.988515, train_metric nan, valid_metric 0.102233
[4142451:MainThread](2024-04-06 16:32:19,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.988624 to 0.988515, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:19,957) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.976980, valid_loss 0.991302, train_metric nan, valid_metric 0.088253
[4142451:MainThread](2024-04-06 16:32:20,099) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.988174, valid_loss 0.990319, train_metric nan, valid_metric 0.099939
[4142451:MainThread](2024-04-06 16:32:20,237) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.980177, valid_loss 0.989296, train_metric nan, valid_metric 0.090700
[4142451:MainThread](2024-04-06 16:32:20,378) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.990761, valid_loss 0.988430, train_metric nan, valid_metric 0.092989
[4142451:MainThread](2024-04-06 16:32:20,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.988515 to 0.988430, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:20,525) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.999330, valid_loss 0.990389, train_metric nan, valid_metric 0.097049
[4142451:MainThread](2024-04-06 16:32:20,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.980593, valid_loss 0.986819, train_metric nan, valid_metric 0.110014
[4142451:MainThread](2024-04-06 16:32:20,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.988430 to 0.986819, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:20,813) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.988920, valid_loss 0.990498, train_metric nan, valid_metric 0.084745
[4142451:MainThread](2024-04-06 16:32:20,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.984479, valid_loss 0.993977, train_metric nan, valid_metric 0.071884
[4142451:MainThread](2024-04-06 16:32:21,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.978183, valid_loss 0.989201, train_metric nan, valid_metric 0.088505
[4142451:MainThread](2024-04-06 16:32:21,251) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.992005, valid_loss 0.991488, train_metric nan, valid_metric 0.080936
[4142451:MainThread](2024-04-06 16:32:21,390) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.991357, valid_loss 0.990987, train_metric nan, valid_metric 0.094299
[4142451:MainThread](2024-04-06 16:32:21,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.991606, valid_loss 0.991720, train_metric nan, valid_metric 0.075013
[4142451:MainThread](2024-04-06 16:32:21,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.981066, valid_loss 0.989072, train_metric nan, valid_metric 0.092497
[4142451:MainThread](2024-04-06 16:32:21,910) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.986066, valid_loss 0.994216, train_metric nan, valid_metric 0.097660
[4142451:MainThread](2024-04-06 16:32:22,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.989419, valid_loss 0.992231, train_metric nan, valid_metric 0.084190
[4142451:MainThread](2024-04-06 16:32:22,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.982867, valid_loss 0.993531, train_metric nan, valid_metric 0.083292
[4142451:MainThread](2024-04-06 16:32:22,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.998515, valid_loss 0.992382, train_metric nan, valid_metric 0.086439
[4142451:MainThread](2024-04-06 16:32:22,538) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.978124, valid_loss 0.991509, train_metric nan, valid_metric 0.089067
[4142451:MainThread](2024-04-06 16:32:22,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.978703, valid_loss 0.991314, train_metric nan, valid_metric 0.106567
[4142451:MainThread](2024-04-06 16:32:22,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.986641, valid_loss 0.989120, train_metric nan, valid_metric 0.097197
[4142451:MainThread](2024-04-06 16:32:22,970) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.992900, valid_loss 0.990295, train_metric nan, valid_metric 0.082767
[4142451:MainThread](2024-04-06 16:32:23,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.980242, valid_loss 0.989760, train_metric nan, valid_metric 0.087311
[4142451:MainThread](2024-04-06 16:32:23,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.987145, valid_loss 0.988979, train_metric nan, valid_metric 0.090658
[4142451:MainThread](2024-04-06 16:32:23,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.977317, valid_loss 0.991098, train_metric nan, valid_metric 0.079618
[4142451:MainThread](2024-04-06 16:32:23,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.981147, valid_loss 0.989425, train_metric nan, valid_metric 0.096603
[4142451:MainThread](2024-04-06 16:32:23,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.977738, valid_loss 0.990684, train_metric nan, valid_metric 0.088890
[4142451:MainThread](2024-04-06 16:32:23,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.987403, valid_loss 0.998763, train_metric nan, valid_metric 0.082422
[4142451:MainThread](2024-04-06 16:32:23,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.985918, valid_loss 0.989267, train_metric nan, valid_metric 0.088662
[4142451:MainThread](2024-04-06 16:32:24,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.997526, valid_loss 0.988799, train_metric nan, valid_metric 0.094460
[4142451:MainThread](2024-04-06 16:32:24,289) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.980747, valid_loss 0.990083, train_metric nan, valid_metric 0.086546
[4142451:MainThread](2024-04-06 16:32:24,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.975160, valid_loss 0.990614, train_metric nan, valid_metric 0.083385
[4142451:MainThread](2024-04-06 16:32:24,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.983562, valid_loss 0.989169, train_metric nan, valid_metric 0.093974
[4142451:MainThread](2024-04-06 16:32:24,737) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.993824, valid_loss 0.990444, train_metric nan, valid_metric 0.099762
[4142451:MainThread](2024-04-06 16:32:24,894) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.985957, valid_loss 0.989705, train_metric nan, valid_metric 0.090094
[4142451:MainThread](2024-04-06 16:32:25,030) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.986117, valid_loss 0.989534, train_metric nan, valid_metric 0.091575
[4142451:MainThread](2024-04-06 16:32:25,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.979225, valid_loss 0.991003, train_metric nan, valid_metric 0.081953
[4142451:MainThread](2024-04-06 16:32:25,305) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.975602, valid_loss 0.990086, train_metric nan, valid_metric 0.090620
[4142451:MainThread](2024-04-06 16:32:25,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.983549, valid_loss 0.988512, train_metric nan, valid_metric 0.105706
[4142451:MainThread](2024-04-06 16:32:25,646) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.971552, valid_loss 0.987148, train_metric nan, valid_metric 0.105786
[4142451:MainThread](2024-04-06 16:32:25,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.987496, valid_loss 0.988703, train_metric nan, valid_metric 0.093508
[4142451:MainThread](2024-04-06 16:32:25,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.978153, valid_loss 0.989602, train_metric nan, valid_metric 0.087233
[4142451:MainThread](2024-04-06 16:32:26,114) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.983611, valid_loss 0.989518, train_metric nan, valid_metric 0.091421
[4142451:MainThread](2024-04-06 16:32:26,261) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.979511, valid_loss 0.989119, train_metric nan, valid_metric 0.090658
[4142451:MainThread](2024-04-06 16:32:26,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.989092, valid_loss 0.989245, train_metric nan, valid_metric 0.092254
[4142451:MainThread](2024-04-06 16:32:26,551) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.971616, valid_loss 0.988323, train_metric nan, valid_metric 0.102130
[4142451:MainThread](2024-04-06 16:32:26,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.983022, valid_loss 0.990530, train_metric nan, valid_metric 0.086316
[4142451:MainThread](2024-04-06 16:32:26,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.988159, valid_loss 0.989450, train_metric nan, valid_metric 0.087475
[4142451:MainThread](2024-04-06 16:32:26,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.984489, valid_loss 0.989156, train_metric nan, valid_metric 0.096388
[4142451:MainThread](2024-04-06 16:32:27,125) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.977839, valid_loss 0.991499, train_metric nan, valid_metric 0.086763
[4142451:MainThread](2024-04-06 16:32:27,268) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.985822, valid_loss 0.991750, train_metric nan, valid_metric 0.083453
[4142451:MainThread](2024-04-06 16:32:27,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.982900, valid_loss 0.989552, train_metric nan, valid_metric 0.092749
[4142451:MainThread](2024-04-06 16:32:27,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.982968, valid_loss 0.990092, train_metric nan, valid_metric 0.087889
[4142451:MainThread](2024-04-06 16:32:27,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.978839, valid_loss 0.989261, train_metric nan, valid_metric 0.091544
[4142451:MainThread](2024-04-06 16:32:27,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.975729, valid_loss 0.989116, train_metric nan, valid_metric 0.092908
[4142451:MainThread](2024-04-06 16:32:27,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.979815, valid_loss 0.989265, train_metric nan, valid_metric 0.091873
[4142451:MainThread](2024-04-06 16:32:28,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.987311, valid_loss 0.989393, train_metric nan, valid_metric 0.092044
[4142451:MainThread](2024-04-06 16:32:28,140) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:32:28,959) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:32:29,824) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  75%|███████▌  | 39/52 [12:54<04:18, 19.91s/it][4142451:MainThread](2024-04-06 16:32:29,832) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:32:29,842) INFO - qlib.workflow - [recorder.py:341] - Recorder 94f7919b829f41048e6e1c059af54e32 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:32:30,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:32:30,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:32:30,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:32:30,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:32:33,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:32:34,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.296968, valid_loss 1.153003, train_metric nan, valid_metric 0.026806
[4142451:MainThread](2024-04-06 16:32:34,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.153003, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:32:34,505) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.144267, valid_loss 1.018618, train_metric nan, valid_metric 0.062655
[4142451:MainThread](2024-04-06 16:32:34,505) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.153003 to 1.018618, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:34,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.079974, valid_loss 1.004502, train_metric nan, valid_metric 0.068747
[4142451:MainThread](2024-04-06 16:32:34,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.018618 to 1.004502, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:34,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.062068, valid_loss 0.996200, train_metric nan, valid_metric 0.078433
[4142451:MainThread](2024-04-06 16:32:34,838) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.004502 to 0.996200, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:34,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.041012, valid_loss 1.005785, train_metric nan, valid_metric 0.039552
[4142451:MainThread](2024-04-06 16:32:35,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.036579, valid_loss 0.998075, train_metric nan, valid_metric 0.063307
[4142451:MainThread](2024-04-06 16:32:35,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.030812, valid_loss 0.999726, train_metric nan, valid_metric 0.075528
[4142451:MainThread](2024-04-06 16:32:35,415) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.042925, valid_loss 1.003865, train_metric nan, valid_metric 0.073097
[4142451:MainThread](2024-04-06 16:32:35,582) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.070702, valid_loss 0.995365, train_metric nan, valid_metric 0.070271
[4142451:MainThread](2024-04-06 16:32:35,582) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996200 to 0.995365, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:35,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.027036, valid_loss 1.003099, train_metric nan, valid_metric 0.087645
[4142451:MainThread](2024-04-06 16:32:35,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.010398, valid_loss 0.999163, train_metric nan, valid_metric 0.053936
[4142451:MainThread](2024-04-06 16:32:36,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.015623, valid_loss 1.006731, train_metric nan, valid_metric 0.049363
[4142451:MainThread](2024-04-06 16:32:36,154) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.999824, valid_loss 0.998713, train_metric nan, valid_metric 0.044299
[4142451:MainThread](2024-04-06 16:32:36,305) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.007284, valid_loss 0.989816, train_metric nan, valid_metric 0.084436
[4142451:MainThread](2024-04-06 16:32:36,306) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995365 to 0.989816, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:36,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.014327, valid_loss 0.992250, train_metric nan, valid_metric 0.082941
[4142451:MainThread](2024-04-06 16:32:36,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.019462, valid_loss 0.998093, train_metric nan, valid_metric 0.077995
[4142451:MainThread](2024-04-06 16:32:36,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.002028, valid_loss 1.025911, train_metric nan, valid_metric 0.067683
[4142451:MainThread](2024-04-06 16:32:36,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.009044, valid_loss 1.003655, train_metric nan, valid_metric 0.023653
[4142451:MainThread](2024-04-06 16:32:37,052) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.997410, valid_loss 0.993514, train_metric nan, valid_metric 0.065965
[4142451:MainThread](2024-04-06 16:32:37,191) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.996737, valid_loss 0.996613, train_metric nan, valid_metric 0.066053
[4142451:MainThread](2024-04-06 16:32:37,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.005435, valid_loss 0.993225, train_metric nan, valid_metric 0.066138
[4142451:MainThread](2024-04-06 16:32:37,453) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.999089, valid_loss 0.994843, train_metric nan, valid_metric 0.066699
[4142451:MainThread](2024-04-06 16:32:37,590) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.988993, valid_loss 0.992351, train_metric nan, valid_metric 0.087212
[4142451:MainThread](2024-04-06 16:32:37,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.995704, valid_loss 0.990947, train_metric nan, valid_metric 0.082708
[4142451:MainThread](2024-04-06 16:32:37,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.989995, valid_loss 0.994354, train_metric nan, valid_metric 0.069024
[4142451:MainThread](2024-04-06 16:32:38,016) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.981732, valid_loss 0.992881, train_metric nan, valid_metric 0.068714
[4142451:MainThread](2024-04-06 16:32:38,161) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.998086, valid_loss 0.991355, train_metric nan, valid_metric 0.077307
[4142451:MainThread](2024-04-06 16:32:38,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.988058, valid_loss 0.992176, train_metric nan, valid_metric 0.073478
[4142451:MainThread](2024-04-06 16:32:38,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.992940, valid_loss 0.990441, train_metric nan, valid_metric 0.080580
[4142451:MainThread](2024-04-06 16:32:38,593) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.988803, valid_loss 0.990692, train_metric nan, valid_metric 0.076229
[4142451:MainThread](2024-04-06 16:32:38,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.986536, valid_loss 0.992752, train_metric nan, valid_metric 0.082482
[4142451:MainThread](2024-04-06 16:32:38,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.987962, valid_loss 0.991353, train_metric nan, valid_metric 0.083199
[4142451:MainThread](2024-04-06 16:32:39,031) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.990079, valid_loss 0.994289, train_metric nan, valid_metric 0.065989
[4142451:MainThread](2024-04-06 16:32:39,172) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.986912, valid_loss 0.990305, train_metric nan, valid_metric 0.084860
[4142451:MainThread](2024-04-06 16:32:39,320) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.983460, valid_loss 0.991910, train_metric nan, valid_metric 0.072506
[4142451:MainThread](2024-04-06 16:32:39,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.988212, valid_loss 0.989738, train_metric nan, valid_metric 0.086622
[4142451:MainThread](2024-04-06 16:32:39,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.989816 to 0.989738, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:39,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.990759, valid_loss 0.990935, train_metric nan, valid_metric 0.078065
[4142451:MainThread](2024-04-06 16:32:39,759) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.993061, valid_loss 0.991733, train_metric nan, valid_metric 0.076316
[4142451:MainThread](2024-04-06 16:32:39,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.998050, valid_loss 0.990053, train_metric nan, valid_metric 0.080679
[4142451:MainThread](2024-04-06 16:32:40,052) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.990129, valid_loss 0.991377, train_metric nan, valid_metric 0.076488
[4142451:MainThread](2024-04-06 16:32:40,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.976012, valid_loss 0.992398, train_metric nan, valid_metric 0.071732
[4142451:MainThread](2024-04-06 16:32:40,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.988027, valid_loss 0.991656, train_metric nan, valid_metric 0.072875
[4142451:MainThread](2024-04-06 16:32:40,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.986585, valid_loss 0.991390, train_metric nan, valid_metric 0.073846
[4142451:MainThread](2024-04-06 16:32:40,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.988207, valid_loss 0.993956, train_metric nan, valid_metric 0.063988
[4142451:MainThread](2024-04-06 16:32:40,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.990379, valid_loss 0.989624, train_metric nan, valid_metric 0.083770
[4142451:MainThread](2024-04-06 16:32:40,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.989738 to 0.989624, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:40,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.986902, valid_loss 0.988117, train_metric nan, valid_metric 0.090279
[4142451:MainThread](2024-04-06 16:32:40,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.989624 to 0.988117, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:41,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.991001, valid_loss 0.991602, train_metric nan, valid_metric 0.084947
[4142451:MainThread](2024-04-06 16:32:41,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.974739, valid_loss 0.990655, train_metric nan, valid_metric 0.078278
[4142451:MainThread](2024-04-06 16:32:41,335) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.997290, valid_loss 0.993952, train_metric nan, valid_metric 0.060675
[4142451:MainThread](2024-04-06 16:32:41,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.002713, valid_loss 0.992669, train_metric nan, valid_metric 0.068046
[4142451:MainThread](2024-04-06 16:32:41,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.986890, valid_loss 0.992840, train_metric nan, valid_metric 0.066640
[4142451:MainThread](2024-04-06 16:32:41,771) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.991731, valid_loss 0.988268, train_metric nan, valid_metric 0.096152
[4142451:MainThread](2024-04-06 16:32:41,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.988813, valid_loss 0.990467, train_metric nan, valid_metric 0.093585
[4142451:MainThread](2024-04-06 16:32:42,064) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.983294, valid_loss 0.988263, train_metric nan, valid_metric 0.089585
[4142451:MainThread](2024-04-06 16:32:42,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.984478, valid_loss 0.990398, train_metric nan, valid_metric 0.077803
[4142451:MainThread](2024-04-06 16:32:42,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.986678, valid_loss 0.989834, train_metric nan, valid_metric 0.080152
[4142451:MainThread](2024-04-06 16:32:42,477) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.986389, valid_loss 0.992274, train_metric nan, valid_metric 0.071538
[4142451:MainThread](2024-04-06 16:32:42,621) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.995002, valid_loss 0.992360, train_metric nan, valid_metric 0.078886
[4142451:MainThread](2024-04-06 16:32:42,765) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.990372, valid_loss 0.992535, train_metric nan, valid_metric 0.070033
[4142451:MainThread](2024-04-06 16:32:42,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.987776, valid_loss 0.990679, train_metric nan, valid_metric 0.077024
[4142451:MainThread](2024-04-06 16:32:43,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.979793, valid_loss 0.991233, train_metric nan, valid_metric 0.073235
[4142451:MainThread](2024-04-06 16:32:43,184) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.993097, valid_loss 0.991861, train_metric nan, valid_metric 0.071577
[4142451:MainThread](2024-04-06 16:32:43,326) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.986646, valid_loss 0.991401, train_metric nan, valid_metric 0.080503
[4142451:MainThread](2024-04-06 16:32:43,471) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.984992, valid_loss 0.991629, train_metric nan, valid_metric 0.072315
[4142451:MainThread](2024-04-06 16:32:43,621) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.987576, valid_loss 0.991023, train_metric nan, valid_metric 0.076821
[4142451:MainThread](2024-04-06 16:32:43,765) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.985797, valid_loss 0.991809, train_metric nan, valid_metric 0.074415
[4142451:MainThread](2024-04-06 16:32:43,914) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.985491, valid_loss 0.990263, train_metric nan, valid_metric 0.081424
[4142451:MainThread](2024-04-06 16:32:44,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.987638, valid_loss 0.991484, train_metric nan, valid_metric 0.074724
[4142451:MainThread](2024-04-06 16:32:44,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.986759, valid_loss 0.990445, train_metric nan, valid_metric 0.083773
[4142451:MainThread](2024-04-06 16:32:44,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.983890, valid_loss 0.991283, train_metric nan, valid_metric 0.075659
[4142451:MainThread](2024-04-06 16:32:44,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.992207, valid_loss 0.990148, train_metric nan, valid_metric 0.082657
[4142451:MainThread](2024-04-06 16:32:44,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.979774, valid_loss 0.989948, train_metric nan, valid_metric 0.085435
[4142451:MainThread](2024-04-06 16:32:44,830) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.982748, valid_loss 0.989692, train_metric nan, valid_metric 0.087359
[4142451:MainThread](2024-04-06 16:32:44,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.987819, valid_loss 0.990987, train_metric nan, valid_metric 0.075913
[4142451:MainThread](2024-04-06 16:32:45,171) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.978103, valid_loss 0.991623, train_metric nan, valid_metric 0.073261
[4142451:MainThread](2024-04-06 16:32:45,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.993960, valid_loss 0.992637, train_metric nan, valid_metric 0.070410
[4142451:MainThread](2024-04-06 16:32:45,463) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.989845, valid_loss 0.991311, train_metric nan, valid_metric 0.077502
[4142451:MainThread](2024-04-06 16:32:45,628) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.984120, valid_loss 0.991066, train_metric nan, valid_metric 0.075567
[4142451:MainThread](2024-04-06 16:32:45,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.991910, valid_loss 0.991440, train_metric nan, valid_metric 0.073699
[4142451:MainThread](2024-04-06 16:32:45,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.986951, valid_loss 0.990825, train_metric nan, valid_metric 0.077616
[4142451:MainThread](2024-04-06 16:32:46,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.990460, valid_loss 0.990091, train_metric nan, valid_metric 0.081656
[4142451:MainThread](2024-04-06 16:32:46,184) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.985957, valid_loss 0.990466, train_metric nan, valid_metric 0.080473
[4142451:MainThread](2024-04-06 16:32:46,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.988289, valid_loss 0.991088, train_metric nan, valid_metric 0.076408
[4142451:MainThread](2024-04-06 16:32:46,452) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.982176, valid_loss 0.990131, train_metric nan, valid_metric 0.082513
[4142451:MainThread](2024-04-06 16:32:46,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.983678, valid_loss 0.991073, train_metric nan, valid_metric 0.076806
[4142451:MainThread](2024-04-06 16:32:46,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.993623, valid_loss 0.990722, train_metric nan, valid_metric 0.078275
[4142451:MainThread](2024-04-06 16:32:46,868) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.983813, valid_loss 0.991225, train_metric nan, valid_metric 0.075694
[4142451:MainThread](2024-04-06 16:32:47,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.986610, valid_loss 0.992059, train_metric nan, valid_metric 0.071549
[4142451:MainThread](2024-04-06 16:32:47,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.986128, valid_loss 0.991909, train_metric nan, valid_metric 0.074220
[4142451:MainThread](2024-04-06 16:32:47,354) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.986844, valid_loss 0.990831, train_metric nan, valid_metric 0.079427
[4142451:MainThread](2024-04-06 16:32:47,511) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.981607, valid_loss 0.991608, train_metric nan, valid_metric 0.074819
[4142451:MainThread](2024-04-06 16:32:47,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.990263, valid_loss 0.990809, train_metric nan, valid_metric 0.077609
[4142451:MainThread](2024-04-06 16:32:47,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.992601, valid_loss 0.990749, train_metric nan, valid_metric 0.078028
[4142451:MainThread](2024-04-06 16:32:47,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.992233, valid_loss 0.990282, train_metric nan, valid_metric 0.082359
[4142451:MainThread](2024-04-06 16:32:48,091) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.991918, valid_loss 0.991751, train_metric nan, valid_metric 0.076468
[4142451:MainThread](2024-04-06 16:32:48,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.991147, valid_loss 0.989162, train_metric nan, valid_metric 0.087995
[4142451:MainThread](2024-04-06 16:32:48,223) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:32:49,075) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
Epoch  1200: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1460: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1680: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1900: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2120: reducing learning rate of group 0 to 1.5625e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-02-28 SH600000   -0.005885
           SH600009    0.083087
           SH600010   -0.021360
           SH600011   -0.028993
           SH600015   -0.070394
Epoch   580: reducing learning rate of group 0 to 1.0000e-03.
Epoch   800: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1020: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1240: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-03-28 SH600000    0.039437
           SH600009    0.108830
           SH600010    0.012831
           SH600011    0.093159
           SH600015    0.152600
Epoch   760: reducing learning rate of group 0 to 1.0000e-03.
Epoch   980: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1200: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1420: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-04-27 SH600000    0.095730
           SH600009    0.107942
           SH600010    0.133711
           SH600011    0.085214
           SH600015    0.011285
Epoch   620: reducing learning rate of group 0 to 1.0000e-03.
Epoch   840: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1060: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1280: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-05-30 SH600000   -0.026110
           SH600009    0.061201
           SH600010   -0.041392
           SH600011   -0.063473
           SH600015    0.046117
Epoch   740: reducing learning rate of group 0 to 1.0000e-03.
Epoch   960: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1180: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1620: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1840: reducing learning rate of group 0 to 6.2500e-05.
Epoch  2060: reducing learning rate of group 0 to 3.1250e-05.
Epoch  2280: reducing learning rate of group 0 to 1.5625e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-06-28 SH600000    0.083861
           SH600009   -0.007998
           SH600010   -0.101168
           SH600011    0.100438
           SH600015    0.008367
Epoch   780: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1120: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1340: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1560: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1780: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-07-26 SH600000    0.022606
           SH600009   -0.072750
           SH600010   -0.046860
           SH600011    0.038497
           SH600015    0.144715
Epoch   620: reducing learning rate of group 0 to 1.0000e-03.
Epoch   840: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1060: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1280: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-08-23 SH600000    0.013126
           SH600009    0.131291
           SH600010    0.010430
           SH600011    0.022215
           SH600015    0.019789
Epoch   680: reducing learning rate of group 0 to 1.0000e-03.
Epoch   900: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1120: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1340: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-09-21 SH600000   -0.109481
           SH600009    0.029253
           SH600010    0.011019
           SH600011    0.038804
           SH600015   -0.061610
Epoch   500: reducing learning rate of group 0 to 1.0000e-03.
Epoch   720: reducing learning rate of group 0 to 5.0000e-04.
Epoch   940: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1160: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-10-26 SH600000   -0.024887
           SH600009   -0.037123
           SH600010    0.060457
           SH600011    0.011304
           SH600015   -0.016587
Epoch   460: reducing learning rate of group 0 to 1.0000e-03.
Epoch   780: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1220: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1440: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1660: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1880: reducing learning rate of group 0 to 3.1250e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-11-23 SH600000   -0.025395
           SH600009   -0.017937
           SH600010   -0.155202
           SH600011    0.095385
           SH600015   -0.007561
Epoch   800: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1020: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1240: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1460: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2022-12-21 SH600000    0.013982
           SH600009    0.177515
           SH600010   -0.189077
           SH600011   -0.021139
           SH600015   -0.057332
Epoch   540: reducing learning rate of group 0 to 1.0000e-03.
Epoch   840: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1360: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1580: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1800: reducing learning rate of group 0 to 6.2500e-05.
Epoch  2020: reducing learning rate of group 0 to 3.1250e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-01-19 SH600000    0.053808
           SH600009   -0.042833
           SH600010   -0.057583
           SH600011   -0.098930
           SH600015    0.045817
Epoch  1040: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1260: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1480: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1700: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-02-23 SH600000   -0.013868
           SH600009    0.078701
           SH600010   -0.042625
           SH600011    0.227180
           SH600015    0.015445
Epoch   500: reducing learning rate of group 0 to 1.0000e-03.
Epoch   720: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1140: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1360: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1580: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1800: reducing learning rate of group 0 to 3.1250e-05.
'The following are prediction results of the DNNModelPytorch model.'
[4142451:MainThread](2024-04-06 16:32:49,944) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  77%|███████▋  | 40/52 [13:14<03:59, 19.97s/it][4142451:MainThread](2024-04-06 16:32:49,953) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:32:49,963) INFO - qlib.workflow - [recorder.py:341] - Recorder eca4d952502146fc915b6582aa20ab6e starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:32:50,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:32:50,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:32:50,718) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:32:50,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:32:54,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:32:54,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.240203, valid_loss 1.051849, train_metric nan, valid_metric 0.024569
[4142451:MainThread](2024-04-06 16:32:54,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.051849, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:32:54,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.101569, valid_loss 1.050720, train_metric nan, valid_metric 0.036520
[4142451:MainThread](2024-04-06 16:32:54,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.051849 to 1.050720, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:55,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.049403, valid_loss 1.036788, train_metric nan, valid_metric 0.034469
[4142451:MainThread](2024-04-06 16:32:55,082) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.050720 to 1.036788, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:55,227) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.036135, valid_loss 1.007943, train_metric nan, valid_metric 0.046610
[4142451:MainThread](2024-04-06 16:32:55,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.036788 to 1.007943, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:55,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.037170, valid_loss 1.018574, train_metric nan, valid_metric 0.051262
[4142451:MainThread](2024-04-06 16:32:55,505) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.034848, valid_loss 1.006857, train_metric nan, valid_metric 0.044067
[4142451:MainThread](2024-04-06 16:32:55,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.007943 to 1.006857, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:55,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.026401, valid_loss 0.996080, train_metric nan, valid_metric 0.067428
[4142451:MainThread](2024-04-06 16:32:55,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006857 to 0.996080, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:55,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.026083, valid_loss 1.016714, train_metric nan, valid_metric 0.022335
[4142451:MainThread](2024-04-06 16:32:55,985) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.064991, valid_loss 1.054868, train_metric nan, valid_metric 0.050966
[4142451:MainThread](2024-04-06 16:32:56,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.030503, valid_loss 0.996742, train_metric nan, valid_metric 0.069387
[4142451:MainThread](2024-04-06 16:32:56,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.045984, valid_loss 1.022626, train_metric nan, valid_metric 0.056432
[4142451:MainThread](2024-04-06 16:32:56,394) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.049367, valid_loss 1.003577, train_metric nan, valid_metric 0.059458
[4142451:MainThread](2024-04-06 16:32:56,533) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.014834, valid_loss 0.996800, train_metric nan, valid_metric 0.078464
[4142451:MainThread](2024-04-06 16:32:56,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.006661, valid_loss 0.993853, train_metric nan, valid_metric 0.065971
[4142451:MainThread](2024-04-06 16:32:56,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996080 to 0.993853, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:56,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.018021, valid_loss 0.992932, train_metric nan, valid_metric 0.065741
[4142451:MainThread](2024-04-06 16:32:56,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993853 to 0.992932, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:57,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.995827, valid_loss 1.001343, train_metric nan, valid_metric 0.060003
[4142451:MainThread](2024-04-06 16:32:57,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.003699, valid_loss 0.998105, train_metric nan, valid_metric 0.049970
[4142451:MainThread](2024-04-06 16:32:57,385) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.988008, valid_loss 0.997791, train_metric nan, valid_metric 0.055720
[4142451:MainThread](2024-04-06 16:32:57,551) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.997066, valid_loss 0.998021, train_metric nan, valid_metric 0.061751
[4142451:MainThread](2024-04-06 16:32:57,690) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.981813, valid_loss 0.996127, train_metric nan, valid_metric 0.054292
[4142451:MainThread](2024-04-06 16:32:57,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.997717, valid_loss 0.991593, train_metric nan, valid_metric 0.068915
[4142451:MainThread](2024-04-06 16:32:57,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.992932 to 0.991593, save checkpoint.
[4142451:MainThread](2024-04-06 16:32:57,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.987863, valid_loss 0.996274, train_metric nan, valid_metric 0.057756
[4142451:MainThread](2024-04-06 16:32:58,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.990615, valid_loss 0.994195, train_metric nan, valid_metric 0.062160
[4142451:MainThread](2024-04-06 16:32:58,234) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.988573, valid_loss 0.992509, train_metric nan, valid_metric 0.069826
[4142451:MainThread](2024-04-06 16:32:58,375) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.987697, valid_loss 0.994442, train_metric nan, valid_metric 0.056490
[4142451:MainThread](2024-04-06 16:32:58,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.001484, valid_loss 0.993810, train_metric nan, valid_metric 0.063851
[4142451:MainThread](2024-04-06 16:32:58,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.992728, valid_loss 1.018106, train_metric nan, valid_metric 0.063873
[4142451:MainThread](2024-04-06 16:32:58,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.980293, valid_loss 0.995566, train_metric nan, valid_metric 0.063761
[4142451:MainThread](2024-04-06 16:32:58,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.995281, valid_loss 0.995232, train_metric nan, valid_metric 0.055847
[4142451:MainThread](2024-04-06 16:32:59,082) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.997288, valid_loss 0.998841, train_metric nan, valid_metric 0.062487
[4142451:MainThread](2024-04-06 16:32:59,233) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.983246, valid_loss 0.995279, train_metric nan, valid_metric 0.053166
[4142451:MainThread](2024-04-06 16:32:59,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.994677, valid_loss 0.994590, train_metric nan, valid_metric 0.054748
[4142451:MainThread](2024-04-06 16:32:59,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.989419, valid_loss 0.993924, train_metric nan, valid_metric 0.058525
[4142451:MainThread](2024-04-06 16:32:59,684) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.982471, valid_loss 0.995007, train_metric nan, valid_metric 0.065738
[4142451:MainThread](2024-04-06 16:32:59,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.986087, valid_loss 0.995080, train_metric nan, valid_metric 0.061129
[4142451:MainThread](2024-04-06 16:32:59,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.993839, valid_loss 0.992705, train_metric nan, valid_metric 0.061476
[4142451:MainThread](2024-04-06 16:33:00,120) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.998433, valid_loss 0.994080, train_metric nan, valid_metric 0.057987
[4142451:MainThread](2024-04-06 16:33:00,285) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.990552, valid_loss 0.993233, train_metric nan, valid_metric 0.060473
[4142451:MainThread](2024-04-06 16:33:00,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.994351, valid_loss 0.992926, train_metric nan, valid_metric 0.061605
[4142451:MainThread](2024-04-06 16:33:00,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.991966, valid_loss 0.995776, train_metric nan, valid_metric 0.048976
[4142451:MainThread](2024-04-06 16:33:00,738) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.994776, valid_loss 0.995789, train_metric nan, valid_metric 0.053990
[4142451:MainThread](2024-04-06 16:33:00,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.992764, valid_loss 0.993587, train_metric nan, valid_metric 0.059073
[4142451:MainThread](2024-04-06 16:33:01,034) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.980623, valid_loss 0.994228, train_metric nan, valid_metric 0.055968
[4142451:MainThread](2024-04-06 16:33:01,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.984816, valid_loss 0.992857, train_metric nan, valid_metric 0.060610
[4142451:MainThread](2024-04-06 16:33:01,322) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.983949, valid_loss 0.995664, train_metric nan, valid_metric 0.054844
[4142451:MainThread](2024-04-06 16:33:01,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.985889, valid_loss 0.994838, train_metric nan, valid_metric 0.055586
[4142451:MainThread](2024-04-06 16:33:01,611) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.986498, valid_loss 0.995698, train_metric nan, valid_metric 0.061202
[4142451:MainThread](2024-04-06 16:33:01,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.981623, valid_loss 0.994391, train_metric nan, valid_metric 0.063540
[4142451:MainThread](2024-04-06 16:33:01,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.983949, valid_loss 0.993095, train_metric nan, valid_metric 0.061199
[4142451:MainThread](2024-04-06 16:33:02,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.989626, valid_loss 0.992455, train_metric nan, valid_metric 0.065071
[4142451:MainThread](2024-04-06 16:33:02,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.993784, valid_loss 0.991804, train_metric nan, valid_metric 0.066380
[4142451:MainThread](2024-04-06 16:33:02,403) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.981638, valid_loss 0.992944, train_metric nan, valid_metric 0.072141
[4142451:MainThread](2024-04-06 16:33:02,578) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.990122, valid_loss 0.993430, train_metric nan, valid_metric 0.058596
[4142451:MainThread](2024-04-06 16:33:02,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.991936, valid_loss 0.993515, train_metric nan, valid_metric 0.060146
[4142451:MainThread](2024-04-06 16:33:02,897) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.982681, valid_loss 0.994680, train_metric nan, valid_metric 0.060101
[4142451:MainThread](2024-04-06 16:33:03,037) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.992049, valid_loss 0.994624, train_metric nan, valid_metric 0.059074
[4142451:MainThread](2024-04-06 16:33:03,175) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.991171, valid_loss 0.994026, train_metric nan, valid_metric 0.061602
[4142451:MainThread](2024-04-06 16:33:03,320) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.990391, valid_loss 0.995142, train_metric nan, valid_metric 0.055058
[4142451:MainThread](2024-04-06 16:33:03,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.989609, valid_loss 0.994822, train_metric nan, valid_metric 0.054187
[4142451:MainThread](2024-04-06 16:33:03,602) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.992264, valid_loss 0.994109, train_metric nan, valid_metric 0.058117
[4142451:MainThread](2024-04-06 16:33:03,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.989112, valid_loss 0.993080, train_metric nan, valid_metric 0.061892
[4142451:MainThread](2024-04-06 16:33:03,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.991185, valid_loss 0.993189, train_metric nan, valid_metric 0.060531
[4142451:MainThread](2024-04-06 16:33:04,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.979532, valid_loss 0.992143, train_metric nan, valid_metric 0.066953
[4142451:MainThread](2024-04-06 16:33:04,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.982543, valid_loss 0.992980, train_metric nan, valid_metric 0.062243
[4142451:MainThread](2024-04-06 16:33:04,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.984310, valid_loss 0.992041, train_metric nan, valid_metric 0.064428
[4142451:MainThread](2024-04-06 16:33:04,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.982056, valid_loss 0.993621, train_metric nan, valid_metric 0.059291
[4142451:MainThread](2024-04-06 16:33:04,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.987056, valid_loss 0.992377, train_metric nan, valid_metric 0.063902
[4142451:MainThread](2024-04-06 16:33:04,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.989486, valid_loss 0.993039, train_metric nan, valid_metric 0.061877
[4142451:MainThread](2024-04-06 16:33:05,065) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.994805, valid_loss 0.992853, train_metric nan, valid_metric 0.061737
[4142451:MainThread](2024-04-06 16:33:05,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.978386, valid_loss 0.993866, train_metric nan, valid_metric 0.058736
[4142451:MainThread](2024-04-06 16:33:05,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.991563, valid_loss 0.994279, train_metric nan, valid_metric 0.058069
[4142451:MainThread](2024-04-06 16:33:05,380) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:33:06,519) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:33:07,393) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  79%|███████▉  | 41/52 [13:31<03:31, 19.21s/it][4142451:MainThread](2024-04-06 16:33:07,402) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:33:07,422) INFO - qlib.workflow - [recorder.py:341] - Recorder 226062bc4d2844c68c56de62f89f802f starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:33:08,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:33:08,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:33:08,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:33:08,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:33:11,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:33:11,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.339226, valid_loss 1.049398, train_metric nan, valid_metric 0.010852
[4142451:MainThread](2024-04-06 16:33:11,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.049398, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:33:11,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.112534, valid_loss 1.026706, train_metric nan, valid_metric 0.025485
[4142451:MainThread](2024-04-06 16:33:11,962) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.049398 to 1.026706, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:12,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.062330, valid_loss 1.011691, train_metric nan, valid_metric 0.033514
[4142451:MainThread](2024-04-06 16:33:12,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.026706 to 1.011691, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:12,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.052090, valid_loss 1.032260, train_metric nan, valid_metric 0.042400
[4142451:MainThread](2024-04-06 16:33:12,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.044457, valid_loss 1.000951, train_metric nan, valid_metric 0.052738
[4142451:MainThread](2024-04-06 16:33:12,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.011691 to 1.000951, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:12,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.021264, valid_loss 1.001298, train_metric nan, valid_metric 0.050034
[4142451:MainThread](2024-04-06 16:33:12,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.029099, valid_loss 0.998588, train_metric nan, valid_metric 0.054832
[4142451:MainThread](2024-04-06 16:33:12,701) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000951 to 0.998588, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:12,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.025335, valid_loss 1.003193, train_metric nan, valid_metric 0.035335
[4142451:MainThread](2024-04-06 16:33:13,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.005724, valid_loss 1.003658, train_metric nan, valid_metric 0.046547
[4142451:MainThread](2024-04-06 16:33:13,148) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.019763, valid_loss 0.999981, train_metric nan, valid_metric 0.040601
[4142451:MainThread](2024-04-06 16:33:13,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.002746, valid_loss 1.031770, train_metric nan, valid_metric 0.026854
[4142451:MainThread](2024-04-06 16:33:13,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.008697, valid_loss 0.996927, train_metric nan, valid_metric 0.051856
[4142451:MainThread](2024-04-06 16:33:13,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998588 to 0.996927, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:13,586) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.015942, valid_loss 1.003765, train_metric nan, valid_metric 0.027643
[4142451:MainThread](2024-04-06 16:33:13,754) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.008256, valid_loss 1.015523, train_metric nan, valid_metric 0.047474
[4142451:MainThread](2024-04-06 16:33:13,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.996032, valid_loss 1.001750, train_metric nan, valid_metric 0.035776
[4142451:MainThread](2024-04-06 16:33:14,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.011031, valid_loss 0.997725, train_metric nan, valid_metric 0.047491
[4142451:MainThread](2024-04-06 16:33:14,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.001547, valid_loss 1.008626, train_metric nan, valid_metric 0.033194
[4142451:MainThread](2024-04-06 16:33:14,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.995686, valid_loss 0.997016, train_metric nan, valid_metric 0.054604
[4142451:MainThread](2024-04-06 16:33:14,516) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.985517, valid_loss 0.997542, train_metric nan, valid_metric 0.056573
[4142451:MainThread](2024-04-06 16:33:14,666) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.000920, valid_loss 0.996934, train_metric nan, valid_metric 0.047950
[4142451:MainThread](2024-04-06 16:33:14,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.999786, valid_loss 1.001602, train_metric nan, valid_metric 0.049484
[4142451:MainThread](2024-04-06 16:33:14,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.991044, valid_loss 0.997460, train_metric nan, valid_metric 0.040842
[4142451:MainThread](2024-04-06 16:33:15,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.990326, valid_loss 0.995396, train_metric nan, valid_metric 0.051709
[4142451:MainThread](2024-04-06 16:33:15,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996927 to 0.995396, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:15,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.992514, valid_loss 0.997098, train_metric nan, valid_metric 0.049840
[4142451:MainThread](2024-04-06 16:33:15,396) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.992338, valid_loss 0.994815, train_metric nan, valid_metric 0.050814
[4142451:MainThread](2024-04-06 16:33:15,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995396 to 0.994815, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:15,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.988709, valid_loss 1.000636, train_metric nan, valid_metric 0.045195
[4142451:MainThread](2024-04-06 16:33:15,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.989852, valid_loss 0.995864, train_metric nan, valid_metric 0.051039
[4142451:MainThread](2024-04-06 16:33:15,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.988810, valid_loss 1.000854, train_metric nan, valid_metric 0.029929
[4142451:MainThread](2024-04-06 16:33:15,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.987256, valid_loss 0.998059, train_metric nan, valid_metric 0.053390
[4142451:MainThread](2024-04-06 16:33:16,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.999040, valid_loss 0.995601, train_metric nan, valid_metric 0.044803
[4142451:MainThread](2024-04-06 16:33:16,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.994918, valid_loss 0.998819, train_metric nan, valid_metric 0.042714
[4142451:MainThread](2024-04-06 16:33:16,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.998832, valid_loss 1.005965, train_metric nan, valid_metric 0.040371
[4142451:MainThread](2024-04-06 16:33:16,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.992796, valid_loss 0.995811, train_metric nan, valid_metric 0.037494
[4142451:MainThread](2024-04-06 16:33:16,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.992594, valid_loss 0.994396, train_metric nan, valid_metric 0.055763
[4142451:MainThread](2024-04-06 16:33:16,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994815 to 0.994396, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:16,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.981807, valid_loss 0.995646, train_metric nan, valid_metric 0.049587
[4142451:MainThread](2024-04-06 16:33:17,008) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.994755, valid_loss 0.995761, train_metric nan, valid_metric 0.045720
[4142451:MainThread](2024-04-06 16:33:17,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.989821, valid_loss 0.994824, train_metric nan, valid_metric 0.049456
[4142451:MainThread](2024-04-06 16:33:17,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.987272, valid_loss 0.995934, train_metric nan, valid_metric 0.046893
[4142451:MainThread](2024-04-06 16:33:17,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.994608, valid_loss 0.995568, train_metric nan, valid_metric 0.050506
[4142451:MainThread](2024-04-06 16:33:17,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.991234, valid_loss 0.994966, train_metric nan, valid_metric 0.047441
[4142451:MainThread](2024-04-06 16:33:17,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.991896, valid_loss 0.996790, train_metric nan, valid_metric 0.039071
[4142451:MainThread](2024-04-06 16:33:17,878) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.985394, valid_loss 0.995407, train_metric nan, valid_metric 0.046356
[4142451:MainThread](2024-04-06 16:33:18,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.991532, valid_loss 0.994112, train_metric nan, valid_metric 0.051776
[4142451:MainThread](2024-04-06 16:33:18,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994396 to 0.994112, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:18,175) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.996916, valid_loss 0.996689, train_metric nan, valid_metric 0.038738
[4142451:MainThread](2024-04-06 16:33:18,327) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.990491, valid_loss 0.994454, train_metric nan, valid_metric 0.052142
[4142451:MainThread](2024-04-06 16:33:18,463) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.984598, valid_loss 0.994854, train_metric nan, valid_metric 0.050454
[4142451:MainThread](2024-04-06 16:33:18,607) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.987707, valid_loss 0.995363, train_metric nan, valid_metric 0.048175
[4142451:MainThread](2024-04-06 16:33:18,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.989434, valid_loss 0.996144, train_metric nan, valid_metric 0.048582
[4142451:MainThread](2024-04-06 16:33:18,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.989635, valid_loss 0.993626, train_metric nan, valid_metric 0.055343
[4142451:MainThread](2024-04-06 16:33:18,897) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994112 to 0.993626, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:19,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.986736, valid_loss 0.995512, train_metric nan, valid_metric 0.050688
[4142451:MainThread](2024-04-06 16:33:19,180) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.985006, valid_loss 0.996388, train_metric nan, valid_metric 0.043390
[4142451:MainThread](2024-04-06 16:33:19,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.976387, valid_loss 1.002048, train_metric nan, valid_metric 0.046851
[4142451:MainThread](2024-04-06 16:33:19,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.987812, valid_loss 0.996242, train_metric nan, valid_metric 0.049428
[4142451:MainThread](2024-04-06 16:33:19,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.991667, valid_loss 0.994852, train_metric nan, valid_metric 0.051535
[4142451:MainThread](2024-04-06 16:33:19,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.994070, valid_loss 0.996799, train_metric nan, valid_metric 0.042595
[4142451:MainThread](2024-04-06 16:33:19,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.987238, valid_loss 0.994897, train_metric nan, valid_metric 0.052422
[4142451:MainThread](2024-04-06 16:33:20,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.983072, valid_loss 0.994765, train_metric nan, valid_metric 0.054972
[4142451:MainThread](2024-04-06 16:33:20,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.993662, valid_loss 0.994626, train_metric nan, valid_metric 0.048504
[4142451:MainThread](2024-04-06 16:33:20,374) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.987089, valid_loss 0.995075, train_metric nan, valid_metric 0.047279
[4142451:MainThread](2024-04-06 16:33:20,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.986300, valid_loss 0.997354, train_metric nan, valid_metric 0.051693
[4142451:MainThread](2024-04-06 16:33:20,661) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.984581, valid_loss 0.997013, train_metric nan, valid_metric 0.044326
[4142451:MainThread](2024-04-06 16:33:20,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.984374, valid_loss 0.996549, train_metric nan, valid_metric 0.045137
[4142451:MainThread](2024-04-06 16:33:20,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.979464, valid_loss 0.995527, train_metric nan, valid_metric 0.045731
[4142451:MainThread](2024-04-06 16:33:21,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.986163, valid_loss 0.996466, train_metric nan, valid_metric 0.045566
[4142451:MainThread](2024-04-06 16:33:21,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.981381, valid_loss 0.996758, train_metric nan, valid_metric 0.046669
[4142451:MainThread](2024-04-06 16:33:21,500) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.989933, valid_loss 0.996221, train_metric nan, valid_metric 0.048096
[4142451:MainThread](2024-04-06 16:33:21,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.980979, valid_loss 0.995550, train_metric nan, valid_metric 0.045438
[4142451:MainThread](2024-04-06 16:33:21,839) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.970928, valid_loss 0.996606, train_metric nan, valid_metric 0.048038
[4142451:MainThread](2024-04-06 16:33:21,984) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.987145, valid_loss 0.998022, train_metric nan, valid_metric 0.044486
[4142451:MainThread](2024-04-06 16:33:22,127) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.988926, valid_loss 1.000161, train_metric nan, valid_metric 0.047808
[4142451:MainThread](2024-04-06 16:33:22,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.986971, valid_loss 0.996583, train_metric nan, valid_metric 0.043718
[4142451:MainThread](2024-04-06 16:33:22,415) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.983945, valid_loss 0.994225, train_metric nan, valid_metric 0.047855
[4142451:MainThread](2024-04-06 16:33:22,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.976813, valid_loss 0.994994, train_metric nan, valid_metric 0.047961
[4142451:MainThread](2024-04-06 16:33:22,705) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.983893, valid_loss 0.994737, train_metric nan, valid_metric 0.050211
[4142451:MainThread](2024-04-06 16:33:22,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.987630, valid_loss 0.996146, train_metric nan, valid_metric 0.049080
[4142451:MainThread](2024-04-06 16:33:23,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.990608, valid_loss 0.996051, train_metric nan, valid_metric 0.050063
[4142451:MainThread](2024-04-06 16:33:23,148) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.981874, valid_loss 0.994235, train_metric nan, valid_metric 0.050425
[4142451:MainThread](2024-04-06 16:33:23,292) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.995551, valid_loss 0.994353, train_metric nan, valid_metric 0.048523
[4142451:MainThread](2024-04-06 16:33:23,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.991821, valid_loss 0.996048, train_metric nan, valid_metric 0.045058
[4142451:MainThread](2024-04-06 16:33:23,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.994278, valid_loss 0.996537, train_metric nan, valid_metric 0.043569
[4142451:MainThread](2024-04-06 16:33:23,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.982586, valid_loss 0.995438, train_metric nan, valid_metric 0.047685
[4142451:MainThread](2024-04-06 16:33:23,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.974145, valid_loss 0.995440, train_metric nan, valid_metric 0.049256
[4142451:MainThread](2024-04-06 16:33:24,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.985118, valid_loss 0.996054, train_metric nan, valid_metric 0.048359
[4142451:MainThread](2024-04-06 16:33:24,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.982006, valid_loss 0.996553, train_metric nan, valid_metric 0.045521
[4142451:MainThread](2024-04-06 16:33:24,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.973558, valid_loss 0.995497, train_metric nan, valid_metric 0.045297
[4142451:MainThread](2024-04-06 16:33:24,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.983469, valid_loss 0.996037, train_metric nan, valid_metric 0.047434
[4142451:MainThread](2024-04-06 16:33:24,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.978098, valid_loss 0.995633, train_metric nan, valid_metric 0.048464
[4142451:MainThread](2024-04-06 16:33:24,733) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.982637, valid_loss 0.994768, train_metric nan, valid_metric 0.047454
[4142451:MainThread](2024-04-06 16:33:24,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.983676, valid_loss 0.995848, train_metric nan, valid_metric 0.048209
[4142451:MainThread](2024-04-06 16:33:25,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.987215, valid_loss 0.995587, train_metric nan, valid_metric 0.045080
[4142451:MainThread](2024-04-06 16:33:25,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.969589, valid_loss 0.995453, train_metric nan, valid_metric 0.046777
[4142451:MainThread](2024-04-06 16:33:25,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.989089, valid_loss 0.994169, train_metric nan, valid_metric 0.050506
[4142451:MainThread](2024-04-06 16:33:25,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.997679, valid_loss 0.996647, train_metric nan, valid_metric 0.043537
[4142451:MainThread](2024-04-06 16:33:25,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.986372, valid_loss 0.997204, train_metric nan, valid_metric 0.045926
[4142451:MainThread](2024-04-06 16:33:25,760) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.972714, valid_loss 0.996489, train_metric nan, valid_metric 0.048879
[4142451:MainThread](2024-04-06 16:33:25,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.989979, valid_loss 0.996320, train_metric nan, valid_metric 0.047401
[4142451:MainThread](2024-04-06 16:33:26,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.980617, valid_loss 0.996256, train_metric nan, valid_metric 0.047792
[4142451:MainThread](2024-04-06 16:33:26,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.989201, valid_loss 0.995890, train_metric nan, valid_metric 0.045020
[4142451:MainThread](2024-04-06 16:33:26,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.977166, valid_loss 0.994431, train_metric nan, valid_metric 0.047126
[4142451:MainThread](2024-04-06 16:33:26,352) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:33:27,281) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:33:28,150) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  81%|████████  | 42/52 [13:52<03:16, 19.68s/it][4142451:MainThread](2024-04-06 16:33:28,159) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:33:28,171) INFO - qlib.workflow - [recorder.py:341] - Recorder 81ffe0b214c34972a705a6cb885eafb5 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:33:28,782) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:33:28,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:33:28,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:33:28,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:33:32,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:33:32,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.317105, valid_loss 1.019842, train_metric nan, valid_metric 0.036908
[4142451:MainThread](2024-04-06 16:33:32,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.019842, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:33:32,760) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.114536, valid_loss 1.018431, train_metric nan, valid_metric 0.030188
[4142451:MainThread](2024-04-06 16:33:32,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.019842 to 1.018431, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:32,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.078930, valid_loss 1.006904, train_metric nan, valid_metric 0.039910
[4142451:MainThread](2024-04-06 16:33:32,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.018431 to 1.006904, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:33,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.045830, valid_loss 1.006217, train_metric nan, valid_metric 0.041699
[4142451:MainThread](2024-04-06 16:33:33,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006904 to 1.006217, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:33,180) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.065918, valid_loss 1.011251, train_metric nan, valid_metric 0.031556
[4142451:MainThread](2024-04-06 16:33:33,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.029066, valid_loss 1.001887, train_metric nan, valid_metric 0.046433
[4142451:MainThread](2024-04-06 16:33:33,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006217 to 1.001887, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:33,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.037198, valid_loss 1.042519, train_metric nan, valid_metric 0.043706
[4142451:MainThread](2024-04-06 16:33:33,626) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.026012, valid_loss 1.000607, train_metric nan, valid_metric 0.038234
[4142451:MainThread](2024-04-06 16:33:33,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001887 to 1.000607, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:33,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.025717, valid_loss 0.999018, train_metric nan, valid_metric 0.044226
[4142451:MainThread](2024-04-06 16:33:33,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000607 to 0.999018, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:33,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.012449, valid_loss 1.001283, train_metric nan, valid_metric 0.034693
[4142451:MainThread](2024-04-06 16:33:34,079) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.028320, valid_loss 1.010229, train_metric nan, valid_metric 0.033668
[4142451:MainThread](2024-04-06 16:33:34,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.026327, valid_loss 1.039362, train_metric nan, valid_metric 0.039017
[4142451:MainThread](2024-04-06 16:33:34,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.006030, valid_loss 1.001505, train_metric nan, valid_metric 0.051295
[4142451:MainThread](2024-04-06 16:33:34,516) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.002442, valid_loss 1.003125, train_metric nan, valid_metric 0.038687
[4142451:MainThread](2024-04-06 16:33:34,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.004633, valid_loss 1.004011, train_metric nan, valid_metric 0.043190
[4142451:MainThread](2024-04-06 16:33:34,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.008705, valid_loss 1.004687, train_metric nan, valid_metric 0.043178
[4142451:MainThread](2024-04-06 16:33:34,926) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.007020, valid_loss 1.009029, train_metric nan, valid_metric 0.036341
[4142451:MainThread](2024-04-06 16:33:35,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.034583, valid_loss 1.006700, train_metric nan, valid_metric 0.032990
[4142451:MainThread](2024-04-06 16:33:35,238) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.002929, valid_loss 1.000676, train_metric nan, valid_metric 0.049436
[4142451:MainThread](2024-04-06 16:33:35,380) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.995371, valid_loss 0.999892, train_metric nan, valid_metric 0.040644
[4142451:MainThread](2024-04-06 16:33:35,524) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.996867, valid_loss 0.996643, train_metric nan, valid_metric 0.044645
[4142451:MainThread](2024-04-06 16:33:35,525) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999018 to 0.996643, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:35,678) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.995764, valid_loss 0.997951, train_metric nan, valid_metric 0.041276
[4142451:MainThread](2024-04-06 16:33:35,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.990662, valid_loss 0.997925, train_metric nan, valid_metric 0.045108
[4142451:MainThread](2024-04-06 16:33:35,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.995268, valid_loss 0.997420, train_metric nan, valid_metric 0.037643
[4142451:MainThread](2024-04-06 16:33:36,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.000838, valid_loss 0.997065, train_metric nan, valid_metric 0.041043
[4142451:MainThread](2024-04-06 16:33:36,321) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.009400, valid_loss 0.998314, train_metric nan, valid_metric 0.047897
[4142451:MainThread](2024-04-06 16:33:36,494) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.984295, valid_loss 0.997162, train_metric nan, valid_metric 0.045085
[4142451:MainThread](2024-04-06 16:33:36,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.989126, valid_loss 0.995369, train_metric nan, valid_metric 0.047405
[4142451:MainThread](2024-04-06 16:33:36,672) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996643 to 0.995369, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:36,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.992992, valid_loss 0.999834, train_metric nan, valid_metric 0.023131
[4142451:MainThread](2024-04-06 16:33:37,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.983834, valid_loss 1.000719, train_metric nan, valid_metric 0.037637
[4142451:MainThread](2024-04-06 16:33:37,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.993082, valid_loss 0.995402, train_metric nan, valid_metric 0.051090
[4142451:MainThread](2024-04-06 16:33:37,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.986889, valid_loss 0.997978, train_metric nan, valid_metric 0.040659
[4142451:MainThread](2024-04-06 16:33:37,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.991410, valid_loss 0.998044, train_metric nan, valid_metric 0.035817
[4142451:MainThread](2024-04-06 16:33:37,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.991357, valid_loss 0.998192, train_metric nan, valid_metric 0.038009
[4142451:MainThread](2024-04-06 16:33:37,941) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.992700, valid_loss 0.997379, train_metric nan, valid_metric 0.044397
[4142451:MainThread](2024-04-06 16:33:38,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.989899, valid_loss 0.996021, train_metric nan, valid_metric 0.049252
[4142451:MainThread](2024-04-06 16:33:38,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.988864, valid_loss 0.999534, train_metric nan, valid_metric 0.043155
[4142451:MainThread](2024-04-06 16:33:38,415) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.997403, valid_loss 0.995944, train_metric nan, valid_metric 0.048029
[4142451:MainThread](2024-04-06 16:33:38,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.991223, valid_loss 0.995242, train_metric nan, valid_metric 0.051928
[4142451:MainThread](2024-04-06 16:33:38,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995369 to 0.995242, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:38,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.993578, valid_loss 0.996773, train_metric nan, valid_metric 0.052698
[4142451:MainThread](2024-04-06 16:33:38,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.988421, valid_loss 0.996957, train_metric nan, valid_metric 0.037793
[4142451:MainThread](2024-04-06 16:33:38,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.988739, valid_loss 0.997161, train_metric nan, valid_metric 0.041270
[4142451:MainThread](2024-04-06 16:33:39,146) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.996641, valid_loss 0.997361, train_metric nan, valid_metric 0.039591
[4142451:MainThread](2024-04-06 16:33:39,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.982187, valid_loss 0.996943, train_metric nan, valid_metric 0.052162
[4142451:MainThread](2024-04-06 16:33:39,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.992616, valid_loss 0.997540, train_metric nan, valid_metric 0.044980
[4142451:MainThread](2024-04-06 16:33:39,579) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.981551, valid_loss 0.998379, train_metric nan, valid_metric 0.033883
[4142451:MainThread](2024-04-06 16:33:39,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.991332, valid_loss 0.998274, train_metric nan, valid_metric 0.039103
[4142451:MainThread](2024-04-06 16:33:39,868) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.988510, valid_loss 0.996614, train_metric nan, valid_metric 0.045421
[4142451:MainThread](2024-04-06 16:33:40,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.988187, valid_loss 0.997819, train_metric nan, valid_metric 0.037208
[4142451:MainThread](2024-04-06 16:33:40,156) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 1.000623, valid_loss 1.002594, train_metric nan, valid_metric 0.032960
[4142451:MainThread](2024-04-06 16:33:40,298) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.985870, valid_loss 0.997429, train_metric nan, valid_metric 0.033502
[4142451:MainThread](2024-04-06 16:33:40,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.995471, valid_loss 0.996849, train_metric nan, valid_metric 0.035244
[4142451:MainThread](2024-04-06 16:33:40,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.983594, valid_loss 0.997864, train_metric nan, valid_metric 0.039648
[4142451:MainThread](2024-04-06 16:33:40,709) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.988269, valid_loss 0.997133, train_metric nan, valid_metric 0.043038
[4142451:MainThread](2024-04-06 16:33:40,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.983047, valid_loss 0.997340, train_metric nan, valid_metric 0.039341
[4142451:MainThread](2024-04-06 16:33:40,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.996439, valid_loss 0.997696, train_metric nan, valid_metric 0.038537
[4142451:MainThread](2024-04-06 16:33:41,141) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.994407, valid_loss 0.996444, train_metric nan, valid_metric 0.035717
[4142451:MainThread](2024-04-06 16:33:41,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.978670, valid_loss 0.997817, train_metric nan, valid_metric 0.043429
[4142451:MainThread](2024-04-06 16:33:41,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.990270, valid_loss 0.997100, train_metric nan, valid_metric 0.041627
[4142451:MainThread](2024-04-06 16:33:41,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.987381, valid_loss 0.997892, train_metric nan, valid_metric 0.035616
[4142451:MainThread](2024-04-06 16:33:41,710) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.983153, valid_loss 0.997419, train_metric nan, valid_metric 0.034293
[4142451:MainThread](2024-04-06 16:33:41,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.995945, valid_loss 0.996189, train_metric nan, valid_metric 0.038054
[4142451:MainThread](2024-04-06 16:33:42,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.980084, valid_loss 0.996392, train_metric nan, valid_metric 0.036696
[4142451:MainThread](2024-04-06 16:33:42,154) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.988969, valid_loss 0.996997, train_metric nan, valid_metric 0.039944
[4142451:MainThread](2024-04-06 16:33:42,298) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.983682, valid_loss 0.997382, train_metric nan, valid_metric 0.031337
[4142451:MainThread](2024-04-06 16:33:42,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.990762, valid_loss 0.997637, train_metric nan, valid_metric 0.039043
[4142451:MainThread](2024-04-06 16:33:42,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.994028, valid_loss 0.997480, train_metric nan, valid_metric 0.036206
[4142451:MainThread](2024-04-06 16:33:42,732) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.986832, valid_loss 0.996448, train_metric nan, valid_metric 0.043772
[4142451:MainThread](2024-04-06 16:33:42,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.995201, valid_loss 0.997448, train_metric nan, valid_metric 0.044332
[4142451:MainThread](2024-04-06 16:33:43,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.979334, valid_loss 0.995841, train_metric nan, valid_metric 0.047799
[4142451:MainThread](2024-04-06 16:33:43,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.990515, valid_loss 0.996450, train_metric nan, valid_metric 0.044987
[4142451:MainThread](2024-04-06 16:33:43,309) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.983104, valid_loss 0.996983, train_metric nan, valid_metric 0.042027
[4142451:MainThread](2024-04-06 16:33:43,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.976450, valid_loss 0.995960, train_metric nan, valid_metric 0.044579
[4142451:MainThread](2024-04-06 16:33:43,633) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.988119, valid_loss 0.996438, train_metric nan, valid_metric 0.042057
[4142451:MainThread](2024-04-06 16:33:43,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.980534, valid_loss 0.997103, train_metric nan, valid_metric 0.034370
[4142451:MainThread](2024-04-06 16:33:43,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.983915, valid_loss 0.997652, train_metric nan, valid_metric 0.037635
[4142451:MainThread](2024-04-06 16:33:44,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.984472, valid_loss 0.996866, train_metric nan, valid_metric 0.043209
[4142451:MainThread](2024-04-06 16:33:44,268) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.986544, valid_loss 0.997373, train_metric nan, valid_metric 0.037000
[4142451:MainThread](2024-04-06 16:33:44,416) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.987618, valid_loss 0.995917, train_metric nan, valid_metric 0.042223
[4142451:MainThread](2024-04-06 16:33:44,564) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.987207, valid_loss 0.996434, train_metric nan, valid_metric 0.042974
[4142451:MainThread](2024-04-06 16:33:44,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.988621, valid_loss 0.997932, train_metric nan, valid_metric 0.036125
[4142451:MainThread](2024-04-06 16:33:44,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.974317, valid_loss 0.997075, train_metric nan, valid_metric 0.037950
[4142451:MainThread](2024-04-06 16:33:44,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.988278, valid_loss 0.996351, train_metric nan, valid_metric 0.044654
[4142451:MainThread](2024-04-06 16:33:45,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.998006, valid_loss 0.996652, train_metric nan, valid_metric 0.038234
[4142451:MainThread](2024-04-06 16:33:45,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.985938, valid_loss 0.996717, train_metric nan, valid_metric 0.035481
[4142451:MainThread](2024-04-06 16:33:45,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.979813, valid_loss 0.996749, train_metric nan, valid_metric 0.041755
[4142451:MainThread](2024-04-06 16:33:45,593) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.986599, valid_loss 0.995862, train_metric nan, valid_metric 0.041186
[4142451:MainThread](2024-04-06 16:33:45,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.982051, valid_loss 0.996487, train_metric nan, valid_metric 0.044301
[4142451:MainThread](2024-04-06 16:33:45,937) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.986827, valid_loss 0.996152, train_metric nan, valid_metric 0.047284
[4142451:MainThread](2024-04-06 16:33:45,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:33:46,981) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:33:48,018) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  83%|████████▎ | 43/52 [14:12<02:57, 19.73s/it][4142451:MainThread](2024-04-06 16:33:48,028) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:33:48,042) INFO - qlib.workflow - [recorder.py:341] - Recorder 4cf55f499d86495ba058a44f7ed61b14 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:33:48,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:33:48,759) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:33:48,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:33:48,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:33:52,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:33:52,913) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.468971, valid_loss 1.046503, train_metric nan, valid_metric 0.014274
[4142451:MainThread](2024-04-06 16:33:52,913) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.046503, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:33:53,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.116932, valid_loss 1.021318, train_metric nan, valid_metric 0.027165
[4142451:MainThread](2024-04-06 16:33:53,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.046503 to 1.021318, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:53,205) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.093596, valid_loss 1.054379, train_metric nan, valid_metric 0.021326
[4142451:MainThread](2024-04-06 16:33:53,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.071664, valid_loss 1.014984, train_metric nan, valid_metric 0.023970
[4142451:MainThread](2024-04-06 16:33:53,346) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.021318 to 1.014984, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:53,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.045108, valid_loss 1.010582, train_metric nan, valid_metric 0.018722
[4142451:MainThread](2024-04-06 16:33:53,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.014984 to 1.010582, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:53,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.040290, valid_loss 1.006225, train_metric nan, valid_metric 0.038331
[4142451:MainThread](2024-04-06 16:33:53,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.010582 to 1.006225, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:53,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.056885, valid_loss 1.013129, train_metric nan, valid_metric 0.026312
[4142451:MainThread](2024-04-06 16:33:53,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.026257, valid_loss 1.009062, train_metric nan, valid_metric 0.025547
[4142451:MainThread](2024-04-06 16:33:54,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.026393, valid_loss 1.003921, train_metric nan, valid_metric 0.026214
[4142451:MainThread](2024-04-06 16:33:54,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006225 to 1.003921, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:54,350) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.036604, valid_loss 1.002437, train_metric nan, valid_metric 0.034989
[4142451:MainThread](2024-04-06 16:33:54,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003921 to 1.002437, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:54,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.016958, valid_loss 1.004607, train_metric nan, valid_metric 0.034413
[4142451:MainThread](2024-04-06 16:33:54,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.022621, valid_loss 1.006533, train_metric nan, valid_metric 0.033065
[4142451:MainThread](2024-04-06 16:33:54,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.013394, valid_loss 1.014111, train_metric nan, valid_metric 0.033546
[4142451:MainThread](2024-04-06 16:33:54,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.024144, valid_loss 1.000368, train_metric nan, valid_metric 0.034882
[4142451:MainThread](2024-04-06 16:33:54,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.002437 to 1.000368, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:55,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.019680, valid_loss 1.002358, train_metric nan, valid_metric 0.029609
[4142451:MainThread](2024-04-06 16:33:55,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.017585, valid_loss 1.001323, train_metric nan, valid_metric 0.037846
[4142451:MainThread](2024-04-06 16:33:55,393) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.009146, valid_loss 1.014851, train_metric nan, valid_metric 0.045775
[4142451:MainThread](2024-04-06 16:33:55,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.012688, valid_loss 1.002870, train_metric nan, valid_metric 0.030658
[4142451:MainThread](2024-04-06 16:33:55,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.007981, valid_loss 0.999807, train_metric nan, valid_metric 0.039527
[4142451:MainThread](2024-04-06 16:33:55,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000368 to 0.999807, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:55,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.005058, valid_loss 1.000753, train_metric nan, valid_metric 0.042839
[4142451:MainThread](2024-04-06 16:33:55,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.999522, valid_loss 0.997678, train_metric nan, valid_metric 0.046049
[4142451:MainThread](2024-04-06 16:33:55,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999807 to 0.997678, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:56,114) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.000116, valid_loss 1.000468, train_metric nan, valid_metric 0.039401
[4142451:MainThread](2024-04-06 16:33:56,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.999059, valid_loss 1.001202, train_metric nan, valid_metric 0.042112
[4142451:MainThread](2024-04-06 16:33:56,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.018153, valid_loss 1.013411, train_metric nan, valid_metric 0.038047
[4142451:MainThread](2024-04-06 16:33:56,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.993462, valid_loss 1.005358, train_metric nan, valid_metric 0.030602
[4142451:MainThread](2024-04-06 16:33:56,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.982116, valid_loss 1.000474, train_metric nan, valid_metric 0.033668
[4142451:MainThread](2024-04-06 16:33:56,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.990928, valid_loss 1.001608, train_metric nan, valid_metric 0.027503
[4142451:MainThread](2024-04-06 16:33:57,016) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.004276, valid_loss 0.997496, train_metric nan, valid_metric 0.042373
[4142451:MainThread](2024-04-06 16:33:57,016) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997678 to 0.997496, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:57,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.993651, valid_loss 1.000914, train_metric nan, valid_metric 0.033129
[4142451:MainThread](2024-04-06 16:33:57,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.998432, valid_loss 0.998255, train_metric nan, valid_metric 0.041174
[4142451:MainThread](2024-04-06 16:33:57,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.999392, valid_loss 1.000266, train_metric nan, valid_metric 0.031121
[4142451:MainThread](2024-04-06 16:33:57,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.992137, valid_loss 0.999676, train_metric nan, valid_metric 0.040147
[4142451:MainThread](2024-04-06 16:33:57,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.978685, valid_loss 1.000082, train_metric nan, valid_metric 0.036299
[4142451:MainThread](2024-04-06 16:33:57,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.993805, valid_loss 0.998479, train_metric nan, valid_metric 0.033441
[4142451:MainThread](2024-04-06 16:33:58,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.988589, valid_loss 0.999801, train_metric nan, valid_metric 0.039296
[4142451:MainThread](2024-04-06 16:33:58,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.977739, valid_loss 0.997981, train_metric nan, valid_metric 0.037151
[4142451:MainThread](2024-04-06 16:33:58,353) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.998786, valid_loss 0.998783, train_metric nan, valid_metric 0.034184
[4142451:MainThread](2024-04-06 16:33:58,507) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.987249, valid_loss 0.997279, train_metric nan, valid_metric 0.036926
[4142451:MainThread](2024-04-06 16:33:58,508) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997496 to 0.997279, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:58,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.992032, valid_loss 0.996902, train_metric nan, valid_metric 0.041042
[4142451:MainThread](2024-04-06 16:33:58,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997279 to 0.996902, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:58,799) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.988491, valid_loss 1.003181, train_metric nan, valid_metric 0.043879
[4142451:MainThread](2024-04-06 16:33:58,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.991101, valid_loss 0.997325, train_metric nan, valid_metric 0.036851
[4142451:MainThread](2024-04-06 16:33:59,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.991117, valid_loss 0.996227, train_metric nan, valid_metric 0.038727
[4142451:MainThread](2024-04-06 16:33:59,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996902 to 0.996227, save checkpoint.
[4142451:MainThread](2024-04-06 16:33:59,243) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.994470, valid_loss 0.997752, train_metric nan, valid_metric 0.034087
[4142451:MainThread](2024-04-06 16:33:59,390) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.987712, valid_loss 0.997967, train_metric nan, valid_metric 0.037202
[4142451:MainThread](2024-04-06 16:33:59,536) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.978896, valid_loss 0.996700, train_metric nan, valid_metric 0.040514
[4142451:MainThread](2024-04-06 16:33:59,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.992715, valid_loss 0.997600, train_metric nan, valid_metric 0.038617
[4142451:MainThread](2024-04-06 16:33:59,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.989461, valid_loss 0.998994, train_metric nan, valid_metric 0.038655
[4142451:MainThread](2024-04-06 16:33:59,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.985343, valid_loss 0.997071, train_metric nan, valid_metric 0.036548
[4142451:MainThread](2024-04-06 16:34:00,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.989412, valid_loss 0.995170, train_metric nan, valid_metric 0.047096
[4142451:MainThread](2024-04-06 16:34:00,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996227 to 0.995170, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:00,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.981030, valid_loss 0.996604, train_metric nan, valid_metric 0.043800
[4142451:MainThread](2024-04-06 16:34:00,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.979138, valid_loss 1.013673, train_metric nan, valid_metric 0.028452
[4142451:MainThread](2024-04-06 16:34:00,530) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.983558, valid_loss 0.997247, train_metric nan, valid_metric 0.039573
[4142451:MainThread](2024-04-06 16:34:00,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.984706, valid_loss 0.994958, train_metric nan, valid_metric 0.049923
[4142451:MainThread](2024-04-06 16:34:00,676) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995170 to 0.994958, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:00,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.982758, valid_loss 1.001261, train_metric nan, valid_metric 0.023480
[4142451:MainThread](2024-04-06 16:34:00,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.985253, valid_loss 0.997145, train_metric nan, valid_metric 0.040038
[4142451:MainThread](2024-04-06 16:34:01,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.980150, valid_loss 0.999148, train_metric nan, valid_metric 0.038569
[4142451:MainThread](2024-04-06 16:34:01,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.983661, valid_loss 0.996644, train_metric nan, valid_metric 0.041492
[4142451:MainThread](2024-04-06 16:34:01,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.982030, valid_loss 0.999623, train_metric nan, valid_metric 0.031507
[4142451:MainThread](2024-04-06 16:34:01,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.993637, valid_loss 1.001969, train_metric nan, valid_metric 0.040778
[4142451:MainThread](2024-04-06 16:34:01,707) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.983810, valid_loss 1.002895, train_metric nan, valid_metric 0.042046
[4142451:MainThread](2024-04-06 16:34:01,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.986667, valid_loss 0.998725, train_metric nan, valid_metric 0.036165
[4142451:MainThread](2024-04-06 16:34:01,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.990199, valid_loss 1.003279, train_metric nan, valid_metric 0.022155
[4142451:MainThread](2024-04-06 16:34:02,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.986227, valid_loss 1.002620, train_metric nan, valid_metric 0.037231
[4142451:MainThread](2024-04-06 16:34:02,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.981180, valid_loss 0.998679, train_metric nan, valid_metric 0.031752
[4142451:MainThread](2024-04-06 16:34:02,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.984692, valid_loss 0.999649, train_metric nan, valid_metric 0.027446
[4142451:MainThread](2024-04-06 16:34:02,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.984171, valid_loss 0.998179, train_metric nan, valid_metric 0.033794
[4142451:MainThread](2024-04-06 16:34:02,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.991786, valid_loss 1.000529, train_metric nan, valid_metric 0.037012
[4142451:MainThread](2024-04-06 16:34:02,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.975455, valid_loss 0.997897, train_metric nan, valid_metric 0.032606
[4142451:MainThread](2024-04-06 16:34:03,018) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.992192, valid_loss 0.997689, train_metric nan, valid_metric 0.033487
[4142451:MainThread](2024-04-06 16:34:03,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.979593, valid_loss 0.999006, train_metric nan, valid_metric 0.031794
[4142451:MainThread](2024-04-06 16:34:03,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.980423, valid_loss 1.000015, train_metric nan, valid_metric 0.034629
[4142451:MainThread](2024-04-06 16:34:03,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.975964, valid_loss 0.998761, train_metric nan, valid_metric 0.038063
[4142451:MainThread](2024-04-06 16:34:03,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.989234, valid_loss 0.997871, train_metric nan, valid_metric 0.028143
[4142451:MainThread](2024-04-06 16:34:03,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.986671, valid_loss 1.004683, train_metric nan, valid_metric 0.030976
[4142451:MainThread](2024-04-06 16:34:03,972) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.976171, valid_loss 1.000642, train_metric nan, valid_metric 0.028756
[4142451:MainThread](2024-04-06 16:34:04,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.983072, valid_loss 0.999411, train_metric nan, valid_metric 0.035421
[4142451:MainThread](2024-04-06 16:34:04,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.979472, valid_loss 0.997437, train_metric nan, valid_metric 0.037794
[4142451:MainThread](2024-04-06 16:34:04,383) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.976030, valid_loss 0.998072, train_metric nan, valid_metric 0.035662
[4142451:MainThread](2024-04-06 16:34:04,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.985778, valid_loss 0.997970, train_metric nan, valid_metric 0.035664
[4142451:MainThread](2024-04-06 16:34:04,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.970458, valid_loss 0.998637, train_metric nan, valid_metric 0.033962
[4142451:MainThread](2024-04-06 16:34:04,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.979269, valid_loss 0.999331, train_metric nan, valid_metric 0.031063
[4142451:MainThread](2024-04-06 16:34:04,968) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.980126, valid_loss 0.999468, train_metric nan, valid_metric 0.030706
[4142451:MainThread](2024-04-06 16:34:05,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.971128, valid_loss 0.998071, train_metric nan, valid_metric 0.032270
[4142451:MainThread](2024-04-06 16:34:05,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.981997, valid_loss 0.996735, train_metric nan, valid_metric 0.034742
[4142451:MainThread](2024-04-06 16:34:05,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.973436, valid_loss 0.997623, train_metric nan, valid_metric 0.031689
[4142451:MainThread](2024-04-06 16:34:05,576) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.992253, valid_loss 0.998897, train_metric nan, valid_metric 0.030259
[4142451:MainThread](2024-04-06 16:34:05,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.975869, valid_loss 0.999645, train_metric nan, valid_metric 0.032842
[4142451:MainThread](2024-04-06 16:34:05,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.978356, valid_loss 0.998566, train_metric nan, valid_metric 0.033618
[4142451:MainThread](2024-04-06 16:34:06,091) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.987441, valid_loss 1.000283, train_metric nan, valid_metric 0.031264
[4142451:MainThread](2024-04-06 16:34:06,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.984522, valid_loss 0.998058, train_metric nan, valid_metric 0.033501
[4142451:MainThread](2024-04-06 16:34:06,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.976338, valid_loss 0.997322, train_metric nan, valid_metric 0.038748
[4142451:MainThread](2024-04-06 16:34:06,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.980803, valid_loss 0.999152, train_metric nan, valid_metric 0.030817
[4142451:MainThread](2024-04-06 16:34:06,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.974131, valid_loss 0.999033, train_metric nan, valid_metric 0.033280
[4142451:MainThread](2024-04-06 16:34:06,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.979694, valid_loss 0.997906, train_metric nan, valid_metric 0.032611
[4142451:MainThread](2024-04-06 16:34:06,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.983450, valid_loss 0.998516, train_metric nan, valid_metric 0.034203
[4142451:MainThread](2024-04-06 16:34:07,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.977465, valid_loss 0.998016, train_metric nan, valid_metric 0.031061
[4142451:MainThread](2024-04-06 16:34:07,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.985993, valid_loss 0.998835, train_metric nan, valid_metric 0.034928
[4142451:MainThread](2024-04-06 16:34:07,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.980940, valid_loss 0.998809, train_metric nan, valid_metric 0.032771
[4142451:MainThread](2024-04-06 16:34:07,577) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.982088, valid_loss 0.998732, train_metric nan, valid_metric 0.033450
[4142451:MainThread](2024-04-06 16:34:07,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.989197, valid_loss 0.997773, train_metric nan, valid_metric 0.034652
[4142451:MainThread](2024-04-06 16:34:07,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.980815, valid_loss 0.998826, train_metric nan, valid_metric 0.034762
[4142451:MainThread](2024-04-06 16:34:08,016) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.982937, valid_loss 0.998882, train_metric nan, valid_metric 0.033078
[4142451:MainThread](2024-04-06 16:34:08,164) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.985269, valid_loss 0.998194, train_metric nan, valid_metric 0.033504
[4142451:MainThread](2024-04-06 16:34:08,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:34:08,983) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:34:09,865) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  85%|████████▍ | 44/52 [14:34<02:42, 20.37s/it][4142451:MainThread](2024-04-06 16:34:09,873) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:34:09,883) INFO - qlib.workflow - [recorder.py:341] - Recorder 09e61d7f04e241dc9f966275813de320 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:34:10,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:34:10,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:34:10,486) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:34:10,487) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:34:13,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:34:14,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.277980, valid_loss 1.086957, train_metric nan, valid_metric 0.030831
[4142451:MainThread](2024-04-06 16:34:14,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.086957, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:34:14,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.110383, valid_loss 1.055404, train_metric nan, valid_metric 0.036420
[4142451:MainThread](2024-04-06 16:34:14,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.086957 to 1.055404, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:14,577) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.063945, valid_loss 1.061204, train_metric nan, valid_metric 0.015448
[4142451:MainThread](2024-04-06 16:34:14,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.045681, valid_loss 1.027964, train_metric nan, valid_metric 0.022291
[4142451:MainThread](2024-04-06 16:34:14,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.055404 to 1.027964, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:14,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.053940, valid_loss 1.021461, train_metric nan, valid_metric 0.020986
[4142451:MainThread](2024-04-06 16:34:14,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.027964 to 1.021461, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:15,016) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.070728, valid_loss 1.010826, train_metric nan, valid_metric 0.028801
[4142451:MainThread](2024-04-06 16:34:15,017) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.021461 to 1.010826, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:15,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.033723, valid_loss 1.023240, train_metric nan, valid_metric 0.042827
[4142451:MainThread](2024-04-06 16:34:15,371) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.020067, valid_loss 0.997025, train_metric nan, valid_metric 0.057466
[4142451:MainThread](2024-04-06 16:34:15,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.010826 to 0.997025, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:15,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.080439, valid_loss 1.017093, train_metric nan, valid_metric 0.035209
[4142451:MainThread](2024-04-06 16:34:15,676) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.027035, valid_loss 1.013979, train_metric nan, valid_metric 0.062362
[4142451:MainThread](2024-04-06 16:34:15,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.013585, valid_loss 1.020030, train_metric nan, valid_metric 0.051418
[4142451:MainThread](2024-04-06 16:34:15,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.017378, valid_loss 1.008157, train_metric nan, valid_metric 0.010954
[4142451:MainThread](2024-04-06 16:34:16,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.014657, valid_loss 1.006212, train_metric nan, valid_metric 0.019195
[4142451:MainThread](2024-04-06 16:34:16,260) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.027613, valid_loss 1.019377, train_metric nan, valid_metric 0.031137
[4142451:MainThread](2024-04-06 16:34:16,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.018019, valid_loss 0.997974, train_metric nan, valid_metric 0.042296
[4142451:MainThread](2024-04-06 16:34:16,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.020472, valid_loss 1.013827, train_metric nan, valid_metric 0.044145
[4142451:MainThread](2024-04-06 16:34:16,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.006225, valid_loss 0.998556, train_metric nan, valid_metric 0.055492
[4142451:MainThread](2024-04-06 16:34:16,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.001374, valid_loss 0.999551, train_metric nan, valid_metric 0.044853
[4142451:MainThread](2024-04-06 16:34:16,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.004667, valid_loss 1.005185, train_metric nan, valid_metric 0.049757
[4142451:MainThread](2024-04-06 16:34:17,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.999062, valid_loss 0.995966, train_metric nan, valid_metric 0.047583
[4142451:MainThread](2024-04-06 16:34:17,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997025 to 0.995966, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:17,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.008789, valid_loss 0.995500, train_metric nan, valid_metric 0.050719
[4142451:MainThread](2024-04-06 16:34:17,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995966 to 0.995500, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:17,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.991239, valid_loss 0.997974, train_metric nan, valid_metric 0.056193
[4142451:MainThread](2024-04-06 16:34:17,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.992067, valid_loss 0.995838, train_metric nan, valid_metric 0.049423
[4142451:MainThread](2024-04-06 16:34:17,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.993426, valid_loss 0.996623, train_metric nan, valid_metric 0.048440
[4142451:MainThread](2024-04-06 16:34:17,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.997766, valid_loss 0.995323, train_metric nan, valid_metric 0.056012
[4142451:MainThread](2024-04-06 16:34:17,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995500 to 0.995323, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:17,957) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.004338, valid_loss 0.997904, train_metric nan, valid_metric 0.041759
[4142451:MainThread](2024-04-06 16:34:18,119) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.001510, valid_loss 0.996143, train_metric nan, valid_metric 0.058818
[4142451:MainThread](2024-04-06 16:34:18,261) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.003282, valid_loss 0.999202, train_metric nan, valid_metric 0.047731
[4142451:MainThread](2024-04-06 16:34:18,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.991174, valid_loss 0.996495, train_metric nan, valid_metric 0.049646
[4142451:MainThread](2024-04-06 16:34:18,561) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.992971, valid_loss 0.998824, train_metric nan, valid_metric 0.050433
[4142451:MainThread](2024-04-06 16:34:18,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.990224, valid_loss 0.996460, train_metric nan, valid_metric 0.045212
[4142451:MainThread](2024-04-06 16:34:18,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.997116, valid_loss 1.000003, train_metric nan, valid_metric 0.033554
[4142451:MainThread](2024-04-06 16:34:19,008) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.001908, valid_loss 0.996467, train_metric nan, valid_metric 0.054715
[4142451:MainThread](2024-04-06 16:34:19,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.002364, valid_loss 1.002679, train_metric nan, valid_metric 0.052589
[4142451:MainThread](2024-04-06 16:34:19,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.002304, valid_loss 0.997786, train_metric nan, valid_metric 0.050666
[4142451:MainThread](2024-04-06 16:34:19,440) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.987347, valid_loss 0.997665, train_metric nan, valid_metric 0.047703
[4142451:MainThread](2024-04-06 16:34:19,579) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.000133, valid_loss 0.995597, train_metric nan, valid_metric 0.050122
[4142451:MainThread](2024-04-06 16:34:19,727) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.980276, valid_loss 0.994666, train_metric nan, valid_metric 0.054042
[4142451:MainThread](2024-04-06 16:34:19,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.995323 to 0.994666, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:19,878) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.987239, valid_loss 0.995323, train_metric nan, valid_metric 0.054591
[4142451:MainThread](2024-04-06 16:34:20,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.000450, valid_loss 0.996095, train_metric nan, valid_metric 0.056204
[4142451:MainThread](2024-04-06 16:34:20,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.995522, valid_loss 0.995697, train_metric nan, valid_metric 0.050371
[4142451:MainThread](2024-04-06 16:34:20,400) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.984139, valid_loss 0.996619, train_metric nan, valid_metric 0.048161
[4142451:MainThread](2024-04-06 16:34:20,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.990219, valid_loss 0.995484, train_metric nan, valid_metric 0.052490
[4142451:MainThread](2024-04-06 16:34:20,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.993504, valid_loss 0.997175, train_metric nan, valid_metric 0.045810
[4142451:MainThread](2024-04-06 16:34:20,830) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.993200, valid_loss 0.996776, train_metric nan, valid_metric 0.043276
[4142451:MainThread](2024-04-06 16:34:20,996) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.989478, valid_loss 0.994971, train_metric nan, valid_metric 0.052610
[4142451:MainThread](2024-04-06 16:34:21,140) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.995059, valid_loss 0.995424, train_metric nan, valid_metric 0.045917
[4142451:MainThread](2024-04-06 16:34:21,281) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.996723, valid_loss 0.995628, train_metric nan, valid_metric 0.048273
[4142451:MainThread](2024-04-06 16:34:21,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.989669, valid_loss 0.995089, train_metric nan, valid_metric 0.047549
[4142451:MainThread](2024-04-06 16:34:21,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.991937, valid_loss 0.994972, train_metric nan, valid_metric 0.053168
[4142451:MainThread](2024-04-06 16:34:21,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.992124, valid_loss 0.995743, train_metric nan, valid_metric 0.046915
[4142451:MainThread](2024-04-06 16:34:21,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.989763, valid_loss 0.995981, train_metric nan, valid_metric 0.046779
[4142451:MainThread](2024-04-06 16:34:22,005) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.985642, valid_loss 0.995450, train_metric nan, valid_metric 0.048959
[4142451:MainThread](2024-04-06 16:34:22,158) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.995575, valid_loss 0.996844, train_metric nan, valid_metric 0.040401
[4142451:MainThread](2024-04-06 16:34:22,306) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.981423, valid_loss 0.995603, train_metric nan, valid_metric 0.047835
[4142451:MainThread](2024-04-06 16:34:22,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.988803, valid_loss 0.996828, train_metric nan, valid_metric 0.048256
[4142451:MainThread](2024-04-06 16:34:22,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.981019, valid_loss 0.995587, train_metric nan, valid_metric 0.049406
[4142451:MainThread](2024-04-06 16:34:22,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.984398, valid_loss 0.995595, train_metric nan, valid_metric 0.047105
[4142451:MainThread](2024-04-06 16:34:22,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.983506, valid_loss 0.995715, train_metric nan, valid_metric 0.048046
[4142451:MainThread](2024-04-06 16:34:23,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.986714, valid_loss 0.994942, train_metric nan, valid_metric 0.051060
[4142451:MainThread](2024-04-06 16:34:23,192) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.995452, valid_loss 0.995505, train_metric nan, valid_metric 0.045664
[4142451:MainThread](2024-04-06 16:34:23,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.990308, valid_loss 0.995577, train_metric nan, valid_metric 0.048425
[4142451:MainThread](2024-04-06 16:34:23,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.987701, valid_loss 0.995842, train_metric nan, valid_metric 0.045841
[4142451:MainThread](2024-04-06 16:34:23,676) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.992720, valid_loss 0.995962, train_metric nan, valid_metric 0.048461
[4142451:MainThread](2024-04-06 16:34:23,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.987818, valid_loss 0.995217, train_metric nan, valid_metric 0.050267
[4142451:MainThread](2024-04-06 16:34:23,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.996884, valid_loss 0.995444, train_metric nan, valid_metric 0.051574
[4142451:MainThread](2024-04-06 16:34:24,154) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.992430, valid_loss 0.995719, train_metric nan, valid_metric 0.051093
[4142451:MainThread](2024-04-06 16:34:24,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.982613, valid_loss 0.995665, train_metric nan, valid_metric 0.049226
[4142451:MainThread](2024-04-06 16:34:24,433) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.987815, valid_loss 0.995648, train_metric nan, valid_metric 0.050028
[4142451:MainThread](2024-04-06 16:34:24,568) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.991806, valid_loss 0.995033, train_metric nan, valid_metric 0.047848
[4142451:MainThread](2024-04-06 16:34:24,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.981441, valid_loss 0.995146, train_metric nan, valid_metric 0.047420
[4142451:MainThread](2024-04-06 16:34:24,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.987915, valid_loss 0.995357, train_metric nan, valid_metric 0.051626
[4142451:MainThread](2024-04-06 16:34:25,017) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.006347, valid_loss 0.995428, train_metric nan, valid_metric 0.053273
[4142451:MainThread](2024-04-06 16:34:25,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.987777, valid_loss 0.995239, train_metric nan, valid_metric 0.046270
[4142451:MainThread](2024-04-06 16:34:25,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.987137, valid_loss 0.995542, train_metric nan, valid_metric 0.049216
[4142451:MainThread](2024-04-06 16:34:25,517) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.980013, valid_loss 0.995534, train_metric nan, valid_metric 0.050664
[4142451:MainThread](2024-04-06 16:34:25,661) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.992983, valid_loss 0.995267, train_metric nan, valid_metric 0.052196
[4142451:MainThread](2024-04-06 16:34:25,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.989093, valid_loss 0.995240, train_metric nan, valid_metric 0.051955
[4142451:MainThread](2024-04-06 16:34:25,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.993916, valid_loss 0.995500, train_metric nan, valid_metric 0.052209
[4142451:MainThread](2024-04-06 16:34:26,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.998159, valid_loss 0.995322, train_metric nan, valid_metric 0.051824
[4142451:MainThread](2024-04-06 16:34:26,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.984210, valid_loss 0.995058, train_metric nan, valid_metric 0.052083
[4142451:MainThread](2024-04-06 16:34:26,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.979304, valid_loss 0.995281, train_metric nan, valid_metric 0.050998
[4142451:MainThread](2024-04-06 16:34:26,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.991732, valid_loss 0.994983, train_metric nan, valid_metric 0.049682
[4142451:MainThread](2024-04-06 16:34:26,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.986053, valid_loss 0.995108, train_metric nan, valid_metric 0.050795
[4142451:MainThread](2024-04-06 16:34:26,835) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.984903, valid_loss 0.995859, train_metric nan, valid_metric 0.045186
[4142451:MainThread](2024-04-06 16:34:26,985) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.980794, valid_loss 0.995457, train_metric nan, valid_metric 0.049996
[4142451:MainThread](2024-04-06 16:34:27,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.991488, valid_loss 0.995173, train_metric nan, valid_metric 0.051429
[4142451:MainThread](2024-04-06 16:34:27,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.989125, valid_loss 0.995155, train_metric nan, valid_metric 0.051456
[4142451:MainThread](2024-04-06 16:34:27,275) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:34:28,104) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:34:28,967) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  87%|████████▋ | 45/52 [14:53<02:19, 19.99s/it][4142451:MainThread](2024-04-06 16:34:28,975) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:34:28,985) INFO - qlib.workflow - [recorder.py:341] - Recorder ca020b0f28ab4744abdb8e43cb101a01 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:34:29,583) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:34:29,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:34:29,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:34:29,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:34:33,091) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:34:33,586) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.273438, valid_loss 1.069490, train_metric nan, valid_metric 0.046092
[4142451:MainThread](2024-04-06 16:34:33,586) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.069490, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:34:33,733) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.083624, valid_loss 1.024136, train_metric nan, valid_metric 0.025399
[4142451:MainThread](2024-04-06 16:34:33,733) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.069490 to 1.024136, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:33,876) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.063791, valid_loss 1.019834, train_metric nan, valid_metric 0.015855
[4142451:MainThread](2024-04-06 16:34:33,877) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.024136 to 1.019834, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:34,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.043959, valid_loss 1.014945, train_metric nan, valid_metric 0.040566
[4142451:MainThread](2024-04-06 16:34:34,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.019834 to 1.014945, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:34,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.034230, valid_loss 1.009794, train_metric nan, valid_metric 0.035293
[4142451:MainThread](2024-04-06 16:34:34,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.014945 to 1.009794, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:34,342) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.032206, valid_loss 1.001974, train_metric nan, valid_metric 0.042281
[4142451:MainThread](2024-04-06 16:34:34,342) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.009794 to 1.001974, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:34,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.018698, valid_loss 1.004869, train_metric nan, valid_metric 0.049343
[4142451:MainThread](2024-04-06 16:34:34,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.021581, valid_loss 1.021004, train_metric nan, valid_metric 0.051594
[4142451:MainThread](2024-04-06 16:34:34,757) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.037994, valid_loss 1.007702, train_metric nan, valid_metric 0.040087
[4142451:MainThread](2024-04-06 16:34:34,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.040737, valid_loss 1.006834, train_metric nan, valid_metric 0.044751
[4142451:MainThread](2024-04-06 16:34:35,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.029574, valid_loss 1.018050, train_metric nan, valid_metric 0.049159
[4142451:MainThread](2024-04-06 16:34:35,183) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.011625, valid_loss 0.996347, train_metric nan, valid_metric 0.046496
[4142451:MainThread](2024-04-06 16:34:35,183) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001974 to 0.996347, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:35,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.004211, valid_loss 0.998066, train_metric nan, valid_metric 0.049497
[4142451:MainThread](2024-04-06 16:34:35,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 0.997490, valid_loss 0.996118, train_metric nan, valid_metric 0.051518
[4142451:MainThread](2024-04-06 16:34:35,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996347 to 0.996118, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:35,593) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.029460, valid_loss 1.004576, train_metric nan, valid_metric 0.053370
[4142451:MainThread](2024-04-06 16:34:35,733) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.029332, valid_loss 0.993117, train_metric nan, valid_metric 0.063712
[4142451:MainThread](2024-04-06 16:34:35,733) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996118 to 0.993117, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:35,885) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.007761, valid_loss 0.994776, train_metric nan, valid_metric 0.054918
[4142451:MainThread](2024-04-06 16:34:36,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.991409, valid_loss 0.996651, train_metric nan, valid_metric 0.051128
[4142451:MainThread](2024-04-06 16:34:36,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.001155, valid_loss 0.999265, train_metric nan, valid_metric 0.044972
[4142451:MainThread](2024-04-06 16:34:36,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.009280, valid_loss 1.003281, train_metric nan, valid_metric 0.049128
[4142451:MainThread](2024-04-06 16:34:36,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.993356, valid_loss 0.997183, train_metric nan, valid_metric 0.048016
[4142451:MainThread](2024-04-06 16:34:36,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.997973, valid_loss 0.995249, train_metric nan, valid_metric 0.052922
[4142451:MainThread](2024-04-06 16:34:36,767) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.000164, valid_loss 0.995521, train_metric nan, valid_metric 0.052361
[4142451:MainThread](2024-04-06 16:34:36,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.995687, valid_loss 0.996508, train_metric nan, valid_metric 0.044335
[4142451:MainThread](2024-04-06 16:34:37,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.990592, valid_loss 0.994352, train_metric nan, valid_metric 0.055364
[4142451:MainThread](2024-04-06 16:34:37,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.986653, valid_loss 0.995264, train_metric nan, valid_metric 0.051682
[4142451:MainThread](2024-04-06 16:34:37,371) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.998461, valid_loss 0.995425, train_metric nan, valid_metric 0.050585
[4142451:MainThread](2024-04-06 16:34:37,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.986989, valid_loss 1.002539, train_metric nan, valid_metric 0.060014
[4142451:MainThread](2024-04-06 16:34:37,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.998913, valid_loss 0.996904, train_metric nan, valid_metric 0.048614
[4142451:MainThread](2024-04-06 16:34:37,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.992615, valid_loss 0.994086, train_metric nan, valid_metric 0.057877
[4142451:MainThread](2024-04-06 16:34:38,031) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.992742, valid_loss 0.996335, train_metric nan, valid_metric 0.056979
[4142451:MainThread](2024-04-06 16:34:38,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.994001, valid_loss 0.993376, train_metric nan, valid_metric 0.058518
[4142451:MainThread](2024-04-06 16:34:38,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.985327, valid_loss 0.994976, train_metric nan, valid_metric 0.052377
[4142451:MainThread](2024-04-06 16:34:38,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.986441, valid_loss 0.995846, train_metric nan, valid_metric 0.049698
[4142451:MainThread](2024-04-06 16:34:38,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.990514, valid_loss 0.994092, train_metric nan, valid_metric 0.051218
[4142451:MainThread](2024-04-06 16:34:38,885) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.996594, valid_loss 0.994177, train_metric nan, valid_metric 0.054116
[4142451:MainThread](2024-04-06 16:34:39,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.985318, valid_loss 0.993092, train_metric nan, valid_metric 0.059663
[4142451:MainThread](2024-04-06 16:34:39,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993117 to 0.993092, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:39,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.983112, valid_loss 0.995697, train_metric nan, valid_metric 0.048603
[4142451:MainThread](2024-04-06 16:34:39,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.997956, valid_loss 0.993638, train_metric nan, valid_metric 0.056341
[4142451:MainThread](2024-04-06 16:34:39,525) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.979632, valid_loss 0.994499, train_metric nan, valid_metric 0.053704
[4142451:MainThread](2024-04-06 16:34:39,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.987162, valid_loss 0.994347, train_metric nan, valid_metric 0.051106
[4142451:MainThread](2024-04-06 16:34:39,812) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.974156, valid_loss 0.994956, train_metric nan, valid_metric 0.053057
[4142451:MainThread](2024-04-06 16:34:39,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.992960, valid_loss 0.995385, train_metric nan, valid_metric 0.055053
[4142451:MainThread](2024-04-06 16:34:40,129) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.983153, valid_loss 0.993605, train_metric nan, valid_metric 0.057983
[4142451:MainThread](2024-04-06 16:34:40,278) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.987347, valid_loss 0.995352, train_metric nan, valid_metric 0.052213
[4142451:MainThread](2024-04-06 16:34:40,416) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.984191, valid_loss 0.996148, train_metric nan, valid_metric 0.049067
[4142451:MainThread](2024-04-06 16:34:40,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.993154, valid_loss 0.996121, train_metric nan, valid_metric 0.052862
[4142451:MainThread](2024-04-06 16:34:40,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.982872, valid_loss 0.994361, train_metric nan, valid_metric 0.055770
[4142451:MainThread](2024-04-06 16:34:40,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.981389, valid_loss 0.994359, train_metric nan, valid_metric 0.055247
[4142451:MainThread](2024-04-06 16:34:41,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.988076, valid_loss 0.995343, train_metric nan, valid_metric 0.049097
[4142451:MainThread](2024-04-06 16:34:41,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.980458, valid_loss 0.995173, train_metric nan, valid_metric 0.051560
[4142451:MainThread](2024-04-06 16:34:41,366) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.987801, valid_loss 0.995305, train_metric nan, valid_metric 0.051060
[4142451:MainThread](2024-04-06 16:34:41,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.991422, valid_loss 0.993205, train_metric nan, valid_metric 0.056222
[4142451:MainThread](2024-04-06 16:34:41,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.990017, valid_loss 0.995226, train_metric nan, valid_metric 0.052103
[4142451:MainThread](2024-04-06 16:34:41,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.988120, valid_loss 0.995216, train_metric nan, valid_metric 0.055648
[4142451:MainThread](2024-04-06 16:34:42,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.991786, valid_loss 0.994627, train_metric nan, valid_metric 0.055157
[4142451:MainThread](2024-04-06 16:34:42,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.982159, valid_loss 0.995479, train_metric nan, valid_metric 0.049867
[4142451:MainThread](2024-04-06 16:34:42,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.987418, valid_loss 0.995270, train_metric nan, valid_metric 0.052900
[4142451:MainThread](2024-04-06 16:34:42,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.988539, valid_loss 0.994089, train_metric nan, valid_metric 0.054542
[4142451:MainThread](2024-04-06 16:34:42,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.979731, valid_loss 0.993949, train_metric nan, valid_metric 0.057186
[4142451:MainThread](2024-04-06 16:34:42,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.991985, valid_loss 0.993937, train_metric nan, valid_metric 0.058328
[4142451:MainThread](2024-04-06 16:34:42,899) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.988465, valid_loss 0.993261, train_metric nan, valid_metric 0.057989
[4142451:MainThread](2024-04-06 16:34:43,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.988083, valid_loss 0.993830, train_metric nan, valid_metric 0.055045
[4142451:MainThread](2024-04-06 16:34:43,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.983710, valid_loss 0.994162, train_metric nan, valid_metric 0.050486
[4142451:MainThread](2024-04-06 16:34:43,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.994351, valid_loss 0.994642, train_metric nan, valid_metric 0.054468
[4142451:MainThread](2024-04-06 16:34:43,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.987157, valid_loss 0.994096, train_metric nan, valid_metric 0.056984
[4142451:MainThread](2024-04-06 16:34:43,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.979080, valid_loss 0.994421, train_metric nan, valid_metric 0.053763
[4142451:MainThread](2024-04-06 16:34:43,747) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.981290, valid_loss 0.994419, train_metric nan, valid_metric 0.054492
[4142451:MainThread](2024-04-06 16:34:43,897) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.984918, valid_loss 0.993787, train_metric nan, valid_metric 0.055737
[4142451:MainThread](2024-04-06 16:34:44,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.989415, valid_loss 0.993869, train_metric nan, valid_metric 0.055440
[4142451:MainThread](2024-04-06 16:34:44,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.990359, valid_loss 0.993518, train_metric nan, valid_metric 0.057617
[4142451:MainThread](2024-04-06 16:34:44,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.981720, valid_loss 0.993158, train_metric nan, valid_metric 0.061619
[4142451:MainThread](2024-04-06 16:34:44,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.988129, valid_loss 0.994324, train_metric nan, valid_metric 0.054771
[4142451:MainThread](2024-04-06 16:34:44,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.983313, valid_loss 0.994950, train_metric nan, valid_metric 0.052914
[4142451:MainThread](2024-04-06 16:34:44,770) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.984026, valid_loss 0.994909, train_metric nan, valid_metric 0.053157
[4142451:MainThread](2024-04-06 16:34:44,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.996681, valid_loss 0.994784, train_metric nan, valid_metric 0.053356
[4142451:MainThread](2024-04-06 16:34:45,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.979115, valid_loss 0.994797, train_metric nan, valid_metric 0.053285
[4142451:MainThread](2024-04-06 16:34:45,238) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.988794, valid_loss 0.993632, train_metric nan, valid_metric 0.055165
[4142451:MainThread](2024-04-06 16:34:45,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.985128, valid_loss 0.993915, train_metric nan, valid_metric 0.054083
[4142451:MainThread](2024-04-06 16:34:45,524) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.979288, valid_loss 0.994786, train_metric nan, valid_metric 0.052152
[4142451:MainThread](2024-04-06 16:34:45,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.981896, valid_loss 0.995147, train_metric nan, valid_metric 0.051393
[4142451:MainThread](2024-04-06 16:34:45,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.983489, valid_loss 0.994431, train_metric nan, valid_metric 0.052411
[4142451:MainThread](2024-04-06 16:34:45,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.992131, valid_loss 0.994875, train_metric nan, valid_metric 0.052187
[4142451:MainThread](2024-04-06 16:34:46,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.989416, valid_loss 0.994643, train_metric nan, valid_metric 0.051663
[4142451:MainThread](2024-04-06 16:34:46,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.982094, valid_loss 0.994230, train_metric nan, valid_metric 0.053875
[4142451:MainThread](2024-04-06 16:34:46,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.980017, valid_loss 0.993878, train_metric nan, valid_metric 0.054711
[4142451:MainThread](2024-04-06 16:34:46,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.995600, valid_loss 0.994817, train_metric nan, valid_metric 0.052806
[4142451:MainThread](2024-04-06 16:34:46,538) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:34:47,386) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:34:48,245) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  88%|████████▊ | 46/52 [15:12<01:58, 19.78s/it][4142451:MainThread](2024-04-06 16:34:48,253) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:34:48,263) INFO - qlib.workflow - [recorder.py:341] - Recorder 7bba775643624714b3ebfbdb94e94ca6 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:34:48,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:34:48,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:34:48,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:34:48,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:34:52,320) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:34:52,602) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.222880, valid_loss 1.054941, train_metric nan, valid_metric 0.015190
[4142451:MainThread](2024-04-06 16:34:52,603) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.054941, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:34:52,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.083175, valid_loss 1.097678, train_metric nan, valid_metric 0.017031
[4142451:MainThread](2024-04-06 16:34:52,876) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.061711, valid_loss 1.031110, train_metric nan, valid_metric 0.035239
[4142451:MainThread](2024-04-06 16:34:52,877) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.054941 to 1.031110, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:53,029) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.025564, valid_loss 1.002798, train_metric nan, valid_metric 0.053793
[4142451:MainThread](2024-04-06 16:34:53,030) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.031110 to 1.002798, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:53,196) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.065845, valid_loss 1.025288, train_metric nan, valid_metric 0.021911
[4142451:MainThread](2024-04-06 16:34:53,344) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.033057, valid_loss 1.007916, train_metric nan, valid_metric 0.031026
[4142451:MainThread](2024-04-06 16:34:53,494) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.072952, valid_loss 1.025952, train_metric nan, valid_metric 0.029821
[4142451:MainThread](2024-04-06 16:34:53,638) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.009386, valid_loss 0.998785, train_metric nan, valid_metric 0.046967
[4142451:MainThread](2024-04-06 16:34:53,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.002798 to 0.998785, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:53,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.014809, valid_loss 1.007579, train_metric nan, valid_metric 0.035997
[4142451:MainThread](2024-04-06 16:34:53,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.007086, valid_loss 0.998762, train_metric nan, valid_metric 0.042915
[4142451:MainThread](2024-04-06 16:34:53,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998785 to 0.998762, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:54,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.003038, valid_loss 1.001343, train_metric nan, valid_metric 0.036604
[4142451:MainThread](2024-04-06 16:34:54,278) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.005664, valid_loss 0.997958, train_metric nan, valid_metric 0.035367
[4142451:MainThread](2024-04-06 16:34:54,278) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998762 to 0.997958, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:54,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.998563, valid_loss 0.997809, train_metric nan, valid_metric 0.053300
[4142451:MainThread](2024-04-06 16:34:54,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997958 to 0.997809, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:54,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.008302, valid_loss 0.999403, train_metric nan, valid_metric 0.041298
[4142451:MainThread](2024-04-06 16:34:54,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.999800, valid_loss 0.998602, train_metric nan, valid_metric 0.044544
[4142451:MainThread](2024-04-06 16:34:54,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.005149, valid_loss 0.998258, train_metric nan, valid_metric 0.042834
[4142451:MainThread](2024-04-06 16:34:55,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 0.998756, valid_loss 1.000595, train_metric nan, valid_metric 0.035417
[4142451:MainThread](2024-04-06 16:34:55,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.002940, valid_loss 1.008454, train_metric nan, valid_metric 0.034479
[4142451:MainThread](2024-04-06 16:34:55,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.993768, valid_loss 0.999545, train_metric nan, valid_metric 0.033797
[4142451:MainThread](2024-04-06 16:34:55,564) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.987975, valid_loss 0.994745, train_metric nan, valid_metric 0.054502
[4142451:MainThread](2024-04-06 16:34:55,565) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997809 to 0.994745, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:55,712) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.991206, valid_loss 0.998203, train_metric nan, valid_metric 0.049889
[4142451:MainThread](2024-04-06 16:34:55,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.000822, valid_loss 0.995652, train_metric nan, valid_metric 0.050125
[4142451:MainThread](2024-04-06 16:34:56,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.002067, valid_loss 0.996176, train_metric nan, valid_metric 0.052842
[4142451:MainThread](2024-04-06 16:34:56,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.991574, valid_loss 0.995454, train_metric nan, valid_metric 0.049526
[4142451:MainThread](2024-04-06 16:34:56,297) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.987590, valid_loss 0.998269, train_metric nan, valid_metric 0.041131
[4142451:MainThread](2024-04-06 16:34:56,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.997292, valid_loss 0.996272, train_metric nan, valid_metric 0.048424
[4142451:MainThread](2024-04-06 16:34:56,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.981809, valid_loss 0.995982, train_metric nan, valid_metric 0.051813
[4142451:MainThread](2024-04-06 16:34:56,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.998368, valid_loss 0.998086, train_metric nan, valid_metric 0.037901
[4142451:MainThread](2024-04-06 16:34:56,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.005099, valid_loss 1.001157, train_metric nan, valid_metric 0.030168
[4142451:MainThread](2024-04-06 16:34:56,984) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.987366, valid_loss 0.998132, train_metric nan, valid_metric 0.040490
[4142451:MainThread](2024-04-06 16:34:57,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.992182, valid_loss 0.994288, train_metric nan, valid_metric 0.058387
[4142451:MainThread](2024-04-06 16:34:57,158) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994745 to 0.994288, save checkpoint.
[4142451:MainThread](2024-04-06 16:34:57,328) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.987465, valid_loss 0.996583, train_metric nan, valid_metric 0.030221
[4142451:MainThread](2024-04-06 16:34:57,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.997495, valid_loss 0.997156, train_metric nan, valid_metric 0.039981
[4142451:MainThread](2024-04-06 16:34:57,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.990992, valid_loss 0.998860, train_metric nan, valid_metric 0.048590
[4142451:MainThread](2024-04-06 16:34:57,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.978286, valid_loss 0.998931, train_metric nan, valid_metric 0.056684
[4142451:MainThread](2024-04-06 16:34:57,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.984882, valid_loss 0.995983, train_metric nan, valid_metric 0.046115
[4142451:MainThread](2024-04-06 16:34:58,091) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.989690, valid_loss 0.996499, train_metric nan, valid_metric 0.042206
[4142451:MainThread](2024-04-06 16:34:58,235) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.985111, valid_loss 0.994802, train_metric nan, valid_metric 0.054361
[4142451:MainThread](2024-04-06 16:34:58,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.983893, valid_loss 1.003127, train_metric nan, valid_metric 0.048983
[4142451:MainThread](2024-04-06 16:34:58,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.994057, valid_loss 0.996617, train_metric nan, valid_metric 0.036899
[4142451:MainThread](2024-04-06 16:34:58,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.987422, valid_loss 0.995016, train_metric nan, valid_metric 0.053154
[4142451:MainThread](2024-04-06 16:34:58,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.992044, valid_loss 0.995976, train_metric nan, valid_metric 0.046287
[4142451:MainThread](2024-04-06 16:34:58,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.984063, valid_loss 0.997392, train_metric nan, valid_metric 0.041151
[4142451:MainThread](2024-04-06 16:34:59,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.991633, valid_loss 0.998043, train_metric nan, valid_metric 0.042732
[4142451:MainThread](2024-04-06 16:34:59,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.986433, valid_loss 0.996840, train_metric nan, valid_metric 0.043351
[4142451:MainThread](2024-04-06 16:34:59,390) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.978617, valid_loss 0.995053, train_metric nan, valid_metric 0.049518
[4142451:MainThread](2024-04-06 16:34:59,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.987747, valid_loss 0.997596, train_metric nan, valid_metric 0.040975
[4142451:MainThread](2024-04-06 16:34:59,661) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.985059, valid_loss 0.996057, train_metric nan, valid_metric 0.048704
[4142451:MainThread](2024-04-06 16:34:59,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.982980, valid_loss 0.996628, train_metric nan, valid_metric 0.043112
[4142451:MainThread](2024-04-06 16:34:59,935) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.977716, valid_loss 0.997396, train_metric nan, valid_metric 0.038729
[4142451:MainThread](2024-04-06 16:35:00,107) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.988291, valid_loss 0.996072, train_metric nan, valid_metric 0.045630
[4142451:MainThread](2024-04-06 16:35:00,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.979261, valid_loss 0.995342, train_metric nan, valid_metric 0.047563
[4142451:MainThread](2024-04-06 16:35:00,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.980857, valid_loss 0.997632, train_metric nan, valid_metric 0.037693
[4142451:MainThread](2024-04-06 16:35:00,561) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.983536, valid_loss 0.996207, train_metric nan, valid_metric 0.040649
[4142451:MainThread](2024-04-06 16:35:00,701) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.975759, valid_loss 0.996136, train_metric nan, valid_metric 0.045906
[4142451:MainThread](2024-04-06 16:35:00,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.981469, valid_loss 0.996106, train_metric nan, valid_metric 0.044959
[4142451:MainThread](2024-04-06 16:35:01,017) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.991830, valid_loss 0.996145, train_metric nan, valid_metric 0.046865
[4142451:MainThread](2024-04-06 16:35:01,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.981487, valid_loss 0.995691, train_metric nan, valid_metric 0.047078
[4142451:MainThread](2024-04-06 16:35:01,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.983866, valid_loss 0.997092, train_metric nan, valid_metric 0.043923
[4142451:MainThread](2024-04-06 16:35:01,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.982237, valid_loss 0.997251, train_metric nan, valid_metric 0.044697
[4142451:MainThread](2024-04-06 16:35:01,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.987284, valid_loss 0.996671, train_metric nan, valid_metric 0.044636
[4142451:MainThread](2024-04-06 16:35:01,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.972881, valid_loss 0.995442, train_metric nan, valid_metric 0.044856
[4142451:MainThread](2024-04-06 16:35:01,931) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.980172, valid_loss 0.995966, train_metric nan, valid_metric 0.042547
[4142451:MainThread](2024-04-06 16:35:02,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.984593, valid_loss 0.995622, train_metric nan, valid_metric 0.042573
[4142451:MainThread](2024-04-06 16:35:02,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.982173, valid_loss 0.995674, train_metric nan, valid_metric 0.041236
[4142451:MainThread](2024-04-06 16:35:02,380) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.980125, valid_loss 0.996320, train_metric nan, valid_metric 0.039905
[4142451:MainThread](2024-04-06 16:35:02,525) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.981520, valid_loss 0.998027, train_metric nan, valid_metric 0.042474
[4142451:MainThread](2024-04-06 16:35:02,672) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.986796, valid_loss 0.995762, train_metric nan, valid_metric 0.046277
[4142451:MainThread](2024-04-06 16:35:02,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.988086, valid_loss 0.996552, train_metric nan, valid_metric 0.044408
[4142451:MainThread](2024-04-06 16:35:02,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.998280, valid_loss 0.995794, train_metric nan, valid_metric 0.045154
[4142451:MainThread](2024-04-06 16:35:03,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.978881, valid_loss 0.996183, train_metric nan, valid_metric 0.044302
[4142451:MainThread](2024-04-06 16:35:03,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.983593, valid_loss 0.995666, train_metric nan, valid_metric 0.039731
[4142451:MainThread](2024-04-06 16:35:03,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.981388, valid_loss 0.995342, train_metric nan, valid_metric 0.039821
[4142451:MainThread](2024-04-06 16:35:03,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.977999, valid_loss 0.995922, train_metric nan, valid_metric 0.044503
[4142451:MainThread](2024-04-06 16:35:03,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.984506, valid_loss 0.995465, train_metric nan, valid_metric 0.044742
[4142451:MainThread](2024-04-06 16:35:03,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.988093, valid_loss 0.995627, train_metric nan, valid_metric 0.045747
[4142451:MainThread](2024-04-06 16:35:04,039) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.982847, valid_loss 0.995614, train_metric nan, valid_metric 0.047283
[4142451:MainThread](2024-04-06 16:35:04,205) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.978658, valid_loss 0.996289, train_metric nan, valid_metric 0.046204
[4142451:MainThread](2024-04-06 16:35:04,352) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.990569, valid_loss 0.995842, train_metric nan, valid_metric 0.045476
[4142451:MainThread](2024-04-06 16:35:04,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.972905, valid_loss 0.996086, train_metric nan, valid_metric 0.042083
[4142451:MainThread](2024-04-06 16:35:04,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.985786, valid_loss 0.996295, train_metric nan, valid_metric 0.044549
[4142451:MainThread](2024-04-06 16:35:04,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:35:05,298) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:35:06,103) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  90%|█████████ | 47/52 [15:30<01:35, 19.20s/it][4142451:MainThread](2024-04-06 16:35:06,111) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:35:06,123) INFO - qlib.workflow - [recorder.py:341] - Recorder 4f7de09dd5a0413cafe5914169e0f5da starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:35:06,813) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:35:06,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:35:06,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:35:06,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:35:10,320) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:35:10,641) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.317289, valid_loss 1.038997, train_metric nan, valid_metric 0.027101
[4142451:MainThread](2024-04-06 16:35:10,641) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.038997, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:35:10,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.102892, valid_loss 1.067375, train_metric nan, valid_metric 0.003132
[4142451:MainThread](2024-04-06 16:35:10,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.071775, valid_loss 1.126086, train_metric nan, valid_metric 0.027438
[4142451:MainThread](2024-04-06 16:35:11,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.049907, valid_loss 1.052339, train_metric nan, valid_metric 0.025652
[4142451:MainThread](2024-04-06 16:35:11,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.038788, valid_loss 1.028876, train_metric nan, valid_metric 0.028673
[4142451:MainThread](2024-04-06 16:35:11,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.038997 to 1.028876, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:11,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.035125, valid_loss 1.012352, train_metric nan, valid_metric 0.018938
[4142451:MainThread](2024-04-06 16:35:11,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.028876 to 1.012352, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:11,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.032622, valid_loss 1.031173, train_metric nan, valid_metric 0.030030
[4142451:MainThread](2024-04-06 16:35:11,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.037093, valid_loss 1.022224, train_metric nan, valid_metric 0.013029
[4142451:MainThread](2024-04-06 16:35:11,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.046599, valid_loss 1.015532, train_metric nan, valid_metric 0.013455
[4142451:MainThread](2024-04-06 16:35:12,053) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.021589, valid_loss 1.011532, train_metric nan, valid_metric 0.013770
[4142451:MainThread](2024-04-06 16:35:12,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.012352 to 1.011532, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:12,205) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.011482, valid_loss 1.007140, train_metric nan, valid_metric 0.023507
[4142451:MainThread](2024-04-06 16:35:12,205) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.011532 to 1.007140, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:12,354) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.011011, valid_loss 1.022518, train_metric nan, valid_metric 0.017110
[4142451:MainThread](2024-04-06 16:35:12,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.993648, valid_loss 1.034548, train_metric nan, valid_metric 0.031192
[4142451:MainThread](2024-04-06 16:35:12,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.000378, valid_loss 1.009726, train_metric nan, valid_metric 0.019944
[4142451:MainThread](2024-04-06 16:35:12,832) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.988144, valid_loss 1.010160, train_metric nan, valid_metric 0.020991
[4142451:MainThread](2024-04-06 16:35:12,976) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.007479, valid_loss 1.001925, train_metric nan, valid_metric 0.047822
[4142451:MainThread](2024-04-06 16:35:12,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.007140 to 1.001925, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:13,126) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.009342, valid_loss 1.005384, train_metric nan, valid_metric 0.028466
[4142451:MainThread](2024-04-06 16:35:13,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.006481, valid_loss 1.001782, train_metric nan, valid_metric 0.023833
[4142451:MainThread](2024-04-06 16:35:13,275) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001925 to 1.001782, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:13,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.981887, valid_loss 0.999292, train_metric nan, valid_metric 0.029063
[4142451:MainThread](2024-04-06 16:35:13,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001782 to 0.999292, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:13,593) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.990610, valid_loss 1.003299, train_metric nan, valid_metric 0.026214
[4142451:MainThread](2024-04-06 16:35:13,739) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.996997, valid_loss 1.017653, train_metric nan, valid_metric 0.019477
[4142451:MainThread](2024-04-06 16:35:13,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.995077, valid_loss 1.005671, train_metric nan, valid_metric 0.022447
[4142451:MainThread](2024-04-06 16:35:14,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.990971, valid_loss 1.003120, train_metric nan, valid_metric 0.022252
[4142451:MainThread](2024-04-06 16:35:14,170) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.001930, valid_loss 1.013517, train_metric nan, valid_metric 0.036797
[4142451:MainThread](2024-04-06 16:35:14,326) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.999283, valid_loss 1.001338, train_metric nan, valid_metric 0.019973
[4142451:MainThread](2024-04-06 16:35:14,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.997669, valid_loss 1.001462, train_metric nan, valid_metric 0.022417
[4142451:MainThread](2024-04-06 16:35:14,673) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.997898, valid_loss 1.002965, train_metric nan, valid_metric 0.014569
[4142451:MainThread](2024-04-06 16:35:14,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.990379, valid_loss 1.000616, train_metric nan, valid_metric 0.022889
[4142451:MainThread](2024-04-06 16:35:15,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.995350, valid_loss 1.005341, train_metric nan, valid_metric 0.008367
[4142451:MainThread](2024-04-06 16:35:15,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.992956, valid_loss 1.000629, train_metric nan, valid_metric 0.032100
[4142451:MainThread](2024-04-06 16:35:15,306) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.988699, valid_loss 1.000028, train_metric nan, valid_metric 0.023705
[4142451:MainThread](2024-04-06 16:35:15,452) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.999144, valid_loss 1.000753, train_metric nan, valid_metric 0.019649
[4142451:MainThread](2024-04-06 16:35:15,631) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.998349, valid_loss 0.998025, train_metric nan, valid_metric 0.029078
[4142451:MainThread](2024-04-06 16:35:15,631) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999292 to 0.998025, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:15,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.986115, valid_loss 0.998287, train_metric nan, valid_metric 0.038584
[4142451:MainThread](2024-04-06 16:35:15,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.999228, valid_loss 0.998456, train_metric nan, valid_metric 0.030917
[4142451:MainThread](2024-04-06 16:35:16,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.998314, valid_loss 1.001266, train_metric nan, valid_metric 0.027712
[4142451:MainThread](2024-04-06 16:35:16,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.986562, valid_loss 0.999989, train_metric nan, valid_metric 0.023689
[4142451:MainThread](2024-04-06 16:35:16,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.979053, valid_loss 1.001507, train_metric nan, valid_metric 0.022959
[4142451:MainThread](2024-04-06 16:35:16,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.990700, valid_loss 0.999212, train_metric nan, valid_metric 0.024665
[4142451:MainThread](2024-04-06 16:35:16,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.990630, valid_loss 0.996642, train_metric nan, valid_metric 0.037365
[4142451:MainThread](2024-04-06 16:35:16,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998025 to 0.996642, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:16,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.984390, valid_loss 0.999459, train_metric nan, valid_metric 0.025974
[4142451:MainThread](2024-04-06 16:35:16,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.994189, valid_loss 1.000752, train_metric nan, valid_metric 0.027421
[4142451:MainThread](2024-04-06 16:35:17,059) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.989414, valid_loss 1.002179, train_metric nan, valid_metric 0.020270
[4142451:MainThread](2024-04-06 16:35:17,203) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.981528, valid_loss 0.999011, train_metric nan, valid_metric 0.029955
[4142451:MainThread](2024-04-06 16:35:17,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.986141, valid_loss 1.001346, train_metric nan, valid_metric 0.019888
[4142451:MainThread](2024-04-06 16:35:17,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.989966, valid_loss 0.998142, train_metric nan, valid_metric 0.030619
[4142451:MainThread](2024-04-06 16:35:17,669) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.991970, valid_loss 0.998228, train_metric nan, valid_metric 0.033540
[4142451:MainThread](2024-04-06 16:35:17,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.982789, valid_loss 0.997735, train_metric nan, valid_metric 0.029697
[4142451:MainThread](2024-04-06 16:35:17,955) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.996432, valid_loss 0.998698, train_metric nan, valid_metric 0.026366
[4142451:MainThread](2024-04-06 16:35:18,098) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.989525, valid_loss 1.002742, train_metric nan, valid_metric 0.024753
[4142451:MainThread](2024-04-06 16:35:18,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.977316, valid_loss 0.998771, train_metric nan, valid_metric 0.028848
[4142451:MainThread](2024-04-06 16:35:18,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.984337, valid_loss 0.998686, train_metric nan, valid_metric 0.029553
[4142451:MainThread](2024-04-06 16:35:18,585) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.987184, valid_loss 0.999651, train_metric nan, valid_metric 0.028377
[4142451:MainThread](2024-04-06 16:35:18,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.985796, valid_loss 1.000442, train_metric nan, valid_metric 0.018074
[4142451:MainThread](2024-04-06 16:35:18,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.000620, valid_loss 1.000210, train_metric nan, valid_metric 0.019108
[4142451:MainThread](2024-04-06 16:35:19,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.997179, valid_loss 0.997344, train_metric nan, valid_metric 0.032549
[4142451:MainThread](2024-04-06 16:35:19,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.987462, valid_loss 0.999415, train_metric nan, valid_metric 0.025390
[4142451:MainThread](2024-04-06 16:35:19,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.980260, valid_loss 1.000010, train_metric nan, valid_metric 0.023261
[4142451:MainThread](2024-04-06 16:35:19,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.992386, valid_loss 1.000880, train_metric nan, valid_metric 0.022624
[4142451:MainThread](2024-04-06 16:35:19,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.990842, valid_loss 0.998948, train_metric nan, valid_metric 0.027765
[4142451:MainThread](2024-04-06 16:35:19,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.975743, valid_loss 0.998232, train_metric nan, valid_metric 0.020277
[4142451:MainThread](2024-04-06 16:35:20,021) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.985500, valid_loss 0.998176, train_metric nan, valid_metric 0.024567
[4142451:MainThread](2024-04-06 16:35:20,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.975510, valid_loss 0.999715, train_metric nan, valid_metric 0.023883
[4142451:MainThread](2024-04-06 16:35:20,328) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.984920, valid_loss 0.999873, train_metric nan, valid_metric 0.024167
[4142451:MainThread](2024-04-06 16:35:20,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.987830, valid_loss 1.000062, train_metric nan, valid_metric 0.024284
[4142451:MainThread](2024-04-06 16:35:20,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.997810, valid_loss 1.000371, train_metric nan, valid_metric 0.022648
[4142451:MainThread](2024-04-06 16:35:20,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.975035, valid_loss 0.998687, train_metric nan, valid_metric 0.030862
[4142451:MainThread](2024-04-06 16:35:20,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.978583, valid_loss 0.999454, train_metric nan, valid_metric 0.027012
[4142451:MainThread](2024-04-06 16:35:21,062) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.985072, valid_loss 0.998918, train_metric nan, valid_metric 0.024676
[4142451:MainThread](2024-04-06 16:35:21,205) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.994687, valid_loss 0.999743, train_metric nan, valid_metric 0.025079
[4142451:MainThread](2024-04-06 16:35:21,349) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.988685, valid_loss 1.000064, train_metric nan, valid_metric 0.018961
[4142451:MainThread](2024-04-06 16:35:21,494) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.985509, valid_loss 0.998325, train_metric nan, valid_metric 0.024655
[4142451:MainThread](2024-04-06 16:35:21,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.977127, valid_loss 0.999903, train_metric nan, valid_metric 0.021465
[4142451:MainThread](2024-04-06 16:35:21,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.983415, valid_loss 1.000021, train_metric nan, valid_metric 0.016736
[4142451:MainThread](2024-04-06 16:35:21,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.989303, valid_loss 0.998601, train_metric nan, valid_metric 0.023834
[4142451:MainThread](2024-04-06 16:35:22,075) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.992831, valid_loss 1.000242, train_metric nan, valid_metric 0.025740
[4142451:MainThread](2024-04-06 16:35:22,211) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.991757, valid_loss 0.999875, train_metric nan, valid_metric 0.025797
[4142451:MainThread](2024-04-06 16:35:22,349) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.990984, valid_loss 0.999336, train_metric nan, valid_metric 0.020496
[4142451:MainThread](2024-04-06 16:35:22,515) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.988531, valid_loss 0.999397, train_metric nan, valid_metric 0.025687
[4142451:MainThread](2024-04-06 16:35:22,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.988981, valid_loss 0.999890, train_metric nan, valid_metric 0.024613
[4142451:MainThread](2024-04-06 16:35:22,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.991711, valid_loss 0.998885, train_metric nan, valid_metric 0.026129
[4142451:MainThread](2024-04-06 16:35:22,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.990584, valid_loss 0.997184, train_metric nan, valid_metric 0.025827
[4142451:MainThread](2024-04-06 16:35:23,143) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.975602, valid_loss 0.999370, train_metric nan, valid_metric 0.021542
[4142451:MainThread](2024-04-06 16:35:23,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.996780, valid_loss 0.998598, train_metric nan, valid_metric 0.014674
[4142451:MainThread](2024-04-06 16:35:23,468) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.988831, valid_loss 0.998707, train_metric nan, valid_metric 0.020791
[4142451:MainThread](2024-04-06 16:35:23,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.990776, valid_loss 0.998804, train_metric nan, valid_metric 0.019651
[4142451:MainThread](2024-04-06 16:35:23,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.986358, valid_loss 0.999831, train_metric nan, valid_metric 0.023842
[4142451:MainThread](2024-04-06 16:35:23,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.983310, valid_loss 0.999969, train_metric nan, valid_metric 0.022539
[4142451:MainThread](2024-04-06 16:35:24,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.990038, valid_loss 0.998323, train_metric nan, valid_metric 0.019961
[4142451:MainThread](2024-04-06 16:35:24,192) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.993749, valid_loss 0.999047, train_metric nan, valid_metric 0.022009
[4142451:MainThread](2024-04-06 16:35:24,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:35:25,012) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:35:25,885) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  92%|█████████▏| 48/52 [15:50<01:17, 19.37s/it][4142451:MainThread](2024-04-06 16:35:25,894) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:35:25,904) INFO - qlib.workflow - [recorder.py:341] - Recorder faf594a92aac4266bb360c34c6f26400 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:35:26,516) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:35:26,517) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:35:26,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:35:26,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:35:30,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:35:30,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.320708, valid_loss 1.045957, train_metric nan, valid_metric 0.002859
[4142451:MainThread](2024-04-06 16:35:30,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.045957, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:35:30,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.102802, valid_loss 1.028469, train_metric nan, valid_metric 0.013667
[4142451:MainThread](2024-04-06 16:35:30,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.045957 to 1.028469, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:30,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.078678, valid_loss 1.026834, train_metric nan, valid_metric 0.009649
[4142451:MainThread](2024-04-06 16:35:30,707) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.028469 to 1.026834, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:30,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.062256, valid_loss 1.012197, train_metric nan, valid_metric 0.025162
[4142451:MainThread](2024-04-06 16:35:30,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.026834 to 1.012197, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:31,013) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.052830, valid_loss 1.013443, train_metric nan, valid_metric 0.036754
[4142451:MainThread](2024-04-06 16:35:31,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.054647, valid_loss 1.003441, train_metric nan, valid_metric 0.033680
[4142451:MainThread](2024-04-06 16:35:31,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.012197 to 1.003441, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:31,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.053589, valid_loss 1.072629, train_metric nan, valid_metric 0.040357
[4142451:MainThread](2024-04-06 16:35:31,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.039564, valid_loss 1.010146, train_metric nan, valid_metric 0.036835
[4142451:MainThread](2024-04-06 16:35:31,594) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.012481, valid_loss 1.029635, train_metric nan, valid_metric 0.046330
[4142451:MainThread](2024-04-06 16:35:31,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.020313, valid_loss 1.001202, train_metric nan, valid_metric 0.045852
[4142451:MainThread](2024-04-06 16:35:31,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003441 to 1.001202, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:31,881) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.095645, valid_loss 1.026634, train_metric nan, valid_metric -0.000652
[4142451:MainThread](2024-04-06 16:35:32,047) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.042885, valid_loss 1.003570, train_metric nan, valid_metric 0.024467
[4142451:MainThread](2024-04-06 16:35:32,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.027194, valid_loss 0.997170, train_metric nan, valid_metric 0.054488
[4142451:MainThread](2024-04-06 16:35:32,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001202 to 0.997170, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:32,350) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.040931, valid_loss 1.017324, train_metric nan, valid_metric 0.009830
[4142451:MainThread](2024-04-06 16:35:32,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.025686, valid_loss 1.009530, train_metric nan, valid_metric 0.025135
[4142451:MainThread](2024-04-06 16:35:32,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.014807, valid_loss 1.000293, train_metric nan, valid_metric 0.041899
[4142451:MainThread](2024-04-06 16:35:32,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.019178, valid_loss 1.001982, train_metric nan, valid_metric 0.024427
[4142451:MainThread](2024-04-06 16:35:32,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.009860, valid_loss 1.000808, train_metric nan, valid_metric 0.029996
[4142451:MainThread](2024-04-06 16:35:33,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 0.998955, valid_loss 1.005469, train_metric nan, valid_metric 0.013600
[4142451:MainThread](2024-04-06 16:35:33,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.007546, valid_loss 1.007176, train_metric nan, valid_metric 0.022123
[4142451:MainThread](2024-04-06 16:35:33,413) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.001690, valid_loss 1.000745, train_metric nan, valid_metric 0.028398
[4142451:MainThread](2024-04-06 16:35:33,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.994703, valid_loss 1.004012, train_metric nan, valid_metric 0.021052
[4142451:MainThread](2024-04-06 16:35:33,767) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.999352, valid_loss 1.003234, train_metric nan, valid_metric 0.019636
[4142451:MainThread](2024-04-06 16:35:33,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.989642, valid_loss 1.003258, train_metric nan, valid_metric 0.023941
[4142451:MainThread](2024-04-06 16:35:34,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.000726, valid_loss 1.003576, train_metric nan, valid_metric 0.011948
[4142451:MainThread](2024-04-06 16:35:34,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.984026, valid_loss 1.002852, train_metric nan, valid_metric 0.010827
[4142451:MainThread](2024-04-06 16:35:34,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.000177, valid_loss 1.004103, train_metric nan, valid_metric 0.009780
[4142451:MainThread](2024-04-06 16:35:34,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.996367, valid_loss 0.999933, train_metric nan, valid_metric 0.033677
[4142451:MainThread](2024-04-06 16:35:34,710) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.001462, valid_loss 0.999967, train_metric nan, valid_metric 0.023978
[4142451:MainThread](2024-04-06 16:35:34,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.991018, valid_loss 1.000306, train_metric nan, valid_metric 0.020514
[4142451:MainThread](2024-04-06 16:35:34,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.992039, valid_loss 0.998864, train_metric nan, valid_metric 0.035071
[4142451:MainThread](2024-04-06 16:35:35,143) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.985039, valid_loss 0.998717, train_metric nan, valid_metric 0.032492
[4142451:MainThread](2024-04-06 16:35:35,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.999761, valid_loss 0.999470, train_metric nan, valid_metric 0.028646
[4142451:MainThread](2024-04-06 16:35:35,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.992722, valid_loss 1.000074, train_metric nan, valid_metric 0.025704
[4142451:MainThread](2024-04-06 16:35:35,582) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.987109, valid_loss 1.002337, train_metric nan, valid_metric 0.018281
[4142451:MainThread](2024-04-06 16:35:35,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.001462, valid_loss 1.001384, train_metric nan, valid_metric 0.019567
[4142451:MainThread](2024-04-06 16:35:35,876) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.994411, valid_loss 1.001062, train_metric nan, valid_metric 0.015939
[4142451:MainThread](2024-04-06 16:35:36,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.994431, valid_loss 1.000848, train_metric nan, valid_metric 0.019880
[4142451:MainThread](2024-04-06 16:35:36,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.994783, valid_loss 1.003432, train_metric nan, valid_metric 0.010567
[4142451:MainThread](2024-04-06 16:35:36,305) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.988995, valid_loss 1.000267, train_metric nan, valid_metric 0.023983
[4142451:MainThread](2024-04-06 16:35:36,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.985239, valid_loss 0.999889, train_metric nan, valid_metric 0.022878
[4142451:MainThread](2024-04-06 16:35:36,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.999646, valid_loss 1.000148, train_metric nan, valid_metric 0.019287
[4142451:MainThread](2024-04-06 16:35:36,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.985584, valid_loss 1.001814, train_metric nan, valid_metric 0.012159
[4142451:MainThread](2024-04-06 16:35:36,892) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.997987, valid_loss 1.003770, train_metric nan, valid_metric 0.007917
[4142451:MainThread](2024-04-06 16:35:37,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.987608, valid_loss 1.000180, train_metric nan, valid_metric 0.021585
[4142451:MainThread](2024-04-06 16:35:37,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.989859, valid_loss 1.000884, train_metric nan, valid_metric 0.017140
[4142451:MainThread](2024-04-06 16:35:37,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.993166, valid_loss 1.001850, train_metric nan, valid_metric 0.016785
[4142451:MainThread](2024-04-06 16:35:37,528) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.980865, valid_loss 1.001125, train_metric nan, valid_metric 0.019349
[4142451:MainThread](2024-04-06 16:35:37,702) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.998143, valid_loss 0.998835, train_metric nan, valid_metric 0.024720
[4142451:MainThread](2024-04-06 16:35:37,873) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.991457, valid_loss 1.001681, train_metric nan, valid_metric 0.015514
[4142451:MainThread](2024-04-06 16:35:38,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.995732, valid_loss 1.000486, train_metric nan, valid_metric 0.018902
[4142451:MainThread](2024-04-06 16:35:38,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.986693, valid_loss 1.001343, train_metric nan, valid_metric 0.015710
[4142451:MainThread](2024-04-06 16:35:38,359) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.990395, valid_loss 1.000560, train_metric nan, valid_metric 0.017280
[4142451:MainThread](2024-04-06 16:35:38,527) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.999077, valid_loss 1.000944, train_metric nan, valid_metric 0.018539
[4142451:MainThread](2024-04-06 16:35:38,696) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.992161, valid_loss 1.000969, train_metric nan, valid_metric 0.021131
[4142451:MainThread](2024-04-06 16:35:38,838) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.993365, valid_loss 1.001155, train_metric nan, valid_metric 0.019888
[4142451:MainThread](2024-04-06 16:35:38,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.989391, valid_loss 1.002609, train_metric nan, valid_metric 0.014016
[4142451:MainThread](2024-04-06 16:35:39,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.991038, valid_loss 1.000573, train_metric nan, valid_metric 0.017235
[4142451:MainThread](2024-04-06 16:35:39,281) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.988558, valid_loss 1.000421, train_metric nan, valid_metric 0.016561
[4142451:MainThread](2024-04-06 16:35:39,425) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.989156, valid_loss 1.002880, train_metric nan, valid_metric 0.014303
[4142451:MainThread](2024-04-06 16:35:39,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.993142, valid_loss 0.998921, train_metric nan, valid_metric 0.021128
[4142451:MainThread](2024-04-06 16:35:39,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.992662, valid_loss 1.000715, train_metric nan, valid_metric 0.017759
[4142451:MainThread](2024-04-06 16:35:39,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.995293, valid_loss 1.001157, train_metric nan, valid_metric 0.021510
[4142451:MainThread](2024-04-06 16:35:39,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:35:40,949) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:35:41,808) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  94%|█████████▍| 49/52 [16:06<00:55, 18.34s/it][4142451:MainThread](2024-04-06 16:35:41,817) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:35:41,827) INFO - qlib.workflow - [recorder.py:341] - Recorder 992add0922c94f32b3c7d65565748bc3 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:35:42,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:35:42,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:35:42,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:35:42,440) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:35:45,907) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:35:46,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.427568, valid_loss 1.030943, train_metric nan, valid_metric 0.005876
[4142451:MainThread](2024-04-06 16:35:46,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.030943, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:35:46,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.125456, valid_loss 1.043628, train_metric nan, valid_metric -0.011515
[4142451:MainThread](2024-04-06 16:35:46,505) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.074416, valid_loss 1.041057, train_metric nan, valid_metric 0.006500
[4142451:MainThread](2024-04-06 16:35:46,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.085902, valid_loss 1.071795, train_metric nan, valid_metric -0.007128
[4142451:MainThread](2024-04-06 16:35:46,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.107648, valid_loss 1.163601, train_metric nan, valid_metric -0.004298
[4142451:MainThread](2024-04-06 16:35:46,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.049780, valid_loss 1.021869, train_metric nan, valid_metric 0.022405
[4142451:MainThread](2024-04-06 16:35:46,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.030943 to 1.021869, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:47,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.031939, valid_loss 1.023135, train_metric nan, valid_metric 0.027153
[4142451:MainThread](2024-04-06 16:35:47,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.031865, valid_loss 1.006342, train_metric nan, valid_metric 0.029752
[4142451:MainThread](2024-04-06 16:35:47,242) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.021869 to 1.006342, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:47,386) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.026515, valid_loss 1.011541, train_metric nan, valid_metric 0.035016
[4142451:MainThread](2024-04-06 16:35:47,533) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.016446, valid_loss 1.006073, train_metric nan, valid_metric 0.016031
[4142451:MainThread](2024-04-06 16:35:47,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006342 to 1.006073, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:47,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.030315, valid_loss 1.015846, train_metric nan, valid_metric 0.004789
[4142451:MainThread](2024-04-06 16:35:47,830) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.021729, valid_loss 1.013821, train_metric nan, valid_metric 0.013359
[4142451:MainThread](2024-04-06 16:35:47,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.013601, valid_loss 1.002166, train_metric nan, valid_metric 0.029877
[4142451:MainThread](2024-04-06 16:35:47,995) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006073 to 1.002166, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:48,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.008044, valid_loss 1.004905, train_metric nan, valid_metric 0.025482
[4142451:MainThread](2024-04-06 16:35:48,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.002326, valid_loss 1.006826, train_metric nan, valid_metric 0.029426
[4142451:MainThread](2024-04-06 16:35:48,410) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.996762, valid_loss 1.018439, train_metric nan, valid_metric 0.025236
[4142451:MainThread](2024-04-06 16:35:48,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.008933, valid_loss 1.014808, train_metric nan, valid_metric 0.026048
[4142451:MainThread](2024-04-06 16:35:48,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.005845, valid_loss 1.004422, train_metric nan, valid_metric 0.028903
[4142451:MainThread](2024-04-06 16:35:48,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.002892, valid_loss 1.003243, train_metric nan, valid_metric 0.019602
[4142451:MainThread](2024-04-06 16:35:49,013) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.002729, valid_loss 0.998414, train_metric nan, valid_metric 0.039909
[4142451:MainThread](2024-04-06 16:35:49,014) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.002166 to 0.998414, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:49,158) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.995880, valid_loss 0.999153, train_metric nan, valid_metric 0.032191
[4142451:MainThread](2024-04-06 16:35:49,297) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.995219, valid_loss 0.999983, train_metric nan, valid_metric 0.036589
[4142451:MainThread](2024-04-06 16:35:49,433) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.989809, valid_loss 1.000584, train_metric nan, valid_metric 0.024872
[4142451:MainThread](2024-04-06 16:35:49,577) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.001932, valid_loss 1.004252, train_metric nan, valid_metric 0.034677
[4142451:MainThread](2024-04-06 16:35:49,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.995246, valid_loss 1.000389, train_metric nan, valid_metric 0.023646
[4142451:MainThread](2024-04-06 16:35:49,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.994384, valid_loss 1.000281, train_metric nan, valid_metric 0.021973
[4142451:MainThread](2024-04-06 16:35:50,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.991933, valid_loss 1.002428, train_metric nan, valid_metric 0.019086
[4142451:MainThread](2024-04-06 16:35:50,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.989715, valid_loss 0.996400, train_metric nan, valid_metric 0.046685
[4142451:MainThread](2024-04-06 16:35:50,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998414 to 0.996400, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:50,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.990832, valid_loss 1.001722, train_metric nan, valid_metric 0.029335
[4142451:MainThread](2024-04-06 16:35:50,516) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.999220, valid_loss 1.002321, train_metric nan, valid_metric 0.021113
[4142451:MainThread](2024-04-06 16:35:50,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.986244, valid_loss 0.997707, train_metric nan, valid_metric 0.035990
[4142451:MainThread](2024-04-06 16:35:50,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.990980, valid_loss 1.003835, train_metric nan, valid_metric 0.038547
[4142451:MainThread](2024-04-06 16:35:50,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.993872, valid_loss 0.996333, train_metric nan, valid_metric 0.043765
[4142451:MainThread](2024-04-06 16:35:50,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.996400 to 0.996333, save checkpoint.
[4142451:MainThread](2024-04-06 16:35:51,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.983303, valid_loss 1.001301, train_metric nan, valid_metric 0.020875
[4142451:MainThread](2024-04-06 16:35:51,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.991097, valid_loss 1.003520, train_metric nan, valid_metric 0.010587
[4142451:MainThread](2024-04-06 16:35:51,390) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.993066, valid_loss 1.001485, train_metric nan, valid_metric 0.016012
[4142451:MainThread](2024-04-06 16:35:51,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.988857, valid_loss 1.011086, train_metric nan, valid_metric 0.012885
[4142451:MainThread](2024-04-06 16:35:51,673) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.986217, valid_loss 1.003630, train_metric nan, valid_metric 0.015761
[4142451:MainThread](2024-04-06 16:35:51,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.984910, valid_loss 0.998325, train_metric nan, valid_metric 0.022917
[4142451:MainThread](2024-04-06 16:35:51,967) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.983092, valid_loss 0.999981, train_metric nan, valid_metric 0.012412
[4142451:MainThread](2024-04-06 16:35:52,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.985920, valid_loss 1.000093, train_metric nan, valid_metric 0.022215
[4142451:MainThread](2024-04-06 16:35:52,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.978861, valid_loss 1.001948, train_metric nan, valid_metric 0.015872
[4142451:MainThread](2024-04-06 16:35:52,396) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.990835, valid_loss 0.999803, train_metric nan, valid_metric 0.023096
[4142451:MainThread](2024-04-06 16:35:52,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.993014, valid_loss 1.000396, train_metric nan, valid_metric 0.020836
[4142451:MainThread](2024-04-06 16:35:52,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.989021, valid_loss 0.999869, train_metric nan, valid_metric 0.023635
[4142451:MainThread](2024-04-06 16:35:52,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.986844, valid_loss 1.001767, train_metric nan, valid_metric 0.020458
[4142451:MainThread](2024-04-06 16:35:52,967) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.996570, valid_loss 0.998772, train_metric nan, valid_metric 0.025074
[4142451:MainThread](2024-04-06 16:35:53,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.986091, valid_loss 0.999563, train_metric nan, valid_metric 0.023987
[4142451:MainThread](2024-04-06 16:35:53,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.979164, valid_loss 1.003136, train_metric nan, valid_metric 0.006542
[4142451:MainThread](2024-04-06 16:35:53,400) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.987472, valid_loss 0.998642, train_metric nan, valid_metric 0.024159
[4142451:MainThread](2024-04-06 16:35:53,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.994468, valid_loss 0.998542, train_metric nan, valid_metric 0.024503
[4142451:MainThread](2024-04-06 16:35:53,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.993694, valid_loss 1.001710, train_metric nan, valid_metric 0.017279
[4142451:MainThread](2024-04-06 16:35:53,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.983316, valid_loss 0.998606, train_metric nan, valid_metric 0.032484
[4142451:MainThread](2024-04-06 16:35:54,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.996471, valid_loss 1.000859, train_metric nan, valid_metric 0.020599
[4142451:MainThread](2024-04-06 16:35:54,142) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.979975, valid_loss 0.999984, train_metric nan, valid_metric 0.021412
[4142451:MainThread](2024-04-06 16:35:54,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.974644, valid_loss 1.000475, train_metric nan, valid_metric 0.020388
[4142451:MainThread](2024-04-06 16:35:54,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.997307, valid_loss 1.001717, train_metric nan, valid_metric 0.016511
[4142451:MainThread](2024-04-06 16:35:54,573) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.988627, valid_loss 1.000499, train_metric nan, valid_metric 0.024843
[4142451:MainThread](2024-04-06 16:35:54,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.980900, valid_loss 0.999807, train_metric nan, valid_metric 0.025069
[4142451:MainThread](2024-04-06 16:35:54,868) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.987500, valid_loss 1.000519, train_metric nan, valid_metric 0.021381
[4142451:MainThread](2024-04-06 16:35:55,035) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.988501, valid_loss 1.001171, train_metric nan, valid_metric 0.019415
[4142451:MainThread](2024-04-06 16:35:55,183) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.977594, valid_loss 0.997761, train_metric nan, valid_metric 0.027722
[4142451:MainThread](2024-04-06 16:35:55,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.995370, valid_loss 0.998463, train_metric nan, valid_metric 0.025936
[4142451:MainThread](2024-04-06 16:35:55,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.989574, valid_loss 0.999017, train_metric nan, valid_metric 0.028180
[4142451:MainThread](2024-04-06 16:35:55,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.988795, valid_loss 1.002050, train_metric nan, valid_metric 0.017234
[4142451:MainThread](2024-04-06 16:35:55,760) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.983417, valid_loss 0.999603, train_metric nan, valid_metric 0.026386
[4142451:MainThread](2024-04-06 16:35:55,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.984898, valid_loss 1.001695, train_metric nan, valid_metric 0.016812
[4142451:MainThread](2024-04-06 16:35:56,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.987608, valid_loss 1.000099, train_metric nan, valid_metric 0.023644
[4142451:MainThread](2024-04-06 16:35:56,242) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.993844, valid_loss 0.999210, train_metric nan, valid_metric 0.024994
[4142451:MainThread](2024-04-06 16:35:56,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.990680, valid_loss 1.000657, train_metric nan, valid_metric 0.019594
[4142451:MainThread](2024-04-06 16:35:56,545) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.981763, valid_loss 0.999807, train_metric nan, valid_metric 0.024822
[4142451:MainThread](2024-04-06 16:35:56,690) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.987238, valid_loss 0.999891, train_metric nan, valid_metric 0.025096
[4142451:MainThread](2024-04-06 16:35:56,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.977960, valid_loss 0.999424, train_metric nan, valid_metric 0.020944
[4142451:MainThread](2024-04-06 16:35:56,995) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.980572, valid_loss 1.000348, train_metric nan, valid_metric 0.021702
[4142451:MainThread](2024-04-06 16:35:57,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.988398, valid_loss 0.998734, train_metric nan, valid_metric 0.025715
[4142451:MainThread](2024-04-06 16:35:57,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.981271, valid_loss 1.000306, train_metric nan, valid_metric 0.022707
[4142451:MainThread](2024-04-06 16:35:57,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.981368, valid_loss 0.999226, train_metric nan, valid_metric 0.022076
[4142451:MainThread](2024-04-06 16:35:57,608) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.990012, valid_loss 0.998368, train_metric nan, valid_metric 0.020307
[4142451:MainThread](2024-04-06 16:35:57,741) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.981618, valid_loss 0.999473, train_metric nan, valid_metric 0.021151
[4142451:MainThread](2024-04-06 16:35:57,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.986419, valid_loss 1.000306, train_metric nan, valid_metric 0.023161
[4142451:MainThread](2024-04-06 16:35:58,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.992396, valid_loss 0.998402, train_metric nan, valid_metric 0.021990
[4142451:MainThread](2024-04-06 16:35:58,214) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.982789, valid_loss 1.000038, train_metric nan, valid_metric 0.020699
[4142451:MainThread](2024-04-06 16:35:58,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.986305, valid_loss 0.999583, train_metric nan, valid_metric 0.023279
[4142451:MainThread](2024-04-06 16:35:58,359) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:35:59,177) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:36:00,046) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  96%|█████████▌| 50/52 [16:24<00:36, 18.31s/it][4142451:MainThread](2024-04-06 16:36:00,054) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:36:00,064) INFO - qlib.workflow - [recorder.py:341] - Recorder 015db19671d54fc2b1cbfe039bafa0b3 starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:36:00,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:36:00,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:36:00,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:36:00,663) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:36:04,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:36:04,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.305469, valid_loss 1.050664, train_metric nan, valid_metric 0.013855
[4142451:MainThread](2024-04-06 16:36:04,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.050664, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:36:04,852) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.099296, valid_loss 1.048268, train_metric nan, valid_metric 0.039748
[4142451:MainThread](2024-04-06 16:36:04,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.050664 to 1.048268, save checkpoint.
[4142451:MainThread](2024-04-06 16:36:05,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.077301, valid_loss 1.033887, train_metric nan, valid_metric -0.002780
[4142451:MainThread](2024-04-06 16:36:05,004) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.048268 to 1.033887, save checkpoint.
[4142451:MainThread](2024-04-06 16:36:05,163) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.069244, valid_loss 1.018103, train_metric nan, valid_metric 0.042175
[4142451:MainThread](2024-04-06 16:36:05,163) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.033887 to 1.018103, save checkpoint.
[4142451:MainThread](2024-04-06 16:36:05,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.048689, valid_loss 1.086757, train_metric nan, valid_metric 0.026855
[4142451:MainThread](2024-04-06 16:36:05,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.040611, valid_loss 1.009737, train_metric nan, valid_metric 0.028268
[4142451:MainThread](2024-04-06 16:36:05,424) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.018103 to 1.009737, save checkpoint.
[4142451:MainThread](2024-04-06 16:36:05,585) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.061722, valid_loss 1.043371, train_metric nan, valid_metric 0.008901
[4142451:MainThread](2024-04-06 16:36:05,732) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.135431, valid_loss 1.145868, train_metric nan, valid_metric -0.004196
[4142451:MainThread](2024-04-06 16:36:05,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.045563, valid_loss 1.021179, train_metric nan, valid_metric 0.043340
[4142451:MainThread](2024-04-06 16:36:06,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.015123, valid_loss 1.002602, train_metric nan, valid_metric 0.038268
[4142451:MainThread](2024-04-06 16:36:06,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.009737 to 1.002602, save checkpoint.
[4142451:MainThread](2024-04-06 16:36:06,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.020110, valid_loss 1.006505, train_metric nan, valid_metric 0.036843
[4142451:MainThread](2024-04-06 16:36:06,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.018758, valid_loss 1.010318, train_metric nan, valid_metric 0.022652
[4142451:MainThread](2024-04-06 16:36:06,484) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.018397, valid_loss 1.004115, train_metric nan, valid_metric 0.027154
[4142451:MainThread](2024-04-06 16:36:06,631) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.012215, valid_loss 1.000250, train_metric nan, valid_metric 0.041101
[4142451:MainThread](2024-04-06 16:36:06,631) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.002602 to 1.000250, save checkpoint.
[4142451:MainThread](2024-04-06 16:36:06,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.002067, valid_loss 1.006383, train_metric nan, valid_metric 0.026502
[4142451:MainThread](2024-04-06 16:36:06,942) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.999742, valid_loss 1.014097, train_metric nan, valid_metric 0.018773
[4142451:MainThread](2024-04-06 16:36:07,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.015687, valid_loss 1.000059, train_metric nan, valid_metric 0.045131
[4142451:MainThread](2024-04-06 16:36:07,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000250 to 1.000059, save checkpoint.
[4142451:MainThread](2024-04-06 16:36:07,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.012570, valid_loss 0.999339, train_metric nan, valid_metric 0.043012
[4142451:MainThread](2024-04-06 16:36:07,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000059 to 0.999339, save checkpoint.
[4142451:MainThread](2024-04-06 16:36:07,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.001985, valid_loss 1.023539, train_metric nan, valid_metric 0.026068
[4142451:MainThread](2024-04-06 16:36:07,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.019332, valid_loss 1.003087, train_metric nan, valid_metric 0.036549
[4142451:MainThread](2024-04-06 16:36:07,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.997309, valid_loss 0.993975, train_metric nan, valid_metric 0.059102
[4142451:MainThread](2024-04-06 16:36:07,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999339 to 0.993975, save checkpoint.
[4142451:MainThread](2024-04-06 16:36:07,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.006018, valid_loss 1.004062, train_metric nan, valid_metric 0.029170
[4142451:MainThread](2024-04-06 16:36:07,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.002761, valid_loss 1.003899, train_metric nan, valid_metric 0.036415
[4142451:MainThread](2024-04-06 16:36:08,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.000598, valid_loss 0.997298, train_metric nan, valid_metric 0.045432
[4142451:MainThread](2024-04-06 16:36:08,234) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.001591, valid_loss 1.006088, train_metric nan, valid_metric 0.028161
[4142451:MainThread](2024-04-06 16:36:08,380) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.003075, valid_loss 1.003357, train_metric nan, valid_metric 0.024626
[4142451:MainThread](2024-04-06 16:36:08,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.998621, valid_loss 1.017888, train_metric nan, valid_metric 0.044094
[4142451:MainThread](2024-04-06 16:36:08,731) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.988649, valid_loss 1.012249, train_metric nan, valid_metric 0.027238
[4142451:MainThread](2024-04-06 16:36:08,907) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.989548, valid_loss 0.997015, train_metric nan, valid_metric 0.043802
[4142451:MainThread](2024-04-06 16:36:09,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.985334, valid_loss 0.996770, train_metric nan, valid_metric 0.058045
[4142451:MainThread](2024-04-06 16:36:09,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.978685, valid_loss 0.998612, train_metric nan, valid_metric 0.044463
[4142451:MainThread](2024-04-06 16:36:09,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.983112, valid_loss 1.003583, train_metric nan, valid_metric 0.042791
[4142451:MainThread](2024-04-06 16:36:09,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.000554, valid_loss 0.995970, train_metric nan, valid_metric 0.047933
[4142451:MainThread](2024-04-06 16:36:09,651) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.988381, valid_loss 1.002141, train_metric nan, valid_metric 0.021308
[4142451:MainThread](2024-04-06 16:36:09,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.995087, valid_loss 0.998687, train_metric nan, valid_metric 0.040944
[4142451:MainThread](2024-04-06 16:36:09,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.001925, valid_loss 0.998770, train_metric nan, valid_metric 0.038367
[4142451:MainThread](2024-04-06 16:36:10,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.986427, valid_loss 0.997606, train_metric nan, valid_metric 0.036569
[4142451:MainThread](2024-04-06 16:36:10,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.990671, valid_loss 0.996177, train_metric nan, valid_metric 0.052201
[4142451:MainThread](2024-04-06 16:36:10,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.007783, valid_loss 0.994871, train_metric nan, valid_metric 0.055000
[4142451:MainThread](2024-04-06 16:36:10,526) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.988526, valid_loss 0.998054, train_metric nan, valid_metric 0.034481
[4142451:MainThread](2024-04-06 16:36:10,666) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.980798, valid_loss 0.996613, train_metric nan, valid_metric 0.044847
[4142451:MainThread](2024-04-06 16:36:10,818) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.995449, valid_loss 0.998783, train_metric nan, valid_metric 0.037081
[4142451:MainThread](2024-04-06 16:36:10,973) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.993128, valid_loss 0.996005, train_metric nan, valid_metric 0.057909
[4142451:MainThread](2024-04-06 16:36:11,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.009447, valid_loss 0.993116, train_metric nan, valid_metric 0.058790
[4142451:MainThread](2024-04-06 16:36:11,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.993975 to 0.993116, save checkpoint.
[4142451:MainThread](2024-04-06 16:36:11,270) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.978690, valid_loss 0.996327, train_metric nan, valid_metric 0.046047
[4142451:MainThread](2024-04-06 16:36:11,410) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.984140, valid_loss 0.996185, train_metric nan, valid_metric 0.045013
[4142451:MainThread](2024-04-06 16:36:11,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.988772, valid_loss 0.999714, train_metric nan, valid_metric 0.028107
[4142451:MainThread](2024-04-06 16:36:11,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.992893, valid_loss 0.999121, train_metric nan, valid_metric 0.029013
[4142451:MainThread](2024-04-06 16:36:11,846) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.981892, valid_loss 0.995753, train_metric nan, valid_metric 0.045603
[4142451:MainThread](2024-04-06 16:36:11,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.980012, valid_loss 0.996668, train_metric nan, valid_metric 0.041976
[4142451:MainThread](2024-04-06 16:36:12,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.980266, valid_loss 0.998042, train_metric nan, valid_metric 0.044769
[4142451:MainThread](2024-04-06 16:36:12,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.984789, valid_loss 0.997791, train_metric nan, valid_metric 0.038706
[4142451:MainThread](2024-04-06 16:36:12,434) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.984645, valid_loss 0.997854, train_metric nan, valid_metric 0.043907
[4142451:MainThread](2024-04-06 16:36:12,571) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.995639, valid_loss 0.998092, train_metric nan, valid_metric 0.036529
[4142451:MainThread](2024-04-06 16:36:12,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.985368, valid_loss 0.996582, train_metric nan, valid_metric 0.043472
[4142451:MainThread](2024-04-06 16:36:12,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.983874, valid_loss 0.998030, train_metric nan, valid_metric 0.038327
[4142451:MainThread](2024-04-06 16:36:12,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 1.000055, valid_loss 0.997144, train_metric nan, valid_metric 0.040394
[4142451:MainThread](2024-04-06 16:36:13,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.981746, valid_loss 0.996535, train_metric nan, valid_metric 0.042586
[4142451:MainThread](2024-04-06 16:36:13,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.980652, valid_loss 0.995744, train_metric nan, valid_metric 0.047805
[4142451:MainThread](2024-04-06 16:36:13,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.995686, valid_loss 0.996583, train_metric nan, valid_metric 0.045934
[4142451:MainThread](2024-04-06 16:36:13,579) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.993596, valid_loss 0.996112, train_metric nan, valid_metric 0.046263
[4142451:MainThread](2024-04-06 16:36:13,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.991348, valid_loss 0.995617, train_metric nan, valid_metric 0.046848
[4142451:MainThread](2024-04-06 16:36:13,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.980664, valid_loss 0.997674, train_metric nan, valid_metric 0.038497
[4142451:MainThread](2024-04-06 16:36:14,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.984494, valid_loss 0.995944, train_metric nan, valid_metric 0.045769
[4142451:MainThread](2024-04-06 16:36:14,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.984517, valid_loss 0.996470, train_metric nan, valid_metric 0.043533
[4142451:MainThread](2024-04-06 16:36:14,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.983555, valid_loss 0.996409, train_metric nan, valid_metric 0.045722
[4142451:MainThread](2024-04-06 16:36:14,470) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.988102, valid_loss 0.996161, train_metric nan, valid_metric 0.045677
[4142451:MainThread](2024-04-06 16:36:14,612) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.981592, valid_loss 0.997215, train_metric nan, valid_metric 0.042121
[4142451:MainThread](2024-04-06 16:36:14,754) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.980992, valid_loss 0.997687, train_metric nan, valid_metric 0.040526
[4142451:MainThread](2024-04-06 16:36:14,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.986567, valid_loss 0.996600, train_metric nan, valid_metric 0.044551
[4142451:MainThread](2024-04-06 16:36:15,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.994599, valid_loss 0.996509, train_metric nan, valid_metric 0.044223
[4142451:MainThread](2024-04-06 16:36:15,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.991834, valid_loss 0.996050, train_metric nan, valid_metric 0.046313
[4142451:MainThread](2024-04-06 16:36:15,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.989248, valid_loss 0.995927, train_metric nan, valid_metric 0.046687
[4142451:MainThread](2024-04-06 16:36:15,463) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.997180, valid_loss 0.996986, train_metric nan, valid_metric 0.041492
[4142451:MainThread](2024-04-06 16:36:15,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.977218, valid_loss 0.996113, train_metric nan, valid_metric 0.045027
[4142451:MainThread](2024-04-06 16:36:15,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.987267, valid_loss 0.996205, train_metric nan, valid_metric 0.044932
[4142451:MainThread](2024-04-06 16:36:15,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.984937, valid_loss 0.995647, train_metric nan, valid_metric 0.047218
[4142451:MainThread](2024-04-06 16:36:16,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.979501, valid_loss 0.996579, train_metric nan, valid_metric 0.044204
[4142451:MainThread](2024-04-06 16:36:16,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.988008, valid_loss 0.998236, train_metric nan, valid_metric 0.035486
[4142451:MainThread](2024-04-06 16:36:16,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.979284, valid_loss 0.996208, train_metric nan, valid_metric 0.047652
[4142451:MainThread](2024-04-06 16:36:16,510) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.993594, valid_loss 0.997057, train_metric nan, valid_metric 0.044506
[4142451:MainThread](2024-04-06 16:36:16,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.979070, valid_loss 0.997365, train_metric nan, valid_metric 0.037664
[4142451:MainThread](2024-04-06 16:36:16,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.983108, valid_loss 0.996654, train_metric nan, valid_metric 0.036494
[4142451:MainThread](2024-04-06 16:36:17,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.978883, valid_loss 0.996784, train_metric nan, valid_metric 0.042535
[4142451:MainThread](2024-04-06 16:36:17,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.986713, valid_loss 0.996325, train_metric nan, valid_metric 0.045206
[4142451:MainThread](2024-04-06 16:36:17,350) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.984642, valid_loss 0.996156, train_metric nan, valid_metric 0.044315
[4142451:MainThread](2024-04-06 16:36:17,502) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.980933, valid_loss 0.996043, train_metric nan, valid_metric 0.046508
[4142451:MainThread](2024-04-06 16:36:17,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.984989, valid_loss 0.996216, train_metric nan, valid_metric 0.045725
[4142451:MainThread](2024-04-06 16:36:17,812) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.975437, valid_loss 0.996407, train_metric nan, valid_metric 0.045325
[4142451:MainThread](2024-04-06 16:36:17,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.981860, valid_loss 0.996646, train_metric nan, valid_metric 0.044459
[4142451:MainThread](2024-04-06 16:36:18,140) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.991497, valid_loss 0.996270, train_metric nan, valid_metric 0.045480
[4142451:MainThread](2024-04-06 16:36:18,277) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.981321, valid_loss 0.996475, train_metric nan, valid_metric 0.045114
[4142451:MainThread](2024-04-06 16:36:18,413) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.988969, valid_loss 0.996669, train_metric nan, valid_metric 0.044888
[4142451:MainThread](2024-04-06 16:36:18,568) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.996888, valid_loss 0.996492, train_metric nan, valid_metric 0.042699
[4142451:MainThread](2024-04-06 16:36:18,568) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:36:19,408) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:36:20,274) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  98%|█████████▊| 51/52 [16:44<00:18, 18.88s/it][4142451:MainThread](2024-04-06 16:36:20,283) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[4142451:MainThread](2024-04-06 16:36:20,293) INFO - qlib.workflow - [recorder.py:341] - Recorder 0597a493ffb54fd897c7f074e99925be starts running under Experiment 14 ...
[4142451:MainThread](2024-04-06 16:36:21,035) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[4142451:MainThread](2024-04-06 16:36:21,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0002
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[4142451:MainThread](2024-04-06 16:36:21,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[4142451:MainThread](2024-04-06 16:36:21,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
[4142451:MainThread](2024-04-06 16:36:24,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[4142451:MainThread](2024-04-06 16:36:25,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.240717, valid_loss 1.114045, train_metric nan, valid_metric 0.003352
[4142451:MainThread](2024-04-06 16:36:25,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.114045, save checkpoint.
/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:903: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
[4142451:MainThread](2024-04-06 16:36:25,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.078129, valid_loss 1.007890, train_metric nan, valid_metric 0.044184
[4142451:MainThread](2024-04-06 16:36:25,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.114045 to 1.007890, save checkpoint.
[4142451:MainThread](2024-04-06 16:36:25,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.036620, valid_loss 1.015626, train_metric nan, valid_metric 0.052106
[4142451:MainThread](2024-04-06 16:36:25,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.031266, valid_loss 1.001149, train_metric nan, valid_metric 0.049649
[4142451:MainThread](2024-04-06 16:36:25,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.007890 to 1.001149, save checkpoint.
[4142451:MainThread](2024-04-06 16:36:26,098) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.021294, valid_loss 0.999574, train_metric nan, valid_metric 0.065351
[4142451:MainThread](2024-04-06 16:36:26,098) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001149 to 0.999574, save checkpoint.
[4142451:MainThread](2024-04-06 16:36:26,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.035688, valid_loss 1.002419, train_metric nan, valid_metric 0.045093
[4142451:MainThread](2024-04-06 16:36:26,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.088738, valid_loss 1.046262, train_metric nan, valid_metric 0.013193
[4142451:MainThread](2024-04-06 16:36:26,621) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.019502, valid_loss 1.006993, train_metric nan, valid_metric 0.053765
[4142451:MainThread](2024-04-06 16:36:26,770) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.006685, valid_loss 0.994583, train_metric nan, valid_metric 0.063712
[4142451:MainThread](2024-04-06 16:36:26,770) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999574 to 0.994583, save checkpoint.
[4142451:MainThread](2024-04-06 16:36:26,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.019567, valid_loss 0.991471, train_metric nan, valid_metric 0.075922
[4142451:MainThread](2024-04-06 16:36:26,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.994583 to 0.991471, save checkpoint.
[4142451:MainThread](2024-04-06 16:36:27,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.008624, valid_loss 0.995019, train_metric nan, valid_metric 0.066965
[4142451:MainThread](2024-04-06 16:36:27,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.018516, valid_loss 0.999617, train_metric nan, valid_metric 0.049499
[4142451:MainThread](2024-04-06 16:36:27,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.020841, valid_loss 0.998124, train_metric nan, valid_metric 0.062506
[4142451:MainThread](2024-04-06 16:36:27,580) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.009579, valid_loss 1.004147, train_metric nan, valid_metric 0.058318
[4142451:MainThread](2024-04-06 16:36:27,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.988732, valid_loss 0.993767, train_metric nan, valid_metric 0.084189
[4142451:MainThread](2024-04-06 16:36:27,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.988646, valid_loss 0.991855, train_metric nan, valid_metric 0.072893
[4142451:MainThread](2024-04-06 16:36:28,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.008720, valid_loss 1.000037, train_metric nan, valid_metric 0.089211
[4142451:MainThread](2024-04-06 16:36:28,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.990267, valid_loss 0.992958, train_metric nan, valid_metric 0.075479
[4142451:MainThread](2024-04-06 16:36:28,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.002553, valid_loss 0.990657, train_metric nan, valid_metric 0.083029
[4142451:MainThread](2024-04-06 16:36:28,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.991471 to 0.990657, save checkpoint.
[4142451:MainThread](2024-04-06 16:36:28,552) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 0.978888, valid_loss 0.990462, train_metric nan, valid_metric 0.078838
[4142451:MainThread](2024-04-06 16:36:28,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990657 to 0.990462, save checkpoint.
[4142451:MainThread](2024-04-06 16:36:28,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.005706, valid_loss 0.996491, train_metric nan, valid_metric 0.064819
[4142451:MainThread](2024-04-06 16:36:28,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.981219, valid_loss 0.996875, train_metric nan, valid_metric 0.063595
[4142451:MainThread](2024-04-06 16:36:28,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.996834, valid_loss 0.991449, train_metric nan, valid_metric 0.079849
[4142451:MainThread](2024-04-06 16:36:29,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.994722, valid_loss 0.990567, train_metric nan, valid_metric 0.074956
[4142451:MainThread](2024-04-06 16:36:29,270) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.999204, valid_loss 0.993384, train_metric nan, valid_metric 0.071642
[4142451:MainThread](2024-04-06 16:36:29,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.994168, valid_loss 1.004664, train_metric nan, valid_metric 0.068100
[4142451:MainThread](2024-04-06 16:36:29,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.989673, valid_loss 0.991542, train_metric nan, valid_metric 0.074598
[4142451:MainThread](2024-04-06 16:36:29,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.003127, valid_loss 0.989221, train_metric nan, valid_metric 0.088081
[4142451:MainThread](2024-04-06 16:36:29,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.990462 to 0.989221, save checkpoint.
[4142451:MainThread](2024-04-06 16:36:29,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.994593, valid_loss 0.994950, train_metric nan, valid_metric 0.057226
[4142451:MainThread](2024-04-06 16:36:29,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.984215, valid_loss 0.993024, train_metric nan, valid_metric 0.068389
[4142451:MainThread](2024-04-06 16:36:30,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.985166, valid_loss 0.992468, train_metric nan, valid_metric 0.072207
[4142451:MainThread](2024-04-06 16:36:30,320) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.993707, valid_loss 0.994970, train_metric nan, valid_metric 0.068826
[4142451:MainThread](2024-04-06 16:36:30,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.996397, valid_loss 0.990604, train_metric nan, valid_metric 0.077028
[4142451:MainThread](2024-04-06 16:36:30,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.996351, valid_loss 0.992578, train_metric nan, valid_metric 0.076177
[4142451:MainThread](2024-04-06 16:36:30,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.984717, valid_loss 0.991558, train_metric nan, valid_metric 0.070596
[4142451:MainThread](2024-04-06 16:36:30,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.000175, valid_loss 0.993767, train_metric nan, valid_metric 0.066275
[4142451:MainThread](2024-04-06 16:36:31,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.990261, valid_loss 0.991614, train_metric nan, valid_metric 0.081716
[4142451:MainThread](2024-04-06 16:36:31,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.983796, valid_loss 0.991227, train_metric nan, valid_metric 0.076687
[4142451:MainThread](2024-04-06 16:36:31,326) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.997027, valid_loss 0.991149, train_metric nan, valid_metric 0.089096
[4142451:MainThread](2024-04-06 16:36:31,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.992150, valid_loss 0.989217, train_metric nan, valid_metric 0.088489
[4142451:MainThread](2024-04-06 16:36:31,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.989221 to 0.989217, save checkpoint.
[4142451:MainThread](2024-04-06 16:36:31,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.983356, valid_loss 0.990150, train_metric nan, valid_metric 0.080300
[4142451:MainThread](2024-04-06 16:36:31,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.000521, valid_loss 0.992333, train_metric nan, valid_metric 0.072102
[4142451:MainThread](2024-04-06 16:36:31,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.987611, valid_loss 0.992039, train_metric nan, valid_metric 0.077835
[4142451:MainThread](2024-04-06 16:36:32,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.986404, valid_loss 0.991663, train_metric nan, valid_metric 0.077081
[4142451:MainThread](2024-04-06 16:36:32,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.982346, valid_loss 0.992058, train_metric nan, valid_metric 0.075162
[4142451:MainThread](2024-04-06 16:36:32,380) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.986460, valid_loss 0.990380, train_metric nan, valid_metric 0.078439
[4142451:MainThread](2024-04-06 16:36:32,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.982259, valid_loss 0.992968, train_metric nan, valid_metric 0.077172
[4142451:MainThread](2024-04-06 16:36:32,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.989899, valid_loss 0.990538, train_metric nan, valid_metric 0.080386
[4142451:MainThread](2024-04-06 16:36:32,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.989183, valid_loss 0.990805, train_metric nan, valid_metric 0.077716
[4142451:MainThread](2024-04-06 16:36:32,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.996359, valid_loss 0.991963, train_metric nan, valid_metric 0.083536
[4142451:MainThread](2024-04-06 16:36:33,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.982672, valid_loss 0.991595, train_metric nan, valid_metric 0.073521
[4142451:MainThread](2024-04-06 16:36:33,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.988486, valid_loss 0.990180, train_metric nan, valid_metric 0.082540
[4142451:MainThread](2024-04-06 16:36:33,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.982347, valid_loss 0.991669, train_metric nan, valid_metric 0.074516
[4142451:MainThread](2024-04-06 16:36:33,533) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.988401, valid_loss 0.990632, train_metric nan, valid_metric 0.081894
[4142451:MainThread](2024-04-06 16:36:33,677) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.994577, valid_loss 0.990584, train_metric nan, valid_metric 0.079775
[4142451:MainThread](2024-04-06 16:36:33,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.988076, valid_loss 0.992391, train_metric nan, valid_metric 0.068689
[4142451:MainThread](2024-04-06 16:36:33,972) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.980797, valid_loss 0.990808, train_metric nan, valid_metric 0.076387
[4142451:MainThread](2024-04-06 16:36:34,119) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.989506, valid_loss 0.991206, train_metric nan, valid_metric 0.075281
[4142451:MainThread](2024-04-06 16:36:34,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.984574, valid_loss 0.990625, train_metric nan, valid_metric 0.081965
[4142451:MainThread](2024-04-06 16:36:34,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.985972, valid_loss 0.990824, train_metric nan, valid_metric 0.076298
[4142451:MainThread](2024-04-06 16:36:34,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.981932, valid_loss 0.990953, train_metric nan, valid_metric 0.075959
[4142451:MainThread](2024-04-06 16:36:34,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.988983, valid_loss 0.990337, train_metric nan, valid_metric 0.080302
[4142451:MainThread](2024-04-06 16:36:34,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.988604, valid_loss 0.990019, train_metric nan, valid_metric 0.079662
[4142451:MainThread](2024-04-06 16:36:34,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.979715, valid_loss 0.990563, train_metric nan, valid_metric 0.078346
[4142451:MainThread](2024-04-06 16:36:35,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.974484, valid_loss 0.991459, train_metric nan, valid_metric 0.076160
[4142451:MainThread](2024-04-06 16:36:35,250) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.984062, valid_loss 0.989973, train_metric nan, valid_metric 0.080714
[4142451:MainThread](2024-04-06 16:36:35,395) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.981470, valid_loss 0.991032, train_metric nan, valid_metric 0.077690
[4142451:MainThread](2024-04-06 16:36:35,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.981759, valid_loss 0.990434, train_metric nan, valid_metric 0.079015
[4142451:MainThread](2024-04-06 16:36:35,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.986266, valid_loss 0.990952, train_metric nan, valid_metric 0.078602
[4142451:MainThread](2024-04-06 16:36:35,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.993062, valid_loss 0.990596, train_metric nan, valid_metric 0.076014
[4142451:MainThread](2024-04-06 16:36:35,970) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.987599, valid_loss 0.991158, train_metric nan, valid_metric 0.075766
[4142451:MainThread](2024-04-06 16:36:36,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.978805, valid_loss 0.991137, train_metric nan, valid_metric 0.075304
[4142451:MainThread](2024-04-06 16:36:36,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.979362, valid_loss 0.991202, train_metric nan, valid_metric 0.074554
[4142451:MainThread](2024-04-06 16:36:36,492) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.988745, valid_loss 0.990682, train_metric nan, valid_metric 0.078207
[4142451:MainThread](2024-04-06 16:36:36,643) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.981348, valid_loss 0.990754, train_metric nan, valid_metric 0.077021
[4142451:MainThread](2024-04-06 16:36:36,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.981696, valid_loss 0.990629, train_metric nan, valid_metric 0.077876
[4142451:MainThread](2024-04-06 16:36:36,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.986453, valid_loss 0.990479, train_metric nan, valid_metric 0.080744
[4142451:MainThread](2024-04-06 16:36:37,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.991971, valid_loss 0.990627, train_metric nan, valid_metric 0.078562
[4142451:MainThread](2024-04-06 16:36:37,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.974066, valid_loss 0.990345, train_metric nan, valid_metric 0.078948
[4142451:MainThread](2024-04-06 16:36:37,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.982754, valid_loss 0.990419, train_metric nan, valid_metric 0.078537
[4142451:MainThread](2024-04-06 16:36:37,552) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.984085, valid_loss 0.991030, train_metric nan, valid_metric 0.075927
[4142451:MainThread](2024-04-06 16:36:37,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.981403, valid_loss 0.990567, train_metric nan, valid_metric 0.078591
[4142451:MainThread](2024-04-06 16:36:37,839) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.974168, valid_loss 0.990701, train_metric nan, valid_metric 0.077700
[4142451:MainThread](2024-04-06 16:36:37,985) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.978855, valid_loss 0.990630, train_metric nan, valid_metric 0.078612
[4142451:MainThread](2024-04-06 16:36:38,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.981759, valid_loss 0.990580, train_metric nan, valid_metric 0.078716
[4142451:MainThread](2024-04-06 16:36:38,305) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.985778, valid_loss 0.991482, train_metric nan, valid_metric 0.078203
[4142451:MainThread](2024-04-06 16:36:38,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.991254, valid_loss 0.991592, train_metric nan, valid_metric 0.078608
[4142451:MainThread](2024-04-06 16:36:38,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.991169, valid_loss 0.990474, train_metric nan, valid_metric 0.080013
[4142451:MainThread](2024-04-06 16:36:38,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.980262, valid_loss 0.990655, train_metric nan, valid_metric 0.078691
[4142451:MainThread](2024-04-06 16:36:38,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.986729, valid_loss 0.990590, train_metric nan, valid_metric 0.078265
[4142451:MainThread](2024-04-06 16:36:38,960) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[4142451:MainThread](2024-04-06 16:36:39,794) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 14
[4142451:MainThread](2024-04-06 16:36:40,669) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks: 100%|██████████| 52/52 [17:04<00:00, 19.34s/it]train tasks: 100%|██████████| 52/52 [17:04<00:00, 19.71s/it]
[4142451:MainThread](2024-04-06 16:36:41,081) INFO - qlib.timer - [log.py:127] - Time cost: 0.347s | Time to `list_recorders` in RecorderCollector Done
[4142451:MainThread](2024-04-06 16:36:41,081) INFO - qlib.RecorderCollector - [collect.py:226] - Nubmer of recorders after filter: defaultdict(<class 'int'>, {'FINISHED': 52})
[4142451:MainThread](2024-04-06 16:36:41,126) INFO - qlib.RollingEnsemble - [ensemble.py:81] - keys in group: ['0597a493ffb54fd897c7f074e99925be', '015db19671d54fc2b1cbfe039bafa0b3', '992add0922c94f32b3c7d65565748bc3', 'faf594a92aac4266bb360c34c6f26400', '4f7de09dd5a0413cafe5914169e0f5da', '7bba775643624714b3ebfbdb94e94ca6', 'ca020b0f28ab4744abdb8e43cb101a01', '09e61d7f04e241dc9f966275813de320', '4cf55f499d86495ba058a44f7ed61b14', '81ffe0b214c34972a705a6cb885eafb5', '226062bc4d2844c68c56de62f89f802f', 'eca4d952502146fc915b6582aa20ab6e', '94f7919b829f41048e6e1c059af54e32', '49fc3d8918ca43988e6f40362c162661', '42ccd2a6c5544b76b483fe0ccd45c95f', 'bd0859cff2ae402e9025cea3288f4e81', '03bf54c75f1942d88b12238f5486e7fe', 'a8a34c1b4cf946958381c07c2dff2676', '0884c29ef3bb41f29b8b19ca74866705', '919834cbb311418291f2c9a3beed476e', '6766ee3902434adcbd08f1e3bd1401f8', '4523a1396a8f465e940ac404182c4730', '0080389f9e0e4e89b8a285892a0379b0', '200724c977cb4542b86df935c8c5934d', 'e6d4df03bbaa48a4b6d4e34d3d1d751a', '4084159fdec04a4aac5f6bce890be82b', 'c0ff88b0bca94960b8fc89ea9836929e', '245f4dcec5724d1c881feec2397fc0a2', 'bd9e809119be4be49b5b8d0709f65b0c', '80e9f859909a48fca6b52aad7032143e', '580cb26f362a49c697f10875fc53c2ce', '4996a1d178354c2ea677c91ff06b49df', '841e27a7bad04e96adfad7efa303467c', '4bc392b02e634238849db03385e8f0d0', '10c6cdd0bc324cb2a392db945da96779', '3c7caaa4b5be4cf5a3249fa43a8f6456', 'ed78e2d15f594f35bb846def681e309a', 'cd51cd3c13af488181726f462b2d4e2b', 'fd75c5f73baf4e5f8e3c2b33115e6e9e', 'dfc20677a10b4681b8f3307925bb2712', '5303bbfad59849a0ac451592e997cc4d', '0153c15684534dbb8f99c90beb32c4c6', '8f5abc035b5247c7b0dc6180a626314c', 'cc062c10f27b4c8abb6373ae29d7fd57', '5ed3e43083284ae4a9088717a301ef00', '94310cf21d164181bf3c8085c4697264', '2105c29b66c340beb746d4b48024633d', 'c078c6d52d904e4cb1155d7e4ce18e3e', '66fb0d4ba51a48e1a3507bb23f919aaa', 'f421c428e38d410e9b111d425171db39', 'f448a3bdd0fa4059bfb3ca10b8c9df4d', '466badbc01a9426482b7d9ec8122ab1b']
[4142451:MainThread](2024-04-06 16:36:41,236) INFO - qlib.RollingEnsemble - [ensemble.py:81] - keys in group: ['0597a493ffb54fd897c7f074e99925be', '015db19671d54fc2b1cbfe039bafa0b3', '992add0922c94f32b3c7d65565748bc3', 'faf594a92aac4266bb360c34c6f26400', '4f7de09dd5a0413cafe5914169e0f5da', '7bba775643624714b3ebfbdb94e94ca6', 'ca020b0f28ab4744abdb8e43cb101a01', '09e61d7f04e241dc9f966275813de320', '4cf55f499d86495ba058a44f7ed61b14', '81ffe0b214c34972a705a6cb885eafb5', '226062bc4d2844c68c56de62f89f802f', 'eca4d952502146fc915b6582aa20ab6e', '94f7919b829f41048e6e1c059af54e32', '49fc3d8918ca43988e6f40362c162661', '42ccd2a6c5544b76b483fe0ccd45c95f', 'bd0859cff2ae402e9025cea3288f4e81', '03bf54c75f1942d88b12238f5486e7fe', 'a8a34c1b4cf946958381c07c2dff2676', '0884c29ef3bb41f29b8b19ca74866705', '919834cbb311418291f2c9a3beed476e', '6766ee3902434adcbd08f1e3bd1401f8', '4523a1396a8f465e940ac404182c4730', '0080389f9e0e4e89b8a285892a0379b0', '200724c977cb4542b86df935c8c5934d', 'e6d4df03bbaa48a4b6d4e34d3d1d751a', '4084159fdec04a4aac5f6bce890be82b', 'c0ff88b0bca94960b8fc89ea9836929e', '245f4dcec5724d1c881feec2397fc0a2', 'bd9e809119be4be49b5b8d0709f65b0c', '80e9f859909a48fca6b52aad7032143e', '580cb26f362a49c697f10875fc53c2ce', '4996a1d178354c2ea677c91ff06b49df', '841e27a7bad04e96adfad7efa303467c', '4bc392b02e634238849db03385e8f0d0', '10c6cdd0bc324cb2a392db945da96779', '3c7caaa4b5be4cf5a3249fa43a8f6456', 'ed78e2d15f594f35bb846def681e309a', 'cd51cd3c13af488181726f462b2d4e2b', 'fd75c5f73baf4e5f8e3c2b33115e6e9e', 'dfc20677a10b4681b8f3307925bb2712', '5303bbfad59849a0ac451592e997cc4d', '0153c15684534dbb8f99c90beb32c4c6', '8f5abc035b5247c7b0dc6180a626314c', 'cc062c10f27b4c8abb6373ae29d7fd57', '5ed3e43083284ae4a9088717a301ef00', '94310cf21d164181bf3c8085c4697264', '2105c29b66c340beb746d4b48024633d', 'c078c6d52d904e4cb1155d7e4ce18e3e', '66fb0d4ba51a48e1a3507bb23f919aaa', 'f421c428e38d410e9b111d425171db39', 'f448a3bdd0fa4059bfb3ca10b8c9df4d', '466badbc01a9426482b7d9ec8122ab1b']
[4142451:MainThread](2024-04-06 16:36:41,357) INFO - qlib.workflow - [exp.py:258] - Experiment 3 starts running ...
[4142451:MainThread](2024-04-06 16:36:41,372) INFO - qlib.workflow - [recorder.py:341] - Recorder 1e0fc94a16bf4522a2600cef1c6ecf03 starts running under Experiment 3 ...
[4142451:MainThread](2024-04-06 16:36:41,990) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
[4142451:MainThread](2024-04-06 16:36:43,851) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
                          score
datetime   instrument          
2023-03-23 SH600000    0.097463
           SH600009   -0.078993
           SH600010   -0.050852
           SH600011    0.044480
           SH600015    0.009447
Epoch   640: reducing learning rate of group 0 to 1.0000e-03.
Epoch   860: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1080: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1300: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-04-21 SH600000    0.035086
           SH600009    0.101155
           SH600010   -0.001794
           SH600011    0.196875
           SH600015    0.060452
Epoch  1200: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1420: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1640: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1860: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-05-24 SH600000   -0.034625
           SH600009    0.067453
           SH600010   -0.104033
           SH600011    0.062467
           SH600015   -0.018275
Epoch   400: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1000: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1220: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1440: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1660: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-06-21 SH600000   -0.051710
           SH600009    0.201120
           SH600010   -0.057395
           SH600011    0.089078
           SH600015   -0.029586
Epoch  1280: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1500: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1720: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1940: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-07-21 SH600000    0.036121
           SH600009    0.046531
           SH600010   -0.169788
           SH600011    0.061652
           SH600015   -0.020797
Epoch   380: reducing learning rate of group 0 to 1.0000e-03.
Epoch   720: reducing learning rate of group 0 to 5.0000e-04.
Epoch   980: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1200: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1420: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1640: reducing learning rate of group 0 to 3.1250e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-08-18 SH600000    0.056625
           SH600009   -0.000234
           SH600010   -0.129524
           SH600011    0.113267
           SH600015    0.072571
Epoch   540: reducing learning rate of group 0 to 1.0000e-03.
Epoch   760: reducing learning rate of group 0 to 5.0000e-04.
Epoch   980: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1200: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1420: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1640: reducing learning rate of group 0 to 3.1250e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-09-15 SH600000    0.052193
           SH600009    0.026136
           SH600010   -0.103979
           SH600011    0.035643
           SH600015    0.062546
Epoch   840: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1060: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1280: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1500: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-10-23 SH600000    0.022773
           SH600009    0.054578
           SH600010    0.091856
           SH600011    0.009380
           SH600015   -0.053575
Epoch   600: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1020: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1240: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1460: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1680: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-11-20 SH600000    0.030363
           SH600009   -0.022800
           SH600010    0.030104
           SH600011    0.033120
           SH600015    0.071752
Epoch   480: reducing learning rate of group 0 to 1.0000e-03.
Epoch   700: reducing learning rate of group 0 to 5.0000e-04.
Epoch   920: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1140: reducing learning rate of group 0 to 1.2500e-04.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2023-12-18 SH600000    0.060973
           SH600009    0.132705
           SH600010    0.022517
           SH600011    0.050843
           SH600015    0.256554
Epoch   780: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1000: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1220: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1440: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1660: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2024-01-16 SH600000   -0.040388
           SH600009    0.068983
           SH600010   -0.006531
           SH600011    0.017533
           SH600015    0.102958
Epoch   640: reducing learning rate of group 0 to 1.0000e-03.
Epoch   860: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1100: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1320: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1540: reducing learning rate of group 0 to 6.2500e-05.
Epoch  1760: reducing learning rate of group 0 to 3.1250e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2024-02-21 SH600000    0.055250
           SH600009   -0.041747
           SH600010    0.024861
           SH600011    0.056194
           SH600015    0.057968
Epoch   780: reducing learning rate of group 0 to 1.0000e-03.
Epoch  1000: reducing learning rate of group 0 to 5.0000e-04.
Epoch  1220: reducing learning rate of group 0 to 2.5000e-04.
Epoch  1440: reducing learning rate of group 0 to 1.2500e-04.
Epoch  1660: reducing learning rate of group 0 to 6.2500e-05.
'The following are prediction results of the DNNModelPytorch model.'
                          score
datetime   instrument          
2024-03-20 SH600000    0.087230
           SH600009    0.119567
           SH600010   -0.058092
           SH600011    0.097692
           SH600015    0.078821
{'IC': 0.06456797495334869,
 'ICIR': 0.4180637887973527,
 'Rank IC': 0.06652013065047926,
 'Rank ICIR': 0.43386363870785494}
[4142451:MainThread](2024-04-06 16:36:54,521) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[4142451:MainThread](2024-04-06 16:36:54,525) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[4142451:MainThread](2024-04-06 16:37:00,982) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f71cd41a460>
backtest loop:   0%|          | 0/1025 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/qlib_env/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 5/1025 [00:00<00:21, 47.50it/s]backtest loop:   1%|          | 10/1025 [00:00<00:21, 47.89it/s]backtest loop:   2%|▏         | 16/1025 [00:00<00:21, 46.61it/s]backtest loop:   2%|▏         | 22/1025 [00:00<00:20, 49.67it/s]backtest loop:   3%|▎         | 28/1025 [00:00<00:19, 51.53it/s]backtest loop:   3%|▎         | 34/1025 [00:00<00:18, 52.45it/s]backtest loop:   4%|▍         | 40/1025 [00:00<00:18, 52.09it/s]backtest loop:   4%|▍         | 46/1025 [00:00<00:20, 47.50it/s]backtest loop:   5%|▍         | 51/1025 [00:01<00:20, 47.68it/s]backtest loop:   6%|▌         | 57/1025 [00:01<00:19, 50.29it/s]backtest loop:   6%|▌         | 63/1025 [00:01<00:18, 51.98it/s]backtest loop:   7%|▋         | 69/1025 [00:01<00:17, 53.15it/s]backtest loop:   7%|▋         | 75/1025 [00:01<00:18, 50.89it/s]backtest loop:   8%|▊         | 81/1025 [00:01<00:17, 52.80it/s]backtest loop:   8%|▊         | 87/1025 [00:01<00:18, 50.69it/s]backtest loop:   9%|▉         | 93/1025 [00:01<00:17, 52.29it/s]backtest loop:  10%|▉         | 99/1025 [00:01<00:17, 53.63it/s]backtest loop:  10%|█         | 105/1025 [00:02<00:16, 54.18it/s]backtest loop:  11%|█         | 111/1025 [00:02<00:16, 54.35it/s]backtest loop:  11%|█▏        | 117/1025 [00:02<00:17, 51.30it/s]backtest loop:  12%|█▏        | 123/1025 [00:02<00:17, 52.84it/s]backtest loop:  13%|█▎        | 129/1025 [00:02<00:16, 53.34it/s]backtest loop:  13%|█▎        | 135/1025 [00:02<00:17, 50.87it/s]backtest loop:  14%|█▍        | 141/1025 [00:02<00:17, 51.99it/s]backtest loop:  14%|█▍        | 147/1025 [00:02<00:16, 52.29it/s]backtest loop:  15%|█▍        | 153/1025 [00:02<00:16, 53.28it/s]backtest loop:  16%|█▌        | 159/1025 [00:03<00:16, 53.51it/s]backtest loop:  16%|█▌        | 165/1025 [00:03<00:16, 50.74it/s]backtest loop:  17%|█▋        | 171/1025 [00:03<00:16, 51.44it/s]backtest loop:  17%|█▋        | 177/1025 [00:03<00:16, 52.38it/s]backtest loop:  18%|█▊        | 183/1025 [00:03<00:16, 49.83it/s]backtest loop:  18%|█▊        | 189/1025 [00:03<00:17, 48.12it/s]backtest loop:  19%|█▉        | 195/1025 [00:03<00:16, 50.00it/s]backtest loop:  20%|█▉        | 201/1025 [00:03<00:16, 51.15it/s]backtest loop:  20%|██        | 207/1025 [00:04<00:15, 52.30it/s]backtest loop:  21%|██        | 213/1025 [00:04<00:15, 52.89it/s]backtest loop:  21%|██▏       | 219/1025 [00:04<00:16, 50.04it/s]backtest loop:  22%|██▏       | 225/1025 [00:04<00:15, 51.45it/s]backtest loop:  23%|██▎       | 231/1025 [00:04<00:15, 52.13it/s]backtest loop:  23%|██▎       | 237/1025 [00:04<00:14, 53.08it/s]backtest loop:  24%|██▎       | 243/1025 [00:04<00:15, 50.58it/s]backtest loop:  24%|██▍       | 249/1025 [00:04<00:14, 51.99it/s]backtest loop:  25%|██▍       | 255/1025 [00:04<00:14, 52.78it/s]backtest loop:  26%|██▌       | 262/1025 [00:05<00:13, 55.65it/s]backtest loop:  26%|██▌       | 268/1025 [00:05<00:13, 54.35it/s]backtest loop:  27%|██▋       | 274/1025 [00:05<00:14, 53.62it/s]backtest loop:  27%|██▋       | 280/1025 [00:05<00:13, 55.17it/s]backtest loop:  28%|██▊       | 287/1025 [00:05<00:12, 57.31it/s]backtest loop:  29%|██▊       | 293/1025 [00:05<00:13, 54.79it/s]backtest loop:  29%|██▉       | 299/1025 [00:05<00:13, 55.29it/s]backtest loop:  30%|██▉       | 305/1025 [00:05<00:12, 56.51it/s]backtest loop:  30%|███       | 312/1025 [00:05<00:12, 54.99it/s]backtest loop:  31%|███       | 318/1025 [00:06<00:12, 56.30it/s]backtest loop:  32%|███▏      | 324/1025 [00:06<00:12, 54.09it/s]backtest loop:  32%|███▏      | 330/1025 [00:06<00:12, 55.59it/s]backtest loop:  33%|███▎      | 336/1025 [00:06<00:12, 56.38it/s]backtest loop:  33%|███▎      | 342/1025 [00:06<00:11, 57.39it/s]backtest loop:  34%|███▍      | 349/1025 [00:06<00:12, 55.47it/s]backtest loop:  35%|███▍      | 355/1025 [00:06<00:11, 56.09it/s]backtest loop:  35%|███▌      | 362/1025 [00:06<00:11, 57.92it/s]backtest loop:  36%|███▌      | 368/1025 [00:06<00:11, 55.23it/s]backtest loop:  36%|███▋      | 374/1025 [00:07<00:11, 56.38it/s]backtest loop:  37%|███▋      | 380/1025 [00:07<00:11, 57.38it/s]backtest loop:  38%|███▊      | 387/1025 [00:07<00:10, 59.18it/s]backtest loop:  38%|███▊      | 393/1025 [00:07<00:11, 56.32it/s]backtest loop:  39%|███▉      | 400/1025 [00:07<00:10, 58.26it/s]backtest loop:  40%|███▉      | 407/1025 [00:07<00:10, 59.67it/s]backtest loop:  40%|████      | 413/1025 [00:07<00:10, 56.61it/s]backtest loop:  41%|████      | 420/1025 [00:07<00:10, 58.29it/s]backtest loop:  42%|████▏     | 426/1025 [00:07<00:11, 52.23it/s]backtest loop:  42%|████▏     | 433/1025 [00:08<00:10, 55.15it/s]backtest loop:  43%|████▎     | 440/1025 [00:08<00:10, 57.16it/s]backtest loop:  44%|████▎     | 446/1025 [00:08<00:10, 54.80it/s]backtest loop:  44%|████▍     | 453/1025 [00:08<00:10, 57.00it/s]backtest loop:  45%|████▍     | 460/1025 [00:08<00:09, 58.63it/s]backtest loop:  45%|████▌     | 466/1025 [00:08<00:10, 55.89it/s]backtest loop:  46%|████▌     | 473/1025 [00:08<00:09, 57.77it/s]backtest loop:  47%|████▋     | 480/1025 [00:08<00:09, 59.25it/s]backtest loop:  47%|████▋     | 486/1025 [00:09<00:09, 55.86it/s]backtest loop:  48%|████▊     | 493/1025 [00:09<00:09, 57.68it/s]backtest loop:  49%|████▉     | 500/1025 [00:09<00:09, 55.86it/s]backtest loop:  49%|████▉     | 506/1025 [00:09<00:09, 56.13it/s]backtest loop:  50%|████▉     | 512/1025 [00:09<00:09, 56.77it/s]backtest loop:  51%|█████     | 518/1025 [00:09<00:08, 57.64it/s]backtest loop:  51%|█████     | 524/1025 [00:09<00:08, 58.24it/s]backtest loop:  52%|█████▏    | 530/1025 [00:09<00:09, 54.92it/s]backtest loop:  52%|█████▏    | 536/1025 [00:09<00:08, 56.20it/s]backtest loop:  53%|█████▎    | 542/1025 [00:10<00:08, 55.81it/s]backtest loop:  53%|█████▎    | 548/1025 [00:10<00:08, 53.13it/s]backtest loop:  54%|█████▍    | 554/1025 [00:10<00:08, 54.93it/s]backtest loop:  55%|█████▍    | 561/1025 [00:10<00:08, 57.19it/s]backtest loop:  55%|█████▌    | 567/1025 [00:10<00:08, 54.87it/s]backtest loop:  56%|█████▌    | 574/1025 [00:10<00:07, 57.13it/s]backtest loop:  57%|█████▋    | 580/1025 [00:10<00:08, 54.69it/s]backtest loop:  57%|█████▋    | 587/1025 [00:10<00:07, 56.92it/s]backtest loop:  58%|█████▊    | 594/1025 [00:10<00:07, 55.42it/s]backtest loop:  59%|█████▊    | 601/1025 [00:11<00:07, 57.36it/s]backtest loop:  59%|█████▉    | 608/1025 [00:11<00:07, 58.79it/s]backtest loop:  60%|█████▉    | 614/1025 [00:11<00:07, 56.04it/s]backtest loop:  61%|██████    | 621/1025 [00:11<00:06, 57.81it/s]backtest loop:  61%|██████▏   | 628/1025 [00:11<00:06, 59.08it/s]backtest loop:  62%|██████▏   | 634/1025 [00:11<00:06, 56.17it/s]backtest loop:  63%|██████▎   | 641/1025 [00:11<00:06, 57.95it/s]backtest loop:  63%|██████▎   | 648/1025 [00:11<00:06, 59.37it/s]backtest loop:  64%|██████▍   | 654/1025 [00:12<00:06, 56.27it/s]backtest loop:  64%|██████▍   | 661/1025 [00:12<00:06, 58.11it/s]backtest loop:  65%|██████▌   | 668/1025 [00:12<00:06, 56.11it/s]backtest loop:  66%|██████▌   | 675/1025 [00:12<00:06, 58.05it/s]backtest loop:  66%|██████▋   | 681/1025 [00:12<00:06, 51.83it/s]backtest loop:  67%|██████▋   | 687/1025 [00:12<00:06, 53.31it/s]backtest loop:  68%|██████▊   | 693/1025 [00:12<00:06, 52.34it/s]backtest loop:  68%|██████▊   | 700/1025 [00:12<00:05, 55.27it/s]backtest loop:  69%|██████▉   | 706/1025 [00:12<00:05, 56.37it/s]backtest loop:  69%|██████▉   | 712/1025 [00:13<00:05, 56.70it/s]backtest loop:  70%|███████   | 718/1025 [00:13<00:05, 53.76it/s]backtest loop:  71%|███████   | 724/1025 [00:13<00:05, 55.18it/s]backtest loop:  71%|███████   | 730/1025 [00:13<00:05, 55.63it/s]backtest loop:  72%|███████▏  | 736/1025 [00:13<00:05, 56.70it/s]backtest loop:  72%|███████▏  | 742/1025 [00:13<00:05, 54.23it/s]backtest loop:  73%|███████▎  | 748/1025 [00:13<00:04, 55.65it/s]backtest loop:  74%|███████▎  | 754/1025 [00:13<00:06, 40.29it/s]backtest loop:  74%|███████▍  | 760/1025 [00:14<00:05, 44.54it/s]backtest loop:  75%|███████▍  | 766/1025 [00:14<00:05, 48.17it/s]backtest loop:  75%|███████▌  | 772/1025 [00:14<00:05, 48.00it/s]backtest loop:  76%|███████▌  | 778/1025 [00:14<00:04, 50.78it/s]backtest loop:  76%|███████▋  | 784/1025 [00:14<00:04, 53.23it/s]backtest loop:  77%|███████▋  | 790/1025 [00:14<00:04, 51.86it/s]backtest loop:  78%|███████▊  | 796/1025 [00:14<00:04, 50.88it/s]backtest loop:  78%|███████▊  | 802/1025 [00:14<00:04, 53.06it/s]backtest loop:  79%|███████▉  | 808/1025 [00:14<00:04, 51.87it/s]backtest loop:  80%|███████▉  | 815/1025 [00:15<00:03, 54.92it/s]backtest loop:  80%|████████  | 821/1025 [00:15<00:03, 56.23it/s]backtest loop:  81%|████████  | 827/1025 [00:15<00:03, 57.08it/s]backtest loop:  81%|████████▏ | 833/1025 [00:15<00:03, 54.42it/s]backtest loop:  82%|████████▏ | 840/1025 [00:15<00:03, 56.76it/s]backtest loop:  83%|████████▎ | 846/1025 [00:15<00:03, 49.42it/s]backtest loop:  83%|████████▎ | 852/1025 [00:15<00:03, 48.82it/s]backtest loop:  84%|████████▎ | 858/1025 [00:15<00:03, 48.57it/s]backtest loop:  84%|████████▍ | 865/1025 [00:16<00:03, 52.34it/s]backtest loop:  85%|████████▍ | 871/1025 [00:16<00:03, 51.23it/s]backtest loop:  86%|████████▌ | 877/1025 [00:16<00:02, 53.31it/s]backtest loop:  86%|████████▌ | 883/1025 [00:16<00:02, 55.02it/s]backtest loop:  87%|████████▋ | 889/1025 [00:16<00:02, 56.30it/s]backtest loop:  87%|████████▋ | 896/1025 [00:16<00:02, 54.78it/s]backtest loop:  88%|████████▊ | 903/1025 [00:16<00:02, 56.99it/s]backtest loop:  89%|████████▉ | 910/1025 [00:16<00:02, 55.36it/s]backtest loop:  89%|████████▉ | 917/1025 [00:16<00:01, 57.27it/s]backtest loop:  90%|█████████ | 923/1025 [00:17<00:01, 57.77it/s]backtest loop:  91%|█████████ | 929/1025 [00:17<00:01, 58.37it/s]backtest loop:  91%|█████████ | 935/1025 [00:17<00:01, 55.44it/s]backtest loop:  92%|█████████▏| 942/1025 [00:17<00:01, 57.38it/s]backtest loop:  92%|█████████▏| 948/1025 [00:17<00:01, 57.95it/s]backtest loop:  93%|█████████▎| 954/1025 [00:17<00:01, 58.44it/s]backtest loop:  94%|█████████▎| 960/1025 [00:17<00:01, 55.50it/s]backtest loop:  94%|█████████▍| 967/1025 [00:17<00:01, 57.46it/s]backtest loop:  95%|█████████▍| 973/1025 [00:17<00:00, 57.66it/s]backtest loop:  96%|█████████▌| 979/1025 [00:18<00:00, 54.57it/s]backtest loop:  96%|█████████▌| 985/1025 [00:18<00:00, 55.87it/s]backtest loop:  97%|█████████▋| 992/1025 [00:18<00:00, 57.93it/s]backtest loop:  97%|█████████▋| 998/1025 [00:18<00:00, 55.03it/s]backtest loop:  98%|█████████▊| 1004/1025 [00:18<00:00, 55.89it/s]backtest loop:  99%|█████████▊| 1010/1025 [00:18<00:00, 49.57it/s]backtest loop:  99%|█████████▉| 1016/1025 [00:18<00:00, 50.87it/s]backtest loop: 100%|█████████▉| 1022/1025 [00:18<00:00, 51.56it/s]backtest loop: 100%|██████████| 1025/1025 [00:18<00:00, 54.15it/s]
[4142451:MainThread](2024-04-06 16:37:19,989) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 3
[4142451:MainThread](2024-04-06 16:37:20,005) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 3
'The following are analysis results of benchmark return(1day).'
                       risk
mean              -0.000070
std                0.011971
annualized_return -0.016567
information_ratio -0.089706
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000619
std                0.005404
annualized_return  0.147395
information_ratio  1.768086
max_drawdown      -0.078645
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000421
std                0.005403
annualized_return  0.100125
information_ratio  1.201311
max_drawdown      -0.107405
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `None`.

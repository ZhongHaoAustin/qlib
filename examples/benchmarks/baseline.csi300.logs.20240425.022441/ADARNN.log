[3265079:MainThread](2024-04-25 13:32:20,805) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[3265079:MainThread](2024-04-25 13:32:20,808) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[3265079:MainThread](2024-04-25 13:32:20,808) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/crowd_data')}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3265079:MainThread](2024-04-25 13:32:24,130) INFO - qlib.ADARNN - [pytorch_adarnn.py:63] - ADARNN pytorch version...
[3265079:MainThread](2024-04-25 13:32:24,487) INFO - qlib.ADARNN - [pytorch_adarnn.py:87] - ADARNN parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3265079:MainThread](2024-04-25 13:32:24,544) INFO - qlib.ADARNN - [pytorch_adarnn.py:136] - model:
AdaRNN(
  (features): Sequential(
    (0): GRU(6, 64, batch_first=True)
    (1): GRU(64, 64, batch_first=True)
  )
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
  (gate): ModuleList(
    (0): Linear(in_features=7680, out_features=60, bias=True)
    (1): Linear(in_features=7680, out_features=60, bias=True)
  )
  (bn_lst): ModuleList(
    (0): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (softmax): Softmax(dim=0)
)
[3265079:MainThread](2024-04-25 13:32:24,545) INFO - qlib.ADARNN - [pytorch_adarnn.py:137] - model size: 0.9163 MB
[3265079:MainThread](2024-04-25 13:32:32,520) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ADARNN_crowd_data_csi300_360_rankTrue_43.
[3265079:MainThread](2024-04-25 13:32:32,627) INFO - qlib.workflow - [exp.py:258] - Experiment 100 starts running ...
[3265079:MainThread](2024-04-25 13:32:34,520) INFO - qlib.workflow - [recorder.py:341] - Recorder efce4c6645de4d1dbbb61b02d54e30ce starts running under Experiment 100 ...
[3265079:MainThread](2024-04-25 13:32:38,682) INFO - qlib.ADARNN - [pytorch_adarnn.py:266] - training...
[3265079:MainThread](2024-04-25 13:32:38,683) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch0:
[3265079:MainThread](2024-04-25 13:32:38,684) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:33:41,081) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:33:48,510) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.096863, icir/train: : 0.638262, ric/train: : 0.092947, ricir/train: : 0.619121, mse/train: : 0.017264, loss/train: : 0.017264
[3265079:MainThread](2024-04-25 13:33:48,510) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.041497, icir/valid: : 0.283948, ric/valid: : 0.040074, ricir/valid: : 0.276896, mse/valid: : 0.020692, loss/valid: : 0.020692
[3265079:MainThread](2024-04-25 13:33:48,513) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch1:
[3265079:MainThread](2024-04-25 13:33:48,513) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:34:49,878) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:34:57,054) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.038754, icir/train: : 0.277625, ric/train: : 0.037404, ricir/train: : 0.275080, mse/train: : 0.098041, loss/train: : 0.098041
[3265079:MainThread](2024-04-25 13:34:57,055) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.018462, icir/valid: : 0.135347, ric/valid: : 0.022411, ricir/valid: : 0.172342, mse/valid: : 0.089362, loss/valid: : 0.089362
[3265079:MainThread](2024-04-25 13:34:57,057) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch2:
[3265079:MainThread](2024-04-25 13:34:57,057) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:35:57,566) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:36:04,999) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.063971, icir/train: : 0.469978, ric/train: : 0.062354, ricir/train: : 0.461723, mse/train: : -0.001696, loss/train: : -0.001696
[3265079:MainThread](2024-04-25 13:36:05,000) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.018499, icir/valid: : 0.143125, ric/valid: : 0.018931, ricir/valid: : 0.150165, mse/valid: : -0.000520, loss/valid: : -0.000520
[3265079:MainThread](2024-04-25 13:36:05,000) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch3:
[3265079:MainThread](2024-04-25 13:36:05,000) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:37:11,678) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:37:19,118) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.067992, icir/train: : 0.448705, ric/train: : 0.064692, ricir/train: : 0.432459, mse/train: : -0.029123, loss/train: : -0.029123
[3265079:MainThread](2024-04-25 13:37:19,118) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.026620, icir/valid: : 0.189592, ric/valid: : 0.024549, ricir/valid: : 0.177956, mse/valid: : -0.032109, loss/valid: : -0.032109
[3265079:MainThread](2024-04-25 13:37:19,119) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch4:
[3265079:MainThread](2024-04-25 13:37:19,119) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:38:21,381) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:38:28,513) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.067917, icir/train: : 0.422014, ric/train: : 0.068095, ricir/train: : 0.433264, mse/train: : -0.004610, loss/train: : -0.004610
[3265079:MainThread](2024-04-25 13:38:28,513) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.024518, icir/valid: : 0.164416, ric/valid: : 0.025782, ricir/valid: : 0.178726, mse/valid: : -0.008700, loss/valid: : -0.008700
[3265079:MainThread](2024-04-25 13:38:28,514) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch5:
[3265079:MainThread](2024-04-25 13:38:28,514) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:39:38,271) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:39:45,592) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.070966, icir/train: : 0.485190, ric/train: : 0.068669, ricir/train: : 0.477981, mse/train: : -0.001859, loss/train: : -0.001859
[3265079:MainThread](2024-04-25 13:39:45,593) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.030703, icir/valid: : 0.227063, ric/valid: : 0.029695, ricir/valid: : 0.223040, mse/valid: : -0.000787, loss/valid: : -0.000787
[3265079:MainThread](2024-04-25 13:39:45,593) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch6:
[3265079:MainThread](2024-04-25 13:39:45,593) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:40:45,346) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:40:52,405) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.072543, icir/train: : 0.529633, ric/train: : 0.070905, ricir/train: : 0.523257, mse/train: : 0.009283, loss/train: : 0.009283
[3265079:MainThread](2024-04-25 13:40:52,406) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.031818, icir/valid: : 0.255875, ric/valid: : 0.031078, ricir/valid: : 0.252528, mse/valid: : 0.012632, loss/valid: : 0.012632
[3265079:MainThread](2024-04-25 13:40:52,406) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch7:
[3265079:MainThread](2024-04-25 13:40:52,406) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:41:53,143) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:42:00,357) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.073580, icir/train: : 0.533087, ric/train: : 0.071768, ricir/train: : 0.522203, mse/train: : -0.002427, loss/train: : -0.002427
[3265079:MainThread](2024-04-25 13:42:00,357) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.031660, icir/valid: : 0.257217, ric/valid: : 0.031700, ricir/valid: : 0.258019, mse/valid: : -0.003262, loss/valid: : -0.003262
[3265079:MainThread](2024-04-25 13:42:00,357) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch8:
[3265079:MainThread](2024-04-25 13:42:00,358) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:43:08,578) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:43:15,774) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.072809, icir/train: : 0.546520, ric/train: : 0.069937, ricir/train: : 0.513838, mse/train: : 0.038217, loss/train: : 0.038217
[3265079:MainThread](2024-04-25 13:43:15,775) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.024761, icir/valid: : 0.201706, ric/valid: : 0.023311, ricir/valid: : 0.183110, mse/valid: : 0.041401, loss/valid: : 0.041401
[3265079:MainThread](2024-04-25 13:43:15,775) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch9:
[3265079:MainThread](2024-04-25 13:43:15,775) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:44:15,557) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:44:22,957) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.078670, icir/train: : 0.583228, ric/train: : 0.076652, ricir/train: : 0.561170, mse/train: : 0.000138, loss/train: : 0.000138
[3265079:MainThread](2024-04-25 13:44:22,958) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.027349, icir/valid: : 0.222871, ric/valid: : 0.026415, ricir/valid: : 0.213356, mse/valid: : -0.002144, loss/valid: : -0.002144
[3265079:MainThread](2024-04-25 13:44:22,958) INFO - qlib.ADARNN - [pytorch_adarnn.py:294] - early stop
[3265079:MainThread](2024-04-25 13:44:22,958) INFO - qlib.ADARNN - [pytorch_adarnn.py:297] - best score: 0.089362 @ 1
[3265079:MainThread](2024-04-25 13:44:23,071) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ADARNN_crowd_data_csi300_360_rankTrue_43.
[3265079:MainThread](2024-04-25 13:44:23,398) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ADARNN_crowd_data_csi300_360_rankTrue.
[3265079:MainThread](2024-04-25 13:44:23,505) INFO - qlib.workflow - [exp.py:258] - Experiment 101 starts running ...
[3265079:MainThread](2024-04-25 13:44:23,524) INFO - qlib.workflow - [recorder.py:341] - Recorder a704e34901b041ad8dd9e103fca76bdb starts running under Experiment 101 ...
{'IC': 0.0013536984392258171,
 'ICIR': 0.009181160161704657,
 'Rank IC': 0.012407792581098361,
 'Rank ICIR': 0.08674177992422927}
[3265079:MainThread](2024-04-25 13:44:30,074) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3265079:MainThread](2024-04-25 13:45:06,374) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 13:45:06,377) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 13:45:12,549) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f89022d0d90>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 6/971 [00:00<00:16, 58.67it/s]backtest loop:   1%|          | 12/971 [00:00<00:18, 52.73it/s]backtest loop:   2%|▏         | 18/971 [00:00<00:17, 55.53it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:17, 52.74it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:16, 56.20it/s]backtest loop:   4%|▍         | 38/971 [00:00<00:16, 58.21it/s]backtest loop:   5%|▍         | 44/971 [00:00<00:16, 55.18it/s]backtest loop:   5%|▌         | 51/971 [00:00<00:16, 57.27it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:16, 54.71it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:15, 57.02it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:15, 59.04it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:15, 56.01it/s]backtest loop:   9%|▊         | 83/971 [00:01<00:15, 57.07it/s]backtest loop:   9%|▉         | 89/971 [00:01<00:15, 57.89it/s]backtest loop:  10%|▉         | 96/971 [00:01<00:14, 59.45it/s]backtest loop:  11%|█         | 102/971 [00:01<00:15, 56.31it/s]backtest loop:  11%|█         | 108/971 [00:01<00:15, 57.33it/s]backtest loop:  12%|█▏        | 115/971 [00:02<00:14, 58.95it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.07it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:15, 52.78it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:15, 55.72it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 54.83it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 57.12it/s]backtest loop:  16%|█▌        | 154/971 [00:02<00:14, 57.76it/s]backtest loop:  16%|█▋        | 160/971 [00:02<00:14, 57.67it/s]backtest loop:  17%|█▋        | 166/971 [00:02<00:14, 55.02it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:13, 57.33it/s]backtest loop:  19%|█▊        | 180/971 [00:03<00:13, 58.86it/s]backtest loop:  19%|█▉        | 186/971 [00:03<00:14, 55.64it/s]backtest loop:  20%|█▉        | 193/971 [00:03<00:13, 58.00it/s]backtest loop:  21%|██        | 200/971 [00:03<00:13, 56.15it/s]backtest loop:  21%|██▏       | 207/971 [00:03<00:13, 57.96it/s]backtest loop:  22%|██▏       | 213/971 [00:03<00:13, 55.47it/s]backtest loop:  23%|██▎       | 219/971 [00:03<00:13, 56.65it/s]backtest loop:  23%|██▎       | 225/971 [00:03<00:13, 54.36it/s]backtest loop:  24%|██▍       | 232/971 [00:04<00:13, 56.71it/s]backtest loop:  25%|██▍       | 239/971 [00:04<00:12, 58.58it/s]backtest loop:  25%|██▌       | 245/971 [00:04<00:12, 55.85it/s]backtest loop:  26%|██▌       | 251/971 [00:04<00:12, 56.16it/s]backtest loop:  27%|██▋       | 258/971 [00:04<00:12, 57.99it/s]backtest loop:  27%|██▋       | 264/971 [00:04<00:12, 55.13it/s]backtest loop:  28%|██▊       | 271/971 [00:04<00:12, 54.34it/s]backtest loop:  29%|██▊       | 278/971 [00:04<00:12, 56.60it/s]backtest loop:  29%|██▉       | 284/971 [00:05<00:11, 57.27it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 55.53it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 57.49it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:11, 55.69it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 57.70it/s]backtest loop:  33%|███▎      | 319/971 [00:05<00:11, 59.10it/s]backtest loop:  33%|███▎      | 325/971 [00:05<00:11, 56.47it/s]backtest loop:  34%|███▍      | 331/971 [00:05<00:11, 57.40it/s]backtest loop:  35%|███▍      | 337/971 [00:05<00:10, 57.65it/s]backtest loop:  35%|███▌      | 344/971 [00:06<00:10, 59.20it/s]backtest loop:  36%|███▌      | 350/971 [00:06<00:11, 56.03it/s]backtest loop:  37%|███▋      | 356/971 [00:06<00:10, 57.11it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:10, 55.46it/s]backtest loop:  38%|███▊      | 369/971 [00:06<00:11, 53.63it/s]backtest loop:  39%|███▊      | 376/971 [00:06<00:10, 56.14it/s]backtest loop:  39%|███▉      | 382/971 [00:06<00:10, 56.96it/s]backtest loop:  40%|███▉      | 388/971 [00:06<00:10, 54.49it/s]backtest loop:  41%|████      | 395/971 [00:06<00:10, 56.73it/s]backtest loop:  41%|████▏     | 402/971 [00:07<00:09, 58.61it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:10, 55.94it/s]backtest loop:  43%|████▎     | 414/971 [00:07<00:09, 56.90it/s]backtest loop:  43%|████▎     | 420/971 [00:07<00:09, 57.52it/s]backtest loop:  44%|████▍     | 426/971 [00:07<00:09, 58.20it/s]backtest loop:  44%|████▍     | 432/971 [00:07<00:09, 55.30it/s]backtest loop:  45%|████▌     | 438/971 [00:07<00:09, 56.45it/s]backtest loop:  46%|████▌     | 445/971 [00:07<00:08, 58.62it/s]backtest loop:  47%|████▋     | 452/971 [00:07<00:09, 56.37it/s]backtest loop:  47%|████▋     | 458/971 [00:08<00:09, 56.94it/s]backtest loop:  48%|████▊     | 465/971 [00:08<00:08, 58.57it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:08, 56.55it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 58.18it/s]backtest loop:  50%|████▉     | 485/971 [00:08<00:08, 58.65it/s]backtest loop:  51%|█████     | 491/971 [00:08<00:08, 55.79it/s]backtest loop:  51%|█████▏    | 498/971 [00:08<00:08, 57.74it/s]backtest loop:  52%|█████▏    | 505/971 [00:08<00:08, 56.09it/s]backtest loop:  53%|█████▎    | 512/971 [00:09<00:08, 54.66it/s]backtest loop:  53%|█████▎    | 518/971 [00:09<00:08, 55.94it/s]backtest loop:  54%|█████▍    | 525/971 [00:09<00:07, 57.75it/s]backtest loop:  55%|█████▍    | 531/971 [00:09<00:07, 55.22it/s]backtest loop:  55%|█████▌    | 538/971 [00:09<00:07, 57.45it/s]backtest loop:  56%|█████▌    | 545/971 [00:09<00:07, 58.90it/s]backtest loop:  57%|█████▋    | 551/971 [00:09<00:07, 55.93it/s]backtest loop:  57%|█████▋    | 558/971 [00:09<00:07, 57.81it/s]backtest loop:  58%|█████▊    | 565/971 [00:09<00:06, 59.21it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 56.11it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:06, 57.91it/s]backtest loop:  60%|██████    | 584/971 [00:10<00:06, 58.42it/s]backtest loop:  61%|██████    | 591/971 [00:10<00:06, 56.21it/s]backtest loop:  62%|██████▏   | 598/971 [00:10<00:06, 57.99it/s]backtest loop:  62%|██████▏   | 605/971 [00:10<00:06, 56.08it/s]backtest loop:  63%|██████▎   | 612/971 [00:10<00:06, 57.72it/s]backtest loop:  64%|██████▎   | 618/971 [00:10<00:06, 58.31it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 56.41it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 58.16it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 59.69it/s]backtest loop:  67%|██████▋   | 646/971 [00:11<00:05, 56.92it/s]backtest loop:  67%|██████▋   | 652/971 [00:11<00:05, 57.69it/s]backtest loop:  68%|██████▊   | 659/971 [00:11<00:05, 59.11it/s]backtest loop:  68%|██████▊   | 665/971 [00:11<00:05, 56.08it/s]backtest loop:  69%|██████▉   | 672/971 [00:11<00:05, 58.02it/s]backtest loop:  70%|██████▉   | 679/971 [00:11<00:05, 55.97it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 56.94it/s]backtest loop:  71%|███████▏  | 692/971 [00:12<00:04, 58.57it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 56.49it/s]backtest loop:  73%|███████▎  | 706/971 [00:12<00:04, 58.20it/s]backtest loop:  73%|███████▎  | 713/971 [00:12<00:04, 59.32it/s]backtest loop:  74%|███████▍  | 719/971 [00:12<00:04, 56.14it/s]backtest loop:  75%|███████▍  | 726/971 [00:12<00:04, 57.99it/s]backtest loop:  75%|███████▌  | 732/971 [00:12<00:04, 55.42it/s]backtest loop:  76%|███████▌  | 738/971 [00:12<00:04, 53.58it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:04, 56.12it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 54.09it/s]backtest loop:  78%|███████▊  | 758/971 [00:13<00:03, 56.42it/s]backtest loop:  79%|███████▉  | 765/971 [00:13<00:03, 55.13it/s]backtest loop:  80%|███████▉  | 772/971 [00:13<00:03, 57.21it/s]backtest loop:  80%|████████  | 779/971 [00:13<00:03, 58.60it/s]backtest loop:  81%|████████  | 785/971 [00:13<00:03, 55.78it/s]backtest loop:  82%|████████▏ | 792/971 [00:13<00:03, 57.83it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 55.24it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:02, 57.33it/s]backtest loop:  84%|████████▎ | 811/971 [00:14<00:02, 57.96it/s]backtest loop:  84%|████████▍ | 818/971 [00:14<00:02, 55.91it/s]backtest loop:  85%|████████▍ | 825/971 [00:14<00:02, 57.76it/s]backtest loop:  86%|████████▌ | 832/971 [00:14<00:02, 59.16it/s]backtest loop:  86%|████████▋ | 838/971 [00:14<00:02, 56.14it/s]backtest loop:  87%|████████▋ | 844/971 [00:14<00:02, 57.01it/s]backtest loop:  88%|████████▊ | 850/971 [00:14<00:02, 57.75it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 55.85it/s]backtest loop:  89%|████████▉ | 864/971 [00:15<00:01, 57.78it/s]backtest loop:  90%|████████▉ | 871/971 [00:15<00:01, 59.15it/s]backtest loop:  90%|█████████ | 877/971 [00:15<00:01, 55.93it/s]backtest loop:  91%|█████████ | 884/971 [00:15<00:01, 57.71it/s]backtest loop:  92%|█████████▏| 891/971 [00:15<00:01, 59.12it/s]backtest loop:  92%|█████████▏| 897/971 [00:15<00:01, 56.15it/s]backtest loop:  93%|█████████▎| 904/971 [00:15<00:01, 57.98it/s]backtest loop:  94%|█████████▍| 911/971 [00:15<00:01, 59.17it/s]backtest loop:  94%|█████████▍| 917/971 [00:16<00:00, 56.25it/s]backtest loop:  95%|█████████▌| 924/971 [00:16<00:00, 58.03it/s]backtest loop:  96%|█████████▌| 931/971 [00:16<00:00, 56.29it/s]backtest loop:  97%|█████████▋| 938/971 [00:16<00:00, 58.06it/s]backtest loop:  97%|█████████▋| 945/971 [00:16<00:00, 55.94it/s]backtest loop:  98%|█████████▊| 952/971 [00:16<00:00, 57.84it/s]backtest loop:  99%|█████████▉| 959/971 [00:16<00:00, 59.18it/s]backtest loop:  99%|█████████▉| 965/971 [00:16<00:00, 56.21it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 56.94it/s]
[3265079:MainThread](2024-04-25 13:45:29,660) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000167
std                0.005204
annualized_return  0.039654
information_ratio  0.493879
max_drawdown      -0.105571
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean              -0.000036
std                0.005205
annualized_return -0.008511
information_ratio -0.105986
max_drawdown      -0.202378
[3265079:MainThread](2024-04-25 13:45:29,675) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ADARNN_crowd_data_csi300_360_rankTrue`.
[3265079:MainThread](2024-04-25 13:45:36,414) INFO - qlib.timer - [log.py:127] - Time cost: 0.009s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.0085111448463081],
 '1day.excess_return_with_cost.information_ratio': [-0.10598626920625567],
 '1day.excess_return_with_cost.max_drawdown': [-0.20237780038364295],
 'IC': [0.0013536984392258171],
 'ICIR': [0.009181160161704657],
 'Rank IC': [0.012407792581098361],
 'Rank ICIR': [0.08674177992422927],
 'mae': [0.8703869590122575],
 'mse': [1.0176620582257514]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3265079:MainThread](2024-04-25 13:45:39,694) INFO - qlib.ADARNN - [pytorch_adarnn.py:63] - ADARNN pytorch version...
[3265079:MainThread](2024-04-25 13:45:39,695) INFO - qlib.ADARNN - [pytorch_adarnn.py:87] - ADARNN parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3265079:MainThread](2024-04-25 13:45:39,710) INFO - qlib.ADARNN - [pytorch_adarnn.py:136] - model:
AdaRNN(
  (features): Sequential(
    (0): GRU(6, 64, batch_first=True)
    (1): GRU(64, 64, batch_first=True)
  )
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
  (gate): ModuleList(
    (0): Linear(in_features=7680, out_features=60, bias=True)
    (1): Linear(in_features=7680, out_features=60, bias=True)
  )
  (bn_lst): ModuleList(
    (0): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (softmax): Softmax(dim=0)
)
[3265079:MainThread](2024-04-25 13:45:39,710) INFO - qlib.ADARNN - [pytorch_adarnn.py:137] - model size: 0.9163 MB
[3265079:MainThread](2024-04-25 13:45:42,661) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ADARNN_crowd_data_csi300_360_rankTrue_44.
[3265079:MainThread](2024-04-25 13:45:42,769) INFO - qlib.workflow - [exp.py:258] - Experiment 102 starts running ...
[3265079:MainThread](2024-04-25 13:45:42,787) INFO - qlib.workflow - [recorder.py:341] - Recorder 31f61ff3ac9c4f6ea645ae8b4a01a78c starts running under Experiment 102 ...
[3265079:MainThread](2024-04-25 13:45:47,053) INFO - qlib.ADARNN - [pytorch_adarnn.py:266] - training...
[3265079:MainThread](2024-04-25 13:45:47,053) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch0:
[3265079:MainThread](2024-04-25 13:45:47,054) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:46:58,648) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:47:05,858) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.085134, icir/train: : 0.538654, ric/train: : 0.081726, ricir/train: : 0.515958, mse/train: : -0.001587, loss/train: : -0.001587
[3265079:MainThread](2024-04-25 13:47:05,859) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.028225, icir/valid: : 0.185142, ric/valid: : 0.025376, ricir/valid: : 0.167896, mse/valid: : -0.002294, loss/valid: : -0.002294
[3265079:MainThread](2024-04-25 13:47:05,860) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch1:
[3265079:MainThread](2024-04-25 13:47:05,861) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:48:14,881) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:48:22,077) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.103576, icir/train: : 0.809440, ric/train: : 0.099142, ricir/train: : 0.770403, mse/train: : 0.038076, loss/train: : 0.038076
[3265079:MainThread](2024-04-25 13:48:22,078) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.042759, icir/valid: : 0.324525, ric/valid: : 0.041010, ricir/valid: : 0.310410, mse/valid: : 0.046771, loss/valid: : 0.046771
[3265079:MainThread](2024-04-25 13:48:22,080) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch2:
[3265079:MainThread](2024-04-25 13:48:22,080) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:49:28,411) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:49:35,565) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.075663, icir/train: : 0.525927, ric/train: : 0.074042, ricir/train: : 0.514446, mse/train: : 0.024150, loss/train: : 0.024150
[3265079:MainThread](2024-04-25 13:49:35,565) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.034537, icir/valid: : 0.242060, ric/valid: : 0.033453, ricir/valid: : 0.232879, mse/valid: : 0.026651, loss/valid: : 0.026651
[3265079:MainThread](2024-04-25 13:49:35,566) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch3:
[3265079:MainThread](2024-04-25 13:49:35,566) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:50:38,597) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:50:45,720) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.044363, icir/train: : 0.280894, ric/train: : 0.040908, ricir/train: : 0.267186, mse/train: : -0.052923, loss/train: : -0.052923
[3265079:MainThread](2024-04-25 13:50:45,721) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.016772, icir/valid: : 0.117501, ric/valid: : 0.017167, ricir/valid: : 0.120380, mse/valid: : -0.058063, loss/valid: : -0.058063
[3265079:MainThread](2024-04-25 13:50:45,721) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch4:
[3265079:MainThread](2024-04-25 13:50:45,721) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:51:56,489) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:52:03,666) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.049040, icir/train: : 0.266625, ric/train: : 0.044743, ricir/train: : 0.239591, mse/train: : -0.031140, loss/train: : -0.031140
[3265079:MainThread](2024-04-25 13:52:03,666) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.017054, icir/valid: : 0.103206, ric/valid: : 0.020997, ricir/valid: : 0.121172, mse/valid: : -0.038504, loss/valid: : -0.038504
[3265079:MainThread](2024-04-25 13:52:03,666) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch5:
[3265079:MainThread](2024-04-25 13:52:03,667) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:53:09,895) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:53:16,938) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.052986, icir/train: : 0.317782, ric/train: : 0.048133, ricir/train: : 0.292621, mse/train: : 0.019521, loss/train: : 0.019521
[3265079:MainThread](2024-04-25 13:53:16,938) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.018542, icir/valid: : 0.118471, ric/valid: : 0.019941, ricir/valid: : 0.123361, mse/valid: : 0.015600, loss/valid: : 0.015600
[3265079:MainThread](2024-04-25 13:53:16,939) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch6:
[3265079:MainThread](2024-04-25 13:53:16,939) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:54:19,473) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:54:26,673) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.054261, icir/train: : 0.334902, ric/train: : 0.049732, ricir/train: : 0.317124, mse/train: : -0.030249, loss/train: : -0.030249
[3265079:MainThread](2024-04-25 13:54:26,674) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.020625, icir/valid: : 0.139144, ric/valid: : 0.020538, ricir/valid: : 0.138552, mse/valid: : -0.033419, loss/valid: : -0.033419
[3265079:MainThread](2024-04-25 13:54:26,674) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch7:
[3265079:MainThread](2024-04-25 13:54:26,674) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:55:29,016) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:55:36,152) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.056063, icir/train: : 0.349928, ric/train: : 0.051835, ricir/train: : 0.333716, mse/train: : -0.034882, loss/train: : -0.034882
[3265079:MainThread](2024-04-25 13:55:36,153) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.021304, icir/valid: : 0.142361, ric/valid: : 0.020801, ricir/valid: : 0.139889, mse/valid: : -0.037719, loss/valid: : -0.037719
[3265079:MainThread](2024-04-25 13:55:36,153) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch8:
[3265079:MainThread](2024-04-25 13:55:36,153) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:56:43,120) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:56:50,310) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.058201, icir/train: : 0.354078, ric/train: : 0.053165, ricir/train: : 0.329130, mse/train: : -0.002041, loss/train: : -0.002041
[3265079:MainThread](2024-04-25 13:56:50,310) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.023737, icir/valid: : 0.155210, ric/valid: : 0.024285, ricir/valid: : 0.159781, mse/valid: : -0.005936, loss/valid: : -0.005936
[3265079:MainThread](2024-04-25 13:56:50,311) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch9:
[3265079:MainThread](2024-04-25 13:56:50,311) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:57:57,864) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:58:05,013) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.056225, icir/train: : 0.356663, ric/train: : 0.052176, ricir/train: : 0.335468, mse/train: : 0.025345, loss/train: : 0.025345
[3265079:MainThread](2024-04-25 13:58:05,013) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.021054, icir/valid: : 0.141396, ric/valid: : 0.019528, ricir/valid: : 0.130806, mse/valid: : 0.023289, loss/valid: : 0.023289
[3265079:MainThread](2024-04-25 13:58:05,014) INFO - qlib.ADARNN - [pytorch_adarnn.py:294] - early stop
[3265079:MainThread](2024-04-25 13:58:05,014) INFO - qlib.ADARNN - [pytorch_adarnn.py:297] - best score: 0.046771 @ 1
[3265079:MainThread](2024-04-25 13:58:05,130) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ADARNN_crowd_data_csi300_360_rankTrue_44.
[3265079:MainThread](2024-04-25 13:58:05,453) INFO - qlib.workflow - [exp.py:258] - Experiment 101 starts running ...
[3265079:MainThread](2024-04-25 13:58:05,469) INFO - qlib.workflow - [recorder.py:341] - Recorder 7b28f9c8be63486b9eb89ac0000537e3 starts running under Experiment 101 ...
{'IC': 0.026439898619729344,
 'ICIR': 0.21079803251917983,
 'Rank IC': 0.03724272331287428,
 'Rank ICIR': 0.29319132408979226}
[3265079:MainThread](2024-04-25 13:58:12,147) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3265079:MainThread](2024-04-25 13:58:50,535) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 13:58:50,538) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 13:58:56,474) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f889f938490>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:41,  9.56it/s]backtest loop:   1%|          | 10/971 [00:00<00:35, 27.40it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:26, 36.55it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:22, 41.99it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:19, 47.89it/s]backtest loop:   4%|▍         | 37/971 [00:00<00:18, 51.11it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:17, 51.68it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:16, 55.00it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 53.63it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:15, 56.69it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:15, 58.49it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:15, 55.88it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 58.00it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 59.44it/s]backtest loop:  10%|▉         | 97/971 [00:01<00:15, 56.42it/s]backtest loop:  11%|█         | 104/971 [00:02<00:14, 58.16it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:14, 59.66it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:15, 56.57it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:14, 58.48it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:15, 55.78it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 54.62it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:14, 57.12it/s]backtest loop:  15%|█▌        | 150/971 [00:02<00:13, 58.86it/s]backtest loop:  16%|█▌        | 156/971 [00:02<00:14, 55.89it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:13, 57.95it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:13, 59.93it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:13, 57.84it/s]backtest loop:  19%|█▉        | 184/971 [00:03<00:13, 59.39it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:13, 56.39it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 58.42it/s]backtest loop:  21%|██        | 204/971 [00:03<00:12, 59.76it/s]backtest loop:  22%|██▏       | 211/971 [00:03<00:13, 57.61it/s]backtest loop:  22%|██▏       | 217/971 [00:04<00:13, 55.23it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:20, 37.19it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:17, 41.71it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:16, 43.80it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:14, 48.60it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:14, 49.96it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:13, 54.35it/s]backtest loop:  27%|██▋       | 263/971 [00:05<00:12, 56.85it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:12, 54.66it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:12, 53.92it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:12, 56.48it/s]backtest loop:  30%|██▉       | 290/971 [00:05<00:11, 58.29it/s]backtest loop:  30%|███       | 296/971 [00:05<00:12, 55.63it/s]backtest loop:  31%|███       | 303/971 [00:05<00:11, 57.80it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:11, 56.01it/s]backtest loop:  33%|███▎      | 317/971 [00:05<00:11, 57.88it/s]backtest loop:  33%|███▎      | 324/971 [00:06<00:10, 59.33it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:11, 56.30it/s]backtest loop:  35%|███▍      | 337/971 [00:06<00:10, 58.30it/s]backtest loop:  35%|███▌      | 344/971 [00:06<00:10, 59.56it/s]backtest loop:  36%|███▌      | 350/971 [00:06<00:10, 56.70it/s]backtest loop:  37%|███▋      | 357/971 [00:06<00:10, 58.60it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:10, 55.59it/s]backtest loop:  38%|███▊      | 369/971 [00:06<00:11, 53.89it/s]backtest loop:  39%|███▊      | 376/971 [00:07<00:10, 56.48it/s]backtest loop:  39%|███▉      | 383/971 [00:07<00:10, 55.27it/s]backtest loop:  40%|████      | 390/971 [00:07<00:10, 57.30it/s]backtest loop:  41%|████      | 397/971 [00:07<00:09, 59.10it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 56.47it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:09, 58.55it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 59.85it/s]backtest loop:  44%|████▎     | 424/971 [00:07<00:09, 57.37it/s]backtest loop:  44%|████▍     | 431/971 [00:07<00:09, 58.75it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:09, 55.94it/s]backtest loop:  46%|████▌     | 444/971 [00:08<00:09, 57.89it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:08, 59.55it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:09, 56.36it/s]backtest loop:  48%|████▊     | 463/971 [00:08<00:08, 57.26it/s]backtest loop:  48%|████▊     | 470/971 [00:08<00:08, 58.97it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:08, 56.73it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:08, 58.45it/s]backtest loop:  50%|█████     | 490/971 [00:08<00:08, 55.85it/s]backtest loop:  51%|█████     | 496/971 [00:09<00:08, 56.87it/s]backtest loop:  52%|█████▏    | 503/971 [00:09<00:07, 58.53it/s]backtest loop:  52%|█████▏    | 509/971 [00:09<00:08, 55.74it/s]backtest loop:  53%|█████▎    | 516/971 [00:09<00:07, 57.82it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:08, 55.47it/s]backtest loop:  54%|█████▍    | 528/971 [00:09<00:07, 56.70it/s]backtest loop:  55%|█████▌    | 535/971 [00:09<00:07, 58.78it/s]backtest loop:  56%|█████▌    | 541/971 [00:09<00:07, 55.91it/s]backtest loop:  56%|█████▋    | 548/971 [00:09<00:07, 58.00it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:06, 59.62it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 56.30it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:06, 58.18it/s]backtest loop:  59%|█████▉    | 575/971 [00:10<00:06, 59.65it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:06, 57.03it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:06, 59.04it/s]backtest loop:  61%|██████    | 594/971 [00:10<00:06, 59.18it/s]backtest loop:  62%|██████▏   | 600/971 [00:10<00:06, 55.83it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 57.78it/s]backtest loop:  63%|██████▎   | 614/971 [00:11<00:06, 59.24it/s]backtest loop:  64%|██████▍   | 620/971 [00:11<00:06, 56.31it/s]backtest loop:  64%|██████▍   | 626/971 [00:11<00:06, 56.70it/s]backtest loop:  65%|██████▌   | 633/971 [00:11<00:05, 58.52it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:05, 56.66it/s]backtest loop:  67%|██████▋   | 647/971 [00:11<00:05, 58.36it/s]backtest loop:  67%|██████▋   | 654/971 [00:11<00:05, 59.61it/s]backtest loop:  68%|██████▊   | 660/971 [00:11<00:05, 56.37it/s]backtest loop:  69%|██████▊   | 666/971 [00:12<00:05, 57.32it/s]backtest loop:  69%|██████▉   | 673/971 [00:12<00:05, 58.92it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 56.12it/s]backtest loop:  71%|███████   | 686/971 [00:12<00:04, 58.04it/s]backtest loop:  71%|███████▏  | 693/971 [00:12<00:04, 59.34it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 55.78it/s]backtest loop:  73%|███████▎  | 706/971 [00:12<00:04, 57.72it/s]backtest loop:  73%|███████▎  | 713/971 [00:12<00:04, 59.13it/s]backtest loop:  74%|███████▍  | 719/971 [00:12<00:04, 56.22it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 57.97it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 55.22it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 53.63it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:04, 56.20it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 54.08it/s]backtest loop:  78%|███████▊  | 757/971 [00:13<00:03, 55.64it/s]backtest loop:  79%|███████▊  | 764/971 [00:13<00:03, 57.66it/s]backtest loop:  79%|███████▉  | 770/971 [00:13<00:03, 55.10it/s]backtest loop:  80%|████████  | 777/971 [00:13<00:03, 57.44it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 55.61it/s]backtest loop:  81%|████████▏ | 789/971 [00:14<00:03, 56.48it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.39it/s]backtest loop:  82%|████████▏ | 801/971 [00:14<00:02, 58.11it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 56.14it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 58.03it/s]backtest loop:  85%|████████▍ | 822/971 [00:14<00:02, 59.31it/s]backtest loop:  85%|████████▌ | 828/971 [00:14<00:02, 55.81it/s]backtest loop:  86%|████████▌ | 835/971 [00:15<00:02, 57.70it/s]backtest loop:  87%|████████▋ | 842/971 [00:15<00:02, 59.05it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 56.06it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:02, 57.90it/s]backtest loop:  89%|████████▊ | 861/971 [00:15<00:01, 58.34it/s]backtest loop:  89%|████████▉ | 867/971 [00:15<00:01, 55.51it/s]backtest loop:  90%|█████████ | 874/971 [00:15<00:01, 57.55it/s]backtest loop:  91%|█████████ | 881/971 [00:15<00:01, 59.04it/s]backtest loop:  91%|█████████▏| 887/971 [00:15<00:01, 55.42it/s]backtest loop:  92%|█████████▏| 894/971 [00:16<00:01, 57.39it/s]backtest loop:  93%|█████████▎| 901/971 [00:16<00:01, 58.90it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 56.00it/s]backtest loop:  94%|█████████▍| 914/971 [00:16<00:00, 57.83it/s]backtest loop:  95%|█████████▍| 921/971 [00:16<00:00, 55.93it/s]backtest loop:  96%|█████████▌| 928/971 [00:16<00:00, 57.78it/s]backtest loop:  96%|█████████▋| 935/971 [00:16<00:00, 59.14it/s]backtest loop:  97%|█████████▋| 941/971 [00:16<00:00, 56.13it/s]backtest loop:  98%|█████████▊| 948/971 [00:16<00:00, 58.01it/s]backtest loop:  98%|█████████▊| 955/971 [00:17<00:00, 56.03it/s]backtest loop:  99%|█████████▉| 962/971 [00:17<00:00, 57.88it/s]backtest loop: 100%|█████████▉| 969/971 [00:17<00:00, 59.82it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.88it/s]
[3265079:MainThread](2024-04-25 13:59:13,907) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000366
std                0.004821
annualized_return  0.087227
information_ratio  1.172898
max_drawdown      -0.065410
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000169
std                0.004822
annualized_return  0.040134
information_ratio  0.539491
max_drawdown      -0.075940
[3265079:MainThread](2024-04-25 13:59:13,919) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ADARNN_crowd_data_csi300_360_rankTrue`.
[3265079:MainThread](2024-04-25 13:59:20,701) INFO - qlib.timer - [log.py:127] - Time cost: 0.009s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.0085111448463081,
                                                    0.040133948309472374],
 '1day.excess_return_with_cost.information_ratio': [-0.10598626920625567,
                                                    0.5394907020639452],
 '1day.excess_return_with_cost.max_drawdown': [-0.20237780038364295,
                                               -0.07594003976516654],
 'IC': [0.0013536984392258171, 0.026439898619729344],
 'ICIR': [0.009181160161704657, 0.21079803251917983],
 'Rank IC': [0.012407792581098361, 0.03724272331287428],
 'Rank ICIR': [0.08674177992422927, 0.29319132408979226],
 'mae': [0.8703869590122575, 0.8647632230090078],
 'mse': [1.0176620582257514, 1.0010798346127248]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3265079:MainThread](2024-04-25 13:59:23,950) INFO - qlib.ADARNN - [pytorch_adarnn.py:63] - ADARNN pytorch version...
[3265079:MainThread](2024-04-25 13:59:23,950) INFO - qlib.ADARNN - [pytorch_adarnn.py:87] - ADARNN parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3265079:MainThread](2024-04-25 13:59:23,966) INFO - qlib.ADARNN - [pytorch_adarnn.py:136] - model:
AdaRNN(
  (features): Sequential(
    (0): GRU(6, 64, batch_first=True)
    (1): GRU(64, 64, batch_first=True)
  )
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
  (gate): ModuleList(
    (0): Linear(in_features=7680, out_features=60, bias=True)
    (1): Linear(in_features=7680, out_features=60, bias=True)
  )
  (bn_lst): ModuleList(
    (0): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (softmax): Softmax(dim=0)
)
[3265079:MainThread](2024-04-25 13:59:23,967) INFO - qlib.ADARNN - [pytorch_adarnn.py:137] - model size: 0.9163 MB
[3265079:MainThread](2024-04-25 13:59:26,927) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ADARNN_crowd_data_csi300_360_rankTrue_45.
[3265079:MainThread](2024-04-25 13:59:27,036) INFO - qlib.workflow - [exp.py:258] - Experiment 103 starts running ...
[3265079:MainThread](2024-04-25 13:59:27,060) INFO - qlib.workflow - [recorder.py:341] - Recorder d90a0be3cc9048d18e6345dc9ed5bd7e starts running under Experiment 103 ...
[3265079:MainThread](2024-04-25 13:59:31,485) INFO - qlib.ADARNN - [pytorch_adarnn.py:266] - training...
[3265079:MainThread](2024-04-25 13:59:31,485) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch0:
[3265079:MainThread](2024-04-25 13:59:31,486) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:00:44,227) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:00:51,495) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.090034, icir/train: : 0.634950, ric/train: : 0.086366, ricir/train: : 0.612264, mse/train: : -0.005354, loss/train: : -0.005354
[3265079:MainThread](2024-04-25 14:00:51,495) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.034816, icir/valid: : 0.248264, ric/valid: : 0.031770, ricir/valid: : 0.225946, mse/valid: : 0.001044, loss/valid: : 0.001044
[3265079:MainThread](2024-04-25 14:00:51,497) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch1:
[3265079:MainThread](2024-04-25 14:00:51,497) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:02:00,037) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:02:07,444) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.082462, icir/train: : 0.627685, ric/train: : 0.080193, ricir/train: : 0.610878, mse/train: : -0.016388, loss/train: : -0.016388
[3265079:MainThread](2024-04-25 14:02:07,444) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.038705, icir/valid: : 0.300113, ric/valid: : 0.038123, ricir/valid: : 0.294688, mse/valid: : -0.014409, loss/valid: : -0.014409
[3265079:MainThread](2024-04-25 14:02:07,445) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch2:
[3265079:MainThread](2024-04-25 14:02:07,445) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:03:16,006) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:03:23,233) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.096839, icir/train: : 0.745688, ric/train: : 0.092924, ricir/train: : 0.722597, mse/train: : 0.025281, loss/train: : 0.025281
[3265079:MainThread](2024-04-25 14:03:23,234) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.045168, icir/valid: : 0.345978, ric/valid: : 0.040953, ricir/valid: : 0.309044, mse/valid: : 0.033845, loss/valid: : 0.033845
[3265079:MainThread](2024-04-25 14:03:23,236) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch3:
[3265079:MainThread](2024-04-25 14:03:23,236) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:04:27,320) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:04:34,830) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.089787, icir/train: : 0.738315, ric/train: : 0.086634, ricir/train: : 0.713538, mse/train: : 0.001232, loss/train: : 0.001232
[3265079:MainThread](2024-04-25 14:04:34,830) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.041387, icir/valid: : 0.349329, ric/valid: : 0.037084, ricir/valid: : 0.309799, mse/valid: : 0.009062, loss/valid: : 0.009062
[3265079:MainThread](2024-04-25 14:04:34,831) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch4:
[3265079:MainThread](2024-04-25 14:04:34,831) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:05:42,215) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:05:49,410) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.105366, icir/train: : 0.820610, ric/train: : 0.101293, ricir/train: : 0.795980, mse/train: : 0.040119, loss/train: : 0.040119
[3265079:MainThread](2024-04-25 14:05:49,410) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.045507, icir/valid: : 0.346553, ric/valid: : 0.043672, ricir/valid: : 0.336754, mse/valid: : 0.043054, loss/valid: : 0.043054
[3265079:MainThread](2024-04-25 14:05:49,412) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch5:
[3265079:MainThread](2024-04-25 14:05:49,413) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:06:52,901) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:07:00,125) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.110289, icir/train: : 0.854621, ric/train: : 0.106301, ricir/train: : 0.825722, mse/train: : -0.008884, loss/train: : -0.008884
[3265079:MainThread](2024-04-25 14:07:00,126) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.044493, icir/valid: : 0.332252, ric/valid: : 0.041423, ricir/valid: : 0.307570, mse/valid: : -0.004866, loss/valid: : -0.004866
[3265079:MainThread](2024-04-25 14:07:00,126) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch6:
[3265079:MainThread](2024-04-25 14:07:00,126) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:08:08,984) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:08:16,522) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.111421, icir/train: : 0.837590, ric/train: : 0.106778, ricir/train: : 0.806883, mse/train: : 0.013640, loss/train: : 0.013640
[3265079:MainThread](2024-04-25 14:08:16,523) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.042078, icir/valid: : 0.316256, ric/valid: : 0.041246, ricir/valid: : 0.310714, mse/valid: : 0.012190, loss/valid: : 0.012190
[3265079:MainThread](2024-04-25 14:08:16,523) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch7:
[3265079:MainThread](2024-04-25 14:08:16,524) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:09:28,039) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:09:35,292) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.113337, icir/train: : 0.892281, ric/train: : 0.108887, ricir/train: : 0.858429, mse/train: : -0.013731, loss/train: : -0.013731
[3265079:MainThread](2024-04-25 14:09:35,293) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.047748, icir/valid: : 0.365124, ric/valid: : 0.043998, ricir/valid: : 0.334686, mse/valid: : -0.003604, loss/valid: : -0.003604
[3265079:MainThread](2024-04-25 14:09:35,293) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch8:
[3265079:MainThread](2024-04-25 14:09:35,293) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:10:43,350) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:10:50,877) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.112368, icir/train: : 0.892077, ric/train: : 0.108502, ricir/train: : 0.860560, mse/train: : 0.019080, loss/train: : 0.019080
[3265079:MainThread](2024-04-25 14:10:50,878) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.041868, icir/valid: : 0.315056, ric/valid: : 0.038993, ricir/valid: : 0.294325, mse/valid: : 0.032978, loss/valid: : 0.032978
[3265079:MainThread](2024-04-25 14:10:50,878) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch9:
[3265079:MainThread](2024-04-25 14:10:50,878) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:11:58,191) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:12:05,408) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.117142, icir/train: : 0.925711, ric/train: : 0.112526, ricir/train: : 0.890155, mse/train: : 0.014401, loss/train: : 0.014401
[3265079:MainThread](2024-04-25 14:12:05,408) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.044738, icir/valid: : 0.350236, ric/valid: : 0.042156, ricir/valid: : 0.327769, mse/valid: : 0.016247, loss/valid: : 0.016247
[3265079:MainThread](2024-04-25 14:12:05,409) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch10:
[3265079:MainThread](2024-04-25 14:12:05,409) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:13:08,769) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:13:16,277) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.118524, icir/train: : 0.893325, ric/train: : 0.113893, ricir/train: : 0.864899, mse/train: : 0.019849, loss/train: : 0.019849
[3265079:MainThread](2024-04-25 14:13:16,277) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.047242, icir/valid: : 0.344269, ric/valid: : 0.044033, ricir/valid: : 0.322987, mse/valid: : 0.035978, loss/valid: : 0.035978
[3265079:MainThread](2024-04-25 14:13:16,278) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch11:
[3265079:MainThread](2024-04-25 14:13:16,278) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:14:18,881) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:14:26,101) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.120641, icir/train: : 0.986460, ric/train: : 0.116592, ricir/train: : 0.955005, mse/train: : -0.012415, loss/train: : -0.012415
[3265079:MainThread](2024-04-25 14:14:26,101) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.046923, icir/valid: : 0.366397, ric/valid: : 0.045265, ricir/valid: : 0.350811, mse/valid: : 0.000372, loss/valid: : 0.000372
[3265079:MainThread](2024-04-25 14:14:26,101) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch12:
[3265079:MainThread](2024-04-25 14:14:26,102) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:15:27,712) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:15:34,935) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.119216, icir/train: : 0.900109, ric/train: : 0.115218, ricir/train: : 0.872127, mse/train: : -0.022248, loss/train: : -0.022248
[3265079:MainThread](2024-04-25 14:15:34,935) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.045876, icir/valid: : 0.325137, ric/valid: : 0.042719, ricir/valid: : 0.302775, mse/valid: : -0.008276, loss/valid: : -0.008276
[3265079:MainThread](2024-04-25 14:15:34,935) INFO - qlib.ADARNN - [pytorch_adarnn.py:294] - early stop
[3265079:MainThread](2024-04-25 14:15:34,936) INFO - qlib.ADARNN - [pytorch_adarnn.py:297] - best score: 0.043054 @ 4
[3265079:MainThread](2024-04-25 14:15:35,048) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ADARNN_crowd_data_csi300_360_rankTrue_45.
[3265079:MainThread](2024-04-25 14:15:35,372) INFO - qlib.workflow - [exp.py:258] - Experiment 101 starts running ...
[3265079:MainThread](2024-04-25 14:15:35,389) INFO - qlib.workflow - [recorder.py:341] - Recorder fd6f69ac7b424a1b8052cb96dd78650a starts running under Experiment 101 ...
{'IC': 0.026902079345962383,
 'ICIR': 0.19837312520563208,
 'Rank IC': 0.03587138551857936,
 'Rank ICIR': 0.27587741721675363}
[3265079:MainThread](2024-04-25 14:15:42,197) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3265079:MainThread](2024-04-25 14:16:20,112) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 14:16:20,115) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 14:16:26,179) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8915dbacd0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:45,  9.19it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.26it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:26, 36.70it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 39.51it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:20, 46.66it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.39it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 51.95it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.12it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.35it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 56.26it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.70it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 57.18it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 58.97it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 55.92it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 57.98it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 59.25it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.25it/s]backtest loop:  12%|█▏        | 113/971 [00:02<00:14, 57.24it/s]backtest loop:  12%|█▏        | 120/971 [00:02<00:14, 58.81it/s]backtest loop:  13%|█▎        | 126/971 [00:02<00:16, 52.64it/s]backtest loop:  14%|█▎        | 133/971 [00:02<00:15, 55.36it/s]backtest loop:  14%|█▍        | 140/971 [00:02<00:14, 57.57it/s]backtest loop:  15%|█▌        | 146/971 [00:02<00:15, 54.90it/s]backtest loop:  16%|█▌        | 153/971 [00:02<00:14, 57.03it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:14, 57.59it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:22, 36.52it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:20, 39.95it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:17, 45.25it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:16, 47.25it/s]backtest loop:  20%|█▉        | 191/971 [00:03<00:15, 49.93it/s]backtest loop:  20%|██        | 198/971 [00:03<00:14, 53.70it/s]backtest loop:  21%|██        | 205/971 [00:04<00:14, 52.89it/s]backtest loop:  22%|██▏       | 212/971 [00:04<00:13, 56.04it/s]backtest loop:  22%|██▏       | 218/971 [00:04<00:13, 54.37it/s]backtest loop:  23%|██▎       | 224/971 [00:04<00:13, 55.81it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 53.80it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:13, 56.33it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 58.08it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:13, 55.41it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 57.58it/s]backtest loop:  27%|██▋       | 264/971 [00:05<00:12, 56.14it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:12, 55.08it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:12, 57.13it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:11, 58.62it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 55.68it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 57.78it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:11, 55.78it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 57.54it/s]backtest loop:  33%|███▎      | 318/971 [00:06<00:11, 58.08it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:11, 55.99it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:11, 57.81it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 59.54it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 56.40it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 58.21it/s]backtest loop:  37%|███▋      | 358/971 [00:06<00:10, 58.68it/s]backtest loop:  37%|███▋      | 364/971 [00:06<00:10, 56.62it/s]backtest loop:  38%|███▊      | 370/971 [00:06<00:11, 54.13it/s]backtest loop:  39%|███▉      | 377/971 [00:07<00:10, 56.54it/s]backtest loop:  39%|███▉      | 383/971 [00:07<00:10, 54.33it/s]backtest loop:  40%|████      | 389/971 [00:07<00:10, 55.57it/s]backtest loop:  41%|████      | 396/971 [00:07<00:09, 57.65it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 55.62it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:09, 57.96it/s]backtest loop:  43%|████▎     | 416/971 [00:07<00:09, 58.50it/s]backtest loop:  43%|████▎     | 422/971 [00:07<00:09, 58.77it/s]backtest loop:  44%|████▍     | 428/971 [00:08<00:09, 55.59it/s]backtest loop:  45%|████▍     | 434/971 [00:08<00:09, 56.79it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:09, 57.35it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:09, 58.07it/s]backtest loop:  47%|████▋     | 452/971 [00:08<00:09, 55.09it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:08, 57.28it/s]backtest loop:  48%|████▊     | 465/971 [00:08<00:08, 58.00it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:08, 55.92it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 57.95it/s]backtest loop:  50%|█████     | 486/971 [00:09<00:08, 59.16it/s]backtest loop:  51%|█████     | 492/971 [00:09<00:08, 56.12it/s]backtest loop:  51%|█████▏    | 499/971 [00:09<00:08, 58.03it/s]backtest loop:  52%|█████▏    | 505/971 [00:09<00:08, 55.51it/s]backtest loop:  53%|█████▎    | 512/971 [00:09<00:08, 54.38it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:07, 56.69it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 55.30it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:07, 57.48it/s]backtest loop:  56%|█████▌    | 540/971 [00:09<00:07, 58.90it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 55.85it/s]backtest loop:  57%|█████▋    | 553/971 [00:10<00:07, 57.66it/s]backtest loop:  58%|█████▊    | 560/971 [00:10<00:06, 59.06it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 56.02it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:06, 58.81it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 60.40it/s]backtest loop:  60%|██████    | 587/971 [00:10<00:06, 57.55it/s]backtest loop:  61%|██████    | 593/971 [00:10<00:06, 58.06it/s]backtest loop:  62%|██████▏   | 600/971 [00:11<00:06, 56.09it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 57.84it/s]backtest loop:  63%|██████▎   | 613/971 [00:11<00:06, 58.25it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:05, 58.73it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 55.61it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 57.64it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 59.30it/s]backtest loop:  66%|██████▋   | 645/971 [00:11<00:05, 56.10it/s]backtest loop:  67%|██████▋   | 652/971 [00:11<00:05, 57.89it/s]backtest loop:  68%|██████▊   | 658/971 [00:12<00:05, 58.27it/s]backtest loop:  68%|██████▊   | 665/971 [00:12<00:05, 56.07it/s]backtest loop:  69%|██████▉   | 672/971 [00:12<00:05, 57.77it/s]backtest loop:  70%|██████▉   | 678/971 [00:12<00:05, 58.10it/s]backtest loop:  70%|███████   | 684/971 [00:12<00:05, 55.09it/s]backtest loop:  71%|███████   | 691/971 [00:12<00:04, 57.27it/s]backtest loop:  72%|███████▏  | 698/971 [00:12<00:04, 58.78it/s]backtest loop:  73%|███████▎  | 704/971 [00:12<00:04, 55.55it/s]backtest loop:  73%|███████▎  | 711/971 [00:12<00:04, 57.49it/s]backtest loop:  74%|███████▍  | 718/971 [00:13<00:04, 59.00it/s]backtest loop:  75%|███████▍  | 724/971 [00:13<00:04, 55.68it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 54.62it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 53.75it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:04, 56.12it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 53.98it/s]backtest loop:  78%|███████▊  | 758/971 [00:13<00:03, 56.35it/s]backtest loop:  79%|███████▉  | 765/971 [00:13<00:03, 55.04it/s]backtest loop:  80%|███████▉  | 772/971 [00:14<00:03, 57.11it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 58.68it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 55.85it/s]backtest loop:  82%|████████▏ | 792/971 [00:14<00:03, 57.66it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 55.01it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:02, 57.12it/s]backtest loop:  84%|████████▎ | 812/971 [00:14<00:02, 58.69it/s]backtest loop:  84%|████████▍ | 818/971 [00:14<00:02, 55.79it/s]backtest loop:  85%|████████▍ | 825/971 [00:14<00:02, 57.63it/s]backtest loop:  86%|████████▌ | 832/971 [00:15<00:02, 59.02it/s]backtest loop:  86%|████████▋ | 838/971 [00:15<00:02, 56.03it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 57.86it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 55.86it/s]backtest loop:  88%|████████▊ | 859/971 [00:15<00:01, 57.70it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 59.08it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 56.02it/s]backtest loop:  90%|█████████ | 878/971 [00:15<00:01, 57.07it/s]backtest loop:  91%|█████████ | 885/971 [00:16<00:01, 58.62it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 56.41it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 58.15it/s]backtest loop:  93%|█████████▎| 905/971 [00:16<00:01, 58.54it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 56.27it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 57.94it/s]backtest loop:  95%|█████████▌| 925/971 [00:16<00:00, 58.45it/s]backtest loop:  96%|█████████▌| 931/971 [00:16<00:00, 55.35it/s]backtest loop:  97%|█████████▋| 938/971 [00:16<00:00, 57.38it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 55.69it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 57.45it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 58.82it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 55.89it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.43it/s]
[3265079:MainThread](2024-04-25 14:16:43,757) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000632
std                0.004900
annualized_return  0.150341
information_ratio  1.988611
max_drawdown      -0.078417
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000433
std                0.004903
annualized_return  0.103162
information_ratio  1.363858
max_drawdown      -0.087298
[3265079:MainThread](2024-04-25 14:16:43,771) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ADARNN_crowd_data_csi300_360_rankTrue`.
[3265079:MainThread](2024-04-25 14:16:50,774) INFO - qlib.timer - [log.py:127] - Time cost: 0.009s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.0085111448463081,
                                                    0.040133948309472374,
                                                    0.10316185137476734],
 '1day.excess_return_with_cost.information_ratio': [-0.10598626920625567,
                                                    0.5394907020639452,
                                                    1.363858333479228],
 '1day.excess_return_with_cost.max_drawdown': [-0.20237780038364295,
                                               -0.07594003976516654,
                                               -0.08729842747498329],
 'IC': [0.0013536984392258171, 0.026439898619729344, 0.026902079345962383],
 'ICIR': [0.009181160161704657, 0.21079803251917983, 0.19837312520563208],
 'Rank IC': [0.012407792581098361, 0.03724272331287428, 0.03587138551857936],
 'Rank ICIR': [0.08674177992422927, 0.29319132408979226, 0.27587741721675363],
 'mae': [0.8703869590122575, 0.8647632230090078, 0.864850520964454],
 'mse': [1.0176620582257514, 1.0010798346127248, 1.001276056691344]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3265079:MainThread](2024-04-25 14:16:54,027) INFO - qlib.ADARNN - [pytorch_adarnn.py:63] - ADARNN pytorch version...
[3265079:MainThread](2024-04-25 14:16:54,027) INFO - qlib.ADARNN - [pytorch_adarnn.py:87] - ADARNN parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3265079:MainThread](2024-04-25 14:16:54,043) INFO - qlib.ADARNN - [pytorch_adarnn.py:136] - model:
AdaRNN(
  (features): Sequential(
    (0): GRU(6, 64, batch_first=True)
    (1): GRU(64, 64, batch_first=True)
  )
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
  (gate): ModuleList(
    (0): Linear(in_features=7680, out_features=60, bias=True)
    (1): Linear(in_features=7680, out_features=60, bias=True)
  )
  (bn_lst): ModuleList(
    (0): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (softmax): Softmax(dim=0)
)
[3265079:MainThread](2024-04-25 14:16:54,043) INFO - qlib.ADARNN - [pytorch_adarnn.py:137] - model size: 0.9163 MB
[3265079:MainThread](2024-04-25 14:16:57,033) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ADARNN_crowd_data_csi300_360_rankTrue_46.
[3265079:MainThread](2024-04-25 14:16:57,144) INFO - qlib.workflow - [exp.py:258] - Experiment 104 starts running ...
[3265079:MainThread](2024-04-25 14:16:57,164) INFO - qlib.workflow - [recorder.py:341] - Recorder ca27f35754fd44c9b5751039ddf70892 starts running under Experiment 104 ...
[3265079:MainThread](2024-04-25 14:17:01,641) INFO - qlib.ADARNN - [pytorch_adarnn.py:266] - training...
[3265079:MainThread](2024-04-25 14:17:01,641) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch0:
[3265079:MainThread](2024-04-25 14:17:01,642) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:18:06,813) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:18:14,228) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.086926, icir/train: : 0.593016, ric/train: : 0.083208, ricir/train: : 0.559991, mse/train: : 0.034755, loss/train: : 0.034755
[3265079:MainThread](2024-04-25 14:18:14,229) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.040133, icir/valid: : 0.298669, ric/valid: : 0.039479, ricir/valid: : 0.284390, mse/valid: : 0.032242, loss/valid: : 0.032242
[3265079:MainThread](2024-04-25 14:18:14,231) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch1:
[3265079:MainThread](2024-04-25 14:18:14,231) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:19:24,416) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:19:31,619) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.059195, icir/train: : 0.410772, ric/train: : 0.055958, ricir/train: : 0.400097, mse/train: : -0.007651, loss/train: : -0.007651
[3265079:MainThread](2024-04-25 14:19:31,620) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.020121, icir/valid: : 0.149257, ric/valid: : 0.020846, ricir/valid: : 0.159172, mse/valid: : -0.013359, loss/valid: : -0.013359
[3265079:MainThread](2024-04-25 14:19:31,620) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch2:
[3265079:MainThread](2024-04-25 14:19:31,620) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:20:37,512) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:20:44,722) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.084522, icir/train: : 0.609357, ric/train: : 0.080591, ricir/train: : 0.575965, mse/train: : -0.059724, loss/train: : -0.059724
[3265079:MainThread](2024-04-25 14:20:44,723) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.029989, icir/valid: : 0.225221, ric/valid: : 0.030599, ricir/valid: : 0.225759, mse/valid: : -0.058407, loss/valid: : -0.058407
[3265079:MainThread](2024-04-25 14:20:44,723) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch3:
[3265079:MainThread](2024-04-25 14:20:44,723) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:21:48,353) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:21:55,509) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.095165, icir/train: : 0.708137, ric/train: : 0.091065, ricir/train: : 0.683066, mse/train: : 0.013577, loss/train: : 0.013577
[3265079:MainThread](2024-04-25 14:21:55,509) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.040383, icir/valid: : 0.300745, ric/valid: : 0.037955, ricir/valid: : 0.284666, mse/valid: : 0.019616, loss/valid: : 0.019616
[3265079:MainThread](2024-04-25 14:21:55,510) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch4:
[3265079:MainThread](2024-04-25 14:21:55,510) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:23:01,757) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:23:08,900) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.090759, icir/train: : 0.693687, ric/train: : 0.086775, ricir/train: : 0.673692, mse/train: : 0.000191, loss/train: : 0.000191
[3265079:MainThread](2024-04-25 14:23:08,901) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.037586, icir/valid: : 0.289072, ric/valid: : 0.035700, ricir/valid: : 0.281720, mse/valid: : 0.001438, loss/valid: : 0.001438
[3265079:MainThread](2024-04-25 14:23:08,901) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch5:
[3265079:MainThread](2024-04-25 14:23:08,901) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:24:11,018) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:24:18,220) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.091908, icir/train: : 0.729895, ric/train: : 0.087226, ricir/train: : 0.691658, mse/train: : 0.023458, loss/train: : 0.023458
[3265079:MainThread](2024-04-25 14:24:18,221) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.035676, icir/valid: : 0.270679, ric/valid: : 0.034130, ricir/valid: : 0.259929, mse/valid: : 0.034596, loss/valid: : 0.034596
[3265079:MainThread](2024-04-25 14:24:18,223) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch6:
[3265079:MainThread](2024-04-25 14:24:18,223) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:25:21,143) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:25:28,356) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.099277, icir/train: : 0.793704, ric/train: : 0.098439, ricir/train: : 0.787542, mse/train: : 0.001751, loss/train: : 0.001751
[3265079:MainThread](2024-04-25 14:25:28,357) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.039498, icir/valid: : 0.320692, ric/valid: : 0.040452, ricir/valid: : 0.330687, mse/valid: : 0.005276, loss/valid: : 0.005276
[3265079:MainThread](2024-04-25 14:25:28,357) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch7:
[3265079:MainThread](2024-04-25 14:25:28,357) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:26:33,619) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:26:40,781) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.102465, icir/train: : 0.807187, ric/train: : 0.100610, ricir/train: : 0.790878, mse/train: : 0.018064, loss/train: : 0.018064
[3265079:MainThread](2024-04-25 14:26:40,782) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.052653, icir/valid: : 0.433539, ric/valid: : 0.051455, ricir/valid: : 0.421852, mse/valid: : 0.016492, loss/valid: : 0.016492
[3265079:MainThread](2024-04-25 14:26:40,782) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch8:
[3265079:MainThread](2024-04-25 14:26:40,782) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:27:50,042) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:27:57,258) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.104240, icir/train: : 0.878082, ric/train: : 0.101045, ricir/train: : 0.860052, mse/train: : 0.008173, loss/train: : 0.008173
[3265079:MainThread](2024-04-25 14:27:57,259) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.044890, icir/valid: : 0.362050, ric/valid: : 0.043471, ricir/valid: : 0.357449, mse/valid: : 0.016828, loss/valid: : 0.016828
[3265079:MainThread](2024-04-25 14:27:57,259) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch9:
[3265079:MainThread](2024-04-25 14:27:57,259) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:29:01,822) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:29:09,319) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.112565, icir/train: : 0.882594, ric/train: : 0.109318, ricir/train: : 0.862458, mse/train: : 0.012143, loss/train: : 0.012143
[3265079:MainThread](2024-04-25 14:29:09,319) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.046291, icir/valid: : 0.348848, ric/valid: : 0.043218, ricir/valid: : 0.328284, mse/valid: : 0.020815, loss/valid: : 0.020815
[3265079:MainThread](2024-04-25 14:29:09,319) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch10:
[3265079:MainThread](2024-04-25 14:29:09,320) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:30:19,034) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:30:26,268) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.101678, icir/train: : 0.801001, ric/train: : 0.099708, ricir/train: : 0.790017, mse/train: : -0.028326, loss/train: : -0.028326
[3265079:MainThread](2024-04-25 14:30:26,269) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.041382, icir/valid: : 0.317349, ric/valid: : 0.040261, ricir/valid: : 0.312670, mse/valid: : -0.027765, loss/valid: : -0.027765
[3265079:MainThread](2024-04-25 14:30:26,269) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch11:
[3265079:MainThread](2024-04-25 14:30:26,269) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:31:33,176) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:31:40,685) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.102382, icir/train: : 0.847837, ric/train: : 0.098947, ricir/train: : 0.821716, mse/train: : -0.005019, loss/train: : -0.005019
[3265079:MainThread](2024-04-25 14:31:40,686) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.050423, icir/valid: : 0.410437, ric/valid: : 0.048821, ricir/valid: : 0.407334, mse/valid: : 0.000638, loss/valid: : 0.000638
[3265079:MainThread](2024-04-25 14:31:40,686) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch12:
[3265079:MainThread](2024-04-25 14:31:40,686) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:32:47,728) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:32:54,934) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.106372, icir/train: : 0.894402, ric/train: : 0.103275, ricir/train: : 0.873851, mse/train: : -0.036347, loss/train: : -0.036347
[3265079:MainThread](2024-04-25 14:32:54,934) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.045269, icir/valid: : 0.365716, ric/valid: : 0.043759, ricir/valid: : 0.354636, mse/valid: : -0.024456, loss/valid: : -0.024456
[3265079:MainThread](2024-04-25 14:32:54,934) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch13:
[3265079:MainThread](2024-04-25 14:32:54,935) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:33:57,861) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:34:05,077) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.107643, icir/train: : 0.878843, ric/train: : 0.104902, ricir/train: : 0.858464, mse/train: : 0.008090, loss/train: : 0.008090
[3265079:MainThread](2024-04-25 14:34:05,077) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.047950, icir/valid: : 0.380659, ric/valid: : 0.045388, ricir/valid: : 0.365538, mse/valid: : 0.012581, loss/valid: : 0.012581
[3265079:MainThread](2024-04-25 14:34:05,078) INFO - qlib.ADARNN - [pytorch_adarnn.py:294] - early stop
[3265079:MainThread](2024-04-25 14:34:05,078) INFO - qlib.ADARNN - [pytorch_adarnn.py:297] - best score: 0.034596 @ 5
[3265079:MainThread](2024-04-25 14:34:05,190) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ADARNN_crowd_data_csi300_360_rankTrue_46.
[3265079:MainThread](2024-04-25 14:34:05,514) INFO - qlib.workflow - [exp.py:258] - Experiment 101 starts running ...
[3265079:MainThread](2024-04-25 14:34:05,531) INFO - qlib.workflow - [recorder.py:341] - Recorder 8e7926228d5440eea52edc4dd8ef431a starts running under Experiment 101 ...
{'IC': 0.02348331098236194,
 'ICIR': 0.18130028119321606,
 'Rank IC': 0.03310470827646654,
 'Rank ICIR': 0.24465738515472754}
[3265079:MainThread](2024-04-25 14:34:12,265) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3265079:MainThread](2024-04-25 14:34:50,745) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 14:34:50,748) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 14:34:56,743) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f890e5cbb20>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:40,  9.62it/s]backtest loop:   1%|          | 9/971 [00:00<00:37, 25.42it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 37.91it/s]backtest loop:   2%|▏         | 22/971 [00:00<00:22, 41.68it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:20, 46.70it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.41it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.06it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.30it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.43it/s]backtest loop:   6%|▌         | 60/971 [00:01<00:16, 55.02it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.57it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 56.86it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 58.52it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 55.94it/s]backtest loop:  10%|▉         | 93/971 [00:01<00:15, 57.00it/s]backtest loop:  10%|█         | 99/971 [00:01<00:15, 57.76it/s]backtest loop:  11%|█         | 106/971 [00:02<00:14, 59.18it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 56.12it/s]backtest loop:  12%|█▏        | 118/971 [00:02<00:14, 57.00it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 55.34it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 53.66it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:14, 56.73it/s]backtest loop:  15%|█▍        | 145/971 [00:02<00:14, 58.55it/s]backtest loop:  16%|█▌        | 151/971 [00:02<00:14, 55.48it/s]backtest loop:  16%|█▌        | 157/971 [00:03<00:14, 56.62it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:21, 38.45it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:18, 44.37it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:17, 45.98it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:15, 50.27it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:15, 51.04it/s]backtest loop:  20%|██        | 197/971 [00:03<00:14, 53.79it/s]backtest loop:  21%|██        | 204/971 [00:03<00:13, 56.48it/s]backtest loop:  22%|██▏       | 210/971 [00:04<00:13, 54.48it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:14, 53.11it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:13, 55.85it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 54.54it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 56.73it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 58.36it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 55.70it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 58.53it/s]backtest loop:  27%|██▋       | 264/971 [00:05<00:12, 56.37it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:12, 55.22it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:12, 57.27it/s]backtest loop:  29%|██▉       | 284/971 [00:05<00:11, 57.80it/s]backtest loop:  30%|██▉       | 290/971 [00:05<00:11, 57.71it/s]backtest loop:  30%|███       | 296/971 [00:05<00:12, 55.32it/s]backtest loop:  31%|███       | 303/971 [00:05<00:11, 57.42it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:11, 55.58it/s]backtest loop:  33%|███▎      | 316/971 [00:05<00:11, 56.68it/s]backtest loop:  33%|███▎      | 322/971 [00:06<00:11, 57.56it/s]backtest loop:  34%|███▍      | 329/971 [00:06<00:10, 59.23it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:11, 56.03it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:10, 57.83it/s]backtest loop:  36%|███▌      | 348/971 [00:06<00:10, 58.16it/s]backtest loop:  37%|███▋      | 355/971 [00:06<00:11, 56.00it/s]backtest loop:  37%|███▋      | 362/971 [00:06<00:10, 57.90it/s]backtest loop:  38%|███▊      | 368/971 [00:06<00:11, 52.17it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:10, 55.36it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:10, 55.75it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 56.70it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 54.15it/s]backtest loop:  41%|████      | 400/971 [00:07<00:10, 56.53it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 59.23it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:09, 56.77it/s]backtest loop:  43%|████▎     | 419/971 [00:07<00:09, 57.47it/s]backtest loop:  44%|████▍     | 426/971 [00:07<00:09, 58.94it/s]backtest loop:  44%|████▍     | 432/971 [00:08<00:09, 55.82it/s]backtest loop:  45%|████▌     | 438/971 [00:08<00:09, 56.89it/s]backtest loop:  46%|████▌     | 445/971 [00:08<00:08, 59.03it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:08, 59.27it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:09, 56.02it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:08, 57.92it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:08, 59.30it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:08, 55.83it/s]backtest loop:  50%|████▉     | 483/971 [00:08<00:08, 56.62it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:08, 54.99it/s]backtest loop:  51%|█████     | 496/971 [00:09<00:08, 56.25it/s]backtest loop:  52%|█████▏    | 503/971 [00:09<00:08, 58.12it/s]backtest loop:  52%|█████▏    | 509/971 [00:09<00:08, 55.58it/s]backtest loop:  53%|█████▎    | 515/971 [00:09<00:08, 56.66it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:08, 54.98it/s]backtest loop:  54%|█████▍    | 529/971 [00:09<00:07, 57.22it/s]backtest loop:  55%|█████▌    | 536/971 [00:09<00:07, 55.53it/s]backtest loop:  56%|█████▌    | 542/971 [00:09<00:07, 56.67it/s]backtest loop:  56%|█████▋    | 548/971 [00:10<00:07, 57.45it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 58.96it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 55.82it/s]backtest loop:  58%|█████▊    | 567/971 [00:10<00:07, 56.78it/s]backtest loop:  59%|█████▉    | 574/971 [00:10<00:06, 58.55it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 58.69it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:06, 55.50it/s]backtest loop:  61%|██████    | 593/971 [00:10<00:06, 57.48it/s]backtest loop:  62%|██████▏   | 600/971 [00:10<00:06, 55.64it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 57.56it/s]backtest loop:  63%|██████▎   | 613/971 [00:11<00:06, 57.97it/s]backtest loop:  64%|██████▍   | 620/971 [00:11<00:06, 55.95it/s]backtest loop:  65%|██████▍   | 627/971 [00:11<00:05, 57.97it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:05, 59.30it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:05, 56.17it/s]backtest loop:  67%|██████▋   | 646/971 [00:11<00:05, 57.14it/s]backtest loop:  67%|██████▋   | 653/971 [00:11<00:05, 58.75it/s]backtest loop:  68%|██████▊   | 660/971 [00:12<00:05, 56.49it/s]backtest loop:  69%|██████▊   | 666/971 [00:12<00:05, 57.34it/s]backtest loop:  69%|██████▉   | 673/971 [00:12<00:05, 58.79it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 55.61it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 56.72it/s]backtest loop:  71%|███████▏  | 692/971 [00:12<00:04, 58.46it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 56.27it/s]backtest loop:  73%|███████▎  | 706/971 [00:12<00:04, 57.96it/s]backtest loop:  73%|███████▎  | 712/971 [00:12<00:04, 58.27it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 56.25it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 58.28it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 55.53it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 53.67it/s]backtest loop:  77%|███████▋  | 744/971 [00:13<00:04, 55.13it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 53.20it/s]backtest loop:  78%|███████▊  | 756/971 [00:13<00:03, 54.90it/s]backtest loop:  79%|███████▊  | 763/971 [00:13<00:03, 57.14it/s]backtest loop:  79%|███████▉  | 770/971 [00:13<00:03, 55.43it/s]backtest loop:  80%|███████▉  | 776/971 [00:14<00:03, 56.56it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 57.49it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 54.86it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.03it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 58.56it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 55.60it/s]backtest loop:  84%|████████▍ | 814/971 [00:14<00:02, 56.51it/s]backtest loop:  85%|████████▍ | 821/971 [00:14<00:02, 58.23it/s]backtest loop:  85%|████████▌ | 828/971 [00:15<00:02, 56.13it/s]backtest loop:  86%|████████▌ | 835/971 [00:15<00:02, 57.86it/s]backtest loop:  87%|████████▋ | 841/971 [00:15<00:02, 58.41it/s]backtest loop:  87%|████████▋ | 847/971 [00:15<00:02, 58.54it/s]backtest loop:  88%|████████▊ | 853/971 [00:15<00:02, 55.55it/s]backtest loop:  88%|████████▊ | 859/971 [00:15<00:01, 56.77it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 58.46it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 55.51it/s]backtest loop:  90%|█████████ | 878/971 [00:15<00:01, 56.43it/s]backtest loop:  91%|█████████ | 885/971 [00:15<00:01, 58.16it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 56.04it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 57.90it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 59.16it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 55.86it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 57.69it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 55.93it/s]backtest loop:  96%|█████████▌| 933/971 [00:16<00:00, 57.76it/s]backtest loop:  97%|█████████▋| 939/971 [00:16<00:00, 58.15it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 55.07it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 57.24it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 58.73it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 55.76it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.49it/s]
[3265079:MainThread](2024-04-25 14:35:14,299) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000588
std                0.004847
annualized_return  0.139827
information_ratio  1.869941
max_drawdown      -0.075883
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000392
std                0.004847
annualized_return  0.093234
information_ratio  1.246736
max_drawdown      -0.086048
[3265079:MainThread](2024-04-25 14:35:14,312) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ADARNN_crowd_data_csi300_360_rankTrue`.
[3265079:MainThread](2024-04-25 14:35:21,167) INFO - qlib.timer - [log.py:127] - Time cost: 0.005s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.0085111448463081,
                                                    0.040133948309472374,
                                                    0.10316185137476734,
                                                    0.09323388904245221],
 '1day.excess_return_with_cost.information_ratio': [-0.10598626920625567,
                                                    0.5394907020639452,
                                                    1.363858333479228,
                                                    1.2467355553729704],
 '1day.excess_return_with_cost.max_drawdown': [-0.20237780038364295,
                                               -0.07594003976516654,
                                               -0.08729842747498329,
                                               -0.08604753042288982],
 'IC': [0.0013536984392258171,
        0.026439898619729344,
        0.026902079345962383,
        0.02348331098236194],
 'ICIR': [0.009181160161704657,
          0.21079803251917983,
          0.19837312520563208,
          0.18130028119321606],
 'Rank IC': [0.012407792581098361,
             0.03724272331287428,
             0.03587138551857936,
             0.03310470827646654],
 'Rank ICIR': [0.08674177992422927,
               0.29319132408979226,
               0.27587741721675363,
               0.24465738515472754],
 'mae': [0.8703869590122575,
         0.8647632230090078,
         0.864850520964454,
         0.8644913943487671],
 'mse': [1.0176620582257514,
         1.0010798346127248,
         1.001276056691344,
         0.9992015764604559]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3265079:MainThread](2024-04-25 14:35:24,389) INFO - qlib.ADARNN - [pytorch_adarnn.py:63] - ADARNN pytorch version...
[3265079:MainThread](2024-04-25 14:35:24,389) INFO - qlib.ADARNN - [pytorch_adarnn.py:87] - ADARNN parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3265079:MainThread](2024-04-25 14:35:24,405) INFO - qlib.ADARNN - [pytorch_adarnn.py:136] - model:
AdaRNN(
  (features): Sequential(
    (0): GRU(6, 64, batch_first=True)
    (1): GRU(64, 64, batch_first=True)
  )
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
  (gate): ModuleList(
    (0): Linear(in_features=7680, out_features=60, bias=True)
    (1): Linear(in_features=7680, out_features=60, bias=True)
  )
  (bn_lst): ModuleList(
    (0): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (softmax): Softmax(dim=0)
)
[3265079:MainThread](2024-04-25 14:35:24,405) INFO - qlib.ADARNN - [pytorch_adarnn.py:137] - model size: 0.9163 MB
[3265079:MainThread](2024-04-25 14:35:27,376) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ADARNN_crowd_data_csi300_360_rankTrue_47.
[3265079:MainThread](2024-04-25 14:35:27,488) INFO - qlib.workflow - [exp.py:258] - Experiment 105 starts running ...
[3265079:MainThread](2024-04-25 14:35:27,509) INFO - qlib.workflow - [recorder.py:341] - Recorder 77311889a1fe4043b1bcb77b5428601c starts running under Experiment 105 ...
[3265079:MainThread](2024-04-25 14:35:31,940) INFO - qlib.ADARNN - [pytorch_adarnn.py:266] - training...
[3265079:MainThread](2024-04-25 14:35:31,940) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch0:
[3265079:MainThread](2024-04-25 14:35:31,940) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:36:42,002) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:36:49,252) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.088438, icir/train: : 0.624202, ric/train: : 0.084461, ricir/train: : 0.597998, mse/train: : -0.006355, loss/train: : -0.006355
[3265079:MainThread](2024-04-25 14:36:49,252) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.041551, icir/valid: : 0.294548, ric/valid: : 0.037711, ricir/valid: : 0.267847, mse/valid: : -0.000004, loss/valid: : -0.000004
[3265079:MainThread](2024-04-25 14:36:49,254) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch1:
[3265079:MainThread](2024-04-25 14:36:49,258) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:37:51,905) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:37:59,122) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.058760, icir/train: : 0.377785, ric/train: : 0.056482, ricir/train: : 0.363307, mse/train: : -0.016066, loss/train: : -0.016066
[3265079:MainThread](2024-04-25 14:37:59,123) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.013423, icir/valid: : 0.094751, ric/valid: : 0.014886, ricir/valid: : 0.102625, mse/valid: : -0.017723, loss/valid: : -0.017723
[3265079:MainThread](2024-04-25 14:37:59,123) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch2:
[3265079:MainThread](2024-04-25 14:37:59,123) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:39:02,541) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:39:09,968) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.063031, icir/train: : 0.435448, ric/train: : 0.060171, ricir/train: : 0.410479, mse/train: : 0.058084, loss/train: : 0.058084
[3265079:MainThread](2024-04-25 14:39:09,968) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.017283, icir/valid: : 0.127266, ric/valid: : 0.019322, ricir/valid: : 0.137606, mse/valid: : 0.060520, loss/valid: : 0.060520
[3265079:MainThread](2024-04-25 14:39:09,970) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch3:
[3265079:MainThread](2024-04-25 14:39:09,971) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:40:18,430) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:40:25,585) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.064264, icir/train: : 0.401776, ric/train: : 0.061342, ricir/train: : 0.383598, mse/train: : -0.003261, loss/train: : -0.003261
[3265079:MainThread](2024-04-25 14:40:25,586) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.020775, icir/valid: : 0.138718, ric/valid: : 0.019173, ricir/valid: : 0.125466, mse/valid: : -0.010383, loss/valid: : -0.010383
[3265079:MainThread](2024-04-25 14:40:25,586) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch4:
[3265079:MainThread](2024-04-25 14:40:25,586) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:41:28,825) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:41:36,058) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.056801, icir/train: : 0.397236, ric/train: : 0.053371, ricir/train: : 0.374843, mse/train: : 0.015037, loss/train: : 0.015037
[3265079:MainThread](2024-04-25 14:41:36,059) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.015879, icir/valid: : 0.118819, ric/valid: : 0.014607, ricir/valid: : 0.109918, mse/valid: : 0.017511, loss/valid: : 0.017511
[3265079:MainThread](2024-04-25 14:41:36,059) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch5:
[3265079:MainThread](2024-04-25 14:41:36,060) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:42:42,941) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:42:50,107) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.059957, icir/train: : 0.397499, ric/train: : 0.056280, ricir/train: : 0.372349, mse/train: : -0.078674, loss/train: : -0.078674
[3265079:MainThread](2024-04-25 14:42:50,107) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.017539, icir/valid: : 0.126093, ric/valid: : 0.017742, ricir/valid: : 0.131964, mse/valid: : -0.082337, loss/valid: : -0.082337
[3265079:MainThread](2024-04-25 14:42:50,107) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch6:
[3265079:MainThread](2024-04-25 14:42:50,108) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:43:54,628) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:44:02,296) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.045475, icir/train: : 0.405453, ric/train: : 0.044959, ricir/train: : 0.400926, mse/train: : 0.000797, loss/train: : 0.000797
[3265079:MainThread](2024-04-25 14:44:02,296) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.019030, icir/valid: : 0.180768, ric/valid: : 0.018646, ricir/valid: : 0.175786, mse/valid: : -0.000229, loss/valid: : -0.000229
[3265079:MainThread](2024-04-25 14:44:02,296) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch7:
[3265079:MainThread](2024-04-25 14:44:02,297) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:45:10,442) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:45:18,064) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.068585, icir/train: : 0.480654, ric/train: : 0.066390, ricir/train: : 0.469142, mse/train: : -0.071772, loss/train: : -0.071772
[3265079:MainThread](2024-04-25 14:45:18,064) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.030494, icir/valid: : 0.236224, ric/valid: : 0.028921, ricir/valid: : 0.224223, mse/valid: : -0.072023, loss/valid: : -0.072023
[3265079:MainThread](2024-04-25 14:45:18,064) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch8:
[3265079:MainThread](2024-04-25 14:45:18,065) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:46:25,931) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:46:33,169) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.054181, icir/train: : 0.488287, ric/train: : 0.054033, ricir/train: : 0.484929, mse/train: : -0.045423, loss/train: : -0.045423
[3265079:MainThread](2024-04-25 14:46:33,169) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.028822, icir/valid: : 0.278397, ric/valid: : 0.028121, ricir/valid: : 0.270639, mse/valid: : -0.042109, loss/valid: : -0.042109
[3265079:MainThread](2024-04-25 14:46:33,169) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch9:
[3265079:MainThread](2024-04-25 14:46:33,170) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:47:45,172) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:47:52,422) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.067915, icir/train: : 0.521228, ric/train: : 0.066410, ricir/train: : 0.506559, mse/train: : 0.014716, loss/train: : 0.014716
[3265079:MainThread](2024-04-25 14:47:52,422) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.024834, icir/valid: : 0.196959, ric/valid: : 0.024087, ricir/valid: : 0.190858, mse/valid: : 0.013709, loss/valid: : 0.013709
[3265079:MainThread](2024-04-25 14:47:52,423) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch10:
[3265079:MainThread](2024-04-25 14:47:52,423) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:48:59,751) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:49:07,017) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.064114, icir/train: : 0.560456, ric/train: : 0.062816, ricir/train: : 0.549676, mse/train: : -0.018532, loss/train: : -0.018532
[3265079:MainThread](2024-04-25 14:49:07,017) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.025191, icir/valid: : 0.234395, ric/valid: : 0.024100, ricir/valid: : 0.222467, mse/valid: : -0.017018, loss/valid: : -0.017018
[3265079:MainThread](2024-04-25 14:49:07,018) INFO - qlib.ADARNN - [pytorch_adarnn.py:294] - early stop
[3265079:MainThread](2024-04-25 14:49:07,018) INFO - qlib.ADARNN - [pytorch_adarnn.py:297] - best score: 0.060520 @ 2
[3265079:MainThread](2024-04-25 14:49:07,136) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ADARNN_crowd_data_csi300_360_rankTrue_47.
[3265079:MainThread](2024-04-25 14:49:07,460) INFO - qlib.workflow - [exp.py:258] - Experiment 101 starts running ...
[3265079:MainThread](2024-04-25 14:49:07,477) INFO - qlib.workflow - [recorder.py:341] - Recorder 455e81948bee42849ca59c3db6425ea4 starts running under Experiment 101 ...
{'IC': 0.01327365027193708,
 'ICIR': 0.08768322408071108,
 'Rank IC': 0.019693651797228897,
 'Rank ICIR': 0.12528583016367276}
[3265079:MainThread](2024-04-25 14:49:14,491) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3265079:MainThread](2024-04-25 14:49:53,864) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 14:49:53,867) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 14:50:00,037) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8918643b80>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:44,  9.23it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.41it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 35.12it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.88it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:20, 46.90it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.69it/s]backtest loop:   4%|▍         | 40/971 [00:00<00:18, 51.02it/s]backtest loop:   5%|▍         | 47/971 [00:01<00:16, 54.61it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.77it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 56.42it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 53.69it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 56.39it/s]backtest loop:   8%|▊         | 80/971 [00:01<00:15, 56.67it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 55.28it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 56.83it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 58.40it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 55.74it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 57.81it/s]backtest loop:  12%|█▏        | 120/971 [00:02<00:14, 58.07it/s]backtest loop:  13%|█▎        | 126/971 [00:02<00:16, 52.39it/s]backtest loop:  14%|█▎        | 133/971 [00:02<00:15, 55.36it/s]backtest loop:  14%|█▍        | 140/971 [00:02<00:14, 57.42it/s]backtest loop:  15%|█▌        | 146/971 [00:02<00:15, 54.80it/s]backtest loop:  16%|█▌        | 152/971 [00:02<00:14, 55.63it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:14, 57.59it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:13, 57.87it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:14, 55.39it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:13, 57.66it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:14, 55.80it/s]backtest loop:  20%|█▉        | 191/971 [00:03<00:13, 56.57it/s]backtest loop:  20%|██        | 198/971 [00:03<00:13, 58.27it/s]backtest loop:  21%|██        | 205/971 [00:03<00:13, 56.37it/s]backtest loop:  22%|██▏       | 211/971 [00:04<00:13, 57.22it/s]backtest loop:  22%|██▏       | 217/971 [00:04<00:13, 54.55it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:21, 35.44it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:18, 40.23it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:17, 42.59it/s]backtest loop:  25%|██▍       | 241/971 [00:04<00:15, 46.52it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:14, 49.56it/s]backtest loop:  26%|██▌       | 254/971 [00:05<00:14, 50.04it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:13, 53.42it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:13, 52.39it/s]backtest loop:  28%|██▊       | 274/971 [00:05<00:12, 55.34it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:12, 54.27it/s]backtest loop:  30%|██▉       | 287/971 [00:05<00:12, 55.74it/s]backtest loop:  30%|███       | 294/971 [00:05<00:11, 57.62it/s]backtest loop:  31%|███       | 300/971 [00:05<00:12, 55.06it/s]backtest loop:  32%|███▏      | 307/971 [00:05<00:11, 57.26it/s]backtest loop:  32%|███▏      | 313/971 [00:06<00:11, 57.06it/s]backtest loop:  33%|███▎      | 319/971 [00:06<00:11, 57.26it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:11, 54.96it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:11, 57.27it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 58.78it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 55.65it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 57.60it/s]backtest loop:  37%|███▋      | 358/971 [00:06<00:10, 58.23it/s]backtest loop:  37%|███▋      | 364/971 [00:06<00:10, 55.70it/s]backtest loop:  38%|███▊      | 370/971 [00:07<00:11, 53.54it/s]backtest loop:  39%|███▉      | 377/971 [00:07<00:10, 56.22it/s]backtest loop:  39%|███▉      | 383/971 [00:07<00:11, 53.39it/s]backtest loop:  40%|████      | 390/971 [00:07<00:10, 56.03it/s]backtest loop:  41%|████      | 397/971 [00:07<00:09, 58.05it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 55.23it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:09, 57.43it/s]backtest loop:  43%|████▎     | 416/971 [00:07<00:09, 58.10it/s]backtest loop:  44%|████▎     | 423/971 [00:07<00:09, 55.86it/s]backtest loop:  44%|████▍     | 430/971 [00:08<00:09, 57.69it/s]backtest loop:  45%|████▍     | 436/971 [00:08<00:09, 58.27it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:09, 55.30it/s]backtest loop:  46%|████▌     | 448/971 [00:08<00:09, 56.51it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:09, 56.69it/s]backtest loop:  47%|████▋     | 461/971 [00:08<00:08, 58.39it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:09, 55.38it/s]backtest loop:  49%|████▊     | 473/971 [00:08<00:08, 56.63it/s]backtest loop:  49%|████▉     | 480/971 [00:08<00:08, 58.37it/s]backtest loop:  50%|█████     | 486/971 [00:09<00:08, 58.76it/s]backtest loop:  51%|█████     | 492/971 [00:09<00:08, 55.52it/s]backtest loop:  51%|█████▏    | 498/971 [00:09<00:08, 56.74it/s]backtest loop:  52%|█████▏    | 505/971 [00:09<00:08, 55.23it/s]backtest loop:  53%|█████▎    | 511/971 [00:09<00:08, 53.99it/s]backtest loop:  53%|█████▎    | 517/971 [00:09<00:08, 52.50it/s]backtest loop:  54%|█████▍    | 524/971 [00:09<00:08, 55.32it/s]backtest loop:  55%|█████▍    | 530/971 [00:09<00:07, 56.55it/s]backtest loop:  55%|█████▌    | 536/971 [00:10<00:08, 54.05it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:07, 56.48it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 57.28it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 57.93it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 54.77it/s]backtest loop:  58%|█████▊    | 567/971 [00:10<00:07, 55.66it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:07, 56.82it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 58.55it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:06, 55.47it/s]backtest loop:  61%|██████    | 592/971 [00:10<00:06, 55.84it/s]backtest loop:  62%|██████▏   | 599/971 [00:11<00:06, 57.72it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:06, 54.97it/s]backtest loop:  63%|██████▎   | 611/971 [00:11<00:06, 56.24it/s]backtest loop:  64%|██████▎   | 618/971 [00:11<00:06, 57.59it/s]backtest loop:  64%|██████▍   | 624/971 [00:11<00:06, 57.82it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:06, 54.92it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:05, 57.08it/s]backtest loop:  66%|██████▋   | 644/971 [00:11<00:05, 58.63it/s]backtest loop:  67%|██████▋   | 650/971 [00:12<00:05, 55.67it/s]backtest loop:  68%|██████▊   | 656/971 [00:12<00:05, 56.40it/s]backtest loop:  68%|██████▊   | 663/971 [00:12<00:05, 58.15it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 56.02it/s]backtest loop:  70%|██████▉   | 677/971 [00:12<00:05, 57.98it/s]backtest loop:  70%|███████   | 683/971 [00:12<00:04, 58.28it/s]backtest loop:  71%|███████   | 689/971 [00:12<00:05, 55.05it/s]backtest loop:  72%|███████▏  | 696/971 [00:12<00:04, 57.13it/s]backtest loop:  72%|███████▏  | 703/971 [00:12<00:04, 58.62it/s]backtest loop:  73%|███████▎  | 709/971 [00:13<00:04, 55.64it/s]backtest loop:  74%|███████▎  | 716/971 [00:13<00:04, 57.63it/s]backtest loop:  74%|███████▍  | 722/971 [00:13<00:04, 58.06it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 56.19it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 53.97it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 55.49it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.40it/s]backtest loop:  78%|███████▊  | 754/971 [00:13<00:03, 55.64it/s]backtest loop:  78%|███████▊  | 760/971 [00:13<00:03, 53.66it/s]backtest loop:  79%|███████▉  | 767/971 [00:14<00:03, 56.16it/s]backtest loop:  80%|███████▉  | 774/971 [00:14<00:03, 57.94it/s]backtest loop:  80%|████████  | 780/971 [00:14<00:03, 55.24it/s]backtest loop:  81%|████████  | 786/971 [00:14<00:03, 56.27it/s]backtest loop:  82%|████████▏ | 792/971 [00:14<00:03, 57.15it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 54.55it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:02, 56.82it/s]backtest loop:  84%|████████▎ | 812/971 [00:14<00:02, 58.45it/s]backtest loop:  84%|████████▍ | 818/971 [00:14<00:02, 55.46it/s]backtest loop:  85%|████████▍ | 824/971 [00:15<00:02, 56.35it/s]backtest loop:  85%|████████▌ | 830/971 [00:15<00:02, 57.28it/s]backtest loop:  86%|████████▌ | 836/971 [00:15<00:02, 57.98it/s]backtest loop:  87%|████████▋ | 842/971 [00:15<00:02, 58.53it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 55.40it/s]backtest loop:  88%|████████▊ | 854/971 [00:15<00:02, 55.86it/s]backtest loop:  89%|████████▊ | 860/971 [00:15<00:01, 56.99it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 57.82it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 54.96it/s]backtest loop:  90%|█████████ | 878/971 [00:16<00:01, 56.04it/s]backtest loop:  91%|█████████ | 884/971 [00:16<00:01, 56.79it/s]backtest loop:  92%|█████████▏| 890/971 [00:16<00:01, 57.36it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 55.47it/s]backtest loop:  93%|█████████▎| 903/971 [00:16<00:01, 56.35it/s]backtest loop:  94%|█████████▎| 909/971 [00:16<00:01, 57.32it/s]backtest loop:  94%|█████████▍| 916/971 [00:16<00:00, 55.35it/s]backtest loop:  95%|█████████▍| 922/971 [00:16<00:00, 56.22it/s]backtest loop:  96%|█████████▌| 928/971 [00:16<00:00, 57.21it/s]backtest loop:  96%|█████████▌| 934/971 [00:17<00:00, 57.82it/s]backtest loop:  97%|█████████▋| 940/971 [00:17<00:00, 54.98it/s]backtest loop:  98%|█████████▊| 947/971 [00:17<00:00, 57.15it/s]backtest loop:  98%|█████████▊| 953/971 [00:17<00:00, 57.69it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 58.05it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 55.22it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.90it/s]
[3265079:MainThread](2024-04-25 14:50:17,785) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000331
std                0.005465
annualized_return  0.078690
information_ratio  0.933392
max_drawdown      -0.089015
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000127
std                0.005465
annualized_return  0.030137
information_ratio  0.357454
max_drawdown      -0.097582
[3265079:MainThread](2024-04-25 14:50:17,798) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ADARNN_crowd_data_csi300_360_rankTrue`.
[3265079:MainThread](2024-04-25 14:50:24,751) INFO - qlib.timer - [log.py:127] - Time cost: 0.009s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.0085111448463081,
                                                    0.040133948309472374,
                                                    0.10316185137476734,
                                                    0.09323388904245221,
                                                    0.030137306084237318],
 '1day.excess_return_with_cost.information_ratio': [-0.10598626920625567,
                                                    0.5394907020639452,
                                                    1.363858333479228,
                                                    1.2467355553729704,
                                                    0.35745365993276573],
 '1day.excess_return_with_cost.max_drawdown': [-0.20237780038364295,
                                               -0.07594003976516654,
                                               -0.08729842747498329,
                                               -0.08604753042288982,
                                               -0.09758207990055402],
 'IC': [0.0013536984392258171,
        0.026439898619729344,
        0.026902079345962383,
        0.02348331098236194,
        0.01327365027193708],
 'ICIR': [0.009181160161704657,
          0.21079803251917983,
          0.19837312520563208,
          0.18130028119321606,
          0.08768322408071108],
 'Rank IC': [0.012407792581098361,
             0.03724272331287428,
             0.03587138551857936,
             0.03310470827646654,
             0.019693651797228897],
 'Rank ICIR': [0.08674177992422927,
               0.29319132408979226,
               0.27587741721675363,
               0.24465738515472754,
               0.12528583016367276],
 'mae': [0.8703869590122575,
         0.8647632230090078,
         0.864850520964454,
         0.8644913943487671,
         0.8657382494764543],
 'mse': [1.0176620582257514,
         1.0010798346127248,
         1.001276056691344,
         0.9992015764604559,
         1.0014523455546427]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3265079:MainThread](2024-04-25 14:50:27,959) INFO - qlib.ADARNN - [pytorch_adarnn.py:63] - ADARNN pytorch version...
[3265079:MainThread](2024-04-25 14:50:27,960) INFO - qlib.ADARNN - [pytorch_adarnn.py:87] - ADARNN parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3265079:MainThread](2024-04-25 14:50:27,975) INFO - qlib.ADARNN - [pytorch_adarnn.py:136] - model:
AdaRNN(
  (features): Sequential(
    (0): GRU(6, 64, batch_first=True)
    (1): GRU(64, 64, batch_first=True)
  )
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
  (gate): ModuleList(
    (0): Linear(in_features=7680, out_features=60, bias=True)
    (1): Linear(in_features=7680, out_features=60, bias=True)
  )
  (bn_lst): ModuleList(
    (0): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (softmax): Softmax(dim=0)
)
[3265079:MainThread](2024-04-25 14:50:27,976) INFO - qlib.ADARNN - [pytorch_adarnn.py:137] - model size: 0.9163 MB
[3265079:MainThread](2024-04-25 14:50:30,931) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ADARNN_crowd_data_csi300_360_rankTrue_48.
[3265079:MainThread](2024-04-25 14:50:31,046) INFO - qlib.workflow - [exp.py:258] - Experiment 106 starts running ...
[3265079:MainThread](2024-04-25 14:50:31,063) INFO - qlib.workflow - [recorder.py:341] - Recorder e7ee069c6d9343fd8bab969db057118b starts running under Experiment 106 ...
[3265079:MainThread](2024-04-25 14:50:35,524) INFO - qlib.ADARNN - [pytorch_adarnn.py:266] - training...
[3265079:MainThread](2024-04-25 14:50:35,525) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch0:
[3265079:MainThread](2024-04-25 14:50:35,525) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:51:39,208) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:51:46,590) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.097384, icir/train: : 0.697446, ric/train: : 0.093111, ricir/train: : 0.665862, mse/train: : -0.016016, loss/train: : -0.016016
[3265079:MainThread](2024-04-25 14:51:46,590) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.041035, icir/valid: : 0.289397, ric/valid: : 0.038510, ricir/valid: : 0.269071, mse/valid: : -0.011523, loss/valid: : -0.011523
[3265079:MainThread](2024-04-25 14:51:46,592) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch1:
[3265079:MainThread](2024-04-25 14:51:46,592) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:52:48,948) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:52:56,267) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.103007, icir/train: : 0.707495, ric/train: : 0.099061, ricir/train: : 0.675169, mse/train: : 0.026583, loss/train: : 0.026583
[3265079:MainThread](2024-04-25 14:52:56,268) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.037738, icir/valid: : 0.255466, ric/valid: : 0.037248, ricir/valid: : 0.250135, mse/valid: : 0.025091, loss/valid: : 0.025091
[3265079:MainThread](2024-04-25 14:52:56,269) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch2:
[3265079:MainThread](2024-04-25 14:52:56,270) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:54:01,925) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:54:09,329) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.085705, icir/train: : 0.686536, ric/train: : 0.082057, ricir/train: : 0.664012, mse/train: : 0.000696, loss/train: : 0.000696
[3265079:MainThread](2024-04-25 14:54:09,330) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.033818, icir/valid: : 0.263396, ric/valid: : 0.031852, ricir/valid: : 0.251970, mse/valid: : 0.009490, loss/valid: : 0.009490
[3265079:MainThread](2024-04-25 14:54:09,330) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch3:
[3265079:MainThread](2024-04-25 14:54:09,330) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:55:12,431) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:55:19,731) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.093825, icir/train: : 0.730652, ric/train: : 0.089748, ricir/train: : 0.702009, mse/train: : 0.044776, loss/train: : 0.044776
[3265079:MainThread](2024-04-25 14:55:19,731) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.038533, icir/valid: : 0.300425, ric/valid: : 0.036460, ricir/valid: : 0.284769, mse/valid: : 0.050875, loss/valid: : 0.050875
[3265079:MainThread](2024-04-25 14:55:19,733) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch4:
[3265079:MainThread](2024-04-25 14:55:19,734) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:56:26,356) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:56:33,649) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.087336, icir/train: : 0.725227, ric/train: : 0.083736, ricir/train: : 0.692462, mse/train: : 0.046337, loss/train: : 0.046337
[3265079:MainThread](2024-04-25 14:56:33,649) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.038460, icir/valid: : 0.313435, ric/valid: : 0.036833, ricir/valid: : 0.297027, mse/valid: : 0.053265, loss/valid: : 0.053265
[3265079:MainThread](2024-04-25 14:56:33,651) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch5:
[3265079:MainThread](2024-04-25 14:56:33,652) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:57:43,199) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:57:50,608) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.102892, icir/train: : 0.849698, ric/train: : 0.099028, ricir/train: : 0.821878, mse/train: : -0.032048, loss/train: : -0.032048
[3265079:MainThread](2024-04-25 14:57:50,608) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.044421, icir/valid: : 0.352551, ric/valid: : 0.041957, ricir/valid: : 0.334987, mse/valid: : -0.023326, loss/valid: : -0.023326
[3265079:MainThread](2024-04-25 14:57:50,609) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch6:
[3265079:MainThread](2024-04-25 14:57:50,609) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 14:59:12,974) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 14:59:21,428) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.097568, icir/train: : 0.782048, ric/train: : 0.093976, ricir/train: : 0.758287, mse/train: : -0.007764, loss/train: : -0.007764
[3265079:MainThread](2024-04-25 14:59:21,429) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.043835, icir/valid: : 0.336042, ric/valid: : 0.041508, ricir/valid: : 0.320762, mse/valid: : -0.003256, loss/valid: : -0.003256
[3265079:MainThread](2024-04-25 14:59:21,429) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch7:
[3265079:MainThread](2024-04-25 14:59:21,429) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:01:06,167) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:01:13,867) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.082252, icir/train: : 0.616030, ric/train: : 0.077551, ricir/train: : 0.582448, mse/train: : 0.012089, loss/train: : 0.012089
[3265079:MainThread](2024-04-25 15:01:13,867) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.028638, icir/valid: : 0.220636, ric/valid: : 0.026915, ricir/valid: : 0.202199, mse/valid: : 0.018606, loss/valid: : 0.018606
[3265079:MainThread](2024-04-25 15:01:13,868) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch8:
[3265079:MainThread](2024-04-25 15:01:13,868) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:02:41,836) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:02:49,582) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.088210, icir/train: : 0.726654, ric/train: : 0.084013, ricir/train: : 0.702472, mse/train: : 0.012998, loss/train: : 0.012998
[3265079:MainThread](2024-04-25 15:02:49,583) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.039780, icir/valid: : 0.326843, ric/valid: : 0.037649, ricir/valid: : 0.312640, mse/valid: : 0.020875, loss/valid: : 0.020875
[3265079:MainThread](2024-04-25 15:02:49,583) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch9:
[3265079:MainThread](2024-04-25 15:02:49,583) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:04:19,037) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:04:26,681) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.094101, icir/train: : 0.708998, ric/train: : 0.090274, ricir/train: : 0.681934, mse/train: : 0.012135, loss/train: : 0.012135
[3265079:MainThread](2024-04-25 15:04:26,682) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.039039, icir/valid: : 0.299613, ric/valid: : 0.038015, ricir/valid: : 0.288084, mse/valid: : 0.015898, loss/valid: : 0.015898
[3265079:MainThread](2024-04-25 15:04:26,683) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch10:
[3265079:MainThread](2024-04-25 15:04:26,683) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:05:56,690) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:06:04,266) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.088384, icir/train: : 0.722782, ric/train: : 0.085137, ricir/train: : 0.699342, mse/train: : -0.044904, loss/train: : -0.044904
[3265079:MainThread](2024-04-25 15:06:04,266) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.040042, icir/valid: : 0.321668, ric/valid: : 0.038920, ricir/valid: : 0.311511, mse/valid: : -0.038153, loss/valid: : -0.038153
[3265079:MainThread](2024-04-25 15:06:04,267) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch11:
[3265079:MainThread](2024-04-25 15:06:04,267) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:07:35,627) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:07:43,382) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.100521, icir/train: : 0.786547, ric/train: : 0.096902, ricir/train: : 0.760531, mse/train: : 0.003766, loss/train: : 0.003766
[3265079:MainThread](2024-04-25 15:07:43,383) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.039144, icir/valid: : 0.294932, ric/valid: : 0.036597, ricir/valid: : 0.276871, mse/valid: : 0.012135, loss/valid: : 0.012135
[3265079:MainThread](2024-04-25 15:07:43,383) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch12:
[3265079:MainThread](2024-04-25 15:07:43,383) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:09:15,019) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:09:22,684) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.092517, icir/train: : 0.721641, ric/train: : 0.088255, ricir/train: : 0.687747, mse/train: : -0.018269, loss/train: : -0.018269
[3265079:MainThread](2024-04-25 15:09:22,685) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.034279, icir/valid: : 0.259541, ric/valid: : 0.031154, ricir/valid: : 0.235499, mse/valid: : -0.010405, loss/valid: : -0.010405
[3265079:MainThread](2024-04-25 15:09:22,685) INFO - qlib.ADARNN - [pytorch_adarnn.py:294] - early stop
[3265079:MainThread](2024-04-25 15:09:22,685) INFO - qlib.ADARNN - [pytorch_adarnn.py:297] - best score: 0.053265 @ 4
[3265079:MainThread](2024-04-25 15:09:22,822) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ADARNN_crowd_data_csi300_360_rankTrue_48.
[3265079:MainThread](2024-04-25 15:09:23,516) INFO - qlib.workflow - [exp.py:258] - Experiment 101 starts running ...
[3265079:MainThread](2024-04-25 15:09:23,535) INFO - qlib.workflow - [recorder.py:341] - Recorder 7132df3f028a4b7abaa8ed7790800ba7 starts running under Experiment 101 ...
{'IC': 0.027115639691058954,
 'ICIR': 0.225711831523885,
 'Rank IC': 0.031972516716016676,
 'Rank ICIR': 0.24856618846863654}
[3265079:MainThread](2024-04-25 15:09:31,474) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3265079:MainThread](2024-04-25 15:10:23,356) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 15:10:23,360) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 15:10:30,011) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f89139cb7c0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:51,  8.70it/s]backtest loop:   1%|          | 8/971 [00:00<00:47, 20.47it/s]backtest loop:   1%|▏         | 13/971 [00:00<00:33, 28.51it/s]backtest loop:   2%|▏         | 19/971 [00:00<00:25, 36.72it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:24, 38.37it/s]backtest loop:   3%|▎         | 30/971 [00:00<00:21, 43.34it/s]backtest loop:   4%|▎         | 36/971 [00:01<00:20, 46.46it/s]backtest loop:   4%|▍         | 42/971 [00:01<00:19, 48.18it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:18, 49.80it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:19, 48.24it/s]backtest loop:   6%|▌         | 60/971 [00:01<00:18, 49.64it/s]backtest loop:   7%|▋         | 66/971 [00:01<00:17, 51.54it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:18, 49.51it/s]backtest loop:   8%|▊         | 78/971 [00:01<00:17, 51.03it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:17, 51.54it/s]backtest loop:   9%|▉         | 90/971 [00:02<00:17, 51.63it/s]backtest loop:  10%|▉         | 96/971 [00:02<00:16, 52.63it/s]backtest loop:  11%|█         | 102/971 [00:02<00:17, 50.12it/s]backtest loop:  11%|█         | 108/971 [00:02<00:16, 51.55it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:16, 52.37it/s]backtest loop:  12%|█▏        | 120/971 [00:02<00:16, 52.38it/s]backtest loop:  13%|█▎        | 126/971 [00:02<00:18, 46.71it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:17, 47.52it/s]backtest loop:  14%|█▍        | 137/971 [00:03<00:16, 49.14it/s]backtest loop:  15%|█▍        | 142/971 [00:03<00:28, 29.29it/s]backtest loop:  15%|█▌        | 148/971 [00:03<00:24, 34.01it/s]backtest loop:  16%|█▌        | 154/971 [00:03<00:21, 38.52it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:19, 40.67it/s]backtest loop:  17%|█▋        | 164/971 [00:03<00:19, 42.28it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:17, 44.99it/s]backtest loop:  18%|█▊        | 175/971 [00:04<00:17, 45.87it/s]backtest loop:  19%|█▊        | 181/971 [00:04<00:16, 46.61it/s]backtest loop:  19%|█▉        | 188/971 [00:04<00:15, 51.02it/s]backtest loop:  20%|█▉        | 194/971 [00:04<00:14, 52.85it/s]backtest loop:  21%|██        | 200/971 [00:04<00:14, 51.70it/s]backtest loop:  21%|██        | 206/971 [00:04<00:14, 53.49it/s]backtest loop:  22%|██▏       | 212/971 [00:04<00:14, 52.80it/s]backtest loop:  22%|██▏       | 218/971 [00:04<00:15, 49.18it/s]backtest loop:  23%|██▎       | 224/971 [00:04<00:14, 49.91it/s]backtest loop:  24%|██▎       | 230/971 [00:05<00:15, 47.09it/s]backtest loop:  24%|██▍       | 235/971 [00:05<00:15, 47.41it/s]backtest loop:  25%|██▍       | 240/971 [00:05<00:15, 47.49it/s]backtest loop:  25%|██▌       | 245/971 [00:05<00:15, 48.05it/s]backtest loop:  26%|██▌       | 251/971 [00:05<00:14, 49.56it/s]backtest loop:  26%|██▋       | 257/971 [00:05<00:14, 50.85it/s]backtest loop:  27%|██▋       | 263/971 [00:05<00:13, 51.14it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:14, 48.45it/s]backtest loop:  28%|██▊       | 274/971 [00:05<00:14, 48.68it/s]backtest loop:  29%|██▉       | 280/971 [00:06<00:13, 49.92it/s]backtest loop:  29%|██▉       | 286/971 [00:06<00:14, 47.80it/s]backtest loop:  30%|███       | 292/971 [00:06<00:13, 49.23it/s]backtest loop:  31%|███       | 297/971 [00:06<00:13, 49.36it/s]backtest loop:  31%|███       | 303/971 [00:06<00:13, 50.23it/s]backtest loop:  32%|███▏      | 309/971 [00:06<00:13, 50.23it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:13, 47.83it/s]backtest loop:  33%|███▎      | 320/971 [00:06<00:13, 48.28it/s]backtest loop:  34%|███▎      | 326/971 [00:07<00:13, 49.51it/s]backtest loop:  34%|███▍      | 332/971 [00:07<00:12, 50.35it/s]backtest loop:  35%|███▍      | 338/971 [00:07<00:12, 50.91it/s]backtest loop:  35%|███▌      | 344/971 [00:07<00:12, 50.65it/s]backtest loop:  36%|███▌      | 350/971 [00:07<00:12, 48.03it/s]backtest loop:  37%|███▋      | 355/971 [00:07<00:12, 48.40it/s]backtest loop:  37%|███▋      | 361/971 [00:07<00:12, 49.48it/s]backtest loop:  38%|███▊      | 366/971 [00:07<00:12, 49.41it/s]backtest loop:  38%|███▊      | 371/971 [00:07<00:12, 46.54it/s]backtest loop:  39%|███▊      | 376/971 [00:08<00:12, 47.24it/s]backtest loop:  39%|███▉      | 381/971 [00:08<00:12, 47.52it/s]backtest loop:  40%|███▉      | 386/971 [00:08<00:12, 48.18it/s]backtest loop:  40%|████      | 391/971 [00:08<00:11, 48.68it/s]backtest loop:  41%|████      | 396/971 [00:08<00:11, 48.19it/s]backtest loop:  41%|████▏     | 401/971 [00:08<00:11, 48.57it/s]backtest loop:  42%|████▏     | 407/971 [00:08<00:11, 50.13it/s]backtest loop:  43%|████▎     | 413/971 [00:08<00:11, 47.60it/s]backtest loop:  43%|████▎     | 418/971 [00:08<00:11, 47.60it/s]backtest loop:  44%|████▎     | 423/971 [00:09<00:11, 48.05it/s]backtest loop:  44%|████▍     | 428/971 [00:09<00:11, 48.47it/s]backtest loop:  45%|████▍     | 433/971 [00:09<00:11, 47.97it/s]backtest loop:  45%|████▌     | 438/971 [00:09<00:11, 48.21it/s]backtest loop:  46%|████▌     | 443/971 [00:09<00:10, 48.65it/s]backtest loop:  46%|████▌     | 448/971 [00:09<00:10, 48.92it/s]backtest loop:  47%|████▋     | 453/971 [00:09<00:10, 49.21it/s]backtest loop:  47%|████▋     | 458/971 [00:09<00:10, 49.04it/s]backtest loop:  48%|████▊     | 463/971 [00:09<00:10, 49.12it/s]backtest loop:  48%|████▊     | 468/971 [00:09<00:10, 49.30it/s]backtest loop:  49%|████▊     | 473/971 [00:10<00:10, 49.31it/s]backtest loop:  49%|████▉     | 478/971 [00:10<00:10, 49.26it/s]backtest loop:  50%|████▉     | 483/971 [00:10<00:09, 49.42it/s]backtest loop:  50%|█████     | 489/971 [00:10<00:09, 50.32it/s]backtest loop:  51%|█████     | 495/971 [00:10<00:09, 47.98it/s]backtest loop:  51%|█████▏    | 500/971 [00:10<00:09, 48.36it/s]backtest loop:  52%|█████▏    | 506/971 [00:10<00:09, 49.84it/s]backtest loop:  53%|█████▎    | 512/971 [00:10<00:09, 47.31it/s]backtest loop:  53%|█████▎    | 518/971 [00:10<00:09, 48.95it/s]backtest loop:  54%|█████▍    | 523/971 [00:11<00:09, 49.01it/s]backtest loop:  54%|█████▍    | 529/971 [00:11<00:08, 50.20it/s]backtest loop:  55%|█████▌    | 535/971 [00:11<00:08, 50.85it/s]backtest loop:  56%|█████▌    | 541/971 [00:11<00:08, 48.27it/s]backtest loop:  56%|█████▋    | 547/971 [00:11<00:08, 49.60it/s]backtest loop:  57%|█████▋    | 553/971 [00:11<00:08, 50.77it/s]backtest loop:  58%|█████▊    | 559/971 [00:11<00:07, 53.10it/s]backtest loop:  58%|█████▊    | 565/971 [00:11<00:07, 54.95it/s]backtest loop:  59%|█████▉    | 571/971 [00:12<00:07, 53.11it/s]backtest loop:  59%|█████▉    | 577/971 [00:12<00:07, 55.01it/s]backtest loop:  60%|██████    | 584/971 [00:12<00:06, 57.21it/s]backtest loop:  61%|██████    | 590/971 [00:12<00:06, 57.94it/s]backtest loop:  61%|██████▏   | 596/971 [00:12<00:06, 55.17it/s]backtest loop:  62%|██████▏   | 602/971 [00:12<00:06, 55.65it/s]backtest loop:  63%|██████▎   | 608/971 [00:12<00:06, 55.41it/s]backtest loop:  63%|██████▎   | 614/971 [00:12<00:06, 55.14it/s]backtest loop:  64%|██████▍   | 620/971 [00:12<00:07, 49.79it/s]backtest loop:  64%|██████▍   | 626/971 [00:13<00:06, 49.71it/s]backtest loop:  65%|██████▌   | 632/971 [00:13<00:06, 50.41it/s]backtest loop:  66%|██████▌   | 638/971 [00:13<00:06, 50.40it/s]backtest loop:  66%|██████▋   | 644/971 [00:13<00:06, 49.77it/s]backtest loop:  67%|██████▋   | 650/971 [00:13<00:06, 47.09it/s]backtest loop:  67%|██████▋   | 655/971 [00:13<00:06, 47.19it/s]backtest loop:  68%|██████▊   | 660/971 [00:13<00:06, 47.44it/s]backtest loop:  68%|██████▊   | 665/971 [00:13<00:06, 47.73it/s]backtest loop:  69%|██████▉   | 670/971 [00:13<00:06, 47.86it/s]backtest loop:  70%|██████▉   | 675/971 [00:14<00:06, 48.06it/s]backtest loop:  70%|███████   | 680/971 [00:14<00:06, 47.77it/s]backtest loop:  71%|███████   | 685/971 [00:14<00:06, 47.61it/s]backtest loop:  71%|███████   | 690/971 [00:14<00:05, 47.35it/s]backtest loop:  72%|███████▏  | 696/971 [00:14<00:05, 48.74it/s]backtest loop:  72%|███████▏  | 702/971 [00:14<00:05, 49.77it/s]backtest loop:  73%|███████▎  | 707/971 [00:14<00:05, 48.43it/s]backtest loop:  73%|███████▎  | 713/971 [00:14<00:05, 50.00it/s]backtest loop:  74%|███████▍  | 718/971 [00:14<00:05, 49.71it/s]backtest loop:  75%|███████▍  | 724/971 [00:15<00:05, 47.81it/s]backtest loop:  75%|███████▌  | 730/971 [00:15<00:04, 49.86it/s]backtest loop:  76%|███████▌  | 736/971 [00:15<00:04, 48.45it/s]backtest loop:  76%|███████▋  | 742/971 [00:15<00:04, 50.18it/s]backtest loop:  77%|███████▋  | 748/971 [00:15<00:04, 48.61it/s]backtest loop:  78%|███████▊  | 754/971 [00:15<00:04, 50.08it/s]backtest loop:  78%|███████▊  | 760/971 [00:15<00:04, 49.79it/s]backtest loop:  79%|███████▉  | 767/971 [00:15<00:03, 53.39it/s]backtest loop:  80%|███████▉  | 774/971 [00:16<00:03, 55.93it/s]backtest loop:  80%|████████  | 780/971 [00:16<00:03, 53.92it/s]backtest loop:  81%|████████  | 786/971 [00:16<00:03, 54.05it/s]backtest loop:  82%|████████▏ | 792/971 [00:16<00:03, 53.26it/s]backtest loop:  82%|████████▏ | 798/971 [00:16<00:03, 49.59it/s]backtest loop:  83%|████████▎ | 804/971 [00:16<00:03, 50.22it/s]backtest loop:  83%|████████▎ | 810/971 [00:16<00:03, 50.48it/s]backtest loop:  84%|████████▍ | 816/971 [00:16<00:03, 50.51it/s]backtest loop:  85%|████████▍ | 822/971 [00:16<00:02, 50.57it/s]backtest loop:  85%|████████▌ | 828/971 [00:17<00:02, 47.96it/s]backtest loop:  86%|████████▌ | 834/971 [00:17<00:02, 49.23it/s]backtest loop:  87%|████████▋ | 840/971 [00:17<00:02, 50.55it/s]backtest loop:  87%|████████▋ | 846/971 [00:17<00:02, 50.44it/s]backtest loop:  88%|████████▊ | 852/971 [00:17<00:02, 48.29it/s]backtest loop:  88%|████████▊ | 858/971 [00:17<00:02, 49.44it/s]backtest loop:  89%|████████▉ | 864/971 [00:17<00:02, 50.01it/s]backtest loop:  90%|████████▉ | 870/971 [00:17<00:01, 51.01it/s]backtest loop:  90%|█████████ | 876/971 [00:18<00:01, 50.91it/s]backtest loop:  91%|█████████ | 882/971 [00:18<00:01, 48.42it/s]backtest loop:  91%|█████████▏| 887/971 [00:18<00:01, 48.78it/s]backtest loop:  92%|█████████▏| 893/971 [00:18<00:01, 49.87it/s]backtest loop:  93%|█████████▎| 899/971 [00:18<00:01, 50.67it/s]backtest loop:  93%|█████████▎| 905/971 [00:18<00:01, 51.19it/s]backtest loop:  94%|█████████▍| 911/971 [00:18<00:01, 51.37it/s]backtest loop:  94%|█████████▍| 917/971 [00:18<00:01, 48.65it/s]backtest loop:  95%|█████████▌| 923/971 [00:18<00:00, 49.78it/s]backtest loop:  96%|█████████▌| 929/971 [00:19<00:00, 50.50it/s]backtest loop:  96%|█████████▋| 935/971 [00:19<00:00, 51.12it/s]backtest loop:  97%|█████████▋| 941/971 [00:19<00:00, 48.62it/s]backtest loop:  97%|█████████▋| 946/971 [00:19<00:00, 48.84it/s]backtest loop:  98%|█████████▊| 952/971 [00:19<00:00, 49.92it/s]backtest loop:  99%|█████████▊| 958/971 [00:19<00:00, 49.98it/s]backtest loop:  99%|█████████▉| 964/971 [00:19<00:00, 49.54it/s]backtest loop: 100%|█████████▉| 969/971 [00:19<00:00, 48.36it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 48.58it/s]
[3265079:MainThread](2024-04-25 15:10:50,090) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000637
std                0.004541
annualized_return  0.151601
information_ratio  2.164150
max_drawdown      -0.063690
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000443
std                0.004542
annualized_return  0.105318
information_ratio  1.503015
max_drawdown      -0.071744
[3265079:MainThread](2024-04-25 15:10:50,106) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ADARNN_crowd_data_csi300_360_rankTrue`.
[3265079:MainThread](2024-04-25 15:11:09,611) INFO - qlib.timer - [log.py:127] - Time cost: 0.005s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.0085111448463081,
                                                    0.040133948309472374,
                                                    0.10316185137476734,
                                                    0.09323388904245221,
                                                    0.030137306084237318,
                                                    0.10531798942252292],
 '1day.excess_return_with_cost.information_ratio': [-0.10598626920625567,
                                                    0.5394907020639452,
                                                    1.363858333479228,
                                                    1.2467355553729704,
                                                    0.35745365993276573,
                                                    1.503015181777876],
 '1day.excess_return_with_cost.max_drawdown': [-0.20237780038364295,
                                               -0.07594003976516654,
                                               -0.08729842747498329,
                                               -0.08604753042288982,
                                               -0.09758207990055402,
                                               -0.07174431931335298],
 'IC': [0.0013536984392258171,
        0.026439898619729344,
        0.026902079345962383,
        0.02348331098236194,
        0.01327365027193708,
        0.027115639691058954],
 'ICIR': [0.009181160161704657,
          0.21079803251917983,
          0.19837312520563208,
          0.18130028119321606,
          0.08768322408071108,
          0.225711831523885],
 'Rank IC': [0.012407792581098361,
             0.03724272331287428,
             0.03587138551857936,
             0.03310470827646654,
             0.019693651797228897,
             0.031972516716016676],
 'Rank ICIR': [0.08674177992422927,
               0.29319132408979226,
               0.27587741721675363,
               0.24465738515472754,
               0.12528583016367276,
               0.24856618846863654],
 'mae': [0.8703869590122575,
         0.8647632230090078,
         0.864850520964454,
         0.8644913943487671,
         0.8657382494764543,
         0.8650519310588405],
 'mse': [1.0176620582257514,
         1.0010798346127248,
         1.001276056691344,
         0.9992015764604559,
         1.0014523455546427,
         1.000771897485576]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3265079:MainThread](2024-04-25 15:11:13,433) INFO - qlib.ADARNN - [pytorch_adarnn.py:63] - ADARNN pytorch version...
[3265079:MainThread](2024-04-25 15:11:13,433) INFO - qlib.ADARNN - [pytorch_adarnn.py:87] - ADARNN parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3265079:MainThread](2024-04-25 15:11:13,450) INFO - qlib.ADARNN - [pytorch_adarnn.py:136] - model:
AdaRNN(
  (features): Sequential(
    (0): GRU(6, 64, batch_first=True)
    (1): GRU(64, 64, batch_first=True)
  )
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
  (gate): ModuleList(
    (0): Linear(in_features=7680, out_features=60, bias=True)
    (1): Linear(in_features=7680, out_features=60, bias=True)
  )
  (bn_lst): ModuleList(
    (0): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (softmax): Softmax(dim=0)
)
[3265079:MainThread](2024-04-25 15:11:13,451) INFO - qlib.ADARNN - [pytorch_adarnn.py:137] - model size: 0.9163 MB
[3265079:MainThread](2024-04-25 15:11:17,079) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ADARNN_crowd_data_csi300_360_rankTrue_49.
[3265079:MainThread](2024-04-25 15:11:17,202) INFO - qlib.workflow - [exp.py:258] - Experiment 107 starts running ...
[3265079:MainThread](2024-04-25 15:11:17,224) INFO - qlib.workflow - [recorder.py:341] - Recorder 3b05e011b0344a82a5496b963c14349b starts running under Experiment 107 ...
[3265079:MainThread](2024-04-25 15:11:24,397) INFO - qlib.ADARNN - [pytorch_adarnn.py:266] - training...
[3265079:MainThread](2024-04-25 15:11:24,400) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch0:
[3265079:MainThread](2024-04-25 15:11:24,400) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:13:06,539) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:13:14,332) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.055570, icir/train: : 0.323584, ric/train: : 0.052934, ricir/train: : 0.308459, mse/train: : 0.006985, loss/train: : 0.006985
[3265079:MainThread](2024-04-25 15:13:14,333) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.025126, icir/valid: : 0.159836, ric/valid: : 0.026045, ricir/valid: : 0.164019, mse/valid: : 0.001282, loss/valid: : 0.001282
[3265079:MainThread](2024-04-25 15:13:14,336) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch1:
[3265079:MainThread](2024-04-25 15:13:14,337) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:14:49,498) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:14:57,445) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.048805, icir/train: : 0.381175, ric/train: : 0.047282, ricir/train: : 0.379034, mse/train: : 0.035733, loss/train: : 0.035733
[3265079:MainThread](2024-04-25 15:14:57,445) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.022812, icir/valid: : 0.182043, ric/valid: : 0.020898, ricir/valid: : 0.170737, mse/valid: : 0.043053, loss/valid: : 0.043053
[3265079:MainThread](2024-04-25 15:14:57,447) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch2:
[3265079:MainThread](2024-04-25 15:14:57,448) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:16:32,677) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:16:40,391) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.063721, icir/train: : 0.513164, ric/train: : 0.060491, ricir/train: : 0.490899, mse/train: : 0.013981, loss/train: : 0.013981
[3265079:MainThread](2024-04-25 15:16:40,391) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.027121, icir/valid: : 0.214676, ric/valid: : 0.025006, ricir/valid: : 0.199371, mse/valid: : 0.017702, loss/valid: : 0.017702
[3265079:MainThread](2024-04-25 15:16:40,392) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch3:
[3265079:MainThread](2024-04-25 15:16:40,392) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:18:01,178) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:18:08,533) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.063108, icir/train: : 0.495311, ric/train: : 0.060678, ricir/train: : 0.480520, mse/train: : 0.038328, loss/train: : 0.038328
[3265079:MainThread](2024-04-25 15:18:08,534) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.026272, icir/valid: : 0.204808, ric/valid: : 0.025740, ricir/valid: : 0.201856, mse/valid: : 0.042145, loss/valid: : 0.042145
[3265079:MainThread](2024-04-25 15:18:08,534) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch4:
[3265079:MainThread](2024-04-25 15:18:08,534) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:19:17,741) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:19:25,207) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.065925, icir/train: : 0.513752, ric/train: : 0.063475, ricir/train: : 0.497858, mse/train: : -0.020167, loss/train: : -0.020167
[3265079:MainThread](2024-04-25 15:19:25,208) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.025523, icir/valid: : 0.190288, ric/valid: : 0.023869, ricir/valid: : 0.177186, mse/valid: : -0.007958, loss/valid: : -0.007958
[3265079:MainThread](2024-04-25 15:19:25,208) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch5:
[3265079:MainThread](2024-04-25 15:19:25,208) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:20:43,992) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:20:51,693) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.075175, icir/train: : 0.641446, ric/train: : 0.071625, ricir/train: : 0.608826, mse/train: : -0.006549, loss/train: : -0.006549
[3265079:MainThread](2024-04-25 15:20:51,693) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.034799, icir/valid: : 0.287627, ric/valid: : 0.032272, ricir/valid: : 0.264071, mse/valid: : -0.002376, loss/valid: : -0.002376
[3265079:MainThread](2024-04-25 15:20:51,694) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch6:
[3265079:MainThread](2024-04-25 15:20:51,694) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:22:18,253) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:22:26,153) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.084929, icir/train: : 0.702130, ric/train: : 0.080943, ricir/train: : 0.676047, mse/train: : 0.002661, loss/train: : 0.002661
[3265079:MainThread](2024-04-25 15:22:26,154) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.033164, icir/valid: : 0.251983, ric/valid: : 0.030089, ricir/valid: : 0.231763, mse/valid: : 0.011779, loss/valid: : 0.011779
[3265079:MainThread](2024-04-25 15:22:26,154) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch7:
[3265079:MainThread](2024-04-25 15:22:26,154) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:24:01,500) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:24:09,609) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.091776, icir/train: : 0.704320, ric/train: : 0.087079, ricir/train: : 0.681094, mse/train: : -0.000834, loss/train: : -0.000834
[3265079:MainThread](2024-04-25 15:24:09,610) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.040913, icir/valid: : 0.298968, ric/valid: : 0.038110, ricir/valid: : 0.283283, mse/valid: : 0.006972, loss/valid: : 0.006972
[3265079:MainThread](2024-04-25 15:24:09,610) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch8:
[3265079:MainThread](2024-04-25 15:24:09,610) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:25:49,737) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:25:58,021) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.074704, icir/train: : 0.555265, ric/train: : 0.073009, ricir/train: : 0.541428, mse/train: : -0.028474, loss/train: : -0.028474
[3265079:MainThread](2024-04-25 15:25:58,021) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.023443, icir/valid: : 0.175590, ric/valid: : 0.023866, ricir/valid: : 0.176106, mse/valid: : -0.030628, loss/valid: : -0.030628
[3265079:MainThread](2024-04-25 15:25:58,021) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch9:
[3265079:MainThread](2024-04-25 15:25:58,022) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:27:29,166) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:27:37,010) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.093971, icir/train: : 0.721238, ric/train: : 0.089606, ricir/train: : 0.693608, mse/train: : -0.022129, loss/train: : -0.022129
[3265079:MainThread](2024-04-25 15:27:37,011) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.041056, icir/valid: : 0.304176, ric/valid: : 0.039148, ricir/valid: : 0.295589, mse/valid: : -0.017577, loss/valid: : -0.017577
[3265079:MainThread](2024-04-25 15:27:37,011) INFO - qlib.ADARNN - [pytorch_adarnn.py:294] - early stop
[3265079:MainThread](2024-04-25 15:27:37,012) INFO - qlib.ADARNN - [pytorch_adarnn.py:297] - best score: 0.043053 @ 1
[3265079:MainThread](2024-04-25 15:27:37,195) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ADARNN_crowd_data_csi300_360_rankTrue_49.
[3265079:MainThread](2024-04-25 15:27:37,605) INFO - qlib.workflow - [exp.py:258] - Experiment 101 starts running ...
[3265079:MainThread](2024-04-25 15:27:37,625) INFO - qlib.workflow - [recorder.py:341] - Recorder 473d8dfa646f44e7baf8cd8373f82b6c starts running under Experiment 101 ...
{'IC': 0.015768548135018903,
 'ICIR': 0.12426388479425975,
 'Rank IC': 0.019646681310193474,
 'Rank ICIR': 0.14914286233002177}
[3265079:MainThread](2024-04-25 15:27:45,409) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3265079:MainThread](2024-04-25 15:28:30,984) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 15:28:30,988) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 15:28:37,739) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f891ad58e50>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:48,  8.93it/s]backtest loop:   1%|          | 9/971 [00:00<00:41, 23.21it/s]backtest loop:   1%|▏         | 14/971 [00:00<00:31, 30.51it/s]backtest loop:   2%|▏         | 19/971 [00:00<00:28, 33.62it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:28, 33.11it/s]backtest loop:   3%|▎         | 29/971 [00:00<00:26, 34.99it/s]backtest loop:   4%|▎         | 34/971 [00:01<00:25, 36.97it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:25, 37.06it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:24, 38.37it/s]backtest loop:   5%|▌         | 49/971 [00:01<00:24, 38.23it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:23, 38.93it/s]backtest loop:   6%|▌         | 58/971 [00:01<00:23, 39.01it/s]backtest loop:   6%|▋         | 62/971 [00:01<00:23, 38.83it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:22, 39.84it/s]backtest loop:   7%|▋         | 72/971 [00:02<00:22, 40.68it/s]backtest loop:   8%|▊         | 77/971 [00:02<00:21, 40.66it/s]backtest loop:   8%|▊         | 82/971 [00:02<00:21, 41.20it/s]backtest loop:   9%|▉         | 87/971 [00:02<00:21, 40.97it/s]backtest loop:   9%|▉         | 92/971 [00:02<00:21, 41.29it/s]backtest loop:  10%|▉         | 97/971 [00:02<00:21, 40.84it/s]backtest loop:  11%|█         | 102/971 [00:02<00:21, 40.13it/s]backtest loop:  11%|█         | 107/971 [00:02<00:21, 40.72it/s]backtest loop:  12%|█▏        | 112/971 [00:03<00:21, 40.48it/s]backtest loop:  12%|█▏        | 117/971 [00:03<00:21, 40.18it/s]backtest loop:  13%|█▎        | 122/971 [00:03<00:20, 40.57it/s]backtest loop:  13%|█▎        | 127/971 [00:03<00:22, 37.36it/s]backtest loop:  13%|█▎        | 131/971 [00:03<00:22, 37.57it/s]backtest loop:  14%|█▍        | 136/971 [00:03<00:22, 37.69it/s]backtest loop:  15%|█▍        | 141/971 [00:03<00:21, 38.27it/s]backtest loop:  15%|█▌        | 146/971 [00:03<00:21, 38.89it/s]backtest loop:  16%|█▌        | 151/971 [00:04<00:20, 39.38it/s]backtest loop:  16%|█▌        | 156/971 [00:04<00:20, 39.77it/s]backtest loop:  17%|█▋        | 161/971 [00:04<00:20, 39.54it/s]backtest loop:  17%|█▋        | 166/971 [00:04<00:20, 39.83it/s]backtest loop:  18%|█▊        | 171/971 [00:04<00:19, 40.44it/s]backtest loop:  18%|█▊        | 176/971 [00:04<00:19, 40.28it/s]backtest loop:  19%|█▊        | 181/971 [00:04<00:19, 41.17it/s]backtest loop:  19%|█▉        | 186/971 [00:04<00:19, 39.95it/s]backtest loop:  20%|█▉        | 191/971 [00:05<00:19, 39.88it/s]backtest loop:  20%|██        | 195/971 [00:05<00:19, 39.49it/s]backtest loop:  21%|██        | 200/971 [00:05<00:19, 40.55it/s]backtest loop:  21%|██        | 205/971 [00:05<00:18, 41.33it/s]backtest loop:  22%|██▏       | 210/971 [00:05<00:18, 41.76it/s]backtest loop:  22%|██▏       | 215/971 [00:05<00:33, 22.31it/s]backtest loop:  23%|██▎       | 220/971 [00:06<00:28, 26.37it/s]backtest loop:  23%|██▎       | 225/971 [00:06<00:25, 29.83it/s]backtest loop:  24%|██▎       | 230/971 [00:06<00:22, 32.70it/s]backtest loop:  24%|██▍       | 235/971 [00:06<00:20, 35.26it/s]backtest loop:  25%|██▍       | 240/971 [00:06<00:19, 37.13it/s]backtest loop:  25%|██▌       | 246/971 [00:06<00:17, 41.24it/s]backtest loop:  26%|██▌       | 252/971 [00:06<00:16, 44.73it/s]backtest loop:  27%|██▋       | 258/971 [00:06<00:15, 47.36it/s]backtest loop:  27%|██▋       | 264/971 [00:06<00:15, 46.46it/s]backtest loop:  28%|██▊       | 270/971 [00:07<00:14, 48.45it/s]backtest loop:  28%|██▊       | 276/971 [00:07<00:14, 47.00it/s]backtest loop:  29%|██▉       | 282/971 [00:07<00:14, 48.73it/s]backtest loop:  30%|██▉       | 287/971 [00:07<00:14, 46.53it/s]backtest loop:  30%|███       | 292/971 [00:07<00:14, 46.16it/s]backtest loop:  31%|███       | 297/971 [00:07<00:14, 45.16it/s]backtest loop:  31%|███       | 302/971 [00:07<00:15, 43.86it/s]backtest loop:  32%|███▏      | 307/971 [00:07<00:15, 43.05it/s]backtest loop:  32%|███▏      | 312/971 [00:08<00:15, 42.51it/s]backtest loop:  33%|███▎      | 317/971 [00:08<00:15, 41.96it/s]backtest loop:  33%|███▎      | 322/971 [00:08<00:15, 42.29it/s]backtest loop:  34%|███▎      | 327/971 [00:08<00:14, 43.14it/s]backtest loop:  34%|███▍      | 332/971 [00:08<00:14, 43.85it/s]backtest loop:  35%|███▍      | 337/971 [00:08<00:16, 37.67it/s]backtest loop:  35%|███▌      | 341/971 [00:08<00:17, 35.17it/s]backtest loop:  36%|███▌      | 346/971 [00:08<00:17, 36.62it/s]backtest loop:  36%|███▌      | 351/971 [00:09<00:15, 39.16it/s]backtest loop:  37%|███▋      | 356/971 [00:09<00:15, 38.68it/s]backtest loop:  37%|███▋      | 361/971 [00:09<00:15, 40.53it/s]backtest loop:  38%|███▊      | 366/971 [00:09<00:14, 41.91it/s]backtest loop:  38%|███▊      | 371/971 [00:09<00:14, 40.78it/s]backtest loop:  39%|███▊      | 376/971 [00:09<00:14, 41.25it/s]backtest loop:  39%|███▉      | 381/971 [00:09<00:13, 42.18it/s]backtest loop:  40%|███▉      | 386/971 [00:09<00:13, 43.55it/s]backtest loop:  40%|████      | 391/971 [00:10<00:13, 43.34it/s]backtest loop:  41%|████      | 396/971 [00:10<00:13, 44.00it/s]backtest loop:  41%|████▏     | 401/971 [00:10<00:12, 44.69it/s]backtest loop:  42%|████▏     | 406/971 [00:10<00:12, 43.57it/s]backtest loop:  42%|████▏     | 411/971 [00:10<00:12, 44.28it/s]backtest loop:  43%|████▎     | 417/971 [00:10<00:11, 47.31it/s]backtest loop:  44%|████▎     | 423/971 [00:10<00:11, 46.47it/s]backtest loop:  44%|████▍     | 429/971 [00:10<00:11, 48.74it/s]backtest loop:  45%|████▍     | 435/971 [00:10<00:10, 50.04it/s]backtest loop:  45%|████▌     | 441/971 [00:11<00:11, 47.16it/s]backtest loop:  46%|████▌     | 446/971 [00:11<00:11, 44.64it/s]backtest loop:  46%|████▋     | 451/971 [00:11<00:12, 41.59it/s]backtest loop:  47%|████▋     | 456/971 [00:11<00:12, 41.00it/s]backtest loop:  47%|████▋     | 461/971 [00:11<00:12, 41.40it/s]backtest loop:  48%|████▊     | 466/971 [00:11<00:12, 41.74it/s]backtest loop:  49%|████▊     | 471/971 [00:11<00:11, 42.21it/s]backtest loop:  49%|████▉     | 476/971 [00:11<00:11, 42.39it/s]backtest loop:  50%|████▉     | 481/971 [00:12<00:11, 42.26it/s]backtest loop:  50%|█████     | 486/971 [00:12<00:11, 42.39it/s]backtest loop:  51%|█████     | 491/971 [00:12<00:11, 40.03it/s]backtest loop:  51%|█████     | 496/971 [00:12<00:11, 40.78it/s]backtest loop:  52%|█████▏    | 501/971 [00:12<00:11, 41.74it/s]backtest loop:  52%|█████▏    | 506/971 [00:12<00:10, 42.35it/s]backtest loop:  53%|█████▎    | 511/971 [00:12<00:10, 42.02it/s]backtest loop:  53%|█████▎    | 516/971 [00:12<00:10, 42.13it/s]backtest loop:  54%|█████▎    | 521/971 [00:13<00:10, 42.13it/s]backtest loop:  54%|█████▍    | 526/971 [00:13<00:11, 39.94it/s]backtest loop:  55%|█████▍    | 531/971 [00:13<00:10, 41.53it/s]backtest loop:  55%|█████▌    | 536/971 [00:13<00:10, 42.50it/s]backtest loop:  56%|█████▌    | 541/971 [00:13<00:10, 42.60it/s]backtest loop:  56%|█████▌    | 546/971 [00:13<00:09, 42.87it/s]backtest loop:  57%|█████▋    | 551/971 [00:13<00:09, 43.24it/s]backtest loop:  57%|█████▋    | 556/971 [00:13<00:09, 43.65it/s]backtest loop:  58%|█████▊    | 561/971 [00:13<00:09, 43.84it/s]backtest loop:  58%|█████▊    | 566/971 [00:14<00:09, 43.48it/s]backtest loop:  59%|█████▉    | 571/971 [00:14<00:09, 44.05it/s]backtest loop:  59%|█████▉    | 576/971 [00:14<00:08, 44.03it/s]backtest loop:  60%|█████▉    | 581/971 [00:14<00:08, 44.20it/s]backtest loop:  60%|██████    | 586/971 [00:14<00:08, 43.66it/s]backtest loop:  61%|██████    | 591/971 [00:14<00:08, 43.43it/s]backtest loop:  61%|██████▏   | 596/971 [00:14<00:08, 41.99it/s]backtest loop:  62%|██████▏   | 601/971 [00:14<00:09, 39.56it/s]backtest loop:  62%|██████▏   | 605/971 [00:15<00:10, 35.88it/s]backtest loop:  63%|██████▎   | 610/971 [00:15<00:09, 37.58it/s]backtest loop:  63%|██████▎   | 615/971 [00:15<00:08, 39.66it/s]backtest loop:  64%|██████▍   | 620/971 [00:15<00:08, 41.14it/s]backtest loop:  64%|██████▍   | 625/971 [00:15<00:08, 42.44it/s]backtest loop:  65%|██████▍   | 630/971 [00:15<00:07, 43.10it/s]backtest loop:  65%|██████▌   | 635/971 [00:15<00:07, 43.47it/s]backtest loop:  66%|██████▌   | 640/971 [00:15<00:07, 43.46it/s]backtest loop:  66%|██████▋   | 645/971 [00:15<00:07, 44.40it/s]backtest loop:  67%|██████▋   | 650/971 [00:16<00:07, 44.08it/s]backtest loop:  67%|██████▋   | 655/971 [00:16<00:07, 44.69it/s]backtest loop:  68%|██████▊   | 660/971 [00:16<00:07, 44.15it/s]backtest loop:  68%|██████▊   | 665/971 [00:16<00:06, 44.18it/s]backtest loop:  69%|██████▉   | 670/971 [00:16<00:06, 44.14it/s]backtest loop:  70%|██████▉   | 675/971 [00:16<00:06, 43.80it/s]backtest loop:  70%|███████   | 680/971 [00:16<00:06, 43.74it/s]backtest loop:  71%|███████   | 685/971 [00:16<00:06, 43.50it/s]backtest loop:  71%|███████   | 691/971 [00:16<00:06, 46.31it/s]backtest loop:  72%|███████▏  | 697/971 [00:17<00:05, 48.48it/s]backtest loop:  72%|███████▏  | 703/971 [00:17<00:05, 50.06it/s]backtest loop:  73%|███████▎  | 709/971 [00:17<00:05, 47.85it/s]backtest loop:  74%|███████▎  | 715/971 [00:17<00:05, 49.65it/s]backtest loop:  74%|███████▍  | 721/971 [00:17<00:04, 50.58it/s]backtest loop:  75%|███████▍  | 727/971 [00:17<00:04, 50.89it/s]backtest loop:  75%|███████▌  | 733/971 [00:17<00:05, 43.03it/s]backtest loop:  76%|███████▌  | 738/971 [00:17<00:05, 43.68it/s]backtest loop:  77%|███████▋  | 743/971 [00:18<00:05, 43.92it/s]backtest loop:  77%|███████▋  | 748/971 [00:18<00:05, 44.43it/s]backtest loop:  78%|███████▊  | 753/971 [00:18<00:04, 44.84it/s]backtest loop:  78%|███████▊  | 758/971 [00:18<00:04, 44.39it/s]backtest loop:  79%|███████▊  | 763/971 [00:18<00:04, 44.91it/s]backtest loop:  79%|███████▉  | 768/971 [00:18<00:04, 44.97it/s]backtest loop:  80%|███████▉  | 773/971 [00:18<00:04, 44.55it/s]backtest loop:  80%|████████  | 778/971 [00:18<00:04, 45.42it/s]backtest loop:  81%|████████  | 783/971 [00:18<00:04, 43.16it/s]backtest loop:  81%|████████  | 788/971 [00:19<00:04, 42.22it/s]backtest loop:  82%|████████▏ | 793/971 [00:19<00:04, 41.40it/s]backtest loop:  82%|████████▏ | 798/971 [00:19<00:04, 41.50it/s]backtest loop:  83%|████████▎ | 803/971 [00:19<00:04, 41.64it/s]backtest loop:  83%|████████▎ | 808/971 [00:19<00:03, 41.78it/s]backtest loop:  84%|████████▎ | 813/971 [00:19<00:03, 42.19it/s]backtest loop:  84%|████████▍ | 818/971 [00:19<00:03, 42.47it/s]backtest loop:  85%|████████▍ | 823/971 [00:19<00:03, 42.21it/s]backtest loop:  85%|████████▌ | 828/971 [00:20<00:03, 41.67it/s]backtest loop:  86%|████████▌ | 833/971 [00:20<00:03, 41.33it/s]backtest loop:  86%|████████▋ | 838/971 [00:20<00:03, 41.22it/s]backtest loop:  87%|████████▋ | 843/971 [00:20<00:03, 41.34it/s]backtest loop:  87%|████████▋ | 848/971 [00:20<00:02, 43.12it/s]backtest loop:  88%|████████▊ | 854/971 [00:20<00:02, 46.14it/s]backtest loop:  89%|████████▊ | 860/971 [00:20<00:02, 48.58it/s]backtest loop:  89%|████████▉ | 866/971 [00:20<00:02, 50.28it/s]backtest loop:  90%|████████▉ | 872/971 [00:21<00:02, 48.05it/s]backtest loop:  90%|█████████ | 877/971 [00:21<00:02, 45.83it/s]backtest loop:  91%|█████████ | 882/971 [00:21<00:02, 43.88it/s]backtest loop:  91%|█████████▏| 887/971 [00:21<00:01, 43.41it/s]backtest loop:  92%|█████████▏| 892/971 [00:21<00:01, 43.35it/s]backtest loop:  92%|█████████▏| 897/971 [00:21<00:01, 43.61it/s]backtest loop:  93%|█████████▎| 902/971 [00:21<00:01, 43.48it/s]backtest loop:  93%|█████████▎| 907/971 [00:21<00:01, 43.03it/s]backtest loop:  94%|█████████▍| 912/971 [00:21<00:01, 43.40it/s]backtest loop:  94%|█████████▍| 917/971 [00:22<00:01, 43.79it/s]backtest loop:  95%|█████████▍| 922/971 [00:22<00:01, 44.29it/s]backtest loop:  95%|█████████▌| 927/971 [00:22<00:00, 44.38it/s]backtest loop:  96%|█████████▌| 932/971 [00:22<00:00, 44.29it/s]backtest loop:  96%|█████████▋| 937/971 [00:22<00:00, 44.45it/s]backtest loop:  97%|█████████▋| 942/971 [00:22<00:00, 44.65it/s]backtest loop:  98%|█████████▊| 947/971 [00:22<00:00, 45.12it/s]backtest loop:  98%|█████████▊| 952/971 [00:22<00:00, 44.84it/s]backtest loop:  99%|█████████▊| 957/971 [00:22<00:00, 45.15it/s]backtest loop:  99%|█████████▉| 962/971 [00:23<00:00, 44.89it/s]backtest loop: 100%|█████████▉| 967/971 [00:23<00:00, 44.62it/s]backtest loop: 100%|██████████| 971/971 [00:23<00:00, 41.74it/s]
[3265079:MainThread](2024-04-25 15:29:01,069) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000386
std                0.005280
annualized_return  0.091952
information_ratio  1.128947
max_drawdown      -0.076517
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000189
std                0.005280
annualized_return  0.044891
information_ratio  0.551146
max_drawdown      -0.085657
[3265079:MainThread](2024-04-25 15:29:01,086) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ADARNN_crowd_data_csi300_360_rankTrue`.
[3265079:MainThread](2024-04-25 15:29:10,495) INFO - qlib.timer - [log.py:127] - Time cost: 0.011s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.0085111448463081,
                                                    0.040133948309472374,
                                                    0.10316185137476734,
                                                    0.09323388904245221,
                                                    0.030137306084237318,
                                                    0.10531798942252292,
                                                    0.04489064065046932],
 '1day.excess_return_with_cost.information_ratio': [-0.10598626920625567,
                                                    0.5394907020639452,
                                                    1.363858333479228,
                                                    1.2467355553729704,
                                                    0.35745365993276573,
                                                    1.503015181777876,
                                                    0.5511464644466534],
 '1day.excess_return_with_cost.max_drawdown': [-0.20237780038364295,
                                               -0.07594003976516654,
                                               -0.08729842747498329,
                                               -0.08604753042288982,
                                               -0.09758207990055402,
                                               -0.07174431931335298,
                                               -0.08565671460392059],
 'IC': [0.0013536984392258171,
        0.026439898619729344,
        0.026902079345962383,
        0.02348331098236194,
        0.01327365027193708,
        0.027115639691058954,
        0.015768548135018903],
 'ICIR': [0.009181160161704657,
          0.21079803251917983,
          0.19837312520563208,
          0.18130028119321606,
          0.08768322408071108,
          0.225711831523885,
          0.12426388479425975],
 'Rank IC': [0.012407792581098361,
             0.03724272331287428,
             0.03587138551857936,
             0.03310470827646654,
             0.019693651797228897,
             0.031972516716016676,
             0.019646681310193474],
 'Rank ICIR': [0.08674177992422927,
               0.29319132408979226,
               0.27587741721675363,
               0.24465738515472754,
               0.12528583016367276,
               0.24856618846863654,
               0.14914286233002177],
 'mae': [0.8703869590122575,
         0.8647632230090078,
         0.864850520964454,
         0.8644913943487671,
         0.8657382494764543,
         0.8650519310588405,
         0.8653423118125829],
 'mse': [1.0176620582257514,
         1.0010798346127248,
         1.001276056691344,
         0.9992015764604559,
         1.0014523455546427,
         1.000771897485576,
         1.0004887467773014]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3265079:MainThread](2024-04-25 15:29:14,592) INFO - qlib.ADARNN - [pytorch_adarnn.py:63] - ADARNN pytorch version...
[3265079:MainThread](2024-04-25 15:29:14,593) INFO - qlib.ADARNN - [pytorch_adarnn.py:87] - ADARNN parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3265079:MainThread](2024-04-25 15:29:14,611) INFO - qlib.ADARNN - [pytorch_adarnn.py:136] - model:
AdaRNN(
  (features): Sequential(
    (0): GRU(6, 64, batch_first=True)
    (1): GRU(64, 64, batch_first=True)
  )
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
  (gate): ModuleList(
    (0): Linear(in_features=7680, out_features=60, bias=True)
    (1): Linear(in_features=7680, out_features=60, bias=True)
  )
  (bn_lst): ModuleList(
    (0): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (softmax): Softmax(dim=0)
)
[3265079:MainThread](2024-04-25 15:29:14,611) INFO - qlib.ADARNN - [pytorch_adarnn.py:137] - model size: 0.9163 MB
[3265079:MainThread](2024-04-25 15:29:18,131) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ADARNN_crowd_data_csi300_360_rankTrue_50.
[3265079:MainThread](2024-04-25 15:29:18,256) INFO - qlib.workflow - [exp.py:258] - Experiment 108 starts running ...
[3265079:MainThread](2024-04-25 15:29:18,275) INFO - qlib.workflow - [recorder.py:341] - Recorder f70c6eabcdd44de3854a898edf823ed2 starts running under Experiment 108 ...
[3265079:MainThread](2024-04-25 15:29:24,332) INFO - qlib.ADARNN - [pytorch_adarnn.py:266] - training...
[3265079:MainThread](2024-04-25 15:29:24,333) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch0:
[3265079:MainThread](2024-04-25 15:29:24,334) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:30:50,266) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:30:57,952) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.092534, icir/train: : 0.643185, ric/train: : 0.087423, ricir/train: : 0.613039, mse/train: : 0.009402, loss/train: : 0.009402
[3265079:MainThread](2024-04-25 15:30:57,953) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.039945, icir/valid: : 0.283055, ric/valid: : 0.036600, ricir/valid: : 0.258447, mse/valid: : 0.013703, loss/valid: : 0.013703
[3265079:MainThread](2024-04-25 15:30:57,955) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch1:
[3265079:MainThread](2024-04-25 15:30:57,956) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:32:27,348) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:32:35,240) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.078390, icir/train: : 0.565010, ric/train: : 0.076799, ricir/train: : 0.558004, mse/train: : 0.036679, loss/train: : 0.036679
[3265079:MainThread](2024-04-25 15:32:35,240) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.030641, icir/valid: : 0.229682, ric/valid: : 0.031944, ricir/valid: : 0.237236, mse/valid: : 0.035379, loss/valid: : 0.035379
[3265079:MainThread](2024-04-25 15:32:35,243) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch2:
[3265079:MainThread](2024-04-25 15:32:35,243) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:34:02,217) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:34:10,055) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.076443, icir/train: : 0.528165, ric/train: : 0.072458, ricir/train: : 0.505826, mse/train: : -0.035264, loss/train: : -0.035264
[3265079:MainThread](2024-04-25 15:34:10,055) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.032199, icir/valid: : 0.235507, ric/valid: : 0.030358, ricir/valid: : 0.224335, mse/valid: : -0.035836, loss/valid: : -0.035836
[3265079:MainThread](2024-04-25 15:34:10,055) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch3:
[3265079:MainThread](2024-04-25 15:34:10,056) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:35:41,954) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:35:49,733) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.063542, icir/train: : 0.483501, ric/train: : 0.061347, ricir/train: : 0.471784, mse/train: : -0.005575, loss/train: : -0.005575
[3265079:MainThread](2024-04-25 15:35:49,734) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.020507, icir/valid: : 0.167559, ric/valid: : 0.018389, ricir/valid: : 0.150891, mse/valid: : -0.003476, loss/valid: : -0.003476
[3265079:MainThread](2024-04-25 15:35:49,734) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch4:
[3265079:MainThread](2024-04-25 15:35:49,734) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:37:14,882) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:37:22,261) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.075145, icir/train: : 0.559662, ric/train: : 0.072162, ricir/train: : 0.537407, mse/train: : -0.065575, loss/train: : -0.065575
[3265079:MainThread](2024-04-25 15:37:22,261) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.031539, icir/valid: : 0.260354, ric/valid: : 0.030540, ricir/valid: : 0.251232, mse/valid: : -0.060129, loss/valid: : -0.060129
[3265079:MainThread](2024-04-25 15:37:22,261) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch5:
[3265079:MainThread](2024-04-25 15:37:22,262) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:38:30,268) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:38:37,588) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.073176, icir/train: : 0.559923, ric/train: : 0.071419, ricir/train: : 0.552618, mse/train: : -0.025035, loss/train: : -0.025035
[3265079:MainThread](2024-04-25 15:38:37,588) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.030992, icir/valid: : 0.233077, ric/valid: : 0.029826, ricir/valid: : 0.227342, mse/valid: : -0.014862, loss/valid: : -0.014862
[3265079:MainThread](2024-04-25 15:38:37,588) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch6:
[3265079:MainThread](2024-04-25 15:38:37,589) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:39:57,922) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:40:06,622) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.089085, icir/train: : 0.651892, ric/train: : 0.087058, ricir/train: : 0.640961, mse/train: : -0.029304, loss/train: : -0.029304
[3265079:MainThread](2024-04-25 15:40:06,623) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.034679, icir/valid: : 0.274385, ric/valid: : 0.035747, ricir/valid: : 0.280362, mse/valid: : -0.030669, loss/valid: : -0.030669
[3265079:MainThread](2024-04-25 15:40:06,623) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch7:
[3265079:MainThread](2024-04-25 15:40:06,623) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:41:32,866) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:41:41,139) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.078993, icir/train: : 0.624690, ric/train: : 0.077189, ricir/train: : 0.614193, mse/train: : 0.016249, loss/train: : 0.016249
[3265079:MainThread](2024-04-25 15:41:41,140) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.037951, icir/valid: : 0.320428, ric/valid: : 0.038084, ricir/valid: : 0.325055, mse/valid: : 0.020015, loss/valid: : 0.020015
[3265079:MainThread](2024-04-25 15:41:41,140) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch8:
[3265079:MainThread](2024-04-25 15:41:41,140) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:43:06,337) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:43:14,640) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.087236, icir/train: : 0.683660, ric/train: : 0.084902, ricir/train: : 0.668107, mse/train: : 0.005277, loss/train: : 0.005277
[3265079:MainThread](2024-04-25 15:43:14,640) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.033406, icir/valid: : 0.278180, ric/valid: : 0.033027, ricir/valid: : 0.275967, mse/valid: : 0.006098, loss/valid: : 0.006098
[3265079:MainThread](2024-04-25 15:43:14,641) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch9:
[3265079:MainThread](2024-04-25 15:43:14,641) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:44:41,707) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:44:49,748) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.091967, icir/train: : 0.755808, ric/train: : 0.089553, ricir/train: : 0.742328, mse/train: : -0.002705, loss/train: : -0.002705
[3265079:MainThread](2024-04-25 15:44:49,749) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.037420, icir/valid: : 0.313436, ric/valid: : 0.037607, ricir/valid: : 0.319415, mse/valid: : -0.002148, loss/valid: : -0.002148
[3265079:MainThread](2024-04-25 15:44:49,749) INFO - qlib.ADARNN - [pytorch_adarnn.py:294] - early stop
[3265079:MainThread](2024-04-25 15:44:49,750) INFO - qlib.ADARNN - [pytorch_adarnn.py:297] - best score: 0.035379 @ 1
[3265079:MainThread](2024-04-25 15:44:49,881) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ADARNN_crowd_data_csi300_360_rankTrue_50.
[3265079:MainThread](2024-04-25 15:44:50,242) INFO - qlib.workflow - [exp.py:258] - Experiment 101 starts running ...
[3265079:MainThread](2024-04-25 15:44:50,263) INFO - qlib.workflow - [recorder.py:341] - Recorder ce1da7029ba34d0fbc4959e1ea8823ad starts running under Experiment 101 ...
{'IC': 0.01883505612201559,
 'ICIR': 0.13086282123412246,
 'Rank IC': 0.020376577977809333,
 'Rank ICIR': 0.13693739622958964}
[3265079:MainThread](2024-04-25 15:44:58,512) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3265079:MainThread](2024-04-25 15:45:43,471) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 15:45:43,475) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 15:45:49,852) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f891b3f2d00>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<03:00,  5.37it/s]backtest loop:   1%|          | 8/971 [00:00<01:07, 14.34it/s]backtest loop:   1%|▏         | 14/971 [00:00<00:40, 23.86it/s]backtest loop:   2%|▏         | 19/971 [00:00<00:32, 29.72it/s]backtest loop:   2%|▏         | 24/971 [00:01<00:28, 32.81it/s]backtest loop:   3%|▎         | 29/971 [00:01<00:25, 36.96it/s]backtest loop:   4%|▎         | 34/971 [00:01<00:23, 40.22it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:22, 42.26it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:20, 45.56it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:19, 47.81it/s]backtest loop:   6%|▌         | 56/971 [00:01<00:19, 46.44it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:19, 46.04it/s]backtest loop:   7%|▋         | 66/971 [00:01<00:19, 46.04it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:19, 47.06it/s]backtest loop:   8%|▊         | 76/971 [00:02<00:18, 47.69it/s]backtest loop:   8%|▊         | 82/971 [00:02<00:19, 46.54it/s]backtest loop:   9%|▉         | 88/971 [00:02<00:18, 48.38it/s]backtest loop:  10%|▉         | 94/971 [00:02<00:17, 49.83it/s]backtest loop:  10%|█         | 100/971 [00:02<00:17, 50.57it/s]backtest loop:  11%|█         | 106/971 [00:02<00:16, 51.63it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:17, 49.49it/s]backtest loop:  12%|█▏        | 118/971 [00:02<00:16, 50.67it/s]backtest loop:  13%|█▎        | 124/971 [00:03<00:16, 51.53it/s]backtest loop:  13%|█▎        | 130/971 [00:03<00:17, 49.10it/s]backtest loop:  14%|█▍        | 136/971 [00:03<00:17, 47.72it/s]backtest loop:  15%|█▍        | 142/971 [00:03<00:16, 49.85it/s]backtest loop:  15%|█▌        | 148/971 [00:03<00:16, 50.71it/s]backtest loop:  16%|█▌        | 154/971 [00:03<00:15, 51.40it/s]backtest loop:  16%|█▋        | 160/971 [00:03<00:15, 52.34it/s]backtest loop:  17%|█▋        | 166/971 [00:04<00:26, 30.04it/s]backtest loop:  18%|█▊        | 172/971 [00:04<00:22, 34.87it/s]backtest loop:  18%|█▊        | 178/971 [00:04<00:20, 39.20it/s]backtest loop:  19%|█▉        | 184/971 [00:04<00:18, 42.94it/s]backtest loop:  20%|█▉        | 190/971 [00:04<00:17, 43.97it/s]backtest loop:  20%|██        | 196/971 [00:04<00:16, 46.79it/s]backtest loop:  21%|██        | 202/971 [00:04<00:15, 48.45it/s]backtest loop:  21%|██▏       | 208/971 [00:04<00:15, 50.44it/s]backtest loop:  22%|██▏       | 214/971 [00:05<00:15, 49.36it/s]backtest loop:  23%|██▎       | 220/971 [00:05<00:15, 48.30it/s]backtest loop:  23%|██▎       | 225/971 [00:05<00:17, 43.19it/s]backtest loop:  24%|██▎       | 230/971 [00:05<00:17, 42.26it/s]backtest loop:  24%|██▍       | 235/971 [00:05<00:17, 42.74it/s]backtest loop:  25%|██▍       | 241/971 [00:05<00:15, 47.13it/s]backtest loop:  25%|██▌       | 247/971 [00:05<00:14, 50.51it/s]backtest loop:  26%|██▌       | 253/971 [00:05<00:13, 52.47it/s]backtest loop:  27%|██▋       | 259/971 [00:05<00:14, 50.70it/s]backtest loop:  27%|██▋       | 266/971 [00:06<00:13, 51.08it/s]backtest loop:  28%|██▊       | 272/971 [00:06<00:15, 43.83it/s]backtest loop:  29%|██▊       | 277/971 [00:06<00:16, 43.15it/s]backtest loop:  29%|██▉       | 283/971 [00:06<00:15, 45.66it/s]backtest loop:  30%|██▉       | 289/971 [00:06<00:14, 47.92it/s]backtest loop:  30%|███       | 295/971 [00:06<00:14, 47.26it/s]backtest loop:  31%|███       | 301/971 [00:06<00:13, 49.11it/s]backtest loop:  32%|███▏      | 307/971 [00:07<00:13, 50.25it/s]backtest loop:  32%|███▏      | 313/971 [00:07<00:12, 51.02it/s]backtest loop:  33%|███▎      | 319/971 [00:07<00:12, 51.92it/s]backtest loop:  33%|███▎      | 325/971 [00:07<00:13, 49.40it/s]backtest loop:  34%|███▍      | 331/971 [00:07<00:12, 50.88it/s]backtest loop:  35%|███▍      | 337/971 [00:07<00:12, 51.38it/s]backtest loop:  35%|███▌      | 343/971 [00:07<00:13, 48.13it/s]backtest loop:  36%|███▌      | 349/971 [00:07<00:12, 50.53it/s]backtest loop:  37%|███▋      | 355/971 [00:07<00:12, 49.01it/s]backtest loop:  37%|███▋      | 361/971 [00:08<00:12, 50.60it/s]backtest loop:  38%|███▊      | 367/971 [00:08<00:12, 48.07it/s]backtest loop:  38%|███▊      | 372/971 [00:08<00:12, 48.22it/s]backtest loop:  39%|███▉      | 378/971 [00:08<00:12, 46.96it/s]backtest loop:  40%|███▉      | 384/971 [00:08<00:11, 49.46it/s]backtest loop:  40%|████      | 390/971 [00:08<00:11, 51.37it/s]backtest loop:  41%|████      | 396/971 [00:08<00:10, 52.62it/s]backtest loop:  41%|████▏     | 402/971 [00:08<00:11, 49.48it/s]backtest loop:  42%|████▏     | 408/971 [00:09<00:11, 48.40it/s]backtest loop:  43%|████▎     | 414/971 [00:09<00:11, 50.34it/s]backtest loop:  43%|████▎     | 420/971 [00:09<00:10, 51.46it/s]backtest loop:  44%|████▍     | 426/971 [00:09<00:10, 51.97it/s]backtest loop:  44%|████▍     | 432/971 [00:09<00:11, 48.60it/s]backtest loop:  45%|████▌     | 438/971 [00:09<00:10, 49.74it/s]backtest loop:  46%|████▌     | 444/971 [00:09<00:10, 50.91it/s]backtest loop:  46%|████▋     | 450/971 [00:09<00:10, 51.18it/s]backtest loop:  47%|████▋     | 457/971 [00:10<00:09, 51.42it/s]backtest loop:  48%|████▊     | 463/971 [00:10<00:09, 53.46it/s]backtest loop:  48%|████▊     | 470/971 [00:10<00:08, 56.05it/s]backtest loop:  49%|████▉     | 477/971 [00:10<00:09, 54.64it/s]backtest loop:  50%|████▉     | 483/971 [00:10<00:08, 54.31it/s]backtest loop:  50%|█████     | 489/971 [00:10<00:08, 53.71it/s]backtest loop:  51%|█████     | 495/971 [00:10<00:09, 49.74it/s]backtest loop:  52%|█████▏    | 501/971 [00:10<00:09, 50.27it/s]backtest loop:  52%|█████▏    | 507/971 [00:10<00:09, 48.58it/s]backtest loop:  53%|█████▎    | 513/971 [00:11<00:09, 49.82it/s]backtest loop:  53%|█████▎    | 519/971 [00:11<00:09, 49.95it/s]backtest loop:  54%|█████▍    | 525/971 [00:11<00:08, 49.61it/s]backtest loop:  55%|█████▍    | 530/971 [00:11<00:08, 49.11it/s]backtest loop:  55%|█████▌    | 535/971 [00:11<00:08, 48.72it/s]backtest loop:  56%|█████▌    | 540/971 [00:11<00:08, 48.19it/s]backtest loop:  56%|█████▌    | 545/971 [00:11<00:08, 48.10it/s]backtest loop:  57%|█████▋    | 550/971 [00:11<00:08, 47.97it/s]backtest loop:  57%|█████▋    | 555/971 [00:11<00:08, 47.70it/s]backtest loop:  58%|█████▊    | 561/971 [00:12<00:08, 46.07it/s]backtest loop:  58%|█████▊    | 566/971 [00:12<00:08, 46.65it/s]backtest loop:  59%|█████▉    | 571/971 [00:12<00:08, 47.12it/s]backtest loop:  59%|█████▉    | 576/971 [00:12<00:08, 47.61it/s]backtest loop:  60%|█████▉    | 581/971 [00:12<00:08, 48.11it/s]backtest loop:  60%|██████    | 587/971 [00:12<00:07, 49.56it/s]backtest loop:  61%|██████    | 592/971 [00:12<00:07, 49.56it/s]backtest loop:  61%|██████▏   | 597/971 [00:12<00:07, 49.54it/s]backtest loop:  62%|██████▏   | 602/971 [00:12<00:07, 49.41it/s]backtest loop:  63%|██████▎   | 607/971 [00:13<00:07, 48.88it/s]backtest loop:  63%|██████▎   | 612/971 [00:13<00:07, 49.02it/s]backtest loop:  64%|██████▎   | 618/971 [00:13<00:07, 50.09it/s]backtest loop:  64%|██████▍   | 624/971 [00:13<00:06, 51.49it/s]backtest loop:  65%|██████▍   | 630/971 [00:13<00:06, 48.97it/s]backtest loop:  65%|██████▌   | 636/971 [00:13<00:06, 50.31it/s]backtest loop:  66%|██████▌   | 642/971 [00:13<00:06, 50.98it/s]backtest loop:  67%|██████▋   | 648/971 [00:13<00:06, 51.26it/s]backtest loop:  67%|██████▋   | 654/971 [00:13<00:06, 51.90it/s]backtest loop:  68%|██████▊   | 660/971 [00:14<00:06, 49.39it/s]backtest loop:  69%|██████▊   | 666/971 [00:14<00:06, 50.42it/s]backtest loop:  69%|██████▉   | 672/971 [00:14<00:05, 51.00it/s]backtest loop:  70%|██████▉   | 678/971 [00:14<00:05, 51.63it/s]backtest loop:  70%|███████   | 684/971 [00:14<00:05, 48.71it/s]backtest loop:  71%|███████   | 689/971 [00:14<00:05, 49.04it/s]backtest loop:  72%|███████▏  | 695/971 [00:14<00:05, 50.20it/s]backtest loop:  72%|███████▏  | 701/971 [00:14<00:05, 50.94it/s]backtest loop:  73%|███████▎  | 707/971 [00:15<00:05, 51.35it/s]backtest loop:  73%|███████▎  | 713/971 [00:15<00:04, 51.75it/s]backtest loop:  74%|███████▍  | 719/971 [00:15<00:05, 49.35it/s]backtest loop:  75%|███████▍  | 725/971 [00:15<00:04, 50.78it/s]backtest loop:  75%|███████▌  | 731/971 [00:15<00:05, 47.95it/s]backtest loop:  76%|███████▌  | 737/971 [00:15<00:04, 49.73it/s]backtest loop:  77%|███████▋  | 743/971 [00:15<00:04, 47.75it/s]backtest loop:  77%|███████▋  | 749/971 [00:15<00:04, 49.50it/s]backtest loop:  78%|███████▊  | 755/971 [00:15<00:04, 48.06it/s]backtest loop:  78%|███████▊  | 761/971 [00:16<00:04, 49.66it/s]backtest loop:  79%|███████▉  | 767/971 [00:16<00:04, 50.78it/s]backtest loop:  80%|███████▉  | 773/971 [00:16<00:03, 52.03it/s]backtest loop:  80%|████████  | 779/971 [00:16<00:03, 52.74it/s]backtest loop:  81%|████████  | 785/971 [00:16<00:03, 49.87it/s]backtest loop:  81%|████████▏ | 791/971 [00:16<00:03, 52.03it/s]backtest loop:  82%|████████▏ | 797/971 [00:16<00:03, 54.15it/s]backtest loop:  83%|████████▎ | 803/971 [00:16<00:03, 52.44it/s]backtest loop:  83%|████████▎ | 809/971 [00:17<00:02, 54.46it/s]backtest loop:  84%|████████▍ | 815/971 [00:17<00:02, 55.88it/s]backtest loop:  85%|████████▍ | 821/971 [00:17<00:02, 56.98it/s]backtest loop:  85%|████████▌ | 827/971 [00:17<00:02, 57.65it/s]backtest loop:  86%|████████▌ | 833/971 [00:17<00:02, 54.66it/s]backtest loop:  86%|████████▋ | 839/971 [00:17<00:02, 54.95it/s]backtest loop:  87%|████████▋ | 845/971 [00:17<00:02, 54.88it/s]backtest loop:  88%|████████▊ | 851/971 [00:17<00:02, 55.13it/s]backtest loop:  88%|████████▊ | 857/971 [00:17<00:02, 51.33it/s]backtest loop:  89%|████████▉ | 863/971 [00:18<00:02, 51.67it/s]backtest loop:  89%|████████▉ | 869/971 [00:18<00:01, 51.58it/s]backtest loop:  90%|█████████ | 875/971 [00:18<00:01, 51.66it/s]backtest loop:  91%|█████████ | 881/971 [00:18<00:01, 51.36it/s]backtest loop:  91%|█████████▏| 887/971 [00:18<00:01, 47.35it/s]backtest loop:  92%|█████████▏| 892/971 [00:18<00:01, 47.94it/s]backtest loop:  92%|█████████▏| 897/971 [00:18<00:01, 47.89it/s]backtest loop:  93%|█████████▎| 902/971 [00:18<00:01, 48.46it/s]backtest loop:  93%|█████████▎| 907/971 [00:18<00:01, 48.53it/s]backtest loop:  94%|█████████▍| 912/971 [00:19<00:01, 48.80it/s]backtest loop:  94%|█████████▍| 917/971 [00:19<00:01, 48.70it/s]backtest loop:  95%|█████████▌| 923/971 [00:19<00:00, 50.29it/s]backtest loop:  96%|█████████▌| 929/971 [00:19<00:00, 51.13it/s]backtest loop:  96%|█████████▋| 935/971 [00:19<00:00, 51.52it/s]backtest loop:  97%|█████████▋| 941/971 [00:19<00:00, 48.78it/s]backtest loop:  98%|█████████▊| 947/971 [00:19<00:00, 49.81it/s]backtest loop:  98%|█████████▊| 953/971 [00:19<00:00, 50.87it/s]backtest loop:  99%|█████████▉| 959/971 [00:19<00:00, 51.57it/s]backtest loop:  99%|█████████▉| 965/971 [00:20<00:00, 49.16it/s]backtest loop: 100%|██████████| 971/971 [00:20<00:00, 50.72it/s]backtest loop: 100%|██████████| 971/971 [00:20<00:00, 48.13it/s]
[3265079:MainThread](2024-04-25 15:46:10,101) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000292
std                0.006018
annualized_return  0.069492
information_ratio  0.748533
max_drawdown      -0.162542
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000092
std                0.006018
annualized_return  0.021862
information_ratio  0.235480
max_drawdown      -0.223707
[3265079:MainThread](2024-04-25 15:46:10,115) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ADARNN_crowd_data_csi300_360_rankTrue`.
[3265079:MainThread](2024-04-25 15:46:17,925) INFO - qlib.timer - [log.py:127] - Time cost: 0.004s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.0085111448463081,
                                                    0.040133948309472374,
                                                    0.10316185137476734,
                                                    0.09323388904245221,
                                                    0.030137306084237318,
                                                    0.10531798942252292,
                                                    0.04489064065046932,
                                                    0.02186206071003745],
 '1day.excess_return_with_cost.information_ratio': [-0.10598626920625567,
                                                    0.5394907020639452,
                                                    1.363858333479228,
                                                    1.2467355553729704,
                                                    0.35745365993276573,
                                                    1.503015181777876,
                                                    0.5511464644466534,
                                                    0.2354803607086786],
 '1day.excess_return_with_cost.max_drawdown': [-0.20237780038364295,
                                               -0.07594003976516654,
                                               -0.08729842747498329,
                                               -0.08604753042288982,
                                               -0.09758207990055402,
                                               -0.07174431931335298,
                                               -0.08565671460392059,
                                               -0.22370700397902749],
 'IC': [0.0013536984392258171,
        0.026439898619729344,
        0.026902079345962383,
        0.02348331098236194,
        0.01327365027193708,
        0.027115639691058954,
        0.015768548135018903,
        0.01883505612201559],
 'ICIR': [0.009181160161704657,
          0.21079803251917983,
          0.19837312520563208,
          0.18130028119321606,
          0.08768322408071108,
          0.225711831523885,
          0.12426388479425975,
          0.13086282123412246],
 'Rank IC': [0.012407792581098361,
             0.03724272331287428,
             0.03587138551857936,
             0.03310470827646654,
             0.019693651797228897,
             0.031972516716016676,
             0.019646681310193474,
             0.020376577977809333],
 'Rank ICIR': [0.08674177992422927,
               0.29319132408979226,
               0.27587741721675363,
               0.24465738515472754,
               0.12528583016367276,
               0.24856618846863654,
               0.14914286233002177,
               0.13693739622958964],
 'mae': [0.8703869590122575,
         0.8647632230090078,
         0.864850520964454,
         0.8644913943487671,
         0.8657382494764543,
         0.8650519310588405,
         0.8653423118125829,
         0.8659474014567119],
 'mse': [1.0176620582257514,
         1.0010798346127248,
         1.001276056691344,
         0.9992015764604559,
         1.0014523455546427,
         1.000771897485576,
         1.0004887467773014,
         1.0050382379836018]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3265079:MainThread](2024-04-25 15:46:21,778) INFO - qlib.ADARNN - [pytorch_adarnn.py:63] - ADARNN pytorch version...
[3265079:MainThread](2024-04-25 15:46:21,779) INFO - qlib.ADARNN - [pytorch_adarnn.py:87] - ADARNN parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3265079:MainThread](2024-04-25 15:46:21,795) INFO - qlib.ADARNN - [pytorch_adarnn.py:136] - model:
AdaRNN(
  (features): Sequential(
    (0): GRU(6, 64, batch_first=True)
    (1): GRU(64, 64, batch_first=True)
  )
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
  (gate): ModuleList(
    (0): Linear(in_features=7680, out_features=60, bias=True)
    (1): Linear(in_features=7680, out_features=60, bias=True)
  )
  (bn_lst): ModuleList(
    (0): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (softmax): Softmax(dim=0)
)
[3265079:MainThread](2024-04-25 15:46:21,796) INFO - qlib.ADARNN - [pytorch_adarnn.py:137] - model size: 0.9163 MB
[3265079:MainThread](2024-04-25 15:46:25,213) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ADARNN_crowd_data_csi300_360_rankTrue_51.
[3265079:MainThread](2024-04-25 15:46:25,340) INFO - qlib.workflow - [exp.py:258] - Experiment 109 starts running ...
[3265079:MainThread](2024-04-25 15:46:25,365) INFO - qlib.workflow - [recorder.py:341] - Recorder 6b2bf30d79e644a69dc04e7074eec75b starts running under Experiment 109 ...
[3265079:MainThread](2024-04-25 15:46:30,908) INFO - qlib.ADARNN - [pytorch_adarnn.py:266] - training...
[3265079:MainThread](2024-04-25 15:46:30,909) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch0:
[3265079:MainThread](2024-04-25 15:46:30,910) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:47:52,288) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:48:00,021) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.099137, icir/train: : 0.718677, ric/train: : 0.094512, ricir/train: : 0.688175, mse/train: : 0.007088, loss/train: : 0.007088
[3265079:MainThread](2024-04-25 15:48:00,022) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.040071, icir/valid: : 0.287875, ric/valid: : 0.035261, ricir/valid: : 0.253560, mse/valid: : 0.019238, loss/valid: : 0.019238
[3265079:MainThread](2024-04-25 15:48:00,025) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch1:
[3265079:MainThread](2024-04-25 15:48:00,025) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:49:24,063) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:49:33,018) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.103945, icir/train: : 0.806535, ric/train: : 0.099812, ricir/train: : 0.779327, mse/train: : -0.001681, loss/train: : -0.001681
[3265079:MainThread](2024-04-25 15:49:33,019) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.041118, icir/valid: : 0.308668, ric/valid: : 0.039308, ricir/valid: : 0.299006, mse/valid: : 0.002586, loss/valid: : 0.002586
[3265079:MainThread](2024-04-25 15:49:33,019) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch2:
[3265079:MainThread](2024-04-25 15:49:33,020) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:51:02,684) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:51:11,045) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.116460, icir/train: : 0.881596, ric/train: : 0.111435, ricir/train: : 0.845344, mse/train: : 0.007902, loss/train: : 0.007902
[3265079:MainThread](2024-04-25 15:51:11,046) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.048814, icir/valid: : 0.353126, ric/valid: : 0.045814, ricir/valid: : 0.335476, mse/valid: : 0.015285, loss/valid: : 0.015285
[3265079:MainThread](2024-04-25 15:51:11,047) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch3:
[3265079:MainThread](2024-04-25 15:51:11,047) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:52:45,429) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:52:53,558) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.085803, icir/train: : 0.600775, ric/train: : 0.081775, ricir/train: : 0.583700, mse/train: : 0.010583, loss/train: : 0.010583
[3265079:MainThread](2024-04-25 15:52:53,559) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.033377, icir/valid: : 0.244822, ric/valid: : 0.031948, ricir/valid: : 0.236513, mse/valid: : 0.009102, loss/valid: : 0.009102
[3265079:MainThread](2024-04-25 15:52:53,559) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch4:
[3265079:MainThread](2024-04-25 15:52:53,559) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:54:20,912) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:54:29,255) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.059157, icir/train: : 0.403855, ric/train: : 0.056792, ricir/train: : 0.383771, mse/train: : -0.003014, loss/train: : -0.003014
[3265079:MainThread](2024-04-25 15:54:29,256) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.022328, icir/valid: : 0.162292, ric/valid: : 0.023275, ricir/valid: : 0.167129, mse/valid: : -0.006609, loss/valid: : -0.006609
[3265079:MainThread](2024-04-25 15:54:29,256) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch5:
[3265079:MainThread](2024-04-25 15:54:29,257) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:55:55,170) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:56:02,820) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.069045, icir/train: : 0.456697, ric/train: : 0.066685, ricir/train: : 0.444728, mse/train: : 0.028292, loss/train: : 0.028292
[3265079:MainThread](2024-04-25 15:56:02,820) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.025178, icir/valid: : 0.180089, ric/valid: : 0.024448, ricir/valid: : 0.177532, mse/valid: : 0.023097, loss/valid: : 0.023097
[3265079:MainThread](2024-04-25 15:56:02,822) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch6:
[3265079:MainThread](2024-04-25 15:56:02,823) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:57:28,599) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:57:36,713) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.077554, icir/train: : 0.536625, ric/train: : 0.074460, ricir/train: : 0.525702, mse/train: : 0.030664, loss/train: : 0.030664
[3265079:MainThread](2024-04-25 15:57:36,714) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.029265, icir/valid: : 0.218453, ric/valid: : 0.027843, ricir/valid: : 0.213593, mse/valid: : 0.029473, loss/valid: : 0.029473
[3265079:MainThread](2024-04-25 15:57:36,716) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch7:
[3265079:MainThread](2024-04-25 15:57:36,717) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 15:58:50,097) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 15:58:57,424) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.082659, icir/train: : 0.573613, ric/train: : 0.079777, ricir/train: : 0.558211, mse/train: : 0.031662, loss/train: : 0.031662
[3265079:MainThread](2024-04-25 15:58:57,425) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.036014, icir/valid: : 0.258521, ric/valid: : 0.035435, ricir/valid: : 0.256715, mse/valid: : 0.030753, loss/valid: : 0.030753
[3265079:MainThread](2024-04-25 15:58:57,427) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch8:
[3265079:MainThread](2024-04-25 15:58:57,427) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:00:07,055) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:00:14,583) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.085839, icir/train: : 0.640436, ric/train: : 0.082206, ricir/train: : 0.624509, mse/train: : 0.020699, loss/train: : 0.020699
[3265079:MainThread](2024-04-25 16:00:14,584) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.037859, icir/valid: : 0.296762, ric/valid: : 0.035326, ricir/valid: : 0.279109, mse/valid: : 0.025907, loss/valid: : 0.025907
[3265079:MainThread](2024-04-25 16:00:14,584) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch9:
[3265079:MainThread](2024-04-25 16:00:14,585) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:01:44,684) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:01:52,479) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.093187, icir/train: : 0.692041, ric/train: : 0.089038, ricir/train: : 0.668775, mse/train: : -0.003080, loss/train: : -0.003080
[3265079:MainThread](2024-04-25 16:01:52,479) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.041271, icir/valid: : 0.307182, ric/valid: : 0.038265, ricir/valid: : 0.284869, mse/valid: : -0.001866, loss/valid: : -0.001866
[3265079:MainThread](2024-04-25 16:01:52,480) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch10:
[3265079:MainThread](2024-04-25 16:01:52,480) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:03:17,050) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:03:24,620) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.090972, icir/train: : 0.708640, ric/train: : 0.087083, ricir/train: : 0.689362, mse/train: : 0.005562, loss/train: : 0.005562
[3265079:MainThread](2024-04-25 16:03:24,620) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.043112, icir/valid: : 0.320587, ric/valid: : 0.040471, ricir/valid: : 0.304486, mse/valid: : 0.013746, loss/valid: : 0.013746
[3265079:MainThread](2024-04-25 16:03:24,620) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch11:
[3265079:MainThread](2024-04-25 16:03:24,621) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:04:47,600) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:04:55,581) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.093620, icir/train: : 0.726833, ric/train: : 0.090555, ricir/train: : 0.704489, mse/train: : 0.032132, loss/train: : 0.032132
[3265079:MainThread](2024-04-25 16:04:55,582) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.037257, icir/valid: : 0.280452, ric/valid: : 0.035588, ricir/valid: : 0.267700, mse/valid: : 0.042710, loss/valid: : 0.042710
[3265079:MainThread](2024-04-25 16:04:55,584) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch12:
[3265079:MainThread](2024-04-25 16:04:55,584) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:06:17,015) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:06:24,628) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.093223, icir/train: : 0.756756, ric/train: : 0.090090, ricir/train: : 0.726860, mse/train: : -0.016042, loss/train: : -0.016042
[3265079:MainThread](2024-04-25 16:06:24,628) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.042748, icir/valid: : 0.335435, ric/valid: : 0.040790, ricir/valid: : 0.323047, mse/valid: : -0.004572, loss/valid: : -0.004572
[3265079:MainThread](2024-04-25 16:06:24,629) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch13:
[3265079:MainThread](2024-04-25 16:06:24,629) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:07:50,290) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:07:58,047) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.097146, icir/train: : 0.785980, ric/train: : 0.093832, ricir/train: : 0.761136, mse/train: : -0.005773, loss/train: : -0.005773
[3265079:MainThread](2024-04-25 16:07:58,047) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.042229, icir/valid: : 0.325892, ric/valid: : 0.038951, ricir/valid: : 0.301142, mse/valid: : 0.003187, loss/valid: : 0.003187
[3265079:MainThread](2024-04-25 16:07:58,048) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch14:
[3265079:MainThread](2024-04-25 16:07:58,048) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:09:24,274) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:09:32,723) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.097243, icir/train: : 0.781882, ric/train: : 0.092945, ricir/train: : 0.743978, mse/train: : -0.023827, loss/train: : -0.023827
[3265079:MainThread](2024-04-25 16:09:32,724) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.039653, icir/valid: : 0.310326, ric/valid: : 0.036986, ricir/valid: : 0.285351, mse/valid: : -0.019197, loss/valid: : -0.019197
[3265079:MainThread](2024-04-25 16:09:32,724) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch15:
[3265079:MainThread](2024-04-25 16:09:32,724) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:10:55,142) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:11:03,090) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.102591, icir/train: : 0.834113, ric/train: : 0.098336, ricir/train: : 0.795353, mse/train: : 0.024838, loss/train: : 0.024838
[3265079:MainThread](2024-04-25 16:11:03,091) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.045315, icir/valid: : 0.365813, ric/valid: : 0.043400, ricir/valid: : 0.349910, mse/valid: : 0.033851, loss/valid: : 0.033851
[3265079:MainThread](2024-04-25 16:11:03,091) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch16:
[3265079:MainThread](2024-04-25 16:11:03,092) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:12:27,879) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:12:35,762) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.100228, icir/train: : 0.822621, ric/train: : 0.095555, ricir/train: : 0.784941, mse/train: : 0.059406, loss/train: : 0.059406
[3265079:MainThread](2024-04-25 16:12:35,762) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.046189, icir/valid: : 0.373385, ric/valid: : 0.043634, ricir/valid: : 0.352821, mse/valid: : 0.067448, loss/valid: : 0.067448
[3265079:MainThread](2024-04-25 16:12:35,765) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch17:
[3265079:MainThread](2024-04-25 16:12:35,765) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:14:01,039) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:14:08,908) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.101798, icir/train: : 0.839795, ric/train: : 0.097903, ricir/train: : 0.806841, mse/train: : 0.030544, loss/train: : 0.030544
[3265079:MainThread](2024-04-25 16:14:08,909) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.050349, icir/valid: : 0.403150, ric/valid: : 0.046075, ricir/valid: : 0.368512, mse/valid: : 0.041972, loss/valid: : 0.041972
[3265079:MainThread](2024-04-25 16:14:08,909) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch18:
[3265079:MainThread](2024-04-25 16:14:08,909) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:15:37,343) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:15:45,009) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.097579, icir/train: : 0.766838, ric/train: : 0.092563, ricir/train: : 0.728835, mse/train: : -0.003674, loss/train: : -0.003674
[3265079:MainThread](2024-04-25 16:15:45,009) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.046801, icir/valid: : 0.348335, ric/valid: : 0.044166, ricir/valid: : 0.331073, mse/valid: : 0.001234, loss/valid: : 0.001234
[3265079:MainThread](2024-04-25 16:15:45,009) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch19:
[3265079:MainThread](2024-04-25 16:15:45,010) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:17:07,525) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:17:15,414) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.095357, icir/train: : 0.759483, ric/train: : 0.091044, ricir/train: : 0.726011, mse/train: : 0.045275, loss/train: : 0.045275
[3265079:MainThread](2024-04-25 16:17:15,414) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.040615, icir/valid: : 0.321665, ric/valid: : 0.038993, ricir/valid: : 0.311697, mse/valid: : 0.049867, loss/valid: : 0.049867
[3265079:MainThread](2024-04-25 16:17:15,415) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch20:
[3265079:MainThread](2024-04-25 16:17:15,415) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:18:39,992) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:18:47,231) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.104239, icir/train: : 0.845955, ric/train: : 0.099357, ricir/train: : 0.800491, mse/train: : 0.025792, loss/train: : 0.025792
[3265079:MainThread](2024-04-25 16:18:47,232) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.045887, icir/valid: : 0.357438, ric/valid: : 0.042728, ricir/valid: : 0.335451, mse/valid: : 0.027724, loss/valid: : 0.027724
[3265079:MainThread](2024-04-25 16:18:47,232) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch21:
[3265079:MainThread](2024-04-25 16:18:47,232) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:19:53,715) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:20:01,209) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.101615, icir/train: : 0.846260, ric/train: : 0.097874, ricir/train: : 0.812940, mse/train: : 0.054819, loss/train: : 0.054819
[3265079:MainThread](2024-04-25 16:20:01,209) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.045439, icir/valid: : 0.355915, ric/valid: : 0.043756, ricir/valid: : 0.344636, mse/valid: : 0.063869, loss/valid: : 0.063869
[3265079:MainThread](2024-04-25 16:20:01,210) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch22:
[3265079:MainThread](2024-04-25 16:20:01,210) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:21:19,348) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:21:27,497) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.079507, icir/train: : 0.565223, ric/train: : 0.075528, ricir/train: : 0.543504, mse/train: : 0.030930, loss/train: : 0.030930
[3265079:MainThread](2024-04-25 16:21:27,497) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.030243, icir/valid: : 0.229036, ric/valid: : 0.027929, ricir/valid: : 0.210374, mse/valid: : 0.029954, loss/valid: : 0.029954
[3265079:MainThread](2024-04-25 16:21:27,497) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch23:
[3265079:MainThread](2024-04-25 16:21:27,498) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:22:53,761) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:23:01,445) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.088380, icir/train: : 0.731201, ric/train: : 0.083511, ricir/train: : 0.668282, mse/train: : 0.001086, loss/train: : 0.001086
[3265079:MainThread](2024-04-25 16:23:01,446) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.036750, icir/valid: : 0.280479, ric/valid: : 0.031551, ricir/valid: : 0.236166, mse/valid: : 0.004869, loss/valid: : 0.004869
[3265079:MainThread](2024-04-25 16:23:01,446) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch24:
[3265079:MainThread](2024-04-25 16:23:01,446) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:24:26,120) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:24:33,898) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.089483, icir/train: : 0.709868, ric/train: : 0.084073, ricir/train: : 0.652695, mse/train: : 0.006966, loss/train: : 0.006966
[3265079:MainThread](2024-04-25 16:24:33,899) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.035432, icir/valid: : 0.272311, ric/valid: : 0.027992, ricir/valid: : 0.215370, mse/valid: : 0.010414, loss/valid: : 0.010414
[3265079:MainThread](2024-04-25 16:24:33,899) INFO - qlib.ADARNN - [pytorch_adarnn.py:294] - early stop
[3265079:MainThread](2024-04-25 16:24:33,899) INFO - qlib.ADARNN - [pytorch_adarnn.py:297] - best score: 0.067448 @ 16
[3265079:MainThread](2024-04-25 16:24:34,070) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ADARNN_crowd_data_csi300_360_rankTrue_51.
[3265079:MainThread](2024-04-25 16:24:34,425) INFO - qlib.workflow - [exp.py:258] - Experiment 101 starts running ...
[3265079:MainThread](2024-04-25 16:24:34,444) INFO - qlib.workflow - [recorder.py:341] - Recorder 2b7ac03a99d04566b299044fc57d6434 starts running under Experiment 101 ...
{'IC': 0.024979768793226474,
 'ICIR': 0.20168371419474068,
 'Rank IC': 0.03567463093763558,
 'Rank ICIR': 0.2856513798688776}
[3265079:MainThread](2024-04-25 16:24:42,007) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3265079:MainThread](2024-04-25 16:25:29,775) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 16:25:29,781) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 16:25:36,268) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f891f7f8430>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<02:07,  7.59it/s]backtest loop:   1%|          | 8/971 [00:00<00:51, 18.72it/s]backtest loop:   1%|▏         | 13/971 [00:00<00:36, 26.59it/s]backtest loop:   2%|▏         | 19/971 [00:00<00:27, 34.51it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:25, 37.09it/s]backtest loop:   3%|▎         | 29/971 [00:00<00:23, 40.05it/s]backtest loop:   4%|▎         | 35/971 [00:01<00:20, 45.11it/s]backtest loop:   4%|▍         | 41/971 [00:01<00:18, 49.16it/s]backtest loop:   5%|▍         | 47/971 [00:01<00:17, 52.21it/s]backtest loop:   5%|▌         | 53/971 [00:01<00:16, 54.21it/s]backtest loop:   6%|▌         | 59/971 [00:01<00:18, 48.60it/s]backtest loop:   7%|▋         | 65/971 [00:01<00:19, 45.85it/s]backtest loop:   7%|▋         | 70/971 [00:01<00:20, 43.50it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:21, 42.05it/s]backtest loop:   8%|▊         | 80/971 [00:02<00:21, 40.87it/s]backtest loop:   9%|▉         | 85/971 [00:02<00:21, 40.70it/s]backtest loop:   9%|▉         | 90/971 [00:02<00:21, 40.44it/s]backtest loop:  10%|▉         | 95/971 [00:02<00:21, 40.46it/s]backtest loop:  10%|█         | 100/971 [00:02<00:21, 41.08it/s]backtest loop:  11%|█         | 105/971 [00:02<00:20, 41.63it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:20, 41.83it/s]backtest loop:  12%|█▏        | 115/971 [00:02<00:20, 40.97it/s]backtest loop:  12%|█▏        | 120/971 [00:03<00:20, 41.12it/s]backtest loop:  13%|█▎        | 125/971 [00:03<00:22, 38.16it/s]backtest loop:  13%|█▎        | 129/971 [00:03<00:26, 31.32it/s]backtest loop:  14%|█▎        | 133/971 [00:03<00:29, 28.40it/s]backtest loop:  14%|█▍        | 137/971 [00:03<00:31, 26.35it/s]backtest loop:  15%|█▍        | 141/971 [00:03<00:33, 25.15it/s]backtest loop:  15%|█▍        | 145/971 [00:04<00:31, 26.53it/s]backtest loop:  15%|█▌        | 148/971 [00:04<00:32, 25.29it/s]backtest loop:  16%|█▌        | 152/971 [00:04<00:28, 28.38it/s]backtest loop:  16%|█▌        | 157/971 [00:04<00:24, 32.66it/s]backtest loop:  17%|█▋        | 162/971 [00:04<00:22, 36.30it/s]backtest loop:  17%|█▋        | 166/971 [00:04<00:24, 32.23it/s]backtest loop:  18%|█▊        | 170/971 [00:04<00:23, 33.47it/s]backtest loop:  18%|█▊        | 174/971 [00:04<00:26, 30.62it/s]backtest loop:  18%|█▊        | 178/971 [00:05<00:26, 29.48it/s]backtest loop:  19%|█▉        | 183/971 [00:05<00:23, 33.09it/s]backtest loop:  19%|█▉        | 188/971 [00:05<00:21, 36.25it/s]backtest loop:  20%|█▉        | 193/971 [00:05<00:19, 39.10it/s]backtest loop:  20%|██        | 198/971 [00:05<00:18, 40.72it/s]backtest loop:  21%|██        | 203/971 [00:05<00:18, 42.26it/s]backtest loop:  21%|██▏       | 208/971 [00:05<00:17, 43.07it/s]backtest loop:  22%|██▏       | 213/971 [00:05<00:18, 41.22it/s]backtest loop:  22%|██▏       | 218/971 [00:05<00:17, 42.39it/s]backtest loop:  23%|██▎       | 223/971 [00:06<00:29, 25.36it/s]backtest loop:  23%|██▎       | 228/971 [00:06<00:25, 29.33it/s]backtest loop:  24%|██▍       | 233/971 [00:06<00:22, 32.78it/s]backtest loop:  25%|██▍       | 238/971 [00:06<00:20, 35.86it/s]backtest loop:  25%|██▌       | 243/971 [00:06<00:19, 38.16it/s]backtest loop:  26%|██▌       | 248/971 [00:06<00:17, 40.21it/s]backtest loop:  26%|██▌       | 253/971 [00:06<00:16, 42.40it/s]backtest loop:  27%|██▋       | 258/971 [00:07<00:16, 43.73it/s]backtest loop:  27%|██▋       | 263/971 [00:07<00:15, 44.83it/s]backtest loop:  28%|██▊       | 268/971 [00:07<00:16, 42.52it/s]backtest loop:  28%|██▊       | 273/971 [00:07<00:16, 42.62it/s]backtest loop:  29%|██▊       | 278/971 [00:07<00:17, 39.99it/s]backtest loop:  29%|██▉       | 283/971 [00:07<00:16, 41.13it/s]backtest loop:  30%|██▉       | 288/971 [00:07<00:16, 42.08it/s]backtest loop:  30%|███       | 293/971 [00:07<00:15, 43.30it/s]backtest loop:  31%|███       | 298/971 [00:08<00:16, 39.78it/s]backtest loop:  31%|███       | 303/971 [00:08<00:17, 37.16it/s]backtest loop:  32%|███▏      | 309/971 [00:08<00:15, 42.40it/s]backtest loop:  32%|███▏      | 315/971 [00:08<00:14, 44.14it/s]backtest loop:  33%|███▎      | 321/971 [00:08<00:13, 47.96it/s]backtest loop:  34%|███▎      | 327/971 [00:08<00:12, 51.05it/s]backtest loop:  34%|███▍      | 333/971 [00:08<00:11, 53.50it/s]backtest loop:  35%|███▍      | 339/971 [00:08<00:11, 55.09it/s]backtest loop:  36%|███▌      | 345/971 [00:08<00:11, 52.97it/s]backtest loop:  36%|███▌      | 351/971 [00:09<00:11, 53.85it/s]backtest loop:  37%|███▋      | 357/971 [00:09<00:11, 52.99it/s]backtest loop:  37%|███▋      | 363/971 [00:09<00:12, 48.81it/s]backtest loop:  38%|███▊      | 368/971 [00:09<00:13, 45.78it/s]backtest loop:  38%|███▊      | 373/971 [00:09<00:12, 46.74it/s]backtest loop:  39%|███▉      | 378/971 [00:09<00:12, 47.20it/s]backtest loop:  39%|███▉      | 383/971 [00:09<00:12, 47.02it/s]backtest loop:  40%|███▉      | 388/971 [00:09<00:12, 47.60it/s]backtest loop:  40%|████      | 393/971 [00:10<00:12, 47.93it/s]backtest loop:  41%|████      | 398/971 [00:10<00:12, 47.20it/s]backtest loop:  42%|████▏     | 403/971 [00:10<00:12, 46.99it/s]backtest loop:  42%|████▏     | 408/971 [00:10<00:11, 47.70it/s]backtest loop:  43%|████▎     | 414/971 [00:10<00:11, 50.18it/s]backtest loop:  43%|████▎     | 420/971 [00:10<00:10, 51.98it/s]backtest loop:  44%|████▍     | 426/971 [00:10<00:10, 52.88it/s]backtest loop:  44%|████▍     | 432/971 [00:10<00:10, 50.22it/s]backtest loop:  45%|████▌     | 438/971 [00:10<00:10, 51.53it/s]backtest loop:  46%|████▌     | 444/971 [00:11<00:10, 52.34it/s]backtest loop:  46%|████▋     | 450/971 [00:11<00:09, 52.73it/s]backtest loop:  47%|████▋     | 456/971 [00:11<00:09, 53.05it/s]backtest loop:  48%|████▊     | 462/971 [00:11<00:10, 50.27it/s]backtest loop:  48%|████▊     | 468/971 [00:11<00:09, 51.75it/s]backtest loop:  49%|████▉     | 474/971 [00:11<00:09, 52.98it/s]backtest loop:  49%|████▉     | 480/971 [00:11<00:09, 53.47it/s]backtest loop:  50%|█████     | 486/971 [00:11<00:08, 54.05it/s]backtest loop:  51%|█████     | 492/971 [00:11<00:09, 50.58it/s]backtest loop:  51%|█████▏    | 498/971 [00:12<00:09, 52.36it/s]backtest loop:  52%|█████▏    | 504/971 [00:12<00:08, 53.18it/s]backtest loop:  53%|█████▎    | 510/971 [00:12<00:09, 50.62it/s]backtest loop:  53%|█████▎    | 516/971 [00:12<00:08, 51.77it/s]backtest loop:  54%|█████▍    | 522/971 [00:12<00:09, 49.52it/s]backtest loop:  54%|█████▍    | 528/971 [00:12<00:08, 51.40it/s]backtest loop:  55%|█████▍    | 534/971 [00:12<00:08, 52.84it/s]backtest loop:  56%|█████▌    | 540/971 [00:12<00:08, 53.76it/s]backtest loop:  56%|█████▌    | 546/971 [00:12<00:08, 51.04it/s]backtest loop:  57%|█████▋    | 552/971 [00:13<00:07, 53.43it/s]backtest loop:  57%|█████▋    | 558/971 [00:13<00:07, 55.23it/s]backtest loop:  58%|█████▊    | 565/971 [00:13<00:07, 57.27it/s]backtest loop:  59%|█████▉    | 571/971 [00:13<00:07, 51.12it/s]backtest loop:  59%|█████▉    | 577/971 [00:13<00:08, 49.13it/s]backtest loop:  60%|██████    | 583/971 [00:13<00:08, 48.25it/s]backtest loop:  61%|██████    | 588/971 [00:13<00:08, 46.55it/s]backtest loop:  61%|██████    | 593/971 [00:13<00:08, 45.77it/s]backtest loop:  62%|██████▏   | 598/971 [00:14<00:08, 45.42it/s]backtest loop:  62%|██████▏   | 603/971 [00:14<00:08, 45.26it/s]backtest loop:  63%|██████▎   | 608/971 [00:14<00:08, 44.72it/s]backtest loop:  63%|██████▎   | 613/971 [00:14<00:08, 44.61it/s]backtest loop:  64%|██████▎   | 618/971 [00:14<00:07, 44.34it/s]backtest loop:  64%|██████▍   | 623/971 [00:14<00:07, 44.38it/s]backtest loop:  65%|██████▍   | 628/971 [00:14<00:07, 44.40it/s]backtest loop:  65%|██████▌   | 633/971 [00:14<00:07, 44.41it/s]backtest loop:  66%|██████▌   | 638/971 [00:14<00:07, 43.65it/s]backtest loop:  66%|██████▌   | 643/971 [00:15<00:07, 43.54it/s]backtest loop:  67%|██████▋   | 648/971 [00:15<00:07, 44.26it/s]backtest loop:  67%|██████▋   | 653/971 [00:15<00:07, 44.13it/s]backtest loop:  68%|██████▊   | 658/971 [00:15<00:07, 43.67it/s]backtest loop:  68%|██████▊   | 663/971 [00:15<00:07, 42.68it/s]backtest loop:  69%|██████▉   | 668/971 [00:15<00:07, 42.10it/s]backtest loop:  69%|██████▉   | 673/971 [00:15<00:07, 42.12it/s]backtest loop:  70%|██████▉   | 678/971 [00:15<00:06, 41.97it/s]backtest loop:  70%|███████   | 683/971 [00:16<00:06, 42.71it/s]backtest loop:  71%|███████   | 688/971 [00:16<00:06, 43.67it/s]backtest loop:  71%|███████▏  | 693/971 [00:16<00:06, 45.06it/s]backtest loop:  72%|███████▏  | 698/971 [00:16<00:05, 45.65it/s]backtest loop:  72%|███████▏  | 703/971 [00:16<00:05, 46.68it/s]backtest loop:  73%|███████▎  | 708/971 [00:16<00:05, 47.22it/s]backtest loop:  73%|███████▎  | 713/971 [00:16<00:05, 47.73it/s]backtest loop:  74%|███████▍  | 718/971 [00:16<00:05, 48.25it/s]backtest loop:  74%|███████▍  | 723/971 [00:16<00:05, 48.42it/s]backtest loop:  75%|███████▍  | 728/971 [00:16<00:05, 48.55it/s]backtest loop:  75%|███████▌  | 733/971 [00:17<00:05, 42.69it/s]backtest loop:  76%|███████▌  | 739/971 [00:17<00:05, 45.63it/s]backtest loop:  77%|███████▋  | 744/971 [00:17<00:04, 46.65it/s]backtest loop:  77%|███████▋  | 749/971 [00:17<00:04, 47.25it/s]backtest loop:  78%|███████▊  | 755/971 [00:17<00:04, 46.05it/s]backtest loop:  78%|███████▊  | 760/971 [00:17<00:04, 46.88it/s]backtest loop:  79%|███████▉  | 765/971 [00:17<00:04, 47.41it/s]backtest loop:  79%|███████▉  | 770/971 [00:17<00:04, 47.73it/s]backtest loop:  80%|███████▉  | 775/971 [00:17<00:04, 48.32it/s]backtest loop:  80%|████████  | 781/971 [00:18<00:03, 49.80it/s]backtest loop:  81%|████████  | 787/971 [00:18<00:03, 51.19it/s]backtest loop:  82%|████████▏ | 793/971 [00:18<00:03, 48.26it/s]backtest loop:  82%|████████▏ | 799/971 [00:18<00:03, 49.46it/s]backtest loop:  83%|████████▎ | 805/971 [00:18<00:03, 50.21it/s]backtest loop:  84%|████████▎ | 811/971 [00:18<00:03, 51.15it/s]backtest loop:  84%|████████▍ | 817/971 [00:18<00:02, 51.87it/s]backtest loop:  85%|████████▍ | 823/971 [00:18<00:03, 49.10it/s]backtest loop:  85%|████████▌ | 829/971 [00:19<00:02, 50.20it/s]backtest loop:  86%|████████▌ | 835/971 [00:19<00:02, 51.11it/s]backtest loop:  87%|████████▋ | 841/971 [00:19<00:02, 51.64it/s]backtest loop:  87%|████████▋ | 847/971 [00:19<00:02, 51.95it/s]backtest loop:  88%|████████▊ | 853/971 [00:19<00:02, 49.37it/s]backtest loop:  88%|████████▊ | 859/971 [00:19<00:02, 50.25it/s]backtest loop:  89%|████████▉ | 865/971 [00:19<00:02, 45.79it/s]backtest loop:  90%|████████▉ | 871/971 [00:19<00:02, 48.59it/s]backtest loop:  90%|█████████ | 877/971 [00:19<00:01, 48.77it/s]backtest loop:  91%|█████████ | 884/971 [00:20<00:01, 52.65it/s]backtest loop:  92%|█████████▏| 891/971 [00:20<00:01, 55.41it/s]backtest loop:  92%|█████████▏| 897/971 [00:20<00:01, 53.61it/s]backtest loop:  93%|█████████▎| 904/971 [00:20<00:01, 56.09it/s]backtest loop:  94%|█████████▎| 910/971 [00:20<00:01, 56.26it/s]backtest loop:  94%|█████████▍| 916/971 [00:20<00:01, 52.79it/s]backtest loop:  95%|█████████▍| 922/971 [00:20<00:00, 53.74it/s]backtest loop:  96%|█████████▌| 928/971 [00:20<00:00, 53.67it/s]backtest loop:  96%|█████████▌| 934/971 [00:21<00:00, 54.10it/s]backtest loop:  97%|█████████▋| 940/971 [00:21<00:00, 51.63it/s]backtest loop:  97%|█████████▋| 946/971 [00:21<00:00, 52.59it/s]backtest loop:  98%|█████████▊| 952/971 [00:21<00:00, 53.39it/s]backtest loop:  99%|█████████▊| 958/971 [00:21<00:00, 53.48it/s]backtest loop:  99%|█████████▉| 964/971 [00:21<00:00, 53.78it/s]backtest loop: 100%|█████████▉| 970/971 [00:21<00:00, 50.84it/s]backtest loop: 100%|██████████| 971/971 [00:21<00:00, 44.69it/s]
[3265079:MainThread](2024-04-25 16:25:58,059) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000599
std                0.004752
annualized_return  0.142477
information_ratio  1.943292
max_drawdown      -0.053522
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000402
std                0.004754
annualized_return  0.095713
information_ratio  1.305078
max_drawdown      -0.056270
[3265079:MainThread](2024-04-25 16:25:58,074) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ADARNN_crowd_data_csi300_360_rankTrue`.
[3265079:MainThread](2024-04-25 16:26:06,689) INFO - qlib.timer - [log.py:127] - Time cost: 0.004s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.0085111448463081,
                                                    0.040133948309472374,
                                                    0.10316185137476734,
                                                    0.09323388904245221,
                                                    0.030137306084237318,
                                                    0.10531798942252292,
                                                    0.04489064065046932,
                                                    0.02186206071003745,
                                                    0.09571333434248457],
 '1day.excess_return_with_cost.information_ratio': [-0.10598626920625567,
                                                    0.5394907020639452,
                                                    1.363858333479228,
                                                    1.2467355553729704,
                                                    0.35745365993276573,
                                                    1.503015181777876,
                                                    0.5511464644466534,
                                                    0.2354803607086786,
                                                    1.305077793316667],
 '1day.excess_return_with_cost.max_drawdown': [-0.20237780038364295,
                                               -0.07594003976516654,
                                               -0.08729842747498329,
                                               -0.08604753042288982,
                                               -0.09758207990055402,
                                               -0.07174431931335298,
                                               -0.08565671460392059,
                                               -0.22370700397902749,
                                               -0.05627016070849378],
 'IC': [0.0013536984392258171,
        0.026439898619729344,
        0.026902079345962383,
        0.02348331098236194,
        0.01327365027193708,
        0.027115639691058954,
        0.015768548135018903,
        0.01883505612201559,
        0.024979768793226474],
 'ICIR': [0.009181160161704657,
          0.21079803251917983,
          0.19837312520563208,
          0.18130028119321606,
          0.08768322408071108,
          0.225711831523885,
          0.12426388479425975,
          0.13086282123412246,
          0.20168371419474068],
 'Rank IC': [0.012407792581098361,
             0.03724272331287428,
             0.03587138551857936,
             0.03310470827646654,
             0.019693651797228897,
             0.031972516716016676,
             0.019646681310193474,
             0.020376577977809333,
             0.03567463093763558],
 'Rank ICIR': [0.08674177992422927,
               0.29319132408979226,
               0.27587741721675363,
               0.24465738515472754,
               0.12528583016367276,
               0.24856618846863654,
               0.14914286233002177,
               0.13693739622958964,
               0.2856513798688776],
 'mae': [0.8703869590122575,
         0.8647632230090078,
         0.864850520964454,
         0.8644913943487671,
         0.8657382494764543,
         0.8650519310588405,
         0.8653423118125829,
         0.8659474014567119,
         0.8656905116295194],
 'mse': [1.0176620582257514,
         1.0010798346127248,
         1.001276056691344,
         0.9992015764604559,
         1.0014523455546427,
         1.000771897485576,
         1.0004887467773014,
         1.0050382379836018,
         1.0037785458189834]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3265079:MainThread](2024-04-25 16:26:10,359) INFO - qlib.ADARNN - [pytorch_adarnn.py:63] - ADARNN pytorch version...
[3265079:MainThread](2024-04-25 16:26:10,360) INFO - qlib.ADARNN - [pytorch_adarnn.py:87] - ADARNN parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3265079:MainThread](2024-04-25 16:26:10,378) INFO - qlib.ADARNN - [pytorch_adarnn.py:136] - model:
AdaRNN(
  (features): Sequential(
    (0): GRU(6, 64, batch_first=True)
    (1): GRU(64, 64, batch_first=True)
  )
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
  (gate): ModuleList(
    (0): Linear(in_features=7680, out_features=60, bias=True)
    (1): Linear(in_features=7680, out_features=60, bias=True)
  )
  (bn_lst): ModuleList(
    (0): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (softmax): Softmax(dim=0)
)
[3265079:MainThread](2024-04-25 16:26:10,379) INFO - qlib.ADARNN - [pytorch_adarnn.py:137] - model size: 0.9163 MB
[3265079:MainThread](2024-04-25 16:26:14,116) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ADARNN_crowd_data_csi300_360_rankTrue_52.
[3265079:MainThread](2024-04-25 16:26:14,252) INFO - qlib.workflow - [exp.py:258] - Experiment 110 starts running ...
[3265079:MainThread](2024-04-25 16:26:14,278) INFO - qlib.workflow - [recorder.py:341] - Recorder 7075efc92b404ac2b0f348c30592ebd8 starts running under Experiment 110 ...
[3265079:MainThread](2024-04-25 16:26:20,820) INFO - qlib.ADARNN - [pytorch_adarnn.py:266] - training...
[3265079:MainThread](2024-04-25 16:26:20,822) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch0:
[3265079:MainThread](2024-04-25 16:26:20,823) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:27:48,268) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:27:56,535) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.083224, icir/train: : 0.635152, ric/train: : 0.079249, ricir/train: : 0.607554, mse/train: : 0.000336, loss/train: : 0.000336
[3265079:MainThread](2024-04-25 16:27:56,536) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.032774, icir/valid: : 0.233867, ric/valid: : 0.030803, ricir/valid: : 0.221934, mse/valid: : 0.012702, loss/valid: : 0.012702
[3265079:MainThread](2024-04-25 16:27:56,538) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch1:
[3265079:MainThread](2024-04-25 16:27:56,538) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:29:25,488) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:29:33,045) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.058045, icir/train: : 0.401768, ric/train: : 0.054688, ricir/train: : 0.379190, mse/train: : -0.048748, loss/train: : -0.048748
[3265079:MainThread](2024-04-25 16:29:33,046) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.019144, icir/valid: : 0.145572, ric/valid: : 0.017770, ricir/valid: : 0.134495, mse/valid: : -0.048264, loss/valid: : -0.048264
[3265079:MainThread](2024-04-25 16:29:33,046) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch2:
[3265079:MainThread](2024-04-25 16:29:33,047) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:30:59,615) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:31:07,402) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.045026, icir/train: : 0.321484, ric/train: : 0.047835, ricir/train: : 0.333133, mse/train: : -0.096031, loss/train: : -0.096031
[3265079:MainThread](2024-04-25 16:31:07,402) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.023528, icir/valid: : 0.184258, ric/valid: : 0.023096, ricir/valid: : 0.174533, mse/valid: : -0.101726, loss/valid: : -0.101726
[3265079:MainThread](2024-04-25 16:31:07,403) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch3:
[3265079:MainThread](2024-04-25 16:31:07,403) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:32:31,293) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:32:39,352) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.054884, icir/train: : 0.395991, ric/train: : 0.053092, ricir/train: : 0.385205, mse/train: : -0.002260, loss/train: : -0.002260
[3265079:MainThread](2024-04-25 16:32:39,352) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.020077, icir/valid: : 0.150351, ric/valid: : 0.020489, ricir/valid: : 0.155776, mse/valid: : 0.001425, loss/valid: : 0.001425
[3265079:MainThread](2024-04-25 16:32:39,353) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch4:
[3265079:MainThread](2024-04-25 16:32:39,353) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:34:02,850) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:34:10,384) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.061333, icir/train: : 0.436946, ric/train: : 0.058544, ricir/train: : 0.422280, mse/train: : -0.021604, loss/train: : -0.021604
[3265079:MainThread](2024-04-25 16:34:10,385) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.025310, icir/valid: : 0.192981, ric/valid: : 0.026770, ricir/valid: : 0.209853, mse/valid: : -0.021404, loss/valid: : -0.021404
[3265079:MainThread](2024-04-25 16:34:10,385) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch5:
[3265079:MainThread](2024-04-25 16:34:10,385) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:35:35,286) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:35:43,072) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.072038, icir/train: : 0.546756, ric/train: : 0.068840, ricir/train: : 0.522525, mse/train: : 0.025635, loss/train: : 0.025635
[3265079:MainThread](2024-04-25 16:35:43,072) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.026489, icir/valid: : 0.210315, ric/valid: : 0.026882, ricir/valid: : 0.209464, mse/valid: : 0.028679, loss/valid: : 0.028679
[3265079:MainThread](2024-04-25 16:35:43,074) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch6:
[3265079:MainThread](2024-04-25 16:35:43,075) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:37:07,815) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:37:16,214) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.078849, icir/train: : 0.582185, ric/train: : 0.074457, ricir/train: : 0.562478, mse/train: : 0.027102, loss/train: : 0.027102
[3265079:MainThread](2024-04-25 16:37:16,215) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.031490, icir/valid: : 0.241699, ric/valid: : 0.031368, ricir/valid: : 0.247363, mse/valid: : 0.032381, loss/valid: : 0.032381
[3265079:MainThread](2024-04-25 16:37:16,217) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch7:
[3265079:MainThread](2024-04-25 16:37:16,217) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:38:41,776) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:38:49,387) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.092022, icir/train: : 0.705206, ric/train: : 0.088216, ricir/train: : 0.683003, mse/train: : -0.018118, loss/train: : -0.018118
[3265079:MainThread](2024-04-25 16:38:49,388) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.037186, icir/valid: : 0.286793, ric/valid: : 0.035166, ricir/valid: : 0.276673, mse/valid: : -0.011851, loss/valid: : -0.011851
[3265079:MainThread](2024-04-25 16:38:49,388) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch8:
[3265079:MainThread](2024-04-25 16:38:49,388) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:40:01,891) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:40:09,545) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.091334, icir/train: : 0.687906, ric/train: : 0.087716, ricir/train: : 0.676421, mse/train: : 0.041541, loss/train: : 0.041541
[3265079:MainThread](2024-04-25 16:40:09,546) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.038359, icir/valid: : 0.290864, ric/valid: : 0.035452, ricir/valid: : 0.279676, mse/valid: : 0.046771, loss/valid: : 0.046771
[3265079:MainThread](2024-04-25 16:40:09,549) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch9:
[3265079:MainThread](2024-04-25 16:40:09,549) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:41:14,798) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:41:22,382) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.096438, icir/train: : 0.805101, ric/train: : 0.093158, ricir/train: : 0.776831, mse/train: : 0.027742, loss/train: : 0.027742
[3265079:MainThread](2024-04-25 16:41:22,383) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.037577, icir/valid: : 0.298182, ric/valid: : 0.035697, ricir/valid: : 0.284567, mse/valid: : 0.035764, loss/valid: : 0.035764
[3265079:MainThread](2024-04-25 16:41:22,383) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch10:
[3265079:MainThread](2024-04-25 16:41:22,383) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:42:44,823) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:42:53,039) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.095168, icir/train: : 0.727001, ric/train: : 0.090917, ricir/train: : 0.696200, mse/train: : 0.031278, loss/train: : 0.031278
[3265079:MainThread](2024-04-25 16:42:53,040) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.038734, icir/valid: : 0.294785, ric/valid: : 0.035320, ricir/valid: : 0.267599, mse/valid: : 0.038745, loss/valid: : 0.038745
[3265079:MainThread](2024-04-25 16:42:53,040) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch11:
[3265079:MainThread](2024-04-25 16:42:53,041) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:44:22,744) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:44:30,663) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.102727, icir/train: : 0.790257, ric/train: : 0.099479, ricir/train: : 0.765503, mse/train: : 0.056652, loss/train: : 0.056652
[3265079:MainThread](2024-04-25 16:44:30,663) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.041205, icir/valid: : 0.324945, ric/valid: : 0.038372, ricir/valid: : 0.301983, mse/valid: : 0.062031, loss/valid: : 0.062031
[3265079:MainThread](2024-04-25 16:44:30,665) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch12:
[3265079:MainThread](2024-04-25 16:44:30,666) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:45:52,643) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:46:00,219) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.101918, icir/train: : 0.845801, ric/train: : 0.097910, ricir/train: : 0.806124, mse/train: : 0.013612, loss/train: : 0.013612
[3265079:MainThread](2024-04-25 16:46:00,220) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.044799, icir/valid: : 0.386781, ric/valid: : 0.039103, ricir/valid: : 0.338598, mse/valid: : 0.016953, loss/valid: : 0.016953
[3265079:MainThread](2024-04-25 16:46:00,220) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch13:
[3265079:MainThread](2024-04-25 16:46:00,220) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:47:26,929) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:47:34,355) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.090996, icir/train: : 0.719175, ric/train: : 0.086708, ricir/train: : 0.690331, mse/train: : 0.015975, loss/train: : 0.015975
[3265079:MainThread](2024-04-25 16:47:34,355) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.031662, icir/valid: : 0.252937, ric/valid: : 0.031359, ricir/valid: : 0.246280, mse/valid: : 0.023011, loss/valid: : 0.023011
[3265079:MainThread](2024-04-25 16:47:34,355) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch14:
[3265079:MainThread](2024-04-25 16:47:34,356) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:48:57,889) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:49:05,599) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.103812, icir/train: : 0.841492, ric/train: : 0.100380, ricir/train: : 0.812552, mse/train: : -0.011979, loss/train: : -0.011979
[3265079:MainThread](2024-04-25 16:49:05,600) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.045125, icir/valid: : 0.362164, ric/valid: : 0.041805, ricir/valid: : 0.333721, mse/valid: : -0.001774, loss/valid: : -0.001774
[3265079:MainThread](2024-04-25 16:49:05,600) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch15:
[3265079:MainThread](2024-04-25 16:49:05,600) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:50:32,190) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:50:39,664) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.100434, icir/train: : 0.841636, ric/train: : 0.097085, ricir/train: : 0.807625, mse/train: : -0.029008, loss/train: : -0.029008
[3265079:MainThread](2024-04-25 16:50:39,664) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.044692, icir/valid: : 0.383520, ric/valid: : 0.042116, ricir/valid: : 0.360846, mse/valid: : -0.023574, loss/valid: : -0.023574
[3265079:MainThread](2024-04-25 16:50:39,665) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch16:
[3265079:MainThread](2024-04-25 16:50:39,665) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:52:01,539) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:52:09,283) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.104305, icir/train: : 0.820835, ric/train: : 0.100995, ricir/train: : 0.801479, mse/train: : 0.001309, loss/train: : 0.001309
[3265079:MainThread](2024-04-25 16:52:09,283) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.042309, icir/valid: : 0.331994, ric/valid: : 0.039405, ricir/valid: : 0.315670, mse/valid: : 0.008457, loss/valid: : 0.008457
[3265079:MainThread](2024-04-25 16:52:09,284) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch17:
[3265079:MainThread](2024-04-25 16:52:09,284) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:53:35,731) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:53:43,426) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.109969, icir/train: : 0.864893, ric/train: : 0.106787, ricir/train: : 0.842874, mse/train: : 0.010107, loss/train: : 0.010107
[3265079:MainThread](2024-04-25 16:53:43,426) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.046166, icir/valid: : 0.365368, ric/valid: : 0.044408, ricir/valid: : 0.354297, mse/valid: : 0.013897, loss/valid: : 0.013897
[3265079:MainThread](2024-04-25 16:53:43,427) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch18:
[3265079:MainThread](2024-04-25 16:53:43,427) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:55:07,219) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:55:14,958) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.108580, icir/train: : 0.863527, ric/train: : 0.104640, ricir/train: : 0.824140, mse/train: : 0.019897, loss/train: : 0.019897
[3265079:MainThread](2024-04-25 16:55:14,959) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.040764, icir/valid: : 0.314050, ric/valid: : 0.036694, ricir/valid: : 0.282822, mse/valid: : 0.027245, loss/valid: : 0.027245
[3265079:MainThread](2024-04-25 16:55:14,960) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch19:
[3265079:MainThread](2024-04-25 16:55:14,960) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 16:56:39,638) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 16:56:47,611) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.066027, icir/train: : 0.556354, ric/train: : 0.063807, ricir/train: : 0.541008, mse/train: : -0.011318, loss/train: : -0.011318
[3265079:MainThread](2024-04-25 16:56:47,611) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.020165, icir/valid: : 0.170794, ric/valid: : 0.019076, ricir/valid: : 0.159902, mse/valid: : -0.007533, loss/valid: : -0.007533
[3265079:MainThread](2024-04-25 16:56:47,611) INFO - qlib.ADARNN - [pytorch_adarnn.py:294] - early stop
[3265079:MainThread](2024-04-25 16:56:47,612) INFO - qlib.ADARNN - [pytorch_adarnn.py:297] - best score: 0.062031 @ 11
[3265079:MainThread](2024-04-25 16:56:47,750) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ADARNN_crowd_data_csi300_360_rankTrue_52.
[3265079:MainThread](2024-04-25 16:56:48,063) INFO - qlib.workflow - [exp.py:258] - Experiment 101 starts running ...
[3265079:MainThread](2024-04-25 16:56:48,081) INFO - qlib.workflow - [recorder.py:341] - Recorder dae6bdf9ff364aefb58f5ed5c5f6986e starts running under Experiment 101 ...
{'IC': 0.02475723798104233,
 'ICIR': 0.1881384804369556,
 'Rank IC': 0.032594118818210276,
 'Rank ICIR': 0.24416207131436676}
[3265079:MainThread](2024-04-25 16:56:56,179) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3265079:MainThread](2024-04-25 16:57:45,881) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 16:57:45,885) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3265079:MainThread](2024-04-25 16:57:52,529) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f89045acac0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<02:15,  7.12it/s]backtest loop:   1%|          | 8/971 [00:00<00:53, 17.86it/s]backtest loop:   1%|▏         | 14/971 [00:00<00:33, 28.24it/s]backtest loop:   2%|▏         | 20/971 [00:00<00:26, 36.09it/s]backtest loop:   3%|▎         | 25/971 [00:00<00:24, 38.58it/s]backtest loop:   3%|▎         | 32/971 [00:00<00:20, 45.60it/s]backtest loop:   4%|▍         | 38/971 [00:01<00:18, 49.26it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:19, 47.29it/s]backtest loop:   5%|▌         | 50/971 [00:01<00:19, 47.90it/s]backtest loop:   6%|▌         | 56/971 [00:01<00:18, 48.37it/s]backtest loop:   6%|▋         | 62/971 [00:01<00:19, 46.19it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:19, 46.73it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:18, 47.44it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:18, 47.50it/s]backtest loop:   8%|▊         | 82/971 [00:02<00:18, 48.17it/s]backtest loop:   9%|▉         | 87/971 [00:02<00:18, 48.21it/s]backtest loop:   9%|▉         | 92/971 [00:02<00:18, 48.36it/s]backtest loop:  10%|▉         | 97/971 [00:02<00:18, 48.38it/s]backtest loop:  11%|█         | 102/971 [00:02<00:18, 48.27it/s]backtest loop:  11%|█         | 108/971 [00:02<00:17, 49.79it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:16, 51.10it/s]backtest loop:  12%|█▏        | 120/971 [00:02<00:16, 50.87it/s]backtest loop:  13%|█▎        | 126/971 [00:02<00:18, 45.22it/s]backtest loop:  13%|█▎        | 131/971 [00:03<00:18, 46.39it/s]backtest loop:  14%|█▍        | 137/971 [00:03<00:17, 48.51it/s]backtest loop:  15%|█▍        | 142/971 [00:03<00:36, 22.56it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:31, 26.56it/s]backtest loop:  16%|█▌        | 152/971 [00:03<00:26, 30.67it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:22, 35.62it/s]backtest loop:  17%|█▋        | 164/971 [00:04<00:20, 39.61it/s]backtest loop:  18%|█▊        | 170/971 [00:04<00:18, 43.08it/s]backtest loop:  18%|█▊        | 176/971 [00:04<00:18, 43.61it/s]backtest loop:  19%|█▊        | 182/971 [00:04<00:17, 46.38it/s]backtest loop:  19%|█▉        | 188/971 [00:04<00:16, 48.02it/s]backtest loop:  20%|█▉        | 194/971 [00:04<00:15, 48.89it/s]backtest loop:  21%|██        | 200/971 [00:04<00:16, 46.81it/s]backtest loop:  21%|██        | 205/971 [00:04<00:16, 47.54it/s]backtest loop:  22%|██▏       | 210/971 [00:05<00:15, 47.96it/s]backtest loop:  22%|██▏       | 215/971 [00:05<00:16, 45.72it/s]backtest loop:  23%|██▎       | 220/971 [00:05<00:16, 46.75it/s]backtest loop:  23%|██▎       | 226/971 [00:05<00:15, 48.26it/s]backtest loop:  24%|██▍       | 231/971 [00:05<00:15, 48.67it/s]backtest loop:  24%|██▍       | 236/971 [00:05<00:15, 48.96it/s]backtest loop:  25%|██▍       | 241/971 [00:05<00:14, 49.00it/s]backtest loop:  25%|██▌       | 246/971 [00:05<00:14, 49.03it/s]backtest loop:  26%|██▌       | 252/971 [00:05<00:14, 50.00it/s]backtest loop:  27%|██▋       | 258/971 [00:06<00:14, 50.86it/s]backtest loop:  27%|██▋       | 264/971 [00:06<00:14, 47.85it/s]backtest loop:  28%|██▊       | 270/971 [00:06<00:14, 49.02it/s]backtest loop:  28%|██▊       | 275/971 [00:06<00:14, 48.89it/s]backtest loop:  29%|██▉       | 280/971 [00:06<00:14, 47.89it/s]backtest loop:  29%|██▉       | 285/971 [00:06<00:14, 48.30it/s]backtest loop:  30%|██▉       | 290/971 [00:06<00:14, 48.37it/s]backtest loop:  30%|███       | 295/971 [00:06<00:14, 45.69it/s]backtest loop:  31%|███       | 300/971 [00:06<00:14, 46.27it/s]backtest loop:  31%|███▏      | 305/971 [00:07<00:14, 47.09it/s]backtest loop:  32%|███▏      | 310/971 [00:07<00:14, 47.19it/s]backtest loop:  32%|███▏      | 315/971 [00:07<00:13, 46.88it/s]backtest loop:  33%|███▎      | 320/971 [00:07<00:13, 47.49it/s]backtest loop:  33%|███▎      | 325/971 [00:07<00:13, 47.48it/s]backtest loop:  34%|███▍      | 330/971 [00:07<00:13, 47.58it/s]backtest loop:  35%|███▍      | 335/971 [00:07<00:13, 46.33it/s]backtest loop:  35%|███▌      | 340/971 [00:07<00:13, 45.95it/s]backtest loop:  36%|███▌      | 345/971 [00:07<00:13, 46.76it/s]backtest loop:  36%|███▌      | 351/971 [00:07<00:12, 48.61it/s]backtest loop:  37%|███▋      | 356/971 [00:08<00:12, 48.19it/s]backtest loop:  37%|███▋      | 362/971 [00:08<00:11, 51.01it/s]backtest loop:  38%|███▊      | 368/971 [00:08<00:12, 47.37it/s]backtest loop:  39%|███▊      | 375/971 [00:08<00:11, 51.73it/s]backtest loop:  39%|███▉      | 381/971 [00:08<00:10, 53.90it/s]backtest loop:  40%|███▉      | 387/971 [00:08<00:10, 55.56it/s]backtest loop:  40%|████      | 393/971 [00:08<00:10, 53.47it/s]backtest loop:  41%|████      | 399/971 [00:08<00:10, 54.33it/s]backtest loop:  42%|████▏     | 405/971 [00:08<00:10, 54.96it/s]backtest loop:  42%|████▏     | 411/971 [00:09<00:10, 54.12it/s]backtest loop:  43%|████▎     | 417/971 [00:09<00:10, 53.33it/s]backtest loop:  44%|████▎     | 423/971 [00:09<00:11, 49.34it/s]backtest loop:  44%|████▍     | 429/971 [00:09<00:10, 49.64it/s]backtest loop:  45%|████▍     | 435/971 [00:09<00:10, 50.07it/s]backtest loop:  45%|████▌     | 441/971 [00:09<00:10, 49.66it/s]backtest loop:  46%|████▌     | 446/971 [00:09<00:10, 49.72it/s]backtest loop:  46%|████▋     | 451/971 [00:09<00:10, 49.34it/s]backtest loop:  47%|████▋     | 457/971 [00:10<00:10, 47.31it/s]backtest loop:  48%|████▊     | 462/971 [00:10<00:10, 47.78it/s]backtest loop:  48%|████▊     | 467/971 [00:10<00:10, 48.30it/s]backtest loop:  49%|████▊     | 472/971 [00:10<00:10, 48.41it/s]backtest loop:  49%|████▉     | 478/971 [00:10<00:09, 49.41it/s]backtest loop:  50%|████▉     | 484/971 [00:10<00:09, 51.02it/s]backtest loop:  50%|█████     | 490/971 [00:10<00:10, 48.02it/s]backtest loop:  51%|█████     | 496/971 [00:10<00:09, 49.69it/s]backtest loop:  52%|█████▏    | 502/971 [00:10<00:09, 50.55it/s]backtest loop:  52%|█████▏    | 508/971 [00:11<00:09, 47.88it/s]backtest loop:  53%|█████▎    | 514/971 [00:11<00:09, 49.70it/s]backtest loop:  54%|█████▎    | 520/971 [00:11<00:09, 45.68it/s]backtest loop:  54%|█████▍    | 526/971 [00:11<00:09, 45.30it/s]backtest loop:  55%|█████▍    | 532/971 [00:11<00:09, 47.48it/s]backtest loop:  55%|█████▌    | 538/971 [00:11<00:08, 48.92it/s]backtest loop:  56%|█████▌    | 543/971 [00:11<00:08, 48.83it/s]backtest loop:  56%|█████▋    | 548/971 [00:11<00:08, 48.71it/s]backtest loop:  57%|█████▋    | 554/971 [00:12<00:08, 50.39it/s]backtest loop:  58%|█████▊    | 560/971 [00:12<00:08, 50.75it/s]backtest loop:  58%|█████▊    | 566/971 [00:12<00:08, 48.35it/s]backtest loop:  59%|█████▉    | 572/971 [00:12<00:07, 51.17it/s]backtest loop:  60%|█████▉    | 578/971 [00:12<00:07, 52.89it/s]backtest loop:  60%|██████    | 584/971 [00:12<00:07, 54.73it/s]backtest loop:  61%|██████    | 590/971 [00:12<00:06, 56.02it/s]backtest loop:  61%|██████▏   | 596/971 [00:12<00:07, 53.29it/s]backtest loop:  62%|██████▏   | 602/971 [00:12<00:07, 51.15it/s]backtest loop:  63%|██████▎   | 608/971 [00:13<00:07, 50.31it/s]backtest loop:  63%|██████▎   | 614/971 [00:13<00:07, 50.21it/s]backtest loop:  64%|██████▍   | 620/971 [00:13<00:07, 47.81it/s]backtest loop:  64%|██████▍   | 625/971 [00:13<00:07, 48.22it/s]backtest loop:  65%|██████▍   | 630/971 [00:13<00:07, 48.23it/s]backtest loop:  65%|██████▌   | 635/971 [00:13<00:06, 48.68it/s]backtest loop:  66%|██████▌   | 640/971 [00:13<00:07, 46.75it/s]backtest loop:  66%|██████▋   | 645/971 [00:13<00:06, 47.01it/s]backtest loop:  67%|██████▋   | 650/971 [00:13<00:06, 47.75it/s]backtest loop:  67%|██████▋   | 655/971 [00:14<00:06, 47.97it/s]backtest loop:  68%|██████▊   | 661/971 [00:14<00:06, 49.27it/s]backtest loop:  69%|██████▊   | 666/971 [00:14<00:06, 48.49it/s]backtest loop:  69%|██████▉   | 672/971 [00:14<00:06, 49.13it/s]backtest loop:  70%|██████▉   | 678/971 [00:14<00:05, 50.24it/s]backtest loop:  70%|███████   | 684/971 [00:14<00:06, 47.24it/s]backtest loop:  71%|███████   | 689/971 [00:14<00:05, 47.61it/s]backtest loop:  72%|███████▏  | 695/971 [00:14<00:05, 49.28it/s]backtest loop:  72%|███████▏  | 700/971 [00:14<00:05, 48.95it/s]backtest loop:  73%|███████▎  | 706/971 [00:15<00:05, 49.79it/s]backtest loop:  73%|███████▎  | 711/971 [00:15<00:05, 49.14it/s]backtest loop:  74%|███████▍  | 717/971 [00:15<00:05, 50.22it/s]backtest loop:  74%|███████▍  | 723/971 [00:15<00:04, 50.23it/s]backtest loop:  75%|███████▌  | 729/971 [00:15<00:05, 44.55it/s]backtest loop:  76%|███████▌  | 734/971 [00:15<00:05, 43.29it/s]backtest loop:  76%|███████▌  | 740/971 [00:15<00:05, 45.88it/s]backtest loop:  77%|███████▋  | 745/971 [00:15<00:04, 46.90it/s]backtest loop:  77%|███████▋  | 750/971 [00:16<00:04, 45.30it/s]backtest loop:  78%|███████▊  | 755/971 [00:16<00:04, 46.31it/s]backtest loop:  78%|███████▊  | 761/971 [00:16<00:04, 48.29it/s]backtest loop:  79%|███████▉  | 766/971 [00:16<00:04, 48.61it/s]backtest loop:  80%|███████▉  | 772/971 [00:16<00:03, 49.87it/s]backtest loop:  80%|████████  | 778/971 [00:16<00:03, 50.80it/s]backtest loop:  81%|████████  | 784/971 [00:16<00:03, 48.48it/s]backtest loop:  81%|████████▏ | 790/971 [00:16<00:03, 49.72it/s]backtest loop:  82%|████████▏ | 796/971 [00:16<00:03, 50.40it/s]backtest loop:  83%|████████▎ | 802/971 [00:17<00:03, 50.96it/s]backtest loop:  83%|████████▎ | 808/971 [00:17<00:03, 48.59it/s]backtest loop:  84%|████████▎ | 813/971 [00:17<00:03, 45.25it/s]backtest loop:  84%|████████▍ | 819/971 [00:17<00:03, 47.32it/s]backtest loop:  85%|████████▍ | 825/971 [00:17<00:02, 48.89it/s]backtest loop:  85%|████████▌ | 830/971 [00:17<00:02, 48.98it/s]backtest loop:  86%|████████▌ | 836/971 [00:17<00:02, 49.87it/s]backtest loop:  87%|████████▋ | 842/971 [00:17<00:02, 50.37it/s]backtest loop:  87%|████████▋ | 848/971 [00:18<00:02, 47.71it/s]backtest loop:  88%|████████▊ | 853/971 [00:18<00:02, 48.09it/s]backtest loop:  88%|████████▊ | 859/971 [00:18<00:02, 49.71it/s]backtest loop:  89%|████████▉ | 865/971 [00:18<00:02, 50.39it/s]backtest loop:  90%|████████▉ | 871/971 [00:18<00:01, 51.30it/s]backtest loop:  90%|█████████ | 877/971 [00:18<00:01, 48.82it/s]backtest loop:  91%|█████████ | 882/971 [00:18<00:01, 49.09it/s]backtest loop:  91%|█████████▏| 888/971 [00:18<00:01, 50.47it/s]backtest loop:  92%|█████████▏| 894/971 [00:18<00:01, 51.02it/s]backtest loop:  93%|█████████▎| 900/971 [00:19<00:01, 51.51it/s]backtest loop:  93%|█████████▎| 906/971 [00:19<00:01, 52.06it/s]backtest loop:  94%|█████████▍| 912/971 [00:19<00:01, 49.29it/s]backtest loop:  94%|█████████▍| 917/971 [00:19<00:01, 49.38it/s]backtest loop:  95%|█████████▌| 923/971 [00:19<00:00, 50.19it/s]backtest loop:  96%|█████████▌| 929/971 [00:19<00:00, 52.56it/s]backtest loop:  96%|█████████▋| 935/971 [00:19<00:00, 54.31it/s]backtest loop:  97%|█████████▋| 941/971 [00:19<00:00, 52.53it/s]backtest loop:  98%|█████████▊| 947/971 [00:19<00:00, 54.57it/s]backtest loop:  98%|█████████▊| 953/971 [00:20<00:00, 55.84it/s]backtest loop:  99%|█████████▉| 960/971 [00:20<00:00, 54.30it/s]backtest loop:  99%|█████████▉| 966/971 [00:20<00:00, 55.43it/s]backtest loop: 100%|██████████| 971/971 [00:20<00:00, 47.58it/s]
[3265079:MainThread](2024-04-25 16:58:13,008) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000584
std                0.004829
annualized_return  0.139078
information_ratio  1.866894
max_drawdown      -0.051473
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000384
std                0.004830
annualized_return  0.091498
information_ratio  1.227985
max_drawdown      -0.061132
[3265079:MainThread](2024-04-25 16:58:13,023) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 101
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ADARNN_crowd_data_csi300_360_rankTrue`.
[3265079:MainThread](2024-04-25 16:58:22,720) INFO - qlib.timer - [log.py:127] - Time cost: 0.006s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.0085111448463081,
                                                    0.040133948309472374,
                                                    0.10316185137476734,
                                                    0.09323388904245221,
                                                    0.030137306084237318,
                                                    0.10531798942252292,
                                                    0.04489064065046932,
                                                    0.02186206071003745,
                                                    0.09571333434248457,
                                                    0.0914975426090599],
 '1day.excess_return_with_cost.information_ratio': [-0.10598626920625567,
                                                    0.5394907020639452,
                                                    1.363858333479228,
                                                    1.2467355553729704,
                                                    0.35745365993276573,
                                                    1.503015181777876,
                                                    0.5511464644466534,
                                                    0.2354803607086786,
                                                    1.305077793316667,
                                                    1.2279851514423703],
 '1day.excess_return_with_cost.max_drawdown': [-0.20237780038364295,
                                               -0.07594003976516654,
                                               -0.08729842747498329,
                                               -0.08604753042288982,
                                               -0.09758207990055402,
                                               -0.07174431931335298,
                                               -0.08565671460392059,
                                               -0.22370700397902749,
                                               -0.05627016070849378,
                                               -0.061132124768802504],
 'IC': [0.0013536984392258171,
        0.026439898619729344,
        0.026902079345962383,
        0.02348331098236194,
        0.01327365027193708,
        0.027115639691058954,
        0.015768548135018903,
        0.01883505612201559,
        0.024979768793226474,
        0.02475723798104233],
 'ICIR': [0.009181160161704657,
          0.21079803251917983,
          0.19837312520563208,
          0.18130028119321606,
          0.08768322408071108,
          0.225711831523885,
          0.12426388479425975,
          0.13086282123412246,
          0.20168371419474068,
          0.1881384804369556],
 'Rank IC': [0.012407792581098361,
             0.03724272331287428,
             0.03587138551857936,
             0.03310470827646654,
             0.019693651797228897,
             0.031972516716016676,
             0.019646681310193474,
             0.020376577977809333,
             0.03567463093763558,
             0.032594118818210276],
 'Rank ICIR': [0.08674177992422927,
               0.29319132408979226,
               0.27587741721675363,
               0.24465738515472754,
               0.12528583016367276,
               0.24856618846863654,
               0.14914286233002177,
               0.13693739622958964,
               0.2856513798688776,
               0.24416207131436676],
 'mae': [0.8703869590122575,
         0.8647632230090078,
         0.864850520964454,
         0.8644913943487671,
         0.8657382494764543,
         0.8650519310588405,
         0.8653423118125829,
         0.8659474014567119,
         0.8656905116295194,
         0.8656768121957964],
 'mse': [1.0176620582257514,
         1.0010798346127248,
         1.001276056691344,
         0.9992015764604559,
         1.0014523455546427,
         1.000771897485576,
         1.0004887467773014,
         1.0050382379836018,
         1.0037785458189834,
         1.0032927866680157]}
[3265079:MainThread](2024-04-25 16:58:23,097) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name final_crowd_data_csi300_360_1_ADARNN.
[3265079:MainThread](2024-04-25 16:58:23,227) INFO - qlib.workflow - [exp.py:258] - Experiment 111 starts running ...
[3265079:MainThread](2024-04-25 16:58:23,247) INFO - qlib.workflow - [recorder.py:341] - Recorder 4da055a1edbd4e9f93b1f04145b07a53 starts running under Experiment 111 ...
Time cost: 1236.2171909570693
{'1day.excess_return_with_cost.annualized_return': [0.06174374176991952,
                                                    0.03862809944330243],
 '1day.excess_return_with_cost.information_ratio': [0.8224256933334899,
                                                    0.539455183970992],
 '1day.excess_return_with_cost.max_drawdown': [-0.10477562013208339,
                                               0.055609733537291935],
 'IC': [0.020290888838157876, 0.007814413900657118],
 'ICIR': [0.15579965553444072, 0.06424923691923444],
 'Rank IC': [0.02785847872461128, 0.008420439620469952],
 'Rank ICIR': [0.20902136347606678, 0.0722776116803937],
 'mae': [0.8657939314964391, 0.00159845172913695],
 'mse': [1.0034042086278399, 0.0050293288006193135]}
[3265079:MainThread](2024-04-25 16:58:24,579) INFO - qlib.timer - [log.py:127] - Time cost: 0.046s | waiting `async_log` Done

[3075328:MainThread](2024-04-25 04:25:02,980) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[3075328:MainThread](2024-04-25 04:25:02,983) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[3075328:MainThread](2024-04-25 04:25:02,983) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/crowd_data')}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3075328:MainThread](2024-04-25 04:25:07,210) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3075328:MainThread](2024-04-25 04:25:07,321) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3075328:MainThread](2024-04-25 04:25:07,347) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3075328:MainThread](2024-04-25 04:25:07,348) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
[3075328:MainThread](2024-04-25 04:25:15,180) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ALSTM_crowd_data_csi300_360_rankTrue_43.
[3075328:MainThread](2024-04-25 04:25:15,220) INFO - qlib.workflow - [exp.py:258] - Experiment 52 starts running ...
[3075328:MainThread](2024-04-25 04:25:16,873) INFO - qlib.workflow - [recorder.py:341] - Recorder 266b2dc4d32f4b12b1cd8fdf1d5e129a starts running under Experiment 52 ...
[3075328:MainThread](2024-04-25 04:25:22,024) INFO - qlib.ALSTM - [pytorch_alstm.py:266] - training...
[3075328:MainThread](2024-04-25 04:25:22,025) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch0:
[3075328:MainThread](2024-04-25 04:25:22,025) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:25:30,369) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:25:30,580) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.001516
[3075328:MainThread](2024-04-25 04:25:30,584) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch1:
[3075328:MainThread](2024-04-25 04:25:30,585) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:25:38,072) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:25:38,282) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999823
[3075328:MainThread](2024-04-25 04:25:38,284) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch2:
[3075328:MainThread](2024-04-25 04:25:38,284) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:25:46,378) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:25:46,598) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998732
[3075328:MainThread](2024-04-25 04:25:46,600) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch3:
[3075328:MainThread](2024-04-25 04:25:46,600) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:25:54,834) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:25:55,048) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.006892
[3075328:MainThread](2024-04-25 04:25:55,048) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch4:
[3075328:MainThread](2024-04-25 04:25:55,049) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:26:03,150) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:26:03,371) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999539
[3075328:MainThread](2024-04-25 04:26:03,371) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch5:
[3075328:MainThread](2024-04-25 04:26:03,371) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:26:11,682) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:26:11,898) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.001811
[3075328:MainThread](2024-04-25 04:26:11,898) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch6:
[3075328:MainThread](2024-04-25 04:26:11,899) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:26:20,487) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:26:20,708) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.001493
[3075328:MainThread](2024-04-25 04:26:20,708) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch7:
[3075328:MainThread](2024-04-25 04:26:20,709) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:26:29,029) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:26:29,249) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.005009
[3075328:MainThread](2024-04-25 04:26:29,250) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch8:
[3075328:MainThread](2024-04-25 04:26:29,250) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:26:37,892) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:26:38,112) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998740
[3075328:MainThread](2024-04-25 04:26:38,113) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch9:
[3075328:MainThread](2024-04-25 04:26:38,113) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:26:46,293) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:26:46,504) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998714
[3075328:MainThread](2024-04-25 04:26:46,505) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch10:
[3075328:MainThread](2024-04-25 04:26:46,506) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:26:54,564) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:26:54,791) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998128
[3075328:MainThread](2024-04-25 04:26:54,792) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch11:
[3075328:MainThread](2024-04-25 04:26:54,793) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:27:02,489) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:27:02,699) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999586
[3075328:MainThread](2024-04-25 04:27:02,700) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch12:
[3075328:MainThread](2024-04-25 04:27:02,700) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:27:10,428) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:27:10,638) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997635
[3075328:MainThread](2024-04-25 04:27:10,640) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch13:
[3075328:MainThread](2024-04-25 04:27:10,640) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:27:18,399) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:27:18,609) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999254
[3075328:MainThread](2024-04-25 04:27:18,610) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch14:
[3075328:MainThread](2024-04-25 04:27:18,610) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:27:26,419) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:27:26,630) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998341
[3075328:MainThread](2024-04-25 04:27:26,630) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch15:
[3075328:MainThread](2024-04-25 04:27:26,631) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:27:34,463) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:27:34,675) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999459
[3075328:MainThread](2024-04-25 04:27:34,675) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch16:
[3075328:MainThread](2024-04-25 04:27:34,676) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:27:42,427) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:27:42,639) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997468
[3075328:MainThread](2024-04-25 04:27:42,641) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch17:
[3075328:MainThread](2024-04-25 04:27:42,641) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:27:50,407) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:27:50,618) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999420
[3075328:MainThread](2024-04-25 04:27:50,618) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch18:
[3075328:MainThread](2024-04-25 04:27:50,619) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:27:58,426) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:27:58,641) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998149
[3075328:MainThread](2024-04-25 04:27:58,641) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch19:
[3075328:MainThread](2024-04-25 04:27:58,642) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:28:06,908) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:28:07,121) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997717
[3075328:MainThread](2024-04-25 04:28:07,121) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch20:
[3075328:MainThread](2024-04-25 04:28:07,121) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:28:15,731) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:28:15,951) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998247
[3075328:MainThread](2024-04-25 04:28:15,951) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch21:
[3075328:MainThread](2024-04-25 04:28:15,951) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:28:24,576) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:28:24,786) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997443
[3075328:MainThread](2024-04-25 04:28:24,788) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch22:
[3075328:MainThread](2024-04-25 04:28:24,788) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:28:32,753) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:28:32,964) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999647
[3075328:MainThread](2024-04-25 04:28:32,964) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch23:
[3075328:MainThread](2024-04-25 04:28:32,965) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:28:41,099) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:28:41,310) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997985
[3075328:MainThread](2024-04-25 04:28:41,310) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch24:
[3075328:MainThread](2024-04-25 04:28:41,310) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:28:49,705) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:28:49,926) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998728
[3075328:MainThread](2024-04-25 04:28:49,926) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch25:
[3075328:MainThread](2024-04-25 04:28:49,926) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:28:58,398) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:28:58,611) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998932
[3075328:MainThread](2024-04-25 04:28:58,611) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch26:
[3075328:MainThread](2024-04-25 04:28:58,611) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:29:06,414) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:29:06,627) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999519
[3075328:MainThread](2024-04-25 04:29:06,627) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch27:
[3075328:MainThread](2024-04-25 04:29:06,627) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:29:14,892) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:29:15,103) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997549
[3075328:MainThread](2024-04-25 04:29:15,103) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch28:
[3075328:MainThread](2024-04-25 04:29:15,104) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:29:22,949) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:29:23,159) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998247
[3075328:MainThread](2024-04-25 04:29:23,160) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch29:
[3075328:MainThread](2024-04-25 04:29:23,160) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:29:30,964) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:29:31,174) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997607
[3075328:MainThread](2024-04-25 04:29:31,174) INFO - qlib.ALSTM - [pytorch_alstm.py:288] - early stop
[3075328:MainThread](2024-04-25 04:29:31,174) INFO - qlib.ALSTM - [pytorch_alstm.py:291] - best score: -0.997443 @ 21
[3075328:MainThread](2024-04-25 04:29:31,197) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ALSTM_crowd_data_csi300_360_rankTrue_43.
[3075328:MainThread](2024-04-25 04:29:31,448) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ALSTM_crowd_data_csi300_360_rankTrue.
[3075328:MainThread](2024-04-25 04:29:31,488) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3075328:MainThread](2024-04-25 04:29:31,501) INFO - qlib.workflow - [recorder.py:341] - Recorder bdc28a66c3da4a8cb506f1b3d2c67eb4 starts running under Experiment 53 ...
{'IC': 0.009460425373336639,
 'ICIR': 0.06965137982819328,
 'Rank IC': 0.009648519317820762,
 'Rank ICIR': 0.07157037796176006}
[3075328:MainThread](2024-04-25 04:29:37,970) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3075328:MainThread](2024-04-25 04:30:13,636) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 04:30:13,639) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 04:30:19,857) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f835a349520>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 6/971 [00:00<00:16, 57.86it/s]backtest loop:   1%|          | 12/971 [00:00<00:18, 51.89it/s]backtest loop:   2%|▏         | 19/971 [00:00<00:16, 56.62it/s]backtest loop:   3%|▎         | 25/971 [00:00<00:17, 53.70it/s]backtest loop:   3%|▎         | 32/971 [00:00<00:16, 56.72it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:16, 55.03it/s]backtest loop:   5%|▍         | 46/971 [00:00<00:16, 57.31it/s]backtest loop:   5%|▌         | 52/971 [00:00<00:15, 58.05it/s]backtest loop:   6%|▌         | 58/971 [00:01<00:16, 55.15it/s]backtest loop:   7%|▋         | 65/971 [00:01<00:15, 57.41it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 55.64it/s]backtest loop:   8%|▊         | 79/971 [00:01<00:15, 57.63it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:14, 59.03it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:15, 56.15it/s]backtest loop:  10%|█         | 99/971 [00:01<00:15, 57.93it/s]backtest loop:  11%|█         | 106/971 [00:01<00:14, 59.31it/s]backtest loop:  12%|█▏        | 112/971 [00:01<00:15, 56.29it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:14, 58.13it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 55.49it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 53.65it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:14, 56.26it/s]backtest loop:  15%|█▍        | 145/971 [00:02<00:14, 58.14it/s]backtest loop:  16%|█▌        | 151/971 [00:02<00:14, 55.51it/s]backtest loop:  16%|█▋        | 158/971 [00:02<00:14, 57.64it/s]backtest loop:  17%|█▋        | 165/971 [00:02<00:13, 59.04it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:14, 56.42it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:13, 58.47it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:13, 56.44it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:13, 58.14it/s]backtest loop:  20%|██        | 199/971 [00:03<00:12, 59.49it/s]backtest loop:  21%|██        | 205/971 [00:03<00:13, 56.52it/s]backtest loop:  22%|██▏       | 212/971 [00:03<00:12, 58.43it/s]backtest loop:  22%|██▏       | 218/971 [00:03<00:13, 55.82it/s]backtest loop:  23%|██▎       | 225/971 [00:03<00:13, 54.54it/s]backtest loop:  24%|██▍       | 232/971 [00:04<00:13, 56.81it/s]backtest loop:  25%|██▍       | 239/971 [00:04<00:12, 58.41it/s]backtest loop:  25%|██▌       | 245/971 [00:04<00:13, 55.70it/s]backtest loop:  26%|██▌       | 252/971 [00:04<00:12, 58.03it/s]backtest loop:  27%|██▋       | 259/971 [00:04<00:12, 56.06it/s]backtest loop:  27%|██▋       | 266/971 [00:04<00:12, 54.87it/s]backtest loop:  28%|██▊       | 273/971 [00:04<00:12, 56.97it/s]backtest loop:  29%|██▉       | 280/971 [00:04<00:11, 58.73it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 55.69it/s]backtest loop:  30%|███       | 293/971 [00:05<00:11, 57.52it/s]backtest loop:  31%|███       | 300/971 [00:05<00:12, 55.65it/s]backtest loop:  32%|███▏      | 307/971 [00:05<00:11, 57.45it/s]backtest loop:  32%|███▏      | 314/971 [00:05<00:11, 58.77it/s]backtest loop:  33%|███▎      | 320/971 [00:05<00:11, 56.11it/s]backtest loop:  34%|███▎      | 327/971 [00:05<00:11, 57.79it/s]backtest loop:  34%|███▍      | 334/971 [00:05<00:10, 59.11it/s]backtest loop:  35%|███▌      | 340/971 [00:05<00:11, 56.21it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:10, 57.93it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:10, 59.24it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 56.41it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.43it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 51.53it/s]backtest loop:  39%|███▉      | 379/971 [00:06<00:11, 52.45it/s]backtest loop:  40%|███▉      | 385/971 [00:06<00:11, 53.09it/s]backtest loop:  40%|████      | 391/971 [00:06<00:10, 53.10it/s]backtest loop:  41%|████      | 397/971 [00:07<00:10, 53.66it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:11, 50.84it/s]backtest loop:  42%|████▏     | 409/971 [00:07<00:10, 51.99it/s]backtest loop:  43%|████▎     | 415/971 [00:07<00:10, 52.83it/s]backtest loop:  43%|████▎     | 421/971 [00:07<00:10, 53.43it/s]backtest loop:  44%|████▍     | 427/971 [00:07<00:10, 54.01it/s]backtest loop:  45%|████▍     | 433/971 [00:07<00:10, 50.92it/s]backtest loop:  45%|████▌     | 439/971 [00:07<00:10, 52.15it/s]backtest loop:  46%|████▌     | 445/971 [00:07<00:09, 53.09it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:09, 53.54it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:10, 50.69it/s]backtest loop:  48%|████▊     | 463/971 [00:08<00:09, 51.92it/s]backtest loop:  48%|████▊     | 469/971 [00:08<00:09, 52.81it/s]backtest loop:  49%|████▉     | 475/971 [00:08<00:09, 53.53it/s]backtest loop:  50%|████▉     | 481/971 [00:08<00:09, 53.93it/s]backtest loop:  50%|█████     | 487/971 [00:08<00:09, 51.00it/s]backtest loop:  51%|█████     | 493/971 [00:08<00:09, 51.63it/s]backtest loop:  51%|█████▏    | 499/971 [00:08<00:08, 52.61it/s]backtest loop:  52%|█████▏    | 505/971 [00:09<00:09, 50.11it/s]backtest loop:  53%|█████▎    | 511/971 [00:09<00:08, 51.42it/s]backtest loop:  53%|█████▎    | 517/971 [00:09<00:09, 49.33it/s]backtest loop:  54%|█████▍    | 523/971 [00:09<00:08, 50.91it/s]backtest loop:  54%|█████▍    | 529/971 [00:09<00:08, 51.98it/s]backtest loop:  55%|█████▌    | 535/971 [00:09<00:08, 53.31it/s]backtest loop:  56%|█████▌    | 541/971 [00:09<00:08, 50.63it/s]backtest loop:  56%|█████▋    | 547/971 [00:09<00:08, 51.99it/s]backtest loop:  57%|█████▋    | 553/971 [00:10<00:07, 53.05it/s]backtest loop:  58%|█████▊    | 559/971 [00:10<00:07, 53.68it/s]backtest loop:  58%|█████▊    | 565/971 [00:10<00:07, 54.10it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 51.07it/s]backtest loop:  59%|█████▉    | 577/971 [00:10<00:07, 52.22it/s]backtest loop:  60%|██████    | 583/971 [00:10<00:07, 53.12it/s]backtest loop:  61%|██████    | 589/971 [00:10<00:07, 53.77it/s]backtest loop:  61%|██████▏   | 595/971 [00:10<00:06, 54.18it/s]backtest loop:  62%|██████▏   | 601/971 [00:10<00:07, 51.15it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 52.27it/s]backtest loop:  63%|██████▎   | 613/971 [00:11<00:06, 53.10it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:06, 54.05it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 51.28it/s]backtest loop:  65%|██████▍   | 631/971 [00:11<00:06, 52.36it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:06, 53.08it/s]backtest loop:  66%|██████▌   | 643/971 [00:11<00:06, 53.56it/s]backtest loop:  67%|██████▋   | 649/971 [00:11<00:05, 53.99it/s]backtest loop:  67%|██████▋   | 655/971 [00:11<00:06, 51.04it/s]backtest loop:  68%|██████▊   | 661/971 [00:12<00:05, 52.18it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 52.98it/s]backtest loop:  69%|██████▉   | 673/971 [00:12<00:05, 53.69it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 50.82it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 51.94it/s]backtest loop:  71%|███████   | 691/971 [00:12<00:05, 52.81it/s]backtest loop:  72%|███████▏  | 697/971 [00:12<00:05, 53.39it/s]backtest loop:  72%|███████▏  | 703/971 [00:12<00:04, 53.89it/s]backtest loop:  73%|███████▎  | 709/971 [00:13<00:05, 50.90it/s]backtest loop:  74%|███████▎  | 715/971 [00:13<00:04, 52.15it/s]backtest loop:  74%|███████▍  | 721/971 [00:13<00:04, 53.11it/s]backtest loop:  75%|███████▍  | 727/971 [00:13<00:04, 53.83it/s]backtest loop:  75%|███████▌  | 733/971 [00:13<00:04, 48.18it/s]backtest loop:  76%|███████▌  | 739/971 [00:13<00:04, 49.96it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:04, 51.56it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 49.54it/s]backtest loop:  78%|███████▊  | 757/971 [00:13<00:04, 51.08it/s]backtest loop:  79%|███████▊  | 763/971 [00:14<00:03, 52.27it/s]backtest loop:  79%|███████▉  | 769/971 [00:14<00:03, 53.23it/s]backtest loop:  80%|███████▉  | 775/971 [00:14<00:03, 50.59it/s]backtest loop:  80%|████████  | 781/971 [00:14<00:03, 51.85it/s]backtest loop:  81%|████████  | 787/971 [00:14<00:03, 52.81it/s]backtest loop:  82%|████████▏ | 793/971 [00:14<00:03, 50.35it/s]backtest loop:  82%|████████▏ | 799/971 [00:14<00:03, 51.72it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:03, 52.58it/s]backtest loop:  84%|████████▎ | 811/971 [00:14<00:03, 53.28it/s]backtest loop:  84%|████████▍ | 817/971 [00:15<00:02, 53.82it/s]backtest loop:  85%|████████▍ | 823/971 [00:15<00:02, 50.88it/s]backtest loop:  85%|████████▌ | 829/971 [00:15<00:02, 52.22it/s]backtest loop:  86%|████████▌ | 835/971 [00:15<00:02, 52.93it/s]backtest loop:  87%|████████▋ | 841/971 [00:15<00:02, 53.59it/s]backtest loop:  87%|████████▋ | 847/971 [00:15<00:02, 54.04it/s]backtest loop:  88%|████████▊ | 853/971 [00:15<00:02, 51.20it/s]backtest loop:  88%|████████▊ | 859/971 [00:15<00:02, 52.30it/s]backtest loop:  89%|████████▉ | 865/971 [00:15<00:01, 53.10it/s]backtest loop:  90%|████████▉ | 871/971 [00:16<00:01, 53.66it/s]backtest loop:  90%|█████████ | 877/971 [00:16<00:01, 50.86it/s]backtest loop:  91%|█████████ | 883/971 [00:16<00:01, 52.09it/s]backtest loop:  92%|█████████▏| 889/971 [00:16<00:01, 52.88it/s]backtest loop:  92%|█████████▏| 895/971 [00:16<00:01, 53.51it/s]backtest loop:  93%|█████████▎| 901/971 [00:16<00:01, 53.93it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 50.78it/s]backtest loop:  94%|█████████▍| 913/971 [00:16<00:01, 52.10it/s]backtest loop:  95%|█████████▍| 919/971 [00:17<00:00, 52.93it/s]backtest loop:  95%|█████████▌| 925/971 [00:17<00:00, 53.55it/s]backtest loop:  96%|█████████▌| 931/971 [00:17<00:00, 50.90it/s]backtest loop:  97%|█████████▋| 938/971 [00:17<00:00, 54.24it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 53.39it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 56.00it/s]backtest loop:  99%|█████████▊| 958/971 [00:17<00:00, 57.03it/s]backtest loop:  99%|█████████▉| 964/971 [00:17<00:00, 57.83it/s]backtest loop: 100%|█████████▉| 970/971 [00:17<00:00, 54.93it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.06it/s]
[3075328:MainThread](2024-04-25 04:30:37,878) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000274
std                0.006228
annualized_return  0.065162
information_ratio  0.678185
max_drawdown      -0.160357
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000073
std                0.006229
annualized_return  0.017309
information_ratio  0.180109
max_drawdown      -0.200642
[3075328:MainThread](2024-04-25 04:30:37,891) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ALSTM_crowd_data_csi300_360_rankTrue`.
[3075328:MainThread](2024-04-25 04:30:44,518) INFO - qlib.timer - [log.py:127] - Time cost: 0.007s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.017308512649334296],
 '1day.excess_return_with_cost.information_ratio': [0.18010918865041212],
 '1day.excess_return_with_cost.max_drawdown': [-0.20064185075338067],
 'IC': [0.009460425373336639],
 'ICIR': [0.06965137982819328],
 'Rank IC': [0.009648519317820762],
 'Rank ICIR': [0.07157037796176006],
 'mae': [0.8649170762273879],
 'mse': [0.9979492119324258]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3075328:MainThread](2024-04-25 04:30:47,718) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3075328:MainThread](2024-04-25 04:30:47,718) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3075328:MainThread](2024-04-25 04:30:47,720) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3075328:MainThread](2024-04-25 04:30:47,721) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
[3075328:MainThread](2024-04-25 04:30:50,560) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ALSTM_crowd_data_csi300_360_rankTrue_44.
[3075328:MainThread](2024-04-25 04:30:50,605) INFO - qlib.workflow - [exp.py:258] - Experiment 54 starts running ...
[3075328:MainThread](2024-04-25 04:30:50,617) INFO - qlib.workflow - [recorder.py:341] - Recorder 68d907a10a2248028e1795a97c477e4f starts running under Experiment 54 ...
[3075328:MainThread](2024-04-25 04:30:55,568) INFO - qlib.ALSTM - [pytorch_alstm.py:266] - training...
[3075328:MainThread](2024-04-25 04:30:55,569) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch0:
[3075328:MainThread](2024-04-25 04:30:55,569) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:31:03,563) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:31:03,775) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998663
[3075328:MainThread](2024-04-25 04:31:03,776) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch1:
[3075328:MainThread](2024-04-25 04:31:03,777) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:31:11,715) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:31:11,925) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997910
[3075328:MainThread](2024-04-25 04:31:11,927) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch2:
[3075328:MainThread](2024-04-25 04:31:11,927) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:31:20,311) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:31:20,523) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998421
[3075328:MainThread](2024-04-25 04:31:20,524) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch3:
[3075328:MainThread](2024-04-25 04:31:20,524) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:31:28,714) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:31:28,924) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999595
[3075328:MainThread](2024-04-25 04:31:28,924) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch4:
[3075328:MainThread](2024-04-25 04:31:28,924) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:31:36,864) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:31:37,075) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997120
[3075328:MainThread](2024-04-25 04:31:37,077) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch5:
[3075328:MainThread](2024-04-25 04:31:37,077) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:31:45,617) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:31:45,826) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.000408
[3075328:MainThread](2024-04-25 04:31:45,827) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch6:
[3075328:MainThread](2024-04-25 04:31:45,827) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:31:54,456) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:31:54,666) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998915
[3075328:MainThread](2024-04-25 04:31:54,666) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch7:
[3075328:MainThread](2024-04-25 04:31:54,666) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:32:02,626) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:32:02,836) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999551
[3075328:MainThread](2024-04-25 04:32:02,837) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch8:
[3075328:MainThread](2024-04-25 04:32:02,837) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:32:10,769) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:32:10,978) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998121
[3075328:MainThread](2024-04-25 04:32:10,978) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch9:
[3075328:MainThread](2024-04-25 04:32:10,979) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:32:18,890) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:32:19,099) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998324
[3075328:MainThread](2024-04-25 04:32:19,099) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch10:
[3075328:MainThread](2024-04-25 04:32:19,099) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:32:27,206) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:32:27,416) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.000092
[3075328:MainThread](2024-04-25 04:32:27,417) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch11:
[3075328:MainThread](2024-04-25 04:32:27,417) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:32:35,582) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:32:35,790) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997077
[3075328:MainThread](2024-04-25 04:32:35,792) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch12:
[3075328:MainThread](2024-04-25 04:32:35,792) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:32:44,093) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:32:44,313) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.996917
[3075328:MainThread](2024-04-25 04:32:44,314) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch13:
[3075328:MainThread](2024-04-25 04:32:44,314) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:32:53,076) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:32:53,296) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999347
[3075328:MainThread](2024-04-25 04:32:53,296) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch14:
[3075328:MainThread](2024-04-25 04:32:53,296) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:33:01,571) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:33:01,781) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997141
[3075328:MainThread](2024-04-25 04:33:01,781) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch15:
[3075328:MainThread](2024-04-25 04:33:01,781) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:33:09,971) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:33:10,184) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998073
[3075328:MainThread](2024-04-25 04:33:10,184) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch16:
[3075328:MainThread](2024-04-25 04:33:10,184) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:33:18,251) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:33:18,461) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999541
[3075328:MainThread](2024-04-25 04:33:18,462) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch17:
[3075328:MainThread](2024-04-25 04:33:18,462) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:33:26,806) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:33:27,025) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998048
[3075328:MainThread](2024-04-25 04:33:27,025) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch18:
[3075328:MainThread](2024-04-25 04:33:27,025) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:33:35,760) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:33:35,979) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.000356
[3075328:MainThread](2024-04-25 04:33:35,980) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch19:
[3075328:MainThread](2024-04-25 04:33:35,980) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:33:44,432) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:33:44,646) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998859
[3075328:MainThread](2024-04-25 04:33:44,646) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch20:
[3075328:MainThread](2024-04-25 04:33:44,646) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:33:52,581) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:33:52,791) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998757
[3075328:MainThread](2024-04-25 04:33:52,791) INFO - qlib.ALSTM - [pytorch_alstm.py:288] - early stop
[3075328:MainThread](2024-04-25 04:33:52,791) INFO - qlib.ALSTM - [pytorch_alstm.py:291] - best score: -0.996917 @ 12
[3075328:MainThread](2024-04-25 04:33:52,814) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ALSTM_crowd_data_csi300_360_rankTrue_44.
[3075328:MainThread](2024-04-25 04:33:53,054) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3075328:MainThread](2024-04-25 04:33:53,067) INFO - qlib.workflow - [recorder.py:341] - Recorder 4dd503f9c29446b5a556cf0c01703186 starts running under Experiment 53 ...
{'IC': 0.008745406877420814,
 'ICIR': 0.05342470255464294,
 'Rank IC': 0.02047129256618671,
 'Rank ICIR': 0.12302168329159428}
[3075328:MainThread](2024-04-25 04:33:59,492) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3075328:MainThread](2024-04-25 04:34:35,957) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 04:34:35,960) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 04:34:41,967) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f82f6f895e0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:44,  9.29it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.47it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 34.86it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.73it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.51it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 49.34it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:18, 49.35it/s]backtest loop:   5%|▍         | 46/971 [00:01<00:17, 53.63it/s]backtest loop:   5%|▌         | 53/971 [00:01<00:16, 56.23it/s]backtest loop:   6%|▌         | 59/971 [00:01<00:16, 54.06it/s]backtest loop:   7%|▋         | 66/971 [00:01<00:15, 56.92it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 54.64it/s]backtest loop:   8%|▊         | 79/971 [00:01<00:15, 56.80it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:15, 58.88it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:15, 55.99it/s]backtest loop:  10%|█         | 98/971 [00:01<00:15, 56.96it/s]backtest loop:  11%|█         | 105/971 [00:02<00:14, 58.51it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 56.40it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:14, 58.10it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 55.48it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 53.64it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:14, 56.41it/s]backtest loop:  15%|█▍        | 145/971 [00:02<00:14, 57.91it/s]backtest loop:  16%|█▌        | 151/971 [00:02<00:14, 54.99it/s]backtest loop:  16%|█▌        | 157/971 [00:03<00:14, 56.24it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:14, 57.06it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:13, 58.67it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 55.67it/s]backtest loop:  19%|█▊        | 182/971 [00:03<00:13, 56.54it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 57.43it/s]backtest loop:  20%|██        | 195/971 [00:03<00:13, 55.86it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 57.72it/s]backtest loop:  22%|██▏       | 209/971 [00:03<00:12, 59.34it/s]backtest loop:  22%|██▏       | 215/971 [00:04<00:14, 53.18it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:20, 36.16it/s]backtest loop:  23%|██▎       | 228/971 [00:04<00:18, 40.63it/s]backtest loop:  24%|██▍       | 234/971 [00:04<00:16, 44.40it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:15, 45.72it/s]backtest loop:  25%|██▌       | 246/971 [00:04<00:14, 48.84it/s]backtest loop:  26%|██▌       | 252/971 [00:04<00:13, 51.58it/s]backtest loop:  27%|██▋       | 259/971 [00:05<00:13, 51.65it/s]backtest loop:  27%|██▋       | 266/971 [00:05<00:13, 51.59it/s]backtest loop:  28%|██▊       | 272/971 [00:05<00:13, 53.69it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:12, 56.15it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 54.86it/s]backtest loop:  30%|███       | 292/971 [00:05<00:12, 56.06it/s]backtest loop:  31%|███       | 299/971 [00:05<00:11, 57.85it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:12, 55.09it/s]backtest loop:  32%|███▏      | 312/971 [00:06<00:11, 57.19it/s]backtest loop:  33%|███▎      | 319/971 [00:06<00:11, 58.63it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:11, 55.77it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:11, 57.65it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 59.14it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 56.02it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 57.84it/s]backtest loop:  37%|███▋      | 359/971 [00:06<00:10, 59.19it/s]backtest loop:  38%|███▊      | 365/971 [00:06<00:10, 56.46it/s]backtest loop:  38%|███▊      | 371/971 [00:07<00:10, 54.80it/s]backtest loop:  39%|███▉      | 378/971 [00:07<00:11, 53.90it/s]backtest loop:  40%|███▉      | 385/971 [00:07<00:10, 56.36it/s]backtest loop:  40%|████      | 392/971 [00:07<00:09, 58.26it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 55.54it/s]backtest loop:  42%|████▏     | 404/971 [00:07<00:09, 56.72it/s]backtest loop:  42%|████▏     | 411/971 [00:07<00:09, 59.49it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:09, 56.90it/s]backtest loop:  44%|████▎     | 424/971 [00:07<00:09, 56.64it/s]backtest loop:  44%|████▍     | 430/971 [00:08<00:09, 56.17it/s]backtest loop:  45%|████▍     | 436/971 [00:08<00:09, 55.83it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:10, 52.40it/s]backtest loop:  46%|████▌     | 448/971 [00:08<00:09, 53.68it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:09, 54.05it/s]backtest loop:  47%|████▋     | 460/971 [00:08<00:09, 54.18it/s]backtest loop:  48%|████▊     | 466/971 [00:08<00:09, 54.35it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:09, 51.19it/s]backtest loop:  49%|████▉     | 478/971 [00:09<00:09, 52.09it/s]backtest loop:  50%|████▉     | 484/971 [00:09<00:09, 52.91it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:09, 50.46it/s]backtest loop:  51%|█████     | 496/971 [00:09<00:09, 51.43it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:08, 52.41it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:09, 50.12it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 50.83it/s]backtest loop:  54%|█████▎    | 520/971 [00:09<00:08, 52.03it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 49.78it/s]backtest loop:  55%|█████▍    | 532/971 [00:10<00:08, 51.15it/s]backtest loop:  55%|█████▌    | 538/971 [00:10<00:08, 52.20it/s]backtest loop:  56%|█████▌    | 544/971 [00:10<00:08, 52.96it/s]backtest loop:  57%|█████▋    | 550/971 [00:10<00:07, 53.46it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:08, 50.53it/s]backtest loop:  58%|█████▊    | 562/971 [00:10<00:07, 51.76it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:07, 52.86it/s]backtest loop:  59%|█████▉    | 574/971 [00:10<00:07, 54.39it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:07, 55.03it/s]backtest loop:  60%|██████    | 586/971 [00:11<00:07, 51.69it/s]backtest loop:  61%|██████    | 592/971 [00:11<00:07, 52.63it/s]backtest loop:  62%|██████▏   | 598/971 [00:11<00:06, 53.32it/s]backtest loop:  62%|██████▏   | 604/971 [00:11<00:06, 53.85it/s]backtest loop:  63%|██████▎   | 610/971 [00:11<00:07, 50.85it/s]backtest loop:  63%|██████▎   | 616/971 [00:11<00:06, 52.03it/s]backtest loop:  64%|██████▍   | 622/971 [00:11<00:06, 52.90it/s]backtest loop:  65%|██████▍   | 628/971 [00:11<00:06, 53.55it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:06, 54.06it/s]backtest loop:  66%|██████▌   | 640/971 [00:12<00:06, 51.11it/s]backtest loop:  67%|██████▋   | 646/971 [00:12<00:06, 52.21it/s]backtest loop:  67%|██████▋   | 652/971 [00:12<00:06, 53.05it/s]backtest loop:  68%|██████▊   | 658/971 [00:12<00:05, 53.68it/s]backtest loop:  68%|██████▊   | 664/971 [00:12<00:05, 54.02it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 51.05it/s]backtest loop:  70%|██████▉   | 676/971 [00:12<00:05, 52.10it/s]backtest loop:  70%|███████   | 682/971 [00:12<00:05, 52.93it/s]backtest loop:  71%|███████   | 688/971 [00:13<00:05, 53.33it/s]backtest loop:  71%|███████▏  | 694/971 [00:13<00:05, 50.56it/s]backtest loop:  72%|███████▏  | 700/971 [00:13<00:05, 51.89it/s]backtest loop:  73%|███████▎  | 706/971 [00:13<00:05, 52.66it/s]backtest loop:  73%|███████▎  | 712/971 [00:13<00:04, 53.27it/s]backtest loop:  74%|███████▍  | 718/971 [00:13<00:04, 53.91it/s]backtest loop:  75%|███████▍  | 724/971 [00:13<00:04, 50.93it/s]backtest loop:  75%|███████▌  | 730/971 [00:13<00:04, 52.04it/s]backtest loop:  76%|███████▌  | 736/971 [00:13<00:04, 49.74it/s]backtest loop:  76%|███████▋  | 742/971 [00:14<00:04, 51.09it/s]backtest loop:  77%|███████▋  | 748/971 [00:14<00:04, 48.87it/s]backtest loop:  78%|███████▊  | 754/971 [00:14<00:04, 50.51it/s]backtest loop:  78%|███████▊  | 760/971 [00:14<00:04, 48.84it/s]backtest loop:  79%|███████▉  | 766/971 [00:14<00:04, 50.50it/s]backtest loop:  80%|███████▉  | 772/971 [00:14<00:03, 51.71it/s]backtest loop:  80%|████████  | 778/971 [00:14<00:03, 52.71it/s]backtest loop:  81%|████████  | 784/971 [00:14<00:03, 50.87it/s]backtest loop:  81%|████████▏ | 790/971 [00:15<00:03, 51.48it/s]backtest loop:  82%|████████▏ | 796/971 [00:15<00:03, 52.48it/s]backtest loop:  83%|████████▎ | 802/971 [00:15<00:03, 53.15it/s]backtest loop:  83%|████████▎ | 808/971 [00:15<00:03, 50.30it/s]backtest loop:  84%|████████▍ | 814/971 [00:15<00:03, 51.54it/s]backtest loop:  84%|████████▍ | 820/971 [00:15<00:02, 52.57it/s]backtest loop:  85%|████████▌ | 826/971 [00:15<00:02, 53.24it/s]backtest loop:  86%|████████▌ | 832/971 [00:15<00:02, 53.75it/s]backtest loop:  86%|████████▋ | 838/971 [00:15<00:02, 50.76it/s]backtest loop:  87%|████████▋ | 844/971 [00:16<00:02, 51.96it/s]backtest loop:  88%|████████▊ | 850/971 [00:16<00:02, 52.84it/s]backtest loop:  88%|████████▊ | 856/971 [00:16<00:02, 53.46it/s]backtest loop:  89%|████████▉ | 862/971 [00:16<00:02, 50.61it/s]backtest loop:  89%|████████▉ | 868/971 [00:16<00:01, 51.78it/s]backtest loop:  90%|█████████ | 874/971 [00:16<00:01, 52.73it/s]backtest loop:  91%|█████████ | 880/971 [00:16<00:01, 53.40it/s]backtest loop:  91%|█████████ | 886/971 [00:16<00:01, 53.96it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 51.00it/s]backtest loop:  92%|█████████▏| 898/971 [00:17<00:01, 52.20it/s]backtest loop:  93%|█████████▎| 904/971 [00:17<00:01, 52.98it/s]backtest loop:  94%|█████████▎| 910/971 [00:17<00:01, 53.74it/s]backtest loop:  94%|█████████▍| 916/971 [00:17<00:01, 50.82it/s]backtest loop:  95%|█████████▍| 922/971 [00:17<00:00, 52.00it/s]backtest loop:  96%|█████████▌| 928/971 [00:17<00:00, 52.89it/s]backtest loop:  96%|█████████▌| 934/971 [00:17<00:00, 53.42it/s]backtest loop:  97%|█████████▋| 940/971 [00:17<00:00, 50.60it/s]backtest loop:  97%|█████████▋| 946/971 [00:17<00:00, 51.77it/s]backtest loop:  98%|█████████▊| 952/971 [00:18<00:00, 52.88it/s]backtest loop:  99%|█████████▊| 958/971 [00:18<00:00, 53.53it/s]backtest loop:  99%|█████████▉| 964/971 [00:18<00:00, 53.98it/s]backtest loop: 100%|█████████▉| 970/971 [00:18<00:00, 50.96it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 52.59it/s]
[3075328:MainThread](2024-04-25 04:35:00,492) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000309
std                0.005572
annualized_return  0.073433
information_ratio  0.854301
max_drawdown      -0.127883
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000106
std                0.005573
annualized_return  0.025227
information_ratio  0.293425
max_drawdown      -0.148707
[3075328:MainThread](2024-04-25 04:35:00,506) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ALSTM_crowd_data_csi300_360_rankTrue`.
[3075328:MainThread](2024-04-25 04:35:07,265) INFO - qlib.timer - [log.py:127] - Time cost: 0.005s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.017308512649334296,
                                                    0.025226956174298033],
 '1day.excess_return_with_cost.information_ratio': [0.18010918865041212,
                                                    0.2934252565629728],
 '1day.excess_return_with_cost.max_drawdown': [-0.20064185075338067,
                                               -0.14870747098105508],
 'IC': [0.009460425373336639, 0.008745406877420814],
 'ICIR': [0.06965137982819328, 0.05342470255464294],
 'Rank IC': [0.009648519317820762, 0.02047129256618671],
 'Rank ICIR': [0.07157037796176006, 0.12302168329159428],
 'mae': [0.8649170762273879, 0.8647050803459836],
 'mse': [0.9979492119324258, 0.9973789235077785]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3075328:MainThread](2024-04-25 04:35:10,419) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3075328:MainThread](2024-04-25 04:35:10,420) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3075328:MainThread](2024-04-25 04:35:10,422) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3075328:MainThread](2024-04-25 04:35:10,422) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
[3075328:MainThread](2024-04-25 04:35:13,234) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ALSTM_crowd_data_csi300_360_rankTrue_45.
[3075328:MainThread](2024-04-25 04:35:13,277) INFO - qlib.workflow - [exp.py:258] - Experiment 55 starts running ...
[3075328:MainThread](2024-04-25 04:35:13,294) INFO - qlib.workflow - [recorder.py:341] - Recorder db56bab882654c80ba0a663fdc5c027d starts running under Experiment 55 ...
[3075328:MainThread](2024-04-25 04:35:18,227) INFO - qlib.ALSTM - [pytorch_alstm.py:266] - training...
[3075328:MainThread](2024-04-25 04:35:18,227) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch0:
[3075328:MainThread](2024-04-25 04:35:18,228) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:35:26,074) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:35:26,284) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.000025
[3075328:MainThread](2024-04-25 04:35:26,286) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch1:
[3075328:MainThread](2024-04-25 04:35:26,286) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:35:34,366) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:35:34,586) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998265
[3075328:MainThread](2024-04-25 04:35:34,587) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch2:
[3075328:MainThread](2024-04-25 04:35:34,588) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:35:42,674) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:35:42,887) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998180
[3075328:MainThread](2024-04-25 04:35:42,888) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch3:
[3075328:MainThread](2024-04-25 04:35:42,889) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:35:50,826) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:35:51,047) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998438
[3075328:MainThread](2024-04-25 04:35:51,048) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch4:
[3075328:MainThread](2024-04-25 04:35:51,048) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:35:59,620) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:35:59,840) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997663
[3075328:MainThread](2024-04-25 04:35:59,841) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch5:
[3075328:MainThread](2024-04-25 04:35:59,841) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:36:08,672) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:36:08,892) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.001573
[3075328:MainThread](2024-04-25 04:36:08,892) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch6:
[3075328:MainThread](2024-04-25 04:36:08,893) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:36:17,649) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:36:17,862) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997893
[3075328:MainThread](2024-04-25 04:36:17,862) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch7:
[3075328:MainThread](2024-04-25 04:36:17,862) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:36:25,799) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:36:26,011) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998384
[3075328:MainThread](2024-04-25 04:36:26,011) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch8:
[3075328:MainThread](2024-04-25 04:36:26,011) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:36:33,960) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:36:34,176) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999410
[3075328:MainThread](2024-04-25 04:36:34,176) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch9:
[3075328:MainThread](2024-04-25 04:36:34,176) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:36:42,549) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:36:42,762) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999231
[3075328:MainThread](2024-04-25 04:36:42,763) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch10:
[3075328:MainThread](2024-04-25 04:36:42,763) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:36:51,536) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:36:51,757) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999605
[3075328:MainThread](2024-04-25 04:36:51,757) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch11:
[3075328:MainThread](2024-04-25 04:36:51,757) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:36:59,828) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:37:00,038) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997504
[3075328:MainThread](2024-04-25 04:37:00,040) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch12:
[3075328:MainThread](2024-04-25 04:37:00,040) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:37:08,012) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:37:08,222) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997727
[3075328:MainThread](2024-04-25 04:37:08,222) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch13:
[3075328:MainThread](2024-04-25 04:37:08,223) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:37:16,503) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:37:16,724) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999811
[3075328:MainThread](2024-04-25 04:37:16,724) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch14:
[3075328:MainThread](2024-04-25 04:37:16,725) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:37:24,766) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:37:24,980) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998353
[3075328:MainThread](2024-04-25 04:37:24,980) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch15:
[3075328:MainThread](2024-04-25 04:37:24,980) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:37:33,073) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:37:33,284) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997518
[3075328:MainThread](2024-04-25 04:37:33,284) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch16:
[3075328:MainThread](2024-04-25 04:37:33,284) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:37:41,477) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:37:41,688) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997385
[3075328:MainThread](2024-04-25 04:37:41,689) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch17:
[3075328:MainThread](2024-04-25 04:37:41,690) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:37:49,642) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:37:49,852) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999249
[3075328:MainThread](2024-04-25 04:37:49,853) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch18:
[3075328:MainThread](2024-04-25 04:37:49,853) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:37:57,753) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:37:57,966) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999466
[3075328:MainThread](2024-04-25 04:37:57,967) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch19:
[3075328:MainThread](2024-04-25 04:37:57,967) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:38:05,713) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:38:05,926) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998217
[3075328:MainThread](2024-04-25 04:38:05,927) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch20:
[3075328:MainThread](2024-04-25 04:38:05,927) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:38:13,761) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:38:13,971) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998480
[3075328:MainThread](2024-04-25 04:38:13,972) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch21:
[3075328:MainThread](2024-04-25 04:38:13,972) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:38:21,915) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:38:22,127) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998031
[3075328:MainThread](2024-04-25 04:38:22,127) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch22:
[3075328:MainThread](2024-04-25 04:38:22,127) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:38:29,926) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:38:30,137) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998349
[3075328:MainThread](2024-04-25 04:38:30,137) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch23:
[3075328:MainThread](2024-04-25 04:38:30,137) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:38:38,299) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:38:38,512) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999202
[3075328:MainThread](2024-04-25 04:38:38,513) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch24:
[3075328:MainThread](2024-04-25 04:38:38,513) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:38:46,386) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:38:46,606) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998770
[3075328:MainThread](2024-04-25 04:38:46,607) INFO - qlib.ALSTM - [pytorch_alstm.py:288] - early stop
[3075328:MainThread](2024-04-25 04:38:46,607) INFO - qlib.ALSTM - [pytorch_alstm.py:291] - best score: -0.997385 @ 16
[3075328:MainThread](2024-04-25 04:38:46,632) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ALSTM_crowd_data_csi300_360_rankTrue_45.
[3075328:MainThread](2024-04-25 04:38:46,868) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3075328:MainThread](2024-04-25 04:38:46,881) INFO - qlib.workflow - [recorder.py:341] - Recorder 2bb5e0bb69594b46b1e13e33a157ae0e starts running under Experiment 53 ...
{'IC': 0.015760138418877627,
 'ICIR': 0.11363008207509598,
 'Rank IC': 0.03334113414017674,
 'Rank ICIR': 0.2406959310867998}
[3075328:MainThread](2024-04-25 04:38:53,385) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3075328:MainThread](2024-04-25 04:39:30,198) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 04:39:30,201) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 04:39:36,195) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f83644f6fd0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:39,  9.69it/s]backtest loop:   1%|          | 9/971 [00:00<00:37, 25.54it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 37.92it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.52it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 46.07it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:18, 50.13it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:18, 49.92it/s]backtest loop:   5%|▍         | 46/971 [00:01<00:17, 53.72it/s]backtest loop:   5%|▌         | 53/971 [00:01<00:16, 56.46it/s]backtest loop:   6%|▌         | 59/971 [00:01<00:16, 53.94it/s]backtest loop:   7%|▋         | 66/971 [00:01<00:15, 56.90it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 55.12it/s]backtest loop:   8%|▊         | 79/971 [00:01<00:15, 57.46it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:15, 58.98it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:15, 55.94it/s]backtest loop:  10%|█         | 99/971 [00:01<00:15, 57.76it/s]backtest loop:  11%|█         | 106/971 [00:02<00:14, 59.31it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 56.37it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:14, 58.18it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 55.22it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 54.11it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:14, 57.96it/s]backtest loop:  15%|█▍        | 145/971 [00:02<00:13, 59.66it/s]backtest loop:  16%|█▌        | 152/971 [00:02<00:14, 57.21it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:14, 57.72it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:13, 59.21it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:14, 57.06it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:13, 59.00it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:13, 56.75it/s]backtest loop:  20%|█▉        | 191/971 [00:03<00:13, 57.55it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 58.17it/s]backtest loop:  21%|██        | 204/971 [00:03<00:12, 59.64it/s]backtest loop:  22%|██▏       | 210/971 [00:03<00:13, 56.61it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 54.61it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:19, 37.67it/s]backtest loop:  23%|██▎       | 228/971 [00:04<00:17, 42.20it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:16, 45.08it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:14, 49.53it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:14, 50.23it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:13, 53.44it/s]backtest loop:  27%|██▋       | 263/971 [00:05<00:12, 55.92it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:12, 54.13it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:12, 53.53it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:12, 56.04it/s]backtest loop:  30%|██▉       | 290/971 [00:05<00:11, 57.78it/s]backtest loop:  30%|███       | 296/971 [00:05<00:12, 55.39it/s]backtest loop:  31%|███       | 303/971 [00:05<00:11, 57.54it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:11, 55.88it/s]backtest loop:  33%|███▎      | 317/971 [00:05<00:11, 57.89it/s]backtest loop:  33%|███▎      | 324/971 [00:06<00:10, 59.18it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:11, 56.20it/s]backtest loop:  35%|███▍      | 337/971 [00:06<00:10, 58.32it/s]backtest loop:  35%|███▌      | 344/971 [00:06<00:10, 59.58it/s]backtest loop:  36%|███▌      | 350/971 [00:06<00:10, 56.69it/s]backtest loop:  37%|███▋      | 357/971 [00:06<00:10, 58.29it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:10, 56.10it/s]backtest loop:  38%|███▊      | 369/971 [00:06<00:11, 53.89it/s]backtest loop:  39%|███▊      | 376/971 [00:07<00:10, 56.49it/s]backtest loop:  39%|███▉      | 383/971 [00:07<00:10, 55.12it/s]backtest loop:  40%|████      | 390/971 [00:07<00:10, 57.47it/s]backtest loop:  41%|████      | 397/971 [00:07<00:09, 59.04it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 56.03it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:09, 58.64it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 60.08it/s]backtest loop:  44%|████▎     | 424/971 [00:07<00:09, 57.40it/s]backtest loop:  44%|████▍     | 431/971 [00:07<00:09, 58.83it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:09, 55.92it/s]backtest loop:  46%|████▌     | 444/971 [00:08<00:09, 58.34it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:08, 59.72it/s]backtest loop:  47%|████▋     | 458/971 [00:08<00:08, 57.10it/s]backtest loop:  48%|████▊     | 465/971 [00:08<00:08, 58.60it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:08, 56.51it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 58.09it/s]backtest loop:  50%|█████     | 486/971 [00:08<00:08, 59.30it/s]backtest loop:  51%|█████     | 492/971 [00:09<00:08, 56.29it/s]backtest loop:  51%|█████▏    | 499/971 [00:09<00:08, 58.19it/s]backtest loop:  52%|█████▏    | 505/971 [00:09<00:08, 55.55it/s]backtest loop:  53%|█████▎    | 512/971 [00:09<00:08, 54.34it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:07, 56.91it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 55.43it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:07, 57.49it/s]backtest loop:  56%|█████▌    | 540/971 [00:09<00:07, 59.15it/s]backtest loop:  56%|█████▌    | 546/971 [00:09<00:07, 56.14it/s]backtest loop:  57%|█████▋    | 553/971 [00:10<00:07, 57.95it/s]backtest loop:  58%|█████▊    | 560/971 [00:10<00:06, 59.29it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 56.23it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:06, 57.94it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 59.31it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:06, 56.99it/s]backtest loop:  61%|██████    | 593/971 [00:10<00:06, 58.58it/s]backtest loop:  62%|██████▏   | 600/971 [00:10<00:06, 56.47it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 58.15it/s]backtest loop:  63%|██████▎   | 613/971 [00:11<00:06, 58.16it/s]backtest loop:  64%|██████▍   | 620/971 [00:11<00:06, 56.17it/s]backtest loop:  65%|██████▍   | 627/971 [00:11<00:05, 57.96it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:05, 59.27it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:05, 56.37it/s]backtest loop:  67%|██████▋   | 647/971 [00:11<00:05, 58.11it/s]backtest loop:  67%|██████▋   | 654/971 [00:11<00:05, 59.36it/s]backtest loop:  68%|██████▊   | 660/971 [00:11<00:05, 56.30it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 58.07it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:05, 56.04it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:05, 57.86it/s]backtest loop:  71%|███████   | 687/971 [00:12<00:04, 58.40it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:04, 56.27it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 58.10it/s]backtest loop:  73%|███████▎  | 707/971 [00:12<00:04, 57.90it/s]backtest loop:  74%|███████▎  | 714/971 [00:12<00:04, 55.97it/s]backtest loop:  74%|███████▍  | 721/971 [00:13<00:04, 57.76it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 59.09it/s]backtest loop:  76%|███████▌  | 734/971 [00:13<00:04, 53.21it/s]backtest loop:  76%|███████▌  | 740/971 [00:13<00:04, 54.95it/s]backtest loop:  77%|███████▋  | 747/971 [00:13<00:03, 57.12it/s]backtest loop:  78%|███████▊  | 753/971 [00:13<00:03, 54.71it/s]backtest loop:  78%|███████▊  | 760/971 [00:13<00:03, 53.93it/s]backtest loop:  79%|███████▉  | 767/971 [00:13<00:03, 56.34it/s]backtest loop:  80%|███████▉  | 774/971 [00:13<00:03, 58.05it/s]backtest loop:  80%|████████  | 780/971 [00:14<00:03, 55.45it/s]backtest loop:  81%|████████  | 787/971 [00:14<00:03, 57.48it/s]backtest loop:  82%|████████▏ | 793/971 [00:14<00:03, 54.96it/s]backtest loop:  82%|████████▏ | 799/971 [00:14<00:03, 55.85it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:02, 56.99it/s]backtest loop:  84%|████████▎ | 812/971 [00:14<00:02, 58.61it/s]backtest loop:  84%|████████▍ | 818/971 [00:14<00:02, 55.79it/s]backtest loop:  85%|████████▍ | 825/971 [00:14<00:02, 57.81it/s]backtest loop:  86%|████████▌ | 832/971 [00:14<00:02, 59.25it/s]backtest loop:  86%|████████▋ | 838/971 [00:15<00:02, 56.17it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 57.98it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 56.03it/s]backtest loop:  88%|████████▊ | 859/971 [00:15<00:01, 57.84it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 59.16it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 56.09it/s]backtest loop:  91%|█████████ | 879/971 [00:15<00:01, 57.99it/s]backtest loop:  91%|█████████ | 886/971 [00:15<00:01, 59.37it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 56.27it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 58.09it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 59.36it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 56.29it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 58.05it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 56.11it/s]backtest loop:  96%|█████████▌| 932/971 [00:16<00:00, 57.11it/s]backtest loop:  97%|█████████▋| 939/971 [00:16<00:00, 58.66it/s]backtest loop:  97%|█████████▋| 945/971 [00:16<00:00, 55.96it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 57.89it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 59.27it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 56.21it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.82it/s]
[3075328:MainThread](2024-04-25 04:39:53,648) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000432
std                0.005457
annualized_return  0.102899
information_ratio  1.222345
max_drawdown      -0.106178
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000233
std                0.005458
annualized_return  0.055417
information_ratio  0.658159
max_drawdown      -0.122172
[3075328:MainThread](2024-04-25 04:39:53,662) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ALSTM_crowd_data_csi300_360_rankTrue`.
[3075328:MainThread](2024-04-25 04:40:00,365) INFO - qlib.timer - [log.py:127] - Time cost: 0.007s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.017308512649334296,
                                                    0.025226956174298033,
                                                    0.055416874840888225],
 '1day.excess_return_with_cost.information_ratio': [0.18010918865041212,
                                                    0.2934252565629728,
                                                    0.6581594906091128],
 '1day.excess_return_with_cost.max_drawdown': [-0.20064185075338067,
                                               -0.14870747098105508,
                                               -0.12217177617500374],
 'IC': [0.009460425373336639, 0.008745406877420814, 0.015760138418877627],
 'ICIR': [0.06965137982819328, 0.05342470255464294, 0.11363008207509598],
 'Rank IC': [0.009648519317820762, 0.02047129256618671, 0.03334113414017674],
 'Rank ICIR': [0.07157037796176006, 0.12302168329159428, 0.2406959310867998],
 'mae': [0.8649170762273879, 0.8647050803459836, 0.86420207780724],
 'mse': [0.9979492119324258, 0.9973789235077785, 0.9969335457109181]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3075328:MainThread](2024-04-25 04:40:03,510) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3075328:MainThread](2024-04-25 04:40:03,511) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3075328:MainThread](2024-04-25 04:40:03,512) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3075328:MainThread](2024-04-25 04:40:03,513) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
[3075328:MainThread](2024-04-25 04:40:06,314) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ALSTM_crowd_data_csi300_360_rankTrue_46.
[3075328:MainThread](2024-04-25 04:40:06,359) INFO - qlib.workflow - [exp.py:258] - Experiment 56 starts running ...
[3075328:MainThread](2024-04-25 04:40:06,371) INFO - qlib.workflow - [recorder.py:341] - Recorder b53311dbbd1c4fd09396278bd8d82f2b starts running under Experiment 56 ...
[3075328:MainThread](2024-04-25 04:40:11,356) INFO - qlib.ALSTM - [pytorch_alstm.py:266] - training...
[3075328:MainThread](2024-04-25 04:40:11,356) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch0:
[3075328:MainThread](2024-04-25 04:40:11,357) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:40:19,468) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:40:19,741) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.011479
[3075328:MainThread](2024-04-25 04:40:19,755) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch1:
[3075328:MainThread](2024-04-25 04:40:19,755) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:40:27,942) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:40:28,153) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999484
[3075328:MainThread](2024-04-25 04:40:28,155) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch2:
[3075328:MainThread](2024-04-25 04:40:28,155) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:40:36,231) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:40:36,443) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999854
[3075328:MainThread](2024-04-25 04:40:36,443) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch3:
[3075328:MainThread](2024-04-25 04:40:36,444) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:40:44,467) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:40:44,694) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.001563
[3075328:MainThread](2024-04-25 04:40:44,694) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch4:
[3075328:MainThread](2024-04-25 04:40:44,695) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:40:53,534) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:40:53,757) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999047
[3075328:MainThread](2024-04-25 04:40:53,759) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch5:
[3075328:MainThread](2024-04-25 04:40:53,759) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:41:02,353) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:41:02,574) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999848
[3075328:MainThread](2024-04-25 04:41:02,574) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch6:
[3075328:MainThread](2024-04-25 04:41:02,574) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:41:11,544) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:41:11,759) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997583
[3075328:MainThread](2024-04-25 04:41:11,760) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch7:
[3075328:MainThread](2024-04-25 04:41:11,760) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:41:20,430) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:41:20,641) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997580
[3075328:MainThread](2024-04-25 04:41:20,642) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch8:
[3075328:MainThread](2024-04-25 04:41:20,643) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:41:28,855) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:41:29,065) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999372
[3075328:MainThread](2024-04-25 04:41:29,066) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch9:
[3075328:MainThread](2024-04-25 04:41:29,066) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:41:37,103) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:41:37,316) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998077
[3075328:MainThread](2024-04-25 04:41:37,316) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch10:
[3075328:MainThread](2024-04-25 04:41:37,317) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:41:45,498) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:41:45,715) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.001295
[3075328:MainThread](2024-04-25 04:41:45,716) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch11:
[3075328:MainThread](2024-04-25 04:41:45,716) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:41:53,686) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:41:53,904) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999269
[3075328:MainThread](2024-04-25 04:41:53,904) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch12:
[3075328:MainThread](2024-04-25 04:41:53,905) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:42:01,876) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:42:02,096) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.000566
[3075328:MainThread](2024-04-25 04:42:02,097) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch13:
[3075328:MainThread](2024-04-25 04:42:02,097) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:42:10,669) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:42:10,880) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998426
[3075328:MainThread](2024-04-25 04:42:10,880) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch14:
[3075328:MainThread](2024-04-25 04:42:10,880) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:42:19,012) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:42:19,223) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.000288
[3075328:MainThread](2024-04-25 04:42:19,224) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch15:
[3075328:MainThread](2024-04-25 04:42:19,224) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:42:27,227) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:42:27,437) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998675
[3075328:MainThread](2024-04-25 04:42:27,438) INFO - qlib.ALSTM - [pytorch_alstm.py:288] - early stop
[3075328:MainThread](2024-04-25 04:42:27,438) INFO - qlib.ALSTM - [pytorch_alstm.py:291] - best score: -0.997580 @ 7
[3075328:MainThread](2024-04-25 04:42:27,462) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ALSTM_crowd_data_csi300_360_rankTrue_46.
[3075328:MainThread](2024-04-25 04:42:28,026) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3075328:MainThread](2024-04-25 04:42:28,039) INFO - qlib.workflow - [recorder.py:341] - Recorder 90d9cb55715c46b69a8fd937708a9e23 starts running under Experiment 53 ...
{'IC': 0.008647241309561056,
 'ICIR': 0.05326330213167523,
 'Rank IC': 0.020794906241499118,
 'Rank ICIR': 0.12470591190690966}
[3075328:MainThread](2024-04-25 04:42:34,529) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3075328:MainThread](2024-04-25 04:43:11,884) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 04:43:11,887) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 04:43:17,847) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f82f76fdf10>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:41,  9.55it/s]backtest loop:   1%|          | 10/971 [00:00<00:35, 27.36it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:26, 36.51it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:22, 41.93it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:19, 47.85it/s]backtest loop:   4%|▍         | 37/971 [00:00<00:18, 50.98it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:17, 51.67it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:16, 54.82it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 52.96it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:16, 54.48it/s]backtest loop:   7%|▋         | 70/971 [00:01<00:15, 56.83it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:16, 55.45it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 57.51it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 59.00it/s]backtest loop:  10%|▉         | 97/971 [00:01<00:15, 56.13it/s]backtest loop:  11%|█         | 103/971 [00:02<00:15, 57.06it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:14, 58.77it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:15, 56.63it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:14, 58.46it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:15, 55.81it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 53.61it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:14, 56.15it/s]backtest loop:  15%|█▌        | 150/971 [00:02<00:14, 58.08it/s]backtest loop:  16%|█▌        | 156/971 [00:03<00:14, 55.46it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:14, 57.59it/s]backtest loop:  17%|█▋        | 169/971 [00:03<00:13, 58.09it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 56.12it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:13, 58.07it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:13, 56.27it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 58.08it/s]backtest loop:  21%|██        | 203/971 [00:03<00:13, 58.42it/s]backtest loop:  22%|██▏       | 210/971 [00:03<00:13, 57.21it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 55.79it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:20, 36.69it/s]backtest loop:  23%|██▎       | 228/971 [00:04<00:18, 41.25it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:16, 44.31it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:14, 48.83it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:14, 49.98it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:13, 53.14it/s]backtest loop:  27%|██▋       | 263/971 [00:05<00:12, 55.60it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:13, 53.83it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:13, 53.41it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:12, 55.87it/s]backtest loop:  30%|██▉       | 289/971 [00:05<00:12, 56.77it/s]backtest loop:  30%|███       | 295/971 [00:05<00:12, 54.29it/s]backtest loop:  31%|███       | 302/971 [00:05<00:11, 56.74it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 58.44it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:11, 55.68it/s]backtest loop:  33%|███▎      | 322/971 [00:06<00:11, 57.51it/s]backtest loop:  34%|███▍      | 328/971 [00:06<00:11, 58.13it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:11, 56.33it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:10, 58.08it/s]backtest loop:  36%|███▌      | 349/971 [00:06<00:10, 59.42it/s]backtest loop:  37%|███▋      | 355/971 [00:06<00:10, 56.42it/s]backtest loop:  37%|███▋      | 361/971 [00:06<00:10, 57.31it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.52it/s]backtest loop:  38%|███▊      | 373/971 [00:07<00:11, 54.12it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:10, 56.68it/s]backtest loop:  40%|███▉      | 386/971 [00:07<00:10, 57.56it/s]backtest loop:  40%|████      | 392/971 [00:07<00:09, 58.19it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 55.41it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 57.66it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:09, 59.11it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:09, 56.31it/s]backtest loop:  44%|████▍     | 425/971 [00:07<00:09, 58.25it/s]backtest loop:  44%|████▍     | 432/971 [00:08<00:09, 56.16it/s]backtest loop:  45%|████▌     | 439/971 [00:08<00:09, 57.98it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:08, 59.26it/s]backtest loop:  47%|████▋     | 452/971 [00:08<00:09, 56.19it/s]backtest loop:  47%|████▋     | 458/971 [00:08<00:08, 57.06it/s]backtest loop:  48%|████▊     | 465/971 [00:08<00:08, 58.58it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:08, 56.52it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 58.23it/s]backtest loop:  50%|████▉     | 485/971 [00:08<00:08, 58.08it/s]backtest loop:  51%|█████     | 491/971 [00:09<00:08, 55.14it/s]backtest loop:  51%|█████▏    | 498/971 [00:09<00:08, 57.25it/s]backtest loop:  52%|█████▏    | 505/971 [00:09<00:08, 55.62it/s]backtest loop:  53%|█████▎    | 512/971 [00:09<00:08, 54.50it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:07, 56.72it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 55.17it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:07, 57.58it/s]backtest loop:  56%|█████▌    | 540/971 [00:09<00:07, 58.89it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 55.99it/s]backtest loop:  57%|█████▋    | 553/971 [00:10<00:07, 57.80it/s]backtest loop:  58%|█████▊    | 560/971 [00:10<00:06, 59.13it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 56.17it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:06, 58.78it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 60.68it/s]backtest loop:  60%|██████    | 587/971 [00:10<00:06, 57.37it/s]backtest loop:  61%|██████    | 593/971 [00:10<00:06, 58.01it/s]backtest loop:  62%|██████▏   | 600/971 [00:10<00:06, 55.99it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 57.75it/s]backtest loop:  63%|██████▎   | 613/971 [00:11<00:06, 58.13it/s]backtest loop:  64%|██████▍   | 620/971 [00:11<00:06, 56.24it/s]backtest loop:  65%|██████▍   | 627/971 [00:11<00:05, 57.98it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:05, 59.26it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:05, 56.51it/s]backtest loop:  67%|██████▋   | 647/971 [00:11<00:05, 58.38it/s]backtest loop:  67%|██████▋   | 654/971 [00:11<00:05, 59.77it/s]backtest loop:  68%|██████▊   | 660/971 [00:12<00:05, 56.58it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 58.29it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:05, 56.15it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:05, 57.83it/s]backtest loop:  71%|███████   | 688/971 [00:12<00:04, 59.06it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:04, 56.06it/s]backtest loop:  72%|███████▏  | 700/971 [00:12<00:04, 54.41it/s]backtest loop:  73%|███████▎  | 706/971 [00:12<00:05, 52.92it/s]backtest loop:  73%|███████▎  | 712/971 [00:12<00:04, 53.05it/s]backtest loop:  74%|███████▍  | 718/971 [00:13<00:04, 51.96it/s]backtest loop:  75%|███████▍  | 724/971 [00:13<00:04, 50.96it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 51.52it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 51.67it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:04, 54.62it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 53.11it/s]backtest loop:  78%|███████▊  | 758/971 [00:13<00:03, 55.72it/s]backtest loop:  79%|███████▉  | 765/971 [00:13<00:03, 54.65it/s]backtest loop:  79%|███████▉  | 771/971 [00:14<00:03, 55.83it/s]backtest loop:  80%|████████  | 778/971 [00:14<00:03, 57.81it/s]backtest loop:  81%|████████  | 784/971 [00:14<00:03, 55.30it/s]backtest loop:  81%|████████▏ | 791/971 [00:14<00:03, 57.47it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 55.76it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:02, 57.60it/s]backtest loop:  84%|████████▎ | 812/971 [00:14<00:02, 58.95it/s]backtest loop:  84%|████████▍ | 818/971 [00:14<00:02, 56.07it/s]backtest loop:  85%|████████▍ | 825/971 [00:14<00:02, 57.92it/s]backtest loop:  86%|████████▌ | 832/971 [00:15<00:02, 59.42it/s]backtest loop:  86%|████████▋ | 838/971 [00:15<00:02, 56.32it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 58.09it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 56.18it/s]backtest loop:  88%|████████▊ | 859/971 [00:15<00:01, 58.07it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 59.33it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 56.03it/s]backtest loop:  91%|█████████ | 879/971 [00:15<00:01, 57.86it/s]backtest loop:  91%|█████████ | 886/971 [00:16<00:01, 59.27it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 56.26it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 58.13it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 59.46it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 56.41it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 58.14it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 56.23it/s]backtest loop:  96%|█████████▌| 933/971 [00:16<00:00, 57.90it/s]backtest loop:  97%|█████████▋| 940/971 [00:16<00:00, 55.98it/s]backtest loop:  98%|█████████▊| 947/971 [00:17<00:00, 57.82it/s]backtest loop:  98%|█████████▊| 954/971 [00:17<00:00, 59.09it/s]backtest loop:  99%|█████████▉| 960/971 [00:17<00:00, 56.16it/s]backtest loop:  99%|█████████▉| 966/971 [00:17<00:00, 56.94it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.39it/s]
[3075328:MainThread](2024-04-25 04:43:35,436) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000252
std                0.006601
annualized_return  0.059921
information_ratio  0.588373
max_drawdown      -0.182292
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000050
std                0.006602
annualized_return  0.011784
information_ratio  0.115696
max_drawdown      -0.211056
[3075328:MainThread](2024-04-25 04:43:35,448) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ALSTM_crowd_data_csi300_360_rankTrue`.
[3075328:MainThread](2024-04-25 04:43:46,172) INFO - qlib.timer - [log.py:127] - Time cost: 0.003s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.017308512649334296,
                                                    0.025226956174298033,
                                                    0.055416874840888225,
                                                    0.011783526040045877],
 '1day.excess_return_with_cost.information_ratio': [0.18010918865041212,
                                                    0.2934252565629728,
                                                    0.6581594906091128,
                                                    0.11569611052484179],
 '1day.excess_return_with_cost.max_drawdown': [-0.20064185075338067,
                                               -0.14870747098105508,
                                               -0.12217177617500374,
                                               -0.21105626405968622],
 'IC': [0.009460425373336639,
        0.008745406877420814,
        0.015760138418877627,
        0.008647241309561056],
 'ICIR': [0.06965137982819328,
          0.05342470255464294,
          0.11363008207509598,
          0.05326330213167523],
 'Rank IC': [0.009648519317820762,
             0.02047129256618671,
             0.03334113414017674,
             0.020794906241499118],
 'Rank ICIR': [0.07157037796176006,
               0.12302168329159428,
               0.2406959310867998,
               0.12470591190690966],
 'mae': [0.8649170762273879,
         0.8647050803459836,
         0.86420207780724,
         0.8646977009841796],
 'mse': [0.9979492119324258,
         0.9973789235077785,
         0.9969335457109181,
         0.9978615205614849]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3075328:MainThread](2024-04-25 04:43:49,374) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3075328:MainThread](2024-04-25 04:43:49,375) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3075328:MainThread](2024-04-25 04:43:49,377) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3075328:MainThread](2024-04-25 04:43:49,377) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
[3075328:MainThread](2024-04-25 04:43:52,253) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ALSTM_crowd_data_csi300_360_rankTrue_47.
[3075328:MainThread](2024-04-25 04:43:52,298) INFO - qlib.workflow - [exp.py:258] - Experiment 57 starts running ...
[3075328:MainThread](2024-04-25 04:43:52,309) INFO - qlib.workflow - [recorder.py:341] - Recorder dba0203958bb451e8e5c0d9d57f21b87 starts running under Experiment 57 ...
[3075328:MainThread](2024-04-25 04:43:57,355) INFO - qlib.ALSTM - [pytorch_alstm.py:266] - training...
[3075328:MainThread](2024-04-25 04:43:57,355) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch0:
[3075328:MainThread](2024-04-25 04:43:57,356) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:44:06,000) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:44:06,220) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.002402
[3075328:MainThread](2024-04-25 04:44:06,222) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch1:
[3075328:MainThread](2024-04-25 04:44:06,222) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:44:14,956) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:44:15,176) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997307
[3075328:MainThread](2024-04-25 04:44:15,177) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch2:
[3075328:MainThread](2024-04-25 04:44:15,178) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:44:23,762) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:44:23,972) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997245
[3075328:MainThread](2024-04-25 04:44:23,974) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch3:
[3075328:MainThread](2024-04-25 04:44:23,974) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:44:32,735) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:44:32,945) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999228
[3075328:MainThread](2024-04-25 04:44:32,946) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch4:
[3075328:MainThread](2024-04-25 04:44:32,946) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:44:41,249) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:44:41,462) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997592
[3075328:MainThread](2024-04-25 04:44:41,463) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch5:
[3075328:MainThread](2024-04-25 04:44:41,463) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:44:49,397) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:44:49,607) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997458
[3075328:MainThread](2024-04-25 04:44:49,608) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch6:
[3075328:MainThread](2024-04-25 04:44:49,608) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:44:57,575) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:44:57,785) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998068
[3075328:MainThread](2024-04-25 04:44:57,786) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch7:
[3075328:MainThread](2024-04-25 04:44:57,786) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:45:05,757) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:45:05,968) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999064
[3075328:MainThread](2024-04-25 04:45:05,968) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch8:
[3075328:MainThread](2024-04-25 04:45:05,968) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:45:14,232) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:45:14,442) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997013
[3075328:MainThread](2024-04-25 04:45:14,444) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch9:
[3075328:MainThread](2024-04-25 04:45:14,444) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:45:22,662) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:45:22,877) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998813
[3075328:MainThread](2024-04-25 04:45:22,877) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch10:
[3075328:MainThread](2024-04-25 04:45:22,877) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:45:31,115) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:45:31,335) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999301
[3075328:MainThread](2024-04-25 04:45:31,335) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch11:
[3075328:MainThread](2024-04-25 04:45:31,335) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:45:39,774) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:45:39,984) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.000978
[3075328:MainThread](2024-04-25 04:45:39,985) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch12:
[3075328:MainThread](2024-04-25 04:45:39,985) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:45:47,897) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:45:48,107) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998079
[3075328:MainThread](2024-04-25 04:45:48,108) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch13:
[3075328:MainThread](2024-04-25 04:45:48,108) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:45:56,085) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:45:56,297) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.996693
[3075328:MainThread](2024-04-25 04:45:56,298) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch14:
[3075328:MainThread](2024-04-25 04:45:56,298) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:46:04,308) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:46:04,518) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998072
[3075328:MainThread](2024-04-25 04:46:04,519) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch15:
[3075328:MainThread](2024-04-25 04:46:04,519) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:46:12,695) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:46:12,908) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.000912
[3075328:MainThread](2024-04-25 04:46:12,908) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch16:
[3075328:MainThread](2024-04-25 04:46:12,909) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:46:21,075) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:46:21,286) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997993
[3075328:MainThread](2024-04-25 04:46:21,286) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch17:
[3075328:MainThread](2024-04-25 04:46:21,286) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:46:29,225) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:46:29,437) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998391
[3075328:MainThread](2024-04-25 04:46:29,438) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch18:
[3075328:MainThread](2024-04-25 04:46:29,438) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:46:37,233) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:46:37,443) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998255
[3075328:MainThread](2024-04-25 04:46:37,444) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch19:
[3075328:MainThread](2024-04-25 04:46:37,444) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:46:45,995) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:46:46,216) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997380
[3075328:MainThread](2024-04-25 04:46:46,216) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch20:
[3075328:MainThread](2024-04-25 04:46:46,217) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:46:54,420) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:46:54,630) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999782
[3075328:MainThread](2024-04-25 04:46:54,631) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch21:
[3075328:MainThread](2024-04-25 04:46:54,631) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:47:02,564) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:47:02,773) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998153
[3075328:MainThread](2024-04-25 04:47:02,774) INFO - qlib.ALSTM - [pytorch_alstm.py:288] - early stop
[3075328:MainThread](2024-04-25 04:47:02,774) INFO - qlib.ALSTM - [pytorch_alstm.py:291] - best score: -0.996693 @ 13
[3075328:MainThread](2024-04-25 04:47:02,798) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ALSTM_crowd_data_csi300_360_rankTrue_47.
[3075328:MainThread](2024-04-25 04:47:03,075) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3075328:MainThread](2024-04-25 04:47:03,088) INFO - qlib.workflow - [recorder.py:341] - Recorder a5c0501ffa8f4253b8de0ce0f594f948 starts running under Experiment 53 ...
{'IC': 0.016392490271658844,
 'ICIR': 0.1356954085685115,
 'Rank IC': 0.02183316905374321,
 'Rank ICIR': 0.17660391793369556}
[3075328:MainThread](2024-04-25 04:47:09,575) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3075328:MainThread](2024-04-25 04:47:47,032) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 04:47:47,036) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 04:47:53,140) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f836e36d400>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:45,  9.15it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 23.74it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 33.62it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:25, 37.55it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:22, 42.76it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 45.91it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 45.45it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:19, 48.01it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 50.04it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 48.38it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:18, 50.36it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 51.72it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 53.06it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 54.06it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 51.05it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 52.33it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 52.92it/s]backtest loop:  11%|█         | 105/971 [00:02<00:16, 53.58it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:15, 54.09it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 51.08it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 52.26it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:16, 50.11it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:16, 51.49it/s]backtest loop:  15%|█▍        | 141/971 [00:03<00:16, 49.48it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:16, 50.89it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 51.91it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 52.77it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:15, 53.29it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 51.39it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:15, 52.38it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 53.18it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:14, 53.54it/s]backtest loop:  20%|██        | 195/971 [00:04<00:15, 50.60it/s]backtest loop:  21%|██        | 201/971 [00:04<00:14, 51.77it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:14, 52.54it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:15, 50.17it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:14, 51.05it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:24, 30.89it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:20, 35.30it/s]backtest loop:  24%|██▍       | 237/971 [00:05<00:18, 39.51it/s]backtest loop:  25%|██▌       | 243/971 [00:05<00:16, 43.13it/s]backtest loop:  26%|██▌       | 249/971 [00:05<00:16, 43.61it/s]backtest loop:  26%|██▋       | 255/971 [00:05<00:15, 46.54it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:14, 48.71it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:14, 47.62it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:14, 49.54it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:13, 51.22it/s]backtest loop:  29%|██▉       | 285/971 [00:06<00:13, 52.32it/s]backtest loop:  30%|██▉       | 291/971 [00:06<00:13, 49.89it/s]backtest loop:  31%|███       | 297/971 [00:06<00:13, 51.35it/s]backtest loop:  31%|███       | 303/971 [00:06<00:12, 52.55it/s]backtest loop:  32%|███▏      | 309/971 [00:06<00:12, 53.58it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:12, 50.82it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:12, 52.14it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:11, 53.74it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:11, 54.20it/s]backtest loop:  35%|███▍      | 339/971 [00:07<00:11, 54.51it/s]backtest loop:  36%|███▌      | 345/971 [00:07<00:12, 51.25it/s]backtest loop:  36%|███▌      | 351/971 [00:07<00:11, 52.30it/s]backtest loop:  37%|███▋      | 357/971 [00:07<00:11, 53.06it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:11, 50.87it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:12, 49.08it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 51.45it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:11, 52.29it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 54.14it/s]backtest loop:  40%|████      | 393/971 [00:08<00:10, 52.56it/s]backtest loop:  41%|████      | 399/971 [00:08<00:10, 54.59it/s]backtest loop:  42%|████▏     | 406/971 [00:08<00:09, 56.97it/s]backtest loop:  43%|████▎     | 413/971 [00:08<00:09, 56.10it/s]backtest loop:  43%|████▎     | 419/971 [00:08<00:09, 57.07it/s]backtest loop:  44%|████▍     | 425/971 [00:08<00:09, 57.82it/s]backtest loop:  44%|████▍     | 431/971 [00:08<00:09, 58.03it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:09, 55.02it/s]backtest loop:  46%|████▌     | 443/971 [00:08<00:09, 56.31it/s]backtest loop:  46%|████▌     | 449/971 [00:09<00:09, 56.90it/s]backtest loop:  47%|████▋     | 455/971 [00:09<00:08, 57.73it/s]backtest loop:  47%|████▋     | 461/971 [00:09<00:08, 58.33it/s]backtest loop:  48%|████▊     | 467/971 [00:09<00:09, 54.81it/s]backtest loop:  49%|████▉     | 474/971 [00:09<00:08, 57.21it/s]backtest loop:  49%|████▉     | 480/971 [00:09<00:08, 57.90it/s]backtest loop:  50%|█████     | 486/971 [00:09<00:08, 57.93it/s]backtest loop:  51%|█████     | 492/971 [00:09<00:08, 55.00it/s]backtest loop:  51%|█████▏    | 499/971 [00:09<00:08, 57.13it/s]backtest loop:  52%|█████▏    | 505/971 [00:10<00:08, 55.11it/s]backtest loop:  53%|█████▎    | 512/971 [00:10<00:08, 54.16it/s]backtest loop:  53%|█████▎    | 519/971 [00:10<00:08, 56.47it/s]backtest loop:  54%|█████▍    | 525/971 [00:10<00:07, 57.33it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:07, 55.03it/s]backtest loop:  55%|█████▌    | 538/971 [00:10<00:07, 57.14it/s]backtest loop:  56%|█████▌    | 544/971 [00:10<00:07, 57.92it/s]backtest loop:  57%|█████▋    | 550/971 [00:10<00:07, 58.46it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:07, 55.47it/s]backtest loop:  58%|█████▊    | 562/971 [00:11<00:07, 56.70it/s]backtest loop:  59%|█████▊    | 569/971 [00:11<00:06, 58.35it/s]backtest loop:  59%|█████▉    | 576/971 [00:11<00:07, 56.30it/s]backtest loop:  60%|█████▉    | 582/971 [00:11<00:06, 57.21it/s]backtest loop:  61%|██████    | 589/971 [00:11<00:06, 58.80it/s]backtest loop:  61%|██████▏   | 595/971 [00:11<00:06, 59.08it/s]backtest loop:  62%|██████▏   | 601/971 [00:11<00:06, 55.75it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 56.88it/s]backtest loop:  63%|██████▎   | 614/971 [00:11<00:06, 58.45it/s]backtest loop:  64%|██████▍   | 620/971 [00:12<00:06, 55.26it/s]backtest loop:  64%|██████▍   | 626/971 [00:12<00:06, 56.41it/s]backtest loop:  65%|██████▌   | 632/971 [00:12<00:05, 57.33it/s]backtest loop:  66%|██████▌   | 639/971 [00:12<00:05, 58.78it/s]backtest loop:  66%|██████▋   | 645/971 [00:12<00:05, 55.58it/s]backtest loop:  67%|██████▋   | 651/971 [00:12<00:05, 56.73it/s]backtest loop:  68%|██████▊   | 657/971 [00:12<00:05, 57.54it/s]backtest loop:  68%|██████▊   | 663/971 [00:12<00:05, 58.20it/s]backtest loop:  69%|██████▉   | 669/971 [00:12<00:05, 58.67it/s]backtest loop:  70%|██████▉   | 675/971 [00:13<00:05, 55.36it/s]backtest loop:  70%|███████   | 681/971 [00:13<00:05, 56.31it/s]backtest loop:  71%|███████   | 687/971 [00:13<00:04, 57.12it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:04, 57.91it/s]backtest loop:  72%|███████▏  | 699/971 [00:13<00:04, 54.73it/s]backtest loop:  73%|███████▎  | 705/971 [00:13<00:04, 56.17it/s]backtest loop:  73%|███████▎  | 711/971 [00:13<00:04, 57.25it/s]backtest loop:  74%|███████▍  | 717/971 [00:13<00:04, 57.75it/s]backtest loop:  74%|███████▍  | 723/971 [00:13<00:04, 58.39it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 55.43it/s]backtest loop:  76%|███████▌  | 735/971 [00:14<00:04, 52.97it/s]backtest loop:  76%|███████▋  | 741/971 [00:14<00:04, 54.74it/s]backtest loop:  77%|███████▋  | 747/971 [00:14<00:03, 56.21it/s]backtest loop:  78%|███████▊  | 753/971 [00:14<00:04, 53.87it/s]backtest loop:  78%|███████▊  | 759/971 [00:14<00:03, 55.47it/s]backtest loop:  79%|███████▉  | 765/971 [00:14<00:03, 53.47it/s]backtest loop:  80%|███████▉  | 772/971 [00:14<00:03, 56.05it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 57.92it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 55.67it/s]backtest loop:  82%|████████▏ | 792/971 [00:15<00:03, 57.69it/s]backtest loop:  82%|████████▏ | 798/971 [00:15<00:03, 54.99it/s]backtest loop:  83%|████████▎ | 804/971 [00:15<00:02, 56.30it/s]backtest loop:  83%|████████▎ | 810/971 [00:15<00:02, 57.19it/s]backtest loop:  84%|████████▍ | 816/971 [00:15<00:02, 57.94it/s]backtest loop:  85%|████████▍ | 822/971 [00:15<00:02, 58.29it/s]backtest loop:  85%|████████▌ | 828/971 [00:15<00:02, 54.56it/s]backtest loop:  86%|████████▌ | 834/971 [00:15<00:02, 56.02it/s]backtest loop:  87%|████████▋ | 840/971 [00:15<00:02, 57.12it/s]backtest loop:  87%|████████▋ | 846/971 [00:16<00:02, 57.93it/s]backtest loop:  88%|████████▊ | 852/971 [00:16<00:02, 54.71it/s]backtest loop:  88%|████████▊ | 858/971 [00:16<00:02, 56.03it/s]backtest loop:  89%|████████▉ | 864/971 [00:16<00:01, 57.11it/s]backtest loop:  90%|████████▉ | 870/971 [00:16<00:01, 57.73it/s]backtest loop:  90%|█████████ | 876/971 [00:16<00:01, 58.13it/s]backtest loop:  91%|█████████ | 882/971 [00:16<00:01, 55.05it/s]backtest loop:  91%|█████████▏| 888/971 [00:16<00:01, 55.98it/s]backtest loop:  92%|█████████▏| 894/971 [00:16<00:01, 56.98it/s]backtest loop:  93%|█████████▎| 900/971 [00:17<00:01, 57.73it/s]backtest loop:  93%|█████████▎| 906/971 [00:17<00:01, 58.33it/s]backtest loop:  94%|█████████▍| 912/971 [00:17<00:01, 55.18it/s]backtest loop:  95%|█████████▍| 918/971 [00:17<00:00, 56.31it/s]backtest loop:  95%|█████████▌| 924/971 [00:17<00:00, 56.95it/s]backtest loop:  96%|█████████▌| 930/971 [00:17<00:00, 57.74it/s]backtest loop:  96%|█████████▋| 936/971 [00:17<00:00, 54.87it/s]backtest loop:  97%|█████████▋| 942/971 [00:17<00:00, 56.30it/s]backtest loop:  98%|█████████▊| 948/971 [00:17<00:00, 57.30it/s]backtest loop:  98%|█████████▊| 954/971 [00:17<00:00, 57.65it/s]backtest loop:  99%|█████████▉| 960/971 [00:18<00:00, 54.78it/s]backtest loop:  99%|█████████▉| 966/971 [00:18<00:00, 55.94it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 53.13it/s]
[3075328:MainThread](2024-04-25 04:48:11,479) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000257
std                0.005169
annualized_return  0.061254
information_ratio  0.768158
max_drawdown      -0.137993
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000059
std                0.005170
annualized_return  0.014000
information_ratio  0.175518
max_drawdown      -0.158022
[3075328:MainThread](2024-04-25 04:48:11,492) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ALSTM_crowd_data_csi300_360_rankTrue`.
[3075328:MainThread](2024-04-25 04:48:18,457) INFO - qlib.timer - [log.py:127] - Time cost: 0.007s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.017308512649334296,
                                                    0.025226956174298033,
                                                    0.055416874840888225,
                                                    0.011783526040045877,
                                                    0.01400035120779],
 '1day.excess_return_with_cost.information_ratio': [0.18010918865041212,
                                                    0.2934252565629728,
                                                    0.6581594906091128,
                                                    0.11569611052484179,
                                                    0.17551813038162198],
 '1day.excess_return_with_cost.max_drawdown': [-0.20064185075338067,
                                               -0.14870747098105508,
                                               -0.12217177617500374,
                                               -0.21105626405968622,
                                               -0.1580217854884085],
 'IC': [0.009460425373336639,
        0.008745406877420814,
        0.015760138418877627,
        0.008647241309561056,
        0.016392490271658844],
 'ICIR': [0.06965137982819328,
          0.05342470255464294,
          0.11363008207509598,
          0.05326330213167523,
          0.1356954085685115],
 'Rank IC': [0.009648519317820762,
             0.02047129256618671,
             0.03334113414017674,
             0.020794906241499118,
             0.02183316905374321],
 'Rank ICIR': [0.07157037796176006,
               0.12302168329159428,
               0.2406959310867998,
               0.12470591190690966,
               0.17660391793369556],
 'mae': [0.8649170762273879,
         0.8647050803459836,
         0.86420207780724,
         0.8646977009841796,
         0.864640614854717],
 'mse': [0.9979492119324258,
         0.9973789235077785,
         0.9969335457109181,
         0.9978615205614849,
         0.9976719791223738]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3075328:MainThread](2024-04-25 04:48:21,706) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3075328:MainThread](2024-04-25 04:48:21,706) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3075328:MainThread](2024-04-25 04:48:21,708) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3075328:MainThread](2024-04-25 04:48:21,709) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
[3075328:MainThread](2024-04-25 04:48:24,632) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ALSTM_crowd_data_csi300_360_rankTrue_48.
[3075328:MainThread](2024-04-25 04:48:24,679) INFO - qlib.workflow - [exp.py:258] - Experiment 58 starts running ...
[3075328:MainThread](2024-04-25 04:48:24,691) INFO - qlib.workflow - [recorder.py:341] - Recorder 64cbdca1acd6455e91f40fa6a928dff1 starts running under Experiment 58 ...
[3075328:MainThread](2024-04-25 04:48:29,863) INFO - qlib.ALSTM - [pytorch_alstm.py:266] - training...
[3075328:MainThread](2024-04-25 04:48:29,864) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch0:
[3075328:MainThread](2024-04-25 04:48:29,864) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:48:38,046) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:48:38,261) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.002769
[3075328:MainThread](2024-04-25 04:48:38,262) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch1:
[3075328:MainThread](2024-04-25 04:48:38,263) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:48:46,755) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:48:46,966) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999527
[3075328:MainThread](2024-04-25 04:48:46,967) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch2:
[3075328:MainThread](2024-04-25 04:48:46,968) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:48:55,390) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:48:55,603) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.000295
[3075328:MainThread](2024-04-25 04:48:55,604) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch3:
[3075328:MainThread](2024-04-25 04:48:55,604) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:49:03,583) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:49:03,797) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999912
[3075328:MainThread](2024-04-25 04:49:03,798) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch4:
[3075328:MainThread](2024-04-25 04:49:03,798) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:49:11,737) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:49:11,948) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998885
[3075328:MainThread](2024-04-25 04:49:11,949) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch5:
[3075328:MainThread](2024-04-25 04:49:11,950) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:49:19,906) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:49:20,127) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999514
[3075328:MainThread](2024-04-25 04:49:20,128) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch6:
[3075328:MainThread](2024-04-25 04:49:20,128) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:49:28,276) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:49:28,487) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.001516
[3075328:MainThread](2024-04-25 04:49:28,487) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch7:
[3075328:MainThread](2024-04-25 04:49:28,487) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:49:36,968) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:49:37,190) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.003004
[3075328:MainThread](2024-04-25 04:49:37,190) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch8:
[3075328:MainThread](2024-04-25 04:49:37,191) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:49:45,409) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:49:45,622) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.000770
[3075328:MainThread](2024-04-25 04:49:45,623) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch9:
[3075328:MainThread](2024-04-25 04:49:45,623) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:49:53,549) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:49:53,760) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998286
[3075328:MainThread](2024-04-25 04:49:53,762) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch10:
[3075328:MainThread](2024-04-25 04:49:53,762) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:50:01,726) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:50:01,938) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998940
[3075328:MainThread](2024-04-25 04:50:01,939) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch11:
[3075328:MainThread](2024-04-25 04:50:01,939) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:50:10,313) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:50:10,533) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998962
[3075328:MainThread](2024-04-25 04:50:10,533) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch12:
[3075328:MainThread](2024-04-25 04:50:10,534) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:50:19,320) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:50:19,541) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999218
[3075328:MainThread](2024-04-25 04:50:19,541) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch13:
[3075328:MainThread](2024-04-25 04:50:19,541) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:50:27,523) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:50:27,735) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997922
[3075328:MainThread](2024-04-25 04:50:27,737) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch14:
[3075328:MainThread](2024-04-25 04:50:27,737) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:50:36,112) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:50:36,332) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997859
[3075328:MainThread](2024-04-25 04:50:36,333) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch15:
[3075328:MainThread](2024-04-25 04:50:36,333) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:50:44,605) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:50:44,816) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998957
[3075328:MainThread](2024-04-25 04:50:44,816) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch16:
[3075328:MainThread](2024-04-25 04:50:44,817) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:50:52,754) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:50:52,965) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999547
[3075328:MainThread](2024-04-25 04:50:52,966) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch17:
[3075328:MainThread](2024-04-25 04:50:52,966) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:51:00,926) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:51:01,138) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998717
[3075328:MainThread](2024-04-25 04:51:01,139) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch18:
[3075328:MainThread](2024-04-25 04:51:01,139) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:51:09,083) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:51:09,294) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999720
[3075328:MainThread](2024-04-25 04:51:09,294) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch19:
[3075328:MainThread](2024-04-25 04:51:09,295) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:51:17,214) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:51:17,426) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997756
[3075328:MainThread](2024-04-25 04:51:17,428) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch20:
[3075328:MainThread](2024-04-25 04:51:17,428) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:51:25,911) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:51:26,132) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997453
[3075328:MainThread](2024-04-25 04:51:26,133) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch21:
[3075328:MainThread](2024-04-25 04:51:26,134) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:51:34,888) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:51:35,102) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999709
[3075328:MainThread](2024-04-25 04:51:35,102) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch22:
[3075328:MainThread](2024-04-25 04:51:35,103) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:51:43,072) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:51:43,284) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998708
[3075328:MainThread](2024-04-25 04:51:43,285) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch23:
[3075328:MainThread](2024-04-25 04:51:43,285) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:51:51,830) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:51:52,041) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998526
[3075328:MainThread](2024-04-25 04:51:52,041) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch24:
[3075328:MainThread](2024-04-25 04:51:52,041) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:51:59,965) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:52:00,176) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998480
[3075328:MainThread](2024-04-25 04:52:00,177) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch25:
[3075328:MainThread](2024-04-25 04:52:00,177) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:52:08,122) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:52:08,333) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997880
[3075328:MainThread](2024-04-25 04:52:08,334) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch26:
[3075328:MainThread](2024-04-25 04:52:08,334) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:52:16,234) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:52:16,452) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999977
[3075328:MainThread](2024-04-25 04:52:16,453) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch27:
[3075328:MainThread](2024-04-25 04:52:16,453) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:52:24,449) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:52:24,660) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999659
[3075328:MainThread](2024-04-25 04:52:24,660) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch28:
[3075328:MainThread](2024-04-25 04:52:24,661) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:52:32,566) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:52:32,778) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997261
[3075328:MainThread](2024-04-25 04:52:32,780) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch29:
[3075328:MainThread](2024-04-25 04:52:32,780) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:52:41,057) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:52:41,268) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999558
[3075328:MainThread](2024-04-25 04:52:41,268) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch30:
[3075328:MainThread](2024-04-25 04:52:41,268) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:52:49,204) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:52:49,415) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998954
[3075328:MainThread](2024-04-25 04:52:49,415) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch31:
[3075328:MainThread](2024-04-25 04:52:49,416) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:52:57,370) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:52:57,581) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997957
[3075328:MainThread](2024-04-25 04:52:57,581) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch32:
[3075328:MainThread](2024-04-25 04:52:57,581) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:53:05,520) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:53:05,735) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998524
[3075328:MainThread](2024-04-25 04:53:05,735) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch33:
[3075328:MainThread](2024-04-25 04:53:05,736) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:53:14,016) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:53:14,227) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997461
[3075328:MainThread](2024-04-25 04:53:14,227) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch34:
[3075328:MainThread](2024-04-25 04:53:14,228) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:53:22,373) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:53:22,584) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998904
[3075328:MainThread](2024-04-25 04:53:22,584) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch35:
[3075328:MainThread](2024-04-25 04:53:22,585) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:53:30,817) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:53:31,036) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999317
[3075328:MainThread](2024-04-25 04:53:31,037) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch36:
[3075328:MainThread](2024-04-25 04:53:31,037) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:53:39,815) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:53:40,035) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998437
[3075328:MainThread](2024-04-25 04:53:40,036) INFO - qlib.ALSTM - [pytorch_alstm.py:288] - early stop
[3075328:MainThread](2024-04-25 04:53:40,036) INFO - qlib.ALSTM - [pytorch_alstm.py:291] - best score: -0.997261 @ 28
[3075328:MainThread](2024-04-25 04:53:40,061) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ALSTM_crowd_data_csi300_360_rankTrue_48.
[3075328:MainThread](2024-04-25 04:53:40,339) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3075328:MainThread](2024-04-25 04:53:40,352) INFO - qlib.workflow - [recorder.py:341] - Recorder 46c31afc2e664a4a8c7117dfb97b84f9 starts running under Experiment 53 ...
{'IC': 0.017164146008581356,
 'ICIR': 0.1261014926685193,
 'Rank IC': 0.03022300820925804,
 'Rank ICIR': 0.21548209310462074}
[3075328:MainThread](2024-04-25 04:53:47,927) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3075328:MainThread](2024-04-25 04:54:25,598) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 04:54:25,601) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 04:54:31,708) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8366c8dbe0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:47,  9.04it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 23.49it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 33.34it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:25, 37.55it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:22, 42.64it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 46.22it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 45.51it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:19, 48.22it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 49.66it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 48.23it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 50.62it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 52.14it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:17, 52.50it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 53.64it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 50.84it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 52.20it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 52.61it/s]backtest loop:  11%|█         | 105/971 [00:02<00:16, 53.33it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:15, 53.97it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 50.60it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 51.86it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:17, 49.37it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:16, 50.99it/s]backtest loop:  15%|█▍        | 141/971 [00:03<00:16, 49.12it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:16, 50.83it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 51.61it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 52.21it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:15, 53.00it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 50.37it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:15, 51.72it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 52.66it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:14, 52.93it/s]backtest loop:  20%|██        | 195/971 [00:04<00:15, 50.48it/s]backtest loop:  21%|██        | 201/971 [00:04<00:14, 51.82it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:14, 53.18it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:14, 50.97it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:14, 51.77it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:23, 32.22it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:20, 36.79it/s]backtest loop:  24%|██▍       | 237/971 [00:05<00:18, 40.69it/s]backtest loop:  25%|██▌       | 243/971 [00:05<00:16, 44.13it/s]backtest loop:  26%|██▌       | 249/971 [00:05<00:16, 44.53it/s]backtest loop:  26%|██▋       | 255/971 [00:05<00:14, 47.85it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:14, 50.08it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:14, 48.62it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:13, 50.36it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:13, 51.61it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:13, 52.59it/s]backtest loop:  30%|██▉       | 291/971 [00:06<00:13, 50.18it/s]backtest loop:  31%|███       | 297/971 [00:06<00:13, 51.48it/s]backtest loop:  31%|███       | 303/971 [00:06<00:12, 52.35it/s]backtest loop:  32%|███▏      | 309/971 [00:06<00:12, 53.27it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:12, 50.52it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:12, 51.91it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:12, 52.81it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:12, 53.16it/s]backtest loop:  35%|███▍      | 339/971 [00:07<00:11, 53.79it/s]backtest loop:  36%|███▌      | 345/971 [00:07<00:12, 50.93it/s]backtest loop:  36%|███▌      | 351/971 [00:07<00:11, 52.10it/s]backtest loop:  37%|███▋      | 357/971 [00:07<00:11, 52.95it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:12, 50.31it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:12, 49.23it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 50.96it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:11, 52.32it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 53.15it/s]backtest loop:  40%|████      | 393/971 [00:08<00:11, 50.38it/s]backtest loop:  41%|████      | 399/971 [00:08<00:11, 51.62it/s]backtest loop:  42%|████▏     | 405/971 [00:08<00:10, 52.65it/s]backtest loop:  42%|████▏     | 411/971 [00:08<00:10, 53.28it/s]backtest loop:  43%|████▎     | 417/971 [00:08<00:10, 53.75it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:10, 50.56it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:10, 51.79it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:10, 52.83it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 53.53it/s]backtest loop:  46%|████▌     | 447/971 [00:09<00:10, 51.49it/s]backtest loop:  47%|████▋     | 453/971 [00:09<00:09, 52.18it/s]backtest loop:  47%|████▋     | 459/971 [00:09<00:09, 52.96it/s]backtest loop:  48%|████▊     | 465/971 [00:09<00:09, 53.71it/s]backtest loop:  49%|████▊     | 471/971 [00:09<00:09, 54.11it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 51.10it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:09, 51.78it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:09, 52.71it/s]backtest loop:  51%|█████     | 495/971 [00:10<00:09, 50.34it/s]backtest loop:  52%|█████▏    | 501/971 [00:10<00:09, 51.81it/s]backtest loop:  52%|█████▏    | 507/971 [00:10<00:09, 49.90it/s]backtest loop:  53%|█████▎    | 513/971 [00:10<00:08, 51.28it/s]backtest loop:  53%|█████▎    | 519/971 [00:10<00:08, 52.41it/s]backtest loop:  54%|█████▍    | 525/971 [00:10<00:08, 53.28it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 50.89it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:08, 52.07it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:08, 52.65it/s]backtest loop:  57%|█████▋    | 549/971 [00:11<00:07, 53.13it/s]backtest loop:  57%|█████▋    | 555/971 [00:11<00:07, 53.80it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:08, 51.16it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:07, 52.27it/s]backtest loop:  59%|█████▉    | 573/971 [00:11<00:07, 53.37it/s]backtest loop:  60%|█████▉    | 579/971 [00:11<00:07, 54.08it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:07, 54.49it/s]backtest loop:  61%|██████    | 591/971 [00:11<00:07, 51.02it/s]backtest loop:  61%|██████▏   | 597/971 [00:11<00:07, 52.09it/s]backtest loop:  62%|██████▏   | 603/971 [00:12<00:06, 52.86it/s]backtest loop:  63%|██████▎   | 609/971 [00:12<00:06, 53.24it/s]backtest loop:  63%|██████▎   | 615/971 [00:12<00:07, 50.48it/s]backtest loop:  64%|██████▍   | 621/971 [00:12<00:06, 51.71it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:06, 52.70it/s]backtest loop:  65%|██████▌   | 633/971 [00:12<00:06, 53.26it/s]backtest loop:  66%|██████▌   | 639/971 [00:12<00:06, 53.29it/s]backtest loop:  66%|██████▋   | 645/971 [00:12<00:06, 50.51it/s]backtest loop:  67%|██████▋   | 651/971 [00:13<00:06, 51.95it/s]backtest loop:  68%|██████▊   | 657/971 [00:13<00:05, 52.80it/s]backtest loop:  68%|██████▊   | 663/971 [00:13<00:05, 53.42it/s]backtest loop:  69%|██████▉   | 669/971 [00:13<00:05, 53.54it/s]backtest loop:  70%|██████▉   | 675/971 [00:13<00:05, 50.62it/s]backtest loop:  70%|███████   | 681/971 [00:13<00:05, 51.81it/s]backtest loop:  71%|███████   | 687/971 [00:13<00:05, 52.41it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:05, 53.16it/s]backtest loop:  72%|███████▏  | 699/971 [00:13<00:05, 50.12it/s]backtest loop:  73%|███████▎  | 705/971 [00:14<00:05, 51.41it/s]backtest loop:  73%|███████▎  | 711/971 [00:14<00:04, 52.33it/s]backtest loop:  74%|███████▍  | 717/971 [00:14<00:04, 53.13it/s]backtest loop:  74%|███████▍  | 723/971 [00:14<00:04, 53.70it/s]backtest loop:  75%|███████▌  | 729/971 [00:14<00:04, 50.30it/s]backtest loop:  76%|███████▌  | 735/971 [00:14<00:04, 49.20it/s]backtest loop:  76%|███████▋  | 741/971 [00:14<00:04, 50.69it/s]backtest loop:  77%|███████▋  | 747/971 [00:14<00:04, 51.87it/s]backtest loop:  78%|███████▊  | 753/971 [00:14<00:04, 49.60it/s]backtest loop:  78%|███████▊  | 759/971 [00:15<00:04, 50.79it/s]backtest loop:  79%|███████▉  | 765/971 [00:15<00:04, 49.03it/s]backtest loop:  79%|███████▉  | 771/971 [00:15<00:03, 50.70it/s]backtest loop:  80%|████████  | 777/971 [00:15<00:03, 51.62it/s]backtest loop:  81%|████████  | 783/971 [00:15<00:03, 49.49it/s]backtest loop:  81%|████████▏ | 789/971 [00:15<00:03, 50.71it/s]backtest loop:  82%|████████▏ | 795/971 [00:15<00:03, 51.88it/s]backtest loop:  82%|████████▏ | 801/971 [00:15<00:03, 52.73it/s]backtest loop:  83%|████████▎ | 807/971 [00:16<00:03, 53.30it/s]backtest loop:  84%|████████▎ | 813/971 [00:16<00:03, 50.57it/s]backtest loop:  84%|████████▍ | 819/971 [00:16<00:02, 51.26it/s]backtest loop:  85%|████████▍ | 825/971 [00:16<00:02, 52.13it/s]backtest loop:  86%|████████▌ | 831/971 [00:16<00:02, 52.94it/s]backtest loop:  86%|████████▌ | 837/971 [00:16<00:02, 53.53it/s]backtest loop:  87%|████████▋ | 843/971 [00:16<00:02, 50.76it/s]backtest loop:  87%|████████▋ | 849/971 [00:16<00:02, 51.95it/s]backtest loop:  88%|████████▊ | 855/971 [00:16<00:02, 52.81it/s]backtest loop:  89%|████████▊ | 861/971 [00:17<00:02, 53.48it/s]backtest loop:  89%|████████▉ | 867/971 [00:17<00:02, 50.13it/s]backtest loop:  90%|████████▉ | 873/971 [00:17<00:01, 51.65it/s]backtest loop:  91%|█████████ | 879/971 [00:17<00:01, 52.73it/s]backtest loop:  91%|█████████ | 885/971 [00:17<00:01, 53.46it/s]backtest loop:  92%|█████████▏| 891/971 [00:17<00:01, 53.89it/s]backtest loop:  92%|█████████▏| 897/971 [00:17<00:01, 51.04it/s]backtest loop:  93%|█████████▎| 903/971 [00:17<00:01, 52.18it/s]backtest loop:  94%|█████████▎| 909/971 [00:17<00:01, 52.99it/s]backtest loop:  94%|█████████▍| 915/971 [00:18<00:01, 53.61it/s]backtest loop:  95%|█████████▍| 921/971 [00:18<00:00, 50.68it/s]backtest loop:  95%|█████████▌| 927/971 [00:18<00:00, 51.94it/s]backtest loop:  96%|█████████▌| 933/971 [00:18<00:00, 51.82it/s]backtest loop:  97%|█████████▋| 940/971 [00:18<00:00, 52.03it/s]backtest loop:  98%|█████████▊| 947/971 [00:18<00:00, 54.88it/s]backtest loop:  98%|█████████▊| 954/971 [00:18<00:00, 57.08it/s]backtest loop:  99%|█████████▉| 960/971 [00:18<00:00, 54.72it/s]backtest loop: 100%|█████████▉| 967/971 [00:19<00:00, 56.96it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 50.78it/s]
[3075328:MainThread](2024-04-25 04:54:50,892) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000596
std                0.005224
annualized_return  0.141890
information_ratio  1.760619
max_drawdown      -0.081751
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000397
std                0.005225
annualized_return  0.094389
information_ratio  1.170923
max_drawdown      -0.098074
[3075328:MainThread](2024-04-25 04:54:50,905) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ALSTM_crowd_data_csi300_360_rankTrue`.
[3075328:MainThread](2024-04-25 04:54:57,794) INFO - qlib.timer - [log.py:127] - Time cost: 0.007s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.017308512649334296,
                                                    0.025226956174298033,
                                                    0.055416874840888225,
                                                    0.011783526040045877,
                                                    0.01400035120779,
                                                    0.09438899367942376],
 '1day.excess_return_with_cost.information_ratio': [0.18010918865041212,
                                                    0.2934252565629728,
                                                    0.6581594906091128,
                                                    0.11569611052484179,
                                                    0.17551813038162198,
                                                    1.170922812371982],
 '1day.excess_return_with_cost.max_drawdown': [-0.20064185075338067,
                                               -0.14870747098105508,
                                               -0.12217177617500374,
                                               -0.21105626405968622,
                                               -0.1580217854884085,
                                               -0.09807365571942406],
 'IC': [0.009460425373336639,
        0.008745406877420814,
        0.015760138418877627,
        0.008647241309561056,
        0.016392490271658844,
        0.017164146008581356],
 'ICIR': [0.06965137982819328,
          0.05342470255464294,
          0.11363008207509598,
          0.05326330213167523,
          0.1356954085685115,
          0.1261014926685193],
 'Rank IC': [0.009648519317820762,
             0.02047129256618671,
             0.03334113414017674,
             0.020794906241499118,
             0.02183316905374321,
             0.03022300820925804],
 'Rank ICIR': [0.07157037796176006,
               0.12302168329159428,
               0.2406959310867998,
               0.12470591190690966,
               0.17660391793369556,
               0.21548209310462074],
 'mae': [0.8649170762273879,
         0.8647050803459836,
         0.86420207780724,
         0.8646977009841796,
         0.864640614854717,
         0.8642817708638176],
 'mse': [0.9979492119324258,
         0.9973789235077785,
         0.9969335457109181,
         0.9978615205614849,
         0.9976719791223738,
         0.9972576945583526]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3075328:MainThread](2024-04-25 04:55:01,001) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3075328:MainThread](2024-04-25 04:55:01,002) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3075328:MainThread](2024-04-25 04:55:01,004) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3075328:MainThread](2024-04-25 04:55:01,004) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
[3075328:MainThread](2024-04-25 04:55:03,894) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ALSTM_crowd_data_csi300_360_rankTrue_49.
[3075328:MainThread](2024-04-25 04:55:03,942) INFO - qlib.workflow - [exp.py:258] - Experiment 59 starts running ...
[3075328:MainThread](2024-04-25 04:55:03,957) INFO - qlib.workflow - [recorder.py:341] - Recorder b7205d4057664c9ca06022091319fd4d starts running under Experiment 59 ...
[3075328:MainThread](2024-04-25 04:55:09,191) INFO - qlib.ALSTM - [pytorch_alstm.py:266] - training...
[3075328:MainThread](2024-04-25 04:55:09,192) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch0:
[3075328:MainThread](2024-04-25 04:55:09,192) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:55:17,908) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:55:18,128) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998324
[3075328:MainThread](2024-04-25 04:55:18,130) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch1:
[3075328:MainThread](2024-04-25 04:55:18,130) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:55:26,880) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:55:27,100) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.000004
[3075328:MainThread](2024-04-25 04:55:27,100) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch2:
[3075328:MainThread](2024-04-25 04:55:27,101) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:55:35,814) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:55:36,034) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998247
[3075328:MainThread](2024-04-25 04:55:36,036) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch3:
[3075328:MainThread](2024-04-25 04:55:36,036) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:55:44,712) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:55:44,923) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998696
[3075328:MainThread](2024-04-25 04:55:44,923) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch4:
[3075328:MainThread](2024-04-25 04:55:44,924) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:55:52,866) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:55:53,078) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997975
[3075328:MainThread](2024-04-25 04:55:53,079) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch5:
[3075328:MainThread](2024-04-25 04:55:53,080) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:56:01,032) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:56:01,243) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.000534
[3075328:MainThread](2024-04-25 04:56:01,243) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch6:
[3075328:MainThread](2024-04-25 04:56:01,243) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:56:09,207) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:56:09,418) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999398
[3075328:MainThread](2024-04-25 04:56:09,419) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch7:
[3075328:MainThread](2024-04-25 04:56:09,419) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:56:17,352) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:56:17,566) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.000688
[3075328:MainThread](2024-04-25 04:56:17,566) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch8:
[3075328:MainThread](2024-04-25 04:56:17,567) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:56:25,507) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:56:25,722) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.000009
[3075328:MainThread](2024-04-25 04:56:25,722) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch9:
[3075328:MainThread](2024-04-25 04:56:25,722) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:56:33,865) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:56:34,078) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999751
[3075328:MainThread](2024-04-25 04:56:34,078) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch10:
[3075328:MainThread](2024-04-25 04:56:34,079) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:56:42,106) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:56:42,320) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998033
[3075328:MainThread](2024-04-25 04:56:42,320) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch11:
[3075328:MainThread](2024-04-25 04:56:42,321) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:56:50,223) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:56:50,436) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998684
[3075328:MainThread](2024-04-25 04:56:50,436) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch12:
[3075328:MainThread](2024-04-25 04:56:50,437) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:56:58,629) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:56:58,850) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997516
[3075328:MainThread](2024-04-25 04:56:58,852) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch13:
[3075328:MainThread](2024-04-25 04:56:58,852) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:57:07,761) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:57:07,982) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.001442
[3075328:MainThread](2024-04-25 04:57:07,982) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch14:
[3075328:MainThread](2024-04-25 04:57:07,983) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:57:16,745) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:57:16,967) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997667
[3075328:MainThread](2024-04-25 04:57:16,967) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch15:
[3075328:MainThread](2024-04-25 04:57:16,967) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:57:24,939) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:57:25,151) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999488
[3075328:MainThread](2024-04-25 04:57:25,151) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch16:
[3075328:MainThread](2024-04-25 04:57:25,152) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:57:33,077) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:57:33,291) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998196
[3075328:MainThread](2024-04-25 04:57:33,291) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch17:
[3075328:MainThread](2024-04-25 04:57:33,292) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:57:41,232) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:57:41,447) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999158
[3075328:MainThread](2024-04-25 04:57:41,447) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch18:
[3075328:MainThread](2024-04-25 04:57:41,448) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:57:50,069) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:57:50,282) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.000717
[3075328:MainThread](2024-04-25 04:57:50,282) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch19:
[3075328:MainThread](2024-04-25 04:57:50,282) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:57:59,038) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:57:59,249) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999906
[3075328:MainThread](2024-04-25 04:57:59,249) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch20:
[3075328:MainThread](2024-04-25 04:57:59,250) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:58:07,160) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:58:07,373) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999288
[3075328:MainThread](2024-04-25 04:58:07,373) INFO - qlib.ALSTM - [pytorch_alstm.py:288] - early stop
[3075328:MainThread](2024-04-25 04:58:07,373) INFO - qlib.ALSTM - [pytorch_alstm.py:291] - best score: -0.997516 @ 12
[3075328:MainThread](2024-04-25 04:58:07,401) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ALSTM_crowd_data_csi300_360_rankTrue_49.
[3075328:MainThread](2024-04-25 04:58:07,679) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3075328:MainThread](2024-04-25 04:58:07,693) INFO - qlib.workflow - [recorder.py:341] - Recorder 2985660d2d5c4d16b694e60f1016cc90 starts running under Experiment 53 ...
{'IC': 0.009764402916850955,
 'ICIR': 0.07023699528403027,
 'Rank IC': 0.019933059214074286,
 'Rank ICIR': 0.14056676552068084}
[3075328:MainThread](2024-04-25 04:58:14,151) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3075328:MainThread](2024-04-25 04:58:51,412) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 04:58:51,416) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 04:58:57,487) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8370a41070>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:42,  9.46it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.41it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 34.21it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 38.16it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 43.30it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 46.68it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 46.22it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:18, 48.90it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 50.73it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 48.97it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 51.26it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:16, 53.57it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 54.25it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 54.57it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 51.70it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 52.86it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 53.41it/s]backtest loop:  11%|█         | 105/971 [00:02<00:16, 54.07it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:15, 54.52it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 51.41it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 52.65it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:16, 50.19it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:16, 51.65it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:16, 49.64it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:16, 51.25it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 52.28it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 53.15it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:14, 53.88it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 51.42it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:14, 53.09it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 53.77it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:14, 54.21it/s]backtest loop:  20%|██        | 195/971 [00:03<00:15, 51.22it/s]backtest loop:  21%|██        | 201/971 [00:04<00:14, 52.39it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:14, 53.23it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:14, 50.82it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:14, 52.09it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:22, 32.89it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:19, 37.46it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:17, 41.44it/s]backtest loop:  25%|██▌       | 243/971 [00:05<00:16, 44.80it/s]backtest loop:  26%|██▌       | 249/971 [00:05<00:16, 44.96it/s]backtest loop:  26%|██▋       | 255/971 [00:05<00:15, 47.73it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:14, 49.88it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:14, 48.47it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:13, 50.40it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:13, 51.82it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:13, 52.34it/s]backtest loop:  30%|██▉       | 291/971 [00:06<00:13, 49.92it/s]backtest loop:  31%|███       | 297/971 [00:06<00:13, 51.33it/s]backtest loop:  31%|███       | 303/971 [00:06<00:12, 52.38it/s]backtest loop:  32%|███▏      | 309/971 [00:06<00:12, 53.31it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:12, 50.66it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:12, 51.99it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:12, 52.79it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:11, 53.47it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:11, 54.11it/s]backtest loop:  36%|███▌      | 345/971 [00:07<00:12, 51.14it/s]backtest loop:  36%|███▌      | 351/971 [00:07<00:11, 52.21it/s]backtest loop:  37%|███▋      | 357/971 [00:07<00:11, 53.08it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:12, 50.45it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:12, 49.53it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 50.74it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:11, 52.00it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:11, 53.07it/s]backtest loop:  40%|████      | 393/971 [00:08<00:11, 50.33it/s]backtest loop:  41%|████      | 399/971 [00:08<00:11, 51.59it/s]backtest loop:  42%|████▏     | 405/971 [00:08<00:10, 52.61it/s]backtest loop:  42%|████▏     | 411/971 [00:08<00:10, 54.17it/s]backtest loop:  43%|████▎     | 417/971 [00:08<00:10, 54.77it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:10, 51.54it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:10, 52.47it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:10, 53.21it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 53.71it/s]backtest loop:  46%|████▌     | 447/971 [00:09<00:10, 50.87it/s]backtest loop:  47%|████▋     | 453/971 [00:09<00:09, 51.82it/s]backtest loop:  47%|████▋     | 459/971 [00:09<00:09, 52.78it/s]backtest loop:  48%|████▊     | 465/971 [00:09<00:09, 53.15it/s]backtest loop:  49%|████▊     | 471/971 [00:09<00:09, 53.65it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 50.88it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:09, 51.94it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:09, 52.77it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:09, 50.25it/s]backtest loop:  52%|█████▏    | 501/971 [00:10<00:09, 51.64it/s]backtest loop:  52%|█████▏    | 507/971 [00:10<00:09, 49.65it/s]backtest loop:  53%|█████▎    | 513/971 [00:10<00:08, 51.26it/s]backtest loop:  53%|█████▎    | 519/971 [00:10<00:08, 52.52it/s]backtest loop:  54%|█████▍    | 525/971 [00:10<00:08, 53.46it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 51.04it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:08, 52.20it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:08, 52.71it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 53.24it/s]backtest loop:  57%|█████▋    | 555/971 [00:11<00:07, 53.61it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:08, 50.90it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:07, 52.06it/s]backtest loop:  59%|█████▉    | 573/971 [00:11<00:07, 52.60it/s]backtest loop:  60%|█████▉    | 579/971 [00:11<00:07, 53.18it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:07, 53.73it/s]backtest loop:  61%|██████    | 591/971 [00:11<00:07, 50.86it/s]backtest loop:  61%|██████▏   | 597/971 [00:11<00:07, 52.03it/s]backtest loop:  62%|██████▏   | 603/971 [00:12<00:06, 52.76it/s]backtest loop:  63%|██████▎   | 609/971 [00:12<00:06, 53.15it/s]backtest loop:  63%|██████▎   | 615/971 [00:12<00:07, 50.51it/s]backtest loop:  64%|██████▍   | 621/971 [00:12<00:06, 51.82it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:06, 52.74it/s]backtest loop:  65%|██████▌   | 633/971 [00:12<00:06, 53.38it/s]backtest loop:  66%|██████▌   | 639/971 [00:12<00:06, 53.99it/s]backtest loop:  66%|██████▋   | 645/971 [00:12<00:06, 50.97it/s]backtest loop:  67%|██████▋   | 651/971 [00:12<00:06, 52.22it/s]backtest loop:  68%|██████▊   | 657/971 [00:13<00:05, 53.01it/s]backtest loop:  68%|██████▊   | 663/971 [00:13<00:05, 53.62it/s]backtest loop:  69%|██████▉   | 669/971 [00:13<00:05, 53.83it/s]backtest loop:  70%|██████▉   | 675/971 [00:13<00:05, 50.80it/s]backtest loop:  70%|███████   | 681/971 [00:13<00:05, 51.99it/s]backtest loop:  71%|███████   | 687/971 [00:13<00:05, 52.72it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:05, 53.39it/s]backtest loop:  72%|███████▏  | 699/971 [00:13<00:05, 50.27it/s]backtest loop:  73%|███████▎  | 705/971 [00:13<00:05, 51.58it/s]backtest loop:  73%|███████▎  | 711/971 [00:14<00:04, 52.55it/s]backtest loop:  74%|███████▍  | 717/971 [00:14<00:04, 53.35it/s]backtest loop:  74%|███████▍  | 723/971 [00:14<00:04, 53.87it/s]backtest loop:  75%|███████▌  | 729/971 [00:14<00:04, 50.51it/s]backtest loop:  76%|███████▌  | 735/971 [00:14<00:04, 48.77it/s]backtest loop:  76%|███████▋  | 741/971 [00:14<00:04, 50.39it/s]backtest loop:  77%|███████▋  | 747/971 [00:14<00:04, 51.80it/s]backtest loop:  78%|███████▊  | 753/971 [00:14<00:04, 49.59it/s]backtest loop:  78%|███████▊  | 759/971 [00:15<00:04, 50.95it/s]backtest loop:  79%|███████▉  | 765/971 [00:15<00:04, 49.18it/s]backtest loop:  79%|███████▉  | 771/971 [00:15<00:03, 50.96it/s]backtest loop:  80%|████████  | 777/971 [00:15<00:03, 52.18it/s]backtest loop:  81%|████████  | 783/971 [00:15<00:03, 50.33it/s]backtest loop:  81%|████████▏ | 789/971 [00:15<00:03, 51.64it/s]backtest loop:  82%|████████▏ | 795/971 [00:15<00:03, 52.55it/s]backtest loop:  82%|████████▏ | 801/971 [00:15<00:03, 53.24it/s]backtest loop:  83%|████████▎ | 807/971 [00:15<00:03, 53.86it/s]backtest loop:  84%|████████▎ | 813/971 [00:16<00:03, 50.81it/s]backtest loop:  84%|████████▍ | 819/971 [00:16<00:02, 51.72it/s]backtest loop:  85%|████████▍ | 825/971 [00:16<00:02, 52.62it/s]backtest loop:  86%|████████▌ | 831/971 [00:16<00:02, 53.32it/s]backtest loop:  86%|████████▌ | 837/971 [00:16<00:02, 53.83it/s]backtest loop:  87%|████████▋ | 843/971 [00:16<00:02, 50.88it/s]backtest loop:  87%|████████▋ | 849/971 [00:16<00:02, 52.06it/s]backtest loop:  88%|████████▊ | 855/971 [00:16<00:02, 52.87it/s]backtest loop:  89%|████████▊ | 861/971 [00:16<00:02, 53.49it/s]backtest loop:  89%|████████▉ | 867/971 [00:17<00:02, 50.71it/s]backtest loop:  90%|████████▉ | 873/971 [00:17<00:01, 51.91it/s]backtest loop:  91%|█████████ | 879/971 [00:17<00:01, 52.79it/s]backtest loop:  91%|█████████ | 885/971 [00:17<00:01, 53.61it/s]backtest loop:  92%|█████████▏| 891/971 [00:17<00:01, 54.02it/s]backtest loop:  92%|█████████▏| 897/971 [00:17<00:01, 51.11it/s]backtest loop:  93%|█████████▎| 903/971 [00:17<00:01, 52.04it/s]backtest loop:  94%|█████████▎| 909/971 [00:17<00:01, 52.88it/s]backtest loop:  94%|█████████▍| 915/971 [00:17<00:01, 53.54it/s]backtest loop:  95%|█████████▍| 921/971 [00:18<00:00, 50.73it/s]backtest loop:  95%|█████████▌| 927/971 [00:18<00:00, 51.94it/s]backtest loop:  96%|█████████▌| 933/971 [00:18<00:00, 52.87it/s]backtest loop:  97%|█████████▋| 939/971 [00:18<00:00, 53.52it/s]backtest loop:  97%|█████████▋| 945/971 [00:18<00:00, 50.67it/s]backtest loop:  98%|█████████▊| 951/971 [00:18<00:00, 52.16it/s]backtest loop:  99%|█████████▊| 957/971 [00:18<00:00, 53.14it/s]backtest loop:  99%|█████████▉| 963/971 [00:18<00:00, 53.69it/s]backtest loop: 100%|█████████▉| 969/971 [00:19<00:00, 54.10it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 50.91it/s]
[3075328:MainThread](2024-04-25 04:59:16,617) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000375
std                0.005778
annualized_return  0.089169
information_ratio  1.000401
max_drawdown      -0.131378
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000175
std                0.005779
annualized_return  0.041608
information_ratio  0.466709
max_drawdown      -0.146007
[3075328:MainThread](2024-04-25 04:59:16,630) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ALSTM_crowd_data_csi300_360_rankTrue`.
[3075328:MainThread](2024-04-25 04:59:23,447) INFO - qlib.timer - [log.py:127] - Time cost: 0.007s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.017308512649334296,
                                                    0.025226956174298033,
                                                    0.055416874840888225,
                                                    0.011783526040045877,
                                                    0.01400035120779,
                                                    0.09438899367942376,
                                                    0.041607827881493614],
 '1day.excess_return_with_cost.information_ratio': [0.18010918865041212,
                                                    0.2934252565629728,
                                                    0.6581594906091128,
                                                    0.11569611052484179,
                                                    0.17551813038162198,
                                                    1.170922812371982,
                                                    0.4667094254577868],
 '1day.excess_return_with_cost.max_drawdown': [-0.20064185075338067,
                                               -0.14870747098105508,
                                               -0.12217177617500374,
                                               -0.21105626405968622,
                                               -0.1580217854884085,
                                               -0.09807365571942406,
                                               -0.14600701746379632],
 'IC': [0.009460425373336639,
        0.008745406877420814,
        0.015760138418877627,
        0.008647241309561056,
        0.016392490271658844,
        0.017164146008581356,
        0.009764402916850955],
 'ICIR': [0.06965137982819328,
          0.05342470255464294,
          0.11363008207509598,
          0.05326330213167523,
          0.1356954085685115,
          0.1261014926685193,
          0.07023699528403027],
 'Rank IC': [0.009648519317820762,
             0.02047129256618671,
             0.03334113414017674,
             0.020794906241499118,
             0.02183316905374321,
             0.03022300820925804,
             0.019933059214074286],
 'Rank ICIR': [0.07157037796176006,
               0.12302168329159428,
               0.2406959310867998,
               0.12470591190690966,
               0.17660391793369556,
               0.21548209310462074,
               0.14056676552068084],
 'mae': [0.8649170762273879,
         0.8647050803459836,
         0.86420207780724,
         0.8646977009841796,
         0.864640614854717,
         0.8642817708638176,
         0.8647837416384312],
 'mse': [0.9979492119324258,
         0.9973789235077785,
         0.9969335457109181,
         0.9978615205614849,
         0.9976719791223738,
         0.9972576945583526,
         0.9977125670458249]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3075328:MainThread](2024-04-25 04:59:26,650) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3075328:MainThread](2024-04-25 04:59:26,651) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3075328:MainThread](2024-04-25 04:59:26,653) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3075328:MainThread](2024-04-25 04:59:26,653) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
[3075328:MainThread](2024-04-25 04:59:29,547) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ALSTM_crowd_data_csi300_360_rankTrue_50.
[3075328:MainThread](2024-04-25 04:59:29,596) INFO - qlib.workflow - [exp.py:258] - Experiment 60 starts running ...
[3075328:MainThread](2024-04-25 04:59:29,612) INFO - qlib.workflow - [recorder.py:341] - Recorder 21dc9086bc684b2d802c1df10881ec0c starts running under Experiment 60 ...
[3075328:MainThread](2024-04-25 04:59:34,758) INFO - qlib.ALSTM - [pytorch_alstm.py:266] - training...
[3075328:MainThread](2024-04-25 04:59:34,758) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch0:
[3075328:MainThread](2024-04-25 04:59:34,759) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:59:43,198) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:59:43,419) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.015183
[3075328:MainThread](2024-04-25 04:59:43,420) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch1:
[3075328:MainThread](2024-04-25 04:59:43,421) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 04:59:52,282) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 04:59:52,503) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.000663
[3075328:MainThread](2024-04-25 04:59:52,504) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch2:
[3075328:MainThread](2024-04-25 04:59:52,505) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:00:01,222) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:00:01,433) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.000149
[3075328:MainThread](2024-04-25 05:00:01,435) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch3:
[3075328:MainThread](2024-04-25 05:00:01,435) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:00:09,741) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:00:09,953) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999321
[3075328:MainThread](2024-04-25 05:00:09,954) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch4:
[3075328:MainThread](2024-04-25 05:00:09,954) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:00:18,158) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:00:18,369) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999831
[3075328:MainThread](2024-04-25 05:00:18,369) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch5:
[3075328:MainThread](2024-04-25 05:00:18,370) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:00:26,273) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:00:26,486) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.000074
[3075328:MainThread](2024-04-25 05:00:26,487) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch6:
[3075328:MainThread](2024-04-25 05:00:26,487) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:00:34,483) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:00:34,694) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.004004
[3075328:MainThread](2024-04-25 05:00:34,694) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch7:
[3075328:MainThread](2024-04-25 05:00:34,694) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:00:43,051) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:00:43,272) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998216
[3075328:MainThread](2024-04-25 05:00:43,273) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch8:
[3075328:MainThread](2024-04-25 05:00:43,274) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:00:51,981) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:00:52,200) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997399
[3075328:MainThread](2024-04-25 05:00:52,201) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch9:
[3075328:MainThread](2024-04-25 05:00:52,201) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:01:00,141) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:01:00,353) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997908
[3075328:MainThread](2024-04-25 05:01:00,353) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch10:
[3075328:MainThread](2024-04-25 05:01:00,354) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:01:08,269) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:01:08,480) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.001175
[3075328:MainThread](2024-04-25 05:01:08,481) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch11:
[3075328:MainThread](2024-04-25 05:01:08,481) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:01:16,547) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:01:16,759) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997639
[3075328:MainThread](2024-04-25 05:01:16,759) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch12:
[3075328:MainThread](2024-04-25 05:01:16,759) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:01:25,348) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:01:25,562) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997048
[3075328:MainThread](2024-04-25 05:01:25,564) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch13:
[3075328:MainThread](2024-04-25 05:01:25,564) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:01:33,714) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:01:33,935) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997129
[3075328:MainThread](2024-04-25 05:01:33,935) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch14:
[3075328:MainThread](2024-04-25 05:01:33,935) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:01:42,805) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:01:43,026) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997124
[3075328:MainThread](2024-04-25 05:01:43,027) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch15:
[3075328:MainThread](2024-04-25 05:01:43,027) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:01:50,953) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:01:51,166) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997075
[3075328:MainThread](2024-04-25 05:01:51,166) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch16:
[3075328:MainThread](2024-04-25 05:01:51,166) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:01:59,372) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:01:59,583) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997568
[3075328:MainThread](2024-04-25 05:01:59,583) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch17:
[3075328:MainThread](2024-04-25 05:01:59,584) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:02:07,495) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:02:07,707) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997698
[3075328:MainThread](2024-04-25 05:02:07,707) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch18:
[3075328:MainThread](2024-04-25 05:02:07,708) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:02:15,658) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:02:15,872) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998563
[3075328:MainThread](2024-04-25 05:02:15,872) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch19:
[3075328:MainThread](2024-04-25 05:02:15,873) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:02:23,828) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:02:24,043) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997594
[3075328:MainThread](2024-04-25 05:02:24,043) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch20:
[3075328:MainThread](2024-04-25 05:02:24,043) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:02:31,997) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:02:32,213) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998030
[3075328:MainThread](2024-04-25 05:02:32,213) INFO - qlib.ALSTM - [pytorch_alstm.py:288] - early stop
[3075328:MainThread](2024-04-25 05:02:32,214) INFO - qlib.ALSTM - [pytorch_alstm.py:291] - best score: -0.997048 @ 12
[3075328:MainThread](2024-04-25 05:02:32,238) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ALSTM_crowd_data_csi300_360_rankTrue_50.
[3075328:MainThread](2024-04-25 05:02:32,518) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3075328:MainThread](2024-04-25 05:02:32,532) INFO - qlib.workflow - [recorder.py:341] - Recorder aba83ab5da8543e48b15c42dbcee1bbe starts running under Experiment 53 ...
{'IC': 0.009864084638396725,
 'ICIR': 0.07520104909263912,
 'Rank IC': 0.017790109449458653,
 'Rank ICIR': 0.1311330888976296}
[3075328:MainThread](2024-04-25 05:02:39,250) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3075328:MainThread](2024-04-25 05:03:16,535) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 05:03:16,538) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 05:03:22,640) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8373362880>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:46,  9.08it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 23.72it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 33.57it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:25, 37.81it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:22, 42.88it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 46.48it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 45.45it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:19, 48.17it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 50.16it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 48.56it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 51.29it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:16, 53.15it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 53.88it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 54.00it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 51.53it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 52.66it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 53.29it/s]backtest loop:  11%|█         | 105/971 [00:02<00:16, 53.83it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:15, 54.29it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 50.84it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 52.17it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:16, 49.84it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:16, 51.24it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:16, 49.30it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:16, 50.91it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 51.64it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 52.46it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:15, 53.13it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 50.40it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:15, 51.70it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 52.62it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:14, 53.38it/s]backtest loop:  20%|██        | 195/971 [00:04<00:15, 50.95it/s]backtest loop:  21%|██        | 201/971 [00:04<00:14, 52.10it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:14, 52.97it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:15, 50.43it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:14, 52.26it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:14, 49.96it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:22, 32.96it/s]backtest loop:  24%|██▍       | 237/971 [00:05<00:19, 37.47it/s]backtest loop:  25%|██▌       | 243/971 [00:05<00:17, 41.56it/s]backtest loop:  26%|██▌       | 249/971 [00:05<00:16, 42.60it/s]backtest loop:  26%|██▋       | 255/971 [00:05<00:15, 45.72it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:14, 48.31it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:14, 47.38it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:14, 49.45it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:13, 50.95it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:13, 52.13it/s]backtest loop:  30%|██▉       | 291/971 [00:06<00:13, 49.86it/s]backtest loop:  31%|███       | 297/971 [00:06<00:13, 51.32it/s]backtest loop:  31%|███       | 303/971 [00:06<00:12, 52.40it/s]backtest loop:  32%|███▏      | 309/971 [00:06<00:12, 53.27it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:12, 50.53it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:12, 51.97it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:12, 52.94it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:11, 53.78it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:11, 54.40it/s]backtest loop:  36%|███▌      | 345/971 [00:07<00:12, 51.44it/s]backtest loop:  36%|███▌      | 351/971 [00:07<00:11, 52.80it/s]backtest loop:  37%|███▋      | 357/971 [00:07<00:11, 53.48it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:11, 50.68it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:12, 49.01it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 50.62it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:11, 51.31it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:11, 51.89it/s]backtest loop:  40%|████      | 393/971 [00:08<00:11, 49.82it/s]backtest loop:  41%|████      | 399/971 [00:08<00:11, 51.27it/s]backtest loop:  42%|████▏     | 405/971 [00:08<00:10, 52.43it/s]backtest loop:  42%|████▏     | 411/971 [00:08<00:10, 53.97it/s]backtest loop:  43%|████▎     | 417/971 [00:08<00:10, 54.74it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:10, 51.41it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:10, 52.43it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:10, 53.15it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 53.69it/s]backtest loop:  46%|████▌     | 447/971 [00:09<00:10, 50.89it/s]backtest loop:  47%|████▋     | 453/971 [00:09<00:09, 52.04it/s]backtest loop:  47%|████▋     | 459/971 [00:09<00:09, 53.15it/s]backtest loop:  48%|████▊     | 465/971 [00:09<00:09, 53.58it/s]backtest loop:  49%|████▊     | 471/971 [00:09<00:09, 54.12it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 51.37it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:09, 52.34it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:09, 53.11it/s]backtest loop:  51%|█████     | 495/971 [00:10<00:09, 50.55it/s]backtest loop:  52%|█████▏    | 501/971 [00:10<00:09, 51.84it/s]backtest loop:  52%|█████▏    | 507/971 [00:10<00:09, 49.93it/s]backtest loop:  53%|█████▎    | 513/971 [00:10<00:08, 51.12it/s]backtest loop:  53%|█████▎    | 519/971 [00:10<00:08, 52.29it/s]backtest loop:  54%|█████▍    | 525/971 [00:10<00:08, 53.16it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 50.65it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:08, 52.02it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:08, 52.90it/s]backtest loop:  57%|█████▋    | 549/971 [00:11<00:07, 53.60it/s]backtest loop:  57%|█████▋    | 555/971 [00:11<00:07, 53.94it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:08, 50.68it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:07, 51.89it/s]backtest loop:  59%|█████▉    | 573/971 [00:11<00:07, 52.94it/s]backtest loop:  60%|█████▉    | 579/971 [00:11<00:07, 53.58it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:07, 53.98it/s]backtest loop:  61%|██████    | 591/971 [00:11<00:07, 51.02it/s]backtest loop:  61%|██████▏   | 597/971 [00:11<00:07, 52.14it/s]backtest loop:  62%|██████▏   | 603/971 [00:12<00:06, 52.72it/s]backtest loop:  63%|██████▎   | 609/971 [00:12<00:06, 53.32it/s]backtest loop:  63%|██████▎   | 615/971 [00:12<00:07, 50.69it/s]backtest loop:  64%|██████▍   | 621/971 [00:12<00:06, 51.91it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:06, 53.09it/s]backtest loop:  65%|██████▌   | 633/971 [00:12<00:06, 53.65it/s]backtest loop:  66%|██████▌   | 639/971 [00:12<00:06, 54.17it/s]backtest loop:  66%|██████▋   | 645/971 [00:12<00:06, 51.13it/s]backtest loop:  67%|██████▋   | 651/971 [00:12<00:06, 51.98it/s]backtest loop:  68%|██████▊   | 657/971 [00:13<00:05, 52.77it/s]backtest loop:  68%|██████▊   | 663/971 [00:13<00:05, 53.34it/s]backtest loop:  69%|██████▉   | 669/971 [00:13<00:05, 53.72it/s]backtest loop:  70%|██████▉   | 675/971 [00:13<00:05, 50.63it/s]backtest loop:  70%|███████   | 681/971 [00:13<00:05, 51.71it/s]backtest loop:  71%|███████   | 687/971 [00:13<00:05, 52.50it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:05, 53.16it/s]backtest loop:  72%|███████▏  | 699/971 [00:13<00:05, 50.07it/s]backtest loop:  73%|███████▎  | 705/971 [00:14<00:05, 51.21it/s]backtest loop:  73%|███████▎  | 711/971 [00:14<00:04, 52.18it/s]backtest loop:  74%|███████▍  | 717/971 [00:14<00:04, 53.00it/s]backtest loop:  74%|███████▍  | 723/971 [00:14<00:04, 53.64it/s]backtest loop:  75%|███████▌  | 729/971 [00:14<00:04, 50.88it/s]backtest loop:  76%|███████▌  | 735/971 [00:14<00:04, 48.74it/s]backtest loop:  76%|███████▋  | 741/971 [00:14<00:04, 50.15it/s]backtest loop:  77%|███████▋  | 747/971 [00:14<00:04, 51.49it/s]backtest loop:  78%|███████▊  | 753/971 [00:14<00:04, 49.40it/s]backtest loop:  78%|███████▊  | 759/971 [00:15<00:04, 50.73it/s]backtest loop:  79%|███████▉  | 765/971 [00:15<00:04, 48.89it/s]backtest loop:  79%|███████▉  | 771/971 [00:15<00:03, 50.56it/s]backtest loop:  80%|████████  | 777/971 [00:15<00:03, 51.86it/s]backtest loop:  81%|████████  | 783/971 [00:15<00:03, 49.67it/s]backtest loop:  81%|████████▏ | 789/971 [00:15<00:03, 50.77it/s]backtest loop:  82%|████████▏ | 795/971 [00:15<00:03, 51.94it/s]backtest loop:  82%|████████▏ | 801/971 [00:15<00:03, 52.82it/s]backtest loop:  83%|████████▎ | 807/971 [00:16<00:03, 53.42it/s]backtest loop:  84%|████████▎ | 813/971 [00:16<00:03, 50.55it/s]backtest loop:  84%|████████▍ | 819/971 [00:16<00:02, 51.79it/s]backtest loop:  85%|████████▍ | 825/971 [00:16<00:02, 52.69it/s]backtest loop:  86%|████████▌ | 831/971 [00:16<00:02, 52.63it/s]backtest loop:  86%|████████▌ | 837/971 [00:16<00:02, 53.25it/s]backtest loop:  87%|████████▋ | 843/971 [00:16<00:02, 50.54it/s]backtest loop:  87%|████████▋ | 849/971 [00:16<00:02, 51.78it/s]backtest loop:  88%|████████▊ | 855/971 [00:16<00:02, 52.68it/s]backtest loop:  89%|████████▊ | 861/971 [00:17<00:02, 53.33it/s]backtest loop:  89%|████████▉ | 867/971 [00:17<00:02, 50.66it/s]backtest loop:  90%|████████▉ | 873/971 [00:17<00:01, 51.90it/s]backtest loop:  91%|█████████ | 879/971 [00:17<00:01, 52.81it/s]backtest loop:  91%|█████████ | 885/971 [00:17<00:01, 53.51it/s]backtest loop:  92%|█████████▏| 891/971 [00:17<00:01, 53.75it/s]backtest loop:  92%|█████████▏| 897/971 [00:17<00:01, 50.94it/s]backtest loop:  93%|█████████▎| 903/971 [00:17<00:01, 52.08it/s]backtest loop:  94%|█████████▎| 909/971 [00:17<00:01, 52.90it/s]backtest loop:  94%|█████████▍| 915/971 [00:18<00:01, 53.58it/s]backtest loop:  95%|█████████▍| 921/971 [00:18<00:00, 50.76it/s]backtest loop:  95%|█████████▌| 927/971 [00:18<00:00, 51.95it/s]backtest loop:  96%|█████████▌| 933/971 [00:18<00:00, 52.73it/s]backtest loop:  97%|█████████▋| 939/971 [00:18<00:00, 53.31it/s]backtest loop:  97%|█████████▋| 945/971 [00:18<00:00, 50.48it/s]backtest loop:  98%|█████████▊| 951/971 [00:18<00:00, 51.74it/s]backtest loop:  99%|█████████▊| 957/971 [00:18<00:00, 52.66it/s]backtest loop:  99%|█████████▉| 963/971 [00:18<00:00, 53.32it/s]backtest loop: 100%|█████████▉| 969/971 [00:19<00:00, 53.82it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 50.71it/s]
[3075328:MainThread](2024-04-25 05:03:41,850) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000293
std                0.005294
annualized_return  0.069787
information_ratio  0.854508
max_drawdown      -0.103389
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000096
std                0.005296
annualized_return  0.022907
information_ratio  0.280391
max_drawdown      -0.159885
[3075328:MainThread](2024-04-25 05:03:41,864) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ALSTM_crowd_data_csi300_360_rankTrue`.
[3075328:MainThread](2024-04-25 05:03:48,698) INFO - qlib.timer - [log.py:127] - Time cost: 0.007s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.017308512649334296,
                                                    0.025226956174298033,
                                                    0.055416874840888225,
                                                    0.011783526040045877,
                                                    0.01400035120779,
                                                    0.09438899367942376,
                                                    0.041607827881493614,
                                                    0.022907194712505994],
 '1day.excess_return_with_cost.information_ratio': [0.18010918865041212,
                                                    0.2934252565629728,
                                                    0.6581594906091128,
                                                    0.11569611052484179,
                                                    0.17551813038162198,
                                                    1.170922812371982,
                                                    0.4667094254577868,
                                                    0.2803908828040007],
 '1day.excess_return_with_cost.max_drawdown': [-0.20064185075338067,
                                               -0.14870747098105508,
                                               -0.12217177617500374,
                                               -0.21105626405968622,
                                               -0.1580217854884085,
                                               -0.09807365571942406,
                                               -0.14600701746379632,
                                               -0.15988541296670056],
 'IC': [0.009460425373336639,
        0.008745406877420814,
        0.015760138418877627,
        0.008647241309561056,
        0.016392490271658844,
        0.017164146008581356,
        0.009764402916850955,
        0.009864084638396725],
 'ICIR': [0.06965137982819328,
          0.05342470255464294,
          0.11363008207509598,
          0.05326330213167523,
          0.1356954085685115,
          0.1261014926685193,
          0.07023699528403027,
          0.07520104909263912],
 'Rank IC': [0.009648519317820762,
             0.02047129256618671,
             0.03334113414017674,
             0.020794906241499118,
             0.02183316905374321,
             0.03022300820925804,
             0.019933059214074286,
             0.017790109449458653],
 'Rank ICIR': [0.07157037796176006,
               0.12302168329159428,
               0.2406959310867998,
               0.12470591190690966,
               0.17660391793369556,
               0.21548209310462074,
               0.14056676552068084,
               0.1311330888976296],
 'mae': [0.8649170762273879,
         0.8647050803459836,
         0.86420207780724,
         0.8646977009841796,
         0.864640614854717,
         0.8642817708638176,
         0.8647837416384312,
         0.8647544713522343],
 'mse': [0.9979492119324258,
         0.9973789235077785,
         0.9969335457109181,
         0.9978615205614849,
         0.9976719791223738,
         0.9972576945583526,
         0.9977125670458249,
         0.9972506214027482]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3075328:MainThread](2024-04-25 05:03:51,908) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3075328:MainThread](2024-04-25 05:03:51,908) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3075328:MainThread](2024-04-25 05:03:51,910) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3075328:MainThread](2024-04-25 05:03:51,911) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
[3075328:MainThread](2024-04-25 05:03:54,809) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ALSTM_crowd_data_csi300_360_rankTrue_51.
[3075328:MainThread](2024-04-25 05:03:54,859) INFO - qlib.workflow - [exp.py:258] - Experiment 61 starts running ...
[3075328:MainThread](2024-04-25 05:03:54,874) INFO - qlib.workflow - [recorder.py:341] - Recorder 9f6a20f624d0434fb61dbbc44bc538c0 starts running under Experiment 61 ...
[3075328:MainThread](2024-04-25 05:04:00,011) INFO - qlib.ALSTM - [pytorch_alstm.py:266] - training...
[3075328:MainThread](2024-04-25 05:04:00,012) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch0:
[3075328:MainThread](2024-04-25 05:04:00,012) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:04:08,338) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:04:08,549) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998846
[3075328:MainThread](2024-04-25 05:04:08,551) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch1:
[3075328:MainThread](2024-04-25 05:04:08,551) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:04:16,887) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:04:17,098) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998795
[3075328:MainThread](2024-04-25 05:04:17,100) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch2:
[3075328:MainThread](2024-04-25 05:04:17,100) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:04:25,025) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:04:25,236) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997271
[3075328:MainThread](2024-04-25 05:04:25,237) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch3:
[3075328:MainThread](2024-04-25 05:04:25,238) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:04:33,464) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:04:33,686) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997755
[3075328:MainThread](2024-04-25 05:04:33,686) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch4:
[3075328:MainThread](2024-04-25 05:04:33,687) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:04:42,441) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:04:42,661) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997963
[3075328:MainThread](2024-04-25 05:04:42,662) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch5:
[3075328:MainThread](2024-04-25 05:04:42,662) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:04:51,155) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:04:51,367) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998884
[3075328:MainThread](2024-04-25 05:04:51,367) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch6:
[3075328:MainThread](2024-04-25 05:04:51,368) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:04:59,352) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:04:59,566) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998481
[3075328:MainThread](2024-04-25 05:04:59,567) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch7:
[3075328:MainThread](2024-04-25 05:04:59,567) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:05:07,638) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:05:07,852) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998006
[3075328:MainThread](2024-04-25 05:05:07,853) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch8:
[3075328:MainThread](2024-04-25 05:05:07,853) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:05:15,913) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:05:16,125) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998301
[3075328:MainThread](2024-04-25 05:05:16,125) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch9:
[3075328:MainThread](2024-04-25 05:05:16,125) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:05:24,378) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:05:24,590) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997224
[3075328:MainThread](2024-04-25 05:05:24,592) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch10:
[3075328:MainThread](2024-04-25 05:05:24,592) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:05:32,499) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:05:32,718) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997907
[3075328:MainThread](2024-04-25 05:05:32,718) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch11:
[3075328:MainThread](2024-04-25 05:05:32,718) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:05:41,562) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:05:41,783) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998389
[3075328:MainThread](2024-04-25 05:05:41,783) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch12:
[3075328:MainThread](2024-04-25 05:05:41,784) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:05:49,943) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:05:50,155) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997244
[3075328:MainThread](2024-04-25 05:05:50,156) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch13:
[3075328:MainThread](2024-04-25 05:05:50,156) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:05:57,944) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:05:58,158) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997723
[3075328:MainThread](2024-04-25 05:05:58,158) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch14:
[3075328:MainThread](2024-04-25 05:05:58,159) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:06:06,103) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:06:06,314) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997630
[3075328:MainThread](2024-04-25 05:06:06,315) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch15:
[3075328:MainThread](2024-04-25 05:06:06,315) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:06:14,289) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:06:14,502) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997835
[3075328:MainThread](2024-04-25 05:06:14,502) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch16:
[3075328:MainThread](2024-04-25 05:06:14,502) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:06:23,006) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:06:23,218) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997933
[3075328:MainThread](2024-04-25 05:06:23,218) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch17:
[3075328:MainThread](2024-04-25 05:06:23,219) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:06:31,737) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:06:31,958) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999175
[3075328:MainThread](2024-04-25 05:06:31,958) INFO - qlib.ALSTM - [pytorch_alstm.py:288] - early stop
[3075328:MainThread](2024-04-25 05:06:31,959) INFO - qlib.ALSTM - [pytorch_alstm.py:291] - best score: -0.997224 @ 9
[3075328:MainThread](2024-04-25 05:06:31,984) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ALSTM_crowd_data_csi300_360_rankTrue_51.
[3075328:MainThread](2024-04-25 05:06:32,264) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3075328:MainThread](2024-04-25 05:06:32,278) INFO - qlib.workflow - [recorder.py:341] - Recorder 77cea9d79b894c7bb07e43a27ae01934 starts running under Experiment 53 ...
{'IC': 0.00806611959668952,
 'ICIR': 0.04861903054757404,
 'Rank IC': 0.013584130111604257,
 'Rank ICIR': 0.08156208428994347}
[3075328:MainThread](2024-04-25 05:06:38,794) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3075328:MainThread](2024-04-25 05:07:15,691) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 05:07:15,694) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 05:07:21,730) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8375c1e3a0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:44,  9.29it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 23.97it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 33.67it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:25, 37.74it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 42.93it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 46.53it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 45.89it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:19, 48.62it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 50.51it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 48.81it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 51.18it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 52.12it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 53.12it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 53.88it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 50.99it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 52.43it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 52.97it/s]backtest loop:  11%|█         | 105/971 [00:02<00:16, 53.69it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:15, 54.45it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 51.58it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 52.78it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:16, 50.04it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:15, 52.50it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:16, 50.23it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:15, 51.73it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 52.70it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 53.18it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:15, 53.66it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 51.12it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:15, 52.67it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 53.41it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:14, 53.91it/s]backtest loop:  20%|██        | 195/971 [00:04<00:15, 50.78it/s]backtest loop:  21%|██        | 201/971 [00:04<00:14, 52.07it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:14, 53.37it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:14, 51.66it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:14, 53.32it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:14, 50.73it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:14, 52.12it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:13, 52.83it/s]backtest loop:  25%|██▌       | 243/971 [00:04<00:13, 53.52it/s]backtest loop:  26%|██▌       | 249/971 [00:05<00:14, 50.85it/s]backtest loop:  26%|██▋       | 255/971 [00:05<00:13, 51.75it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:19, 35.86it/s]backtest loop:  27%|██▋       | 266/971 [00:05<00:18, 37.44it/s]backtest loop:  28%|██▊       | 272/971 [00:05<00:16, 41.43it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:15, 44.81it/s]backtest loop:  29%|██▉       | 284/971 [00:05<00:14, 47.50it/s]backtest loop:  30%|██▉       | 290/971 [00:05<00:13, 49.59it/s]backtest loop:  30%|███       | 296/971 [00:06<00:13, 48.30it/s]backtest loop:  31%|███       | 302/971 [00:06<00:13, 49.88it/s]backtest loop:  32%|███▏      | 308/971 [00:06<00:12, 51.31it/s]backtest loop:  32%|███▏      | 314/971 [00:06<00:12, 52.41it/s]backtest loop:  33%|███▎      | 320/971 [00:06<00:13, 50.03it/s]backtest loop:  34%|███▎      | 326/971 [00:06<00:12, 51.34it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:12, 52.65it/s]backtest loop:  35%|███▍      | 338/971 [00:06<00:11, 53.35it/s]backtest loop:  35%|███▌      | 344/971 [00:07<00:11, 53.93it/s]backtest loop:  36%|███▌      | 350/971 [00:07<00:12, 51.13it/s]backtest loop:  37%|███▋      | 356/971 [00:07<00:11, 52.27it/s]backtest loop:  37%|███▋      | 362/971 [00:07<00:11, 53.39it/s]backtest loop:  38%|███▊      | 368/971 [00:07<00:12, 48.24it/s]backtest loop:  39%|███▊      | 374/971 [00:07<00:11, 50.03it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:11, 51.43it/s]backtest loop:  40%|███▉      | 386/971 [00:07<00:11, 52.48it/s]backtest loop:  40%|████      | 392/971 [00:07<00:10, 53.23it/s]backtest loop:  41%|████      | 398/971 [00:08<00:11, 50.30it/s]backtest loop:  42%|████▏     | 404/971 [00:08<00:10, 51.80it/s]backtest loop:  42%|████▏     | 410/971 [00:08<00:10, 53.61it/s]backtest loop:  43%|████▎     | 416/971 [00:08<00:10, 54.61it/s]backtest loop:  43%|████▎     | 422/971 [00:08<00:10, 54.77it/s]backtest loop:  44%|████▍     | 428/971 [00:08<00:10, 51.18it/s]backtest loop:  45%|████▍     | 434/971 [00:08<00:10, 52.24it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:09, 53.20it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:09, 53.78it/s]backtest loop:  47%|████▋     | 452/971 [00:09<00:10, 50.67it/s]backtest loop:  47%|████▋     | 458/971 [00:09<00:09, 51.75it/s]backtest loop:  48%|████▊     | 464/971 [00:09<00:09, 52.82it/s]backtest loop:  48%|████▊     | 470/971 [00:09<00:09, 53.43it/s]backtest loop:  49%|████▉     | 476/971 [00:09<00:09, 54.05it/s]backtest loop:  50%|████▉     | 482/971 [00:09<00:09, 51.10it/s]backtest loop:  50%|█████     | 488/971 [00:09<00:09, 52.00it/s]backtest loop:  51%|█████     | 494/971 [00:09<00:09, 52.91it/s]backtest loop:  51%|█████▏    | 500/971 [00:10<00:09, 50.39it/s]backtest loop:  52%|█████▏    | 506/971 [00:10<00:08, 51.93it/s]backtest loop:  53%|█████▎    | 512/971 [00:10<00:09, 49.66it/s]backtest loop:  53%|█████▎    | 518/971 [00:10<00:08, 51.17it/s]backtest loop:  54%|█████▍    | 524/971 [00:10<00:08, 52.07it/s]backtest loop:  55%|█████▍    | 530/971 [00:10<00:08, 53.10it/s]backtest loop:  55%|█████▌    | 536/971 [00:10<00:08, 50.67it/s]backtest loop:  56%|█████▌    | 542/971 [00:10<00:08, 52.15it/s]backtest loop:  56%|█████▋    | 548/971 [00:10<00:08, 52.76it/s]backtest loop:  57%|█████▋    | 554/971 [00:11<00:07, 53.56it/s]backtest loop:  58%|█████▊    | 560/971 [00:11<00:07, 54.02it/s]backtest loop:  58%|█████▊    | 566/971 [00:11<00:07, 51.12it/s]backtest loop:  59%|█████▉    | 572/971 [00:11<00:07, 52.31it/s]backtest loop:  60%|█████▉    | 578/971 [00:11<00:07, 52.74it/s]backtest loop:  60%|██████    | 584/971 [00:11<00:07, 53.43it/s]backtest loop:  61%|██████    | 590/971 [00:11<00:07, 53.96it/s]backtest loop:  61%|██████▏   | 596/971 [00:11<00:07, 51.08it/s]backtest loop:  62%|██████▏   | 602/971 [00:11<00:07, 51.74it/s]backtest loop:  63%|██████▎   | 608/971 [00:12<00:06, 52.62it/s]backtest loop:  63%|██████▎   | 614/971 [00:12<00:06, 53.17it/s]backtest loop:  64%|██████▍   | 620/971 [00:12<00:06, 50.60it/s]backtest loop:  64%|██████▍   | 626/971 [00:12<00:06, 51.99it/s]backtest loop:  65%|██████▌   | 632/971 [00:12<00:06, 52.90it/s]backtest loop:  66%|██████▌   | 638/971 [00:12<00:06, 53.49it/s]backtest loop:  66%|██████▋   | 644/971 [00:12<00:06, 53.70it/s]backtest loop:  67%|██████▋   | 650/971 [00:12<00:06, 50.85it/s]backtest loop:  68%|██████▊   | 656/971 [00:13<00:06, 52.13it/s]backtest loop:  68%|██████▊   | 662/971 [00:13<00:05, 52.99it/s]backtest loop:  69%|██████▉   | 668/971 [00:13<00:05, 53.56it/s]backtest loop:  69%|██████▉   | 674/971 [00:13<00:05, 49.88it/s]backtest loop:  70%|███████   | 680/971 [00:13<00:05, 51.25it/s]backtest loop:  71%|███████   | 686/971 [00:13<00:05, 52.13it/s]backtest loop:  71%|███████▏  | 692/971 [00:13<00:05, 52.90it/s]backtest loop:  72%|███████▏  | 698/971 [00:13<00:05, 53.48it/s]backtest loop:  73%|███████▎  | 704/971 [00:13<00:05, 50.40it/s]backtest loop:  73%|███████▎  | 710/971 [00:14<00:05, 51.61it/s]backtest loop:  74%|███████▎  | 716/971 [00:14<00:04, 52.63it/s]backtest loop:  74%|███████▍  | 722/971 [00:14<00:04, 53.28it/s]backtest loop:  75%|███████▍  | 728/971 [00:14<00:04, 54.20it/s]backtest loop:  76%|███████▌  | 734/971 [00:14<00:04, 48.33it/s]backtest loop:  76%|███████▌  | 740/971 [00:14<00:04, 50.34it/s]backtest loop:  77%|███████▋  | 746/971 [00:14<00:04, 51.83it/s]backtest loop:  77%|███████▋  | 752/971 [00:14<00:04, 49.26it/s]backtest loop:  78%|███████▊  | 758/971 [00:14<00:04, 50.86it/s]backtest loop:  79%|███████▊  | 764/971 [00:15<00:03, 51.80it/s]backtest loop:  79%|███████▉  | 770/971 [00:15<00:04, 49.76it/s]backtest loop:  80%|███████▉  | 776/971 [00:15<00:03, 51.19it/s]backtest loop:  81%|████████  | 782/971 [00:15<00:03, 52.35it/s]backtest loop:  81%|████████  | 788/971 [00:15<00:03, 50.37it/s]backtest loop:  82%|████████▏ | 794/971 [00:15<00:03, 51.40it/s]backtest loop:  82%|████████▏ | 800/971 [00:15<00:03, 52.41it/s]backtest loop:  83%|████████▎ | 806/971 [00:15<00:03, 53.15it/s]backtest loop:  84%|████████▎ | 812/971 [00:16<00:02, 53.66it/s]backtest loop:  84%|████████▍ | 818/971 [00:16<00:03, 50.88it/s]backtest loop:  85%|████████▍ | 824/971 [00:16<00:02, 51.89it/s]backtest loop:  85%|████████▌ | 830/971 [00:16<00:02, 52.67it/s]backtest loop:  86%|████████▌ | 836/971 [00:16<00:02, 53.28it/s]backtest loop:  87%|████████▋ | 842/971 [00:16<00:02, 53.70it/s]backtest loop:  87%|████████▋ | 848/971 [00:16<00:02, 50.85it/s]backtest loop:  88%|████████▊ | 854/971 [00:16<00:02, 52.11it/s]backtest loop:  89%|████████▊ | 860/971 [00:16<00:02, 52.97it/s]backtest loop:  89%|████████▉ | 866/971 [00:17<00:01, 53.62it/s]backtest loop:  90%|████████▉ | 872/971 [00:17<00:01, 50.68it/s]backtest loop:  90%|█████████ | 878/971 [00:17<00:01, 52.03it/s]backtest loop:  91%|█████████ | 884/971 [00:17<00:01, 52.94it/s]backtest loop:  92%|█████████▏| 890/971 [00:17<00:01, 53.53it/s]backtest loop:  92%|█████████▏| 896/971 [00:17<00:01, 53.95it/s]backtest loop:  93%|█████████▎| 902/971 [00:17<00:01, 50.99it/s]backtest loop:  94%|█████████▎| 908/971 [00:17<00:01, 51.91it/s]backtest loop:  94%|█████████▍| 914/971 [00:17<00:01, 52.77it/s]backtest loop:  95%|█████████▍| 920/971 [00:18<00:00, 53.37it/s]backtest loop:  95%|█████████▌| 926/971 [00:18<00:00, 50.63it/s]backtest loop:  96%|█████████▌| 932/971 [00:18<00:00, 51.87it/s]backtest loop:  97%|█████████▋| 938/971 [00:18<00:00, 52.77it/s]backtest loop:  97%|█████████▋| 944/971 [00:18<00:00, 53.48it/s]backtest loop:  98%|█████████▊| 950/971 [00:18<00:00, 50.59it/s]backtest loop:  98%|█████████▊| 956/971 [00:18<00:00, 51.96it/s]backtest loop:  99%|█████████▉| 962/971 [00:18<00:00, 52.78it/s]backtest loop: 100%|█████████▉| 968/971 [00:18<00:00, 53.34it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 50.94it/s]
[3075328:MainThread](2024-04-25 05:07:40,851) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000057
std                0.005787
annualized_return  0.013622
information_ratio  0.152569
max_drawdown      -0.291596
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean              -0.000143
std                0.005789
annualized_return -0.034036
information_ratio -0.381133
max_drawdown      -0.394572
[3075328:MainThread](2024-04-25 05:07:40,865) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ALSTM_crowd_data_csi300_360_rankTrue`.
[3075328:MainThread](2024-04-25 05:07:47,509) INFO - qlib.timer - [log.py:127] - Time cost: 0.007s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.017308512649334296,
                                                    0.025226956174298033,
                                                    0.055416874840888225,
                                                    0.011783526040045877,
                                                    0.01400035120779,
                                                    0.09438899367942376,
                                                    0.041607827881493614,
                                                    0.022907194712505994,
                                                    -0.03403551724848347],
 '1day.excess_return_with_cost.information_ratio': [0.18010918865041212,
                                                    0.2934252565629728,
                                                    0.6581594906091128,
                                                    0.11569611052484179,
                                                    0.17551813038162198,
                                                    1.170922812371982,
                                                    0.4667094254577868,
                                                    0.2803908828040007,
                                                    -0.38113340755017144],
 '1day.excess_return_with_cost.max_drawdown': [-0.20064185075338067,
                                               -0.14870747098105508,
                                               -0.12217177617500374,
                                               -0.21105626405968622,
                                               -0.1580217854884085,
                                               -0.09807365571942406,
                                               -0.14600701746379632,
                                               -0.15988541296670056,
                                               -0.39457224349011644],
 'IC': [0.009460425373336639,
        0.008745406877420814,
        0.015760138418877627,
        0.008647241309561056,
        0.016392490271658844,
        0.017164146008581356,
        0.009764402916850955,
        0.009864084638396725,
        0.00806611959668952],
 'ICIR': [0.06965137982819328,
          0.05342470255464294,
          0.11363008207509598,
          0.05326330213167523,
          0.1356954085685115,
          0.1261014926685193,
          0.07023699528403027,
          0.07520104909263912,
          0.04861903054757404],
 'Rank IC': [0.009648519317820762,
             0.02047129256618671,
             0.03334113414017674,
             0.020794906241499118,
             0.02183316905374321,
             0.03022300820925804,
             0.019933059214074286,
             0.017790109449458653,
             0.013584130111604257],
 'Rank ICIR': [0.07157037796176006,
               0.12302168329159428,
               0.2406959310867998,
               0.12470591190690966,
               0.17660391793369556,
               0.21548209310462074,
               0.14056676552068084,
               0.1311330888976296,
               0.08156208428994347],
 'mae': [0.8649170762273879,
         0.8647050803459836,
         0.86420207780724,
         0.8646977009841796,
         0.864640614854717,
         0.8642817708638176,
         0.8647837416384312,
         0.8647544713522343,
         0.8648852578201034],
 'mse': [0.9979492119324258,
         0.9973789235077785,
         0.9969335457109181,
         0.9978615205614849,
         0.9976719791223738,
         0.9972576945583526,
         0.9977125670458249,
         0.9972506214027482,
         0.9977803241052169]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3075328:MainThread](2024-04-25 05:07:50,708) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3075328:MainThread](2024-04-25 05:07:50,708) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3075328:MainThread](2024-04-25 05:07:50,710) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3075328:MainThread](2024-04-25 05:07:50,711) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
[3075328:MainThread](2024-04-25 05:07:53,602) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ALSTM_crowd_data_csi300_360_rankTrue_52.
[3075328:MainThread](2024-04-25 05:07:53,654) INFO - qlib.workflow - [exp.py:258] - Experiment 62 starts running ...
[3075328:MainThread](2024-04-25 05:07:53,670) INFO - qlib.workflow - [recorder.py:341] - Recorder 4cfbc84f7624457586d9b685ee916293 starts running under Experiment 62 ...
[3075328:MainThread](2024-04-25 05:07:58,902) INFO - qlib.ALSTM - [pytorch_alstm.py:266] - training...
[3075328:MainThread](2024-04-25 05:07:58,903) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch0:
[3075328:MainThread](2024-04-25 05:07:58,903) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:08:06,771) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:08:06,985) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -1.007474
[3075328:MainThread](2024-04-25 05:08:06,987) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch1:
[3075328:MainThread](2024-04-25 05:08:06,987) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:08:14,942) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:08:15,153) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998178
[3075328:MainThread](2024-04-25 05:08:15,155) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch2:
[3075328:MainThread](2024-04-25 05:08:15,155) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:08:23,555) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:08:23,775) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998222
[3075328:MainThread](2024-04-25 05:08:23,776) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch3:
[3075328:MainThread](2024-04-25 05:08:23,776) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:08:32,279) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:08:32,498) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999330
[3075328:MainThread](2024-04-25 05:08:32,498) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch4:
[3075328:MainThread](2024-04-25 05:08:32,499) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:08:41,341) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:08:41,562) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997574
[3075328:MainThread](2024-04-25 05:08:41,564) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch5:
[3075328:MainThread](2024-04-25 05:08:41,564) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:08:50,170) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:08:50,390) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997954
[3075328:MainThread](2024-04-25 05:08:50,391) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch6:
[3075328:MainThread](2024-04-25 05:08:50,391) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:08:58,608) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:08:58,822) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998124
[3075328:MainThread](2024-04-25 05:08:58,822) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch7:
[3075328:MainThread](2024-04-25 05:08:58,823) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:09:07,135) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:09:07,356) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.997713
[3075328:MainThread](2024-04-25 05:09:07,356) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch8:
[3075328:MainThread](2024-04-25 05:09:07,357) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:09:15,415) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:09:15,626) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999059
[3075328:MainThread](2024-04-25 05:09:15,627) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch9:
[3075328:MainThread](2024-04-25 05:09:15,627) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:09:23,610) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:09:23,821) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.998530
[3075328:MainThread](2024-04-25 05:09:23,822) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch10:
[3075328:MainThread](2024-04-25 05:09:23,822) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:09:32,472) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:09:32,692) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999731
[3075328:MainThread](2024-04-25 05:09:32,693) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch11:
[3075328:MainThread](2024-04-25 05:09:32,693) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:09:41,008) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:09:41,219) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999575
[3075328:MainThread](2024-04-25 05:09:41,220) INFO - qlib.ALSTM - [pytorch_alstm.py:270] - Epoch12:
[3075328:MainThread](2024-04-25 05:09:41,220) INFO - qlib.ALSTM - [pytorch_alstm.py:271] - training...
[3075328:MainThread](2024-04-25 05:09:49,118) INFO - qlib.ALSTM - [pytorch_alstm.py:273] - evaluating...
[3075328:MainThread](2024-04-25 05:09:49,329) INFO - qlib.ALSTM - [pytorch_alstm.py:276] - valid -0.999526
[3075328:MainThread](2024-04-25 05:09:49,329) INFO - qlib.ALSTM - [pytorch_alstm.py:288] - early stop
[3075328:MainThread](2024-04-25 05:09:49,329) INFO - qlib.ALSTM - [pytorch_alstm.py:291] - best score: -0.997574 @ 4
[3075328:MainThread](2024-04-25 05:09:49,353) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to ALSTM_crowd_data_csi300_360_rankTrue_52.
[3075328:MainThread](2024-04-25 05:09:49,630) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3075328:MainThread](2024-04-25 05:09:49,644) INFO - qlib.workflow - [recorder.py:341] - Recorder 550c47ca4eea4fb0a1deb0320efe5c38 starts running under Experiment 53 ...
{'IC': 0.012619195619603672,
 'ICIR': 0.0851645128779815,
 'Rank IC': 0.02315573198093821,
 'Rank ICIR': 0.15830892074531272}
[3075328:MainThread](2024-04-25 05:09:56,336) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3075328:MainThread](2024-04-25 05:10:33,330) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 05:10:33,333) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3075328:MainThread](2024-04-25 05:10:39,301) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8375a0d5b0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:32, 10.43it/s]backtest loop:   1%|          | 9/971 [00:00<00:35, 26.87it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:24, 39.32it/s]backtest loop:   2%|▏         | 22/971 [00:00<00:22, 42.91it/s]backtest loop:   3%|▎         | 29/971 [00:00<00:20, 46.26it/s]backtest loop:   4%|▎         | 36/971 [00:00<00:18, 51.23it/s]backtest loop:   4%|▍         | 43/971 [00:00<00:16, 54.83it/s]backtest loop:   5%|▌         | 49/971 [00:01<00:17, 53.25it/s]backtest loop:   6%|▌         | 56/971 [00:01<00:16, 56.11it/s]backtest loop:   6%|▋         | 62/971 [00:01<00:16, 54.09it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:15, 57.09it/s]backtest loop:   8%|▊         | 76/971 [00:01<00:15, 59.03it/s]backtest loop:   8%|▊         | 82/971 [00:01<00:15, 56.15it/s]backtest loop:   9%|▉         | 89/971 [00:01<00:15, 58.26it/s]backtest loop:  10%|▉         | 96/971 [00:01<00:14, 59.69it/s]backtest loop:  11%|█         | 103/971 [00:02<00:15, 57.28it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:14, 58.85it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:15, 56.84it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:14, 58.49it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:22, 36.87it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:20, 40.12it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:18, 45.42it/s]backtest loop:  15%|█▌        | 150/971 [00:03<00:16, 49.67it/s]backtest loop:  16%|█▌        | 156/971 [00:03<00:16, 49.74it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:15, 53.17it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:14, 55.79it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 53.90it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:13, 56.61it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:14, 55.32it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 57.32it/s]backtest loop:  21%|██        | 204/971 [00:03<00:13, 58.83it/s]backtest loop:  22%|██▏       | 210/971 [00:04<00:13, 56.67it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 55.44it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:12, 58.14it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 56.30it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 58.10it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 59.44it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 56.82it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:11, 59.72it/s]backtest loop:  27%|██▋       | 264/971 [00:05<00:12, 57.17it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:12, 55.47it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:12, 57.65it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:11, 59.07it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 56.17it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 58.02it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:11, 56.11it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 58.13it/s]backtest loop:  33%|███▎      | 319/971 [00:05<00:10, 59.42it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:11, 56.26it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:11, 58.07it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 59.46it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 56.45it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 58.35it/s]backtest loop:  37%|███▋      | 359/971 [00:06<00:10, 59.64it/s]backtest loop:  38%|███▊      | 365/971 [00:06<00:10, 56.30it/s]backtest loop:  38%|███▊      | 371/971 [00:06<00:10, 54.70it/s]backtest loop:  39%|███▉      | 378/971 [00:07<00:10, 53.97it/s]backtest loop:  40%|███▉      | 385/971 [00:07<00:10, 56.29it/s]backtest loop:  40%|████      | 392/971 [00:07<00:09, 58.13it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 55.55it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 58.27it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:09, 60.71it/s]backtest loop:  43%|████▎     | 419/971 [00:07<00:09, 58.15it/s]backtest loop:  44%|████▍     | 426/971 [00:07<00:09, 59.35it/s]backtest loop:  44%|████▍     | 432/971 [00:07<00:09, 56.43it/s]backtest loop:  45%|████▌     | 439/971 [00:08<00:09, 58.32it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:08, 60.32it/s]backtest loop:  47%|████▋     | 453/971 [00:08<00:09, 57.50it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:08, 57.75it/s]backtest loop:  48%|████▊     | 466/971 [00:08<00:08, 59.26it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:08, 56.22it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 58.08it/s]backtest loop:  50%|█████     | 486/971 [00:08<00:08, 59.41it/s]backtest loop:  51%|█████     | 492/971 [00:08<00:08, 56.35it/s]backtest loop:  51%|█████▏    | 499/971 [00:09<00:08, 58.18it/s]backtest loop:  52%|█████▏    | 505/971 [00:09<00:08, 56.14it/s]backtest loop:  53%|█████▎    | 512/971 [00:09<00:08, 54.79it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:07, 57.15it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:07, 55.67it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:07, 57.98it/s]backtest loop:  56%|█████▌    | 540/971 [00:09<00:07, 59.40it/s]backtest loop:  56%|█████▌    | 546/971 [00:09<00:07, 56.31it/s]backtest loop:  57%|█████▋    | 552/971 [00:10<00:07, 56.66it/s]backtest loop:  58%|█████▊    | 559/971 [00:10<00:07, 58.28it/s]backtest loop:  58%|█████▊    | 565/971 [00:10<00:06, 58.38it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 56.02it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:06, 58.77it/s]backtest loop:  60%|██████    | 585/971 [00:10<00:06, 60.38it/s]backtest loop:  61%|██████    | 592/971 [00:10<00:06, 57.56it/s]backtest loop:  62%|██████▏   | 599/971 [00:10<00:06, 58.93it/s]backtest loop:  62%|██████▏   | 605/971 [00:10<00:06, 55.99it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 57.76it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:05, 59.22it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 56.30it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 58.17it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 59.64it/s]backtest loop:  66%|██████▋   | 645/971 [00:11<00:05, 56.35it/s]backtest loop:  67%|██████▋   | 651/971 [00:11<00:05, 56.89it/s]backtest loop:  68%|██████▊   | 657/971 [00:11<00:05, 56.85it/s]backtest loop:  68%|██████▊   | 664/971 [00:11<00:05, 58.46it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 55.60it/s]backtest loop:  70%|██████▉   | 677/971 [00:12<00:05, 57.58it/s]backtest loop:  70%|███████   | 683/971 [00:12<00:04, 58.13it/s]backtest loop:  71%|███████   | 689/971 [00:12<00:05, 55.35it/s]backtest loop:  72%|███████▏  | 696/971 [00:12<00:04, 57.43it/s]backtest loop:  72%|███████▏  | 703/971 [00:12<00:04, 58.95it/s]backtest loop:  73%|███████▎  | 709/971 [00:12<00:04, 55.80it/s]backtest loop:  74%|███████▎  | 716/971 [00:12<00:04, 57.81it/s]backtest loop:  74%|███████▍  | 723/971 [00:12<00:04, 59.26it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 56.22it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 54.16it/s]backtest loop:  76%|███████▋  | 742/971 [00:13<00:04, 56.47it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 53.90it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 53.25it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 55.80it/s]backtest loop:  79%|███████▉  | 769/971 [00:13<00:03, 57.67it/s]backtest loop:  80%|███████▉  | 775/971 [00:13<00:03, 55.21it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 57.18it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 54.86it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.11it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 58.63it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 55.77it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 57.65it/s]backtest loop:  85%|████████▍ | 822/971 [00:14<00:02, 59.03it/s]backtest loop:  85%|████████▌ | 828/971 [00:14<00:02, 56.03it/s]backtest loop:  86%|████████▌ | 835/971 [00:14<00:02, 57.55it/s]backtest loop:  87%|████████▋ | 841/971 [00:15<00:02, 58.18it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 56.23it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:01, 58.03it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 56.07it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 57.83it/s]backtest loop:  90%|█████████ | 876/971 [00:15<00:01, 59.11it/s]backtest loop:  91%|█████████ | 882/971 [00:15<00:01, 56.18it/s]backtest loop:  92%|█████████▏| 889/971 [00:15<00:01, 57.92it/s]backtest loop:  92%|█████████▏| 896/971 [00:16<00:01, 59.19it/s]backtest loop:  93%|█████████▎| 902/971 [00:16<00:01, 56.14it/s]backtest loop:  94%|█████████▎| 909/971 [00:16<00:01, 57.91it/s]backtest loop:  94%|█████████▍| 916/971 [00:16<00:00, 56.06it/s]backtest loop:  95%|█████████▌| 923/971 [00:16<00:00, 57.82it/s]backtest loop:  96%|█████████▌| 929/971 [00:16<00:00, 58.35it/s]backtest loop:  96%|█████████▋| 936/971 [00:16<00:00, 56.24it/s]backtest loop:  97%|█████████▋| 943/971 [00:16<00:00, 57.95it/s]backtest loop:  98%|█████████▊| 950/971 [00:17<00:00, 56.10it/s]backtest loop:  99%|█████████▊| 957/971 [00:17<00:00, 57.87it/s]backtest loop:  99%|█████████▉| 964/971 [00:17<00:00, 59.18it/s]backtest loop: 100%|█████████▉| 970/971 [00:17<00:00, 55.92it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.92it/s]
[3075328:MainThread](2024-04-25 05:10:56,721) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000429
std                0.004486
annualized_return  0.102178
information_ratio  1.476572
max_drawdown      -0.110809
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000231
std                0.004487
annualized_return  0.054883
information_ratio  0.792921
max_drawdown      -0.134462
[3075328:MainThread](2024-04-25 05:10:56,733) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `ALSTM_crowd_data_csi300_360_rankTrue`.
[3075328:MainThread](2024-04-25 05:11:03,506) INFO - qlib.timer - [log.py:127] - Time cost: 0.007s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.017308512649334296,
                                                    0.025226956174298033,
                                                    0.055416874840888225,
                                                    0.011783526040045877,
                                                    0.01400035120779,
                                                    0.09438899367942376,
                                                    0.041607827881493614,
                                                    0.022907194712505994,
                                                    -0.03403551724848347,
                                                    0.05488268013195226],
 '1day.excess_return_with_cost.information_ratio': [0.18010918865041212,
                                                    0.2934252565629728,
                                                    0.6581594906091128,
                                                    0.11569611052484179,
                                                    0.17551813038162198,
                                                    1.170922812371982,
                                                    0.4667094254577868,
                                                    0.2803908828040007,
                                                    -0.38113340755017144,
                                                    0.7929207745339305],
 '1day.excess_return_with_cost.max_drawdown': [-0.20064185075338067,
                                               -0.14870747098105508,
                                               -0.12217177617500374,
                                               -0.21105626405968622,
                                               -0.1580217854884085,
                                               -0.09807365571942406,
                                               -0.14600701746379632,
                                               -0.15988541296670056,
                                               -0.39457224349011644,
                                               -0.13446156791710911],
 'IC': [0.009460425373336639,
        0.008745406877420814,
        0.015760138418877627,
        0.008647241309561056,
        0.016392490271658844,
        0.017164146008581356,
        0.009764402916850955,
        0.009864084638396725,
        0.00806611959668952,
        0.012619195619603672],
 'ICIR': [0.06965137982819328,
          0.05342470255464294,
          0.11363008207509598,
          0.05326330213167523,
          0.1356954085685115,
          0.1261014926685193,
          0.07023699528403027,
          0.07520104909263912,
          0.04861903054757404,
          0.0851645128779815],
 'Rank IC': [0.009648519317820762,
             0.02047129256618671,
             0.03334113414017674,
             0.020794906241499118,
             0.02183316905374321,
             0.03022300820925804,
             0.019933059214074286,
             0.017790109449458653,
             0.013584130111604257,
             0.02315573198093821],
 'Rank ICIR': [0.07157037796176006,
               0.12302168329159428,
               0.2406959310867998,
               0.12470591190690966,
               0.17660391793369556,
               0.21548209310462074,
               0.14056676552068084,
               0.1311330888976296,
               0.08156208428994347,
               0.15830892074531272],
 'mae': [0.8649170762273879,
         0.8647050803459836,
         0.86420207780724,
         0.8646977009841796,
         0.864640614854717,
         0.8642817708638176,
         0.8647837416384312,
         0.8647544713522343,
         0.8648852578201034,
         0.8647198123212421],
 'mse': [0.9979492119324258,
         0.9973789235077785,
         0.9969335457109181,
         0.9978615205614849,
         0.9976719791223738,
         0.9972576945583526,
         0.9977125670458249,
         0.9972506214027482,
         0.9977803241052169,
         0.9976548500845382]}
[3075328:MainThread](2024-04-25 05:11:03,783) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name final_crowd_data_csi300_360_1_ALSTM.
[3075328:MainThread](2024-04-25 05:11:03,836) INFO - qlib.workflow - [exp.py:258] - Experiment 63 starts running ...
[3075328:MainThread](2024-04-25 05:11:03,850) INFO - qlib.workflow - [recorder.py:341] - Recorder 6a3f7d3802e14edaba9c5dba62344d77 starts running under Experiment 63 ...
Time cost: 276.0706298351288
{'1day.excess_return_with_cost.annualized_return': [0.030348740006924856,
                                                    0.03235301085856839],
 '1day.excess_return_with_cost.information_ratio': [0.375271866434649,
                                                    0.40362074765256284],
 '1day.excess_return_with_cost.max_drawdown': [-0.17735990450146807,
                                               0.07906597630275945],
 'IC': [0.011648365103097722, 0.003355088645829481],
 'ICIR': [0.08309879556288632, 0.02986680139797173],
 'Rank IC': [0.021077506028476, 0.006620146118947119],
 'Rank ICIR': [0.14636507747389466, 0.05079946560810967],
 'mae': [0.8646587604215336, 0.00022387667356026317],
 'mse': [0.9975451238031662, 0.0003075516559938882]}
[3075328:MainThread](2024-04-25 05:11:04,376) INFO - qlib.timer - [log.py:127] - Time cost: 0.029s | waiting `async_log` Done

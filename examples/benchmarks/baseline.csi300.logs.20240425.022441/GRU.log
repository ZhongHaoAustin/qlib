[3046892:MainThread](2024-04-25 03:11:22,306) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[3046892:MainThread](2024-04-25 03:11:22,308) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[3046892:MainThread](2024-04-25 03:11:22,309) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/crowd_data')}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
[3046892:MainThread](2024-04-25 03:17:58,286) INFO - qlib.timer - [log.py:127] - Time cost: 395.919s | Loading data Done
[3046892:MainThread](2024-04-25 03:20:41,251) INFO - qlib.timer - [log.py:127] - Time cost: 160.728s | RobustZScoreNorm Done
[3046892:MainThread](2024-04-25 03:20:44,198) INFO - qlib.timer - [log.py:127] - Time cost: 2.945s | Fillna Done
[3046892:MainThread](2024-04-25 03:20:45,844) INFO - qlib.timer - [log.py:127] - Time cost: 0.890s | DropnaLabel Done
/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/data/dataset/processor.py:370: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[cols] = t
[3046892:MainThread](2024-04-25 03:20:46,956) INFO - qlib.timer - [log.py:127] - Time cost: 1.111s | CSRankNorm Done
[3046892:MainThread](2024-04-25 03:20:46,960) INFO - qlib.timer - [log.py:127] - Time cost: 168.673s | fit & process data Done
[3046892:MainThread](2024-04-25 03:20:46,960) INFO - qlib.timer - [log.py:127] - Time cost: 564.593s | Init data Done
Save handler file to /home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3046892:MainThread](2024-04-25 03:20:56,729) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3046892:MainThread](2024-04-25 03:20:56,799) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3046892:MainThread](2024-04-25 03:20:56,802) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3046892:MainThread](2024-04-25 03:20:56,803) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3046892:MainThread](2024-04-25 03:21:14,353) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name GRU_crowd_data_csi300_360_rankTrue_43.
[3046892:MainThread](2024-04-25 03:21:14,371) INFO - qlib.workflow - [exp.py:258] - Experiment 28 starts running ...
[3046892:MainThread](2024-04-25 03:21:15,964) INFO - qlib.workflow - [recorder.py:341] - Recorder e8c43dff1fe94643bd44604dcf2ca5f0 starts running under Experiment 28 ...
[3046892:MainThread](2024-04-25 03:21:25,425) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3046892:MainThread](2024-04-25 03:21:25,425) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3046892:MainThread](2024-04-25 03:21:25,426) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:21:34,461) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:21:34,666) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997764
[3046892:MainThread](2024-04-25 03:21:34,667) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3046892:MainThread](2024-04-25 03:21:34,668) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:21:42,339) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:21:42,543) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.003391
[3046892:MainThread](2024-04-25 03:21:42,543) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3046892:MainThread](2024-04-25 03:21:42,544) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:21:50,237) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:21:50,444) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998302
[3046892:MainThread](2024-04-25 03:21:50,444) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3046892:MainThread](2024-04-25 03:21:50,445) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:21:58,101) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:21:58,305) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.004505
[3046892:MainThread](2024-04-25 03:21:58,305) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3046892:MainThread](2024-04-25 03:21:58,306) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:22:05,954) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:22:06,158) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997874
[3046892:MainThread](2024-04-25 03:22:06,159) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3046892:MainThread](2024-04-25 03:22:06,159) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:22:13,909) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:22:14,115) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999204
[3046892:MainThread](2024-04-25 03:22:14,116) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3046892:MainThread](2024-04-25 03:22:14,116) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:22:20,818) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:22:21,021) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999228
[3046892:MainThread](2024-04-25 03:22:21,022) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3046892:MainThread](2024-04-25 03:22:21,022) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:22:27,535) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:22:27,709) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.005295
[3046892:MainThread](2024-04-25 03:22:27,710) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3046892:MainThread](2024-04-25 03:22:27,710) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:22:34,137) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:22:34,311) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997815
[3046892:MainThread](2024-04-25 03:22:34,311) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3046892:MainThread](2024-04-25 03:22:34,312) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.997764 @ 0
[3046892:MainThread](2024-04-25 03:22:34,337) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to GRU_crowd_data_csi300_360_rankTrue_43.
[3046892:MainThread](2024-04-25 03:22:34,607) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name GRU_crowd_data_csi300_360_rankTrue.
[3046892:MainThread](2024-04-25 03:22:34,626) INFO - qlib.workflow - [exp.py:258] - Experiment 29 starts running ...
[3046892:MainThread](2024-04-25 03:22:34,637) INFO - qlib.workflow - [recorder.py:341] - Recorder dce64ab8179a40a6b7aa15291c9e29f3 starts running under Experiment 29 ...
{'IC': 0.00363443899505527,
 'ICIR': 0.021413940843084633,
 'Rank IC': 0.015102010164117578,
 'Rank ICIR': 0.09774431979917947}
[3046892:MainThread](2024-04-25 03:22:41,396) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3046892:MainThread](2024-04-25 03:23:16,095) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:23:16,098) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:23:22,452) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f7e120c7370>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 6/971 [00:00<00:16, 58.52it/s]backtest loop:   1%|          | 12/971 [00:00<00:18, 52.81it/s]backtest loop:   2%|▏         | 19/971 [00:00<00:16, 57.31it/s]backtest loop:   3%|▎         | 25/971 [00:00<00:17, 54.20it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:16, 55.67it/s]backtest loop:   4%|▍         | 37/971 [00:00<00:16, 56.25it/s]backtest loop:   4%|▍         | 43/971 [00:00<00:16, 56.56it/s]backtest loop:   5%|▌         | 49/971 [00:00<00:17, 54.02it/s]backtest loop:   6%|▌         | 56/971 [00:01<00:16, 56.75it/s]backtest loop:   6%|▋         | 62/971 [00:01<00:16, 54.62it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:15, 57.48it/s]backtest loop:   8%|▊         | 76/971 [00:01<00:15, 59.23it/s]backtest loop:   8%|▊         | 82/971 [00:01<00:15, 56.24it/s]backtest loop:   9%|▉         | 89/971 [00:01<00:15, 58.14it/s]backtest loop:  10%|▉         | 96/971 [00:01<00:14, 59.52it/s]backtest loop:  11%|█         | 102/971 [00:01<00:15, 56.47it/s]backtest loop:  11%|█         | 109/971 [00:01<00:14, 58.33it/s]backtest loop:  12%|█▏        | 116/971 [00:02<00:14, 59.60it/s]backtest loop:  13%|█▎        | 122/971 [00:02<00:15, 56.54it/s]backtest loop:  13%|█▎        | 128/971 [00:02<00:15, 54.04it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:14, 56.74it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 54.49it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 56.92it/s]backtest loop:  16%|█▌        | 155/971 [00:02<00:13, 58.67it/s]backtest loop:  17%|█▋        | 161/971 [00:02<00:14, 55.86it/s]backtest loop:  17%|█▋        | 168/971 [00:02<00:13, 57.98it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:13, 59.30it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:14, 56.36it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 58.25it/s]backtest loop:  20%|██        | 195/971 [00:03<00:13, 56.31it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 58.10it/s]backtest loop:  22%|██▏       | 209/971 [00:03<00:12, 59.69it/s]backtest loop:  22%|██▏       | 216/971 [00:03<00:13, 54.81it/s]backtest loop:  23%|██▎       | 223/971 [00:03<00:13, 56.93it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 55.46it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 57.37it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 58.89it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 56.09it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 58.19it/s]backtest loop:  27%|██▋       | 263/971 [00:04<00:12, 58.48it/s]backtest loop:  28%|██▊       | 269/971 [00:04<00:12, 55.85it/s]backtest loop:  28%|██▊       | 276/971 [00:04<00:12, 54.59it/s]backtest loop:  29%|██▉       | 283/971 [00:04<00:12, 56.88it/s]backtest loop:  30%|██▉       | 290/971 [00:05<00:11, 58.61it/s]backtest loop:  30%|███       | 296/971 [00:05<00:12, 55.89it/s]backtest loop:  31%|███       | 303/971 [00:05<00:11, 57.84it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:11, 56.00it/s]backtest loop:  33%|███▎      | 317/971 [00:05<00:11, 57.89it/s]backtest loop:  33%|███▎      | 324/971 [00:05<00:10, 59.43it/s]backtest loop:  34%|███▍      | 330/971 [00:05<00:11, 56.58it/s]backtest loop:  35%|███▍      | 337/971 [00:05<00:10, 58.55it/s]backtest loop:  35%|███▌      | 344/971 [00:06<00:10, 59.72it/s]backtest loop:  36%|███▌      | 350/971 [00:06<00:10, 57.07it/s]backtest loop:  37%|███▋      | 357/971 [00:06<00:10, 58.71it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:10, 56.37it/s]backtest loop:  38%|███▊      | 369/971 [00:06<00:11, 53.84it/s]backtest loop:  39%|███▊      | 376/971 [00:06<00:10, 56.37it/s]backtest loop:  39%|███▉      | 383/971 [00:06<00:10, 55.16it/s]backtest loop:  40%|████      | 389/971 [00:06<00:10, 56.04it/s]backtest loop:  41%|████      | 396/971 [00:06<00:09, 57.95it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 55.92it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:09, 57.87it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 59.41it/s]backtest loop:  44%|████▎     | 423/971 [00:07<00:09, 56.47it/s]backtest loop:  44%|████▍     | 430/971 [00:07<00:09, 58.31it/s]backtest loop:  45%|████▌     | 437/971 [00:07<00:09, 56.31it/s]backtest loop:  46%|████▌     | 444/971 [00:07<00:09, 58.20it/s]backtest loop:  46%|████▋     | 450/971 [00:07<00:08, 58.57it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:09, 56.46it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:08, 58.44it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:08, 59.71it/s]backtest loop:  49%|████▉     | 478/971 [00:08<00:08, 57.35it/s]backtest loop:  50%|████▉     | 485/971 [00:08<00:08, 58.85it/s]backtest loop:  51%|█████     | 491/971 [00:08<00:08, 55.93it/s]backtest loop:  51%|█████▏    | 498/971 [00:08<00:08, 57.72it/s]backtest loop:  52%|█████▏    | 505/971 [00:08<00:08, 56.19it/s]backtest loop:  53%|█████▎    | 512/971 [00:08<00:08, 55.05it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:07, 57.37it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:07, 55.84it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:07, 57.81it/s]backtest loop:  56%|█████▌    | 539/971 [00:09<00:07, 58.33it/s]backtest loop:  56%|█████▌    | 546/971 [00:09<00:07, 56.51it/s]backtest loop:  57%|█████▋    | 553/971 [00:09<00:07, 58.28it/s]backtest loop:  58%|█████▊    | 560/971 [00:09<00:06, 59.55it/s]backtest loop:  58%|█████▊    | 566/971 [00:09<00:07, 56.41it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:06, 58.16it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 59.47it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:06, 56.46it/s]backtest loop:  61%|██████    | 593/971 [00:10<00:06, 58.26it/s]backtest loop:  62%|██████▏   | 600/971 [00:10<00:06, 56.42it/s]backtest loop:  63%|██████▎   | 607/971 [00:10<00:06, 58.18it/s]backtest loop:  63%|██████▎   | 614/971 [00:10<00:06, 59.48it/s]backtest loop:  64%|██████▍   | 620/971 [00:10<00:06, 56.13it/s]backtest loop:  65%|██████▍   | 627/971 [00:10<00:05, 58.00it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:05, 59.33it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:05, 56.73it/s]backtest loop:  67%|██████▋   | 647/971 [00:11<00:05, 58.46it/s]backtest loop:  67%|██████▋   | 654/971 [00:11<00:05, 59.89it/s]backtest loop:  68%|██████▊   | 661/971 [00:11<00:05, 57.49it/s]backtest loop:  69%|██████▉   | 668/971 [00:11<00:05, 58.93it/s]backtest loop:  69%|██████▉   | 674/971 [00:11<00:05, 56.05it/s]backtest loop:  70%|███████   | 681/971 [00:11<00:05, 57.92it/s]backtest loop:  71%|███████   | 687/971 [00:11<00:04, 58.42it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:04, 56.33it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 58.17it/s]backtest loop:  73%|███████▎  | 707/971 [00:12<00:04, 58.11it/s]backtest loop:  74%|███████▎  | 714/971 [00:12<00:04, 56.19it/s]backtest loop:  74%|███████▍  | 721/971 [00:12<00:04, 58.01it/s]backtest loop:  75%|███████▍  | 728/971 [00:12<00:04, 59.34it/s]backtest loop:  76%|███████▌  | 734/971 [00:12<00:04, 53.52it/s]backtest loop:  76%|███████▋  | 741/971 [00:12<00:04, 56.07it/s]backtest loop:  77%|███████▋  | 747/971 [00:13<00:03, 56.81it/s]backtest loop:  78%|███████▊  | 753/971 [00:13<00:04, 53.36it/s]backtest loop:  78%|███████▊  | 759/971 [00:13<00:03, 55.04it/s]backtest loop:  79%|███████▉  | 765/971 [00:13<00:03, 53.35it/s]backtest loop:  80%|███████▉  | 772/971 [00:13<00:03, 55.96it/s]backtest loop:  80%|████████  | 779/971 [00:13<00:03, 57.95it/s]backtest loop:  81%|████████  | 785/971 [00:13<00:03, 55.34it/s]backtest loop:  81%|████████▏ | 791/971 [00:13<00:03, 54.06it/s]backtest loop:  82%|████████▏ | 797/971 [00:13<00:03, 54.06it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:03, 51.11it/s]backtest loop:  83%|████████▎ | 809/971 [00:14<00:03, 52.19it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 52.93it/s]backtest loop:  85%|████████▍ | 821/971 [00:14<00:02, 53.37it/s]backtest loop:  85%|████████▌ | 827/971 [00:14<00:02, 53.48it/s]backtest loop:  86%|████████▌ | 833/971 [00:14<00:02, 50.68it/s]backtest loop:  86%|████████▋ | 839/971 [00:14<00:02, 51.94it/s]backtest loop:  87%|████████▋ | 845/971 [00:14<00:02, 52.74it/s]backtest loop:  88%|████████▊ | 851/971 [00:15<00:02, 53.35it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 50.21it/s]backtest loop:  89%|████████▉ | 863/971 [00:15<00:02, 51.49it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 52.57it/s]backtest loop:  90%|█████████ | 875/971 [00:15<00:01, 53.22it/s]backtest loop:  91%|█████████ | 881/971 [00:15<00:01, 53.87it/s]backtest loop:  91%|█████████▏| 887/971 [00:15<00:01, 50.52it/s]backtest loop:  92%|█████████▏| 893/971 [00:15<00:01, 51.72it/s]backtest loop:  93%|█████████▎| 899/971 [00:15<00:01, 52.69it/s]backtest loop:  93%|█████████▎| 905/971 [00:16<00:01, 53.33it/s]backtest loop:  94%|█████████▍| 911/971 [00:16<00:01, 53.94it/s]backtest loop:  94%|█████████▍| 917/971 [00:16<00:01, 50.72it/s]backtest loop:  95%|█████████▌| 923/971 [00:16<00:00, 51.85it/s]backtest loop:  96%|█████████▌| 929/971 [00:16<00:00, 52.72it/s]backtest loop:  96%|█████████▋| 935/971 [00:16<00:00, 53.60it/s]backtest loop:  97%|█████████▋| 941/971 [00:16<00:00, 50.67it/s]backtest loop:  98%|█████████▊| 947/971 [00:16<00:00, 51.55it/s]backtest loop:  98%|█████████▊| 953/971 [00:16<00:00, 52.35it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 53.14it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 50.57it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 51.80it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 56.05it/s]
[3046892:MainThread](2024-04-25 03:23:39,859) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000002
std                0.006505
annualized_return  0.000458
information_ratio  0.004560
max_drawdown      -0.254581
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean              -0.000200
std                0.006506
annualized_return -0.047527
information_ratio -0.473559
max_drawdown      -0.337675
[3046892:MainThread](2024-04-25 03:23:39,877) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `GRU_crowd_data_csi300_360_rankTrue`.
[3046892:MainThread](2024-04-25 03:23:48,881) INFO - qlib.timer - [log.py:127] - Time cost: 0.006s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.04752747527500248],
 '1day.excess_return_with_cost.information_ratio': [-0.47355908603877145],
 '1day.excess_return_with_cost.max_drawdown': [-0.3376746326901112],
 'IC': [0.00363443899505527],
 'ICIR': [0.021413940843084633],
 'Rank IC': [0.015102010164117578],
 'Rank ICIR': [0.09774431979917947],
 'mae': [0.8650185462473066],
 'mse': [0.9983762431278207]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3046892:MainThread](2024-04-25 03:23:51,893) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3046892:MainThread](2024-04-25 03:23:51,894) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3046892:MainThread](2024-04-25 03:23:51,895) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3046892:MainThread](2024-04-25 03:23:51,896) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3046892:MainThread](2024-04-25 03:23:54,676) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name GRU_crowd_data_csi300_360_rankTrue_44.
[3046892:MainThread](2024-04-25 03:23:54,696) INFO - qlib.workflow - [exp.py:258] - Experiment 30 starts running ...
[3046892:MainThread](2024-04-25 03:23:54,706) INFO - qlib.workflow - [recorder.py:341] - Recorder 69b62e5ad83f49b299334e7eb2403c24 starts running under Experiment 30 ...
[3046892:MainThread](2024-04-25 03:24:02,355) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3046892:MainThread](2024-04-25 03:24:02,356) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3046892:MainThread](2024-04-25 03:24:02,356) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:24:10,437) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:24:10,642) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000943
[3046892:MainThread](2024-04-25 03:24:10,643) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3046892:MainThread](2024-04-25 03:24:10,644) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:24:17,717) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:24:17,922) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997543
[3046892:MainThread](2024-04-25 03:24:17,924) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3046892:MainThread](2024-04-25 03:24:17,924) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:24:24,473) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:24:24,648) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998403
[3046892:MainThread](2024-04-25 03:24:24,649) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3046892:MainThread](2024-04-25 03:24:24,649) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:24:31,352) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:24:31,530) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999858
[3046892:MainThread](2024-04-25 03:24:31,530) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3046892:MainThread](2024-04-25 03:24:31,531) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:24:37,803) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:24:37,977) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997749
[3046892:MainThread](2024-04-25 03:24:37,978) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3046892:MainThread](2024-04-25 03:24:37,978) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:24:44,066) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:24:44,240) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998715
[3046892:MainThread](2024-04-25 03:24:44,241) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3046892:MainThread](2024-04-25 03:24:44,241) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:24:50,491) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:24:50,667) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998621
[3046892:MainThread](2024-04-25 03:24:50,667) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3046892:MainThread](2024-04-25 03:24:50,667) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:24:57,170) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:24:57,344) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999930
[3046892:MainThread](2024-04-25 03:24:57,344) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3046892:MainThread](2024-04-25 03:24:57,345) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:25:04,128) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:25:04,302) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998551
[3046892:MainThread](2024-04-25 03:25:04,302) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3046892:MainThread](2024-04-25 03:25:04,302) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:25:10,814) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:25:10,987) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997178
[3046892:MainThread](2024-04-25 03:25:10,988) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3046892:MainThread](2024-04-25 03:25:10,989) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:25:17,686) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:25:17,862) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997709
[3046892:MainThread](2024-04-25 03:25:17,863) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3046892:MainThread](2024-04-25 03:25:17,863) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:25:24,711) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:25:24,887) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997575
[3046892:MainThread](2024-04-25 03:25:24,887) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3046892:MainThread](2024-04-25 03:25:24,888) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:25:31,569) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:25:31,746) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996128
[3046892:MainThread](2024-04-25 03:25:31,747) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3046892:MainThread](2024-04-25 03:25:31,748) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:25:38,299) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:25:38,474) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998099
[3046892:MainThread](2024-04-25 03:25:38,475) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3046892:MainThread](2024-04-25 03:25:38,475) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:25:45,029) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:25:45,206) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996612
[3046892:MainThread](2024-04-25 03:25:45,207) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3046892:MainThread](2024-04-25 03:25:45,207) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:25:51,739) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:25:51,913) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998737
[3046892:MainThread](2024-04-25 03:25:51,914) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3046892:MainThread](2024-04-25 03:25:51,914) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:25:58,418) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:25:58,591) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998054
[3046892:MainThread](2024-04-25 03:25:58,592) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3046892:MainThread](2024-04-25 03:25:58,592) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:26:05,089) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:26:05,263) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997745
[3046892:MainThread](2024-04-25 03:26:05,264) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3046892:MainThread](2024-04-25 03:26:05,264) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:26:11,972) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:26:12,151) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.001521
[3046892:MainThread](2024-04-25 03:26:12,151) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3046892:MainThread](2024-04-25 03:26:12,151) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:26:18,915) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:26:19,091) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999004
[3046892:MainThread](2024-04-25 03:26:19,091) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3046892:MainThread](2024-04-25 03:26:19,092) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:26:25,802) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:26:25,978) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997560
[3046892:MainThread](2024-04-25 03:26:25,979) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3046892:MainThread](2024-04-25 03:26:25,979) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.996128 @ 12
[3046892:MainThread](2024-04-25 03:26:26,005) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to GRU_crowd_data_csi300_360_rankTrue_44.
[3046892:MainThread](2024-04-25 03:26:26,213) INFO - qlib.workflow - [exp.py:258] - Experiment 29 starts running ...
[3046892:MainThread](2024-04-25 03:26:26,226) INFO - qlib.workflow - [recorder.py:341] - Recorder 7a4eaeb65e4e4bd59d4db94e0269c101 starts running under Experiment 29 ...
{'IC': 0.02489675590560467,
 'ICIR': 0.19480099902991765,
 'Rank IC': 0.037783709736229354,
 'Rank ICIR': 0.3096498421629207}
[3046892:MainThread](2024-04-25 03:26:34,541) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3046892:MainThread](2024-04-25 03:27:11,253) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:27:11,256) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:27:17,171) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f7d21fdc130>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:41,  9.52it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 25.25it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 37.66it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.35it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.98it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 48.31it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.68it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.97it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:16, 54.06it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 56.74it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.71it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 57.49it/s]backtest loop:   8%|▊         | 80/971 [00:01<00:15, 58.03it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 56.43it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 58.35it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 59.69it/s]backtest loop:  11%|█         | 108/971 [00:02<00:15, 57.26it/s]backtest loop:  12%|█▏        | 115/971 [00:02<00:14, 58.86it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.11it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:15, 52.94it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:14, 56.23it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 55.25it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 57.46it/s]backtest loop:  16%|█▌        | 155/971 [00:02<00:13, 58.99it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 56.25it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:13, 58.27it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:13, 60.40it/s]backtest loop:  19%|█▊        | 182/971 [00:03<00:13, 57.96it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:13, 59.62it/s]backtest loop:  20%|██        | 196/971 [00:03<00:13, 57.48it/s]backtest loop:  21%|██        | 203/971 [00:03<00:12, 59.14it/s]backtest loop:  22%|██▏       | 210/971 [00:03<00:13, 57.80it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 56.22it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:12, 58.60it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 56.55it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 58.44it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 59.76it/s]backtest loop:  26%|██▌       | 251/971 [00:04<00:12, 56.83it/s]backtest loop:  27%|██▋       | 258/971 [00:04<00:12, 58.59it/s]backtest loop:  27%|██▋       | 264/971 [00:04<00:12, 56.05it/s]backtest loop:  28%|██▊       | 271/971 [00:04<00:12, 55.05it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:12, 57.20it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:11, 58.83it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 56.09it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 58.06it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:11, 56.11it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 57.99it/s]backtest loop:  33%|███▎      | 319/971 [00:05<00:10, 59.32it/s]backtest loop:  33%|███▎      | 325/971 [00:05<00:11, 56.29it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:10, 58.19it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 59.78it/s]backtest loop:  36%|███▌      | 346/971 [00:06<00:10, 57.36it/s]backtest loop:  36%|███▋      | 353/971 [00:06<00:10, 58.93it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 57.13it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.89it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 54.13it/s]backtest loop:  39%|███▉      | 380/971 [00:06<00:10, 56.44it/s]backtest loop:  40%|███▉      | 387/971 [00:06<00:10, 58.21it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 55.91it/s]backtest loop:  41%|████      | 400/971 [00:07<00:09, 58.02it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 60.19it/s]backtest loop:  43%|████▎     | 414/971 [00:07<00:09, 57.66it/s]backtest loop:  43%|████▎     | 421/971 [00:07<00:09, 58.98it/s]backtest loop:  44%|████▍     | 428/971 [00:07<00:09, 56.79it/s]backtest loop:  45%|████▍     | 435/971 [00:07<00:09, 58.45it/s]backtest loop:  46%|████▌     | 442/971 [00:07<00:09, 56.44it/s]backtest loop:  46%|████▌     | 449/971 [00:08<00:08, 58.14it/s]backtest loop:  47%|████▋     | 455/971 [00:08<00:12, 39.86it/s]backtest loop:  48%|████▊     | 462/971 [00:08<00:11, 43.05it/s]backtest loop:  48%|████▊     | 468/971 [00:08<00:10, 46.59it/s]backtest loop:  49%|████▉     | 475/971 [00:08<00:09, 50.63it/s]backtest loop:  50%|████▉     | 481/971 [00:08<00:09, 52.77it/s]backtest loop:  50%|█████     | 487/971 [00:08<00:09, 51.76it/s]backtest loop:  51%|█████     | 493/971 [00:09<00:08, 53.74it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 53.30it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 53.20it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 56.04it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 57.94it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:08, 55.40it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:07, 57.55it/s]backtest loop:  56%|█████▌    | 541/971 [00:09<00:07, 56.08it/s]backtest loop:  56%|█████▋    | 548/971 [00:09<00:07, 58.01it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 59.34it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 56.47it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:06, 58.26it/s]backtest loop:  59%|█████▉    | 575/971 [00:10<00:06, 59.53it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:06, 56.34it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:06, 58.08it/s]backtest loop:  61%|██████▏   | 595/971 [00:10<00:06, 59.43it/s]backtest loop:  62%|██████▏   | 601/971 [00:10<00:06, 56.48it/s]backtest loop:  63%|██████▎   | 608/971 [00:11<00:06, 58.37it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:06, 56.49it/s]backtest loop:  64%|██████▍   | 622/971 [00:11<00:05, 58.29it/s]backtest loop:  65%|██████▍   | 629/971 [00:11<00:05, 59.98it/s]backtest loop:  65%|██████▌   | 636/971 [00:11<00:05, 57.79it/s]backtest loop:  66%|██████▌   | 643/971 [00:11<00:05, 59.33it/s]backtest loop:  67%|██████▋   | 650/971 [00:11<00:05, 56.99it/s]backtest loop:  68%|██████▊   | 657/971 [00:11<00:05, 58.70it/s]backtest loop:  68%|██████▊   | 664/971 [00:11<00:05, 59.85it/s]backtest loop:  69%|██████▉   | 671/971 [00:12<00:05, 57.41it/s]backtest loop:  70%|██████▉   | 678/971 [00:12<00:04, 59.14it/s]backtest loop:  70%|███████   | 684/971 [00:12<00:05, 56.15it/s]backtest loop:  71%|███████   | 691/971 [00:12<00:04, 58.03it/s]backtest loop:  72%|███████▏  | 697/971 [00:12<00:04, 58.47it/s]backtest loop:  73%|███████▎  | 704/971 [00:12<00:04, 56.49it/s]backtest loop:  73%|███████▎  | 711/971 [00:12<00:04, 58.20it/s]backtest loop:  74%|███████▍  | 718/971 [00:12<00:04, 59.56it/s]backtest loop:  75%|███████▍  | 724/971 [00:13<00:04, 56.54it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 55.29it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 54.45it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:03, 56.77it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 54.11it/s]backtest loop:  78%|███████▊  | 758/971 [00:13<00:03, 56.52it/s]backtest loop:  79%|███████▉  | 765/971 [00:13<00:03, 55.29it/s]backtest loop:  80%|███████▉  | 772/971 [00:13<00:03, 57.33it/s]backtest loop:  80%|████████  | 779/971 [00:13<00:03, 58.87it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 56.09it/s]backtest loop:  82%|████████▏ | 792/971 [00:14<00:03, 58.03it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 55.47it/s]backtest loop:  83%|████████▎ | 804/971 [00:14<00:02, 56.61it/s]backtest loop:  84%|████████▎ | 811/971 [00:14<00:02, 58.47it/s]backtest loop:  84%|████████▍ | 818/971 [00:14<00:02, 56.46it/s]backtest loop:  85%|████████▍ | 824/971 [00:14<00:02, 57.26it/s]backtest loop:  85%|████████▌ | 830/971 [00:14<00:02, 57.64it/s]backtest loop:  86%|████████▌ | 836/971 [00:14<00:02, 58.12it/s]backtest loop:  87%|████████▋ | 843/971 [00:15<00:02, 56.02it/s]backtest loop:  88%|████████▊ | 850/971 [00:15<00:02, 57.92it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 56.19it/s]backtest loop:  89%|████████▉ | 864/971 [00:15<00:01, 58.03it/s]backtest loop:  90%|████████▉ | 871/971 [00:15<00:01, 59.36it/s]backtest loop:  90%|█████████ | 877/971 [00:15<00:01, 56.41it/s]backtest loop:  91%|█████████ | 884/971 [00:15<00:01, 58.28it/s]backtest loop:  92%|█████████▏| 891/971 [00:15<00:01, 59.61it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 56.60it/s]backtest loop:  93%|█████████▎| 904/971 [00:16<00:01, 58.33it/s]backtest loop:  94%|█████████▍| 911/971 [00:16<00:01, 59.61it/s]backtest loop:  94%|█████████▍| 917/971 [00:16<00:00, 56.41it/s]backtest loop:  95%|█████████▌| 924/971 [00:16<00:00, 58.21it/s]backtest loop:  96%|█████████▌| 931/971 [00:16<00:00, 56.25it/s]backtest loop:  97%|█████████▋| 938/971 [00:16<00:00, 58.08it/s]backtest loop:  97%|█████████▋| 945/971 [00:16<00:00, 56.30it/s]backtest loop:  98%|█████████▊| 952/971 [00:16<00:00, 58.10it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 59.39it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 56.42it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 56.04it/s]
[3046892:MainThread](2024-04-25 03:27:34,555) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000481
std                0.004655
annualized_return  0.114418
information_ratio  1.593127
max_drawdown      -0.074379
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000284
std                0.004657
annualized_return  0.067535
information_ratio  0.940096
max_drawdown      -0.081732
[3046892:MainThread](2024-04-25 03:27:34,567) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `GRU_crowd_data_csi300_360_rankTrue`.
[3046892:MainThread](2024-04-25 03:27:41,276) INFO - qlib.timer - [log.py:127] - Time cost: 0.006s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.04752747527500248,
                                                    0.06753497732457434],
 '1day.excess_return_with_cost.information_ratio': [-0.47355908603877145,
                                                    0.940095684943139],
 '1day.excess_return_with_cost.max_drawdown': [-0.3376746326901112,
                                               -0.08173152645982251],
 'IC': [0.00363443899505527, 0.02489675590560467],
 'ICIR': [0.021413940843084633, 0.19480099902991765],
 'Rank IC': [0.015102010164117578, 0.037783709736229354],
 'Rank ICIR': [0.09774431979917947, 0.3096498421629207],
 'mae': [0.8650185462473066, 0.8638857495457903],
 'mse': [0.9983762431278207, 0.99706359774119]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3046892:MainThread](2024-04-25 03:27:44,549) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3046892:MainThread](2024-04-25 03:27:44,549) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3046892:MainThread](2024-04-25 03:27:44,551) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3046892:MainThread](2024-04-25 03:27:44,551) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3046892:MainThread](2024-04-25 03:27:47,587) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name GRU_crowd_data_csi300_360_rankTrue_45.
[3046892:MainThread](2024-04-25 03:27:47,608) INFO - qlib.workflow - [exp.py:258] - Experiment 31 starts running ...
[3046892:MainThread](2024-04-25 03:27:47,618) INFO - qlib.workflow - [recorder.py:341] - Recorder c891444b45064668a4f0c9451e4ddc27 starts running under Experiment 31 ...
[3046892:MainThread](2024-04-25 03:27:52,562) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3046892:MainThread](2024-04-25 03:27:52,562) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3046892:MainThread](2024-04-25 03:27:52,563) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:27:59,135) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:27:59,309) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.006553
[3046892:MainThread](2024-04-25 03:27:59,310) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3046892:MainThread](2024-04-25 03:27:59,311) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:28:05,775) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:28:05,951) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000986
[3046892:MainThread](2024-04-25 03:28:05,952) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3046892:MainThread](2024-04-25 03:28:05,952) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:28:12,391) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:28:12,563) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.007301
[3046892:MainThread](2024-04-25 03:28:12,564) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3046892:MainThread](2024-04-25 03:28:12,564) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:28:19,027) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:28:19,199) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997532
[3046892:MainThread](2024-04-25 03:28:19,200) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3046892:MainThread](2024-04-25 03:28:19,201) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:28:25,548) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:28:25,722) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998526
[3046892:MainThread](2024-04-25 03:28:25,723) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3046892:MainThread](2024-04-25 03:28:25,723) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:28:32,031) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:28:32,203) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.002729
[3046892:MainThread](2024-04-25 03:28:32,204) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3046892:MainThread](2024-04-25 03:28:32,204) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:28:38,493) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:28:38,665) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999575
[3046892:MainThread](2024-04-25 03:28:38,666) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3046892:MainThread](2024-04-25 03:28:38,666) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:28:45,354) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:28:45,527) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998687
[3046892:MainThread](2024-04-25 03:28:45,527) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3046892:MainThread](2024-04-25 03:28:45,528) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:28:52,002) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:28:52,176) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998510
[3046892:MainThread](2024-04-25 03:28:52,177) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3046892:MainThread](2024-04-25 03:28:52,177) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:28:58,651) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:28:58,825) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.002577
[3046892:MainThread](2024-04-25 03:28:58,825) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3046892:MainThread](2024-04-25 03:28:58,826) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:29:05,314) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:29:05,488) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998596
[3046892:MainThread](2024-04-25 03:29:05,488) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3046892:MainThread](2024-04-25 03:29:05,488) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:29:11,971) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:29:12,146) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998525
[3046892:MainThread](2024-04-25 03:29:12,147) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3046892:MainThread](2024-04-25 03:29:12,147) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.997532 @ 3
[3046892:MainThread](2024-04-25 03:29:12,168) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to GRU_crowd_data_csi300_360_rankTrue_45.
[3046892:MainThread](2024-04-25 03:29:12,375) INFO - qlib.workflow - [exp.py:258] - Experiment 29 starts running ...
[3046892:MainThread](2024-04-25 03:29:12,387) INFO - qlib.workflow - [recorder.py:341] - Recorder b11614a238cc4aa5a3212a89ab619289 starts running under Experiment 29 ...
{'IC': 0.018902094432700335,
 'ICIR': 0.13069641324061324,
 'Rank IC': 0.029404122617660105,
 'Rank ICIR': 0.2002519378681989}
[3046892:MainThread](2024-04-25 03:29:19,345) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3046892:MainThread](2024-04-25 03:29:55,790) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:29:55,794) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:30:01,788) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f7dfb5cbb80>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:36,  9.99it/s]backtest loop:   1%|          | 9/971 [00:00<00:36, 26.12it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:24, 38.62it/s]backtest loop:   2%|▏         | 22/971 [00:00<00:22, 42.42it/s]backtest loop:   3%|▎         | 29/971 [00:00<00:20, 45.95it/s]backtest loop:   4%|▎         | 35/971 [00:00<00:18, 49.62it/s]backtest loop:   4%|▍         | 42/971 [00:00<00:17, 53.56it/s]backtest loop:   5%|▌         | 49/971 [00:01<00:17, 53.21it/s]backtest loop:   6%|▌         | 56/971 [00:01<00:16, 55.97it/s]backtest loop:   6%|▋         | 62/971 [00:01<00:16, 53.91it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:15, 57.04it/s]backtest loop:   8%|▊         | 76/971 [00:01<00:15, 58.88it/s]backtest loop:   8%|▊         | 82/971 [00:01<00:15, 55.58it/s]backtest loop:   9%|▉         | 89/971 [00:01<00:15, 57.73it/s]backtest loop:  10%|▉         | 96/971 [00:01<00:14, 59.26it/s]backtest loop:  11%|█         | 102/971 [00:02<00:15, 56.25it/s]backtest loop:  11%|█         | 109/971 [00:02<00:14, 58.28it/s]backtest loop:  12%|█▏        | 116/971 [00:02<00:14, 59.53it/s]backtest loop:  13%|█▎        | 122/971 [00:02<00:15, 56.59it/s]backtest loop:  13%|█▎        | 128/971 [00:02<00:15, 54.32it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:15, 55.47it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 53.22it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 56.02it/s]backtest loop:  16%|█▌        | 155/971 [00:02<00:14, 57.77it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 55.37it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:13, 57.64it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:13, 59.59it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:14, 56.15it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 57.96it/s]backtest loop:  20%|██        | 195/971 [00:03<00:13, 56.08it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 57.97it/s]backtest loop:  21%|██▏       | 208/971 [00:03<00:13, 58.31it/s]backtest loop:  22%|██▏       | 214/971 [00:04<00:13, 56.00it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 54.00it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:13, 56.36it/s]backtest loop:  24%|██▍       | 234/971 [00:04<00:12, 58.24it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:13, 55.32it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:12, 57.23it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:12, 56.23it/s]backtest loop:  27%|██▋       | 261/971 [00:04<00:12, 58.29it/s]backtest loop:  27%|██▋       | 267/971 [00:04<00:12, 56.01it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 56.69it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:12, 57.58it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 55.77it/s]backtest loop:  30%|███       | 293/971 [00:05<00:11, 57.75it/s]backtest loop:  31%|███       | 300/971 [00:05<00:11, 55.93it/s]backtest loop:  32%|███▏      | 306/971 [00:05<00:11, 56.87it/s]backtest loop:  32%|███▏      | 313/971 [00:05<00:11, 58.45it/s]backtest loop:  33%|███▎      | 319/971 [00:05<00:11, 58.10it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:18, 34.26it/s]backtest loop:  34%|███▍      | 331/971 [00:06<00:16, 39.07it/s]backtest loop:  35%|███▍      | 338/971 [00:06<00:14, 44.49it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:13, 46.75it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:12, 50.72it/s]backtest loop:  37%|███▋      | 359/971 [00:06<00:11, 53.92it/s]backtest loop:  38%|███▊      | 365/971 [00:06<00:11, 52.49it/s]backtest loop:  38%|███▊      | 371/971 [00:07<00:11, 51.47it/s]backtest loop:  39%|███▉      | 378/971 [00:07<00:11, 51.85it/s]backtest loop:  40%|███▉      | 385/971 [00:07<00:10, 54.93it/s]backtest loop:  40%|████      | 392/971 [00:07<00:10, 57.13it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 54.52it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 56.81it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:09, 58.86it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:09, 55.94it/s]backtest loop:  44%|████▍     | 425/971 [00:07<00:09, 57.73it/s]backtest loop:  44%|████▍     | 431/971 [00:08<00:09, 58.19it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:09, 55.31it/s]backtest loop:  46%|████▌     | 443/971 [00:08<00:09, 55.83it/s]backtest loop:  46%|████▌     | 449/971 [00:08<00:09, 56.81it/s]backtest loop:  47%|████▋     | 456/971 [00:08<00:08, 58.48it/s]backtest loop:  48%|████▊     | 462/971 [00:08<00:09, 55.17it/s]backtest loop:  48%|████▊     | 469/971 [00:08<00:08, 57.27it/s]backtest loop:  49%|████▉     | 476/971 [00:08<00:08, 58.82it/s]backtest loop:  50%|████▉     | 482/971 [00:08<00:08, 55.75it/s]backtest loop:  50%|█████     | 488/971 [00:09<00:08, 56.37it/s]backtest loop:  51%|█████     | 494/971 [00:09<00:08, 57.10it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 54.48it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 53.65it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 56.16it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 58.20it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:08, 55.45it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:07, 57.64it/s]backtest loop:  56%|█████▌    | 540/971 [00:09<00:07, 58.27it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 55.40it/s]backtest loop:  57%|█████▋    | 552/971 [00:10<00:07, 56.55it/s]backtest loop:  58%|█████▊    | 559/971 [00:10<00:07, 58.25it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 56.05it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:06, 57.77it/s]backtest loop:  60%|█████▉    | 579/971 [00:10<00:06, 58.30it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:06, 56.50it/s]backtest loop:  61%|██████    | 593/971 [00:10<00:06, 58.08it/s]backtest loop:  62%|██████▏   | 600/971 [00:11<00:06, 56.13it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 57.90it/s]backtest loop:  63%|██████▎   | 614/971 [00:11<00:06, 59.23it/s]backtest loop:  64%|██████▍   | 620/971 [00:11<00:06, 56.13it/s]backtest loop:  65%|██████▍   | 627/971 [00:11<00:05, 58.04it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:05, 59.27it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:05, 56.20it/s]backtest loop:  67%|██████▋   | 646/971 [00:11<00:05, 56.96it/s]backtest loop:  67%|██████▋   | 653/971 [00:11<00:05, 58.71it/s]backtest loop:  68%|██████▊   | 659/971 [00:12<00:05, 59.05it/s]backtest loop:  68%|██████▊   | 665/971 [00:12<00:05, 55.56it/s]backtest loop:  69%|██████▉   | 671/971 [00:12<00:05, 56.56it/s]backtest loop:  70%|██████▉   | 678/971 [00:12<00:05, 58.44it/s]backtest loop:  70%|███████   | 684/971 [00:12<00:05, 55.37it/s]backtest loop:  71%|███████   | 690/971 [00:12<00:04, 56.64it/s]backtest loop:  72%|███████▏  | 697/971 [00:12<00:04, 58.38it/s]backtest loop:  73%|███████▎  | 704/971 [00:12<00:04, 56.28it/s]backtest loop:  73%|███████▎  | 711/971 [00:12<00:04, 57.98it/s]backtest loop:  74%|███████▍  | 718/971 [00:13<00:04, 59.33it/s]backtest loop:  75%|███████▍  | 724/971 [00:13<00:04, 56.21it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 54.89it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 54.01it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:04, 56.41it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 54.31it/s]backtest loop:  78%|███████▊  | 758/971 [00:13<00:03, 56.61it/s]backtest loop:  79%|███████▉  | 765/971 [00:13<00:03, 55.29it/s]backtest loop:  79%|███████▉  | 771/971 [00:14<00:03, 56.49it/s]backtest loop:  80%|████████  | 778/971 [00:14<00:03, 58.33it/s]backtest loop:  81%|████████  | 784/971 [00:14<00:03, 55.73it/s]backtest loop:  81%|████████▏ | 791/971 [00:14<00:03, 57.76it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 55.88it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:02, 57.67it/s]backtest loop:  84%|████████▎ | 812/971 [00:14<00:02, 58.94it/s]backtest loop:  84%|████████▍ | 818/971 [00:14<00:02, 56.09it/s]backtest loop:  85%|████████▍ | 825/971 [00:14<00:02, 57.89it/s]backtest loop:  86%|████████▌ | 832/971 [00:15<00:02, 59.16it/s]backtest loop:  86%|████████▋ | 838/971 [00:15<00:02, 56.03it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 57.87it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 55.99it/s]backtest loop:  88%|████████▊ | 859/971 [00:15<00:01, 57.89it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 59.20it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 56.17it/s]backtest loop:  91%|█████████ | 879/971 [00:15<00:01, 58.17it/s]backtest loop:  91%|█████████ | 886/971 [00:16<00:01, 59.52it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 56.37it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 58.09it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 59.33it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 56.29it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 58.08it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 56.25it/s]backtest loop:  96%|█████████▌| 933/971 [00:16<00:00, 58.07it/s]backtest loop:  97%|█████████▋| 939/971 [00:16<00:00, 58.56it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 55.67it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 57.73it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 59.10it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 56.08it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 57.13it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.43it/s]
[3046892:MainThread](2024-04-25 03:30:19,366) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000385
std                0.005392
annualized_return  0.091728
information_ratio  1.102744
max_drawdown      -0.143616
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000184
std                0.005392
annualized_return  0.043897
information_ratio  0.527685
max_drawdown      -0.172763
[3046892:MainThread](2024-04-25 03:30:19,379) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `GRU_crowd_data_csi300_360_rankTrue`.
[3046892:MainThread](2024-04-25 03:30:26,124) INFO - qlib.timer - [log.py:127] - Time cost: 0.006s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.04752747527500248,
                                                    0.06753497732457434,
                                                    0.04389698519088239],
 '1day.excess_return_with_cost.information_ratio': [-0.47355908603877145,
                                                    0.940095684943139,
                                                    0.527684838645942],
 '1day.excess_return_with_cost.max_drawdown': [-0.3376746326901112,
                                               -0.08173152645982251,
                                               -0.17276302603976773],
 'IC': [0.00363443899505527, 0.02489675590560467, 0.018902094432700335],
 'ICIR': [0.021413940843084633, 0.19480099902991765, 0.13069641324061324],
 'Rank IC': [0.015102010164117578, 0.037783709736229354, 0.029404122617660105],
 'Rank ICIR': [0.09774431979917947, 0.3096498421629207, 0.2002519378681989],
 'mae': [0.8650185462473066, 0.8638857495457903, 0.8643701461289718],
 'mse': [0.9983762431278207, 0.99706359774119, 0.997759548555407]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3046892:MainThread](2024-04-25 03:30:29,367) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3046892:MainThread](2024-04-25 03:30:29,367) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3046892:MainThread](2024-04-25 03:30:29,369) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3046892:MainThread](2024-04-25 03:30:29,369) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3046892:MainThread](2024-04-25 03:30:32,395) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name GRU_crowd_data_csi300_360_rankTrue_46.
[3046892:MainThread](2024-04-25 03:30:32,416) INFO - qlib.workflow - [exp.py:258] - Experiment 32 starts running ...
[3046892:MainThread](2024-04-25 03:30:32,428) INFO - qlib.workflow - [recorder.py:341] - Recorder 96f006a80fd04754911ce8c918adaa09 starts running under Experiment 32 ...
[3046892:MainThread](2024-04-25 03:30:37,474) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3046892:MainThread](2024-04-25 03:30:37,474) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3046892:MainThread](2024-04-25 03:30:37,475) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:30:44,035) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:30:44,211) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.008808
[3046892:MainThread](2024-04-25 03:30:44,212) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3046892:MainThread](2024-04-25 03:30:44,212) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:30:50,470) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:30:50,647) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.001719
[3046892:MainThread](2024-04-25 03:30:50,648) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3046892:MainThread](2024-04-25 03:30:50,649) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:30:57,198) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:30:57,375) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.014539
[3046892:MainThread](2024-04-25 03:30:57,375) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3046892:MainThread](2024-04-25 03:30:57,375) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:31:03,881) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:31:04,058) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.007200
[3046892:MainThread](2024-04-25 03:31:04,059) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3046892:MainThread](2024-04-25 03:31:04,059) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:31:10,842) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:31:11,017) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.002438
[3046892:MainThread](2024-04-25 03:31:11,018) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3046892:MainThread](2024-04-25 03:31:11,018) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:31:17,506) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:31:17,681) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.004350
[3046892:MainThread](2024-04-25 03:31:17,682) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3046892:MainThread](2024-04-25 03:31:17,682) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:31:24,200) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:31:24,375) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999443
[3046892:MainThread](2024-04-25 03:31:24,376) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3046892:MainThread](2024-04-25 03:31:24,377) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:31:31,051) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:31:31,227) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996015
[3046892:MainThread](2024-04-25 03:31:31,229) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3046892:MainThread](2024-04-25 03:31:31,229) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:31:38,047) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:31:38,223) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999359
[3046892:MainThread](2024-04-25 03:31:38,223) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3046892:MainThread](2024-04-25 03:31:38,224) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:31:45,000) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:31:45,178) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998799
[3046892:MainThread](2024-04-25 03:31:45,178) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3046892:MainThread](2024-04-25 03:31:45,178) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:31:51,768) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:31:51,942) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000810
[3046892:MainThread](2024-04-25 03:31:51,943) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3046892:MainThread](2024-04-25 03:31:51,943) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:31:58,492) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:31:58,667) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998066
[3046892:MainThread](2024-04-25 03:31:58,667) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3046892:MainThread](2024-04-25 03:31:58,668) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:32:05,262) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:32:05,436) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.001867
[3046892:MainThread](2024-04-25 03:32:05,436) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3046892:MainThread](2024-04-25 03:32:05,436) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:32:11,955) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:32:12,130) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998726
[3046892:MainThread](2024-04-25 03:32:12,131) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3046892:MainThread](2024-04-25 03:32:12,131) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:32:18,789) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:32:18,963) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999779
[3046892:MainThread](2024-04-25 03:32:18,964) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3046892:MainThread](2024-04-25 03:32:18,964) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:32:25,490) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:32:25,666) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998445
[3046892:MainThread](2024-04-25 03:32:25,666) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3046892:MainThread](2024-04-25 03:32:25,666) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.996015 @ 7
[3046892:MainThread](2024-04-25 03:32:25,687) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to GRU_crowd_data_csi300_360_rankTrue_46.
[3046892:MainThread](2024-04-25 03:32:25,895) INFO - qlib.workflow - [exp.py:258] - Experiment 29 starts running ...
[3046892:MainThread](2024-04-25 03:32:25,907) INFO - qlib.workflow - [recorder.py:341] - Recorder 19acbd7c425d47898d5bdd3eea4d60d4 starts running under Experiment 29 ...
{'IC': 0.020888639826414604,
 'ICIR': 0.15884409057214505,
 'Rank IC': 0.026423821148463412,
 'Rank ICIR': 0.20040688139219454}
[3046892:MainThread](2024-04-25 03:32:32,493) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3046892:MainThread](2024-04-25 03:33:09,025) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:33:09,028) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:33:14,982) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f7d22d23a00>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:38,  9.78it/s]backtest loop:   1%|          | 9/971 [00:00<00:37, 25.73it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:24, 38.26it/s]backtest loop:   2%|▏         | 22/971 [00:00<00:22, 42.14it/s]backtest loop:   3%|▎         | 29/971 [00:00<00:20, 45.80it/s]backtest loop:   4%|▎         | 36/971 [00:00<00:18, 50.92it/s]backtest loop:   4%|▍         | 43/971 [00:00<00:16, 54.63it/s]backtest loop:   5%|▌         | 49/971 [00:01<00:17, 53.07it/s]backtest loop:   6%|▌         | 56/971 [00:01<00:16, 55.89it/s]backtest loop:   6%|▋         | 62/971 [00:01<00:16, 54.18it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:15, 57.09it/s]backtest loop:   8%|▊         | 76/971 [00:01<00:15, 59.22it/s]backtest loop:   9%|▊         | 83/971 [00:01<00:15, 57.07it/s]backtest loop:   9%|▉         | 90/971 [00:01<00:14, 58.84it/s]backtest loop:  10%|▉         | 97/971 [00:01<00:15, 56.82it/s]backtest loop:  11%|█         | 104/971 [00:02<00:14, 58.62it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:14, 59.92it/s]backtest loop:  12%|█▏        | 118/971 [00:02<00:14, 57.59it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 55.94it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 54.16it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:14, 56.57it/s]backtest loop:  15%|█▍        | 145/971 [00:02<00:14, 58.58it/s]backtest loop:  16%|█▌        | 151/971 [00:02<00:14, 55.84it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:14, 57.74it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:13, 59.29it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:13, 57.30it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:13, 59.28it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:13, 56.98it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:13, 59.01it/s]backtest loop:  20%|██        | 199/971 [00:03<00:12, 60.24it/s]backtest loop:  21%|██        | 206/971 [00:03<00:13, 57.75it/s]backtest loop:  22%|██▏       | 213/971 [00:03<00:13, 56.22it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 55.29it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:12, 57.34it/s]backtest loop:  24%|██▍       | 234/971 [00:04<00:12, 58.87it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:13, 56.08it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:12, 58.01it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:12, 57.22it/s]backtest loop:  27%|██▋       | 261/971 [00:04<00:11, 59.40it/s]backtest loop:  27%|██▋       | 267/971 [00:04<00:12, 56.55it/s]backtest loop:  28%|██▊       | 274/971 [00:05<00:11, 58.33it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:12, 56.31it/s]backtest loop:  30%|██▉       | 288/971 [00:05<00:11, 57.96it/s]backtest loop:  30%|███       | 295/971 [00:05<00:12, 56.17it/s]backtest loop:  31%|███       | 301/971 [00:05<00:11, 56.97it/s]backtest loop:  32%|███▏      | 307/971 [00:05<00:11, 57.64it/s]backtest loop:  32%|███▏      | 313/971 [00:05<00:11, 58.10it/s]backtest loop:  33%|███▎      | 320/971 [00:05<00:11, 56.28it/s]backtest loop:  34%|███▎      | 326/971 [00:06<00:17, 37.78it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:14, 43.37it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:13, 46.03it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:12, 50.17it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:11, 53.78it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:11, 52.66it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:11, 52.60it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 51.70it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:10, 54.68it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 56.90it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 54.64it/s]backtest loop:  41%|████      | 400/971 [00:07<00:10, 56.89it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 58.54it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:09, 56.13it/s]backtest loop:  43%|████▎     | 420/971 [00:07<00:09, 57.98it/s]backtest loop:  44%|████▍     | 427/971 [00:07<00:09, 59.33it/s]backtest loop:  45%|████▍     | 433/971 [00:07<00:09, 56.23it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:09, 58.05it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 56.07it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:08, 58.03it/s]backtest loop:  47%|████▋     | 461/971 [00:08<00:08, 59.21it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:08, 56.20it/s]backtest loop:  49%|████▉     | 474/971 [00:08<00:08, 58.01it/s]backtest loop:  50%|████▉     | 481/971 [00:08<00:08, 59.33it/s]backtest loop:  50%|█████     | 487/971 [00:08<00:08, 56.29it/s]backtest loop:  51%|█████     | 494/971 [00:09<00:08, 58.14it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 55.42it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 54.33it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 56.54it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 58.28it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:08, 55.16it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:07, 57.31it/s]backtest loop:  56%|█████▌    | 541/971 [00:09<00:07, 55.63it/s]backtest loop:  56%|█████▋    | 548/971 [00:09<00:07, 57.60it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 59.29it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 56.28it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:06, 58.05it/s]backtest loop:  59%|█████▉    | 575/971 [00:10<00:06, 59.53it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:06, 56.32it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:06, 58.12it/s]backtest loop:  61%|██████▏   | 595/971 [00:10<00:06, 59.42it/s]backtest loop:  62%|██████▏   | 601/971 [00:10<00:06, 56.34it/s]backtest loop:  63%|██████▎   | 608/971 [00:11<00:06, 58.02it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:06, 56.08it/s]backtest loop:  64%|██████▍   | 622/971 [00:11<00:06, 57.89it/s]backtest loop:  65%|██████▍   | 629/971 [00:11<00:05, 59.34it/s]backtest loop:  65%|██████▌   | 635/971 [00:11<00:05, 56.45it/s]backtest loop:  66%|██████▌   | 642/971 [00:11<00:05, 58.12it/s]backtest loop:  67%|██████▋   | 648/971 [00:11<00:05, 58.42it/s]backtest loop:  67%|██████▋   | 654/971 [00:11<00:05, 58.68it/s]backtest loop:  68%|██████▊   | 660/971 [00:11<00:05, 55.29it/s]backtest loop:  69%|██████▊   | 666/971 [00:12<00:05, 56.36it/s]backtest loop:  69%|██████▉   | 673/971 [00:12<00:05, 58.22it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 55.42it/s]backtest loop:  71%|███████   | 686/971 [00:12<00:04, 57.53it/s]backtest loop:  71%|███████▏  | 692/971 [00:12<00:04, 58.03it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 56.09it/s]backtest loop:  73%|███████▎  | 706/971 [00:12<00:04, 57.85it/s]backtest loop:  73%|███████▎  | 713/971 [00:12<00:04, 59.23it/s]backtest loop:  74%|███████▍  | 719/971 [00:12<00:04, 56.27it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 58.35it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 55.72it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 53.78it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:04, 56.29it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 54.18it/s]backtest loop:  78%|███████▊  | 758/971 [00:13<00:03, 56.58it/s]backtest loop:  79%|███████▉  | 765/971 [00:13<00:03, 55.19it/s]backtest loop:  79%|███████▉  | 771/971 [00:13<00:03, 55.95it/s]backtest loop:  80%|████████  | 778/971 [00:14<00:03, 58.03it/s]backtest loop:  81%|████████  | 784/971 [00:14<00:03, 55.38it/s]backtest loop:  81%|████████▏ | 791/971 [00:14<00:03, 57.44it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 55.77it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:02, 57.64it/s]backtest loop:  84%|████████▎ | 812/971 [00:14<00:02, 59.04it/s]backtest loop:  84%|████████▍ | 818/971 [00:14<00:02, 56.20it/s]backtest loop:  85%|████████▍ | 825/971 [00:14<00:02, 58.01it/s]backtest loop:  86%|████████▌ | 832/971 [00:14<00:02, 59.35it/s]backtest loop:  86%|████████▋ | 838/971 [00:15<00:02, 56.21it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 58.04it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 55.81it/s]backtest loop:  88%|████████▊ | 858/971 [00:15<00:01, 56.89it/s]backtest loop:  89%|████████▉ | 865/971 [00:15<00:01, 58.52it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 56.41it/s]backtest loop:  91%|█████████ | 879/971 [00:15<00:01, 58.14it/s]backtest loop:  91%|█████████ | 886/971 [00:15<00:01, 59.48it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 56.34it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 58.08it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 59.38it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 56.38it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 58.15it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 56.22it/s]backtest loop:  96%|█████████▌| 932/971 [00:16<00:00, 57.13it/s]backtest loop:  97%|█████████▋| 939/971 [00:16<00:00, 58.63it/s]backtest loop:  97%|█████████▋| 945/971 [00:16<00:00, 55.78it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 57.69it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 59.11it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 56.11it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.86it/s]
[3046892:MainThread](2024-04-25 03:33:32,424) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000558
std                0.005308
annualized_return  0.132881
information_ratio  1.622808
max_drawdown      -0.079830
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000361
std                0.005309
annualized_return  0.085802
information_ratio  1.047561
max_drawdown      -0.097566
[3046892:MainThread](2024-04-25 03:33:32,437) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `GRU_crowd_data_csi300_360_rankTrue`.
[3046892:MainThread](2024-04-25 03:33:39,236) INFO - qlib.timer - [log.py:127] - Time cost: 0.003s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.04752747527500248,
                                                    0.06753497732457434,
                                                    0.04389698519088239,
                                                    0.08580218014262934],
 '1day.excess_return_with_cost.information_ratio': [-0.47355908603877145,
                                                    0.940095684943139,
                                                    0.527684838645942,
                                                    1.0475605812703772],
 '1day.excess_return_with_cost.max_drawdown': [-0.3376746326901112,
                                               -0.08173152645982251,
                                               -0.17276302603976773,
                                               -0.09756583800230148],
 'IC': [0.00363443899505527,
        0.02489675590560467,
        0.018902094432700335,
        0.020888639826414604],
 'ICIR': [0.021413940843084633,
          0.19480099902991765,
          0.13069641324061324,
          0.15884409057214505],
 'Rank IC': [0.015102010164117578,
             0.037783709736229354,
             0.029404122617660105,
             0.026423821148463412],
 'Rank ICIR': [0.09774431979917947,
               0.3096498421629207,
               0.2002519378681989,
               0.20040688139219454],
 'mae': [0.8650185462473066,
         0.8638857495457903,
         0.8643701461289718,
         0.8645102856924792],
 'mse': [0.9983762431278207,
         0.99706359774119,
         0.997759548555407,
         0.9974266902873177]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3046892:MainThread](2024-04-25 03:33:42,503) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3046892:MainThread](2024-04-25 03:33:42,504) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3046892:MainThread](2024-04-25 03:33:42,505) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3046892:MainThread](2024-04-25 03:33:42,506) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3046892:MainThread](2024-04-25 03:33:45,560) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name GRU_crowd_data_csi300_360_rankTrue_47.
[3046892:MainThread](2024-04-25 03:33:45,582) INFO - qlib.workflow - [exp.py:258] - Experiment 33 starts running ...
[3046892:MainThread](2024-04-25 03:33:45,595) INFO - qlib.workflow - [recorder.py:341] - Recorder 4674ca3e844349cab108ec5d749f8632 starts running under Experiment 33 ...
[3046892:MainThread](2024-04-25 03:33:50,593) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3046892:MainThread](2024-04-25 03:33:50,594) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3046892:MainThread](2024-04-25 03:33:50,594) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:33:57,102) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:33:57,278) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000739
[3046892:MainThread](2024-04-25 03:33:57,279) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3046892:MainThread](2024-04-25 03:33:57,279) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:34:03,773) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:34:03,947) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998687
[3046892:MainThread](2024-04-25 03:34:03,948) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3046892:MainThread](2024-04-25 03:34:03,949) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:34:10,463) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:34:10,639) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996835
[3046892:MainThread](2024-04-25 03:34:10,640) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3046892:MainThread](2024-04-25 03:34:10,641) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:34:17,156) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:34:17,330) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.002356
[3046892:MainThread](2024-04-25 03:34:17,331) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3046892:MainThread](2024-04-25 03:34:17,331) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:34:23,774) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:34:23,949) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999695
[3046892:MainThread](2024-04-25 03:34:23,949) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3046892:MainThread](2024-04-25 03:34:23,949) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:34:30,416) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:34:30,592) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998762
[3046892:MainThread](2024-04-25 03:34:30,592) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3046892:MainThread](2024-04-25 03:34:30,592) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:34:37,153) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:34:37,327) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997894
[3046892:MainThread](2024-04-25 03:34:37,327) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3046892:MainThread](2024-04-25 03:34:37,327) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:34:44,086) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:34:44,262) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999456
[3046892:MainThread](2024-04-25 03:34:44,262) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3046892:MainThread](2024-04-25 03:34:44,262) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:34:50,823) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:34:50,997) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997565
[3046892:MainThread](2024-04-25 03:34:50,997) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3046892:MainThread](2024-04-25 03:34:50,997) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:34:57,516) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:34:57,693) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998644
[3046892:MainThread](2024-04-25 03:34:57,693) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3046892:MainThread](2024-04-25 03:34:57,694) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:35:04,290) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:35:04,464) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999709
[3046892:MainThread](2024-04-25 03:35:04,465) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3046892:MainThread](2024-04-25 03:35:04,465) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.996835 @ 2
[3046892:MainThread](2024-04-25 03:35:04,491) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to GRU_crowd_data_csi300_360_rankTrue_47.
[3046892:MainThread](2024-04-25 03:35:04,701) INFO - qlib.workflow - [exp.py:258] - Experiment 29 starts running ...
[3046892:MainThread](2024-04-25 03:35:04,713) INFO - qlib.workflow - [recorder.py:341] - Recorder 14e49bc2661949ff88303713ae39c954 starts running under Experiment 29 ...
{'IC': 0.024184579544304124,
 'ICIR': 0.191989366852175,
 'Rank IC': 0.03324991193140413,
 'Rank ICIR': 0.26980638508856297}
[3046892:MainThread](2024-04-25 03:35:11,147) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3046892:MainThread](2024-04-25 03:35:48,106) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:35:48,109) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:35:54,134) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f7e07c4f880>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:39,  9.74it/s]backtest loop:   1%|          | 10/971 [00:00<00:34, 27.72it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:25, 36.78it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:22, 42.14it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:19, 48.12it/s]backtest loop:   4%|▍         | 38/971 [00:00<00:17, 52.42it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:18, 51.47it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:16, 54.73it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 53.39it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:16, 56.29it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:15, 58.34it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:16, 55.62it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 57.93it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 59.31it/s]backtest loop:  10%|▉         | 97/971 [00:01<00:15, 56.15it/s]backtest loop:  11%|█         | 104/971 [00:02<00:14, 58.07it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:14, 58.29it/s]backtest loop:  12%|█▏        | 116/971 [00:02<00:14, 57.91it/s]backtest loop:  13%|█▎        | 122/971 [00:02<00:15, 55.22it/s]backtest loop:  13%|█▎        | 128/971 [00:02<00:15, 53.41it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:14, 56.85it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 54.08it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 56.66it/s]backtest loop:  16%|█▌        | 155/971 [00:02<00:13, 58.30it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 55.62it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:13, 58.15it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:13, 60.13it/s]backtest loop:  19%|█▊        | 182/971 [00:03<00:13, 57.73it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:13, 59.51it/s]backtest loop:  20%|██        | 195/971 [00:03<00:13, 56.21it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 58.04it/s]backtest loop:  22%|██▏       | 209/971 [00:03<00:12, 59.87it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 55.03it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:13, 57.30it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 55.64it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 57.16it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 58.76it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 55.92it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:12, 56.98it/s]backtest loop:  27%|██▋       | 263/971 [00:04<00:12, 58.81it/s]backtest loop:  28%|██▊       | 269/971 [00:04<00:12, 55.93it/s]backtest loop:  28%|██▊       | 275/971 [00:05<00:12, 57.02it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:12, 54.73it/s]backtest loop:  30%|██▉       | 287/971 [00:05<00:12, 56.16it/s]backtest loop:  30%|███       | 294/971 [00:05<00:11, 58.07it/s]backtest loop:  31%|███       | 300/971 [00:05<00:12, 55.33it/s]backtest loop:  32%|███▏      | 307/971 [00:05<00:11, 57.33it/s]backtest loop:  32%|███▏      | 314/971 [00:05<00:11, 58.79it/s]backtest loop:  33%|███▎      | 320/971 [00:05<00:11, 55.82it/s]backtest loop:  34%|███▎      | 326/971 [00:05<00:11, 56.92it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:11, 57.67it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 59.33it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 56.13it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 58.31it/s]backtest loop:  37%|███▋      | 359/971 [00:06<00:10, 59.54it/s]backtest loop:  38%|███▊      | 365/971 [00:06<00:10, 56.62it/s]backtest loop:  38%|███▊      | 371/971 [00:06<00:11, 54.46it/s]backtest loop:  39%|███▉      | 377/971 [00:06<00:10, 55.83it/s]backtest loop:  39%|███▉      | 383/971 [00:06<00:10, 53.84it/s]backtest loop:  40%|████      | 390/971 [00:07<00:10, 56.40it/s]backtest loop:  41%|████      | 397/971 [00:07<00:09, 58.36it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 55.82it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:09, 58.20it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 59.81it/s]backtest loop:  44%|████▎     | 424/971 [00:07<00:09, 56.91it/s]backtest loop:  44%|████▍     | 431/971 [00:07<00:09, 58.43it/s]backtest loop:  45%|████▌     | 437/971 [00:07<00:09, 55.64it/s]backtest loop:  46%|████▌     | 444/971 [00:08<00:09, 57.56it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:08, 59.02it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:14, 34.46it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:12, 40.08it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:11, 45.04it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:10, 46.20it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:09, 50.41it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:09, 50.12it/s]backtest loop:  51%|█████     | 497/971 [00:09<00:08, 53.49it/s]backtest loop:  52%|█████▏    | 503/971 [00:09<00:08, 54.56it/s]backtest loop:  52%|█████▏    | 509/971 [00:09<00:08, 53.24it/s]backtest loop:  53%|█████▎    | 516/971 [00:09<00:08, 56.06it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:08, 53.90it/s]backtest loop:  54%|█████▍    | 529/971 [00:09<00:07, 56.46it/s]backtest loop:  55%|█████▌    | 536/971 [00:09<00:07, 55.09it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:07, 57.26it/s]backtest loop:  57%|█████▋    | 550/971 [00:10<00:07, 58.80it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:07, 55.34it/s]backtest loop:  58%|█████▊    | 563/971 [00:10<00:07, 57.34it/s]backtest loop:  59%|█████▊    | 570/971 [00:10<00:06, 58.79it/s]backtest loop:  59%|█████▉    | 576/971 [00:10<00:07, 56.03it/s]backtest loop:  60%|█████▉    | 582/971 [00:10<00:06, 57.09it/s]backtest loop:  61%|██████    | 589/971 [00:10<00:06, 58.64it/s]backtest loop:  61%|██████▏   | 596/971 [00:10<00:06, 56.46it/s]backtest loop:  62%|██████▏   | 603/971 [00:11<00:06, 58.21it/s]backtest loop:  63%|██████▎   | 610/971 [00:11<00:06, 56.17it/s]backtest loop:  64%|██████▎   | 617/971 [00:11<00:06, 57.95it/s]backtest loop:  64%|██████▍   | 624/971 [00:11<00:05, 59.21it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:06, 56.37it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:05, 58.21it/s]backtest loop:  66%|██████▋   | 644/971 [00:11<00:05, 59.42it/s]backtest loop:  67%|██████▋   | 650/971 [00:11<00:05, 56.20it/s]backtest loop:  68%|██████▊   | 657/971 [00:11<00:05, 57.91it/s]backtest loop:  68%|██████▊   | 664/971 [00:12<00:05, 59.19it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 56.11it/s]backtest loop:  70%|██████▉   | 677/971 [00:12<00:05, 58.06it/s]backtest loop:  70%|███████   | 683/971 [00:12<00:04, 58.42it/s]backtest loop:  71%|███████   | 689/971 [00:12<00:05, 55.53it/s]backtest loop:  72%|███████▏  | 696/971 [00:12<00:04, 57.52it/s]backtest loop:  72%|███████▏  | 703/971 [00:12<00:04, 59.00it/s]backtest loop:  73%|███████▎  | 709/971 [00:12<00:04, 56.00it/s]backtest loop:  74%|███████▎  | 715/971 [00:13<00:04, 56.91it/s]backtest loop:  74%|███████▍  | 722/971 [00:13<00:04, 58.62it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 56.61it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 54.71it/s]backtest loop:  76%|███████▋  | 742/971 [00:13<00:04, 56.92it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.55it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 53.82it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 56.26it/s]backtest loop:  79%|███████▉  | 769/971 [00:13<00:03, 58.12it/s]backtest loop:  80%|███████▉  | 775/971 [00:14<00:03, 55.49it/s]backtest loop:  80%|████████  | 781/971 [00:14<00:03, 56.66it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 55.25it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.30it/s]backtest loop:  82%|████████▏ | 801/971 [00:14<00:02, 57.62it/s]backtest loop:  83%|████████▎ | 807/971 [00:14<00:02, 58.10it/s]backtest loop:  84%|████████▎ | 813/971 [00:14<00:02, 55.04it/s]backtest loop:  84%|████████▍ | 820/971 [00:14<00:02, 57.26it/s]backtest loop:  85%|████████▌ | 827/971 [00:14<00:02, 58.84it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 55.94it/s]backtest loop:  86%|████████▋ | 839/971 [00:15<00:02, 57.02it/s]backtest loop:  87%|████████▋ | 846/971 [00:15<00:02, 58.64it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 55.71it/s]backtest loop:  88%|████████▊ | 859/971 [00:15<00:01, 57.70it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 59.12it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 56.20it/s]backtest loop:  91%|█████████ | 879/971 [00:15<00:01, 58.03it/s]backtest loop:  91%|█████████ | 886/971 [00:15<00:01, 59.37it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 56.25it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 58.21it/s]backtest loop:  93%|█████████▎| 905/971 [00:16<00:01, 58.66it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 56.50it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 58.26it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 56.29it/s]backtest loop:  96%|█████████▌| 933/971 [00:16<00:00, 58.02it/s]backtest loop:  97%|█████████▋| 940/971 [00:16<00:00, 56.11it/s]backtest loop:  98%|█████████▊| 947/971 [00:17<00:00, 57.84it/s]backtest loop:  98%|█████████▊| 954/971 [00:17<00:00, 59.18it/s]backtest loop:  99%|█████████▉| 960/971 [00:17<00:00, 56.16it/s]backtest loop: 100%|█████████▉| 967/971 [00:17<00:00, 57.87it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.53it/s]
[3046892:MainThread](2024-04-25 03:36:11,680) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000590
std                0.004935
annualized_return  0.140471
information_ratio  1.844941
max_drawdown      -0.059892
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000393
std                0.004936
annualized_return  0.093459
information_ratio  1.227218
max_drawdown      -0.063220
[3046892:MainThread](2024-04-25 03:36:11,694) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `GRU_crowd_data_csi300_360_rankTrue`.
[3046892:MainThread](2024-04-25 03:36:18,439) INFO - qlib.timer - [log.py:127] - Time cost: 0.007s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.04752747527500248,
                                                    0.06753497732457434,
                                                    0.04389698519088239,
                                                    0.08580218014262934,
                                                    0.09345902392943012],
 '1day.excess_return_with_cost.information_ratio': [-0.47355908603877145,
                                                    0.940095684943139,
                                                    0.527684838645942,
                                                    1.0475605812703772,
                                                    1.227218033174128],
 '1day.excess_return_with_cost.max_drawdown': [-0.3376746326901112,
                                               -0.08173152645982251,
                                               -0.17276302603976773,
                                               -0.09756583800230148,
                                               -0.0632203399043754],
 'IC': [0.00363443899505527,
        0.02489675590560467,
        0.018902094432700335,
        0.020888639826414604,
        0.024184579544304124],
 'ICIR': [0.021413940843084633,
          0.19480099902991765,
          0.13069641324061324,
          0.15884409057214505,
          0.191989366852175],
 'Rank IC': [0.015102010164117578,
             0.037783709736229354,
             0.029404122617660105,
             0.026423821148463412,
             0.03324991193140413],
 'Rank ICIR': [0.09774431979917947,
               0.3096498421629207,
               0.2002519378681989,
               0.20040688139219454,
               0.26980638508856297],
 'mae': [0.8650185462473066,
         0.8638857495457903,
         0.8643701461289718,
         0.8645102856924792,
         0.8642098388915666],
 'mse': [0.9983762431278207,
         0.99706359774119,
         0.997759548555407,
         0.9974266902873177,
         0.9974959103471112]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3046892:MainThread](2024-04-25 03:36:21,682) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3046892:MainThread](2024-04-25 03:36:21,683) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3046892:MainThread](2024-04-25 03:36:21,684) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3046892:MainThread](2024-04-25 03:36:21,684) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3046892:MainThread](2024-04-25 03:36:24,715) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name GRU_crowd_data_csi300_360_rankTrue_48.
[3046892:MainThread](2024-04-25 03:36:24,738) INFO - qlib.workflow - [exp.py:258] - Experiment 34 starts running ...
[3046892:MainThread](2024-04-25 03:36:24,751) INFO - qlib.workflow - [recorder.py:341] - Recorder 936f413694774123ba3d69bbeaa4c885 starts running under Experiment 34 ...
[3046892:MainThread](2024-04-25 03:36:29,692) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3046892:MainThread](2024-04-25 03:36:29,692) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3046892:MainThread](2024-04-25 03:36:29,692) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:36:36,060) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:36:36,237) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.010311
[3046892:MainThread](2024-04-25 03:36:36,238) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3046892:MainThread](2024-04-25 03:36:36,239) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:36:42,565) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:36:42,739) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998903
[3046892:MainThread](2024-04-25 03:36:42,740) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3046892:MainThread](2024-04-25 03:36:42,741) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:36:49,031) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:36:49,206) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999864
[3046892:MainThread](2024-04-25 03:36:49,207) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3046892:MainThread](2024-04-25 03:36:49,207) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:36:55,539) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:36:55,714) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000419
[3046892:MainThread](2024-04-25 03:36:55,714) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3046892:MainThread](2024-04-25 03:36:55,715) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:37:01,938) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:37:02,114) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000670
[3046892:MainThread](2024-04-25 03:37:02,114) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3046892:MainThread](2024-04-25 03:37:02,115) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:37:08,446) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:37:08,622) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999798
[3046892:MainThread](2024-04-25 03:37:08,623) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3046892:MainThread](2024-04-25 03:37:08,623) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:37:15,081) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:37:15,255) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000124
[3046892:MainThread](2024-04-25 03:37:15,256) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3046892:MainThread](2024-04-25 03:37:15,256) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:37:21,809) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:37:21,986) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997348
[3046892:MainThread](2024-04-25 03:37:21,987) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3046892:MainThread](2024-04-25 03:37:21,988) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:37:28,516) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:37:28,692) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000287
[3046892:MainThread](2024-04-25 03:37:28,692) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3046892:MainThread](2024-04-25 03:37:28,693) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:37:35,009) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:37:35,182) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997676
[3046892:MainThread](2024-04-25 03:37:35,183) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3046892:MainThread](2024-04-25 03:37:35,183) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:37:41,480) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:37:41,654) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000018
[3046892:MainThread](2024-04-25 03:37:41,655) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3046892:MainThread](2024-04-25 03:37:41,655) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:37:47,979) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:37:48,155) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997601
[3046892:MainThread](2024-04-25 03:37:48,155) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3046892:MainThread](2024-04-25 03:37:48,156) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:37:54,301) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:37:54,475) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999551
[3046892:MainThread](2024-04-25 03:37:54,476) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3046892:MainThread](2024-04-25 03:37:54,476) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:38:00,757) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:38:00,935) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998299
[3046892:MainThread](2024-04-25 03:38:00,935) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3046892:MainThread](2024-04-25 03:38:00,936) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:38:07,229) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:38:07,404) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998342
[3046892:MainThread](2024-04-25 03:38:07,404) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3046892:MainThread](2024-04-25 03:38:07,405) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:38:13,729) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:38:13,907) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998741
[3046892:MainThread](2024-04-25 03:38:13,908) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3046892:MainThread](2024-04-25 03:38:13,908) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.997348 @ 7
[3046892:MainThread](2024-04-25 03:38:13,929) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to GRU_crowd_data_csi300_360_rankTrue_48.
[3046892:MainThread](2024-04-25 03:38:14,139) INFO - qlib.workflow - [exp.py:258] - Experiment 29 starts running ...
[3046892:MainThread](2024-04-25 03:38:14,151) INFO - qlib.workflow - [recorder.py:341] - Recorder c7f5fed5d8a74ab199aafe79cb6f29de starts running under Experiment 29 ...
{'IC': 0.020154432141670262,
 'ICIR': 0.14941450844986376,
 'Rank IC': 0.03325765963572595,
 'Rank ICIR': 0.2564386463960009}
[3046892:MainThread](2024-04-25 03:38:20,611) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3046892:MainThread](2024-04-25 03:38:57,491) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:38:57,495) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:39:03,445) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f7e02e406d0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:39,  9.77it/s]backtest loop:   1%|          | 10/971 [00:00<00:34, 27.82it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:25, 36.93it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:22, 42.27it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:19, 48.24it/s]backtest loop:   4%|▍         | 38/971 [00:00<00:17, 52.51it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:17, 51.88it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:16, 55.04it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 53.45it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:16, 56.09it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:15, 58.19it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:16, 55.59it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 57.95it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 59.49it/s]backtest loop:  10%|▉         | 97/971 [00:01<00:15, 56.52it/s]backtest loop:  11%|█         | 104/971 [00:02<00:14, 58.34it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:14, 59.77it/s]backtest loop:  12%|█▏        | 118/971 [00:02<00:14, 57.31it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 56.09it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 54.23it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:14, 56.66it/s]backtest loop:  15%|█▍        | 145/971 [00:02<00:14, 58.47it/s]backtest loop:  16%|█▌        | 151/971 [00:02<00:14, 55.95it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:14, 57.96it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:13, 59.51it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:13, 57.39it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:13, 59.28it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:13, 57.19it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:13, 59.12it/s]backtest loop:  20%|██        | 199/971 [00:03<00:12, 60.36it/s]backtest loop:  21%|██        | 206/971 [00:03<00:13, 57.75it/s]backtest loop:  22%|██▏       | 213/971 [00:03<00:13, 56.39it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 55.43it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:12, 57.73it/s]backtest loop:  24%|██▍       | 234/971 [00:04<00:12, 59.34it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:12, 56.46it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:12, 58.34it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:12, 56.44it/s]backtest loop:  27%|██▋       | 261/971 [00:04<00:12, 58.40it/s]backtest loop:  27%|██▋       | 267/971 [00:04<00:12, 55.83it/s]backtest loop:  28%|██▊       | 274/971 [00:05<00:12, 57.87it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:12, 56.11it/s]backtest loop:  30%|██▉       | 288/971 [00:05<00:11, 58.01it/s]backtest loop:  30%|███       | 295/971 [00:05<00:12, 56.32it/s]backtest loop:  31%|███       | 302/971 [00:05<00:11, 58.09it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 59.46it/s]backtest loop:  32%|███▏      | 315/971 [00:05<00:11, 56.50it/s]backtest loop:  33%|███▎      | 321/971 [00:05<00:11, 57.39it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:17, 36.52it/s]backtest loop:  34%|███▍      | 334/971 [00:06<00:15, 42.22it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:14, 44.21it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:12, 48.81it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:11, 52.62it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:11, 51.88it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:11, 52.25it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 51.73it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:10, 54.77it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 57.15it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 55.10it/s]backtest loop:  41%|████      | 400/971 [00:07<00:09, 57.33it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 59.97it/s]backtest loop:  43%|████▎     | 414/971 [00:07<00:09, 58.39it/s]backtest loop:  43%|████▎     | 421/971 [00:07<00:09, 59.72it/s]backtest loop:  44%|████▍     | 428/971 [00:07<00:09, 57.13it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:09, 58.81it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:09, 56.60it/s]backtest loop:  46%|████▌     | 449/971 [00:08<00:08, 58.20it/s]backtest loop:  47%|████▋     | 455/971 [00:08<00:08, 58.62it/s]backtest loop:  48%|████▊     | 462/971 [00:08<00:09, 56.44it/s]backtest loop:  48%|████▊     | 469/971 [00:08<00:08, 58.14it/s]backtest loop:  49%|████▉     | 476/971 [00:08<00:08, 59.56it/s]backtest loop:  50%|████▉     | 482/971 [00:08<00:08, 56.33it/s]backtest loop:  50%|█████     | 489/971 [00:08<00:08, 58.15it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:08, 55.50it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:08, 57.59it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:08, 55.10it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 56.10it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 58.09it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:07, 55.54it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:07, 57.67it/s]backtest loop:  56%|█████▌    | 541/971 [00:09<00:07, 56.02it/s]backtest loop:  56%|█████▋    | 548/971 [00:09<00:07, 57.93it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:06, 59.48it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 56.56it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:06, 58.31it/s]backtest loop:  59%|█████▉    | 575/971 [00:10<00:06, 59.58it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:06, 56.35it/s]backtest loop:  60%|██████    | 587/971 [00:10<00:06, 57.12it/s]backtest loop:  61%|██████    | 594/971 [00:10<00:06, 58.80it/s]backtest loop:  62%|██████▏   | 600/971 [00:10<00:06, 55.88it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 57.86it/s]backtest loop:  63%|██████▎   | 614/971 [00:11<00:06, 59.26it/s]backtest loop:  64%|██████▍   | 620/971 [00:11<00:06, 56.34it/s]backtest loop:  65%|██████▍   | 627/971 [00:11<00:05, 58.28it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:05, 59.61it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:05, 56.40it/s]backtest loop:  67%|██████▋   | 647/971 [00:11<00:05, 58.07it/s]backtest loop:  67%|██████▋   | 654/971 [00:11<00:05, 59.38it/s]backtest loop:  68%|██████▊   | 660/971 [00:11<00:05, 56.16it/s]backtest loop:  69%|██████▊   | 666/971 [00:12<00:05, 56.43it/s]backtest loop:  69%|██████▉   | 672/971 [00:12<00:05, 57.13it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 55.47it/s]backtest loop:  71%|███████   | 686/971 [00:12<00:04, 57.40it/s]backtest loop:  71%|███████▏  | 692/971 [00:12<00:04, 58.09it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 56.07it/s]backtest loop:  73%|███████▎  | 706/971 [00:12<00:04, 57.85it/s]backtest loop:  73%|███████▎  | 713/971 [00:12<00:04, 59.18it/s]backtest loop:  74%|███████▍  | 719/971 [00:12<00:04, 56.35it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 58.28it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 55.56it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 53.71it/s]backtest loop:  77%|███████▋  | 744/971 [00:13<00:04, 55.25it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 53.43it/s]backtest loop:  78%|███████▊  | 757/971 [00:13<00:03, 56.00it/s]backtest loop:  79%|███████▊  | 764/971 [00:13<00:03, 57.97it/s]backtest loop:  79%|███████▉  | 770/971 [00:13<00:03, 55.45it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 57.47it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 55.41it/s]backtest loop:  81%|████████▏ | 790/971 [00:14<00:03, 57.67it/s]backtest loop:  82%|████████▏ | 797/971 [00:14<00:02, 59.14it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:02, 56.06it/s]backtest loop:  83%|████████▎ | 810/971 [00:14<00:02, 57.97it/s]backtest loop:  84%|████████▍ | 816/971 [00:14<00:02, 58.46it/s]backtest loop:  85%|████████▍ | 823/971 [00:14<00:02, 56.41it/s]backtest loop:  85%|████████▌ | 829/971 [00:14<00:02, 57.33it/s]backtest loop:  86%|████████▌ | 836/971 [00:15<00:02, 58.80it/s]backtest loop:  87%|████████▋ | 843/971 [00:15<00:02, 56.59it/s]backtest loop:  88%|████████▊ | 850/971 [00:15<00:02, 58.33it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 56.40it/s]backtest loop:  89%|████████▉ | 864/971 [00:15<00:01, 58.10it/s]backtest loop:  90%|████████▉ | 871/971 [00:15<00:01, 59.52it/s]backtest loop:  90%|█████████ | 877/971 [00:15<00:01, 56.37it/s]backtest loop:  91%|█████████ | 883/971 [00:15<00:01, 57.24it/s]backtest loop:  92%|█████████▏| 890/971 [00:15<00:01, 58.90it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 56.69it/s]backtest loop:  93%|█████████▎| 904/971 [00:16<00:01, 58.26it/s]backtest loop:  94%|█████████▍| 911/971 [00:16<00:01, 59.47it/s]backtest loop:  94%|█████████▍| 917/971 [00:16<00:00, 56.10it/s]backtest loop:  95%|█████████▌| 924/971 [00:16<00:00, 57.95it/s]backtest loop:  96%|█████████▌| 931/971 [00:16<00:00, 56.20it/s]backtest loop:  97%|█████████▋| 938/971 [00:16<00:00, 58.02it/s]backtest loop:  97%|█████████▋| 945/971 [00:16<00:00, 56.07it/s]backtest loop:  98%|█████████▊| 951/971 [00:17<00:00, 56.85it/s]backtest loop:  99%|█████████▊| 958/971 [00:17<00:00, 58.49it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 56.43it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.87it/s]
[3046892:MainThread](2024-04-25 03:39:20,883) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000611
std                0.004865
annualized_return  0.145397
information_ratio  1.937371
max_drawdown      -0.054995
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000412
std                0.004866
annualized_return  0.097951
information_ratio  1.304939
max_drawdown      -0.062487
[3046892:MainThread](2024-04-25 03:39:20,895) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `GRU_crowd_data_csi300_360_rankTrue`.
[3046892:MainThread](2024-04-25 03:39:27,662) INFO - qlib.timer - [log.py:127] - Time cost: 0.003s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.04752747527500248,
                                                    0.06753497732457434,
                                                    0.04389698519088239,
                                                    0.08580218014262934,
                                                    0.09345902392943012,
                                                    0.097951390998315],
 '1day.excess_return_with_cost.information_ratio': [-0.47355908603877145,
                                                    0.940095684943139,
                                                    0.527684838645942,
                                                    1.0475605812703772,
                                                    1.227218033174128,
                                                    1.3049393272943204],
 '1day.excess_return_with_cost.max_drawdown': [-0.3376746326901112,
                                               -0.08173152645982251,
                                               -0.17276302603976773,
                                               -0.09756583800230148,
                                               -0.0632203399043754,
                                               -0.06248740653818602],
 'IC': [0.00363443899505527,
        0.02489675590560467,
        0.018902094432700335,
        0.020888639826414604,
        0.024184579544304124,
        0.020154432141670262],
 'ICIR': [0.021413940843084633,
          0.19480099902991765,
          0.13069641324061324,
          0.15884409057214505,
          0.191989366852175,
          0.14941450844986376],
 'Rank IC': [0.015102010164117578,
             0.037783709736229354,
             0.029404122617660105,
             0.026423821148463412,
             0.03324991193140413,
             0.03325765963572595],
 'Rank ICIR': [0.09774431979917947,
               0.3096498421629207,
               0.2002519378681989,
               0.20040688139219454,
               0.26980638508856297,
               0.2564386463960009],
 'mae': [0.8650185462473066,
         0.8638857495457903,
         0.8643701461289718,
         0.8645102856924792,
         0.8642098388915666,
         0.8640932410861362],
 'mse': [0.9983762431278207,
         0.99706359774119,
         0.997759548555407,
         0.9974266902873177,
         0.9974959103471112,
         0.9978944201174561]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3046892:MainThread](2024-04-25 03:39:30,939) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3046892:MainThread](2024-04-25 03:39:30,939) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3046892:MainThread](2024-04-25 03:39:30,941) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3046892:MainThread](2024-04-25 03:39:30,941) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3046892:MainThread](2024-04-25 03:39:34,000) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name GRU_crowd_data_csi300_360_rankTrue_49.
[3046892:MainThread](2024-04-25 03:39:34,024) INFO - qlib.workflow - [exp.py:258] - Experiment 35 starts running ...
[3046892:MainThread](2024-04-25 03:39:34,034) INFO - qlib.workflow - [recorder.py:341] - Recorder 675e8666d70d44d580254c0ec8385c89 starts running under Experiment 35 ...
[3046892:MainThread](2024-04-25 03:39:39,131) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3046892:MainThread](2024-04-25 03:39:39,131) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3046892:MainThread](2024-04-25 03:39:39,132) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:39:45,365) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:39:45,539) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999507
[3046892:MainThread](2024-04-25 03:39:45,541) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3046892:MainThread](2024-04-25 03:39:45,541) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:39:51,891) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:39:52,068) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000798
[3046892:MainThread](2024-04-25 03:39:52,068) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3046892:MainThread](2024-04-25 03:39:52,069) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:39:58,476) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:39:58,653) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998645
[3046892:MainThread](2024-04-25 03:39:58,654) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3046892:MainThread](2024-04-25 03:39:58,654) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:40:04,995) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:40:05,170) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997708
[3046892:MainThread](2024-04-25 03:40:05,171) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3046892:MainThread](2024-04-25 03:40:05,171) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:40:11,539) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:40:11,713) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998900
[3046892:MainThread](2024-04-25 03:40:11,713) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3046892:MainThread](2024-04-25 03:40:11,713) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:40:18,020) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:40:18,196) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998744
[3046892:MainThread](2024-04-25 03:40:18,196) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3046892:MainThread](2024-04-25 03:40:18,197) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:40:25,097) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:40:25,271) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998684
[3046892:MainThread](2024-04-25 03:40:25,271) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3046892:MainThread](2024-04-25 03:40:25,272) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:40:31,528) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:40:31,703) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000827
[3046892:MainThread](2024-04-25 03:40:31,703) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3046892:MainThread](2024-04-25 03:40:31,703) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:40:38,045) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:40:38,219) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000629
[3046892:MainThread](2024-04-25 03:40:38,219) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3046892:MainThread](2024-04-25 03:40:38,219) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:40:44,500) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:40:44,673) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999912
[3046892:MainThread](2024-04-25 03:40:44,674) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3046892:MainThread](2024-04-25 03:40:44,674) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:40:50,939) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:40:51,114) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999576
[3046892:MainThread](2024-04-25 03:40:51,115) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3046892:MainThread](2024-04-25 03:40:51,115) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:40:57,406) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:40:57,579) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998090
[3046892:MainThread](2024-04-25 03:40:57,579) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3046892:MainThread](2024-04-25 03:40:57,580) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.997708 @ 3
[3046892:MainThread](2024-04-25 03:40:57,602) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to GRU_crowd_data_csi300_360_rankTrue_49.
[3046892:MainThread](2024-04-25 03:40:57,815) INFO - qlib.workflow - [exp.py:258] - Experiment 29 starts running ...
[3046892:MainThread](2024-04-25 03:40:57,827) INFO - qlib.workflow - [recorder.py:341] - Recorder 7053145bfe5d4e5a978a3ff3cd89d2ca starts running under Experiment 29 ...
{'IC': 0.012235740776743175,
 'ICIR': 0.08617666534890676,
 'Rank IC': 0.01903367623117386,
 'Rank ICIR': 0.1301164570332772}
[3046892:MainThread](2024-04-25 03:41:04,309) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3046892:MainThread](2024-04-25 03:41:41,494) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:41:41,497) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:41:47,556) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f7e07da2ee0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:40,  9.67it/s]backtest loop:   1%|          | 9/971 [00:00<00:37, 25.46it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 37.92it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.48it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:19, 47.25it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.86it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.19it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.21it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 52.61it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 55.39it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 53.54it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 56.14it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 58.10it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:16, 55.14it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 57.33it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 58.99it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 55.93it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 57.83it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.20it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:15, 53.05it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:14, 55.86it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 54.89it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 57.06it/s]backtest loop:  16%|█▌        | 154/971 [00:02<00:14, 57.58it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 55.84it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:13, 57.82it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:13, 59.10it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:14, 56.24it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 57.94it/s]backtest loop:  20%|██        | 195/971 [00:03<00:13, 56.13it/s]backtest loop:  21%|██        | 201/971 [00:03<00:13, 56.68it/s]backtest loop:  21%|██▏       | 208/971 [00:03<00:13, 58.35it/s]backtest loop:  22%|██▏       | 214/971 [00:04<00:13, 55.65it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 53.65it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:13, 56.28it/s]backtest loop:  24%|██▍       | 234/971 [00:04<00:12, 58.11it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:13, 55.42it/s]backtest loop:  25%|██▌       | 246/971 [00:04<00:12, 55.99it/s]backtest loop:  26%|██▌       | 252/971 [00:04<00:12, 56.95it/s]backtest loop:  27%|██▋       | 259/971 [00:04<00:12, 55.47it/s]backtest loop:  27%|██▋       | 266/971 [00:04<00:12, 54.42it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 56.60it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:11, 58.32it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 55.51it/s]backtest loop:  30%|███       | 293/971 [00:05<00:11, 57.60it/s]backtest loop:  31%|███       | 300/971 [00:05<00:12, 55.88it/s]backtest loop:  32%|███▏      | 307/971 [00:05<00:11, 57.81it/s]backtest loop:  32%|███▏      | 314/971 [00:05<00:11, 59.17it/s]backtest loop:  33%|███▎      | 320/971 [00:05<00:11, 56.03it/s]backtest loop:  34%|███▎      | 326/971 [00:06<00:18, 35.19it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:15, 40.87it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:14, 43.87it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:12, 48.40it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:11, 52.33it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:11, 51.62it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:11, 52.11it/s]backtest loop:  38%|███▊      | 373/971 [00:07<00:11, 51.71it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:10, 54.63it/s]backtest loop:  40%|███▉      | 386/971 [00:07<00:10, 56.03it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 54.69it/s]backtest loop:  41%|████      | 400/971 [00:07<00:10, 56.97it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 58.70it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:09, 55.96it/s]backtest loop:  43%|████▎     | 420/971 [00:07<00:09, 57.83it/s]backtest loop:  44%|████▍     | 427/971 [00:07<00:09, 59.37it/s]backtest loop:  45%|████▍     | 433/971 [00:08<00:09, 56.23it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:09, 58.00it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 55.88it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:08, 57.79it/s]backtest loop:  47%|████▋     | 461/971 [00:08<00:08, 59.18it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:08, 56.12it/s]backtest loop:  49%|████▉     | 474/971 [00:08<00:08, 57.87it/s]backtest loop:  50%|████▉     | 481/971 [00:08<00:08, 59.24it/s]backtest loop:  50%|█████     | 487/971 [00:09<00:08, 56.09it/s]backtest loop:  51%|█████     | 494/971 [00:09<00:08, 57.86it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 55.21it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 54.25it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 56.60it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 58.31it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:07, 55.71it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:07, 57.61it/s]backtest loop:  56%|█████▌    | 540/971 [00:09<00:07, 58.23it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 55.01it/s]backtest loop:  57%|█████▋    | 553/971 [00:10<00:07, 57.24it/s]backtest loop:  58%|█████▊    | 560/971 [00:10<00:06, 58.86it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 55.90it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:06, 57.73it/s]backtest loop:  60%|█████▉    | 579/971 [00:10<00:06, 58.27it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:06, 56.33it/s]backtest loop:  61%|██████    | 593/971 [00:10<00:06, 58.06it/s]backtest loop:  62%|██████▏   | 600/971 [00:11<00:06, 56.10it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 57.85it/s]backtest loop:  63%|██████▎   | 614/971 [00:11<00:06, 59.23it/s]backtest loop:  64%|██████▍   | 620/971 [00:11<00:06, 56.33it/s]backtest loop:  65%|██████▍   | 627/971 [00:11<00:05, 58.07it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:05, 59.42it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:05, 56.39it/s]backtest loop:  67%|██████▋   | 646/971 [00:11<00:05, 57.35it/s]backtest loop:  67%|██████▋   | 653/971 [00:11<00:05, 58.95it/s]backtest loop:  68%|██████▊   | 660/971 [00:12<00:05, 56.54it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 58.18it/s]backtest loop:  69%|██████▉   | 673/971 [00:12<00:05, 58.46it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 55.55it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 56.68it/s]backtest loop:  71%|███████▏  | 692/971 [00:12<00:04, 58.31it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 56.21it/s]backtest loop:  73%|███████▎  | 705/971 [00:12<00:04, 57.16it/s]backtest loop:  73%|███████▎  | 712/971 [00:12<00:04, 58.61it/s]backtest loop:  74%|███████▍  | 718/971 [00:13<00:04, 58.93it/s]backtest loop:  75%|███████▍  | 724/971 [00:13<00:04, 56.39it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 54.92it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 53.99it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:04, 56.42it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 54.33it/s]backtest loop:  78%|███████▊  | 757/971 [00:13<00:03, 55.77it/s]backtest loop:  79%|███████▊  | 764/971 [00:13<00:03, 57.68it/s]backtest loop:  79%|███████▉  | 770/971 [00:14<00:03, 55.21it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 57.24it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 54.96it/s]backtest loop:  81%|████████▏ | 790/971 [00:14<00:03, 57.24it/s]backtest loop:  82%|████████▏ | 797/971 [00:14<00:02, 58.82it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:03, 55.81it/s]backtest loop:  83%|████████▎ | 810/971 [00:14<00:02, 57.63it/s]backtest loop:  84%|████████▍ | 817/971 [00:14<00:02, 59.02it/s]backtest loop:  85%|████████▍ | 823/971 [00:14<00:02, 56.03it/s]backtest loop:  85%|████████▌ | 830/971 [00:15<00:02, 57.87it/s]backtest loop:  86%|████████▌ | 836/971 [00:15<00:02, 58.41it/s]backtest loop:  87%|████████▋ | 843/971 [00:15<00:02, 56.27it/s]backtest loop:  87%|████████▋ | 849/971 [00:15<00:02, 56.28it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:02, 57.08it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 55.36it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 57.66it/s]backtest loop:  90%|█████████ | 876/971 [00:15<00:01, 59.01it/s]backtest loop:  91%|█████████ | 882/971 [00:15<00:01, 56.08it/s]backtest loop:  91%|█████████▏| 888/971 [00:16<00:01, 56.98it/s]backtest loop:  92%|█████████▏| 894/971 [00:16<00:01, 57.69it/s]backtest loop:  93%|█████████▎| 900/971 [00:16<00:01, 57.49it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 58.15it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 55.25it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 57.35it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 55.49it/s]backtest loop:  96%|█████████▌| 933/971 [00:16<00:00, 57.43it/s]backtest loop:  97%|█████████▋| 940/971 [00:17<00:00, 55.63it/s]backtest loop:  97%|█████████▋| 946/971 [00:17<00:00, 56.48it/s]backtest loop:  98%|█████████▊| 953/971 [00:17<00:00, 58.19it/s]backtest loop:  99%|█████████▉| 960/971 [00:17<00:00, 56.19it/s]backtest loop: 100%|█████████▉| 967/971 [00:17<00:00, 57.88it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.36it/s]
[3046892:MainThread](2024-04-25 03:42:05,154) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000376
std                0.005224
annualized_return  0.089457
information_ratio  1.110101
max_drawdown      -0.111826
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000175
std                0.005224
annualized_return  0.041569
information_ratio  0.515777
max_drawdown      -0.119833
[3046892:MainThread](2024-04-25 03:42:05,167) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `GRU_crowd_data_csi300_360_rankTrue`.
[3046892:MainThread](2024-04-25 03:42:21,973) INFO - qlib.timer - [log.py:127] - Time cost: 0.007s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.04752747527500248,
                                                    0.06753497732457434,
                                                    0.04389698519088239,
                                                    0.08580218014262934,
                                                    0.09345902392943012,
                                                    0.097951390998315,
                                                    0.041568808810134535],
 '1day.excess_return_with_cost.information_ratio': [-0.47355908603877145,
                                                    0.940095684943139,
                                                    0.527684838645942,
                                                    1.0475605812703772,
                                                    1.227218033174128,
                                                    1.3049393272943204,
                                                    0.5157774530742688],
 '1day.excess_return_with_cost.max_drawdown': [-0.3376746326901112,
                                               -0.08173152645982251,
                                               -0.17276302603976773,
                                               -0.09756583800230148,
                                               -0.0632203399043754,
                                               -0.06248740653818602,
                                               -0.1198327049674568],
 'IC': [0.00363443899505527,
        0.02489675590560467,
        0.018902094432700335,
        0.020888639826414604,
        0.024184579544304124,
        0.020154432141670262,
        0.012235740776743175],
 'ICIR': [0.021413940843084633,
          0.19480099902991765,
          0.13069641324061324,
          0.15884409057214505,
          0.191989366852175,
          0.14941450844986376,
          0.08617666534890676],
 'Rank IC': [0.015102010164117578,
             0.037783709736229354,
             0.029404122617660105,
             0.026423821148463412,
             0.03324991193140413,
             0.03325765963572595,
             0.01903367623117386],
 'Rank ICIR': [0.09774431979917947,
               0.3096498421629207,
               0.2002519378681989,
               0.20040688139219454,
               0.26980638508856297,
               0.2564386463960009,
               0.1301164570332772],
 'mae': [0.8650185462473066,
         0.8638857495457903,
         0.8643701461289718,
         0.8645102856924792,
         0.8642098388915666,
         0.8640932410861362,
         0.864754724525937],
 'mse': [0.9983762431278207,
         0.99706359774119,
         0.997759548555407,
         0.9974266902873177,
         0.9974959103471112,
         0.9978944201174561,
         0.9982913445672937]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3046892:MainThread](2024-04-25 03:42:25,256) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3046892:MainThread](2024-04-25 03:42:25,256) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3046892:MainThread](2024-04-25 03:42:25,258) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3046892:MainThread](2024-04-25 03:42:25,258) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3046892:MainThread](2024-04-25 03:42:28,283) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name GRU_crowd_data_csi300_360_rankTrue_50.
[3046892:MainThread](2024-04-25 03:42:28,308) INFO - qlib.workflow - [exp.py:258] - Experiment 36 starts running ...
[3046892:MainThread](2024-04-25 03:42:28,321) INFO - qlib.workflow - [recorder.py:341] - Recorder a5a9dfc507514603aad0cc62f712e48a starts running under Experiment 36 ...
[3046892:MainThread](2024-04-25 03:42:33,461) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3046892:MainThread](2024-04-25 03:42:33,462) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3046892:MainThread](2024-04-25 03:42:33,462) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:42:39,817) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:42:39,994) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.002898
[3046892:MainThread](2024-04-25 03:42:39,995) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3046892:MainThread](2024-04-25 03:42:39,995) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:42:46,345) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:42:46,522) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.011756
[3046892:MainThread](2024-04-25 03:42:46,522) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3046892:MainThread](2024-04-25 03:42:46,523) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:42:52,844) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:42:53,019) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999851
[3046892:MainThread](2024-04-25 03:42:53,020) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3046892:MainThread](2024-04-25 03:42:53,020) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:42:59,341) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:42:59,520) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998944
[3046892:MainThread](2024-04-25 03:42:59,521) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3046892:MainThread](2024-04-25 03:42:59,522) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:43:05,829) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:43:06,005) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999089
[3046892:MainThread](2024-04-25 03:43:06,006) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3046892:MainThread](2024-04-25 03:43:06,007) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:43:12,199) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:43:12,377) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.006384
[3046892:MainThread](2024-04-25 03:43:12,378) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3046892:MainThread](2024-04-25 03:43:12,378) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:43:18,699) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:43:18,876) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998099
[3046892:MainThread](2024-04-25 03:43:18,877) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3046892:MainThread](2024-04-25 03:43:18,878) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:43:25,210) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:43:25,385) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998009
[3046892:MainThread](2024-04-25 03:43:25,387) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3046892:MainThread](2024-04-25 03:43:25,387) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:43:31,704) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:43:31,880) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.002384
[3046892:MainThread](2024-04-25 03:43:31,881) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3046892:MainThread](2024-04-25 03:43:31,881) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:43:38,203) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:43:38,377) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000201
[3046892:MainThread](2024-04-25 03:43:38,377) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3046892:MainThread](2024-04-25 03:43:38,378) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:43:44,583) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:43:44,762) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.001897
[3046892:MainThread](2024-04-25 03:43:44,762) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3046892:MainThread](2024-04-25 03:43:44,762) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:43:51,057) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:43:51,234) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998203
[3046892:MainThread](2024-04-25 03:43:51,234) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3046892:MainThread](2024-04-25 03:43:51,234) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:43:57,506) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:43:57,684) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998675
[3046892:MainThread](2024-04-25 03:43:57,685) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3046892:MainThread](2024-04-25 03:43:57,685) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:44:03,879) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:44:04,054) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997496
[3046892:MainThread](2024-04-25 03:44:04,056) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3046892:MainThread](2024-04-25 03:44:04,056) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:44:10,411) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:44:10,589) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.001624
[3046892:MainThread](2024-04-25 03:44:10,589) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3046892:MainThread](2024-04-25 03:44:10,590) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:44:16,909) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:44:17,083) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997686
[3046892:MainThread](2024-04-25 03:44:17,084) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3046892:MainThread](2024-04-25 03:44:17,084) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:44:23,379) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:44:23,556) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.002646
[3046892:MainThread](2024-04-25 03:44:23,556) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3046892:MainThread](2024-04-25 03:44:23,556) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:44:29,753) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:44:29,929) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997437
[3046892:MainThread](2024-04-25 03:44:29,930) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3046892:MainThread](2024-04-25 03:44:29,930) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:44:36,253) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:44:36,429) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997556
[3046892:MainThread](2024-04-25 03:44:36,429) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3046892:MainThread](2024-04-25 03:44:36,429) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:44:42,697) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:44:42,874) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999027
[3046892:MainThread](2024-04-25 03:44:42,874) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3046892:MainThread](2024-04-25 03:44:42,875) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:44:49,249) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:44:49,424) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.001486
[3046892:MainThread](2024-04-25 03:44:49,424) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3046892:MainThread](2024-04-25 03:44:49,425) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:44:55,736) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:44:55,913) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998816
[3046892:MainThread](2024-04-25 03:44:55,914) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3046892:MainThread](2024-04-25 03:44:55,914) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:45:02,256) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:45:02,433) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000064
[3046892:MainThread](2024-04-25 03:45:02,433) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3046892:MainThread](2024-04-25 03:45:02,433) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:45:08,724) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:45:08,900) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000025
[3046892:MainThread](2024-04-25 03:45:08,900) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3046892:MainThread](2024-04-25 03:45:08,900) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:45:15,184) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:45:15,359) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999363
[3046892:MainThread](2024-04-25 03:45:15,359) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3046892:MainThread](2024-04-25 03:45:15,359) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:45:21,718) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:45:21,896) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997102
[3046892:MainThread](2024-04-25 03:45:21,897) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3046892:MainThread](2024-04-25 03:45:21,897) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:45:28,161) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:45:28,335) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997973
[3046892:MainThread](2024-04-25 03:45:28,336) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[3046892:MainThread](2024-04-25 03:45:28,336) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:45:34,650) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:45:34,825) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000255
[3046892:MainThread](2024-04-25 03:45:34,826) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[3046892:MainThread](2024-04-25 03:45:34,826) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:45:41,110) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:45:41,286) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999173
[3046892:MainThread](2024-04-25 03:45:41,286) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[3046892:MainThread](2024-04-25 03:45:41,286) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:45:47,574) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:45:47,751) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998404
[3046892:MainThread](2024-04-25 03:45:47,751) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch30:
[3046892:MainThread](2024-04-25 03:45:47,751) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:45:54,063) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:45:54,238) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999410
[3046892:MainThread](2024-04-25 03:45:54,238) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch31:
[3046892:MainThread](2024-04-25 03:45:54,238) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:46:00,530) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:46:00,705) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000517
[3046892:MainThread](2024-04-25 03:46:00,705) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch32:
[3046892:MainThread](2024-04-25 03:46:00,705) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:46:06,983) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:46:07,160) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000548
[3046892:MainThread](2024-04-25 03:46:07,160) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch33:
[3046892:MainThread](2024-04-25 03:46:07,161) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:46:13,469) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:46:13,644) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000465
[3046892:MainThread](2024-04-25 03:46:13,644) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3046892:MainThread](2024-04-25 03:46:13,645) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.997102 @ 25
[3046892:MainThread](2024-04-25 03:46:13,665) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to GRU_crowd_data_csi300_360_rankTrue_50.
[3046892:MainThread](2024-04-25 03:46:13,877) INFO - qlib.workflow - [exp.py:258] - Experiment 29 starts running ...
[3046892:MainThread](2024-04-25 03:46:13,889) INFO - qlib.workflow - [recorder.py:341] - Recorder cea303021fde4eb882e5882f9669bb0c starts running under Experiment 29 ...
{'IC': 0.010274074412924146,
 'ICIR': 0.0881459108735743,
 'Rank IC': 0.014640904746829154,
 'Rank ICIR': 0.1204174396336297}
[3046892:MainThread](2024-04-25 03:46:20,439) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3046892:MainThread](2024-04-25 03:46:57,713) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:46:57,716) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:47:03,738) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f7e0f64ca00>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:40,  9.68it/s]backtest loop:   1%|          | 9/971 [00:00<00:37, 25.49it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 37.86it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.43it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.96it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 48.12it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.69it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.79it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.89it/s]backtest loop:   6%|▌         | 60/971 [00:01<00:16, 55.45it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.64it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 57.25it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 58.92it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 56.10it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 57.75it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 59.06it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.14it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 58.11it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.36it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:15, 52.95it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:15, 55.59it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 54.49it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 56.62it/s]backtest loop:  16%|█▌        | 155/971 [00:02<00:13, 58.33it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 55.40it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:14, 57.36it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:13, 58.75it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:14, 56.01it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 58.08it/s]backtest loop:  20%|██        | 195/971 [00:03<00:13, 56.10it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 58.11it/s]backtest loop:  22%|██▏       | 209/971 [00:03<00:12, 59.40it/s]backtest loop:  22%|██▏       | 215/971 [00:04<00:14, 53.76it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:13, 56.26it/s]backtest loop:  23%|██▎       | 228/971 [00:04<00:13, 57.05it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:13, 55.36it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:12, 57.39it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:12, 55.89it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:12, 58.27it/s]backtest loop:  27%|██▋       | 262/971 [00:04<00:12, 58.73it/s]backtest loop:  28%|██▊       | 268/971 [00:04<00:12, 55.88it/s]backtest loop:  28%|██▊       | 275/971 [00:05<00:12, 57.92it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:12, 55.37it/s]backtest loop:  30%|██▉       | 288/971 [00:05<00:11, 57.47it/s]backtest loop:  30%|███       | 295/971 [00:05<00:12, 55.73it/s]backtest loop:  31%|███       | 302/971 [00:05<00:11, 57.72it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 59.11it/s]backtest loop:  32%|███▏      | 315/971 [00:05<00:11, 56.12it/s]backtest loop:  33%|███▎      | 322/971 [00:06<00:16, 38.83it/s]backtest loop:  34%|███▍      | 329/971 [00:06<00:14, 44.01it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:13, 45.54it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:12, 50.14it/s]backtest loop:  36%|███▌      | 349/971 [00:06<00:11, 53.58it/s]backtest loop:  37%|███▋      | 355/971 [00:06<00:11, 52.74it/s]backtest loop:  37%|███▋      | 362/971 [00:06<00:10, 55.55it/s]backtest loop:  38%|███▊      | 368/971 [00:06<00:11, 51.05it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:10, 54.20it/s]backtest loop:  39%|███▉      | 382/971 [00:07<00:10, 56.74it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:10, 54.61it/s]backtest loop:  41%|████      | 395/971 [00:07<00:10, 56.94it/s]backtest loop:  41%|████▏     | 402/971 [00:07<00:09, 58.55it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:10, 55.76it/s]backtest loop:  43%|████▎     | 415/971 [00:07<00:09, 57.73it/s]backtest loop:  43%|████▎     | 422/971 [00:07<00:09, 59.80it/s]backtest loop:  44%|████▍     | 429/971 [00:07<00:09, 57.25it/s]backtest loop:  45%|████▍     | 436/971 [00:08<00:09, 58.77it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:09, 55.88it/s]backtest loop:  46%|████▌     | 449/971 [00:08<00:09, 57.71it/s]backtest loop:  47%|████▋     | 456/971 [00:08<00:08, 59.08it/s]backtest loop:  48%|████▊     | 462/971 [00:08<00:09, 56.16it/s]backtest loop:  48%|████▊     | 469/971 [00:08<00:08, 58.01it/s]backtest loop:  49%|████▉     | 476/971 [00:08<00:08, 59.29it/s]backtest loop:  50%|████▉     | 482/971 [00:08<00:08, 56.25it/s]backtest loop:  50%|█████     | 489/971 [00:08<00:08, 58.04it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:08, 55.53it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:08, 57.56it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:08, 55.36it/s]backtest loop:  53%|█████▎    | 515/971 [00:09<00:07, 57.33it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 57.92it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:08, 55.39it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:07, 57.83it/s]backtest loop:  56%|█████▌    | 541/971 [00:09<00:07, 56.03it/s]backtest loop:  56%|█████▋    | 548/971 [00:10<00:07, 57.95it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 59.30it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 56.26it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:06, 58.03it/s]backtest loop:  59%|█████▉    | 575/971 [00:10<00:06, 59.53it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:06, 56.22it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:06, 58.13it/s]backtest loop:  61%|██████▏   | 595/971 [00:10<00:06, 59.49it/s]backtest loop:  62%|██████▏   | 601/971 [00:10<00:06, 55.66it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 56.63it/s]backtest loop:  63%|██████▎   | 613/971 [00:11<00:06, 57.52it/s]backtest loop:  64%|██████▍   | 620/971 [00:11<00:06, 55.79it/s]backtest loop:  65%|██████▍   | 627/971 [00:11<00:05, 57.76it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:05, 59.09it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:05, 56.09it/s]backtest loop:  67%|██████▋   | 646/971 [00:11<00:05, 57.14it/s]backtest loop:  67%|██████▋   | 653/971 [00:11<00:05, 58.98it/s]backtest loop:  68%|██████▊   | 660/971 [00:11<00:05, 56.64it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 58.31it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:05, 56.25it/s]backtest loop:  70%|███████   | 680/971 [00:12<00:05, 57.04it/s]backtest loop:  71%|███████   | 686/971 [00:12<00:04, 57.79it/s]backtest loop:  71%|███████▏  | 693/971 [00:12<00:04, 59.29it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 56.21it/s]backtest loop:  73%|███████▎  | 706/971 [00:12<00:04, 57.94it/s]backtest loop:  73%|███████▎  | 713/971 [00:12<00:04, 59.25it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 56.25it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 58.29it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 55.87it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 54.19it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:03, 56.60it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 54.38it/s]backtest loop:  78%|███████▊  | 758/971 [00:13<00:03, 56.68it/s]backtest loop:  79%|███████▊  | 764/971 [00:13<00:03, 57.15it/s]backtest loop:  79%|███████▉  | 770/971 [00:13<00:03, 54.81it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 56.99it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 54.76it/s]backtest loop:  81%|████████▏ | 790/971 [00:14<00:03, 57.05it/s]backtest loop:  82%|████████▏ | 797/971 [00:14<00:02, 58.64it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:03, 55.68it/s]backtest loop:  83%|████████▎ | 810/971 [00:14<00:02, 57.63it/s]backtest loop:  84%|████████▍ | 817/971 [00:14<00:02, 58.97it/s]backtest loop:  85%|████████▍ | 823/971 [00:14<00:02, 55.96it/s]backtest loop:  85%|████████▌ | 830/971 [00:14<00:02, 57.80it/s]backtest loop:  86%|████████▌ | 837/971 [00:15<00:02, 59.07it/s]backtest loop:  87%|████████▋ | 843/971 [00:15<00:02, 55.74it/s]backtest loop:  88%|████████▊ | 850/971 [00:15<00:02, 57.64it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 55.78it/s]backtest loop:  89%|████████▉ | 864/971 [00:15<00:01, 57.74it/s]backtest loop:  90%|████████▉ | 871/971 [00:15<00:01, 59.16it/s]backtest loop:  90%|█████████ | 877/971 [00:15<00:01, 56.14it/s]backtest loop:  91%|█████████ | 884/971 [00:15<00:01, 57.98it/s]backtest loop:  92%|█████████▏| 890/971 [00:16<00:01, 57.94it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 56.04it/s]backtest loop:  93%|█████████▎| 904/971 [00:16<00:01, 57.76it/s]backtest loop:  94%|█████████▍| 911/971 [00:16<00:01, 59.09it/s]backtest loop:  94%|█████████▍| 917/971 [00:16<00:00, 56.16it/s]backtest loop:  95%|█████████▌| 924/971 [00:16<00:00, 57.88it/s]backtest loop:  96%|█████████▌| 931/971 [00:16<00:00, 56.11it/s]backtest loop:  97%|█████████▋| 938/971 [00:16<00:00, 57.92it/s]backtest loop:  97%|█████████▋| 945/971 [00:16<00:00, 56.02it/s]backtest loop:  98%|█████████▊| 951/971 [00:17<00:00, 56.83it/s]backtest loop:  99%|█████████▊| 957/971 [00:17<00:00, 57.46it/s]backtest loop:  99%|█████████▉| 963/971 [00:17<00:00, 57.92it/s]backtest loop: 100%|█████████▉| 969/971 [00:17<00:00, 58.45it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.68it/s]
[3046892:MainThread](2024-04-25 03:47:21,233) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000383
std                0.004987
annualized_return  0.091260
information_ratio  1.186194
max_drawdown      -0.087282
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000187
std                0.004989
annualized_return  0.044397
information_ratio  0.576829
max_drawdown      -0.104766
[3046892:MainThread](2024-04-25 03:47:21,246) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `GRU_crowd_data_csi300_360_rankTrue`.
[3046892:MainThread](2024-04-25 03:47:28,106) INFO - qlib.timer - [log.py:127] - Time cost: 0.007s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.04752747527500248,
                                                    0.06753497732457434,
                                                    0.04389698519088239,
                                                    0.08580218014262934,
                                                    0.09345902392943012,
                                                    0.097951390998315,
                                                    0.041568808810134535,
                                                    0.04439714119896197],
 '1day.excess_return_with_cost.information_ratio': [-0.47355908603877145,
                                                    0.940095684943139,
                                                    0.527684838645942,
                                                    1.0475605812703772,
                                                    1.227218033174128,
                                                    1.3049393272943204,
                                                    0.5157774530742688,
                                                    0.5768287256312978],
 '1day.excess_return_with_cost.max_drawdown': [-0.3376746326901112,
                                               -0.08173152645982251,
                                               -0.17276302603976773,
                                               -0.09756583800230148,
                                               -0.0632203399043754,
                                               -0.06248740653818602,
                                               -0.1198327049674568,
                                               -0.10476552975560653],
 'IC': [0.00363443899505527,
        0.02489675590560467,
        0.018902094432700335,
        0.020888639826414604,
        0.024184579544304124,
        0.020154432141670262,
        0.012235740776743175,
        0.010274074412924146],
 'ICIR': [0.021413940843084633,
          0.19480099902991765,
          0.13069641324061324,
          0.15884409057214505,
          0.191989366852175,
          0.14941450844986376,
          0.08617666534890676,
          0.0881459108735743],
 'Rank IC': [0.015102010164117578,
             0.037783709736229354,
             0.029404122617660105,
             0.026423821148463412,
             0.03324991193140413,
             0.03325765963572595,
             0.01903367623117386,
             0.014640904746829154],
 'Rank ICIR': [0.09774431979917947,
               0.3096498421629207,
               0.2002519378681989,
               0.20040688139219454,
               0.26980638508856297,
               0.2564386463960009,
               0.1301164570332772,
               0.1204174396336297],
 'mae': [0.8650185462473066,
         0.8638857495457903,
         0.8643701461289718,
         0.8645102856924792,
         0.8642098388915666,
         0.8640932410861362,
         0.864754724525937,
         0.864854616873327],
 'mse': [0.9983762431278207,
         0.99706359774119,
         0.997759548555407,
         0.9974266902873177,
         0.9974959103471112,
         0.9978944201174561,
         0.9982913445672937,
         0.9976449001674517]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3046892:MainThread](2024-04-25 03:47:31,409) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3046892:MainThread](2024-04-25 03:47:31,410) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3046892:MainThread](2024-04-25 03:47:31,411) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3046892:MainThread](2024-04-25 03:47:31,412) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3046892:MainThread](2024-04-25 03:47:34,469) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name GRU_crowd_data_csi300_360_rankTrue_51.
[3046892:MainThread](2024-04-25 03:47:34,495) INFO - qlib.workflow - [exp.py:258] - Experiment 37 starts running ...
[3046892:MainThread](2024-04-25 03:47:34,508) INFO - qlib.workflow - [recorder.py:341] - Recorder 827146b09790437493e5ff0e6a308076 starts running under Experiment 37 ...
[3046892:MainThread](2024-04-25 03:47:39,570) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3046892:MainThread](2024-04-25 03:47:39,570) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3046892:MainThread](2024-04-25 03:47:39,570) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:47:45,881) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:47:46,057) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999354
[3046892:MainThread](2024-04-25 03:47:46,058) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3046892:MainThread](2024-04-25 03:47:46,058) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:47:52,161) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:47:52,336) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.002654
[3046892:MainThread](2024-04-25 03:47:52,336) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3046892:MainThread](2024-04-25 03:47:52,336) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:47:58,570) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:47:58,745) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999147
[3046892:MainThread](2024-04-25 03:47:58,746) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3046892:MainThread](2024-04-25 03:47:58,747) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:48:05,018) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:48:05,192) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997324
[3046892:MainThread](2024-04-25 03:48:05,194) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3046892:MainThread](2024-04-25 03:48:05,194) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:48:11,466) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:48:11,639) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998359
[3046892:MainThread](2024-04-25 03:48:11,640) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3046892:MainThread](2024-04-25 03:48:11,640) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:48:17,929) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:48:18,103) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998432
[3046892:MainThread](2024-04-25 03:48:18,103) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3046892:MainThread](2024-04-25 03:48:18,104) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:48:24,347) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:48:24,524) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.001750
[3046892:MainThread](2024-04-25 03:48:24,524) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3046892:MainThread](2024-04-25 03:48:24,525) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:48:30,788) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:48:30,962) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998211
[3046892:MainThread](2024-04-25 03:48:30,962) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3046892:MainThread](2024-04-25 03:48:30,962) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:48:37,236) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:48:37,411) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997193
[3046892:MainThread](2024-04-25 03:48:37,412) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3046892:MainThread](2024-04-25 03:48:37,412) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:48:43,660) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:48:43,834) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997544
[3046892:MainThread](2024-04-25 03:48:43,835) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3046892:MainThread](2024-04-25 03:48:43,835) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:48:49,923) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:48:50,098) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998181
[3046892:MainThread](2024-04-25 03:48:50,099) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3046892:MainThread](2024-04-25 03:48:50,099) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:48:56,387) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:48:56,562) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998708
[3046892:MainThread](2024-04-25 03:48:56,562) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3046892:MainThread](2024-04-25 03:48:56,562) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:49:02,827) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:49:03,001) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996288
[3046892:MainThread](2024-04-25 03:49:03,002) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3046892:MainThread](2024-04-25 03:49:03,003) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:49:09,305) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:49:09,482) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996840
[3046892:MainThread](2024-04-25 03:49:09,482) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3046892:MainThread](2024-04-25 03:49:09,482) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:49:15,780) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:49:15,954) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999426
[3046892:MainThread](2024-04-25 03:49:15,954) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3046892:MainThread](2024-04-25 03:49:15,955) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:49:22,107) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:49:22,281) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999914
[3046892:MainThread](2024-04-25 03:49:22,281) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3046892:MainThread](2024-04-25 03:49:22,281) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:49:28,538) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:49:28,715) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000392
[3046892:MainThread](2024-04-25 03:49:28,716) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3046892:MainThread](2024-04-25 03:49:28,716) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:49:35,025) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:49:35,201) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999625
[3046892:MainThread](2024-04-25 03:49:35,201) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3046892:MainThread](2024-04-25 03:49:35,201) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:49:41,552) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:49:41,726) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997261
[3046892:MainThread](2024-04-25 03:49:41,726) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3046892:MainThread](2024-04-25 03:49:41,726) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:49:48,008) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:49:48,183) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.002547
[3046892:MainThread](2024-04-25 03:49:48,184) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3046892:MainThread](2024-04-25 03:49:48,184) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:49:54,478) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:49:54,653) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000863
[3046892:MainThread](2024-04-25 03:49:54,653) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3046892:MainThread](2024-04-25 03:49:54,654) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.996288 @ 12
[3046892:MainThread](2024-04-25 03:49:54,675) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to GRU_crowd_data_csi300_360_rankTrue_51.
[3046892:MainThread](2024-04-25 03:49:54,887) INFO - qlib.workflow - [exp.py:258] - Experiment 29 starts running ...
[3046892:MainThread](2024-04-25 03:49:54,900) INFO - qlib.workflow - [recorder.py:341] - Recorder 179577ab76d94393bfddb4526bccd6fb starts running under Experiment 29 ...
{'IC': 0.022863245520046375,
 'ICIR': 0.19081458907553883,
 'Rank IC': 0.03489093529274627,
 'Rank ICIR': 0.274687562882567}
[3046892:MainThread](2024-04-25 03:50:01,416) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3046892:MainThread](2024-04-25 03:50:39,171) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:50:39,174) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:50:45,156) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f7e0a9bedf0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:38,  9.82it/s]backtest loop:   1%|          | 10/971 [00:00<00:34, 27.88it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:25, 37.03it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:22, 42.36it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:19, 48.31it/s]backtest loop:   4%|▍         | 37/971 [00:00<00:18, 51.34it/s]backtest loop:   4%|▍         | 43/971 [00:00<00:17, 53.70it/s]backtest loop:   5%|▌         | 49/971 [00:01<00:17, 52.25it/s]backtest loop:   6%|▌         | 56/971 [00:01<00:16, 55.43it/s]backtest loop:   6%|▋         | 62/971 [00:01<00:16, 53.76it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:15, 56.54it/s]backtest loop:   8%|▊         | 76/971 [00:01<00:15, 58.56it/s]backtest loop:   8%|▊         | 82/971 [00:01<00:15, 55.98it/s]backtest loop:   9%|▉         | 89/971 [00:01<00:15, 57.99it/s]backtest loop:  10%|▉         | 96/971 [00:01<00:14, 59.65it/s]backtest loop:  11%|█         | 103/971 [00:02<00:15, 57.28it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:14, 58.95it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:15, 56.89it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:14, 58.58it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:15, 55.87it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 54.60it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:14, 57.13it/s]backtest loop:  15%|█▌        | 150/971 [00:02<00:13, 58.89it/s]backtest loop:  16%|█▌        | 156/971 [00:02<00:14, 56.11it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:13, 58.17it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:13, 60.36it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:13, 58.19it/s]backtest loop:  19%|█▉        | 184/971 [00:03<00:13, 59.56it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:13, 56.57it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 58.51it/s]backtest loop:  21%|██        | 204/971 [00:03<00:12, 59.82it/s]backtest loop:  22%|██▏       | 211/971 [00:03<00:13, 57.41it/s]backtest loop:  22%|██▏       | 217/971 [00:04<00:13, 55.29it/s]backtest loop:  23%|██▎       | 224/971 [00:04<00:12, 57.54it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 55.21it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 57.50it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 59.15it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 56.26it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 58.24it/s]backtest loop:  27%|██▋       | 264/971 [00:04<00:12, 56.33it/s]backtest loop:  28%|██▊       | 271/971 [00:04<00:12, 55.03it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:12, 57.44it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:11, 58.81it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 56.19it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 58.15it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:11, 56.20it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 58.15it/s]backtest loop:  33%|███▎      | 319/971 [00:05<00:10, 59.59it/s]backtest loop:  33%|███▎      | 325/971 [00:05<00:11, 56.55it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:10, 58.63it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 60.03it/s]backtest loop:  36%|███▌      | 346/971 [00:06<00:10, 57.77it/s]backtest loop:  36%|███▋      | 353/971 [00:06<00:10, 59.30it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 57.07it/s]backtest loop:  38%|███▊      | 366/971 [00:06<00:10, 57.37it/s]backtest loop:  38%|███▊      | 372/971 [00:06<00:10, 55.03it/s]backtest loop:  39%|███▉      | 378/971 [00:06<00:11, 53.40it/s]backtest loop:  40%|███▉      | 385/971 [00:06<00:10, 56.06it/s]backtest loop:  40%|████      | 391/971 [00:07<00:10, 57.02it/s]backtest loop:  41%|████      | 397/971 [00:07<00:09, 57.84it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 54.86it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:09, 57.18it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 58.78it/s]backtest loop:  44%|████▎     | 423/971 [00:07<00:09, 55.88it/s]backtest loop:  44%|████▍     | 430/971 [00:07<00:09, 57.87it/s]backtest loop:  45%|████▌     | 437/971 [00:07<00:09, 56.02it/s]backtest loop:  46%|████▌     | 444/971 [00:07<00:09, 57.88it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:08, 59.19it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:14, 36.49it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:12, 41.94it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:10, 46.68it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:10, 47.44it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:09, 51.31it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:09, 50.85it/s]backtest loop:  51%|█████     | 497/971 [00:09<00:08, 54.20it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:08, 56.53it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:08, 54.67it/s]backtest loop:  53%|█████▎    | 517/971 [00:09<00:08, 53.91it/s]backtest loop:  54%|█████▍    | 523/971 [00:09<00:08, 55.33it/s]backtest loop:  55%|█████▍    | 530/971 [00:09<00:07, 57.66it/s]backtest loop:  55%|█████▌    | 536/971 [00:09<00:07, 55.16it/s]backtest loop:  56%|█████▌    | 543/971 [00:09<00:07, 57.46it/s]backtest loop:  57%|█████▋    | 550/971 [00:10<00:07, 59.05it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:07, 56.29it/s]backtest loop:  58%|█████▊    | 563/971 [00:10<00:06, 58.41it/s]backtest loop:  59%|█████▊    | 570/971 [00:10<00:06, 59.70it/s]backtest loop:  59%|█████▉    | 576/971 [00:10<00:06, 56.68it/s]backtest loop:  60%|██████    | 583/971 [00:10<00:06, 58.35it/s]backtest loop:  61%|██████    | 590/971 [00:10<00:06, 59.68it/s]backtest loop:  61%|██████▏   | 596/971 [00:10<00:06, 56.59it/s]backtest loop:  62%|██████▏   | 603/971 [00:10<00:06, 58.28it/s]backtest loop:  63%|██████▎   | 610/971 [00:11<00:06, 56.34it/s]backtest loop:  64%|██████▎   | 617/971 [00:11<00:06, 58.24it/s]backtest loop:  64%|██████▍   | 624/971 [00:11<00:05, 59.56it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:06, 56.73it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:05, 58.52it/s]backtest loop:  66%|██████▋   | 644/971 [00:11<00:05, 59.83it/s]backtest loop:  67%|██████▋   | 651/971 [00:11<00:05, 57.33it/s]backtest loop:  68%|██████▊   | 658/971 [00:11<00:05, 58.89it/s]backtest loop:  68%|██████▊   | 665/971 [00:12<00:05, 56.83it/s]backtest loop:  69%|██████▉   | 672/971 [00:12<00:05, 58.51it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 56.59it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:04, 57.45it/s]backtest loop:  71%|███████▏  | 692/971 [00:12<00:04, 58.95it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 56.80it/s]backtest loop:  73%|███████▎  | 706/971 [00:12<00:04, 58.46it/s]backtest loop:  73%|███████▎  | 713/971 [00:12<00:04, 59.60it/s]backtest loop:  74%|███████▍  | 719/971 [00:12<00:04, 56.59it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 58.46it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 55.54it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 53.47it/s]backtest loop:  77%|███████▋  | 744/971 [00:13<00:04, 55.09it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 53.32it/s]backtest loop:  78%|███████▊  | 757/971 [00:13<00:03, 56.05it/s]backtest loop:  79%|███████▊  | 763/971 [00:13<00:03, 57.02it/s]backtest loop:  79%|███████▉  | 770/971 [00:13<00:03, 55.58it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 57.61it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 55.14it/s]backtest loop:  81%|████████▏ | 790/971 [00:14<00:03, 57.35it/s]backtest loop:  82%|████████▏ | 797/971 [00:14<00:02, 59.03it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:02, 56.22it/s]backtest loop:  83%|████████▎ | 810/971 [00:14<00:02, 58.10it/s]backtest loop:  84%|████████▍ | 817/971 [00:14<00:02, 59.43it/s]backtest loop:  85%|████████▍ | 823/971 [00:14<00:02, 56.36it/s]backtest loop:  85%|████████▌ | 830/971 [00:14<00:02, 58.32it/s]backtest loop:  86%|████████▌ | 837/971 [00:15<00:02, 59.56it/s]backtest loop:  87%|████████▋ | 843/971 [00:15<00:02, 56.27it/s]backtest loop:  88%|████████▊ | 850/971 [00:15<00:02, 58.13it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 56.32it/s]backtest loop:  89%|████████▉ | 864/971 [00:15<00:01, 58.15it/s]backtest loop:  90%|████████▉ | 871/971 [00:15<00:01, 59.48it/s]backtest loop:  90%|█████████ | 877/971 [00:15<00:01, 56.45it/s]backtest loop:  91%|█████████ | 884/971 [00:15<00:01, 58.32it/s]backtest loop:  92%|█████████▏| 891/971 [00:15<00:01, 59.63it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 56.55it/s]backtest loop:  93%|█████████▎| 904/971 [00:16<00:01, 58.22it/s]backtest loop:  94%|█████████▍| 911/971 [00:16<00:01, 59.61it/s]backtest loop:  94%|█████████▍| 917/971 [00:16<00:00, 56.62it/s]backtest loop:  95%|█████████▌| 924/971 [00:16<00:00, 58.36it/s]backtest loop:  96%|█████████▌| 931/971 [00:16<00:00, 56.25it/s]backtest loop:  97%|█████████▋| 938/971 [00:16<00:00, 58.06it/s]backtest loop:  97%|█████████▋| 945/971 [00:16<00:00, 56.18it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 58.21it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 59.58it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 56.51it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.91it/s]
[3046892:MainThread](2024-04-25 03:51:02,579) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000520
std                0.004549
annualized_return  0.123760
information_ratio  1.763653
max_drawdown      -0.049148
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000322
std                0.004550
annualized_return  0.076729
information_ratio  1.093063
max_drawdown      -0.060833
[3046892:MainThread](2024-04-25 03:51:02,592) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `GRU_crowd_data_csi300_360_rankTrue`.
[3046892:MainThread](2024-04-25 03:51:09,333) INFO - qlib.timer - [log.py:127] - Time cost: 0.007s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.04752747527500248,
                                                    0.06753497732457434,
                                                    0.04389698519088239,
                                                    0.08580218014262934,
                                                    0.09345902392943012,
                                                    0.097951390998315,
                                                    0.041568808810134535,
                                                    0.04439714119896197,
                                                    0.07672949938517477],
 '1day.excess_return_with_cost.information_ratio': [-0.47355908603877145,
                                                    0.940095684943139,
                                                    0.527684838645942,
                                                    1.0475605812703772,
                                                    1.227218033174128,
                                                    1.3049393272943204,
                                                    0.5157774530742688,
                                                    0.5768287256312978,
                                                    1.0930630597026154],
 '1day.excess_return_with_cost.max_drawdown': [-0.3376746326901112,
                                               -0.08173152645982251,
                                               -0.17276302603976773,
                                               -0.09756583800230148,
                                               -0.0632203399043754,
                                               -0.06248740653818602,
                                               -0.1198327049674568,
                                               -0.10476552975560653,
                                               -0.06083311963245744],
 'IC': [0.00363443899505527,
        0.02489675590560467,
        0.018902094432700335,
        0.020888639826414604,
        0.024184579544304124,
        0.020154432141670262,
        0.012235740776743175,
        0.010274074412924146,
        0.022863245520046375],
 'ICIR': [0.021413940843084633,
          0.19480099902991765,
          0.13069641324061324,
          0.15884409057214505,
          0.191989366852175,
          0.14941450844986376,
          0.08617666534890676,
          0.0881459108735743,
          0.19081458907553883],
 'Rank IC': [0.015102010164117578,
             0.037783709736229354,
             0.029404122617660105,
             0.026423821148463412,
             0.03324991193140413,
             0.03325765963572595,
             0.01903367623117386,
             0.014640904746829154,
             0.03489093529274627],
 'Rank ICIR': [0.09774431979917947,
               0.3096498421629207,
               0.2002519378681989,
               0.20040688139219454,
               0.26980638508856297,
               0.2564386463960009,
               0.1301164570332772,
               0.1204174396336297,
               0.274687562882567],
 'mae': [0.8650185462473066,
         0.8638857495457903,
         0.8643701461289718,
         0.8645102856924792,
         0.8642098388915666,
         0.8640932410861362,
         0.864754724525937,
         0.864854616873327,
         0.8642705093255931],
 'mse': [0.9983762431278207,
         0.99706359774119,
         0.997759548555407,
         0.9974266902873177,
         0.9974959103471112,
         0.9978944201174561,
         0.9982913445672937,
         0.9976449001674517,
         0.9966446076221614]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3046892:MainThread](2024-04-25 03:51:12,608) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3046892:MainThread](2024-04-25 03:51:12,608) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3046892:MainThread](2024-04-25 03:51:12,610) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3046892:MainThread](2024-04-25 03:51:12,610) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3046892:MainThread](2024-04-25 03:51:15,638) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name GRU_crowd_data_csi300_360_rankTrue_52.
[3046892:MainThread](2024-04-25 03:51:15,664) INFO - qlib.workflow - [exp.py:258] - Experiment 38 starts running ...
[3046892:MainThread](2024-04-25 03:51:15,675) INFO - qlib.workflow - [recorder.py:341] - Recorder b1a7e0e5bd874fb3bea1c1131879bdf8 starts running under Experiment 38 ...
[3046892:MainThread](2024-04-25 03:51:20,751) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3046892:MainThread](2024-04-25 03:51:20,752) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3046892:MainThread](2024-04-25 03:51:20,752) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:51:27,062) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:51:27,240) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.003481
[3046892:MainThread](2024-04-25 03:51:27,241) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3046892:MainThread](2024-04-25 03:51:27,241) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:51:33,581) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:51:33,757) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998259
[3046892:MainThread](2024-04-25 03:51:33,758) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3046892:MainThread](2024-04-25 03:51:33,758) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:51:40,097) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:51:40,272) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998791
[3046892:MainThread](2024-04-25 03:51:40,272) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3046892:MainThread](2024-04-25 03:51:40,272) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:51:46,588) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:51:46,762) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997960
[3046892:MainThread](2024-04-25 03:51:46,763) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3046892:MainThread](2024-04-25 03:51:46,764) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:51:53,089) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:51:53,267) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998427
[3046892:MainThread](2024-04-25 03:51:53,267) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3046892:MainThread](2024-04-25 03:51:53,267) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:51:59,564) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:51:59,739) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000420
[3046892:MainThread](2024-04-25 03:51:59,740) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3046892:MainThread](2024-04-25 03:51:59,740) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:52:05,995) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:52:06,170) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997317
[3046892:MainThread](2024-04-25 03:52:06,171) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3046892:MainThread](2024-04-25 03:52:06,171) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:52:12,516) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:52:12,694) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000362
[3046892:MainThread](2024-04-25 03:52:12,694) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3046892:MainThread](2024-04-25 03:52:12,695) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:52:18,984) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:52:19,162) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997401
[3046892:MainThread](2024-04-25 03:52:19,162) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3046892:MainThread](2024-04-25 03:52:19,163) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:52:25,433) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:52:25,611) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.001748
[3046892:MainThread](2024-04-25 03:52:25,611) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3046892:MainThread](2024-04-25 03:52:25,612) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:52:31,899) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:52:32,074) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.003548
[3046892:MainThread](2024-04-25 03:52:32,074) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3046892:MainThread](2024-04-25 03:52:32,075) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:52:38,378) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:52:38,553) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999430
[3046892:MainThread](2024-04-25 03:52:38,553) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3046892:MainThread](2024-04-25 03:52:38,553) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:52:44,765) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:52:44,941) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999892
[3046892:MainThread](2024-04-25 03:52:44,941) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3046892:MainThread](2024-04-25 03:52:44,942) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:52:51,269) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:52:51,444) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.002616
[3046892:MainThread](2024-04-25 03:52:51,444) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3046892:MainThread](2024-04-25 03:52:51,444) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3046892:MainThread](2024-04-25 03:52:57,633) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3046892:MainThread](2024-04-25 03:52:57,809) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.001445
[3046892:MainThread](2024-04-25 03:52:57,809) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3046892:MainThread](2024-04-25 03:52:57,809) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.997317 @ 6
[3046892:MainThread](2024-04-25 03:52:57,830) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to GRU_crowd_data_csi300_360_rankTrue_52.
[3046892:MainThread](2024-04-25 03:52:58,043) INFO - qlib.workflow - [exp.py:258] - Experiment 29 starts running ...
[3046892:MainThread](2024-04-25 03:52:58,056) INFO - qlib.workflow - [recorder.py:341] - Recorder f8554cae89b342c0b07116cfa30a8eb8 starts running under Experiment 29 ...
{'IC': 0.014671980089875756,
 'ICIR': 0.10767672494987088,
 'Rank IC': 0.01718963054698925,
 'Rank ICIR': 0.12448525213609278}
[3046892:MainThread](2024-04-25 03:53:04,565) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3046892:MainThread](2024-04-25 03:53:42,789) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:53:42,792) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3046892:MainThread](2024-04-25 03:53:48,781) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f7e02dcec70>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:38,  9.81it/s]backtest loop:   1%|          | 9/971 [00:00<00:37, 25.77it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:24, 38.32it/s]backtest loop:   2%|▏         | 22/971 [00:00<00:22, 42.08it/s]backtest loop:   3%|▎         | 29/971 [00:00<00:20, 45.78it/s]backtest loop:   4%|▎         | 36/971 [00:00<00:18, 50.94it/s]backtest loop:   4%|▍         | 43/971 [00:00<00:16, 54.69it/s]backtest loop:   5%|▌         | 49/971 [00:01<00:17, 53.11it/s]backtest loop:   6%|▌         | 56/971 [00:01<00:16, 55.92it/s]backtest loop:   6%|▋         | 62/971 [00:01<00:16, 54.20it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:15, 56.96it/s]backtest loop:   8%|▊         | 76/971 [00:01<00:15, 58.86it/s]backtest loop:   8%|▊         | 82/971 [00:01<00:15, 56.17it/s]backtest loop:   9%|▉         | 89/971 [00:01<00:15, 58.20it/s]backtest loop:  10%|▉         | 96/971 [00:01<00:14, 59.64it/s]backtest loop:  11%|█         | 103/971 [00:02<00:15, 57.12it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:14, 58.94it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:15, 56.78it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:14, 58.51it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:15, 56.00it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 54.80it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:14, 57.22it/s]backtest loop:  15%|█▌        | 150/971 [00:02<00:13, 58.80it/s]backtest loop:  16%|█▌        | 156/971 [00:02<00:14, 56.06it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:13, 57.92it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:13, 59.31it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 56.26it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:13, 58.05it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:13, 55.96it/s]backtest loop:  20%|██        | 196/971 [00:03<00:13, 56.94it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 57.09it/s]backtest loop:  22%|██▏       | 209/971 [00:03<00:12, 58.75it/s]backtest loop:  22%|██▏       | 215/971 [00:04<00:14, 52.99it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:13, 55.65it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:12, 57.68it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:13, 55.19it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:12, 57.35it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:12, 56.12it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:12, 58.94it/s]backtest loop:  27%|██▋       | 263/971 [00:04<00:11, 60.01it/s]backtest loop:  28%|██▊       | 270/971 [00:04<00:12, 57.71it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:12, 55.27it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:11, 57.34it/s]backtest loop:  30%|██▉       | 290/971 [00:05<00:11, 58.94it/s]backtest loop:  30%|███       | 296/971 [00:05<00:11, 57.03it/s]backtest loop:  31%|███       | 303/971 [00:05<00:11, 59.14it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:11, 56.94it/s]backtest loop:  33%|███▎      | 317/971 [00:05<00:11, 58.59it/s]backtest loop:  33%|███▎      | 324/971 [00:05<00:10, 59.81it/s]backtest loop:  34%|███▍      | 331/971 [00:06<00:11, 57.23it/s]backtest loop:  35%|███▍      | 338/971 [00:06<00:10, 59.00it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:10, 57.00it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 58.90it/s]backtest loop:  37%|███▋      | 358/971 [00:06<00:15, 39.59it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:14, 41.21it/s]backtest loop:  38%|███▊      | 368/971 [00:06<00:14, 42.39it/s]backtest loop:  39%|███▊      | 375/971 [00:06<00:12, 47.81it/s]backtest loop:  39%|███▉      | 382/971 [00:07<00:11, 51.82it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:11, 51.15it/s]backtest loop:  41%|████      | 395/971 [00:07<00:10, 54.50it/s]backtest loop:  41%|████▏     | 402/971 [00:07<00:09, 57.01it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:10, 55.37it/s]backtest loop:  43%|████▎     | 415/971 [00:07<00:09, 58.03it/s]backtest loop:  43%|████▎     | 422/971 [00:07<00:09, 59.32it/s]backtest loop:  44%|████▍     | 428/971 [00:07<00:09, 56.27it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:09, 58.12it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:09, 56.18it/s]backtest loop:  46%|████▌     | 449/971 [00:08<00:08, 58.05it/s]backtest loop:  47%|████▋     | 456/971 [00:08<00:08, 59.34it/s]backtest loop:  48%|████▊     | 462/971 [00:08<00:09, 56.32it/s]backtest loop:  48%|████▊     | 469/971 [00:08<00:08, 58.15it/s]backtest loop:  49%|████▉     | 476/971 [00:08<00:08, 59.50it/s]backtest loop:  50%|████▉     | 482/971 [00:08<00:08, 56.47it/s]backtest loop:  50%|█████     | 489/971 [00:08<00:08, 58.19it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:08, 55.42it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:08, 57.52it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:08, 55.10it/s]backtest loop:  53%|█████▎    | 515/971 [00:09<00:07, 57.57it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:08, 56.05it/s]backtest loop:  54%|█████▍    | 529/971 [00:09<00:07, 57.80it/s]backtest loop:  55%|█████▌    | 536/971 [00:09<00:07, 56.03it/s]backtest loop:  56%|█████▌    | 543/971 [00:09<00:07, 57.99it/s]backtest loop:  57%|█████▋    | 550/971 [00:10<00:07, 59.50it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:07, 56.46it/s]backtest loop:  58%|█████▊    | 563/971 [00:10<00:07, 58.27it/s]backtest loop:  59%|█████▊    | 570/971 [00:10<00:06, 59.60it/s]backtest loop:  59%|█████▉    | 576/971 [00:10<00:07, 55.86it/s]backtest loop:  60%|██████    | 583/971 [00:10<00:06, 57.98it/s]backtest loop:  61%|██████    | 590/971 [00:10<00:06, 59.45it/s]backtest loop:  61%|██████▏   | 596/971 [00:10<00:06, 56.51it/s]backtest loop:  62%|██████▏   | 603/971 [00:10<00:06, 58.29it/s]backtest loop:  63%|██████▎   | 610/971 [00:11<00:06, 56.32it/s]backtest loop:  64%|██████▎   | 617/971 [00:11<00:06, 58.36it/s]backtest loop:  64%|██████▍   | 624/971 [00:11<00:05, 59.61it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:06, 56.58it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:05, 58.40it/s]backtest loop:  66%|██████▋   | 644/971 [00:11<00:05, 59.71it/s]backtest loop:  67%|██████▋   | 650/971 [00:11<00:05, 56.59it/s]backtest loop:  68%|██████▊   | 656/971 [00:11<00:05, 57.16it/s]backtest loop:  68%|██████▊   | 663/971 [00:11<00:05, 58.82it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 56.63it/s]backtest loop:  70%|██████▉   | 677/971 [00:12<00:05, 58.32it/s]backtest loop:  70%|███████   | 683/971 [00:12<00:04, 58.70it/s]backtest loop:  71%|███████   | 689/971 [00:12<00:05, 55.84it/s]backtest loop:  72%|███████▏  | 696/971 [00:12<00:04, 57.85it/s]backtest loop:  72%|███████▏  | 703/971 [00:12<00:04, 59.38it/s]backtest loop:  73%|███████▎  | 709/971 [00:12<00:04, 56.32it/s]backtest loop:  74%|███████▎  | 716/971 [00:12<00:04, 58.18it/s]backtest loop:  74%|███████▍  | 723/971 [00:12<00:04, 59.64it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 56.64it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 54.28it/s]backtest loop:  76%|███████▋  | 742/971 [00:13<00:04, 56.70it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.31it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 53.70it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 56.38it/s]backtest loop:  79%|███████▉  | 769/971 [00:13<00:03, 58.17it/s]backtest loop:  80%|███████▉  | 775/971 [00:13<00:03, 55.64it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 57.87it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 55.31it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.41it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 58.90it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 56.01it/s]backtest loop:  84%|████████▍ | 814/971 [00:14<00:02, 57.03it/s]backtest loop:  85%|████████▍ | 821/971 [00:14<00:02, 58.65it/s]backtest loop:  85%|████████▌ | 828/971 [00:14<00:02, 56.63it/s]backtest loop:  86%|████████▌ | 835/971 [00:14<00:02, 58.36it/s]backtest loop:  87%|████████▋ | 842/971 [00:15<00:02, 59.61it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 56.50it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:01, 58.28it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 56.31it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 58.09it/s]backtest loop:  90%|█████████ | 876/971 [00:15<00:01, 59.33it/s]backtest loop:  91%|█████████ | 882/971 [00:15<00:01, 56.17it/s]backtest loop:  91%|█████████▏| 888/971 [00:15<00:01, 57.13it/s]backtest loop:  92%|█████████▏| 894/971 [00:16<00:01, 57.73it/s]backtest loop:  93%|█████████▎| 900/971 [00:16<00:01, 57.93it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 55.93it/s]backtest loop:  94%|█████████▍| 914/971 [00:16<00:00, 57.90it/s]backtest loop:  95%|█████████▍| 921/971 [00:16<00:00, 56.04it/s]backtest loop:  96%|█████████▌| 928/971 [00:16<00:00, 57.94it/s]backtest loop:  96%|█████████▋| 935/971 [00:16<00:00, 59.27it/s]backtest loop:  97%|█████████▋| 941/971 [00:16<00:00, 56.27it/s]backtest loop:  98%|█████████▊| 948/971 [00:16<00:00, 58.19it/s]backtest loop:  98%|█████████▊| 955/971 [00:17<00:00, 56.20it/s]backtest loop:  99%|█████████▉| 962/971 [00:17<00:00, 58.02it/s]backtest loop: 100%|█████████▉| 969/971 [00:17<00:00, 59.33it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.98it/s]
[3046892:MainThread](2024-04-25 03:54:06,186) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000565
std                0.006062
annualized_return  0.134550
information_ratio  1.438685
max_drawdown      -0.162621
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000365
std                0.006063
annualized_return  0.086753
information_ratio  0.927498
max_drawdown      -0.174557
[3046892:MainThread](2024-04-25 03:54:06,198) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 29
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `GRU_crowd_data_csi300_360_rankTrue`.
[3046892:MainThread](2024-04-25 03:54:12,950) INFO - qlib.timer - [log.py:127] - Time cost: 0.003s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [-0.04752747527500248,
                                                    0.06753497732457434,
                                                    0.04389698519088239,
                                                    0.08580218014262934,
                                                    0.09345902392943012,
                                                    0.097951390998315,
                                                    0.041568808810134535,
                                                    0.04439714119896197,
                                                    0.07672949938517477,
                                                    0.08675260239141591],
 '1day.excess_return_with_cost.information_ratio': [-0.47355908603877145,
                                                    0.940095684943139,
                                                    0.527684838645942,
                                                    1.0475605812703772,
                                                    1.227218033174128,
                                                    1.3049393272943204,
                                                    0.5157774530742688,
                                                    0.5768287256312978,
                                                    1.0930630597026154,
                                                    0.9274984049640311],
 '1day.excess_return_with_cost.max_drawdown': [-0.3376746326901112,
                                               -0.08173152645982251,
                                               -0.17276302603976773,
                                               -0.09756583800230148,
                                               -0.0632203399043754,
                                               -0.06248740653818602,
                                               -0.1198327049674568,
                                               -0.10476552975560653,
                                               -0.06083311963245744,
                                               -0.17455671786881338],
 'IC': [0.00363443899505527,
        0.02489675590560467,
        0.018902094432700335,
        0.020888639826414604,
        0.024184579544304124,
        0.020154432141670262,
        0.012235740776743175,
        0.010274074412924146,
        0.022863245520046375,
        0.014671980089875756],
 'ICIR': [0.021413940843084633,
          0.19480099902991765,
          0.13069641324061324,
          0.15884409057214505,
          0.191989366852175,
          0.14941450844986376,
          0.08617666534890676,
          0.0881459108735743,
          0.19081458907553883,
          0.10767672494987088],
 'Rank IC': [0.015102010164117578,
             0.037783709736229354,
             0.029404122617660105,
             0.026423821148463412,
             0.03324991193140413,
             0.03325765963572595,
             0.01903367623117386,
             0.014640904746829154,
             0.03489093529274627,
             0.01718963054698925],
 'Rank ICIR': [0.09774431979917947,
               0.3096498421629207,
               0.2002519378681989,
               0.20040688139219454,
               0.26980638508856297,
               0.2564386463960009,
               0.1301164570332772,
               0.1204174396336297,
               0.274687562882567,
               0.12448525213609278],
 'mae': [0.8650185462473066,
         0.8638857495457903,
         0.8643701461289718,
         0.8645102856924792,
         0.8642098388915666,
         0.8640932410861362,
         0.864754724525937,
         0.864854616873327,
         0.8642705093255931,
         0.864851031895898],
 'mse': [0.9983762431278207,
         0.99706359774119,
         0.997759548555407,
         0.9974266902873177,
         0.9974959103471112,
         0.9978944201174561,
         0.9982913445672937,
         0.9976449001674517,
         0.9966446076221614,
         0.9979601983284243]}
[3046892:MainThread](2024-04-25 03:54:13,154) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name final_crowd_data_csi300_360_1_GRU.
[3046892:MainThread](2024-04-25 03:54:13,182) INFO - qlib.workflow - [exp.py:258] - Experiment 39 starts running ...
[3046892:MainThread](2024-04-25 03:54:13,196) INFO - qlib.workflow - [recorder.py:341] - Recorder e753bba8263f432abf72af4ee7b7c068 starts running under Experiment 39 ...
Time cost: 257.075802063942
{'1day.excess_return_with_cost.annualized_return': [0.05905651340965159,
                                                    0.0408333711512327],
 '1day.excess_return_with_cost.information_ratio': [0.7687107022661348,
                                                    0.4937043426768261],
 '1day.excess_return_with_cost.max_drawdown': [-0.12754308418588983,
                                               0.08050209289857391],
 'IC': [0.017270598164533867, 0.006544512320394711],
 'ICIR': [0.131997320923569, 0.053731994559239354],
 'Rank IC': [0.026097638205133906, 0.008418783992263156],
 'Rank ICIR': [0.19840047243926243, 0.07280797418768653],
 'mae': [0.8644818690213004, 0.00035721809667090047],
 'mse': [0.9976557460861635, 0.0005034585526296337]}
[3046892:MainThread](2024-04-25 03:54:13,991) INFO - qlib.timer - [log.py:127] - Time cost: 0.025s | waiting `async_log` Done

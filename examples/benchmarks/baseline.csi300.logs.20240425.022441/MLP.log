[3036190:MainThread](2024-04-25 02:43:06,362) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[3036190:MainThread](2024-04-25 02:43:06,364) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[3036190:MainThread](2024-04-25 02:43:06,365) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/crowd_data')}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
[3036190:MainThread](2024-04-25 02:49:46,111) INFO - qlib.timer - [log.py:127] - Time cost: 399.710s | Loading data Done
[3036190:MainThread](2024-04-25 02:52:33,728) INFO - qlib.timer - [log.py:127] - Time cost: 164.788s | RobustZScoreNorm Done
[3036190:MainThread](2024-04-25 02:52:36,697) INFO - qlib.timer - [log.py:127] - Time cost: 2.968s | Fillna Done
[3036190:MainThread](2024-04-25 02:52:38,354) INFO - qlib.timer - [log.py:127] - Time cost: 0.911s | DropnaLabel Done
/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/data/dataset/processor.py:370: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df[cols] = t
[3036190:MainThread](2024-04-25 02:52:39,470) INFO - qlib.timer - [log.py:127] - Time cost: 1.116s | CSRankNorm Done
[3036190:MainThread](2024-04-25 02:52:39,475) INFO - qlib.timer - [log.py:127] - Time cost: 173.363s | fit & process data Done
[3036190:MainThread](2024-04-25 02:52:39,475) INFO - qlib.timer - [log.py:127] - Time cost: 573.074s | Init data Done
Save handler file to /home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3036190:MainThread](2024-04-25 02:52:50,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3036190:MainThread](2024-04-25 02:52:50,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.01
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3036190:MainThread](2024-04-25 02:52:50,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3036190:MainThread](2024-04-25 02:52:50,555) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
[3036190:MainThread](2024-04-25 02:53:16,958) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name MLP_crowd_data_csi300_360_rankTrue_43.
[3036190:MainThread](2024-04-25 02:53:16,968) INFO - qlib.workflow - [exp.py:258] - Experiment 16 starts running ...
[3036190:MainThread](2024-04-25 02:53:18,282) INFO - qlib.workflow - [recorder.py:341] - Recorder 8582de9cc1734098a4499b21f799a844 starts running under Experiment 16 ...
[3036190:MainThread](2024-04-25 02:53:25,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[3036190:MainThread](2024-04-25 02:53:27,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.804935, valid_loss 1.155576, train_metric nan, valid_metric -0.015135
[3036190:MainThread](2024-04-25 02:53:27,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.155576, save checkpoint.
[3036190:MainThread](2024-04-25 02:53:27,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.062732, valid_loss 1.003756, train_metric nan, valid_metric -0.006376
[3036190:MainThread](2024-04-25 02:53:27,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.155576 to 1.003756, save checkpoint.
[3036190:MainThread](2024-04-25 02:53:27,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.028058, valid_loss 1.000442, train_metric nan, valid_metric 0.017950
[3036190:MainThread](2024-04-25 02:53:27,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003756 to 1.000442, save checkpoint.
[3036190:MainThread](2024-04-25 02:53:27,508) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.021949, valid_loss 1.000137, train_metric nan, valid_metric 0.020394
[3036190:MainThread](2024-04-25 02:53:27,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000442 to 1.000137, save checkpoint.
[3036190:MainThread](2024-04-25 02:53:27,696) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.017875, valid_loss 0.999988, train_metric nan, valid_metric 0.006974
[3036190:MainThread](2024-04-25 02:53:27,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000137 to 0.999988, save checkpoint.
[3036190:MainThread](2024-04-25 02:53:27,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.013832, valid_loss 0.998797, train_metric nan, valid_metric 0.021328
[3036190:MainThread](2024-04-25 02:53:27,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999988 to 0.998797, save checkpoint.
[3036190:MainThread](2024-04-25 02:53:28,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.007650, valid_loss 1.002527, train_metric nan, valid_metric 0.023767
[3036190:MainThread](2024-04-25 02:53:28,278) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.010771, valid_loss 0.998449, train_metric nan, valid_metric 0.015601
[3036190:MainThread](2024-04-25 02:53:28,278) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998797 to 0.998449, save checkpoint.
[3036190:MainThread](2024-04-25 02:53:28,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.012358, valid_loss 1.005149, train_metric nan, valid_metric -0.010238
[3036190:MainThread](2024-04-25 02:53:28,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.016187, valid_loss 1.004346, train_metric nan, valid_metric 0.026974
[3036190:MainThread](2024-04-25 02:53:28,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.007171, valid_loss 1.012028, train_metric nan, valid_metric 0.024449
[3036190:MainThread](2024-04-25 02:53:28,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.005386, valid_loss 0.998573, train_metric nan, valid_metric 0.024781
[3036190:MainThread](2024-04-25 02:53:29,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.008399, valid_loss 0.999747, train_metric nan, valid_metric 0.007229
[3036190:MainThread](2024-04-25 02:53:29,250) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.003729, valid_loss 1.000535, train_metric nan, valid_metric 0.001800
[3036190:MainThread](2024-04-25 02:53:29,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.005966, valid_loss 0.998418, train_metric nan, valid_metric 0.024306
[3036190:MainThread](2024-04-25 02:53:29,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998449 to 0.998418, save checkpoint.
[3036190:MainThread](2024-04-25 02:53:29,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.999516, valid_loss 0.999732, train_metric nan, valid_metric 0.014552
[3036190:MainThread](2024-04-25 02:53:29,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.002850, valid_loss 1.001357, train_metric nan, valid_metric 0.024793
[3036190:MainThread](2024-04-25 02:53:29,856) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.002282, valid_loss 1.005939, train_metric nan, valid_metric 0.030630
[3036190:MainThread](2024-04-25 02:53:30,015) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.002268, valid_loss 1.003672, train_metric nan, valid_metric 0.001553
[3036190:MainThread](2024-04-25 02:53:30,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.002379, valid_loss 0.999152, train_metric nan, valid_metric 0.022508
[3036190:MainThread](2024-04-25 02:53:30,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.009295, valid_loss 1.020276, train_metric nan, valid_metric 0.028186
[3036190:MainThread](2024-04-25 02:53:30,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.004080, valid_loss 1.005239, train_metric nan, valid_metric -0.008724
[3036190:MainThread](2024-04-25 02:53:30,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.001709, valid_loss 0.998595, train_metric nan, valid_metric 0.021611
[3036190:MainThread](2024-04-25 02:53:30,770) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.996786, valid_loss 0.998285, train_metric nan, valid_metric 0.026078
[3036190:MainThread](2024-04-25 02:53:30,771) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998418 to 0.998285, save checkpoint.
[3036190:MainThread](2024-04-25 02:53:30,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.000894, valid_loss 0.999897, train_metric nan, valid_metric 0.028250
[3036190:MainThread](2024-04-25 02:53:31,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.996927, valid_loss 1.001977, train_metric nan, valid_metric 0.007748
[3036190:MainThread](2024-04-25 02:53:31,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.987438, valid_loss 0.998777, train_metric nan, valid_metric 0.023305
[3036190:MainThread](2024-04-25 02:53:31,375) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.001978, valid_loss 0.999875, train_metric nan, valid_metric 0.032299
[3036190:MainThread](2024-04-25 02:53:31,524) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.995522, valid_loss 0.998780, train_metric nan, valid_metric 0.023218
[3036190:MainThread](2024-04-25 02:53:31,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.993498, valid_loss 0.999342, train_metric nan, valid_metric 0.019928
[3036190:MainThread](2024-04-25 02:53:31,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.997741, valid_loss 0.998294, train_metric nan, valid_metric 0.022784
[3036190:MainThread](2024-04-25 02:53:31,973) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.997941, valid_loss 0.999591, train_metric nan, valid_metric 0.018797
[3036190:MainThread](2024-04-25 02:53:32,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.999895, valid_loss 1.019699, train_metric nan, valid_metric 0.027350
[3036190:MainThread](2024-04-25 02:53:32,307) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.993998, valid_loss 1.001738, train_metric nan, valid_metric 0.005803
[3036190:MainThread](2024-04-25 02:53:32,494) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.999471, valid_loss 0.999306, train_metric nan, valid_metric 0.013849
[3036190:MainThread](2024-04-25 02:53:32,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.992667, valid_loss 1.002348, train_metric nan, valid_metric 0.032510
[3036190:MainThread](2024-04-25 02:53:32,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.999602, valid_loss 0.998620, train_metric nan, valid_metric 0.020814
[3036190:MainThread](2024-04-25 02:53:32,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.993770, valid_loss 0.999849, train_metric nan, valid_metric 0.014442
[3036190:MainThread](2024-04-25 02:53:33,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.991913, valid_loss 0.998587, train_metric nan, valid_metric 0.026539
[3036190:MainThread](2024-04-25 02:53:33,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.991827, valid_loss 0.996962, train_metric nan, valid_metric 0.031626
[3036190:MainThread](2024-04-25 02:53:33,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998285 to 0.996962, save checkpoint.
[3036190:MainThread](2024-04-25 02:53:33,440) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.992210, valid_loss 1.003733, train_metric nan, valid_metric 0.008169
[3036190:MainThread](2024-04-25 02:53:33,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.000125, valid_loss 1.001236, train_metric nan, valid_metric 0.010895
[3036190:MainThread](2024-04-25 02:53:33,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 1.001327, valid_loss 0.997830, train_metric nan, valid_metric 0.028224
[3036190:MainThread](2024-04-25 02:53:33,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.990288, valid_loss 0.999789, train_metric nan, valid_metric 0.031206
[3036190:MainThread](2024-04-25 02:53:34,050) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.996628, valid_loss 1.004151, train_metric nan, valid_metric 0.033689
[3036190:MainThread](2024-04-25 02:53:34,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.993767, valid_loss 1.001690, train_metric nan, valid_metric 0.014584
[3036190:MainThread](2024-04-25 02:53:34,427) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.997584, valid_loss 1.011645, train_metric nan, valid_metric 0.029783
[3036190:MainThread](2024-04-25 02:53:34,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.004662, valid_loss 0.998481, train_metric nan, valid_metric 0.027261
[3036190:MainThread](2024-04-25 02:53:34,770) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.990781, valid_loss 0.998364, train_metric nan, valid_metric 0.028001
[3036190:MainThread](2024-04-25 02:53:34,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.997105, valid_loss 1.005595, train_metric nan, valid_metric 0.026429
[3036190:MainThread](2024-04-25 02:53:35,142) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.993688, valid_loss 0.998862, train_metric nan, valid_metric 0.023651
[3036190:MainThread](2024-04-25 02:53:35,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.994701, valid_loss 1.004054, train_metric nan, valid_metric 0.010388
[3036190:MainThread](2024-04-25 02:53:35,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.006950, valid_loss 0.999505, train_metric nan, valid_metric 0.021946
[3036190:MainThread](2024-04-25 02:53:35,591) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.998633, valid_loss 0.998628, train_metric nan, valid_metric 0.022649
[3036190:MainThread](2024-04-25 02:53:35,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.993197, valid_loss 1.000096, train_metric nan, valid_metric 0.016179
[3036190:MainThread](2024-04-25 02:53:35,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.993317, valid_loss 1.005403, train_metric nan, valid_metric 0.029325
[3036190:MainThread](2024-04-25 02:53:36,037) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.993415, valid_loss 1.005186, train_metric nan, valid_metric 0.027993
[3036190:MainThread](2024-04-25 02:53:36,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.992647, valid_loss 1.000649, train_metric nan, valid_metric 0.031009
[3036190:MainThread](2024-04-25 02:53:36,335) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.998259, valid_loss 1.000009, train_metric nan, valid_metric 0.031972
[3036190:MainThread](2024-04-25 02:53:36,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.991394, valid_loss 0.999090, train_metric nan, valid_metric 0.026485
[3036190:MainThread](2024-04-25 02:53:36,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.993209, valid_loss 0.998567, train_metric nan, valid_metric 0.029104
[3036190:MainThread](2024-04-25 02:53:36,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.993192, valid_loss 0.998275, train_metric nan, valid_metric 0.027115
[3036190:MainThread](2024-04-25 02:53:36,935) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.989883, valid_loss 1.000239, train_metric nan, valid_metric 0.031303
[3036190:MainThread](2024-04-25 02:53:37,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.991283, valid_loss 0.998582, train_metric nan, valid_metric 0.034200
[3036190:MainThread](2024-04-25 02:53:37,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.991362, valid_loss 0.999978, train_metric nan, valid_metric 0.031023
[3036190:MainThread](2024-04-25 02:53:37,417) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.994872, valid_loss 1.005657, train_metric nan, valid_metric 0.005973
[3036190:MainThread](2024-04-25 02:53:37,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.992529, valid_loss 1.000861, train_metric nan, valid_metric 0.029880
[3036190:MainThread](2024-04-25 02:53:37,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.998174, valid_loss 1.002691, train_metric nan, valid_metric 0.009681
[3036190:MainThread](2024-04-25 02:53:37,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.994824, valid_loss 0.999221, train_metric nan, valid_metric 0.025011
[3036190:MainThread](2024-04-25 02:53:38,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.991391, valid_loss 1.002595, train_metric nan, valid_metric 0.030917
[3036190:MainThread](2024-04-25 02:53:38,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.997117, valid_loss 1.000513, train_metric nan, valid_metric 0.028918
[3036190:MainThread](2024-04-25 02:53:38,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.998609, valid_loss 1.000032, train_metric nan, valid_metric 0.021998
[3036190:MainThread](2024-04-25 02:53:38,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.993394, valid_loss 1.001578, train_metric nan, valid_metric 0.029927
[3036190:MainThread](2024-04-25 02:53:38,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.999407, valid_loss 1.006162, train_metric nan, valid_metric 0.012591
[3036190:MainThread](2024-04-25 02:53:38,983) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.994805, valid_loss 0.998292, train_metric nan, valid_metric 0.025935
[3036190:MainThread](2024-04-25 02:53:39,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.994155, valid_loss 0.999456, train_metric nan, valid_metric 0.020814
[3036190:MainThread](2024-04-25 02:53:39,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.997077, valid_loss 1.003458, train_metric nan, valid_metric 0.031348
[3036190:MainThread](2024-04-25 02:53:39,568) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 1.001112, valid_loss 0.999057, train_metric nan, valid_metric 0.026568
[3036190:MainThread](2024-04-25 02:53:39,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.990725, valid_loss 0.998693, train_metric nan, valid_metric 0.026723
[3036190:MainThread](2024-04-25 02:53:39,960) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.993827, valid_loss 0.998258, train_metric nan, valid_metric 0.029565
[3036190:MainThread](2024-04-25 02:53:40,153) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.997063, valid_loss 0.998610, train_metric nan, valid_metric 0.028597
[3036190:MainThread](2024-04-25 02:53:40,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.990707, valid_loss 0.999226, train_metric nan, valid_metric 0.020915
[3036190:MainThread](2024-04-25 02:53:40,515) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.994621, valid_loss 1.002674, train_metric nan, valid_metric 0.028904
[3036190:MainThread](2024-04-25 02:53:40,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.987618, valid_loss 0.998603, train_metric nan, valid_metric 0.031969
[3036190:MainThread](2024-04-25 02:53:40,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.991955, valid_loss 0.998738, train_metric nan, valid_metric 0.030291
[3036190:MainThread](2024-04-25 02:53:41,004) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.995175, valid_loss 0.999917, train_metric nan, valid_metric 0.029250
[3036190:MainThread](2024-04-25 02:53:41,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.989233, valid_loss 1.015110, train_metric nan, valid_metric 0.029080
[3036190:MainThread](2024-04-25 02:53:41,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.991809, valid_loss 0.999002, train_metric nan, valid_metric 0.028814
[3036190:MainThread](2024-04-25 02:53:41,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.994182, valid_loss 1.004354, train_metric nan, valid_metric 0.029619
[3036190:MainThread](2024-04-25 02:53:41,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.989763, valid_loss 1.003951, train_metric nan, valid_metric 0.033395
[3036190:MainThread](2024-04-25 02:53:41,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[3036190:MainThread](2024-04-25 02:53:41,672) INFO - qlib.timer - [log.py:127] - Time cost: 0.001s | waiting `async_log` Done
Save pretrained model to MLP_crowd_data_csi300_360_rankTrue_43.
[3036190:MainThread](2024-04-25 02:53:41,890) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name MLP_crowd_data_csi300_360_rankTrue.
[3036190:MainThread](2024-04-25 02:53:41,901) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3036190:MainThread](2024-04-25 02:53:41,911) INFO - qlib.workflow - [recorder.py:341] - Recorder 5c38c46272e54960abcd43f5edc7cb14 starts running under Experiment 17 ...
{'IC': 0.022102653552402936,
 'ICIR': 0.13898491673495106,
 'Rank IC': 0.025665075667307198,
 'Rank ICIR': 0.16136503534804983}
[3036190:MainThread](2024-04-25 02:53:47,727) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3036190:MainThread](2024-04-25 02:54:23,046) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 02:54:23,049) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 02:54:29,177) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fc5126ef250>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 5/971 [00:00<00:19, 49.57it/s]backtest loop:   1%|          | 12/971 [00:00<00:18, 51.23it/s]backtest loop:   2%|▏         | 19/971 [00:00<00:16, 56.03it/s]backtest loop:   3%|▎         | 25/971 [00:00<00:29, 32.05it/s]backtest loop:   3%|▎         | 32/971 [00:00<00:23, 39.38it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:21, 43.20it/s]backtest loop:   5%|▍         | 46/971 [00:01<00:19, 48.30it/s]backtest loop:   5%|▌         | 53/971 [00:01<00:17, 52.10it/s]backtest loop:   6%|▌         | 59/971 [00:01<00:17, 51.32it/s]backtest loop:   7%|▋         | 66/971 [00:01<00:16, 54.73it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 53.63it/s]backtest loop:   8%|▊         | 79/971 [00:01<00:15, 56.39it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:15, 58.64it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:15, 56.28it/s]backtest loop:  10%|█         | 99/971 [00:01<00:14, 58.15it/s]backtest loop:  11%|█         | 106/971 [00:02<00:14, 59.57it/s]backtest loop:  12%|█▏        | 113/971 [00:02<00:15, 57.04it/s]backtest loop:  12%|█▏        | 120/971 [00:02<00:14, 58.55it/s]backtest loop:  13%|█▎        | 126/971 [00:02<00:15, 53.05it/s]backtest loop:  14%|█▎        | 133/971 [00:02<00:15, 55.63it/s]backtest loop:  14%|█▍        | 140/971 [00:02<00:14, 57.94it/s]backtest loop:  15%|█▌        | 146/971 [00:02<00:14, 55.31it/s]backtest loop:  16%|█▌        | 153/971 [00:02<00:14, 56.82it/s]backtest loop:  16%|█▋        | 159/971 [00:02<00:14, 57.67it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:13, 58.27it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:14, 55.46it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:13, 57.47it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:14, 55.82it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:13, 57.62it/s]backtest loop:  20%|██        | 198/971 [00:03<00:13, 58.18it/s]backtest loop:  21%|██        | 204/971 [00:03<00:13, 58.52it/s]backtest loop:  22%|██▏       | 210/971 [00:03<00:13, 56.08it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 54.42it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:13, 56.94it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 55.32it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 57.24it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 58.77it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 55.74it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 57.88it/s]backtest loop:  27%|██▋       | 264/971 [00:04<00:12, 56.35it/s]backtest loop:  28%|██▊       | 271/971 [00:04<00:12, 55.30it/s]backtest loop:  29%|██▊       | 277/971 [00:05<00:12, 56.49it/s]backtest loop:  29%|██▉       | 284/971 [00:05<00:11, 58.15it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 55.79it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 57.86it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:11, 55.97it/s]backtest loop:  32%|███▏      | 311/971 [00:05<00:11, 56.97it/s]backtest loop:  33%|███▎      | 318/971 [00:05<00:11, 58.56it/s]backtest loop:  33%|███▎      | 325/971 [00:05<00:11, 56.57it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:10, 58.25it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 59.40it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 56.21it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 58.29it/s]backtest loop:  37%|███▋      | 359/971 [00:06<00:10, 59.82it/s]backtest loop:  38%|███▊      | 366/971 [00:06<00:10, 57.97it/s]backtest loop:  38%|███▊      | 372/971 [00:06<00:10, 55.49it/s]backtest loop:  39%|███▉      | 378/971 [00:06<00:11, 53.90it/s]backtest loop:  40%|███▉      | 384/971 [00:06<00:10, 55.32it/s]backtest loop:  40%|████      | 391/971 [00:07<00:10, 57.69it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 55.86it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 57.81it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:09, 59.27it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:09, 56.43it/s]backtest loop:  44%|████▍     | 425/971 [00:07<00:09, 58.16it/s]backtest loop:  44%|████▍     | 431/971 [00:07<00:09, 58.10it/s]backtest loop:  45%|████▌     | 437/971 [00:07<00:09, 55.36it/s]backtest loop:  46%|████▌     | 444/971 [00:07<00:09, 57.54it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:08, 59.00it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:09, 56.05it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:08, 57.87it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:08, 59.14it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:08, 56.40it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:08, 58.14it/s]backtest loop:  50%|█████     | 490/971 [00:08<00:08, 55.55it/s]backtest loop:  51%|█████     | 497/971 [00:08<00:08, 57.56it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:07, 59.27it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:08, 56.32it/s]backtest loop:  53%|█████▎    | 517/971 [00:09<00:08, 55.20it/s]backtest loop:  54%|█████▍    | 524/971 [00:09<00:07, 57.29it/s]backtest loop:  55%|█████▍    | 531/971 [00:09<00:07, 56.08it/s]backtest loop:  55%|█████▌    | 538/971 [00:09<00:07, 58.02it/s]backtest loop:  56%|█████▌    | 545/971 [00:09<00:07, 59.44it/s]backtest loop:  57%|█████▋    | 551/971 [00:09<00:07, 56.46it/s]backtest loop:  57%|█████▋    | 558/971 [00:09<00:07, 58.20it/s]backtest loop:  58%|█████▊    | 565/971 [00:10<00:06, 59.42it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 56.34it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:06, 58.09it/s]backtest loop:  60%|██████    | 585/971 [00:10<00:06, 59.55it/s]backtest loop:  61%|██████    | 591/971 [00:10<00:06, 56.50it/s]backtest loop:  62%|██████▏   | 598/971 [00:10<00:06, 58.15it/s]backtest loop:  62%|██████▏   | 605/971 [00:10<00:06, 56.28it/s]backtest loop:  63%|██████▎   | 612/971 [00:10<00:06, 58.02it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:05, 59.34it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 56.45it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 58.15it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 59.84it/s]backtest loop:  67%|██████▋   | 646/971 [00:11<00:05, 57.38it/s]backtest loop:  67%|██████▋   | 653/971 [00:11<00:05, 58.81it/s]backtest loop:  68%|██████▊   | 660/971 [00:11<00:05, 56.76it/s]backtest loop:  69%|██████▊   | 667/971 [00:11<00:05, 58.29it/s]backtest loop:  69%|██████▉   | 674/971 [00:11<00:05, 56.35it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:04, 58.06it/s]backtest loop:  71%|███████   | 687/971 [00:12<00:05, 56.14it/s]backtest loop:  71%|███████▏  | 693/971 [00:12<00:04, 55.76it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:05, 52.30it/s]backtest loop:  73%|███████▎  | 705/971 [00:12<00:05, 52.98it/s]backtest loop:  73%|███████▎  | 711/971 [00:12<00:04, 53.60it/s]backtest loop:  74%|███████▍  | 717/971 [00:12<00:04, 54.19it/s]backtest loop:  74%|███████▍  | 723/971 [00:12<00:04, 54.46it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 51.43it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 49.50it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 50.98it/s]backtest loop:  77%|███████▋  | 747/971 [00:13<00:04, 52.07it/s]backtest loop:  78%|███████▊  | 753/971 [00:13<00:04, 49.80it/s]backtest loop:  78%|███████▊  | 759/971 [00:13<00:04, 51.22it/s]backtest loop:  79%|███████▉  | 765/971 [00:13<00:04, 49.30it/s]backtest loop:  79%|███████▉  | 771/971 [00:13<00:03, 50.85it/s]backtest loop:  80%|████████  | 777/971 [00:13<00:03, 51.99it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 49.79it/s]backtest loop:  81%|████████▏ | 789/971 [00:14<00:03, 51.18it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 52.12it/s]backtest loop:  82%|████████▏ | 801/971 [00:14<00:03, 52.90it/s]backtest loop:  83%|████████▎ | 807/971 [00:14<00:03, 53.50it/s]backtest loop:  84%|████████▎ | 813/971 [00:14<00:03, 50.72it/s]backtest loop:  84%|████████▍ | 819/971 [00:14<00:02, 51.91it/s]backtest loop:  85%|████████▍ | 825/971 [00:14<00:02, 52.74it/s]backtest loop:  86%|████████▌ | 831/971 [00:15<00:02, 53.37it/s]backtest loop:  86%|████████▌ | 837/971 [00:15<00:02, 53.79it/s]backtest loop:  87%|████████▋ | 843/971 [00:15<00:02, 50.90it/s]backtest loop:  87%|████████▋ | 849/971 [00:15<00:02, 52.01it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:02, 52.76it/s]backtest loop:  89%|████████▊ | 861/971 [00:15<00:02, 53.29it/s]backtest loop:  89%|████████▉ | 867/971 [00:15<00:02, 50.52it/s]backtest loop:  90%|████████▉ | 873/971 [00:15<00:01, 51.81it/s]backtest loop:  91%|█████████ | 879/971 [00:15<00:01, 52.74it/s]backtest loop:  91%|█████████ | 885/971 [00:16<00:01, 53.41it/s]backtest loop:  92%|█████████▏| 891/971 [00:16<00:01, 53.86it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 51.02it/s]backtest loop:  93%|█████████▎| 903/971 [00:16<00:01, 52.09it/s]backtest loop:  94%|█████████▎| 909/971 [00:16<00:01, 52.89it/s]backtest loop:  94%|█████████▍| 915/971 [00:16<00:01, 53.53it/s]backtest loop:  95%|█████████▍| 921/971 [00:16<00:00, 50.66it/s]backtest loop:  95%|█████████▌| 927/971 [00:16<00:00, 51.84it/s]backtest loop:  96%|█████████▌| 933/971 [00:16<00:00, 52.69it/s]backtest loop:  97%|█████████▋| 939/971 [00:17<00:00, 53.27it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 50.67it/s]backtest loop:  98%|█████████▊| 951/971 [00:17<00:00, 51.86it/s]backtest loop:  99%|█████████▊| 957/971 [00:17<00:00, 52.72it/s]backtest loop:  99%|█████████▉| 963/971 [00:17<00:00, 53.39it/s]backtest loop: 100%|█████████▉| 969/971 [00:17<00:00, 54.03it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.90it/s]
[3036190:MainThread](2024-04-25 02:54:46,927) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000608
std                0.006284
annualized_return  0.144714
information_ratio  1.492691
max_drawdown      -0.149065
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000406
std                0.006284
annualized_return  0.096609
information_ratio  0.996533
max_drawdown      -0.178626
[3036190:MainThread](2024-04-25 02:54:46,942) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `MLP_crowd_data_csi300_360_rankTrue`.
[3036190:MainThread](2024-04-25 02:55:11,932) INFO - qlib.timer - [log.py:127] - Time cost: 0.002s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.09660888993280313],
 '1day.excess_return_with_cost.information_ratio': [0.9965334629357873],
 '1day.excess_return_with_cost.max_drawdown': [-0.178625820283921],
 'IC': [0.022102653552402936],
 'ICIR': [0.13898491673495106],
 'Rank IC': [0.025665075667307198],
 'Rank ICIR': [0.16136503534804983],
 'mae': [0.8644317750225282],
 'mse': [0.9972685662584836]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3036190:MainThread](2024-04-25 02:55:14,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3036190:MainThread](2024-04-25 02:55:14,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.01
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3036190:MainThread](2024-04-25 02:55:14,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3036190:MainThread](2024-04-25 02:55:14,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
[3036190:MainThread](2024-04-25 02:55:17,717) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name MLP_crowd_data_csi300_360_rankTrue_44.
[3036190:MainThread](2024-04-25 02:55:17,729) INFO - qlib.workflow - [exp.py:258] - Experiment 18 starts running ...
[3036190:MainThread](2024-04-25 02:55:17,738) INFO - qlib.workflow - [recorder.py:341] - Recorder f945f094f398462f902bf0a077aca03d starts running under Experiment 18 ...
[3036190:MainThread](2024-04-25 02:55:24,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[3036190:MainThread](2024-04-25 02:55:25,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 9.077090, valid_loss 1.767287, train_metric nan, valid_metric 0.023472
[3036190:MainThread](2024-04-25 02:55:25,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.767287, save checkpoint.
[3036190:MainThread](2024-04-25 02:55:25,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.135554, valid_loss 1.004004, train_metric nan, valid_metric -0.011185
[3036190:MainThread](2024-04-25 02:55:25,366) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.767287 to 1.004004, save checkpoint.
[3036190:MainThread](2024-04-25 02:55:25,526) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.022120, valid_loss 1.002288, train_metric nan, valid_metric 0.000558
[3036190:MainThread](2024-04-25 02:55:25,527) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.004004 to 1.002288, save checkpoint.
[3036190:MainThread](2024-04-25 02:55:25,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.019307, valid_loss 0.999494, train_metric nan, valid_metric 0.008514
[3036190:MainThread](2024-04-25 02:55:25,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.002288 to 0.999494, save checkpoint.
[3036190:MainThread](2024-04-25 02:55:25,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.010122, valid_loss 0.999456, train_metric nan, valid_metric 0.011976
[3036190:MainThread](2024-04-25 02:55:25,830) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999494 to 0.999456, save checkpoint.
[3036190:MainThread](2024-04-25 02:55:26,017) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.009815, valid_loss 0.999294, train_metric nan, valid_metric 0.017570
[3036190:MainThread](2024-04-25 02:55:26,018) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999456 to 0.999294, save checkpoint.
[3036190:MainThread](2024-04-25 02:55:26,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.017607, valid_loss 0.998835, train_metric nan, valid_metric 0.016198
[3036190:MainThread](2024-04-25 02:55:26,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999294 to 0.998835, save checkpoint.
[3036190:MainThread](2024-04-25 02:55:26,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.009583, valid_loss 0.999945, train_metric nan, valid_metric 0.011669
[3036190:MainThread](2024-04-25 02:55:26,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.006481, valid_loss 0.999847, train_metric nan, valid_metric 0.008000
[3036190:MainThread](2024-04-25 02:55:26,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.009776, valid_loss 1.001128, train_metric nan, valid_metric 0.020789
[3036190:MainThread](2024-04-25 02:55:26,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.017697, valid_loss 0.998499, train_metric nan, valid_metric 0.022266
[3036190:MainThread](2024-04-25 02:55:26,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998835 to 0.998499, save checkpoint.
[3036190:MainThread](2024-04-25 02:55:26,983) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.007975, valid_loss 0.999414, train_metric nan, valid_metric 0.018306
[3036190:MainThread](2024-04-25 02:55:27,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.009361, valid_loss 0.998693, train_metric nan, valid_metric 0.025897
[3036190:MainThread](2024-04-25 02:55:27,289) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.012898, valid_loss 0.998981, train_metric nan, valid_metric 0.017673
[3036190:MainThread](2024-04-25 02:55:27,444) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.011113, valid_loss 0.998759, train_metric nan, valid_metric 0.016188
[3036190:MainThread](2024-04-25 02:55:27,629) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.009314, valid_loss 0.999685, train_metric nan, valid_metric 0.021867
[3036190:MainThread](2024-04-25 02:55:27,818) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.010110, valid_loss 0.999098, train_metric nan, valid_metric 0.024756
[3036190:MainThread](2024-04-25 02:55:28,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.001066, valid_loss 0.999025, train_metric nan, valid_metric 0.016779
[3036190:MainThread](2024-04-25 02:55:28,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.009770, valid_loss 0.998931, train_metric nan, valid_metric 0.021801
[3036190:MainThread](2024-04-25 02:55:28,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.000863, valid_loss 0.999332, train_metric nan, valid_metric 0.024358
[3036190:MainThread](2024-04-25 02:55:28,578) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.007882, valid_loss 0.999391, train_metric nan, valid_metric 0.010497
[3036190:MainThread](2024-04-25 02:55:28,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.001304, valid_loss 1.000970, train_metric nan, valid_metric 0.025278
[3036190:MainThread](2024-04-25 02:55:28,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.000419, valid_loss 0.998405, train_metric nan, valid_metric 0.021684
[3036190:MainThread](2024-04-25 02:55:28,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998499 to 0.998405, save checkpoint.
[3036190:MainThread](2024-04-25 02:55:29,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.003694, valid_loss 0.998393, train_metric nan, valid_metric 0.022346
[3036190:MainThread](2024-04-25 02:55:29,153) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998405 to 0.998393, save checkpoint.
[3036190:MainThread](2024-04-25 02:55:29,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.000453, valid_loss 0.998883, train_metric nan, valid_metric 0.019215
[3036190:MainThread](2024-04-25 02:55:29,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.000771, valid_loss 0.998919, train_metric nan, valid_metric 0.021203
[3036190:MainThread](2024-04-25 02:55:29,659) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.001920, valid_loss 0.998426, train_metric nan, valid_metric 0.022472
[3036190:MainThread](2024-04-25 02:55:29,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.001265, valid_loss 1.001087, train_metric nan, valid_metric 0.024915
[3036190:MainThread](2024-04-25 02:55:30,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.004559, valid_loss 0.998787, train_metric nan, valid_metric 0.023809
[3036190:MainThread](2024-04-25 02:55:30,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.998356, valid_loss 0.999015, train_metric nan, valid_metric 0.022708
[3036190:MainThread](2024-04-25 02:55:30,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.998672, valid_loss 0.999535, train_metric nan, valid_metric 0.028022
[3036190:MainThread](2024-04-25 02:55:30,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.998230, valid_loss 0.998462, train_metric nan, valid_metric 0.028434
[3036190:MainThread](2024-04-25 02:55:30,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.993265, valid_loss 0.998589, train_metric nan, valid_metric 0.016821
[3036190:MainThread](2024-04-25 02:55:30,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.998954, valid_loss 0.998501, train_metric nan, valid_metric 0.022191
[3036190:MainThread](2024-04-25 02:55:31,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.995048, valid_loss 0.998276, train_metric nan, valid_metric 0.027323
[3036190:MainThread](2024-04-25 02:55:31,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998393 to 0.998276, save checkpoint.
[3036190:MainThread](2024-04-25 02:55:31,304) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.997801, valid_loss 0.998510, train_metric nan, valid_metric 0.018536
[3036190:MainThread](2024-04-25 02:55:31,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.996178, valid_loss 0.998739, train_metric nan, valid_metric 0.021845
[3036190:MainThread](2024-04-25 02:55:31,611) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.003347, valid_loss 0.998131, train_metric nan, valid_metric 0.028424
[3036190:MainThread](2024-04-25 02:55:31,611) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998276 to 0.998131, save checkpoint.
[3036190:MainThread](2024-04-25 02:55:31,767) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.000815, valid_loss 0.999466, train_metric nan, valid_metric 0.020385
[3036190:MainThread](2024-04-25 02:55:31,920) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.996253, valid_loss 0.999147, train_metric nan, valid_metric 0.028926
[3036190:MainThread](2024-04-25 02:55:32,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.994596, valid_loss 0.998686, train_metric nan, valid_metric 0.021708
[3036190:MainThread](2024-04-25 02:55:32,229) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.993767, valid_loss 0.999549, train_metric nan, valid_metric 0.027835
[3036190:MainThread](2024-04-25 02:55:32,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.995554, valid_loss 0.998400, train_metric nan, valid_metric 0.027988
[3036190:MainThread](2024-04-25 02:55:32,538) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.992847, valid_loss 0.998507, train_metric nan, valid_metric 0.018154
[3036190:MainThread](2024-04-25 02:55:32,691) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.995567, valid_loss 0.999723, train_metric nan, valid_metric 0.018316
[3036190:MainThread](2024-04-25 02:55:32,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.994394, valid_loss 0.998599, train_metric nan, valid_metric 0.026020
[3036190:MainThread](2024-04-25 02:55:32,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.992122, valid_loss 0.999176, train_metric nan, valid_metric 0.027076
[3036190:MainThread](2024-04-25 02:55:33,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.992807, valid_loss 0.998911, train_metric nan, valid_metric 0.017275
[3036190:MainThread](2024-04-25 02:55:33,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.992300, valid_loss 0.998447, train_metric nan, valid_metric 0.030032
[3036190:MainThread](2024-04-25 02:55:33,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.995903, valid_loss 0.999984, train_metric nan, valid_metric 0.030186
[3036190:MainThread](2024-04-25 02:55:33,607) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.996793, valid_loss 0.998764, train_metric nan, valid_metric 0.029328
[3036190:MainThread](2024-04-25 02:55:33,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.998681, valid_loss 1.000440, train_metric nan, valid_metric 0.028891
[3036190:MainThread](2024-04-25 02:55:33,914) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.995569, valid_loss 0.999310, train_metric nan, valid_metric 0.032747
[3036190:MainThread](2024-04-25 02:55:34,066) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.993668, valid_loss 0.999450, train_metric nan, valid_metric 0.020251
[3036190:MainThread](2024-04-25 02:55:34,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.998239, valid_loss 0.998553, train_metric nan, valid_metric 0.029005
[3036190:MainThread](2024-04-25 02:55:34,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.992061, valid_loss 0.998380, train_metric nan, valid_metric 0.032143
[3036190:MainThread](2024-04-25 02:55:34,526) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.994181, valid_loss 1.002593, train_metric nan, valid_metric 0.033476
[3036190:MainThread](2024-04-25 02:55:34,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.993481, valid_loss 0.998080, train_metric nan, valid_metric 0.028677
[3036190:MainThread](2024-04-25 02:55:34,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998131 to 0.998080, save checkpoint.
[3036190:MainThread](2024-04-25 02:55:34,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.988687, valid_loss 0.998045, train_metric nan, valid_metric 0.030873
[3036190:MainThread](2024-04-25 02:55:34,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998080 to 0.998045, save checkpoint.
[3036190:MainThread](2024-04-25 02:55:35,031) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 1.000819, valid_loss 1.002763, train_metric nan, valid_metric 0.031686
[3036190:MainThread](2024-04-25 02:55:35,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.997438, valid_loss 0.997187, train_metric nan, valid_metric 0.037708
[3036190:MainThread](2024-04-25 02:55:35,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998045 to 0.997187, save checkpoint.
[3036190:MainThread](2024-04-25 02:55:35,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.994163, valid_loss 0.999981, train_metric nan, valid_metric 0.033884
[3036190:MainThread](2024-04-25 02:55:35,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.990632, valid_loss 0.998922, train_metric nan, valid_metric 0.027917
[3036190:MainThread](2024-04-25 02:55:35,784) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.997472, valid_loss 0.997938, train_metric nan, valid_metric 0.028040
[3036190:MainThread](2024-04-25 02:55:35,972) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.991197, valid_loss 1.000372, train_metric nan, valid_metric 0.027246
[3036190:MainThread](2024-04-25 02:55:36,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.994424, valid_loss 0.997849, train_metric nan, valid_metric 0.030234
[3036190:MainThread](2024-04-25 02:55:36,349) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.992934, valid_loss 0.999235, train_metric nan, valid_metric 0.026253
[3036190:MainThread](2024-04-25 02:55:36,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.987762, valid_loss 0.998539, train_metric nan, valid_metric 0.027287
[3036190:MainThread](2024-04-25 02:55:36,702) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.997858, valid_loss 0.999553, train_metric nan, valid_metric 0.029988
[3036190:MainThread](2024-04-25 02:55:36,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.997023, valid_loss 0.998341, train_metric nan, valid_metric 0.027011
[3036190:MainThread](2024-04-25 02:55:37,008) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.994314, valid_loss 1.000411, train_metric nan, valid_metric 0.032314
[3036190:MainThread](2024-04-25 02:55:37,192) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.994762, valid_loss 0.998545, train_metric nan, valid_metric 0.029687
[3036190:MainThread](2024-04-25 02:55:37,354) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 1.002012, valid_loss 0.998662, train_metric nan, valid_metric 0.026803
[3036190:MainThread](2024-04-25 02:55:37,507) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.995053, valid_loss 1.000246, train_metric nan, valid_metric 0.035294
[3036190:MainThread](2024-04-25 02:55:37,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.996550, valid_loss 0.998760, train_metric nan, valid_metric 0.031606
[3036190:MainThread](2024-04-25 02:55:37,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.991563, valid_loss 0.998230, train_metric nan, valid_metric 0.031891
[3036190:MainThread](2024-04-25 02:55:38,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.998580, valid_loss 0.999289, train_metric nan, valid_metric 0.025333
[3036190:MainThread](2024-04-25 02:55:38,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.993373, valid_loss 0.998193, train_metric nan, valid_metric 0.031620
[3036190:MainThread](2024-04-25 02:55:38,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.993328, valid_loss 0.999255, train_metric nan, valid_metric 0.018662
[3036190:MainThread](2024-04-25 02:55:38,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.989568, valid_loss 1.000044, train_metric nan, valid_metric 0.011608
[3036190:MainThread](2024-04-25 02:55:38,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.991710, valid_loss 0.998947, train_metric nan, valid_metric 0.028836
[3036190:MainThread](2024-04-25 02:55:38,980) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.992085, valid_loss 0.999858, train_metric nan, valid_metric 0.029876
[3036190:MainThread](2024-04-25 02:55:39,167) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.990576, valid_loss 0.998408, train_metric nan, valid_metric 0.033181
[3036190:MainThread](2024-04-25 02:55:39,356) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.996258, valid_loss 0.997651, train_metric nan, valid_metric 0.032138
[3036190:MainThread](2024-04-25 02:55:39,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.991916, valid_loss 1.005996, train_metric nan, valid_metric 0.002145
[3036190:MainThread](2024-04-25 02:55:39,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.989356, valid_loss 1.001227, train_metric nan, valid_metric 0.031235
[3036190:MainThread](2024-04-25 02:55:39,839) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.988549, valid_loss 0.998447, train_metric nan, valid_metric 0.029624
[3036190:MainThread](2024-04-25 02:55:39,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.992322, valid_loss 1.000025, train_metric nan, valid_metric 0.032161
[3036190:MainThread](2024-04-25 02:55:40,149) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.990811, valid_loss 0.998256, train_metric nan, valid_metric 0.034038
[3036190:MainThread](2024-04-25 02:55:40,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.991471, valid_loss 0.998433, train_metric nan, valid_metric 0.029934
[3036190:MainThread](2024-04-25 02:55:40,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.989456, valid_loss 1.000644, train_metric nan, valid_metric 0.032493
[3036190:MainThread](2024-04-25 02:55:40,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.987361, valid_loss 1.004440, train_metric nan, valid_metric 0.029682
[3036190:MainThread](2024-04-25 02:55:40,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.990629, valid_loss 0.999653, train_metric nan, valid_metric 0.032153
[3036190:MainThread](2024-04-25 02:55:40,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.991125, valid_loss 0.999019, train_metric nan, valid_metric 0.032059
[3036190:MainThread](2024-04-25 02:55:41,053) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.988784, valid_loss 0.999800, train_metric nan, valid_metric 0.035130
[3036190:MainThread](2024-04-25 02:55:41,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.990339, valid_loss 0.998503, train_metric nan, valid_metric 0.030648
[3036190:MainThread](2024-04-25 02:55:41,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.986423, valid_loss 0.999572, train_metric nan, valid_metric 0.031415
[3036190:MainThread](2024-04-25 02:55:41,607) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.991825, valid_loss 1.001086, train_metric nan, valid_metric 0.031075
[3036190:MainThread](2024-04-25 02:55:41,770) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.988552, valid_loss 1.001068, train_metric nan, valid_metric 0.022437
[3036190:MainThread](2024-04-25 02:55:41,955) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.996194, valid_loss 1.000787, train_metric nan, valid_metric 0.024910
[3036190:MainThread](2024-04-25 02:55:42,142) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.995720, valid_loss 0.997634, train_metric nan, valid_metric 0.031951
[3036190:MainThread](2024-04-25 02:55:42,328) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.995312, valid_loss 0.997678, train_metric nan, valid_metric 0.035341
[3036190:MainThread](2024-04-25 02:55:42,515) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.990576, valid_loss 0.998842, train_metric nan, valid_metric 0.037075
[3036190:MainThread](2024-04-25 02:55:42,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.992339, valid_loss 0.999962, train_metric nan, valid_metric 0.033806
[3036190:MainThread](2024-04-25 02:55:42,887) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.989701, valid_loss 0.998470, train_metric nan, valid_metric 0.034119
[3036190:MainThread](2024-04-25 02:55:43,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 0.988336, valid_loss 1.000827, train_metric nan, valid_metric 0.024289
[3036190:MainThread](2024-04-25 02:55:43,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.992991, valid_loss 0.999634, train_metric nan, valid_metric 0.031225
[3036190:MainThread](2024-04-25 02:55:43,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 0.992366, valid_loss 0.998465, train_metric nan, valid_metric 0.028257
[3036190:MainThread](2024-04-25 02:55:43,496) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 0.987761, valid_loss 0.997630, train_metric nan, valid_metric 0.031539
[3036190:MainThread](2024-04-25 02:55:43,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 0.989118, valid_loss 0.999256, train_metric nan, valid_metric 0.032113
[3036190:MainThread](2024-04-25 02:55:43,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 0.994421, valid_loss 0.998537, train_metric nan, valid_metric 0.033391
[3036190:MainThread](2024-04-25 02:55:43,799) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[3036190:MainThread](2024-04-25 02:55:43,815) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to MLP_crowd_data_csi300_360_rankTrue_44.
[3036190:MainThread](2024-04-25 02:55:44,017) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3036190:MainThread](2024-04-25 02:55:44,028) INFO - qlib.workflow - [recorder.py:341] - Recorder 57359581647b4985a39e92804372b03e starts running under Experiment 17 ...
{'IC': 0.02409782375001873,
 'ICIR': 0.15607704167026837,
 'Rank IC': 0.03148333316577824,
 'Rank ICIR': 0.21059379399912298}
[3036190:MainThread](2024-04-25 02:55:50,097) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3036190:MainThread](2024-04-25 02:56:26,651) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 02:56:26,654) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 02:56:32,649) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fc44df4f460>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:41,  9.56it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.34it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 34.13it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 38.21it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 43.32it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 46.69it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 46.29it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:18, 48.90it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 50.66it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 48.89it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 50.72it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 52.24it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 53.23it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 53.98it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 51.16it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 52.41it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 53.14it/s]backtest loop:  11%|█         | 105/971 [00:02<00:16, 53.64it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:15, 54.10it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 51.25it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 52.30it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:16, 49.94it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:16, 51.36it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:16, 49.38it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:16, 50.91it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 51.98it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 52.96it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:15, 53.34it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 50.64it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:15, 51.85it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 52.77it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:14, 53.46it/s]backtest loop:  20%|██        | 195/971 [00:04<00:15, 50.68it/s]backtest loop:  21%|██        | 201/971 [00:04<00:14, 52.09it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:14, 52.92it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:14, 50.79it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:14, 52.21it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:14, 50.08it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:14, 51.63it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:13, 52.73it/s]backtest loop:  25%|██▌       | 243/971 [00:04<00:13, 53.44it/s]backtest loop:  26%|██▌       | 249/971 [00:05<00:14, 50.64it/s]backtest loop:  26%|██▋       | 255/971 [00:05<00:13, 51.96it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:13, 52.89it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:13, 50.52it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:13, 51.99it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:13, 52.95it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:12, 53.49it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:13, 50.75it/s]backtest loop:  31%|███       | 297/971 [00:05<00:12, 52.00it/s]backtest loop:  31%|███       | 303/971 [00:06<00:12, 52.88it/s]backtest loop:  32%|███▏      | 309/971 [00:06<00:12, 53.54it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:12, 50.79it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:12, 51.99it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:12, 52.72it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:11, 53.62it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:11, 54.23it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:12, 51.11it/s]backtest loop:  36%|███▌      | 351/971 [00:06<00:11, 52.36it/s]backtest loop:  37%|███▋      | 357/971 [00:07<00:11, 53.24it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:11, 51.01it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:12, 49.25it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 50.88it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:11, 52.08it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:11, 52.97it/s]backtest loop:  40%|████      | 393/971 [00:07<00:11, 50.45it/s]backtest loop:  41%|████      | 399/971 [00:07<00:11, 51.71it/s]backtest loop:  42%|████▏     | 405/971 [00:08<00:10, 52.77it/s]backtest loop:  42%|████▏     | 411/971 [00:08<00:10, 53.17it/s]backtest loop:  43%|████▎     | 417/971 [00:08<00:15, 35.76it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:14, 38.18it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:12, 41.98it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:11, 45.18it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:11, 47.71it/s]backtest loop:  46%|████▌     | 447/971 [00:09<00:11, 46.94it/s]backtest loop:  47%|████▋     | 453/971 [00:09<00:10, 49.07it/s]backtest loop:  47%|████▋     | 459/971 [00:09<00:10, 50.67it/s]backtest loop:  48%|████▊     | 465/971 [00:09<00:09, 51.89it/s]backtest loop:  49%|████▊     | 471/971 [00:09<00:09, 52.76it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 50.73it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:09, 51.84it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:09, 52.71it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:09, 50.21it/s]backtest loop:  52%|█████▏    | 501/971 [00:10<00:09, 51.57it/s]backtest loop:  52%|█████▏    | 507/971 [00:10<00:09, 49.77it/s]backtest loop:  53%|█████▎    | 513/971 [00:10<00:08, 51.21it/s]backtest loop:  53%|█████▎    | 519/971 [00:10<00:08, 52.41it/s]backtest loop:  54%|█████▍    | 525/971 [00:10<00:08, 53.11it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 50.64it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:08, 51.85it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:08, 52.79it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 53.33it/s]backtest loop:  57%|█████▋    | 555/971 [00:11<00:07, 53.82it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:08, 50.81it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:07, 52.01it/s]backtest loop:  59%|█████▉    | 573/971 [00:11<00:07, 52.88it/s]backtest loop:  60%|█████▉    | 579/971 [00:11<00:07, 53.47it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:07, 54.33it/s]backtest loop:  61%|██████    | 591/971 [00:11<00:07, 51.27it/s]backtest loop:  61%|██████▏   | 597/971 [00:11<00:07, 52.41it/s]backtest loop:  62%|██████▏   | 603/971 [00:12<00:06, 53.15it/s]backtest loop:  63%|██████▎   | 609/971 [00:12<00:06, 53.69it/s]backtest loop:  63%|██████▎   | 615/971 [00:12<00:06, 51.10it/s]backtest loop:  64%|██████▍   | 621/971 [00:12<00:06, 52.18it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:06, 53.17it/s]backtest loop:  65%|██████▌   | 633/971 [00:12<00:06, 53.63it/s]backtest loop:  66%|██████▌   | 639/971 [00:12<00:06, 54.05it/s]backtest loop:  66%|██████▋   | 645/971 [00:12<00:06, 50.96it/s]backtest loop:  67%|██████▋   | 651/971 [00:12<00:06, 52.07it/s]backtest loop:  68%|██████▊   | 657/971 [00:13<00:05, 52.88it/s]backtest loop:  68%|██████▊   | 663/971 [00:13<00:05, 52.78it/s]backtest loop:  69%|██████▉   | 670/971 [00:13<00:05, 52.60it/s]backtest loop:  70%|██████▉   | 676/971 [00:13<00:05, 54.53it/s]backtest loop:  70%|███████   | 683/971 [00:13<00:05, 56.71it/s]backtest loop:  71%|███████   | 689/971 [00:13<00:05, 54.47it/s]backtest loop:  72%|███████▏  | 696/971 [00:13<00:04, 56.73it/s]backtest loop:  72%|███████▏  | 703/971 [00:13<00:04, 58.46it/s]backtest loop:  73%|███████▎  | 709/971 [00:13<00:04, 55.66it/s]backtest loop:  74%|███████▎  | 716/971 [00:14<00:04, 57.79it/s]backtest loop:  74%|███████▍  | 723/971 [00:14<00:04, 59.22it/s]backtest loop:  75%|███████▌  | 729/971 [00:14<00:04, 56.19it/s]backtest loop:  76%|███████▌  | 735/971 [00:14<00:04, 54.23it/s]backtest loop:  76%|███████▋  | 742/971 [00:14<00:04, 56.59it/s]backtest loop:  77%|███████▋  | 748/971 [00:14<00:04, 54.37it/s]backtest loop:  78%|███████▊  | 755/971 [00:14<00:04, 53.63it/s]backtest loop:  78%|███████▊  | 762/971 [00:14<00:03, 56.12it/s]backtest loop:  79%|███████▉  | 769/971 [00:15<00:03, 57.85it/s]backtest loop:  80%|███████▉  | 775/971 [00:15<00:03, 55.47it/s]backtest loop:  81%|████████  | 782/971 [00:15<00:03, 57.66it/s]backtest loop:  81%|████████  | 788/971 [00:15<00:03, 55.14it/s]backtest loop:  82%|████████▏ | 795/971 [00:15<00:03, 57.20it/s]backtest loop:  83%|████████▎ | 802/971 [00:15<00:02, 58.75it/s]backtest loop:  83%|████████▎ | 808/971 [00:15<00:02, 55.71it/s]backtest loop:  84%|████████▍ | 814/971 [00:15<00:02, 56.86it/s]backtest loop:  85%|████████▍ | 821/971 [00:15<00:02, 58.46it/s]backtest loop:  85%|████████▌ | 828/971 [00:16<00:02, 56.27it/s]backtest loop:  86%|████████▌ | 835/971 [00:16<00:02, 57.93it/s]backtest loop:  87%|████████▋ | 842/971 [00:16<00:02, 59.14it/s]backtest loop:  87%|████████▋ | 848/971 [00:16<00:02, 56.10it/s]backtest loop:  88%|████████▊ | 855/971 [00:16<00:02, 57.90it/s]backtest loop:  89%|████████▉ | 862/971 [00:16<00:01, 56.11it/s]backtest loop:  89%|████████▉ | 869/971 [00:16<00:01, 58.02it/s]backtest loop:  90%|█████████ | 876/971 [00:16<00:01, 59.57it/s]backtest loop:  91%|█████████ | 882/971 [00:17<00:01, 56.58it/s]backtest loop:  92%|█████████▏| 889/971 [00:17<00:01, 58.20it/s]backtest loop:  92%|█████████▏| 896/971 [00:17<00:01, 59.42it/s]backtest loop:  93%|█████████▎| 902/971 [00:17<00:01, 55.90it/s]backtest loop:  94%|█████████▎| 909/971 [00:17<00:01, 57.71it/s]backtest loop:  94%|█████████▍| 916/971 [00:17<00:00, 55.91it/s]backtest loop:  95%|█████████▌| 923/971 [00:17<00:00, 57.69it/s]backtest loop:  96%|█████████▌| 930/971 [00:17<00:00, 59.04it/s]backtest loop:  96%|█████████▋| 936/971 [00:17<00:00, 55.86it/s]backtest loop:  97%|█████████▋| 943/971 [00:18<00:00, 57.69it/s]backtest loop:  98%|█████████▊| 950/971 [00:18<00:00, 56.06it/s]backtest loop:  99%|█████████▊| 957/971 [00:18<00:00, 57.92it/s]backtest loop:  99%|█████████▉| 964/971 [00:18<00:00, 59.18it/s]backtest loop: 100%|█████████▉| 970/971 [00:18<00:00, 56.17it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 52.35it/s]
[3036190:MainThread](2024-04-25 02:56:51,254) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000770
std                0.005974
annualized_return  0.183150
information_ratio  1.987342
max_drawdown      -0.120512
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000570
std                0.005974
annualized_return  0.135624
information_ratio  1.471462
max_drawdown      -0.127577
[3036190:MainThread](2024-04-25 02:56:51,267) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `MLP_crowd_data_csi300_360_rankTrue`.
[3036190:MainThread](2024-04-25 02:56:57,821) INFO - qlib.timer - [log.py:127] - Time cost: 0.003s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.09660888993280313,
                                                    0.13562370991980652],
 '1day.excess_return_with_cost.information_ratio': [0.9965334629357873,
                                                    1.471462498466688],
 '1day.excess_return_with_cost.max_drawdown': [-0.178625820283921,
                                               -0.12757703738688353],
 'IC': [0.022102653552402936, 0.02409782375001873],
 'ICIR': [0.13898491673495106, 0.15607704167026837],
 'Rank IC': [0.025665075667307198, 0.03148333316577824],
 'Rank ICIR': [0.16136503534804983, 0.21059379399912298],
 'mae': [0.8644317750225282, 0.8642435379012978],
 'mse': [0.9972685662584836, 0.9972602008572546]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3036190:MainThread](2024-04-25 02:57:00,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3036190:MainThread](2024-04-25 02:57:00,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.01
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3036190:MainThread](2024-04-25 02:57:00,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3036190:MainThread](2024-04-25 02:57:00,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
[3036190:MainThread](2024-04-25 02:57:03,590) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name MLP_crowd_data_csi300_360_rankTrue_45.
[3036190:MainThread](2024-04-25 02:57:03,602) INFO - qlib.workflow - [exp.py:258] - Experiment 19 starts running ...
[3036190:MainThread](2024-04-25 02:57:03,613) INFO - qlib.workflow - [recorder.py:341] - Recorder 0f870c27ce5245a19bb423f7f81c3b5c starts running under Experiment 19 ...
[3036190:MainThread](2024-04-25 02:57:10,743) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[3036190:MainThread](2024-04-25 02:57:11,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 5.088297, valid_loss 1.239663, train_metric nan, valid_metric -0.011211
[3036190:MainThread](2024-04-25 02:57:11,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.239663, save checkpoint.
[3036190:MainThread](2024-04-25 02:57:11,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.083097, valid_loss 1.027279, train_metric nan, valid_metric -0.028073
[3036190:MainThread](2024-04-25 02:57:11,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.239663 to 1.027279, save checkpoint.
[3036190:MainThread](2024-04-25 02:57:11,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.026431, valid_loss 0.999013, train_metric nan, valid_metric 0.023685
[3036190:MainThread](2024-04-25 02:57:11,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.027279 to 0.999013, save checkpoint.
[3036190:MainThread](2024-04-25 02:57:11,591) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.019432, valid_loss 1.000764, train_metric nan, valid_metric 0.023838
[3036190:MainThread](2024-04-25 02:57:11,757) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.021038, valid_loss 1.001762, train_metric nan, valid_metric 0.024476
[3036190:MainThread](2024-04-25 02:57:11,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.016466, valid_loss 0.999533, train_metric nan, valid_metric 0.025176
[3036190:MainThread](2024-04-25 02:57:12,086) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.016151, valid_loss 0.999781, train_metric nan, valid_metric 0.007374
[3036190:MainThread](2024-04-25 02:57:12,238) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.011408, valid_loss 0.999385, train_metric nan, valid_metric 0.013770
[3036190:MainThread](2024-04-25 02:57:12,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.007301, valid_loss 0.998306, train_metric nan, valid_metric 0.016400
[3036190:MainThread](2024-04-25 02:57:12,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999013 to 0.998306, save checkpoint.
[3036190:MainThread](2024-04-25 02:57:12,550) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.011678, valid_loss 1.000408, train_metric nan, valid_metric 0.025774
[3036190:MainThread](2024-04-25 02:57:12,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.011470, valid_loss 0.997794, train_metric nan, valid_metric 0.026082
[3036190:MainThread](2024-04-25 02:57:12,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998306 to 0.997794, save checkpoint.
[3036190:MainThread](2024-04-25 02:57:12,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.008286, valid_loss 0.999348, train_metric nan, valid_metric 0.024674
[3036190:MainThread](2024-04-25 02:57:13,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.005378, valid_loss 0.998316, train_metric nan, valid_metric 0.029659
[3036190:MainThread](2024-04-25 02:57:13,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.009187, valid_loss 1.000021, train_metric nan, valid_metric 0.009117
[3036190:MainThread](2024-04-25 02:57:13,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.004813, valid_loss 0.998572, train_metric nan, valid_metric 0.021166
[3036190:MainThread](2024-04-25 02:57:13,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.009446, valid_loss 1.000358, train_metric nan, valid_metric 0.026966
[3036190:MainThread](2024-04-25 02:57:13,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.006227, valid_loss 0.998952, train_metric nan, valid_metric 0.024572
[3036190:MainThread](2024-04-25 02:57:13,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.007630, valid_loss 0.998423, train_metric nan, valid_metric 0.026878
[3036190:MainThread](2024-04-25 02:57:14,016) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.000309, valid_loss 0.998554, train_metric nan, valid_metric 0.025763
[3036190:MainThread](2024-04-25 02:57:14,180) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.006070, valid_loss 1.000512, train_metric nan, valid_metric 0.030254
[3036190:MainThread](2024-04-25 02:57:14,346) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.006853, valid_loss 0.998801, train_metric nan, valid_metric 0.019533
[3036190:MainThread](2024-04-25 02:57:14,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.006205, valid_loss 0.998999, train_metric nan, valid_metric 0.027287
[3036190:MainThread](2024-04-25 02:57:14,709) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.001457, valid_loss 1.000862, train_metric nan, valid_metric 0.008145
[3036190:MainThread](2024-04-25 02:57:14,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.998169, valid_loss 0.998930, train_metric nan, valid_metric 0.031655
[3036190:MainThread](2024-04-25 02:57:15,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.998229, valid_loss 0.998495, train_metric nan, valid_metric 0.034594
[3036190:MainThread](2024-04-25 02:57:15,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.002217, valid_loss 0.998122, train_metric nan, valid_metric 0.026389
[3036190:MainThread](2024-04-25 02:57:15,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.001524, valid_loss 0.999917, train_metric nan, valid_metric 0.017536
[3036190:MainThread](2024-04-25 02:57:15,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.995951, valid_loss 0.998181, train_metric nan, valid_metric 0.029133
[3036190:MainThread](2024-04-25 02:57:15,765) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.995918, valid_loss 0.998271, train_metric nan, valid_metric 0.025239
[3036190:MainThread](2024-04-25 02:57:15,928) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.999310, valid_loss 1.001183, train_metric nan, valid_metric 0.025371
[3036190:MainThread](2024-04-25 02:57:16,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.997848, valid_loss 0.997536, train_metric nan, valid_metric 0.034323
[3036190:MainThread](2024-04-25 02:57:16,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997794 to 0.997536, save checkpoint.
[3036190:MainThread](2024-04-25 02:57:16,257) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.000232, valid_loss 0.999363, train_metric nan, valid_metric 0.029350
[3036190:MainThread](2024-04-25 02:57:16,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.999413, valid_loss 0.997872, train_metric nan, valid_metric 0.032026
[3036190:MainThread](2024-04-25 02:57:16,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.995210, valid_loss 1.001060, train_metric nan, valid_metric 0.017005
[3036190:MainThread](2024-04-25 02:57:16,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.000793, valid_loss 1.000557, train_metric nan, valid_metric 0.027865
[3036190:MainThread](2024-04-25 02:57:16,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.000792, valid_loss 0.999388, train_metric nan, valid_metric 0.031376
[3036190:MainThread](2024-04-25 02:57:17,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.000531, valid_loss 0.998676, train_metric nan, valid_metric 0.025751
[3036190:MainThread](2024-04-25 02:57:17,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.997103, valid_loss 0.999454, train_metric nan, valid_metric 0.030453
[3036190:MainThread](2024-04-25 02:57:17,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.999258, valid_loss 0.999288, train_metric nan, valid_metric 0.023058
[3036190:MainThread](2024-04-25 02:57:17,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.994903, valid_loss 0.998182, train_metric nan, valid_metric 0.025905
[3036190:MainThread](2024-04-25 02:57:17,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.996835, valid_loss 0.998114, train_metric nan, valid_metric 0.028274
[3036190:MainThread](2024-04-25 02:57:17,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.000696, valid_loss 0.998038, train_metric nan, valid_metric 0.034073
[3036190:MainThread](2024-04-25 02:57:18,037) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.992745, valid_loss 0.998117, train_metric nan, valid_metric 0.019587
[3036190:MainThread](2024-04-25 02:57:18,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.995200, valid_loss 0.998415, train_metric nan, valid_metric 0.027655
[3036190:MainThread](2024-04-25 02:57:18,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.994043, valid_loss 0.997544, train_metric nan, valid_metric 0.030319
[3036190:MainThread](2024-04-25 02:57:18,496) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.993482, valid_loss 0.997566, train_metric nan, valid_metric 0.027384
[3036190:MainThread](2024-04-25 02:57:18,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.993308, valid_loss 0.998851, train_metric nan, valid_metric 0.028440
[3036190:MainThread](2024-04-25 02:57:18,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.004403, valid_loss 0.997357, train_metric nan, valid_metric 0.027617
[3036190:MainThread](2024-04-25 02:57:18,812) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997536 to 0.997357, save checkpoint.
[3036190:MainThread](2024-04-25 02:57:18,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.995358, valid_loss 0.998497, train_metric nan, valid_metric 0.027208
[3036190:MainThread](2024-04-25 02:57:19,148) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.989714, valid_loss 1.000102, train_metric nan, valid_metric 0.026486
[3036190:MainThread](2024-04-25 02:57:19,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.996141, valid_loss 0.998215, train_metric nan, valid_metric 0.026151
[3036190:MainThread](2024-04-25 02:57:19,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.989612, valid_loss 0.998050, train_metric nan, valid_metric 0.019830
[3036190:MainThread](2024-04-25 02:57:19,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.993455, valid_loss 0.998040, train_metric nan, valid_metric 0.025560
[3036190:MainThread](2024-04-25 02:57:19,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.996337, valid_loss 0.998760, train_metric nan, valid_metric 0.025717
[3036190:MainThread](2024-04-25 02:57:19,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.993104, valid_loss 1.001245, train_metric nan, valid_metric 0.010008
[3036190:MainThread](2024-04-25 02:57:20,130) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.996033, valid_loss 0.997909, train_metric nan, valid_metric 0.030204
[3036190:MainThread](2024-04-25 02:57:20,289) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.995108, valid_loss 0.998039, train_metric nan, valid_metric 0.030474
[3036190:MainThread](2024-04-25 02:57:20,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.992801, valid_loss 0.998621, train_metric nan, valid_metric 0.025061
[3036190:MainThread](2024-04-25 02:57:20,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.991585, valid_loss 1.000794, train_metric nan, valid_metric 0.015275
[3036190:MainThread](2024-04-25 02:57:20,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.995367, valid_loss 1.004999, train_metric nan, valid_metric 0.028320
[3036190:MainThread](2024-04-25 02:57:20,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.992204, valid_loss 0.999640, train_metric nan, valid_metric 0.016446
[3036190:MainThread](2024-04-25 02:57:21,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.995977, valid_loss 0.998405, train_metric nan, valid_metric 0.031598
[3036190:MainThread](2024-04-25 02:57:21,277) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.987435, valid_loss 0.998401, train_metric nan, valid_metric 0.029195
[3036190:MainThread](2024-04-25 02:57:21,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.999330, valid_loss 0.998427, train_metric nan, valid_metric 0.029376
[3036190:MainThread](2024-04-25 02:57:21,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.988513, valid_loss 0.998069, train_metric nan, valid_metric 0.029287
[3036190:MainThread](2024-04-25 02:57:21,770) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.992859, valid_loss 0.999924, train_metric nan, valid_metric 0.033710
[3036190:MainThread](2024-04-25 02:57:21,935) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.995931, valid_loss 0.998418, train_metric nan, valid_metric 0.029431
[3036190:MainThread](2024-04-25 02:57:22,099) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.992724, valid_loss 0.999665, train_metric nan, valid_metric 0.033102
[3036190:MainThread](2024-04-25 02:57:22,263) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.992460, valid_loss 0.999311, train_metric nan, valid_metric 0.022946
[3036190:MainThread](2024-04-25 02:57:22,425) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.991573, valid_loss 0.998578, train_metric nan, valid_metric 0.030719
[3036190:MainThread](2024-04-25 02:57:22,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.988359, valid_loss 0.998726, train_metric nan, valid_metric 0.024580
[3036190:MainThread](2024-04-25 02:57:22,756) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.997948, valid_loss 0.999469, train_metric nan, valid_metric 0.027685
[3036190:MainThread](2024-04-25 02:57:22,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.994003, valid_loss 0.999765, train_metric nan, valid_metric 0.022082
[3036190:MainThread](2024-04-25 02:57:23,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.989762, valid_loss 1.000352, train_metric nan, valid_metric 0.031977
[3036190:MainThread](2024-04-25 02:57:23,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.990391, valid_loss 0.998104, train_metric nan, valid_metric 0.027934
[3036190:MainThread](2024-04-25 02:57:23,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.985520, valid_loss 0.998441, train_metric nan, valid_metric 0.031512
[3036190:MainThread](2024-04-25 02:57:23,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.995898, valid_loss 0.998078, train_metric nan, valid_metric 0.032562
[3036190:MainThread](2024-04-25 02:57:23,892) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.992431, valid_loss 1.002290, train_metric nan, valid_metric 0.026813
[3036190:MainThread](2024-04-25 02:57:24,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.995467, valid_loss 0.998740, train_metric nan, valid_metric 0.029794
[3036190:MainThread](2024-04-25 02:57:24,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.994976, valid_loss 0.999447, train_metric nan, valid_metric 0.023154
[3036190:MainThread](2024-04-25 02:57:24,463) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.991669, valid_loss 1.001045, train_metric nan, valid_metric 0.029883
[3036190:MainThread](2024-04-25 02:57:24,666) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.989349, valid_loss 0.999643, train_metric nan, valid_metric 0.031071
[3036190:MainThread](2024-04-25 02:57:24,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.997177, valid_loss 0.998176, train_metric nan, valid_metric 0.024887
[3036190:MainThread](2024-04-25 02:57:25,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.996834, valid_loss 0.998164, train_metric nan, valid_metric 0.024898
[3036190:MainThread](2024-04-25 02:57:25,235) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.993138, valid_loss 0.999001, train_metric nan, valid_metric 0.023146
[3036190:MainThread](2024-04-25 02:57:25,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.995378, valid_loss 0.999302, train_metric nan, valid_metric 0.032139
[3036190:MainThread](2024-04-25 02:57:25,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.989398, valid_loss 0.999493, train_metric nan, valid_metric 0.026532
[3036190:MainThread](2024-04-25 02:57:25,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.989025, valid_loss 0.997612, train_metric nan, valid_metric 0.032197
[3036190:MainThread](2024-04-25 02:57:25,960) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.984385, valid_loss 0.998912, train_metric nan, valid_metric 0.031472
[3036190:MainThread](2024-04-25 02:57:26,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.995233, valid_loss 1.000319, train_metric nan, valid_metric 0.030702
[3036190:MainThread](2024-04-25 02:57:26,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.995350, valid_loss 0.998747, train_metric nan, valid_metric 0.031280
[3036190:MainThread](2024-04-25 02:57:26,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.994074, valid_loss 0.999418, train_metric nan, valid_metric 0.022133
[3036190:MainThread](2024-04-25 02:57:26,759) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.989478, valid_loss 0.998034, train_metric nan, valid_metric 0.029526
[3036190:MainThread](2024-04-25 02:57:26,929) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.996764, valid_loss 0.998311, train_metric nan, valid_metric 0.026566
[3036190:MainThread](2024-04-25 02:57:27,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.988386, valid_loss 0.998204, train_metric nan, valid_metric 0.029345
[3036190:MainThread](2024-04-25 02:57:27,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.991224, valid_loss 0.998527, train_metric nan, valid_metric 0.032426
[3036190:MainThread](2024-04-25 02:57:27,424) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.990636, valid_loss 0.998442, train_metric nan, valid_metric 0.026918
[3036190:MainThread](2024-04-25 02:57:27,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.990411, valid_loss 0.999865, train_metric nan, valid_metric 0.016235
[3036190:MainThread](2024-04-25 02:57:27,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[3036190:MainThread](2024-04-25 02:57:27,606) INFO - qlib.timer - [log.py:127] - Time cost: 0.002s | waiting `async_log` Done
Save pretrained model to MLP_crowd_data_csi300_360_rankTrue_45.
[3036190:MainThread](2024-04-25 02:57:27,809) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3036190:MainThread](2024-04-25 02:57:27,820) INFO - qlib.workflow - [recorder.py:341] - Recorder d52085428d0a4543b5bea0d0820cedb1 starts running under Experiment 17 ...
{'IC': 0.022686097788742136,
 'ICIR': 0.15786952974802382,
 'Rank IC': 0.030750383407579112,
 'Rank ICIR': 0.2200373329436436}
[3036190:MainThread](2024-04-25 02:57:33,390) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3036190:MainThread](2024-04-25 02:58:09,994) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 02:58:09,997) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 02:58:16,021) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fc51028f070>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:37,  9.90it/s]backtest loop:   1%|          | 9/971 [00:00<00:37, 25.93it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:24, 38.35it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.97it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:19, 48.01it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 48.55it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.81it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.92it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.91it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 56.51it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.60it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 57.25it/s]backtest loop:   8%|▊         | 80/971 [00:01<00:15, 57.92it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 56.24it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 58.15it/s]backtest loop:  10%|█         | 101/971 [00:01<00:14, 59.49it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.50it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 58.30it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.60it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:15, 53.44it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:14, 56.19it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 55.25it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 57.41it/s]backtest loop:  16%|█▌        | 155/971 [00:02<00:13, 58.91it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 56.13it/s]backtest loop:  17%|█▋        | 167/971 [00:03<00:14, 57.03it/s]backtest loop:  18%|█▊        | 174/971 [00:03<00:13, 58.61it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:13, 56.56it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 58.44it/s]backtest loop:  20%|██        | 195/971 [00:03<00:13, 56.53it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 58.38it/s]backtest loop:  22%|██▏       | 209/971 [00:03<00:12, 59.59it/s]backtest loop:  22%|██▏       | 215/971 [00:04<00:14, 53.81it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:13, 56.29it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:12, 58.10it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:13, 55.59it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:12, 57.58it/s]backtest loop:  26%|██▌       | 248/971 [00:04<00:12, 57.97it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:12, 55.47it/s]backtest loop:  27%|██▋       | 261/971 [00:04<00:12, 57.80it/s]backtest loop:  27%|██▋       | 267/971 [00:04<00:12, 55.44it/s]backtest loop:  28%|██▊       | 274/971 [00:05<00:12, 57.60it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:12, 55.86it/s]backtest loop:  30%|██▉       | 288/971 [00:05<00:11, 57.69it/s]backtest loop:  30%|███       | 295/971 [00:05<00:12, 56.08it/s]backtest loop:  31%|███       | 302/971 [00:05<00:11, 57.79it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 59.21it/s]backtest loop:  32%|███▏      | 315/971 [00:05<00:11, 56.27it/s]backtest loop:  33%|███▎      | 322/971 [00:06<00:16, 38.72it/s]backtest loop:  34%|███▍      | 328/971 [00:06<00:14, 42.91it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:13, 45.67it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:12, 49.78it/s]backtest loop:  36%|███▌      | 349/971 [00:06<00:11, 53.30it/s]backtest loop:  37%|███▋      | 355/971 [00:06<00:11, 52.38it/s]backtest loop:  37%|███▋      | 362/971 [00:06<00:10, 55.73it/s]backtest loop:  38%|███▊      | 368/971 [00:06<00:11, 51.34it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:10, 54.35it/s]backtest loop:  39%|███▉      | 382/971 [00:07<00:10, 56.73it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:10, 54.59it/s]backtest loop:  41%|████      | 395/971 [00:07<00:10, 56.80it/s]backtest loop:  41%|████▏     | 402/971 [00:07<00:09, 58.40it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:10, 55.39it/s]backtest loop:  43%|████▎     | 415/971 [00:07<00:09, 57.53it/s]backtest loop:  43%|████▎     | 422/971 [00:07<00:09, 58.98it/s]backtest loop:  44%|████▍     | 428/971 [00:07<00:09, 56.01it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:09, 57.78it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:09, 55.98it/s]backtest loop:  46%|████▌     | 448/971 [00:08<00:09, 56.79it/s]backtest loop:  47%|████▋     | 455/971 [00:08<00:08, 58.44it/s]backtest loop:  48%|████▊     | 462/971 [00:08<00:09, 56.49it/s]backtest loop:  48%|████▊     | 469/971 [00:08<00:08, 58.15it/s]backtest loop:  49%|████▉     | 476/971 [00:08<00:08, 59.48it/s]backtest loop:  50%|████▉     | 482/971 [00:08<00:08, 56.69it/s]backtest loop:  50%|█████     | 489/971 [00:08<00:08, 58.24it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:08, 55.53it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:08, 57.59it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:08, 55.11it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 56.38it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 58.21it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:08, 55.49it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:07, 58.04it/s]backtest loop:  56%|█████▌    | 541/971 [00:09<00:07, 56.19it/s]backtest loop:  56%|█████▋    | 548/971 [00:10<00:07, 58.01it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 59.27it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 56.24it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:06, 57.97it/s]backtest loop:  59%|█████▉    | 574/971 [00:10<00:06, 58.39it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:06, 56.41it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:06, 58.07it/s]backtest loop:  61%|██████▏   | 595/971 [00:10<00:06, 59.48it/s]backtest loop:  62%|██████▏   | 601/971 [00:10<00:06, 56.40it/s]backtest loop:  63%|██████▎   | 608/971 [00:11<00:06, 58.13it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:06, 56.17it/s]backtest loop:  64%|██████▍   | 622/971 [00:11<00:06, 57.83it/s]backtest loop:  65%|██████▍   | 629/971 [00:11<00:05, 59.55it/s]backtest loop:  65%|██████▌   | 635/971 [00:11<00:05, 56.54it/s]backtest loop:  66%|██████▌   | 641/971 [00:11<00:05, 57.43it/s]backtest loop:  67%|██████▋   | 648/971 [00:11<00:05, 58.86it/s]backtest loop:  67%|██████▋   | 655/971 [00:11<00:05, 56.65it/s]backtest loop:  68%|██████▊   | 661/971 [00:11<00:05, 57.38it/s]backtest loop:  69%|██████▉   | 668/971 [00:12<00:05, 58.84it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:05, 55.90it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:05, 57.76it/s]backtest loop:  71%|███████   | 687/971 [00:12<00:04, 58.30it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:04, 56.16it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 58.00it/s]backtest loop:  73%|███████▎  | 708/971 [00:12<00:04, 59.19it/s]backtest loop:  74%|███████▎  | 714/971 [00:12<00:04, 56.26it/s]backtest loop:  74%|███████▍  | 721/971 [00:13<00:04, 58.17it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 59.60it/s]backtest loop:  76%|███████▌  | 734/971 [00:13<00:04, 53.47it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 55.97it/s]backtest loop:  77%|███████▋  | 747/971 [00:13<00:03, 56.96it/s]backtest loop:  78%|███████▊  | 753/971 [00:13<00:03, 54.50it/s]backtest loop:  78%|███████▊  | 760/971 [00:13<00:03, 53.82it/s]backtest loop:  79%|███████▉  | 767/971 [00:13<00:03, 56.24it/s]backtest loop:  80%|███████▉  | 774/971 [00:13<00:03, 58.06it/s]backtest loop:  80%|████████  | 780/971 [00:14<00:03, 55.66it/s]backtest loop:  81%|████████  | 787/971 [00:14<00:03, 57.62it/s]backtest loop:  82%|████████▏ | 793/971 [00:14<00:03, 55.21it/s]backtest loop:  82%|████████▏ | 800/971 [00:14<00:02, 57.28it/s]backtest loop:  83%|████████▎ | 807/971 [00:14<00:02, 58.74it/s]backtest loop:  84%|████████▎ | 813/971 [00:14<00:02, 55.86it/s]backtest loop:  84%|████████▍ | 820/971 [00:14<00:02, 57.67it/s]backtest loop:  85%|████████▌ | 826/971 [00:14<00:02, 57.14it/s]backtest loop:  86%|████████▌ | 832/971 [00:14<00:02, 57.90it/s]backtest loop:  86%|████████▋ | 838/971 [00:15<00:02, 55.11it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 57.25it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 55.54it/s]backtest loop:  88%|████████▊ | 859/971 [00:15<00:01, 57.57it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 59.08it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 56.00it/s]backtest loop:  91%|█████████ | 879/971 [00:15<00:01, 58.04it/s]backtest loop:  91%|█████████ | 886/971 [00:15<00:01, 59.36it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 56.28it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 58.02it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 59.21it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 55.58it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 57.60it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 55.84it/s]backtest loop:  96%|█████████▌| 933/971 [00:16<00:00, 57.66it/s]backtest loop:  97%|█████████▋| 939/971 [00:16<00:00, 55.59it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 52.48it/s]backtest loop:  98%|█████████▊| 951/971 [00:17<00:00, 53.20it/s]backtest loop:  99%|█████████▊| 957/971 [00:17<00:00, 53.68it/s]backtest loop:  99%|█████████▉| 963/971 [00:17<00:00, 54.03it/s]backtest loop: 100%|█████████▉| 969/971 [00:17<00:00, 54.20it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.52it/s]
[3036190:MainThread](2024-04-25 02:58:33,568) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000478
std                0.005033
annualized_return  0.113692
information_ratio  1.464296
max_drawdown      -0.067475
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000280
std                0.005035
annualized_return  0.066605
information_ratio  0.857420
max_drawdown      -0.091321
[3036190:MainThread](2024-04-25 02:58:33,582) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `MLP_crowd_data_csi300_360_rankTrue`.
[3036190:MainThread](2024-04-25 02:58:40,082) INFO - qlib.timer - [log.py:127] - Time cost: 0.006s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.09660888993280313,
                                                    0.13562370991980652,
                                                    0.06660464834929007],
 '1day.excess_return_with_cost.information_ratio': [0.9965334629357873,
                                                    1.471462498466688,
                                                    0.8574204686978396],
 '1day.excess_return_with_cost.max_drawdown': [-0.178625820283921,
                                               -0.12757703738688353,
                                               -0.0913209010721612],
 'IC': [0.022102653552402936, 0.02409782375001873, 0.022686097788742136],
 'ICIR': [0.13898491673495106, 0.15607704167026837, 0.15786952974802382],
 'Rank IC': [0.025665075667307198, 0.03148333316577824, 0.030750383407579112],
 'Rank ICIR': [0.16136503534804983, 0.21059379399912298, 0.2200373329436436],
 'mae': [0.8644317750225282, 0.8642435379012978, 0.8642145420813768],
 'mse': [0.9972685662584836, 0.9972602008572546, 0.9967983457930604]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3036190:MainThread](2024-04-25 02:58:43,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3036190:MainThread](2024-04-25 02:58:43,073) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.01
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3036190:MainThread](2024-04-25 02:58:43,075) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3036190:MainThread](2024-04-25 02:58:43,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
[3036190:MainThread](2024-04-25 02:58:45,831) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name MLP_crowd_data_csi300_360_rankTrue_46.
[3036190:MainThread](2024-04-25 02:58:45,844) INFO - qlib.workflow - [exp.py:258] - Experiment 20 starts running ...
[3036190:MainThread](2024-04-25 02:58:45,853) INFO - qlib.workflow - [recorder.py:341] - Recorder c7340650f70649c4a8907d074bcc2fba starts running under Experiment 20 ...
[3036190:MainThread](2024-04-25 02:58:52,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[3036190:MainThread](2024-04-25 02:58:53,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 3.280098, valid_loss 1.075506, train_metric nan, valid_metric 0.011164
[3036190:MainThread](2024-04-25 02:58:53,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.075506, save checkpoint.
[3036190:MainThread](2024-04-25 02:58:53,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.084835, valid_loss 1.009560, train_metric nan, valid_metric 0.014398
[3036190:MainThread](2024-04-25 02:58:53,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.075506 to 1.009560, save checkpoint.
[3036190:MainThread](2024-04-25 02:58:53,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.037017, valid_loss 1.006805, train_metric nan, valid_metric 0.020995
[3036190:MainThread](2024-04-25 02:58:53,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.009560 to 1.006805, save checkpoint.
[3036190:MainThread](2024-04-25 02:58:53,804) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.021938, valid_loss 0.999278, train_metric nan, valid_metric 0.011683
[3036190:MainThread](2024-04-25 02:58:53,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006805 to 0.999278, save checkpoint.
[3036190:MainThread](2024-04-25 02:58:53,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.023421, valid_loss 0.999129, train_metric nan, valid_metric 0.009061
[3036190:MainThread](2024-04-25 02:58:53,962) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999278 to 0.999129, save checkpoint.
[3036190:MainThread](2024-04-25 02:58:54,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.019448, valid_loss 0.999769, train_metric nan, valid_metric 0.019662
[3036190:MainThread](2024-04-25 02:58:54,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.020362, valid_loss 0.999101, train_metric nan, valid_metric 0.016495
[3036190:MainThread](2024-04-25 02:58:54,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999129 to 0.999101, save checkpoint.
[3036190:MainThread](2024-04-25 02:58:54,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.015162, valid_loss 1.000057, train_metric nan, valid_metric 0.005960
[3036190:MainThread](2024-04-25 02:58:54,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.011759, valid_loss 0.998450, train_metric nan, valid_metric 0.015416
[3036190:MainThread](2024-04-25 02:58:54,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999101 to 0.998450, save checkpoint.
[3036190:MainThread](2024-04-25 02:58:54,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.013062, valid_loss 0.999403, train_metric nan, valid_metric 0.021850
[3036190:MainThread](2024-04-25 02:58:54,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.002564, valid_loss 0.998586, train_metric nan, valid_metric 0.017674
[3036190:MainThread](2024-04-25 02:58:55,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.014436, valid_loss 0.998312, train_metric nan, valid_metric 0.015727
[3036190:MainThread](2024-04-25 02:58:55,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998450 to 0.998312, save checkpoint.
[3036190:MainThread](2024-04-25 02:58:55,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.008990, valid_loss 0.998592, train_metric nan, valid_metric 0.021284
[3036190:MainThread](2024-04-25 02:58:55,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.008932, valid_loss 0.998632, train_metric nan, valid_metric 0.021095
[3036190:MainThread](2024-04-25 02:58:55,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.007580, valid_loss 0.998495, train_metric nan, valid_metric 0.019872
[3036190:MainThread](2024-04-25 02:58:55,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.008949, valid_loss 1.002687, train_metric nan, valid_metric 0.023024
[3036190:MainThread](2024-04-25 02:58:55,970) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.003248, valid_loss 0.999763, train_metric nan, valid_metric 0.010044
[3036190:MainThread](2024-04-25 02:58:56,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.009083, valid_loss 0.999345, train_metric nan, valid_metric 0.013930
[3036190:MainThread](2024-04-25 02:58:56,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.003879, valid_loss 0.999843, train_metric nan, valid_metric 0.022648
[3036190:MainThread](2024-04-25 02:58:56,463) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.004170, valid_loss 0.999459, train_metric nan, valid_metric 0.020710
[3036190:MainThread](2024-04-25 02:58:56,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.004357, valid_loss 0.998729, train_metric nan, valid_metric 0.024022
[3036190:MainThread](2024-04-25 02:58:56,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.004082, valid_loss 0.998226, train_metric nan, valid_metric 0.024011
[3036190:MainThread](2024-04-25 02:58:56,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998312 to 0.998226, save checkpoint.
[3036190:MainThread](2024-04-25 02:58:56,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.995589, valid_loss 0.998530, train_metric nan, valid_metric 0.023120
[3036190:MainThread](2024-04-25 02:58:57,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.003001, valid_loss 0.998121, train_metric nan, valid_metric 0.021977
[3036190:MainThread](2024-04-25 02:58:57,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998226 to 0.998121, save checkpoint.
[3036190:MainThread](2024-04-25 02:58:57,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.995904, valid_loss 0.997929, train_metric nan, valid_metric 0.018956
[3036190:MainThread](2024-04-25 02:58:57,316) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998121 to 0.997929, save checkpoint.
[3036190:MainThread](2024-04-25 02:58:57,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.002983, valid_loss 0.998370, train_metric nan, valid_metric 0.025076
[3036190:MainThread](2024-04-25 02:58:57,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.001393, valid_loss 0.999430, train_metric nan, valid_metric 0.014882
[3036190:MainThread](2024-04-25 02:58:57,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.998506, valid_loss 1.000252, train_metric nan, valid_metric 0.023918
[3036190:MainThread](2024-04-25 02:58:57,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.002107, valid_loss 0.999892, train_metric nan, valid_metric 0.012073
[3036190:MainThread](2024-04-25 02:58:58,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.000148, valid_loss 0.999008, train_metric nan, valid_metric 0.024345
[3036190:MainThread](2024-04-25 02:58:58,346) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.001823, valid_loss 1.003052, train_metric nan, valid_metric 0.003657
[3036190:MainThread](2024-04-25 02:58:58,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 1.002154, valid_loss 0.997928, train_metric nan, valid_metric 0.023057
[3036190:MainThread](2024-04-25 02:58:58,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997929 to 0.997928, save checkpoint.
[3036190:MainThread](2024-04-25 02:58:58,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.996915, valid_loss 1.001569, train_metric nan, valid_metric 0.000784
[3036190:MainThread](2024-04-25 02:58:58,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.004086, valid_loss 0.999292, train_metric nan, valid_metric 0.027282
[3036190:MainThread](2024-04-25 02:58:59,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.999295, valid_loss 0.999516, train_metric nan, valid_metric 0.019221
[3036190:MainThread](2024-04-25 02:58:59,243) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.001086, valid_loss 0.999389, train_metric nan, valid_metric 0.014065
[3036190:MainThread](2024-04-25 02:58:59,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.999484, valid_loss 0.999002, train_metric nan, valid_metric 0.016524
[3036190:MainThread](2024-04-25 02:58:59,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.995423, valid_loss 0.998887, train_metric nan, valid_metric 0.018459
[3036190:MainThread](2024-04-25 02:58:59,804) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.998823, valid_loss 1.001743, train_metric nan, valid_metric 0.009431
[3036190:MainThread](2024-04-25 02:59:00,006) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.997482, valid_loss 0.997910, train_metric nan, valid_metric 0.026969
[3036190:MainThread](2024-04-25 02:59:00,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997928 to 0.997910, save checkpoint.
[3036190:MainThread](2024-04-25 02:59:00,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.000303, valid_loss 0.999203, train_metric nan, valid_metric 0.022381
[3036190:MainThread](2024-04-25 02:59:00,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 1.004497, valid_loss 0.999050, train_metric nan, valid_metric 0.020420
[3036190:MainThread](2024-04-25 02:59:00,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.996194, valid_loss 0.999138, train_metric nan, valid_metric 0.018988
[3036190:MainThread](2024-04-25 02:59:00,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.001063, valid_loss 0.999497, train_metric nan, valid_metric 0.030447
[3036190:MainThread](2024-04-25 02:59:00,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.997639, valid_loss 0.997669, train_metric nan, valid_metric 0.026812
[3036190:MainThread](2024-04-25 02:59:00,980) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997910 to 0.997669, save checkpoint.
[3036190:MainThread](2024-04-25 02:59:01,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.998612, valid_loss 0.998581, train_metric nan, valid_metric 0.022974
[3036190:MainThread](2024-04-25 02:59:01,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.995165, valid_loss 0.999516, train_metric nan, valid_metric 0.016670
[3036190:MainThread](2024-04-25 02:59:01,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.992862, valid_loss 0.997795, train_metric nan, valid_metric 0.029726
[3036190:MainThread](2024-04-25 02:59:01,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.990156, valid_loss 0.998733, train_metric nan, valid_metric 0.023255
[3036190:MainThread](2024-04-25 02:59:01,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.992867, valid_loss 0.998018, train_metric nan, valid_metric 0.028504
[3036190:MainThread](2024-04-25 02:59:01,970) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.998703, valid_loss 0.998163, train_metric nan, valid_metric 0.018201
[3036190:MainThread](2024-04-25 02:59:02,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.992701, valid_loss 0.998415, train_metric nan, valid_metric 0.026000
[3036190:MainThread](2024-04-25 02:59:02,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.997897, valid_loss 1.001550, train_metric nan, valid_metric 0.024498
[3036190:MainThread](2024-04-25 02:59:02,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.995061, valid_loss 1.001717, train_metric nan, valid_metric 0.014616
[3036190:MainThread](2024-04-25 02:59:02,629) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.992363, valid_loss 0.999562, train_metric nan, valid_metric 0.018879
[3036190:MainThread](2024-04-25 02:59:02,793) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.995128, valid_loss 1.000519, train_metric nan, valid_metric 0.015611
[3036190:MainThread](2024-04-25 02:59:02,957) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.996796, valid_loss 0.999760, train_metric nan, valid_metric 0.011726
[3036190:MainThread](2024-04-25 02:59:03,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 1.000629, valid_loss 0.998278, train_metric nan, valid_metric 0.021163
[3036190:MainThread](2024-04-25 02:59:03,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.996116, valid_loss 0.997715, train_metric nan, valid_metric 0.029755
[3036190:MainThread](2024-04-25 02:59:03,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.996217, valid_loss 0.998682, train_metric nan, valid_metric 0.022676
[3036190:MainThread](2024-04-25 02:59:03,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.997153, valid_loss 1.001690, train_metric nan, valid_metric 0.007770
[3036190:MainThread](2024-04-25 02:59:03,784) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.994154, valid_loss 0.999511, train_metric nan, valid_metric 0.029445
[3036190:MainThread](2024-04-25 02:59:03,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.992022, valid_loss 0.998606, train_metric nan, valid_metric 0.033935
[3036190:MainThread](2024-04-25 02:59:04,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.999727, valid_loss 0.998826, train_metric nan, valid_metric 0.021541
[3036190:MainThread](2024-04-25 02:59:04,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.994426, valid_loss 1.001296, train_metric nan, valid_metric 0.029243
[3036190:MainThread](2024-04-25 02:59:04,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.991529, valid_loss 1.000089, train_metric nan, valid_metric 0.031385
[3036190:MainThread](2024-04-25 02:59:04,608) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.986994, valid_loss 1.000621, train_metric nan, valid_metric 0.009596
[3036190:MainThread](2024-04-25 02:59:04,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.994565, valid_loss 1.000975, train_metric nan, valid_metric 0.015365
[3036190:MainThread](2024-04-25 02:59:04,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.995698, valid_loss 0.999250, train_metric nan, valid_metric 0.029600
[3036190:MainThread](2024-04-25 02:59:05,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.999131, valid_loss 0.997706, train_metric nan, valid_metric 0.028470
[3036190:MainThread](2024-04-25 02:59:05,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.990804, valid_loss 0.999598, train_metric nan, valid_metric 0.019409
[3036190:MainThread](2024-04-25 02:59:05,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.996685, valid_loss 0.997646, train_metric nan, valid_metric 0.032758
[3036190:MainThread](2024-04-25 02:59:05,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997669 to 0.997646, save checkpoint.
[3036190:MainThread](2024-04-25 02:59:05,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.997979, valid_loss 0.998730, train_metric nan, valid_metric 0.028005
[3036190:MainThread](2024-04-25 02:59:05,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.990407, valid_loss 1.002008, train_metric nan, valid_metric 0.022671
[3036190:MainThread](2024-04-25 02:59:05,926) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.991112, valid_loss 1.000367, train_metric nan, valid_metric 0.030197
[3036190:MainThread](2024-04-25 02:59:06,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.994027, valid_loss 0.999624, train_metric nan, valid_metric 0.029345
[3036190:MainThread](2024-04-25 02:59:06,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.996685, valid_loss 1.000465, train_metric nan, valid_metric 0.017987
[3036190:MainThread](2024-04-25 02:59:06,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.997645, valid_loss 0.999323, train_metric nan, valid_metric 0.028796
[3036190:MainThread](2024-04-25 02:59:06,583) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.993535, valid_loss 0.998419, train_metric nan, valid_metric 0.029095
[3036190:MainThread](2024-04-25 02:59:06,746) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.992609, valid_loss 0.998280, train_metric nan, valid_metric 0.028797
[3036190:MainThread](2024-04-25 02:59:06,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.991599, valid_loss 1.000306, train_metric nan, valid_metric 0.020092
[3036190:MainThread](2024-04-25 02:59:07,062) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.994756, valid_loss 1.002881, train_metric nan, valid_metric 0.028762
[3036190:MainThread](2024-04-25 02:59:07,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 1.001680, valid_loss 1.000643, train_metric nan, valid_metric 0.020026
[3036190:MainThread](2024-04-25 02:59:07,394) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.996703, valid_loss 0.998168, train_metric nan, valid_metric 0.028007
[3036190:MainThread](2024-04-25 02:59:07,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.999390, valid_loss 0.999741, train_metric nan, valid_metric 0.029319
[3036190:MainThread](2024-04-25 02:59:07,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.995727, valid_loss 1.000249, train_metric nan, valid_metric 0.034663
[3036190:MainThread](2024-04-25 02:59:07,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.995402, valid_loss 0.999246, train_metric nan, valid_metric 0.024677
[3036190:MainThread](2024-04-25 02:59:08,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.999231, valid_loss 0.999875, train_metric nan, valid_metric 0.029932
[3036190:MainThread](2024-04-25 02:59:08,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.993779, valid_loss 1.001458, train_metric nan, valid_metric 0.028183
[3036190:MainThread](2024-04-25 02:59:08,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 1.003566, valid_loss 1.000150, train_metric nan, valid_metric 0.033843
[3036190:MainThread](2024-04-25 02:59:08,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.992325, valid_loss 1.000970, train_metric nan, valid_metric 0.015079
[3036190:MainThread](2024-04-25 02:59:08,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.988344, valid_loss 0.999519, train_metric nan, valid_metric 0.023331
[3036190:MainThread](2024-04-25 02:59:08,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.992431, valid_loss 0.998275, train_metric nan, valid_metric 0.021343
[3036190:MainThread](2024-04-25 02:59:08,995) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.995023, valid_loss 1.003824, train_metric nan, valid_metric 0.008545
[3036190:MainThread](2024-04-25 02:59:09,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.998677, valid_loss 0.998152, train_metric nan, valid_metric 0.026673
[3036190:MainThread](2024-04-25 02:59:09,320) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.996193, valid_loss 0.998762, train_metric nan, valid_metric 0.024750
[3036190:MainThread](2024-04-25 02:59:09,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.987026, valid_loss 1.000866, train_metric nan, valid_metric 0.017830
[3036190:MainThread](2024-04-25 02:59:09,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.993798, valid_loss 1.001183, train_metric nan, valid_metric 0.014794
[3036190:MainThread](2024-04-25 02:59:09,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.988210, valid_loss 0.999663, train_metric nan, valid_metric 0.028651
[3036190:MainThread](2024-04-25 02:59:09,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.994104, valid_loss 1.001899, train_metric nan, valid_metric 0.032370
[3036190:MainThread](2024-04-25 02:59:10,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.992420, valid_loss 0.999470, train_metric nan, valid_metric 0.019120
[3036190:MainThread](2024-04-25 02:59:10,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.995737, valid_loss 0.998323, train_metric nan, valid_metric 0.031252
[3036190:MainThread](2024-04-25 02:59:10,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.991263, valid_loss 1.003162, train_metric nan, valid_metric 0.031136
[3036190:MainThread](2024-04-25 02:59:10,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.992232, valid_loss 0.998058, train_metric nan, valid_metric 0.032665
[3036190:MainThread](2024-04-25 02:59:10,812) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.992055, valid_loss 0.999863, train_metric nan, valid_metric 0.029332
[3036190:MainThread](2024-04-25 02:59:10,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 0.996904, valid_loss 1.000114, train_metric nan, valid_metric 0.019894
[3036190:MainThread](2024-04-25 02:59:11,146) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.991572, valid_loss 1.004385, train_metric nan, valid_metric 0.030459
[3036190:MainThread](2024-04-25 02:59:11,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 0.990807, valid_loss 0.999913, train_metric nan, valid_metric 0.026671
[3036190:MainThread](2024-04-25 02:59:11,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 0.993777, valid_loss 1.000436, train_metric nan, valid_metric 0.030230
[3036190:MainThread](2024-04-25 02:59:11,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 0.995215, valid_loss 1.001142, train_metric nan, valid_metric 0.020667
[3036190:MainThread](2024-04-25 02:59:11,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 1.002473, valid_loss 1.003267, train_metric nan, valid_metric 0.027448
[3036190:MainThread](2024-04-25 02:59:11,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 0.991907, valid_loss 0.997985, train_metric nan, valid_metric 0.030731
[3036190:MainThread](2024-04-25 02:59:12,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 0.985280, valid_loss 1.001210, train_metric nan, valid_metric 0.032580
[3036190:MainThread](2024-04-25 02:59:12,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 0.997298, valid_loss 0.999310, train_metric nan, valid_metric 0.032779
[3036190:MainThread](2024-04-25 02:59:12,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 0.996912, valid_loss 1.000013, train_metric nan, valid_metric 0.030363
[3036190:MainThread](2024-04-25 02:59:12,629) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 0.988531, valid_loss 1.000250, train_metric nan, valid_metric 0.021430
[3036190:MainThread](2024-04-25 02:59:12,793) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 0.990323, valid_loss 0.999379, train_metric nan, valid_metric 0.025632
[3036190:MainThread](2024-04-25 02:59:12,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 0.991111, valid_loss 0.999935, train_metric nan, valid_metric 0.031465
[3036190:MainThread](2024-04-25 02:59:13,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 0.990352, valid_loss 1.000445, train_metric nan, valid_metric 0.024158
[3036190:MainThread](2024-04-25 02:59:13,289) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 0.992948, valid_loss 0.999632, train_metric nan, valid_metric 0.028391
[3036190:MainThread](2024-04-25 02:59:13,453) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 0.986528, valid_loss 0.999132, train_metric nan, valid_metric 0.031518
[3036190:MainThread](2024-04-25 02:59:13,615) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 0.994913, valid_loss 0.999374, train_metric nan, valid_metric 0.035030
[3036190:MainThread](2024-04-25 02:59:13,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[3036190:MainThread](2024-04-25 02:59:13,634) INFO - qlib.timer - [log.py:127] - Time cost: 0.001s | waiting `async_log` Done
Save pretrained model to MLP_crowd_data_csi300_360_rankTrue_46.
[3036190:MainThread](2024-04-25 02:59:13,847) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3036190:MainThread](2024-04-25 02:59:13,859) INFO - qlib.workflow - [recorder.py:341] - Recorder 2c5e0c8e3436433c83b09d3b2887675e starts running under Experiment 17 ...
{'IC': 0.02367574671522226,
 'ICIR': 0.14959396620968068,
 'Rank IC': 0.03557216907148577,
 'Rank ICIR': 0.2277897581780483}
[3036190:MainThread](2024-04-25 02:59:19,409) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3036190:MainThread](2024-04-25 02:59:56,483) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 02:59:56,486) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 03:00:02,546) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fc44ef492e0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:43,  9.39it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.18it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 33.95it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 38.04it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 43.01it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 46.55it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 46.13it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:18, 48.94it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 50.70it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 48.61it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:18, 50.42it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 51.88it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 53.05it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 53.84it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 51.15it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 52.66it/s]backtest loop:  10%|█         | 100/971 [00:02<00:15, 55.57it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 54.58it/s]backtest loop:  12%|█▏        | 113/971 [00:02<00:15, 53.65it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:15, 53.87it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:16, 51.18it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:16, 49.50it/s]backtest loop:  14%|█▍        | 137/971 [00:02<00:16, 51.11it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:15, 52.04it/s]backtest loop:  15%|█▌        | 149/971 [00:03<00:15, 52.71it/s]backtest loop:  16%|█▌        | 155/971 [00:03<00:15, 53.25it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:16, 50.58it/s]backtest loop:  17%|█▋        | 167/971 [00:03<00:15, 51.83it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:15, 52.72it/s]backtest loop:  18%|█▊        | 179/971 [00:03<00:14, 53.26it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:15, 50.55it/s]backtest loop:  20%|█▉        | 191/971 [00:03<00:14, 52.04it/s]backtest loop:  20%|██        | 197/971 [00:04<00:14, 52.94it/s]backtest loop:  21%|██        | 203/971 [00:04<00:14, 53.57it/s]backtest loop:  22%|██▏       | 209/971 [00:04<00:14, 53.88it/s]backtest loop:  22%|██▏       | 215/971 [00:04<00:15, 48.46it/s]backtest loop:  23%|██▎       | 221/971 [00:04<00:14, 50.41it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:14, 51.94it/s]backtest loop:  24%|██▍       | 233/971 [00:04<00:13, 53.17it/s]backtest loop:  25%|██▍       | 239/971 [00:04<00:13, 53.69it/s]backtest loop:  25%|██▌       | 245/971 [00:04<00:14, 50.68it/s]backtest loop:  26%|██▌       | 251/971 [00:05<00:13, 52.00it/s]backtest loop:  26%|██▋       | 257/971 [00:05<00:13, 52.89it/s]backtest loop:  27%|██▋       | 263/971 [00:05<00:13, 54.13it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:13, 51.15it/s]backtest loop:  28%|██▊       | 275/971 [00:05<00:13, 52.00it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:13, 49.74it/s]backtest loop:  30%|██▉       | 287/971 [00:05<00:13, 51.19it/s]backtest loop:  30%|███       | 293/971 [00:05<00:13, 52.11it/s]backtest loop:  31%|███       | 299/971 [00:05<00:12, 53.03it/s]backtest loop:  31%|███▏      | 305/971 [00:06<00:13, 50.09it/s]backtest loop:  32%|███▏      | 311/971 [00:06<00:12, 51.53it/s]backtest loop:  33%|███▎      | 317/971 [00:06<00:12, 52.53it/s]backtest loop:  33%|███▎      | 323/971 [00:06<00:12, 53.29it/s]backtest loop:  34%|███▍      | 329/971 [00:06<00:11, 53.85it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:12, 50.89it/s]backtest loop:  35%|███▌      | 341/971 [00:06<00:12, 52.22it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:11, 52.99it/s]backtest loop:  36%|███▋      | 353/971 [00:07<00:11, 53.70it/s]backtest loop:  37%|███▋      | 359/971 [00:07<00:18, 33.46it/s]backtest loop:  37%|███▋      | 364/971 [00:07<00:17, 35.70it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:16, 37.29it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:14, 41.53it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:13, 44.78it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:12, 47.45it/s]backtest loop:  40%|████      | 393/971 [00:08<00:12, 46.75it/s]backtest loop:  41%|████      | 399/971 [00:08<00:11, 48.97it/s]backtest loop:  42%|████▏     | 405/971 [00:08<00:11, 50.60it/s]backtest loop:  42%|████▏     | 411/971 [00:08<00:10, 51.68it/s]backtest loop:  43%|████▎     | 417/971 [00:08<00:10, 52.50it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:10, 50.01it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:10, 51.33it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:10, 52.35it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:10, 52.81it/s]backtest loop:  46%|████▌     | 447/971 [00:09<00:10, 50.17it/s]backtest loop:  47%|████▋     | 453/971 [00:09<00:10, 51.50it/s]backtest loop:  47%|████▋     | 459/971 [00:09<00:09, 52.47it/s]backtest loop:  48%|████▊     | 465/971 [00:09<00:09, 53.18it/s]backtest loop:  49%|████▊     | 471/971 [00:09<00:09, 53.53it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 50.67it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:09, 51.76it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:09, 52.66it/s]backtest loop:  51%|█████     | 495/971 [00:10<00:09, 50.27it/s]backtest loop:  52%|█████▏    | 501/971 [00:10<00:09, 51.07it/s]backtest loop:  52%|█████▏    | 507/971 [00:10<00:09, 49.08it/s]backtest loop:  53%|█████▎    | 513/971 [00:10<00:09, 50.80it/s]backtest loop:  53%|█████▎    | 519/971 [00:10<00:08, 52.18it/s]backtest loop:  54%|█████▍    | 525/971 [00:10<00:08, 52.98it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 50.44it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:08, 51.82it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:08, 52.84it/s]backtest loop:  57%|█████▋    | 549/971 [00:11<00:07, 53.49it/s]backtest loop:  57%|█████▋    | 555/971 [00:11<00:07, 53.83it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:08, 50.85it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:07, 51.78it/s]backtest loop:  59%|█████▉    | 573/971 [00:11<00:07, 52.82it/s]backtest loop:  60%|█████▉    | 579/971 [00:11<00:07, 53.24it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:07, 53.92it/s]backtest loop:  61%|██████    | 591/971 [00:11<00:07, 51.06it/s]backtest loop:  61%|██████▏   | 597/971 [00:11<00:07, 51.83it/s]backtest loop:  62%|██████▏   | 603/971 [00:12<00:06, 52.81it/s]backtest loop:  63%|██████▎   | 609/971 [00:12<00:06, 53.38it/s]backtest loop:  63%|██████▎   | 615/971 [00:12<00:07, 50.67it/s]backtest loop:  64%|██████▍   | 621/971 [00:12<00:06, 51.79it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:06, 52.35it/s]backtest loop:  65%|██████▌   | 633/971 [00:12<00:06, 53.08it/s]backtest loop:  66%|██████▌   | 639/971 [00:12<00:06, 53.63it/s]backtest loop:  66%|██████▋   | 645/971 [00:12<00:06, 50.82it/s]backtest loop:  67%|██████▋   | 651/971 [00:12<00:06, 51.95it/s]backtest loop:  68%|██████▊   | 657/971 [00:13<00:06, 52.09it/s]backtest loop:  68%|██████▊   | 663/971 [00:13<00:05, 52.88it/s]backtest loop:  69%|██████▉   | 669/971 [00:13<00:05, 53.49it/s]backtest loop:  70%|██████▉   | 675/971 [00:13<00:05, 50.68it/s]backtest loop:  70%|███████   | 681/971 [00:13<00:05, 51.79it/s]backtest loop:  71%|███████   | 687/971 [00:13<00:05, 52.27it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:05, 53.03it/s]backtest loop:  72%|███████▏  | 699/971 [00:13<00:05, 50.45it/s]backtest loop:  73%|███████▎  | 705/971 [00:14<00:05, 51.67it/s]backtest loop:  73%|███████▎  | 711/971 [00:14<00:04, 52.59it/s]backtest loop:  74%|███████▍  | 717/971 [00:14<00:04, 53.15it/s]backtest loop:  74%|███████▍  | 723/971 [00:14<00:04, 53.70it/s]backtest loop:  75%|███████▌  | 729/971 [00:14<00:04, 50.59it/s]backtest loop:  76%|███████▌  | 735/971 [00:14<00:04, 48.90it/s]backtest loop:  76%|███████▋  | 741/971 [00:14<00:04, 50.61it/s]backtest loop:  77%|███████▋  | 747/971 [00:14<00:04, 51.48it/s]backtest loop:  78%|███████▊  | 753/971 [00:14<00:04, 49.36it/s]backtest loop:  78%|███████▊  | 759/971 [00:15<00:04, 50.79it/s]backtest loop:  79%|███████▉  | 765/971 [00:15<00:04, 48.99it/s]backtest loop:  79%|███████▉  | 771/971 [00:15<00:03, 50.58it/s]backtest loop:  80%|████████  | 777/971 [00:15<00:03, 51.52it/s]backtest loop:  81%|████████  | 783/971 [00:15<00:03, 49.58it/s]backtest loop:  81%|████████▏ | 789/971 [00:15<00:03, 51.02it/s]backtest loop:  82%|████████▏ | 795/971 [00:15<00:03, 52.11it/s]backtest loop:  82%|████████▏ | 801/971 [00:15<00:03, 52.39it/s]backtest loop:  83%|████████▎ | 807/971 [00:16<00:03, 52.59it/s]backtest loop:  84%|████████▎ | 813/971 [00:16<00:03, 50.01it/s]backtest loop:  84%|████████▍ | 819/971 [00:16<00:02, 51.41it/s]backtest loop:  85%|████████▍ | 825/971 [00:16<00:02, 52.31it/s]backtest loop:  86%|████████▌ | 831/971 [00:16<00:02, 53.04it/s]backtest loop:  86%|████████▌ | 837/971 [00:16<00:02, 53.13it/s]backtest loop:  87%|████████▋ | 843/971 [00:16<00:02, 50.43it/s]backtest loop:  87%|████████▋ | 849/971 [00:16<00:02, 51.63it/s]backtest loop:  88%|████████▊ | 855/971 [00:16<00:02, 52.51it/s]backtest loop:  89%|████████▊ | 861/971 [00:17<00:02, 52.98it/s]backtest loop:  89%|████████▉ | 867/971 [00:17<00:02, 50.06it/s]backtest loop:  90%|████████▉ | 873/971 [00:17<00:01, 51.26it/s]backtest loop:  91%|█████████ | 879/971 [00:17<00:01, 52.19it/s]backtest loop:  91%|█████████ | 885/971 [00:17<00:01, 52.98it/s]backtest loop:  92%|█████████▏| 891/971 [00:17<00:01, 53.47it/s]backtest loop:  92%|█████████▏| 897/971 [00:17<00:01, 50.39it/s]backtest loop:  93%|█████████▎| 903/971 [00:17<00:01, 51.57it/s]backtest loop:  94%|█████████▎| 909/971 [00:17<00:01, 52.51it/s]backtest loop:  94%|█████████▍| 915/971 [00:18<00:01, 53.31it/s]backtest loop:  95%|█████████▍| 921/971 [00:18<00:00, 50.53it/s]backtest loop:  95%|█████████▌| 927/971 [00:18<00:00, 51.55it/s]backtest loop:  96%|█████████▌| 933/971 [00:18<00:00, 52.42it/s]backtest loop:  97%|█████████▋| 939/971 [00:18<00:00, 53.00it/s]backtest loop:  97%|█████████▋| 945/971 [00:18<00:00, 50.51it/s]backtest loop:  98%|█████████▊| 951/971 [00:18<00:00, 51.60it/s]backtest loop:  99%|█████████▊| 957/971 [00:18<00:00, 52.19it/s]backtest loop:  99%|█████████▉| 963/971 [00:19<00:00, 52.85it/s]backtest loop: 100%|█████████▉| 969/971 [00:19<00:00, 53.39it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 50.59it/s]
[3036190:MainThread](2024-04-25 03:00:21,795) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000675
std                0.006201
annualized_return  0.160578
information_ratio  1.678520
max_drawdown      -0.105576
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000474
std                0.006201
annualized_return  0.112731
information_ratio  1.178358
max_drawdown      -0.112495
[3036190:MainThread](2024-04-25 03:00:21,808) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `MLP_crowd_data_csi300_360_rankTrue`.
[3036190:MainThread](2024-04-25 03:00:28,285) INFO - qlib.timer - [log.py:127] - Time cost: 0.002s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.09660888993280313,
                                                    0.13562370991980652,
                                                    0.06660464834929007,
                                                    0.11273109897819915],
 '1day.excess_return_with_cost.information_ratio': [0.9965334629357873,
                                                    1.471462498466688,
                                                    0.8574204686978396,
                                                    1.1783584885283203],
 '1day.excess_return_with_cost.max_drawdown': [-0.178625820283921,
                                               -0.12757703738688353,
                                               -0.0913209010721612,
                                               -0.11249516827526612],
 'IC': [0.022102653552402936,
        0.02409782375001873,
        0.022686097788742136,
        0.02367574671522226],
 'ICIR': [0.13898491673495106,
          0.15607704167026837,
          0.15786952974802382,
          0.14959396620968068],
 'Rank IC': [0.025665075667307198,
             0.03148333316577824,
             0.030750383407579112,
             0.03557216907148577],
 'Rank ICIR': [0.16136503534804983,
               0.21059379399912298,
               0.2200373329436436,
               0.2277897581780483],
 'mae': [0.8644317750225282,
         0.8642435379012978,
         0.8642145420813768,
         0.8640649052148514],
 'mse': [0.9972685662584836,
         0.9972602008572546,
         0.9967983457930604,
         0.9969556729191729]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3036190:MainThread](2024-04-25 03:00:31,297) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3036190:MainThread](2024-04-25 03:00:31,297) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.01
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3036190:MainThread](2024-04-25 03:00:31,300) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3036190:MainThread](2024-04-25 03:00:31,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
[3036190:MainThread](2024-04-25 03:00:34,074) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name MLP_crowd_data_csi300_360_rankTrue_47.
[3036190:MainThread](2024-04-25 03:00:34,087) INFO - qlib.workflow - [exp.py:258] - Experiment 21 starts running ...
[3036190:MainThread](2024-04-25 03:00:34,098) INFO - qlib.workflow - [recorder.py:341] - Recorder 956903f10a8147f5a19d9a82330c28cd starts running under Experiment 21 ...
[3036190:MainThread](2024-04-25 03:00:41,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[3036190:MainThread](2024-04-25 03:00:41,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 4.919164, valid_loss 1.114924, train_metric nan, valid_metric 0.013630
[3036190:MainThread](2024-04-25 03:00:41,701) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.114924, save checkpoint.
[3036190:MainThread](2024-04-25 03:00:41,895) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.080868, valid_loss 1.006937, train_metric nan, valid_metric -0.003922
[3036190:MainThread](2024-04-25 03:00:41,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.114924 to 1.006937, save checkpoint.
[3036190:MainThread](2024-04-25 03:00:42,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.024447, valid_loss 1.001751, train_metric nan, valid_metric 0.024258
[3036190:MainThread](2024-04-25 03:00:42,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006937 to 1.001751, save checkpoint.
[3036190:MainThread](2024-04-25 03:00:42,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.013890, valid_loss 0.998272, train_metric nan, valid_metric 0.019465
[3036190:MainThread](2024-04-25 03:00:42,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001751 to 0.998272, save checkpoint.
[3036190:MainThread](2024-04-25 03:00:42,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.016083, valid_loss 1.000174, train_metric nan, valid_metric 0.024497
[3036190:MainThread](2024-04-25 03:00:42,630) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.012381, valid_loss 1.000087, train_metric nan, valid_metric 0.027338
[3036190:MainThread](2024-04-25 03:00:42,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.011605, valid_loss 0.998506, train_metric nan, valid_metric 0.023995
[3036190:MainThread](2024-04-25 03:00:42,931) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.010903, valid_loss 0.999050, train_metric nan, valid_metric 0.016886
[3036190:MainThread](2024-04-25 03:00:43,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.014688, valid_loss 0.998767, train_metric nan, valid_metric 0.024061
[3036190:MainThread](2024-04-25 03:00:43,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.009872, valid_loss 0.998939, train_metric nan, valid_metric 0.019712
[3036190:MainThread](2024-04-25 03:00:43,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.010650, valid_loss 0.998965, train_metric nan, valid_metric 0.025886
[3036190:MainThread](2024-04-25 03:00:43,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.009834, valid_loss 0.999961, train_metric nan, valid_metric 0.006699
[3036190:MainThread](2024-04-25 03:00:43,782) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.011733, valid_loss 0.998457, train_metric nan, valid_metric 0.026929
[3036190:MainThread](2024-04-25 03:00:43,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.004954, valid_loss 0.998362, train_metric nan, valid_metric 0.018065
[3036190:MainThread](2024-04-25 03:00:44,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.007764, valid_loss 0.998290, train_metric nan, valid_metric 0.019244
[3036190:MainThread](2024-04-25 03:00:44,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.001751, valid_loss 0.998311, train_metric nan, valid_metric 0.023749
[3036190:MainThread](2024-04-25 03:00:44,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.008165, valid_loss 0.998635, train_metric nan, valid_metric 0.031250
[3036190:MainThread](2024-04-25 03:00:44,677) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.003004, valid_loss 0.998216, train_metric nan, valid_metric 0.029653
[3036190:MainThread](2024-04-25 03:00:44,678) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998272 to 0.998216, save checkpoint.
[3036190:MainThread](2024-04-25 03:00:44,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.005970, valid_loss 0.998737, train_metric nan, valid_metric 0.017189
[3036190:MainThread](2024-04-25 03:00:44,996) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.008566, valid_loss 0.998493, train_metric nan, valid_metric 0.026395
[3036190:MainThread](2024-04-25 03:00:45,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.002746, valid_loss 0.998708, train_metric nan, valid_metric 0.023990
[3036190:MainThread](2024-04-25 03:00:45,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.002766, valid_loss 0.998251, train_metric nan, valid_metric 0.022817
[3036190:MainThread](2024-04-25 03:00:45,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.000973, valid_loss 1.000303, train_metric nan, valid_metric 0.028908
[3036190:MainThread](2024-04-25 03:00:45,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.002503, valid_loss 1.000508, train_metric nan, valid_metric 0.028710
[3036190:MainThread](2024-04-25 03:00:45,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.997885, valid_loss 0.998282, train_metric nan, valid_metric 0.027152
[3036190:MainThread](2024-04-25 03:00:45,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.994076, valid_loss 0.999461, train_metric nan, valid_metric 0.030354
[3036190:MainThread](2024-04-25 03:00:46,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.997139, valid_loss 1.000199, train_metric nan, valid_metric 0.015363
[3036190:MainThread](2024-04-25 03:00:46,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.000703, valid_loss 0.998364, train_metric nan, valid_metric 0.024543
[3036190:MainThread](2024-04-25 03:00:46,444) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 1.001305, valid_loss 0.999403, train_metric nan, valid_metric 0.021527
[3036190:MainThread](2024-04-25 03:00:46,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.994568, valid_loss 0.999376, train_metric nan, valid_metric 0.023723
[3036190:MainThread](2024-04-25 03:00:46,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.000841, valid_loss 0.998539, train_metric nan, valid_metric 0.027061
[3036190:MainThread](2024-04-25 03:00:46,936) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.995758, valid_loss 0.999302, train_metric nan, valid_metric 0.024144
[3036190:MainThread](2024-04-25 03:00:47,105) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.998952, valid_loss 0.998677, train_metric nan, valid_metric 0.029149
[3036190:MainThread](2024-04-25 03:00:47,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.996381, valid_loss 1.000514, train_metric nan, valid_metric 0.026404
[3036190:MainThread](2024-04-25 03:00:47,437) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.992411, valid_loss 0.997921, train_metric nan, valid_metric 0.024415
[3036190:MainThread](2024-04-25 03:00:47,437) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998216 to 0.997921, save checkpoint.
[3036190:MainThread](2024-04-25 03:00:47,598) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.995060, valid_loss 0.997952, train_metric nan, valid_metric 0.026481
[3036190:MainThread](2024-04-25 03:00:47,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.999897, valid_loss 1.000139, train_metric nan, valid_metric 0.028267
[3036190:MainThread](2024-04-25 03:00:47,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.001266, valid_loss 0.998782, train_metric nan, valid_metric 0.024817
[3036190:MainThread](2024-04-25 03:00:48,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.996027, valid_loss 0.998746, train_metric nan, valid_metric 0.028882
[3036190:MainThread](2024-04-25 03:00:48,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.995499, valid_loss 0.998523, train_metric nan, valid_metric 0.031472
[3036190:MainThread](2024-04-25 03:00:48,427) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.989030, valid_loss 0.999520, train_metric nan, valid_metric 0.031651
[3036190:MainThread](2024-04-25 03:00:48,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.994979, valid_loss 0.999968, train_metric nan, valid_metric 0.013671
[3036190:MainThread](2024-04-25 03:00:48,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.995546, valid_loss 1.000279, train_metric nan, valid_metric 0.008316
[3036190:MainThread](2024-04-25 03:00:48,926) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.996433, valid_loss 0.999832, train_metric nan, valid_metric 0.029146
[3036190:MainThread](2024-04-25 03:00:49,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.993963, valid_loss 0.999282, train_metric nan, valid_metric 0.029345
[3036190:MainThread](2024-04-25 03:00:49,261) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.995481, valid_loss 0.998503, train_metric nan, valid_metric 0.031798
[3036190:MainThread](2024-04-25 03:00:49,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.998500, valid_loss 0.998363, train_metric nan, valid_metric 0.032413
[3036190:MainThread](2024-04-25 03:00:49,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.991396, valid_loss 1.001073, train_metric nan, valid_metric 0.007204
[3036190:MainThread](2024-04-25 03:00:49,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.993544, valid_loss 0.998706, train_metric nan, valid_metric 0.029792
[3036190:MainThread](2024-04-25 03:00:49,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.996153, valid_loss 1.003074, train_metric nan, valid_metric 0.000217
[3036190:MainThread](2024-04-25 03:00:50,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.993805, valid_loss 0.998867, train_metric nan, valid_metric 0.026924
[3036190:MainThread](2024-04-25 03:00:50,257) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.999445, valid_loss 0.998168, train_metric nan, valid_metric 0.030829
[3036190:MainThread](2024-04-25 03:00:50,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.992123, valid_loss 1.000059, train_metric nan, valid_metric 0.014835
[3036190:MainThread](2024-04-25 03:00:50,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.998605, valid_loss 0.998936, train_metric nan, valid_metric 0.030267
[3036190:MainThread](2024-04-25 03:00:50,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.996866, valid_loss 0.998223, train_metric nan, valid_metric 0.028531
[3036190:MainThread](2024-04-25 03:00:51,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.993538, valid_loss 0.998515, train_metric nan, valid_metric 0.033225
[3036190:MainThread](2024-04-25 03:00:51,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.995433, valid_loss 0.997900, train_metric nan, valid_metric 0.031083
[3036190:MainThread](2024-04-25 03:00:51,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997921 to 0.997900, save checkpoint.
[3036190:MainThread](2024-04-25 03:00:51,376) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.995227, valid_loss 0.997866, train_metric nan, valid_metric 0.032912
[3036190:MainThread](2024-04-25 03:00:51,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997900 to 0.997866, save checkpoint.
[3036190:MainThread](2024-04-25 03:00:51,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.999118, valid_loss 0.998359, train_metric nan, valid_metric 0.031657
[3036190:MainThread](2024-04-25 03:00:51,755) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.997140, valid_loss 0.999674, train_metric nan, valid_metric 0.029686
[3036190:MainThread](2024-04-25 03:00:51,957) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.993651, valid_loss 0.999063, train_metric nan, valid_metric 0.024974
[3036190:MainThread](2024-04-25 03:00:52,158) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.995039, valid_loss 1.000274, train_metric nan, valid_metric 0.028604
[3036190:MainThread](2024-04-25 03:00:52,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.998898, valid_loss 0.998343, train_metric nan, valid_metric 0.024665
[3036190:MainThread](2024-04-25 03:00:52,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.995817, valid_loss 0.997940, train_metric nan, valid_metric 0.028792
[3036190:MainThread](2024-04-25 03:00:52,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.991841, valid_loss 1.002391, train_metric nan, valid_metric 0.030319
[3036190:MainThread](2024-04-25 03:00:52,885) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.993930, valid_loss 1.000842, train_metric nan, valid_metric 0.034529
[3036190:MainThread](2024-04-25 03:00:53,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.996604, valid_loss 1.001504, train_metric nan, valid_metric 0.031822
[3036190:MainThread](2024-04-25 03:00:53,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.992788, valid_loss 0.999033, train_metric nan, valid_metric 0.018258
[3036190:MainThread](2024-04-25 03:00:53,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.993093, valid_loss 0.998773, train_metric nan, valid_metric 0.025330
[3036190:MainThread](2024-04-25 03:00:53,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.990287, valid_loss 0.998655, train_metric nan, valid_metric 0.037158
[3036190:MainThread](2024-04-25 03:00:53,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.995197, valid_loss 1.000996, train_metric nan, valid_metric 0.034339
[3036190:MainThread](2024-04-25 03:00:53,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.995636, valid_loss 0.998334, train_metric nan, valid_metric 0.029202
[3036190:MainThread](2024-04-25 03:00:54,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.998253, valid_loss 0.999142, train_metric nan, valid_metric 0.021345
[3036190:MainThread](2024-04-25 03:00:54,192) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.990000, valid_loss 0.997984, train_metric nan, valid_metric 0.032238
[3036190:MainThread](2024-04-25 03:00:54,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.994507, valid_loss 0.998388, train_metric nan, valid_metric 0.033466
[3036190:MainThread](2024-04-25 03:00:54,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.991296, valid_loss 0.999077, train_metric nan, valid_metric 0.018658
[3036190:MainThread](2024-04-25 03:00:54,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.993684, valid_loss 0.998715, train_metric nan, valid_metric 0.031294
[3036190:MainThread](2024-04-25 03:00:54,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.993324, valid_loss 1.001264, train_metric nan, valid_metric 0.018809
[3036190:MainThread](2024-04-25 03:00:55,028) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.996948, valid_loss 0.998024, train_metric nan, valid_metric 0.033944
[3036190:MainThread](2024-04-25 03:00:55,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.994932, valid_loss 0.999316, train_metric nan, valid_metric 0.030596
[3036190:MainThread](2024-04-25 03:00:55,364) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.994530, valid_loss 0.998270, train_metric nan, valid_metric 0.033802
[3036190:MainThread](2024-04-25 03:00:55,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.992938, valid_loss 0.998657, train_metric nan, valid_metric 0.032580
[3036190:MainThread](2024-04-25 03:00:55,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.992298, valid_loss 1.000811, train_metric nan, valid_metric 0.027971
[3036190:MainThread](2024-04-25 03:00:55,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.993169, valid_loss 0.999639, train_metric nan, valid_metric 0.033715
[3036190:MainThread](2024-04-25 03:00:56,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.992355, valid_loss 0.998723, train_metric nan, valid_metric 0.033596
[3036190:MainThread](2024-04-25 03:00:56,196) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.986861, valid_loss 1.004266, train_metric nan, valid_metric 0.034647
[3036190:MainThread](2024-04-25 03:00:56,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.991984, valid_loss 0.999136, train_metric nan, valid_metric 0.018413
[3036190:MainThread](2024-04-25 03:00:56,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.990105, valid_loss 0.997710, train_metric nan, valid_metric 0.030434
[3036190:MainThread](2024-04-25 03:00:56,533) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997866 to 0.997710, save checkpoint.
[3036190:MainThread](2024-04-25 03:00:56,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.991620, valid_loss 0.997997, train_metric nan, valid_metric 0.028674
[3036190:MainThread](2024-04-25 03:00:56,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.986816, valid_loss 0.998509, train_metric nan, valid_metric 0.030574
[3036190:MainThread](2024-04-25 03:00:57,039) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.994806, valid_loss 1.000023, train_metric nan, valid_metric 0.034310
[3036190:MainThread](2024-04-25 03:00:57,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.992779, valid_loss 0.998418, train_metric nan, valid_metric 0.031151
[3036190:MainThread](2024-04-25 03:00:57,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.995949, valid_loss 0.998717, train_metric nan, valid_metric 0.029565
[3036190:MainThread](2024-04-25 03:00:57,552) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.991019, valid_loss 0.998130, train_metric nan, valid_metric 0.030880
[3036190:MainThread](2024-04-25 03:00:57,726) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.998755, valid_loss 1.000575, train_metric nan, valid_metric 0.015119
[3036190:MainThread](2024-04-25 03:00:57,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.998038, valid_loss 0.998809, train_metric nan, valid_metric 0.028374
[3036190:MainThread](2024-04-25 03:00:58,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.993118, valid_loss 1.001586, train_metric nan, valid_metric 0.034384
[3036190:MainThread](2024-04-25 03:00:58,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.988878, valid_loss 0.997964, train_metric nan, valid_metric 0.029838
[3036190:MainThread](2024-04-25 03:00:58,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.993632, valid_loss 1.000782, train_metric nan, valid_metric 0.018677
[3036190:MainThread](2024-04-25 03:00:58,582) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.994458, valid_loss 0.998330, train_metric nan, valid_metric 0.031411
[3036190:MainThread](2024-04-25 03:00:58,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.990392, valid_loss 1.001636, train_metric nan, valid_metric 0.017464
[3036190:MainThread](2024-04-25 03:00:58,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.988543, valid_loss 0.998707, train_metric nan, valid_metric 0.028195
[3036190:MainThread](2024-04-25 03:00:59,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.992338, valid_loss 1.000901, train_metric nan, valid_metric 0.037391
[3036190:MainThread](2024-04-25 03:00:59,261) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.997525, valid_loss 1.000058, train_metric nan, valid_metric 0.029679
[3036190:MainThread](2024-04-25 03:00:59,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.993441, valid_loss 1.003465, train_metric nan, valid_metric 0.034231
[3036190:MainThread](2024-04-25 03:00:59,599) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 0.996769, valid_loss 1.004120, train_metric nan, valid_metric 0.034089
[3036190:MainThread](2024-04-25 03:00:59,774) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.988930, valid_loss 1.000804, train_metric nan, valid_metric 0.031588
[3036190:MainThread](2024-04-25 03:00:59,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 0.991660, valid_loss 0.999599, train_metric nan, valid_metric 0.035360
[3036190:MainThread](2024-04-25 03:01:00,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 0.987517, valid_loss 1.001290, train_metric nan, valid_metric 0.033642
[3036190:MainThread](2024-04-25 03:01:00,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 0.990719, valid_loss 0.999249, train_metric nan, valid_metric 0.032593
[3036190:MainThread](2024-04-25 03:01:00,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 0.990198, valid_loss 0.999684, train_metric nan, valid_metric 0.016620
[3036190:MainThread](2024-04-25 03:01:00,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 0.987940, valid_loss 0.997238, train_metric nan, valid_metric 0.033813
[3036190:MainThread](2024-04-25 03:01:00,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997710 to 0.997238, save checkpoint.
[3036190:MainThread](2024-04-25 03:01:00,784) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 0.991723, valid_loss 1.000458, train_metric nan, valid_metric 0.019055
[3036190:MainThread](2024-04-25 03:01:00,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 0.992932, valid_loss 1.000229, train_metric nan, valid_metric 0.037682
[3036190:MainThread](2024-04-25 03:01:01,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 0.993801, valid_loss 0.999778, train_metric nan, valid_metric 0.024708
[3036190:MainThread](2024-04-25 03:01:01,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 0.990197, valid_loss 0.998068, train_metric nan, valid_metric 0.032516
[3036190:MainThread](2024-04-25 03:01:01,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 0.989971, valid_loss 0.997760, train_metric nan, valid_metric 0.033764
[3036190:MainThread](2024-04-25 03:01:01,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 0.991542, valid_loss 1.000917, train_metric nan, valid_metric 0.032045
[3036190:MainThread](2024-04-25 03:01:01,796) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 0.991374, valid_loss 0.999378, train_metric nan, valid_metric 0.026534
[3036190:MainThread](2024-04-25 03:01:01,968) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 0.993163, valid_loss 0.998740, train_metric nan, valid_metric 0.034882
[3036190:MainThread](2024-04-25 03:01:02,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 0.992569, valid_loss 0.999533, train_metric nan, valid_metric 0.033668
[3036190:MainThread](2024-04-25 03:01:02,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 0.992541, valid_loss 0.998252, train_metric nan, valid_metric 0.034112
[3036190:MainThread](2024-04-25 03:01:02,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 0.988925, valid_loss 0.998845, train_metric nan, valid_metric 0.031507
[3036190:MainThread](2024-04-25 03:01:02,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 0.990099, valid_loss 1.003401, train_metric nan, valid_metric 0.034604
[3036190:MainThread](2024-04-25 03:01:02,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 0.991474, valid_loss 1.006606, train_metric nan, valid_metric 0.032644
[3036190:MainThread](2024-04-25 03:01:03,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 0.997362, valid_loss 0.998006, train_metric nan, valid_metric 0.032839
[3036190:MainThread](2024-04-25 03:01:03,176) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 0.988869, valid_loss 0.998813, train_metric nan, valid_metric 0.030629
[3036190:MainThread](2024-04-25 03:01:03,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 0.992831, valid_loss 0.998772, train_metric nan, valid_metric 0.030393
[3036190:MainThread](2024-04-25 03:01:03,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 0.991676, valid_loss 1.000686, train_metric nan, valid_metric 0.027289
[3036190:MainThread](2024-04-25 03:01:03,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 0.995738, valid_loss 1.003703, train_metric nan, valid_metric 0.033077
[3036190:MainThread](2024-04-25 03:01:03,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 0.998024, valid_loss 0.997437, train_metric nan, valid_metric 0.030042
[3036190:MainThread](2024-04-25 03:01:04,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 0.989248, valid_loss 1.002349, train_metric nan, valid_metric 0.036060
[3036190:MainThread](2024-04-25 03:01:04,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 0.988683, valid_loss 0.998447, train_metric nan, valid_metric 0.030882
[3036190:MainThread](2024-04-25 03:01:04,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 0.988606, valid_loss 1.000808, train_metric nan, valid_metric 0.039517
[3036190:MainThread](2024-04-25 03:01:04,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 0.993578, valid_loss 0.998822, train_metric nan, valid_metric 0.030306
[3036190:MainThread](2024-04-25 03:01:04,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 0.996866, valid_loss 0.999426, train_metric nan, valid_metric 0.027930
[3036190:MainThread](2024-04-25 03:01:04,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 0.996236, valid_loss 1.000787, train_metric nan, valid_metric 0.026181
[3036190:MainThread](2024-04-25 03:01:05,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2760]: train_loss 0.996493, valid_loss 1.001883, train_metric nan, valid_metric 0.017954
[3036190:MainThread](2024-04-25 03:01:05,251) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2780]: train_loss 0.991330, valid_loss 0.998959, train_metric nan, valid_metric 0.029993
[3036190:MainThread](2024-04-25 03:01:05,427) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2800]: train_loss 0.989993, valid_loss 1.000213, train_metric nan, valid_metric 0.029777
[3036190:MainThread](2024-04-25 03:01:05,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2820]: train_loss 0.988463, valid_loss 1.003236, train_metric nan, valid_metric 0.032702
[3036190:MainThread](2024-04-25 03:01:05,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2840]: train_loss 0.991068, valid_loss 1.000193, train_metric nan, valid_metric 0.039056
[3036190:MainThread](2024-04-25 03:01:05,931) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2860]: train_loss 0.987932, valid_loss 1.000135, train_metric nan, valid_metric 0.037979
[3036190:MainThread](2024-04-25 03:01:06,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2880]: train_loss 0.995691, valid_loss 1.005210, train_metric nan, valid_metric 0.037742
[3036190:MainThread](2024-04-25 03:01:06,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2900]: train_loss 0.996142, valid_loss 0.999040, train_metric nan, valid_metric 0.027675
[3036190:MainThread](2024-04-25 03:01:06,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2920]: train_loss 0.996047, valid_loss 1.000234, train_metric nan, valid_metric 0.024526
[3036190:MainThread](2024-04-25 03:01:06,607) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2940]: train_loss 0.993105, valid_loss 1.000314, train_metric nan, valid_metric 0.021365
[3036190:MainThread](2024-04-25 03:01:06,774) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2960]: train_loss 0.990858, valid_loss 1.000905, train_metric nan, valid_metric 0.026606
[3036190:MainThread](2024-04-25 03:01:06,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2980]: train_loss 0.993368, valid_loss 1.006442, train_metric nan, valid_metric 0.010703
[3036190:MainThread](2024-04-25 03:01:07,114) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3000]: train_loss 0.984000, valid_loss 0.999762, train_metric nan, valid_metric 0.035833
[3036190:MainThread](2024-04-25 03:01:07,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3020]: train_loss 0.991471, valid_loss 0.997642, train_metric nan, valid_metric 0.040515
[3036190:MainThread](2024-04-25 03:01:07,442) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3040]: train_loss 0.987354, valid_loss 1.013098, train_metric nan, valid_metric 0.036365
[3036190:MainThread](2024-04-25 03:01:07,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3060]: train_loss 0.993461, valid_loss 0.999528, train_metric nan, valid_metric 0.036463
[3036190:MainThread](2024-04-25 03:01:07,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3080]: train_loss 0.991735, valid_loss 0.998572, train_metric nan, valid_metric 0.038074
[3036190:MainThread](2024-04-25 03:01:07,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3100]: train_loss 0.988254, valid_loss 1.002372, train_metric nan, valid_metric 0.021503
[3036190:MainThread](2024-04-25 03:01:08,107) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3120]: train_loss 0.986545, valid_loss 0.998564, train_metric nan, valid_metric 0.033635
[3036190:MainThread](2024-04-25 03:01:08,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3140]: train_loss 0.990091, valid_loss 1.000508, train_metric nan, valid_metric 0.036319
[3036190:MainThread](2024-04-25 03:01:08,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3160]: train_loss 0.996554, valid_loss 1.000935, train_metric nan, valid_metric 0.040084
[3036190:MainThread](2024-04-25 03:01:08,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3180]: train_loss 0.991105, valid_loss 0.998509, train_metric nan, valid_metric 0.036362
[3036190:MainThread](2024-04-25 03:01:08,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3200]: train_loss 0.990579, valid_loss 0.998338, train_metric nan, valid_metric 0.035930
[3036190:MainThread](2024-04-25 03:01:08,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3220]: train_loss 0.991462, valid_loss 0.998602, train_metric nan, valid_metric 0.027406
[3036190:MainThread](2024-04-25 03:01:09,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 3240]: train_loss 0.989694, valid_loss 0.998763, train_metric nan, valid_metric 0.034955
[3036190:MainThread](2024-04-25 03:01:09,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[3036190:MainThread](2024-04-25 03:01:09,128) INFO - qlib.timer - [log.py:127] - Time cost: 0.001s | waiting `async_log` Done
Save pretrained model to MLP_crowd_data_csi300_360_rankTrue_47.
[3036190:MainThread](2024-04-25 03:01:09,334) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3036190:MainThread](2024-04-25 03:01:09,345) INFO - qlib.workflow - [recorder.py:341] - Recorder f729a4d91707470e9cdbf0a7f4795698 starts running under Experiment 17 ...
{'IC': 0.026994334331438982,
 'ICIR': 0.2055005402854329,
 'Rank IC': 0.032984373539418264,
 'Rank ICIR': 0.2471184880035974}
[3036190:MainThread](2024-04-25 03:01:15,486) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3036190:MainThread](2024-04-25 03:01:53,595) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 03:01:53,598) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 03:01:59,697) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fc44e4709a0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:28, 10.89it/s]backtest loop:   1%|          | 9/971 [00:00<00:36, 26.69it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:26, 36.27it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.71it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 44.41it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 47.56it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:19, 46.87it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:18, 49.45it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 51.04it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 49.09it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 50.86it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 52.20it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 53.39it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 53.85it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 51.11it/s]backtest loop:  10%|▉         | 93/971 [00:01<00:16, 52.19it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 52.94it/s]backtest loop:  11%|█         | 105/971 [00:02<00:16, 53.53it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:15, 54.05it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 51.03it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 52.20it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:16, 49.88it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:16, 51.31it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:16, 49.31it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:16, 50.93it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 51.93it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 52.50it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:15, 53.24it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 50.95it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:15, 52.15it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 53.00it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:14, 53.72it/s]backtest loop:  20%|██        | 195/971 [00:03<00:15, 50.83it/s]backtest loop:  21%|██        | 201/971 [00:04<00:14, 52.34it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:14, 53.12it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:14, 51.07it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:14, 52.33it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:14, 50.00it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:14, 51.44it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:14, 52.39it/s]backtest loop:  25%|██▌       | 243/971 [00:04<00:13, 53.15it/s]backtest loop:  26%|██▌       | 249/971 [00:05<00:14, 50.73it/s]backtest loop:  26%|██▋       | 255/971 [00:05<00:13, 52.33it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:13, 53.28it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:13, 50.77it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:13, 51.97it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:13, 52.90it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:12, 53.37it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:13, 50.63it/s]backtest loop:  31%|███       | 297/971 [00:05<00:12, 52.69it/s]backtest loop:  31%|███       | 303/971 [00:06<00:12, 53.37it/s]backtest loop:  32%|███▏      | 309/971 [00:06<00:12, 53.95it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:12, 51.01it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:12, 52.16it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:12, 52.97it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:11, 53.62it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:11, 54.20it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:12, 51.05it/s]backtest loop:  36%|███▌      | 351/971 [00:06<00:11, 52.25it/s]backtest loop:  37%|███▋      | 357/971 [00:07<00:11, 53.15it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:11, 50.90it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:12, 49.06it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 50.76it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:11, 51.97it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:11, 52.78it/s]backtest loop:  40%|████      | 393/971 [00:07<00:11, 50.44it/s]backtest loop:  41%|████      | 399/971 [00:07<00:11, 51.72it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:10, 52.81it/s]backtest loop:  42%|████▏     | 411/971 [00:08<00:10, 53.44it/s]backtest loop:  43%|████▎     | 417/971 [00:08<00:15, 34.80it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:14, 37.38it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:13, 41.35it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:11, 44.73it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:11, 47.40it/s]backtest loop:  46%|████▌     | 447/971 [00:09<00:11, 46.74it/s]backtest loop:  47%|████▋     | 453/971 [00:09<00:10, 48.61it/s]backtest loop:  47%|████▋     | 459/971 [00:09<00:10, 50.35it/s]backtest loop:  48%|████▊     | 465/971 [00:09<00:09, 51.66it/s]backtest loop:  49%|████▊     | 471/971 [00:09<00:09, 52.66it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 50.26it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:09, 51.66it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:09, 52.63it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:09, 50.24it/s]backtest loop:  52%|█████▏    | 501/971 [00:10<00:09, 51.62it/s]backtest loop:  52%|█████▏    | 507/971 [00:10<00:09, 49.61it/s]backtest loop:  53%|█████▎    | 513/971 [00:10<00:08, 51.12it/s]backtest loop:  53%|█████▎    | 519/971 [00:10<00:08, 52.41it/s]backtest loop:  54%|█████▍    | 525/971 [00:10<00:08, 53.24it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 50.08it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:08, 51.51it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:08, 52.65it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 53.31it/s]backtest loop:  57%|█████▋    | 555/971 [00:11<00:07, 53.77it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:08, 50.60it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:07, 51.80it/s]backtest loop:  59%|█████▉    | 573/971 [00:11<00:07, 52.69it/s]backtest loop:  60%|█████▉    | 579/971 [00:11<00:07, 53.49it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:07, 54.28it/s]backtest loop:  61%|██████    | 591/971 [00:11<00:07, 51.25it/s]backtest loop:  61%|██████▏   | 597/971 [00:11<00:07, 52.32it/s]backtest loop:  62%|██████▏   | 603/971 [00:11<00:06, 53.13it/s]backtest loop:  63%|██████▎   | 609/971 [00:12<00:06, 53.44it/s]backtest loop:  63%|██████▎   | 615/971 [00:12<00:06, 50.94it/s]backtest loop:  64%|██████▍   | 621/971 [00:12<00:06, 51.71it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:06, 52.96it/s]backtest loop:  65%|██████▌   | 633/971 [00:12<00:06, 53.51it/s]backtest loop:  66%|██████▌   | 639/971 [00:12<00:06, 54.20it/s]backtest loop:  66%|██████▋   | 645/971 [00:12<00:06, 51.29it/s]backtest loop:  67%|██████▋   | 651/971 [00:12<00:06, 52.01it/s]backtest loop:  68%|██████▊   | 657/971 [00:13<00:05, 52.84it/s]backtest loop:  68%|██████▊   | 663/971 [00:13<00:05, 53.48it/s]backtest loop:  69%|██████▉   | 669/971 [00:13<00:05, 53.92it/s]backtest loop:  70%|██████▉   | 675/971 [00:13<00:05, 50.92it/s]backtest loop:  70%|███████   | 681/971 [00:13<00:05, 51.53it/s]backtest loop:  71%|███████   | 687/971 [00:13<00:05, 52.39it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:05, 53.19it/s]backtest loop:  72%|███████▏  | 699/971 [00:13<00:05, 50.55it/s]backtest loop:  73%|███████▎  | 705/971 [00:13<00:05, 51.81it/s]backtest loop:  73%|███████▎  | 711/971 [00:14<00:04, 52.43it/s]backtest loop:  74%|███████▍  | 717/971 [00:14<00:04, 53.35it/s]backtest loop:  74%|███████▍  | 723/971 [00:14<00:04, 54.06it/s]backtest loop:  75%|███████▌  | 729/971 [00:14<00:04, 51.51it/s]backtest loop:  76%|███████▌  | 735/971 [00:14<00:04, 49.58it/s]backtest loop:  76%|███████▋  | 741/971 [00:14<00:04, 50.63it/s]backtest loop:  77%|███████▋  | 747/971 [00:14<00:04, 51.85it/s]backtest loop:  78%|███████▊  | 753/971 [00:14<00:04, 49.60it/s]backtest loop:  78%|███████▊  | 759/971 [00:14<00:04, 50.94it/s]backtest loop:  79%|███████▉  | 765/971 [00:15<00:04, 49.16it/s]backtest loop:  79%|███████▉  | 771/971 [00:15<00:03, 50.59it/s]backtest loop:  80%|████████  | 777/971 [00:15<00:03, 52.01it/s]backtest loop:  81%|████████  | 783/971 [00:15<00:03, 50.05it/s]backtest loop:  81%|████████▏ | 789/971 [00:15<00:03, 51.50it/s]backtest loop:  82%|████████▏ | 795/971 [00:15<00:03, 52.56it/s]backtest loop:  82%|████████▏ | 801/971 [00:15<00:03, 52.89it/s]backtest loop:  83%|████████▎ | 807/971 [00:15<00:03, 53.41it/s]backtest loop:  84%|████████▎ | 813/971 [00:16<00:03, 50.72it/s]backtest loop:  84%|████████▍ | 819/971 [00:16<00:02, 51.94it/s]backtest loop:  85%|████████▍ | 825/971 [00:16<00:02, 52.83it/s]backtest loop:  86%|████████▌ | 831/971 [00:16<00:02, 53.13it/s]backtest loop:  86%|████████▌ | 837/971 [00:16<00:02, 53.14it/s]backtest loop:  87%|████████▋ | 843/971 [00:16<00:02, 50.53it/s]backtest loop:  87%|████████▋ | 849/971 [00:16<00:02, 51.81it/s]backtest loop:  88%|████████▊ | 855/971 [00:16<00:02, 52.76it/s]backtest loop:  89%|████████▊ | 861/971 [00:16<00:02, 53.17it/s]backtest loop:  89%|████████▉ | 867/971 [00:17<00:02, 50.64it/s]backtest loop:  90%|████████▉ | 873/971 [00:17<00:01, 51.95it/s]backtest loop:  91%|█████████ | 879/971 [00:17<00:01, 52.85it/s]backtest loop:  91%|█████████ | 885/971 [00:17<00:01, 53.55it/s]backtest loop:  92%|█████████▏| 891/971 [00:17<00:01, 53.82it/s]backtest loop:  92%|█████████▏| 897/971 [00:17<00:01, 50.85it/s]backtest loop:  93%|█████████▎| 903/971 [00:17<00:01, 52.05it/s]backtest loop:  94%|█████████▎| 909/971 [00:17<00:01, 52.90it/s]backtest loop:  94%|█████████▍| 915/971 [00:17<00:01, 53.50it/s]backtest loop:  95%|█████████▍| 921/971 [00:18<00:00, 50.59it/s]backtest loop:  95%|█████████▌| 927/971 [00:18<00:00, 51.72it/s]backtest loop:  96%|█████████▌| 933/971 [00:18<00:00, 52.55it/s]backtest loop:  97%|█████████▋| 939/971 [00:18<00:00, 53.26it/s]backtest loop:  97%|█████████▋| 945/971 [00:18<00:00, 50.63it/s]backtest loop:  98%|█████████▊| 951/971 [00:18<00:00, 52.07it/s]backtest loop:  99%|█████████▊| 957/971 [00:18<00:00, 52.81it/s]backtest loop:  99%|█████████▉| 963/971 [00:18<00:00, 53.47it/s]backtest loop: 100%|█████████▉| 969/971 [00:19<00:00, 53.94it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 50.95it/s]
[3036190:MainThread](2024-04-25 03:02:18,812) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000725
std                0.005135
annualized_return  0.172510
information_ratio  2.177693
max_drawdown      -0.072031
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000526
std                0.005136
annualized_return  0.125089
information_ratio  1.578777
max_drawdown      -0.079788
[3036190:MainThread](2024-04-25 03:02:18,825) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `MLP_crowd_data_csi300_360_rankTrue`.
[3036190:MainThread](2024-04-25 03:02:25,401) INFO - qlib.timer - [log.py:127] - Time cost: 0.006s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.09660888993280313,
                                                    0.13562370991980652,
                                                    0.06660464834929007,
                                                    0.11273109897819915,
                                                    0.12508853654933336],
 '1day.excess_return_with_cost.information_ratio': [0.9965334629357873,
                                                    1.471462498466688,
                                                    0.8574204686978396,
                                                    1.1783584885283203,
                                                    1.5787766589453898],
 '1day.excess_return_with_cost.max_drawdown': [-0.178625820283921,
                                               -0.12757703738688353,
                                               -0.0913209010721612,
                                               -0.11249516827526612,
                                               -0.07978807685234823],
 'IC': [0.022102653552402936,
        0.02409782375001873,
        0.022686097788742136,
        0.02367574671522226,
        0.026994334331438982],
 'ICIR': [0.13898491673495106,
          0.15607704167026837,
          0.15786952974802382,
          0.14959396620968068,
          0.2055005402854329],
 'Rank IC': [0.025665075667307198,
             0.03148333316577824,
             0.030750383407579112,
             0.03557216907148577,
             0.032984373539418264],
 'Rank ICIR': [0.16136503534804983,
               0.21059379399912298,
               0.2200373329436436,
               0.2277897581780483,
               0.2471184880035974],
 'mae': [0.8644317750225282,
         0.8642435379012978,
         0.8642145420813768,
         0.8640649052148514,
         0.8641229436793894],
 'mse': [0.9972685662584836,
         0.9972602008572546,
         0.9967983457930604,
         0.9969556729191729,
         0.9972293304320696]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3036190:MainThread](2024-04-25 03:02:28,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3036190:MainThread](2024-04-25 03:02:28,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.01
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3036190:MainThread](2024-04-25 03:02:28,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3036190:MainThread](2024-04-25 03:02:28,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
[3036190:MainThread](2024-04-25 03:02:31,219) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name MLP_crowd_data_csi300_360_rankTrue_48.
[3036190:MainThread](2024-04-25 03:02:31,233) INFO - qlib.workflow - [exp.py:258] - Experiment 22 starts running ...
[3036190:MainThread](2024-04-25 03:02:31,242) INFO - qlib.workflow - [recorder.py:341] - Recorder 0035e6eb75a44a51b2114b9f180040a2 starts running under Experiment 22 ...
[3036190:MainThread](2024-04-25 03:02:36,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[3036190:MainThread](2024-04-25 03:02:37,050) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 1.623623, valid_loss 1.018151, train_metric nan, valid_metric 0.004536
[3036190:MainThread](2024-04-25 03:02:37,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.018151, save checkpoint.
[3036190:MainThread](2024-04-25 03:02:37,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.037451, valid_loss 1.001402, train_metric nan, valid_metric 0.015040
[3036190:MainThread](2024-04-25 03:02:37,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.018151 to 1.001402, save checkpoint.
[3036190:MainThread](2024-04-25 03:02:37,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.016161, valid_loss 0.999757, train_metric nan, valid_metric 0.014301
[3036190:MainThread](2024-04-25 03:02:37,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.001402 to 0.999757, save checkpoint.
[3036190:MainThread](2024-04-25 03:02:37,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.018244, valid_loss 0.998838, train_metric nan, valid_metric 0.012720
[3036190:MainThread](2024-04-25 03:02:37,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999757 to 0.998838, save checkpoint.
[3036190:MainThread](2024-04-25 03:02:37,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.010527, valid_loss 1.003876, train_metric nan, valid_metric 0.012541
[3036190:MainThread](2024-04-25 03:02:37,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.025758, valid_loss 0.998425, train_metric nan, valid_metric 0.022606
[3036190:MainThread](2024-04-25 03:02:37,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998838 to 0.998425, save checkpoint.
[3036190:MainThread](2024-04-25 03:02:37,984) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.008146, valid_loss 0.998876, train_metric nan, valid_metric 0.017337
[3036190:MainThread](2024-04-25 03:02:38,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.012511, valid_loss 1.001507, train_metric nan, valid_metric -0.003203
[3036190:MainThread](2024-04-25 03:02:38,289) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.000728, valid_loss 0.998838, train_metric nan, valid_metric 0.011425
[3036190:MainThread](2024-04-25 03:02:38,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.013056, valid_loss 1.006993, train_metric nan, valid_metric 0.021525
[3036190:MainThread](2024-04-25 03:02:38,607) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.005491, valid_loss 0.998924, train_metric nan, valid_metric 0.020172
[3036190:MainThread](2024-04-25 03:02:38,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.000432, valid_loss 1.000129, train_metric nan, valid_metric 0.005816
[3036190:MainThread](2024-04-25 03:02:38,936) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.999177, valid_loss 0.999099, train_metric nan, valid_metric 0.012657
[3036190:MainThread](2024-04-25 03:02:39,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.006142, valid_loss 0.998608, train_metric nan, valid_metric 0.018061
[3036190:MainThread](2024-04-25 03:02:39,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.007260, valid_loss 1.002902, train_metric nan, valid_metric 0.022900
[3036190:MainThread](2024-04-25 03:02:39,434) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 0.997635, valid_loss 0.997991, train_metric nan, valid_metric 0.020818
[3036190:MainThread](2024-04-25 03:02:39,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998425 to 0.997991, save checkpoint.
[3036190:MainThread](2024-04-25 03:02:39,623) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.000011, valid_loss 1.008258, train_metric nan, valid_metric 0.022913
[3036190:MainThread](2024-04-25 03:02:39,813) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.997465, valid_loss 0.999227, train_metric nan, valid_metric 0.021420
[3036190:MainThread](2024-04-25 03:02:40,005) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.000049, valid_loss 0.998901, train_metric nan, valid_metric 0.020068
[3036190:MainThread](2024-04-25 03:02:40,195) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.001254, valid_loss 1.000705, train_metric nan, valid_metric 0.022478
[3036190:MainThread](2024-04-25 03:02:40,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.996053, valid_loss 1.000609, train_metric nan, valid_metric 0.020109
[3036190:MainThread](2024-04-25 03:02:40,565) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.008413, valid_loss 0.998242, train_metric nan, valid_metric 0.021793
[3036190:MainThread](2024-04-25 03:02:40,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.000112, valid_loss 1.003117, train_metric nan, valid_metric 0.022971
[3036190:MainThread](2024-04-25 03:02:40,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.005057, valid_loss 1.002743, train_metric nan, valid_metric 0.021814
[3036190:MainThread](2024-04-25 03:02:41,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.991089, valid_loss 1.014966, train_metric nan, valid_metric -0.012379
[3036190:MainThread](2024-04-25 03:02:41,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.005160, valid_loss 0.999479, train_metric nan, valid_metric 0.011864
[3036190:MainThread](2024-04-25 03:02:41,364) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.007227, valid_loss 1.003704, train_metric nan, valid_metric 0.015281
[3036190:MainThread](2024-04-25 03:02:41,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.994803, valid_loss 0.999844, train_metric nan, valid_metric 0.013484
[3036190:MainThread](2024-04-25 03:02:41,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.993807, valid_loss 1.000143, train_metric nan, valid_metric 0.016716
[3036190:MainThread](2024-04-25 03:02:41,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.007284, valid_loss 1.001978, train_metric nan, valid_metric 0.004078
[3036190:MainThread](2024-04-25 03:02:41,983) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.999605, valid_loss 0.998825, train_metric nan, valid_metric 0.018143
[3036190:MainThread](2024-04-25 03:02:42,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.995032, valid_loss 0.998192, train_metric nan, valid_metric 0.019128
[3036190:MainThread](2024-04-25 03:02:42,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.005301, valid_loss 1.026640, train_metric nan, valid_metric -0.013787
[3036190:MainThread](2024-04-25 03:02:42,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.003393, valid_loss 1.000013, train_metric nan, valid_metric 0.025197
[3036190:MainThread](2024-04-25 03:02:42,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.002515, valid_loss 1.001917, train_metric nan, valid_metric 0.025340
[3036190:MainThread](2024-04-25 03:02:42,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.999130, valid_loss 1.001108, train_metric nan, valid_metric 0.015762
[3036190:MainThread](2024-04-25 03:02:42,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.995726, valid_loss 1.000210, train_metric nan, valid_metric 0.024452
[3036190:MainThread](2024-04-25 03:02:43,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.996079, valid_loss 1.003680, train_metric nan, valid_metric -0.000611
[3036190:MainThread](2024-04-25 03:02:43,281) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.997768, valid_loss 1.005813, train_metric nan, valid_metric -0.004036
[3036190:MainThread](2024-04-25 03:02:43,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.993897, valid_loss 1.002553, train_metric nan, valid_metric 0.025695
[3036190:MainThread](2024-04-25 03:02:43,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.993251, valid_loss 1.001230, train_metric nan, valid_metric 0.023622
[3036190:MainThread](2024-04-25 03:02:43,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.998117, valid_loss 0.999959, train_metric nan, valid_metric 0.027487
[3036190:MainThread](2024-04-25 03:02:44,017) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.995083, valid_loss 1.000824, train_metric nan, valid_metric 0.019232
[3036190:MainThread](2024-04-25 03:02:44,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.990337, valid_loss 0.999660, train_metric nan, valid_metric 0.024860
[3036190:MainThread](2024-04-25 03:02:44,386) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 1.000424, valid_loss 0.998621, train_metric nan, valid_metric 0.027689
[3036190:MainThread](2024-04-25 03:02:44,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.995593, valid_loss 0.999219, train_metric nan, valid_metric 0.020443
[3036190:MainThread](2024-04-25 03:02:44,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.998206, valid_loss 1.007777, train_metric nan, valid_metric 0.025962
[3036190:MainThread](2024-04-25 03:02:44,936) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.998606, valid_loss 1.000129, train_metric nan, valid_metric 0.019851
[3036190:MainThread](2024-04-25 03:02:45,119) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.997209, valid_loss 0.999380, train_metric nan, valid_metric 0.024738
[3036190:MainThread](2024-04-25 03:02:45,304) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.997303, valid_loss 1.002488, train_metric nan, valid_metric 0.002656
[3036190:MainThread](2024-04-25 03:02:45,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.994881, valid_loss 1.000074, train_metric nan, valid_metric 0.017364
[3036190:MainThread](2024-04-25 03:02:45,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.998852, valid_loss 1.007350, train_metric nan, valid_metric 0.022206
[3036190:MainThread](2024-04-25 03:02:45,868) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.993669, valid_loss 0.998343, train_metric nan, valid_metric 0.021314
[3036190:MainThread](2024-04-25 03:02:46,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.997110, valid_loss 0.997479, train_metric nan, valid_metric 0.025033
[3036190:MainThread](2024-04-25 03:02:46,058) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997991 to 0.997479, save checkpoint.
[3036190:MainThread](2024-04-25 03:02:46,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.002156, valid_loss 0.999671, train_metric nan, valid_metric 0.027027
[3036190:MainThread](2024-04-25 03:02:46,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 1.000340, valid_loss 0.997979, train_metric nan, valid_metric 0.026096
[3036190:MainThread](2024-04-25 03:02:46,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.991797, valid_loss 0.998707, train_metric nan, valid_metric 0.028988
[3036190:MainThread](2024-04-25 03:02:46,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.993216, valid_loss 0.999402, train_metric nan, valid_metric 0.017911
[3036190:MainThread](2024-04-25 03:02:46,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.993395, valid_loss 0.997414, train_metric nan, valid_metric 0.028555
[3036190:MainThread](2024-04-25 03:02:46,838) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997479 to 0.997414, save checkpoint.
[3036190:MainThread](2024-04-25 03:02:47,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.997704, valid_loss 1.001196, train_metric nan, valid_metric 0.009211
[3036190:MainThread](2024-04-25 03:02:47,215) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.994843, valid_loss 0.998292, train_metric nan, valid_metric 0.031392
[3036190:MainThread](2024-04-25 03:02:47,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.991196, valid_loss 1.005165, train_metric nan, valid_metric 0.004206
[3036190:MainThread](2024-04-25 03:02:47,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.992940, valid_loss 1.001790, train_metric nan, valid_metric 0.027238
[3036190:MainThread](2024-04-25 03:02:47,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.993806, valid_loss 1.000692, train_metric nan, valid_metric 0.012219
[3036190:MainThread](2024-04-25 03:02:47,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.994569, valid_loss 0.998505, train_metric nan, valid_metric 0.022960
[3036190:MainThread](2024-04-25 03:02:48,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.992683, valid_loss 0.999949, train_metric nan, valid_metric 0.017598
[3036190:MainThread](2024-04-25 03:02:48,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.989829, valid_loss 1.002763, train_metric nan, valid_metric 0.026371
[3036190:MainThread](2024-04-25 03:02:48,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.997402, valid_loss 0.999075, train_metric nan, valid_metric 0.023878
[3036190:MainThread](2024-04-25 03:02:48,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.999377, valid_loss 0.999371, train_metric nan, valid_metric 0.027128
[3036190:MainThread](2024-04-25 03:02:48,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.999172, valid_loss 0.998034, train_metric nan, valid_metric 0.023670
[3036190:MainThread](2024-04-25 03:02:49,126) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.993151, valid_loss 1.000633, train_metric nan, valid_metric 0.032162
[3036190:MainThread](2024-04-25 03:02:49,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.995998, valid_loss 1.005669, train_metric nan, valid_metric 0.028081
[3036190:MainThread](2024-04-25 03:02:49,507) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.990388, valid_loss 0.997528, train_metric nan, valid_metric 0.030276
[3036190:MainThread](2024-04-25 03:02:49,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.986588, valid_loss 1.001869, train_metric nan, valid_metric 0.030070
[3036190:MainThread](2024-04-25 03:02:49,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.989519, valid_loss 0.997940, train_metric nan, valid_metric 0.030533
[3036190:MainThread](2024-04-25 03:02:50,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.989579, valid_loss 0.997888, train_metric nan, valid_metric 0.028468
[3036190:MainThread](2024-04-25 03:02:50,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.995535, valid_loss 0.997860, train_metric nan, valid_metric 0.035638
[3036190:MainThread](2024-04-25 03:02:50,453) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.991944, valid_loss 0.998098, train_metric nan, valid_metric 0.032093
[3036190:MainThread](2024-04-25 03:02:50,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.992038, valid_loss 0.997923, train_metric nan, valid_metric 0.029993
[3036190:MainThread](2024-04-25 03:02:50,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.992676, valid_loss 0.997339, train_metric nan, valid_metric 0.034475
[3036190:MainThread](2024-04-25 03:02:50,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997414 to 0.997339, save checkpoint.
[3036190:MainThread](2024-04-25 03:02:50,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.993633, valid_loss 0.997930, train_metric nan, valid_metric 0.030965
[3036190:MainThread](2024-04-25 03:02:51,153) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.992935, valid_loss 1.000333, train_metric nan, valid_metric 0.030673
[3036190:MainThread](2024-04-25 03:02:51,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.991807, valid_loss 1.000606, train_metric nan, valid_metric 0.018111
[3036190:MainThread](2024-04-25 03:02:51,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.994281, valid_loss 0.999700, train_metric nan, valid_metric 0.029376
[3036190:MainThread](2024-04-25 03:02:51,641) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.985579, valid_loss 0.998470, train_metric nan, valid_metric 0.031879
[3036190:MainThread](2024-04-25 03:02:51,839) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.993425, valid_loss 1.000574, train_metric nan, valid_metric 0.033434
[3036190:MainThread](2024-04-25 03:02:51,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.998593, valid_loss 1.003682, train_metric nan, valid_metric 0.009313
[3036190:MainThread](2024-04-25 03:02:52,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.995672, valid_loss 0.998800, train_metric nan, valid_metric 0.030418
[3036190:MainThread](2024-04-25 03:02:52,325) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.991582, valid_loss 1.001242, train_metric nan, valid_metric 0.028545
[3036190:MainThread](2024-04-25 03:02:52,516) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.993631, valid_loss 0.998094, train_metric nan, valid_metric 0.027161
[3036190:MainThread](2024-04-25 03:02:52,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.993416, valid_loss 0.998742, train_metric nan, valid_metric 0.028677
[3036190:MainThread](2024-04-25 03:02:52,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.991044, valid_loss 0.998949, train_metric nan, valid_metric 0.025598
[3036190:MainThread](2024-04-25 03:02:52,972) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.994849, valid_loss 1.000066, train_metric nan, valid_metric 0.021391
[3036190:MainThread](2024-04-25 03:02:53,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.991349, valid_loss 1.001689, train_metric nan, valid_metric 0.033678
[3036190:MainThread](2024-04-25 03:02:53,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.995114, valid_loss 0.997611, train_metric nan, valid_metric 0.032758
[3036190:MainThread](2024-04-25 03:02:53,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.991136, valid_loss 0.997883, train_metric nan, valid_metric 0.032273
[3036190:MainThread](2024-04-25 03:02:53,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.984665, valid_loss 1.002690, train_metric nan, valid_metric 0.029620
[3036190:MainThread](2024-04-25 03:02:53,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.992542, valid_loss 1.000030, train_metric nan, valid_metric 0.034365
[3036190:MainThread](2024-04-25 03:02:54,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.992721, valid_loss 0.998389, train_metric nan, valid_metric 0.032732
[3036190:MainThread](2024-04-25 03:02:54,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.996277, valid_loss 1.000670, train_metric nan, valid_metric 0.033673
[3036190:MainThread](2024-04-25 03:02:54,403) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.991409, valid_loss 0.998521, train_metric nan, valid_metric 0.033526
[3036190:MainThread](2024-04-25 03:02:54,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.992383, valid_loss 1.003358, train_metric nan, valid_metric 0.009105
[3036190:MainThread](2024-04-25 03:02:54,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.996649, valid_loss 0.998184, train_metric nan, valid_metric 0.028786
[3036190:MainThread](2024-04-25 03:02:54,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.990007, valid_loss 0.998763, train_metric nan, valid_metric 0.030434
[3036190:MainThread](2024-04-25 03:02:55,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.999732, valid_loss 0.997901, train_metric nan, valid_metric 0.033389
[3036190:MainThread](2024-04-25 03:02:55,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 0.995633, valid_loss 1.000183, train_metric nan, valid_metric 0.030180
[3036190:MainThread](2024-04-25 03:02:55,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.991532, valid_loss 0.998948, train_metric nan, valid_metric 0.029014
[3036190:MainThread](2024-04-25 03:02:55,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 0.995310, valid_loss 0.998704, train_metric nan, valid_metric 0.031750
[3036190:MainThread](2024-04-25 03:02:55,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 0.997778, valid_loss 0.998103, train_metric nan, valid_metric 0.027671
[3036190:MainThread](2024-04-25 03:02:55,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 0.989741, valid_loss 1.002182, train_metric nan, valid_metric 0.013397
[3036190:MainThread](2024-04-25 03:02:55,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 0.993086, valid_loss 0.999613, train_metric nan, valid_metric 0.026250
[3036190:MainThread](2024-04-25 03:02:56,119) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 0.998884, valid_loss 1.000352, train_metric nan, valid_metric 0.027845
[3036190:MainThread](2024-04-25 03:02:56,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 0.993870, valid_loss 0.999885, train_metric nan, valid_metric 0.029892
[3036190:MainThread](2024-04-25 03:02:56,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 0.987889, valid_loss 0.998255, train_metric nan, valid_metric 0.030108
[3036190:MainThread](2024-04-25 03:02:56,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 0.987859, valid_loss 1.000713, train_metric nan, valid_metric 0.016401
[3036190:MainThread](2024-04-25 03:02:56,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 0.990798, valid_loss 1.001313, train_metric nan, valid_metric 0.031740
[3036190:MainThread](2024-04-25 03:02:56,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 0.986821, valid_loss 0.998500, train_metric nan, valid_metric 0.029968
[3036190:MainThread](2024-04-25 03:02:57,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 0.990750, valid_loss 0.999508, train_metric nan, valid_metric 0.024015
[3036190:MainThread](2024-04-25 03:02:57,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 0.993207, valid_loss 0.999082, train_metric nan, valid_metric 0.026039
[3036190:MainThread](2024-04-25 03:02:57,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 0.990141, valid_loss 0.998305, train_metric nan, valid_metric 0.030760
[3036190:MainThread](2024-04-25 03:02:57,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 0.986720, valid_loss 0.998787, train_metric nan, valid_metric 0.031091
[3036190:MainThread](2024-04-25 03:02:57,702) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 0.996203, valid_loss 0.998507, train_metric nan, valid_metric 0.029972
[3036190:MainThread](2024-04-25 03:02:57,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 0.987420, valid_loss 0.998756, train_metric nan, valid_metric 0.032740
[3036190:MainThread](2024-04-25 03:02:58,013) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 0.993888, valid_loss 1.000056, train_metric nan, valid_metric 0.033436
[3036190:MainThread](2024-04-25 03:02:58,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 0.993705, valid_loss 0.999754, train_metric nan, valid_metric 0.028450
[3036190:MainThread](2024-04-25 03:02:58,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 0.994505, valid_loss 0.998951, train_metric nan, valid_metric 0.030844
[3036190:MainThread](2024-04-25 03:02:58,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 0.989769, valid_loss 0.999490, train_metric nan, valid_metric 0.027578
[3036190:MainThread](2024-04-25 03:02:58,638) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 0.984872, valid_loss 1.001876, train_metric nan, valid_metric 0.017536
[3036190:MainThread](2024-04-25 03:02:58,794) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 0.994652, valid_loss 1.001168, train_metric nan, valid_metric 0.030019
[3036190:MainThread](2024-04-25 03:02:58,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 0.985354, valid_loss 0.998333, train_metric nan, valid_metric 0.028283
[3036190:MainThread](2024-04-25 03:02:58,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[3036190:MainThread](2024-04-25 03:02:58,971) INFO - qlib.timer - [log.py:127] - Time cost: 0.001s | waiting `async_log` Done
Save pretrained model to MLP_crowd_data_csi300_360_rankTrue_48.
[3036190:MainThread](2024-04-25 03:02:59,178) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3036190:MainThread](2024-04-25 03:02:59,190) INFO - qlib.workflow - [recorder.py:341] - Recorder dc12b2b7d6cb457c81b1a039b93721d8 starts running under Experiment 17 ...
{'IC': 0.022168896888494324,
 'ICIR': 0.1549874468820034,
 'Rank IC': 0.031728544611053115,
 'Rank ICIR': 0.23356527995755422}
[3036190:MainThread](2024-04-25 03:03:05,803) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3036190:MainThread](2024-04-25 03:03:43,926) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 03:03:43,929) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 03:03:49,930) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fc52640cac0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:40,  9.68it/s]backtest loop:   1%|          | 9/971 [00:00<00:37, 25.53it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 37.90it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.81it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 44.75it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 47.65it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:20, 46.43it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:18, 48.89it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 50.57it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 48.89it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 50.72it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 52.37it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 53.58it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 54.15it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 51.09it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 52.22it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 53.07it/s]backtest loop:  11%|█         | 105/971 [00:02<00:16, 53.53it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:15, 53.99it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 50.76it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 52.02it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:16, 49.70it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:16, 51.37it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:16, 49.52it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:16, 51.11it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 52.13it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 52.89it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:15, 53.45it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 50.68it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:15, 51.92it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 52.80it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:14, 53.69it/s]backtest loop:  20%|██        | 195/971 [00:03<00:15, 50.80it/s]backtest loop:  21%|██        | 201/971 [00:04<00:14, 52.11it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:14, 53.23it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:14, 50.87it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:14, 51.92it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:15, 49.69it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:14, 51.28it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:14, 52.30it/s]backtest loop:  25%|██▌       | 243/971 [00:04<00:13, 53.03it/s]backtest loop:  26%|██▌       | 249/971 [00:05<00:14, 50.38it/s]backtest loop:  26%|██▋       | 255/971 [00:05<00:13, 51.69it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:13, 52.62it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:14, 49.88it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:13, 51.28it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:13, 52.44it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:12, 53.11it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:13, 50.50it/s]backtest loop:  31%|███       | 297/971 [00:05<00:13, 51.75it/s]backtest loop:  31%|███       | 303/971 [00:06<00:12, 52.68it/s]backtest loop:  32%|███▏      | 309/971 [00:06<00:12, 53.34it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:12, 50.64it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:12, 52.22it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:12, 53.58it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:11, 53.95it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:11, 54.77it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:12, 51.34it/s]backtest loop:  36%|███▌      | 351/971 [00:06<00:11, 52.40it/s]backtest loop:  37%|███▋      | 357/971 [00:07<00:11, 53.36it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:11, 51.15it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:12, 49.23it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 50.88it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:11, 52.02it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 53.27it/s]backtest loop:  40%|████      | 393/971 [00:07<00:11, 50.70it/s]backtest loop:  41%|████      | 399/971 [00:07<00:11, 51.90it/s]backtest loop:  42%|████▏     | 405/971 [00:08<00:10, 52.84it/s]backtest loop:  42%|████▏     | 411/971 [00:08<00:10, 53.39it/s]backtest loop:  43%|████▎     | 417/971 [00:08<00:15, 35.35it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:14, 37.80it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:13, 41.67it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:11, 44.91it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:11, 47.50it/s]backtest loop:  46%|████▌     | 447/971 [00:09<00:11, 46.82it/s]backtest loop:  47%|████▋     | 453/971 [00:09<00:10, 49.11it/s]backtest loop:  47%|████▋     | 459/971 [00:09<00:10, 50.71it/s]backtest loop:  48%|████▊     | 465/971 [00:09<00:09, 51.83it/s]backtest loop:  49%|████▊     | 471/971 [00:09<00:09, 52.77it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 50.48it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:09, 51.79it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:09, 52.28it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:09, 49.99it/s]backtest loop:  52%|█████▏    | 501/971 [00:10<00:09, 51.30it/s]backtest loop:  52%|█████▏    | 507/971 [00:10<00:09, 49.43it/s]backtest loop:  53%|█████▎    | 513/971 [00:10<00:08, 51.14it/s]backtest loop:  53%|█████▎    | 519/971 [00:10<00:08, 52.26it/s]backtest loop:  54%|█████▍    | 525/971 [00:10<00:08, 53.01it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 50.48it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:08, 51.74it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:08, 52.75it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 53.30it/s]backtest loop:  57%|█████▋    | 555/971 [00:11<00:07, 53.72it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:08, 50.89it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:07, 51.71it/s]backtest loop:  59%|█████▉    | 573/971 [00:11<00:07, 52.58it/s]backtest loop:  60%|█████▉    | 579/971 [00:11<00:07, 53.26it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:07, 54.04it/s]backtest loop:  61%|██████    | 591/971 [00:11<00:07, 51.02it/s]backtest loop:  61%|██████▏   | 597/971 [00:11<00:07, 52.00it/s]backtest loop:  62%|██████▏   | 603/971 [00:12<00:06, 52.77it/s]backtest loop:  63%|██████▎   | 609/971 [00:12<00:06, 53.32it/s]backtest loop:  63%|██████▎   | 615/971 [00:12<00:07, 50.67it/s]backtest loop:  64%|██████▍   | 621/971 [00:12<00:06, 51.73it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:06, 52.91it/s]backtest loop:  65%|██████▌   | 633/971 [00:12<00:06, 53.37it/s]backtest loop:  66%|██████▌   | 639/971 [00:12<00:06, 54.00it/s]backtest loop:  66%|██████▋   | 645/971 [00:12<00:06, 50.55it/s]backtest loop:  67%|██████▋   | 651/971 [00:12<00:06, 51.68it/s]backtest loop:  68%|██████▊   | 657/971 [00:13<00:05, 52.54it/s]backtest loop:  68%|██████▊   | 663/971 [00:13<00:05, 53.10it/s]backtest loop:  69%|██████▉   | 669/971 [00:13<00:05, 53.56it/s]backtest loop:  70%|██████▉   | 675/971 [00:13<00:05, 50.59it/s]backtest loop:  70%|███████   | 681/971 [00:13<00:05, 51.70it/s]backtest loop:  71%|███████   | 687/971 [00:13<00:05, 52.45it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:05, 53.07it/s]backtest loop:  72%|███████▏  | 699/971 [00:13<00:05, 50.40it/s]backtest loop:  73%|███████▎  | 705/971 [00:13<00:05, 51.54it/s]backtest loop:  73%|███████▎  | 711/971 [00:14<00:04, 52.42it/s]backtest loop:  74%|███████▍  | 717/971 [00:14<00:04, 52.83it/s]backtest loop:  74%|███████▍  | 723/971 [00:14<00:04, 53.43it/s]backtest loop:  75%|███████▌  | 729/971 [00:14<00:04, 50.72it/s]backtest loop:  76%|███████▌  | 735/971 [00:14<00:04, 49.08it/s]backtest loop:  76%|███████▌  | 740/971 [00:14<00:04, 49.16it/s]backtest loop:  77%|███████▋  | 746/971 [00:14<00:04, 51.93it/s]backtest loop:  77%|███████▋  | 752/971 [00:14<00:04, 49.52it/s]backtest loop:  78%|███████▊  | 758/971 [00:15<00:04, 51.04it/s]backtest loop:  79%|███████▊  | 764/971 [00:15<00:03, 52.21it/s]backtest loop:  79%|███████▉  | 770/971 [00:15<00:04, 50.02it/s]backtest loop:  80%|███████▉  | 776/971 [00:15<00:03, 51.63it/s]backtest loop:  81%|████████  | 782/971 [00:15<00:03, 52.89it/s]backtest loop:  81%|████████  | 788/971 [00:15<00:03, 50.49it/s]backtest loop:  82%|████████▏ | 794/971 [00:15<00:03, 51.37it/s]backtest loop:  82%|████████▏ | 800/971 [00:15<00:03, 52.36it/s]backtest loop:  83%|████████▎ | 806/971 [00:15<00:03, 53.02it/s]backtest loop:  84%|████████▎ | 812/971 [00:16<00:02, 53.53it/s]backtest loop:  84%|████████▍ | 818/971 [00:16<00:03, 50.76it/s]backtest loop:  85%|████████▍ | 824/971 [00:16<00:02, 51.91it/s]backtest loop:  85%|████████▌ | 830/971 [00:16<00:02, 52.77it/s]backtest loop:  86%|████████▌ | 836/971 [00:16<00:02, 53.39it/s]backtest loop:  87%|████████▋ | 842/971 [00:16<00:02, 53.84it/s]backtest loop:  87%|████████▋ | 848/971 [00:16<00:02, 50.96it/s]backtest loop:  88%|████████▊ | 854/971 [00:16<00:02, 52.10it/s]backtest loop:  89%|████████▊ | 860/971 [00:16<00:02, 52.85it/s]backtest loop:  89%|████████▉ | 866/971 [00:17<00:01, 53.44it/s]backtest loop:  90%|████████▉ | 872/971 [00:17<00:01, 50.23it/s]backtest loop:  90%|█████████ | 878/971 [00:17<00:01, 51.91it/s]backtest loop:  91%|█████████ | 884/971 [00:17<00:01, 52.80it/s]backtest loop:  92%|█████████▏| 890/971 [00:17<00:01, 53.40it/s]backtest loop:  92%|█████████▏| 896/971 [00:17<00:01, 53.85it/s]backtest loop:  93%|█████████▎| 902/971 [00:17<00:01, 51.02it/s]backtest loop:  94%|█████████▎| 908/971 [00:17<00:01, 52.13it/s]backtest loop:  94%|█████████▍| 914/971 [00:17<00:01, 53.05it/s]backtest loop:  95%|█████████▍| 920/971 [00:18<00:00, 53.55it/s]backtest loop:  95%|█████████▌| 926/971 [00:18<00:00, 50.77it/s]backtest loop:  96%|█████████▌| 932/971 [00:18<00:00, 51.84it/s]backtest loop:  97%|█████████▋| 938/971 [00:18<00:00, 52.70it/s]backtest loop:  97%|█████████▋| 944/971 [00:18<00:00, 53.33it/s]backtest loop:  98%|█████████▊| 950/971 [00:18<00:00, 49.43it/s]backtest loop:  99%|█████████▊| 957/971 [00:18<00:00, 53.12it/s]backtest loop:  99%|█████████▉| 964/971 [00:18<00:00, 55.74it/s]backtest loop: 100%|█████████▉| 970/971 [00:19<00:00, 53.79it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 50.95it/s]
[3036190:MainThread](2024-04-25 03:04:09,043) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000710
std                0.004949
annualized_return  0.168917
information_ratio  2.212506
max_drawdown      -0.069495
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000512
std                0.004950
annualized_return  0.121939
information_ratio  1.596794
max_drawdown      -0.087857
[3036190:MainThread](2024-04-25 03:04:09,055) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `MLP_crowd_data_csi300_360_rankTrue`.
[3036190:MainThread](2024-04-25 03:04:15,600) INFO - qlib.timer - [log.py:127] - Time cost: 0.006s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.09660888993280313,
                                                    0.13562370991980652,
                                                    0.06660464834929007,
                                                    0.11273109897819915,
                                                    0.12508853654933336,
                                                    0.12193933987535104],
 '1day.excess_return_with_cost.information_ratio': [0.9965334629357873,
                                                    1.471462498466688,
                                                    0.8574204686978396,
                                                    1.1783584885283203,
                                                    1.5787766589453898,
                                                    1.5967941127594432],
 '1day.excess_return_with_cost.max_drawdown': [-0.178625820283921,
                                               -0.12757703738688353,
                                               -0.0913209010721612,
                                               -0.11249516827526612,
                                               -0.07978807685234823,
                                               -0.08785727986105331],
 'IC': [0.022102653552402936,
        0.02409782375001873,
        0.022686097788742136,
        0.02367574671522226,
        0.026994334331438982,
        0.022168896888494324],
 'ICIR': [0.13898491673495106,
          0.15607704167026837,
          0.15786952974802382,
          0.14959396620968068,
          0.2055005402854329,
          0.1549874468820034],
 'Rank IC': [0.025665075667307198,
             0.03148333316577824,
             0.030750383407579112,
             0.03557216907148577,
             0.032984373539418264,
             0.031728544611053115],
 'Rank ICIR': [0.16136503534804983,
               0.21059379399912298,
               0.2200373329436436,
               0.2277897581780483,
               0.2471184880035974,
               0.23356527995755422],
 'mae': [0.8644317750225282,
         0.8642435379012978,
         0.8642145420813768,
         0.8640649052148514,
         0.8641229436793894,
         0.8642419257601456],
 'mse': [0.9972685662584836,
         0.9972602008572546,
         0.9967983457930604,
         0.9969556729191729,
         0.9972293304320696,
         0.9972566124002319]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3036190:MainThread](2024-04-25 03:04:18,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3036190:MainThread](2024-04-25 03:04:18,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.01
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3036190:MainThread](2024-04-25 03:04:18,678) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3036190:MainThread](2024-04-25 03:04:18,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
[3036190:MainThread](2024-04-25 03:04:21,454) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name MLP_crowd_data_csi300_360_rankTrue_49.
[3036190:MainThread](2024-04-25 03:04:21,470) INFO - qlib.workflow - [exp.py:258] - Experiment 23 starts running ...
[3036190:MainThread](2024-04-25 03:04:21,481) INFO - qlib.workflow - [recorder.py:341] - Recorder 556a9a4dafcc42afa4ef1d32da9c71c9 starts running under Experiment 23 ...
[3036190:MainThread](2024-04-25 03:04:26,765) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[3036190:MainThread](2024-04-25 03:04:27,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 2.472582, valid_loss 1.074807, train_metric nan, valid_metric 0.008195
[3036190:MainThread](2024-04-25 03:04:27,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.074807, save checkpoint.
[3036190:MainThread](2024-04-25 03:04:27,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.073937, valid_loss 1.033615, train_metric nan, valid_metric -0.018541
[3036190:MainThread](2024-04-25 03:04:27,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.074807 to 1.033615, save checkpoint.
[3036190:MainThread](2024-04-25 03:04:27,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.029568, valid_loss 0.999900, train_metric nan, valid_metric 0.014128
[3036190:MainThread](2024-04-25 03:04:27,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.033615 to 0.999900, save checkpoint.
[3036190:MainThread](2024-04-25 03:04:27,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.022378, valid_loss 0.998877, train_metric nan, valid_metric 0.017584
[3036190:MainThread](2024-04-25 03:04:27,585) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999900 to 0.998877, save checkpoint.
[3036190:MainThread](2024-04-25 03:04:27,739) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.014304, valid_loss 0.998745, train_metric nan, valid_metric 0.017185
[3036190:MainThread](2024-04-25 03:04:27,739) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998877 to 0.998745, save checkpoint.
[3036190:MainThread](2024-04-25 03:04:27,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.018213, valid_loss 0.998357, train_metric nan, valid_metric 0.020255
[3036190:MainThread](2024-04-25 03:04:27,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998745 to 0.998357, save checkpoint.
[3036190:MainThread](2024-04-25 03:04:28,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.013383, valid_loss 0.998757, train_metric nan, valid_metric 0.019134
[3036190:MainThread](2024-04-25 03:04:28,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.008723, valid_loss 0.999279, train_metric nan, valid_metric 0.023605
[3036190:MainThread](2024-04-25 03:04:28,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.012551, valid_loss 0.999609, train_metric nan, valid_metric 0.012642
[3036190:MainThread](2024-04-25 03:04:28,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.009240, valid_loss 0.999000, train_metric nan, valid_metric 0.022765
[3036190:MainThread](2024-04-25 03:04:28,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.002239, valid_loss 0.998440, train_metric nan, valid_metric 0.023317
[3036190:MainThread](2024-04-25 03:04:28,832) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.007577, valid_loss 1.000327, train_metric nan, valid_metric 0.023072
[3036190:MainThread](2024-04-25 03:04:28,995) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.009724, valid_loss 1.000173, train_metric nan, valid_metric 0.027919
[3036190:MainThread](2024-04-25 03:04:29,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.001891, valid_loss 1.000136, train_metric nan, valid_metric 0.025249
[3036190:MainThread](2024-04-25 03:04:29,326) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.004008, valid_loss 0.999639, train_metric nan, valid_metric 0.019892
[3036190:MainThread](2024-04-25 03:04:29,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.005132, valid_loss 0.999206, train_metric nan, valid_metric 0.023193
[3036190:MainThread](2024-04-25 03:04:29,651) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.006813, valid_loss 0.999116, train_metric nan, valid_metric 0.013441
[3036190:MainThread](2024-04-25 03:04:29,810) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.007509, valid_loss 0.999621, train_metric nan, valid_metric 0.028429
[3036190:MainThread](2024-04-25 03:04:29,968) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.005867, valid_loss 1.001060, train_metric nan, valid_metric 0.023700
[3036190:MainThread](2024-04-25 03:04:30,126) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.001796, valid_loss 0.999155, train_metric nan, valid_metric 0.016678
[3036190:MainThread](2024-04-25 03:04:30,285) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.999651, valid_loss 0.999235, train_metric nan, valid_metric 0.020627
[3036190:MainThread](2024-04-25 03:04:30,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.001042, valid_loss 0.999119, train_metric nan, valid_metric 0.024367
[3036190:MainThread](2024-04-25 03:04:30,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.002517, valid_loss 0.998784, train_metric nan, valid_metric 0.023049
[3036190:MainThread](2024-04-25 03:04:30,760) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.994659, valid_loss 0.999489, train_metric nan, valid_metric 0.027067
[3036190:MainThread](2024-04-25 03:04:30,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.997839, valid_loss 1.000868, train_metric nan, valid_metric 0.025907
[3036190:MainThread](2024-04-25 03:04:31,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.997580, valid_loss 0.999409, train_metric nan, valid_metric 0.028344
[3036190:MainThread](2024-04-25 03:04:31,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.995451, valid_loss 0.998218, train_metric nan, valid_metric 0.028773
[3036190:MainThread](2024-04-25 03:04:31,255) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998357 to 0.998218, save checkpoint.
[3036190:MainThread](2024-04-25 03:04:31,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.001458, valid_loss 0.998384, train_metric nan, valid_metric 0.025749
[3036190:MainThread](2024-04-25 03:04:31,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.998776, valid_loss 0.998383, train_metric nan, valid_metric 0.015884
[3036190:MainThread](2024-04-25 03:04:31,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.997978, valid_loss 1.000117, train_metric nan, valid_metric 0.015158
[3036190:MainThread](2024-04-25 03:04:32,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 1.000537, valid_loss 0.999119, train_metric nan, valid_metric 0.023846
[3036190:MainThread](2024-04-25 03:04:32,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.997888, valid_loss 1.000602, train_metric nan, valid_metric 0.004668
[3036190:MainThread](2024-04-25 03:04:32,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.993986, valid_loss 0.999957, train_metric nan, valid_metric 0.012142
[3036190:MainThread](2024-04-25 03:04:32,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.995327, valid_loss 0.999092, train_metric nan, valid_metric 0.021882
[3036190:MainThread](2024-04-25 03:04:32,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.998570, valid_loss 0.998342, train_metric nan, valid_metric 0.023372
[3036190:MainThread](2024-04-25 03:04:32,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.992696, valid_loss 0.998974, train_metric nan, valid_metric 0.020570
[3036190:MainThread](2024-04-25 03:04:33,158) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.997502, valid_loss 1.002574, train_metric nan, valid_metric 0.001032
[3036190:MainThread](2024-04-25 03:04:33,325) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.997911, valid_loss 0.998331, train_metric nan, valid_metric 0.027175
[3036190:MainThread](2024-04-25 03:04:33,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 1.002072, valid_loss 0.999823, train_metric nan, valid_metric 0.023941
[3036190:MainThread](2024-04-25 03:04:33,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 1.000963, valid_loss 0.999087, train_metric nan, valid_metric 0.015330
[3036190:MainThread](2024-04-25 03:04:33,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 1.000543, valid_loss 1.000263, train_metric nan, valid_metric 0.008329
[3036190:MainThread](2024-04-25 03:04:34,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.995189, valid_loss 0.998253, train_metric nan, valid_metric 0.024567
[3036190:MainThread](2024-04-25 03:04:34,203) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.992974, valid_loss 0.999174, train_metric nan, valid_metric 0.024315
[3036190:MainThread](2024-04-25 03:04:34,369) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 1.002346, valid_loss 0.998003, train_metric nan, valid_metric 0.018838
[3036190:MainThread](2024-04-25 03:04:34,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998218 to 0.998003, save checkpoint.
[3036190:MainThread](2024-04-25 03:04:34,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.995904, valid_loss 0.998517, train_metric nan, valid_metric 0.025066
[3036190:MainThread](2024-04-25 03:04:34,702) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.992474, valid_loss 1.001617, train_metric nan, valid_metric 0.008770
[3036190:MainThread](2024-04-25 03:04:34,868) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.995673, valid_loss 0.998179, train_metric nan, valid_metric 0.019635
[3036190:MainThread](2024-04-25 03:04:35,034) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.995533, valid_loss 0.999844, train_metric nan, valid_metric 0.021220
[3036190:MainThread](2024-04-25 03:04:35,203) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.993269, valid_loss 0.999046, train_metric nan, valid_metric 0.012813
[3036190:MainThread](2024-04-25 03:04:35,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.995639, valid_loss 0.998875, train_metric nan, valid_metric 0.020621
[3036190:MainThread](2024-04-25 03:04:35,538) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.992706, valid_loss 0.998312, train_metric nan, valid_metric 0.029815
[3036190:MainThread](2024-04-25 03:04:35,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 1.001595, valid_loss 1.000863, train_metric nan, valid_metric 0.013284
[3036190:MainThread](2024-04-25 03:04:35,873) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.994665, valid_loss 1.003542, train_metric nan, valid_metric 0.026585
[3036190:MainThread](2024-04-25 03:04:36,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 1.003375, valid_loss 0.999050, train_metric nan, valid_metric 0.017348
[3036190:MainThread](2024-04-25 03:04:36,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.995295, valid_loss 0.997745, train_metric nan, valid_metric 0.027349
[3036190:MainThread](2024-04-25 03:04:36,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998003 to 0.997745, save checkpoint.
[3036190:MainThread](2024-04-25 03:04:36,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.995823, valid_loss 0.999960, train_metric nan, valid_metric 0.025998
[3036190:MainThread](2024-04-25 03:04:36,551) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.995181, valid_loss 0.999666, train_metric nan, valid_metric 0.027626
[3036190:MainThread](2024-04-25 03:04:36,718) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.997898, valid_loss 1.008636, train_metric nan, valid_metric 0.027630
[3036190:MainThread](2024-04-25 03:04:36,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.995920, valid_loss 0.999531, train_metric nan, valid_metric 0.023756
[3036190:MainThread](2024-04-25 03:04:37,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.992327, valid_loss 1.000942, train_metric nan, valid_metric 0.009042
[3036190:MainThread](2024-04-25 03:04:37,281) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.995574, valid_loss 1.012879, train_metric nan, valid_metric 0.027714
[3036190:MainThread](2024-04-25 03:04:37,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.992816, valid_loss 0.999107, train_metric nan, valid_metric 0.025869
[3036190:MainThread](2024-04-25 03:04:37,623) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.996298, valid_loss 0.999181, train_metric nan, valid_metric 0.016833
[3036190:MainThread](2024-04-25 03:04:37,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.995660, valid_loss 0.998726, train_metric nan, valid_metric 0.032466
[3036190:MainThread](2024-04-25 03:04:37,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.992943, valid_loss 0.998736, train_metric nan, valid_metric 0.026411
[3036190:MainThread](2024-04-25 03:04:38,154) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 1.000606, valid_loss 0.999097, train_metric nan, valid_metric 0.026553
[3036190:MainThread](2024-04-25 03:04:38,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.999282, valid_loss 1.006393, train_metric nan, valid_metric 0.027702
[3036190:MainThread](2024-04-25 03:04:38,528) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.991947, valid_loss 0.999852, train_metric nan, valid_metric 0.027276
[3036190:MainThread](2024-04-25 03:04:38,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.997542, valid_loss 1.000162, train_metric nan, valid_metric 0.017185
[3036190:MainThread](2024-04-25 03:04:38,928) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.996247, valid_loss 0.998126, train_metric nan, valid_metric 0.030422
[3036190:MainThread](2024-04-25 03:04:39,098) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.997523, valid_loss 0.999865, train_metric nan, valid_metric 0.025156
[3036190:MainThread](2024-04-25 03:04:39,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.994049, valid_loss 0.998473, train_metric nan, valid_metric 0.027219
[3036190:MainThread](2024-04-25 03:04:39,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.988493, valid_loss 0.998571, train_metric nan, valid_metric 0.023267
[3036190:MainThread](2024-04-25 03:04:39,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.990431, valid_loss 0.998512, train_metric nan, valid_metric 0.023604
[3036190:MainThread](2024-04-25 03:04:39,784) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.994926, valid_loss 1.000976, train_metric nan, valid_metric 0.014403
[3036190:MainThread](2024-04-25 03:04:39,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.997776, valid_loss 0.997810, train_metric nan, valid_metric 0.036715
[3036190:MainThread](2024-04-25 03:04:40,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.989045, valid_loss 0.999477, train_metric nan, valid_metric 0.019024
[3036190:MainThread](2024-04-25 03:04:40,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.993090, valid_loss 0.998737, train_metric nan, valid_metric 0.027439
[3036190:MainThread](2024-04-25 03:04:40,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.994955, valid_loss 0.998437, train_metric nan, valid_metric 0.027520
[3036190:MainThread](2024-04-25 03:04:40,631) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.992275, valid_loss 0.998619, train_metric nan, valid_metric 0.017310
[3036190:MainThread](2024-04-25 03:04:40,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.989524, valid_loss 1.000852, train_metric nan, valid_metric 0.026445
[3036190:MainThread](2024-04-25 03:04:40,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.992651, valid_loss 0.998985, train_metric nan, valid_metric 0.033646
[3036190:MainThread](2024-04-25 03:04:41,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.993808, valid_loss 0.999946, train_metric nan, valid_metric 0.034837
[3036190:MainThread](2024-04-25 03:04:41,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.991399, valid_loss 0.999398, train_metric nan, valid_metric 0.022666
[3036190:MainThread](2024-04-25 03:04:41,568) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.995149, valid_loss 1.003431, train_metric nan, valid_metric 0.025234
[3036190:MainThread](2024-04-25 03:04:41,767) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.994854, valid_loss 0.999574, train_metric nan, valid_metric 0.019431
[3036190:MainThread](2024-04-25 03:04:41,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.990812, valid_loss 0.998235, train_metric nan, valid_metric 0.026411
[3036190:MainThread](2024-04-25 03:04:42,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.994000, valid_loss 1.000912, train_metric nan, valid_metric 0.030713
[3036190:MainThread](2024-04-25 03:04:42,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.992903, valid_loss 1.000955, train_metric nan, valid_metric 0.025279
[3036190:MainThread](2024-04-25 03:04:42,567) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.987156, valid_loss 0.999287, train_metric nan, valid_metric 0.024519
[3036190:MainThread](2024-04-25 03:04:42,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.984826, valid_loss 1.000699, train_metric nan, valid_metric 0.025729
[3036190:MainThread](2024-04-25 03:04:42,960) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.001990, valid_loss 1.000571, train_metric nan, valid_metric 0.028840
[3036190:MainThread](2024-04-25 03:04:43,153) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.994742, valid_loss 1.002105, train_metric nan, valid_metric 0.019068
[3036190:MainThread](2024-04-25 03:04:43,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.995566, valid_loss 1.007922, train_metric nan, valid_metric 0.033782
[3036190:MainThread](2024-04-25 03:04:43,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.995419, valid_loss 0.999696, train_metric nan, valid_metric 0.033541
[3036190:MainThread](2024-04-25 03:04:43,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.991597, valid_loss 0.997756, train_metric nan, valid_metric 0.031732
[3036190:MainThread](2024-04-25 03:04:43,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.994628, valid_loss 1.001254, train_metric nan, valid_metric 0.030705
[3036190:MainThread](2024-04-25 03:04:43,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.997862, valid_loss 1.000854, train_metric nan, valid_metric 0.024894
[3036190:MainThread](2024-04-25 03:04:44,154) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.994718, valid_loss 0.998486, train_metric nan, valid_metric 0.032293
[3036190:MainThread](2024-04-25 03:04:44,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.994890, valid_loss 0.998038, train_metric nan, valid_metric 0.025370
[3036190:MainThread](2024-04-25 03:04:44,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.990744, valid_loss 0.998811, train_metric nan, valid_metric 0.031655
[3036190:MainThread](2024-04-25 03:04:44,659) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.993312, valid_loss 1.007407, train_metric nan, valid_metric 0.030815
[3036190:MainThread](2024-04-25 03:04:44,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.995700, valid_loss 0.999425, train_metric nan, valid_metric 0.033034
[3036190:MainThread](2024-04-25 03:04:44,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.993447, valid_loss 1.000998, train_metric nan, valid_metric 0.022774
[3036190:MainThread](2024-04-25 03:04:45,163) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.986897, valid_loss 0.999120, train_metric nan, valid_metric 0.032085
[3036190:MainThread](2024-04-25 03:04:45,164) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[3036190:MainThread](2024-04-25 03:04:45,181) INFO - qlib.timer - [log.py:127] - Time cost: 0.001s | waiting `async_log` Done
Save pretrained model to MLP_crowd_data_csi300_360_rankTrue_49.
[3036190:MainThread](2024-04-25 03:04:45,387) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3036190:MainThread](2024-04-25 03:04:45,398) INFO - qlib.workflow - [recorder.py:341] - Recorder 98174631986045249d66774d4b298329 starts running under Experiment 17 ...
{'IC': 0.021800412131666193,
 'ICIR': 0.14518168977691154,
 'Rank IC': 0.030161476140567276,
 'Rank ICIR': 0.20055621145015046}
[3036190:MainThread](2024-04-25 03:04:51,524) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3036190:MainThread](2024-04-25 03:05:29,886) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 03:05:29,889) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 03:05:35,930) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fc52b6aa6d0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:42,  9.44it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 25.06it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 37.53it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.53it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 46.13it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 48.37it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.65it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.84it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:16, 53.96it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 56.58it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 55.10it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 57.26it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 59.08it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 56.76it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:14, 58.49it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 59.69it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.67it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 58.42it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.71it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:15, 53.68it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:14, 56.45it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 55.18it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 57.29it/s]backtest loop:  16%|█▌        | 155/971 [00:02<00:13, 58.90it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 56.12it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:13, 58.14it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:13, 59.86it/s]backtest loop:  19%|█▊        | 182/971 [00:03<00:13, 57.46it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:13, 59.09it/s]backtest loop:  20%|██        | 195/971 [00:03<00:13, 56.46it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 58.49it/s]backtest loop:  22%|██▏       | 209/971 [00:03<00:12, 59.76it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 54.68it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:13, 56.78it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 55.67it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 57.62it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 59.11it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 56.36it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 58.29it/s]backtest loop:  27%|██▋       | 264/971 [00:04<00:12, 56.60it/s]backtest loop:  28%|██▊       | 271/971 [00:04<00:12, 55.18it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:12, 57.45it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:11, 58.94it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 56.04it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 58.03it/s]backtest loop:  31%|███▏      | 304/971 [00:05<00:11, 58.37it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:11, 55.61it/s]backtest loop:  33%|███▎      | 317/971 [00:05<00:11, 57.63it/s]backtest loop:  33%|███▎      | 324/971 [00:05<00:10, 59.21it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:11, 56.24it/s]backtest loop:  35%|███▍      | 337/971 [00:06<00:10, 58.28it/s]backtest loop:  35%|███▌      | 344/971 [00:06<00:10, 59.49it/s]backtest loop:  36%|███▌      | 350/971 [00:06<00:11, 56.20it/s]backtest loop:  37%|███▋      | 357/971 [00:06<00:16, 36.16it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:15, 39.26it/s]backtest loop:  38%|███▊      | 368/971 [00:06<00:14, 40.78it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:12, 46.05it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:12, 49.10it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:11, 50.06it/s]backtest loop:  41%|████      | 395/971 [00:07<00:10, 53.37it/s]backtest loop:  41%|████▏     | 402/971 [00:07<00:10, 55.89it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:10, 53.96it/s]backtest loop:  43%|████▎     | 415/971 [00:07<00:09, 56.32it/s]backtest loop:  43%|████▎     | 422/971 [00:07<00:09, 57.99it/s]backtest loop:  44%|████▍     | 428/971 [00:07<00:09, 55.09it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:09, 57.17it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:09, 55.56it/s]backtest loop:  46%|████▌     | 449/971 [00:08<00:09, 57.46it/s]backtest loop:  47%|████▋     | 456/971 [00:08<00:08, 59.22it/s]backtest loop:  48%|████▊     | 462/971 [00:08<00:09, 56.21it/s]backtest loop:  48%|████▊     | 469/971 [00:08<00:08, 57.97it/s]backtest loop:  49%|████▉     | 476/971 [00:08<00:08, 59.14it/s]backtest loop:  50%|████▉     | 482/971 [00:08<00:08, 56.42it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:08, 58.10it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:08, 55.43it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:08, 57.43it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:08, 54.92it/s]backtest loop:  53%|█████▎    | 515/971 [00:09<00:07, 57.25it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 57.93it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:08, 55.33it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:07, 57.61it/s]backtest loop:  56%|█████▌    | 541/971 [00:09<00:07, 55.89it/s]backtest loop:  56%|█████▋    | 548/971 [00:10<00:07, 57.84it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 59.15it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 56.21it/s]backtest loop:  58%|█████▊    | 567/971 [00:10<00:07, 56.94it/s]backtest loop:  59%|█████▉    | 574/971 [00:10<00:06, 58.90it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:06, 57.07it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:06, 58.63it/s]backtest loop:  61%|██████▏   | 595/971 [00:10<00:06, 59.88it/s]backtest loop:  62%|██████▏   | 602/971 [00:10<00:06, 57.40it/s]backtest loop:  63%|██████▎   | 609/971 [00:11<00:06, 58.88it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:06, 56.05it/s]backtest loop:  64%|██████▍   | 622/971 [00:11<00:06, 57.96it/s]backtest loop:  65%|██████▍   | 629/971 [00:11<00:05, 59.68it/s]backtest loop:  65%|██████▌   | 635/971 [00:11<00:05, 56.93it/s]backtest loop:  66%|██████▌   | 642/971 [00:11<00:05, 58.62it/s]backtest loop:  67%|██████▋   | 649/971 [00:11<00:05, 59.79it/s]backtest loop:  67%|██████▋   | 655/971 [00:11<00:05, 56.62it/s]backtest loop:  68%|██████▊   | 661/971 [00:12<00:05, 57.27it/s]backtest loop:  69%|██████▉   | 668/971 [00:12<00:05, 58.87it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:05, 55.95it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:05, 57.79it/s]backtest loop:  71%|███████   | 687/971 [00:12<00:04, 58.35it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:04, 56.26it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 58.13it/s]backtest loop:  73%|███████▎  | 707/971 [00:12<00:04, 57.90it/s]backtest loop:  74%|███████▎  | 714/971 [00:12<00:04, 56.18it/s]backtest loop:  74%|███████▍  | 721/971 [00:13<00:04, 58.15it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 59.60it/s]backtest loop:  76%|███████▌  | 734/971 [00:13<00:04, 53.51it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 56.01it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.77it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 53.96it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 56.34it/s]backtest loop:  79%|███████▉  | 769/971 [00:13<00:03, 58.05it/s]backtest loop:  80%|███████▉  | 775/971 [00:14<00:03, 55.68it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 57.76it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 55.33it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.41it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 58.98it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 56.08it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 57.83it/s]backtest loop:  85%|████████▍ | 822/971 [00:14<00:02, 59.24it/s]backtest loop:  85%|████████▌ | 828/971 [00:14<00:02, 56.22it/s]backtest loop:  86%|████████▌ | 835/971 [00:15<00:02, 57.99it/s]backtest loop:  87%|████████▋ | 842/971 [00:15<00:02, 59.36it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 56.34it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:01, 58.13it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 56.34it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 58.12it/s]backtest loop:  90%|█████████ | 876/971 [00:15<00:01, 59.58it/s]backtest loop:  91%|█████████ | 882/971 [00:15<00:01, 56.60it/s]backtest loop:  92%|█████████▏| 889/971 [00:15<00:01, 58.29it/s]backtest loop:  92%|█████████▏| 896/971 [00:16<00:01, 59.57it/s]backtest loop:  93%|█████████▎| 902/971 [00:16<00:01, 56.60it/s]backtest loop:  94%|█████████▎| 909/971 [00:16<00:01, 58.34it/s]backtest loop:  94%|█████████▍| 916/971 [00:16<00:00, 56.21it/s]backtest loop:  95%|█████████▌| 923/971 [00:16<00:00, 57.98it/s]backtest loop:  96%|█████████▌| 930/971 [00:16<00:00, 59.48it/s]backtest loop:  96%|█████████▋| 936/971 [00:16<00:00, 56.52it/s]backtest loop:  97%|█████████▋| 943/971 [00:16<00:00, 58.29it/s]backtest loop:  98%|█████████▊| 950/971 [00:17<00:00, 56.46it/s]backtest loop:  98%|█████████▊| 956/971 [00:17<00:00, 56.01it/s]backtest loop:  99%|█████████▉| 962/971 [00:17<00:00, 55.57it/s]backtest loop: 100%|█████████▉| 968/971 [00:17<00:00, 55.39it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.61it/s]
[3036190:MainThread](2024-04-25 03:05:53,449) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000444
std                0.005418
annualized_return  0.105785
information_ratio  1.265650
max_drawdown      -0.081856
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000248
std                0.005419
annualized_return  0.059087
information_ratio  0.706721
max_drawdown      -0.097793
[3036190:MainThread](2024-04-25 03:05:53,463) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `MLP_crowd_data_csi300_360_rankTrue`.
[3036190:MainThread](2024-04-25 03:06:00,113) INFO - qlib.timer - [log.py:127] - Time cost: 0.006s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.09660888993280313,
                                                    0.13562370991980652,
                                                    0.06660464834929007,
                                                    0.11273109897819915,
                                                    0.12508853654933336,
                                                    0.12193933987535104,
                                                    0.059086509324079446],
 '1day.excess_return_with_cost.information_ratio': [0.9965334629357873,
                                                    1.471462498466688,
                                                    0.8574204686978396,
                                                    1.1783584885283203,
                                                    1.5787766589453898,
                                                    1.5967941127594432,
                                                    0.7067206748880079],
 '1day.excess_return_with_cost.max_drawdown': [-0.178625820283921,
                                               -0.12757703738688353,
                                               -0.0913209010721612,
                                               -0.11249516827526612,
                                               -0.07978807685234823,
                                               -0.08785727986105331,
                                               -0.09779338256797732],
 'IC': [0.022102653552402936,
        0.02409782375001873,
        0.022686097788742136,
        0.02367574671522226,
        0.026994334331438982,
        0.022168896888494324,
        0.021800412131666193],
 'ICIR': [0.13898491673495106,
          0.15607704167026837,
          0.15786952974802382,
          0.14959396620968068,
          0.2055005402854329,
          0.1549874468820034,
          0.14518168977691154],
 'Rank IC': [0.025665075667307198,
             0.03148333316577824,
             0.030750383407579112,
             0.03557216907148577,
             0.032984373539418264,
             0.031728544611053115,
             0.030161476140567276],
 'Rank ICIR': [0.16136503534804983,
               0.21059379399912298,
               0.2200373329436436,
               0.2277897581780483,
               0.2471184880035974,
               0.23356527995755422,
               0.20055621145015046],
 'mae': [0.8644317750225282,
         0.8642435379012978,
         0.8642145420813768,
         0.8640649052148514,
         0.8641229436793894,
         0.8642419257601456,
         0.8642964383530691],
 'mse': [0.9972685662584836,
         0.9972602008572546,
         0.9967983457930604,
         0.9969556729191729,
         0.9972293304320696,
         0.9972566124002319,
         0.9973126808783253]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3036190:MainThread](2024-04-25 03:06:03,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3036190:MainThread](2024-04-25 03:06:03,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.01
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3036190:MainThread](2024-04-25 03:06:03,204) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3036190:MainThread](2024-04-25 03:06:03,205) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
[3036190:MainThread](2024-04-25 03:06:05,998) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name MLP_crowd_data_csi300_360_rankTrue_50.
[3036190:MainThread](2024-04-25 03:06:06,014) INFO - qlib.workflow - [exp.py:258] - Experiment 24 starts running ...
[3036190:MainThread](2024-04-25 03:06:06,023) INFO - qlib.workflow - [recorder.py:341] - Recorder 66b40eec2af64c3e825b879ff2cfd3fa starts running under Experiment 24 ...
[3036190:MainThread](2024-04-25 03:06:11,154) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[3036190:MainThread](2024-04-25 03:06:11,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 3.063015, valid_loss 1.107804, train_metric nan, valid_metric 0.013014
[3036190:MainThread](2024-04-25 03:06:11,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.107804, save checkpoint.
[3036190:MainThread](2024-04-25 03:06:11,743) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.054122, valid_loss 1.003583, train_metric nan, valid_metric 0.017910
[3036190:MainThread](2024-04-25 03:06:11,743) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.107804 to 1.003583, save checkpoint.
[3036190:MainThread](2024-04-25 03:06:11,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.016615, valid_loss 1.000211, train_metric nan, valid_metric 0.010337
[3036190:MainThread](2024-04-25 03:06:11,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.003583 to 1.000211, save checkpoint.
[3036190:MainThread](2024-04-25 03:06:12,132) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.013313, valid_loss 0.999322, train_metric nan, valid_metric 0.022352
[3036190:MainThread](2024-04-25 03:06:12,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.000211 to 0.999322, save checkpoint.
[3036190:MainThread](2024-04-25 03:06:12,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.012758, valid_loss 0.998307, train_metric nan, valid_metric 0.020699
[3036190:MainThread](2024-04-25 03:06:12,320) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999322 to 0.998307, save checkpoint.
[3036190:MainThread](2024-04-25 03:06:12,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.010865, valid_loss 0.998980, train_metric nan, valid_metric 0.019205
[3036190:MainThread](2024-04-25 03:06:12,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.004410, valid_loss 1.000068, train_metric nan, valid_metric 0.021905
[3036190:MainThread](2024-04-25 03:06:12,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.008466, valid_loss 0.998359, train_metric nan, valid_metric 0.019269
[3036190:MainThread](2024-04-25 03:06:13,086) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.012283, valid_loss 0.998088, train_metric nan, valid_metric 0.024763
[3036190:MainThread](2024-04-25 03:06:13,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998307 to 0.998088, save checkpoint.
[3036190:MainThread](2024-04-25 03:06:13,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 0.997241, valid_loss 0.998339, train_metric nan, valid_metric 0.021878
[3036190:MainThread](2024-04-25 03:06:13,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.006841, valid_loss 0.999144, train_metric nan, valid_metric 0.010975
[3036190:MainThread](2024-04-25 03:06:13,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.009168, valid_loss 0.999288, train_metric nan, valid_metric 0.029176
[3036190:MainThread](2024-04-25 03:06:13,832) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.003671, valid_loss 0.998078, train_metric nan, valid_metric 0.021432
[3036190:MainThread](2024-04-25 03:06:13,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998088 to 0.998078, save checkpoint.
[3036190:MainThread](2024-04-25 03:06:14,031) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.002143, valid_loss 0.998880, train_metric nan, valid_metric 0.013374
[3036190:MainThread](2024-04-25 03:06:14,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.003803, valid_loss 0.998333, train_metric nan, valid_metric 0.024996
[3036190:MainThread](2024-04-25 03:06:14,427) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.002919, valid_loss 0.999439, train_metric nan, valid_metric 0.019350
[3036190:MainThread](2024-04-25 03:06:14,629) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.004409, valid_loss 0.998266, train_metric nan, valid_metric 0.025878
[3036190:MainThread](2024-04-25 03:06:14,796) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.998476, valid_loss 0.999456, train_metric nan, valid_metric 0.021946
[3036190:MainThread](2024-04-25 03:06:14,963) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.003574, valid_loss 0.999362, train_metric nan, valid_metric 0.009009
[3036190:MainThread](2024-04-25 03:06:15,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.001195, valid_loss 0.998142, train_metric nan, valid_metric 0.023760
[3036190:MainThread](2024-04-25 03:06:15,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.999566, valid_loss 0.998165, train_metric nan, valid_metric 0.019066
[3036190:MainThread](2024-04-25 03:06:15,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 0.995472, valid_loss 0.999288, train_metric nan, valid_metric 0.025555
[3036190:MainThread](2024-04-25 03:06:15,716) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.997075, valid_loss 0.998827, train_metric nan, valid_metric 0.018344
[3036190:MainThread](2024-04-25 03:06:15,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.997255, valid_loss 0.998128, train_metric nan, valid_metric 0.024821
[3036190:MainThread](2024-04-25 03:06:16,035) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.999105, valid_loss 0.999519, train_metric nan, valid_metric 0.029330
[3036190:MainThread](2024-04-25 03:06:16,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.998911, valid_loss 0.998540, train_metric nan, valid_metric 0.028666
[3036190:MainThread](2024-04-25 03:06:16,350) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.001614, valid_loss 1.000258, train_metric nan, valid_metric 0.008006
[3036190:MainThread](2024-04-25 03:06:16,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.002283, valid_loss 0.998859, train_metric nan, valid_metric 0.021790
[3036190:MainThread](2024-04-25 03:06:16,663) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.995677, valid_loss 1.003008, train_metric nan, valid_metric 0.025958
[3036190:MainThread](2024-04-25 03:06:16,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.994747, valid_loss 0.998706, train_metric nan, valid_metric 0.016163
[3036190:MainThread](2024-04-25 03:06:16,976) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.994452, valid_loss 0.997788, train_metric nan, valid_metric 0.028307
[3036190:MainThread](2024-04-25 03:06:16,976) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998078 to 0.997788, save checkpoint.
[3036190:MainThread](2024-04-25 03:06:17,134) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.994974, valid_loss 1.008938, train_metric nan, valid_metric 0.027754
[3036190:MainThread](2024-04-25 03:06:17,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.006167, valid_loss 0.999046, train_metric nan, valid_metric 0.018308
[3036190:MainThread](2024-04-25 03:06:17,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.998471, valid_loss 1.001251, train_metric nan, valid_metric 0.002972
[3036190:MainThread](2024-04-25 03:06:17,603) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.000504, valid_loss 1.001840, train_metric nan, valid_metric 0.000743
[3036190:MainThread](2024-04-25 03:06:17,762) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.000380, valid_loss 0.998730, train_metric nan, valid_metric 0.022233
[3036190:MainThread](2024-04-25 03:06:17,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 0.992251, valid_loss 1.000145, train_metric nan, valid_metric 0.025118
[3036190:MainThread](2024-04-25 03:06:18,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 0.995251, valid_loss 0.998303, train_metric nan, valid_metric 0.026040
[3036190:MainThread](2024-04-25 03:06:18,227) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.995391, valid_loss 0.999539, train_metric nan, valid_metric 0.025430
[3036190:MainThread](2024-04-25 03:06:18,383) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.989662, valid_loss 0.998056, train_metric nan, valid_metric 0.024213
[3036190:MainThread](2024-04-25 03:06:18,538) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.999972, valid_loss 0.999852, train_metric nan, valid_metric 0.028043
[3036190:MainThread](2024-04-25 03:06:18,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.999597, valid_loss 0.998086, train_metric nan, valid_metric 0.025106
[3036190:MainThread](2024-04-25 03:06:18,856) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.998822, valid_loss 0.998237, train_metric nan, valid_metric 0.018783
[3036190:MainThread](2024-04-25 03:06:19,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.992098, valid_loss 0.999024, train_metric nan, valid_metric 0.018719
[3036190:MainThread](2024-04-25 03:06:19,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.994702, valid_loss 0.998689, train_metric nan, valid_metric 0.024627
[3036190:MainThread](2024-04-25 03:06:19,328) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.994139, valid_loss 0.999911, train_metric nan, valid_metric 0.026506
[3036190:MainThread](2024-04-25 03:06:19,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.990030, valid_loss 1.001727, train_metric nan, valid_metric 0.027817
[3036190:MainThread](2024-04-25 03:06:19,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.995195, valid_loss 0.998965, train_metric nan, valid_metric 0.016516
[3036190:MainThread](2024-04-25 03:06:19,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.994680, valid_loss 1.002035, train_metric nan, valid_metric 0.008129
[3036190:MainThread](2024-04-25 03:06:19,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.997290, valid_loss 0.999581, train_metric nan, valid_metric 0.021180
[3036190:MainThread](2024-04-25 03:06:20,104) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.992684, valid_loss 1.000860, train_metric nan, valid_metric 0.025553
[3036190:MainThread](2024-04-25 03:06:20,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.998152, valid_loss 0.998390, train_metric nan, valid_metric 0.027916
[3036190:MainThread](2024-04-25 03:06:20,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.992039, valid_loss 1.000066, train_metric nan, valid_metric 0.031686
[3036190:MainThread](2024-04-25 03:06:20,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.992841, valid_loss 0.998898, train_metric nan, valid_metric 0.017960
[3036190:MainThread](2024-04-25 03:06:20,735) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 1.003003, valid_loss 1.000419, train_metric nan, valid_metric 0.018057
[3036190:MainThread](2024-04-25 03:06:20,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.994391, valid_loss 1.002763, train_metric nan, valid_metric 0.010859
[3036190:MainThread](2024-04-25 03:06:21,065) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.986952, valid_loss 1.002765, train_metric nan, valid_metric 0.013785
[3036190:MainThread](2024-04-25 03:06:21,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.995231, valid_loss 0.998457, train_metric nan, valid_metric 0.028357
[3036190:MainThread](2024-04-25 03:06:21,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.991246, valid_loss 1.002934, train_metric nan, valid_metric 0.033167
[3036190:MainThread](2024-04-25 03:06:21,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.995829, valid_loss 0.999047, train_metric nan, valid_metric 0.030439
[3036190:MainThread](2024-04-25 03:06:21,732) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.997257, valid_loss 1.000330, train_metric nan, valid_metric 0.017022
[3036190:MainThread](2024-04-25 03:06:21,895) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 1.006141, valid_loss 0.999406, train_metric nan, valid_metric 0.024915
[3036190:MainThread](2024-04-25 03:06:22,062) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.991485, valid_loss 1.001119, train_metric nan, valid_metric 0.023349
[3036190:MainThread](2024-04-25 03:06:22,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.999093, valid_loss 1.005028, train_metric nan, valid_metric 0.030196
[3036190:MainThread](2024-04-25 03:06:22,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.995409, valid_loss 0.999311, train_metric nan, valid_metric 0.023542
[3036190:MainThread](2024-04-25 03:06:22,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.997591, valid_loss 1.001808, train_metric nan, valid_metric 0.033325
[3036190:MainThread](2024-04-25 03:06:22,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.993028, valid_loss 0.998581, train_metric nan, valid_metric 0.029231
[3036190:MainThread](2024-04-25 03:06:22,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.996356, valid_loss 0.999758, train_metric nan, valid_metric 0.013976
[3036190:MainThread](2024-04-25 03:06:23,053) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.994763, valid_loss 1.000087, train_metric nan, valid_metric 0.032119
[3036190:MainThread](2024-04-25 03:06:23,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.996168, valid_loss 1.001080, train_metric nan, valid_metric 0.029782
[3036190:MainThread](2024-04-25 03:06:23,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.989084, valid_loss 0.999572, train_metric nan, valid_metric 0.028364
[3036190:MainThread](2024-04-25 03:06:23,545) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.988380, valid_loss 1.002366, train_metric nan, valid_metric 0.029806
[3036190:MainThread](2024-04-25 03:06:23,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.995331, valid_loss 0.998732, train_metric nan, valid_metric 0.032786
[3036190:MainThread](2024-04-25 03:06:23,877) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.990630, valid_loss 0.999275, train_metric nan, valid_metric 0.025887
[3036190:MainThread](2024-04-25 03:06:24,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.991863, valid_loss 0.998291, train_metric nan, valid_metric 0.029914
[3036190:MainThread](2024-04-25 03:06:24,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.989699, valid_loss 1.001833, train_metric nan, valid_metric 0.013319
[3036190:MainThread](2024-04-25 03:06:24,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.991088, valid_loss 1.003879, train_metric nan, valid_metric 0.013806
[3036190:MainThread](2024-04-25 03:06:24,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.994104, valid_loss 1.001363, train_metric nan, valid_metric 0.014496
[3036190:MainThread](2024-04-25 03:06:24,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.987478, valid_loss 0.998456, train_metric nan, valid_metric 0.021177
[3036190:MainThread](2024-04-25 03:06:24,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.992315, valid_loss 0.999748, train_metric nan, valid_metric 0.022367
[3036190:MainThread](2024-04-25 03:06:25,031) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.996658, valid_loss 0.997794, train_metric nan, valid_metric 0.028685
[3036190:MainThread](2024-04-25 03:06:25,031) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[3036190:MainThread](2024-04-25 03:06:25,049) INFO - qlib.timer - [log.py:127] - Time cost: 0.002s | waiting `async_log` Done
Save pretrained model to MLP_crowd_data_csi300_360_rankTrue_50.
[3036190:MainThread](2024-04-25 03:06:25,255) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3036190:MainThread](2024-04-25 03:06:25,267) INFO - qlib.workflow - [recorder.py:341] - Recorder 79da98df46fc4ef2a302840813e62f62 starts running under Experiment 17 ...
{'IC': 0.019800181045442358,
 'ICIR': 0.12170849211192651,
 'Rank IC': 0.03040487978179861,
 'Rank ICIR': 0.19658633236114925}
[3036190:MainThread](2024-04-25 03:06:31,228) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3036190:MainThread](2024-04-25 03:07:09,481) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 03:07:09,484) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 03:07:15,627) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fc532f59a60>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:46,  9.12it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 23.77it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 33.59it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:25, 37.58it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:22, 42.61it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 46.20it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 45.77it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:19, 48.41it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 50.27it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 48.65it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 50.58it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 52.21it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 53.14it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 53.85it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 50.81it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 52.03it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 52.67it/s]backtest loop:  11%|█         | 105/971 [00:02<00:16, 53.32it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:16, 53.16it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 52.06it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:15, 55.26it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:15, 53.50it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 52.64it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:14, 55.59it/s]backtest loop:  15%|█▌        | 150/971 [00:03<00:14, 57.60it/s]backtest loop:  16%|█▌        | 156/971 [00:03<00:14, 55.20it/s]backtest loop:  17%|█▋        | 162/971 [00:03<00:14, 56.44it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:13, 57.42it/s]backtest loop:  18%|█▊        | 174/971 [00:03<00:13, 58.13it/s]backtest loop:  19%|█▊        | 180/971 [00:03<00:13, 58.49it/s]backtest loop:  19%|█▉        | 186/971 [00:03<00:14, 55.40it/s]backtest loop:  20%|█▉        | 193/971 [00:03<00:13, 57.74it/s]backtest loop:  21%|██        | 200/971 [00:03<00:13, 55.88it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:13, 57.68it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:13, 55.13it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 54.34it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:13, 56.55it/s]backtest loop:  24%|██▍       | 234/971 [00:04<00:12, 58.42it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:13, 55.67it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:12, 57.58it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:12, 55.75it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:12, 57.77it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:12, 55.51it/s]backtest loop:  28%|██▊       | 274/971 [00:05<00:12, 57.56it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:11, 58.19it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 55.39it/s]backtest loop:  30%|███       | 292/971 [00:05<00:11, 56.59it/s]backtest loop:  31%|███       | 299/971 [00:05<00:11, 58.33it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:12, 55.44it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 57.36it/s]backtest loop:  33%|███▎      | 319/971 [00:06<00:11, 58.83it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:11, 55.89it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:11, 57.83it/s]backtest loop:  35%|███▍      | 338/971 [00:06<00:10, 58.40it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 56.41it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 58.35it/s]backtest loop:  37%|███▋      | 358/971 [00:06<00:17, 35.87it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:15, 38.14it/s]backtest loop:  38%|███▊      | 368/971 [00:07<00:15, 39.95it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:13, 45.51it/s]backtest loop:  39%|███▉      | 382/971 [00:07<00:11, 49.99it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:11, 49.79it/s]backtest loop:  41%|████      | 394/971 [00:07<00:11, 52.23it/s]backtest loop:  41%|████▏     | 401/971 [00:07<00:10, 55.08it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:10, 54.05it/s]backtest loop:  43%|████▎     | 414/971 [00:07<00:10, 55.58it/s]backtest loop:  43%|████▎     | 420/971 [00:08<00:09, 56.72it/s]backtest loop:  44%|████▍     | 427/971 [00:08<00:09, 58.47it/s]backtest loop:  45%|████▍     | 433/971 [00:08<00:09, 55.64it/s]backtest loop:  45%|████▌     | 439/971 [00:08<00:09, 56.53it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:09, 58.28it/s]backtest loop:  47%|████▋     | 452/971 [00:08<00:09, 55.57it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:08, 57.51it/s]backtest loop:  48%|████▊     | 466/971 [00:08<00:08, 58.89it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:08, 56.00it/s]backtest loop:  49%|████▉     | 479/971 [00:09<00:08, 57.94it/s]backtest loop:  50%|████▉     | 485/971 [00:09<00:08, 58.22it/s]backtest loop:  51%|█████     | 491/971 [00:09<00:08, 55.34it/s]backtest loop:  51%|█████▏    | 498/971 [00:09<00:08, 57.36it/s]backtest loop:  52%|█████▏    | 505/971 [00:09<00:08, 55.87it/s]backtest loop:  53%|█████▎    | 512/971 [00:09<00:08, 54.59it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:07, 56.78it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 55.30it/s]backtest loop:  55%|█████▍    | 532/971 [00:10<00:07, 56.29it/s]backtest loop:  55%|█████▌    | 538/971 [00:10<00:07, 57.23it/s]backtest loop:  56%|█████▌    | 545/971 [00:10<00:07, 58.76it/s]backtest loop:  57%|█████▋    | 551/971 [00:10<00:07, 55.79it/s]backtest loop:  57%|█████▋    | 557/971 [00:10<00:07, 56.80it/s]backtest loop:  58%|█████▊    | 563/971 [00:10<00:07, 57.68it/s]backtest loop:  59%|█████▊    | 569/971 [00:10<00:06, 58.31it/s]backtest loop:  59%|█████▉    | 576/971 [00:10<00:07, 56.16it/s]backtest loop:  60%|██████    | 583/971 [00:10<00:06, 58.20it/s]backtest loop:  61%|██████    | 590/971 [00:11<00:06, 59.50it/s]backtest loop:  61%|██████▏   | 596/971 [00:11<00:06, 56.45it/s]backtest loop:  62%|██████▏   | 603/971 [00:11<00:06, 58.16it/s]backtest loop:  63%|██████▎   | 609/971 [00:11<00:06, 58.64it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:06, 55.94it/s]backtest loop:  64%|██████▍   | 621/971 [00:11<00:06, 56.69it/s]backtest loop:  65%|██████▍   | 628/971 [00:11<00:05, 58.44it/s]backtest loop:  65%|██████▌   | 635/971 [00:11<00:05, 56.35it/s]backtest loop:  66%|██████▌   | 642/971 [00:11<00:05, 58.16it/s]backtest loop:  67%|██████▋   | 649/971 [00:12<00:05, 59.33it/s]backtest loop:  67%|██████▋   | 655/971 [00:12<00:05, 56.24it/s]backtest loop:  68%|██████▊   | 662/971 [00:12<00:05, 57.93it/s]backtest loop:  69%|██████▉   | 668/971 [00:12<00:05, 58.25it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:05, 55.38it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:05, 57.38it/s]backtest loop:  71%|███████   | 687/971 [00:12<00:04, 58.01it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:04, 55.93it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 57.83it/s]backtest loop:  73%|███████▎  | 708/971 [00:13<00:04, 59.20it/s]backtest loop:  74%|███████▎  | 714/971 [00:13<00:04, 56.03it/s]backtest loop:  74%|███████▍  | 720/971 [00:13<00:04, 57.09it/s]backtest loop:  75%|███████▍  | 727/971 [00:13<00:04, 58.76it/s]backtest loop:  75%|███████▌  | 733/971 [00:13<00:04, 53.04it/s]backtest loop:  76%|███████▌  | 740/971 [00:13<00:04, 55.64it/s]backtest loop:  77%|███████▋  | 747/971 [00:13<00:03, 57.56it/s]backtest loop:  78%|███████▊  | 753/971 [00:13<00:03, 55.01it/s]backtest loop:  78%|███████▊  | 759/971 [00:14<00:03, 55.97it/s]backtest loop:  79%|███████▉  | 765/971 [00:14<00:03, 53.91it/s]backtest loop:  80%|███████▉  | 772/971 [00:14<00:03, 56.33it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 58.12it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 55.41it/s]backtest loop:  82%|████████▏ | 792/971 [00:14<00:03, 57.39it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 54.85it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:02, 56.25it/s]backtest loop:  84%|████████▎ | 811/971 [00:14<00:02, 57.03it/s]backtest loop:  84%|████████▍ | 818/971 [00:15<00:02, 55.50it/s]backtest loop:  85%|████████▍ | 825/971 [00:15<00:02, 57.44it/s]backtest loop:  86%|████████▌ | 832/971 [00:15<00:02, 58.79it/s]backtest loop:  86%|████████▋ | 838/971 [00:15<00:02, 55.85it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 57.67it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 55.84it/s]backtest loop:  88%|████████▊ | 859/971 [00:15<00:01, 57.60it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 58.91it/s]backtest loop:  90%|████████▉ | 872/971 [00:16<00:01, 56.00it/s]backtest loop:  91%|█████████ | 879/971 [00:16<00:01, 57.89it/s]backtest loop:  91%|█████████ | 886/971 [00:16<00:01, 59.20it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 56.18it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 57.97it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 59.29it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 56.53it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 58.29it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 56.26it/s]backtest loop:  96%|█████████▌| 933/971 [00:17<00:00, 57.95it/s]backtest loop:  97%|█████████▋| 940/971 [00:17<00:00, 56.07it/s]backtest loop:  98%|█████████▊| 947/971 [00:17<00:00, 58.00it/s]backtest loop:  98%|█████████▊| 954/971 [00:17<00:00, 59.29it/s]backtest loop:  99%|█████████▉| 960/971 [00:17<00:00, 56.33it/s]backtest loop: 100%|█████████▉| 967/971 [00:17<00:00, 58.14it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.75it/s]
[3036190:MainThread](2024-04-25 03:07:33,427) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000597
std                0.006105
annualized_return  0.141971
information_ratio  1.507485
max_drawdown      -0.116379
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000397
std                0.006106
annualized_return  0.094378
information_ratio  1.001918
max_drawdown      -0.122158
[3036190:MainThread](2024-04-25 03:07:33,440) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `MLP_crowd_data_csi300_360_rankTrue`.
[3036190:MainThread](2024-04-25 03:07:40,067) INFO - qlib.timer - [log.py:127] - Time cost: 0.006s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.09660888993280313,
                                                    0.13562370991980652,
                                                    0.06660464834929007,
                                                    0.11273109897819915,
                                                    0.12508853654933336,
                                                    0.12193933987535104,
                                                    0.059086509324079446,
                                                    0.09437823940243575],
 '1day.excess_return_with_cost.information_ratio': [0.9965334629357873,
                                                    1.471462498466688,
                                                    0.8574204686978396,
                                                    1.1783584885283203,
                                                    1.5787766589453898,
                                                    1.5967941127594432,
                                                    0.7067206748880079,
                                                    1.001917606555779],
 '1day.excess_return_with_cost.max_drawdown': [-0.178625820283921,
                                               -0.12757703738688353,
                                               -0.0913209010721612,
                                               -0.11249516827526612,
                                               -0.07978807685234823,
                                               -0.08785727986105331,
                                               -0.09779338256797732,
                                               -0.12215782734934821],
 'IC': [0.022102653552402936,
        0.02409782375001873,
        0.022686097788742136,
        0.02367574671522226,
        0.026994334331438982,
        0.022168896888494324,
        0.021800412131666193,
        0.019800181045442358],
 'ICIR': [0.13898491673495106,
          0.15607704167026837,
          0.15786952974802382,
          0.14959396620968068,
          0.2055005402854329,
          0.1549874468820034,
          0.14518168977691154,
          0.12170849211192651],
 'Rank IC': [0.025665075667307198,
             0.03148333316577824,
             0.030750383407579112,
             0.03557216907148577,
             0.032984373539418264,
             0.031728544611053115,
             0.030161476140567276,
             0.03040487978179861],
 'Rank ICIR': [0.16136503534804983,
               0.21059379399912298,
               0.2200373329436436,
               0.2277897581780483,
               0.2471184880035974,
               0.23356527995755422,
               0.20055621145015046,
               0.19658633236114925],
 'mae': [0.8644317750225282,
         0.8642435379012978,
         0.8642145420813768,
         0.8640649052148514,
         0.8641229436793894,
         0.8642419257601456,
         0.8642964383530691,
         0.864250819471095],
 'mse': [0.9972685662584836,
         0.9972602008572546,
         0.9967983457930604,
         0.9969556729191729,
         0.9972293304320696,
         0.9972566124002319,
         0.9973126808783253,
         0.9971266967661773]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3036190:MainThread](2024-04-25 03:07:43,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3036190:MainThread](2024-04-25 03:07:43,153) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.01
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3036190:MainThread](2024-04-25 03:07:43,156) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3036190:MainThread](2024-04-25 03:07:43,156) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
[3036190:MainThread](2024-04-25 03:07:45,946) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name MLP_crowd_data_csi300_360_rankTrue_51.
[3036190:MainThread](2024-04-25 03:07:45,962) INFO - qlib.workflow - [exp.py:258] - Experiment 25 starts running ...
[3036190:MainThread](2024-04-25 03:07:45,972) INFO - qlib.workflow - [recorder.py:341] - Recorder b4fb89fd3d4a433f86938a4e01039331 starts running under Experiment 25 ...
[3036190:MainThread](2024-04-25 03:07:51,211) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[3036190:MainThread](2024-04-25 03:07:51,571) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 5.527371, valid_loss 1.110325, train_metric nan, valid_metric -0.017104
[3036190:MainThread](2024-04-25 03:07:51,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.110325, save checkpoint.
[3036190:MainThread](2024-04-25 03:07:51,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.061841, valid_loss 1.010323, train_metric nan, valid_metric -0.005712
[3036190:MainThread](2024-04-25 03:07:51,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.110325 to 1.010323, save checkpoint.
[3036190:MainThread](2024-04-25 03:07:51,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.026840, valid_loss 0.998716, train_metric nan, valid_metric 0.009901
[3036190:MainThread](2024-04-25 03:07:51,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.010323 to 0.998716, save checkpoint.
[3036190:MainThread](2024-04-25 03:07:52,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.012320, valid_loss 0.999298, train_metric nan, valid_metric 0.020624
[3036190:MainThread](2024-04-25 03:07:52,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.018539, valid_loss 0.999354, train_metric nan, valid_metric 0.020703
[3036190:MainThread](2024-04-25 03:07:52,350) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.014842, valid_loss 0.998598, train_metric nan, valid_metric 0.022406
[3036190:MainThread](2024-04-25 03:07:52,350) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998716 to 0.998598, save checkpoint.
[3036190:MainThread](2024-04-25 03:07:52,517) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.006651, valid_loss 0.998540, train_metric nan, valid_metric 0.023774
[3036190:MainThread](2024-04-25 03:07:52,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998598 to 0.998540, save checkpoint.
[3036190:MainThread](2024-04-25 03:07:52,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.014950, valid_loss 0.998272, train_metric nan, valid_metric 0.022601
[3036190:MainThread](2024-04-25 03:07:52,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998540 to 0.998272, save checkpoint.
[3036190:MainThread](2024-04-25 03:07:52,852) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.013445, valid_loss 0.998739, train_metric nan, valid_metric 0.023402
[3036190:MainThread](2024-04-25 03:07:53,016) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.008626, valid_loss 0.998929, train_metric nan, valid_metric 0.024272
[3036190:MainThread](2024-04-25 03:07:53,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.008062, valid_loss 0.998737, train_metric nan, valid_metric 0.018555
[3036190:MainThread](2024-04-25 03:07:53,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 1.007876, valid_loss 0.998714, train_metric nan, valid_metric 0.024302
[3036190:MainThread](2024-04-25 03:07:53,484) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 1.006109, valid_loss 0.998320, train_metric nan, valid_metric 0.028466
[3036190:MainThread](2024-04-25 03:07:53,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.002841, valid_loss 0.998472, train_metric nan, valid_metric 0.025683
[3036190:MainThread](2024-04-25 03:07:53,810) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 1.004839, valid_loss 0.998721, train_metric nan, valid_metric 0.023875
[3036190:MainThread](2024-04-25 03:07:53,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.009895, valid_loss 0.999010, train_metric nan, valid_metric 0.019688
[3036190:MainThread](2024-04-25 03:07:54,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.007006, valid_loss 0.999801, train_metric nan, valid_metric 0.027219
[3036190:MainThread](2024-04-25 03:07:54,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 1.007707, valid_loss 0.998413, train_metric nan, valid_metric 0.026992
[3036190:MainThread](2024-04-25 03:07:54,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.005814, valid_loss 0.998118, train_metric nan, valid_metric 0.027135
[3036190:MainThread](2024-04-25 03:07:54,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998272 to 0.998118, save checkpoint.
[3036190:MainThread](2024-04-25 03:07:54,615) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.006952, valid_loss 0.998483, train_metric nan, valid_metric 0.023155
[3036190:MainThread](2024-04-25 03:07:54,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 1.009752, valid_loss 0.998984, train_metric nan, valid_metric 0.025651
[3036190:MainThread](2024-04-25 03:07:54,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.006852, valid_loss 0.998074, train_metric nan, valid_metric 0.027071
[3036190:MainThread](2024-04-25 03:07:54,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998118 to 0.998074, save checkpoint.
[3036190:MainThread](2024-04-25 03:07:55,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 1.005889, valid_loss 0.998436, train_metric nan, valid_metric 0.026839
[3036190:MainThread](2024-04-25 03:07:55,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 1.008428, valid_loss 0.997950, train_metric nan, valid_metric 0.024321
[3036190:MainThread](2024-04-25 03:07:55,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998074 to 0.997950, save checkpoint.
[3036190:MainThread](2024-04-25 03:07:55,386) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 1.002587, valid_loss 0.998340, train_metric nan, valid_metric 0.019999
[3036190:MainThread](2024-04-25 03:07:55,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 1.000744, valid_loss 0.998752, train_metric nan, valid_metric 0.026054
[3036190:MainThread](2024-04-25 03:07:55,690) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 1.002358, valid_loss 0.998548, train_metric nan, valid_metric 0.024415
[3036190:MainThread](2024-04-25 03:07:55,850) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 1.003142, valid_loss 0.999372, train_metric nan, valid_metric 0.024628
[3036190:MainThread](2024-04-25 03:07:56,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.998932, valid_loss 0.998426, train_metric nan, valid_metric 0.027736
[3036190:MainThread](2024-04-25 03:07:56,163) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 0.996734, valid_loss 0.998957, train_metric nan, valid_metric 0.018559
[3036190:MainThread](2024-04-25 03:07:56,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.998827, valid_loss 0.998398, train_metric nan, valid_metric 0.022174
[3036190:MainThread](2024-04-25 03:07:56,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.994601, valid_loss 0.998631, train_metric nan, valid_metric 0.018505
[3036190:MainThread](2024-04-25 03:07:56,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 1.001552, valid_loss 0.998702, train_metric nan, valid_metric 0.026307
[3036190:MainThread](2024-04-25 03:07:56,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 0.993827, valid_loss 0.999118, train_metric nan, valid_metric 0.025633
[3036190:MainThread](2024-04-25 03:07:56,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 1.006374, valid_loss 0.999095, train_metric nan, valid_metric 0.028813
[3036190:MainThread](2024-04-25 03:07:57,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 1.000513, valid_loss 0.998860, train_metric nan, valid_metric 0.019284
[3036190:MainThread](2024-04-25 03:07:57,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.000578, valid_loss 0.999378, train_metric nan, valid_metric 0.021276
[3036190:MainThread](2024-04-25 03:07:57,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.002529, valid_loss 1.001236, train_metric nan, valid_metric 0.014167
[3036190:MainThread](2024-04-25 03:07:57,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.998882, valid_loss 1.000248, train_metric nan, valid_metric 0.023115
[3036190:MainThread](2024-04-25 03:07:57,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.994670, valid_loss 0.998505, train_metric nan, valid_metric 0.022115
[3036190:MainThread](2024-04-25 03:07:57,804) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.998821, valid_loss 0.998302, train_metric nan, valid_metric 0.026195
[3036190:MainThread](2024-04-25 03:07:57,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.993379, valid_loss 0.998546, train_metric nan, valid_metric 0.024695
[3036190:MainThread](2024-04-25 03:07:58,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.995790, valid_loss 1.000132, train_metric nan, valid_metric 0.017443
[3036190:MainThread](2024-04-25 03:07:58,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.988804, valid_loss 0.998519, train_metric nan, valid_metric 0.020500
[3036190:MainThread](2024-04-25 03:07:58,410) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.990940, valid_loss 0.998400, train_metric nan, valid_metric 0.022133
[3036190:MainThread](2024-04-25 03:07:58,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 0.997320, valid_loss 0.998933, train_metric nan, valid_metric 0.024976
[3036190:MainThread](2024-04-25 03:07:58,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.995199, valid_loss 0.999969, train_metric nan, valid_metric 0.028938
[3036190:MainThread](2024-04-25 03:07:58,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 1.003549, valid_loss 0.998094, train_metric nan, valid_metric 0.022830
[3036190:MainThread](2024-04-25 03:07:59,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.997273, valid_loss 0.998393, train_metric nan, valid_metric 0.027071
[3036190:MainThread](2024-04-25 03:07:59,156) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.995663, valid_loss 0.999402, train_metric nan, valid_metric 0.027270
[3036190:MainThread](2024-04-25 03:07:59,309) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.997545, valid_loss 0.997893, train_metric nan, valid_metric 0.027575
[3036190:MainThread](2024-04-25 03:07:59,310) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997950 to 0.997893, save checkpoint.
[3036190:MainThread](2024-04-25 03:07:59,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.990650, valid_loss 0.998715, train_metric nan, valid_metric 0.015373
[3036190:MainThread](2024-04-25 03:07:59,643) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 0.992707, valid_loss 0.997938, train_metric nan, valid_metric 0.025019
[3036190:MainThread](2024-04-25 03:07:59,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.993236, valid_loss 0.998141, train_metric nan, valid_metric 0.018388
[3036190:MainThread](2024-04-25 03:07:59,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.996388, valid_loss 0.998660, train_metric nan, valid_metric 0.027141
[3036190:MainThread](2024-04-25 03:08:00,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.996247, valid_loss 0.998610, train_metric nan, valid_metric 0.026676
[3036190:MainThread](2024-04-25 03:08:00,260) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.996025, valid_loss 1.002137, train_metric nan, valid_metric 0.032056
[3036190:MainThread](2024-04-25 03:08:00,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.996144, valid_loss 1.001700, train_metric nan, valid_metric 0.011710
[3036190:MainThread](2024-04-25 03:08:00,564) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.994877, valid_loss 0.998182, train_metric nan, valid_metric 0.028230
[3036190:MainThread](2024-04-25 03:08:00,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.992879, valid_loss 1.001563, train_metric nan, valid_metric 0.032178
[3036190:MainThread](2024-04-25 03:08:00,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.991901, valid_loss 0.998972, train_metric nan, valid_metric 0.023607
[3036190:MainThread](2024-04-25 03:08:01,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.996494, valid_loss 1.000929, train_metric nan, valid_metric 0.012082
[3036190:MainThread](2024-04-25 03:08:01,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.995890, valid_loss 1.000863, train_metric nan, valid_metric 0.026234
[3036190:MainThread](2024-04-25 03:08:01,342) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.995980, valid_loss 0.998159, train_metric nan, valid_metric 0.028366
[3036190:MainThread](2024-04-25 03:08:01,507) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.994154, valid_loss 0.999580, train_metric nan, valid_metric 0.017370
[3036190:MainThread](2024-04-25 03:08:01,669) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.995639, valid_loss 1.001706, train_metric nan, valid_metric 0.030814
[3036190:MainThread](2024-04-25 03:08:01,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.994105, valid_loss 0.998220, train_metric nan, valid_metric 0.029427
[3036190:MainThread](2024-04-25 03:08:01,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.989685, valid_loss 0.998095, train_metric nan, valid_metric 0.027939
[3036190:MainThread](2024-04-25 03:08:02,127) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.994647, valid_loss 1.000860, train_metric nan, valid_metric 0.027336
[3036190:MainThread](2024-04-25 03:08:02,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 0.992491, valid_loss 0.998711, train_metric nan, valid_metric 0.022174
[3036190:MainThread](2024-04-25 03:08:02,433) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.990534, valid_loss 0.999892, train_metric nan, valid_metric 0.021599
[3036190:MainThread](2024-04-25 03:08:02,585) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.994880, valid_loss 0.999776, train_metric nan, valid_metric 0.029680
[3036190:MainThread](2024-04-25 03:08:02,738) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.993046, valid_loss 0.998772, train_metric nan, valid_metric 0.029390
[3036190:MainThread](2024-04-25 03:08:02,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.987913, valid_loss 0.997736, train_metric nan, valid_metric 0.031085
[3036190:MainThread](2024-04-25 03:08:02,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997893 to 0.997736, save checkpoint.
[3036190:MainThread](2024-04-25 03:08:03,050) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.994487, valid_loss 1.007569, train_metric nan, valid_metric 0.007718
[3036190:MainThread](2024-04-25 03:08:03,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.998119, valid_loss 1.002752, train_metric nan, valid_metric 0.008317
[3036190:MainThread](2024-04-25 03:08:03,350) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.993151, valid_loss 0.999360, train_metric nan, valid_metric 0.029791
[3036190:MainThread](2024-04-25 03:08:03,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.998037, valid_loss 1.000368, train_metric nan, valid_metric 0.019553
[3036190:MainThread](2024-04-25 03:08:03,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.995987, valid_loss 0.997985, train_metric nan, valid_metric 0.031605
[3036190:MainThread](2024-04-25 03:08:03,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.992955, valid_loss 0.997962, train_metric nan, valid_metric 0.033430
[3036190:MainThread](2024-04-25 03:08:03,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.990723, valid_loss 0.998559, train_metric nan, valid_metric 0.031330
[3036190:MainThread](2024-04-25 03:08:04,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.988723, valid_loss 0.998938, train_metric nan, valid_metric 0.021507
[3036190:MainThread](2024-04-25 03:08:04,263) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.990986, valid_loss 0.997911, train_metric nan, valid_metric 0.029081
[3036190:MainThread](2024-04-25 03:08:04,416) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 0.990249, valid_loss 1.000143, train_metric nan, valid_metric 0.025585
[3036190:MainThread](2024-04-25 03:08:04,568) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.992006, valid_loss 0.999833, train_metric nan, valid_metric 0.032526
[3036190:MainThread](2024-04-25 03:08:04,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.997533, valid_loss 1.003982, train_metric nan, valid_metric 0.026574
[3036190:MainThread](2024-04-25 03:08:04,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.996021, valid_loss 0.997543, train_metric nan, valid_metric 0.029923
[3036190:MainThread](2024-04-25 03:08:04,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997736 to 0.997543, save checkpoint.
[3036190:MainThread](2024-04-25 03:08:05,028) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.996220, valid_loss 0.998265, train_metric nan, valid_metric 0.028745
[3036190:MainThread](2024-04-25 03:08:05,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.993384, valid_loss 0.999251, train_metric nan, valid_metric 0.034727
[3036190:MainThread](2024-04-25 03:08:05,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.994650, valid_loss 0.998322, train_metric nan, valid_metric 0.026732
[3036190:MainThread](2024-04-25 03:08:05,486) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.994532, valid_loss 1.002008, train_metric nan, valid_metric 0.016123
[3036190:MainThread](2024-04-25 03:08:05,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 0.992287, valid_loss 0.997998, train_metric nan, valid_metric 0.029842
[3036190:MainThread](2024-04-25 03:08:05,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.992147, valid_loss 1.000263, train_metric nan, valid_metric 0.032520
[3036190:MainThread](2024-04-25 03:08:05,942) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.994416, valid_loss 0.997618, train_metric nan, valid_metric 0.032823
[3036190:MainThread](2024-04-25 03:08:06,098) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.990804, valid_loss 1.000900, train_metric nan, valid_metric 0.027072
[3036190:MainThread](2024-04-25 03:08:06,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.990577, valid_loss 0.997663, train_metric nan, valid_metric 0.033618
[3036190:MainThread](2024-04-25 03:08:06,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.998010, valid_loss 0.999541, train_metric nan, valid_metric 0.020959
[3036190:MainThread](2024-04-25 03:08:06,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.991434, valid_loss 0.998346, train_metric nan, valid_metric 0.029675
[3036190:MainThread](2024-04-25 03:08:06,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1980]: train_loss 0.995299, valid_loss 1.000301, train_metric nan, valid_metric 0.021196
[3036190:MainThread](2024-04-25 03:08:06,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2000]: train_loss 0.993687, valid_loss 0.998965, train_metric nan, valid_metric 0.023573
[3036190:MainThread](2024-04-25 03:08:07,029) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2020]: train_loss 0.990062, valid_loss 1.002590, train_metric nan, valid_metric 0.016805
[3036190:MainThread](2024-04-25 03:08:07,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2040]: train_loss 0.990237, valid_loss 1.000224, train_metric nan, valid_metric 0.033910
[3036190:MainThread](2024-04-25 03:08:07,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2060]: train_loss 0.996240, valid_loss 0.998633, train_metric nan, valid_metric 0.032962
[3036190:MainThread](2024-04-25 03:08:07,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2080]: train_loss 0.990780, valid_loss 1.000642, train_metric nan, valid_metric 0.036919
[3036190:MainThread](2024-04-25 03:08:07,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2100]: train_loss 0.991240, valid_loss 0.998962, train_metric nan, valid_metric 0.028511
[3036190:MainThread](2024-04-25 03:08:07,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2120]: train_loss 0.987657, valid_loss 1.000890, train_metric nan, valid_metric 0.036293
[3036190:MainThread](2024-04-25 03:08:08,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2140]: train_loss 0.992939, valid_loss 1.000839, train_metric nan, valid_metric 0.029684
[3036190:MainThread](2024-04-25 03:08:08,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2160]: train_loss 0.997338, valid_loss 0.999225, train_metric nan, valid_metric 0.027647
[3036190:MainThread](2024-04-25 03:08:08,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2180]: train_loss 0.994686, valid_loss 0.998203, train_metric nan, valid_metric 0.038199
[3036190:MainThread](2024-04-25 03:08:08,486) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2200]: train_loss 0.999310, valid_loss 0.998183, train_metric nan, valid_metric 0.031262
[3036190:MainThread](2024-04-25 03:08:08,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2220]: train_loss 0.993750, valid_loss 1.003013, train_metric nan, valid_metric 0.028754
[3036190:MainThread](2024-04-25 03:08:08,810) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2240]: train_loss 1.000339, valid_loss 0.999200, train_metric nan, valid_metric 0.035297
[3036190:MainThread](2024-04-25 03:08:08,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2260]: train_loss 0.991637, valid_loss 0.999683, train_metric nan, valid_metric 0.023966
[3036190:MainThread](2024-04-25 03:08:09,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2280]: train_loss 0.994488, valid_loss 0.999417, train_metric nan, valid_metric 0.020342
[3036190:MainThread](2024-04-25 03:08:09,296) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2300]: train_loss 0.994317, valid_loss 0.997913, train_metric nan, valid_metric 0.035895
[3036190:MainThread](2024-04-25 03:08:09,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2320]: train_loss 0.994957, valid_loss 0.998002, train_metric nan, valid_metric 0.030350
[3036190:MainThread](2024-04-25 03:08:09,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2340]: train_loss 0.991141, valid_loss 0.999186, train_metric nan, valid_metric 0.031843
[3036190:MainThread](2024-04-25 03:08:09,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2360]: train_loss 0.989443, valid_loss 0.997553, train_metric nan, valid_metric 0.034320
[3036190:MainThread](2024-04-25 03:08:09,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2380]: train_loss 0.988938, valid_loss 0.999034, train_metric nan, valid_metric 0.031726
[3036190:MainThread](2024-04-25 03:08:10,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2400]: train_loss 0.993802, valid_loss 1.000979, train_metric nan, valid_metric 0.021805
[3036190:MainThread](2024-04-25 03:08:10,281) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2420]: train_loss 0.992645, valid_loss 0.997837, train_metric nan, valid_metric 0.032108
[3036190:MainThread](2024-04-25 03:08:10,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2440]: train_loss 0.991850, valid_loss 1.001766, train_metric nan, valid_metric 0.025649
[3036190:MainThread](2024-04-25 03:08:10,612) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2460]: train_loss 0.994124, valid_loss 1.002610, train_metric nan, valid_metric 0.021272
[3036190:MainThread](2024-04-25 03:08:10,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2480]: train_loss 0.990190, valid_loss 0.999889, train_metric nan, valid_metric 0.037893
[3036190:MainThread](2024-04-25 03:08:10,941) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2500]: train_loss 0.984017, valid_loss 1.000810, train_metric nan, valid_metric 0.020007
[3036190:MainThread](2024-04-25 03:08:11,105) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2520]: train_loss 0.986011, valid_loss 0.999880, train_metric nan, valid_metric 0.028861
[3036190:MainThread](2024-04-25 03:08:11,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2540]: train_loss 0.994077, valid_loss 0.998183, train_metric nan, valid_metric 0.029937
[3036190:MainThread](2024-04-25 03:08:11,424) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2560]: train_loss 0.995068, valid_loss 1.000468, train_metric nan, valid_metric 0.030055
[3036190:MainThread](2024-04-25 03:08:11,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2580]: train_loss 0.992608, valid_loss 1.001306, train_metric nan, valid_metric 0.035917
[3036190:MainThread](2024-04-25 03:08:11,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2600]: train_loss 0.993377, valid_loss 0.999277, train_metric nan, valid_metric 0.029455
[3036190:MainThread](2024-04-25 03:08:11,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2620]: train_loss 0.992448, valid_loss 0.998704, train_metric nan, valid_metric 0.033491
[3036190:MainThread](2024-04-25 03:08:12,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2640]: train_loss 0.989467, valid_loss 0.999231, train_metric nan, valid_metric 0.031629
[3036190:MainThread](2024-04-25 03:08:12,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2660]: train_loss 0.995910, valid_loss 0.999095, train_metric nan, valid_metric 0.029302
[3036190:MainThread](2024-04-25 03:08:12,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2680]: train_loss 0.998453, valid_loss 0.999676, train_metric nan, valid_metric 0.033204
[3036190:MainThread](2024-04-25 03:08:12,576) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2700]: train_loss 0.988779, valid_loss 1.001646, train_metric nan, valid_metric 0.026127
[3036190:MainThread](2024-04-25 03:08:12,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2720]: train_loss 0.988658, valid_loss 0.997697, train_metric nan, valid_metric 0.032964
[3036190:MainThread](2024-04-25 03:08:12,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 2740]: train_loss 0.991048, valid_loss 1.003054, train_metric nan, valid_metric 0.030162
[3036190:MainThread](2024-04-25 03:08:12,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[3036190:MainThread](2024-04-25 03:08:12,922) INFO - qlib.timer - [log.py:127] - Time cost: 0.002s | waiting `async_log` Done
Save pretrained model to MLP_crowd_data_csi300_360_rankTrue_51.
[3036190:MainThread](2024-04-25 03:08:13,128) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3036190:MainThread](2024-04-25 03:08:13,140) INFO - qlib.workflow - [recorder.py:341] - Recorder 9f84aa3b97574b58aa1706a346b7dbc2 starts running under Experiment 17 ...
{'IC': 0.02234994543163826,
 'ICIR': 0.1399944262294579,
 'Rank IC': 0.02491409945857444,
 'Rank ICIR': 0.16711917239399468}
[3036190:MainThread](2024-04-25 03:08:19,211) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3036190:MainThread](2024-04-25 03:08:57,167) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 03:08:57,170) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 03:09:03,189) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fc5332783a0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:38,  9.78it/s]backtest loop:   1%|          | 10/971 [00:00<00:34, 27.88it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:25, 37.02it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:22, 42.56it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:19, 48.46it/s]backtest loop:   4%|▍         | 38/971 [00:00<00:17, 52.65it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:17, 51.88it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:16, 55.03it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 53.43it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:16, 56.39it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:15, 58.65it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:15, 56.16it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 58.42it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 59.77it/s]backtest loop:  10%|█         | 98/971 [00:01<00:15, 57.43it/s]backtest loop:  11%|█         | 105/971 [00:02<00:14, 58.94it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 56.62it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:14, 58.22it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 53.75it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:16, 51.17it/s]backtest loop:  14%|█▍        | 137/971 [00:02<00:15, 52.36it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:15, 53.11it/s]backtest loop:  15%|█▌        | 149/971 [00:02<00:15, 53.62it/s]backtest loop:  16%|█▌        | 155/971 [00:03<00:15, 54.08it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:15, 51.18it/s]backtest loop:  17%|█▋        | 167/971 [00:03<00:15, 52.28it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:14, 53.34it/s]backtest loop:  18%|█▊        | 179/971 [00:03<00:14, 53.85it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:15, 51.03it/s]backtest loop:  20%|█▉        | 191/971 [00:03<00:14, 52.08it/s]backtest loop:  20%|██        | 197/971 [00:03<00:14, 52.95it/s]backtest loop:  21%|██        | 203/971 [00:03<00:14, 53.65it/s]backtest loop:  22%|██▏       | 209/971 [00:04<00:14, 54.39it/s]backtest loop:  22%|██▏       | 215/971 [00:04<00:15, 48.96it/s]backtest loop:  23%|██▎       | 221/971 [00:04<00:14, 50.79it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:14, 51.93it/s]backtest loop:  24%|██▍       | 233/971 [00:04<00:13, 52.84it/s]backtest loop:  25%|██▍       | 239/971 [00:04<00:13, 53.48it/s]backtest loop:  25%|██▌       | 245/971 [00:04<00:14, 50.89it/s]backtest loop:  26%|██▌       | 251/971 [00:04<00:13, 52.04it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:13, 52.79it/s]backtest loop:  27%|██▋       | 263/971 [00:05<00:13, 53.80it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:13, 50.75it/s]backtest loop:  28%|██▊       | 275/971 [00:05<00:13, 51.94it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:13, 49.73it/s]backtest loop:  30%|██▉       | 287/971 [00:05<00:13, 51.25it/s]backtest loop:  30%|███       | 293/971 [00:05<00:12, 52.28it/s]backtest loop:  31%|███       | 299/971 [00:05<00:12, 53.12it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:13, 50.51it/s]backtest loop:  32%|███▏      | 311/971 [00:06<00:12, 51.74it/s]backtest loop:  33%|███▎      | 317/971 [00:06<00:12, 52.69it/s]backtest loop:  33%|███▎      | 323/971 [00:06<00:12, 53.41it/s]backtest loop:  34%|███▍      | 329/971 [00:06<00:11, 53.96it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:12, 51.33it/s]backtest loop:  35%|███▌      | 341/971 [00:06<00:12, 52.14it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:11, 52.93it/s]backtest loop:  36%|███▋      | 353/971 [00:06<00:11, 53.61it/s]backtest loop:  37%|███▋      | 359/971 [00:06<00:11, 54.00it/s]backtest loop:  38%|███▊      | 365/971 [00:07<00:11, 51.45it/s]backtest loop:  38%|███▊      | 371/971 [00:07<00:12, 49.48it/s]backtest loop:  39%|███▉      | 377/971 [00:07<00:11, 51.34it/s]backtest loop:  39%|███▉      | 383/971 [00:07<00:11, 49.36it/s]backtest loop:  40%|████      | 389/971 [00:07<00:11, 50.89it/s]backtest loop:  41%|████      | 395/971 [00:07<00:11, 52.00it/s]backtest loop:  41%|████▏     | 401/971 [00:07<00:10, 52.88it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:10, 53.61it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:10, 50.87it/s]backtest loop:  43%|████▎     | 419/971 [00:08<00:10, 52.11it/s]backtest loop:  44%|████▍     | 425/971 [00:08<00:10, 52.98it/s]backtest loop:  44%|████▍     | 431/971 [00:08<00:10, 53.67it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:10, 50.80it/s]backtest loop:  46%|████▌     | 443/971 [00:08<00:10, 52.06it/s]backtest loop:  46%|████▌     | 449/971 [00:08<00:09, 52.81it/s]backtest loop:  47%|████▋     | 455/971 [00:08<00:14, 35.53it/s]backtest loop:  47%|████▋     | 461/971 [00:09<00:12, 39.72it/s]backtest loop:  48%|████▊     | 467/971 [00:09<00:12, 41.24it/s]backtest loop:  49%|████▊     | 473/971 [00:09<00:11, 44.57it/s]backtest loop:  49%|████▉     | 479/971 [00:09<00:10, 47.30it/s]backtest loop:  50%|████▉     | 485/971 [00:09<00:09, 49.41it/s]backtest loop:  51%|█████     | 491/971 [00:09<00:10, 47.93it/s]backtest loop:  51%|█████     | 497/971 [00:09<00:09, 49.87it/s]backtest loop:  52%|█████▏    | 503/971 [00:09<00:09, 51.46it/s]backtest loop:  52%|█████▏    | 509/971 [00:10<00:09, 49.34it/s]backtest loop:  53%|█████▎    | 515/971 [00:10<00:08, 50.92it/s]backtest loop:  54%|█████▎    | 521/971 [00:10<00:08, 52.20it/s]backtest loop:  54%|█████▍    | 527/971 [00:10<00:08, 49.92it/s]backtest loop:  55%|█████▍    | 533/971 [00:10<00:08, 51.57it/s]backtest loop:  56%|█████▌    | 539/971 [00:10<00:08, 52.79it/s]backtest loop:  56%|█████▌    | 545/971 [00:10<00:07, 53.48it/s]backtest loop:  57%|█████▋    | 551/971 [00:10<00:08, 50.79it/s]backtest loop:  57%|█████▋    | 557/971 [00:10<00:07, 52.03it/s]backtest loop:  58%|█████▊    | 563/971 [00:11<00:07, 52.69it/s]backtest loop:  59%|█████▊    | 569/971 [00:11<00:07, 53.38it/s]backtest loop:  59%|█████▉    | 575/971 [00:11<00:07, 53.86it/s]backtest loop:  60%|█████▉    | 581/971 [00:11<00:07, 50.99it/s]backtest loop:  60%|██████    | 587/971 [00:11<00:07, 51.58it/s]backtest loop:  61%|██████    | 594/971 [00:11<00:06, 54.92it/s]backtest loop:  62%|██████▏   | 600/971 [00:11<00:06, 53.34it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 56.03it/s]backtest loop:  63%|██████▎   | 614/971 [00:11<00:06, 57.93it/s]backtest loop:  64%|██████▍   | 620/971 [00:12<00:06, 55.34it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:05, 57.70it/s]backtest loop:  65%|██████▌   | 634/971 [00:12<00:05, 59.14it/s]backtest loop:  66%|██████▌   | 640/971 [00:12<00:05, 56.33it/s]backtest loop:  67%|██████▋   | 646/971 [00:12<00:05, 56.84it/s]backtest loop:  67%|██████▋   | 653/971 [00:12<00:05, 58.68it/s]backtest loop:  68%|██████▊   | 660/971 [00:12<00:05, 56.59it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 58.26it/s]backtest loop:  69%|██████▉   | 674/971 [00:13<00:05, 56.26it/s]backtest loop:  70%|███████   | 680/971 [00:13<00:05, 57.14it/s]backtest loop:  71%|███████   | 686/971 [00:13<00:04, 57.90it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:04, 59.22it/s]backtest loop:  72%|███████▏  | 699/971 [00:13<00:04, 56.14it/s]backtest loop:  73%|███████▎  | 705/971 [00:13<00:04, 57.19it/s]backtest loop:  73%|███████▎  | 711/971 [00:13<00:04, 57.96it/s]backtest loop:  74%|███████▍  | 718/971 [00:13<00:04, 59.38it/s]backtest loop:  75%|███████▍  | 724/971 [00:13<00:04, 56.48it/s]backtest loop:  75%|███████▌  | 731/971 [00:14<00:04, 55.13it/s]backtest loop:  76%|███████▌  | 738/971 [00:14<00:04, 54.32it/s]backtest loop:  77%|███████▋  | 745/971 [00:14<00:03, 56.69it/s]backtest loop:  77%|███████▋  | 751/971 [00:14<00:04, 54.50it/s]backtest loop:  78%|███████▊  | 758/971 [00:14<00:03, 56.72it/s]backtest loop:  79%|███████▉  | 765/971 [00:14<00:03, 55.26it/s]backtest loop:  80%|███████▉  | 772/971 [00:14<00:03, 57.23it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 58.65it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 55.85it/s]backtest loop:  82%|████████▏ | 792/971 [00:15<00:03, 57.70it/s]backtest loop:  82%|████████▏ | 798/971 [00:15<00:03, 55.15it/s]backtest loop:  83%|████████▎ | 804/971 [00:15<00:02, 56.43it/s]backtest loop:  84%|████████▎ | 811/971 [00:15<00:02, 58.15it/s]backtest loop:  84%|████████▍ | 817/971 [00:15<00:02, 58.19it/s]backtest loop:  85%|████████▍ | 823/971 [00:15<00:02, 55.41it/s]backtest loop:  85%|████████▌ | 830/971 [00:15<00:02, 57.48it/s]backtest loop:  86%|████████▌ | 837/971 [00:15<00:02, 58.91it/s]backtest loop:  87%|████████▋ | 843/971 [00:15<00:02, 55.90it/s]backtest loop:  88%|████████▊ | 850/971 [00:16<00:02, 57.77it/s]backtest loop:  88%|████████▊ | 857/971 [00:16<00:02, 55.91it/s]backtest loop:  89%|████████▉ | 864/971 [00:16<00:01, 57.73it/s]backtest loop:  90%|████████▉ | 871/971 [00:16<00:01, 59.06it/s]backtest loop:  90%|█████████ | 877/971 [00:16<00:01, 56.11it/s]backtest loop:  91%|█████████ | 884/971 [00:16<00:01, 57.95it/s]backtest loop:  92%|█████████▏| 891/971 [00:16<00:01, 59.21it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 55.83it/s]backtest loop:  93%|█████████▎| 903/971 [00:17<00:01, 56.92it/s]backtest loop:  94%|█████████▎| 910/971 [00:17<00:01, 58.49it/s]backtest loop:  94%|█████████▍| 916/971 [00:17<00:00, 55.70it/s]backtest loop:  95%|█████████▌| 923/971 [00:17<00:00, 57.59it/s]backtest loop:  96%|█████████▌| 930/971 [00:17<00:00, 59.01it/s]backtest loop:  96%|█████████▋| 936/971 [00:17<00:00, 56.08it/s]backtest loop:  97%|█████████▋| 943/971 [00:17<00:00, 57.88it/s]backtest loop:  98%|█████████▊| 950/971 [00:17<00:00, 56.38it/s]backtest loop:  99%|█████████▊| 957/971 [00:17<00:00, 58.22it/s]backtest loop:  99%|█████████▉| 964/971 [00:18<00:00, 59.39it/s]backtest loop: 100%|█████████▉| 970/971 [00:18<00:00, 56.25it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 53.33it/s]
[3036190:MainThread](2024-04-25 03:09:21,452) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000550
std                0.006283
annualized_return  0.130820
information_ratio  1.349753
max_drawdown      -0.131551
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000350
std                0.006284
annualized_return  0.083316
information_ratio  0.859438
max_drawdown      -0.165440
[3036190:MainThread](2024-04-25 03:09:21,464) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `MLP_crowd_data_csi300_360_rankTrue`.
[3036190:MainThread](2024-04-25 03:09:27,994) INFO - qlib.timer - [log.py:127] - Time cost: 0.006s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.09660888993280313,
                                                    0.13562370991980652,
                                                    0.06660464834929007,
                                                    0.11273109897819915,
                                                    0.12508853654933336,
                                                    0.12193933987535104,
                                                    0.059086509324079446,
                                                    0.09437823940243575,
                                                    0.0833159586278719],
 '1day.excess_return_with_cost.information_ratio': [0.9965334629357873,
                                                    1.471462498466688,
                                                    0.8574204686978396,
                                                    1.1783584885283203,
                                                    1.5787766589453898,
                                                    1.5967941127594432,
                                                    0.7067206748880079,
                                                    1.001917606555779,
                                                    0.8594384226724924],
 '1day.excess_return_with_cost.max_drawdown': [-0.178625820283921,
                                               -0.12757703738688353,
                                               -0.0913209010721612,
                                               -0.11249516827526612,
                                               -0.07978807685234823,
                                               -0.08785727986105331,
                                               -0.09779338256797732,
                                               -0.12215782734934821,
                                               -0.16544002131405366],
 'IC': [0.022102653552402936,
        0.02409782375001873,
        0.022686097788742136,
        0.02367574671522226,
        0.026994334331438982,
        0.022168896888494324,
        0.021800412131666193,
        0.019800181045442358,
        0.02234994543163826],
 'ICIR': [0.13898491673495106,
          0.15607704167026837,
          0.15786952974802382,
          0.14959396620968068,
          0.2055005402854329,
          0.1549874468820034,
          0.14518168977691154,
          0.12170849211192651,
          0.1399944262294579],
 'Rank IC': [0.025665075667307198,
             0.03148333316577824,
             0.030750383407579112,
             0.03557216907148577,
             0.032984373539418264,
             0.031728544611053115,
             0.030161476140567276,
             0.03040487978179861,
             0.02491409945857444],
 'Rank ICIR': [0.16136503534804983,
               0.21059379399912298,
               0.2200373329436436,
               0.2277897581780483,
               0.2471184880035974,
               0.23356527995755422,
               0.20055621145015046,
               0.19658633236114925,
               0.16711917239399468],
 'mae': [0.8644317750225282,
         0.8642435379012978,
         0.8642145420813768,
         0.8640649052148514,
         0.8641229436793894,
         0.8642419257601456,
         0.8642964383530691,
         0.864250819471095,
         0.8644296674677928],
 'mse': [0.9972685662584836,
         0.9972602008572546,
         0.9967983457930604,
         0.9969556729191729,
         0.9972293304320696,
         0.9972566124002319,
         0.9973126808783253,
         0.9971266967661773,
         0.9977867425827526]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3036190:MainThread](2024-04-25 03:09:31,067) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3036190:MainThread](2024-04-25 03:09:31,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.01
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3036190:MainThread](2024-04-25 03:09:31,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3036190:MainThread](2024-04-25 03:09:31,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
[3036190:MainThread](2024-04-25 03:09:33,833) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name MLP_crowd_data_csi300_360_rankTrue_52.
[3036190:MainThread](2024-04-25 03:09:33,850) INFO - qlib.workflow - [exp.py:258] - Experiment 26 starts running ...
[3036190:MainThread](2024-04-25 03:09:33,860) INFO - qlib.workflow - [recorder.py:341] - Recorder 631f38aef15c4b9d8eece805ebeee818 starts running under Experiment 26 ...
[3036190:MainThread](2024-04-25 03:09:39,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:219] - training...
[3036190:MainThread](2024-04-25 03:09:39,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 20]: train_loss 2.102522, valid_loss 1.195652, train_metric nan, valid_metric 0.021415
[3036190:MainThread](2024-04-25 03:09:39,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from inf to 1.195652, save checkpoint.
[3036190:MainThread](2024-04-25 03:09:39,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 40]: train_loss 1.046126, valid_loss 1.006971, train_metric nan, valid_metric 0.000482
[3036190:MainThread](2024-04-25 03:09:39,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.195652 to 1.006971, save checkpoint.
[3036190:MainThread](2024-04-25 03:09:39,774) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 60]: train_loss 1.013790, valid_loss 0.999381, train_metric nan, valid_metric 0.021717
[3036190:MainThread](2024-04-25 03:09:39,774) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 1.006971 to 0.999381, save checkpoint.
[3036190:MainThread](2024-04-25 03:09:39,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 80]: train_loss 1.009715, valid_loss 0.999422, train_metric nan, valid_metric 0.012600
[3036190:MainThread](2024-04-25 03:09:40,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 100]: train_loss 1.005959, valid_loss 0.998032, train_metric nan, valid_metric 0.025795
[3036190:MainThread](2024-04-25 03:09:40,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.999381 to 0.998032, save checkpoint.
[3036190:MainThread](2024-04-25 03:09:40,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 120]: train_loss 1.007082, valid_loss 1.000027, train_metric nan, valid_metric 0.003251
[3036190:MainThread](2024-04-25 03:09:40,396) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 140]: train_loss 1.003833, valid_loss 0.999776, train_metric nan, valid_metric 0.008185
[3036190:MainThread](2024-04-25 03:09:40,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 160]: train_loss 1.005692, valid_loss 0.998885, train_metric nan, valid_metric 0.021521
[3036190:MainThread](2024-04-25 03:09:40,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 180]: train_loss 1.007189, valid_loss 0.998758, train_metric nan, valid_metric 0.021877
[3036190:MainThread](2024-04-25 03:09:40,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 200]: train_loss 1.001119, valid_loss 0.998363, train_metric nan, valid_metric 0.023075
[3036190:MainThread](2024-04-25 03:09:41,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 220]: train_loss 1.008608, valid_loss 0.998043, train_metric nan, valid_metric 0.021929
[3036190:MainThread](2024-04-25 03:09:41,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 240]: train_loss 0.995579, valid_loss 0.999304, train_metric nan, valid_metric 0.023156
[3036190:MainThread](2024-04-25 03:09:41,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 260]: train_loss 0.996716, valid_loss 1.002120, train_metric nan, valid_metric 0.025386
[3036190:MainThread](2024-04-25 03:09:41,496) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 280]: train_loss 1.003306, valid_loss 0.999957, train_metric nan, valid_metric 0.023166
[3036190:MainThread](2024-04-25 03:09:41,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 300]: train_loss 0.996388, valid_loss 0.998510, train_metric nan, valid_metric 0.024522
[3036190:MainThread](2024-04-25 03:09:41,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 320]: train_loss 1.000922, valid_loss 0.998580, train_metric nan, valid_metric 0.024881
[3036190:MainThread](2024-04-25 03:09:41,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 340]: train_loss 1.001719, valid_loss 1.003178, train_metric nan, valid_metric -0.000700
[3036190:MainThread](2024-04-25 03:09:42,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 360]: train_loss 0.999401, valid_loss 1.000263, train_metric nan, valid_metric 0.022589
[3036190:MainThread](2024-04-25 03:09:42,275) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 380]: train_loss 1.001404, valid_loss 0.997984, train_metric nan, valid_metric 0.021281
[3036190:MainThread](2024-04-25 03:09:42,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.998032 to 0.997984, save checkpoint.
[3036190:MainThread](2024-04-25 03:09:42,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 400]: train_loss 1.002507, valid_loss 1.000818, train_metric nan, valid_metric 0.024916
[3036190:MainThread](2024-04-25 03:09:42,611) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 420]: train_loss 0.992884, valid_loss 0.999541, train_metric nan, valid_metric 0.020354
[3036190:MainThread](2024-04-25 03:09:42,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 440]: train_loss 1.001022, valid_loss 1.011857, train_metric nan, valid_metric -0.006553
[3036190:MainThread](2024-04-25 03:09:42,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 460]: train_loss 0.997030, valid_loss 0.998684, train_metric nan, valid_metric 0.022268
[3036190:MainThread](2024-04-25 03:09:43,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 480]: train_loss 0.992428, valid_loss 1.000102, train_metric nan, valid_metric 0.010485
[3036190:MainThread](2024-04-25 03:09:43,263) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 500]: train_loss 0.996067, valid_loss 0.999991, train_metric nan, valid_metric 0.013915
[3036190:MainThread](2024-04-25 03:09:43,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 520]: train_loss 0.993182, valid_loss 0.998133, train_metric nan, valid_metric 0.018541
[3036190:MainThread](2024-04-25 03:09:43,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 540]: train_loss 0.995377, valid_loss 1.002661, train_metric nan, valid_metric 0.020851
[3036190:MainThread](2024-04-25 03:09:43,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 560]: train_loss 0.994773, valid_loss 0.998518, train_metric nan, valid_metric 0.019777
[3036190:MainThread](2024-04-25 03:09:43,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 580]: train_loss 0.994216, valid_loss 0.997996, train_metric nan, valid_metric 0.023376
[3036190:MainThread](2024-04-25 03:09:44,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 600]: train_loss 1.003874, valid_loss 0.998707, train_metric nan, valid_metric 0.015905
[3036190:MainThread](2024-04-25 03:09:44,333) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 620]: train_loss 0.992934, valid_loss 1.002390, train_metric nan, valid_metric 0.023565
[3036190:MainThread](2024-04-25 03:09:44,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 640]: train_loss 0.999522, valid_loss 0.998671, train_metric nan, valid_metric 0.019687
[3036190:MainThread](2024-04-25 03:09:44,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 660]: train_loss 0.995129, valid_loss 1.004140, train_metric nan, valid_metric 0.006247
[3036190:MainThread](2024-04-25 03:09:44,897) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 680]: train_loss 1.002498, valid_loss 1.004438, train_metric nan, valid_metric 0.022851
[3036190:MainThread](2024-04-25 03:09:45,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 700]: train_loss 0.992278, valid_loss 0.998840, train_metric nan, valid_metric 0.018226
[3036190:MainThread](2024-04-25 03:09:45,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 720]: train_loss 0.998067, valid_loss 0.999201, train_metric nan, valid_metric 0.012671
[3036190:MainThread](2024-04-25 03:09:45,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 740]: train_loss 1.000507, valid_loss 0.998604, train_metric nan, valid_metric 0.030072
[3036190:MainThread](2024-04-25 03:09:45,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 760]: train_loss 1.000360, valid_loss 0.998296, train_metric nan, valid_metric 0.020059
[3036190:MainThread](2024-04-25 03:09:45,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 780]: train_loss 0.999422, valid_loss 0.999767, train_metric nan, valid_metric 0.030229
[3036190:MainThread](2024-04-25 03:09:45,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 800]: train_loss 0.995240, valid_loss 1.000549, train_metric nan, valid_metric 0.018992
[3036190:MainThread](2024-04-25 03:09:46,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 820]: train_loss 0.995247, valid_loss 0.998108, train_metric nan, valid_metric 0.025030
[3036190:MainThread](2024-04-25 03:09:46,295) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 840]: train_loss 0.997503, valid_loss 0.999717, train_metric nan, valid_metric 0.011755
[3036190:MainThread](2024-04-25 03:09:46,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 860]: train_loss 0.998487, valid_loss 0.998975, train_metric nan, valid_metric 0.025118
[3036190:MainThread](2024-04-25 03:09:46,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 880]: train_loss 0.994337, valid_loss 0.998893, train_metric nan, valid_metric 0.019392
[3036190:MainThread](2024-04-25 03:09:46,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 900]: train_loss 0.995908, valid_loss 1.001907, train_metric nan, valid_metric 0.023508
[3036190:MainThread](2024-04-25 03:09:47,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 920]: train_loss 1.001218, valid_loss 0.998835, train_metric nan, valid_metric 0.027001
[3036190:MainThread](2024-04-25 03:09:47,213) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 940]: train_loss 0.994534, valid_loss 0.999762, train_metric nan, valid_metric 0.013527
[3036190:MainThread](2024-04-25 03:09:47,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 960]: train_loss 0.994899, valid_loss 0.997357, train_metric nan, valid_metric 0.030973
[3036190:MainThread](2024-04-25 03:09:47,403) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:296] - 	valid loss update from 0.997984 to 0.997357, save checkpoint.
[3036190:MainThread](2024-04-25 03:09:47,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 980]: train_loss 0.999079, valid_loss 0.999284, train_metric nan, valid_metric 0.029221
[3036190:MainThread](2024-04-25 03:09:47,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1000]: train_loss 0.994346, valid_loss 0.998249, train_metric nan, valid_metric 0.029329
[3036190:MainThread](2024-04-25 03:09:47,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1020]: train_loss 0.996716, valid_loss 0.998747, train_metric nan, valid_metric 0.027814
[3036190:MainThread](2024-04-25 03:09:48,080) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1040]: train_loss 0.993569, valid_loss 1.000970, train_metric nan, valid_metric 0.023218
[3036190:MainThread](2024-04-25 03:09:48,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1060]: train_loss 1.004510, valid_loss 1.000832, train_metric nan, valid_metric 0.011119
[3036190:MainThread](2024-04-25 03:09:48,434) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1080]: train_loss 0.993082, valid_loss 0.999467, train_metric nan, valid_metric 0.015360
[3036190:MainThread](2024-04-25 03:09:48,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1100]: train_loss 0.997674, valid_loss 1.000305, train_metric nan, valid_metric 0.016681
[3036190:MainThread](2024-04-25 03:09:48,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1120]: train_loss 0.998545, valid_loss 1.003547, train_metric nan, valid_metric 0.030188
[3036190:MainThread](2024-04-25 03:09:48,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1140]: train_loss 0.997817, valid_loss 0.997729, train_metric nan, valid_metric 0.034217
[3036190:MainThread](2024-04-25 03:09:49,059) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1160]: train_loss 0.996206, valid_loss 0.999354, train_metric nan, valid_metric 0.020164
[3036190:MainThread](2024-04-25 03:09:49,214) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1180]: train_loss 0.993576, valid_loss 1.003084, train_metric nan, valid_metric 0.000734
[3036190:MainThread](2024-04-25 03:09:49,371) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1200]: train_loss 0.998904, valid_loss 0.998684, train_metric nan, valid_metric 0.025241
[3036190:MainThread](2024-04-25 03:09:49,530) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1220]: train_loss 0.996568, valid_loss 1.002722, train_metric nan, valid_metric 0.005748
[3036190:MainThread](2024-04-25 03:09:49,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1240]: train_loss 0.998678, valid_loss 1.000384, train_metric nan, valid_metric 0.031942
[3036190:MainThread](2024-04-25 03:09:49,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1260]: train_loss 0.993666, valid_loss 1.001034, train_metric nan, valid_metric 0.016690
[3036190:MainThread](2024-04-25 03:09:49,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1280]: train_loss 0.992080, valid_loss 1.005958, train_metric nan, valid_metric 0.030335
[3036190:MainThread](2024-04-25 03:09:50,156) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1300]: train_loss 0.999322, valid_loss 0.998254, train_metric nan, valid_metric 0.029701
[3036190:MainThread](2024-04-25 03:09:50,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1320]: train_loss 0.994228, valid_loss 1.002049, train_metric nan, valid_metric 0.025352
[3036190:MainThread](2024-04-25 03:09:50,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1340]: train_loss 0.999004, valid_loss 0.998962, train_metric nan, valid_metric 0.019191
[3036190:MainThread](2024-04-25 03:09:50,630) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1360]: train_loss 0.993675, valid_loss 1.000710, train_metric nan, valid_metric 0.024342
[3036190:MainThread](2024-04-25 03:09:50,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1380]: train_loss 0.996924, valid_loss 0.998190, train_metric nan, valid_metric 0.024340
[3036190:MainThread](2024-04-25 03:09:50,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1400]: train_loss 1.001283, valid_loss 0.997575, train_metric nan, valid_metric 0.028704
[3036190:MainThread](2024-04-25 03:09:51,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1420]: train_loss 0.994034, valid_loss 0.998828, train_metric nan, valid_metric 0.022731
[3036190:MainThread](2024-04-25 03:09:51,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1440]: train_loss 0.994631, valid_loss 1.003791, train_metric nan, valid_metric 0.012579
[3036190:MainThread](2024-04-25 03:09:51,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1460]: train_loss 0.998393, valid_loss 1.000131, train_metric nan, valid_metric 0.025147
[3036190:MainThread](2024-04-25 03:09:51,712) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1480]: train_loss 0.994366, valid_loss 1.000370, train_metric nan, valid_metric 0.028906
[3036190:MainThread](2024-04-25 03:09:51,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1500]: train_loss 0.991785, valid_loss 1.001597, train_metric nan, valid_metric 0.012653
[3036190:MainThread](2024-04-25 03:09:52,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1520]: train_loss 0.990840, valid_loss 0.998819, train_metric nan, valid_metric 0.033307
[3036190:MainThread](2024-04-25 03:09:52,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1540]: train_loss 0.989249, valid_loss 0.998671, train_metric nan, valid_metric 0.018771
[3036190:MainThread](2024-04-25 03:09:52,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1560]: train_loss 0.992011, valid_loss 0.998198, train_metric nan, valid_metric 0.022128
[3036190:MainThread](2024-04-25 03:09:52,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1580]: train_loss 0.995174, valid_loss 0.999023, train_metric nan, valid_metric 0.028739
[3036190:MainThread](2024-04-25 03:09:52,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1600]: train_loss 0.991475, valid_loss 0.998149, train_metric nan, valid_metric 0.031084
[3036190:MainThread](2024-04-25 03:09:53,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1620]: train_loss 0.993215, valid_loss 0.998403, train_metric nan, valid_metric 0.032157
[3036190:MainThread](2024-04-25 03:09:53,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1640]: train_loss 0.997015, valid_loss 1.000593, train_metric nan, valid_metric 0.028148
[3036190:MainThread](2024-04-25 03:09:53,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1660]: train_loss 0.994623, valid_loss 1.002360, train_metric nan, valid_metric 0.012212
[3036190:MainThread](2024-04-25 03:09:53,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1680]: train_loss 1.001880, valid_loss 1.002513, train_metric nan, valid_metric 0.027347
[3036190:MainThread](2024-04-25 03:09:53,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1700]: train_loss 0.992187, valid_loss 0.999343, train_metric nan, valid_metric 0.017331
[3036190:MainThread](2024-04-25 03:09:54,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1720]: train_loss 0.997979, valid_loss 0.999989, train_metric nan, valid_metric 0.022112
[3036190:MainThread](2024-04-25 03:09:54,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1740]: train_loss 0.993791, valid_loss 1.005056, train_metric nan, valid_metric 0.032967
[3036190:MainThread](2024-04-25 03:09:54,400) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1760]: train_loss 0.999432, valid_loss 0.998922, train_metric nan, valid_metric 0.025437
[3036190:MainThread](2024-04-25 03:09:54,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1780]: train_loss 0.991871, valid_loss 0.998469, train_metric nan, valid_metric 0.023417
[3036190:MainThread](2024-04-25 03:09:54,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1800]: train_loss 0.992752, valid_loss 1.003382, train_metric nan, valid_metric 0.009624
[3036190:MainThread](2024-04-25 03:09:54,877) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1820]: train_loss 0.998564, valid_loss 0.999225, train_metric nan, valid_metric 0.022485
[3036190:MainThread](2024-04-25 03:09:55,034) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1840]: train_loss 1.005729, valid_loss 1.009400, train_metric nan, valid_metric 0.030195
[3036190:MainThread](2024-04-25 03:09:55,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1860]: train_loss 0.996967, valid_loss 1.003465, train_metric nan, valid_metric 0.030568
[3036190:MainThread](2024-04-25 03:09:55,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1880]: train_loss 0.993485, valid_loss 0.999005, train_metric nan, valid_metric 0.027395
[3036190:MainThread](2024-04-25 03:09:55,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1900]: train_loss 0.995680, valid_loss 1.000910, train_metric nan, valid_metric 0.028638
[3036190:MainThread](2024-04-25 03:09:55,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1920]: train_loss 0.990687, valid_loss 0.999294, train_metric nan, valid_metric 0.029091
[3036190:MainThread](2024-04-25 03:09:55,813) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1940]: train_loss 0.988189, valid_loss 1.003084, train_metric nan, valid_metric 0.031661
[3036190:MainThread](2024-04-25 03:09:55,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:289] - [Step 1960]: train_loss 0.993161, valid_loss 1.005423, train_metric nan, valid_metric 0.025330
[3036190:MainThread](2024-04-25 03:09:55,970) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:228] - 	early stop
[3036190:MainThread](2024-04-25 03:09:55,988) INFO - qlib.timer - [log.py:127] - Time cost: 0.001s | waiting `async_log` Done
Save pretrained model to MLP_crowd_data_csi300_360_rankTrue_52.
[3036190:MainThread](2024-04-25 03:09:56,195) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3036190:MainThread](2024-04-25 03:09:56,207) INFO - qlib.workflow - [recorder.py:341] - Recorder 0b19935a166145f1a99cd6e706add95c starts running under Experiment 17 ...
{'IC': 0.01920513500571938,
 'ICIR': 0.12626328899004252,
 'Rank IC': 0.02945695447345232,
 'Rank ICIR': 0.19685054670795823}
[3036190:MainThread](2024-04-25 03:10:02,317) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3036190:MainThread](2024-04-25 03:10:40,952) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 03:10:40,955) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3036190:MainThread](2024-04-25 03:10:47,063) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fc5354ea700>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:40,  9.67it/s]backtest loop:   1%|          | 10/971 [00:00<00:34, 27.60it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:26, 36.47it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:22, 41.91it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:19, 47.94it/s]backtest loop:   4%|▍         | 38/971 [00:00<00:17, 52.14it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:18, 49.10it/s]backtest loop:   5%|▌         | 50/971 [00:01<00:18, 50.75it/s]backtest loop:   6%|▌         | 56/971 [00:01<00:17, 51.97it/s]backtest loop:   6%|▋         | 62/971 [00:01<00:18, 49.90it/s]backtest loop:   7%|▋         | 68/971 [00:01<00:17, 51.81it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:16, 53.06it/s]backtest loop:   8%|▊         | 80/971 [00:01<00:16, 53.67it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:16, 54.58it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:17, 51.65it/s]backtest loop:  10%|█         | 98/971 [00:02<00:16, 52.32it/s]backtest loop:  11%|█         | 104/971 [00:02<00:16, 53.01it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:16, 53.72it/s]backtest loop:  12%|█▏        | 116/971 [00:02<00:15, 54.14it/s]backtest loop:  13%|█▎        | 122/971 [00:02<00:16, 51.52it/s]backtest loop:  13%|█▎        | 128/971 [00:02<00:17, 49.55it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:16, 51.31it/s]backtest loop:  14%|█▍        | 140/971 [00:02<00:15, 52.53it/s]backtest loop:  15%|█▌        | 146/971 [00:03<00:16, 50.15it/s]backtest loop:  16%|█▌        | 152/971 [00:03<00:15, 51.60it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:15, 52.47it/s]backtest loop:  17%|█▋        | 164/971 [00:03<00:15, 53.15it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:14, 53.70it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:15, 50.70it/s]backtest loop:  19%|█▊        | 182/971 [00:03<00:15, 51.95it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:14, 52.89it/s]backtest loop:  20%|█▉        | 194/971 [00:03<00:14, 53.56it/s]backtest loop:  21%|██        | 200/971 [00:04<00:15, 50.84it/s]backtest loop:  21%|██        | 206/971 [00:04<00:14, 52.18it/s]backtest loop:  22%|██▏       | 212/971 [00:04<00:14, 53.11it/s]backtest loop:  22%|██▏       | 218/971 [00:04<00:14, 50.68it/s]backtest loop:  23%|██▎       | 224/971 [00:04<00:14, 51.86it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:14, 49.87it/s]backtest loop:  24%|██▍       | 236/971 [00:04<00:14, 51.34it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:13, 52.39it/s]backtest loop:  26%|██▌       | 248/971 [00:04<00:13, 53.13it/s]backtest loop:  26%|██▌       | 254/971 [00:05<00:14, 50.30it/s]backtest loop:  27%|██▋       | 260/971 [00:05<00:13, 51.63it/s]backtest loop:  27%|██▋       | 266/971 [00:05<00:14, 49.67it/s]backtest loop:  28%|██▊       | 272/971 [00:05<00:13, 51.30it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:13, 52.36it/s]backtest loop:  29%|██▉       | 284/971 [00:05<00:12, 53.14it/s]backtest loop:  30%|██▉       | 290/971 [00:05<00:12, 53.69it/s]backtest loop:  30%|███       | 296/971 [00:05<00:13, 50.94it/s]backtest loop:  31%|███       | 302/971 [00:06<00:12, 52.11it/s]backtest loop:  32%|███▏      | 308/971 [00:06<00:12, 52.98it/s]backtest loop:  32%|███▏      | 314/971 [00:06<00:12, 53.58it/s]backtest loop:  33%|███▎      | 320/971 [00:06<00:12, 50.83it/s]backtest loop:  34%|███▎      | 326/971 [00:06<00:12, 51.92it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:12, 52.67it/s]backtest loop:  35%|███▍      | 338/971 [00:06<00:11, 53.51it/s]backtest loop:  35%|███▌      | 344/971 [00:06<00:11, 54.12it/s]backtest loop:  36%|███▌      | 350/971 [00:06<00:12, 51.30it/s]backtest loop:  37%|███▋      | 357/971 [00:07<00:17, 35.98it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:15, 39.22it/s]backtest loop:  38%|███▊      | 368/971 [00:07<00:14, 40.85it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:12, 46.22it/s]backtest loop:  39%|███▉      | 382/971 [00:07<00:11, 50.59it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:11, 50.44it/s]backtest loop:  41%|████      | 395/971 [00:07<00:10, 53.45it/s]backtest loop:  41%|████▏     | 402/971 [00:08<00:10, 55.98it/s]backtest loop:  42%|████▏     | 408/971 [00:08<00:10, 54.02it/s]backtest loop:  43%|████▎     | 415/971 [00:08<00:09, 56.40it/s]backtest loop:  43%|████▎     | 422/971 [00:08<00:09, 58.12it/s]backtest loop:  44%|████▍     | 428/971 [00:08<00:09, 55.53it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:09, 57.52it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:09, 55.84it/s]backtest loop:  46%|████▌     | 449/971 [00:08<00:09, 57.64it/s]backtest loop:  47%|████▋     | 456/971 [00:08<00:08, 59.03it/s]backtest loop:  48%|████▊     | 462/971 [00:09<00:09, 56.12it/s]backtest loop:  48%|████▊     | 469/971 [00:09<00:08, 57.94it/s]backtest loop:  49%|████▉     | 476/971 [00:09<00:08, 59.30it/s]backtest loop:  50%|████▉     | 482/971 [00:09<00:08, 55.96it/s]backtest loop:  50%|█████     | 488/971 [00:09<00:08, 56.91it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:08, 55.49it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:08, 57.54it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:08, 55.08it/s]backtest loop:  53%|█████▎    | 515/971 [00:10<00:07, 57.17it/s]backtest loop:  54%|█████▍    | 522/971 [00:10<00:08, 55.80it/s]backtest loop:  54%|█████▍    | 529/971 [00:10<00:07, 57.80it/s]backtest loop:  55%|█████▌    | 536/971 [00:10<00:07, 56.37it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:07, 58.08it/s]backtest loop:  57%|█████▋    | 550/971 [00:10<00:07, 59.42it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:07, 56.33it/s]backtest loop:  58%|█████▊    | 563/971 [00:10<00:07, 58.11it/s]backtest loop:  59%|█████▊    | 569/971 [00:10<00:06, 58.59it/s]backtest loop:  59%|█████▉    | 576/971 [00:11<00:06, 56.64it/s]backtest loop:  60%|██████    | 583/971 [00:11<00:06, 58.92it/s]backtest loop:  61%|██████    | 590/971 [00:11<00:06, 59.99it/s]backtest loop:  61%|██████▏   | 597/971 [00:11<00:06, 57.59it/s]backtest loop:  62%|██████▏   | 604/971 [00:11<00:06, 59.00it/s]backtest loop:  63%|██████▎   | 610/971 [00:11<00:06, 56.17it/s]backtest loop:  64%|██████▎   | 617/971 [00:11<00:06, 57.87it/s]backtest loop:  64%|██████▍   | 623/971 [00:11<00:06, 57.24it/s]backtest loop:  65%|██████▍   | 629/971 [00:11<00:06, 56.94it/s]backtest loop:  65%|██████▌   | 635/971 [00:12<00:06, 53.23it/s]backtest loop:  66%|██████▌   | 641/971 [00:12<00:06, 53.70it/s]backtest loop:  67%|██████▋   | 647/971 [00:12<00:06, 53.69it/s]backtest loop:  67%|██████▋   | 653/971 [00:12<00:05, 54.09it/s]backtest loop:  68%|██████▊   | 659/971 [00:12<00:05, 54.37it/s]backtest loop:  68%|██████▊   | 665/971 [00:12<00:05, 51.33it/s]backtest loop:  69%|██████▉   | 671/971 [00:12<00:05, 52.37it/s]backtest loop:  70%|██████▉   | 677/971 [00:12<00:05, 53.17it/s]backtest loop:  70%|███████   | 683/971 [00:13<00:05, 53.46it/s]backtest loop:  71%|███████   | 689/971 [00:13<00:05, 50.74it/s]backtest loop:  72%|███████▏  | 695/971 [00:13<00:05, 51.94it/s]backtest loop:  72%|███████▏  | 701/971 [00:13<00:05, 52.87it/s]backtest loop:  73%|███████▎  | 707/971 [00:13<00:04, 53.51it/s]backtest loop:  73%|███████▎  | 713/971 [00:13<00:04, 53.98it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 51.14it/s]backtest loop:  75%|███████▍  | 725/971 [00:13<00:04, 51.99it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 49.99it/s]backtest loop:  76%|███████▌  | 737/971 [00:14<00:04, 51.34it/s]backtest loop:  77%|███████▋  | 743/971 [00:14<00:04, 49.28it/s]backtest loop:  77%|███████▋  | 749/971 [00:14<00:04, 50.84it/s]backtest loop:  78%|███████▊  | 755/971 [00:14<00:04, 48.99it/s]backtest loop:  78%|███████▊  | 761/971 [00:14<00:04, 50.66it/s]backtest loop:  79%|███████▉  | 767/971 [00:14<00:03, 51.86it/s]backtest loop:  80%|███████▉  | 773/971 [00:14<00:03, 52.73it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 53.75it/s]backtest loop:  81%|████████  | 785/971 [00:15<00:03, 50.88it/s]backtest loop:  81%|████████▏ | 791/971 [00:15<00:03, 52.10it/s]backtest loop:  82%|████████▏ | 797/971 [00:15<00:03, 52.95it/s]backtest loop:  83%|████████▎ | 803/971 [00:15<00:03, 49.94it/s]backtest loop:  83%|████████▎ | 809/971 [00:15<00:03, 51.22it/s]backtest loop:  84%|████████▍ | 815/971 [00:15<00:02, 52.35it/s]backtest loop:  85%|████████▍ | 821/971 [00:15<00:02, 53.13it/s]backtest loop:  85%|████████▌ | 827/971 [00:15<00:02, 53.61it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 50.79it/s]backtest loop:  86%|████████▋ | 839/971 [00:16<00:02, 51.92it/s]backtest loop:  87%|████████▋ | 845/971 [00:16<00:02, 52.75it/s]backtest loop:  88%|████████▊ | 851/971 [00:16<00:02, 53.42it/s]backtest loop:  88%|████████▊ | 857/971 [00:16<00:02, 50.65it/s]backtest loop:  89%|████████▉ | 863/971 [00:16<00:02, 51.84it/s]backtest loop:  89%|████████▉ | 869/971 [00:16<00:01, 52.71it/s]backtest loop:  90%|█████████ | 875/971 [00:16<00:01, 53.38it/s]backtest loop:  91%|█████████ | 881/971 [00:16<00:01, 53.31it/s]backtest loop:  91%|█████████▏| 887/971 [00:16<00:01, 50.60it/s]backtest loop:  92%|█████████▏| 893/971 [00:17<00:01, 51.80it/s]backtest loop:  93%|█████████▎| 899/971 [00:17<00:01, 52.69it/s]backtest loop:  93%|█████████▎| 905/971 [00:17<00:01, 53.34it/s]backtest loop:  94%|█████████▍| 911/971 [00:17<00:01, 53.79it/s]backtest loop:  94%|█████████▍| 917/971 [00:17<00:01, 50.95it/s]backtest loop:  95%|█████████▌| 923/971 [00:17<00:00, 52.07it/s]backtest loop:  96%|█████████▌| 929/971 [00:17<00:00, 52.93it/s]backtest loop:  96%|█████████▋| 935/971 [00:17<00:00, 53.72it/s]backtest loop:  97%|█████████▋| 941/971 [00:17<00:00, 50.91it/s]backtest loop:  98%|█████████▊| 947/971 [00:18<00:00, 52.33it/s]backtest loop:  98%|█████████▊| 953/971 [00:18<00:00, 53.10it/s]backtest loop:  99%|█████████▉| 959/971 [00:18<00:00, 53.62it/s]backtest loop:  99%|█████████▉| 965/971 [00:18<00:00, 50.82it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 52.00it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 52.30it/s]
[3036190:MainThread](2024-04-25 03:11:05,687) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000424
std                0.005259
annualized_return  0.100912
information_ratio  1.243815
max_drawdown      -0.071833
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000224
std                0.005259
annualized_return  0.053342
information_ratio  0.657416
max_drawdown      -0.100477
[3036190:MainThread](2024-04-25 03:11:05,700) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 17
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.01, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `MLP_crowd_data_csi300_360_rankTrue`.
[3036190:MainThread](2024-04-25 03:11:12,249) INFO - qlib.timer - [log.py:127] - Time cost: 0.007s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.09660888993280313,
                                                    0.13562370991980652,
                                                    0.06660464834929007,
                                                    0.11273109897819915,
                                                    0.12508853654933336,
                                                    0.12193933987535104,
                                                    0.059086509324079446,
                                                    0.09437823940243575,
                                                    0.0833159586278719,
                                                    0.0533418225743518],
 '1day.excess_return_with_cost.information_ratio': [0.9965334629357873,
                                                    1.471462498466688,
                                                    0.8574204686978396,
                                                    1.1783584885283203,
                                                    1.5787766589453898,
                                                    1.5967941127594432,
                                                    0.7067206748880079,
                                                    1.001917606555779,
                                                    0.8594384226724924,
                                                    0.6574164436693938],
 '1day.excess_return_with_cost.max_drawdown': [-0.178625820283921,
                                               -0.12757703738688353,
                                               -0.0913209010721612,
                                               -0.11249516827526612,
                                               -0.07978807685234823,
                                               -0.08785727986105331,
                                               -0.09779338256797732,
                                               -0.12215782734934821,
                                               -0.16544002131405366,
                                               -0.10047671388299731],
 'IC': [0.022102653552402936,
        0.02409782375001873,
        0.022686097788742136,
        0.02367574671522226,
        0.026994334331438982,
        0.022168896888494324,
        0.021800412131666193,
        0.019800181045442358,
        0.02234994543163826,
        0.01920513500571938],
 'ICIR': [0.13898491673495106,
          0.15607704167026837,
          0.15786952974802382,
          0.14959396620968068,
          0.2055005402854329,
          0.1549874468820034,
          0.14518168977691154,
          0.12170849211192651,
          0.1399944262294579,
          0.12626328899004252],
 'Rank IC': [0.025665075667307198,
             0.03148333316577824,
             0.030750383407579112,
             0.03557216907148577,
             0.032984373539418264,
             0.031728544611053115,
             0.030161476140567276,
             0.03040487978179861,
             0.02491409945857444,
             0.02945695447345232],
 'Rank ICIR': [0.16136503534804983,
               0.21059379399912298,
               0.2200373329436436,
               0.2277897581780483,
               0.2471184880035974,
               0.23356527995755422,
               0.20055621145015046,
               0.19658633236114925,
               0.16711917239399468,
               0.19685054670795823],
 'mae': [0.8644317750225282,
         0.8642435379012978,
         0.8642145420813768,
         0.8640649052148514,
         0.8641229436793894,
         0.8642419257601456,
         0.8642964383530691,
         0.864250819471095,
         0.8644296674677928,
         0.8642491391752022],
 'mse': [0.9972685662584836,
         0.9972602008572546,
         0.9967983457930604,
         0.9969556729191729,
         0.9972293304320696,
         0.9972566124002319,
         0.9973126808783253,
         0.9971266967661773,
         0.9977867425827526,
         0.9969766531642745]}
[3036190:MainThread](2024-04-25 03:11:12,464) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name final_crowd_data_csi300_360_1_MLP.
[3036190:MainThread](2024-04-25 03:11:12,481) INFO - qlib.workflow - [exp.py:258] - Experiment 27 starts running ...
[3036190:MainThread](2024-04-25 03:11:12,493) INFO - qlib.workflow - [recorder.py:341] - Recorder 9feed90277c54b14b6fda38b5cc0db3b starts running under Experiment 27 ...
Time cost: 168.60506939888
{'1day.excess_return_with_cost.annualized_return': [0.0948718753533522,
                                                    0.02750733006698141],
 '1day.excess_return_with_cost.information_ratio': [1.090483883811914,
                                                    0.33269195497119103],
 '1day.excess_return_with_cost.max_drawdown': [-0.116353222884601,
                                               0.031359399255077094],
 'IC': [0.022488122664078555, 0.0020758683623948097],
 'ICIR': [0.14961613386386988, 0.021934530792788762],
 'Rank IC': [0.030312128931701432, 0.002997922310675351],
 'Rank ICIR': [0.20615819513432693, 0.026171035461578892],
 'mae': [0.8642545694126748, 0.00010910513270353418],
 'mse': [0.9971971502051803, 0.0002540772197713654]}
[3036190:MainThread](2024-04-25 03:11:13,258) INFO - qlib.timer - [log.py:127] - Time cost: 0.021s | waiting `async_log` Done

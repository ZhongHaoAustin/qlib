[3104099:MainThread](2024-04-25 05:39:06,706) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[3104099:MainThread](2024-04-25 05:39:06,708) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[3104099:MainThread](2024-04-25 05:39:06,709) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/crowd_data')}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3104099:MainThread](2024-04-25 05:39:12,493) INFO - qlib.DEnsembleModel - [double_ensemble.py:57] - Double Ensemble Model...
[3104099:MainThread](2024-04-25 05:39:15,441) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name DoubleEnsemble_crowd_data_csi300_360_rankTrue_43.
[3104099:MainThread](2024-04-25 05:39:15,510) INFO - qlib.workflow - [exp.py:258] - Experiment 76 starts running ...
[3104099:MainThread](2024-04-25 05:39:17,086) INFO - qlib.workflow - [recorder.py:341] - Recorder 6035479d5fcf401283c431d993767035 starts running under Experiment 76 ...
[3104099:MainThread](2024-04-25 05:39:20,859) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (1/3)
[20]	train's l2: 0.991261	valid's l2: 0.996549
[40]	train's l2: 0.987821	valid's l2: 0.99677
[60]	train's l2: 0.985726	valid's l2: 0.996906
[80]	train's l2: 0.984089	valid's l2: 0.997054
[100]	train's l2: 0.982619	valid's l2: 0.997148
[120]	train's l2: 0.981068	valid's l2: 0.99714
[3104099:MainThread](2024-04-25 05:39:51,065) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 05:42:07,644) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 05:42:36,679) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 05:55:18,721) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (2/3)
[20]	train's l2: 1.18885	valid's l2: 1.00273
[40]	train's l2: 1.16902	valid's l2: 1.0127
[60]	train's l2: 1.15858	valid's l2: 1.01958
[80]	train's l2: 1.15185	valid's l2: 1.02379
[100]	train's l2: 1.14631	valid's l2: 1.02683
[120]	train's l2: 1.14168	valid's l2: 1.02909
[3104099:MainThread](2024-04-25 05:55:37,851) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 05:56:53,712) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 05:57:23,906) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 06:18:04,396) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (3/3)
[20]	train's l2: 1.18149	valid's l2: 0.999318
[40]	train's l2: 1.16828	valid's l2: 1.00421
[60]	train's l2: 1.16061	valid's l2: 1.00767
[80]	train's l2: 1.15572	valid's l2: 1.00961
[100]	train's l2: 1.15093	valid's l2: 1.01116
[120]	train's l2: 1.14649	valid's l2: 1.01255
[3104099:MainThread](2024-04-25 06:18:25,409) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to DoubleEnsemble_crowd_data_csi300_360_rankTrue_43.
[3104099:MainThread](2024-04-25 06:18:25,741) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name DoubleEnsemble_crowd_data_csi300_360_rankTrue.
[3104099:MainThread](2024-04-25 06:18:25,811) INFO - qlib.workflow - [exp.py:258] - Experiment 77 starts running ...
[3104099:MainThread](2024-04-25 06:18:25,832) INFO - qlib.workflow - [recorder.py:341] - Recorder 0ab9dbf06e0f4af5b8e2b5bc07b133c4 starts running under Experiment 77 ...
{'IC': 0.023874941755380283,
 'ICIR': 0.17482656452430498,
 'Rank IC': 0.03290767358310547,
 'Rank ICIR': 0.24272272204378978}
[3104099:MainThread](2024-04-25 06:18:33,378) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3104099:MainThread](2024-04-25 06:19:09,034) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 06:19:09,037) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 06:19:15,190) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f99b5641b50>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 5/971 [00:00<00:19, 49.96it/s]backtest loop:   1%|          | 11/971 [00:00<00:17, 55.72it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:18, 52.37it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:18, 52.16it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:16, 55.66it/s]backtest loop:   4%|▍         | 37/971 [00:00<00:16, 56.77it/s]backtest loop:   5%|▍         | 44/971 [00:00<00:16, 54.93it/s]backtest loop:   5%|▌         | 51/971 [00:00<00:16, 57.09it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:16, 54.58it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:15, 56.80it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:15, 58.39it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:16, 55.62it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 57.52it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 59.17it/s]backtest loop:  10%|▉         | 97/971 [00:01<00:15, 56.23it/s]backtest loop:  11%|█         | 104/971 [00:01<00:14, 57.98it/s]backtest loop:  11%|█▏        | 111/971 [00:01<00:14, 59.25it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:15, 56.24it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:14, 58.08it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:15, 55.33it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 53.28it/s]backtest loop:  15%|█▍        | 142/971 [00:02<00:15, 55.04it/s]backtest loop:  15%|█▌        | 149/971 [00:02<00:14, 57.27it/s]backtest loop:  16%|█▌        | 156/971 [00:02<00:14, 55.87it/s]backtest loop:  17%|█▋        | 163/971 [00:02<00:14, 57.70it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:13, 59.44it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:13, 56.82it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:13, 58.52it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:13, 56.45it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 58.26it/s]backtest loop:  21%|██        | 203/971 [00:03<00:13, 58.59it/s]backtest loop:  22%|██▏       | 210/971 [00:03<00:13, 56.50it/s]backtest loop:  22%|██▏       | 216/971 [00:03<00:13, 54.71it/s]backtest loop:  23%|██▎       | 223/971 [00:03<00:13, 57.12it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 55.56it/s]backtest loop:  24%|██▍       | 236/971 [00:04<00:13, 56.45it/s]backtest loop:  25%|██▌       | 243/971 [00:04<00:12, 58.17it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:12, 55.77it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:12, 58.62it/s]backtest loop:  27%|██▋       | 263/971 [00:04<00:11, 60.08it/s]backtest loop:  28%|██▊       | 270/971 [00:04<00:12, 57.49it/s]backtest loop:  28%|██▊       | 276/971 [00:04<00:12, 54.99it/s]backtest loop:  29%|██▉       | 283/971 [00:04<00:12, 57.07it/s]backtest loop:  30%|██▉       | 289/971 [00:05<00:11, 57.72it/s]backtest loop:  30%|███       | 295/971 [00:05<00:12, 55.29it/s]backtest loop:  31%|███       | 302/971 [00:05<00:11, 57.27it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 58.71it/s]backtest loop:  32%|███▏      | 315/971 [00:05<00:11, 55.73it/s]backtest loop:  33%|███▎      | 321/971 [00:05<00:11, 56.69it/s]backtest loop:  34%|███▎      | 327/971 [00:05<00:11, 57.52it/s]backtest loop:  34%|███▍      | 334/971 [00:05<00:10, 59.00it/s]backtest loop:  35%|███▌      | 340/971 [00:05<00:11, 55.82it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:10, 57.74it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:10, 59.40it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 56.12it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.07it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 52.78it/s]backtest loop:  39%|███▉      | 380/971 [00:06<00:10, 55.52it/s]backtest loop:  40%|███▉      | 386/971 [00:06<00:10, 56.67it/s]backtest loop:  40%|████      | 392/971 [00:06<00:10, 57.47it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 54.86it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 57.04it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:09, 58.63it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:09, 55.64it/s]backtest loop:  44%|████▎     | 424/971 [00:07<00:09, 56.58it/s]backtest loop:  44%|████▍     | 430/971 [00:07<00:09, 57.48it/s]backtest loop:  45%|████▌     | 437/971 [00:07<00:09, 55.56it/s]backtest loop:  46%|████▌     | 444/971 [00:07<00:09, 57.50it/s]backtest loop:  46%|████▋     | 451/971 [00:07<00:08, 58.91it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:09, 55.63it/s]backtest loop:  48%|████▊     | 463/971 [00:08<00:08, 56.79it/s]backtest loop:  48%|████▊     | 470/971 [00:08<00:08, 58.40it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:08, 56.21it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:08, 57.93it/s]backtest loop:  50%|█████     | 490/971 [00:08<00:08, 55.02it/s]backtest loop:  51%|█████     | 496/971 [00:08<00:08, 56.34it/s]backtest loop:  52%|█████▏    | 503/971 [00:08<00:08, 58.12it/s]backtest loop:  52%|█████▏    | 509/971 [00:08<00:08, 55.26it/s]backtest loop:  53%|█████▎    | 516/971 [00:09<00:07, 57.43it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:08, 54.86it/s]backtest loop:  54%|█████▍    | 529/971 [00:09<00:07, 56.97it/s]backtest loop:  55%|█████▌    | 536/971 [00:09<00:07, 55.64it/s]backtest loop:  56%|█████▌    | 543/971 [00:09<00:07, 57.63it/s]backtest loop:  57%|█████▋    | 550/971 [00:09<00:07, 59.04it/s]backtest loop:  57%|█████▋    | 556/971 [00:09<00:07, 55.85it/s]backtest loop:  58%|█████▊    | 563/971 [00:09<00:07, 57.65it/s]backtest loop:  59%|█████▊    | 570/971 [00:10<00:06, 58.95it/s]backtest loop:  59%|█████▉    | 576/971 [00:10<00:07, 56.01it/s]backtest loop:  60%|██████    | 583/971 [00:10<00:06, 58.00it/s]backtest loop:  61%|██████    | 589/971 [00:10<00:06, 58.51it/s]backtest loop:  61%|██████▏   | 595/971 [00:10<00:06, 58.91it/s]backtest loop:  62%|██████▏   | 601/971 [00:10<00:06, 55.80it/s]backtest loop:  63%|██████▎   | 608/971 [00:10<00:06, 57.76it/s]backtest loop:  63%|██████▎   | 615/971 [00:10<00:06, 56.01it/s]backtest loop:  64%|██████▍   | 621/971 [00:10<00:06, 56.83it/s]backtest loop:  65%|██████▍   | 628/971 [00:11<00:05, 58.41it/s]backtest loop:  65%|██████▌   | 635/971 [00:11<00:05, 56.60it/s]backtest loop:  66%|██████▌   | 642/971 [00:11<00:05, 58.17it/s]backtest loop:  67%|██████▋   | 649/971 [00:11<00:05, 59.48it/s]backtest loop:  67%|██████▋   | 655/971 [00:11<00:05, 56.28it/s]backtest loop:  68%|██████▊   | 661/971 [00:11<00:05, 57.21it/s]backtest loop:  69%|██████▉   | 668/971 [00:11<00:05, 58.65it/s]backtest loop:  69%|██████▉   | 674/971 [00:11<00:05, 55.64it/s]backtest loop:  70%|███████   | 681/971 [00:11<00:05, 57.55it/s]backtest loop:  71%|███████   | 687/971 [00:12<00:04, 58.20it/s]backtest loop:  71%|███████▏  | 693/971 [00:12<00:04, 58.51it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 55.54it/s]backtest loop:  73%|███████▎  | 706/971 [00:12<00:04, 57.45it/s]backtest loop:  73%|███████▎  | 713/971 [00:12<00:04, 58.88it/s]backtest loop:  74%|███████▍  | 719/971 [00:12<00:04, 55.40it/s]backtest loop:  75%|███████▍  | 726/971 [00:12<00:04, 57.35it/s]backtest loop:  75%|███████▌  | 732/971 [00:12<00:04, 54.87it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 53.23it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:04, 55.78it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 53.76it/s]backtest loop:  78%|███████▊  | 757/971 [00:13<00:03, 55.32it/s]backtest loop:  79%|███████▊  | 764/971 [00:13<00:03, 57.47it/s]backtest loop:  79%|███████▉  | 770/971 [00:13<00:03, 54.91it/s]backtest loop:  80%|████████  | 777/971 [00:13<00:03, 57.07it/s]backtest loop:  81%|████████  | 783/971 [00:13<00:03, 55.13it/s]backtest loop:  81%|████████▏ | 790/971 [00:13<00:03, 57.19it/s]backtest loop:  82%|████████▏ | 797/971 [00:14<00:02, 58.67it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:03, 55.78it/s]backtest loop:  83%|████████▎ | 810/971 [00:14<00:02, 57.65it/s]backtest loop:  84%|████████▍ | 817/971 [00:14<00:02, 59.00it/s]backtest loop:  85%|████████▍ | 823/971 [00:14<00:02, 55.81it/s]backtest loop:  85%|████████▌ | 830/971 [00:14<00:02, 57.76it/s]backtest loop:  86%|████████▌ | 837/971 [00:14<00:02, 59.03it/s]backtest loop:  87%|████████▋ | 843/971 [00:14<00:02, 55.99it/s]backtest loop:  88%|████████▊ | 850/971 [00:14<00:02, 57.79it/s]backtest loop:  88%|████████▊ | 856/971 [00:15<00:01, 58.18it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 55.31it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 57.35it/s]backtest loop:  90%|█████████ | 876/971 [00:15<00:01, 58.77it/s]backtest loop:  91%|█████████ | 882/971 [00:15<00:01, 55.91it/s]backtest loop:  91%|█████████▏| 888/971 [00:15<00:01, 56.88it/s]backtest loop:  92%|█████████▏| 894/971 [00:15<00:01, 57.75it/s]backtest loop:  93%|█████████▎| 901/971 [00:15<00:01, 59.13it/s]backtest loop:  93%|█████████▎| 907/971 [00:15<00:01, 55.99it/s]backtest loop:  94%|█████████▍| 914/971 [00:16<00:00, 57.92it/s]backtest loop:  95%|█████████▍| 921/971 [00:16<00:00, 55.81it/s]backtest loop:  95%|█████████▌| 927/971 [00:16<00:00, 56.81it/s]backtest loop:  96%|█████████▌| 934/971 [00:16<00:00, 58.42it/s]backtest loop:  97%|█████████▋| 940/971 [00:16<00:00, 55.62it/s]backtest loop:  98%|█████████▊| 947/971 [00:16<00:00, 57.64it/s]backtest loop:  98%|█████████▊| 954/971 [00:16<00:00, 59.00it/s]backtest loop:  99%|█████████▉| 960/971 [00:16<00:00, 55.78it/s]backtest loop: 100%|█████████▉| 967/971 [00:17<00:00, 57.58it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 56.86it/s]
[3104099:MainThread](2024-04-25 06:19:32,324) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000551
std                0.005014
annualized_return  0.131108
information_ratio  1.695103
max_drawdown      -0.060408
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000351
std                0.005015
annualized_return  0.083618
information_ratio  1.080693
max_drawdown      -0.066962
[3104099:MainThread](2024-04-25 06:19:32,337) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `DoubleEnsemble_crowd_data_csi300_360_rankTrue`.
[3104099:MainThread](2024-04-25 06:19:39,120) INFO - qlib.timer - [log.py:127] - Time cost: 0.011s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.08361817278898007],
 '1day.excess_return_with_cost.information_ratio': [1.0806929078780303],
 '1day.excess_return_with_cost.max_drawdown': [-0.06696203294657171],
 'IC': [0.023874941755380283],
 'ICIR': [0.17482656452430498],
 'Rank IC': [0.03290767358310547],
 'Rank ICIR': [0.24272272204378978],
 'mae': [0.8659597564607173],
 'mse': [1.0094607797146595]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3104099:MainThread](2024-04-25 06:19:42,431) INFO - qlib.DEnsembleModel - [double_ensemble.py:57] - Double Ensemble Model...
[3104099:MainThread](2024-04-25 06:19:45,393) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name DoubleEnsemble_crowd_data_csi300_360_rankTrue_44.
[3104099:MainThread](2024-04-25 06:19:45,465) INFO - qlib.workflow - [exp.py:258] - Experiment 78 starts running ...
[3104099:MainThread](2024-04-25 06:19:45,483) INFO - qlib.workflow - [recorder.py:341] - Recorder 7e1f6d2995bb4aa2a6f9aa13a59327a3 starts running under Experiment 78 ...
[3104099:MainThread](2024-04-25 06:19:49,692) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (1/3)
[20]	train's l2: 0.991261	valid's l2: 0.996549
[40]	train's l2: 0.987821	valid's l2: 0.99677
[60]	train's l2: 0.985726	valid's l2: 0.996906
[80]	train's l2: 0.984089	valid's l2: 0.997054
[100]	train's l2: 0.982619	valid's l2: 0.997148
[120]	train's l2: 0.981068	valid's l2: 0.99714
[3104099:MainThread](2024-04-25 06:20:25,343) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 06:22:40,171) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 06:23:08,800) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 06:36:10,195) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (2/3)
[20]	train's l2: 1.18927	valid's l2: 1.00262
[40]	train's l2: 1.16983	valid's l2: 1.01213
[60]	train's l2: 1.15938	valid's l2: 1.01886
[80]	train's l2: 1.15258	valid's l2: 1.02354
[100]	train's l2: 1.14688	valid's l2: 1.02663
[120]	train's l2: 1.14187	valid's l2: 1.02917
[3104099:MainThread](2024-04-25 06:36:30,395) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 06:37:46,906) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 06:38:15,521) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 06:59:42,742) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (3/3)
[20]	train's l2: 1.18081	valid's l2: 0.999174
[40]	train's l2: 1.1671	valid's l2: 1.00444
[60]	train's l2: 1.15874	valid's l2: 1.00814
[80]	train's l2: 1.1528	valid's l2: 1.0106
[100]	train's l2: 1.14795	valid's l2: 1.01233
[120]	train's l2: 1.14383	valid's l2: 1.01349
[3104099:MainThread](2024-04-25 07:00:04,286) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to DoubleEnsemble_crowd_data_csi300_360_rankTrue_44.
[3104099:MainThread](2024-04-25 07:00:04,641) INFO - qlib.workflow - [exp.py:258] - Experiment 77 starts running ...
[3104099:MainThread](2024-04-25 07:00:04,662) INFO - qlib.workflow - [recorder.py:341] - Recorder caa56abfe9394d03acd242169c49e4fb starts running under Experiment 77 ...
{'IC': 0.023240012636530968,
 'ICIR': 0.17087196550992945,
 'Rank IC': 0.03214350726183365,
 'Rank ICIR': 0.23868823821747276}
[3104099:MainThread](2024-04-25 07:00:12,396) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3104099:MainThread](2024-04-25 07:00:49,141) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 07:00:49,144) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 07:00:54,966) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f99546a8d60>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:39,  9.72it/s]backtest loop:   1%|          | 10/971 [00:00<00:34, 27.68it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:25, 36.84it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:22, 42.19it/s]backtest loop:   3%|▎         | 30/971 [00:00<00:20, 46.86it/s]backtest loop:   4%|▍         | 37/971 [00:00<00:18, 51.55it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:17, 51.80it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:16, 54.90it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 53.31it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:16, 55.06it/s]backtest loop:   7%|▋         | 70/971 [00:01<00:15, 57.35it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:16, 55.71it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 57.90it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 59.60it/s]backtest loop:  10%|█         | 98/971 [00:01<00:15, 57.00it/s]backtest loop:  11%|█         | 105/971 [00:02<00:14, 58.56it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 56.72it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:14, 58.35it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 55.77it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 53.80it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:14, 56.34it/s]backtest loop:  15%|█▍        | 145/971 [00:02<00:14, 58.21it/s]backtest loop:  16%|█▌        | 151/971 [00:02<00:14, 55.83it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:14, 57.94it/s]backtest loop:  17%|█▋        | 164/971 [00:03<00:13, 58.40it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:13, 57.30it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:13, 59.16it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:13, 56.94it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:13, 58.70it/s]backtest loop:  20%|██        | 199/971 [00:03<00:12, 59.99it/s]backtest loop:  21%|██        | 206/971 [00:03<00:13, 57.58it/s]backtest loop:  22%|██▏       | 213/971 [00:03<00:13, 56.24it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 55.07it/s]backtest loop:  23%|██▎       | 226/971 [00:04<00:19, 37.60it/s]backtest loop:  24%|██▍       | 233/971 [00:04<00:17, 43.08it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:16, 45.60it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:14, 49.74it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:14, 51.10it/s]backtest loop:  27%|██▋       | 261/971 [00:04<00:13, 54.50it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:13, 53.28it/s]backtest loop:  28%|██▊       | 274/971 [00:05<00:12, 55.87it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:12, 54.74it/s]backtest loop:  30%|██▉       | 287/971 [00:05<00:12, 56.03it/s]backtest loop:  30%|███       | 294/971 [00:05<00:11, 58.17it/s]backtest loop:  31%|███       | 300/971 [00:05<00:12, 55.63it/s]backtest loop:  32%|███▏      | 307/971 [00:05<00:11, 57.67it/s]backtest loop:  32%|███▏      | 314/971 [00:05<00:11, 59.14it/s]backtest loop:  33%|███▎      | 320/971 [00:06<00:11, 56.02it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:11, 58.03it/s]backtest loop:  34%|███▍      | 334/971 [00:06<00:10, 59.48it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:11, 56.42it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:10, 58.24it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:10, 59.64it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 56.79it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.73it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 53.88it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:10, 56.38it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 58.05it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 55.55it/s]backtest loop:  41%|████      | 400/971 [00:07<00:09, 57.57it/s]backtest loop:  42%|████▏     | 406/971 [00:07<00:09, 57.90it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:09, 55.96it/s]backtest loop:  43%|████▎     | 419/971 [00:07<00:09, 56.96it/s]backtest loop:  44%|████▍     | 426/971 [00:07<00:09, 58.62it/s]backtest loop:  44%|████▍     | 432/971 [00:08<00:09, 55.73it/s]backtest loop:  45%|████▌     | 439/971 [00:08<00:09, 57.68it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:08, 59.06it/s]backtest loop:  47%|████▋     | 452/971 [00:08<00:09, 56.03it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:08, 57.81it/s]backtest loop:  48%|████▊     | 466/971 [00:08<00:08, 59.15it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:08, 56.09it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 57.84it/s]backtest loop:  50%|████▉     | 485/971 [00:08<00:08, 58.24it/s]backtest loop:  51%|█████     | 491/971 [00:09<00:08, 55.40it/s]backtest loop:  51%|█████▏    | 498/971 [00:09<00:08, 57.47it/s]backtest loop:  52%|█████▏    | 505/971 [00:09<00:08, 55.68it/s]backtest loop:  53%|█████▎    | 512/971 [00:09<00:08, 54.62it/s]backtest loop:  53%|█████▎    | 518/971 [00:09<00:08, 55.95it/s]backtest loop:  54%|█████▍    | 525/971 [00:09<00:07, 57.80it/s]backtest loop:  55%|█████▍    | 531/971 [00:09<00:07, 55.38it/s]backtest loop:  55%|█████▌    | 538/971 [00:09<00:07, 57.59it/s]backtest loop:  56%|█████▌    | 545/971 [00:09<00:07, 59.03it/s]backtest loop:  57%|█████▋    | 551/971 [00:10<00:07, 55.94it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 57.76it/s]backtest loop:  58%|█████▊    | 565/971 [00:10<00:06, 59.15it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 56.33it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:06, 58.07it/s]backtest loop:  60%|██████    | 585/971 [00:10<00:06, 59.40it/s]backtest loop:  61%|██████    | 591/971 [00:10<00:06, 56.09it/s]backtest loop:  62%|██████▏   | 598/971 [00:10<00:06, 57.95it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:06, 55.92it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 57.83it/s]backtest loop:  64%|██████▎   | 618/971 [00:11<00:06, 58.33it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 56.15it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 58.04it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 59.58it/s]backtest loop:  66%|██████▋   | 645/971 [00:11<00:05, 56.44it/s]backtest loop:  67%|██████▋   | 651/971 [00:11<00:05, 57.39it/s]backtest loop:  68%|██████▊   | 658/971 [00:11<00:05, 58.94it/s]backtest loop:  68%|██████▊   | 664/971 [00:12<00:05, 59.09it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 55.93it/s]backtest loop:  70%|██████▉   | 677/971 [00:12<00:05, 57.86it/s]backtest loop:  70%|███████   | 683/971 [00:12<00:04, 58.35it/s]backtest loop:  71%|███████   | 689/971 [00:12<00:05, 55.28it/s]backtest loop:  72%|███████▏  | 696/971 [00:12<00:04, 57.40it/s]backtest loop:  72%|███████▏  | 702/971 [00:12<00:04, 58.10it/s]backtest loop:  73%|███████▎  | 709/971 [00:12<00:04, 56.07it/s]backtest loop:  74%|███████▎  | 716/971 [00:12<00:04, 57.98it/s]backtest loop:  74%|███████▍  | 722/971 [00:13<00:04, 58.45it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 56.55it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 54.27it/s]backtest loop:  76%|███████▋  | 742/971 [00:13<00:04, 56.67it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.37it/s]backtest loop:  78%|███████▊  | 754/971 [00:13<00:03, 55.76it/s]backtest loop:  78%|███████▊  | 760/971 [00:13<00:03, 53.80it/s]backtest loop:  79%|███████▉  | 767/971 [00:13<00:03, 56.31it/s]backtest loop:  80%|███████▉  | 774/971 [00:13<00:03, 58.14it/s]backtest loop:  80%|████████  | 780/971 [00:14<00:03, 55.43it/s]backtest loop:  81%|████████  | 786/971 [00:14<00:03, 56.52it/s]backtest loop:  82%|████████▏ | 793/971 [00:14<00:03, 55.12it/s]backtest loop:  82%|████████▏ | 800/971 [00:14<00:02, 57.16it/s]backtest loop:  83%|████████▎ | 807/971 [00:14<00:02, 58.72it/s]backtest loop:  84%|████████▎ | 813/971 [00:14<00:02, 55.74it/s]backtest loop:  84%|████████▍ | 819/971 [00:14<00:02, 56.73it/s]backtest loop:  85%|████████▌ | 826/971 [00:14<00:02, 58.54it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 56.36it/s]backtest loop:  87%|████████▋ | 840/971 [00:15<00:02, 58.11it/s]backtest loop:  87%|████████▋ | 847/971 [00:15<00:02, 59.39it/s]backtest loop:  88%|████████▊ | 853/971 [00:15<00:02, 56.08it/s]backtest loop:  89%|████████▊ | 860/971 [00:15<00:01, 57.90it/s]backtest loop:  89%|████████▉ | 867/971 [00:15<00:01, 55.89it/s]backtest loop:  90%|█████████ | 874/971 [00:15<00:01, 57.77it/s]backtest loop:  91%|█████████ | 881/971 [00:15<00:01, 58.99it/s]backtest loop:  91%|█████████▏| 887/971 [00:15<00:01, 55.98it/s]backtest loop:  92%|█████████▏| 894/971 [00:16<00:01, 57.83it/s]backtest loop:  93%|█████████▎| 901/971 [00:16<00:01, 59.29it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 56.24it/s]backtest loop:  94%|█████████▍| 913/971 [00:16<00:01, 57.24it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 57.38it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 55.53it/s]backtest loop:  96%|█████████▌| 933/971 [00:16<00:00, 57.70it/s]backtest loop:  97%|█████████▋| 940/971 [00:16<00:00, 55.98it/s]backtest loop:  97%|█████████▋| 946/971 [00:16<00:00, 56.92it/s]backtest loop:  98%|█████████▊| 953/971 [00:17<00:00, 58.52it/s]backtest loop:  99%|█████████▉| 960/971 [00:17<00:00, 56.42it/s]backtest loop: 100%|█████████▉| 967/971 [00:17<00:00, 58.13it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.71it/s]
[3104099:MainThread](2024-04-25 07:01:12,453) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000582
std                0.004975
annualized_return  0.138419
information_ratio  1.803609
max_drawdown      -0.055487
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000382
std                0.004976
annualized_return  0.090958
information_ratio  1.184909
max_drawdown      -0.073053
[3104099:MainThread](2024-04-25 07:01:12,466) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `DoubleEnsemble_crowd_data_csi300_360_rankTrue`.
[3104099:MainThread](2024-04-25 07:01:19,356) INFO - qlib.timer - [log.py:127] - Time cost: 0.011s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.08361817278898007,
                                                    0.09095844033602322],
 '1day.excess_return_with_cost.information_ratio': [1.0806929078780303,
                                                    1.1849094019170558],
 '1day.excess_return_with_cost.max_drawdown': [-0.06696203294657171,
                                               -0.07305297047972394],
 'IC': [0.023874941755380283, 0.023240012636530968],
 'ICIR': [0.17482656452430498, 0.17087196550992945],
 'Rank IC': [0.03290767358310547, 0.03214350726183365],
 'Rank ICIR': [0.24272272204378978, 0.23868823821747276],
 'mae': [0.8659597564607173, 0.8661122518523465],
 'mse': [1.0094607797146595, 1.010206485668107]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3104099:MainThread](2024-04-25 07:01:22,637) INFO - qlib.DEnsembleModel - [double_ensemble.py:57] - Double Ensemble Model...
[3104099:MainThread](2024-04-25 07:01:25,591) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name DoubleEnsemble_crowd_data_csi300_360_rankTrue_45.
[3104099:MainThread](2024-04-25 07:01:25,664) INFO - qlib.workflow - [exp.py:258] - Experiment 79 starts running ...
[3104099:MainThread](2024-04-25 07:01:25,683) INFO - qlib.workflow - [recorder.py:341] - Recorder a43764a7505a4281aaac9c8b0c048200 starts running under Experiment 79 ...
[3104099:MainThread](2024-04-25 07:01:29,777) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (1/3)
[20]	train's l2: 0.991261	valid's l2: 0.996549
[40]	train's l2: 0.987821	valid's l2: 0.99677
[60]	train's l2: 0.985726	valid's l2: 0.996906
[80]	train's l2: 0.984089	valid's l2: 0.997054
[100]	train's l2: 0.982619	valid's l2: 0.997148
[120]	train's l2: 0.981068	valid's l2: 0.99714
[3104099:MainThread](2024-04-25 07:02:04,103) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 07:04:19,008) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 07:04:47,135) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 07:17:32,203) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (2/3)
[20]	train's l2: 1.19016	valid's l2: 1.00253
[40]	train's l2: 1.17056	valid's l2: 1.01249
[60]	train's l2: 1.16004	valid's l2: 1.01932
[80]	train's l2: 1.15333	valid's l2: 1.02387
[100]	train's l2: 1.14834	valid's l2: 1.02654
[120]	train's l2: 1.14378	valid's l2: 1.02879
[3104099:MainThread](2024-04-25 07:17:51,749) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 07:19:10,029) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 07:19:38,529) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 07:40:18,813) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (3/3)
[20]	train's l2: 1.1803	valid's l2: 0.999365
[40]	train's l2: 1.16678	valid's l2: 1.00459
[60]	train's l2: 1.15856	valid's l2: 1.00823
[80]	train's l2: 1.1529	valid's l2: 1.01065
[100]	train's l2: 1.14792	valid's l2: 1.0124
[120]	train's l2: 1.14345	valid's l2: 1.01371
[3104099:MainThread](2024-04-25 07:40:38,444) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to DoubleEnsemble_crowd_data_csi300_360_rankTrue_45.
[3104099:MainThread](2024-04-25 07:40:38,846) INFO - qlib.workflow - [exp.py:258] - Experiment 77 starts running ...
[3104099:MainThread](2024-04-25 07:40:38,868) INFO - qlib.workflow - [recorder.py:341] - Recorder 48cb3069b69e44709f477b96fd03f628 starts running under Experiment 77 ...
{'IC': 0.022564971340533844,
 'ICIR': 0.16481748707638758,
 'Rank IC': 0.031119659481776092,
 'Rank ICIR': 0.22822531597855578}
[3104099:MainThread](2024-04-25 07:40:47,336) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3104099:MainThread](2024-04-25 07:41:25,089) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 07:41:25,092) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 07:41:31,169) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f99c4a89a00>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<02:02,  7.91it/s]backtest loop:   1%|          | 9/971 [00:00<00:43, 22.16it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:29, 32.50it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 38.01it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:20, 45.53it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:20, 46.76it/s]backtest loop:   4%|▍         | 41/971 [00:01<00:18, 51.55it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 54.82it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.17it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 55.93it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 53.25it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:16, 55.82it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 57.77it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 55.74it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 57.91it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 59.50it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.42it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 58.22it/s]backtest loop:  12%|█▏        | 120/971 [00:02<00:15, 56.44it/s]backtest loop:  13%|█▎        | 126/971 [00:02<00:16, 52.20it/s]backtest loop:  14%|█▎        | 133/971 [00:02<00:15, 55.22it/s]backtest loop:  14%|█▍        | 139/971 [00:02<00:17, 47.96it/s]backtest loop:  15%|█▍        | 145/971 [00:02<00:16, 49.85it/s]backtest loop:  16%|█▌        | 151/971 [00:03<00:16, 48.56it/s]backtest loop:  16%|█▌        | 157/971 [00:03<00:16, 50.45it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:15, 50.86it/s]backtest loop:  17%|█▋        | 169/971 [00:03<00:15, 52.33it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:14, 53.73it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:15, 50.92it/s]backtest loop:  19%|█▉        | 187/971 [00:03<00:14, 52.30it/s]backtest loop:  20%|█▉        | 193/971 [00:03<00:14, 52.69it/s]backtest loop:  20%|██        | 199/971 [00:03<00:14, 53.66it/s]backtest loop:  21%|██        | 205/971 [00:04<00:15, 50.95it/s]backtest loop:  22%|██▏       | 211/971 [00:04<00:14, 52.26it/s]backtest loop:  22%|██▏       | 217/971 [00:04<00:15, 49.46it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:14, 51.18it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:14, 52.44it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:14, 50.16it/s]backtest loop:  25%|██▍       | 241/971 [00:04<00:14, 51.53it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:13, 52.62it/s]backtest loop:  26%|██▌       | 253/971 [00:05<00:13, 53.87it/s]backtest loop:  27%|██▋       | 259/971 [00:05<00:22, 31.20it/s]backtest loop:  27%|██▋       | 265/971 [00:05<00:19, 35.91it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:18, 38.09it/s]backtest loop:  29%|██▊       | 277/971 [00:05<00:16, 41.92it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:15, 45.10it/s]backtest loop:  30%|██▉       | 289/971 [00:05<00:14, 47.70it/s]backtest loop:  30%|███       | 295/971 [00:06<00:14, 46.28it/s]backtest loop:  31%|███       | 301/971 [00:06<00:13, 48.62it/s]backtest loop:  32%|███▏      | 307/971 [00:06<00:13, 50.39it/s]backtest loop:  32%|███▏      | 313/971 [00:06<00:12, 51.64it/s]backtest loop:  33%|███▎      | 319/971 [00:06<00:12, 52.61it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:12, 49.90it/s]backtest loop:  34%|███▍      | 331/971 [00:06<00:12, 51.36it/s]backtest loop:  35%|███▍      | 337/971 [00:06<00:12, 52.04it/s]backtest loop:  35%|███▌      | 343/971 [00:07<00:11, 52.66it/s]backtest loop:  36%|███▌      | 349/971 [00:07<00:11, 53.59it/s]backtest loop:  37%|███▋      | 355/971 [00:07<00:12, 50.52it/s]backtest loop:  37%|███▋      | 361/971 [00:07<00:11, 52.27it/s]backtest loop:  38%|███▊      | 367/971 [00:07<00:12, 50.10it/s]backtest loop:  38%|███▊      | 373/971 [00:07<00:12, 48.50it/s]backtest loop:  39%|███▉      | 379/971 [00:07<00:11, 49.83it/s]backtest loop:  40%|███▉      | 385/971 [00:07<00:11, 50.94it/s]backtest loop:  40%|████      | 391/971 [00:07<00:11, 52.01it/s]backtest loop:  41%|████      | 397/971 [00:08<00:10, 53.00it/s]backtest loop:  42%|████▏     | 403/971 [00:08<00:11, 51.04it/s]backtest loop:  42%|████▏     | 410/971 [00:08<00:10, 54.25it/s]backtest loop:  43%|████▎     | 417/971 [00:08<00:09, 56.63it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:10, 54.48it/s]backtest loop:  44%|████▍     | 430/971 [00:08<00:09, 56.73it/s]backtest loop:  45%|████▍     | 436/971 [00:08<00:09, 57.33it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:09, 54.61it/s]backtest loop:  46%|████▌     | 448/971 [00:08<00:09, 56.06it/s]backtest loop:  47%|████▋     | 454/971 [00:09<00:09, 55.64it/s]backtest loop:  47%|████▋     | 461/971 [00:09<00:08, 57.59it/s]backtest loop:  48%|████▊     | 467/971 [00:09<00:09, 54.94it/s]backtest loop:  49%|████▊     | 473/971 [00:09<00:08, 55.99it/s]backtest loop:  49%|████▉     | 480/971 [00:09<00:08, 57.85it/s]backtest loop:  50%|█████     | 486/971 [00:09<00:08, 58.04it/s]backtest loop:  51%|█████     | 492/971 [00:09<00:08, 55.19it/s]backtest loop:  51%|█████▏    | 499/971 [00:09<00:08, 57.29it/s]backtest loop:  52%|█████▏    | 505/971 [00:10<00:08, 54.55it/s]backtest loop:  53%|█████▎    | 512/971 [00:10<00:08, 53.60it/s]backtest loop:  53%|█████▎    | 519/971 [00:10<00:08, 56.23it/s]backtest loop:  54%|█████▍    | 525/971 [00:10<00:07, 56.94it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 54.06it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:07, 55.59it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:07, 55.23it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 55.11it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 54.98it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:08, 50.67it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:07, 51.83it/s]backtest loop:  59%|█████▉    | 573/971 [00:11<00:07, 52.72it/s]backtest loop:  60%|█████▉    | 579/971 [00:11<00:07, 53.12it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:07, 53.43it/s]backtest loop:  61%|██████    | 591/971 [00:11<00:07, 52.12it/s]backtest loop:  62%|██████▏   | 598/971 [00:11<00:06, 55.04it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:06, 54.03it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 56.40it/s]backtest loop:  64%|██████▎   | 619/971 [00:12<00:06, 58.28it/s]backtest loop:  64%|██████▍   | 625/971 [00:12<00:06, 55.47it/s]backtest loop:  65%|██████▍   | 631/971 [00:12<00:06, 56.39it/s]backtest loop:  66%|██████▌   | 638/971 [00:12<00:05, 58.50it/s]backtest loop:  66%|██████▋   | 644/971 [00:12<00:05, 58.86it/s]backtest loop:  67%|██████▋   | 650/971 [00:12<00:05, 55.86it/s]backtest loop:  68%|██████▊   | 657/971 [00:12<00:05, 57.78it/s]backtest loop:  68%|██████▊   | 664/971 [00:12<00:05, 59.13it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 56.05it/s]backtest loop:  70%|██████▉   | 677/971 [00:13<00:05, 57.88it/s]backtest loop:  70%|███████   | 683/971 [00:13<00:05, 56.47it/s]backtest loop:  71%|███████   | 689/971 [00:13<00:05, 54.11it/s]backtest loop:  72%|███████▏  | 695/971 [00:13<00:04, 55.43it/s]backtest loop:  72%|███████▏  | 701/971 [00:13<00:04, 56.50it/s]backtest loop:  73%|███████▎  | 707/971 [00:13<00:04, 57.34it/s]backtest loop:  74%|███████▎  | 714/971 [00:13<00:04, 55.48it/s]backtest loop:  74%|███████▍  | 721/971 [00:13<00:04, 57.40it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 58.96it/s]backtest loop:  76%|███████▌  | 734/971 [00:14<00:04, 52.52it/s]backtest loop:  76%|███████▌  | 740/971 [00:14<00:04, 53.64it/s]backtest loop:  77%|███████▋  | 746/971 [00:14<00:04, 55.16it/s]backtest loop:  77%|███████▋  | 752/971 [00:14<00:04, 53.11it/s]backtest loop:  78%|███████▊  | 758/971 [00:14<00:03, 54.89it/s]backtest loop:  79%|███████▉  | 765/971 [00:14<00:03, 53.96it/s]backtest loop:  79%|███████▉  | 771/971 [00:14<00:03, 55.43it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 56.25it/s]backtest loop:  81%|████████  | 783/971 [00:15<00:03, 53.93it/s]backtest loop:  81%|████████▏ | 789/971 [00:15<00:03, 55.43it/s]backtest loop:  82%|████████▏ | 795/971 [00:15<00:03, 56.55it/s]backtest loop:  82%|████████▏ | 801/971 [00:15<00:02, 57.27it/s]backtest loop:  83%|████████▎ | 807/971 [00:15<00:02, 58.01it/s]backtest loop:  84%|████████▎ | 813/971 [00:15<00:02, 54.99it/s]backtest loop:  84%|████████▍ | 820/971 [00:15<00:02, 57.11it/s]backtest loop:  85%|████████▌ | 827/971 [00:15<00:02, 58.71it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 55.21it/s]backtest loop:  86%|████████▋ | 839/971 [00:16<00:02, 56.36it/s]backtest loop:  87%|████████▋ | 845/971 [00:16<00:02, 57.24it/s]backtest loop:  88%|████████▊ | 851/971 [00:16<00:02, 57.96it/s]backtest loop:  88%|████████▊ | 857/971 [00:16<00:02, 55.01it/s]backtest loop:  89%|████████▉ | 864/971 [00:16<00:01, 57.20it/s]backtest loop:  90%|████████▉ | 871/971 [00:16<00:01, 58.70it/s]backtest loop:  90%|█████████ | 877/971 [00:16<00:01, 55.69it/s]backtest loop:  91%|█████████ | 883/971 [00:16<00:01, 56.68it/s]backtest loop:  92%|█████████▏| 890/971 [00:16<00:01, 58.32it/s]backtest loop:  92%|█████████▏| 897/971 [00:17<00:01, 56.39it/s]backtest loop:  93%|█████████▎| 904/971 [00:17<00:01, 58.01it/s]backtest loop:  94%|█████████▍| 911/971 [00:17<00:01, 59.29it/s]backtest loop:  94%|█████████▍| 917/971 [00:17<00:00, 56.25it/s]backtest loop:  95%|█████████▌| 923/971 [00:17<00:00, 57.20it/s]backtest loop:  96%|█████████▌| 930/971 [00:17<00:00, 58.70it/s]backtest loop:  96%|█████████▋| 936/971 [00:17<00:00, 55.40it/s]backtest loop:  97%|█████████▋| 943/971 [00:17<00:00, 57.53it/s]backtest loop:  98%|█████████▊| 950/971 [00:17<00:00, 55.63it/s]backtest loop:  98%|█████████▊| 956/971 [00:18<00:00, 56.15it/s]backtest loop:  99%|█████████▉| 962/971 [00:18<00:00, 57.16it/s]backtest loop: 100%|█████████▉| 968/971 [00:18<00:00, 57.82it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 53.00it/s]
[3104099:MainThread](2024-04-25 07:41:49,549) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000482
std                0.004963
annualized_return  0.114721
information_ratio  1.498244
max_drawdown      -0.053755
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000283
std                0.004964
annualized_return  0.067304
information_ratio  0.878851
max_drawdown      -0.061856
[3104099:MainThread](2024-04-25 07:41:49,563) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `DoubleEnsemble_crowd_data_csi300_360_rankTrue`.
[3104099:MainThread](2024-04-25 07:41:56,785) INFO - qlib.timer - [log.py:127] - Time cost: 0.009s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.08361817278898007,
                                                    0.09095844033602322,
                                                    0.06730404236767748],
 '1day.excess_return_with_cost.information_ratio': [1.0806929078780303,
                                                    1.1849094019170558,
                                                    0.878850542100161],
 '1day.excess_return_with_cost.max_drawdown': [-0.06696203294657171,
                                               -0.07305297047972394,
                                               -0.06185570741678455],
 'IC': [0.023874941755380283, 0.023240012636530968, 0.022564971340533844],
 'ICIR': [0.17482656452430498, 0.17087196550992945, 0.16481748707638758],
 'Rank IC': [0.03290767358310547, 0.03214350726183365, 0.031119659481776092],
 'Rank ICIR': [0.24272272204378978, 0.23868823821747276, 0.22822531597855578],
 'mae': [0.8659597564607173, 0.8661122518523465, 0.8661860570410561],
 'mse': [1.0094607797146595, 1.010206485668107, 1.0101893411295777]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3104099:MainThread](2024-04-25 07:42:00,133) INFO - qlib.DEnsembleModel - [double_ensemble.py:57] - Double Ensemble Model...
[3104099:MainThread](2024-04-25 07:42:03,120) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name DoubleEnsemble_crowd_data_csi300_360_rankTrue_46.
[3104099:MainThread](2024-04-25 07:42:03,195) INFO - qlib.workflow - [exp.py:258] - Experiment 80 starts running ...
[3104099:MainThread](2024-04-25 07:42:03,215) INFO - qlib.workflow - [recorder.py:341] - Recorder ddd76b7ec1bf480285ebadca8f7aef59 starts running under Experiment 80 ...
[3104099:MainThread](2024-04-25 07:42:07,627) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (1/3)
[20]	train's l2: 0.991261	valid's l2: 0.996549
[40]	train's l2: 0.987821	valid's l2: 0.99677
[60]	train's l2: 0.985726	valid's l2: 0.996906
[80]	train's l2: 0.984089	valid's l2: 0.997054
[100]	train's l2: 0.982619	valid's l2: 0.997148
[120]	train's l2: 0.981068	valid's l2: 0.99714
[3104099:MainThread](2024-04-25 07:42:38,456) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 07:44:58,512) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 07:45:27,106) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 07:58:07,013) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (2/3)
[20]	train's l2: 1.18879	valid's l2: 1.00287
[40]	train's l2: 1.16927	valid's l2: 1.01289
[60]	train's l2: 1.15881	valid's l2: 1.01984
[80]	train's l2: 1.15243	valid's l2: 1.02422
[100]	train's l2: 1.14712	valid's l2: 1.02729
[120]	train's l2: 1.14201	valid's l2: 1.02975
[3104099:MainThread](2024-04-25 07:58:25,894) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 07:59:41,966) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 08:00:10,448) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 08:21:43,904) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (3/3)
[20]	train's l2: 1.1811	valid's l2: 0.999169
[40]	train's l2: 1.16726	valid's l2: 1.00432
[60]	train's l2: 1.15946	valid's l2: 1.00803
[80]	train's l2: 1.15438	valid's l2: 1.01031
[100]	train's l2: 1.14968	valid's l2: 1.01207
[120]	train's l2: 1.14521	valid's l2: 1.01335
[3104099:MainThread](2024-04-25 08:22:08,310) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to DoubleEnsemble_crowd_data_csi300_360_rankTrue_46.
[3104099:MainThread](2024-04-25 08:22:08,766) INFO - qlib.workflow - [exp.py:258] - Experiment 77 starts running ...
[3104099:MainThread](2024-04-25 08:22:08,788) INFO - qlib.workflow - [recorder.py:341] - Recorder ef7ed7669e614c1c961a0b3310ccf8b5 starts running under Experiment 77 ...
{'IC': 0.02347779949429157,
 'ICIR': 0.17261255414205035,
 'Rank IC': 0.031821060869092255,
 'Rank ICIR': 0.23571956793672166}
[3104099:MainThread](2024-04-25 08:22:17,232) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3104099:MainThread](2024-04-25 08:22:54,617) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 08:22:54,620) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 08:23:00,700) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f9955a356d0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:54,  8.42it/s]backtest loop:   1%|          | 9/971 [00:00<00:43, 22.37it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:29, 32.07it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:26, 36.05it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:22, 41.85it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 46.29it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:19, 47.31it/s]backtest loop:   5%|▍         | 46/971 [00:01<00:17, 51.76it/s]backtest loop:   5%|▌         | 53/971 [00:01<00:16, 54.93it/s]backtest loop:   6%|▌         | 59/971 [00:01<00:17, 53.11it/s]backtest loop:   7%|▋         | 65/971 [00:01<00:16, 54.76it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:16, 56.11it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:16, 53.99it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 56.74it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 58.73it/s]backtest loop:  10%|▉         | 97/971 [00:02<00:15, 55.82it/s]backtest loop:  11%|█         | 103/971 [00:02<00:15, 56.48it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:14, 58.28it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:15, 56.14it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:14, 58.78it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:14, 56.40it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 53.77it/s]backtest loop:  15%|█▍        | 142/971 [00:02<00:14, 55.39it/s]backtest loop:  15%|█▌        | 149/971 [00:02<00:14, 57.45it/s]backtest loop:  16%|█▌        | 156/971 [00:03<00:14, 56.00it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:13, 57.76it/s]backtest loop:  17%|█▋        | 169/971 [00:03<00:14, 56.84it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:13, 57.16it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:14, 53.29it/s]backtest loop:  19%|█▉        | 187/971 [00:03<00:14, 53.93it/s]backtest loop:  20%|█▉        | 193/971 [00:03<00:14, 54.23it/s]backtest loop:  20%|██        | 199/971 [00:03<00:14, 53.99it/s]backtest loop:  21%|██        | 205/971 [00:04<00:14, 51.19it/s]backtest loop:  22%|██▏       | 211/971 [00:04<00:14, 52.60it/s]backtest loop:  22%|██▏       | 217/971 [00:04<00:14, 50.37it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:14, 51.97it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:13, 53.00it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:14, 50.74it/s]backtest loop:  25%|██▍       | 241/971 [00:04<00:14, 51.97it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:13, 52.92it/s]backtest loop:  26%|██▌       | 253/971 [00:04<00:13, 53.84it/s]backtest loop:  27%|██▋       | 259/971 [00:05<00:22, 31.09it/s]backtest loop:  27%|██▋       | 265/971 [00:05<00:19, 35.83it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:18, 38.21it/s]backtest loop:  29%|██▊       | 277/971 [00:05<00:16, 41.88it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:15, 45.07it/s]backtest loop:  30%|██▉       | 289/971 [00:05<00:14, 47.64it/s]backtest loop:  30%|███       | 295/971 [00:06<00:14, 47.06it/s]backtest loop:  31%|███       | 301/971 [00:06<00:13, 49.26it/s]backtest loop:  32%|███▏      | 307/971 [00:06<00:13, 50.73it/s]backtest loop:  32%|███▏      | 313/971 [00:06<00:12, 51.91it/s]backtest loop:  33%|███▎      | 319/971 [00:06<00:12, 52.83it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:12, 50.34it/s]backtest loop:  34%|███▍      | 331/971 [00:06<00:12, 51.81it/s]backtest loop:  35%|███▍      | 337/971 [00:06<00:12, 52.73it/s]backtest loop:  35%|███▌      | 343/971 [00:06<00:11, 53.27it/s]backtest loop:  36%|███▌      | 349/971 [00:07<00:11, 54.03it/s]backtest loop:  37%|███▋      | 355/971 [00:07<00:12, 51.26it/s]backtest loop:  37%|███▋      | 361/971 [00:07<00:11, 52.89it/s]backtest loop:  38%|███▊      | 367/971 [00:07<00:11, 50.45it/s]backtest loop:  38%|███▊      | 373/971 [00:07<00:12, 48.73it/s]backtest loop:  39%|███▉      | 379/971 [00:07<00:11, 50.48it/s]backtest loop:  40%|███▉      | 385/971 [00:07<00:11, 51.98it/s]backtest loop:  40%|████      | 391/971 [00:07<00:10, 52.78it/s]backtest loop:  41%|████      | 397/971 [00:07<00:10, 53.24it/s]backtest loop:  42%|████▏     | 403/971 [00:08<00:11, 50.55it/s]backtest loop:  42%|████▏     | 409/971 [00:08<00:10, 51.83it/s]backtest loop:  43%|████▎     | 415/971 [00:08<00:10, 52.73it/s]backtest loop:  43%|████▎     | 421/971 [00:08<00:10, 53.44it/s]backtest loop:  44%|████▍     | 427/971 [00:08<00:10, 53.30it/s]backtest loop:  45%|████▍     | 433/971 [00:08<00:10, 50.51it/s]backtest loop:  45%|████▌     | 439/971 [00:08<00:10, 51.74it/s]backtest loop:  46%|████▌     | 445/971 [00:08<00:09, 52.64it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:09, 53.34it/s]backtest loop:  47%|████▋     | 457/971 [00:09<00:10, 50.27it/s]backtest loop:  48%|████▊     | 463/971 [00:09<00:09, 51.55it/s]backtest loop:  48%|████▊     | 469/971 [00:09<00:09, 52.55it/s]backtest loop:  49%|████▉     | 475/971 [00:09<00:09, 53.23it/s]backtest loop:  50%|████▉     | 481/971 [00:09<00:09, 53.69it/s]backtest loop:  50%|█████     | 487/971 [00:09<00:09, 49.31it/s]backtest loop:  51%|█████     | 493/971 [00:09<00:09, 50.77it/s]backtest loop:  51%|█████▏    | 499/971 [00:09<00:09, 52.05it/s]backtest loop:  52%|█████▏    | 505/971 [00:10<00:09, 49.84it/s]backtest loop:  53%|█████▎    | 511/971 [00:10<00:08, 51.23it/s]backtest loop:  53%|█████▎    | 517/971 [00:10<00:09, 49.29it/s]backtest loop:  54%|█████▍    | 523/971 [00:10<00:08, 50.89it/s]backtest loop:  54%|█████▍    | 529/971 [00:10<00:08, 52.18it/s]backtest loop:  55%|█████▌    | 535/971 [00:10<00:08, 53.22it/s]backtest loop:  56%|█████▌    | 541/971 [00:10<00:08, 50.50it/s]backtest loop:  56%|█████▋    | 547/971 [00:10<00:08, 51.08it/s]backtest loop:  57%|█████▋    | 553/971 [00:10<00:08, 51.80it/s]backtest loop:  58%|█████▊    | 559/971 [00:11<00:07, 52.44it/s]backtest loop:  58%|█████▊    | 565/971 [00:11<00:07, 53.07it/s]backtest loop:  59%|█████▉    | 571/971 [00:11<00:07, 50.40it/s]backtest loop:  59%|█████▉    | 577/971 [00:11<00:07, 51.50it/s]backtest loop:  60%|██████    | 583/971 [00:11<00:07, 52.72it/s]backtest loop:  61%|██████    | 589/971 [00:11<00:07, 53.60it/s]backtest loop:  61%|██████▏   | 595/971 [00:11<00:06, 53.91it/s]backtest loop:  62%|██████▏   | 601/971 [00:11<00:07, 50.93it/s]backtest loop:  63%|██████▎   | 607/971 [00:12<00:07, 51.19it/s]backtest loop:  63%|██████▎   | 613/971 [00:12<00:06, 52.17it/s]backtest loop:  64%|██████▎   | 619/971 [00:12<00:06, 52.95it/s]backtest loop:  64%|██████▍   | 625/971 [00:12<00:06, 50.18it/s]backtest loop:  65%|██████▍   | 631/971 [00:12<00:06, 51.52it/s]backtest loop:  66%|██████▌   | 637/971 [00:12<00:06, 52.84it/s]backtest loop:  66%|██████▌   | 643/971 [00:12<00:06, 53.38it/s]backtest loop:  67%|██████▋   | 649/971 [00:12<00:06, 53.66it/s]backtest loop:  67%|██████▋   | 655/971 [00:12<00:06, 50.67it/s]backtest loop:  68%|██████▊   | 661/971 [00:13<00:05, 51.84it/s]backtest loop:  69%|██████▊   | 667/971 [00:13<00:05, 52.59it/s]backtest loop:  69%|██████▉   | 673/971 [00:13<00:05, 53.17it/s]backtest loop:  70%|██████▉   | 679/971 [00:13<00:05, 50.44it/s]backtest loop:  71%|███████   | 685/971 [00:13<00:05, 51.41it/s]backtest loop:  71%|███████   | 691/971 [00:13<00:05, 52.29it/s]backtest loop:  72%|███████▏  | 697/971 [00:13<00:05, 52.94it/s]backtest loop:  72%|███████▏  | 703/971 [00:13<00:05, 53.55it/s]backtest loop:  73%|███████▎  | 709/971 [00:13<00:05, 50.67it/s]backtest loop:  74%|███████▎  | 715/971 [00:14<00:04, 52.01it/s]backtest loop:  74%|███████▍  | 721/971 [00:14<00:04, 53.03it/s]backtest loop:  75%|███████▍  | 727/971 [00:14<00:04, 53.52it/s]backtest loop:  75%|███████▌  | 733/971 [00:14<00:04, 47.81it/s]backtest loop:  76%|███████▌  | 739/971 [00:14<00:04, 49.58it/s]backtest loop:  77%|███████▋  | 745/971 [00:14<00:04, 51.03it/s]backtest loop:  77%|███████▋  | 751/971 [00:14<00:04, 48.94it/s]backtest loop:  78%|███████▊  | 757/971 [00:14<00:04, 50.43it/s]backtest loop:  79%|███████▊  | 763/971 [00:15<00:04, 51.73it/s]backtest loop:  79%|███████▉  | 769/971 [00:15<00:03, 52.51it/s]backtest loop:  80%|███████▉  | 775/971 [00:15<00:03, 50.00it/s]backtest loop:  80%|████████  | 781/971 [00:15<00:03, 51.42it/s]backtest loop:  81%|████████  | 787/971 [00:15<00:03, 52.46it/s]backtest loop:  82%|████████▏ | 793/971 [00:15<00:03, 49.91it/s]backtest loop:  82%|████████▏ | 799/971 [00:15<00:03, 51.26it/s]backtest loop:  83%|████████▎ | 805/971 [00:15<00:03, 52.22it/s]backtest loop:  84%|████████▎ | 811/971 [00:15<00:03, 52.77it/s]backtest loop:  84%|████████▍ | 817/971 [00:16<00:02, 53.16it/s]backtest loop:  85%|████████▍ | 823/971 [00:16<00:02, 50.44it/s]backtest loop:  85%|████████▌ | 829/971 [00:16<00:02, 51.83it/s]backtest loop:  86%|████████▌ | 835/971 [00:16<00:02, 52.67it/s]backtest loop:  87%|████████▋ | 841/971 [00:16<00:02, 53.37it/s]backtest loop:  87%|████████▋ | 847/971 [00:16<00:02, 52.93it/s]backtest loop:  88%|████████▊ | 853/971 [00:16<00:02, 50.25it/s]backtest loop:  88%|████████▊ | 859/971 [00:16<00:02, 51.47it/s]backtest loop:  89%|████████▉ | 865/971 [00:17<00:02, 52.03it/s]backtest loop:  90%|████████▉ | 871/971 [00:17<00:02, 48.87it/s]backtest loop:  90%|█████████ | 877/971 [00:17<00:01, 47.27it/s]backtest loop:  91%|█████████ | 883/971 [00:17<00:01, 49.38it/s]backtest loop:  92%|█████████▏| 889/971 [00:17<00:01, 50.89it/s]backtest loop:  92%|█████████▏| 895/971 [00:17<00:01, 51.99it/s]backtest loop:  93%|█████████▎| 901/971 [00:17<00:01, 52.97it/s]backtest loop:  93%|█████████▎| 907/971 [00:17<00:01, 50.31it/s]backtest loop:  94%|█████████▍| 913/971 [00:17<00:01, 51.62it/s]backtest loop:  95%|█████████▍| 919/971 [00:18<00:00, 52.54it/s]backtest loop:  95%|█████████▌| 925/971 [00:18<00:00, 53.23it/s]backtest loop:  96%|█████████▌| 931/971 [00:18<00:00, 50.32it/s]backtest loop:  96%|█████████▋| 937/971 [00:18<00:00, 51.63it/s]backtest loop:  97%|█████████▋| 943/971 [00:18<00:00, 52.71it/s]backtest loop:  98%|█████████▊| 949/971 [00:18<00:00, 53.47it/s]backtest loop:  98%|█████████▊| 955/971 [00:18<00:00, 50.67it/s]backtest loop:  99%|█████████▉| 961/971 [00:18<00:00, 51.86it/s]backtest loop: 100%|█████████▉| 967/971 [00:18<00:00, 52.56it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 50.91it/s]
[3104099:MainThread](2024-04-25 08:23:19,836) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000595
std                0.005006
annualized_return  0.141515
information_ratio  1.832523
max_drawdown      -0.059207
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000396
std                0.005007
annualized_return  0.094163
information_ratio  1.219012
max_drawdown      -0.066321
[3104099:MainThread](2024-04-25 08:23:19,855) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `DoubleEnsemble_crowd_data_csi300_360_rankTrue`.
[3104099:MainThread](2024-04-25 08:23:26,901) INFO - qlib.timer - [log.py:127] - Time cost: 0.011s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.08361817278898007,
                                                    0.09095844033602322,
                                                    0.06730404236767748,
                                                    0.09416335131983414],
 '1day.excess_return_with_cost.information_ratio': [1.0806929078780303,
                                                    1.1849094019170558,
                                                    0.878850542100161,
                                                    1.219011521175686],
 '1day.excess_return_with_cost.max_drawdown': [-0.06696203294657171,
                                               -0.07305297047972394,
                                               -0.06185570741678455,
                                               -0.06632145028511466],
 'IC': [0.023874941755380283,
        0.023240012636530968,
        0.022564971340533844,
        0.02347779949429157],
 'ICIR': [0.17482656452430498,
          0.17087196550992945,
          0.16481748707638758,
          0.17261255414205035],
 'Rank IC': [0.03290767358310547,
             0.03214350726183365,
             0.031119659481776092,
             0.031821060869092255],
 'Rank ICIR': [0.24272272204378978,
               0.23868823821747276,
               0.22822531597855578,
               0.23571956793672166],
 'mae': [0.8659597564607173,
         0.8661122518523465,
         0.8661860570410561,
         0.8661981567204093],
 'mse': [1.0094607797146595,
         1.010206485668107,
         1.0101893411295777,
         1.0101539014774608]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3104099:MainThread](2024-04-25 08:23:30,210) INFO - qlib.DEnsembleModel - [double_ensemble.py:57] - Double Ensemble Model...
[3104099:MainThread](2024-04-25 08:23:33,169) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name DoubleEnsemble_crowd_data_csi300_360_rankTrue_47.
[3104099:MainThread](2024-04-25 08:23:33,245) INFO - qlib.workflow - [exp.py:258] - Experiment 81 starts running ...
[3104099:MainThread](2024-04-25 08:23:33,265) INFO - qlib.workflow - [recorder.py:341] - Recorder 8204d1810de7471f930da04bc60f9218 starts running under Experiment 81 ...
[3104099:MainThread](2024-04-25 08:23:37,849) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (1/3)
[20]	train's l2: 0.991261	valid's l2: 0.996549
[40]	train's l2: 0.987821	valid's l2: 0.99677
[60]	train's l2: 0.985726	valid's l2: 0.996906
[80]	train's l2: 0.984089	valid's l2: 0.997054
[100]	train's l2: 0.982619	valid's l2: 0.997148
[120]	train's l2: 0.981068	valid's l2: 0.99714
[3104099:MainThread](2024-04-25 08:24:06,286) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 08:26:27,968) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 08:26:56,558) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 08:39:37,281) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (2/3)
[20]	train's l2: 1.19025	valid's l2: 1.00235
[40]	train's l2: 1.17086	valid's l2: 1.01203
[60]	train's l2: 1.16013	valid's l2: 1.01915
[80]	train's l2: 1.15341	valid's l2: 1.0236
[100]	train's l2: 1.14762	valid's l2: 1.02674
[120]	train's l2: 1.14262	valid's l2: 1.02921
[3104099:MainThread](2024-04-25 08:39:55,771) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 08:41:14,858) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 08:41:43,104) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 09:02:56,679) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (3/3)
[20]	train's l2: 1.18098	valid's l2: 0.999097
[40]	train's l2: 1.16746	valid's l2: 1.00403
[60]	train's l2: 1.15902	valid's l2: 1.0075
[80]	train's l2: 1.15331	valid's l2: 1.00999
[100]	train's l2: 1.14875	valid's l2: 1.01173
[120]	train's l2: 1.14435	valid's l2: 1.01291
[3104099:MainThread](2024-04-25 09:03:15,987) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to DoubleEnsemble_crowd_data_csi300_360_rankTrue_47.
[3104099:MainThread](2024-04-25 09:03:16,332) INFO - qlib.workflow - [exp.py:258] - Experiment 77 starts running ...
[3104099:MainThread](2024-04-25 09:03:16,354) INFO - qlib.workflow - [recorder.py:341] - Recorder b08ed87964b149798a783b50455c824b starts running under Experiment 77 ...
{'IC': 0.023483012856719807,
 'ICIR': 0.1728120275255053,
 'Rank IC': 0.03233520808592909,
 'Rank ICIR': 0.2380048905903517}
[3104099:MainThread](2024-04-25 09:03:24,531) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3104099:MainThread](2024-04-25 09:04:02,951) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 09:04:02,954) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 09:04:08,953) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f99c6c39ee0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<02:00,  8.02it/s]backtest loop:   1%|          | 9/971 [00:00<00:43, 22.35it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:29, 32.91it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 38.34it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:20, 45.89it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:20, 46.40it/s]backtest loop:   4%|▍         | 41/971 [00:01<00:18, 51.04it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 54.33it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 52.77it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 55.55it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 53.44it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 56.10it/s]backtest loop:   8%|▊         | 80/971 [00:01<00:16, 55.08it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:16, 55.14it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:16, 52.30it/s]backtest loop:  10%|█         | 98/971 [00:02<00:16, 53.19it/s]backtest loop:  11%|█         | 104/971 [00:02<00:16, 53.72it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:15, 54.28it/s]backtest loop:  12%|█▏        | 116/971 [00:02<00:15, 54.36it/s]backtest loop:  13%|█▎        | 122/971 [00:02<00:16, 51.79it/s]backtest loop:  13%|█▎        | 128/971 [00:02<00:16, 50.50it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:16, 51.43it/s]backtest loop:  14%|█▍        | 140/971 [00:02<00:15, 52.52it/s]backtest loop:  15%|█▌        | 146/971 [00:03<00:16, 50.19it/s]backtest loop:  16%|█▌        | 152/971 [00:03<00:15, 51.85it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:15, 52.69it/s]backtest loop:  17%|█▋        | 164/971 [00:03<00:15, 53.18it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:14, 54.33it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:15, 51.93it/s]backtest loop:  19%|█▊        | 182/971 [00:03<00:14, 52.84it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:14, 53.68it/s]backtest loop:  20%|█▉        | 194/971 [00:03<00:14, 54.16it/s]backtest loop:  21%|██        | 200/971 [00:04<00:15, 51.17it/s]backtest loop:  21%|██        | 206/971 [00:04<00:14, 52.36it/s]backtest loop:  22%|██▏       | 212/971 [00:04<00:14, 53.37it/s]backtest loop:  22%|██▏       | 218/971 [00:04<00:14, 50.76it/s]backtest loop:  23%|██▎       | 224/971 [00:04<00:14, 52.12it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:22, 32.56it/s]backtest loop:  24%|██▍       | 236/971 [00:04<00:19, 37.11it/s]backtest loop:  25%|██▍       | 242/971 [00:05<00:17, 41.02it/s]backtest loop:  26%|██▌       | 248/971 [00:05<00:16, 44.50it/s]backtest loop:  26%|██▌       | 254/971 [00:05<00:15, 45.45it/s]backtest loop:  27%|██▋       | 260/971 [00:05<00:14, 48.49it/s]backtest loop:  27%|██▋       | 266/971 [00:05<00:14, 47.78it/s]backtest loop:  28%|██▊       | 272/971 [00:05<00:14, 49.52it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:13, 51.17it/s]backtest loop:  29%|██▉       | 284/971 [00:05<00:13, 52.29it/s]backtest loop:  30%|██▉       | 290/971 [00:05<00:12, 52.86it/s]backtest loop:  30%|███       | 296/971 [00:06<00:13, 50.52it/s]backtest loop:  31%|███       | 302/971 [00:06<00:12, 51.84it/s]backtest loop:  32%|███▏      | 308/971 [00:06<00:12, 52.90it/s]backtest loop:  32%|███▏      | 314/971 [00:06<00:12, 53.52it/s]backtest loop:  33%|███▎      | 320/971 [00:06<00:12, 50.74it/s]backtest loop:  34%|███▎      | 326/971 [00:06<00:12, 52.02it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:12, 53.03it/s]backtest loop:  35%|███▍      | 338/971 [00:06<00:11, 53.42it/s]backtest loop:  35%|███▌      | 344/971 [00:06<00:11, 53.85it/s]backtest loop:  36%|███▌      | 350/971 [00:07<00:12, 51.67it/s]backtest loop:  37%|███▋      | 356/971 [00:07<00:11, 51.93it/s]backtest loop:  37%|███▋      | 362/971 [00:07<00:11, 53.36it/s]backtest loop:  38%|███▊      | 368/971 [00:07<00:12, 47.97it/s]backtest loop:  39%|███▊      | 374/971 [00:07<00:11, 49.89it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:11, 51.27it/s]backtest loop:  40%|███▉      | 386/971 [00:07<00:11, 52.17it/s]backtest loop:  40%|████      | 392/971 [00:07<00:10, 53.05it/s]backtest loop:  41%|████      | 398/971 [00:08<00:11, 49.91it/s]backtest loop:  42%|████▏     | 404/971 [00:08<00:11, 51.19it/s]backtest loop:  42%|████▏     | 410/971 [00:08<00:10, 52.32it/s]backtest loop:  43%|████▎     | 416/971 [00:08<00:10, 52.99it/s]backtest loop:  43%|████▎     | 422/971 [00:08<00:10, 53.63it/s]backtest loop:  44%|████▍     | 428/971 [00:08<00:10, 50.83it/s]backtest loop:  45%|████▍     | 434/971 [00:08<00:10, 51.81it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:10, 52.72it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:09, 53.38it/s]backtest loop:  47%|████▋     | 452/971 [00:09<00:10, 50.77it/s]backtest loop:  47%|████▋     | 458/971 [00:09<00:09, 51.97it/s]backtest loop:  48%|████▊     | 464/971 [00:09<00:09, 52.85it/s]backtest loop:  48%|████▊     | 470/971 [00:09<00:09, 53.53it/s]backtest loop:  49%|████▉     | 476/971 [00:09<00:09, 53.95it/s]backtest loop:  50%|████▉     | 482/971 [00:09<00:09, 50.33it/s]backtest loop:  50%|█████     | 488/971 [00:09<00:09, 51.62it/s]backtest loop:  51%|█████     | 494/971 [00:09<00:09, 52.60it/s]backtest loop:  51%|█████▏    | 500/971 [00:10<00:09, 50.14it/s]backtest loop:  52%|█████▏    | 506/971 [00:10<00:09, 51.55it/s]backtest loop:  53%|█████▎    | 512/971 [00:10<00:09, 49.43it/s]backtest loop:  53%|█████▎    | 518/971 [00:10<00:08, 51.13it/s]backtest loop:  54%|█████▍    | 524/971 [00:10<00:08, 52.00it/s]backtest loop:  55%|█████▍    | 530/971 [00:10<00:08, 52.90it/s]backtest loop:  55%|█████▌    | 536/971 [00:10<00:08, 50.57it/s]backtest loop:  56%|█████▌    | 542/971 [00:10<00:08, 51.80it/s]backtest loop:  56%|█████▋    | 548/971 [00:10<00:08, 52.64it/s]backtest loop:  57%|█████▋    | 554/971 [00:11<00:07, 53.31it/s]backtest loop:  58%|█████▊    | 560/971 [00:11<00:07, 53.92it/s]backtest loop:  58%|█████▊    | 566/971 [00:11<00:07, 50.73it/s]backtest loop:  59%|█████▉    | 572/971 [00:11<00:07, 51.74it/s]backtest loop:  60%|█████▉    | 578/971 [00:11<00:07, 52.57it/s]backtest loop:  60%|██████    | 584/971 [00:11<00:07, 53.50it/s]backtest loop:  61%|██████    | 590/971 [00:11<00:07, 53.99it/s]backtest loop:  61%|██████▏   | 596/971 [00:11<00:07, 50.85it/s]backtest loop:  62%|██████▏   | 602/971 [00:11<00:07, 52.07it/s]backtest loop:  63%|██████▎   | 608/971 [00:12<00:06, 52.82it/s]backtest loop:  63%|██████▎   | 614/971 [00:12<00:06, 53.35it/s]backtest loop:  64%|██████▍   | 620/971 [00:12<00:06, 50.29it/s]backtest loop:  64%|██████▍   | 626/971 [00:12<00:06, 51.58it/s]backtest loop:  65%|██████▌   | 632/971 [00:12<00:06, 52.51it/s]backtest loop:  66%|██████▌   | 638/971 [00:12<00:06, 53.79it/s]backtest loop:  66%|██████▋   | 644/971 [00:12<00:06, 53.95it/s]backtest loop:  67%|██████▋   | 650/971 [00:12<00:06, 51.03it/s]backtest loop:  68%|██████▊   | 656/971 [00:13<00:06, 52.13it/s]backtest loop:  68%|██████▊   | 662/971 [00:13<00:05, 52.93it/s]backtest loop:  69%|██████▉   | 668/971 [00:13<00:05, 53.34it/s]backtest loop:  69%|██████▉   | 674/971 [00:13<00:05, 50.46it/s]backtest loop:  70%|███████   | 680/971 [00:13<00:05, 51.71it/s]backtest loop:  71%|███████   | 686/971 [00:13<00:05, 52.43it/s]backtest loop:  71%|███████▏  | 692/971 [00:13<00:05, 53.08it/s]backtest loop:  72%|███████▏  | 698/971 [00:13<00:05, 53.62it/s]backtest loop:  73%|███████▎  | 704/971 [00:13<00:05, 50.80it/s]backtest loop:  73%|███████▎  | 710/971 [00:14<00:05, 51.77it/s]backtest loop:  74%|███████▎  | 716/971 [00:14<00:04, 52.66it/s]backtest loop:  74%|███████▍  | 722/971 [00:14<00:04, 53.36it/s]backtest loop:  75%|███████▍  | 728/971 [00:14<00:04, 53.76it/s]backtest loop:  76%|███████▌  | 734/971 [00:14<00:04, 47.95it/s]backtest loop:  76%|███████▌  | 740/971 [00:14<00:04, 49.80it/s]backtest loop:  77%|███████▋  | 746/971 [00:14<00:04, 51.24it/s]backtest loop:  77%|███████▋  | 752/971 [00:14<00:04, 49.30it/s]backtest loop:  78%|███████▊  | 758/971 [00:14<00:04, 50.69it/s]backtest loop:  79%|███████▊  | 764/971 [00:15<00:03, 51.96it/s]backtest loop:  79%|███████▉  | 770/971 [00:15<00:04, 49.60it/s]backtest loop:  80%|███████▉  | 776/971 [00:15<00:03, 51.17it/s]backtest loop:  81%|████████  | 782/971 [00:15<00:03, 52.47it/s]backtest loop:  81%|████████  | 788/971 [00:15<00:03, 50.43it/s]backtest loop:  82%|████████▏ | 794/971 [00:15<00:03, 51.74it/s]backtest loop:  82%|████████▏ | 800/971 [00:15<00:03, 52.68it/s]backtest loop:  83%|████████▎ | 806/971 [00:15<00:03, 53.15it/s]backtest loop:  84%|████████▎ | 812/971 [00:16<00:02, 53.86it/s]backtest loop:  84%|████████▍ | 818/971 [00:16<00:03, 50.90it/s]backtest loop:  85%|████████▍ | 824/971 [00:16<00:02, 52.07it/s]backtest loop:  85%|████████▌ | 830/971 [00:16<00:02, 52.92it/s]backtest loop:  86%|████████▌ | 836/971 [00:16<00:02, 53.53it/s]backtest loop:  87%|████████▋ | 842/971 [00:16<00:02, 53.96it/s]backtest loop:  87%|████████▋ | 848/971 [00:16<00:02, 50.94it/s]backtest loop:  88%|████████▊ | 854/971 [00:16<00:02, 51.93it/s]backtest loop:  89%|████████▊ | 860/971 [00:16<00:02, 52.48it/s]backtest loop:  89%|████████▉ | 867/971 [00:17<00:01, 52.15it/s]backtest loop:  90%|█████████ | 874/971 [00:17<00:01, 54.95it/s]backtest loop:  91%|█████████ | 881/971 [00:17<00:01, 57.01it/s]backtest loop:  91%|█████████▏| 887/971 [00:17<00:01, 54.46it/s]backtest loop:  92%|█████████▏| 893/971 [00:17<00:01, 55.87it/s]backtest loop:  93%|█████████▎| 899/971 [00:17<00:01, 56.83it/s]backtest loop:  93%|█████████▎| 905/971 [00:17<00:01, 57.58it/s]backtest loop:  94%|█████████▍| 911/971 [00:17<00:01, 58.25it/s]backtest loop:  94%|█████████▍| 917/971 [00:17<00:00, 55.20it/s]backtest loop:  95%|█████████▌| 923/971 [00:18<00:00, 56.42it/s]backtest loop:  96%|█████████▌| 930/971 [00:18<00:00, 58.19it/s]backtest loop:  96%|█████████▋| 936/971 [00:18<00:00, 55.20it/s]backtest loop:  97%|█████████▋| 943/971 [00:18<00:00, 57.31it/s]backtest loop:  98%|█████████▊| 950/971 [00:18<00:00, 55.39it/s]backtest loop:  98%|█████████▊| 956/971 [00:18<00:00, 56.48it/s]backtest loop:  99%|█████████▉| 962/971 [00:18<00:00, 57.41it/s]backtest loop: 100%|█████████▉| 969/971 [00:18<00:00, 58.82it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 51.41it/s]
[3104099:MainThread](2024-04-25 09:04:27,902) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000516
std                0.005093
annualized_return  0.122879
information_ratio  1.564003
max_drawdown      -0.053097
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000318
std                0.005094
annualized_return  0.075719
information_ratio  0.963514
max_drawdown      -0.068086
[3104099:MainThread](2024-04-25 09:04:27,915) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `DoubleEnsemble_crowd_data_csi300_360_rankTrue`.
[3104099:MainThread](2024-04-25 09:04:34,974) INFO - qlib.timer - [log.py:127] - Time cost: 0.007s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.08361817278898007,
                                                    0.09095844033602322,
                                                    0.06730404236767748,
                                                    0.09416335131983414,
                                                    0.07571914736580923],
 '1day.excess_return_with_cost.information_ratio': [1.0806929078780303,
                                                    1.1849094019170558,
                                                    0.878850542100161,
                                                    1.219011521175686,
                                                    0.9635135445975826],
 '1day.excess_return_with_cost.max_drawdown': [-0.06696203294657171,
                                               -0.07305297047972394,
                                               -0.06185570741678455,
                                               -0.06632145028511466,
                                               -0.06808610612298839],
 'IC': [0.023874941755380283,
        0.023240012636530968,
        0.022564971340533844,
        0.02347779949429157,
        0.023483012856719807],
 'ICIR': [0.17482656452430498,
          0.17087196550992945,
          0.16481748707638758,
          0.17261255414205035,
          0.1728120275255053],
 'Rank IC': [0.03290767358310547,
             0.03214350726183365,
             0.031119659481776092,
             0.031821060869092255,
             0.03233520808592909],
 'Rank ICIR': [0.24272272204378978,
               0.23868823821747276,
               0.22822531597855578,
               0.23571956793672166,
               0.2380048905903517],
 'mae': [0.8659597564607173,
         0.8661122518523465,
         0.8661860570410561,
         0.8661981567204093,
         0.8661771742546653],
 'mse': [1.0094607797146595,
         1.010206485668107,
         1.0101893411295777,
         1.0101539014774608,
         1.010014981055666]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3104099:MainThread](2024-04-25 09:04:38,272) INFO - qlib.DEnsembleModel - [double_ensemble.py:57] - Double Ensemble Model...
[3104099:MainThread](2024-04-25 09:04:41,255) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name DoubleEnsemble_crowd_data_csi300_360_rankTrue_48.
[3104099:MainThread](2024-04-25 09:04:41,332) INFO - qlib.workflow - [exp.py:258] - Experiment 82 starts running ...
[3104099:MainThread](2024-04-25 09:04:41,350) INFO - qlib.workflow - [recorder.py:341] - Recorder 1e2075d3842240279cfea67263637b8c starts running under Experiment 82 ...
[3104099:MainThread](2024-04-25 09:04:45,693) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (1/3)
[20]	train's l2: 0.991261	valid's l2: 0.996549
[40]	train's l2: 0.987821	valid's l2: 0.99677
[60]	train's l2: 0.985726	valid's l2: 0.996906
[80]	train's l2: 0.984089	valid's l2: 0.997054
[100]	train's l2: 0.982619	valid's l2: 0.997148
[120]	train's l2: 0.981068	valid's l2: 0.99714
[3104099:MainThread](2024-04-25 09:05:18,311) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 09:07:31,679) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 09:08:00,150) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 09:20:44,207) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (2/3)
[20]	train's l2: 1.18925	valid's l2: 1.0026
[40]	train's l2: 1.16949	valid's l2: 1.0124
[60]	train's l2: 1.15889	valid's l2: 1.01927
[80]	train's l2: 1.15178	valid's l2: 1.02376
[100]	train's l2: 1.14627	valid's l2: 1.02707
[120]	train's l2: 1.14164	valid's l2: 1.02922
[3104099:MainThread](2024-04-25 09:21:03,739) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 09:22:19,303) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 09:22:47,401) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 09:44:09,932) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (3/3)
[20]	train's l2: 1.18106	valid's l2: 0.998986
[40]	train's l2: 1.16732	valid's l2: 1.00396
[60]	train's l2: 1.1591	valid's l2: 1.00763
[80]	train's l2: 1.15348	valid's l2: 1.00993
[100]	train's l2: 1.14862	valid's l2: 1.01149
[120]	train's l2: 1.14392	valid's l2: 1.01294
[3104099:MainThread](2024-04-25 09:44:30,062) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to DoubleEnsemble_crowd_data_csi300_360_rankTrue_48.
[3104099:MainThread](2024-04-25 09:44:30,409) INFO - qlib.workflow - [exp.py:258] - Experiment 77 starts running ...
[3104099:MainThread](2024-04-25 09:44:30,431) INFO - qlib.workflow - [recorder.py:341] - Recorder 6bfc957936324623aa62fee7517f6617 starts running under Experiment 77 ...
{'IC': 0.02294186329295907,
 'ICIR': 0.16796746172163987,
 'Rank IC': 0.03216682095633594,
 'Rank ICIR': 0.2367800463227247}
[3104099:MainThread](2024-04-25 09:44:38,095) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3104099:MainThread](2024-04-25 09:45:15,018) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 09:45:15,021) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 09:45:20,870) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f99bfa58d90>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:39,  9.77it/s]backtest loop:   1%|          | 10/971 [00:00<00:34, 27.75it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:25, 36.85it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:22, 42.16it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:19, 48.15it/s]backtest loop:   4%|▍         | 37/971 [00:00<00:18, 51.26it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:18, 50.69it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:17, 54.01it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 52.61it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:16, 55.45it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:15, 57.64it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:16, 55.12it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 57.07it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 59.01it/s]backtest loop:  10%|▉         | 97/971 [00:01<00:15, 56.10it/s]backtest loop:  11%|█         | 104/971 [00:02<00:14, 57.83it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:14, 59.25it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:15, 56.26it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:14, 58.89it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:14, 56.52it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 54.18it/s]backtest loop:  15%|█▍        | 142/971 [00:02<00:15, 54.70it/s]backtest loop:  15%|█▌        | 149/971 [00:02<00:14, 57.09it/s]backtest loop:  16%|█▌        | 156/971 [00:03<00:14, 55.71it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:14, 57.59it/s]backtest loop:  17%|█▋        | 169/971 [00:03<00:13, 58.03it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:13, 56.93it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:13, 58.62it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:13, 56.42it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 58.24it/s]backtest loop:  21%|██        | 204/971 [00:03<00:12, 59.66it/s]backtest loop:  22%|██▏       | 210/971 [00:03<00:13, 56.72it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 54.58it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:13, 56.98it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:19, 37.43it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:18, 40.32it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:16, 45.52it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:15, 47.70it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:13, 52.17it/s]backtest loop:  27%|██▋       | 263/971 [00:05<00:12, 55.25it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:13, 53.54it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:13, 53.09it/s]backtest loop:  29%|██▉       | 282/971 [00:05<00:12, 54.84it/s]backtest loop:  30%|██▉       | 289/971 [00:05<00:11, 57.05it/s]backtest loop:  30%|███       | 295/971 [00:05<00:12, 54.82it/s]backtest loop:  31%|███       | 302/971 [00:05<00:11, 57.05it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 58.63it/s]backtest loop:  32%|███▏      | 315/971 [00:05<00:11, 55.78it/s]backtest loop:  33%|███▎      | 322/971 [00:06<00:11, 57.72it/s]backtest loop:  34%|███▍      | 329/971 [00:06<00:10, 59.15it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:11, 56.08it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:10, 58.14it/s]backtest loop:  36%|███▌      | 349/971 [00:06<00:10, 59.75it/s]backtest loop:  37%|███▋      | 356/971 [00:06<00:10, 57.39it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:10, 56.24it/s]backtest loop:  38%|███▊      | 369/971 [00:06<00:11, 53.84it/s]backtest loop:  39%|███▊      | 376/971 [00:07<00:10, 56.24it/s]backtest loop:  39%|███▉      | 382/971 [00:07<00:10, 57.06it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:10, 54.77it/s]backtest loop:  41%|████      | 395/971 [00:07<00:10, 57.27it/s]backtest loop:  41%|████▏     | 402/971 [00:07<00:09, 58.76it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:10, 55.91it/s]backtest loop:  43%|████▎     | 415/971 [00:07<00:09, 57.79it/s]backtest loop:  43%|████▎     | 422/971 [00:07<00:09, 59.07it/s]backtest loop:  44%|████▍     | 428/971 [00:07<00:09, 56.16it/s]backtest loop:  45%|████▍     | 434/971 [00:08<00:09, 57.09it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 58.67it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 55.67it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:08, 57.83it/s]backtest loop:  47%|████▋     | 461/971 [00:08<00:08, 59.17it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:08, 56.08it/s]backtest loop:  49%|████▉     | 474/971 [00:08<00:08, 57.86it/s]backtest loop:  50%|████▉     | 481/971 [00:08<00:08, 59.16it/s]backtest loop:  50%|█████     | 487/971 [00:08<00:08, 55.78it/s]backtest loop:  51%|█████     | 494/971 [00:09<00:08, 57.70it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 55.12it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 54.09it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 56.59it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 58.26it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:07, 55.58it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:07, 57.52it/s]backtest loop:  56%|█████▌    | 541/971 [00:09<00:07, 55.77it/s]backtest loop:  56%|█████▋    | 548/971 [00:10<00:07, 57.70it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 58.95it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 56.00it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:06, 57.81it/s]backtest loop:  59%|█████▉    | 575/971 [00:10<00:06, 59.20it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:06, 56.39it/s]backtest loop:  60%|██████    | 587/971 [00:10<00:06, 57.33it/s]backtest loop:  61%|██████    | 593/971 [00:10<00:06, 57.38it/s]backtest loop:  62%|██████▏   | 600/971 [00:10<00:06, 55.65it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 57.61it/s]backtest loop:  63%|██████▎   | 614/971 [00:11<00:06, 59.18it/s]backtest loop:  64%|██████▍   | 620/971 [00:11<00:06, 56.22it/s]backtest loop:  65%|██████▍   | 627/971 [00:11<00:05, 58.05it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:05, 59.36it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:05, 56.33it/s]backtest loop:  67%|██████▋   | 647/971 [00:11<00:05, 58.18it/s]backtest loop:  67%|██████▋   | 654/971 [00:11<00:05, 59.51it/s]backtest loop:  68%|██████▊   | 660/971 [00:12<00:05, 56.39it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 58.17it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:05, 56.20it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:05, 57.95it/s]backtest loop:  71%|███████   | 687/971 [00:12<00:04, 58.49it/s]backtest loop:  71%|███████▏  | 693/971 [00:12<00:04, 58.82it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 55.85it/s]backtest loop:  73%|███████▎  | 706/971 [00:12<00:04, 57.84it/s]backtest loop:  73%|███████▎  | 713/971 [00:12<00:04, 59.24it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 56.23it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 58.38it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 55.68it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 53.73it/s]backtest loop:  77%|███████▋  | 744/971 [00:13<00:04, 55.19it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 53.19it/s]backtest loop:  78%|███████▊  | 757/971 [00:13<00:03, 55.92it/s]backtest loop:  79%|███████▊  | 764/971 [00:13<00:03, 57.92it/s]backtest loop:  79%|███████▉  | 770/971 [00:13<00:03, 55.28it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 57.43it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 55.44it/s]backtest loop:  81%|████████▏ | 790/971 [00:14<00:03, 57.49it/s]backtest loop:  82%|████████▏ | 797/971 [00:14<00:02, 58.95it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:03, 55.99it/s]backtest loop:  83%|████████▎ | 810/971 [00:14<00:02, 57.91it/s]backtest loop:  84%|████████▍ | 817/971 [00:14<00:02, 59.27it/s]backtest loop:  85%|████████▍ | 823/971 [00:14<00:02, 56.24it/s]backtest loop:  85%|████████▌ | 830/971 [00:14<00:02, 58.09it/s]backtest loop:  86%|████████▌ | 837/971 [00:15<00:02, 59.40it/s]backtest loop:  87%|████████▋ | 843/971 [00:15<00:02, 56.13it/s]backtest loop:  88%|████████▊ | 850/971 [00:15<00:02, 57.95it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 56.05it/s]backtest loop:  89%|████████▉ | 864/971 [00:15<00:01, 57.85it/s]backtest loop:  90%|████████▉ | 871/971 [00:15<00:01, 59.21it/s]backtest loop:  90%|█████████ | 877/971 [00:15<00:01, 56.14it/s]backtest loop:  91%|█████████ | 884/971 [00:15<00:01, 58.05it/s]backtest loop:  92%|█████████▏| 891/971 [00:16<00:01, 59.38it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 56.07it/s]backtest loop:  93%|█████████▎| 903/971 [00:16<00:01, 56.44it/s]backtest loop:  94%|█████████▎| 910/971 [00:16<00:01, 58.20it/s]backtest loop:  94%|█████████▍| 916/971 [00:16<00:00, 55.50it/s]backtest loop:  95%|█████████▍| 922/971 [00:16<00:00, 56.68it/s]backtest loop:  96%|█████████▌| 929/971 [00:16<00:00, 58.47it/s]backtest loop:  96%|█████████▋| 936/971 [00:16<00:00, 56.50it/s]backtest loop:  97%|█████████▋| 943/971 [00:16<00:00, 58.25it/s]backtest loop:  98%|█████████▊| 949/971 [00:17<00:00, 58.68it/s]backtest loop:  98%|█████████▊| 955/971 [00:17<00:00, 55.74it/s]backtest loop:  99%|█████████▉| 962/971 [00:17<00:00, 57.73it/s]backtest loop: 100%|█████████▉| 969/971 [00:17<00:00, 59.13it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.66it/s]
[3104099:MainThread](2024-04-25 09:45:38,373) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000554
std                0.004897
annualized_return  0.131743
information_ratio  1.743954
max_drawdown      -0.051472
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000355
std                0.004898
annualized_return  0.084458
information_ratio  1.117684
max_drawdown      -0.058556
[3104099:MainThread](2024-04-25 09:45:38,385) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `DoubleEnsemble_crowd_data_csi300_360_rankTrue`.
[3104099:MainThread](2024-04-25 09:45:45,308) INFO - qlib.timer - [log.py:127] - Time cost: 0.012s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.08361817278898007,
                                                    0.09095844033602322,
                                                    0.06730404236767748,
                                                    0.09416335131983414,
                                                    0.07571914736580923,
                                                    0.08445794487843644],
 '1day.excess_return_with_cost.information_ratio': [1.0806929078780303,
                                                    1.1849094019170558,
                                                    0.878850542100161,
                                                    1.219011521175686,
                                                    0.9635135445975826,
                                                    1.117683589984463],
 '1day.excess_return_with_cost.max_drawdown': [-0.06696203294657171,
                                               -0.07305297047972394,
                                               -0.06185570741678455,
                                               -0.06632145028511466,
                                               -0.06808610612298839,
                                               -0.05855643317073739],
 'IC': [0.023874941755380283,
        0.023240012636530968,
        0.022564971340533844,
        0.02347779949429157,
        0.023483012856719807,
        0.02294186329295907],
 'ICIR': [0.17482656452430498,
          0.17087196550992945,
          0.16481748707638758,
          0.17261255414205035,
          0.1728120275255053,
          0.16796746172163987],
 'Rank IC': [0.03290767358310547,
             0.03214350726183365,
             0.031119659481776092,
             0.031821060869092255,
             0.03233520808592909,
             0.03216682095633594],
 'Rank ICIR': [0.24272272204378978,
               0.23868823821747276,
               0.22822531597855578,
               0.23571956793672166,
               0.2380048905903517,
               0.2367800463227247],
 'mae': [0.8659597564607173,
         0.8661122518523465,
         0.8661860570410561,
         0.8661981567204093,
         0.8661771742546653,
         0.8661068903157573],
 'mse': [1.0094607797146595,
         1.010206485668107,
         1.0101893411295777,
         1.0101539014774608,
         1.010014981055666,
         1.0101964531009429]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3104099:MainThread](2024-04-25 09:45:48,626) INFO - qlib.DEnsembleModel - [double_ensemble.py:57] - Double Ensemble Model...
[3104099:MainThread](2024-04-25 09:45:51,593) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name DoubleEnsemble_crowd_data_csi300_360_rankTrue_49.
[3104099:MainThread](2024-04-25 09:45:51,673) INFO - qlib.workflow - [exp.py:258] - Experiment 83 starts running ...
[3104099:MainThread](2024-04-25 09:45:51,697) INFO - qlib.workflow - [recorder.py:341] - Recorder be3ed6cdba794df9bc96b78afde5b478 starts running under Experiment 83 ...
[3104099:MainThread](2024-04-25 09:45:56,016) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (1/3)
[20]	train's l2: 0.991261	valid's l2: 0.996549
[40]	train's l2: 0.987821	valid's l2: 0.99677
[60]	train's l2: 0.985726	valid's l2: 0.996906
[80]	train's l2: 0.984089	valid's l2: 0.997054
[100]	train's l2: 0.982619	valid's l2: 0.997148
[120]	train's l2: 0.981068	valid's l2: 0.99714
[3104099:MainThread](2024-04-25 09:46:27,122) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 09:48:40,693) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 09:49:08,868) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 10:01:44,680) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (2/3)
[20]	train's l2: 1.18959	valid's l2: 1.00246
[40]	train's l2: 1.17013	valid's l2: 1.01234
[60]	train's l2: 1.15989	valid's l2: 1.01901
[80]	train's l2: 1.15288	valid's l2: 1.02352
[100]	train's l2: 1.14787	valid's l2: 1.02675
[120]	train's l2: 1.14303	valid's l2: 1.02897
[3104099:MainThread](2024-04-25 10:02:05,408) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 10:03:20,218) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 10:03:49,047) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 10:24:54,561) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (3/3)
[20]	train's l2: 1.18146	valid's l2: 0.99895
[40]	train's l2: 1.16803	valid's l2: 1.00413
[60]	train's l2: 1.15998	valid's l2: 1.0076
[80]	train's l2: 1.15478	valid's l2: 1.00965
[100]	train's l2: 1.15028	valid's l2: 1.01122
[120]	train's l2: 1.14552	valid's l2: 1.0125
[3104099:MainThread](2024-04-25 10:25:12,077) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to DoubleEnsemble_crowd_data_csi300_360_rankTrue_49.
[3104099:MainThread](2024-04-25 10:25:12,433) INFO - qlib.workflow - [exp.py:258] - Experiment 77 starts running ...
[3104099:MainThread](2024-04-25 10:25:12,456) INFO - qlib.workflow - [recorder.py:341] - Recorder 79f1512d952a461b820f13447fe563b1 starts running under Experiment 77 ...
{'IC': 0.022553004098026616,
 'ICIR': 0.16472172405086566,
 'Rank IC': 0.031419529154925824,
 'Rank ICIR': 0.23138981309887238}
[3104099:MainThread](2024-04-25 10:25:20,057) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3104099:MainThread](2024-04-25 10:25:58,266) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 10:25:58,269) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 10:26:04,167) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f99c722d400>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:37,  9.91it/s]backtest loop:   1%|          | 9/971 [00:00<00:37, 25.97it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:26, 35.58it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.39it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.82it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 48.01it/s]backtest loop:   4%|▍         | 40/971 [00:00<00:18, 51.30it/s]backtest loop:   5%|▍         | 47/971 [00:01<00:16, 54.62it/s]backtest loop:   5%|▌         | 53/971 [00:01<00:16, 54.81it/s]backtest loop:   6%|▌         | 59/971 [00:01<00:17, 53.16it/s]backtest loop:   7%|▋         | 66/971 [00:01<00:16, 55.98it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 54.07it/s]backtest loop:   8%|▊         | 79/971 [00:01<00:15, 56.58it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:15, 58.42it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:15, 55.63it/s]backtest loop:  10%|█         | 99/971 [00:02<00:15, 57.63it/s]backtest loop:  11%|█         | 106/971 [00:02<00:14, 59.13it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 56.34it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:14, 58.18it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 56.19it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 54.51it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:14, 56.94it/s]backtest loop:  15%|█▍        | 144/971 [00:02<00:14, 57.64it/s]backtest loop:  16%|█▌        | 151/971 [00:02<00:14, 55.83it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:14, 57.85it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:13, 59.36it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:14, 56.98it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:13, 58.75it/s]backtest loop:  19%|█▉        | 184/971 [00:03<00:13, 58.77it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:13, 55.99it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 57.84it/s]backtest loop:  21%|██        | 204/971 [00:03<00:12, 59.40it/s]backtest loop:  22%|██▏       | 210/971 [00:03<00:13, 56.32it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 54.29it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:20, 35.99it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:17, 41.76it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:16, 43.79it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:15, 48.45it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:14, 49.91it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:13, 54.13it/s]backtest loop:  27%|██▋       | 263/971 [00:05<00:12, 56.72it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:12, 54.71it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:12, 54.03it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:12, 56.26it/s]backtest loop:  30%|██▉       | 289/971 [00:05<00:11, 57.07it/s]backtest loop:  30%|███       | 295/971 [00:05<00:12, 55.70it/s]backtest loop:  31%|███       | 302/971 [00:05<00:11, 58.34it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 59.56it/s]backtest loop:  32%|███▏      | 315/971 [00:05<00:11, 56.36it/s]backtest loop:  33%|███▎      | 322/971 [00:06<00:11, 58.35it/s]backtest loop:  34%|███▍      | 329/971 [00:06<00:10, 59.86it/s]backtest loop:  35%|███▍      | 336/971 [00:06<00:11, 57.10it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:10, 57.81it/s]backtest loop:  36%|███▌      | 349/971 [00:06<00:10, 59.39it/s]backtest loop:  37%|███▋      | 355/971 [00:06<00:10, 56.52it/s]backtest loop:  37%|███▋      | 362/971 [00:06<00:10, 58.65it/s]backtest loop:  38%|███▊      | 368/971 [00:06<00:11, 52.97it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:10, 55.66it/s]backtest loop:  39%|███▉      | 382/971 [00:07<00:10, 57.64it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:10, 54.93it/s]backtest loop:  41%|████      | 395/971 [00:07<00:10, 57.24it/s]backtest loop:  41%|████▏     | 401/971 [00:07<00:09, 57.92it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:10, 56.10it/s]backtest loop:  43%|████▎     | 415/971 [00:07<00:09, 57.98it/s]backtest loop:  43%|████▎     | 422/971 [00:07<00:09, 59.35it/s]backtest loop:  44%|████▍     | 428/971 [00:07<00:09, 56.43it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:09, 58.24it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 58.59it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 55.77it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:08, 58.16it/s]backtest loop:  47%|████▋     | 460/971 [00:08<00:08, 58.41it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:08, 56.31it/s]backtest loop:  49%|████▉     | 474/971 [00:08<00:08, 58.01it/s]backtest loop:  50%|████▉     | 481/971 [00:08<00:08, 59.37it/s]backtest loop:  50%|█████     | 487/971 [00:08<00:08, 56.29it/s]backtest loop:  51%|█████     | 493/971 [00:09<00:08, 57.17it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 55.47it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 54.35it/s]backtest loop:  53%|█████▎    | 513/971 [00:09<00:08, 55.51it/s]backtest loop:  54%|█████▎    | 520/971 [00:09<00:07, 57.62it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 55.09it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:07, 57.54it/s]backtest loop:  56%|█████▌    | 540/971 [00:09<00:07, 58.91it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 55.73it/s]backtest loop:  57%|█████▋    | 553/971 [00:10<00:07, 57.68it/s]backtest loop:  58%|█████▊    | 560/971 [00:10<00:06, 59.10it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 56.05it/s]backtest loop:  59%|█████▉    | 572/971 [00:10<00:07, 56.27it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:06, 57.18it/s]backtest loop:  60%|██████    | 585/971 [00:10<00:06, 59.09it/s]backtest loop:  61%|██████    | 591/971 [00:10<00:06, 56.00it/s]backtest loop:  62%|██████▏   | 598/971 [00:10<00:06, 57.85it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:06, 55.76it/s]backtest loop:  63%|██████▎   | 611/971 [00:11<00:06, 56.80it/s]backtest loop:  64%|██████▎   | 618/971 [00:11<00:06, 58.69it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 56.46it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 57.70it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 59.16it/s]backtest loop:  66%|██████▋   | 645/971 [00:11<00:05, 56.17it/s]backtest loop:  67%|██████▋   | 652/971 [00:11<00:05, 58.08it/s]backtest loop:  68%|██████▊   | 659/971 [00:11<00:05, 59.20it/s]backtest loop:  68%|██████▊   | 665/971 [00:12<00:05, 56.16it/s]backtest loop:  69%|██████▉   | 672/971 [00:12<00:05, 57.94it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 55.95it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 56.88it/s]backtest loop:  71%|███████▏  | 692/971 [00:12<00:04, 58.51it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 56.45it/s]backtest loop:  73%|███████▎  | 706/971 [00:12<00:04, 58.13it/s]backtest loop:  73%|███████▎  | 712/971 [00:12<00:04, 58.50it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 56.44it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 58.29it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 55.52it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 53.71it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:04, 56.38it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 54.26it/s]backtest loop:  78%|███████▊  | 758/971 [00:13<00:03, 56.46it/s]backtest loop:  79%|███████▉  | 765/971 [00:13<00:03, 54.98it/s]backtest loop:  80%|███████▉  | 772/971 [00:13<00:03, 57.06it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 58.66it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 56.55it/s]backtest loop:  82%|████████▏ | 792/971 [00:14<00:03, 58.38it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 55.61it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:02, 57.49it/s]backtest loop:  84%|████████▎ | 811/971 [00:14<00:02, 58.04it/s]backtest loop:  84%|████████▍ | 818/971 [00:14<00:02, 56.00it/s]backtest loop:  85%|████████▍ | 825/971 [00:14<00:02, 57.85it/s]backtest loop:  86%|████████▌ | 832/971 [00:15<00:02, 59.19it/s]backtest loop:  86%|████████▋ | 838/971 [00:15<00:02, 56.15it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 57.95it/s]backtest loop:  88%|████████▊ | 851/971 [00:15<00:02, 58.44it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 54.99it/s]backtest loop:  89%|████████▉ | 863/971 [00:15<00:01, 56.12it/s]backtest loop:  90%|████████▉ | 870/971 [00:15<00:01, 57.94it/s]backtest loop:  90%|█████████ | 877/971 [00:15<00:01, 55.92it/s]backtest loop:  91%|█████████ | 884/971 [00:15<00:01, 57.79it/s]backtest loop:  92%|█████████▏| 891/971 [00:16<00:01, 59.16it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 56.30it/s]backtest loop:  93%|█████████▎| 904/971 [00:16<00:01, 58.16it/s]backtest loop:  94%|█████████▍| 911/971 [00:16<00:01, 59.49it/s]backtest loop:  94%|█████████▍| 917/971 [00:16<00:00, 56.39it/s]backtest loop:  95%|█████████▌| 924/971 [00:16<00:00, 58.12it/s]backtest loop:  96%|█████████▌| 931/971 [00:16<00:00, 56.08it/s]backtest loop:  97%|█████████▋| 938/971 [00:16<00:00, 57.93it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 56.10it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 57.86it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 59.19it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 56.20it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 57.03it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.63it/s]
[3104099:MainThread](2024-04-25 10:26:21,679) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000512
std                0.005031
annualized_return  0.121864
information_ratio  1.570157
max_drawdown      -0.063181
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000313
std                0.005032
annualized_return  0.074561
information_ratio  0.960488
max_drawdown      -0.071967
[3104099:MainThread](2024-04-25 10:26:21,693) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `DoubleEnsemble_crowd_data_csi300_360_rankTrue`.
[3104099:MainThread](2024-04-25 10:26:28,596) INFO - qlib.timer - [log.py:127] - Time cost: 0.011s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.08361817278898007,
                                                    0.09095844033602322,
                                                    0.06730404236767748,
                                                    0.09416335131983414,
                                                    0.07571914736580923,
                                                    0.08445794487843644,
                                                    0.07456149530076366],
 '1day.excess_return_with_cost.information_ratio': [1.0806929078780303,
                                                    1.1849094019170558,
                                                    0.878850542100161,
                                                    1.219011521175686,
                                                    0.9635135445975826,
                                                    1.117683589984463,
                                                    0.9604879141926975],
 '1day.excess_return_with_cost.max_drawdown': [-0.06696203294657171,
                                               -0.07305297047972394,
                                               -0.06185570741678455,
                                               -0.06632145028511466,
                                               -0.06808610612298839,
                                               -0.05855643317073739,
                                               -0.0719674514614302],
 'IC': [0.023874941755380283,
        0.023240012636530968,
        0.022564971340533844,
        0.02347779949429157,
        0.023483012856719807,
        0.02294186329295907,
        0.022553004098026616],
 'ICIR': [0.17482656452430498,
          0.17087196550992945,
          0.16481748707638758,
          0.17261255414205035,
          0.1728120275255053,
          0.16796746172163987,
          0.16472172405086566],
 'Rank IC': [0.03290767358310547,
             0.03214350726183365,
             0.031119659481776092,
             0.031821060869092255,
             0.03233520808592909,
             0.03216682095633594,
             0.031419529154925824],
 'Rank ICIR': [0.24272272204378978,
               0.23868823821747276,
               0.22822531597855578,
               0.23571956793672166,
               0.2380048905903517,
               0.2367800463227247,
               0.23138981309887238],
 'mae': [0.8659597564607173,
         0.8661122518523465,
         0.8661860570410561,
         0.8661981567204093,
         0.8661771742546653,
         0.8661068903157573,
         0.8661295321328841],
 'mse': [1.0094607797146595,
         1.010206485668107,
         1.0101893411295777,
         1.0101539014774608,
         1.010014981055666,
         1.0101964531009429,
         1.0099105768602996]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3104099:MainThread](2024-04-25 10:26:31,872) INFO - qlib.DEnsembleModel - [double_ensemble.py:57] - Double Ensemble Model...
[3104099:MainThread](2024-04-25 10:26:34,818) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name DoubleEnsemble_crowd_data_csi300_360_rankTrue_50.
[3104099:MainThread](2024-04-25 10:26:34,898) INFO - qlib.workflow - [exp.py:258] - Experiment 84 starts running ...
[3104099:MainThread](2024-04-25 10:26:34,912) INFO - qlib.workflow - [recorder.py:341] - Recorder de533ec4b5fb4649b14e710b385c1ff0 starts running under Experiment 84 ...
[3104099:MainThread](2024-04-25 10:26:39,065) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (1/3)
[20]	train's l2: 0.991261	valid's l2: 0.996549
[40]	train's l2: 0.987821	valid's l2: 0.99677
[60]	train's l2: 0.985726	valid's l2: 0.996906
[80]	train's l2: 0.984089	valid's l2: 0.997054
[100]	train's l2: 0.982619	valid's l2: 0.997148
[120]	train's l2: 0.981068	valid's l2: 0.99714
[3104099:MainThread](2024-04-25 10:27:07,964) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 10:29:20,388) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 10:29:48,867) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 10:42:19,860) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (2/3)
[20]	train's l2: 1.1895	valid's l2: 1.00263
[40]	train's l2: 1.17011	valid's l2: 1.01282
[60]	train's l2: 1.15974	valid's l2: 1.01945
[80]	train's l2: 1.15291	valid's l2: 1.02391
[100]	train's l2: 1.14767	valid's l2: 1.02667
[120]	train's l2: 1.14293	valid's l2: 1.02918
[3104099:MainThread](2024-04-25 10:42:39,176) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 10:43:56,159) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 10:44:24,460) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 11:05:42,090) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (3/3)
[20]	train's l2: 1.18103	valid's l2: 0.999006
[40]	train's l2: 1.1674	valid's l2: 1.00403
[60]	train's l2: 1.15926	valid's l2: 1.00758
[80]	train's l2: 1.15375	valid's l2: 1.00979
[100]	train's l2: 1.14877	valid's l2: 1.01154
[120]	train's l2: 1.1441	valid's l2: 1.01291
[3104099:MainThread](2024-04-25 11:06:01,932) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to DoubleEnsemble_crowd_data_csi300_360_rankTrue_50.
[3104099:MainThread](2024-04-25 11:06:02,282) INFO - qlib.workflow - [exp.py:258] - Experiment 77 starts running ...
[3104099:MainThread](2024-04-25 11:06:02,304) INFO - qlib.workflow - [recorder.py:341] - Recorder c0e1e5b85db04545acbb980db26bb939 starts running under Experiment 77 ...
{'IC': 0.022915817489001317,
 'ICIR': 0.16818079954120482,
 'Rank IC': 0.031750270146404656,
 'Rank ICIR': 0.23363755327516045}
[3104099:MainThread](2024-04-25 11:06:10,243) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3104099:MainThread](2024-04-25 11:06:47,795) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 11:06:47,798) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 11:06:53,646) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f99cc236970>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:39,  9.73it/s]backtest loop:   1%|          | 9/971 [00:00<00:37, 25.62it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 38.10it/s]backtest loop:   2%|▏         | 22/971 [00:00<00:22, 42.06it/s]backtest loop:   3%|▎         | 29/971 [00:00<00:20, 45.46it/s]backtest loop:   4%|▎         | 35/971 [00:00<00:18, 49.37it/s]backtest loop:   4%|▍         | 42/971 [00:00<00:17, 53.47it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 54.97it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.15it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 55.95it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 53.99it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 56.69it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 58.26it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 55.76it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 57.82it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 59.20it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.21it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 58.11it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.81it/s]backtest loop:  13%|█▎        | 128/971 [00:02<00:15, 55.22it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:14, 56.31it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 55.00it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 57.12it/s]backtest loop:  16%|█▌        | 155/971 [00:02<00:13, 58.62it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 55.77it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:13, 57.97it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:13, 60.20it/s]backtest loop:  19%|█▊        | 182/971 [00:03<00:13, 57.45it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:13, 58.90it/s]backtest loop:  20%|██        | 195/971 [00:03<00:13, 56.18it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 58.19it/s]backtest loop:  22%|██▏       | 209/971 [00:03<00:12, 59.74it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 54.55it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:19, 38.41it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:17, 43.60it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:16, 45.06it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:14, 49.36it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:14, 50.49it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:13, 54.53it/s]backtest loop:  27%|██▋       | 263/971 [00:05<00:12, 57.06it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:12, 54.93it/s]backtest loop:  28%|██▊       | 275/971 [00:05<00:12, 56.20it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:12, 54.14it/s]backtest loop:  30%|██▉       | 288/971 [00:05<00:12, 56.49it/s]backtest loop:  30%|███       | 295/971 [00:05<00:12, 55.98it/s]backtest loop:  31%|███       | 302/971 [00:05<00:11, 58.23it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 59.52it/s]backtest loop:  32%|███▏      | 315/971 [00:05<00:11, 56.42it/s]backtest loop:  33%|███▎      | 322/971 [00:06<00:11, 58.21it/s]backtest loop:  34%|███▍      | 329/971 [00:06<00:10, 59.49it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:11, 56.36it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:10, 58.13it/s]backtest loop:  36%|███▌      | 349/971 [00:06<00:10, 59.52it/s]backtest loop:  37%|███▋      | 355/971 [00:06<00:10, 56.38it/s]backtest loop:  37%|███▋      | 362/971 [00:06<00:10, 58.87it/s]backtest loop:  38%|███▊      | 368/971 [00:06<00:11, 52.95it/s]backtest loop:  39%|███▊      | 375/971 [00:06<00:10, 55.53it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:10, 56.66it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:10, 55.27it/s]backtest loop:  41%|████      | 395/971 [00:07<00:10, 57.44it/s]backtest loop:  41%|████▏     | 402/971 [00:07<00:09, 58.86it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:10, 56.02it/s]backtest loop:  43%|████▎     | 414/971 [00:07<00:09, 57.06it/s]backtest loop:  43%|████▎     | 421/971 [00:07<00:09, 58.68it/s]backtest loop:  44%|████▍     | 428/971 [00:07<00:09, 56.45it/s]backtest loop:  45%|████▍     | 434/971 [00:08<00:09, 57.39it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 58.87it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 55.82it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:08, 57.91it/s]backtest loop:  47%|████▋     | 461/971 [00:08<00:08, 59.25it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:08, 56.16it/s]backtest loop:  49%|████▊     | 473/971 [00:08<00:08, 57.16it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 57.83it/s]backtest loop:  50%|█████     | 486/971 [00:08<00:08, 59.15it/s]backtest loop:  51%|█████     | 492/971 [00:09<00:08, 55.79it/s]backtest loop:  51%|█████▏    | 498/971 [00:09<00:08, 55.33it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:08, 55.30it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:08, 51.89it/s]backtest loop:  53%|█████▎    | 516/971 [00:09<00:08, 52.91it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:08, 50.51it/s]backtest loop:  54%|█████▍    | 528/971 [00:09<00:08, 51.67it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:08, 52.97it/s]backtest loop:  56%|█████▌    | 540/971 [00:09<00:08, 53.60it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:08, 50.64it/s]backtest loop:  57%|█████▋    | 552/971 [00:10<00:08, 51.74it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 52.71it/s]backtest loop:  58%|█████▊    | 564/971 [00:10<00:07, 53.40it/s]backtest loop:  59%|█████▊    | 570/971 [00:10<00:07, 54.25it/s]backtest loop:  59%|█████▉    | 576/971 [00:10<00:07, 52.17it/s]backtest loop:  60%|█████▉    | 582/971 [00:10<00:07, 53.34it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:07, 53.99it/s]backtest loop:  61%|██████    | 594/971 [00:10<00:06, 54.33it/s]backtest loop:  62%|██████▏   | 600/971 [00:11<00:07, 51.25it/s]backtest loop:  62%|██████▏   | 606/971 [00:11<00:06, 52.33it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 53.17it/s]backtest loop:  64%|██████▎   | 618/971 [00:11<00:06, 53.87it/s]backtest loop:  64%|██████▍   | 624/971 [00:11<00:06, 54.02it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:06, 50.95it/s]backtest loop:  65%|██████▌   | 636/971 [00:11<00:06, 52.39it/s]backtest loop:  66%|██████▌   | 642/971 [00:11<00:06, 53.30it/s]backtest loop:  67%|██████▋   | 648/971 [00:11<00:05, 53.94it/s]backtest loop:  67%|██████▋   | 654/971 [00:12<00:05, 54.18it/s]backtest loop:  68%|██████▊   | 660/971 [00:12<00:06, 51.19it/s]backtest loop:  69%|██████▊   | 666/971 [00:12<00:05, 52.26it/s]backtest loop:  69%|██████▉   | 672/971 [00:12<00:05, 52.86it/s]backtest loop:  70%|██████▉   | 678/971 [00:12<00:05, 53.49it/s]backtest loop:  70%|███████   | 684/971 [00:12<00:05, 50.58it/s]backtest loop:  71%|███████   | 690/971 [00:12<00:05, 51.84it/s]backtest loop:  72%|███████▏  | 696/971 [00:12<00:05, 52.38it/s]backtest loop:  72%|███████▏  | 702/971 [00:13<00:05, 53.25it/s]backtest loop:  73%|███████▎  | 708/971 [00:13<00:04, 53.79it/s]backtest loop:  74%|███████▎  | 714/971 [00:13<00:05, 50.88it/s]backtest loop:  74%|███████▍  | 720/971 [00:13<00:04, 51.95it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 52.94it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 50.34it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 48.69it/s]backtest loop:  77%|███████▋  | 744/971 [00:13<00:04, 50.39it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 48.67it/s]backtest loop:  78%|███████▊  | 756/971 [00:14<00:04, 50.57it/s]backtest loop:  78%|███████▊  | 762/971 [00:14<00:04, 51.71it/s]backtest loop:  79%|███████▉  | 768/971 [00:14<00:03, 52.62it/s]backtest loop:  80%|███████▉  | 774/971 [00:14<00:03, 53.34it/s]backtest loop:  80%|████████  | 780/971 [00:14<00:03, 50.72it/s]backtest loop:  81%|████████  | 786/971 [00:14<00:03, 52.57it/s]backtest loop:  82%|████████▏ | 792/971 [00:14<00:03, 53.47it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 50.70it/s]backtest loop:  83%|████████▎ | 804/971 [00:15<00:03, 51.90it/s]backtest loop:  83%|████████▎ | 810/971 [00:15<00:03, 52.59it/s]backtest loop:  84%|████████▍ | 816/971 [00:15<00:02, 53.24it/s]backtest loop:  85%|████████▍ | 822/971 [00:15<00:02, 53.82it/s]backtest loop:  85%|████████▌ | 828/971 [00:15<00:02, 50.92it/s]backtest loop:  86%|████████▌ | 834/971 [00:15<00:02, 52.10it/s]backtest loop:  87%|████████▋ | 840/971 [00:15<00:02, 53.00it/s]backtest loop:  87%|████████▋ | 846/971 [00:15<00:02, 53.65it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 50.81it/s]backtest loop:  88%|████████▊ | 858/971 [00:16<00:02, 51.79it/s]backtest loop:  89%|████████▉ | 864/971 [00:16<00:02, 52.66it/s]backtest loop:  90%|████████▉ | 870/971 [00:16<00:01, 53.32it/s]backtest loop:  90%|█████████ | 876/971 [00:16<00:01, 53.83it/s]backtest loop:  91%|█████████ | 882/971 [00:16<00:01, 51.00it/s]backtest loop:  91%|█████████▏| 888/971 [00:16<00:01, 52.11it/s]backtest loop:  92%|█████████▏| 894/971 [00:16<00:01, 52.91it/s]backtest loop:  93%|█████████▎| 900/971 [00:16<00:01, 53.60it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 53.87it/s]backtest loop:  94%|█████████▍| 912/971 [00:17<00:01, 51.01it/s]backtest loop:  95%|█████████▍| 918/971 [00:17<00:01, 52.17it/s]backtest loop:  95%|█████████▌| 924/971 [00:17<00:00, 52.92it/s]backtest loop:  96%|█████████▌| 930/971 [00:17<00:00, 53.15it/s]backtest loop:  96%|█████████▋| 936/971 [00:17<00:00, 50.56it/s]backtest loop:  97%|█████████▋| 942/971 [00:17<00:00, 51.86it/s]backtest loop:  98%|█████████▊| 948/971 [00:17<00:00, 52.70it/s]backtest loop:  98%|█████████▊| 954/971 [00:17<00:00, 53.41it/s]backtest loop:  99%|█████████▉| 960/971 [00:17<00:00, 52.03it/s]backtest loop: 100%|█████████▉| 967/971 [00:18<00:00, 55.05it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 53.44it/s]
[3104099:MainThread](2024-04-25 11:07:11,871) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000626
std                0.005041
annualized_return  0.149084
information_ratio  1.917150
max_drawdown      -0.043689
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000428
std                0.005043
annualized_return  0.101907
information_ratio  1.309988
max_drawdown      -0.046613
[3104099:MainThread](2024-04-25 11:07:11,884) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `DoubleEnsemble_crowd_data_csi300_360_rankTrue`.
[3104099:MainThread](2024-04-25 11:07:18,837) INFO - qlib.timer - [log.py:127] - Time cost: 0.011s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.08361817278898007,
                                                    0.09095844033602322,
                                                    0.06730404236767748,
                                                    0.09416335131983414,
                                                    0.07571914736580923,
                                                    0.08445794487843644,
                                                    0.07456149530076366,
                                                    0.10190659295821984],
 '1day.excess_return_with_cost.information_ratio': [1.0806929078780303,
                                                    1.1849094019170558,
                                                    0.878850542100161,
                                                    1.219011521175686,
                                                    0.9635135445975826,
                                                    1.117683589984463,
                                                    0.9604879141926975,
                                                    1.3099879540075643],
 '1day.excess_return_with_cost.max_drawdown': [-0.06696203294657171,
                                               -0.07305297047972394,
                                               -0.06185570741678455,
                                               -0.06632145028511466,
                                               -0.06808610612298839,
                                               -0.05855643317073739,
                                               -0.0719674514614302,
                                               -0.046613121285415005],
 'IC': [0.023874941755380283,
        0.023240012636530968,
        0.022564971340533844,
        0.02347779949429157,
        0.023483012856719807,
        0.02294186329295907,
        0.022553004098026616,
        0.022915817489001317],
 'ICIR': [0.17482656452430498,
          0.17087196550992945,
          0.16481748707638758,
          0.17261255414205035,
          0.1728120275255053,
          0.16796746172163987,
          0.16472172405086566,
          0.16818079954120482],
 'Rank IC': [0.03290767358310547,
             0.03214350726183365,
             0.031119659481776092,
             0.031821060869092255,
             0.03233520808592909,
             0.03216682095633594,
             0.031419529154925824,
             0.031750270146404656],
 'Rank ICIR': [0.24272272204378978,
               0.23868823821747276,
               0.22822531597855578,
               0.23571956793672166,
               0.2380048905903517,
               0.2367800463227247,
               0.23138981309887238,
               0.23363755327516045],
 'mae': [0.8659597564607173,
         0.8661122518523465,
         0.8661860570410561,
         0.8661981567204093,
         0.8661771742546653,
         0.8661068903157573,
         0.8661295321328841,
         0.8661515804859404],
 'mse': [1.0094607797146595,
         1.010206485668107,
         1.0101893411295777,
         1.0101539014774608,
         1.010014981055666,
         1.0101964531009429,
         1.0099105768602996,
         1.0101053462343517]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3104099:MainThread](2024-04-25 11:07:22,112) INFO - qlib.DEnsembleModel - [double_ensemble.py:57] - Double Ensemble Model...
[3104099:MainThread](2024-04-25 11:07:25,065) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name DoubleEnsemble_crowd_data_csi300_360_rankTrue_51.
[3104099:MainThread](2024-04-25 11:07:25,148) INFO - qlib.workflow - [exp.py:258] - Experiment 85 starts running ...
[3104099:MainThread](2024-04-25 11:07:25,168) INFO - qlib.workflow - [recorder.py:341] - Recorder 16bc4054f53f473ca340fe15b341c75b starts running under Experiment 85 ...
[3104099:MainThread](2024-04-25 11:07:29,508) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (1/3)
[20]	train's l2: 0.991261	valid's l2: 0.996549
[40]	train's l2: 0.987821	valid's l2: 0.99677
[60]	train's l2: 0.985726	valid's l2: 0.996906
[80]	train's l2: 0.984089	valid's l2: 0.997054
[100]	train's l2: 0.982619	valid's l2: 0.997148
[120]	train's l2: 0.981068	valid's l2: 0.99714
[3104099:MainThread](2024-04-25 11:08:03,925) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 11:10:20,923) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 11:10:49,471) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 11:23:26,623) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (2/3)
[20]	train's l2: 1.18981	valid's l2: 1.00237
[40]	train's l2: 1.17025	valid's l2: 1.01214
[60]	train's l2: 1.15973	valid's l2: 1.01885
[80]	train's l2: 1.15266	valid's l2: 1.02345
[100]	train's l2: 1.1471	valid's l2: 1.02669
[120]	train's l2: 1.14219	valid's l2: 1.029
[3104099:MainThread](2024-04-25 11:23:46,634) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 11:25:12,918) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 11:25:41,875) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 11:47:05,507) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (3/3)
[20]	train's l2: 1.18137	valid's l2: 0.998947
[40]	train's l2: 1.16758	valid's l2: 1.00417
[60]	train's l2: 1.15954	valid's l2: 1.00788
[80]	train's l2: 1.15416	valid's l2: 1.01019
[100]	train's l2: 1.14919	valid's l2: 1.01209
[120]	train's l2: 1.14451	valid's l2: 1.01345
[3104099:MainThread](2024-04-25 11:47:24,589) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to DoubleEnsemble_crowd_data_csi300_360_rankTrue_51.
[3104099:MainThread](2024-04-25 11:47:24,952) INFO - qlib.workflow - [exp.py:258] - Experiment 77 starts running ...
[3104099:MainThread](2024-04-25 11:47:24,974) INFO - qlib.workflow - [recorder.py:341] - Recorder c8a0b89cef12436da45a4f856e8cf209 starts running under Experiment 77 ...
{'IC': 0.023352999573339625,
 'ICIR': 0.1711733628764009,
 'Rank IC': 0.032170868730050525,
 'Rank ICIR': 0.23660996865187164}
[3104099:MainThread](2024-04-25 11:47:32,740) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3104099:MainThread](2024-04-25 11:48:10,409) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 11:48:10,412) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 11:48:16,319) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f99cb7ca250>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:39,  9.71it/s]backtest loop:   1%|          | 9/971 [00:00<00:37, 25.59it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 38.10it/s]backtest loop:   2%|▏         | 22/971 [00:00<00:23, 41.15it/s]backtest loop:   3%|▎         | 29/971 [00:00<00:20, 44.98it/s]backtest loop:   4%|▎         | 36/971 [00:00<00:18, 50.11it/s]backtest loop:   4%|▍         | 43/971 [00:01<00:17, 53.91it/s]backtest loop:   5%|▌         | 49/971 [00:01<00:17, 52.59it/s]backtest loop:   6%|▌         | 56/971 [00:01<00:16, 55.50it/s]backtest loop:   6%|▋         | 62/971 [00:01<00:16, 53.78it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:15, 56.62it/s]backtest loop:   8%|▊         | 76/971 [00:01<00:15, 58.39it/s]backtest loop:   8%|▊         | 82/971 [00:01<00:15, 55.93it/s]backtest loop:   9%|▉         | 89/971 [00:01<00:15, 58.27it/s]backtest loop:  10%|▉         | 96/971 [00:01<00:14, 59.68it/s]backtest loop:  11%|█         | 103/971 [00:02<00:15, 57.19it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:14, 58.78it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:15, 56.73it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:14, 59.21it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:14, 56.91it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 54.77it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:14, 56.98it/s]backtest loop:  15%|█▌        | 150/971 [00:02<00:14, 58.63it/s]backtest loop:  16%|█▌        | 156/971 [00:02<00:14, 56.04it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:13, 57.95it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:13, 60.10it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:13, 58.10it/s]backtest loop:  19%|█▉        | 184/971 [00:03<00:13, 59.39it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:13, 56.63it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 58.35it/s]backtest loop:  21%|██        | 204/971 [00:03<00:12, 59.84it/s]backtest loop:  22%|██▏       | 211/971 [00:03<00:13, 57.81it/s]backtest loop:  22%|██▏       | 217/971 [00:04<00:13, 55.33it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:19, 38.08it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:17, 41.74it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:15, 46.55it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:14, 50.62it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:14, 50.67it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:13, 54.68it/s]backtest loop:  27%|██▋       | 264/971 [00:05<00:13, 54.13it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:13, 53.58it/s]backtest loop:  29%|██▊       | 277/971 [00:05<00:12, 54.92it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:12, 56.16it/s]backtest loop:  30%|██▉       | 290/971 [00:05<00:11, 58.04it/s]backtest loop:  30%|███       | 296/971 [00:05<00:11, 56.43it/s]backtest loop:  31%|███       | 303/971 [00:05<00:11, 58.63it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:11, 56.37it/s]backtest loop:  33%|███▎      | 317/971 [00:05<00:11, 58.08it/s]backtest loop:  33%|███▎      | 324/971 [00:06<00:10, 59.52it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:11, 56.63it/s]backtest loop:  35%|███▍      | 337/971 [00:06<00:10, 58.32it/s]backtest loop:  35%|███▌      | 344/971 [00:06<00:10, 59.78it/s]backtest loop:  36%|███▌      | 351/971 [00:06<00:10, 57.57it/s]backtest loop:  37%|███▋      | 358/971 [00:06<00:10, 59.08it/s]backtest loop:  37%|███▋      | 364/971 [00:06<00:10, 56.52it/s]backtest loop:  38%|███▊      | 370/971 [00:06<00:11, 54.44it/s]backtest loop:  39%|███▉      | 377/971 [00:07<00:10, 56.76it/s]backtest loop:  39%|███▉      | 383/971 [00:07<00:10, 54.63it/s]backtest loop:  40%|████      | 390/971 [00:07<00:10, 56.92it/s]backtest loop:  41%|████      | 397/971 [00:07<00:09, 58.73it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 55.86it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:09, 57.78it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 59.14it/s]backtest loop:  44%|████▎     | 423/971 [00:07<00:09, 56.17it/s]backtest loop:  44%|████▍     | 430/971 [00:07<00:09, 58.03it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:09, 56.09it/s]backtest loop:  46%|████▌     | 444/971 [00:08<00:09, 57.92it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:08, 59.47it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:09, 56.36it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:08, 58.08it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:08, 59.42it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:08, 56.22it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:08, 58.05it/s]backtest loop:  50%|█████     | 490/971 [00:08<00:08, 55.41it/s]backtest loop:  51%|█████     | 497/971 [00:09<00:08, 57.54it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:07, 59.06it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:08, 56.07it/s]backtest loop:  53%|█████▎    | 517/971 [00:09<00:08, 55.00it/s]backtest loop:  54%|█████▍    | 524/971 [00:09<00:07, 57.22it/s]backtest loop:  55%|█████▍    | 531/971 [00:09<00:07, 55.85it/s]backtest loop:  55%|█████▌    | 538/971 [00:09<00:07, 57.82it/s]backtest loop:  56%|█████▌    | 545/971 [00:09<00:07, 59.11it/s]backtest loop:  57%|█████▋    | 551/971 [00:10<00:07, 56.20it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 58.01it/s]backtest loop:  58%|█████▊    | 565/971 [00:10<00:06, 59.32it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 56.40it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:06, 58.14it/s]backtest loop:  60%|██████    | 585/971 [00:10<00:06, 59.91it/s]backtest loop:  61%|██████    | 592/971 [00:10<00:06, 57.36it/s]backtest loop:  62%|██████▏   | 598/971 [00:10<00:06, 57.97it/s]backtest loop:  62%|██████▏   | 605/971 [00:10<00:06, 56.04it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 57.96it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:05, 59.51it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 56.41it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 58.18it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 59.84it/s]backtest loop:  67%|██████▋   | 646/971 [00:11<00:05, 57.34it/s]backtest loop:  67%|██████▋   | 653/971 [00:11<00:05, 58.83it/s]backtest loop:  68%|██████▊   | 660/971 [00:11<00:05, 56.71it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 58.29it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:05, 56.31it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:04, 58.01it/s]backtest loop:  71%|███████   | 688/971 [00:12<00:04, 59.19it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:04, 56.18it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 58.04it/s]backtest loop:  73%|███████▎  | 708/971 [00:12<00:04, 59.31it/s]backtest loop:  74%|███████▎  | 714/971 [00:12<00:04, 56.32it/s]backtest loop:  74%|███████▍  | 721/971 [00:12<00:04, 58.11it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 59.52it/s]backtest loop:  76%|███████▌  | 734/971 [00:13<00:04, 53.36it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 55.93it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.70it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 53.94it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 56.31it/s]backtest loop:  79%|███████▉  | 769/971 [00:13<00:03, 58.00it/s]backtest loop:  80%|███████▉  | 775/971 [00:13<00:03, 55.46it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 57.68it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 55.56it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.65it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 59.01it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 56.14it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 57.98it/s]backtest loop:  85%|████████▍ | 822/971 [00:14<00:02, 59.29it/s]backtest loop:  85%|████████▌ | 828/971 [00:14<00:02, 56.23it/s]backtest loop:  86%|████████▌ | 835/971 [00:14<00:02, 58.03it/s]backtest loop:  87%|████████▋ | 841/971 [00:15<00:02, 58.54it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 56.34it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:01, 58.08it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 56.02it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 57.80it/s]backtest loop:  90%|█████████ | 876/971 [00:15<00:01, 59.14it/s]backtest loop:  91%|█████████ | 882/971 [00:15<00:01, 56.21it/s]backtest loop:  92%|█████████▏| 889/971 [00:15<00:01, 57.98it/s]backtest loop:  92%|█████████▏| 896/971 [00:16<00:01, 59.29it/s]backtest loop:  93%|█████████▎| 902/971 [00:16<00:01, 56.31it/s]backtest loop:  94%|█████████▎| 909/971 [00:16<00:01, 58.09it/s]backtest loop:  94%|█████████▍| 916/971 [00:16<00:00, 56.14it/s]backtest loop:  95%|█████████▌| 923/971 [00:16<00:00, 57.89it/s]backtest loop:  96%|█████████▌| 930/971 [00:16<00:00, 59.18it/s]backtest loop:  96%|█████████▋| 936/971 [00:16<00:00, 56.18it/s]backtest loop:  97%|█████████▋| 943/971 [00:16<00:00, 58.07it/s]backtest loop:  98%|█████████▊| 950/971 [00:16<00:00, 56.21it/s]backtest loop:  99%|█████████▊| 957/971 [00:17<00:00, 57.98it/s]backtest loop:  99%|█████████▉| 964/971 [00:17<00:00, 59.28it/s]backtest loop: 100%|█████████▉| 970/971 [00:17<00:00, 56.28it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.97it/s]
[3104099:MainThread](2024-04-25 11:48:33,724) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000616
std                0.004969
annualized_return  0.146726
information_ratio  1.913959
max_drawdown      -0.056054
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000418
std                0.004970
annualized_return  0.099580
information_ratio  1.298636
max_drawdown      -0.063128
[3104099:MainThread](2024-04-25 11:48:33,737) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `DoubleEnsemble_crowd_data_csi300_360_rankTrue`.
[3104099:MainThread](2024-04-25 11:48:40,578) INFO - qlib.timer - [log.py:127] - Time cost: 0.005s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.08361817278898007,
                                                    0.09095844033602322,
                                                    0.06730404236767748,
                                                    0.09416335131983414,
                                                    0.07571914736580923,
                                                    0.08445794487843644,
                                                    0.07456149530076366,
                                                    0.10190659295821984,
                                                    0.09957964022517292],
 '1day.excess_return_with_cost.information_ratio': [1.0806929078780303,
                                                    1.1849094019170558,
                                                    0.878850542100161,
                                                    1.219011521175686,
                                                    0.9635135445975826,
                                                    1.117683589984463,
                                                    0.9604879141926975,
                                                    1.3099879540075643,
                                                    1.2986356636826997],
 '1day.excess_return_with_cost.max_drawdown': [-0.06696203294657171,
                                               -0.07305297047972394,
                                               -0.06185570741678455,
                                               -0.06632145028511466,
                                               -0.06808610612298839,
                                               -0.05855643317073739,
                                               -0.0719674514614302,
                                               -0.046613121285415005,
                                               -0.0631278179470598],
 'IC': [0.023874941755380283,
        0.023240012636530968,
        0.022564971340533844,
        0.02347779949429157,
        0.023483012856719807,
        0.02294186329295907,
        0.022553004098026616,
        0.022915817489001317,
        0.023352999573339625],
 'ICIR': [0.17482656452430498,
          0.17087196550992945,
          0.16481748707638758,
          0.17261255414205035,
          0.1728120275255053,
          0.16796746172163987,
          0.16472172405086566,
          0.16818079954120482,
          0.1711733628764009],
 'Rank IC': [0.03290767358310547,
             0.03214350726183365,
             0.031119659481776092,
             0.031821060869092255,
             0.03233520808592909,
             0.03216682095633594,
             0.031419529154925824,
             0.031750270146404656,
             0.032170868730050525],
 'Rank ICIR': [0.24272272204378978,
               0.23868823821747276,
               0.22822531597855578,
               0.23571956793672166,
               0.2380048905903517,
               0.2367800463227247,
               0.23138981309887238,
               0.23363755327516045,
               0.23660996865187164],
 'mae': [0.8659597564607173,
         0.8661122518523465,
         0.8661860570410561,
         0.8661981567204093,
         0.8661771742546653,
         0.8661068903157573,
         0.8661295321328841,
         0.8661515804859404,
         0.8660253148028558],
 'mse': [1.0094607797146595,
         1.010206485668107,
         1.0101893411295777,
         1.0101539014774608,
         1.010014981055666,
         1.0101964531009429,
         1.0099105768602996,
         1.0101053462343517,
         1.0098365533593903]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3104099:MainThread](2024-04-25 11:48:43,848) INFO - qlib.DEnsembleModel - [double_ensemble.py:57] - Double Ensemble Model...
[3104099:MainThread](2024-04-25 11:48:46,813) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name DoubleEnsemble_crowd_data_csi300_360_rankTrue_52.
[3104099:MainThread](2024-04-25 11:48:46,896) INFO - qlib.workflow - [exp.py:258] - Experiment 86 starts running ...
[3104099:MainThread](2024-04-25 11:48:46,911) INFO - qlib.workflow - [recorder.py:341] - Recorder 9fefa0b37ebe43ff9716d0c05013a8c9 starts running under Experiment 86 ...
[3104099:MainThread](2024-04-25 11:48:51,137) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (1/3)
[20]	train's l2: 0.991261	valid's l2: 0.996549
[40]	train's l2: 0.987821	valid's l2: 0.99677
[60]	train's l2: 0.985726	valid's l2: 0.996906
[80]	train's l2: 0.984089	valid's l2: 0.997054
[100]	train's l2: 0.982619	valid's l2: 0.997148
[120]	train's l2: 0.981068	valid's l2: 0.99714
[3104099:MainThread](2024-04-25 11:49:21,088) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 11:51:34,553) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 11:52:03,206) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 12:04:37,101) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (2/3)
[20]	train's l2: 1.18938	valid's l2: 1.00245
[40]	train's l2: 1.17006	valid's l2: 1.01247
[60]	train's l2: 1.15972	valid's l2: 1.0193
[80]	train's l2: 1.15298	valid's l2: 1.02353
[100]	train's l2: 1.14766	valid's l2: 1.02659
[120]	train's l2: 1.14274	valid's l2: 1.02902
[3104099:MainThread](2024-04-25 12:04:54,981) INFO - qlib.DEnsembleModel - [double_ensemble.py:88] - Retrieving loss curve and loss values...
[3104099:MainThread](2024-04-25 12:06:09,895) INFO - qlib.DEnsembleModel - [double_ensemble.py:98] - Sample re-weighting...
[3104099:MainThread](2024-04-25 12:06:38,368) INFO - qlib.DEnsembleModel - [double_ensemble.py:102] - Feature selection...
[3104099:MainThread](2024-04-25 12:27:54,748) INFO - qlib.DEnsembleModel - [double_ensemble.py:81] - Training sub-model: (3/3)
[20]	train's l2: 1.18052	valid's l2: 0.999308
[40]	train's l2: 1.16718	valid's l2: 1.00439
[60]	train's l2: 1.1591	valid's l2: 1.00787
[80]	train's l2: 1.1535	valid's l2: 1.01018
[100]	train's l2: 1.14839	valid's l2: 1.0117
[120]	train's l2: 1.14395	valid's l2: 1.01306
[3104099:MainThread](2024-04-25 12:28:15,606) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to DoubleEnsemble_crowd_data_csi300_360_rankTrue_52.
[3104099:MainThread](2024-04-25 12:28:15,954) INFO - qlib.workflow - [exp.py:258] - Experiment 77 starts running ...
[3104099:MainThread](2024-04-25 12:28:15,978) INFO - qlib.workflow - [recorder.py:341] - Recorder 31e6a915a64e490f904a9511077016e3 starts running under Experiment 77 ...
{'IC': 0.02267056043689711,
 'ICIR': 0.16645036559230006,
 'Rank IC': 0.03174832984499374,
 'Rank ICIR': 0.23517286467314288}
[3104099:MainThread](2024-04-25 12:28:23,675) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3104099:MainThread](2024-04-25 12:29:00,808) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 12:29:00,812) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3104099:MainThread](2024-04-25 12:29:06,759) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f99b312bc70>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:44,  9.25it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 24.71it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:26, 35.41it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.34it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.74it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 48.02it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.26it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.25it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.40it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 56.05it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 53.84it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 56.42it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 58.22it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 55.84it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 57.92it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 59.38it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.32it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 58.10it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.70it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:15, 54.31it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:14, 56.63it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 55.27it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 57.34it/s]backtest loop:  16%|█▌        | 155/971 [00:02<00:13, 59.14it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 56.15it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:13, 58.36it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:13, 60.29it/s]backtest loop:  19%|█▊        | 182/971 [00:03<00:13, 57.27it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:13, 59.13it/s]backtest loop:  20%|██        | 195/971 [00:03<00:13, 56.20it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 58.13it/s]backtest loop:  22%|██▏       | 209/971 [00:03<00:12, 59.49it/s]backtest loop:  22%|██▏       | 215/971 [00:04<00:14, 53.59it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:13, 56.33it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:12, 58.08it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:13, 55.43it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:12, 57.47it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:12, 56.04it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:12, 58.84it/s]backtest loop:  27%|██▋       | 262/971 [00:05<00:18, 37.92it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:17, 39.71it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:15, 44.05it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:14, 48.78it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:13, 49.02it/s]backtest loop:  30%|███       | 293/971 [00:05<00:12, 52.81it/s]backtest loop:  31%|███       | 300/971 [00:05<00:12, 52.72it/s]backtest loop:  32%|███▏      | 307/971 [00:05<00:11, 55.40it/s]backtest loop:  32%|███▏      | 314/971 [00:05<00:11, 57.64it/s]backtest loop:  33%|███▎      | 320/971 [00:06<00:11, 55.12it/s]backtest loop:  34%|███▎      | 326/971 [00:06<00:11, 56.30it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:10, 58.23it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:11, 56.30it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:10, 58.05it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:10, 59.50it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 56.70it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.69it/s]backtest loop:  38%|███▊      | 373/971 [00:07<00:11, 53.78it/s]backtest loop:  39%|███▉      | 379/971 [00:07<00:10, 55.34it/s]backtest loop:  40%|███▉      | 386/971 [00:07<00:10, 57.39it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 55.81it/s]backtest loop:  41%|████      | 400/971 [00:07<00:09, 57.70it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 59.08it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:09, 56.15it/s]backtest loop:  43%|████▎     | 420/971 [00:07<00:09, 57.98it/s]backtest loop:  44%|████▍     | 427/971 [00:07<00:09, 59.31it/s]backtest loop:  45%|████▍     | 433/971 [00:08<00:09, 56.02it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:09, 57.86it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 55.88it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:08, 57.92it/s]backtest loop:  47%|████▋     | 461/971 [00:08<00:08, 59.23it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:08, 56.22it/s]backtest loop:  49%|████▉     | 474/971 [00:08<00:08, 57.96it/s]backtest loop:  50%|████▉     | 481/971 [00:08<00:08, 59.26it/s]backtest loop:  50%|█████     | 487/971 [00:08<00:08, 56.07it/s]backtest loop:  51%|█████     | 494/971 [00:09<00:08, 57.97it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 55.46it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 54.37it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 56.59it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 58.39it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:07, 55.79it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:07, 57.93it/s]backtest loop:  56%|█████▌    | 540/971 [00:09<00:07, 58.10it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 55.39it/s]backtest loop:  57%|█████▋    | 553/971 [00:10<00:07, 57.48it/s]backtest loop:  58%|█████▊    | 560/971 [00:10<00:06, 58.98it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 56.00it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:06, 57.96it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 59.22it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:06, 56.45it/s]backtest loop:  61%|██████    | 593/971 [00:10<00:06, 58.25it/s]backtest loop:  62%|██████▏   | 599/971 [00:10<00:06, 58.30it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:06, 55.47it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 57.63it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:05, 59.14it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 56.04it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 58.03it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 59.87it/s]backtest loop:  67%|██████▋   | 646/971 [00:11<00:05, 57.21it/s]backtest loop:  67%|██████▋   | 652/971 [00:11<00:05, 56.93it/s]backtest loop:  68%|██████▊   | 659/971 [00:11<00:05, 58.51it/s]backtest loop:  68%|██████▊   | 665/971 [00:12<00:05, 55.68it/s]backtest loop:  69%|██████▉   | 672/971 [00:12<00:05, 57.68it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 55.82it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 56.80it/s]backtest loop:  71%|███████▏  | 692/971 [00:12<00:04, 58.44it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 56.38it/s]backtest loop:  73%|███████▎  | 706/971 [00:12<00:04, 58.01it/s]backtest loop:  73%|███████▎  | 713/971 [00:12<00:04, 59.16it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 56.21it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 57.98it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 55.34it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 53.60it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:04, 56.14it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 54.12it/s]backtest loop:  78%|███████▊  | 758/971 [00:13<00:03, 56.47it/s]backtest loop:  79%|███████▉  | 765/971 [00:13<00:03, 55.09it/s]backtest loop:  80%|███████▉  | 772/971 [00:13<00:03, 57.05it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 58.66it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 56.58it/s]backtest loop:  82%|████████▏ | 792/971 [00:14<00:03, 58.39it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 55.62it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:02, 57.57it/s]backtest loop:  84%|████████▎ | 812/971 [00:14<00:02, 59.00it/s]backtest loop:  84%|████████▍ | 818/971 [00:14<00:02, 56.00it/s]backtest loop:  85%|████████▍ | 825/971 [00:14<00:02, 57.87it/s]backtest loop:  86%|████████▌ | 832/971 [00:15<00:02, 59.23it/s]backtest loop:  86%|████████▋ | 838/971 [00:15<00:02, 56.15it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 57.99it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 56.07it/s]backtest loop:  88%|████████▊ | 859/971 [00:15<00:01, 57.91it/s]backtest loop:  89%|████████▉ | 865/971 [00:15<00:01, 57.99it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 55.97it/s]backtest loop:  91%|█████████ | 879/971 [00:15<00:01, 57.77it/s]backtest loop:  91%|█████████ | 886/971 [00:15<00:01, 59.17it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 56.12it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 57.94it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 59.25it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 56.26it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 58.03it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 56.07it/s]backtest loop:  96%|█████████▌| 933/971 [00:16<00:00, 57.96it/s]backtest loop:  97%|█████████▋| 939/971 [00:16<00:00, 58.07it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 55.37it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 57.69it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 59.11it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 56.08it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 56.94it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.63it/s]
[3104099:MainThread](2024-04-25 12:29:24,272) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000531
std                0.004950
annualized_return  0.126429
information_ratio  1.655644
max_drawdown      -0.057379
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000332
std                0.004952
annualized_return  0.079060
information_ratio  1.034937
max_drawdown      -0.064477
[3104099:MainThread](2024-04-25 12:29:24,286) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 77
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'DEnsembleModel', 'module_path': 'qlib.contrib.model.double_ensemble', 'kwargs': {'base_model': 'gbm', 'loss': 'mse', 'num_models': 3, 'enable_sr': True, 'enable_fs': True, 'alpha1': 1, 'alpha2': 1, 'bins_sr': 10, 'bins_fs': 5, 'decay': 0.5, 'sample_ratios': [0.8, 0.7, 0.6, 0.5, 0.4], 'sub_weights': [1, 1, 1], 'epochs': 136, 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20, 'verbosity': -1}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `DoubleEnsemble_crowd_data_csi300_360_rankTrue`.
[3104099:MainThread](2024-04-25 12:29:31,004) INFO - qlib.timer - [log.py:127] - Time cost: 0.012s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.08361817278898007,
                                                    0.09095844033602322,
                                                    0.06730404236767748,
                                                    0.09416335131983414,
                                                    0.07571914736580923,
                                                    0.08445794487843644,
                                                    0.07456149530076366,
                                                    0.10190659295821984,
                                                    0.09957964022517292,
                                                    0.07905976974212546],
 '1day.excess_return_with_cost.information_ratio': [1.0806929078780303,
                                                    1.1849094019170558,
                                                    0.878850542100161,
                                                    1.219011521175686,
                                                    0.9635135445975826,
                                                    1.117683589984463,
                                                    0.9604879141926975,
                                                    1.3099879540075643,
                                                    1.2986356636826997,
                                                    1.0349371895179842],
 '1day.excess_return_with_cost.max_drawdown': [-0.06696203294657171,
                                               -0.07305297047972394,
                                               -0.06185570741678455,
                                               -0.06632145028511466,
                                               -0.06808610612298839,
                                               -0.05855643317073739,
                                               -0.0719674514614302,
                                               -0.046613121285415005,
                                               -0.0631278179470598,
                                               -0.06447659305668935],
 'IC': [0.023874941755380283,
        0.023240012636530968,
        0.022564971340533844,
        0.02347779949429157,
        0.023483012856719807,
        0.02294186329295907,
        0.022553004098026616,
        0.022915817489001317,
        0.023352999573339625,
        0.02267056043689711],
 'ICIR': [0.17482656452430498,
          0.17087196550992945,
          0.16481748707638758,
          0.17261255414205035,
          0.1728120275255053,
          0.16796746172163987,
          0.16472172405086566,
          0.16818079954120482,
          0.1711733628764009,
          0.16645036559230006],
 'Rank IC': [0.03290767358310547,
             0.03214350726183365,
             0.031119659481776092,
             0.031821060869092255,
             0.03233520808592909,
             0.03216682095633594,
             0.031419529154925824,
             0.031750270146404656,
             0.032170868730050525,
             0.03174832984499374],
 'Rank ICIR': [0.24272272204378978,
               0.23868823821747276,
               0.22822531597855578,
               0.23571956793672166,
               0.2380048905903517,
               0.2367800463227247,
               0.23138981309887238,
               0.23363755327516045,
               0.23660996865187164,
               0.23517286467314288],
 'mae': [0.8659597564607173,
         0.8661122518523465,
         0.8661860570410561,
         0.8661981567204093,
         0.8661771742546653,
         0.8661068903157573,
         0.8661295321328841,
         0.8661515804859404,
         0.8660253148028558,
         0.8661711187611664],
 'mse': [1.0094607797146595,
         1.010206485668107,
         1.0101893411295777,
         1.0101539014774608,
         1.010014981055666,
         1.0101964531009429,
         1.0099105768602996,
         1.0101053462343517,
         1.0098365533593903,
         1.0102870271294386]}
[3104099:MainThread](2024-04-25 12:29:31,322) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name final_crowd_data_csi300_360_1_DoubleEnsemble.
[3104099:MainThread](2024-04-25 12:29:31,406) INFO - qlib.workflow - [exp.py:258] - Experiment 87 starts running ...
[3104099:MainThread](2024-04-25 12:29:31,428) INFO - qlib.workflow - [recorder.py:341] - Recorder a0be280cc73c46119cefc57153a69ce0 starts running under Experiment 87 ...
Time cost: 2462.44740421772
{'1day.excess_return_with_cost.annualized_return': [0.08513285972830426,
                                                    0.010786220025273024],
 '1day.excess_return_with_cost.information_ratio': [1.1048710229053924,
                                                    0.14021592191072318],
 '1day.excess_return_with_cost.max_drawdown': [-0.06410196841725149,
                                               0.00716738041396517],
 'IC': [0.02310749829736802, 0.00042447909788952587],
 'ICIR': [0.1694434312560589, 0.0033440592618664924],
 'Rank IC': [0.03195829281144473, 0.0004760387060339039],
 'Rank ICIR': [0.23569509807886635, 0.003801783388008253],
 'mae': [0.8661217832827799, 7.230877711996832e-05],
 'mse': [1.0100361445729895, 0.00023385427750418155]}
[3104099:MainThread](2024-04-25 12:29:31,970) INFO - qlib.timer - [log.py:127] - Time cost: 0.051s | waiting `async_log` Done

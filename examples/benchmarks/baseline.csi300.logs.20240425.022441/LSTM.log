[3063331:MainThread](2024-04-25 03:54:20,235) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[3063331:MainThread](2024-04-25 03:54:20,238) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[3063331:MainThread](2024-04-25 03:54:20,238) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/crowd_data')}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3063331:MainThread](2024-04-25 03:54:25,895) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[3063331:MainThread](2024-04-25 03:54:26,064) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3063331:MainThread](2024-04-25 03:54:31,667) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name LSTM_crowd_data_csi300_360_rankTrue_43.
[3063331:MainThread](2024-04-25 03:54:31,696) INFO - qlib.workflow - [exp.py:258] - Experiment 40 starts running ...
[3063331:MainThread](2024-04-25 03:54:33,289) INFO - qlib.workflow - [recorder.py:341] - Recorder 0eced1b0b23b4e86ab1b13da280dbf64 starts running under Experiment 40 ...
[3063331:MainThread](2024-04-25 03:54:39,138) INFO - qlib.LSTM - [pytorch_lstm.py:261] - training...
[3063331:MainThread](2024-04-25 03:54:39,138) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch0:
[3063331:MainThread](2024-04-25 03:54:39,139) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:54:46,268) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:54:46,491) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997010
[3063331:MainThread](2024-04-25 03:54:46,493) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch1:
[3063331:MainThread](2024-04-25 03:54:46,493) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:54:53,238) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:54:53,455) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997532
[3063331:MainThread](2024-04-25 03:54:53,456) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch2:
[3063331:MainThread](2024-04-25 03:54:53,456) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:54:59,499) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:54:59,716) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997595
[3063331:MainThread](2024-04-25 03:54:59,716) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch3:
[3063331:MainThread](2024-04-25 03:54:59,716) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:55:06,399) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:55:06,616) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.000938
[3063331:MainThread](2024-04-25 03:55:06,616) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch4:
[3063331:MainThread](2024-04-25 03:55:06,617) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:55:13,529) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:55:13,748) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.000874
[3063331:MainThread](2024-04-25 03:55:13,748) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch5:
[3063331:MainThread](2024-04-25 03:55:13,749) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:55:20,611) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:55:20,835) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.001594
[3063331:MainThread](2024-04-25 03:55:20,836) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch6:
[3063331:MainThread](2024-04-25 03:55:20,836) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:55:27,812) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:55:28,030) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.996851
[3063331:MainThread](2024-04-25 03:55:28,031) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch7:
[3063331:MainThread](2024-04-25 03:55:28,032) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:55:34,961) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:55:35,181) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.002138
[3063331:MainThread](2024-04-25 03:55:35,181) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch8:
[3063331:MainThread](2024-04-25 03:55:35,181) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:55:42,125) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:55:42,344) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998008
[3063331:MainThread](2024-04-25 03:55:42,344) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch9:
[3063331:MainThread](2024-04-25 03:55:42,344) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:55:48,939) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:55:49,177) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.001851
[3063331:MainThread](2024-04-25 03:55:49,178) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch10:
[3063331:MainThread](2024-04-25 03:55:49,178) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:55:55,520) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:55:55,737) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998526
[3063331:MainThread](2024-04-25 03:55:55,737) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch11:
[3063331:MainThread](2024-04-25 03:55:55,737) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:56:02,288) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:56:02,524) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997860
[3063331:MainThread](2024-04-25 03:56:02,524) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch12:
[3063331:MainThread](2024-04-25 03:56:02,525) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:56:09,083) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:56:09,302) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998860
[3063331:MainThread](2024-04-25 03:56:09,303) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch13:
[3063331:MainThread](2024-04-25 03:56:09,303) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:56:15,998) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:56:16,224) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998641
[3063331:MainThread](2024-04-25 03:56:16,224) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch14:
[3063331:MainThread](2024-04-25 03:56:16,225) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:56:23,003) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:56:23,219) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.000344
[3063331:MainThread](2024-04-25 03:56:23,220) INFO - qlib.LSTM - [pytorch_lstm.py:283] - early stop
[3063331:MainThread](2024-04-25 03:56:23,220) INFO - qlib.LSTM - [pytorch_lstm.py:286] - best score: -0.996851 @ 6
[3063331:MainThread](2024-04-25 03:56:23,296) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to LSTM_crowd_data_csi300_360_rankTrue_43.
[3063331:MainThread](2024-04-25 03:56:23,746) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name LSTM_crowd_data_csi300_360_rankTrue.
[3063331:MainThread](2024-04-25 03:56:23,777) INFO - qlib.workflow - [exp.py:258] - Experiment 41 starts running ...
[3063331:MainThread](2024-04-25 03:56:23,790) INFO - qlib.workflow - [recorder.py:341] - Recorder e590dbdadb804806b3651d80c5f0bcc9 starts running under Experiment 41 ...
{'IC': 0.029633086614531495,
 'ICIR': 0.23780975049045117,
 'Rank IC': 0.043422656604175304,
 'Rank ICIR': 0.349273660811528}
[3063331:MainThread](2024-04-25 03:56:30,891) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3063331:MainThread](2024-04-25 03:57:05,659) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 03:57:05,662) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 03:57:11,943) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8562d3bf70>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 6/971 [00:00<00:17, 54.01it/s]backtest loop:   1%|          | 12/971 [00:00<00:18, 51.46it/s]backtest loop:   2%|▏         | 19/971 [00:00<00:16, 56.67it/s]backtest loop:   3%|▎         | 25/971 [00:00<00:17, 53.80it/s]backtest loop:   3%|▎         | 32/971 [00:00<00:16, 56.97it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:16, 55.25it/s]backtest loop:   5%|▍         | 46/971 [00:00<00:16, 57.64it/s]backtest loop:   5%|▌         | 53/971 [00:00<00:15, 59.22it/s]backtest loop:   6%|▌         | 59/971 [00:01<00:16, 55.97it/s]backtest loop:   7%|▋         | 66/971 [00:01<00:15, 57.81it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 54.98it/s]backtest loop:   8%|▊         | 78/971 [00:01<00:15, 56.16it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 57.16it/s]backtest loop:   9%|▉         | 90/971 [00:01<00:15, 57.75it/s]backtest loop:  10%|▉         | 97/971 [00:01<00:15, 56.01it/s]backtest loop:  11%|█         | 103/971 [00:01<00:15, 57.07it/s]backtest loop:  11%|█         | 109/971 [00:01<00:14, 57.60it/s]backtest loop:  12%|█▏        | 115/971 [00:02<00:14, 57.96it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 58.54it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:16, 52.03it/s]backtest loop:  14%|█▎        | 133/971 [00:02<00:15, 53.58it/s]backtest loop:  14%|█▍        | 139/971 [00:02<00:15, 52.15it/s]backtest loop:  15%|█▌        | 146/971 [00:02<00:15, 52.27it/s]backtest loop:  16%|█▌        | 153/971 [00:02<00:14, 55.25it/s]backtest loop:  16%|█▋        | 160/971 [00:02<00:14, 57.49it/s]backtest loop:  17%|█▋        | 166/971 [00:02<00:14, 55.15it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:13, 57.44it/s]backtest loop:  19%|█▊        | 180/971 [00:03<00:13, 59.06it/s]backtest loop:  19%|█▉        | 186/971 [00:03<00:13, 56.29it/s]backtest loop:  20%|█▉        | 193/971 [00:03<00:13, 58.36it/s]backtest loop:  21%|██        | 200/971 [00:03<00:13, 56.39it/s]backtest loop:  21%|██▏       | 207/971 [00:03<00:13, 58.50it/s]backtest loop:  22%|██▏       | 213/971 [00:03<00:13, 56.07it/s]backtest loop:  23%|██▎       | 220/971 [00:03<00:13, 55.03it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:12, 57.34it/s]backtest loop:  24%|██▍       | 234/971 [00:04<00:12, 58.94it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:12, 56.26it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:12, 58.10it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:12, 56.98it/s]backtest loop:  27%|██▋       | 261/971 [00:04<00:12, 59.14it/s]backtest loop:  27%|██▋       | 267/971 [00:04<00:12, 56.58it/s]backtest loop:  28%|██▊       | 274/971 [00:04<00:11, 58.70it/s]backtest loop:  29%|██▉       | 281/971 [00:04<00:12, 56.74it/s]backtest loop:  30%|██▉       | 288/971 [00:05<00:11, 58.49it/s]backtest loop:  30%|███       | 295/971 [00:05<00:11, 56.47it/s]backtest loop:  31%|███       | 302/971 [00:05<00:11, 58.43it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 59.68it/s]backtest loop:  33%|███▎      | 316/971 [00:05<00:11, 57.40it/s]backtest loop:  33%|███▎      | 323/971 [00:05<00:11, 58.86it/s]backtest loop:  34%|███▍      | 330/971 [00:05<00:11, 56.80it/s]backtest loop:  35%|███▍      | 337/971 [00:05<00:10, 58.56it/s]backtest loop:  35%|███▌      | 344/971 [00:06<00:10, 59.99it/s]backtest loop:  36%|███▌      | 351/971 [00:06<00:10, 57.90it/s]backtest loop:  37%|███▋      | 358/971 [00:06<00:10, 59.51it/s]backtest loop:  37%|███▋      | 364/971 [00:06<00:10, 57.00it/s]backtest loop:  38%|███▊      | 370/971 [00:06<00:10, 54.74it/s]backtest loop:  39%|███▉      | 377/971 [00:06<00:10, 57.05it/s]backtest loop:  39%|███▉      | 383/971 [00:06<00:10, 54.99it/s]backtest loop:  40%|████      | 390/971 [00:06<00:10, 57.30it/s]backtest loop:  41%|████      | 397/971 [00:06<00:09, 59.44it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 56.53it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:09, 58.72it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 59.73it/s]backtest loop:  44%|████▎     | 423/971 [00:07<00:09, 56.58it/s]backtest loop:  44%|████▍     | 430/971 [00:07<00:09, 58.32it/s]backtest loop:  45%|████▌     | 437/971 [00:07<00:09, 56.31it/s]backtest loop:  46%|████▌     | 444/971 [00:07<00:09, 58.24it/s]backtest loop:  46%|████▋     | 451/971 [00:07<00:08, 59.52it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:09, 56.54it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:08, 58.27it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:08, 59.71it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:08, 56.69it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:08, 58.45it/s]backtest loop:  50%|█████     | 490/971 [00:08<00:08, 55.74it/s]backtest loop:  51%|█████     | 497/971 [00:08<00:08, 57.75it/s]backtest loop:  52%|█████▏    | 504/971 [00:08<00:07, 59.26it/s]backtest loop:  53%|█████▎    | 510/971 [00:08<00:08, 55.45it/s]backtest loop:  53%|█████▎    | 516/971 [00:09<00:08, 54.50it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:08, 51.68it/s]backtest loop:  54%|█████▍    | 528/971 [00:09<00:08, 52.84it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:08, 53.59it/s]backtest loop:  56%|█████▌    | 540/971 [00:09<00:07, 53.97it/s]backtest loop:  56%|█████▌    | 546/971 [00:09<00:08, 51.11it/s]backtest loop:  57%|█████▋    | 552/971 [00:09<00:07, 52.41it/s]backtest loop:  57%|█████▋    | 558/971 [00:09<00:07, 53.16it/s]backtest loop:  58%|█████▊    | 564/971 [00:09<00:07, 53.74it/s]backtest loop:  59%|█████▊    | 570/971 [00:10<00:07, 54.15it/s]backtest loop:  59%|█████▉    | 576/971 [00:10<00:07, 51.20it/s]backtest loop:  60%|█████▉    | 582/971 [00:10<00:07, 52.36it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:07, 53.34it/s]backtest loop:  61%|██████    | 594/971 [00:10<00:06, 53.94it/s]backtest loop:  62%|██████▏   | 600/971 [00:10<00:07, 51.01it/s]backtest loop:  62%|██████▏   | 606/971 [00:10<00:06, 52.31it/s]backtest loop:  63%|██████▎   | 612/971 [00:10<00:06, 53.13it/s]backtest loop:  64%|██████▎   | 618/971 [00:10<00:06, 53.84it/s]backtest loop:  64%|██████▍   | 624/971 [00:11<00:06, 54.27it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:06, 51.52it/s]backtest loop:  65%|██████▌   | 636/971 [00:11<00:06, 52.78it/s]backtest loop:  66%|██████▌   | 642/971 [00:11<00:06, 53.56it/s]backtest loop:  67%|██████▋   | 648/971 [00:11<00:05, 54.10it/s]backtest loop:  67%|██████▋   | 654/971 [00:11<00:05, 54.49it/s]backtest loop:  68%|██████▊   | 660/971 [00:11<00:06, 51.49it/s]backtest loop:  69%|██████▊   | 666/971 [00:11<00:05, 52.60it/s]backtest loop:  69%|██████▉   | 672/971 [00:12<00:05, 53.38it/s]backtest loop:  70%|██████▉   | 678/971 [00:12<00:05, 53.90it/s]backtest loop:  70%|███████   | 684/971 [00:12<00:05, 50.93it/s]backtest loop:  71%|███████   | 690/971 [00:12<00:05, 52.17it/s]backtest loop:  72%|███████▏  | 696/971 [00:12<00:05, 53.09it/s]backtest loop:  72%|███████▏  | 702/971 [00:12<00:05, 53.80it/s]backtest loop:  73%|███████▎  | 708/971 [00:12<00:04, 54.17it/s]backtest loop:  74%|███████▎  | 714/971 [00:12<00:05, 51.27it/s]backtest loop:  74%|███████▍  | 720/971 [00:12<00:04, 52.44it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 53.43it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 50.78it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 48.62it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:04, 52.54it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 51.60it/s]backtest loop:  78%|███████▊  | 758/971 [00:13<00:03, 54.73it/s]backtest loop:  79%|███████▉  | 765/971 [00:13<00:03, 53.97it/s]backtest loop:  79%|███████▉  | 771/971 [00:13<00:03, 55.26it/s]backtest loop:  80%|████████  | 778/971 [00:13<00:03, 57.33it/s]backtest loop:  81%|████████  | 784/971 [00:14<00:03, 55.20it/s]backtest loop:  81%|████████▏ | 791/971 [00:14<00:03, 57.27it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 55.59it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:02, 57.54it/s]backtest loop:  84%|████████▎ | 812/971 [00:14<00:02, 59.05it/s]backtest loop:  84%|████████▍ | 818/971 [00:14<00:02, 56.11it/s]backtest loop:  85%|████████▍ | 825/971 [00:14<00:02, 57.94it/s]backtest loop:  86%|████████▌ | 832/971 [00:14<00:02, 59.26it/s]backtest loop:  86%|████████▋ | 838/971 [00:15<00:02, 56.18it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 57.97it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 56.10it/s]backtest loop:  88%|████████▊ | 859/971 [00:15<00:01, 57.85it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 59.23it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 56.41it/s]backtest loop:  90%|█████████ | 878/971 [00:15<00:01, 57.36it/s]backtest loop:  91%|█████████ | 885/971 [00:15<00:01, 58.92it/s]backtest loop:  92%|█████████▏| 892/971 [00:15<00:01, 56.64it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 58.31it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 59.54it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 56.46it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 58.22it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 56.19it/s]backtest loop:  96%|█████████▌| 933/971 [00:16<00:00, 57.95it/s]backtest loop:  97%|█████████▋| 940/971 [00:16<00:00, 56.08it/s]backtest loop:  98%|█████████▊| 947/971 [00:16<00:00, 57.88it/s]backtest loop:  98%|█████████▊| 953/971 [00:17<00:00, 57.90it/s]backtest loop:  99%|█████████▉| 960/971 [00:17<00:00, 55.87it/s]backtest loop:  99%|█████████▉| 966/971 [00:17<00:00, 56.89it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.92it/s]
[3063331:MainThread](2024-04-25 03:57:29,366) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000445
std                0.004666
annualized_return  0.106001
information_ratio  1.472610
max_drawdown      -0.055896
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000248
std                0.004666
annualized_return  0.058918
information_ratio  0.818426
max_drawdown      -0.078462
[3063331:MainThread](2024-04-25 03:57:29,380) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `LSTM_crowd_data_csi300_360_rankTrue`.
[3063331:MainThread](2024-04-25 03:57:36,568) INFO - qlib.timer - [log.py:127] - Time cost: 0.007s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.05891823804012103],
 '1day.excess_return_with_cost.information_ratio': [0.8184259048224443],
 '1day.excess_return_with_cost.max_drawdown': [-0.07846232143476412],
 'IC': [0.029633086614531495],
 'ICIR': [0.23780975049045117],
 'Rank IC': [0.043422656604175304],
 'Rank ICIR': [0.349273660811528],
 'mae': [0.8636513547094068],
 'mse': [0.997057058270892]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3063331:MainThread](2024-04-25 03:57:39,743) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[3063331:MainThread](2024-04-25 03:57:39,743) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3063331:MainThread](2024-04-25 03:57:42,599) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name LSTM_crowd_data_csi300_360_rankTrue_44.
[3063331:MainThread](2024-04-25 03:57:42,629) INFO - qlib.workflow - [exp.py:258] - Experiment 42 starts running ...
[3063331:MainThread](2024-04-25 03:57:42,645) INFO - qlib.workflow - [recorder.py:341] - Recorder 8fa478e2ab244972a571c42d9b1da096 starts running under Experiment 42 ...
[3063331:MainThread](2024-04-25 03:57:48,627) INFO - qlib.LSTM - [pytorch_lstm.py:261] - training...
[3063331:MainThread](2024-04-25 03:57:48,628) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch0:
[3063331:MainThread](2024-04-25 03:57:48,628) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:57:55,482) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:57:55,690) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.000056
[3063331:MainThread](2024-04-25 03:57:55,691) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch1:
[3063331:MainThread](2024-04-25 03:57:55,691) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:58:02,686) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:58:02,895) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997458
[3063331:MainThread](2024-04-25 03:58:02,897) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch2:
[3063331:MainThread](2024-04-25 03:58:02,897) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:58:09,682) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:58:09,882) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.996645
[3063331:MainThread](2024-04-25 03:58:09,883) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch3:
[3063331:MainThread](2024-04-25 03:58:09,884) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:58:16,286) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:58:16,487) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.000322
[3063331:MainThread](2024-04-25 03:58:16,488) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch4:
[3063331:MainThread](2024-04-25 03:58:16,488) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:58:22,858) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:58:23,068) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997025
[3063331:MainThread](2024-04-25 03:58:23,069) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch5:
[3063331:MainThread](2024-04-25 03:58:23,069) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:58:29,966) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:58:30,174) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999708
[3063331:MainThread](2024-04-25 03:58:30,174) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch6:
[3063331:MainThread](2024-04-25 03:58:30,174) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:58:36,823) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:58:37,023) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.000633
[3063331:MainThread](2024-04-25 03:58:37,024) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch7:
[3063331:MainThread](2024-04-25 03:58:37,024) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:58:43,811) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:58:44,018) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.002665
[3063331:MainThread](2024-04-25 03:58:44,019) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch8:
[3063331:MainThread](2024-04-25 03:58:44,019) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:58:50,917) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:58:51,124) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.001864
[3063331:MainThread](2024-04-25 03:58:51,125) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch9:
[3063331:MainThread](2024-04-25 03:58:51,125) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:58:58,173) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:58:58,382) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.000337
[3063331:MainThread](2024-04-25 03:58:58,383) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch10:
[3063331:MainThread](2024-04-25 03:58:58,383) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 03:59:04,924) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 03:59:05,125) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999533
[3063331:MainThread](2024-04-25 03:59:05,125) INFO - qlib.LSTM - [pytorch_lstm.py:283] - early stop
[3063331:MainThread](2024-04-25 03:59:05,125) INFO - qlib.LSTM - [pytorch_lstm.py:286] - best score: -0.996645 @ 2
[3063331:MainThread](2024-04-25 03:59:05,146) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to LSTM_crowd_data_csi300_360_rankTrue_44.
[3063331:MainThread](2024-04-25 03:59:05,422) INFO - qlib.workflow - [exp.py:258] - Experiment 41 starts running ...
[3063331:MainThread](2024-04-25 03:59:05,436) INFO - qlib.workflow - [recorder.py:341] - Recorder a4c5fd1ddebc4b6abd9bdd7f5b413009 starts running under Experiment 41 ...
{'IC': 0.02574694121661612,
 'ICIR': 0.2141330839585906,
 'Rank IC': 0.03218351845141216,
 'Rank ICIR': 0.26258111504674114}
[3063331:MainThread](2024-04-25 03:59:11,678) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3063331:MainThread](2024-04-25 03:59:47,621) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 03:59:47,624) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 03:59:53,692) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8507a5ea90>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:43,  9.31it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.20it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 34.07it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 38.06it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 43.03it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 46.53it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 46.11it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:18, 48.80it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 50.74it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 48.99it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 51.03it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 52.40it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 53.54it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 54.79it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 51.54it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 52.79it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 53.48it/s]backtest loop:  11%|█         | 105/971 [00:02<00:16, 54.10it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:15, 54.61it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 51.62it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:15, 53.01it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:16, 50.61it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:15, 52.55it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:16, 50.35it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:15, 51.88it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 52.94it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 53.70it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:14, 54.38it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 52.19it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:14, 53.48it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 54.21it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:14, 54.82it/s]backtest loop:  20%|██        | 195/971 [00:03<00:14, 51.76it/s]backtest loop:  21%|██        | 201/971 [00:04<00:14, 52.88it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:14, 53.77it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:14, 51.42it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:14, 52.63it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:22, 32.93it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:19, 37.25it/s]backtest loop:  25%|██▍       | 238/971 [00:04<00:17, 43.03it/s]backtest loop:  25%|██▌       | 245/971 [00:05<00:15, 45.61it/s]backtest loop:  26%|██▌       | 252/971 [00:05<00:14, 49.84it/s]backtest loop:  27%|██▋       | 259/971 [00:05<00:14, 50.72it/s]backtest loop:  27%|██▋       | 266/971 [00:05<00:13, 51.18it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 54.46it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:12, 55.61it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 54.55it/s]backtest loop:  30%|███       | 293/971 [00:05<00:11, 56.76it/s]backtest loop:  31%|███       | 300/971 [00:06<00:12, 55.40it/s]backtest loop:  32%|███▏      | 307/971 [00:06<00:11, 57.60it/s]backtest loop:  32%|███▏      | 314/971 [00:06<00:11, 59.33it/s]backtest loop:  33%|███▎      | 320/971 [00:06<00:11, 56.08it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:11, 57.99it/s]backtest loop:  34%|███▍      | 334/971 [00:06<00:10, 59.57it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:11, 56.66it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:10, 58.54it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:10, 59.96it/s]backtest loop:  37%|███▋      | 361/971 [00:07<00:10, 57.77it/s]backtest loop:  38%|███▊      | 367/971 [00:07<00:11, 54.64it/s]backtest loop:  38%|███▊      | 373/971 [00:07<00:11, 53.00it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:10, 55.59it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 57.55it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 55.18it/s]backtest loop:  41%|████      | 400/971 [00:07<00:09, 57.23it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 59.35it/s]backtest loop:  43%|████▎     | 413/971 [00:08<00:09, 56.16it/s]backtest loop:  43%|████▎     | 419/971 [00:08<00:09, 57.18it/s]backtest loop:  44%|████▍     | 426/971 [00:08<00:09, 58.87it/s]backtest loop:  44%|████▍     | 432/971 [00:08<00:09, 55.94it/s]backtest loop:  45%|████▌     | 439/971 [00:08<00:09, 57.89it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:08, 59.85it/s]backtest loop:  47%|████▋     | 453/971 [00:08<00:09, 57.27it/s]backtest loop:  47%|████▋     | 460/971 [00:08<00:08, 58.22it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:08, 56.19it/s]backtest loop:  49%|████▉     | 474/971 [00:09<00:08, 58.01it/s]backtest loop:  50%|████▉     | 481/971 [00:09<00:08, 59.28it/s]backtest loop:  50%|█████     | 487/971 [00:09<00:08, 56.33it/s]backtest loop:  51%|█████     | 494/971 [00:09<00:08, 58.26it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 55.53it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 54.27it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 56.54it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 58.31it/s]backtest loop:  54%|█████▍    | 527/971 [00:10<00:07, 55.71it/s]backtest loop:  55%|█████▍    | 534/971 [00:10<00:07, 57.99it/s]backtest loop:  56%|█████▌    | 541/971 [00:10<00:07, 56.17it/s]backtest loop:  56%|█████▋    | 547/971 [00:10<00:07, 57.15it/s]backtest loop:  57%|█████▋    | 553/971 [00:10<00:07, 57.38it/s]backtest loop:  58%|█████▊    | 560/971 [00:10<00:06, 58.94it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 55.90it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:06, 57.91it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 59.32it/s]backtest loop:  60%|██████    | 586/971 [00:11<00:06, 56.24it/s]backtest loop:  61%|██████    | 593/971 [00:11<00:06, 58.10it/s]backtest loop:  62%|██████▏   | 600/971 [00:11<00:06, 56.15it/s]backtest loop:  62%|██████▏   | 606/971 [00:11<00:06, 56.98it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 57.74it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:05, 59.36it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 56.21it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 58.45it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 60.13it/s]backtest loop:  67%|██████▋   | 646/971 [00:12<00:05, 57.45it/s]backtest loop:  67%|██████▋   | 653/971 [00:12<00:05, 59.01it/s]backtest loop:  68%|██████▊   | 660/971 [00:12<00:05, 56.83it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 58.44it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:05, 56.46it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:04, 58.17it/s]backtest loop:  71%|███████   | 687/971 [00:12<00:04, 58.58it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:04, 56.42it/s]backtest loop:  72%|███████▏  | 701/971 [00:13<00:04, 58.23it/s]backtest loop:  73%|███████▎  | 708/971 [00:13<00:04, 59.50it/s]backtest loop:  74%|███████▎  | 714/971 [00:13<00:04, 56.23it/s]backtest loop:  74%|███████▍  | 721/971 [00:13<00:04, 58.08it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 59.50it/s]backtest loop:  76%|███████▌  | 734/971 [00:13<00:04, 53.33it/s]backtest loop:  76%|███████▌  | 740/971 [00:13<00:04, 54.86it/s]backtest loop:  77%|███████▋  | 747/971 [00:13<00:03, 57.12it/s]backtest loop:  78%|███████▊  | 753/971 [00:13<00:03, 54.68it/s]backtest loop:  78%|███████▊  | 760/971 [00:14<00:03, 53.87it/s]backtest loop:  79%|███████▉  | 767/971 [00:14<00:03, 56.22it/s]backtest loop:  80%|███████▉  | 774/971 [00:14<00:03, 57.98it/s]backtest loop:  80%|████████  | 780/971 [00:14<00:03, 55.37it/s]backtest loop:  81%|████████  | 787/971 [00:14<00:03, 57.40it/s]backtest loop:  82%|████████▏ | 793/971 [00:14<00:03, 55.21it/s]backtest loop:  82%|████████▏ | 800/971 [00:14<00:02, 57.33it/s]backtest loop:  83%|████████▎ | 807/971 [00:14<00:02, 58.78it/s]backtest loop:  84%|████████▎ | 813/971 [00:15<00:02, 55.89it/s]backtest loop:  84%|████████▍ | 820/971 [00:15<00:02, 57.92it/s]backtest loop:  85%|████████▌ | 827/971 [00:15<00:02, 59.30it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 56.27it/s]backtest loop:  87%|████████▋ | 840/971 [00:15<00:02, 58.07it/s]backtest loop:  87%|████████▋ | 847/971 [00:15<00:02, 59.42it/s]backtest loop:  88%|████████▊ | 853/971 [00:15<00:02, 56.31it/s]backtest loop:  89%|████████▊ | 860/971 [00:15<00:01, 58.22it/s]backtest loop:  89%|████████▉ | 867/971 [00:15<00:01, 56.19it/s]backtest loop:  90%|█████████ | 874/971 [00:16<00:01, 58.01it/s]backtest loop:  91%|█████████ | 881/971 [00:16<00:01, 59.31it/s]backtest loop:  91%|█████████▏| 887/971 [00:16<00:01, 56.33it/s]backtest loop:  92%|█████████▏| 894/971 [00:16<00:01, 58.13it/s]backtest loop:  93%|█████████▎| 901/971 [00:16<00:01, 59.52it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 56.56it/s]backtest loop:  94%|█████████▍| 914/971 [00:16<00:00, 58.27it/s]backtest loop:  95%|█████████▍| 921/971 [00:16<00:00, 56.31it/s]backtest loop:  96%|█████████▌| 928/971 [00:17<00:00, 58.12it/s]backtest loop:  96%|█████████▋| 935/971 [00:17<00:00, 59.29it/s]backtest loop:  97%|█████████▋| 941/971 [00:17<00:00, 56.28it/s]backtest loop:  98%|█████████▊| 948/971 [00:17<00:00, 58.11it/s]backtest loop:  98%|█████████▊| 955/971 [00:17<00:00, 56.18it/s]backtest loop:  99%|█████████▉| 962/971 [00:17<00:00, 58.00it/s]backtest loop: 100%|█████████▉| 969/971 [00:17<00:00, 59.33it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.60it/s]
[3063331:MainThread](2024-04-25 04:00:11,537) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000294
std                0.004942
annualized_return  0.069972
information_ratio  0.917794
max_drawdown      -0.069770
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000096
std                0.004943
annualized_return  0.022927
information_ratio  0.300642
max_drawdown      -0.105709
[3063331:MainThread](2024-04-25 04:00:11,550) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `LSTM_crowd_data_csi300_360_rankTrue`.
[3063331:MainThread](2024-04-25 04:00:18,405) INFO - qlib.timer - [log.py:127] - Time cost: 0.007s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.05891823804012103,
                                                    0.022926572555685015],
 '1day.excess_return_with_cost.information_ratio': [0.8184259048224443,
                                                    0.30064223245350585],
 '1day.excess_return_with_cost.max_drawdown': [-0.07846232143476412,
                                               -0.10570945240542111],
 'IC': [0.029633086614531495, 0.02574694121661612],
 'ICIR': [0.23780975049045117, 0.2141330839585906],
 'Rank IC': [0.043422656604175304, 0.03218351845141216],
 'Rank ICIR': [0.349273660811528, 0.26258111504674114],
 'mae': [0.8636513547094068, 0.864254717184863],
 'mse': [0.997057058270892, 0.9974504140999779]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3063331:MainThread](2024-04-25 04:00:21,596) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[3063331:MainThread](2024-04-25 04:00:21,597) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3063331:MainThread](2024-04-25 04:00:24,468) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name LSTM_crowd_data_csi300_360_rankTrue_45.
[3063331:MainThread](2024-04-25 04:00:24,499) INFO - qlib.workflow - [exp.py:258] - Experiment 43 starts running ...
[3063331:MainThread](2024-04-25 04:00:24,510) INFO - qlib.workflow - [recorder.py:341] - Recorder 736ccc2ce55b497a87558db97209731a starts running under Experiment 43 ...
[3063331:MainThread](2024-04-25 04:00:30,383) INFO - qlib.LSTM - [pytorch_lstm.py:261] - training...
[3063331:MainThread](2024-04-25 04:00:30,383) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch0:
[3063331:MainThread](2024-04-25 04:00:30,383) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:00:37,295) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:00:37,498) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997077
[3063331:MainThread](2024-04-25 04:00:37,500) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch1:
[3063331:MainThread](2024-04-25 04:00:37,500) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:00:44,367) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:00:44,577) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997474
[3063331:MainThread](2024-04-25 04:00:44,577) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch2:
[3063331:MainThread](2024-04-25 04:00:44,577) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:00:51,452) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:00:51,655) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998585
[3063331:MainThread](2024-04-25 04:00:51,655) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch3:
[3063331:MainThread](2024-04-25 04:00:51,656) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:00:58,604) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:00:58,808) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.001164
[3063331:MainThread](2024-04-25 04:00:58,809) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch4:
[3063331:MainThread](2024-04-25 04:00:58,809) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:01:05,468) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:01:05,668) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997725
[3063331:MainThread](2024-04-25 04:01:05,669) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch5:
[3063331:MainThread](2024-04-25 04:01:05,669) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:01:12,519) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:01:12,722) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.004714
[3063331:MainThread](2024-04-25 04:01:12,722) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch6:
[3063331:MainThread](2024-04-25 04:01:12,723) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:01:19,363) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:01:19,572) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998154
[3063331:MainThread](2024-04-25 04:01:19,573) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch7:
[3063331:MainThread](2024-04-25 04:01:19,573) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:01:26,204) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:01:26,403) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999459
[3063331:MainThread](2024-04-25 04:01:26,404) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch8:
[3063331:MainThread](2024-04-25 04:01:26,404) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:01:32,837) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:01:33,040) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.002110
[3063331:MainThread](2024-04-25 04:01:33,040) INFO - qlib.LSTM - [pytorch_lstm.py:283] - early stop
[3063331:MainThread](2024-04-25 04:01:33,041) INFO - qlib.LSTM - [pytorch_lstm.py:286] - best score: -0.997077 @ 0
[3063331:MainThread](2024-04-25 04:01:33,062) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to LSTM_crowd_data_csi300_360_rankTrue_45.
[3063331:MainThread](2024-04-25 04:01:33,336) INFO - qlib.workflow - [exp.py:258] - Experiment 41 starts running ...
[3063331:MainThread](2024-04-25 04:01:33,350) INFO - qlib.workflow - [recorder.py:341] - Recorder 3d1e2803d62944e5a4ddafa93875c581 starts running under Experiment 41 ...
{'IC': 0.013315832589728332,
 'ICIR': 0.09240673096781117,
 'Rank IC': 0.016324296576641695,
 'Rank ICIR': 0.10110355733504273}
[3063331:MainThread](2024-04-25 04:01:39,688) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3063331:MainThread](2024-04-25 04:02:16,221) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 04:02:16,224) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 04:02:22,165) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8567ccac70>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:40,  9.65it/s]backtest loop:   1%|          | 10/971 [00:00<00:34, 27.60it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:25, 36.74it/s]backtest loop:   2%|▏         | 23/971 [00:00<00:22, 42.74it/s]backtest loop:   3%|▎         | 29/971 [00:00<00:20, 45.01it/s]backtest loop:   4%|▎         | 36/971 [00:00<00:18, 50.25it/s]backtest loop:   4%|▍         | 43/971 [00:01<00:17, 54.13it/s]backtest loop:   5%|▌         | 49/971 [00:01<00:17, 52.92it/s]backtest loop:   6%|▌         | 56/971 [00:01<00:16, 55.64it/s]backtest loop:   6%|▋         | 62/971 [00:01<00:16, 53.85it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:15, 56.99it/s]backtest loop:   8%|▊         | 76/971 [00:01<00:15, 59.26it/s]backtest loop:   9%|▊         | 83/971 [00:01<00:15, 57.18it/s]backtest loop:   9%|▉         | 90/971 [00:01<00:15, 58.62it/s]backtest loop:  10%|▉         | 97/971 [00:01<00:15, 56.70it/s]backtest loop:  11%|█         | 104/971 [00:02<00:14, 58.41it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:14, 59.85it/s]backtest loop:  12%|█▏        | 118/971 [00:02<00:14, 57.55it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 55.85it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 54.15it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:14, 56.74it/s]backtest loop:  15%|█▍        | 145/971 [00:02<00:14, 58.44it/s]backtest loop:  16%|█▌        | 151/971 [00:02<00:14, 55.86it/s]backtest loop:  16%|█▌        | 157/971 [00:03<00:14, 56.89it/s]backtest loop:  17%|█▋        | 164/971 [00:03<00:13, 58.59it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:14, 56.90it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:13, 58.99it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:13, 57.01it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:13, 58.76it/s]backtest loop:  20%|██        | 199/971 [00:03<00:12, 60.09it/s]backtest loop:  21%|██        | 206/971 [00:03<00:13, 57.84it/s]backtest loop:  22%|██▏       | 213/971 [00:03<00:13, 56.61it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 55.47it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:19, 38.94it/s]backtest loop:  24%|██▍       | 234/971 [00:04<00:16, 43.98it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:16, 45.39it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:14, 49.48it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:14, 50.31it/s]backtest loop:  27%|██▋       | 261/971 [00:04<00:13, 53.48it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:13, 52.62it/s]backtest loop:  28%|██▊       | 274/971 [00:05<00:12, 55.42it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:12, 56.44it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 53.57it/s]backtest loop:  30%|███       | 293/971 [00:05<00:11, 56.61it/s]backtest loop:  31%|███       | 300/971 [00:05<00:11, 56.30it/s]backtest loop:  32%|███▏      | 307/971 [00:05<00:11, 58.27it/s]backtest loop:  32%|███▏      | 313/971 [00:05<00:11, 58.52it/s]backtest loop:  33%|███▎      | 319/971 [00:05<00:11, 58.90it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:11, 54.83it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:11, 57.48it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 59.53it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 56.40it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 58.04it/s]backtest loop:  37%|███▋      | 359/971 [00:06<00:10, 59.33it/s]backtest loop:  38%|███▊      | 365/971 [00:06<00:10, 56.48it/s]backtest loop:  38%|███▊      | 371/971 [00:06<00:11, 54.52it/s]backtest loop:  39%|███▉      | 378/971 [00:07<00:11, 53.85it/s]backtest loop:  40%|███▉      | 384/971 [00:07<00:10, 55.39it/s]backtest loop:  40%|████      | 391/971 [00:07<00:10, 57.51it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 55.83it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 58.20it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:09, 59.68it/s]backtest loop:  43%|████▎     | 419/971 [00:07<00:09, 56.54it/s]backtest loop:  44%|████▍     | 426/971 [00:07<00:09, 58.30it/s]backtest loop:  44%|████▍     | 432/971 [00:07<00:09, 55.66it/s]backtest loop:  45%|████▌     | 439/971 [00:08<00:09, 57.69it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:08, 59.00it/s]backtest loop:  47%|████▋     | 452/971 [00:08<00:09, 55.89it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:08, 57.88it/s]backtest loop:  48%|████▊     | 466/971 [00:08<00:08, 59.34it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:08, 56.34it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 58.06it/s]backtest loop:  50%|████▉     | 485/971 [00:08<00:08, 58.34it/s]backtest loop:  51%|█████     | 491/971 [00:09<00:08, 55.58it/s]backtest loop:  51%|█████▏    | 498/971 [00:09<00:08, 57.78it/s]backtest loop:  52%|█████▏    | 505/971 [00:09<00:08, 56.22it/s]backtest loop:  53%|█████▎    | 512/971 [00:09<00:08, 54.83it/s]backtest loop:  53%|█████▎    | 518/971 [00:09<00:08, 56.10it/s]backtest loop:  54%|█████▍    | 525/971 [00:09<00:07, 58.11it/s]backtest loop:  55%|█████▍    | 531/971 [00:09<00:07, 55.74it/s]backtest loop:  55%|█████▌    | 538/971 [00:09<00:07, 58.03it/s]backtest loop:  56%|█████▌    | 545/971 [00:09<00:07, 59.32it/s]backtest loop:  57%|█████▋    | 551/971 [00:10<00:07, 55.97it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 57.79it/s]backtest loop:  58%|█████▊    | 565/971 [00:10<00:06, 59.21it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 56.39it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:06, 58.17it/s]backtest loop:  60%|██████    | 585/971 [00:10<00:06, 59.38it/s]backtest loop:  61%|██████    | 591/971 [00:10<00:06, 56.32it/s]backtest loop:  62%|██████▏   | 598/971 [00:10<00:06, 58.15it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:06, 56.21it/s]backtest loop:  63%|██████▎   | 611/971 [00:11<00:06, 57.06it/s]backtest loop:  64%|██████▎   | 617/971 [00:11<00:06, 57.70it/s]backtest loop:  64%|██████▍   | 624/971 [00:11<00:05, 59.44it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:06, 56.38it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:05, 58.34it/s]backtest loop:  66%|██████▋   | 644/971 [00:11<00:05, 59.66it/s]backtest loop:  67%|██████▋   | 650/971 [00:11<00:05, 56.36it/s]backtest loop:  68%|██████▊   | 657/971 [00:11<00:05, 58.44it/s]backtest loop:  68%|██████▊   | 664/971 [00:12<00:05, 60.11it/s]backtest loop:  69%|██████▉   | 671/971 [00:12<00:05, 57.47it/s]backtest loop:  70%|██████▉   | 677/971 [00:12<00:05, 56.58it/s]backtest loop:  70%|███████   | 683/971 [00:12<00:05, 55.68it/s]backtest loop:  71%|███████   | 689/971 [00:12<00:05, 52.28it/s]backtest loop:  72%|███████▏  | 695/971 [00:12<00:05, 53.16it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:05, 53.86it/s]backtest loop:  73%|███████▎  | 707/971 [00:12<00:04, 54.27it/s]backtest loop:  73%|███████▎  | 713/971 [00:12<00:04, 54.46it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 51.50it/s]backtest loop:  75%|███████▍  | 725/971 [00:13<00:04, 52.70it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 50.45it/s]backtest loop:  76%|███████▌  | 737/971 [00:13<00:04, 51.93it/s]backtest loop:  77%|███████▋  | 743/971 [00:13<00:04, 49.59it/s]backtest loop:  77%|███████▋  | 749/971 [00:13<00:04, 51.24it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 49.56it/s]backtest loop:  78%|███████▊  | 761/971 [00:13<00:04, 51.24it/s]backtest loop:  79%|███████▉  | 767/971 [00:13<00:03, 52.39it/s]backtest loop:  80%|███████▉  | 773/971 [00:14<00:03, 53.16it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 53.77it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 51.21it/s]backtest loop:  81%|████████▏ | 791/971 [00:14<00:03, 52.29it/s]backtest loop:  82%|████████▏ | 797/971 [00:14<00:03, 53.20it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:03, 50.51it/s]backtest loop:  83%|████████▎ | 809/971 [00:14<00:03, 52.05it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 52.88it/s]backtest loop:  85%|████████▍ | 821/971 [00:15<00:02, 53.60it/s]backtest loop:  85%|████████▌ | 827/971 [00:15<00:02, 54.13it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 51.30it/s]backtest loop:  86%|████████▋ | 839/971 [00:15<00:02, 52.25it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 53.16it/s]backtest loop:  88%|████████▊ | 851/971 [00:15<00:02, 52.82it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 51.81it/s]backtest loop:  89%|████████▉ | 864/971 [00:15<00:01, 54.99it/s]backtest loop:  90%|████████▉ | 870/971 [00:15<00:01, 56.35it/s]backtest loop:  90%|█████████ | 877/971 [00:16<00:01, 54.89it/s]backtest loop:  91%|█████████ | 884/971 [00:16<00:01, 56.98it/s]backtest loop:  92%|█████████▏| 891/971 [00:16<00:01, 58.66it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 55.87it/s]backtest loop:  93%|█████████▎| 903/971 [00:16<00:01, 56.86it/s]backtest loop:  94%|█████████▎| 910/971 [00:16<00:01, 58.57it/s]backtest loop:  94%|█████████▍| 916/971 [00:16<00:00, 55.79it/s]backtest loop:  95%|█████████▌| 923/971 [00:16<00:00, 57.89it/s]backtest loop:  96%|█████████▌| 930/971 [00:16<00:00, 59.30it/s]backtest loop:  96%|█████████▋| 936/971 [00:17<00:00, 55.90it/s]backtest loop:  97%|█████████▋| 943/971 [00:17<00:00, 57.72it/s]backtest loop:  98%|█████████▊| 950/971 [00:17<00:00, 56.44it/s]backtest loop:  99%|█████████▊| 957/971 [00:17<00:00, 58.25it/s]backtest loop:  99%|█████████▉| 964/971 [00:17<00:00, 59.73it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 57.46it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.91it/s]
[3063331:MainThread](2024-04-25 04:02:39,904) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean              -0.000034
std                0.006739
annualized_return -0.008047
information_ratio -0.077405
max_drawdown      -0.366233
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean              -0.000233
std                0.006738
annualized_return -0.055504
information_ratio -0.533927
max_drawdown      -0.482423
[3063331:MainThread](2024-04-25 04:02:39,916) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `LSTM_crowd_data_csi300_360_rankTrue`.
[3063331:MainThread](2024-04-25 04:02:46,780) INFO - qlib.timer - [log.py:127] - Time cost: 0.008s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.05891823804012103,
                                                    0.022926572555685015,
                                                    -0.05550433417881047],
 '1day.excess_return_with_cost.information_ratio': [0.8184259048224443,
                                                    0.30064223245350585,
                                                    -0.5339271082344875],
 '1day.excess_return_with_cost.max_drawdown': [-0.07846232143476412,
                                               -0.10570945240542111,
                                               -0.4824232677837425],
 'IC': [0.029633086614531495, 0.02574694121661612, 0.013315832589728332],
 'ICIR': [0.23780975049045117, 0.2141330839585906, 0.09240673096781117],
 'Rank IC': [0.043422656604175304, 0.03218351845141216, 0.016324296576641695],
 'Rank ICIR': [0.349273660811528, 0.26258111504674114, 0.10110355733504273],
 'mae': [0.8636513547094068, 0.864254717184863, 0.8645593211325421],
 'mse': [0.997057058270892, 0.9974504140999779, 0.9979122563515013]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3063331:MainThread](2024-04-25 04:02:49,980) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[3063331:MainThread](2024-04-25 04:02:49,981) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3063331:MainThread](2024-04-25 04:02:52,850) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name LSTM_crowd_data_csi300_360_rankTrue_46.
[3063331:MainThread](2024-04-25 04:02:52,883) INFO - qlib.workflow - [exp.py:258] - Experiment 44 starts running ...
[3063331:MainThread](2024-04-25 04:02:52,897) INFO - qlib.workflow - [recorder.py:341] - Recorder 0f2f0a695edd4921b9e1f0bd5e4a4144 starts running under Experiment 44 ...
[3063331:MainThread](2024-04-25 04:02:57,974) INFO - qlib.LSTM - [pytorch_lstm.py:261] - training...
[3063331:MainThread](2024-04-25 04:02:57,975) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch0:
[3063331:MainThread](2024-04-25 04:02:57,975) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:03:04,434) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:03:04,635) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.001857
[3063331:MainThread](2024-04-25 04:03:04,636) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch1:
[3063331:MainThread](2024-04-25 04:03:04,636) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:03:11,245) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:03:11,444) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.002878
[3063331:MainThread](2024-04-25 04:03:11,444) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch2:
[3063331:MainThread](2024-04-25 04:03:11,445) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:03:17,625) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:03:17,828) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998767
[3063331:MainThread](2024-04-25 04:03:17,829) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch3:
[3063331:MainThread](2024-04-25 04:03:17,829) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:03:24,513) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:03:24,721) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997614
[3063331:MainThread](2024-04-25 04:03:24,722) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch4:
[3063331:MainThread](2024-04-25 04:03:24,722) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:03:31,712) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:03:31,920) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999662
[3063331:MainThread](2024-04-25 04:03:31,921) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch5:
[3063331:MainThread](2024-04-25 04:03:31,921) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:03:38,914) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:03:39,123) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998598
[3063331:MainThread](2024-04-25 04:03:39,123) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch6:
[3063331:MainThread](2024-04-25 04:03:39,124) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:03:45,867) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:03:46,069) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999373
[3063331:MainThread](2024-04-25 04:03:46,070) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch7:
[3063331:MainThread](2024-04-25 04:03:46,070) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:03:52,834) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:03:53,034) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998615
[3063331:MainThread](2024-04-25 04:03:53,035) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch8:
[3063331:MainThread](2024-04-25 04:03:53,035) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:03:59,770) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:03:59,979) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998151
[3063331:MainThread](2024-04-25 04:03:59,979) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch9:
[3063331:MainThread](2024-04-25 04:03:59,979) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:04:06,445) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:04:06,645) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997182
[3063331:MainThread](2024-04-25 04:04:06,646) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch10:
[3063331:MainThread](2024-04-25 04:04:06,647) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:04:13,068) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:04:13,269) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997183
[3063331:MainThread](2024-04-25 04:04:13,270) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch11:
[3063331:MainThread](2024-04-25 04:04:13,270) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:04:19,667) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:04:19,871) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997743
[3063331:MainThread](2024-04-25 04:04:19,871) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch12:
[3063331:MainThread](2024-04-25 04:04:19,871) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:04:26,376) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:04:26,585) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999341
[3063331:MainThread](2024-04-25 04:04:26,585) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch13:
[3063331:MainThread](2024-04-25 04:04:26,585) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:04:33,416) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:04:33,619) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998874
[3063331:MainThread](2024-04-25 04:04:33,619) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch14:
[3063331:MainThread](2024-04-25 04:04:33,620) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:04:40,434) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:04:40,644) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998155
[3063331:MainThread](2024-04-25 04:04:40,645) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch15:
[3063331:MainThread](2024-04-25 04:04:40,645) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:04:47,588) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:04:47,793) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998906
[3063331:MainThread](2024-04-25 04:04:47,793) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch16:
[3063331:MainThread](2024-04-25 04:04:47,793) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:04:54,503) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:04:54,705) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998039
[3063331:MainThread](2024-04-25 04:04:54,705) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch17:
[3063331:MainThread](2024-04-25 04:04:54,705) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:05:01,125) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:05:01,325) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998198
[3063331:MainThread](2024-04-25 04:05:01,326) INFO - qlib.LSTM - [pytorch_lstm.py:283] - early stop
[3063331:MainThread](2024-04-25 04:05:01,326) INFO - qlib.LSTM - [pytorch_lstm.py:286] - best score: -0.997182 @ 9
[3063331:MainThread](2024-04-25 04:05:01,346) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to LSTM_crowd_data_csi300_360_rankTrue_46.
[3063331:MainThread](2024-04-25 04:05:01,617) INFO - qlib.workflow - [exp.py:258] - Experiment 41 starts running ...
[3063331:MainThread](2024-04-25 04:05:01,631) INFO - qlib.workflow - [recorder.py:341] - Recorder b0f26c83473342f3a1b5d8e6d7714f71 starts running under Experiment 41 ...
{'IC': 0.012958518389712228,
 'ICIR': 0.09827432529970663,
 'Rank IC': 0.01420673078031172,
 'Rank ICIR': 0.10608327974210181}
[3063331:MainThread](2024-04-25 04:05:07,848) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3063331:MainThread](2024-04-25 04:05:44,839) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 04:05:44,842) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 04:05:51,026) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f851a69b6a0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:41,  9.58it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 24.70it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 34.61it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 38.59it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 43.74it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 47.28it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 46.24it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:18, 49.18it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 51.05it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 49.31it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 51.50it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 52.78it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 53.79it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 54.64it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 51.76it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 53.07it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 53.89it/s]backtest loop:  11%|█         | 105/971 [00:02<00:15, 54.57it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:15, 55.01it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 51.88it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:15, 53.22it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:16, 50.28it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:16, 52.22it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:16, 50.15it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:15, 51.70it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 52.77it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 53.55it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:22, 36.11it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:20, 38.85it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:18, 42.90it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:17, 46.07it/s]backtest loop:  19%|█▉        | 189/971 [00:04<00:15, 48.93it/s]backtest loop:  20%|██        | 195/971 [00:04<00:16, 47.99it/s]backtest loop:  21%|██        | 201/971 [00:04<00:15, 50.07it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:14, 50.96it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:15, 49.42it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:14, 51.11it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:15, 49.30it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:14, 51.00it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:14, 52.41it/s]backtest loop:  25%|██▌       | 243/971 [00:05<00:13, 53.34it/s]backtest loop:  26%|██▌       | 249/971 [00:05<00:14, 50.78it/s]backtest loop:  26%|██▋       | 255/971 [00:05<00:13, 52.41it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:13, 53.50it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:13, 50.94it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:13, 52.21it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:13, 53.18it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:12, 54.20it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:13, 51.58it/s]backtest loop:  31%|███       | 297/971 [00:06<00:12, 53.24it/s]backtest loop:  31%|███       | 303/971 [00:06<00:12, 54.09it/s]backtest loop:  32%|███▏      | 309/971 [00:06<00:12, 54.61it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:12, 51.61it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:12, 52.73it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:11, 53.74it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:11, 54.25it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:11, 54.70it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:12, 51.63it/s]backtest loop:  36%|███▌      | 351/971 [00:07<00:11, 52.98it/s]backtest loop:  37%|███▋      | 357/971 [00:07<00:11, 53.65it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:11, 51.03it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:12, 49.23it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 51.01it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:11, 52.28it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 53.19it/s]backtest loop:  40%|████      | 393/971 [00:07<00:11, 50.80it/s]backtest loop:  41%|████      | 399/971 [00:08<00:10, 52.11it/s]backtest loop:  42%|████▏     | 405/971 [00:08<00:10, 53.44it/s]backtest loop:  42%|████▏     | 411/971 [00:08<00:10, 54.33it/s]backtest loop:  43%|████▎     | 417/971 [00:08<00:10, 54.72it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:10, 51.61it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:10, 52.79it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:10, 53.60it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 54.14it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:10, 51.20it/s]backtest loop:  47%|████▋     | 453/971 [00:09<00:09, 52.40it/s]backtest loop:  47%|████▋     | 459/971 [00:09<00:09, 53.29it/s]backtest loop:  48%|████▊     | 465/971 [00:09<00:09, 53.95it/s]backtest loop:  49%|████▊     | 471/971 [00:09<00:09, 54.20it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 51.40it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:09, 52.47it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:09, 53.46it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:09, 50.87it/s]backtest loop:  52%|█████▏    | 501/971 [00:09<00:08, 52.75it/s]backtest loop:  52%|█████▏    | 507/971 [00:10<00:09, 50.72it/s]backtest loop:  53%|█████▎    | 513/971 [00:10<00:08, 52.08it/s]backtest loop:  53%|█████▎    | 519/971 [00:10<00:08, 53.13it/s]backtest loop:  54%|█████▍    | 525/971 [00:10<00:08, 53.84it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 51.22it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:08, 52.63it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:07, 53.68it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 54.14it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 54.68it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:07, 51.75it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:07, 52.84it/s]backtest loop:  59%|█████▉    | 573/971 [00:11<00:07, 53.69it/s]backtest loop:  60%|█████▉    | 579/971 [00:11<00:07, 54.25it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:07, 53.73it/s]backtest loop:  61%|██████    | 591/971 [00:11<00:07, 52.45it/s]backtest loop:  62%|██████▏   | 598/971 [00:11<00:06, 55.49it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:06, 54.48it/s]backtest loop:  63%|██████▎   | 612/971 [00:12<00:06, 56.80it/s]backtest loop:  64%|██████▎   | 619/971 [00:12<00:06, 58.57it/s]backtest loop:  64%|██████▍   | 625/971 [00:12<00:06, 55.78it/s]backtest loop:  65%|██████▌   | 632/971 [00:12<00:05, 57.76it/s]backtest loop:  66%|██████▌   | 639/971 [00:12<00:05, 59.58it/s]backtest loop:  66%|██████▋   | 645/971 [00:12<00:05, 56.52it/s]backtest loop:  67%|██████▋   | 652/971 [00:12<00:05, 58.42it/s]backtest loop:  68%|██████▊   | 659/971 [00:12<00:05, 59.86it/s]backtest loop:  69%|██████▊   | 666/971 [00:12<00:05, 57.63it/s]backtest loop:  69%|██████▉   | 673/971 [00:13<00:05, 59.03it/s]backtest loop:  70%|██████▉   | 679/971 [00:13<00:05, 56.08it/s]backtest loop:  71%|███████   | 686/971 [00:13<00:04, 57.86it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:04, 59.25it/s]backtest loop:  72%|███████▏  | 699/971 [00:13<00:04, 56.33it/s]backtest loop:  73%|███████▎  | 706/971 [00:13<00:04, 58.16it/s]backtest loop:  73%|███████▎  | 713/971 [00:13<00:04, 59.52it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 56.63it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 58.85it/s]backtest loop:  75%|███████▌  | 732/971 [00:14<00:04, 56.11it/s]backtest loop:  76%|███████▌  | 738/971 [00:14<00:04, 54.01it/s]backtest loop:  77%|███████▋  | 745/971 [00:14<00:03, 56.62it/s]backtest loop:  77%|███████▋  | 751/971 [00:14<00:04, 54.46it/s]backtest loop:  78%|███████▊  | 758/971 [00:14<00:03, 56.83it/s]backtest loop:  79%|███████▉  | 765/971 [00:14<00:03, 55.42it/s]backtest loop:  80%|███████▉  | 772/971 [00:14<00:03, 57.46it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 59.19it/s]backtest loop:  81%|████████  | 785/971 [00:15<00:03, 56.37it/s]backtest loop:  81%|████████▏ | 791/971 [00:15<00:03, 57.17it/s]backtest loop:  82%|████████▏ | 798/971 [00:15<00:03, 55.57it/s]backtest loop:  83%|████████▎ | 805/971 [00:15<00:02, 57.57it/s]backtest loop:  84%|████████▎ | 812/971 [00:15<00:02, 59.15it/s]backtest loop:  84%|████████▍ | 818/971 [00:15<00:02, 56.17it/s]backtest loop:  85%|████████▍ | 824/971 [00:15<00:02, 57.06it/s]backtest loop:  85%|████████▌ | 830/971 [00:15<00:02, 56.38it/s]backtest loop:  86%|████████▌ | 836/971 [00:15<00:02, 56.12it/s]backtest loop:  87%|████████▋ | 842/971 [00:16<00:02, 55.95it/s]backtest loop:  87%|████████▋ | 848/971 [00:16<00:02, 52.41it/s]backtest loop:  88%|████████▊ | 854/971 [00:16<00:02, 52.97it/s]backtest loop:  89%|████████▊ | 860/971 [00:16<00:02, 53.61it/s]backtest loop:  89%|████████▉ | 866/971 [00:16<00:01, 54.16it/s]backtest loop:  90%|████████▉ | 872/971 [00:16<00:01, 51.20it/s]backtest loop:  90%|█████████ | 878/971 [00:16<00:01, 52.42it/s]backtest loop:  91%|█████████ | 884/971 [00:16<00:01, 53.24it/s]backtest loop:  92%|█████████▏| 890/971 [00:16<00:01, 53.70it/s]backtest loop:  92%|█████████▏| 896/971 [00:17<00:01, 54.25it/s]backtest loop:  93%|█████████▎| 902/971 [00:17<00:01, 51.37it/s]backtest loop:  94%|█████████▎| 908/971 [00:17<00:01, 52.55it/s]backtest loop:  94%|█████████▍| 914/971 [00:17<00:01, 53.41it/s]backtest loop:  95%|█████████▍| 920/971 [00:17<00:00, 53.71it/s]backtest loop:  95%|█████████▌| 926/971 [00:17<00:00, 50.97it/s]backtest loop:  96%|█████████▌| 932/971 [00:17<00:00, 52.20it/s]backtest loop:  97%|█████████▋| 938/971 [00:17<00:00, 53.08it/s]backtest loop:  97%|█████████▋| 944/971 [00:17<00:00, 53.80it/s]backtest loop:  98%|█████████▊| 950/971 [00:18<00:00, 50.68it/s]backtest loop:  98%|█████████▊| 956/971 [00:18<00:00, 52.01it/s]backtest loop:  99%|█████████▉| 962/971 [00:18<00:00, 53.02it/s]backtest loop: 100%|█████████▉| 968/971 [00:18<00:00, 53.65it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 52.50it/s]
[3063331:MainThread](2024-04-25 04:06:09,579) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000146
std                0.005351
annualized_return  0.034802
information_ratio  0.421571
max_drawdown      -0.154394
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean              -0.000053
std                0.005352
annualized_return -0.012568
information_ratio -0.152227
max_drawdown      -0.255296
[3063331:MainThread](2024-04-25 04:06:09,593) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `LSTM_crowd_data_csi300_360_rankTrue`.
[3063331:MainThread](2024-04-25 04:06:16,368) INFO - qlib.timer - [log.py:127] - Time cost: 0.007s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.05891823804012103,
                                                    0.022926572555685015,
                                                    -0.05550433417881047,
                                                    -0.012567980593449053],
 '1day.excess_return_with_cost.information_ratio': [0.8184259048224443,
                                                    0.30064223245350585,
                                                    -0.5339271082344875,
                                                    -0.152226770022929],
 '1day.excess_return_with_cost.max_drawdown': [-0.07846232143476412,
                                               -0.10570945240542111,
                                               -0.4824232677837425,
                                               -0.25529562680435725],
 'IC': [0.029633086614531495,
        0.02574694121661612,
        0.013315832589728332,
        0.012958518389712228],
 'ICIR': [0.23780975049045117,
          0.2141330839585906,
          0.09240673096781117,
          0.09827432529970663],
 'Rank IC': [0.043422656604175304,
             0.03218351845141216,
             0.016324296576641695,
             0.01420673078031172],
 'Rank ICIR': [0.349273660811528,
               0.26258111504674114,
               0.10110355733504273,
               0.10608327974210181],
 'mae': [0.8636513547094068,
         0.864254717184863,
         0.8645593211325421,
         0.8648148057465549],
 'mse': [0.997057058270892,
         0.9974504140999779,
         0.9979122563515013,
         0.9984265146409119]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3063331:MainThread](2024-04-25 04:06:19,549) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[3063331:MainThread](2024-04-25 04:06:19,549) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3063331:MainThread](2024-04-25 04:06:22,418) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name LSTM_crowd_data_csi300_360_rankTrue_47.
[3063331:MainThread](2024-04-25 04:06:22,459) INFO - qlib.workflow - [exp.py:258] - Experiment 45 starts running ...
[3063331:MainThread](2024-04-25 04:06:22,472) INFO - qlib.workflow - [recorder.py:341] - Recorder 330f6d60781f482dbb428091d265859b starts running under Experiment 45 ...
[3063331:MainThread](2024-04-25 04:06:27,956) INFO - qlib.LSTM - [pytorch_lstm.py:261] - training...
[3063331:MainThread](2024-04-25 04:06:27,957) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch0:
[3063331:MainThread](2024-04-25 04:06:27,957) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:06:34,628) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:06:34,827) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.996479
[3063331:MainThread](2024-04-25 04:06:34,829) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch1:
[3063331:MainThread](2024-04-25 04:06:34,829) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:06:41,274) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:06:41,476) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997690
[3063331:MainThread](2024-04-25 04:06:41,477) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch2:
[3063331:MainThread](2024-04-25 04:06:41,477) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:06:48,190) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:06:48,390) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997167
[3063331:MainThread](2024-04-25 04:06:48,390) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch3:
[3063331:MainThread](2024-04-25 04:06:48,391) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:06:54,888) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:06:55,090) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.003267
[3063331:MainThread](2024-04-25 04:06:55,090) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch4:
[3063331:MainThread](2024-04-25 04:06:55,091) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:07:01,675) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:07:01,875) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998460
[3063331:MainThread](2024-04-25 04:07:01,876) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch5:
[3063331:MainThread](2024-04-25 04:07:01,876) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:07:08,310) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:07:08,514) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.000761
[3063331:MainThread](2024-04-25 04:07:08,514) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch6:
[3063331:MainThread](2024-04-25 04:07:08,514) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:07:14,988) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:07:15,188) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998318
[3063331:MainThread](2024-04-25 04:07:15,188) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch7:
[3063331:MainThread](2024-04-25 04:07:15,189) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:07:21,635) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:07:21,837) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.000105
[3063331:MainThread](2024-04-25 04:07:21,837) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch8:
[3063331:MainThread](2024-04-25 04:07:21,838) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:07:28,215) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:07:28,415) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998553
[3063331:MainThread](2024-04-25 04:07:28,416) INFO - qlib.LSTM - [pytorch_lstm.py:283] - early stop
[3063331:MainThread](2024-04-25 04:07:28,416) INFO - qlib.LSTM - [pytorch_lstm.py:286] - best score: -0.996479 @ 0
[3063331:MainThread](2024-04-25 04:07:28,438) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to LSTM_crowd_data_csi300_360_rankTrue_47.
[3063331:MainThread](2024-04-25 04:07:28,713) INFO - qlib.workflow - [exp.py:258] - Experiment 41 starts running ...
[3063331:MainThread](2024-04-25 04:07:28,727) INFO - qlib.workflow - [recorder.py:341] - Recorder 15114e53ad7f475caa72b134093cd891 starts running under Experiment 41 ...
{'IC': 0.01588291832584367,
 'ICIR': 0.11688319797213967,
 'Rank IC': 0.015615345030848294,
 'Rank ICIR': 0.1084787038066814}
[3063331:MainThread](2024-04-25 04:07:35,193) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3063331:MainThread](2024-04-25 04:08:12,063) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 04:08:12,066) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 04:08:18,014) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8576a54d00>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:42,  9.48it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.54it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 34.43it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 38.53it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 43.44it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 47.13it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 46.52it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:18, 49.13it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 51.00it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 48.95it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 51.01it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 52.66it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 54.00it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 54.81it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 51.68it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 52.74it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 53.49it/s]backtest loop:  11%|█         | 105/971 [00:02<00:15, 54.29it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:15, 54.81it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 51.70it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 52.78it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:16, 50.47it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:15, 52.30it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:16, 50.18it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:16, 51.21it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 52.30it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 53.15it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:14, 53.86it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 51.07it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:15, 52.37it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 53.20it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:14, 54.15it/s]backtest loop:  20%|██        | 195/971 [00:03<00:15, 51.24it/s]backtest loop:  21%|██        | 201/971 [00:04<00:14, 52.49it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:14, 53.45it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:14, 51.26it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:14, 52.46it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:14, 50.35it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:21, 34.57it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:18, 38.94it/s]backtest loop:  25%|██▌       | 243/971 [00:05<00:17, 42.75it/s]backtest loop:  26%|██▌       | 249/971 [00:05<00:16, 43.67it/s]backtest loop:  26%|██▋       | 255/971 [00:05<00:15, 47.04it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:14, 49.41it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:14, 48.41it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:13, 50.38it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:13, 51.81it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:12, 53.14it/s]backtest loop:  30%|██▉       | 291/971 [00:06<00:13, 50.55it/s]backtest loop:  31%|███       | 297/971 [00:06<00:12, 51.95it/s]backtest loop:  31%|███       | 303/971 [00:06<00:12, 52.94it/s]backtest loop:  32%|███▏      | 309/971 [00:06<00:12, 53.91it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:12, 51.07it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:12, 51.90it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:12, 53.16it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:11, 54.02it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:11, 54.66it/s]backtest loop:  36%|███▌      | 345/971 [00:07<00:12, 51.48it/s]backtest loop:  36%|███▌      | 351/971 [00:07<00:11, 52.69it/s]backtest loop:  37%|███▋      | 357/971 [00:07<00:11, 53.67it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:11, 51.26it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:12, 49.42it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 51.16it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:11, 52.44it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 53.30it/s]backtest loop:  40%|████      | 393/971 [00:07<00:11, 50.84it/s]backtest loop:  41%|████      | 399/971 [00:08<00:10, 52.06it/s]backtest loop:  42%|████▏     | 405/971 [00:08<00:10, 53.45it/s]backtest loop:  42%|████▏     | 411/971 [00:08<00:10, 53.88it/s]backtest loop:  43%|████▎     | 417/971 [00:08<00:10, 54.35it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:10, 51.39it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:10, 52.50it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:10, 53.33it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 54.04it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:10, 51.48it/s]backtest loop:  47%|████▋     | 453/971 [00:09<00:09, 52.88it/s]backtest loop:  47%|████▋     | 459/971 [00:09<00:09, 53.62it/s]backtest loop:  48%|████▊     | 465/971 [00:09<00:09, 54.19it/s]backtest loop:  49%|████▊     | 471/971 [00:09<00:09, 54.59it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 51.65it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:09, 52.61it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:09, 53.42it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:09, 50.97it/s]backtest loop:  52%|█████▏    | 501/971 [00:09<00:08, 52.31it/s]backtest loop:  52%|█████▏    | 507/971 [00:10<00:09, 50.50it/s]backtest loop:  53%|█████▎    | 513/971 [00:10<00:08, 51.88it/s]backtest loop:  53%|█████▎    | 519/971 [00:10<00:08, 52.98it/s]backtest loop:  54%|█████▍    | 525/971 [00:10<00:08, 53.77it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 51.33it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:08, 52.72it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:07, 53.51it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 54.08it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 54.41it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:07, 51.45it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:07, 52.59it/s]backtest loop:  59%|█████▉    | 573/971 [00:11<00:07, 53.62it/s]backtest loop:  60%|█████▉    | 579/971 [00:11<00:07, 54.20it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:07, 54.50it/s]backtest loop:  61%|██████    | 591/971 [00:11<00:07, 51.48it/s]backtest loop:  61%|██████▏   | 597/971 [00:11<00:07, 52.64it/s]backtest loop:  62%|██████▏   | 603/971 [00:11<00:06, 53.44it/s]backtest loop:  63%|██████▎   | 609/971 [00:12<00:06, 53.87it/s]backtest loop:  63%|██████▎   | 615/971 [00:12<00:06, 51.06it/s]backtest loop:  64%|██████▍   | 621/971 [00:12<00:06, 52.24it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:06, 53.35it/s]backtest loop:  65%|██████▌   | 633/971 [00:12<00:06, 54.02it/s]backtest loop:  66%|██████▌   | 639/971 [00:12<00:06, 54.46it/s]backtest loop:  66%|██████▋   | 645/971 [00:12<00:06, 51.49it/s]backtest loop:  67%|██████▋   | 651/971 [00:12<00:06, 52.71it/s]backtest loop:  68%|██████▊   | 657/971 [00:12<00:05, 53.51it/s]backtest loop:  68%|██████▊   | 663/971 [00:13<00:05, 54.07it/s]backtest loop:  69%|██████▉   | 669/971 [00:13<00:05, 54.52it/s]backtest loop:  70%|██████▉   | 675/971 [00:13<00:05, 51.30it/s]backtest loop:  70%|███████   | 681/971 [00:13<00:05, 52.42it/s]backtest loop:  71%|███████   | 687/971 [00:13<00:05, 53.20it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:05, 53.94it/s]backtest loop:  72%|███████▏  | 699/971 [00:13<00:05, 51.12it/s]backtest loop:  73%|███████▎  | 705/971 [00:13<00:05, 52.34it/s]backtest loop:  73%|███████▎  | 711/971 [00:13<00:04, 53.76it/s]backtest loop:  74%|███████▍  | 717/971 [00:14<00:04, 54.37it/s]backtest loop:  74%|███████▍  | 723/971 [00:14<00:04, 55.09it/s]backtest loop:  75%|███████▌  | 729/971 [00:14<00:04, 52.26it/s]backtest loop:  76%|███████▌  | 735/971 [00:14<00:04, 50.28it/s]backtest loop:  76%|███████▋  | 741/971 [00:14<00:04, 51.78it/s]backtest loop:  77%|███████▋  | 747/971 [00:14<00:04, 52.90it/s]backtest loop:  78%|███████▊  | 753/971 [00:14<00:04, 50.60it/s]backtest loop:  78%|███████▊  | 759/971 [00:14<00:04, 51.98it/s]backtest loop:  79%|███████▉  | 765/971 [00:15<00:04, 49.68it/s]backtest loop:  79%|███████▉  | 771/971 [00:15<00:03, 51.23it/s]backtest loop:  80%|████████  | 777/971 [00:15<00:03, 52.65it/s]backtest loop:  81%|████████  | 783/971 [00:15<00:03, 50.29it/s]backtest loop:  81%|████████▏ | 789/971 [00:15<00:03, 51.41it/s]backtest loop:  82%|████████▏ | 795/971 [00:15<00:03, 52.59it/s]backtest loop:  82%|████████▏ | 801/971 [00:15<00:03, 53.42it/s]backtest loop:  83%|████████▎ | 807/971 [00:15<00:03, 54.04it/s]backtest loop:  84%|████████▎ | 813/971 [00:15<00:03, 50.73it/s]backtest loop:  84%|████████▍ | 819/971 [00:16<00:02, 52.06it/s]backtest loop:  85%|████████▍ | 825/971 [00:16<00:02, 52.99it/s]backtest loop:  86%|████████▌ | 831/971 [00:16<00:02, 53.90it/s]backtest loop:  86%|████████▌ | 837/971 [00:16<00:02, 54.38it/s]backtest loop:  87%|████████▋ | 843/971 [00:16<00:02, 51.45it/s]backtest loop:  87%|████████▋ | 849/971 [00:16<00:02, 52.39it/s]backtest loop:  88%|████████▊ | 855/971 [00:16<00:02, 53.27it/s]backtest loop:  89%|████████▊ | 861/971 [00:16<00:02, 53.90it/s]backtest loop:  89%|████████▉ | 867/971 [00:16<00:02, 51.08it/s]backtest loop:  90%|████████▉ | 873/971 [00:17<00:01, 52.29it/s]backtest loop:  91%|█████████ | 879/971 [00:17<00:01, 53.18it/s]backtest loop:  91%|█████████ | 885/971 [00:17<00:01, 53.94it/s]backtest loop:  92%|█████████▏| 891/971 [00:17<00:01, 54.41it/s]backtest loop:  92%|█████████▏| 897/971 [00:17<00:01, 51.47it/s]backtest loop:  93%|█████████▎| 903/971 [00:17<00:01, 52.61it/s]backtest loop:  94%|█████████▎| 909/971 [00:17<00:01, 53.39it/s]backtest loop:  94%|█████████▍| 915/971 [00:17<00:01, 54.02it/s]backtest loop:  95%|█████████▍| 921/971 [00:17<00:00, 51.16it/s]backtest loop:  95%|█████████▌| 927/971 [00:18<00:00, 52.46it/s]backtest loop:  96%|█████████▌| 933/971 [00:18<00:00, 53.32it/s]backtest loop:  97%|█████████▋| 939/971 [00:18<00:00, 53.10it/s]backtest loop:  97%|█████████▋| 945/971 [00:18<00:00, 50.54it/s]backtest loop:  98%|█████████▊| 951/971 [00:18<00:00, 52.09it/s]backtest loop:  99%|█████████▊| 957/971 [00:18<00:00, 53.11it/s]backtest loop:  99%|█████████▉| 963/971 [00:18<00:00, 53.92it/s]backtest loop: 100%|█████████▉| 969/971 [00:18<00:00, 54.68it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 51.36it/s]
[3063331:MainThread](2024-04-25 04:08:36,976) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000175
std                0.006355
annualized_return  0.041743
information_ratio  0.425753
max_drawdown      -0.238408
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean              -0.000024
std                0.006356
annualized_return -0.005649
information_ratio -0.057612
max_drawdown      -0.357470
[3063331:MainThread](2024-04-25 04:08:36,989) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `LSTM_crowd_data_csi300_360_rankTrue`.
[3063331:MainThread](2024-04-25 04:08:43,809) INFO - qlib.timer - [log.py:127] - Time cost: 0.008s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.05891823804012103,
                                                    0.022926572555685015,
                                                    -0.05550433417881047,
                                                    -0.012567980593449053,
                                                    -0.005649080654276603],
 '1day.excess_return_with_cost.information_ratio': [0.8184259048224443,
                                                    0.30064223245350585,
                                                    -0.5339271082344875,
                                                    -0.152226770022929,
                                                    -0.05761185713768486],
 '1day.excess_return_with_cost.max_drawdown': [-0.07846232143476412,
                                               -0.10570945240542111,
                                               -0.4824232677837425,
                                               -0.25529562680435725,
                                               -0.3574695859945844],
 'IC': [0.029633086614531495,
        0.02574694121661612,
        0.013315832589728332,
        0.012958518389712228,
        0.01588291832584367],
 'ICIR': [0.23780975049045117,
          0.2141330839585906,
          0.09240673096781117,
          0.09827432529970663,
          0.11688319797213967],
 'Rank IC': [0.043422656604175304,
             0.03218351845141216,
             0.016324296576641695,
             0.01420673078031172,
             0.015615345030848294],
 'Rank ICIR': [0.349273660811528,
               0.26258111504674114,
               0.10110355733504273,
               0.10608327974210181,
               0.1084787038066814],
 'mae': [0.8636513547094068,
         0.864254717184863,
         0.8645593211325421,
         0.8648148057465549,
         0.8646410613775686],
 'mse': [0.997057058270892,
         0.9974504140999779,
         0.9979122563515013,
         0.9984265146409119,
         0.9987282034543231]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3063331:MainThread](2024-04-25 04:08:46,974) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[3063331:MainThread](2024-04-25 04:08:46,975) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3063331:MainThread](2024-04-25 04:08:49,841) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name LSTM_crowd_data_csi300_360_rankTrue_48.
[3063331:MainThread](2024-04-25 04:08:49,875) INFO - qlib.workflow - [exp.py:258] - Experiment 46 starts running ...
[3063331:MainThread](2024-04-25 04:08:49,890) INFO - qlib.workflow - [recorder.py:341] - Recorder 462eb55d16584ac298a7fa72fc99c578 starts running under Experiment 46 ...
[3063331:MainThread](2024-04-25 04:08:54,975) INFO - qlib.LSTM - [pytorch_lstm.py:261] - training...
[3063331:MainThread](2024-04-25 04:08:54,975) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch0:
[3063331:MainThread](2024-04-25 04:08:54,976) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:09:01,739) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:09:01,945) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998391
[3063331:MainThread](2024-04-25 04:09:01,946) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch1:
[3063331:MainThread](2024-04-25 04:09:01,946) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:09:08,493) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:09:08,702) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998432
[3063331:MainThread](2024-04-25 04:09:08,702) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch2:
[3063331:MainThread](2024-04-25 04:09:08,702) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:09:15,607) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:09:15,816) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997506
[3063331:MainThread](2024-04-25 04:09:15,817) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch3:
[3063331:MainThread](2024-04-25 04:09:15,817) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:09:22,346) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:09:22,548) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997699
[3063331:MainThread](2024-04-25 04:09:22,548) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch4:
[3063331:MainThread](2024-04-25 04:09:22,548) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:09:28,956) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:09:29,154) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997199
[3063331:MainThread](2024-04-25 04:09:29,156) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch5:
[3063331:MainThread](2024-04-25 04:09:29,156) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:09:35,598) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:09:35,807) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999882
[3063331:MainThread](2024-04-25 04:09:35,807) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch6:
[3063331:MainThread](2024-04-25 04:09:35,808) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:09:42,378) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:09:42,578) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999524
[3063331:MainThread](2024-04-25 04:09:42,579) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch7:
[3063331:MainThread](2024-04-25 04:09:42,579) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:09:49,180) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:09:49,382) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999262
[3063331:MainThread](2024-04-25 04:09:49,382) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch8:
[3063331:MainThread](2024-04-25 04:09:49,382) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:09:55,827) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:09:56,028) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.000833
[3063331:MainThread](2024-04-25 04:09:56,029) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch9:
[3063331:MainThread](2024-04-25 04:09:56,029) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:10:02,515) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:10:02,719) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999192
[3063331:MainThread](2024-04-25 04:10:02,720) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch10:
[3063331:MainThread](2024-04-25 04:10:02,720) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:10:09,137) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:10:09,338) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.000292
[3063331:MainThread](2024-04-25 04:10:09,338) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch11:
[3063331:MainThread](2024-04-25 04:10:09,339) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:10:15,910) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:10:16,114) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999897
[3063331:MainThread](2024-04-25 04:10:16,114) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch12:
[3063331:MainThread](2024-04-25 04:10:16,114) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:10:22,434) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:10:22,638) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.001941
[3063331:MainThread](2024-04-25 04:10:22,638) INFO - qlib.LSTM - [pytorch_lstm.py:283] - early stop
[3063331:MainThread](2024-04-25 04:10:22,639) INFO - qlib.LSTM - [pytorch_lstm.py:286] - best score: -0.997199 @ 4
[3063331:MainThread](2024-04-25 04:10:22,660) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to LSTM_crowd_data_csi300_360_rankTrue_48.
[3063331:MainThread](2024-04-25 04:10:22,934) INFO - qlib.workflow - [exp.py:258] - Experiment 41 starts running ...
[3063331:MainThread](2024-04-25 04:10:22,948) INFO - qlib.workflow - [recorder.py:341] - Recorder cca3c415b6f14ba1946b89990edad4e4 starts running under Experiment 41 ...
{'IC': 0.02944302842463128,
 'ICIR': 0.24326658526288497,
 'Rank IC': 0.04056717341283423,
 'Rank ICIR': 0.32691885978453966}
[3063331:MainThread](2024-04-25 04:10:28,677) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3063331:MainThread](2024-04-25 04:11:05,941) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 04:11:05,944) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 04:11:11,914) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f856f41a8b0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:44,  9.27it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.14it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 34.00it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:25, 37.78it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 42.99it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 46.55it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 46.24it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:18, 48.82it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 50.58it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 48.91it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 51.00it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 52.60it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 53.61it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 53.99it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 51.22it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 52.50it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 53.26it/s]backtest loop:  11%|█         | 105/971 [00:02<00:16, 53.98it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:16, 53.60it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 50.87it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 52.11it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:16, 49.94it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:16, 51.42it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:16, 49.21it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:16, 50.32it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 51.71it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 52.74it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:15, 53.54it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 51.29it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:15, 52.60it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 53.76it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:14, 54.42it/s]backtest loop:  20%|██        | 195/971 [00:04<00:15, 51.06it/s]backtest loop:  21%|██        | 201/971 [00:04<00:14, 52.31it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:14, 53.14it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:14, 50.86it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:14, 52.30it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:22, 33.66it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:19, 37.92it/s]backtest loop:  24%|██▍       | 237/971 [00:05<00:17, 41.97it/s]backtest loop:  25%|██▌       | 243/971 [00:05<00:16, 45.33it/s]backtest loop:  26%|██▌       | 249/971 [00:05<00:15, 45.49it/s]backtest loop:  26%|██▋       | 255/971 [00:05<00:14, 48.05it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:14, 50.08it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:14, 48.84it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:13, 50.14it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:13, 51.87it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:13, 52.69it/s]backtest loop:  30%|██▉       | 291/971 [00:06<00:13, 50.23it/s]backtest loop:  31%|███       | 297/971 [00:06<00:13, 51.67it/s]backtest loop:  31%|███       | 303/971 [00:06<00:12, 52.74it/s]backtest loop:  32%|███▏      | 309/971 [00:06<00:12, 53.65it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:12, 50.51it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:12, 51.75it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:12, 53.49it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:11, 54.07it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:11, 54.78it/s]backtest loop:  36%|███▌      | 345/971 [00:07<00:12, 51.62it/s]backtest loop:  36%|███▌      | 351/971 [00:07<00:11, 52.76it/s]backtest loop:  37%|███▋      | 357/971 [00:07<00:11, 53.59it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:11, 50.67it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:12, 49.12it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 50.79it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:11, 52.07it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:11, 53.00it/s]backtest loop:  40%|████      | 393/971 [00:08<00:11, 50.78it/s]backtest loop:  41%|████      | 399/971 [00:08<00:10, 52.12it/s]backtest loop:  42%|████▏     | 405/971 [00:08<00:10, 52.19it/s]backtest loop:  42%|████▏     | 411/971 [00:08<00:10, 53.14it/s]backtest loop:  43%|████▎     | 417/971 [00:08<00:10, 53.61it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:10, 50.90it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:10, 52.20it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:10, 52.99it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 53.50it/s]backtest loop:  46%|████▌     | 447/971 [00:09<00:10, 50.23it/s]backtest loop:  47%|████▋     | 453/971 [00:09<00:10, 51.65it/s]backtest loop:  47%|████▋     | 459/971 [00:09<00:09, 52.68it/s]backtest loop:  48%|████▊     | 465/971 [00:09<00:09, 53.41it/s]backtest loop:  49%|████▊     | 471/971 [00:09<00:09, 53.72it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 50.88it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:09, 51.98it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:09, 52.57it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:09, 50.23it/s]backtest loop:  52%|█████▏    | 501/971 [00:10<00:09, 51.36it/s]backtest loop:  52%|█████▏    | 507/971 [00:10<00:09, 49.99it/s]backtest loop:  53%|█████▎    | 513/971 [00:10<00:08, 51.47it/s]backtest loop:  53%|█████▎    | 519/971 [00:10<00:08, 52.90it/s]backtest loop:  54%|█████▍    | 525/971 [00:10<00:08, 53.60it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 50.77it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:08, 52.05it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:08, 53.10it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 53.70it/s]backtest loop:  57%|█████▋    | 555/971 [00:11<00:07, 54.14it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:08, 50.85it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:07, 52.08it/s]backtest loop:  59%|█████▉    | 573/971 [00:11<00:07, 53.09it/s]backtest loop:  60%|█████▉    | 579/971 [00:11<00:07, 53.81it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:07, 54.31it/s]backtest loop:  61%|██████    | 591/971 [00:11<00:07, 51.09it/s]backtest loop:  61%|██████▏   | 597/971 [00:11<00:07, 52.34it/s]backtest loop:  62%|██████▏   | 603/971 [00:12<00:06, 53.23it/s]backtest loop:  63%|██████▎   | 609/971 [00:12<00:06, 53.89it/s]backtest loop:  63%|██████▎   | 615/971 [00:12<00:06, 51.19it/s]backtest loop:  64%|██████▍   | 621/971 [00:12<00:06, 52.05it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:06, 53.10it/s]backtest loop:  65%|██████▌   | 633/971 [00:12<00:06, 53.81it/s]backtest loop:  66%|██████▌   | 639/971 [00:12<00:06, 54.58it/s]backtest loop:  66%|██████▋   | 645/971 [00:12<00:06, 51.52it/s]backtest loop:  67%|██████▋   | 651/971 [00:12<00:06, 52.36it/s]backtest loop:  68%|██████▊   | 657/971 [00:13<00:05, 52.87it/s]backtest loop:  68%|██████▊   | 663/971 [00:13<00:05, 53.62it/s]backtest loop:  69%|██████▉   | 669/971 [00:13<00:05, 54.13it/s]backtest loop:  70%|██████▉   | 675/971 [00:13<00:05, 51.12it/s]backtest loop:  70%|███████   | 681/971 [00:13<00:05, 52.22it/s]backtest loop:  71%|███████   | 687/971 [00:13<00:05, 52.70it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:05, 53.48it/s]backtest loop:  72%|███████▏  | 699/971 [00:13<00:05, 50.87it/s]backtest loop:  73%|███████▎  | 705/971 [00:13<00:05, 52.11it/s]backtest loop:  73%|███████▎  | 711/971 [00:14<00:04, 53.03it/s]backtest loop:  74%|███████▍  | 717/971 [00:14<00:04, 53.50it/s]backtest loop:  74%|███████▍  | 723/971 [00:14<00:04, 54.21it/s]backtest loop:  75%|███████▌  | 729/971 [00:14<00:04, 51.56it/s]backtest loop:  76%|███████▌  | 735/971 [00:14<00:04, 49.67it/s]backtest loop:  76%|███████▋  | 741/971 [00:14<00:04, 51.15it/s]backtest loop:  77%|███████▋  | 747/971 [00:14<00:04, 52.15it/s]backtest loop:  78%|███████▊  | 753/971 [00:14<00:04, 49.96it/s]backtest loop:  78%|███████▊  | 759/971 [00:14<00:04, 51.40it/s]backtest loop:  79%|███████▉  | 765/971 [00:15<00:04, 49.50it/s]backtest loop:  79%|███████▉  | 771/971 [00:15<00:03, 51.04it/s]backtest loop:  80%|████████  | 777/971 [00:15<00:03, 52.21it/s]backtest loop:  81%|████████  | 783/971 [00:15<00:03, 50.42it/s]backtest loop:  81%|████████▏ | 789/971 [00:15<00:03, 51.95it/s]backtest loop:  82%|████████▏ | 795/971 [00:15<00:03, 52.91it/s]backtest loop:  82%|████████▏ | 801/971 [00:15<00:03, 53.65it/s]backtest loop:  83%|████████▎ | 807/971 [00:15<00:03, 53.87it/s]backtest loop:  84%|████████▎ | 813/971 [00:16<00:03, 51.03it/s]backtest loop:  84%|████████▍ | 819/971 [00:16<00:02, 52.27it/s]backtest loop:  85%|████████▍ | 825/971 [00:16<00:02, 53.09it/s]backtest loop:  86%|████████▌ | 831/971 [00:16<00:02, 53.57it/s]backtest loop:  86%|████████▌ | 837/971 [00:16<00:02, 53.76it/s]backtest loop:  87%|████████▋ | 843/971 [00:16<00:02, 50.94it/s]backtest loop:  87%|████████▋ | 849/971 [00:16<00:02, 52.20it/s]backtest loop:  88%|████████▊ | 855/971 [00:16<00:02, 53.09it/s]backtest loop:  89%|████████▊ | 861/971 [00:16<00:02, 53.76it/s]backtest loop:  89%|████████▉ | 867/971 [00:17<00:02, 50.86it/s]backtest loop:  90%|████████▉ | 873/971 [00:17<00:01, 52.19it/s]backtest loop:  91%|█████████ | 879/971 [00:17<00:01, 53.01it/s]backtest loop:  91%|█████████ | 885/971 [00:17<00:01, 53.77it/s]backtest loop:  92%|█████████▏| 891/971 [00:17<00:01, 54.23it/s]backtest loop:  92%|█████████▏| 897/971 [00:17<00:01, 51.31it/s]backtest loop:  93%|█████████▎| 903/971 [00:17<00:01, 52.46it/s]backtest loop:  94%|█████████▎| 909/971 [00:17<00:01, 53.26it/s]backtest loop:  94%|█████████▍| 915/971 [00:17<00:01, 53.94it/s]backtest loop:  95%|█████████▍| 921/971 [00:18<00:00, 51.05it/s]backtest loop:  95%|█████████▌| 927/971 [00:18<00:00, 52.31it/s]backtest loop:  96%|█████████▌| 933/971 [00:18<00:00, 53.09it/s]backtest loop:  97%|█████████▋| 939/971 [00:18<00:00, 53.74it/s]backtest loop:  97%|█████████▋| 945/971 [00:18<00:00, 50.94it/s]backtest loop:  98%|█████████▊| 951/971 [00:18<00:00, 52.34it/s]backtest loop:  99%|█████████▊| 957/971 [00:18<00:00, 53.30it/s]backtest loop:  99%|█████████▉| 963/971 [00:18<00:00, 53.92it/s]backtest loop: 100%|█████████▉| 969/971 [00:18<00:00, 54.44it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 51.02it/s]
[3063331:MainThread](2024-04-25 04:11:31,004) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000489
std                0.004600
annualized_return  0.116447
information_ratio  1.640748
max_drawdown      -0.058088
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000292
std                0.004603
annualized_return  0.069591
information_ratio  0.980019
max_drawdown      -0.065524
[3063331:MainThread](2024-04-25 04:11:31,018) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `LSTM_crowd_data_csi300_360_rankTrue`.
[3063331:MainThread](2024-04-25 04:11:37,795) INFO - qlib.timer - [log.py:127] - Time cost: 0.008s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.05891823804012103,
                                                    0.022926572555685015,
                                                    -0.05550433417881047,
                                                    -0.012567980593449053,
                                                    -0.005649080654276603,
                                                    0.0695912035666429],
 '1day.excess_return_with_cost.information_ratio': [0.8184259048224443,
                                                    0.30064223245350585,
                                                    -0.5339271082344875,
                                                    -0.152226770022929,
                                                    -0.05761185713768486,
                                                    0.9800193558356165],
 '1day.excess_return_with_cost.max_drawdown': [-0.07846232143476412,
                                               -0.10570945240542111,
                                               -0.4824232677837425,
                                               -0.25529562680435725,
                                               -0.3574695859945844,
                                               -0.06552375947562239],
 'IC': [0.029633086614531495,
        0.02574694121661612,
        0.013315832589728332,
        0.012958518389712228,
        0.01588291832584367,
        0.02944302842463128],
 'ICIR': [0.23780975049045117,
          0.2141330839585906,
          0.09240673096781117,
          0.09827432529970663,
          0.11688319797213967,
          0.24326658526288497],
 'Rank IC': [0.043422656604175304,
             0.03218351845141216,
             0.016324296576641695,
             0.01420673078031172,
             0.015615345030848294,
             0.04056717341283423],
 'Rank ICIR': [0.349273660811528,
               0.26258111504674114,
               0.10110355733504273,
               0.10608327974210181,
               0.1084787038066814,
               0.32691885978453966],
 'mae': [0.8636513547094068,
         0.864254717184863,
         0.8645593211325421,
         0.8648148057465549,
         0.8646410613775686,
         0.8637755331436053],
 'mse': [0.997057058270892,
         0.9974504140999779,
         0.9979122563515013,
         0.9984265146409119,
         0.9987282034543231,
         0.9979906128632701]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3063331:MainThread](2024-04-25 04:11:40,968) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[3063331:MainThread](2024-04-25 04:11:40,969) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3063331:MainThread](2024-04-25 04:11:43,841) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name LSTM_crowd_data_csi300_360_rankTrue_49.
[3063331:MainThread](2024-04-25 04:11:43,876) INFO - qlib.workflow - [exp.py:258] - Experiment 47 starts running ...
[3063331:MainThread](2024-04-25 04:11:43,887) INFO - qlib.workflow - [recorder.py:341] - Recorder 22ae5fffea0e444880eb57aa107d8ab3 starts running under Experiment 47 ...
[3063331:MainThread](2024-04-25 04:11:49,091) INFO - qlib.LSTM - [pytorch_lstm.py:261] - training...
[3063331:MainThread](2024-04-25 04:11:49,092) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch0:
[3063331:MainThread](2024-04-25 04:11:49,092) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:11:55,875) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:11:56,077) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997535
[3063331:MainThread](2024-04-25 04:11:56,078) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch1:
[3063331:MainThread](2024-04-25 04:11:56,079) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:12:02,835) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:12:03,037) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.000053
[3063331:MainThread](2024-04-25 04:12:03,038) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch2:
[3063331:MainThread](2024-04-25 04:12:03,038) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:12:09,452) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:12:09,652) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998247
[3063331:MainThread](2024-04-25 04:12:09,652) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch3:
[3063331:MainThread](2024-04-25 04:12:09,652) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:12:16,045) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:12:16,245) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998142
[3063331:MainThread](2024-04-25 04:12:16,245) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch4:
[3063331:MainThread](2024-04-25 04:12:16,246) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:12:22,737) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:12:22,938) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998133
[3063331:MainThread](2024-04-25 04:12:22,938) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch5:
[3063331:MainThread](2024-04-25 04:12:22,939) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:12:29,303) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:12:29,503) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999122
[3063331:MainThread](2024-04-25 04:12:29,504) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch6:
[3063331:MainThread](2024-04-25 04:12:29,504) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:12:36,103) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:12:36,302) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.001284
[3063331:MainThread](2024-04-25 04:12:36,303) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch7:
[3063331:MainThread](2024-04-25 04:12:36,303) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:12:42,977) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:12:43,177) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.996875
[3063331:MainThread](2024-04-25 04:12:43,178) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch8:
[3063331:MainThread](2024-04-25 04:12:43,179) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:12:50,155) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:12:50,363) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.002396
[3063331:MainThread](2024-04-25 04:12:50,364) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch9:
[3063331:MainThread](2024-04-25 04:12:50,364) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:12:57,096) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:12:57,298) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.000503
[3063331:MainThread](2024-04-25 04:12:57,299) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch10:
[3063331:MainThread](2024-04-25 04:12:57,299) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:13:03,947) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:13:04,156) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997422
[3063331:MainThread](2024-04-25 04:13:04,156) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch11:
[3063331:MainThread](2024-04-25 04:13:04,157) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:13:11,034) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:13:11,237) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998974
[3063331:MainThread](2024-04-25 04:13:11,238) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch12:
[3063331:MainThread](2024-04-25 04:13:11,238) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:13:17,997) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:13:18,198) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997547
[3063331:MainThread](2024-04-25 04:13:18,198) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch13:
[3063331:MainThread](2024-04-25 04:13:18,198) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:13:24,976) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:13:25,178) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999903
[3063331:MainThread](2024-04-25 04:13:25,179) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch14:
[3063331:MainThread](2024-04-25 04:13:25,179) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:13:32,097) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:13:32,306) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.996810
[3063331:MainThread](2024-04-25 04:13:32,308) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch15:
[3063331:MainThread](2024-04-25 04:13:32,308) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:13:39,140) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:13:39,343) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997931
[3063331:MainThread](2024-04-25 04:13:39,343) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch16:
[3063331:MainThread](2024-04-25 04:13:39,344) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:13:46,022) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:13:46,225) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997387
[3063331:MainThread](2024-04-25 04:13:46,225) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch17:
[3063331:MainThread](2024-04-25 04:13:46,226) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:13:52,658) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:13:52,861) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997845
[3063331:MainThread](2024-04-25 04:13:52,862) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch18:
[3063331:MainThread](2024-04-25 04:13:52,862) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:13:59,206) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:13:59,407) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998168
[3063331:MainThread](2024-04-25 04:13:59,407) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch19:
[3063331:MainThread](2024-04-25 04:13:59,407) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:14:05,752) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:14:05,962) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998205
[3063331:MainThread](2024-04-25 04:14:05,962) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch20:
[3063331:MainThread](2024-04-25 04:14:05,962) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:14:12,334) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:14:12,535) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999322
[3063331:MainThread](2024-04-25 04:14:12,535) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch21:
[3063331:MainThread](2024-04-25 04:14:12,536) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:14:19,097) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:14:19,306) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998010
[3063331:MainThread](2024-04-25 04:14:19,306) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch22:
[3063331:MainThread](2024-04-25 04:14:19,307) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:14:26,125) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:14:26,330) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997367
[3063331:MainThread](2024-04-25 04:14:26,330) INFO - qlib.LSTM - [pytorch_lstm.py:283] - early stop
[3063331:MainThread](2024-04-25 04:14:26,331) INFO - qlib.LSTM - [pytorch_lstm.py:286] - best score: -0.996810 @ 14
[3063331:MainThread](2024-04-25 04:14:26,353) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to LSTM_crowd_data_csi300_360_rankTrue_49.
[3063331:MainThread](2024-04-25 04:14:26,629) INFO - qlib.workflow - [exp.py:258] - Experiment 41 starts running ...
[3063331:MainThread](2024-04-25 04:14:26,643) INFO - qlib.workflow - [recorder.py:341] - Recorder b9ca1334a7d24092b1325b343a7414bb starts running under Experiment 41 ...
{'IC': 0.00914099209964402,
 'ICIR': 0.05845702089707385,
 'Rank IC': 0.013941216326489713,
 'Rank ICIR': 0.07943257545531746}
[3063331:MainThread](2024-04-25 04:14:33,103) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3063331:MainThread](2024-04-25 04:15:09,998) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 04:15:10,001) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 04:15:15,951) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f84f976a430>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:40,  9.59it/s]backtest loop:   1%|          | 10/971 [00:00<00:34, 27.52it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 37.07it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.90it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:20, 47.05it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.81it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.61it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.74it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.80it/s]backtest loop:   6%|▌         | 60/971 [00:01<00:16, 55.41it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.57it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 57.11it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 58.86it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 56.25it/s]backtest loop:  10%|▉         | 93/971 [00:01<00:15, 57.21it/s]backtest loop:  10%|█         | 100/971 [00:01<00:14, 58.81it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.76it/s]backtest loop:  12%|█▏        | 113/971 [00:02<00:14, 57.47it/s]backtest loop:  12%|█▏        | 120/971 [00:02<00:14, 59.19it/s]backtest loop:  13%|█▎        | 126/971 [00:02<00:15, 52.95it/s]backtest loop:  14%|█▎        | 133/971 [00:02<00:15, 55.84it/s]backtest loop:  14%|█▍        | 140/971 [00:02<00:14, 57.90it/s]backtest loop:  15%|█▌        | 146/971 [00:02<00:14, 55.45it/s]backtest loop:  16%|█▌        | 153/971 [00:02<00:14, 57.60it/s]backtest loop:  16%|█▋        | 160/971 [00:03<00:13, 58.93it/s]backtest loop:  17%|█▋        | 166/971 [00:03<00:14, 56.20it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:13, 58.21it/s]backtest loop:  19%|█▊        | 180/971 [00:03<00:13, 59.66it/s]backtest loop:  19%|█▉        | 186/971 [00:03<00:13, 56.63it/s]backtest loop:  20%|█▉        | 193/971 [00:03<00:13, 58.34it/s]backtest loop:  21%|██        | 200/971 [00:03<00:13, 56.48it/s]backtest loop:  21%|██        | 206/971 [00:03<00:13, 57.21it/s]backtest loop:  22%|██▏       | 213/971 [00:03<00:13, 55.87it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 54.78it/s]backtest loop:  23%|██▎       | 226/971 [00:04<00:13, 56.06it/s]backtest loop:  24%|██▍       | 232/971 [00:04<00:19, 38.33it/s]backtest loop:  25%|██▍       | 239/971 [00:04<00:16, 43.77it/s]backtest loop:  25%|██▌       | 245/971 [00:04<00:16, 45.20it/s]backtest loop:  26%|██▌       | 251/971 [00:04<00:14, 48.59it/s]backtest loop:  27%|██▋       | 258/971 [00:04<00:13, 52.41it/s]backtest loop:  27%|██▋       | 264/971 [00:05<00:13, 51.67it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:13, 52.13it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:12, 55.12it/s]backtest loop:  29%|██▉       | 284/971 [00:05<00:12, 56.34it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 55.02it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 57.30it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:11, 55.73it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 57.75it/s]backtest loop:  33%|███▎      | 319/971 [00:06<00:11, 59.08it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:11, 56.22it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:10, 58.26it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 59.96it/s]backtest loop:  36%|███▌      | 346/971 [00:06<00:10, 57.20it/s]backtest loop:  36%|███▋      | 353/971 [00:06<00:10, 58.88it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 56.74it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.51it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 53.85it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:10, 56.08it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 57.91it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 55.89it/s]backtest loop:  41%|████      | 400/971 [00:07<00:09, 58.18it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 59.70it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:09, 56.73it/s]backtest loop:  43%|████▎     | 419/971 [00:07<00:09, 57.51it/s]backtest loop:  44%|████▍     | 426/971 [00:07<00:09, 59.15it/s]backtest loop:  44%|████▍     | 432/971 [00:08<00:09, 56.20it/s]backtest loop:  45%|████▌     | 439/971 [00:08<00:09, 58.19it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:08, 59.52it/s]backtest loop:  47%|████▋     | 452/971 [00:08<00:09, 56.09it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:08, 58.01it/s]backtest loop:  48%|████▊     | 466/971 [00:08<00:08, 59.41it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:08, 56.38it/s]backtest loop:  49%|████▉     | 478/971 [00:08<00:08, 57.25it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:08, 57.80it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:08, 55.22it/s]backtest loop:  51%|█████     | 497/971 [00:09<00:08, 57.51it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:07, 59.24it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:08, 56.29it/s]backtest loop:  53%|█████▎    | 516/971 [00:09<00:07, 57.23it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:08, 54.85it/s]backtest loop:  54%|█████▍    | 529/971 [00:09<00:07, 57.22it/s]backtest loop:  55%|█████▌    | 536/971 [00:09<00:07, 55.85it/s]backtest loop:  56%|█████▌    | 543/971 [00:09<00:07, 58.06it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 58.52it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:07, 56.46it/s]backtest loop:  58%|█████▊    | 563/971 [00:10<00:07, 58.25it/s]backtest loop:  59%|█████▊    | 570/971 [00:10<00:06, 59.41it/s]backtest loop:  59%|█████▉    | 576/971 [00:10<00:06, 56.44it/s]backtest loop:  60%|█████▉    | 582/971 [00:10<00:06, 57.31it/s]backtest loop:  61%|██████    | 589/971 [00:10<00:06, 58.94it/s]backtest loop:  61%|██████▏   | 596/971 [00:10<00:06, 56.80it/s]backtest loop:  62%|██████▏   | 603/971 [00:10<00:06, 58.57it/s]backtest loop:  63%|██████▎   | 610/971 [00:11<00:06, 56.50it/s]backtest loop:  63%|██████▎   | 616/971 [00:11<00:06, 57.28it/s]backtest loop:  64%|██████▍   | 623/971 [00:11<00:05, 58.78it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:05, 56.87it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:05, 58.58it/s]backtest loop:  66%|██████▋   | 644/971 [00:11<00:05, 59.84it/s]backtest loop:  67%|██████▋   | 651/971 [00:11<00:05, 57.18it/s]backtest loop:  68%|██████▊   | 658/971 [00:11<00:05, 58.71it/s]backtest loop:  68%|██████▊   | 665/971 [00:12<00:05, 56.57it/s]backtest loop:  69%|██████▉   | 672/971 [00:12<00:05, 58.33it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 56.41it/s]backtest loop:  71%|███████   | 686/971 [00:12<00:04, 58.11it/s]backtest loop:  71%|███████▏  | 693/971 [00:12<00:04, 59.48it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 56.61it/s]backtest loop:  73%|███████▎  | 706/971 [00:12<00:04, 58.40it/s]backtest loop:  73%|███████▎  | 713/971 [00:12<00:04, 59.72it/s]backtest loop:  74%|███████▍  | 719/971 [00:12<00:04, 57.07it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 58.88it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 56.26it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 54.30it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:03, 56.81it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 54.66it/s]backtest loop:  78%|███████▊  | 757/971 [00:13<00:03, 56.06it/s]backtest loop:  79%|███████▊  | 764/971 [00:13<00:03, 58.19it/s]backtest loop:  79%|███████▉  | 770/971 [00:13<00:03, 55.55it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 57.77it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 55.27it/s]backtest loop:  81%|████████▏ | 790/971 [00:14<00:03, 57.46it/s]backtest loop:  82%|████████▏ | 797/971 [00:14<00:02, 59.05it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:03, 55.99it/s]backtest loop:  83%|████████▎ | 810/971 [00:14<00:02, 57.90it/s]backtest loop:  84%|████████▍ | 817/971 [00:14<00:02, 59.34it/s]backtest loop:  85%|████████▍ | 823/971 [00:14<00:02, 56.38it/s]backtest loop:  85%|████████▌ | 830/971 [00:14<00:02, 58.18it/s]backtest loop:  86%|████████▌ | 837/971 [00:15<00:02, 59.56it/s]backtest loop:  87%|████████▋ | 843/971 [00:15<00:02, 56.51it/s]backtest loop:  88%|████████▊ | 850/971 [00:15<00:02, 58.22it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 56.30it/s]backtest loop:  89%|████████▉ | 864/971 [00:15<00:01, 58.03it/s]backtest loop:  90%|████████▉ | 871/971 [00:15<00:01, 59.45it/s]backtest loop:  90%|█████████ | 877/971 [00:15<00:01, 56.45it/s]backtest loop:  91%|█████████ | 884/971 [00:15<00:01, 58.34it/s]backtest loop:  92%|█████████▏| 891/971 [00:15<00:01, 59.70it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 56.67it/s]backtest loop:  93%|█████████▎| 904/971 [00:16<00:01, 58.47it/s]backtest loop:  94%|█████████▍| 911/971 [00:16<00:01, 59.80it/s]backtest loop:  94%|█████████▍| 917/971 [00:16<00:00, 56.73it/s]backtest loop:  95%|█████████▌| 924/971 [00:16<00:00, 58.51it/s]backtest loop:  96%|█████████▌| 931/971 [00:16<00:00, 56.58it/s]backtest loop:  97%|█████████▋| 938/971 [00:16<00:00, 58.28it/s]backtest loop:  97%|█████████▋| 945/971 [00:16<00:00, 56.37it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 58.43it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 59.60it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 56.65it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.93it/s]
[3063331:MainThread](2024-04-25 04:15:33,367) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000355
std                0.005764
annualized_return  0.084537
information_ratio  0.950749
max_drawdown      -0.167778
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000149
std                0.005764
annualized_return  0.035531
information_ratio  0.399578
max_drawdown      -0.196138
[3063331:MainThread](2024-04-25 04:15:33,379) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `LSTM_crowd_data_csi300_360_rankTrue`.
[3063331:MainThread](2024-04-25 04:15:40,192) INFO - qlib.timer - [log.py:127] - Time cost: 0.008s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.05891823804012103,
                                                    0.022926572555685015,
                                                    -0.05550433417881047,
                                                    -0.012567980593449053,
                                                    -0.005649080654276603,
                                                    0.0695912035666429,
                                                    0.035530501760830106],
 '1day.excess_return_with_cost.information_ratio': [0.8184259048224443,
                                                    0.30064223245350585,
                                                    -0.5339271082344875,
                                                    -0.152226770022929,
                                                    -0.05761185713768486,
                                                    0.9800193558356165,
                                                    0.3995784254421482],
 '1day.excess_return_with_cost.max_drawdown': [-0.07846232143476412,
                                               -0.10570945240542111,
                                               -0.4824232677837425,
                                               -0.25529562680435725,
                                               -0.3574695859945844,
                                               -0.06552375947562239,
                                               -0.19613843792954566],
 'IC': [0.029633086614531495,
        0.02574694121661612,
        0.013315832589728332,
        0.012958518389712228,
        0.01588291832584367,
        0.02944302842463128,
        0.00914099209964402],
 'ICIR': [0.23780975049045117,
          0.2141330839585906,
          0.09240673096781117,
          0.09827432529970663,
          0.11688319797213967,
          0.24326658526288497,
          0.05845702089707385],
 'Rank IC': [0.043422656604175304,
             0.03218351845141216,
             0.016324296576641695,
             0.01420673078031172,
             0.015615345030848294,
             0.04056717341283423,
             0.013941216326489713],
 'Rank ICIR': [0.349273660811528,
               0.26258111504674114,
               0.10110355733504273,
               0.10608327974210181,
               0.1084787038066814,
               0.32691885978453966,
               0.07943257545531746],
 'mae': [0.8636513547094068,
         0.864254717184863,
         0.8645593211325421,
         0.8648148057465549,
         0.8646410613775686,
         0.8637755331436053,
         0.8648061032816513],
 'mse': [0.997057058270892,
         0.9974504140999779,
         0.9979122563515013,
         0.9984265146409119,
         0.9987282034543231,
         0.9979906128632701,
         0.9978530146728194]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3063331:MainThread](2024-04-25 04:15:43,365) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[3063331:MainThread](2024-04-25 04:15:43,366) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3063331:MainThread](2024-04-25 04:15:46,235) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name LSTM_crowd_data_csi300_360_rankTrue_50.
[3063331:MainThread](2024-04-25 04:15:46,271) INFO - qlib.workflow - [exp.py:258] - Experiment 48 starts running ...
[3063331:MainThread](2024-04-25 04:15:46,285) INFO - qlib.workflow - [recorder.py:341] - Recorder 53f6477a890a45899cd2f118f2b0fe43 starts running under Experiment 48 ...
[3063331:MainThread](2024-04-25 04:15:51,448) INFO - qlib.LSTM - [pytorch_lstm.py:261] - training...
[3063331:MainThread](2024-04-25 04:15:51,449) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch0:
[3063331:MainThread](2024-04-25 04:15:51,449) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:15:57,892) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:15:58,094) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998059
[3063331:MainThread](2024-04-25 04:15:58,095) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch1:
[3063331:MainThread](2024-04-25 04:15:58,096) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:16:04,632) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:16:04,833) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998536
[3063331:MainThread](2024-04-25 04:16:04,834) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch2:
[3063331:MainThread](2024-04-25 04:16:04,834) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:16:11,534) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:16:11,737) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998586
[3063331:MainThread](2024-04-25 04:16:11,737) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch3:
[3063331:MainThread](2024-04-25 04:16:11,737) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:16:18,509) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:16:18,718) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999757
[3063331:MainThread](2024-04-25 04:16:18,718) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch4:
[3063331:MainThread](2024-04-25 04:16:18,718) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:16:25,286) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:16:25,492) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997350
[3063331:MainThread](2024-04-25 04:16:25,493) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch5:
[3063331:MainThread](2024-04-25 04:16:25,494) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:16:31,734) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:16:31,938) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.000062
[3063331:MainThread](2024-04-25 04:16:31,938) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch6:
[3063331:MainThread](2024-04-25 04:16:31,939) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:16:38,499) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:16:38,709) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998722
[3063331:MainThread](2024-04-25 04:16:38,710) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch7:
[3063331:MainThread](2024-04-25 04:16:38,710) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:16:45,155) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:16:45,359) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998520
[3063331:MainThread](2024-04-25 04:16:45,360) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch8:
[3063331:MainThread](2024-04-25 04:16:45,360) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:16:52,164) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:16:52,365) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999062
[3063331:MainThread](2024-04-25 04:16:52,365) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch9:
[3063331:MainThread](2024-04-25 04:16:52,366) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:16:59,035) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:16:59,235) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.000261
[3063331:MainThread](2024-04-25 04:16:59,235) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch10:
[3063331:MainThread](2024-04-25 04:16:59,236) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:17:05,844) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:17:06,053) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999427
[3063331:MainThread](2024-04-25 04:17:06,054) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch11:
[3063331:MainThread](2024-04-25 04:17:06,054) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:17:12,854) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:17:13,058) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997385
[3063331:MainThread](2024-04-25 04:17:13,059) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch12:
[3063331:MainThread](2024-04-25 04:17:13,059) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:17:19,393) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:17:19,594) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998113
[3063331:MainThread](2024-04-25 04:17:19,594) INFO - qlib.LSTM - [pytorch_lstm.py:283] - early stop
[3063331:MainThread](2024-04-25 04:17:19,594) INFO - qlib.LSTM - [pytorch_lstm.py:286] - best score: -0.997350 @ 4
[3063331:MainThread](2024-04-25 04:17:19,616) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to LSTM_crowd_data_csi300_360_rankTrue_50.
[3063331:MainThread](2024-04-25 04:17:19,961) INFO - qlib.workflow - [exp.py:258] - Experiment 41 starts running ...
[3063331:MainThread](2024-04-25 04:17:19,975) INFO - qlib.workflow - [recorder.py:341] - Recorder 6e51a28147bb4d0d8f300ccc16fbf88e starts running under Experiment 41 ...
{'IC': 0.019699291972305133,
 'ICIR': 0.14899931000785527,
 'Rank IC': 0.03001017117428144,
 'Rank ICIR': 0.22257326527388363}
[3063331:MainThread](2024-04-25 04:17:26,562) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3063331:MainThread](2024-04-25 04:18:03,729) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 04:18:03,732) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 04:18:09,814) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f857bcc8ee0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:42,  9.48it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.49it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 34.27it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 38.30it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 43.46it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 46.89it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 46.31it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:19, 48.67it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 50.66it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 49.08it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 51.20it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 52.50it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 53.44it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 54.10it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 51.70it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 53.04it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 53.70it/s]backtest loop:  11%|█         | 105/971 [00:02<00:15, 54.35it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:15, 54.82it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 51.55it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 52.77it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:16, 50.37it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:15, 52.59it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:16, 50.39it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:15, 51.81it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 52.96it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 53.79it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:14, 54.45it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 51.45it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:15, 52.65it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 53.52it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:14, 54.38it/s]backtest loop:  20%|██        | 195/971 [00:03<00:14, 51.76it/s]backtest loop:  21%|██        | 201/971 [00:04<00:14, 52.72it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:14, 53.82it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:14, 52.12it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:14, 53.58it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:14, 50.89it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:20, 35.42it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:18, 39.75it/s]backtest loop:  25%|██▌       | 243/971 [00:05<00:16, 43.47it/s]backtest loop:  26%|██▌       | 249/971 [00:05<00:16, 44.07it/s]backtest loop:  26%|██▋       | 255/971 [00:05<00:15, 47.03it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:14, 49.33it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:14, 48.29it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:13, 50.40it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:13, 51.69it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:12, 52.93it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:13, 50.68it/s]backtest loop:  31%|███       | 297/971 [00:06<00:12, 51.97it/s]backtest loop:  31%|███       | 303/971 [00:06<00:12, 53.01it/s]backtest loop:  32%|███▏      | 309/971 [00:06<00:12, 53.77it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:12, 50.94it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:12, 52.26it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:12, 53.32it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:11, 54.11it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:11, 54.79it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:12, 51.35it/s]backtest loop:  36%|███▌      | 351/971 [00:07<00:11, 52.75it/s]backtest loop:  37%|███▋      | 357/971 [00:07<00:11, 53.46it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:11, 50.68it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:12, 49.03it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 51.09it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:11, 52.37it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 53.47it/s]backtest loop:  40%|████      | 393/971 [00:07<00:11, 50.95it/s]backtest loop:  41%|████      | 399/971 [00:08<00:10, 52.35it/s]backtest loop:  42%|████▏     | 405/971 [00:08<00:10, 53.83it/s]backtest loop:  42%|████▏     | 411/971 [00:08<00:10, 54.51it/s]backtest loop:  43%|████▎     | 417/971 [00:08<00:10, 54.85it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:10, 51.76it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:10, 52.88it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:09, 53.68it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 54.24it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:10, 50.95it/s]backtest loop:  47%|████▋     | 453/971 [00:09<00:09, 52.28it/s]backtest loop:  47%|████▋     | 459/971 [00:09<00:09, 53.20it/s]backtest loop:  48%|████▊     | 465/971 [00:09<00:09, 53.88it/s]backtest loop:  49%|████▊     | 471/971 [00:09<00:09, 54.38it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 51.49it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:09, 52.53it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:09, 53.43it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:09, 51.02it/s]backtest loop:  52%|█████▏    | 501/971 [00:09<00:08, 52.28it/s]backtest loop:  52%|█████▏    | 507/971 [00:10<00:09, 50.41it/s]backtest loop:  53%|█████▎    | 513/971 [00:10<00:08, 51.87it/s]backtest loop:  53%|█████▎    | 519/971 [00:10<00:08, 53.02it/s]backtest loop:  54%|█████▍    | 525/971 [00:10<00:08, 53.88it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 50.83it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:08, 52.14it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:08, 53.19it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 53.94it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 54.66it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:07, 51.59it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:07, 52.71it/s]backtest loop:  59%|█████▉    | 573/971 [00:11<00:07, 53.53it/s]backtest loop:  60%|█████▉    | 579/971 [00:11<00:07, 54.14it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:07, 54.57it/s]backtest loop:  61%|██████    | 591/971 [00:11<00:07, 51.56it/s]backtest loop:  61%|██████▏   | 597/971 [00:11<00:07, 52.68it/s]backtest loop:  62%|██████▏   | 603/971 [00:11<00:06, 53.52it/s]backtest loop:  63%|██████▎   | 609/971 [00:11<00:06, 54.11it/s]backtest loop:  63%|██████▎   | 615/971 [00:12<00:07, 50.65it/s]backtest loop:  64%|██████▍   | 621/971 [00:12<00:06, 51.94it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:06, 53.05it/s]backtest loop:  65%|██████▌   | 633/971 [00:12<00:06, 53.87it/s]backtest loop:  66%|██████▌   | 639/971 [00:12<00:06, 54.51it/s]backtest loop:  66%|██████▋   | 645/971 [00:12<00:06, 51.47it/s]backtest loop:  67%|██████▋   | 651/971 [00:12<00:06, 52.58it/s]backtest loop:  68%|██████▊   | 657/971 [00:12<00:05, 53.41it/s]backtest loop:  68%|██████▊   | 663/971 [00:13<00:05, 54.00it/s]backtest loop:  69%|██████▉   | 669/971 [00:13<00:05, 54.44it/s]backtest loop:  70%|██████▉   | 675/971 [00:13<00:05, 51.42it/s]backtest loop:  70%|███████   | 681/971 [00:13<00:05, 52.62it/s]backtest loop:  71%|███████   | 687/971 [00:13<00:05, 53.33it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:05, 53.96it/s]backtest loop:  72%|███████▏  | 699/971 [00:13<00:05, 50.62it/s]backtest loop:  73%|███████▎  | 705/971 [00:13<00:05, 51.76it/s]backtest loop:  73%|███████▎  | 711/971 [00:13<00:04, 52.81it/s]backtest loop:  74%|███████▍  | 717/971 [00:14<00:04, 53.65it/s]backtest loop:  74%|███████▍  | 723/971 [00:14<00:04, 54.46it/s]backtest loop:  75%|███████▌  | 729/971 [00:14<00:04, 51.55it/s]backtest loop:  76%|███████▌  | 735/971 [00:14<00:04, 49.59it/s]backtest loop:  76%|███████▋  | 741/971 [00:14<00:04, 51.19it/s]backtest loop:  77%|███████▋  | 747/971 [00:14<00:04, 52.26it/s]backtest loop:  78%|███████▊  | 753/971 [00:14<00:04, 50.02it/s]backtest loop:  78%|███████▊  | 759/971 [00:14<00:04, 51.56it/s]backtest loop:  79%|███████▉  | 765/971 [00:15<00:04, 49.78it/s]backtest loop:  79%|███████▉  | 771/971 [00:15<00:03, 51.51it/s]backtest loop:  80%|████████  | 777/971 [00:15<00:03, 52.66it/s]backtest loop:  81%|████████  | 783/971 [00:15<00:03, 50.75it/s]backtest loop:  81%|████████▏ | 789/971 [00:15<00:03, 52.22it/s]backtest loop:  82%|████████▏ | 795/971 [00:15<00:03, 53.25it/s]backtest loop:  82%|████████▏ | 801/971 [00:15<00:03, 53.93it/s]backtest loop:  83%|████████▎ | 807/971 [00:15<00:03, 54.57it/s]backtest loop:  84%|████████▎ | 813/971 [00:15<00:03, 51.61it/s]backtest loop:  84%|████████▍ | 819/971 [00:16<00:02, 52.70it/s]backtest loop:  85%|████████▍ | 825/971 [00:16<00:02, 53.48it/s]backtest loop:  86%|████████▌ | 831/971 [00:16<00:02, 54.10it/s]backtest loop:  86%|████████▌ | 837/971 [00:16<00:02, 54.50it/s]backtest loop:  87%|████████▋ | 843/971 [00:16<00:02, 51.48it/s]backtest loop:  87%|████████▋ | 849/971 [00:16<00:02, 52.60it/s]backtest loop:  88%|████████▊ | 855/971 [00:16<00:02, 53.43it/s]backtest loop:  89%|████████▊ | 861/971 [00:16<00:02, 54.03it/s]backtest loop:  89%|████████▉ | 867/971 [00:16<00:02, 51.13it/s]backtest loop:  90%|████████▉ | 873/971 [00:17<00:01, 52.09it/s]backtest loop:  91%|█████████ | 879/971 [00:17<00:01, 53.04it/s]backtest loop:  91%|█████████ | 885/971 [00:17<00:01, 53.81it/s]backtest loop:  92%|█████████▏| 891/971 [00:17<00:01, 54.31it/s]backtest loop:  92%|█████████▏| 897/971 [00:17<00:01, 51.42it/s]backtest loop:  93%|█████████▎| 903/971 [00:17<00:01, 52.54it/s]backtest loop:  94%|█████████▎| 909/971 [00:17<00:01, 53.39it/s]backtest loop:  94%|█████████▍| 915/971 [00:17<00:01, 54.12it/s]backtest loop:  95%|█████████▍| 921/971 [00:17<00:00, 51.35it/s]backtest loop:  95%|█████████▌| 927/971 [00:18<00:00, 52.53it/s]backtest loop:  96%|█████████▌| 933/971 [00:18<00:00, 53.42it/s]backtest loop:  97%|█████████▋| 939/971 [00:18<00:00, 53.86it/s]backtest loop:  97%|█████████▋| 945/971 [00:18<00:00, 51.06it/s]backtest loop:  98%|█████████▊| 951/971 [00:18<00:00, 52.29it/s]backtest loop:  99%|█████████▊| 957/971 [00:18<00:00, 53.16it/s]backtest loop:  99%|█████████▉| 963/971 [00:18<00:00, 53.82it/s]backtest loop: 100%|█████████▉| 969/971 [00:18<00:00, 54.33it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 51.41it/s]
[3063331:MainThread](2024-04-25 04:18:28,760) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000337
std                0.004794
annualized_return  0.080222
information_ratio  1.084622
max_drawdown      -0.072408
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000138
std                0.004795
annualized_return  0.032861
information_ratio  0.444232
max_drawdown      -0.125624
[3063331:MainThread](2024-04-25 04:18:28,774) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `LSTM_crowd_data_csi300_360_rankTrue`.
[3063331:MainThread](2024-04-25 04:18:35,545) INFO - qlib.timer - [log.py:127] - Time cost: 0.008s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.05891823804012103,
                                                    0.022926572555685015,
                                                    -0.05550433417881047,
                                                    -0.012567980593449053,
                                                    -0.005649080654276603,
                                                    0.0695912035666429,
                                                    0.035530501760830106,
                                                    0.03286115814899971],
 '1day.excess_return_with_cost.information_ratio': [0.8184259048224443,
                                                    0.30064223245350585,
                                                    -0.5339271082344875,
                                                    -0.152226770022929,
                                                    -0.05761185713768486,
                                                    0.9800193558356165,
                                                    0.3995784254421482,
                                                    0.4442320693123457],
 '1day.excess_return_with_cost.max_drawdown': [-0.07846232143476412,
                                               -0.10570945240542111,
                                               -0.4824232677837425,
                                               -0.25529562680435725,
                                               -0.3574695859945844,
                                               -0.06552375947562239,
                                               -0.19613843792954566,
                                               -0.12562365234810519],
 'IC': [0.029633086614531495,
        0.02574694121661612,
        0.013315832589728332,
        0.012958518389712228,
        0.01588291832584367,
        0.02944302842463128,
        0.00914099209964402,
        0.019699291972305133],
 'ICIR': [0.23780975049045117,
          0.2141330839585906,
          0.09240673096781117,
          0.09827432529970663,
          0.11688319797213967,
          0.24326658526288497,
          0.05845702089707385,
          0.14899931000785527],
 'Rank IC': [0.043422656604175304,
             0.03218351845141216,
             0.016324296576641695,
             0.01420673078031172,
             0.015615345030848294,
             0.04056717341283423,
             0.013941216326489713,
             0.03001017117428144],
 'Rank ICIR': [0.349273660811528,
               0.26258111504674114,
               0.10110355733504273,
               0.10608327974210181,
               0.1084787038066814,
               0.32691885978453966,
               0.07943257545531746,
               0.22257326527388363],
 'mae': [0.8636513547094068,
         0.864254717184863,
         0.8645593211325421,
         0.8648148057465549,
         0.8646410613775686,
         0.8637755331436053,
         0.8648061032816513,
         0.864295886664761],
 'mse': [0.997057058270892,
         0.9974504140999779,
         0.9979122563515013,
         0.9984265146409119,
         0.9987282034543231,
         0.9979906128632701,
         0.9978530146728194,
         0.997901769532349]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3063331:MainThread](2024-04-25 04:18:38,703) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[3063331:MainThread](2024-04-25 04:18:38,703) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3063331:MainThread](2024-04-25 04:18:41,557) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name LSTM_crowd_data_csi300_360_rankTrue_51.
[3063331:MainThread](2024-04-25 04:18:41,595) INFO - qlib.workflow - [exp.py:258] - Experiment 49 starts running ...
[3063331:MainThread](2024-04-25 04:18:41,610) INFO - qlib.workflow - [recorder.py:341] - Recorder 5f838bd4e82445b8a5f5ee1b63586d43 starts running under Experiment 49 ...
[3063331:MainThread](2024-04-25 04:18:46,702) INFO - qlib.LSTM - [pytorch_lstm.py:261] - training...
[3063331:MainThread](2024-04-25 04:18:46,702) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch0:
[3063331:MainThread](2024-04-25 04:18:46,703) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:18:53,374) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:18:53,576) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998749
[3063331:MainThread](2024-04-25 04:18:53,577) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch1:
[3063331:MainThread](2024-04-25 04:18:53,577) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:19:00,128) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:19:00,332) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998496
[3063331:MainThread](2024-04-25 04:19:00,333) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch2:
[3063331:MainThread](2024-04-25 04:19:00,333) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:19:06,776) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:19:06,978) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997056
[3063331:MainThread](2024-04-25 04:19:06,979) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch3:
[3063331:MainThread](2024-04-25 04:19:06,979) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:19:13,430) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:19:13,630) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998343
[3063331:MainThread](2024-04-25 04:19:13,630) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch4:
[3063331:MainThread](2024-04-25 04:19:13,631) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:19:20,064) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:19:20,265) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998229
[3063331:MainThread](2024-04-25 04:19:20,265) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch5:
[3063331:MainThread](2024-04-25 04:19:20,266) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:19:26,589) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:19:26,796) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997738
[3063331:MainThread](2024-04-25 04:19:26,797) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch6:
[3063331:MainThread](2024-04-25 04:19:26,797) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:19:33,394) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:19:33,603) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998110
[3063331:MainThread](2024-04-25 04:19:33,604) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch7:
[3063331:MainThread](2024-04-25 04:19:33,604) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:19:40,360) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:19:40,564) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997323
[3063331:MainThread](2024-04-25 04:19:40,564) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch8:
[3063331:MainThread](2024-04-25 04:19:40,565) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:19:47,358) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:19:47,560) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997497
[3063331:MainThread](2024-04-25 04:19:47,560) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch9:
[3063331:MainThread](2024-04-25 04:19:47,560) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:19:54,170) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:19:54,379) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.996531
[3063331:MainThread](2024-04-25 04:19:54,380) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch10:
[3063331:MainThread](2024-04-25 04:19:54,380) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:20:01,356) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:20:01,565) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999387
[3063331:MainThread](2024-04-25 04:20:01,566) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch11:
[3063331:MainThread](2024-04-25 04:20:01,566) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:20:08,530) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:20:08,734) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997185
[3063331:MainThread](2024-04-25 04:20:08,734) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch12:
[3063331:MainThread](2024-04-25 04:20:08,735) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:20:15,613) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:20:15,817) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.996538
[3063331:MainThread](2024-04-25 04:20:15,817) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch13:
[3063331:MainThread](2024-04-25 04:20:15,817) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:20:22,126) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:20:22,329) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999359
[3063331:MainThread](2024-04-25 04:20:22,330) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch14:
[3063331:MainThread](2024-04-25 04:20:22,330) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:20:28,582) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:20:28,782) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999577
[3063331:MainThread](2024-04-25 04:20:28,783) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch15:
[3063331:MainThread](2024-04-25 04:20:28,783) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:20:35,481) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:20:35,682) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999015
[3063331:MainThread](2024-04-25 04:20:35,682) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch16:
[3063331:MainThread](2024-04-25 04:20:35,683) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:20:42,119) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:20:42,319) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999664
[3063331:MainThread](2024-04-25 04:20:42,320) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch17:
[3063331:MainThread](2024-04-25 04:20:42,320) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:20:48,771) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:20:48,973) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998287
[3063331:MainThread](2024-04-25 04:20:48,973) INFO - qlib.LSTM - [pytorch_lstm.py:283] - early stop
[3063331:MainThread](2024-04-25 04:20:48,973) INFO - qlib.LSTM - [pytorch_lstm.py:286] - best score: -0.996531 @ 9
[3063331:MainThread](2024-04-25 04:20:48,998) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to LSTM_crowd_data_csi300_360_rankTrue_51.
[3063331:MainThread](2024-04-25 04:20:49,272) INFO - qlib.workflow - [exp.py:258] - Experiment 41 starts running ...
[3063331:MainThread](2024-04-25 04:20:49,287) INFO - qlib.workflow - [recorder.py:341] - Recorder bf6bf3de66cb4e1d9332f5ae51441e01 starts running under Experiment 41 ...
{'IC': 0.022176834801100553,
 'ICIR': 0.1679139241314835,
 'Rank IC': 0.03221801295452029,
 'Rank ICIR': 0.2428827890144363}
[3063331:MainThread](2024-04-25 04:20:55,617) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3063331:MainThread](2024-04-25 04:21:32,651) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 04:21:32,654) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 04:21:38,688) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f857bba59a0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:44,  9.29it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 24.04it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 33.84it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:25, 37.80it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:22, 42.45it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 45.82it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 45.47it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:19, 48.22it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 49.56it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:19, 48.05it/s]backtest loop:   6%|▋         | 62/971 [00:01<00:18, 48.17it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 52.61it/s]backtest loop:   8%|▊         | 76/971 [00:01<00:16, 55.64it/s]backtest loop:   8%|▊         | 82/971 [00:01<00:16, 53.79it/s]backtest loop:   9%|▉         | 89/971 [00:01<00:15, 56.28it/s]backtest loop:  10%|▉         | 95/971 [00:02<00:15, 57.14it/s]backtest loop:  10%|█         | 101/971 [00:02<00:15, 57.81it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 55.03it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:15, 57.10it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 58.88it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:16, 52.48it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:15, 55.47it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 54.54it/s]backtest loop:  15%|█▌        | 147/971 [00:02<00:14, 55.75it/s]backtest loop:  16%|█▌        | 154/971 [00:03<00:14, 57.58it/s]backtest loop:  16%|█▋        | 160/971 [00:03<00:14, 57.75it/s]backtest loop:  17%|█▋        | 166/971 [00:03<00:14, 55.00it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:13, 57.05it/s]backtest loop:  19%|█▊        | 180/971 [00:03<00:13, 58.68it/s]backtest loop:  19%|█▉        | 186/971 [00:03<00:14, 55.82it/s]backtest loop:  20%|█▉        | 193/971 [00:03<00:13, 57.78it/s]backtest loop:  21%|██        | 200/971 [00:03<00:13, 56.07it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:13, 57.92it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:14, 51.57it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:15, 49.88it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:15, 47.62it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:23, 31.72it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:21, 33.88it/s]backtest loop:  25%|██▍       | 241/971 [00:04<00:18, 38.61it/s]backtest loop:  25%|██▌       | 247/971 [00:05<00:16, 42.74it/s]backtest loop:  26%|██▌       | 253/971 [00:05<00:15, 46.35it/s]backtest loop:  27%|██▋       | 259/971 [00:05<00:16, 44.37it/s]backtest loop:  27%|██▋       | 265/971 [00:05<00:14, 47.49it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:14, 47.10it/s]backtest loop:  29%|██▊       | 277/971 [00:05<00:14, 49.31it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:13, 51.06it/s]backtest loop:  30%|██▉       | 289/971 [00:05<00:13, 52.36it/s]backtest loop:  30%|███       | 295/971 [00:06<00:13, 50.10it/s]backtest loop:  31%|███       | 301/971 [00:06<00:13, 51.36it/s]backtest loop:  32%|███▏      | 307/971 [00:06<00:12, 53.11it/s]backtest loop:  32%|███▏      | 313/971 [00:06<00:12, 54.49it/s]backtest loop:  33%|███▎      | 319/971 [00:06<00:12, 54.13it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:14, 46.01it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:14, 43.60it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:14, 42.50it/s]backtest loop:  35%|███▌      | 340/971 [00:07<00:15, 41.75it/s]backtest loop:  36%|███▌      | 346/971 [00:07<00:13, 45.47it/s]backtest loop:  36%|███▋      | 353/971 [00:07<00:12, 50.63it/s]backtest loop:  37%|███▋      | 360/971 [00:07<00:11, 51.27it/s]backtest loop:  38%|███▊      | 367/971 [00:07<00:11, 51.67it/s]backtest loop:  38%|███▊      | 373/971 [00:07<00:11, 51.20it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:10, 54.43it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 56.84it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 54.76it/s]backtest loop:  41%|████      | 400/971 [00:08<00:09, 57.17it/s]backtest loop:  42%|████▏     | 407/971 [00:08<00:09, 58.91it/s]backtest loop:  43%|████▎     | 413/971 [00:08<00:09, 56.00it/s]backtest loop:  43%|████▎     | 420/971 [00:08<00:09, 57.92it/s]backtest loop:  44%|████▍     | 427/971 [00:08<00:09, 59.37it/s]backtest loop:  45%|████▍     | 433/971 [00:08<00:09, 56.38it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:09, 58.40it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 56.58it/s]backtest loop:  47%|████▋     | 454/971 [00:09<00:08, 58.43it/s]backtest loop:  47%|████▋     | 461/971 [00:09<00:08, 59.73it/s]backtest loop:  48%|████▊     | 468/971 [00:09<00:08, 57.42it/s]backtest loop:  49%|████▉     | 475/971 [00:09<00:08, 59.07it/s]backtest loop:  50%|████▉     | 482/971 [00:09<00:08, 56.91it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:08, 58.32it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:08, 55.79it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:08, 58.01it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:08, 55.72it/s]backtest loop:  53%|█████▎    | 515/971 [00:10<00:07, 57.86it/s]backtest loop:  54%|█████▍    | 522/971 [00:10<00:07, 56.17it/s]backtest loop:  54%|█████▍    | 529/971 [00:10<00:07, 58.06it/s]backtest loop:  55%|█████▌    | 536/971 [00:10<00:07, 56.45it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:07, 58.43it/s]backtest loop:  57%|█████▋    | 550/971 [00:10<00:07, 59.80it/s]backtest loop:  57%|█████▋    | 557/971 [00:10<00:07, 57.47it/s]backtest loop:  58%|█████▊    | 563/971 [00:10<00:07, 57.77it/s]backtest loop:  59%|█████▊    | 569/971 [00:11<00:06, 57.82it/s]backtest loop:  59%|█████▉    | 575/971 [00:11<00:06, 58.28it/s]backtest loop:  60%|█████▉    | 581/971 [00:11<00:07, 52.29it/s]backtest loop:  60%|██████    | 587/971 [00:11<00:07, 52.33it/s]backtest loop:  61%|██████    | 593/971 [00:11<00:07, 53.19it/s]backtest loop:  62%|██████▏   | 599/971 [00:11<00:06, 53.36it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:07, 49.58it/s]backtest loop:  63%|██████▎   | 611/971 [00:11<00:07, 51.13it/s]backtest loop:  64%|██████▎   | 617/971 [00:11<00:06, 52.24it/s]backtest loop:  64%|██████▍   | 623/971 [00:12<00:06, 53.25it/s]backtest loop:  65%|██████▍   | 629/971 [00:12<00:06, 53.92it/s]backtest loop:  65%|██████▌   | 635/971 [00:12<00:06, 51.37it/s]backtest loop:  66%|██████▌   | 641/971 [00:12<00:06, 52.55it/s]backtest loop:  67%|██████▋   | 647/971 [00:12<00:06, 53.26it/s]backtest loop:  67%|██████▋   | 653/971 [00:12<00:05, 53.84it/s]backtest loop:  68%|██████▊   | 659/971 [00:12<00:05, 54.24it/s]backtest loop:  68%|██████▊   | 665/971 [00:12<00:05, 51.21it/s]backtest loop:  69%|██████▉   | 671/971 [00:12<00:05, 52.17it/s]backtest loop:  70%|██████▉   | 677/971 [00:13<00:05, 52.94it/s]backtest loop:  70%|███████   | 683/971 [00:13<00:05, 53.35it/s]backtest loop:  71%|███████   | 689/971 [00:13<00:05, 50.64it/s]backtest loop:  72%|███████▏  | 695/971 [00:13<00:05, 51.89it/s]backtest loop:  72%|███████▏  | 701/971 [00:13<00:05, 52.92it/s]backtest loop:  73%|███████▎  | 707/971 [00:13<00:04, 53.66it/s]backtest loop:  73%|███████▎  | 713/971 [00:13<00:04, 54.14it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 51.25it/s]backtest loop:  75%|███████▍  | 725/971 [00:13<00:04, 52.36it/s]backtest loop:  75%|███████▌  | 731/971 [00:14<00:04, 50.13it/s]backtest loop:  76%|███████▌  | 737/971 [00:14<00:04, 51.58it/s]backtest loop:  77%|███████▋  | 743/971 [00:14<00:04, 49.53it/s]backtest loop:  77%|███████▋  | 749/971 [00:14<00:04, 51.13it/s]backtest loop:  78%|███████▊  | 755/971 [00:14<00:04, 49.32it/s]backtest loop:  78%|███████▊  | 761/971 [00:14<00:04, 50.73it/s]backtest loop:  79%|███████▉  | 767/971 [00:14<00:03, 52.18it/s]backtest loop:  80%|███████▉  | 773/971 [00:14<00:03, 53.08it/s]backtest loop:  80%|████████  | 779/971 [00:15<00:03, 53.79it/s]backtest loop:  81%|████████  | 785/971 [00:15<00:03, 51.02it/s]backtest loop:  81%|████████▏ | 791/971 [00:15<00:03, 52.32it/s]backtest loop:  82%|████████▏ | 797/971 [00:15<00:03, 53.18it/s]backtest loop:  83%|████████▎ | 803/971 [00:15<00:03, 50.54it/s]backtest loop:  83%|████████▎ | 809/971 [00:15<00:03, 51.82it/s]backtest loop:  84%|████████▍ | 815/971 [00:15<00:02, 52.04it/s]backtest loop:  85%|████████▍ | 821/971 [00:15<00:02, 52.96it/s]backtest loop:  85%|████████▌ | 827/971 [00:15<00:02, 53.62it/s]backtest loop:  86%|████████▌ | 833/971 [00:16<00:02, 50.81it/s]backtest loop:  86%|████████▋ | 839/971 [00:16<00:02, 52.16it/s]backtest loop:  87%|████████▋ | 845/971 [00:16<00:02, 52.32it/s]backtest loop:  88%|████████▊ | 851/971 [00:16<00:02, 53.11it/s]backtest loop:  88%|████████▊ | 857/971 [00:16<00:02, 50.57it/s]backtest loop:  89%|████████▉ | 863/971 [00:16<00:02, 52.00it/s]backtest loop:  89%|████████▉ | 869/971 [00:16<00:01, 52.95it/s]backtest loop:  90%|█████████ | 875/971 [00:16<00:01, 53.60it/s]backtest loop:  91%|█████████ | 881/971 [00:16<00:01, 54.06it/s]backtest loop:  91%|█████████▏| 887/971 [00:17<00:01, 51.19it/s]backtest loop:  92%|█████████▏| 893/971 [00:17<00:01, 52.33it/s]backtest loop:  93%|█████████▎| 899/971 [00:17<00:01, 53.11it/s]backtest loop:  93%|█████████▎| 905/971 [00:17<00:01, 53.73it/s]backtest loop:  94%|█████████▍| 911/971 [00:17<00:01, 54.16it/s]backtest loop:  94%|█████████▍| 917/971 [00:17<00:01, 51.28it/s]backtest loop:  95%|█████████▌| 923/971 [00:17<00:00, 52.46it/s]backtest loop:  96%|█████████▌| 929/971 [00:17<00:00, 53.32it/s]backtest loop:  96%|█████████▋| 935/971 [00:18<00:00, 54.09it/s]backtest loop:  97%|█████████▋| 941/971 [00:18<00:00, 50.49it/s]backtest loop:  98%|█████████▊| 947/971 [00:18<00:00, 51.96it/s]backtest loop:  98%|█████████▊| 953/971 [00:18<00:00, 52.98it/s]backtest loop:  99%|█████████▉| 959/971 [00:18<00:00, 53.84it/s]backtest loop:  99%|█████████▉| 965/971 [00:18<00:00, 51.02it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 52.26it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 51.88it/s]
[3063331:MainThread](2024-04-25 04:21:57,465) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000457
std                0.004856
annualized_return  0.108775
information_ratio  1.452001
max_drawdown      -0.070307
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000257
std                0.004857
annualized_return  0.061263
information_ratio  0.817618
max_drawdown      -0.084395
[3063331:MainThread](2024-04-25 04:21:57,478) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `LSTM_crowd_data_csi300_360_rankTrue`.
[3063331:MainThread](2024-04-25 04:22:04,284) INFO - qlib.timer - [log.py:127] - Time cost: 0.008s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.05891823804012103,
                                                    0.022926572555685015,
                                                    -0.05550433417881047,
                                                    -0.012567980593449053,
                                                    -0.005649080654276603,
                                                    0.0695912035666429,
                                                    0.035530501760830106,
                                                    0.03286115814899971,
                                                    0.0612632706915804],
 '1day.excess_return_with_cost.information_ratio': [0.8184259048224443,
                                                    0.30064223245350585,
                                                    -0.5339271082344875,
                                                    -0.152226770022929,
                                                    -0.05761185713768486,
                                                    0.9800193558356165,
                                                    0.3995784254421482,
                                                    0.4442320693123457,
                                                    0.8176180573906947],
 '1day.excess_return_with_cost.max_drawdown': [-0.07846232143476412,
                                               -0.10570945240542111,
                                               -0.4824232677837425,
                                               -0.25529562680435725,
                                               -0.3574695859945844,
                                               -0.06552375947562239,
                                               -0.19613843792954566,
                                               -0.12562365234810519,
                                               -0.08439548470643693],
 'IC': [0.029633086614531495,
        0.02574694121661612,
        0.013315832589728332,
        0.012958518389712228,
        0.01588291832584367,
        0.02944302842463128,
        0.00914099209964402,
        0.019699291972305133,
        0.022176834801100553],
 'ICIR': [0.23780975049045117,
          0.2141330839585906,
          0.09240673096781117,
          0.09827432529970663,
          0.11688319797213967,
          0.24326658526288497,
          0.05845702089707385,
          0.14899931000785527,
          0.1679139241314835],
 'Rank IC': [0.043422656604175304,
             0.03218351845141216,
             0.016324296576641695,
             0.01420673078031172,
             0.015615345030848294,
             0.04056717341283423,
             0.013941216326489713,
             0.03001017117428144,
             0.03221801295452029],
 'Rank ICIR': [0.349273660811528,
               0.26258111504674114,
               0.10110355733504273,
               0.10608327974210181,
               0.1084787038066814,
               0.32691885978453966,
               0.07943257545531746,
               0.22257326527388363,
               0.2428827890144363],
 'mae': [0.8636513547094068,
         0.864254717184863,
         0.8645593211325421,
         0.8648148057465549,
         0.8646410613775686,
         0.8637755331436053,
         0.8648061032816513,
         0.864295886664761,
         0.8640359898145943],
 'mse': [0.997057058270892,
         0.9974504140999779,
         0.9979122563515013,
         0.9984265146409119,
         0.9987282034543231,
         0.9979906128632701,
         0.9978530146728194,
         0.997901769532349,
         0.9972783340501211]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3063331:MainThread](2024-04-25 04:22:07,454) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[3063331:MainThread](2024-04-25 04:22:07,454) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3063331:MainThread](2024-04-25 04:22:10,286) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name LSTM_crowd_data_csi300_360_rankTrue_52.
[3063331:MainThread](2024-04-25 04:22:10,325) INFO - qlib.workflow - [exp.py:258] - Experiment 50 starts running ...
[3063331:MainThread](2024-04-25 04:22:10,339) INFO - qlib.workflow - [recorder.py:341] - Recorder 910c2a698a3442618c0aa64c160002ad starts running under Experiment 50 ...
[3063331:MainThread](2024-04-25 04:22:17,332) INFO - qlib.LSTM - [pytorch_lstm.py:261] - training...
[3063331:MainThread](2024-04-25 04:22:17,332) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch0:
[3063331:MainThread](2024-04-25 04:22:17,332) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:22:23,895) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:22:24,095) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998384
[3063331:MainThread](2024-04-25 04:22:24,097) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch1:
[3063331:MainThread](2024-04-25 04:22:24,097) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:22:30,438) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:22:30,637) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997229
[3063331:MainThread](2024-04-25 04:22:30,638) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch2:
[3063331:MainThread](2024-04-25 04:22:30,639) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:22:36,871) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:22:37,070) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.996235
[3063331:MainThread](2024-04-25 04:22:37,071) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch3:
[3063331:MainThread](2024-04-25 04:22:37,071) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:22:43,536) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:22:43,735) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998719
[3063331:MainThread](2024-04-25 04:22:43,736) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch4:
[3063331:MainThread](2024-04-25 04:22:43,736) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:22:50,473) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:22:50,672) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.997629
[3063331:MainThread](2024-04-25 04:22:50,673) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch5:
[3063331:MainThread](2024-04-25 04:22:50,673) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:22:57,121) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:22:57,321) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999319
[3063331:MainThread](2024-04-25 04:22:57,321) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch6:
[3063331:MainThread](2024-04-25 04:22:57,322) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:23:04,154) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:23:04,357) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.996863
[3063331:MainThread](2024-04-25 04:23:04,357) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch7:
[3063331:MainThread](2024-04-25 04:23:04,358) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:23:10,739) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:23:10,939) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -1.001108
[3063331:MainThread](2024-04-25 04:23:10,939) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch8:
[3063331:MainThread](2024-04-25 04:23:10,940) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:23:17,825) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:23:18,034) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998523
[3063331:MainThread](2024-04-25 04:23:18,034) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch9:
[3063331:MainThread](2024-04-25 04:23:18,035) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:23:25,054) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:23:25,266) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.998975
[3063331:MainThread](2024-04-25 04:23:25,267) INFO - qlib.LSTM - [pytorch_lstm.py:265] - Epoch10:
[3063331:MainThread](2024-04-25 04:23:25,267) INFO - qlib.LSTM - [pytorch_lstm.py:266] - training...
[3063331:MainThread](2024-04-25 04:23:32,251) INFO - qlib.LSTM - [pytorch_lstm.py:268] - evaluating...
[3063331:MainThread](2024-04-25 04:23:32,452) INFO - qlib.LSTM - [pytorch_lstm.py:271] - valid -0.999014
[3063331:MainThread](2024-04-25 04:23:32,452) INFO - qlib.LSTM - [pytorch_lstm.py:283] - early stop
[3063331:MainThread](2024-04-25 04:23:32,453) INFO - qlib.LSTM - [pytorch_lstm.py:286] - best score: -0.996235 @ 2
[3063331:MainThread](2024-04-25 04:23:32,474) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
Save pretrained model to LSTM_crowd_data_csi300_360_rankTrue_52.
[3063331:MainThread](2024-04-25 04:23:32,713) INFO - qlib.workflow - [exp.py:258] - Experiment 41 starts running ...
[3063331:MainThread](2024-04-25 04:23:32,728) INFO - qlib.workflow - [recorder.py:341] - Recorder 2521043dfffb4831953ea09055027ee3 starts running under Experiment 41 ...
{'IC': 0.026371188533125728,
 'ICIR': 0.22576564787310122,
 'Rank IC': 0.0341300441930608,
 'Rank ICIR': 0.28489969217415423}
[3063331:MainThread](2024-04-25 04:23:38,470) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3063331:MainThread](2024-04-25 04:24:15,636) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 04:24:15,639) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3063331:MainThread](2024-04-25 04:24:21,620) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8580e361c0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:39,  9.70it/s]backtest loop:   1%|          | 10/971 [00:00<00:34, 27.67it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:25, 36.85it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:22, 42.44it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:19, 48.36it/s]backtest loop:   4%|▍         | 38/971 [00:00<00:17, 52.64it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:17, 51.83it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:16, 55.06it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 53.55it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:15, 56.84it/s]backtest loop:   7%|▋         | 70/971 [00:01<00:15, 57.55it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:16, 55.84it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 57.98it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 59.56it/s]backtest loop:  10%|█         | 98/971 [00:01<00:15, 57.34it/s]backtest loop:  11%|█         | 105/971 [00:02<00:14, 58.94it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 56.92it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:14, 58.61it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 56.19it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 54.25it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:14, 56.75it/s]backtest loop:  15%|█▍        | 145/971 [00:02<00:14, 58.49it/s]backtest loop:  16%|█▌        | 151/971 [00:02<00:14, 55.86it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:14, 57.76it/s]backtest loop:  17%|█▋        | 164/971 [00:03<00:13, 57.94it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:14, 56.08it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:13, 58.03it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:13, 56.33it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:13, 58.25it/s]backtest loop:  20%|██        | 199/971 [00:03<00:12, 59.98it/s]backtest loop:  21%|██        | 206/971 [00:03<00:13, 57.61it/s]backtest loop:  22%|██▏       | 213/971 [00:03<00:13, 56.18it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 55.12it/s]backtest loop:  23%|██▎       | 226/971 [00:04<00:19, 38.58it/s]backtest loop:  24%|██▍       | 233/971 [00:04<00:16, 43.83it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:15, 46.23it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:14, 50.28it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:14, 51.09it/s]backtest loop:  27%|██▋       | 261/971 [00:04<00:13, 54.36it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:13, 53.19it/s]backtest loop:  28%|██▊       | 274/971 [00:05<00:12, 56.02it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:12, 54.99it/s]backtest loop:  30%|██▉       | 288/971 [00:05<00:11, 57.10it/s]backtest loop:  30%|███       | 295/971 [00:05<00:12, 55.68it/s]backtest loop:  31%|███       | 302/971 [00:05<00:11, 57.71it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 59.26it/s]backtest loop:  32%|███▏      | 315/971 [00:05<00:11, 56.28it/s]backtest loop:  33%|███▎      | 322/971 [00:06<00:11, 58.55it/s]backtest loop:  34%|███▍      | 329/971 [00:06<00:10, 60.12it/s]backtest loop:  35%|███▍      | 336/971 [00:06<00:10, 57.85it/s]backtest loop:  35%|███▌      | 343/971 [00:06<00:10, 59.32it/s]backtest loop:  36%|███▌      | 349/971 [00:06<00:10, 59.18it/s]backtest loop:  37%|███▋      | 355/971 [00:06<00:10, 56.24it/s]backtest loop:  37%|███▋      | 362/971 [00:06<00:10, 58.45it/s]backtest loop:  38%|███▊      | 368/971 [00:06<00:11, 52.86it/s]backtest loop:  39%|███▊      | 375/971 [00:06<00:10, 55.75it/s]backtest loop:  39%|███▉      | 382/971 [00:07<00:10, 57.92it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:10, 55.52it/s]backtest loop:  41%|████      | 395/971 [00:07<00:09, 57.86it/s]backtest loop:  41%|████▏     | 402/971 [00:07<00:09, 59.45it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:09, 57.23it/s]backtest loop:  43%|████▎     | 415/971 [00:07<00:09, 58.75it/s]backtest loop:  43%|████▎     | 422/971 [00:07<00:09, 60.00it/s]backtest loop:  44%|████▍     | 429/971 [00:07<00:09, 57.61it/s]backtest loop:  45%|████▍     | 436/971 [00:08<00:09, 59.27it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:09, 56.52it/s]backtest loop:  46%|████▌     | 449/971 [00:08<00:09, 57.91it/s]backtest loop:  47%|████▋     | 456/971 [00:08<00:08, 59.36it/s]backtest loop:  48%|████▊     | 462/971 [00:08<00:09, 56.37it/s]backtest loop:  48%|████▊     | 469/971 [00:08<00:08, 58.28it/s]backtest loop:  49%|████▉     | 476/971 [00:08<00:08, 59.77it/s]backtest loop:  50%|████▉     | 482/971 [00:08<00:08, 56.55it/s]backtest loop:  50%|█████     | 489/971 [00:08<00:08, 58.67it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:08, 55.93it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:08, 58.11it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:08, 55.70it/s]backtest loop:  53%|█████▎    | 515/971 [00:09<00:07, 57.85it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:07, 56.15it/s]backtest loop:  54%|█████▍    | 529/971 [00:09<00:07, 58.19it/s]backtest loop:  55%|█████▌    | 536/971 [00:09<00:07, 56.57it/s]backtest loop:  56%|█████▌    | 543/971 [00:09<00:07, 58.70it/s]backtest loop:  57%|█████▋    | 549/971 [00:09<00:07, 58.69it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:07, 56.64it/s]backtest loop:  58%|█████▊    | 563/971 [00:10<00:06, 58.42it/s]backtest loop:  59%|█████▊    | 570/971 [00:10<00:06, 59.74it/s]backtest loop:  59%|█████▉    | 577/971 [00:10<00:06, 57.73it/s]backtest loop:  60%|██████    | 584/971 [00:10<00:06, 59.21it/s]backtest loop:  61%|██████    | 591/971 [00:10<00:06, 57.05it/s]backtest loop:  62%|██████▏   | 598/971 [00:10<00:06, 58.68it/s]backtest loop:  62%|██████▏   | 605/971 [00:10<00:06, 56.70it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 58.45it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:05, 59.73it/s]backtest loop:  64%|██████▍   | 626/971 [00:11<00:06, 57.32it/s]backtest loop:  65%|██████▌   | 633/971 [00:11<00:05, 59.11it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:05, 57.25it/s]backtest loop:  67%|██████▋   | 646/971 [00:11<00:05, 57.73it/s]backtest loop:  67%|██████▋   | 653/971 [00:11<00:05, 59.24it/s]backtest loop:  68%|██████▊   | 660/971 [00:11<00:05, 57.07it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 58.73it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:05, 56.63it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:04, 58.38it/s]backtest loop:  71%|███████   | 688/971 [00:12<00:04, 59.59it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:04, 56.53it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 58.46it/s]backtest loop:  73%|███████▎  | 708/971 [00:12<00:04, 59.79it/s]backtest loop:  74%|███████▎  | 715/971 [00:12<00:04, 57.39it/s]backtest loop:  74%|███████▍  | 722/971 [00:12<00:04, 59.05it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 57.11it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 54.90it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 55.90it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.76it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 53.96it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 56.56it/s]backtest loop:  79%|███████▉  | 769/971 [00:13<00:03, 58.42it/s]backtest loop:  80%|███████▉  | 775/971 [00:13<00:03, 55.85it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 58.03it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 55.60it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.83it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 59.29it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 56.33it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 58.16it/s]backtest loop:  85%|████████▍ | 822/971 [00:14<00:02, 59.54it/s]backtest loop:  85%|████████▌ | 828/971 [00:14<00:02, 56.46it/s]backtest loop:  86%|████████▌ | 835/971 [00:14<00:02, 57.73it/s]backtest loop:  87%|████████▋ | 842/971 [00:15<00:02, 59.25it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 56.28it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:01, 58.30it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 56.35it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 58.10it/s]backtest loop:  90%|█████████ | 876/971 [00:15<00:01, 59.53it/s]backtest loop:  91%|█████████ | 882/971 [00:15<00:01, 56.57it/s]backtest loop:  92%|█████████▏| 889/971 [00:15<00:01, 58.37it/s]backtest loop:  92%|█████████▏| 896/971 [00:15<00:01, 59.63it/s]backtest loop:  93%|█████████▎| 902/971 [00:16<00:01, 56.59it/s]backtest loop:  94%|█████████▎| 909/971 [00:16<00:01, 58.35it/s]backtest loop:  94%|█████████▍| 916/971 [00:16<00:00, 56.45it/s]backtest loop:  95%|█████████▌| 923/971 [00:16<00:00, 58.25it/s]backtest loop:  96%|█████████▌| 930/971 [00:16<00:00, 59.61it/s]backtest loop:  96%|█████████▋| 936/971 [00:16<00:00, 55.92it/s]backtest loop:  97%|█████████▋| 943/971 [00:16<00:00, 57.88it/s]backtest loop:  98%|█████████▊| 950/971 [00:16<00:00, 55.97it/s]backtest loop:  99%|█████████▊| 957/971 [00:17<00:00, 58.01it/s]backtest loop:  99%|█████████▉| 964/971 [00:17<00:00, 59.50it/s]backtest loop: 100%|█████████▉| 970/971 [00:17<00:00, 56.94it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 56.15it/s]
[3063331:MainThread](2024-04-25 04:24:38,971) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000194
std                0.004454
annualized_return  0.046276
information_ratio  0.673477
max_drawdown      -0.072563
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean              -0.000002
std                0.004455
annualized_return -0.000464
information_ratio -0.006743
max_drawdown      -0.114403
[3063331:MainThread](2024-04-25 04:24:38,983) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 41
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `LSTM_crowd_data_csi300_360_rankTrue`.
[3063331:MainThread](2024-04-25 04:24:45,731) INFO - qlib.timer - [log.py:127] - Time cost: 0.008s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.05891823804012103,
                                                    0.022926572555685015,
                                                    -0.05550433417881047,
                                                    -0.012567980593449053,
                                                    -0.005649080654276603,
                                                    0.0695912035666429,
                                                    0.035530501760830106,
                                                    0.03286115814899971,
                                                    0.0612632706915804,
                                                    -0.00046350021463659945],
 '1day.excess_return_with_cost.information_ratio': [0.8184259048224443,
                                                    0.30064223245350585,
                                                    -0.5339271082344875,
                                                    -0.152226770022929,
                                                    -0.05761185713768486,
                                                    0.9800193558356165,
                                                    0.3995784254421482,
                                                    0.4442320693123457,
                                                    0.8176180573906947,
                                                    -0.0067433067614516016],
 '1day.excess_return_with_cost.max_drawdown': [-0.07846232143476412,
                                               -0.10570945240542111,
                                               -0.4824232677837425,
                                               -0.25529562680435725,
                                               -0.3574695859945844,
                                               -0.06552375947562239,
                                               -0.19613843792954566,
                                               -0.12562365234810519,
                                               -0.08439548470643693,
                                               -0.1144031511910249],
 'IC': [0.029633086614531495,
        0.02574694121661612,
        0.013315832589728332,
        0.012958518389712228,
        0.01588291832584367,
        0.02944302842463128,
        0.00914099209964402,
        0.019699291972305133,
        0.022176834801100553,
        0.026371188533125728],
 'ICIR': [0.23780975049045117,
          0.2141330839585906,
          0.09240673096781117,
          0.09827432529970663,
          0.11688319797213967,
          0.24326658526288497,
          0.05845702089707385,
          0.14899931000785527,
          0.1679139241314835,
          0.22576564787310122],
 'Rank IC': [0.043422656604175304,
             0.03218351845141216,
             0.016324296576641695,
             0.01420673078031172,
             0.015615345030848294,
             0.04056717341283423,
             0.013941216326489713,
             0.03001017117428144,
             0.03221801295452029,
             0.0341300441930608],
 'Rank ICIR': [0.349273660811528,
               0.26258111504674114,
               0.10110355733504273,
               0.10608327974210181,
               0.1084787038066814,
               0.32691885978453966,
               0.07943257545531746,
               0.22257326527388363,
               0.2428827890144363,
               0.28489969217415423],
 'mae': [0.8636513547094068,
         0.864254717184863,
         0.8645593211325421,
         0.8648148057465549,
         0.8646410613775686,
         0.8637755331436053,
         0.8648061032816513,
         0.864295886664761,
         0.8640359898145943,
         0.8641665679479441],
 'mse': [0.997057058270892,
         0.9974504140999779,
         0.9979122563515013,
         0.9984265146409119,
         0.9987282034543231,
         0.9979906128632701,
         0.9978530146728194,
         0.997901769532349,
         0.9972783340501211,
         0.9970150519078211]}
[3063331:MainThread](2024-04-25 04:24:45,991) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name final_crowd_data_csi300_360_1_LSTM.
[3063331:MainThread](2024-04-25 04:24:46,031) INFO - qlib.workflow - [exp.py:258] - Experiment 51 starts running ...
[3063331:MainThread](2024-04-25 04:24:46,047) INFO - qlib.workflow - [recorder.py:341] - Recorder 2ec34103ea9b4dc3b050cf622116b3e0 starts running under Experiment 51 ...
Time cost: 182.568998670578
{'1day.excess_return_with_cost.annualized_return': [0.02069060491226864,
                                                    0.03731646231895392],
 '1day.excess_return_with_cost.information_ratio': [0.30100070031002024,
                                                    0.4638696495249685],
 '1day.excess_return_with_cost.max_drawdown': [-0.18654447400736043,
                                               0.13182966980975194],
 'IC': [0.020436863296723857, 0.006983094093741818],
 'ICIR': [0.1603909576861098, 0.06401113478604661],
 'Rank IC': [0.027261916550457566, 0.010699820585835946],
 'Rank ICIR': [0.20842274984444265, 0.09626419035977495],
 'mae': [0.864300134100349, 0.00038602004630065276],
 'mse': [0.9977613229843987, 0.0005351333537450021]}
[3063331:MainThread](2024-04-25 04:24:46,551) INFO - qlib.timer - [log.py:127] - Time cost: 0.035s | waiting `async_log` Done

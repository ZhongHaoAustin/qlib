[3029722:MainThread](2024-04-25 02:26:24,292) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[3029722:MainThread](2024-04-25 02:26:24,294) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[3029722:MainThread](2024-04-25 02:26:24,295) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/crowd_data')}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3029722:MainThread](2024-04-25 02:26:28,923) INFO - qlib.workflow - [exp.py:258] - Experiment 4 starts running ...
[3029722:MainThread](2024-04-25 02:26:29,882) INFO - qlib.workflow - [recorder.py:341] - Recorder 9000b82585ef42fe884724ba608e2731 starts running under Experiment 4 ...
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.991012	valid's l2: 0.996567
[40]	train's l2: 0.987348	valid's l2: 0.99668
[60]	train's l2: 0.985148	valid's l2: 0.996856
Early stopping, best iteration is:
[24]	train's l2: 0.990146	valid's l2: 0.996529
[3029722:MainThread](2024-04-25 02:26:54,067) INFO - qlib.timer - [log.py:127] - Time cost: 0.151s | waiting `async_log` Done
Save pretrained model to gbdt_crowd_data_csi300_360_rankTrue_43.
[3029722:MainThread](2024-04-25 02:26:54,291) INFO - qlib.workflow - [exp.py:258] - Experiment 5 starts running ...
[3029722:MainThread](2024-04-25 02:26:54,301) INFO - qlib.workflow - [recorder.py:341] - Recorder 32e51f5172454e2a8906a9bbcdc02c38 starts running under Experiment 5 ...
{'IC': 0.017539680988361398,
 'ICIR': 0.12497015039951265,
 'Rank IC': 0.028101527086621156,
 'Rank ICIR': 0.20354051119561578}
[3029722:MainThread](2024-04-25 02:27:00,265) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3029722:MainThread](2024-04-25 02:27:31,507) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:27:31,510) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:27:37,786) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fdac3e40e20>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 6/971 [00:00<00:17, 56.08it/s]backtest loop:   1%|          | 12/971 [00:00<00:18, 51.21it/s]backtest loop:   2%|▏         | 18/971 [00:00<00:17, 54.43it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:18, 51.60it/s]backtest loop:   3%|▎         | 30/971 [00:00<00:17, 54.03it/s]backtest loop:   4%|▎         | 36/971 [00:00<00:16, 55.11it/s]backtest loop:   4%|▍         | 42/971 [00:00<00:16, 56.53it/s]backtest loop:   5%|▍         | 48/971 [00:00<00:16, 57.43it/s]backtest loop:   6%|▌         | 54/971 [00:00<00:16, 54.32it/s]backtest loop:   6%|▌         | 60/971 [00:01<00:16, 55.77it/s]backtest loop:   7%|▋         | 66/971 [00:01<00:15, 56.97it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 54.38it/s]backtest loop:   8%|▊         | 78/971 [00:01<00:16, 55.01it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 56.40it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:15, 58.24it/s]backtest loop:  10%|▉         | 97/971 [00:01<00:15, 55.12it/s]backtest loop:  11%|█         | 103/971 [00:01<00:15, 56.03it/s]backtest loop:  11%|█         | 109/971 [00:01<00:15, 56.78it/s]backtest loop:  12%|█▏        | 115/971 [00:02<00:14, 57.54it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 57.64it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:16, 51.81it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:15, 55.22it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 54.14it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 56.44it/s]backtest loop:  16%|█▌        | 155/971 [00:02<00:13, 58.39it/s]backtest loop:  17%|█▋        | 161/971 [00:02<00:14, 55.11it/s]backtest loop:  17%|█▋        | 167/971 [00:03<00:14, 56.25it/s]backtest loop:  18%|█▊        | 174/971 [00:03<00:13, 58.01it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:14, 55.93it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 57.72it/s]backtest loop:  20%|█▉        | 194/971 [00:03<00:13, 58.26it/s]backtest loop:  21%|██        | 200/971 [00:03<00:13, 55.16it/s]backtest loop:  21%|██▏       | 207/971 [00:03<00:13, 57.61it/s]backtest loop:  22%|██▏       | 213/971 [00:03<00:13, 54.80it/s]backtest loop:  23%|██▎       | 220/971 [00:03<00:13, 53.94it/s]backtest loop:  23%|██▎       | 226/971 [00:04<00:13, 55.46it/s]backtest loop:  24%|██▍       | 232/971 [00:04<00:13, 56.62it/s]backtest loop:  25%|██▍       | 238/971 [00:04<00:12, 57.51it/s]backtest loop:  25%|██▌       | 245/971 [00:04<00:13, 55.54it/s]backtest loop:  26%|██▌       | 252/971 [00:04<00:12, 58.18it/s]backtest loop:  27%|██▋       | 259/971 [00:04<00:12, 56.65it/s]backtest loop:  27%|██▋       | 265/971 [00:04<00:12, 57.33it/s]backtest loop:  28%|██▊       | 271/971 [00:04<00:12, 54.60it/s]backtest loop:  29%|██▊       | 277/971 [00:04<00:12, 56.05it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:12, 56.96it/s]backtest loop:  30%|██▉       | 289/971 [00:05<00:11, 57.76it/s]backtest loop:  30%|███       | 295/971 [00:05<00:12, 54.93it/s]backtest loop:  31%|███       | 301/971 [00:05<00:11, 56.25it/s]backtest loop:  32%|███▏      | 307/971 [00:05<00:11, 57.22it/s]backtest loop:  32%|███▏      | 313/971 [00:05<00:11, 57.77it/s]backtest loop:  33%|███▎      | 319/971 [00:05<00:11, 58.14it/s]backtest loop:  33%|███▎      | 325/971 [00:05<00:11, 55.07it/s]backtest loop:  34%|███▍      | 331/971 [00:05<00:11, 56.35it/s]backtest loop:  35%|███▍      | 337/971 [00:06<00:11, 57.22it/s]backtest loop:  35%|███▌      | 343/971 [00:06<00:10, 57.92it/s]backtest loop:  36%|███▌      | 350/971 [00:06<00:11, 56.21it/s]backtest loop:  37%|███▋      | 356/971 [00:06<00:10, 57.23it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:10, 55.84it/s]backtest loop:  38%|███▊      | 369/971 [00:06<00:11, 53.35it/s]backtest loop:  39%|███▊      | 375/971 [00:06<00:10, 54.96it/s]backtest loop:  39%|███▉      | 381/971 [00:06<00:10, 55.88it/s]backtest loop:  40%|███▉      | 387/971 [00:06<00:10, 56.87it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 54.10it/s]backtest loop:  41%|████      | 399/971 [00:07<00:10, 55.36it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:10, 56.23it/s]backtest loop:  42%|████▏     | 411/971 [00:07<00:09, 56.93it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 57.39it/s]backtest loop:  44%|████▎     | 423/971 [00:07<00:10, 54.52it/s]backtest loop:  44%|████▍     | 429/971 [00:07<00:09, 55.99it/s]backtest loop:  45%|████▍     | 435/971 [00:07<00:09, 57.08it/s]backtest loop:  45%|████▌     | 441/971 [00:07<00:09, 57.86it/s]backtest loop:  46%|████▌     | 447/971 [00:07<00:09, 54.45it/s]backtest loop:  47%|████▋     | 453/971 [00:08<00:09, 54.99it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:09, 55.94it/s]backtest loop:  48%|████▊     | 465/971 [00:08<00:08, 56.55it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:08, 57.48it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:09, 54.87it/s]backtest loop:  50%|████▉     | 483/971 [00:08<00:08, 56.30it/s]backtest loop:  50%|█████     | 489/971 [00:08<00:08, 57.26it/s]backtest loop:  51%|█████     | 495/971 [00:08<00:08, 54.48it/s]backtest loop:  52%|█████▏    | 501/971 [00:08<00:08, 56.00it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 53.85it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 56.38it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 58.44it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:07, 55.59it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:07, 57.74it/s]backtest loop:  56%|█████▌    | 541/971 [00:09<00:07, 55.76it/s]backtest loop:  56%|█████▋    | 548/971 [00:09<00:07, 57.60it/s]backtest loop:  57%|█████▋    | 554/971 [00:09<00:07, 58.19it/s]backtest loop:  58%|█████▊    | 560/971 [00:09<00:07, 58.60it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 55.37it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:06, 57.43it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 58.91it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:06, 56.19it/s]backtest loop:  61%|██████    | 592/971 [00:10<00:06, 57.15it/s]backtest loop:  62%|██████▏   | 598/971 [00:10<00:06, 57.82it/s]backtest loop:  62%|██████▏   | 604/971 [00:10<00:06, 58.43it/s]backtest loop:  63%|██████▎   | 610/971 [00:10<00:06, 55.28it/s]backtest loop:  63%|██████▎   | 616/971 [00:10<00:06, 56.54it/s]backtest loop:  64%|██████▍   | 623/971 [00:11<00:05, 58.43it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:06, 56.26it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:05, 58.21it/s]backtest loop:  66%|██████▌   | 643/971 [00:11<00:05, 58.61it/s]backtest loop:  67%|██████▋   | 649/971 [00:11<00:05, 59.00it/s]backtest loop:  67%|██████▋   | 655/971 [00:11<00:05, 55.68it/s]backtest loop:  68%|██████▊   | 661/971 [00:11<00:05, 56.81it/s]backtest loop:  69%|██████▊   | 667/971 [00:11<00:05, 57.51it/s]backtest loop:  69%|██████▉   | 673/971 [00:11<00:05, 57.80it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 54.63it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 56.00it/s]backtest loop:  71%|███████   | 691/971 [00:12<00:04, 57.06it/s]backtest loop:  72%|███████▏  | 697/971 [00:12<00:04, 57.87it/s]backtest loop:  73%|███████▎  | 704/971 [00:12<00:04, 55.76it/s]backtest loop:  73%|███████▎  | 711/971 [00:12<00:04, 57.63it/s]backtest loop:  74%|███████▍  | 718/971 [00:12<00:04, 58.99it/s]backtest loop:  75%|███████▍  | 724/971 [00:12<00:04, 56.14it/s]backtest loop:  75%|███████▌  | 731/971 [00:12<00:04, 54.49it/s]backtest loop:  76%|███████▌  | 737/971 [00:13<00:04, 55.89it/s]backtest loop:  77%|███████▋  | 743/971 [00:13<00:04, 53.91it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 53.23it/s]backtest loop:  78%|███████▊  | 756/971 [00:13<00:03, 54.98it/s]backtest loop:  79%|███████▊  | 763/971 [00:13<00:03, 57.13it/s]backtest loop:  79%|███████▉  | 769/971 [00:13<00:03, 57.91it/s]backtest loop:  80%|███████▉  | 775/971 [00:13<00:03, 55.16it/s]backtest loop:  80%|████████  | 781/971 [00:13<00:03, 56.28it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 54.96it/s]backtest loop:  82%|████████▏ | 794/971 [00:14<00:03, 55.69it/s]backtest loop:  82%|████████▏ | 800/971 [00:14<00:03, 55.71it/s]backtest loop:  83%|████████▎ | 806/971 [00:14<00:02, 56.09it/s]backtest loop:  84%|████████▎ | 812/971 [00:14<00:02, 57.13it/s]backtest loop:  84%|████████▍ | 818/971 [00:14<00:02, 54.30it/s]backtest loop:  85%|████████▍ | 824/971 [00:14<00:02, 55.85it/s]backtest loop:  86%|████████▌ | 831/971 [00:14<00:02, 57.86it/s]backtest loop:  86%|████████▋ | 838/971 [00:14<00:02, 55.74it/s]backtest loop:  87%|████████▋ | 844/971 [00:14<00:02, 56.87it/s]backtest loop:  88%|████████▊ | 850/971 [00:15<00:02, 57.71it/s]backtest loop:  88%|████████▊ | 856/971 [00:15<00:01, 58.07it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 54.74it/s]backtest loop:  89%|████████▉ | 868/971 [00:15<00:01, 56.06it/s]backtest loop:  90%|█████████ | 875/971 [00:15<00:01, 57.98it/s]backtest loop:  91%|█████████ | 882/971 [00:15<00:01, 55.95it/s]backtest loop:  92%|█████████▏| 889/971 [00:15<00:01, 57.73it/s]backtest loop:  92%|█████████▏| 896/971 [00:15<00:01, 59.06it/s]backtest loop:  93%|█████████▎| 902/971 [00:16<00:01, 56.08it/s]backtest loop:  94%|█████████▎| 909/971 [00:16<00:01, 57.79it/s]backtest loop:  94%|█████████▍| 915/971 [00:16<00:00, 58.11it/s]backtest loop:  95%|█████████▍| 921/971 [00:16<00:00, 55.18it/s]backtest loop:  96%|█████████▌| 928/971 [00:16<00:00, 57.36it/s]backtest loop:  96%|█████████▋| 935/971 [00:16<00:00, 58.91it/s]backtest loop:  97%|█████████▋| 941/971 [00:16<00:00, 55.81it/s]backtest loop:  98%|█████████▊| 948/971 [00:16<00:00, 57.78it/s]backtest loop:  98%|█████████▊| 954/971 [00:16<00:00, 58.34it/s]backtest loop:  99%|█████████▉| 960/971 [00:17<00:00, 55.43it/s]backtest loop:  99%|█████████▉| 966/971 [00:17<00:00, 56.65it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 56.37it/s]
[3029722:MainThread](2024-04-25 02:27:55,072) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000328
std                0.005204
annualized_return  0.078107
information_ratio  0.972861
max_drawdown      -0.089545
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000129
std                0.005204
annualized_return  0.030707
information_ratio  0.382473
max_drawdown      -0.121424
[3029722:MainThread](2024-04-25 02:27:55,087) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `gbdt_crowd_data_csi300_360_rankTrue`.
[3029722:MainThread](2024-04-25 02:28:00,932) INFO - qlib.timer - [log.py:127] - Time cost: 0.002s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.030706717085016277],
 '1day.excess_return_with_cost.information_ratio': [0.3824733296056038],
 '1day.excess_return_with_cost.max_drawdown': [-0.12142421237903872],
 'IC': [0.017539680988361398],
 'ICIR': [0.12497015039951265],
 'Rank IC': [0.028101527086621156],
 'Rank ICIR': [0.20354051119561578],
 'mae': [0.8644107165169036],
 'mse': [0.996899333238641]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3029722:MainThread](2024-04-25 02:28:05,288) INFO - qlib.workflow - [exp.py:258] - Experiment 6 starts running ...
[3029722:MainThread](2024-04-25 02:28:05,296) INFO - qlib.workflow - [recorder.py:341] - Recorder 204065a9c3b0475eb458b2c41ec47718 starts running under Experiment 6 ...
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.991012	valid's l2: 0.996567
[40]	train's l2: 0.987348	valid's l2: 0.99668
[60]	train's l2: 0.985148	valid's l2: 0.996856
Early stopping, best iteration is:
[24]	train's l2: 0.990146	valid's l2: 0.996529
[3029722:MainThread](2024-04-25 02:28:33,861) INFO - qlib.timer - [log.py:127] - Time cost: 0.120s | waiting `async_log` Done
Save pretrained model to gbdt_crowd_data_csi300_360_rankTrue_44.
[3029722:MainThread](2024-04-25 02:28:34,014) INFO - qlib.workflow - [exp.py:258] - Experiment 5 starts running ...
[3029722:MainThread](2024-04-25 02:28:34,024) INFO - qlib.workflow - [recorder.py:341] - Recorder 0b0e1f800ed24c83a01400edd8857fc5 starts running under Experiment 5 ...
{'IC': 0.017539680988361398,
 'ICIR': 0.12497015039951265,
 'Rank IC': 0.028101527086621156,
 'Rank ICIR': 0.20354051119561578}
[3029722:MainThread](2024-04-25 02:28:39,850) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3029722:MainThread](2024-04-25 02:29:11,699) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:29:11,702) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:29:17,609) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fda4b966f70>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:42,  9.41it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 24.96it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 37.35it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.99it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:20, 47.03it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.62it/s]backtest loop:   4%|▍         | 40/971 [00:00<00:18, 50.66it/s]backtest loop:   5%|▍         | 46/971 [00:01<00:17, 53.19it/s]backtest loop:   5%|▌         | 52/971 [00:01<00:16, 55.06it/s]backtest loop:   6%|▌         | 58/971 [00:01<00:17, 53.01it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:16, 54.82it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:15, 57.29it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:16, 54.38it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 56.71it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:15, 58.50it/s]backtest loop:  10%|▉         | 97/971 [00:01<00:15, 55.59it/s]backtest loop:  11%|█         | 104/971 [00:02<00:15, 57.57it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:14, 58.12it/s]backtest loop:  12%|█▏        | 116/971 [00:02<00:14, 57.36it/s]backtest loop:  13%|█▎        | 122/971 [00:02<00:16, 50.49it/s]backtest loop:  13%|█▎        | 128/971 [00:02<00:25, 32.83it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:22, 37.65it/s]backtest loop:  14%|█▍        | 140/971 [00:03<00:19, 42.24it/s]backtest loop:  15%|█▌        | 146/971 [00:03<00:18, 43.93it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:16, 48.70it/s]backtest loop:  16%|█▋        | 160/971 [00:03<00:15, 52.38it/s]backtest loop:  17%|█▋        | 166/971 [00:03<00:15, 51.39it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:14, 54.35it/s]backtest loop:  19%|█▊        | 180/971 [00:03<00:13, 56.55it/s]backtest loop:  19%|█▉        | 186/971 [00:03<00:14, 54.23it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:14, 55.46it/s]backtest loop:  20%|██        | 198/971 [00:04<00:13, 56.57it/s]backtest loop:  21%|██        | 205/971 [00:04<00:13, 55.13it/s]backtest loop:  22%|██▏       | 212/971 [00:04<00:13, 57.49it/s]backtest loop:  22%|██▏       | 218/971 [00:04<00:13, 55.19it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:13, 54.14it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:13, 55.31it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 56.57it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 58.32it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 55.91it/s]backtest loop:  26%|██▋       | 257/971 [00:05<00:12, 58.71it/s]backtest loop:  27%|██▋       | 263/971 [00:05<00:11, 59.06it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:12, 55.80it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:12, 54.36it/s]backtest loop:  29%|██▉       | 282/971 [00:05<00:12, 55.69it/s]backtest loop:  30%|██▉       | 288/971 [00:05<00:12, 56.85it/s]backtest loop:  30%|███       | 294/971 [00:05<00:11, 56.51it/s]backtest loop:  31%|███       | 300/971 [00:05<00:12, 53.94it/s]backtest loop:  32%|███▏      | 306/971 [00:05<00:12, 55.37it/s]backtest loop:  32%|███▏      | 312/971 [00:06<00:11, 56.60it/s]backtest loop:  33%|███▎      | 319/971 [00:06<00:11, 58.23it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:11, 55.11it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:11, 57.19it/s]backtest loop:  35%|███▍      | 338/971 [00:06<00:10, 57.96it/s]backtest loop:  35%|███▌      | 344/971 [00:06<00:10, 58.45it/s]backtest loop:  36%|███▌      | 350/971 [00:06<00:11, 55.89it/s]backtest loop:  37%|███▋      | 357/971 [00:06<00:10, 57.86it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:10, 55.63it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:11, 53.36it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:10, 55.01it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:10, 56.24it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 57.18it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 54.35it/s]backtest loop:  41%|████      | 399/971 [00:07<00:10, 55.78it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 56.85it/s]backtest loop:  42%|████▏     | 411/971 [00:07<00:09, 57.25it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 58.00it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:09, 54.99it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:09, 56.05it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:09, 57.13it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 57.76it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 54.28it/s]backtest loop:  47%|████▋     | 453/971 [00:08<00:09, 54.11it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:09, 55.36it/s]backtest loop:  48%|████▊     | 465/971 [00:08<00:09, 56.19it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:08, 57.06it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 54.49it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:08, 55.92it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:08, 56.83it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:08, 53.97it/s]backtest loop:  52%|█████▏    | 501/971 [00:09<00:08, 55.29it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 52.93it/s]backtest loop:  53%|█████▎    | 513/971 [00:09<00:08, 54.26it/s]backtest loop:  54%|█████▎    | 520/971 [00:09<00:07, 56.60it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 54.10it/s]backtest loop:  55%|█████▍    | 533/971 [00:10<00:07, 56.84it/s]backtest loop:  56%|█████▌    | 540/971 [00:10<00:07, 58.44it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 55.43it/s]backtest loop:  57%|█████▋    | 552/971 [00:10<00:07, 56.33it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 57.20it/s]backtest loop:  58%|█████▊    | 564/971 [00:10<00:07, 57.90it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 55.78it/s]backtest loop:  59%|█████▉    | 577/971 [00:10<00:06, 56.57it/s]backtest loop:  60%|██████    | 584/971 [00:10<00:06, 58.46it/s]backtest loop:  61%|██████    | 591/971 [00:11<00:06, 56.21it/s]backtest loop:  61%|██████▏   | 597/971 [00:11<00:06, 57.17it/s]backtest loop:  62%|██████▏   | 603/971 [00:11<00:06, 57.80it/s]backtest loop:  63%|██████▎   | 609/971 [00:11<00:06, 58.37it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:06, 55.23it/s]backtest loop:  64%|██████▍   | 622/971 [00:11<00:06, 57.34it/s]backtest loop:  65%|██████▍   | 629/971 [00:11<00:05, 58.84it/s]backtest loop:  65%|██████▌   | 635/971 [00:11<00:06, 55.99it/s]backtest loop:  66%|██████▌   | 641/971 [00:11<00:05, 56.82it/s]backtest loop:  67%|██████▋   | 647/971 [00:11<00:05, 57.53it/s]backtest loop:  67%|██████▋   | 653/971 [00:12<00:05, 57.93it/s]backtest loop:  68%|██████▊   | 659/971 [00:12<00:05, 58.35it/s]backtest loop:  68%|██████▊   | 665/971 [00:12<00:05, 55.20it/s]backtest loop:  69%|██████▉   | 671/971 [00:12<00:05, 56.44it/s]backtest loop:  70%|██████▉   | 677/971 [00:12<00:05, 57.38it/s]backtest loop:  70%|███████   | 683/971 [00:12<00:04, 57.84it/s]backtest loop:  71%|███████   | 689/971 [00:12<00:05, 54.82it/s]backtest loop:  72%|███████▏  | 695/971 [00:12<00:04, 56.20it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 57.28it/s]backtest loop:  73%|███████▎  | 707/971 [00:13<00:04, 57.91it/s]backtest loop:  73%|███████▎  | 713/971 [00:13<00:04, 58.21it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 55.12it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 57.44it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 54.71it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 52.94it/s]backtest loop:  77%|███████▋  | 744/971 [00:13<00:04, 54.80it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 52.84it/s]backtest loop:  78%|███████▊  | 756/971 [00:13<00:03, 54.64it/s]backtest loop:  78%|███████▊  | 762/971 [00:14<00:03, 55.94it/s]backtest loop:  79%|███████▉  | 768/971 [00:14<00:03, 56.90it/s]backtest loop:  80%|███████▉  | 774/971 [00:14<00:03, 57.47it/s]backtest loop:  80%|████████  | 780/971 [00:14<00:03, 54.68it/s]backtest loop:  81%|████████  | 787/971 [00:14<00:03, 57.40it/s]backtest loop:  82%|████████▏ | 793/971 [00:14<00:03, 54.65it/s]backtest loop:  82%|████████▏ | 799/971 [00:14<00:03, 55.10it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:03, 55.09it/s]backtest loop:  84%|████████▎ | 811/971 [00:14<00:02, 56.15it/s]backtest loop:  84%|████████▍ | 817/971 [00:15<00:02, 56.91it/s]backtest loop:  85%|████████▍ | 823/971 [00:15<00:02, 54.30it/s]backtest loop:  85%|████████▌ | 830/971 [00:15<00:02, 56.70it/s]backtest loop:  86%|████████▌ | 836/971 [00:15<00:02, 57.52it/s]backtest loop:  87%|████████▋ | 842/971 [00:15<00:02, 58.21it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 55.17it/s]backtest loop:  88%|████████▊ | 854/971 [00:15<00:02, 56.48it/s]backtest loop:  89%|████████▊ | 860/971 [00:15<00:01, 57.43it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 58.12it/s]backtest loop:  90%|████████▉ | 872/971 [00:16<00:01, 55.00it/s]backtest loop:  90%|█████████ | 878/971 [00:16<00:01, 56.31it/s]backtest loop:  91%|█████████ | 884/971 [00:16<00:01, 56.96it/s]backtest loop:  92%|█████████▏| 890/971 [00:16<00:01, 57.17it/s]backtest loop:  92%|█████████▏| 896/971 [00:16<00:01, 56.96it/s]backtest loop:  93%|█████████▎| 902/971 [00:16<00:01, 54.13it/s]backtest loop:  94%|█████████▎| 908/971 [00:16<00:01, 55.73it/s]backtest loop:  94%|█████████▍| 914/971 [00:16<00:01, 56.85it/s]backtest loop:  95%|█████████▍| 920/971 [00:16<00:00, 56.97it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 54.34it/s]backtest loop:  96%|█████████▌| 933/971 [00:17<00:00, 56.85it/s]backtest loop:  97%|█████████▋| 939/971 [00:17<00:00, 57.64it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 54.50it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 56.98it/s]backtest loop:  99%|█████████▊| 958/971 [00:17<00:00, 57.79it/s]backtest loop:  99%|█████████▉| 964/971 [00:17<00:00, 58.40it/s]backtest loop: 100%|█████████▉| 970/971 [00:17<00:00, 55.16it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.65it/s]
[3029722:MainThread](2024-04-25 02:29:35,438) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000328
std                0.005204
annualized_return  0.078107
information_ratio  0.972861
max_drawdown      -0.089545
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000129
std                0.005204
annualized_return  0.030707
information_ratio  0.382473
max_drawdown      -0.121424
[3029722:MainThread](2024-04-25 02:29:35,452) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `gbdt_crowd_data_csi300_360_rankTrue`.
[3029722:MainThread](2024-04-25 02:29:41,438) INFO - qlib.timer - [log.py:127] - Time cost: 0.005s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.030706717085016277,
                                                    0.030706717085016277],
 '1day.excess_return_with_cost.information_ratio': [0.3824733296056038,
                                                    0.3824733296056038],
 '1day.excess_return_with_cost.max_drawdown': [-0.12142421237903872,
                                               -0.12142421237903872],
 'IC': [0.017539680988361398, 0.017539680988361398],
 'ICIR': [0.12497015039951265, 0.12497015039951265],
 'Rank IC': [0.028101527086621156, 0.028101527086621156],
 'Rank ICIR': [0.20354051119561578, 0.20354051119561578],
 'mae': [0.8644107165169036, 0.8644107165169036],
 'mse': [0.996899333238641, 0.996899333238641]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3029722:MainThread](2024-04-25 02:29:45,931) INFO - qlib.workflow - [exp.py:258] - Experiment 7 starts running ...
[3029722:MainThread](2024-04-25 02:29:45,940) INFO - qlib.workflow - [recorder.py:341] - Recorder 17cfce3fa19948178b1fa5fc33ffd3af starts running under Experiment 7 ...
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.991012	valid's l2: 0.996567
[40]	train's l2: 0.987348	valid's l2: 0.99668
[60]	train's l2: 0.985148	valid's l2: 0.996856
Early stopping, best iteration is:
[24]	train's l2: 0.990146	valid's l2: 0.996529
[3029722:MainThread](2024-04-25 02:30:12,267) INFO - qlib.timer - [log.py:127] - Time cost: 0.142s | waiting `async_log` Done
Save pretrained model to gbdt_crowd_data_csi300_360_rankTrue_45.
[3029722:MainThread](2024-04-25 02:30:12,436) INFO - qlib.workflow - [exp.py:258] - Experiment 5 starts running ...
[3029722:MainThread](2024-04-25 02:30:12,445) INFO - qlib.workflow - [recorder.py:341] - Recorder 4601bf1e3bd34625be9aa5feb4907ca8 starts running under Experiment 5 ...
{'IC': 0.017539680988361398,
 'ICIR': 0.12497015039951265,
 'Rank IC': 0.028101527086621156,
 'Rank ICIR': 0.20354051119561578}
[3029722:MainThread](2024-04-25 02:30:18,089) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3029722:MainThread](2024-04-25 02:30:50,283) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:30:50,286) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:30:56,226) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fdad2d9c310>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:41,  9.57it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 25.31it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 37.77it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.34it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:19, 47.39it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.94it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.39it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.35it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.47it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 56.08it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.02it/s]backtest loop:   8%|▊         | 73/971 [00:01<00:16, 55.43it/s]backtest loop:   8%|▊         | 80/971 [00:01<00:15, 57.51it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 55.74it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 57.90it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 59.22it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.36it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 58.05it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.38it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:23, 36.46it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:19, 42.19it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:18, 44.96it/s]backtest loop:  15%|█▌        | 148/971 [00:03<00:16, 49.26it/s]backtest loop:  16%|█▌        | 154/971 [00:03<00:15, 51.45it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:15, 51.67it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:14, 54.50it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:14, 56.79it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:14, 54.58it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 56.84it/s]backtest loop:  20%|█▉        | 194/971 [00:03<00:13, 57.62it/s]backtest loop:  21%|██        | 200/971 [00:03<00:14, 54.97it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:13, 57.64it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:13, 55.18it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:13, 56.33it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:13, 53.96it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:13, 55.46it/s]backtest loop:  25%|██▍       | 238/971 [00:04<00:12, 57.53it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 58.00it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 55.68it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 58.68it/s]backtest loop:  27%|██▋       | 264/971 [00:05<00:12, 56.48it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:12, 55.05it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:12, 57.24it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:11, 58.70it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 55.89it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 57.92it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:11, 56.00it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 57.72it/s]backtest loop:  33%|███▎      | 318/971 [00:06<00:11, 57.92it/s]backtest loop:  33%|███▎      | 324/971 [00:06<00:11, 57.92it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:11, 54.49it/s]backtest loop:  35%|███▍      | 336/971 [00:06<00:11, 55.91it/s]backtest loop:  35%|███▌      | 343/971 [00:06<00:10, 57.81it/s]backtest loop:  36%|███▌      | 350/971 [00:06<00:11, 56.34it/s]backtest loop:  37%|███▋      | 357/971 [00:06<00:10, 58.15it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:10, 55.98it/s]backtest loop:  38%|███▊      | 369/971 [00:06<00:11, 53.93it/s]backtest loop:  39%|███▊      | 376/971 [00:07<00:10, 56.31it/s]backtest loop:  39%|███▉      | 383/971 [00:07<00:10, 54.75it/s]backtest loop:  40%|████      | 389/971 [00:07<00:10, 55.96it/s]backtest loop:  41%|████      | 396/971 [00:07<00:09, 57.75it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 55.79it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:09, 57.56it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 58.91it/s]backtest loop:  44%|████▎     | 423/971 [00:07<00:09, 55.33it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:09, 56.46it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:09, 57.40it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 58.10it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 54.98it/s]backtest loop:  47%|████▋     | 453/971 [00:08<00:09, 56.34it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:08, 57.36it/s]backtest loop:  48%|████▊     | 466/971 [00:08<00:08, 58.83it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:08, 55.75it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 57.93it/s]backtest loop:  50%|████▉     | 485/971 [00:08<00:08, 58.50it/s]backtest loop:  51%|█████     | 491/971 [00:09<00:08, 55.45it/s]backtest loop:  51%|█████     | 497/971 [00:09<00:08, 56.68it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:07, 58.47it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:08, 55.60it/s]backtest loop:  53%|█████▎    | 517/971 [00:09<00:08, 54.56it/s]backtest loop:  54%|█████▍    | 524/971 [00:09<00:07, 56.93it/s]backtest loop:  55%|█████▍    | 531/971 [00:09<00:07, 55.55it/s]backtest loop:  55%|█████▌    | 538/971 [00:09<00:07, 57.81it/s]backtest loop:  56%|█████▌    | 545/971 [00:10<00:07, 59.04it/s]backtest loop:  57%|█████▋    | 551/971 [00:10<00:07, 56.02it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 57.73it/s]backtest loop:  58%|█████▊    | 565/971 [00:10<00:06, 59.02it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 55.59it/s]backtest loop:  59%|█████▉    | 577/971 [00:10<00:06, 56.48it/s]backtest loop:  60%|██████    | 584/971 [00:10<00:06, 58.29it/s]backtest loop:  61%|██████    | 591/971 [00:10<00:06, 55.70it/s]backtest loop:  61%|██████▏   | 597/971 [00:10<00:06, 56.77it/s]backtest loop:  62%|██████▏   | 603/971 [00:11<00:06, 57.61it/s]backtest loop:  63%|██████▎   | 609/971 [00:11<00:06, 58.25it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:06, 55.20it/s]backtest loop:  64%|██████▍   | 622/971 [00:11<00:06, 57.36it/s]backtest loop:  65%|██████▍   | 629/971 [00:11<00:05, 58.95it/s]backtest loop:  65%|██████▌   | 635/971 [00:11<00:05, 56.16it/s]backtest loop:  66%|██████▌   | 641/971 [00:11<00:05, 57.03it/s]backtest loop:  67%|██████▋   | 647/971 [00:11<00:05, 57.85it/s]backtest loop:  67%|██████▋   | 653/971 [00:11<00:05, 58.46it/s]backtest loop:  68%|██████▊   | 660/971 [00:12<00:05, 56.11it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 57.86it/s]backtest loop:  69%|██████▉   | 673/971 [00:12<00:05, 58.39it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 55.42it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 56.61it/s]backtest loop:  71%|███████   | 691/971 [00:12<00:04, 57.56it/s]backtest loop:  72%|███████▏  | 698/971 [00:12<00:04, 58.99it/s]backtest loop:  73%|███████▎  | 704/971 [00:12<00:04, 55.32it/s]backtest loop:  73%|███████▎  | 710/971 [00:12<00:04, 56.33it/s]backtest loop:  74%|███████▎  | 716/971 [00:13<00:04, 57.15it/s]backtest loop:  74%|███████▍  | 723/971 [00:13<00:04, 58.86it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 55.96it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 53.77it/s]backtest loop:  76%|███████▋  | 742/971 [00:13<00:04, 56.30it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.21it/s]backtest loop:  78%|███████▊  | 754/971 [00:13<00:03, 55.76it/s]backtest loop:  78%|███████▊  | 760/971 [00:13<00:03, 53.70it/s]backtest loop:  79%|███████▉  | 766/971 [00:13<00:03, 54.69it/s]backtest loop:  80%|███████▉  | 772/971 [00:14<00:03, 55.98it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 57.86it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 55.64it/s]backtest loop:  82%|████████▏ | 792/971 [00:14<00:03, 57.66it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 54.95it/s]backtest loop:  83%|████████▎ | 804/971 [00:14<00:02, 56.29it/s]backtest loop:  83%|████████▎ | 810/971 [00:14<00:02, 57.20it/s]backtest loop:  84%|████████▍ | 816/971 [00:14<00:02, 57.94it/s]backtest loop:  85%|████████▍ | 822/971 [00:14<00:02, 58.53it/s]backtest loop:  85%|████████▌ | 828/971 [00:15<00:02, 55.50it/s]backtest loop:  86%|████████▌ | 835/971 [00:15<00:02, 57.43it/s]backtest loop:  87%|████████▋ | 842/971 [00:15<00:02, 58.87it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 55.76it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:02, 57.63it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 55.68it/s]backtest loop:  89%|████████▉ | 868/971 [00:15<00:01, 56.80it/s]backtest loop:  90%|█████████ | 875/971 [00:15<00:01, 58.40it/s]backtest loop:  91%|█████████ | 882/971 [00:15<00:01, 56.28it/s]backtest loop:  92%|█████████▏| 889/971 [00:16<00:01, 57.92it/s]backtest loop:  92%|█████████▏| 895/971 [00:16<00:01, 58.45it/s]backtest loop:  93%|█████████▎| 901/971 [00:16<00:01, 58.87it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 55.73it/s]backtest loop:  94%|█████████▍| 914/971 [00:16<00:00, 57.67it/s]backtest loop:  95%|█████████▍| 920/971 [00:16<00:00, 58.02it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 54.89it/s]backtest loop:  96%|█████████▌| 932/971 [00:16<00:00, 56.28it/s]backtest loop:  97%|█████████▋| 938/971 [00:16<00:00, 57.26it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 55.39it/s]backtest loop:  98%|█████████▊| 951/971 [00:17<00:00, 56.56it/s]backtest loop:  99%|█████████▊| 957/971 [00:17<00:00, 57.51it/s]backtest loop:  99%|█████████▉| 963/971 [00:17<00:00, 58.20it/s]backtest loop: 100%|█████████▉| 969/971 [00:17<00:00, 58.66it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.36it/s]
[3029722:MainThread](2024-04-25 02:31:13,821) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000328
std                0.005204
annualized_return  0.078107
information_ratio  0.972861
max_drawdown      -0.089545
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000129
std                0.005204
annualized_return  0.030707
information_ratio  0.382473
max_drawdown      -0.121424
[3029722:MainThread](2024-04-25 02:31:13,834) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `gbdt_crowd_data_csi300_360_rankTrue`.
[3029722:MainThread](2024-04-25 02:31:19,799) INFO - qlib.timer - [log.py:127] - Time cost: 0.005s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277],
 '1day.excess_return_with_cost.information_ratio': [0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038],
 '1day.excess_return_with_cost.max_drawdown': [-0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872],
 'IC': [0.017539680988361398, 0.017539680988361398, 0.017539680988361398],
 'ICIR': [0.12497015039951265, 0.12497015039951265, 0.12497015039951265],
 'Rank IC': [0.028101527086621156, 0.028101527086621156, 0.028101527086621156],
 'Rank ICIR': [0.20354051119561578, 0.20354051119561578, 0.20354051119561578],
 'mae': [0.8644107165169036, 0.8644107165169036, 0.8644107165169036],
 'mse': [0.996899333238641, 0.996899333238641, 0.996899333238641]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3029722:MainThread](2024-04-25 02:31:24,158) INFO - qlib.workflow - [exp.py:258] - Experiment 8 starts running ...
[3029722:MainThread](2024-04-25 02:31:24,167) INFO - qlib.workflow - [recorder.py:341] - Recorder e9dbb18c39ed43bbb39ed511938fe541 starts running under Experiment 8 ...
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.991012	valid's l2: 0.996567
[40]	train's l2: 0.987348	valid's l2: 0.99668
[60]	train's l2: 0.985148	valid's l2: 0.996856
Early stopping, best iteration is:
[24]	train's l2: 0.990146	valid's l2: 0.996529
[3029722:MainThread](2024-04-25 02:31:52,453) INFO - qlib.timer - [log.py:127] - Time cost: 0.137s | waiting `async_log` Done
Save pretrained model to gbdt_crowd_data_csi300_360_rankTrue_46.
[3029722:MainThread](2024-04-25 02:31:52,607) INFO - qlib.workflow - [exp.py:258] - Experiment 5 starts running ...
[3029722:MainThread](2024-04-25 02:31:52,617) INFO - qlib.workflow - [recorder.py:341] - Recorder e5fc881ae6c5446c88665ae7dea9038f starts running under Experiment 5 ...
{'IC': 0.017539680988361398,
 'ICIR': 0.12497015039951265,
 'Rank IC': 0.028101527086621156,
 'Rank ICIR': 0.20354051119561578}
[3029722:MainThread](2024-04-25 02:31:58,508) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3029722:MainThread](2024-04-25 02:32:32,014) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:32:32,019) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:32:37,939) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fdac1b10a90>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:45,  9.17it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.53it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 36.95it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.70it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:20, 46.84it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.61it/s]backtest loop:   4%|▍         | 40/971 [00:00<00:18, 50.96it/s]backtest loop:   5%|▍         | 46/971 [00:01<00:17, 53.52it/s]backtest loop:   5%|▌         | 52/971 [00:01<00:16, 54.91it/s]backtest loop:   6%|▌         | 58/971 [00:01<00:17, 53.00it/s]backtest loop:   7%|▋         | 65/971 [00:01<00:16, 55.77it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 54.54it/s]backtest loop:   8%|▊         | 79/971 [00:01<00:15, 56.72it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:15, 58.42it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:15, 55.78it/s]backtest loop:  10%|█         | 98/971 [00:02<00:15, 55.98it/s]backtest loop:  11%|█         | 105/971 [00:02<00:14, 58.02it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 56.13it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:14, 57.99it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 55.13it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:24, 34.14it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:20, 39.99it/s]backtest loop:  15%|█▍        | 144/971 [00:03<00:18, 43.60it/s]backtest loop:  16%|█▌        | 151/971 [00:03<00:17, 46.08it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:16, 50.32it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:15, 53.39it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 51.28it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:14, 54.31it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:14, 53.56it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:13, 55.96it/s]backtest loop:  20%|██        | 199/971 [00:04<00:13, 57.69it/s]backtest loop:  21%|██        | 205/971 [00:04<00:13, 55.41it/s]backtest loop:  22%|██▏       | 212/971 [00:04<00:13, 57.69it/s]backtest loop:  22%|██▏       | 218/971 [00:04<00:13, 55.43it/s]backtest loop:  23%|██▎       | 224/971 [00:04<00:13, 56.46it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 54.22it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 56.59it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 58.39it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 56.00it/s]backtest loop:  26%|██▋       | 257/971 [00:05<00:12, 58.79it/s]backtest loop:  27%|██▋       | 264/971 [00:05<00:12, 56.63it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:12, 55.12it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:12, 57.27it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:11, 58.71it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 55.88it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 57.89it/s]backtest loop:  31%|███▏      | 304/971 [00:05<00:11, 58.07it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:11, 55.21it/s]backtest loop:  33%|███▎      | 316/971 [00:06<00:11, 56.50it/s]backtest loop:  33%|███▎      | 322/971 [00:06<00:11, 57.39it/s]backtest loop:  34%|███▍      | 328/971 [00:06<00:11, 57.98it/s]backtest loop:  34%|███▍      | 334/971 [00:06<00:10, 58.39it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:11, 54.88it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:10, 57.25it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:10, 59.01it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 56.00it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.11it/s]backtest loop:  38%|███▊      | 373/971 [00:07<00:11, 53.23it/s]backtest loop:  39%|███▉      | 379/971 [00:07<00:10, 54.99it/s]backtest loop:  40%|███▉      | 385/971 [00:07<00:10, 56.19it/s]backtest loop:  40%|████      | 391/971 [00:07<00:10, 57.19it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 55.33it/s]backtest loop:  42%|████▏     | 404/971 [00:07<00:10, 56.58it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:09, 57.51it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 58.94it/s]backtest loop:  44%|████▎     | 423/971 [00:07<00:09, 55.78it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:09, 56.93it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:09, 56.98it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 57.74it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 54.65it/s]backtest loop:  47%|████▋     | 453/971 [00:08<00:09, 56.11it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:08, 57.10it/s]backtest loop:  48%|████▊     | 465/971 [00:08<00:08, 57.89it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:08, 55.79it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 57.86it/s]backtest loop:  50%|████▉     | 485/971 [00:09<00:08, 57.96it/s]backtest loop:  51%|█████     | 491/971 [00:09<00:08, 53.56it/s]backtest loop:  51%|█████     | 497/971 [00:09<00:08, 54.93it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:08, 57.10it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:08, 54.65it/s]backtest loop:  53%|█████▎    | 516/971 [00:09<00:08, 56.07it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:08, 54.22it/s]backtest loop:  54%|█████▍    | 529/971 [00:09<00:07, 56.70it/s]backtest loop:  55%|█████▌    | 536/971 [00:09<00:07, 55.55it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:07, 57.50it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 58.14it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:07, 55.97it/s]backtest loop:  58%|█████▊    | 562/971 [00:10<00:07, 57.03it/s]backtest loop:  59%|█████▊    | 569/971 [00:10<00:06, 58.05it/s]backtest loop:  59%|█████▉    | 575/971 [00:10<00:06, 58.53it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:07, 55.63it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:06, 57.67it/s]backtest loop:  61%|██████    | 594/971 [00:10<00:06, 58.31it/s]backtest loop:  62%|██████▏   | 600/971 [00:11<00:06, 55.34it/s]backtest loop:  62%|██████▏   | 606/971 [00:11<00:06, 56.59it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 57.53it/s]backtest loop:  64%|██████▎   | 618/971 [00:11<00:06, 58.23it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 56.31it/s]backtest loop:  65%|██████▍   | 631/971 [00:11<00:05, 57.25it/s]backtest loop:  66%|██████▌   | 638/971 [00:11<00:05, 59.00it/s]backtest loop:  66%|██████▋   | 644/971 [00:11<00:05, 59.19it/s]backtest loop:  67%|██████▋   | 650/971 [00:11<00:05, 55.88it/s]backtest loop:  68%|██████▊   | 656/971 [00:12<00:05, 57.01it/s]backtest loop:  68%|██████▊   | 662/971 [00:12<00:05, 57.84it/s]backtest loop:  69%|██████▉   | 669/971 [00:12<00:05, 59.14it/s]backtest loop:  70%|██████▉   | 675/971 [00:12<00:05, 55.84it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:05, 56.97it/s]backtest loop:  71%|███████   | 687/971 [00:12<00:04, 57.62it/s]backtest loop:  71%|███████▏  | 693/971 [00:12<00:04, 58.29it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 55.24it/s]backtest loop:  73%|███████▎  | 705/971 [00:12<00:04, 55.98it/s]backtest loop:  73%|███████▎  | 711/971 [00:13<00:04, 56.58it/s]backtest loop:  74%|███████▍  | 717/971 [00:13<00:04, 57.37it/s]backtest loop:  75%|███████▍  | 724/971 [00:13<00:04, 55.54it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 54.40it/s]backtest loop:  76%|███████▌  | 737/971 [00:13<00:04, 55.82it/s]backtest loop:  77%|███████▋  | 743/971 [00:13<00:04, 53.85it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 53.15it/s]backtest loop:  78%|███████▊  | 756/971 [00:13<00:03, 54.88it/s]backtest loop:  79%|███████▊  | 763/971 [00:13<00:03, 57.05it/s]backtest loop:  79%|███████▉  | 770/971 [00:14<00:03, 55.31it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 57.21it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 55.16it/s]backtest loop:  81%|████████▏ | 790/971 [00:14<00:03, 57.40it/s]backtest loop:  82%|████████▏ | 796/971 [00:14<00:03, 58.10it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:03, 55.98it/s]backtest loop:  83%|████████▎ | 810/971 [00:14<00:02, 57.71it/s]backtest loop:  84%|████████▍ | 817/971 [00:14<00:02, 58.98it/s]backtest loop:  85%|████████▍ | 823/971 [00:15<00:02, 55.92it/s]backtest loop:  85%|████████▌ | 830/971 [00:15<00:02, 57.80it/s]backtest loop:  86%|████████▌ | 836/971 [00:15<00:02, 57.47it/s]backtest loop:  87%|████████▋ | 842/971 [00:15<00:02, 57.94it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 54.72it/s]backtest loop:  88%|████████▊ | 854/971 [00:15<00:02, 56.15it/s]backtest loop:  89%|████████▊ | 861/971 [00:15<00:01, 57.95it/s]backtest loop:  89%|████████▉ | 867/971 [00:15<00:01, 55.07it/s]backtest loop:  90%|█████████ | 874/971 [00:15<00:01, 57.19it/s]backtest loop:  91%|█████████ | 880/971 [00:16<00:01, 57.95it/s]backtest loop:  91%|█████████▏| 887/971 [00:16<00:01, 55.92it/s]backtest loop:  92%|█████████▏| 894/971 [00:16<00:01, 57.70it/s]backtest loop:  93%|█████████▎| 901/971 [00:16<00:01, 58.99it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 55.91it/s]backtest loop:  94%|█████████▍| 914/971 [00:16<00:00, 57.70it/s]backtest loop:  95%|█████████▍| 920/971 [00:16<00:00, 58.32it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 55.38it/s]backtest loop:  96%|█████████▌| 933/971 [00:16<00:00, 57.61it/s]backtest loop:  97%|█████████▋| 939/971 [00:17<00:00, 58.26it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 55.31it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 57.56it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 58.91it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 55.82it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 56.86it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.07it/s]
[3029722:MainThread](2024-04-25 02:32:55,628) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000328
std                0.005204
annualized_return  0.078107
information_ratio  0.972861
max_drawdown      -0.089545
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000129
std                0.005204
annualized_return  0.030707
information_ratio  0.382473
max_drawdown      -0.121424
[3029722:MainThread](2024-04-25 02:32:55,642) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `gbdt_crowd_data_csi300_360_rankTrue`.
[3029722:MainThread](2024-04-25 02:33:01,642) INFO - qlib.timer - [log.py:127] - Time cost: 0.005s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277],
 '1day.excess_return_with_cost.information_ratio': [0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038],
 '1day.excess_return_with_cost.max_drawdown': [-0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872],
 'IC': [0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398],
 'ICIR': [0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265],
 'Rank IC': [0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156],
 'Rank ICIR': [0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578],
 'mae': [0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036],
 'mse': [0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3029722:MainThread](2024-04-25 02:33:06,033) INFO - qlib.workflow - [exp.py:258] - Experiment 9 starts running ...
[3029722:MainThread](2024-04-25 02:33:06,043) INFO - qlib.workflow - [recorder.py:341] - Recorder 2fc22674df094fe5bbb139dbd1cbf9b1 starts running under Experiment 9 ...
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.991012	valid's l2: 0.996567
[40]	train's l2: 0.987348	valid's l2: 0.99668
[60]	train's l2: 0.985148	valid's l2: 0.996856
Early stopping, best iteration is:
[24]	train's l2: 0.990146	valid's l2: 0.996529
[3029722:MainThread](2024-04-25 02:33:31,775) INFO - qlib.timer - [log.py:127] - Time cost: 0.161s | waiting `async_log` Done
Save pretrained model to gbdt_crowd_data_csi300_360_rankTrue_47.
[3029722:MainThread](2024-04-25 02:33:31,927) INFO - qlib.workflow - [exp.py:258] - Experiment 5 starts running ...
[3029722:MainThread](2024-04-25 02:33:31,937) INFO - qlib.workflow - [recorder.py:341] - Recorder cc881220839a433ca3dba25463d09b76 starts running under Experiment 5 ...
{'IC': 0.017539680988361398,
 'ICIR': 0.12497015039951265,
 'Rank IC': 0.028101527086621156,
 'Rank ICIR': 0.20354051119561578}
[3029722:MainThread](2024-04-25 02:33:37,879) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3029722:MainThread](2024-04-25 02:34:11,526) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:34:11,529) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:34:17,593) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fdad575cbb0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:41,  9.52it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 24.93it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 37.33it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.01it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:20, 47.14it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.82it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.30it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.31it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.40it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 56.00it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 53.91it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 56.56it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 58.22it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 55.54it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 57.74it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 59.07it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.22it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 57.99it/s]backtest loop:  12%|█▏        | 120/971 [00:02<00:14, 58.28it/s]backtest loop:  13%|█▎        | 126/971 [00:02<00:23, 36.25it/s]backtest loop:  14%|█▎        | 133/971 [00:02<00:19, 41.98it/s]backtest loop:  14%|█▍        | 140/971 [00:02<00:17, 46.95it/s]backtest loop:  15%|█▌        | 146/971 [00:03<00:17, 47.69it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 51.72it/s]backtest loop:  16%|█▋        | 160/971 [00:03<00:14, 54.68it/s]backtest loop:  17%|█▋        | 166/971 [00:03<00:15, 53.10it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:14, 55.76it/s]backtest loop:  18%|█▊        | 179/971 [00:03<00:13, 56.64it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:14, 54.18it/s]backtest loop:  20%|█▉        | 191/971 [00:03<00:14, 55.53it/s]backtest loop:  20%|██        | 198/971 [00:03<00:13, 57.50it/s]backtest loop:  21%|██        | 205/971 [00:04<00:13, 55.92it/s]backtest loop:  22%|██▏       | 212/971 [00:04<00:13, 58.03it/s]backtest loop:  22%|██▏       | 218/971 [00:04<00:13, 55.62it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:13, 54.51it/s]backtest loop:  24%|██▍       | 232/971 [00:04<00:13, 56.65it/s]backtest loop:  25%|██▍       | 238/971 [00:04<00:12, 57.12it/s]backtest loop:  25%|██▌       | 245/971 [00:04<00:13, 55.49it/s]backtest loop:  26%|██▌       | 252/971 [00:04<00:12, 58.18it/s]backtest loop:  27%|██▋       | 259/971 [00:05<00:12, 56.74it/s]backtest loop:  27%|██▋       | 266/971 [00:05<00:12, 55.34it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 57.22it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:11, 58.78it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 55.94it/s]backtest loop:  30%|███       | 292/971 [00:05<00:11, 56.97it/s]backtest loop:  31%|███       | 299/971 [00:05<00:11, 58.71it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:11, 55.67it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 57.57it/s]backtest loop:  33%|███▎      | 319/971 [00:06<00:11, 58.87it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:11, 55.88it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:11, 57.80it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 59.17it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 56.20it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 58.38it/s]backtest loop:  37%|███▋      | 359/971 [00:06<00:10, 59.58it/s]backtest loop:  38%|███▊      | 365/971 [00:06<00:10, 57.03it/s]backtest loop:  38%|███▊      | 371/971 [00:06<00:11, 54.08it/s]backtest loop:  39%|███▉      | 378/971 [00:07<00:11, 53.29it/s]backtest loop:  40%|███▉      | 384/971 [00:07<00:10, 54.92it/s]backtest loop:  40%|████      | 390/971 [00:07<00:10, 56.26it/s]backtest loop:  41%|████      | 396/971 [00:07<00:10, 57.29it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 55.37it/s]backtest loop:  42%|████▏     | 409/971 [00:07<00:09, 56.56it/s]backtest loop:  43%|████▎     | 415/971 [00:07<00:09, 57.51it/s]backtest loop:  43%|████▎     | 421/971 [00:07<00:09, 58.16it/s]backtest loop:  44%|████▍     | 427/971 [00:07<00:09, 58.67it/s]backtest loop:  45%|████▍     | 433/971 [00:08<00:09, 55.40it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:09, 57.43it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:09, 58.12it/s]backtest loop:  47%|████▋     | 452/971 [00:08<00:09, 55.02it/s]backtest loop:  47%|████▋     | 458/971 [00:08<00:09, 56.36it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:08, 57.37it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:08, 58.95it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:08, 55.97it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:08, 57.81it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:08, 55.07it/s]backtest loop:  51%|█████     | 496/971 [00:09<00:08, 56.38it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:08, 56.59it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:08, 54.29it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 55.74it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 57.98it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:08, 55.23it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:07, 56.54it/s]backtest loop:  56%|█████▌    | 539/971 [00:09<00:07, 57.48it/s]backtest loop:  56%|█████▌    | 545/971 [00:10<00:07, 57.98it/s]backtest loop:  57%|█████▋    | 551/971 [00:10<00:07, 55.06it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 57.13it/s]backtest loop:  58%|█████▊    | 564/971 [00:10<00:07, 57.90it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 55.84it/s]backtest loop:  59%|█████▉    | 577/971 [00:10<00:06, 56.85it/s]backtest loop:  60%|██████    | 584/971 [00:10<00:06, 58.74it/s]backtest loop:  61%|██████    | 591/971 [00:10<00:06, 56.41it/s]backtest loop:  61%|██████▏   | 597/971 [00:10<00:06, 57.36it/s]backtest loop:  62%|██████▏   | 603/971 [00:11<00:06, 58.02it/s]backtest loop:  63%|██████▎   | 610/971 [00:11<00:06, 55.87it/s]backtest loop:  63%|██████▎   | 616/971 [00:11<00:06, 56.97it/s]backtest loop:  64%|██████▍   | 623/971 [00:11<00:05, 58.68it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:06, 56.44it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:05, 58.25it/s]backtest loop:  66%|██████▌   | 643/971 [00:11<00:05, 58.12it/s]backtest loop:  67%|██████▋   | 649/971 [00:11<00:05, 58.59it/s]backtest loop:  67%|██████▋   | 655/971 [00:11<00:05, 55.53it/s]backtest loop:  68%|██████▊   | 661/971 [00:12<00:05, 56.75it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 57.64it/s]backtest loop:  69%|██████▉   | 673/971 [00:12<00:05, 58.30it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 55.23it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 56.37it/s]backtest loop:  71%|███████   | 691/971 [00:12<00:04, 57.39it/s]backtest loop:  72%|███████▏  | 698/971 [00:12<00:04, 58.84it/s]backtest loop:  73%|███████▎  | 704/971 [00:12<00:04, 55.73it/s]backtest loop:  73%|███████▎  | 710/971 [00:12<00:04, 56.86it/s]backtest loop:  74%|███████▍  | 717/971 [00:13<00:04, 58.46it/s]backtest loop:  75%|███████▍  | 724/971 [00:13<00:04, 56.39it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 55.01it/s]backtest loop:  76%|███████▌  | 737/971 [00:13<00:04, 56.28it/s]backtest loop:  77%|███████▋  | 743/971 [00:13<00:04, 54.21it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 53.40it/s]backtest loop:  78%|███████▊  | 756/971 [00:13<00:03, 55.09it/s]backtest loop:  79%|███████▊  | 763/971 [00:13<00:03, 57.17it/s]backtest loop:  79%|███████▉  | 769/971 [00:13<00:03, 57.94it/s]backtest loop:  80%|███████▉  | 775/971 [00:14<00:03, 54.50it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 56.91it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 54.81it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.03it/s]backtest loop:  82%|████████▏ | 801/971 [00:14<00:02, 57.84it/s]backtest loop:  83%|████████▎ | 807/971 [00:14<00:02, 58.43it/s]backtest loop:  84%|████████▎ | 813/971 [00:14<00:02, 55.29it/s]backtest loop:  84%|████████▍ | 819/971 [00:14<00:02, 56.57it/s]backtest loop:  85%|████████▍ | 825/971 [00:14<00:02, 57.52it/s]backtest loop:  86%|████████▌ | 831/971 [00:15<00:02, 58.23it/s]backtest loop:  86%|████████▌ | 837/971 [00:15<00:02, 58.64it/s]backtest loop:  87%|████████▋ | 843/971 [00:15<00:02, 55.43it/s]backtest loop:  87%|████████▋ | 849/971 [00:15<00:02, 56.71it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:02, 57.65it/s]backtest loop:  89%|████████▊ | 861/971 [00:15<00:01, 58.26it/s]backtest loop:  89%|████████▉ | 867/971 [00:15<00:01, 55.14it/s]backtest loop:  90%|█████████ | 874/971 [00:15<00:01, 57.31it/s]backtest loop:  91%|█████████ | 880/971 [00:15<00:01, 57.97it/s]backtest loop:  91%|█████████ | 886/971 [00:16<00:01, 58.17it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 54.93it/s]backtest loop:  92%|█████████▏| 898/971 [00:16<00:01, 56.26it/s]backtest loop:  93%|█████████▎| 904/971 [00:16<00:01, 56.54it/s]backtest loop:  94%|█████████▎| 910/971 [00:16<00:01, 57.44it/s]backtest loop:  94%|█████████▍| 916/971 [00:16<00:01, 54.68it/s]backtest loop:  95%|█████████▍| 922/971 [00:16<00:00, 56.06it/s]backtest loop:  96%|█████████▌| 929/971 [00:16<00:00, 57.97it/s]backtest loop:  96%|█████████▋| 936/971 [00:16<00:00, 55.89it/s]backtest loop:  97%|█████████▋| 942/971 [00:17<00:00, 56.90it/s]backtest loop:  98%|█████████▊| 949/971 [00:17<00:00, 58.55it/s]backtest loop:  98%|█████████▊| 955/971 [00:17<00:00, 55.59it/s]backtest loop:  99%|█████████▉| 961/971 [00:17<00:00, 56.77it/s]backtest loop: 100%|█████████▉| 967/971 [00:17<00:00, 57.58it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.37it/s]
[3029722:MainThread](2024-04-25 02:34:35,189) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000328
std                0.005204
annualized_return  0.078107
information_ratio  0.972861
max_drawdown      -0.089545
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000129
std                0.005204
annualized_return  0.030707
information_ratio  0.382473
max_drawdown      -0.121424
[3029722:MainThread](2024-04-25 02:34:35,203) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `gbdt_crowd_data_csi300_360_rankTrue`.
[3029722:MainThread](2024-04-25 02:34:41,228) INFO - qlib.timer - [log.py:127] - Time cost: 0.005s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277],
 '1day.excess_return_with_cost.information_ratio': [0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038],
 '1day.excess_return_with_cost.max_drawdown': [-0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872],
 'IC': [0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398],
 'ICIR': [0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265],
 'Rank IC': [0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156],
 'Rank ICIR': [0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578],
 'mae': [0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036],
 'mse': [0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3029722:MainThread](2024-04-25 02:34:45,588) INFO - qlib.workflow - [exp.py:258] - Experiment 10 starts running ...
[3029722:MainThread](2024-04-25 02:34:45,596) INFO - qlib.workflow - [recorder.py:341] - Recorder 4236e2bf3db046ab9093313b490716af starts running under Experiment 10 ...
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.991012	valid's l2: 0.996567
[40]	train's l2: 0.987348	valid's l2: 0.99668
[60]	train's l2: 0.985148	valid's l2: 0.996856
Early stopping, best iteration is:
[24]	train's l2: 0.990146	valid's l2: 0.996529
[3029722:MainThread](2024-04-25 02:35:13,700) INFO - qlib.timer - [log.py:127] - Time cost: 0.121s | waiting `async_log` Done
Save pretrained model to gbdt_crowd_data_csi300_360_rankTrue_48.
[3029722:MainThread](2024-04-25 02:35:13,873) INFO - qlib.workflow - [exp.py:258] - Experiment 5 starts running ...
[3029722:MainThread](2024-04-25 02:35:13,883) INFO - qlib.workflow - [recorder.py:341] - Recorder a66fc85956f74d5c98c52831e22ae914 starts running under Experiment 5 ...
{'IC': 0.017539680988361398,
 'ICIR': 0.12497015039951265,
 'Rank IC': 0.028101527086621156,
 'Rank ICIR': 0.20354051119561578}
[3029722:MainThread](2024-04-25 02:35:19,812) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3029722:MainThread](2024-04-25 02:35:53,575) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:35:53,578) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:35:59,545) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fdad04ee8e0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:47,  9.02it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.31it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 36.74it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.61it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:20, 46.83it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.67it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.21it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.23it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.15it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 55.87it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 53.89it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 56.58it/s]backtest loop:   8%|▊         | 80/971 [00:01<00:15, 57.48it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 55.68it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 57.75it/s]backtest loop:  10%|█         | 100/971 [00:02<00:15, 57.78it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.08it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 57.87it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.23it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:24, 35.14it/s]backtest loop:  14%|█▎        | 133/971 [00:02<00:21, 39.72it/s]backtest loop:  14%|█▍        | 140/971 [00:02<00:18, 45.10it/s]backtest loop:  15%|█▌        | 146/971 [00:03<00:17, 46.29it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:16, 50.57it/s]backtest loop:  16%|█▋        | 160/971 [00:03<00:15, 53.80it/s]backtest loop:  17%|█▋        | 166/971 [00:03<00:15, 52.47it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:14, 55.30it/s]backtest loop:  18%|█▊        | 179/971 [00:03<00:14, 55.70it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:14, 53.65it/s]backtest loop:  20%|█▉        | 191/971 [00:03<00:14, 55.33it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 56.62it/s]backtest loop:  21%|██        | 204/971 [00:04<00:13, 58.50it/s]backtest loop:  22%|██▏       | 210/971 [00:04<00:13, 56.00it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:14, 53.87it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:13, 56.63it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 55.07it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 57.08it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 58.70it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 56.29it/s]backtest loop:  26%|██▋       | 257/971 [00:05<00:12, 59.01it/s]backtest loop:  27%|██▋       | 264/971 [00:05<00:12, 56.69it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:12, 55.19it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:12, 57.26it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:11, 58.65it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 55.81it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 57.78it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:11, 55.85it/s]backtest loop:  32%|███▏      | 311/971 [00:05<00:11, 56.92it/s]backtest loop:  33%|███▎      | 318/971 [00:06<00:11, 58.50it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:11, 56.27it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:11, 58.02it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 59.25it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 56.27it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 58.44it/s]backtest loop:  37%|███▋      | 358/971 [00:06<00:10, 58.53it/s]backtest loop:  37%|███▋      | 364/971 [00:06<00:10, 56.22it/s]backtest loop:  38%|███▊      | 370/971 [00:07<00:11, 54.04it/s]backtest loop:  39%|███▉      | 377/971 [00:07<00:10, 56.43it/s]backtest loop:  39%|███▉      | 383/971 [00:07<00:10, 54.19it/s]backtest loop:  40%|████      | 389/971 [00:07<00:10, 55.67it/s]backtest loop:  41%|████      | 396/971 [00:07<00:09, 57.60it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 55.67it/s]backtest loop:  42%|████▏     | 409/971 [00:07<00:09, 56.78it/s]backtest loop:  43%|████▎     | 416/971 [00:07<00:09, 58.36it/s]backtest loop:  43%|████▎     | 422/971 [00:07<00:09, 58.66it/s]backtest loop:  44%|████▍     | 428/971 [00:08<00:09, 55.52it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:09, 57.50it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 58.18it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 55.17it/s]backtest loop:  47%|████▋     | 453/971 [00:08<00:09, 56.09it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:08, 57.16it/s]backtest loop:  48%|████▊     | 465/971 [00:08<00:08, 57.96it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:08, 55.87it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 57.91it/s]backtest loop:  50%|████▉     | 485/971 [00:09<00:08, 58.47it/s]backtest loop:  51%|█████     | 491/971 [00:09<00:08, 55.46it/s]backtest loop:  51%|█████     | 497/971 [00:09<00:08, 56.66it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:07, 58.44it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:08, 55.61it/s]backtest loop:  53%|█████▎    | 517/971 [00:09<00:08, 54.54it/s]backtest loop:  54%|█████▍    | 524/971 [00:09<00:07, 56.86it/s]backtest loop:  55%|█████▍    | 531/971 [00:09<00:07, 55.50it/s]backtest loop:  55%|█████▌    | 538/971 [00:09<00:07, 57.78it/s]backtest loop:  56%|█████▌    | 544/971 [00:10<00:07, 57.93it/s]backtest loop:  57%|█████▋    | 551/971 [00:10<00:07, 55.96it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 57.71it/s]backtest loop:  58%|█████▊    | 565/971 [00:10<00:06, 59.03it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 56.10it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:06, 57.77it/s]backtest loop:  60%|██████    | 585/971 [00:10<00:06, 59.48it/s]backtest loop:  61%|██████    | 591/971 [00:10<00:06, 56.28it/s]backtest loop:  62%|██████▏   | 598/971 [00:10<00:06, 57.97it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:06, 55.97it/s]backtest loop:  63%|██████▎   | 611/971 [00:11<00:06, 57.02it/s]backtest loop:  64%|██████▎   | 618/971 [00:11<00:06, 58.51it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 56.64it/s]backtest loop:  65%|██████▍   | 631/971 [00:11<00:05, 57.49it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:05, 57.77it/s]backtest loop:  66%|██████▌   | 643/971 [00:11<00:05, 58.28it/s]backtest loop:  67%|██████▋   | 650/971 [00:11<00:05, 56.01it/s]backtest loop:  68%|██████▊   | 656/971 [00:12<00:05, 57.09it/s]backtest loop:  68%|██████▊   | 662/971 [00:12<00:05, 57.83it/s]backtest loop:  69%|██████▉   | 668/971 [00:12<00:05, 58.42it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:05, 55.29it/s]backtest loop:  70%|███████   | 680/971 [00:12<00:05, 56.59it/s]backtest loop:  71%|███████   | 686/971 [00:12<00:04, 57.48it/s]backtest loop:  71%|███████▏  | 693/971 [00:12<00:04, 58.90it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 55.67it/s]backtest loop:  73%|███████▎  | 705/971 [00:12<00:04, 56.81it/s]backtest loop:  73%|███████▎  | 711/971 [00:12<00:04, 57.53it/s]backtest loop:  74%|███████▍  | 718/971 [00:13<00:04, 59.00it/s]backtest loop:  75%|███████▍  | 724/971 [00:13<00:04, 55.92it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 54.60it/s]backtest loop:  76%|███████▌  | 737/971 [00:13<00:04, 55.98it/s]backtest loop:  77%|███████▋  | 743/971 [00:13<00:04, 53.93it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 53.23it/s]backtest loop:  78%|███████▊  | 756/971 [00:13<00:03, 54.95it/s]backtest loop:  79%|███████▊  | 763/971 [00:13<00:03, 57.10it/s]backtest loop:  79%|███████▉  | 769/971 [00:14<00:03, 57.89it/s]backtest loop:  80%|███████▉  | 775/971 [00:14<00:03, 54.81it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 57.08it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 54.96it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.16it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 58.59it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 55.59it/s]backtest loop:  84%|████████▍ | 814/971 [00:14<00:02, 56.59it/s]backtest loop:  84%|████████▍ | 820/971 [00:14<00:02, 57.49it/s]backtest loop:  85%|████████▌ | 827/971 [00:15<00:02, 58.98it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 55.84it/s]backtest loop:  86%|████████▋ | 839/971 [00:15<00:02, 56.94it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 57.71it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 55.68it/s]backtest loop:  88%|████████▊ | 859/971 [00:15<00:01, 57.57it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 58.91it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 55.96it/s]backtest loop:  90%|█████████ | 878/971 [00:15<00:01, 56.98it/s]backtest loop:  91%|█████████ | 885/971 [00:16<00:01, 58.59it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 56.29it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 58.00it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 59.22it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 55.92it/s]backtest loop:  95%|█████████▍| 918/971 [00:16<00:00, 56.73it/s]backtest loop:  95%|█████████▌| 924/971 [00:16<00:00, 57.56it/s]backtest loop:  96%|█████████▌| 931/971 [00:16<00:00, 55.79it/s]backtest loop:  97%|█████████▋| 938/971 [00:16<00:00, 57.59it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 55.64it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 57.62it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 58.91it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 55.86it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 56.91it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.30it/s]
[3029722:MainThread](2024-04-25 02:36:17,166) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000328
std                0.005204
annualized_return  0.078107
information_ratio  0.972861
max_drawdown      -0.089545
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000129
std                0.005204
annualized_return  0.030707
information_ratio  0.382473
max_drawdown      -0.121424
[3029722:MainThread](2024-04-25 02:36:17,179) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `gbdt_crowd_data_csi300_360_rankTrue`.
[3029722:MainThread](2024-04-25 02:36:23,219) INFO - qlib.timer - [log.py:127] - Time cost: 0.005s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277],
 '1day.excess_return_with_cost.information_ratio': [0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038],
 '1day.excess_return_with_cost.max_drawdown': [-0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872],
 'IC': [0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398],
 'ICIR': [0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265],
 'Rank IC': [0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156],
 'Rank ICIR': [0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578],
 'mae': [0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036],
 'mse': [0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3029722:MainThread](2024-04-25 02:36:27,568) INFO - qlib.workflow - [exp.py:258] - Experiment 11 starts running ...
[3029722:MainThread](2024-04-25 02:36:27,578) INFO - qlib.workflow - [recorder.py:341] - Recorder b26ef8bbb7b840a9a5941f10f78d08bc starts running under Experiment 11 ...
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.991012	valid's l2: 0.996567
[40]	train's l2: 0.987348	valid's l2: 0.99668
[60]	train's l2: 0.985148	valid's l2: 0.996856
Early stopping, best iteration is:
[24]	train's l2: 0.990146	valid's l2: 0.996529
[3029722:MainThread](2024-04-25 02:36:53,004) INFO - qlib.timer - [log.py:127] - Time cost: 0.132s | waiting `async_log` Done
Save pretrained model to gbdt_crowd_data_csi300_360_rankTrue_49.
[3029722:MainThread](2024-04-25 02:36:53,172) INFO - qlib.workflow - [exp.py:258] - Experiment 5 starts running ...
[3029722:MainThread](2024-04-25 02:36:53,182) INFO - qlib.workflow - [recorder.py:341] - Recorder 00ffd91878964525bd7a45cc18004bba starts running under Experiment 5 ...
{'IC': 0.017539680988361398,
 'ICIR': 0.12497015039951265,
 'Rank IC': 0.028101527086621156,
 'Rank ICIR': 0.20354051119561578}
[3029722:MainThread](2024-04-25 02:36:59,046) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3029722:MainThread](2024-04-25 02:37:33,084) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:37:33,087) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:37:38,987) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fdad5a96c10>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:47,  8.96it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.16it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:26, 36.59it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 39.48it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:20, 46.75it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.57it/s]backtest loop:   4%|▍         | 41/971 [00:01<00:17, 52.15it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.26it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.39it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 56.07it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.05it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 56.70it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 58.40it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 55.69it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 57.93it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 59.28it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.35it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 58.07it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.34it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:22, 37.04it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:19, 42.71it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:18, 45.33it/s]backtest loop:  15%|█▌        | 148/971 [00:03<00:16, 49.55it/s]backtest loop:  16%|█▌        | 155/971 [00:03<00:15, 53.17it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:15, 52.11it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:14, 54.91it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:13, 57.14it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:14, 54.87it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 57.13it/s]backtest loop:  20%|██        | 195/971 [00:03<00:14, 55.38it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 57.43it/s]backtest loop:  22%|██▏       | 209/971 [00:04<00:12, 59.32it/s]backtest loop:  22%|██▏       | 215/971 [00:04<00:14, 53.28it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:13, 56.16it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:12, 57.97it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:13, 55.32it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:12, 57.35it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:12, 56.09it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:12, 58.82it/s]backtest loop:  27%|██▋       | 263/971 [00:05<00:11, 60.03it/s]backtest loop:  28%|██▊       | 270/971 [00:05<00:12, 57.52it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:12, 55.17it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:12, 57.24it/s]backtest loop:  30%|██▉       | 290/971 [00:05<00:11, 58.73it/s]backtest loop:  30%|███       | 296/971 [00:05<00:12, 55.97it/s]backtest loop:  31%|███       | 303/971 [00:05<00:11, 57.79it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:11, 55.88it/s]backtest loop:  33%|███▎      | 317/971 [00:06<00:11, 57.70it/s]backtest loop:  33%|███▎      | 324/971 [00:06<00:10, 59.04it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:11, 56.10it/s]backtest loop:  35%|███▍      | 337/971 [00:06<00:10, 57.92it/s]backtest loop:  35%|███▌      | 344/971 [00:06<00:10, 59.25it/s]backtest loop:  36%|███▌      | 350/971 [00:06<00:10, 56.68it/s]backtest loop:  37%|███▋      | 357/971 [00:06<00:10, 58.47it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:10, 56.26it/s]backtest loop:  38%|███▊      | 369/971 [00:06<00:11, 54.20it/s]backtest loop:  39%|███▊      | 376/971 [00:07<00:10, 56.59it/s]backtest loop:  39%|███▉      | 383/971 [00:07<00:10, 55.06it/s]backtest loop:  40%|████      | 389/971 [00:07<00:10, 56.32it/s]backtest loop:  41%|████      | 396/971 [00:07<00:09, 58.09it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 56.04it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:09, 57.77it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 59.08it/s]backtest loop:  44%|████▎     | 423/971 [00:07<00:09, 56.06it/s]backtest loop:  44%|████▍     | 430/971 [00:07<00:09, 57.82it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:09, 55.88it/s]backtest loop:  46%|████▌     | 444/971 [00:08<00:09, 57.67it/s]backtest loop:  46%|████▋     | 450/971 [00:08<00:08, 58.26it/s]backtest loop:  47%|████▋     | 456/971 [00:08<00:08, 58.52it/s]backtest loop:  48%|████▊     | 462/971 [00:08<00:09, 55.44it/s]backtest loop:  48%|████▊     | 468/971 [00:08<00:08, 56.56it/s]backtest loop:  49%|████▉     | 475/971 [00:08<00:08, 58.52it/s]backtest loop:  50%|████▉     | 482/971 [00:08<00:08, 56.43it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:08, 58.08it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:08, 55.32it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:08, 57.42it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:08, 55.08it/s]backtest loop:  53%|█████▎    | 515/971 [00:09<00:07, 57.12it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:08, 55.89it/s]backtest loop:  54%|█████▍    | 529/971 [00:09<00:07, 57.88it/s]backtest loop:  55%|█████▌    | 536/971 [00:09<00:07, 56.45it/s]backtest loop:  56%|█████▌    | 543/971 [00:09<00:07, 58.11it/s]backtest loop:  57%|█████▋    | 550/971 [00:10<00:07, 59.34it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:07, 56.20it/s]backtest loop:  58%|█████▊    | 563/971 [00:10<00:07, 57.92it/s]backtest loop:  59%|█████▊    | 570/971 [00:10<00:06, 59.23it/s]backtest loop:  59%|█████▉    | 576/971 [00:10<00:07, 56.16it/s]backtest loop:  60%|██████    | 583/971 [00:10<00:06, 58.17it/s]backtest loop:  61%|██████    | 590/971 [00:10<00:06, 59.45it/s]backtest loop:  61%|██████▏   | 596/971 [00:10<00:06, 56.23it/s]backtest loop:  62%|██████▏   | 603/971 [00:11<00:06, 57.99it/s]backtest loop:  63%|██████▎   | 610/971 [00:11<00:06, 55.93it/s]backtest loop:  64%|██████▎   | 617/971 [00:11<00:06, 57.67it/s]backtest loop:  64%|██████▍   | 624/971 [00:11<00:05, 59.23it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:06, 56.18it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:05, 58.19it/s]backtest loop:  66%|██████▌   | 643/971 [00:11<00:05, 58.67it/s]backtest loop:  67%|██████▋   | 650/971 [00:11<00:05, 56.37it/s]backtest loop:  68%|██████▊   | 657/971 [00:11<00:05, 58.05it/s]backtest loop:  68%|██████▊   | 664/971 [00:12<00:05, 59.30it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 56.14it/s]backtest loop:  70%|██████▉   | 677/971 [00:12<00:05, 57.86it/s]backtest loop:  70%|███████   | 683/971 [00:12<00:04, 58.26it/s]backtest loop:  71%|███████   | 689/971 [00:12<00:05, 55.39it/s]backtest loop:  72%|███████▏  | 696/971 [00:12<00:04, 57.42it/s]backtest loop:  72%|███████▏  | 703/971 [00:12<00:04, 58.90it/s]backtest loop:  73%|███████▎  | 709/971 [00:12<00:04, 55.79it/s]backtest loop:  74%|███████▎  | 716/971 [00:12<00:04, 57.71it/s]backtest loop:  74%|███████▍  | 723/971 [00:13<00:04, 59.23it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 56.36it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 54.13it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 55.57it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.47it/s]backtest loop:  78%|███████▊  | 754/971 [00:13<00:03, 55.93it/s]backtest loop:  78%|███████▊  | 760/971 [00:13<00:03, 53.87it/s]backtest loop:  79%|███████▉  | 767/971 [00:13<00:03, 56.31it/s]backtest loop:  80%|███████▉  | 774/971 [00:14<00:03, 58.02it/s]backtest loop:  80%|████████  | 780/971 [00:14<00:03, 55.37it/s]backtest loop:  81%|████████  | 787/971 [00:14<00:03, 58.01it/s]backtest loop:  82%|████████▏ | 793/971 [00:14<00:03, 55.27it/s]backtest loop:  82%|████████▏ | 799/971 [00:14<00:03, 56.47it/s]backtest loop:  83%|████████▎ | 806/971 [00:14<00:02, 58.14it/s]backtest loop:  84%|████████▎ | 812/971 [00:14<00:02, 58.49it/s]backtest loop:  84%|████████▍ | 818/971 [00:14<00:02, 55.47it/s]backtest loop:  85%|████████▍ | 824/971 [00:14<00:02, 56.71it/s]backtest loop:  86%|████████▌ | 831/971 [00:15<00:02, 58.52it/s]backtest loop:  86%|████████▌ | 837/971 [00:15<00:02, 58.93it/s]backtest loop:  87%|████████▋ | 843/971 [00:15<00:02, 55.75it/s]backtest loop:  88%|████████▊ | 850/971 [00:15<00:02, 57.75it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 55.76it/s]backtest loop:  89%|████████▉ | 864/971 [00:15<00:01, 57.62it/s]backtest loop:  90%|████████▉ | 871/971 [00:15<00:01, 58.98it/s]backtest loop:  90%|█████████ | 877/971 [00:15<00:01, 55.97it/s]backtest loop:  91%|█████████ | 884/971 [00:15<00:01, 57.84it/s]backtest loop:  92%|█████████▏| 891/971 [00:16<00:01, 59.12it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 56.11it/s]backtest loop:  93%|█████████▎| 903/971 [00:16<00:01, 57.09it/s]backtest loop:  94%|█████████▎| 910/971 [00:16<00:01, 58.65it/s]backtest loop:  94%|█████████▍| 916/971 [00:16<00:00, 55.70it/s]backtest loop:  95%|█████████▌| 923/971 [00:16<00:00, 57.61it/s]backtest loop:  96%|█████████▌| 930/971 [00:16<00:00, 58.74it/s]backtest loop:  96%|█████████▋| 936/971 [00:16<00:00, 55.80it/s]backtest loop:  97%|█████████▋| 943/971 [00:16<00:00, 57.65it/s]backtest loop:  98%|█████████▊| 950/971 [00:17<00:00, 55.98it/s]backtest loop:  99%|█████████▊| 957/971 [00:17<00:00, 57.79it/s]backtest loop:  99%|█████████▉| 964/971 [00:17<00:00, 59.08it/s]backtest loop: 100%|█████████▉| 970/971 [00:17<00:00, 55.97it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.63it/s]
[3029722:MainThread](2024-04-25 02:37:56,497) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000328
std                0.005204
annualized_return  0.078107
information_ratio  0.972861
max_drawdown      -0.089545
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000129
std                0.005204
annualized_return  0.030707
information_ratio  0.382473
max_drawdown      -0.121424
[3029722:MainThread](2024-04-25 02:37:56,509) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `gbdt_crowd_data_csi300_360_rankTrue`.
[3029722:MainThread](2024-04-25 02:38:02,506) INFO - qlib.timer - [log.py:127] - Time cost: 0.005s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277],
 '1day.excess_return_with_cost.information_ratio': [0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038],
 '1day.excess_return_with_cost.max_drawdown': [-0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872],
 'IC': [0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398],
 'ICIR': [0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265],
 'Rank IC': [0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156],
 'Rank ICIR': [0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578],
 'mae': [0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036],
 'mse': [0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3029722:MainThread](2024-04-25 02:38:06,906) INFO - qlib.workflow - [exp.py:258] - Experiment 12 starts running ...
[3029722:MainThread](2024-04-25 02:38:06,915) INFO - qlib.workflow - [recorder.py:341] - Recorder 77ace6d7ddef4cbebae0df9ba1ac173a starts running under Experiment 12 ...
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.991012	valid's l2: 0.996567
[40]	train's l2: 0.987348	valid's l2: 0.99668
[60]	train's l2: 0.985148	valid's l2: 0.996856
Early stopping, best iteration is:
[24]	train's l2: 0.990146	valid's l2: 0.996529
[3029722:MainThread](2024-04-25 02:38:33,103) INFO - qlib.timer - [log.py:127] - Time cost: 0.109s | waiting `async_log` Done
Save pretrained model to gbdt_crowd_data_csi300_360_rankTrue_50.
[3029722:MainThread](2024-04-25 02:38:33,254) INFO - qlib.workflow - [exp.py:258] - Experiment 5 starts running ...
[3029722:MainThread](2024-04-25 02:38:33,265) INFO - qlib.workflow - [recorder.py:341] - Recorder 14b28a8d14364267912bf35fff7b6fbf starts running under Experiment 5 ...
{'IC': 0.017539680988361398,
 'ICIR': 0.12497015039951265,
 'Rank IC': 0.028101527086621156,
 'Rank ICIR': 0.20354051119561578}
[3029722:MainThread](2024-04-25 02:38:39,272) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3029722:MainThread](2024-04-25 02:39:13,420) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:39:13,423) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:39:19,495) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fdada643490>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:41,  9.55it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 25.23it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 37.67it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.27it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.82it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:18, 49.97it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:18, 49.84it/s]backtest loop:   5%|▍         | 46/971 [00:01<00:17, 53.68it/s]backtest loop:   5%|▌         | 53/971 [00:01<00:16, 56.29it/s]backtest loop:   6%|▌         | 59/971 [00:01<00:16, 53.72it/s]backtest loop:   7%|▋         | 65/971 [00:01<00:16, 54.80it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 54.11it/s]backtest loop:   8%|▊         | 79/971 [00:01<00:15, 56.45it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:15, 58.06it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:15, 55.54it/s]backtest loop:  10%|█         | 99/971 [00:02<00:15, 57.47it/s]backtest loop:  11%|█         | 106/971 [00:02<00:14, 58.99it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 55.91it/s]backtest loop:  12%|█▏        | 118/971 [00:02<00:15, 56.74it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:14, 57.63it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:22, 37.40it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:20, 40.51it/s]backtest loop:  15%|█▍        | 142/971 [00:02<00:18, 44.72it/s]backtest loop:  15%|█▌        | 149/971 [00:03<00:16, 49.36it/s]backtest loop:  16%|█▌        | 156/971 [00:03<00:16, 50.45it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:15, 53.58it/s]backtest loop:  17%|█▋        | 169/971 [00:03<00:14, 55.13it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 54.18it/s]backtest loop:  19%|█▊        | 182/971 [00:03<00:14, 55.65it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:13, 57.70it/s]backtest loop:  20%|██        | 195/971 [00:03<00:14, 54.95it/s]backtest loop:  21%|██        | 201/971 [00:03<00:13, 56.26it/s]backtest loop:  21%|██▏       | 208/971 [00:04<00:13, 58.30it/s]backtest loop:  22%|██▏       | 214/971 [00:04<00:13, 55.66it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 53.86it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:13, 56.38it/s]backtest loop:  24%|██▍       | 233/971 [00:04<00:12, 57.34it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:13, 55.51it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:12, 57.59it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:12, 56.48it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:12, 58.51it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:12, 55.78it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 56.17it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:12, 56.46it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:11, 57.41it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 54.79it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 57.16it/s]backtest loop:  31%|███▏      | 304/971 [00:05<00:11, 57.80it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:12, 54.71it/s]backtest loop:  33%|███▎      | 317/971 [00:06<00:11, 56.92it/s]backtest loop:  33%|███▎      | 324/971 [00:06<00:11, 58.55it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:11, 55.64it/s]backtest loop:  35%|███▍      | 336/971 [00:06<00:11, 56.48it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:10, 57.23it/s]backtest loop:  36%|███▌      | 349/971 [00:06<00:10, 59.16it/s]backtest loop:  37%|███▋      | 355/971 [00:06<00:10, 56.11it/s]backtest loop:  37%|███▋      | 362/971 [00:06<00:10, 58.50it/s]backtest loop:  38%|███▊      | 368/971 [00:06<00:11, 52.84it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:10, 55.53it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:10, 56.48it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:10, 54.87it/s]backtest loop:  41%|████      | 395/971 [00:07<00:10, 56.97it/s]backtest loop:  41%|████▏     | 402/971 [00:07<00:09, 58.58it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:10, 55.70it/s]backtest loop:  43%|████▎     | 415/971 [00:07<00:09, 57.57it/s]backtest loop:  43%|████▎     | 421/971 [00:07<00:09, 57.94it/s]backtest loop:  44%|████▍     | 427/971 [00:07<00:09, 58.47it/s]backtest loop:  45%|████▍     | 433/971 [00:08<00:09, 55.42it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:09, 57.49it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 55.53it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:08, 57.52it/s]backtest loop:  47%|████▋     | 460/971 [00:08<00:08, 58.11it/s]backtest loop:  48%|████▊     | 466/971 [00:08<00:08, 58.58it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:08, 55.68it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 57.97it/s]backtest loop:  50%|█████     | 486/971 [00:08<00:08, 59.30it/s]backtest loop:  51%|█████     | 492/971 [00:09<00:08, 56.21it/s]backtest loop:  51%|█████▏    | 499/971 [00:09<00:08, 57.94it/s]backtest loop:  52%|█████▏    | 505/971 [00:09<00:08, 55.15it/s]backtest loop:  53%|█████▎    | 512/971 [00:09<00:08, 53.96it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:07, 56.69it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 55.30it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:07, 57.78it/s]backtest loop:  56%|█████▌    | 540/971 [00:09<00:07, 59.32it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 56.01it/s]backtest loop:  57%|█████▋    | 553/971 [00:10<00:07, 57.82it/s]backtest loop:  58%|█████▊    | 560/971 [00:10<00:06, 59.16it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 56.06it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:06, 58.01it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 59.27it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:06, 56.14it/s]backtest loop:  61%|██████    | 593/971 [00:10<00:06, 57.97it/s]backtest loop:  62%|██████▏   | 600/971 [00:11<00:06, 56.08it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 57.93it/s]backtest loop:  63%|██████▎   | 614/971 [00:11<00:06, 59.25it/s]backtest loop:  64%|██████▍   | 620/971 [00:11<00:06, 56.33it/s]backtest loop:  65%|██████▍   | 627/971 [00:11<00:05, 58.02it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:05, 59.29it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:05, 56.41it/s]backtest loop:  67%|██████▋   | 646/971 [00:11<00:05, 57.28it/s]backtest loop:  67%|██████▋   | 653/971 [00:11<00:05, 58.73it/s]backtest loop:  68%|██████▊   | 660/971 [00:12<00:05, 56.43it/s]backtest loop:  69%|██████▊   | 666/971 [00:12<00:05, 57.26it/s]backtest loop:  69%|██████▉   | 672/971 [00:12<00:05, 57.94it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 55.81it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 56.92it/s]backtest loop:  71%|███████▏  | 692/971 [00:12<00:04, 58.50it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 56.35it/s]backtest loop:  73%|███████▎  | 705/971 [00:12<00:04, 57.10it/s]backtest loop:  73%|███████▎  | 711/971 [00:12<00:04, 57.79it/s]backtest loop:  74%|███████▍  | 718/971 [00:13<00:04, 59.12it/s]backtest loop:  75%|███████▍  | 724/971 [00:13<00:04, 56.20it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 54.90it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 54.05it/s]backtest loop:  77%|███████▋  | 744/971 [00:13<00:04, 55.48it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 53.44it/s]backtest loop:  78%|███████▊  | 756/971 [00:13<00:03, 55.17it/s]backtest loop:  79%|███████▊  | 763/971 [00:13<00:03, 57.35it/s]backtest loop:  79%|███████▉  | 770/971 [00:13<00:03, 55.55it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 57.45it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 55.26it/s]backtest loop:  81%|████████▏ | 790/971 [00:14<00:03, 57.35it/s]backtest loop:  82%|████████▏ | 797/971 [00:14<00:02, 58.76it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:03, 55.82it/s]backtest loop:  83%|████████▎ | 809/971 [00:14<00:02, 56.92it/s]backtest loop:  84%|████████▍ | 816/971 [00:14<00:02, 58.50it/s]backtest loop:  85%|████████▍ | 823/971 [00:14<00:02, 56.20it/s]backtest loop:  85%|████████▌ | 829/971 [00:15<00:02, 57.17it/s]backtest loop:  86%|████████▌ | 835/971 [00:15<00:02, 57.80it/s]backtest loop:  87%|████████▋ | 841/971 [00:15<00:02, 57.18it/s]backtest loop:  87%|████████▋ | 847/971 [00:15<00:02, 55.68it/s]backtest loop:  88%|████████▊ | 853/971 [00:15<00:02, 50.11it/s]backtest loop:  88%|████████▊ | 859/971 [00:15<00:02, 50.36it/s]backtest loop:  89%|████████▉ | 865/971 [00:15<00:02, 51.52it/s]backtest loop:  90%|████████▉ | 871/971 [00:15<00:01, 50.71it/s]backtest loop:  90%|█████████ | 877/971 [00:15<00:01, 47.23it/s]backtest loop:  91%|█████████ | 883/971 [00:16<00:01, 49.53it/s]backtest loop:  92%|█████████▏| 889/971 [00:16<00:01, 51.47it/s]backtest loop:  92%|█████████▏| 895/971 [00:16<00:01, 52.71it/s]backtest loop:  93%|█████████▎| 901/971 [00:16<00:01, 53.63it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 48.72it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 46.52it/s]backtest loop:  95%|█████████▍| 918/971 [00:16<00:01, 48.78it/s]backtest loop:  95%|█████████▌| 924/971 [00:16<00:00, 50.61it/s]backtest loop:  96%|█████████▌| 930/971 [00:17<00:00, 48.57it/s]backtest loop:  96%|█████████▋| 935/971 [00:17<00:00, 46.47it/s]backtest loop:  97%|█████████▋| 940/971 [00:17<00:00, 45.28it/s]backtest loop:  97%|█████████▋| 946/971 [00:17<00:00, 48.10it/s]backtest loop:  98%|█████████▊| 951/971 [00:17<00:00, 48.37it/s]backtest loop:  98%|█████████▊| 956/971 [00:17<00:00, 46.95it/s]backtest loop:  99%|█████████▉| 961/971 [00:17<00:00, 46.15it/s]backtest loop:  99%|█████████▉| 966/971 [00:17<00:00, 44.24it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 42.65it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.02it/s]
[3029722:MainThread](2024-04-25 02:39:37,559) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000328
std                0.005204
annualized_return  0.078107
information_ratio  0.972861
max_drawdown      -0.089545
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000129
std                0.005204
annualized_return  0.030707
information_ratio  0.382473
max_drawdown      -0.121424
[3029722:MainThread](2024-04-25 02:39:37,577) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `gbdt_crowd_data_csi300_360_rankTrue`.
[3029722:MainThread](2024-04-25 02:39:43,578) INFO - qlib.timer - [log.py:127] - Time cost: 0.005s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277],
 '1day.excess_return_with_cost.information_ratio': [0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038],
 '1day.excess_return_with_cost.max_drawdown': [-0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872],
 'IC': [0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398],
 'ICIR': [0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265],
 'Rank IC': [0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156],
 'Rank ICIR': [0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578],
 'mae': [0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036],
 'mse': [0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3029722:MainThread](2024-04-25 02:39:47,921) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name gbdt_crowd_data_csi300_360_rankTrue_51.
[3029722:MainThread](2024-04-25 02:39:47,929) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3029722:MainThread](2024-04-25 02:39:47,939) INFO - qlib.workflow - [recorder.py:341] - Recorder 078e496e00ac4161ae784d8dd09be3e3 starts running under Experiment 13 ...
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.991012	valid's l2: 0.996567
[40]	train's l2: 0.987348	valid's l2: 0.99668
[60]	train's l2: 0.985148	valid's l2: 0.996856
Early stopping, best iteration is:
[24]	train's l2: 0.990146	valid's l2: 0.996529
[3029722:MainThread](2024-04-25 02:40:12,124) INFO - qlib.timer - [log.py:127] - Time cost: 0.112s | waiting `async_log` Done
Save pretrained model to gbdt_crowd_data_csi300_360_rankTrue_51.
[3029722:MainThread](2024-04-25 02:40:12,306) INFO - qlib.workflow - [exp.py:258] - Experiment 5 starts running ...
[3029722:MainThread](2024-04-25 02:40:12,316) INFO - qlib.workflow - [recorder.py:341] - Recorder f2f778fe20694fb0ac85d346fb5c1d1b starts running under Experiment 5 ...
{'IC': 0.017539680988361398,
 'ICIR': 0.12497015039951265,
 'Rank IC': 0.028101527086621156,
 'Rank ICIR': 0.20354051119561578}
[3029722:MainThread](2024-04-25 02:40:18,258) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3029722:MainThread](2024-04-25 02:40:52,076) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:40:52,080) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:40:58,023) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fdac67aa7f0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:45,  9.17it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.33it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 36.79it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.63it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:20, 46.84it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.57it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.12it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.21it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.36it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 56.02it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.00it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 56.65it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 58.34it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 55.64it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 57.81it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 59.09it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.24it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 58.02it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.33it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:15, 53.32it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:14, 56.34it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 55.12it/s]backtest loop:  15%|█▌        | 147/971 [00:02<00:14, 56.07it/s]backtest loop:  16%|█▌        | 154/971 [00:02<00:14, 58.19it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 56.17it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:13, 57.85it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:13, 59.22it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:14, 56.21it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 58.09it/s]backtest loop:  20%|█▉        | 194/971 [00:03<00:13, 58.59it/s]backtest loop:  21%|██        | 200/971 [00:03<00:13, 55.57it/s]backtest loop:  21%|██▏       | 207/971 [00:03<00:13, 57.82it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:13, 55.29it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 54.24it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:13, 56.60it/s]backtest loop:  24%|██▍       | 234/971 [00:04<00:12, 58.21it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:13, 55.42it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:12, 57.54it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:12, 56.62it/s]backtest loop:  27%|██▋       | 260/971 [00:05<00:19, 37.05it/s]backtest loop:  27%|██▋       | 266/971 [00:05<00:17, 39.86it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:15, 45.00it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:13, 49.36it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:13, 49.42it/s]backtest loop:  30%|███       | 292/971 [00:05<00:13, 52.02it/s]backtest loop:  31%|███       | 299/971 [00:05<00:12, 55.09it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:12, 53.26it/s]backtest loop:  32%|███▏      | 311/971 [00:05<00:12, 54.47it/s]backtest loop:  33%|███▎      | 317/971 [00:06<00:11, 55.95it/s]backtest loop:  33%|███▎      | 323/971 [00:06<00:11, 57.08it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:11, 55.39it/s]backtest loop:  35%|███▍      | 337/971 [00:06<00:11, 57.36it/s]backtest loop:  35%|███▌      | 344/971 [00:06<00:10, 58.75it/s]backtest loop:  36%|███▌      | 350/971 [00:06<00:11, 56.29it/s]backtest loop:  37%|███▋      | 357/971 [00:06<00:10, 58.17it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:10, 55.95it/s]backtest loop:  38%|███▊      | 369/971 [00:06<00:11, 53.97it/s]backtest loop:  39%|███▊      | 376/971 [00:07<00:10, 56.33it/s]backtest loop:  39%|███▉      | 382/971 [00:07<00:10, 57.31it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:10, 54.61it/s]backtest loop:  41%|████      | 395/971 [00:07<00:10, 56.81it/s]backtest loop:  41%|████▏     | 402/971 [00:07<00:09, 58.39it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:10, 55.43it/s]backtest loop:  43%|████▎     | 415/971 [00:07<00:09, 57.38it/s]backtest loop:  43%|████▎     | 422/971 [00:07<00:09, 58.76it/s]backtest loop:  44%|████▍     | 428/971 [00:08<00:09, 55.71it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:09, 57.61it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:09, 55.67it/s]backtest loop:  46%|████▌     | 449/971 [00:08<00:09, 57.45it/s]backtest loop:  47%|████▋     | 455/971 [00:08<00:08, 58.12it/s]backtest loop:  48%|████▊     | 462/971 [00:08<00:09, 56.02it/s]backtest loop:  48%|████▊     | 469/971 [00:08<00:08, 57.80it/s]backtest loop:  49%|████▉     | 476/971 [00:08<00:08, 59.31it/s]backtest loop:  50%|████▉     | 482/971 [00:08<00:08, 56.32it/s]backtest loop:  50%|█████     | 488/971 [00:09<00:08, 56.53it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:08, 54.86it/s]backtest loop:  52%|█████▏    | 501/971 [00:09<00:08, 56.18it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 54.18it/s]backtest loop:  53%|█████▎    | 513/971 [00:09<00:08, 55.68it/s]backtest loop:  54%|█████▎    | 520/971 [00:09<00:07, 57.95it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 55.34it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:07, 57.88it/s]backtest loop:  56%|█████▌    | 540/971 [00:09<00:07, 59.37it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 55.93it/s]backtest loop:  57%|█████▋    | 552/971 [00:10<00:07, 56.85it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 57.46it/s]backtest loop:  58%|█████▊    | 564/971 [00:10<00:06, 58.16it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 56.01it/s]backtest loop:  59%|█████▉    | 577/971 [00:10<00:06, 57.07it/s]backtest loop:  60%|██████    | 584/971 [00:10<00:06, 58.93it/s]backtest loop:  61%|██████    | 591/971 [00:10<00:06, 56.59it/s]backtest loop:  62%|██████▏   | 598/971 [00:10<00:06, 58.19it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:06, 56.14it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 57.85it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:05, 59.17it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 56.32it/s]backtest loop:  65%|██████▍   | 631/971 [00:11<00:05, 57.28it/s]backtest loop:  66%|██████▌   | 638/971 [00:11<00:05, 59.06it/s]backtest loop:  66%|██████▋   | 644/971 [00:11<00:05, 59.29it/s]backtest loop:  67%|██████▋   | 650/971 [00:11<00:05, 56.04it/s]backtest loop:  68%|██████▊   | 657/971 [00:12<00:05, 57.87it/s]backtest loop:  68%|██████▊   | 664/971 [00:12<00:05, 59.14it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 55.52it/s]backtest loop:  70%|██████▉   | 676/971 [00:12<00:05, 56.47it/s]backtest loop:  70%|███████   | 682/971 [00:12<00:05, 57.41it/s]backtest loop:  71%|███████   | 688/971 [00:12<00:04, 58.02it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:05, 55.03it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 57.19it/s]backtest loop:  73%|███████▎  | 707/971 [00:12<00:04, 57.90it/s]backtest loop:  74%|███████▎  | 714/971 [00:13<00:04, 55.84it/s]backtest loop:  74%|███████▍  | 721/971 [00:13<00:04, 57.76it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 59.29it/s]backtest loop:  76%|███████▌  | 734/971 [00:13<00:04, 53.09it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 55.65it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.55it/s]backtest loop:  78%|███████▊  | 754/971 [00:13<00:03, 55.88it/s]backtest loop:  78%|███████▊  | 760/971 [00:13<00:03, 53.85it/s]backtest loop:  79%|███████▉  | 767/971 [00:13<00:03, 56.25it/s]backtest loop:  80%|███████▉  | 773/971 [00:14<00:03, 57.17it/s]backtest loop:  80%|████████  | 780/971 [00:14<00:03, 55.45it/s]backtest loop:  81%|████████  | 787/971 [00:14<00:03, 57.94it/s]backtest loop:  82%|████████▏ | 793/971 [00:14<00:03, 55.28it/s]backtest loop:  82%|████████▏ | 800/971 [00:14<00:02, 57.29it/s]backtest loop:  83%|████████▎ | 807/971 [00:14<00:02, 58.71it/s]backtest loop:  84%|████████▎ | 813/971 [00:14<00:02, 55.67it/s]backtest loop:  84%|████████▍ | 820/971 [00:14<00:02, 57.53it/s]backtest loop:  85%|████████▌ | 827/971 [00:15<00:02, 59.00it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 55.93it/s]backtest loop:  86%|████████▋ | 839/971 [00:15<00:02, 56.98it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 57.53it/s]backtest loop:  88%|████████▊ | 851/971 [00:15<00:02, 58.21it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 55.21it/s]backtest loop:  89%|████████▉ | 863/971 [00:15<00:01, 56.55it/s]backtest loop:  90%|████████▉ | 870/971 [00:15<00:01, 58.24it/s]backtest loop:  90%|█████████ | 877/971 [00:15<00:01, 56.08it/s]backtest loop:  91%|█████████ | 884/971 [00:16<00:01, 57.88it/s]backtest loop:  92%|█████████▏| 891/971 [00:16<00:01, 59.14it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 56.05it/s]backtest loop:  93%|█████████▎| 903/971 [00:16<00:01, 56.93it/s]backtest loop:  94%|█████████▎| 910/971 [00:16<00:01, 58.47it/s]backtest loop:  94%|█████████▍| 916/971 [00:16<00:00, 55.54it/s]backtest loop:  95%|█████████▌| 923/971 [00:16<00:00, 57.45it/s]backtest loop:  96%|█████████▌| 930/971 [00:16<00:00, 58.99it/s]backtest loop:  96%|█████████▋| 936/971 [00:16<00:00, 55.94it/s]backtest loop:  97%|█████████▋| 942/971 [00:17<00:00, 57.03it/s]backtest loop:  98%|█████████▊| 949/971 [00:17<00:00, 58.78it/s]backtest loop:  98%|█████████▊| 955/971 [00:17<00:00, 55.75it/s]backtest loop:  99%|█████████▉| 962/971 [00:17<00:00, 57.61it/s]backtest loop: 100%|█████████▉| 968/971 [00:17<00:00, 58.23it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.37it/s]
[3029722:MainThread](2024-04-25 02:41:15,618) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000328
std                0.005204
annualized_return  0.078107
information_ratio  0.972861
max_drawdown      -0.089545
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000129
std                0.005204
annualized_return  0.030707
information_ratio  0.382473
max_drawdown      -0.121424
[3029722:MainThread](2024-04-25 02:41:15,630) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `gbdt_crowd_data_csi300_360_rankTrue`.
[3029722:MainThread](2024-04-25 02:41:21,652) INFO - qlib.timer - [log.py:127] - Time cost: 0.004s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277],
 '1day.excess_return_with_cost.information_ratio': [0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038],
 '1day.excess_return_with_cost.max_drawdown': [-0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872],
 'IC': [0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398],
 'ICIR': [0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265],
 'Rank IC': [0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156],
 'Rank ICIR': [0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578],
 'mae': [0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036],
 'mse': [0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641]}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3029722:MainThread](2024-04-25 02:41:26,004) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name gbdt_crowd_data_csi300_360_rankTrue_52.
[3029722:MainThread](2024-04-25 02:41:26,013) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[3029722:MainThread](2024-04-25 02:41:26,022) INFO - qlib.workflow - [recorder.py:341] - Recorder 7ed728b7c1be4515b2eef2490ba160e9 starts running under Experiment 14 ...
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.991012	valid's l2: 0.996567
[40]	train's l2: 0.987348	valid's l2: 0.99668
[60]	train's l2: 0.985148	valid's l2: 0.996856
Early stopping, best iteration is:
[24]	train's l2: 0.990146	valid's l2: 0.996529
[3029722:MainThread](2024-04-25 02:41:52,692) INFO - qlib.timer - [log.py:127] - Time cost: 0.135s | waiting `async_log` Done
Save pretrained model to gbdt_crowd_data_csi300_360_rankTrue_52.
[3029722:MainThread](2024-04-25 02:41:52,849) INFO - qlib.workflow - [exp.py:258] - Experiment 5 starts running ...
[3029722:MainThread](2024-04-25 02:41:52,859) INFO - qlib.workflow - [recorder.py:341] - Recorder b49cdca399d14cca871e680b003c903c starts running under Experiment 5 ...
{'IC': 0.017539680988361398,
 'ICIR': 0.12497015039951265,
 'Rank IC': 0.028101527086621156,
 'Rank ICIR': 0.20354051119561578}
[3029722:MainThread](2024-04-25 02:41:58,965) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3029722:MainThread](2024-04-25 02:42:33,021) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:42:33,025) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3029722:MainThread](2024-04-25 02:42:39,042) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fdac6968130>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:45,  9.14it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.48it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 36.90it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 39.33it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.01it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.43it/s]backtest loop:   4%|▍         | 41/971 [00:01<00:17, 51.94it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 54.98it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.15it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 55.81it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 53.40it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 56.13it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 57.89it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 55.31it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 57.59it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 58.93it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.11it/s]backtest loop:  12%|█▏        | 113/971 [00:02<00:15, 56.78it/s]backtest loop:  12%|█▏        | 120/971 [00:02<00:14, 58.43it/s]backtest loop:  13%|█▎        | 126/971 [00:02<00:24, 34.40it/s]backtest loop:  14%|█▎        | 133/971 [00:02<00:20, 40.22it/s]backtest loop:  14%|█▍        | 140/971 [00:02<00:18, 45.40it/s]backtest loop:  15%|█▌        | 146/971 [00:03<00:17, 45.98it/s]backtest loop:  16%|█▌        | 152/971 [00:03<00:16, 49.24it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 52.79it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:14, 54.47it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 52.73it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:14, 54.63it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 56.01it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:14, 54.28it/s]backtest loop:  20%|██        | 196/971 [00:03<00:13, 55.68it/s]backtest loop:  21%|██        | 203/971 [00:04<00:13, 57.70it/s]backtest loop:  22%|██▏       | 210/971 [00:04<00:13, 56.17it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 54.06it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:13, 56.64it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:12, 57.46it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:13, 54.73it/s]backtest loop:  25%|██▍       | 241/971 [00:04<00:13, 56.10it/s]backtest loop:  26%|██▌       | 248/971 [00:04<00:12, 58.24it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:12, 56.15it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:12, 58.41it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:12, 55.59it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 56.79it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:11, 58.51it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 55.56it/s]backtest loop:  30%|███       | 292/971 [00:05<00:11, 56.69it/s]backtest loop:  31%|███       | 299/971 [00:05<00:11, 58.56it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:11, 55.51it/s]backtest loop:  32%|███▏      | 311/971 [00:05<00:11, 56.71it/s]backtest loop:  33%|███▎      | 317/971 [00:06<00:11, 57.61it/s]backtest loop:  33%|███▎      | 324/971 [00:06<00:10, 59.03it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:11, 55.89it/s]backtest loop:  35%|███▍      | 337/971 [00:06<00:10, 57.76it/s]backtest loop:  35%|███▌      | 343/971 [00:06<00:10, 58.37it/s]backtest loop:  36%|███▌      | 350/971 [00:06<00:10, 56.62it/s]backtest loop:  37%|███▋      | 357/971 [00:06<00:10, 58.32it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:10, 56.07it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:11, 54.00it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:10, 55.26it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:10, 56.56it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 57.47it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 54.59it/s]backtest loop:  41%|████      | 399/971 [00:07<00:10, 56.06it/s]backtest loop:  42%|████▏     | 406/971 [00:07<00:09, 57.89it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:09, 58.45it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:09, 55.39it/s]backtest loop:  44%|████▍     | 425/971 [00:07<00:09, 57.41it/s]backtest loop:  44%|████▍     | 432/971 [00:08<00:09, 55.49it/s]backtest loop:  45%|████▌     | 439/971 [00:08<00:09, 57.37it/s]backtest loop:  46%|████▌     | 445/971 [00:08<00:09, 58.03it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:08, 58.47it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:09, 55.38it/s]backtest loop:  48%|████▊     | 463/971 [00:08<00:09, 56.23it/s]backtest loop:  48%|████▊     | 469/971 [00:08<00:08, 57.23it/s]backtest loop:  49%|████▉     | 476/971 [00:08<00:08, 58.94it/s]backtest loop:  50%|████▉     | 482/971 [00:08<00:08, 55.87it/s]backtest loop:  50%|█████     | 488/971 [00:09<00:08, 56.99it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:08, 55.11it/s]backtest loop:  52%|█████▏    | 501/971 [00:09<00:08, 56.40it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 54.24it/s]backtest loop:  53%|█████▎    | 513/971 [00:09<00:08, 55.72it/s]backtest loop:  54%|█████▎    | 520/971 [00:09<00:07, 57.99it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 55.25it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:07, 57.82it/s]backtest loop:  56%|█████▌    | 540/971 [00:10<00:07, 59.23it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 55.99it/s]backtest loop:  57%|█████▋    | 552/971 [00:10<00:07, 57.06it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 57.44it/s]backtest loop:  58%|█████▊    | 565/971 [00:10<00:06, 58.87it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 55.81it/s]backtest loop:  59%|█████▉    | 577/971 [00:10<00:06, 56.87it/s]backtest loop:  60%|██████    | 584/971 [00:10<00:06, 58.77it/s]backtest loop:  61%|██████    | 591/971 [00:10<00:06, 56.45it/s]backtest loop:  62%|██████▏   | 598/971 [00:11<00:06, 58.05it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:06, 55.99it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 57.71it/s]backtest loop:  64%|██████▎   | 618/971 [00:11<00:06, 58.32it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 56.37it/s]backtest loop:  65%|██████▍   | 631/971 [00:11<00:05, 57.24it/s]backtest loop:  66%|██████▌   | 638/971 [00:11<00:05, 58.94it/s]backtest loop:  66%|██████▋   | 644/971 [00:11<00:05, 59.19it/s]backtest loop:  67%|██████▋   | 650/971 [00:11<00:05, 55.37it/s]backtest loop:  68%|██████▊   | 656/971 [00:12<00:05, 56.53it/s]backtest loop:  68%|██████▊   | 662/971 [00:12<00:05, 57.44it/s]backtest loop:  69%|██████▉   | 668/971 [00:12<00:05, 58.04it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:05, 54.93it/s]backtest loop:  70%|███████   | 680/971 [00:12<00:05, 56.27it/s]backtest loop:  71%|███████   | 686/971 [00:12<00:04, 57.13it/s]backtest loop:  71%|███████▏  | 692/971 [00:12<00:04, 57.86it/s]backtest loop:  72%|███████▏  | 698/971 [00:12<00:04, 58.36it/s]backtest loop:  73%|███████▎  | 704/971 [00:12<00:04, 55.22it/s]backtest loop:  73%|███████▎  | 710/971 [00:12<00:04, 56.39it/s]backtest loop:  74%|███████▎  | 716/971 [00:13<00:04, 57.41it/s]backtest loop:  74%|███████▍  | 723/971 [00:13<00:04, 58.94it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 55.90it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 53.66it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 55.24it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.15it/s]backtest loop:  78%|███████▊  | 754/971 [00:13<00:03, 55.62it/s]backtest loop:  78%|███████▊  | 760/971 [00:13<00:03, 53.60it/s]backtest loop:  79%|███████▉  | 766/971 [00:14<00:03, 55.31it/s]backtest loop:  80%|███████▉  | 772/971 [00:14<00:03, 56.47it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 58.26it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 55.90it/s]backtest loop:  82%|████████▏ | 792/971 [00:14<00:03, 57.84it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 55.02it/s]backtest loop:  83%|████████▎ | 804/971 [00:14<00:02, 56.36it/s]backtest loop:  83%|████████▎ | 810/971 [00:14<00:02, 57.29it/s]backtest loop:  84%|████████▍ | 816/971 [00:14<00:02, 58.02it/s]backtest loop:  85%|████████▍ | 822/971 [00:14<00:02, 58.52it/s]backtest loop:  85%|████████▌ | 828/971 [00:15<00:02, 55.24it/s]backtest loop:  86%|████████▌ | 834/971 [00:15<00:02, 56.44it/s]backtest loop:  87%|████████▋ | 840/971 [00:15<00:02, 57.34it/s]backtest loop:  87%|████████▋ | 846/971 [00:15<00:02, 58.06it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 55.06it/s]backtest loop:  88%|████████▊ | 858/971 [00:15<00:02, 56.14it/s]backtest loop:  89%|████████▉ | 864/971 [00:15<00:01, 57.13it/s]backtest loop:  90%|████████▉ | 870/971 [00:15<00:01, 57.65it/s]backtest loop:  90%|█████████ | 876/971 [00:15<00:01, 58.33it/s]backtest loop:  91%|█████████ | 882/971 [00:16<00:01, 55.15it/s]backtest loop:  91%|█████████▏| 888/971 [00:16<00:01, 56.51it/s]backtest loop:  92%|█████████▏| 894/971 [00:16<00:01, 57.48it/s]backtest loop:  93%|█████████▎| 900/971 [00:16<00:01, 58.14it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 58.68it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 55.47it/s]backtest loop:  95%|█████████▍| 918/971 [00:16<00:00, 56.71it/s]backtest loop:  95%|█████████▌| 924/971 [00:16<00:00, 57.52it/s]backtest loop:  96%|█████████▌| 931/971 [00:16<00:00, 55.67it/s]backtest loop:  96%|█████████▋| 937/971 [00:17<00:00, 56.81it/s]backtest loop:  97%|█████████▋| 943/971 [00:17<00:00, 57.67it/s]backtest loop:  98%|█████████▊| 950/971 [00:17<00:00, 55.79it/s]backtest loop:  99%|█████████▊| 957/971 [00:17<00:00, 57.56it/s]backtest loop:  99%|█████████▉| 964/971 [00:17<00:00, 58.87it/s]backtest loop: 100%|█████████▉| 970/971 [00:17<00:00, 55.69it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.15it/s]
[3029722:MainThread](2024-04-25 02:42:56,706) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000328
std                0.005204
annualized_return  0.078107
information_ratio  0.972861
max_drawdown      -0.089545
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000129
std                0.005204
annualized_return  0.030707
information_ratio  0.382473
max_drawdown      -0.121424
[3029722:MainThread](2024-04-25 02:42:56,719) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 5
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LGBModel', 'module_path': 'qlib.contrib.model.gbdt', 'kwargs': {'loss': 'mse', 'colsample_bytree': 0.8879, 'learning_rate': 0.0421, 'subsample': 0.8789, 'lambda_l1': 205.6999, 'lambda_l2': 580.9768, 'max_depth': 8, 'num_leaves': 210, 'num_threads': 20}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_lightgbm_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `gbdt_crowd_data_csi300_360_rankTrue`.
[3029722:MainThread](2024-04-25 02:43:02,788) INFO - qlib.timer - [log.py:127] - Time cost: 0.004s | waiting `async_log` Done
{'1day.excess_return_with_cost.annualized_return': [0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277,
                                                    0.030706717085016277],
 '1day.excess_return_with_cost.information_ratio': [0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038,
                                                    0.3824733296056038],
 '1day.excess_return_with_cost.max_drawdown': [-0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872,
                                               -0.12142421237903872],
 'IC': [0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398,
        0.017539680988361398],
 'ICIR': [0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265,
          0.12497015039951265],
 'Rank IC': [0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156,
             0.028101527086621156],
 'Rank ICIR': [0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578,
               0.20354051119561578],
 'mae': [0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036,
         0.8644107165169036],
 'mse': [0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641,
         0.996899333238641]}
[3029722:MainThread](2024-04-25 02:43:02,929) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name final_crowd_data_csi300_360_1_gbdt.
[3029722:MainThread](2024-04-25 02:43:02,938) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3029722:MainThread](2024-04-25 02:43:02,948) INFO - qlib.workflow - [recorder.py:341] - Recorder 9e1e464853174cfca21858f400df7209 starts running under Experiment 15 ...
Time cost: 99.85856444835663
{'1day.excess_return_with_cost.annualized_return': [0.030706717085016277, 0.0],
 '1day.excess_return_with_cost.information_ratio': [0.3824733296056038, 0.0],
 '1day.excess_return_with_cost.max_drawdown': [-0.12142421237903873,
                                               1.3877787807814457e-17],
 'IC': [0.017539680988361398, 0.0],
 'ICIR': [0.12497015039951265, 0.0],
 'Rank IC': [0.02810152708662116, 3.469446951953614e-18],
 'Rank ICIR': [0.2035405111956158, 2.7755575615628914e-17],
 'mae': [0.8644107165169036, 0.0],
 'mse': [0.9968993332386409, 1.1102230246251565e-16]}
[3029722:MainThread](2024-04-25 02:43:03,452) INFO - qlib.timer - [log.py:127] - Time cost: 0.020s | waiting `async_log` Done

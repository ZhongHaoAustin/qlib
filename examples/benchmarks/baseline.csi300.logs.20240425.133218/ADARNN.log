[3265079:MainThread](2024-04-25 13:32:20,805) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[3265079:MainThread](2024-04-25 13:32:20,808) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[3265079:MainThread](2024-04-25 13:32:20,808) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/crowd_data')}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSRankNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ADARNN', 'module_path': 'qlib.contrib.model.pytorch_adarnn', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.01, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankTrue_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}

[3265079:MainThread](2024-04-25 13:32:24,130) INFO - qlib.ADARNN - [pytorch_adarnn.py:63] - ADARNN pytorch version...
[3265079:MainThread](2024-04-25 13:32:24,487) INFO - qlib.ADARNN - [pytorch_adarnn.py:87] - ADARNN parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.01
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3265079:MainThread](2024-04-25 13:32:24,544) INFO - qlib.ADARNN - [pytorch_adarnn.py:136] - model:
AdaRNN(
  (features): Sequential(
    (0): GRU(6, 64, batch_first=True)
    (1): GRU(64, 64, batch_first=True)
  )
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
  (gate): ModuleList(
    (0): Linear(in_features=7680, out_features=60, bias=True)
    (1): Linear(in_features=7680, out_features=60, bias=True)
  )
  (bn_lst): ModuleList(
    (0): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): BatchNorm1d(60, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (softmax): Softmax(dim=0)
)
[3265079:MainThread](2024-04-25 13:32:24,545) INFO - qlib.ADARNN - [pytorch_adarnn.py:137] - model size: 0.9163 MB
[3265079:MainThread](2024-04-25 13:32:32,520) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name ADARNN_crowd_data_csi300_360_rankTrue_43.
[3265079:MainThread](2024-04-25 13:32:32,627) INFO - qlib.workflow - [exp.py:258] - Experiment 100 starts running ...
[3265079:MainThread](2024-04-25 13:32:34,520) INFO - qlib.workflow - [recorder.py:341] - Recorder efce4c6645de4d1dbbb61b02d54e30ce starts running under Experiment 100 ...
[3265079:MainThread](2024-04-25 13:32:38,682) INFO - qlib.ADARNN - [pytorch_adarnn.py:266] - training...
[3265079:MainThread](2024-04-25 13:32:38,683) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch0:
[3265079:MainThread](2024-04-25 13:32:38,684) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:33:41,081) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:33:48,510) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.096863, icir/train: : 0.638262, ric/train: : 0.092947, ricir/train: : 0.619121, mse/train: : 0.017264, loss/train: : 0.017264
[3265079:MainThread](2024-04-25 13:33:48,510) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.041497, icir/valid: : 0.283948, ric/valid: : 0.040074, ricir/valid: : 0.276896, mse/valid: : 0.020692, loss/valid: : 0.020692
[3265079:MainThread](2024-04-25 13:33:48,513) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch1:
[3265079:MainThread](2024-04-25 13:33:48,513) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:34:49,878) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:34:57,054) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.038754, icir/train: : 0.277625, ric/train: : 0.037404, ricir/train: : 0.275080, mse/train: : 0.098041, loss/train: : 0.098041
[3265079:MainThread](2024-04-25 13:34:57,055) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.018462, icir/valid: : 0.135347, ric/valid: : 0.022411, ricir/valid: : 0.172342, mse/valid: : 0.089362, loss/valid: : 0.089362
[3265079:MainThread](2024-04-25 13:34:57,057) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch2:
[3265079:MainThread](2024-04-25 13:34:57,057) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:35:57,566) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:36:04,999) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.063971, icir/train: : 0.469978, ric/train: : 0.062354, ricir/train: : 0.461723, mse/train: : -0.001696, loss/train: : -0.001696
[3265079:MainThread](2024-04-25 13:36:05,000) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.018499, icir/valid: : 0.143125, ric/valid: : 0.018931, ricir/valid: : 0.150165, mse/valid: : -0.000520, loss/valid: : -0.000520
[3265079:MainThread](2024-04-25 13:36:05,000) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch3:
[3265079:MainThread](2024-04-25 13:36:05,000) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:37:11,678) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:37:19,118) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.067992, icir/train: : 0.448705, ric/train: : 0.064692, ricir/train: : 0.432459, mse/train: : -0.029123, loss/train: : -0.029123
[3265079:MainThread](2024-04-25 13:37:19,118) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.026620, icir/valid: : 0.189592, ric/valid: : 0.024549, ricir/valid: : 0.177956, mse/valid: : -0.032109, loss/valid: : -0.032109
[3265079:MainThread](2024-04-25 13:37:19,119) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch4:
[3265079:MainThread](2024-04-25 13:37:19,119) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:38:21,381) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:38:28,513) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.067917, icir/train: : 0.422014, ric/train: : 0.068095, ricir/train: : 0.433264, mse/train: : -0.004610, loss/train: : -0.004610
[3265079:MainThread](2024-04-25 13:38:28,513) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.024518, icir/valid: : 0.164416, ric/valid: : 0.025782, ricir/valid: : 0.178726, mse/valid: : -0.008700, loss/valid: : -0.008700
[3265079:MainThread](2024-04-25 13:38:28,514) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch5:
[3265079:MainThread](2024-04-25 13:38:28,514) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:39:38,271) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:39:45,592) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.070966, icir/train: : 0.485190, ric/train: : 0.068669, ricir/train: : 0.477981, mse/train: : -0.001859, loss/train: : -0.001859
[3265079:MainThread](2024-04-25 13:39:45,593) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.030703, icir/valid: : 0.227063, ric/valid: : 0.029695, ricir/valid: : 0.223040, mse/valid: : -0.000787, loss/valid: : -0.000787
[3265079:MainThread](2024-04-25 13:39:45,593) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch6:
[3265079:MainThread](2024-04-25 13:39:45,593) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...
[3265079:MainThread](2024-04-25 13:40:45,346) INFO - qlib.ADARNN - [pytorch_adarnn.py:276] - evaluating...
[3265079:MainThread](2024-04-25 13:40:52,405) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/train: : 0.072543, icir/train: : 0.529633, ric/train: : 0.070905, ricir/train: : 0.523257, mse/train: : 0.009283, loss/train: : 0.009283
[3265079:MainThread](2024-04-25 13:40:52,406) INFO - qlib.ADARNN - [pytorch_adarnn.py:241] - ic/valid: : 0.031818, icir/valid: : 0.255875, ric/valid: : 0.031078, ricir/valid: : 0.252528, mse/valid: : 0.012632, loss/valid: : 0.012632
[3265079:MainThread](2024-04-25 13:40:52,406) INFO - qlib.ADARNN - [pytorch_adarnn.py:273] - Epoch7:
[3265079:MainThread](2024-04-25 13:40:52,406) INFO - qlib.ADARNN - [pytorch_adarnn.py:274] - training...

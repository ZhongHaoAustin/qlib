2024-04-22 22:32:26.081 | WARNING  | qlib.tests.data:qlib_data:175 - Data already exists: ~/.qlib/qlib_data/cn_data, the data download will be skipped
	If downloading is required: `exists_skip=False` or `change target_dir`
[2211374:MainThread](2024-04-22 22:32:26,082) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[2211374:MainThread](2024-04-22 22:32:26,084) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[2211374:MainThread](2024-04-22 22:32:26,085) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/cn_data')}
Remove CSRankNorm
{'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': datetime.date(2008, 1, 1), 'end_time': datetime.date(2020, 8, 1), 'fit_start_time': datetime.date(2008, 1, 1), 'fit_end_time': datetime.date(2014, 12, 31), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
[2211374:MainThread](2024-04-22 22:37:20,180) INFO - qlib.timer - [log.py:127] - Time cost: 293.958s | Loading data Done
/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/numpy/lib/nanfunctions.py:1095: RuntimeWarning: All-NaN slice encountered
  result = np.apply_along_axis(_nanmedian1d, axis, a, overwrite_input)
[2211374:MainThread](2024-04-22 22:39:20,084) INFO - qlib.timer - [log.py:127] - Time cost: 118.168s | RobustZScoreNorm Done
[2211374:MainThread](2024-04-22 22:39:22,501) INFO - qlib.timer - [log.py:127] - Time cost: 2.416s | Fillna Done
[2211374:MainThread](2024-04-22 22:39:23,744) INFO - qlib.timer - [log.py:127] - Time cost: 0.657s | DropnaLabel Done
[2211374:MainThread](2024-04-22 22:39:29,350) INFO - qlib.timer - [log.py:127] - Time cost: 5.606s | CSZScoreNorm Done
[2211374:MainThread](2024-04-22 22:39:29,354) INFO - qlib.timer - [log.py:127] - Time cost: 129.173s | fit & process data Done
[2211374:MainThread](2024-04-22 22:39:29,354) INFO - qlib.timer - [log.py:127] - Time cost: 423.133s | Init data Done
Save handler file to /home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/baseline/cn_data_csi300_rankFalse_alpha360_handler_horizon1.pkl
[2211374:MainThread](2024-04-22 22:39:34,634) INFO - qlib.RollingBenchmark - [rolling_benchmark.py:208] - {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 5000, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/baseline/cn_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': [datetime.date(2008, 1, 1), datetime.date(2014, 12, 31)], 'valid': [datetime.date(2015, 1, 1), datetime.date(2016, 12, 31)], 'test': [datetime.date(2017, 1, 1), datetime.date(2020, 8, 1)]}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
[2211374:MainThread](2024-04-22 22:39:34,644) WARNING - qlib.data - [data.py:666] - load calendar error: freq=day, future=True; return current calendar!
[2211374:MainThread](2024-04-22 22:39:34,644) WARNING - qlib.data - [data.py:669] - You can get future calendar by referring to the following document: https://github.com/microsoft/qlib/blob/main/scripts/data_collector/contrib/README.md
[2211374:MainThread](2024-04-22 22:39:34,671) INFO - qlib.MetaDatasetDS - [dataset.py:316] - Example task for training meta model: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 5000, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/baseline/cn_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-02 00:00:00'), Timestamp('2014-12-31 00:00:00')), 'valid': (Timestamp('2015-01-05 00:00:00'), Timestamp('2016-12-29 00:00:00')), 'test': (Timestamp('2017-01-03 00:00:00'), Timestamp('2017-02-06 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/44 [00:00<?, ?it/s]creating meta tasks:   2%|▏         | 1/44 [00:00<00:20,  2.14it/s]creating meta tasks:   5%|▍         | 2/44 [00:00<00:18,  2.28it/s]creating meta tasks:   7%|▋         | 3/44 [00:01<00:17,  2.34it/s]creating meta tasks:   9%|▉         | 4/44 [00:01<00:16,  2.35it/s]creating meta tasks:  11%|█▏        | 5/44 [00:02<00:16,  2.37it/s]creating meta tasks:  14%|█▎        | 6/44 [00:02<00:16,  2.37it/s]creating meta tasks:  16%|█▌        | 7/44 [00:02<00:15,  2.37it/s]creating meta tasks:  18%|█▊        | 8/44 [00:03<00:15,  2.37it/s]creating meta tasks:  20%|██        | 9/44 [00:03<00:14,  2.36it/s]creating meta tasks:  23%|██▎       | 10/44 [00:04<00:14,  2.36it/s]creating meta tasks:  25%|██▌       | 11/44 [00:04<00:14,  2.35it/s]creating meta tasks:  27%|██▋       | 12/44 [00:05<00:13,  2.35it/s]creating meta tasks:  30%|██▉       | 13/44 [00:05<00:13,  2.34it/s]creating meta tasks:  32%|███▏      | 14/44 [00:05<00:12,  2.33it/s]creating meta tasks:  34%|███▍      | 15/44 [00:06<00:12,  2.32it/s]creating meta tasks:  36%|███▋      | 16/44 [00:06<00:12,  2.32it/s]creating meta tasks:  39%|███▊      | 17/44 [00:07<00:11,  2.31it/s]creating meta tasks:  41%|████      | 18/44 [00:07<00:11,  2.30it/s]creating meta tasks:  43%|████▎     | 19/44 [00:08<00:10,  2.35it/s]creating meta tasks:  45%|████▌     | 20/44 [00:08<00:10,  2.32it/s]creating meta tasks:  48%|████▊     | 21/44 [00:09<00:09,  2.31it/s]creating meta tasks:  50%|█████     | 22/44 [00:09<00:09,  2.38it/s]creating meta tasks:  52%|█████▏    | 23/44 [00:09<00:08,  2.43it/s]creating meta tasks:  55%|█████▍    | 24/44 [00:10<00:08,  2.46it/s]creating meta tasks:  57%|█████▋    | 25/44 [00:10<00:07,  2.48it/s]creating meta tasks:  59%|█████▉    | 26/44 [00:10<00:07,  2.49it/s]creating meta tasks:  61%|██████▏   | 27/44 [00:11<00:06,  2.49it/s]creating meta tasks:  64%|██████▎   | 28/44 [00:11<00:06,  2.48it/s]creating meta tasks:  66%|██████▌   | 29/44 [00:12<00:06,  2.48it/s]creating meta tasks:  68%|██████▊   | 30/44 [00:12<00:05,  2.47it/s]creating meta tasks:  70%|███████   | 31/44 [00:12<00:05,  2.47it/s]creating meta tasks:  73%|███████▎  | 32/44 [00:13<00:04,  2.45it/s]creating meta tasks:  75%|███████▌  | 33/44 [00:13<00:04,  2.42it/s]creating meta tasks:  77%|███████▋  | 34/44 [00:14<00:04,  2.31it/s]creating meta tasks:  80%|███████▉  | 35/44 [00:14<00:04,  2.23it/s]creating meta tasks:  82%|████████▏ | 36/44 [00:15<00:03,  2.18it/s]creating meta tasks:  84%|████████▍ | 37/44 [00:15<00:03,  2.21it/s]creating meta tasks:  86%|████████▋ | 38/44 [00:16<00:02,  2.24it/s]creating meta tasks:  89%|████████▊ | 39/44 [00:16<00:02,  2.24it/s]creating meta tasks:  91%|█████████ | 40/44 [00:17<00:01,  2.25it/s]creating meta tasks:  93%|█████████▎| 41/44 [00:17<00:01,  2.25it/s]creating meta tasks:  95%|█████████▌| 42/44 [00:17<00:00,  2.26it/s]creating meta tasks:  98%|█████████▊| 43/44 [00:18<00:00,  2.25it/s]creating meta tasks: 100%|██████████| 44/44 [00:18<00:00,  2.24it/s]creating meta tasks: 100%|██████████| 44/44 [00:18<00:00,  2.34it/s]
train tasks:   0%|          | 0/44 [00:00<?, ?it/s][2211374:MainThread](2024-04-22 22:39:53,854) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name rolling_cn_data_csi300_GRU_alpha360_h1_step20_rankFalse_2024-04-22_22:39:53_DDG-DA.
[2211374:MainThread](2024-04-22 22:39:53,863) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 22:39:55,005) INFO - qlib.workflow - [recorder.py:341] - Recorder 72e712dd1b5f4db69e58b13113701f88 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 22:39:57,787) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 22:39:57,868) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 22:39:57,869) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 22:39:57,870) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 22:40:12,943) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.531170
            SH600004      0.531170
            SH600006      0.531170
            SH600007      0.531170
            SH600008      0.531170
                            ...   
2014-12-31  SZ300070      1.926194
            SZ300124      1.926194
            SZ300133      1.926194
            SZ300146      1.926194
            SZ300251      1.926194
Length: 478007, dtype: float64
[2211374:MainThread](2024-04-22 22:40:12,998) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 22:40:12,999) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 22:40:12,999) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:40:16,511) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:40:16,733) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994998
[2211374:MainThread](2024-04-22 22:40:16,756) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 22:40:16,756) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:40:19,066) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:40:19,287) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995443
[2211374:MainThread](2024-04-22 22:40:19,287) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 22:40:19,288) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:40:21,580) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:40:21,802) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995178
[2211374:MainThread](2024-04-22 22:40:21,803) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 22:40:21,803) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:40:24,098) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:40:24,319) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994440
[2211374:MainThread](2024-04-22 22:40:24,320) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 22:40:24,320) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:40:26,623) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:40:26,844) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994105
[2211374:MainThread](2024-04-22 22:40:26,846) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 22:40:26,846) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:40:29,108) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:40:29,329) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994704
[2211374:MainThread](2024-04-22 22:40:29,330) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 22:40:29,330) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:40:31,581) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:40:31,804) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994970
[2211374:MainThread](2024-04-22 22:40:31,805) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 22:40:31,805) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:40:34,086) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:40:34,305) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994371
[2211374:MainThread](2024-04-22 22:40:34,306) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 22:40:34,306) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:40:36,572) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:40:36,791) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994429
[2211374:MainThread](2024-04-22 22:40:36,792) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 22:40:36,792) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:40:39,067) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:40:39,286) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994727
[2211374:MainThread](2024-04-22 22:40:39,287) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 22:40:39,287) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:40:41,532) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:40:41,751) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993531
[2211374:MainThread](2024-04-22 22:40:41,752) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 22:40:41,753) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:40:43,974) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:40:44,193) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993688
[2211374:MainThread](2024-04-22 22:40:44,193) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 22:40:44,193) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:40:46,424) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:40:46,643) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992598
[2211374:MainThread](2024-04-22 22:40:46,645) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 22:40:46,645) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:40:48,866) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:40:49,088) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992424
[2211374:MainThread](2024-04-22 22:40:49,089) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 22:40:49,089) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:40:51,312) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:40:51,532) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993024
[2211374:MainThread](2024-04-22 22:40:51,532) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 22:40:51,533) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:40:53,729) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:40:53,949) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992794
[2211374:MainThread](2024-04-22 22:40:53,949) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 22:40:53,949) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:40:56,116) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:40:56,336) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993390
[2211374:MainThread](2024-04-22 22:40:56,336) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 22:40:56,336) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:40:58,502) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:40:58,722) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993696
[2211374:MainThread](2024-04-22 22:40:58,722) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 22:40:58,723) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:41:00,986) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:41:01,206) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994944
[2211374:MainThread](2024-04-22 22:41:01,206) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 22:41:01,206) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:41:03,493) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:41:03,713) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994263
[2211374:MainThread](2024-04-22 22:41:03,713) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 22:41:03,714) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:41:05,902) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:41:06,125) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994016
[2211374:MainThread](2024-04-22 22:41:06,125) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 22:41:06,126) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:41:08,398) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:41:08,618) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994510
[2211374:MainThread](2024-04-22 22:41:08,618) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 22:41:08,618) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992424 @ 13
[2211374:MainThread](2024-04-22 22:41:08,675) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-01-03 SH600000   -0.012509
           SH600008    0.027391
           SH600009    0.064820
           SH600010   -0.018964
           SH600015   -0.021880
[2211374:MainThread](2024-04-22 22:41:10,335) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   2%|▏         | 1/44 [01:16<54:49, 76.49s/it][2211374:MainThread](2024-04-22 22:41:10,343) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 22:41:10,352) INFO - qlib.workflow - [recorder.py:341] - Recorder 4ad034c69e2342b0b3e09948d6ed44db starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 22:41:10,835) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 22:41:10,836) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 22:41:10,838) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 22:41:10,839) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 22:41:18,502) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.540694
            SH600004      0.540694
            SH600006      0.540694
            SH600007      0.540694
            SH600008      0.540694
                            ...   
2015-01-30  SZ300070      1.993659
            SZ300124      1.993659
            SZ300133      1.993659
            SZ300146      1.993659
            SZ300251      1.993659
Length: 483831, dtype: float64
[2211374:MainThread](2024-04-22 22:41:18,515) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 22:41:18,515) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 22:41:18,515) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:41:20,810) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:41:21,034) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995726
[2211374:MainThread](2024-04-22 22:41:21,035) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 22:41:21,036) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:41:23,332) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:41:23,555) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995339
[2211374:MainThread](2024-04-22 22:41:23,556) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 22:41:23,556) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:41:25,833) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:41:26,056) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994508
[2211374:MainThread](2024-04-22 22:41:26,057) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 22:41:26,058) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:41:28,348) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:41:28,571) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994028
[2211374:MainThread](2024-04-22 22:41:28,572) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 22:41:28,572) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:41:30,832) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:41:31,057) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993810
[2211374:MainThread](2024-04-22 22:41:31,058) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 22:41:31,059) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:41:33,340) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:41:33,565) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993826
[2211374:MainThread](2024-04-22 22:41:33,565) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 22:41:33,566) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:41:35,858) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:41:36,083) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993504
[2211374:MainThread](2024-04-22 22:41:36,084) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 22:41:36,084) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:41:38,357) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:41:38,582) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994050
[2211374:MainThread](2024-04-22 22:41:38,583) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 22:41:38,583) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:41:40,870) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:41:41,096) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994176
[2211374:MainThread](2024-04-22 22:41:41,096) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 22:41:41,096) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:41:43,369) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:41:43,594) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994696
[2211374:MainThread](2024-04-22 22:41:43,595) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 22:41:43,595) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:41:45,868) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:41:46,093) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994613
[2211374:MainThread](2024-04-22 22:41:46,093) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 22:41:46,094) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:41:48,367) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:41:48,591) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993845
[2211374:MainThread](2024-04-22 22:41:48,591) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 22:41:48,591) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:41:50,819) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:41:51,045) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994411
[2211374:MainThread](2024-04-22 22:41:51,045) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 22:41:51,045) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:41:53,273) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:41:53,498) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994798
[2211374:MainThread](2024-04-22 22:41:53,499) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 22:41:53,499) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:41:55,748) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:41:55,972) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994551
[2211374:MainThread](2024-04-22 22:41:55,973) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 22:41:55,973) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993504 @ 6
[2211374:MainThread](2024-04-22 22:41:56,021) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-02-07 SH600000    0.028859
           SH600008    0.040567
           SH600009    0.016868
           SH600010   -0.057020
           SH600015    0.026855
[2211374:MainThread](2024-04-22 22:41:57,675) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   5%|▍         | 2/44 [02:03<41:32, 59.34s/it][2211374:MainThread](2024-04-22 22:41:57,682) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 22:41:57,691) INFO - qlib.workflow - [recorder.py:341] - Recorder 5b24e52b44c748689cb8f065eb6133d4 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 22:41:58,159) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 22:41:58,160) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 22:41:58,161) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 22:41:58,162) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 22:42:05,763) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.632693
            SH600004      0.632693
            SH600006      0.632693
            SH600007      0.632693
            SH600008      0.632693
                            ...   
2015-03-06  SZ300070      1.926944
            SZ300124      1.926944
            SZ300133      1.926944
            SZ300146      1.926944
            SZ300251      1.926944
Length: 489365, dtype: float64
[2211374:MainThread](2024-04-22 22:42:05,765) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 22:42:05,766) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 22:42:05,766) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:42:08,041) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:42:08,263) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995621
[2211374:MainThread](2024-04-22 22:42:08,264) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 22:42:08,265) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:42:10,538) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:42:10,760) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994986
[2211374:MainThread](2024-04-22 22:42:10,761) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 22:42:10,762) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:42:13,020) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:42:13,243) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995564
[2211374:MainThread](2024-04-22 22:42:13,243) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 22:42:13,243) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:42:15,511) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:42:15,734) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994571
[2211374:MainThread](2024-04-22 22:42:15,735) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 22:42:15,736) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:42:18,014) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:42:18,242) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994675
[2211374:MainThread](2024-04-22 22:42:18,242) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 22:42:18,243) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:42:20,579) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:42:20,806) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994451
[2211374:MainThread](2024-04-22 22:42:20,807) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 22:42:20,808) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:42:23,156) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:42:23,383) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996021
[2211374:MainThread](2024-04-22 22:42:23,384) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 22:42:23,384) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:42:25,720) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:42:25,947) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993823
[2211374:MainThread](2024-04-22 22:42:25,948) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 22:42:25,949) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:42:28,287) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:42:28,514) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994629
[2211374:MainThread](2024-04-22 22:42:28,515) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 22:42:28,515) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:42:30,865) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:42:31,092) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993435
[2211374:MainThread](2024-04-22 22:42:31,093) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 22:42:31,094) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:42:33,432) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:42:33,659) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993695
[2211374:MainThread](2024-04-22 22:42:33,660) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 22:42:33,660) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:42:35,999) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:42:36,229) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994752
[2211374:MainThread](2024-04-22 22:42:36,229) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 22:42:36,229) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:42:38,572) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:42:38,800) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993476
[2211374:MainThread](2024-04-22 22:42:38,800) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 22:42:38,800) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:42:41,144) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:42:41,369) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995966
[2211374:MainThread](2024-04-22 22:42:41,370) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 22:42:41,370) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:42:43,720) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:42:43,945) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994602
[2211374:MainThread](2024-04-22 22:42:43,945) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 22:42:43,945) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:42:46,249) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:42:46,474) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995758
[2211374:MainThread](2024-04-22 22:42:46,474) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 22:42:46,475) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:42:48,783) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:42:49,011) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994334
[2211374:MainThread](2024-04-22 22:42:49,011) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 22:42:49,012) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:42:51,338) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:42:51,565) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994353
[2211374:MainThread](2024-04-22 22:42:51,566) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 22:42:51,566) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993435 @ 9
[2211374:MainThread](2024-04-22 22:42:51,615) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-03-07 SH600000    0.011560
           SH600008    0.002059
           SH600009    0.035795
           SH600010    0.024588
           SH600015    0.047968
[2211374:MainThread](2024-04-22 22:42:53,302) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   7%|▋         | 3/44 [02:59<39:23, 57.65s/it][2211374:MainThread](2024-04-22 22:42:53,309) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 22:42:53,318) INFO - qlib.workflow - [recorder.py:341] - Recorder a4a0fa15ac4941eca44b0f85e940119f starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 22:42:53,804) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 22:42:53,804) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 22:42:53,808) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 22:42:53,809) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 22:43:01,435) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.655666
            SH600004      0.655666
            SH600006      0.655666
            SH600007      0.655666
            SH600008      0.655666
                            ...   
2015-04-03  SZ300070      0.662131
            SZ300124      0.662131
            SZ300133      0.662131
            SZ300146      0.662131
            SZ300251      0.662131
Length: 495049, dtype: float64
[2211374:MainThread](2024-04-22 22:43:01,438) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 22:43:01,438) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 22:43:01,438) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:03,820) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:04,047) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995446
[2211374:MainThread](2024-04-22 22:43:04,049) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 22:43:04,049) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:06,410) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:06,636) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995952
[2211374:MainThread](2024-04-22 22:43:06,637) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 22:43:06,637) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:08,959) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:09,186) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995293
[2211374:MainThread](2024-04-22 22:43:09,187) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 22:43:09,187) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:11,521) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:11,749) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996258
[2211374:MainThread](2024-04-22 22:43:11,749) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 22:43:11,749) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:14,067) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:14,294) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994726
[2211374:MainThread](2024-04-22 22:43:14,295) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 22:43:14,295) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:16,640) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:16,867) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995732
[2211374:MainThread](2024-04-22 22:43:16,867) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 22:43:16,868) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:19,213) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:19,441) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994077
[2211374:MainThread](2024-04-22 22:43:19,442) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 22:43:19,442) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:21,765) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:21,991) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994060
[2211374:MainThread](2024-04-22 22:43:21,992) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 22:43:21,993) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:24,314) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:24,543) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994748
[2211374:MainThread](2024-04-22 22:43:24,543) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 22:43:24,544) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:26,868) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:27,097) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995974
[2211374:MainThread](2024-04-22 22:43:27,097) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 22:43:27,097) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:29,418) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:29,646) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994014
[2211374:MainThread](2024-04-22 22:43:29,647) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 22:43:29,647) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:31,982) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:32,207) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995958
[2211374:MainThread](2024-04-22 22:43:32,208) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 22:43:32,208) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:34,543) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:34,774) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994781
[2211374:MainThread](2024-04-22 22:43:34,774) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 22:43:34,774) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:37,093) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:37,321) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995251
[2211374:MainThread](2024-04-22 22:43:37,321) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 22:43:37,321) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:39,645) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:39,869) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993489
[2211374:MainThread](2024-04-22 22:43:39,870) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 22:43:39,870) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:42,159) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:42,384) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994032
[2211374:MainThread](2024-04-22 22:43:42,384) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 22:43:42,384) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:44,682) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:44,907) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994797
[2211374:MainThread](2024-04-22 22:43:44,907) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 22:43:44,908) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:47,254) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:47,478) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995564
[2211374:MainThread](2024-04-22 22:43:47,478) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 22:43:47,478) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:49,834) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:50,059) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996496
[2211374:MainThread](2024-04-22 22:43:50,059) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 22:43:50,060) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:52,419) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:52,644) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995085
[2211374:MainThread](2024-04-22 22:43:52,644) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 22:43:52,645) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:54,951) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:55,176) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995421
[2211374:MainThread](2024-04-22 22:43:55,176) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 22:43:55,176) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:43:57,509) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:43:57,734) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996095
[2211374:MainThread](2024-04-22 22:43:57,734) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 22:43:57,734) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:00,078) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:00,303) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997703
[2211374:MainThread](2024-04-22 22:44:00,304) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 22:44:00,304) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993489 @ 14
[2211374:MainThread](2024-04-22 22:44:00,353) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-04-06 SH600000   -0.011465
           SH600008   -0.205024
           SH600009   -0.113153
           SH600010   -0.007494
           SH600015   -0.010182
[2211374:MainThread](2024-04-22 22:44:02,010) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   9%|▉         | 4/44 [04:08<41:20, 62.01s/it][2211374:MainThread](2024-04-22 22:44:02,017) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 22:44:02,026) INFO - qlib.workflow - [recorder.py:341] - Recorder a683f87d6d404f87ae4f6b38bf959991 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 22:44:02,491) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 22:44:02,492) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 22:44:02,494) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 22:44:02,494) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 22:44:09,994) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.007424
            SH600004      1.007424
            SH600006      1.007424
            SH600007      1.007424
            SH600008      1.007424
                            ...   
2015-05-05  SZ300070      1.863817
            SZ300124      1.863817
            SZ300133      1.863817
            SZ300146      1.863817
            SZ300251      1.863817
Length: 500679, dtype: float64
[2211374:MainThread](2024-04-22 22:44:09,996) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 22:44:09,997) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 22:44:09,997) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:12,397) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:12,599) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995893
[2211374:MainThread](2024-04-22 22:44:12,600) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 22:44:12,601) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:14,985) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:15,184) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996550
[2211374:MainThread](2024-04-22 22:44:15,184) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 22:44:15,184) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:17,563) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:17,763) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994673
[2211374:MainThread](2024-04-22 22:44:17,763) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 22:44:17,764) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:20,181) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:20,383) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994547
[2211374:MainThread](2024-04-22 22:44:20,384) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 22:44:20,385) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:22,805) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:23,007) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994722
[2211374:MainThread](2024-04-22 22:44:23,007) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 22:44:23,008) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:25,424) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:25,626) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994741
[2211374:MainThread](2024-04-22 22:44:25,626) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 22:44:25,627) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:28,057) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:28,258) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993872
[2211374:MainThread](2024-04-22 22:44:28,259) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 22:44:28,259) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:30,669) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:30,870) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993923
[2211374:MainThread](2024-04-22 22:44:30,871) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 22:44:30,871) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:33,285) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:33,486) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994079
[2211374:MainThread](2024-04-22 22:44:33,487) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 22:44:33,487) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:35,910) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:36,111) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993683
[2211374:MainThread](2024-04-22 22:44:36,112) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 22:44:36,113) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:38,530) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:38,732) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994869
[2211374:MainThread](2024-04-22 22:44:38,732) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 22:44:38,732) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:41,133) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:41,333) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993648
[2211374:MainThread](2024-04-22 22:44:41,334) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 22:44:41,334) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:43,698) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:43,900) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994116
[2211374:MainThread](2024-04-22 22:44:43,900) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 22:44:43,901) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:46,270) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:46,472) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993593
[2211374:MainThread](2024-04-22 22:44:46,473) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 22:44:46,473) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:48,848) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:49,049) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994831
[2211374:MainThread](2024-04-22 22:44:49,050) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 22:44:49,050) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:51,410) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:51,613) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994616
[2211374:MainThread](2024-04-22 22:44:51,613) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 22:44:51,614) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:53,971) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:54,171) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993845
[2211374:MainThread](2024-04-22 22:44:54,172) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 22:44:54,172) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:56,529) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:56,731) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995222
[2211374:MainThread](2024-04-22 22:44:56,731) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 22:44:56,732) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:44:59,092) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:44:59,293) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996241
[2211374:MainThread](2024-04-22 22:44:59,294) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 22:44:59,294) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:45:01,664) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:45:01,866) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995398
[2211374:MainThread](2024-04-22 22:45:01,866) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 22:45:01,867) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:45:04,232) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:45:04,435) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995927
[2211374:MainThread](2024-04-22 22:45:04,435) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 22:45:04,436) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:45:06,798) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:45:06,999) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994966
[2211374:MainThread](2024-04-22 22:45:07,000) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 22:45:07,000) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993593 @ 13
[2211374:MainThread](2024-04-22 22:45:07,050) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-05-05 SH600000   -0.030379
           SH600008   -0.120515
           SH600009   -0.256201
           SH600010   -0.029952
           SH600015   -0.037110
[2211374:MainThread](2024-04-22 22:45:08,737) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  11%|█▏        | 5/44 [05:14<41:24, 63.71s/it][2211374:MainThread](2024-04-22 22:45:08,745) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 22:45:08,754) INFO - qlib.workflow - [recorder.py:341] - Recorder 1e3c6863486e4aafaa714dff90945d7b starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 22:45:09,220) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 22:45:09,221) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 22:45:09,224) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 22:45:09,225) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 22:45:16,896) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.561148
            SH600004      0.561148
            SH600006      0.561148
            SH600007      0.561148
            SH600008      0.561148
                            ...   
2015-06-02  SZ300070      0.736107
            SZ300124      0.736107
            SZ300133      0.736107
            SZ300146      0.736107
            SZ300251      0.736107
Length: 506316, dtype: float64
[2211374:MainThread](2024-04-22 22:45:16,899) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 22:45:16,899) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 22:45:16,899) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:45:19,298) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:45:19,503) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997644
[2211374:MainThread](2024-04-22 22:45:19,504) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 22:45:19,504) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:45:21,893) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:45:22,100) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995795
[2211374:MainThread](2024-04-22 22:45:22,101) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 22:45:22,101) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:45:24,482) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:45:24,686) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995597
[2211374:MainThread](2024-04-22 22:45:24,687) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 22:45:24,687) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:45:27,042) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:45:27,248) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994662
[2211374:MainThread](2024-04-22 22:45:27,249) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 22:45:27,249) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:45:29,641) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:45:29,846) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995443
[2211374:MainThread](2024-04-22 22:45:29,846) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 22:45:29,847) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:45:32,228) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:45:32,433) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995265
[2211374:MainThread](2024-04-22 22:45:32,434) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 22:45:32,434) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:45:34,814) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:45:35,019) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994596
[2211374:MainThread](2024-04-22 22:45:35,020) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 22:45:35,021) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:45:37,412) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:45:37,617) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993702
[2211374:MainThread](2024-04-22 22:45:37,618) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 22:45:37,619) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:45:39,997) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:45:40,203) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995065
[2211374:MainThread](2024-04-22 22:45:40,203) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 22:45:40,204) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:45:42,570) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:45:42,776) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994138
[2211374:MainThread](2024-04-22 22:45:42,776) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 22:45:42,776) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:45:45,131) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:45:45,335) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994825
[2211374:MainThread](2024-04-22 22:45:45,335) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 22:45:45,336) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:45:47,692) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:45:47,898) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994879
[2211374:MainThread](2024-04-22 22:45:47,898) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 22:45:47,899) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:45:50,263) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:45:50,468) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993294
[2211374:MainThread](2024-04-22 22:45:50,469) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 22:45:50,469) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:45:52,828) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:45:53,032) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995238
[2211374:MainThread](2024-04-22 22:45:53,032) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 22:45:53,032) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:45:55,416) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:45:55,623) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993153
[2211374:MainThread](2024-04-22 22:45:55,624) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 22:45:55,624) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:45:58,013) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:45:58,218) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994781
[2211374:MainThread](2024-04-22 22:45:58,218) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 22:45:58,219) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:00,574) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:00,779) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994210
[2211374:MainThread](2024-04-22 22:46:00,780) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 22:46:00,780) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:03,102) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:03,309) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995683
[2211374:MainThread](2024-04-22 22:46:03,310) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 22:46:03,310) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:05,665) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:05,870) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994942
[2211374:MainThread](2024-04-22 22:46:05,870) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 22:46:05,871) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:08,225) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:08,430) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995959
[2211374:MainThread](2024-04-22 22:46:08,430) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 22:46:08,430) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:10,795) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:11,000) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995854
[2211374:MainThread](2024-04-22 22:46:11,000) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 22:46:11,000) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:13,358) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:13,563) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996707
[2211374:MainThread](2024-04-22 22:46:13,563) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 22:46:13,564) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:15,917) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:16,122) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996020
[2211374:MainThread](2024-04-22 22:46:16,122) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 22:46:16,122) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993153 @ 14
[2211374:MainThread](2024-04-22 22:46:16,171) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-06-06 SH600000    0.006944
           SH600008    0.007045
           SH600009    0.085408
           SH600010   -0.003480
           SH600015    0.036047
[2211374:MainThread](2024-04-22 22:46:17,829) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  14%|█▎        | 6/44 [06:23<41:30, 65.54s/it][2211374:MainThread](2024-04-22 22:46:17,837) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 22:46:17,846) INFO - qlib.workflow - [recorder.py:341] - Recorder d6656f329b8d4d48b459679b62bee2c8 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 22:46:18,332) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 22:46:18,333) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 22:46:18,335) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 22:46:18,336) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 22:46:25,837) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.766580
            SH600004      1.766580
            SH600006      1.766580
            SH600007      1.766580
            SH600008      1.766580
                            ...   
2015-07-10  SZ300059      1.509355
            SZ300070      1.509355
            SZ300104      1.509355
            SZ300124      1.509355
            SZ300146      1.509355
Length: 511531, dtype: float64
[2211374:MainThread](2024-04-22 22:46:25,839) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 22:46:25,840) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 22:46:25,840) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:28,166) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:28,391) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995835
[2211374:MainThread](2024-04-22 22:46:28,392) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 22:46:28,393) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:30,710) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:30,938) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994711
[2211374:MainThread](2024-04-22 22:46:30,939) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 22:46:30,940) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:33,256) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:33,482) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993593
[2211374:MainThread](2024-04-22 22:46:33,483) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 22:46:33,483) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:35,798) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:36,024) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993404
[2211374:MainThread](2024-04-22 22:46:36,024) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 22:46:36,025) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:38,350) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:38,577) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994354
[2211374:MainThread](2024-04-22 22:46:38,577) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 22:46:38,577) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:40,894) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:41,121) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992636
[2211374:MainThread](2024-04-22 22:46:41,122) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 22:46:41,122) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:43,437) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:43,663) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992761
[2211374:MainThread](2024-04-22 22:46:43,663) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 22:46:43,663) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:46,028) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:46,256) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991809
[2211374:MainThread](2024-04-22 22:46:46,257) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 22:46:46,257) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:48,644) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:48,869) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991469
[2211374:MainThread](2024-04-22 22:46:48,870) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 22:46:48,871) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:51,241) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:51,469) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991748
[2211374:MainThread](2024-04-22 22:46:51,469) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 22:46:51,469) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:53,860) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:54,086) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991870
[2211374:MainThread](2024-04-22 22:46:54,086) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 22:46:54,086) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:56,463) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:56,688) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991480
[2211374:MainThread](2024-04-22 22:46:56,689) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 22:46:56,689) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:46:59,089) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:46:59,319) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992428
[2211374:MainThread](2024-04-22 22:46:59,319) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 22:46:59,319) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:47:01,704) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:47:01,933) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991714
[2211374:MainThread](2024-04-22 22:47:01,933) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 22:47:01,934) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:47:04,340) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:47:04,569) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991228
[2211374:MainThread](2024-04-22 22:47:04,570) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 22:47:04,570) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:47:07,026) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:47:07,256) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991945
[2211374:MainThread](2024-04-22 22:47:07,257) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 22:47:07,257) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:47:09,707) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:47:09,936) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991317
[2211374:MainThread](2024-04-22 22:47:09,936) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 22:47:09,936) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:47:12,397) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:47:12,624) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991626
[2211374:MainThread](2024-04-22 22:47:12,624) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 22:47:12,625) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:47:15,071) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:47:15,300) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993607
[2211374:MainThread](2024-04-22 22:47:15,301) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 22:47:15,301) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:47:17,748) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:47:17,977) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992891
[2211374:MainThread](2024-04-22 22:47:17,978) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 22:47:17,978) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:47:20,436) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:47:20,665) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993228
[2211374:MainThread](2024-04-22 22:47:20,666) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 22:47:20,666) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:47:23,116) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:47:23,343) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993903
[2211374:MainThread](2024-04-22 22:47:23,343) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 22:47:23,344) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:47:25,796) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:47:26,030) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993709
[2211374:MainThread](2024-04-22 22:47:26,030) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 22:47:26,030) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991228 @ 14
[2211374:MainThread](2024-04-22 22:47:26,080) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-07-04 SH600000    0.050131
           SH600008   -0.117586
           SH600009   -0.018709
           SH600010    0.028316
           SH600015    0.036029
[2211374:MainThread](2024-04-22 22:47:27,768) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  16%|█▌        | 7/44 [07:33<41:18, 66.98s/it][2211374:MainThread](2024-04-22 22:47:27,776) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 22:47:27,785) INFO - qlib.workflow - [recorder.py:341] - Recorder 3965991483714ef591843e222c022ec3 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 22:47:28,268) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 22:47:28,268) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 22:47:28,271) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 22:47:28,272) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 22:47:35,946) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.032033
            SH600004      1.032033
            SH600006      1.032033
            SH600007      1.032033
            SH600008      1.032033
                            ...   
2015-08-07  SZ300104      1.692228
            SZ300124      1.692228
            SZ300133      1.692228
            SZ300146      1.692228
            SZ300251      1.692228
Length: 516849, dtype: float64
[2211374:MainThread](2024-04-22 22:47:35,959) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 22:47:35,959) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 22:47:35,959) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:47:38,452) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:47:38,674) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995586
[2211374:MainThread](2024-04-22 22:47:38,675) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 22:47:38,676) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:47:41,167) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:47:41,392) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994611
[2211374:MainThread](2024-04-22 22:47:41,393) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 22:47:41,393) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:47:43,874) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:47:44,098) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994130
[2211374:MainThread](2024-04-22 22:47:44,099) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 22:47:44,099) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:47:46,580) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:47:46,805) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994283
[2211374:MainThread](2024-04-22 22:47:46,806) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 22:47:46,806) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:47:49,285) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:47:49,509) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993646
[2211374:MainThread](2024-04-22 22:47:49,510) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 22:47:49,511) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:47:51,991) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:47:52,215) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993977
[2211374:MainThread](2024-04-22 22:47:52,216) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 22:47:52,216) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:47:54,708) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:47:54,933) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994312
[2211374:MainThread](2024-04-22 22:47:54,934) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 22:47:54,934) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:47:57,338) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:47:57,562) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993830
[2211374:MainThread](2024-04-22 22:47:57,562) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 22:47:57,562) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:47:59,988) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:48:00,212) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992935
[2211374:MainThread](2024-04-22 22:48:00,213) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 22:48:00,214) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:48:02,673) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:48:02,899) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993461
[2211374:MainThread](2024-04-22 22:48:02,899) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 22:48:02,899) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:48:05,331) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:48:05,557) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992894
[2211374:MainThread](2024-04-22 22:48:05,558) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 22:48:05,558) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:48:08,003) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:48:08,229) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992899
[2211374:MainThread](2024-04-22 22:48:08,229) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 22:48:08,230) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:48:10,664) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:48:10,889) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992475
[2211374:MainThread](2024-04-22 22:48:10,890) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 22:48:10,891) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:48:13,322) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:48:13,548) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994552
[2211374:MainThread](2024-04-22 22:48:13,548) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 22:48:13,549) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:48:16,000) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:48:16,225) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993066
[2211374:MainThread](2024-04-22 22:48:16,225) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 22:48:16,226) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:48:18,646) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:48:18,868) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992175
[2211374:MainThread](2024-04-22 22:48:18,869) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 22:48:18,869) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:48:21,309) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:48:21,536) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992230
[2211374:MainThread](2024-04-22 22:48:21,537) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 22:48:21,537) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:48:23,971) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:48:24,197) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992808
[2211374:MainThread](2024-04-22 22:48:24,197) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 22:48:24,198) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:48:26,628) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:48:26,850) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992524
[2211374:MainThread](2024-04-22 22:48:26,851) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 22:48:26,851) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:48:29,297) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:48:29,523) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992224
[2211374:MainThread](2024-04-22 22:48:29,523) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 22:48:29,523) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:48:31,943) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:48:32,169) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993054
[2211374:MainThread](2024-04-22 22:48:32,170) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 22:48:32,170) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:48:34,590) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:48:34,813) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992813
[2211374:MainThread](2024-04-22 22:48:34,813) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 22:48:34,814) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:48:37,233) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:48:37,456) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994485
[2211374:MainThread](2024-04-22 22:48:37,456) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 22:48:37,456) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:48:39,868) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:48:40,091) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994286
[2211374:MainThread](2024-04-22 22:48:40,092) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 22:48:40,092) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992175 @ 15
[2211374:MainThread](2024-04-22 22:48:40,140) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-08-01 SH600000   -0.038642
           SH600008    0.059121
           SH600009   -0.046093
           SH600010    0.162006
           SH600015   -0.118003
[2211374:MainThread](2024-04-22 22:48:41,788) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  18%|█▊        | 8/44 [08:47<41:31, 69.22s/it][2211374:MainThread](2024-04-22 22:48:41,796) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 22:48:41,805) INFO - qlib.workflow - [recorder.py:341] - Recorder da397a0e30ec47c2aec3b23766400efe starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 22:48:42,283) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 22:48:42,283) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 22:48:42,287) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 22:48:42,287) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 22:48:49,808) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.439811
            SH600004      1.439811
            SH600006      1.439811
            SH600007      1.439811
            SH600008      1.439811
                            ...   
2015-09-08  SZ300104      1.791496
            SZ300124      1.791496
            SZ300133      1.791496
            SZ300146      1.791496
            SZ300251      1.791496
Length: 522220, dtype: float64
[2211374:MainThread](2024-04-22 22:48:49,810) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 22:48:49,810) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 22:48:49,810) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:48:52,283) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:48:52,473) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996082
[2211374:MainThread](2024-04-22 22:48:52,474) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 22:48:52,474) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:48:54,942) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:48:55,131) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994404
[2211374:MainThread](2024-04-22 22:48:55,132) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 22:48:55,132) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:48:57,610) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:48:57,800) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993734
[2211374:MainThread](2024-04-22 22:48:57,801) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 22:48:57,801) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:00,269) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:00,458) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993331
[2211374:MainThread](2024-04-22 22:49:00,459) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 22:49:00,459) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:02,942) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:03,133) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993535
[2211374:MainThread](2024-04-22 22:49:03,134) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 22:49:03,134) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:05,599) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:05,789) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993581
[2211374:MainThread](2024-04-22 22:49:05,789) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 22:49:05,790) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:08,254) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:08,444) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992825
[2211374:MainThread](2024-04-22 22:49:08,445) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 22:49:08,445) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:10,927) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:11,117) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992230
[2211374:MainThread](2024-04-22 22:49:11,118) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 22:49:11,118) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:13,584) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:13,774) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992511
[2211374:MainThread](2024-04-22 22:49:13,775) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 22:49:13,775) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:16,245) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:16,436) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992612
[2211374:MainThread](2024-04-22 22:49:16,437) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 22:49:16,437) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:18,945) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:19,135) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992160
[2211374:MainThread](2024-04-22 22:49:19,136) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 22:49:19,136) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:21,633) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:21,823) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991888
[2211374:MainThread](2024-04-22 22:49:21,824) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 22:49:21,824) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:24,304) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:24,494) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991649
[2211374:MainThread](2024-04-22 22:49:24,495) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 22:49:24,495) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:26,961) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:27,150) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991956
[2211374:MainThread](2024-04-22 22:49:27,151) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 22:49:27,151) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:29,615) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:29,805) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992817
[2211374:MainThread](2024-04-22 22:49:29,805) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 22:49:29,805) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:32,277) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:32,467) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991381
[2211374:MainThread](2024-04-22 22:49:32,468) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 22:49:32,469) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:34,935) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:35,125) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991074
[2211374:MainThread](2024-04-22 22:49:35,126) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 22:49:35,126) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:37,605) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:37,795) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991991
[2211374:MainThread](2024-04-22 22:49:37,796) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 22:49:37,796) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:40,261) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:40,451) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991012
[2211374:MainThread](2024-04-22 22:49:40,452) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 22:49:40,452) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:42,916) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:43,106) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991855
[2211374:MainThread](2024-04-22 22:49:43,107) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 22:49:43,107) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:45,585) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:45,775) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991163
[2211374:MainThread](2024-04-22 22:49:45,776) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 22:49:45,776) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:48,240) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:48,431) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990661
[2211374:MainThread](2024-04-22 22:49:48,432) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 22:49:48,432) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:50,904) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:51,094) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991332
[2211374:MainThread](2024-04-22 22:49:51,095) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 22:49:51,095) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:53,566) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:53,756) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991169
[2211374:MainThread](2024-04-22 22:49:53,756) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 22:49:53,757) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:56,223) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:56,414) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991604
[2211374:MainThread](2024-04-22 22:49:56,414) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 22:49:56,415) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:49:58,896) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:49:59,086) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991447
[2211374:MainThread](2024-04-22 22:49:59,087) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-22 22:49:59,087) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:50:01,552) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:50:01,743) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991528
[2211374:MainThread](2024-04-22 22:50:01,743) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[2211374:MainThread](2024-04-22 22:50:01,744) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:50:04,217) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:50:04,407) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992675
[2211374:MainThread](2024-04-22 22:50:04,407) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[2211374:MainThread](2024-04-22 22:50:04,408) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:50:06,884) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:50:07,076) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992191
[2211374:MainThread](2024-04-22 22:50:07,076) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[2211374:MainThread](2024-04-22 22:50:07,077) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:50:09,541) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:50:09,732) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992868
[2211374:MainThread](2024-04-22 22:50:09,732) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 22:50:09,733) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990661 @ 21
[2211374:MainThread](2024-04-22 22:50:09,783) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-08-29 SH600000   -0.060139
           SH600008   -0.023892
           SH600009    0.218188
           SH600010   -0.133782
           SH600015    0.003133
[2211374:MainThread](2024-04-22 22:50:11,440) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  20%|██        | 9/44 [10:17<44:06, 75.61s/it][2211374:MainThread](2024-04-22 22:50:11,448) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 22:50:11,457) INFO - qlib.workflow - [recorder.py:341] - Recorder 328d35a47fba4b9685f98049b7e5391b starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 22:50:11,944) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 22:50:11,946) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 22:50:11,948) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 22:50:11,948) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 22:50:19,469) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.323617
            SH600004      1.323617
            SH600006      1.323617
            SH600007      1.323617
            SH600008      1.323617
                            ...   
2015-10-13  SZ300104      1.789057
            SZ300124      1.789057
            SZ300133      1.789057
            SZ300146      1.789057
            SZ300251      1.789057
Length: 527673, dtype: float64
[2211374:MainThread](2024-04-22 22:50:19,471) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 22:50:19,471) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 22:50:19,471) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:50:21,956) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:50:22,178) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995098
[2211374:MainThread](2024-04-22 22:50:22,179) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 22:50:22,179) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:50:24,646) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:50:24,867) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994539
[2211374:MainThread](2024-04-22 22:50:24,868) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 22:50:24,869) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:50:27,352) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:50:27,574) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993896
[2211374:MainThread](2024-04-22 22:50:27,575) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 22:50:27,575) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:50:30,040) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:50:30,262) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993677
[2211374:MainThread](2024-04-22 22:50:30,263) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 22:50:30,263) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:50:32,743) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:50:32,964) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993769
[2211374:MainThread](2024-04-22 22:50:32,964) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 22:50:32,965) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:50:35,434) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:50:35,656) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993581
[2211374:MainThread](2024-04-22 22:50:35,657) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 22:50:35,658) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:50:38,120) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:50:38,342) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992683
[2211374:MainThread](2024-04-22 22:50:38,343) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 22:50:38,344) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:50:40,822) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:50:41,044) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992553
[2211374:MainThread](2024-04-22 22:50:41,045) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 22:50:41,045) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:50:43,512) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:50:43,733) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992757
[2211374:MainThread](2024-04-22 22:50:43,734) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 22:50:43,734) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:50:46,215) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:50:46,437) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992319
[2211374:MainThread](2024-04-22 22:50:46,438) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 22:50:46,438) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:50:48,906) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:50:49,128) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991843
[2211374:MainThread](2024-04-22 22:50:49,129) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 22:50:49,129) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:50:51,597) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:50:51,821) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992886
[2211374:MainThread](2024-04-22 22:50:51,822) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 22:50:51,822) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:50:54,302) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:50:54,524) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992460
[2211374:MainThread](2024-04-22 22:50:54,525) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 22:50:54,525) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:50:56,990) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:50:57,212) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992333
[2211374:MainThread](2024-04-22 22:50:57,212) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 22:50:57,213) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:50:59,685) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:50:59,913) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991929
[2211374:MainThread](2024-04-22 22:50:59,914) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 22:50:59,914) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:51:02,412) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:51:02,637) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992291
[2211374:MainThread](2024-04-22 22:51:02,637) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 22:51:02,637) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:51:05,135) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:51:05,360) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991832
[2211374:MainThread](2024-04-22 22:51:05,361) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 22:51:05,361) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:51:07,857) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:51:08,079) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992034
[2211374:MainThread](2024-04-22 22:51:08,079) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 22:51:08,080) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:51:10,567) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:51:10,792) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991749
[2211374:MainThread](2024-04-22 22:51:10,793) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 22:51:10,794) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:51:13,288) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:51:13,516) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991858
[2211374:MainThread](2024-04-22 22:51:13,517) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 22:51:13,517) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:51:16,017) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:51:16,242) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991890
[2211374:MainThread](2024-04-22 22:51:16,242) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 22:51:16,242) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:51:18,733) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:51:18,959) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991675
[2211374:MainThread](2024-04-22 22:51:18,960) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 22:51:18,960) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:51:21,468) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:51:21,693) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992669
[2211374:MainThread](2024-04-22 22:51:21,693) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 22:51:21,694) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:51:24,167) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:51:24,388) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992203
[2211374:MainThread](2024-04-22 22:51:24,389) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 22:51:24,389) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:51:26,869) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:51:27,094) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992208
[2211374:MainThread](2024-04-22 22:51:27,094) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 22:51:27,095) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:51:29,602) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:51:29,830) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992071
[2211374:MainThread](2024-04-22 22:51:29,830) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-22 22:51:29,830) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:51:32,324) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:51:32,550) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992450
[2211374:MainThread](2024-04-22 22:51:32,550) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[2211374:MainThread](2024-04-22 22:51:32,551) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:51:35,035) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:51:35,257) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993290
[2211374:MainThread](2024-04-22 22:51:35,257) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[2211374:MainThread](2024-04-22 22:51:35,258) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:51:37,727) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:51:37,950) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993145
[2211374:MainThread](2024-04-22 22:51:37,950) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[2211374:MainThread](2024-04-22 22:51:37,950) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:51:40,417) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:51:40,639) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992353
[2211374:MainThread](2024-04-22 22:51:40,639) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 22:51:40,640) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991675 @ 21
[2211374:MainThread](2024-04-22 22:51:40,688) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-09-26 SH600000    0.050200
           SH600008   -0.104591
           SH600009    0.007059
           SH600010    0.008912
           SH600015    0.046216
[2211374:MainThread](2024-04-22 22:51:42,338) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  23%|██▎       | 10/44 [11:48<45:31, 80.33s/it][2211374:MainThread](2024-04-22 22:51:42,346) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 22:51:42,355) INFO - qlib.workflow - [recorder.py:341] - Recorder 0ed2913244814f5eaf7556203ff0c853 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 22:51:42,830) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 22:51:42,831) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 22:51:42,834) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 22:51:42,834) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 22:51:50,368) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.465659
            SH600004      1.465659
            SH600006      1.465659
            SH600007      1.465659
            SH600008      1.465659
                            ...   
2015-11-19  SZ300104      1.883063
            SZ300124      1.883063
            SZ300133      1.883063
            SZ300146      1.883063
            SZ300251      1.883063
Length: 533252, dtype: float64
[2211374:MainThread](2024-04-22 22:51:50,370) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 22:51:50,371) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 22:51:50,371) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:51:52,880) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:51:53,104) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995151
[2211374:MainThread](2024-04-22 22:51:53,105) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 22:51:53,106) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:51:55,637) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:51:55,863) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994952
[2211374:MainThread](2024-04-22 22:51:55,864) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 22:51:55,864) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:51:58,362) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:51:58,588) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994193
[2211374:MainThread](2024-04-22 22:51:58,589) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 22:51:58,589) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:52:01,082) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:52:01,307) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993736
[2211374:MainThread](2024-04-22 22:52:01,308) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 22:52:01,308) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:52:03,806) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:52:04,031) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993538
[2211374:MainThread](2024-04-22 22:52:04,032) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 22:52:04,032) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:52:06,532) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:52:06,757) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993953
[2211374:MainThread](2024-04-22 22:52:06,758) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 22:52:06,758) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:52:09,265) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:52:09,493) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993506
[2211374:MainThread](2024-04-22 22:52:09,494) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 22:52:09,494) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:52:11,989) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:52:12,214) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993104
[2211374:MainThread](2024-04-22 22:52:12,215) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 22:52:12,215) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:52:14,708) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:52:14,933) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993684
[2211374:MainThread](2024-04-22 22:52:14,933) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 22:52:14,934) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:52:17,498) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:52:17,723) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994750
[2211374:MainThread](2024-04-22 22:52:17,724) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 22:52:17,724) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:52:20,270) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:52:20,495) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992829
[2211374:MainThread](2024-04-22 22:52:20,496) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 22:52:20,496) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:52:23,062) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:52:23,289) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991887
[2211374:MainThread](2024-04-22 22:52:23,290) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 22:52:23,290) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:52:25,841) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:52:26,066) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992240
[2211374:MainThread](2024-04-22 22:52:26,067) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 22:52:26,067) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:52:28,609) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:52:28,835) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990952
[2211374:MainThread](2024-04-22 22:52:28,836) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 22:52:28,836) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:52:31,396) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:52:31,622) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991981
[2211374:MainThread](2024-04-22 22:52:31,622) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 22:52:31,623) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:52:34,167) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:52:34,392) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991525
[2211374:MainThread](2024-04-22 22:52:34,392) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 22:52:34,393) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:52:36,926) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:52:37,152) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992548
[2211374:MainThread](2024-04-22 22:52:37,152) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 22:52:37,152) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:52:39,644) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:52:39,870) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991449
[2211374:MainThread](2024-04-22 22:52:39,870) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 22:52:39,870) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:52:42,363) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:52:42,589) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990992
[2211374:MainThread](2024-04-22 22:52:42,589) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 22:52:42,590) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:52:45,092) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:52:45,318) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991299
[2211374:MainThread](2024-04-22 22:52:45,318) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 22:52:45,319) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:52:47,812) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:52:48,037) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991202
[2211374:MainThread](2024-04-22 22:52:48,038) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 22:52:48,038) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:52:50,572) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:52:50,798) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991294
[2211374:MainThread](2024-04-22 22:52:50,799) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 22:52:50,799) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990952 @ 13
[2211374:MainThread](2024-04-22 22:52:50,847) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-10-31 SH600000   -0.022043
           SH600008   -0.069081
           SH600009    0.120295
           SH600010    0.023869
           SH600015   -0.008454
[2211374:MainThread](2024-04-22 22:52:52,497) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  25%|██▌       | 11/44 [12:58<42:28, 77.22s/it][2211374:MainThread](2024-04-22 22:52:52,505) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 22:52:52,514) INFO - qlib.workflow - [recorder.py:341] - Recorder a4f9f9951dd343ebb225eecdb8d99ef9 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 22:52:52,972) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 22:52:52,973) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 22:52:52,975) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 22:52:52,976) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 22:53:00,522) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.073025
            SH600004      1.073025
            SH600006      1.073025
            SH600007      1.073025
            SH600008      1.073025
                            ...   
2015-12-17  SZ300133      1.984583
            SZ300144      1.984583
            SZ300146      1.984583
            SZ300251      1.984583
            SZ300315      1.984583
Length: 538891, dtype: float64
[2211374:MainThread](2024-04-22 22:53:00,524) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 22:53:00,525) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 22:53:00,525) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:03,042) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:03,268) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995524
[2211374:MainThread](2024-04-22 22:53:03,269) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 22:53:03,269) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:05,772) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:05,998) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994820
[2211374:MainThread](2024-04-22 22:53:05,999) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 22:53:05,999) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:08,517) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:08,746) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993921
[2211374:MainThread](2024-04-22 22:53:08,747) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 22:53:08,747) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:11,283) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:11,512) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993986
[2211374:MainThread](2024-04-22 22:53:11,513) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 22:53:11,513) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:14,037) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:14,266) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993684
[2211374:MainThread](2024-04-22 22:53:14,267) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 22:53:14,268) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:16,791) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:17,020) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992955
[2211374:MainThread](2024-04-22 22:53:17,021) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 22:53:17,022) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:19,556) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:19,786) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993093
[2211374:MainThread](2024-04-22 22:53:19,786) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 22:53:19,786) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:22,313) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:22,542) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992918
[2211374:MainThread](2024-04-22 22:53:22,543) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 22:53:22,543) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:25,078) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:25,307) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992509
[2211374:MainThread](2024-04-22 22:53:25,308) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 22:53:25,309) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:27,836) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:28,065) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992504
[2211374:MainThread](2024-04-22 22:53:28,066) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 22:53:28,067) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:30,591) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:30,820) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991837
[2211374:MainThread](2024-04-22 22:53:30,821) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 22:53:30,821) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:33,365) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:33,594) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992518
[2211374:MainThread](2024-04-22 22:53:33,595) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 22:53:33,595) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:36,123) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:36,353) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992240
[2211374:MainThread](2024-04-22 22:53:36,353) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 22:53:36,353) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:38,892) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:39,123) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991522
[2211374:MainThread](2024-04-22 22:53:39,123) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 22:53:39,124) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:41,652) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:41,881) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992174
[2211374:MainThread](2024-04-22 22:53:41,882) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 22:53:41,882) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:44,409) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:44,639) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991978
[2211374:MainThread](2024-04-22 22:53:44,639) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 22:53:44,640) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:47,162) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:47,389) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992368
[2211374:MainThread](2024-04-22 22:53:47,390) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 22:53:47,390) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:49,884) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:50,111) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991500
[2211374:MainThread](2024-04-22 22:53:50,112) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 22:53:50,112) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:52,616) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:52,842) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991519
[2211374:MainThread](2024-04-22 22:53:52,842) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 22:53:52,842) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:55,333) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:55,561) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991395
[2211374:MainThread](2024-04-22 22:53:55,562) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 22:53:55,562) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:53:58,056) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:53:58,284) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991413
[2211374:MainThread](2024-04-22 22:53:58,284) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 22:53:58,284) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:54:00,788) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:54:01,014) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991167
[2211374:MainThread](2024-04-22 22:54:01,015) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 22:54:01,015) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:54:03,513) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:54:03,739) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991180
[2211374:MainThread](2024-04-22 22:54:03,739) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 22:54:03,739) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:54:06,242) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:54:06,468) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992050
[2211374:MainThread](2024-04-22 22:54:06,468) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 22:54:06,469) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:54:08,956) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:54:09,183) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991694
[2211374:MainThread](2024-04-22 22:54:09,183) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 22:54:09,183) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:54:11,675) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:54:11,902) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991667
[2211374:MainThread](2024-04-22 22:54:11,902) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-22 22:54:11,902) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:54:14,401) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:54:14,627) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991379
[2211374:MainThread](2024-04-22 22:54:14,628) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[2211374:MainThread](2024-04-22 22:54:14,628) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:54:17,141) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:54:17,367) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992166
[2211374:MainThread](2024-04-22 22:54:17,367) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[2211374:MainThread](2024-04-22 22:54:17,367) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:54:19,894) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:54:20,120) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991728
[2211374:MainThread](2024-04-22 22:54:20,120) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[2211374:MainThread](2024-04-22 22:54:20,121) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:54:22,610) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:54:22,836) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992265
[2211374:MainThread](2024-04-22 22:54:22,837) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 22:54:22,837) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991167 @ 21
[2211374:MainThread](2024-04-22 22:54:22,888) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-11-28 SH600000   -0.015964
           SH600008   -0.070293
           SH600009    0.018347
           SH600010   -0.004287
           SH600015   -0.010133
[2211374:MainThread](2024-04-22 22:54:24,592) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  27%|██▋       | 12/44 [14:30<43:35, 81.74s/it][2211374:MainThread](2024-04-22 22:54:24,599) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 22:54:24,608) INFO - qlib.workflow - [recorder.py:341] - Recorder 62c950c772344517ab60bd3332c65c5d starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 22:54:25,084) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 22:54:25,085) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 22:54:25,087) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 22:54:25,087) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 22:54:33,070) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.603096
            SH600004      1.603096
            SH600006      1.603096
            SH600007      1.603096
            SH600008      1.603096
                            ...   
2016-01-15  SZ300133      1.050705
            SZ300144      1.050705
            SZ300146      1.050705
            SZ300251      1.050705
            SZ300315      1.050705
Length: 544436, dtype: float64
[2211374:MainThread](2024-04-22 22:54:33,073) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 22:54:33,073) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 22:54:33,074) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:54:35,680) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:54:35,904) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995611
[2211374:MainThread](2024-04-22 22:54:35,905) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 22:54:35,905) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:54:38,496) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:54:38,721) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994711
[2211374:MainThread](2024-04-22 22:54:38,722) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 22:54:38,722) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:54:41,320) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:54:41,547) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994493
[2211374:MainThread](2024-04-22 22:54:41,548) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 22:54:41,548) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:54:44,134) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:54:44,358) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993617
[2211374:MainThread](2024-04-22 22:54:44,359) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 22:54:44,359) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:54:46,952) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:54:47,176) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993018
[2211374:MainThread](2024-04-22 22:54:47,177) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 22:54:47,178) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:54:49,744) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:54:49,970) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993506
[2211374:MainThread](2024-04-22 22:54:49,970) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 22:54:49,971) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:54:52,569) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:54:52,796) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993039
[2211374:MainThread](2024-04-22 22:54:52,797) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 22:54:52,797) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:54:55,408) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:54:55,635) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991924
[2211374:MainThread](2024-04-22 22:54:55,637) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 22:54:55,637) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:54:58,236) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:54:58,464) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991968
[2211374:MainThread](2024-04-22 22:54:58,464) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 22:54:58,464) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:55:01,002) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:55:01,231) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992325
[2211374:MainThread](2024-04-22 22:55:01,231) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 22:55:01,231) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:55:03,745) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:55:03,971) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992364
[2211374:MainThread](2024-04-22 22:55:03,971) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 22:55:03,972) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:55:06,465) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:55:06,690) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991923
[2211374:MainThread](2024-04-22 22:55:06,692) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 22:55:06,692) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:55:09,159) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:55:09,386) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991251
[2211374:MainThread](2024-04-22 22:55:09,387) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 22:55:09,387) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:55:11,849) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:55:12,075) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990887
[2211374:MainThread](2024-04-22 22:55:12,076) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 22:55:12,076) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:55:14,590) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:55:14,815) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990758
[2211374:MainThread](2024-04-22 22:55:14,816) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 22:55:14,817) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:55:17,332) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:55:17,558) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990780
[2211374:MainThread](2024-04-22 22:55:17,558) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 22:55:17,558) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:55:20,079) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:55:20,305) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991276
[2211374:MainThread](2024-04-22 22:55:20,306) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 22:55:20,306) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:55:22,839) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:55:23,064) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990615
[2211374:MainThread](2024-04-22 22:55:23,066) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 22:55:23,066) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:55:25,590) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:55:25,816) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990962
[2211374:MainThread](2024-04-22 22:55:25,817) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 22:55:25,817) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:55:28,351) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:55:28,577) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991310
[2211374:MainThread](2024-04-22 22:55:28,578) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 22:55:28,578) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:55:31,180) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:55:31,409) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992064
[2211374:MainThread](2024-04-22 22:55:31,410) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 22:55:31,410) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:55:34,006) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:55:34,234) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991581
[2211374:MainThread](2024-04-22 22:55:34,235) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 22:55:34,235) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:55:36,753) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:55:36,983) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991774
[2211374:MainThread](2024-04-22 22:55:36,983) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 22:55:36,984) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:55:39,472) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:55:39,701) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991791
[2211374:MainThread](2024-04-22 22:55:39,701) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 22:55:39,702) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:55:42,199) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:55:42,428) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992222
[2211374:MainThread](2024-04-22 22:55:42,429) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 22:55:42,429) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:55:44,918) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:55:45,147) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993622
[2211374:MainThread](2024-04-22 22:55:45,148) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 22:55:45,148) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990615 @ 17
[2211374:MainThread](2024-04-22 22:55:45,197) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-12-26 SH600000   -0.022793
           SH600008    0.043486
           SH600009   -0.001257
           SH600010   -0.052745
           SH600011    0.031759
[2211374:MainThread](2024-04-22 22:55:46,888) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  30%|██▉       | 13/44 [15:53<42:19, 81.91s/it][2211374:MainThread](2024-04-22 22:55:46,895) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 22:55:46,904) INFO - qlib.workflow - [recorder.py:341] - Recorder 5c85cbd418464e3ebc7198369b57c8b2 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 22:55:47,393) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 22:55:47,394) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 22:55:47,397) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 22:55:47,398) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 22:55:55,069) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.745301
            SH600004      0.745301
            SH600006      0.745301
            SH600007      0.745301
            SH600008      0.745301
                            ...   
2016-03-16  SZ300133      1.471090
            SZ300144      1.471090
            SZ300146      1.471090
            SZ300251      1.471090
            SZ300315      1.471090
Length: 550075, dtype: float64
[2211374:MainThread](2024-04-22 22:55:55,072) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 22:55:55,072) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 22:55:55,072) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:55:57,670) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:55:57,859) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995231
[2211374:MainThread](2024-04-22 22:55:57,860) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 22:55:57,860) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:00,460) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:00,650) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995383
[2211374:MainThread](2024-04-22 22:56:00,650) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 22:56:00,650) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:03,285) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:03,474) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994466
[2211374:MainThread](2024-04-22 22:56:03,475) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 22:56:03,475) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:06,095) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:06,284) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993519
[2211374:MainThread](2024-04-22 22:56:06,285) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 22:56:06,286) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:08,909) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:09,100) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993613
[2211374:MainThread](2024-04-22 22:56:09,100) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 22:56:09,101) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:11,730) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:11,919) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993338
[2211374:MainThread](2024-04-22 22:56:11,920) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 22:56:11,921) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:14,546) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:14,736) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992777
[2211374:MainThread](2024-04-22 22:56:14,737) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 22:56:14,738) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:17,386) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:17,575) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993159
[2211374:MainThread](2024-04-22 22:56:17,575) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 22:56:17,575) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:20,179) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:20,368) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992780
[2211374:MainThread](2024-04-22 22:56:20,369) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 22:56:20,369) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:23,005) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:23,194) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992034
[2211374:MainThread](2024-04-22 22:56:23,195) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 22:56:23,195) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:25,776) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:25,965) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991922
[2211374:MainThread](2024-04-22 22:56:25,966) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 22:56:25,966) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:28,540) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:28,729) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992257
[2211374:MainThread](2024-04-22 22:56:28,729) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 22:56:28,730) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:31,314) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:31,504) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991817
[2211374:MainThread](2024-04-22 22:56:31,505) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 22:56:31,506) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:34,077) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:34,266) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991521
[2211374:MainThread](2024-04-22 22:56:34,267) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 22:56:34,268) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:36,855) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:37,046) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991581
[2211374:MainThread](2024-04-22 22:56:37,046) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 22:56:37,047) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:39,636) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:39,827) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992190
[2211374:MainThread](2024-04-22 22:56:39,827) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 22:56:39,827) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:42,438) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:42,629) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991761
[2211374:MainThread](2024-04-22 22:56:42,629) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 22:56:42,630) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:45,257) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:45,448) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990979
[2211374:MainThread](2024-04-22 22:56:45,449) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 22:56:45,449) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:48,084) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:48,275) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992291
[2211374:MainThread](2024-04-22 22:56:48,275) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 22:56:48,275) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:50,891) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:51,081) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990953
[2211374:MainThread](2024-04-22 22:56:51,082) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 22:56:51,083) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:53,729) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:53,919) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991498
[2211374:MainThread](2024-04-22 22:56:53,920) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 22:56:53,920) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:56,565) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:56,756) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991389
[2211374:MainThread](2024-04-22 22:56:56,756) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 22:56:56,756) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:56:59,360) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:56:59,551) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991745
[2211374:MainThread](2024-04-22 22:56:59,552) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 22:56:59,552) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:57:02,142) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:57:02,333) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991099
[2211374:MainThread](2024-04-22 22:57:02,333) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 22:57:02,334) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:57:04,940) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:57:05,131) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992110
[2211374:MainThread](2024-04-22 22:57:05,132) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 22:57:05,132) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:57:07,726) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:57:07,917) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992853
[2211374:MainThread](2024-04-22 22:57:07,917) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-22 22:57:07,918) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:57:10,510) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:57:10,703) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993105
[2211374:MainThread](2024-04-22 22:57:10,703) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[2211374:MainThread](2024-04-22 22:57:10,704) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:57:13,295) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:57:13,485) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992377
[2211374:MainThread](2024-04-22 22:57:13,486) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 22:57:13,486) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990953 @ 19
[2211374:MainThread](2024-04-22 22:57:13,536) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-01-24 SH600000   -0.015052
           SH600008   -0.146066
           SH600009    0.158778
           SH600010    0.002345
           SH600011   -0.012101
[2211374:MainThread](2024-04-22 22:57:15,216) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  32%|███▏      | 14/44 [17:21<41:55, 83.85s/it][2211374:MainThread](2024-04-22 22:57:15,223) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 22:57:15,232) INFO - qlib.workflow - [recorder.py:341] - Recorder d664e6e6b6ab4f598aab40bfdac39834 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 22:57:15,706) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 22:57:15,707) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 22:57:15,710) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 22:57:15,711) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 22:57:23,358) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.084703
            SH600004      1.084703
            SH600006      1.084703
            SH600007      1.084703
            SH600008      1.084703
                            ...   
2016-04-14  SZ300124      1.939611
            SZ300133      1.939611
            SZ300144      1.939611
            SZ300146      1.939611
            SZ300315      1.939611
Length: 555663, dtype: float64
[2211374:MainThread](2024-04-22 22:57:23,361) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 22:57:23,361) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 22:57:23,361) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:57:25,998) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:57:26,188) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995541
[2211374:MainThread](2024-04-22 22:57:26,189) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 22:57:26,189) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:57:28,837) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:57:29,026) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995212
[2211374:MainThread](2024-04-22 22:57:29,027) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 22:57:29,027) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:57:31,634) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:57:31,823) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993682
[2211374:MainThread](2024-04-22 22:57:31,824) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 22:57:31,824) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:57:34,410) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:57:34,598) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993572
[2211374:MainThread](2024-04-22 22:57:34,599) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 22:57:34,600) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:57:37,209) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:57:37,398) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993293
[2211374:MainThread](2024-04-22 22:57:37,399) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 22:57:37,399) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:57:40,051) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:57:40,239) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993090
[2211374:MainThread](2024-04-22 22:57:40,240) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 22:57:40,240) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:57:42,876) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:57:43,064) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992885
[2211374:MainThread](2024-04-22 22:57:43,065) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 22:57:43,066) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:57:45,711) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:57:45,899) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991972
[2211374:MainThread](2024-04-22 22:57:45,900) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 22:57:45,900) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:57:48,496) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:57:48,685) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992818
[2211374:MainThread](2024-04-22 22:57:48,685) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 22:57:48,685) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:57:51,294) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:57:51,483) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991216
[2211374:MainThread](2024-04-22 22:57:51,484) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 22:57:51,484) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:57:54,086) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:57:54,276) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992115
[2211374:MainThread](2024-04-22 22:57:54,276) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 22:57:54,276) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:57:56,860) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:57:57,049) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991408
[2211374:MainThread](2024-04-22 22:57:57,050) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 22:57:57,050) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:57:59,664) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:57:59,855) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991181
[2211374:MainThread](2024-04-22 22:57:59,856) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 22:57:59,856) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:58:02,478) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:58:02,670) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991526
[2211374:MainThread](2024-04-22 22:58:02,670) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 22:58:02,671) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:58:05,295) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:58:05,485) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991678
[2211374:MainThread](2024-04-22 22:58:05,486) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 22:58:05,486) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:58:08,093) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:58:08,283) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990867
[2211374:MainThread](2024-04-22 22:58:08,284) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 22:58:08,284) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:58:10,870) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:58:11,060) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992096
[2211374:MainThread](2024-04-22 22:58:11,060) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 22:58:11,060) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:58:13,661) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:58:13,851) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991924
[2211374:MainThread](2024-04-22 22:58:13,851) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 22:58:13,852) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:58:16,439) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:58:16,629) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990673
[2211374:MainThread](2024-04-22 22:58:16,630) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 22:58:16,630) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:58:19,219) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:58:19,410) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991273
[2211374:MainThread](2024-04-22 22:58:19,411) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 22:58:19,411) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:58:22,055) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:58:22,245) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991541
[2211374:MainThread](2024-04-22 22:58:22,245) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 22:58:22,246) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:58:24,829) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:58:25,018) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992489
[2211374:MainThread](2024-04-22 22:58:25,019) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 22:58:25,019) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:58:27,632) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:58:27,823) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991492
[2211374:MainThread](2024-04-22 22:58:27,823) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 22:58:27,823) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:58:30,421) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:58:30,611) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992372
[2211374:MainThread](2024-04-22 22:58:30,611) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 22:58:30,611) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:58:33,202) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:58:33,393) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992237
[2211374:MainThread](2024-04-22 22:58:33,393) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 22:58:33,394) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:58:35,994) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:58:36,185) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992844
[2211374:MainThread](2024-04-22 22:58:36,185) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-22 22:58:36,185) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:58:38,803) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:58:38,995) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992791
[2211374:MainThread](2024-04-22 22:58:38,996) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 22:58:38,996) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990673 @ 18
[2211374:MainThread](2024-04-22 22:58:39,045) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-02-28 SH600000   -0.111711
           SH600008   -0.024961
           SH600009    0.047394
           SH600010   -0.080368
           SH600011   -0.079914
[2211374:MainThread](2024-04-22 22:58:40,738) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  34%|███▍      | 15/44 [18:46<40:46, 84.35s/it][2211374:MainThread](2024-04-22 22:58:40,746) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 22:58:40,755) INFO - qlib.workflow - [recorder.py:341] - Recorder d0d05869a5d74f6eb58516cb0ae25863 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 22:58:41,225) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 22:58:41,226) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 22:58:41,228) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 22:58:41,229) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 22:58:48,930) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.802728
            SH600004      0.802728
            SH600006      0.802728
            SH600007      0.802728
            SH600008      0.802728
                            ...   
2016-05-13  SZ300124      0.810076
            SZ300133      0.810076
            SZ300144      0.810076
            SZ300146      0.810076
            SZ300315      0.810076
Length: 561275, dtype: float64
[2211374:MainThread](2024-04-22 22:58:48,932) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 22:58:48,932) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 22:58:48,933) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:58:51,591) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:58:51,819) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995833
[2211374:MainThread](2024-04-22 22:58:51,820) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 22:58:51,820) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:58:54,435) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:58:54,664) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995441
[2211374:MainThread](2024-04-22 22:58:54,665) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 22:58:54,665) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:58:57,224) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:58:57,448) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994142
[2211374:MainThread](2024-04-22 22:58:57,449) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 22:58:57,449) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:00,021) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:00,246) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994891
[2211374:MainThread](2024-04-22 22:59:00,246) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 22:59:00,247) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:02,869) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:03,094) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994039
[2211374:MainThread](2024-04-22 22:59:03,095) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 22:59:03,095) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:05,704) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:05,930) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994050
[2211374:MainThread](2024-04-22 22:59:05,930) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 22:59:05,930) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:08,548) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:08,773) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993310
[2211374:MainThread](2024-04-22 22:59:08,774) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 22:59:08,775) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:11,380) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:11,606) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992927
[2211374:MainThread](2024-04-22 22:59:11,607) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 22:59:11,607) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:14,218) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:14,449) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992501
[2211374:MainThread](2024-04-22 22:59:14,450) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 22:59:14,451) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:17,120) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:17,344) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993147
[2211374:MainThread](2024-04-22 22:59:17,344) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 22:59:17,345) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:20,011) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:20,235) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992781
[2211374:MainThread](2024-04-22 22:59:20,236) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 22:59:20,236) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:22,902) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:23,126) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992336
[2211374:MainThread](2024-04-22 22:59:23,127) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 22:59:23,127) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:25,816) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:26,044) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992229
[2211374:MainThread](2024-04-22 22:59:26,045) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 22:59:26,045) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:28,748) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:28,973) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992665
[2211374:MainThread](2024-04-22 22:59:28,973) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 22:59:28,973) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:31,645) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:31,869) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992346
[2211374:MainThread](2024-04-22 22:59:31,869) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 22:59:31,870) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:34,535) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:34,760) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991690
[2211374:MainThread](2024-04-22 22:59:34,761) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 22:59:34,761) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:37,460) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:37,686) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991638
[2211374:MainThread](2024-04-22 22:59:37,687) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 22:59:37,687) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:40,358) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:40,583) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991584
[2211374:MainThread](2024-04-22 22:59:40,584) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 22:59:40,584) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:43,239) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:43,464) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991270
[2211374:MainThread](2024-04-22 22:59:43,465) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 22:59:43,466) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:46,106) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:46,331) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991584
[2211374:MainThread](2024-04-22 22:59:46,331) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 22:59:46,331) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:49,006) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:49,232) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992479
[2211374:MainThread](2024-04-22 22:59:49,233) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 22:59:49,233) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:51,923) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:52,151) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992227
[2211374:MainThread](2024-04-22 22:59:52,151) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 22:59:52,152) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:54,847) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:55,075) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992539
[2211374:MainThread](2024-04-22 22:59:55,076) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 22:59:55,076) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 22:59:57,767) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 22:59:57,996) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992910
[2211374:MainThread](2024-04-22 22:59:57,996) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 22:59:57,996) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:00:00,687) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:00:00,915) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992018
[2211374:MainThread](2024-04-22 23:00:00,916) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 23:00:00,916) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:00:03,624) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:00:03,855) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992122
[2211374:MainThread](2024-04-22 23:00:03,855) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-22 23:00:03,855) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:00:06,546) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:00:06,772) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992249
[2211374:MainThread](2024-04-22 23:00:06,772) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:00:06,773) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991270 @ 18
[2211374:MainThread](2024-04-22 23:00:06,821) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-03-28 SH600000   -0.086063
           SH600008   -0.167953
           SH600009    0.078261
           SH600010    0.106598
           SH600011   -0.167344
[2211374:MainThread](2024-04-22 23:00:08,489) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  36%|███▋      | 16/44 [20:14<39:50, 85.38s/it][2211374:MainThread](2024-04-22 23:00:08,497) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:00:08,506) INFO - qlib.workflow - [recorder.py:341] - Recorder 64cbe886318e410388391b0d2b70d293 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:00:08,976) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:00:08,977) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:00:08,981) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:00:08,981) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:00:16,645) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.773869
            SH600004      0.773869
            SH600006      0.773869
            SH600007      0.773869
            SH600008      0.773869
                            ...   
2016-06-14  SZ300133      1.552051
            SZ300144      1.552051
            SZ300146      1.552051
            SZ300251      1.552051
            SZ300315      1.552051
Length: 566995, dtype: float64
[2211374:MainThread](2024-04-22 23:00:16,648) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:00:16,648) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:00:16,648) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:00:19,349) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:00:19,579) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995623
[2211374:MainThread](2024-04-22 23:00:19,580) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:00:19,580) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:00:22,236) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:00:22,465) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994804
[2211374:MainThread](2024-04-22 23:00:22,466) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:00:22,466) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:00:25,147) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:00:25,373) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994376
[2211374:MainThread](2024-04-22 23:00:25,374) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:00:25,374) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:00:28,023) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:00:28,251) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993929
[2211374:MainThread](2024-04-22 23:00:28,253) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:00:28,253) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:00:30,944) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:00:31,169) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993188
[2211374:MainThread](2024-04-22 23:00:31,170) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:00:31,171) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:00:33,852) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:00:34,079) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992731
[2211374:MainThread](2024-04-22 23:00:34,080) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:00:34,080) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:00:36,792) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:00:37,018) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992434
[2211374:MainThread](2024-04-22 23:00:37,019) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:00:37,020) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:00:39,699) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:00:39,925) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992496
[2211374:MainThread](2024-04-22 23:00:39,926) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:00:39,926) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:00:42,617) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:00:42,841) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992500
[2211374:MainThread](2024-04-22 23:00:42,842) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:00:42,842) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:00:45,553) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:00:45,780) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992704
[2211374:MainThread](2024-04-22 23:00:45,780) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:00:45,780) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:00:48,473) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:00:48,698) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991893
[2211374:MainThread](2024-04-22 23:00:48,699) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:00:48,699) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:00:51,422) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:00:51,648) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991230
[2211374:MainThread](2024-04-22 23:00:51,649) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:00:51,650) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:00:54,338) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:00:54,563) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991270
[2211374:MainThread](2024-04-22 23:00:54,564) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:00:54,564) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:00:57,272) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:00:57,499) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991336
[2211374:MainThread](2024-04-22 23:00:57,499) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:00:57,499) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:01:00,212) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:01:00,440) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991096
[2211374:MainThread](2024-04-22 23:01:00,441) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:01:00,441) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:01:03,169) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:01:03,397) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991452
[2211374:MainThread](2024-04-22 23:01:03,397) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:01:03,398) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:01:06,113) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:01:06,340) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991139
[2211374:MainThread](2024-04-22 23:01:06,341) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:01:06,341) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:01:09,057) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:01:09,283) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991749
[2211374:MainThread](2024-04-22 23:01:09,284) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:01:09,284) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:01:12,014) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:01:12,240) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990747
[2211374:MainThread](2024-04-22 23:01:12,242) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:01:12,242) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:01:14,935) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:01:15,162) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991269
[2211374:MainThread](2024-04-22 23:01:15,163) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:01:15,163) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:01:17,871) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:01:18,102) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991263
[2211374:MainThread](2024-04-22 23:01:18,102) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:01:18,102) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:01:20,770) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:01:20,997) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991354
[2211374:MainThread](2024-04-22 23:01:20,997) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 23:01:20,997) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:01:23,685) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:01:23,914) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991724
[2211374:MainThread](2024-04-22 23:01:23,914) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 23:01:23,914) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:01:26,594) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:01:26,823) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991674
[2211374:MainThread](2024-04-22 23:01:26,824) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 23:01:26,824) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:01:29,488) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:01:29,717) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991941
[2211374:MainThread](2024-04-22 23:01:29,718) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 23:01:29,718) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:01:32,372) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:01:32,601) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992167
[2211374:MainThread](2024-04-22 23:01:32,602) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-22 23:01:32,602) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:01:35,262) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:01:35,492) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993108
[2211374:MainThread](2024-04-22 23:01:35,492) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:01:35,492) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990747 @ 18
[2211374:MainThread](2024-04-22 23:01:35,543) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-04-27 SH600000   -0.000395
           SH600008   -0.019765
           SH600009    0.070808
           SH600010   -0.088761
           SH600011   -0.092733
[2211374:MainThread](2024-04-22 23:01:37,221) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  39%|███▊      | 17/44 [21:43<38:52, 86.38s/it][2211374:MainThread](2024-04-22 23:01:37,228) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:01:37,237) INFO - qlib.workflow - [recorder.py:341] - Recorder c7263f731c0e4ce79de6005be5ad58d9 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:01:37,713) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:01:37,714) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:01:37,716) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:01:37,717) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:01:45,375) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.117558
            SH600004      1.117558
            SH600006      1.117558
            SH600007      1.117558
            SH600008      1.117558
                            ...   
2016-07-12  SZ300144      1.724638
            SZ300146      1.724638
            SZ300168      1.724638
            SZ300251      1.724638
            SZ300315      1.724638
Length: 572790, dtype: float64
[2211374:MainThread](2024-04-22 23:01:45,377) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:01:45,378) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:01:45,378) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:01:48,089) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:01:48,314) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995388
[2211374:MainThread](2024-04-22 23:01:48,315) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:01:48,315) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:01:51,031) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:01:51,256) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994578
[2211374:MainThread](2024-04-22 23:01:51,257) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:01:51,258) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:01:53,968) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:01:54,192) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993609
[2211374:MainThread](2024-04-22 23:01:54,193) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:01:54,194) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:01:56,886) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:01:57,110) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993249
[2211374:MainThread](2024-04-22 23:01:57,111) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:01:57,111) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:01:59,809) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:02:00,034) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994082
[2211374:MainThread](2024-04-22 23:02:00,035) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:02:00,035) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:02:02,758) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:02:02,987) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994185
[2211374:MainThread](2024-04-22 23:02:02,987) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:02:02,987) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:02:05,727) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:02:05,952) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992446
[2211374:MainThread](2024-04-22 23:02:05,953) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:02:05,954) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:02:08,678) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:02:08,904) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992519
[2211374:MainThread](2024-04-22 23:02:08,904) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:02:08,905) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:02:11,634) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:02:11,859) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991546
[2211374:MainThread](2024-04-22 23:02:11,860) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:02:11,861) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:02:14,600) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:02:14,828) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992105
[2211374:MainThread](2024-04-22 23:02:14,829) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:02:14,829) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:02:17,559) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:02:17,787) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991239
[2211374:MainThread](2024-04-22 23:02:17,788) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:02:17,788) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:02:20,505) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:02:20,733) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992472
[2211374:MainThread](2024-04-22 23:02:20,733) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:02:20,734) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:02:23,404) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:02:23,633) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991491
[2211374:MainThread](2024-04-22 23:02:23,633) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:02:23,634) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:02:26,261) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:02:26,487) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991773
[2211374:MainThread](2024-04-22 23:02:26,487) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:02:26,487) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:02:29,143) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:02:29,371) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991419
[2211374:MainThread](2024-04-22 23:02:29,371) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:02:29,372) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:02:32,043) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:02:32,268) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991479
[2211374:MainThread](2024-04-22 23:02:32,268) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:02:32,268) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:02:34,940) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:02:35,168) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991376
[2211374:MainThread](2024-04-22 23:02:35,169) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:02:35,169) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:02:37,820) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:02:38,045) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992091
[2211374:MainThread](2024-04-22 23:02:38,046) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:02:38,046) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:02:40,702) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:02:40,927) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992464
[2211374:MainThread](2024-04-22 23:02:40,928) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:02:40,928) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991239 @ 10
[2211374:MainThread](2024-04-22 23:02:40,977) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-05-29 SH600000   -0.028563
           SH600008    0.008144
           SH600009   -0.013629
           SH600010   -0.001231
           SH600011   -0.088620
[2211374:MainThread](2024-04-22 23:02:42,638) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  41%|████      | 18/44 [22:48<34:42, 80.08s/it][2211374:MainThread](2024-04-22 23:02:42,646) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:02:42,655) INFO - qlib.workflow - [recorder.py:341] - Recorder 2baacc4a09974634a642911909299bea starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:02:43,111) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:02:43,112) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:02:43,115) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:02:43,115) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:02:50,683) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.959205
            SH600004      0.959205
            SH600006      0.959205
            SH600007      0.959205
            SH600008      0.959205
                            ...   
2016-08-09  SZ300144      1.894663
            SZ300146      1.894663
            SZ300168      1.894663
            SZ300251      1.894663
            SZ300315      1.894663
Length: 578598, dtype: float64
[2211374:MainThread](2024-04-22 23:02:50,685) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:02:50,685) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:02:50,686) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:02:53,395) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:02:53,597) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995724
[2211374:MainThread](2024-04-22 23:02:53,598) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:02:53,599) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:02:56,282) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:02:56,483) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994664
[2211374:MainThread](2024-04-22 23:02:56,484) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:02:56,484) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:02:59,170) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:02:59,371) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994105
[2211374:MainThread](2024-04-22 23:02:59,372) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:02:59,372) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:03:02,067) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:03:02,268) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993003
[2211374:MainThread](2024-04-22 23:03:02,268) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:03:02,269) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:03:04,959) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:03:05,160) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992926
[2211374:MainThread](2024-04-22 23:03:05,161) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:03:05,161) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:03:07,851) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:03:08,052) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992956
[2211374:MainThread](2024-04-22 23:03:08,052) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:03:08,052) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:03:10,733) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:03:10,934) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992481
[2211374:MainThread](2024-04-22 23:03:10,935) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:03:10,935) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:03:13,628) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:03:13,830) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992600
[2211374:MainThread](2024-04-22 23:03:13,830) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:03:13,831) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:03:16,530) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:03:16,731) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992439
[2211374:MainThread](2024-04-22 23:03:16,732) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:03:16,732) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:03:19,419) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:03:19,620) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992952
[2211374:MainThread](2024-04-22 23:03:19,621) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:03:19,621) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:03:22,314) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:03:22,515) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992981
[2211374:MainThread](2024-04-22 23:03:22,515) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:03:22,516) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:03:25,196) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:03:25,397) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991376
[2211374:MainThread](2024-04-22 23:03:25,398) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:03:25,399) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:03:28,103) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:03:28,304) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991733
[2211374:MainThread](2024-04-22 23:03:28,304) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:03:28,305) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:03:31,020) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:03:31,223) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991448
[2211374:MainThread](2024-04-22 23:03:31,224) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:03:31,224) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:03:33,913) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:03:34,114) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993397
[2211374:MainThread](2024-04-22 23:03:34,114) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:03:34,115) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:03:36,819) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:03:37,022) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991804
[2211374:MainThread](2024-04-22 23:03:37,022) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:03:37,023) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:03:39,716) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:03:39,918) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993257
[2211374:MainThread](2024-04-22 23:03:39,919) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:03:39,919) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:03:42,624) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:03:42,828) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991645
[2211374:MainThread](2024-04-22 23:03:42,828) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:03:42,829) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:03:45,521) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:03:45,723) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993239
[2211374:MainThread](2024-04-22 23:03:45,723) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:03:45,724) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:03:48,425) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:03:48,627) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992243
[2211374:MainThread](2024-04-22 23:03:48,627) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:03:48,628) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991376 @ 11
[2211374:MainThread](2024-04-22 23:03:48,676) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-06-27 SH600000    0.006810
           SH600008   -0.043368
           SH600009    0.111649
           SH600010    0.066069
           SH600011   -0.075290
[2211374:MainThread](2024-04-22 23:03:50,337) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  43%|████▎     | 19/44 [23:56<31:49, 76.36s/it][2211374:MainThread](2024-04-22 23:03:50,344) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:03:50,353) INFO - qlib.workflow - [recorder.py:341] - Recorder d8067c9af7d24c75b9859f98138f068b starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:03:50,834) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:03:50,835) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:03:50,837) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:03:50,838) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:03:58,408) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.741250
            SH600004      0.741250
            SH600006      0.741250
            SH600007      0.741250
            SH600008      0.741250
                            ...   
2016-09-06  SZ300144      1.278686
            SZ300146      1.278686
            SZ300168      1.278686
            SZ300251      1.278686
            SZ300315      1.278686
Length: 584401, dtype: float64
[2211374:MainThread](2024-04-22 23:03:58,411) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:03:58,411) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:03:58,411) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:01,127) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:01,353) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996589
[2211374:MainThread](2024-04-22 23:04:01,354) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:04:01,354) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:04,085) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:04,310) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995622
[2211374:MainThread](2024-04-22 23:04:04,311) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:04:04,312) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:07,024) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:07,250) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994254
[2211374:MainThread](2024-04-22 23:04:07,251) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:04:07,251) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:09,983) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:10,210) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993248
[2211374:MainThread](2024-04-22 23:04:10,211) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:04:10,211) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:12,909) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:13,136) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993048
[2211374:MainThread](2024-04-22 23:04:13,137) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:04:13,137) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:15,858) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:16,084) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992256
[2211374:MainThread](2024-04-22 23:04:16,085) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:04:16,086) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:18,787) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:19,014) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992134
[2211374:MainThread](2024-04-22 23:04:19,015) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:04:19,015) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:21,718) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:21,945) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991912
[2211374:MainThread](2024-04-22 23:04:21,946) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:04:21,946) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:24,662) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:24,889) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992611
[2211374:MainThread](2024-04-22 23:04:24,889) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:04:24,889) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:27,593) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:27,820) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991739
[2211374:MainThread](2024-04-22 23:04:27,821) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:04:27,821) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:30,538) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:30,764) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991606
[2211374:MainThread](2024-04-22 23:04:30,765) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:04:30,765) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:33,479) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:33,706) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991135
[2211374:MainThread](2024-04-22 23:04:33,707) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:04:33,707) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:36,419) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:36,646) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991832
[2211374:MainThread](2024-04-22 23:04:36,647) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:04:36,647) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:39,347) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:39,575) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991356
[2211374:MainThread](2024-04-22 23:04:39,575) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:04:39,575) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:42,270) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:42,497) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991400
[2211374:MainThread](2024-04-22 23:04:42,498) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:04:42,498) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:45,205) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:45,433) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991045
[2211374:MainThread](2024-04-22 23:04:45,434) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:04:45,434) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:48,131) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:48,359) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991303
[2211374:MainThread](2024-04-22 23:04:48,359) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:04:48,359) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:51,067) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:51,294) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990588
[2211374:MainThread](2024-04-22 23:04:51,295) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:04:51,296) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:53,992) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:54,220) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991124
[2211374:MainThread](2024-04-22 23:04:54,220) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:04:54,221) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:56,932) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:04:57,159) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990962
[2211374:MainThread](2024-04-22 23:04:57,159) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:04:57,159) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:04:59,863) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:05:00,089) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991405
[2211374:MainThread](2024-04-22 23:05:00,090) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:05:00,090) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:05:02,790) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:05:03,017) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990524
[2211374:MainThread](2024-04-22 23:05:03,018) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 23:05:03,019) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:05:05,669) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:05:05,896) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991583
[2211374:MainThread](2024-04-22 23:05:05,897) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 23:05:05,897) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:05:08,600) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:05:08,826) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992168
[2211374:MainThread](2024-04-22 23:05:08,827) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 23:05:08,827) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:05:11,539) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:05:11,766) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991336
[2211374:MainThread](2024-04-22 23:05:11,767) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 23:05:11,767) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:05:14,467) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:05:14,694) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991963
[2211374:MainThread](2024-04-22 23:05:14,694) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-22 23:05:14,695) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:05:17,404) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:05:17,630) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991517
[2211374:MainThread](2024-04-22 23:05:17,631) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[2211374:MainThread](2024-04-22 23:05:17,631) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:05:20,335) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:05:20,562) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991882
[2211374:MainThread](2024-04-22 23:05:20,562) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[2211374:MainThread](2024-04-22 23:05:20,562) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:05:23,266) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:05:23,493) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991563
[2211374:MainThread](2024-04-22 23:05:23,493) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[2211374:MainThread](2024-04-22 23:05:23,494) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:05:26,203) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:05:26,429) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991032
[2211374:MainThread](2024-04-22 23:05:26,430) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:05:26,430) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990524 @ 21
[2211374:MainThread](2024-04-22 23:05:26,478) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-07-25 SH600000    0.022101
           SH600008    0.033086
           SH600009   -0.050515
           SH600010   -0.108080
           SH600011   -0.130593
[2211374:MainThread](2024-04-22 23:05:28,139) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  45%|████▌     | 20/44 [25:34<33:07, 82.80s/it][2211374:MainThread](2024-04-22 23:05:28,146) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:05:28,156) INFO - qlib.workflow - [recorder.py:341] - Recorder 289c581fd58e466680543c37912cb1e9 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:05:28,623) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:05:28,624) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:05:28,627) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:05:28,628) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:05:36,208) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.364260
            SH600004      1.364260
            SH600006      1.364260
            SH600007      1.364260
            SH600008      1.364260
                            ...   
2016-10-13  SZ300144      0.704851
            SZ300146      0.704851
            SZ300168      0.704851
            SZ300251      0.704851
            SZ300315      0.704851
Length: 590146, dtype: float64
[2211374:MainThread](2024-04-22 23:05:36,210) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:05:36,211) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:05:36,211) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:05:38,953) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:05:39,156) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995247
[2211374:MainThread](2024-04-22 23:05:39,158) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:05:39,158) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:05:41,845) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:05:42,048) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994769
[2211374:MainThread](2024-04-22 23:05:42,049) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:05:42,050) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:05:44,746) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:05:44,950) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993817
[2211374:MainThread](2024-04-22 23:05:44,951) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:05:44,951) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:05:47,638) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:05:47,842) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993841
[2211374:MainThread](2024-04-22 23:05:47,842) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:05:47,842) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:05:50,532) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:05:50,736) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993068
[2211374:MainThread](2024-04-22 23:05:50,737) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:05:50,737) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:05:53,435) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:05:53,639) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992339
[2211374:MainThread](2024-04-22 23:05:53,640) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:05:53,640) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:05:56,328) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:05:56,532) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992795
[2211374:MainThread](2024-04-22 23:05:56,533) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:05:56,533) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:05:59,283) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:05:59,488) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992326
[2211374:MainThread](2024-04-22 23:05:59,489) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:05:59,489) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:06:02,319) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:06:02,524) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991106
[2211374:MainThread](2024-04-22 23:06:02,525) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:06:02,526) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:06:05,347) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:06:05,552) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991170
[2211374:MainThread](2024-04-22 23:06:05,552) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:06:05,552) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:06:08,365) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:06:08,568) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992411
[2211374:MainThread](2024-04-22 23:06:08,569) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:06:08,569) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:06:11,383) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:06:11,591) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991194
[2211374:MainThread](2024-04-22 23:06:11,591) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:06:11,592) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:06:14,410) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:06:14,614) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990605
[2211374:MainThread](2024-04-22 23:06:14,615) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:06:14,615) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:06:17,419) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:06:17,623) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990381
[2211374:MainThread](2024-04-22 23:06:17,624) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:06:17,624) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:06:20,454) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:06:20,657) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990943
[2211374:MainThread](2024-04-22 23:06:20,658) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:06:20,658) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:06:23,480) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:06:23,684) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990862
[2211374:MainThread](2024-04-22 23:06:23,685) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:06:23,685) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:06:26,506) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:06:26,709) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990465
[2211374:MainThread](2024-04-22 23:06:26,710) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:06:26,710) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:06:29,543) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:06:29,748) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990861
[2211374:MainThread](2024-04-22 23:06:29,749) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:06:29,749) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:06:32,593) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:06:32,796) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991468
[2211374:MainThread](2024-04-22 23:06:32,796) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:06:32,797) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:06:35,612) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:06:35,815) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991498
[2211374:MainThread](2024-04-22 23:06:35,815) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:06:35,816) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:06:38,583) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:06:38,789) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991703
[2211374:MainThread](2024-04-22 23:06:38,790) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:06:38,790) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:06:41,554) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:06:41,758) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991124
[2211374:MainThread](2024-04-22 23:06:41,758) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:06:41,758) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990381 @ 13
[2211374:MainThread](2024-04-22 23:06:41,808) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-08-22 SH600000    0.003560
           SH600008   -0.115608
           SH600009    0.123648
           SH600010   -0.082851
           SH600011   -0.038377
[2211374:MainThread](2024-04-22 23:06:43,468) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  48%|████▊     | 21/44 [26:49<30:52, 80.56s/it][2211374:MainThread](2024-04-22 23:06:43,475) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:06:43,484) INFO - qlib.workflow - [recorder.py:341] - Recorder a03b14cbca4542c2bd4f6f41a84422c5 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:06:43,945) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:06:43,946) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:06:43,948) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:06:43,949) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:06:51,533) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.262473
            SH600004      1.262473
            SH600006      1.262473
            SH600007      1.262473
            SH600008      1.262473
                            ...   
2016-11-10  SZ300144      1.076953
            SZ300146      1.076953
            SZ300168      1.076953
            SZ300251      1.076953
            SZ300315      1.076953
Length: 595946, dtype: float64
[2211374:MainThread](2024-04-22 23:06:51,536) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:06:51,536) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:06:51,536) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:06:54,335) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:06:54,555) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994960
[2211374:MainThread](2024-04-22 23:06:54,556) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:06:54,556) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:06:57,336) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:06:57,557) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994204
[2211374:MainThread](2024-04-22 23:06:57,558) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:06:57,558) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:07:00,350) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:07:00,571) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993545
[2211374:MainThread](2024-04-22 23:07:00,572) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:07:00,572) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:07:03,350) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:07:03,571) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992261
[2211374:MainThread](2024-04-22 23:07:03,572) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:07:03,572) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:07:06,355) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:07:06,577) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992640
[2211374:MainThread](2024-04-22 23:07:06,578) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:07:06,578) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:07:09,351) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:07:09,572) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991917
[2211374:MainThread](2024-04-22 23:07:09,573) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:07:09,573) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:07:12,345) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:07:12,566) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991784
[2211374:MainThread](2024-04-22 23:07:12,567) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:07:12,568) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:07:15,414) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:07:15,635) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991691
[2211374:MainThread](2024-04-22 23:07:15,636) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:07:15,636) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:07:18,466) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:07:18,687) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991253
[2211374:MainThread](2024-04-22 23:07:18,687) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:07:18,688) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:07:21,528) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:07:21,749) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991344
[2211374:MainThread](2024-04-22 23:07:21,749) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:07:21,749) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:07:24,584) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:07:24,805) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990431
[2211374:MainThread](2024-04-22 23:07:24,806) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:07:24,806) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:07:27,648) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:07:27,868) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990008
[2211374:MainThread](2024-04-22 23:07:27,869) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:07:27,869) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:07:30,677) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:07:30,898) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990528
[2211374:MainThread](2024-04-22 23:07:30,898) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:07:30,899) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:07:33,697) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:07:33,922) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990219
[2211374:MainThread](2024-04-22 23:07:33,923) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:07:33,923) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:07:36,763) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:07:36,988) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990649
[2211374:MainThread](2024-04-22 23:07:36,988) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:07:36,988) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:07:39,856) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:07:40,080) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990664
[2211374:MainThread](2024-04-22 23:07:40,080) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:07:40,080) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:07:42,953) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:07:43,178) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990067
[2211374:MainThread](2024-04-22 23:07:43,178) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:07:43,178) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:07:46,022) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:07:46,247) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990909
[2211374:MainThread](2024-04-22 23:07:46,247) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:07:46,248) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:07:49,067) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:07:49,292) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991483
[2211374:MainThread](2024-04-22 23:07:49,293) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:07:49,293) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:07:52,101) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:07:52,326) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991022
[2211374:MainThread](2024-04-22 23:07:52,326) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:07:52,327) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990008 @ 11
[2211374:MainThread](2024-04-22 23:07:52,376) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-09-19 SH600000   -0.002071
           SH600008    0.009236
           SH600009   -0.010587
           SH600010   -0.011669
           SH600011    0.021649
[2211374:MainThread](2024-04-22 23:07:54,063) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  50%|█████     | 22/44 [28:00<28:26, 77.57s/it][2211374:MainThread](2024-04-22 23:07:54,070) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:07:54,080) INFO - qlib.workflow - [recorder.py:341] - Recorder 38b2d634b9e04ec4a737913d00cd5167 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:07:54,559) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:07:54,560) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:07:54,564) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:07:54,564) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:08:02,266) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.958155
            SH600004      0.958155
            SH600006      0.958155
            SH600007      0.958155
            SH600008      0.958155
                            ...   
2016-12-08  SZ300144      1.834291
            SZ300146      1.834291
            SZ300168      1.834291
            SZ300251      1.834291
            SZ300315      1.834291
Length: 601711, dtype: float64
[2211374:MainThread](2024-04-22 23:08:02,268) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:08:02,268) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:08:02,268) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:08:05,082) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:08:05,305) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995663
[2211374:MainThread](2024-04-22 23:08:05,306) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:08:05,306) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:08:08,157) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:08:08,378) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994837
[2211374:MainThread](2024-04-22 23:08:08,379) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:08:08,380) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:08:11,245) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:08:11,467) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993544
[2211374:MainThread](2024-04-22 23:08:11,468) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:08:11,469) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:08:14,322) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:08:14,545) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993819
[2211374:MainThread](2024-04-22 23:08:14,546) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:08:14,546) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:08:17,418) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:08:17,641) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993414
[2211374:MainThread](2024-04-22 23:08:17,642) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:08:17,642) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:08:20,493) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:08:20,715) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992604
[2211374:MainThread](2024-04-22 23:08:20,716) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:08:20,716) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:08:23,575) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:08:23,799) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992439
[2211374:MainThread](2024-04-22 23:08:23,800) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:08:23,800) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:08:26,670) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:08:26,892) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992023
[2211374:MainThread](2024-04-22 23:08:26,893) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:08:26,894) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:08:29,763) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:08:29,989) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991407
[2211374:MainThread](2024-04-22 23:08:29,990) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:08:29,990) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:08:32,839) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:08:33,062) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991356
[2211374:MainThread](2024-04-22 23:08:33,063) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:08:33,063) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:08:35,923) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:08:36,146) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992824
[2211374:MainThread](2024-04-22 23:08:36,146) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:08:36,147) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:08:39,003) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:08:39,226) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991643
[2211374:MainThread](2024-04-22 23:08:39,227) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:08:39,227) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:08:42,037) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:08:42,261) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991852
[2211374:MainThread](2024-04-22 23:08:42,261) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:08:42,261) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:08:45,059) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:08:45,282) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990470
[2211374:MainThread](2024-04-22 23:08:45,283) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:08:45,284) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:08:48,078) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:08:48,301) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990927
[2211374:MainThread](2024-04-22 23:08:48,302) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:08:48,302) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:08:51,117) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:08:51,341) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991097
[2211374:MainThread](2024-04-22 23:08:51,341) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:08:51,341) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:08:54,135) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:08:54,359) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990913
[2211374:MainThread](2024-04-22 23:08:54,359) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:08:54,359) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:08:57,172) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:08:57,396) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990884
[2211374:MainThread](2024-04-22 23:08:57,396) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:08:57,397) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:09:00,192) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:09:00,416) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990954
[2211374:MainThread](2024-04-22 23:09:00,416) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:09:00,416) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:09:03,224) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:09:03,450) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990300
[2211374:MainThread](2024-04-22 23:09:03,451) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:09:03,452) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:09:06,260) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:09:06,484) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990718
[2211374:MainThread](2024-04-22 23:09:06,484) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:09:06,485) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:09:09,283) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:09:09,515) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990188
[2211374:MainThread](2024-04-22 23:09:09,516) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 23:09:09,516) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:09:12,340) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:09:12,566) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991269
[2211374:MainThread](2024-04-22 23:09:12,567) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 23:09:12,567) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:09:15,394) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:09:15,620) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990957
[2211374:MainThread](2024-04-22 23:09:15,621) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 23:09:15,621) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:09:18,459) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:09:18,686) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990554
[2211374:MainThread](2024-04-22 23:09:18,686) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 23:09:18,687) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:09:21,514) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:09:21,738) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991909
[2211374:MainThread](2024-04-22 23:09:21,738) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-22 23:09:21,739) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:09:24,558) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:09:24,782) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991790
[2211374:MainThread](2024-04-22 23:09:24,782) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[2211374:MainThread](2024-04-22 23:09:24,783) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:09:27,592) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:09:27,816) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991214
[2211374:MainThread](2024-04-22 23:09:27,816) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[2211374:MainThread](2024-04-22 23:09:27,817) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:09:30,630) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:09:30,854) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991061
[2211374:MainThread](2024-04-22 23:09:30,854) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[2211374:MainThread](2024-04-22 23:09:30,855) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:09:33,658) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:09:33,882) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992050
[2211374:MainThread](2024-04-22 23:09:33,883) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:09:33,883) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990188 @ 21
[2211374:MainThread](2024-04-22 23:09:33,932) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-10-25 SH600000   -0.151151
           SH600008   -0.068950
           SH600009   -0.486053
           SH600010   -0.004437
           SH600011   -0.130956
[2211374:MainThread](2024-04-22 23:09:35,614) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  52%|█████▏    | 23/44 [29:41<29:40, 84.77s/it][2211374:MainThread](2024-04-22 23:09:35,622) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:09:35,631) INFO - qlib.workflow - [recorder.py:341] - Recorder 96c176e155f14c899fde11fb1ee61103 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:09:36,086) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:09:36,086) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:09:36,089) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:09:36,089) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:09:43,782) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.762962
            SH600004      1.762962
            SH600006      1.762962
            SH600007      1.762962
            SH600008      1.762962
                            ...   
2017-01-06  SZ300146      1.662915
            SZ300168      1.662915
            SZ300182      1.662915
            SZ300251      1.662915
            SZ300315      1.662915
Length: 607469, dtype: float64
[2211374:MainThread](2024-04-22 23:09:43,785) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:09:43,785) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:09:43,785) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:09:46,613) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:09:46,838) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996723
[2211374:MainThread](2024-04-22 23:09:46,839) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:09:46,839) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:09:49,649) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:09:49,874) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994832
[2211374:MainThread](2024-04-22 23:09:49,875) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:09:49,875) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:09:52,699) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:09:52,923) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993556
[2211374:MainThread](2024-04-22 23:09:52,924) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:09:52,925) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:09:55,738) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:09:55,962) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993329
[2211374:MainThread](2024-04-22 23:09:55,963) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:09:55,964) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:09:58,785) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:09:59,010) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992361
[2211374:MainThread](2024-04-22 23:09:59,011) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:09:59,011) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:10:01,830) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:10:02,057) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992543
[2211374:MainThread](2024-04-22 23:10:02,058) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:10:02,058) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:10:04,926) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:10:05,150) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991809
[2211374:MainThread](2024-04-22 23:10:05,151) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:10:05,151) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:10:07,980) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:10:08,208) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992612
[2211374:MainThread](2024-04-22 23:10:08,208) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:10:08,209) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:10:11,056) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:10:11,285) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990818
[2211374:MainThread](2024-04-22 23:10:11,286) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:10:11,286) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:10:14,117) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:10:14,346) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991255
[2211374:MainThread](2024-04-22 23:10:14,346) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:10:14,346) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:10:17,159) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:10:17,388) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991597
[2211374:MainThread](2024-04-22 23:10:17,388) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:10:17,388) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:10:20,211) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:10:20,436) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990236
[2211374:MainThread](2024-04-22 23:10:20,437) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:10:20,437) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:10:23,255) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:10:23,480) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.989864
[2211374:MainThread](2024-04-22 23:10:23,481) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:10:23,481) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:10:26,307) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:10:26,532) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991034
[2211374:MainThread](2024-04-22 23:10:26,532) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:10:26,533) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:10:29,407) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:10:29,631) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991919
[2211374:MainThread](2024-04-22 23:10:29,631) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:10:29,632) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:10:32,438) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:10:32,664) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991205
[2211374:MainThread](2024-04-22 23:10:32,664) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:10:32,664) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:10:35,419) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:10:35,645) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.989984
[2211374:MainThread](2024-04-22 23:10:35,646) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:10:35,646) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:10:38,464) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:10:38,691) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990532
[2211374:MainThread](2024-04-22 23:10:38,692) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:10:38,692) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:10:41,504) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:10:41,730) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990601
[2211374:MainThread](2024-04-22 23:10:41,730) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:10:41,730) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:10:44,541) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:10:44,766) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991022
[2211374:MainThread](2024-04-22 23:10:44,766) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:10:44,767) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:10:47,579) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:10:47,805) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990854
[2211374:MainThread](2024-04-22 23:10:47,805) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:10:47,806) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.989864 @ 12
[2211374:MainThread](2024-04-22 23:10:47,855) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-11-22 SH600000    0.004887
           SH600008   -0.120835
           SH600009   -0.108081
           SH600010    0.048128
           SH600011    0.036912
[2211374:MainThread](2024-04-22 23:10:49,516) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  55%|█████▍    | 24/44 [30:55<27:10, 81.51s/it][2211374:MainThread](2024-04-22 23:10:49,523) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:10:49,532) INFO - qlib.workflow - [recorder.py:341] - Recorder b6a91210c4ee465bae7d633802150352 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:10:49,990) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:10:49,990) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:10:49,993) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:10:49,993) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:10:57,582) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.523406
            SH600004      1.523406
            SH600006      1.523406
            SH600007      1.523406
            SH600008      1.523406
                            ...   
2017-02-10  SZ300144      1.762726
            SZ300146      1.762726
            SZ300168      1.762726
            SZ300182      1.762726
            SZ300251      1.762726
Length: 613211, dtype: float64
[2211374:MainThread](2024-04-22 23:10:57,609) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:10:57,610) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:10:57,610) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:00,473) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:00,701) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995587
[2211374:MainThread](2024-04-22 23:11:00,702) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:11:00,702) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:03,540) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:03,768) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994136
[2211374:MainThread](2024-04-22 23:11:03,769) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:11:03,769) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:06,632) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:06,859) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993175
[2211374:MainThread](2024-04-22 23:11:06,860) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:11:06,861) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:09,721) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:09,952) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993040
[2211374:MainThread](2024-04-22 23:11:09,953) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:11:09,953) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:12,864) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:13,095) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992310
[2211374:MainThread](2024-04-22 23:11:13,096) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:11:13,096) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:15,975) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:16,205) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994010
[2211374:MainThread](2024-04-22 23:11:16,206) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:11:16,206) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:19,090) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:19,321) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992197
[2211374:MainThread](2024-04-22 23:11:19,322) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:11:19,322) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:22,199) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:22,430) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992205
[2211374:MainThread](2024-04-22 23:11:22,430) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:11:22,430) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:25,300) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:25,528) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992225
[2211374:MainThread](2024-04-22 23:11:25,528) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:11:25,528) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:28,382) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:28,610) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992247
[2211374:MainThread](2024-04-22 23:11:28,610) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:11:28,610) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:31,453) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:31,681) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991782
[2211374:MainThread](2024-04-22 23:11:31,682) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:11:31,682) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:34,560) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:34,790) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992525
[2211374:MainThread](2024-04-22 23:11:34,791) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:11:34,791) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:37,651) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:37,879) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992233
[2211374:MainThread](2024-04-22 23:11:37,879) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:11:37,879) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:40,756) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:40,987) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991610
[2211374:MainThread](2024-04-22 23:11:40,988) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:11:40,989) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:43,861) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:44,091) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991736
[2211374:MainThread](2024-04-22 23:11:44,092) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:11:44,092) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:46,977) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:47,208) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992310
[2211374:MainThread](2024-04-22 23:11:47,208) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:11:47,208) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:50,080) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:50,308) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991680
[2211374:MainThread](2024-04-22 23:11:50,308) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:11:50,309) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:53,176) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:53,407) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992341
[2211374:MainThread](2024-04-22 23:11:53,407) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:11:53,407) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:56,279) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:56,510) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991825
[2211374:MainThread](2024-04-22 23:11:56,511) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:11:56,511) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:11:59,382) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:11:59,611) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992666
[2211374:MainThread](2024-04-22 23:11:59,611) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:11:59,611) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:12:02,468) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:12:02,699) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994390
[2211374:MainThread](2024-04-22 23:12:02,699) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:12:02,700) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:12:05,562) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:12:05,793) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992952
[2211374:MainThread](2024-04-22 23:12:05,793) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:12:05,794) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991610 @ 13
[2211374:MainThread](2024-04-22 23:12:05,843) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-12-20 SH600000    0.014911
           SH600004   -0.007570
           SH600009    0.014737
           SH600010   -0.064354
           SH600011   -0.100061
[2211374:MainThread](2024-04-22 23:12:07,537) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  57%|█████▋    | 25/44 [32:13<25:28, 80.46s/it][2211374:MainThread](2024-04-22 23:12:07,544) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:12:07,554) INFO - qlib.workflow - [recorder.py:341] - Recorder a4cca9b96bed49858c21e69ff0943508 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:12:08,035) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:12:08,036) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:12:08,038) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:12:08,039) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:12:15,752) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.523431
            SH600004      1.523431
            SH600006      1.523431
            SH600007      1.523431
            SH600008      1.523431
                            ...   
2017-03-10  SZ300144      1.973282
            SZ300146      1.973282
            SZ300168      1.973282
            SZ300182      1.973282
            SZ300251      1.973282
Length: 618892, dtype: float64
[2211374:MainThread](2024-04-22 23:12:15,754) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:12:15,754) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:12:15,755) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:12:18,638) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:12:18,866) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996144
[2211374:MainThread](2024-04-22 23:12:18,867) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:12:18,867) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:12:21,749) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:12:21,976) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995169
[2211374:MainThread](2024-04-22 23:12:21,977) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:12:21,977) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:12:24,847) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:12:25,075) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994214
[2211374:MainThread](2024-04-22 23:12:25,076) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:12:25,077) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:12:27,953) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:12:28,181) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993378
[2211374:MainThread](2024-04-22 23:12:28,182) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:12:28,182) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:12:31,051) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:12:31,279) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993078
[2211374:MainThread](2024-04-22 23:12:31,280) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:12:31,280) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:12:34,160) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:12:34,388) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992317
[2211374:MainThread](2024-04-22 23:12:34,389) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:12:34,390) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:12:37,260) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:12:37,487) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992001
[2211374:MainThread](2024-04-22 23:12:37,488) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:12:37,489) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:12:40,357) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:12:40,585) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992985
[2211374:MainThread](2024-04-22 23:12:40,586) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:12:40,586) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:12:43,471) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:12:43,699) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992727
[2211374:MainThread](2024-04-22 23:12:43,699) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:12:43,700) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:12:46,570) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:12:46,798) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992139
[2211374:MainThread](2024-04-22 23:12:46,798) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:12:46,799) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:12:49,691) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:12:49,919) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991869
[2211374:MainThread](2024-04-22 23:12:49,920) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:12:49,920) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:12:52,796) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:12:53,024) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992914
[2211374:MainThread](2024-04-22 23:12:53,024) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:12:53,025) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:12:55,910) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:12:56,138) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991619
[2211374:MainThread](2024-04-22 23:12:56,139) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:12:56,140) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:12:59,010) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:12:59,238) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991898
[2211374:MainThread](2024-04-22 23:12:59,239) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:12:59,239) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:13:02,123) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:13:02,351) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991987
[2211374:MainThread](2024-04-22 23:13:02,352) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:13:02,352) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:13:05,233) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:13:05,462) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991538
[2211374:MainThread](2024-04-22 23:13:05,463) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:13:05,463) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:13:08,344) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:13:08,573) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991586
[2211374:MainThread](2024-04-22 23:13:08,574) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:13:08,574) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:13:11,445) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:13:11,674) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991480
[2211374:MainThread](2024-04-22 23:13:11,675) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:13:11,675) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:13:14,543) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:13:14,773) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992262
[2211374:MainThread](2024-04-22 23:13:14,773) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:13:14,774) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:13:17,657) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:13:17,886) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991471
[2211374:MainThread](2024-04-22 23:13:17,887) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:13:17,888) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:13:20,756) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:13:20,985) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992466
[2211374:MainThread](2024-04-22 23:13:20,985) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:13:20,985) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:13:23,868) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:13:24,097) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993124
[2211374:MainThread](2024-04-22 23:13:24,097) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 23:13:24,098) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:13:26,969) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:13:27,200) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992915
[2211374:MainThread](2024-04-22 23:13:27,200) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 23:13:27,200) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:13:30,105) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:13:30,337) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993349
[2211374:MainThread](2024-04-22 23:13:30,337) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 23:13:30,337) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:13:33,240) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:13:33,472) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994470
[2211374:MainThread](2024-04-22 23:13:33,473) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 23:13:33,473) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:13:36,412) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:13:36,642) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994879
[2211374:MainThread](2024-04-22 23:13:36,642) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-22 23:13:36,643) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:13:39,604) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:13:39,835) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994039
[2211374:MainThread](2024-04-22 23:13:39,836) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[2211374:MainThread](2024-04-22 23:13:39,836) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:13:42,813) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:13:43,044) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994438
[2211374:MainThread](2024-04-22 23:13:43,045) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:13:43,045) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991471 @ 19
[2211374:MainThread](2024-04-22 23:13:43,095) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-01-21 SH600000   -0.040410
           SH600004    0.145641
           SH600009    0.069963
           SH600010    0.008033
           SH600011   -0.039488
[2211374:MainThread](2024-04-22 23:13:44,787) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  59%|█████▉    | 26/44 [33:50<25:38, 85.50s/it][2211374:MainThread](2024-04-22 23:13:44,795) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:13:44,804) INFO - qlib.workflow - [recorder.py:341] - Recorder 1af72d5b2e104d90a1eb00b9f0a1a52b starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:13:45,273) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:13:45,274) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:13:45,276) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:13:45,276) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:13:53,051) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.978591
            SH600004      0.978591
            SH600006      0.978591
            SH600007      0.978591
            SH600008      0.978591
                            ...   
2017-04-11  SZ300144      1.742481
            SZ300146      1.742481
            SZ300168      1.742481
            SZ300182      1.742481
            SZ300251      1.742481
Length: 624606, dtype: float64
[2211374:MainThread](2024-04-22 23:13:53,053) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:13:53,054) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:13:53,054) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:13:56,057) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:13:56,253) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996363
[2211374:MainThread](2024-04-22 23:13:56,255) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:13:56,255) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:13:59,232) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:13:59,429) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995273
[2211374:MainThread](2024-04-22 23:13:59,430) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:13:59,430) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:14:02,408) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:14:02,606) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994292
[2211374:MainThread](2024-04-22 23:14:02,608) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:14:02,608) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:14:05,584) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:14:05,780) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993465
[2211374:MainThread](2024-04-22 23:14:05,781) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:14:05,782) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:14:08,742) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:14:08,939) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993876
[2211374:MainThread](2024-04-22 23:14:08,940) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:14:08,940) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:14:11,924) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:14:12,121) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992659
[2211374:MainThread](2024-04-22 23:14:12,122) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:14:12,122) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:14:15,095) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:14:15,292) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992380
[2211374:MainThread](2024-04-22 23:14:15,293) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:14:15,294) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:14:18,284) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:14:18,481) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992707
[2211374:MainThread](2024-04-22 23:14:18,482) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:14:18,482) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:14:21,459) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:14:21,657) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992489
[2211374:MainThread](2024-04-22 23:14:21,657) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:14:21,657) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:14:24,648) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:14:24,846) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992362
[2211374:MainThread](2024-04-22 23:14:24,847) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:14:24,848) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:14:27,823) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:14:28,020) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992230
[2211374:MainThread](2024-04-22 23:14:28,021) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:14:28,021) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:14:30,982) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:14:31,180) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993048
[2211374:MainThread](2024-04-22 23:14:31,180) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:14:31,181) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:14:34,097) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:14:34,295) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992409
[2211374:MainThread](2024-04-22 23:14:34,296) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:14:34,296) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:14:37,209) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:14:37,406) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991740
[2211374:MainThread](2024-04-22 23:14:37,407) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:14:37,407) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:14:40,305) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:14:40,502) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992406
[2211374:MainThread](2024-04-22 23:14:40,502) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:14:40,503) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:14:43,403) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:14:43,600) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993143
[2211374:MainThread](2024-04-22 23:14:43,600) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:14:43,600) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:14:46,486) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:14:46,682) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991533
[2211374:MainThread](2024-04-22 23:14:46,683) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:14:46,683) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:14:49,569) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:14:49,766) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992531
[2211374:MainThread](2024-04-22 23:14:49,766) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:14:49,767) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:14:52,662) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:14:52,858) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992293
[2211374:MainThread](2024-04-22 23:14:52,859) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:14:52,859) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:14:55,743) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:14:55,939) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993710
[2211374:MainThread](2024-04-22 23:14:55,940) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:14:55,940) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:14:58,838) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:14:59,035) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992980
[2211374:MainThread](2024-04-22 23:14:59,035) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:14:59,035) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:15:01,919) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:15:02,116) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993295
[2211374:MainThread](2024-04-22 23:15:02,116) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 23:15:02,117) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:15:05,018) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:15:05,214) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993226
[2211374:MainThread](2024-04-22 23:15:05,215) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 23:15:05,215) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:15:08,099) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:15:08,296) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993006
[2211374:MainThread](2024-04-22 23:15:08,296) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 23:15:08,296) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:15:11,214) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:15:11,413) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994833
[2211374:MainThread](2024-04-22 23:15:11,414) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:15:11,414) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991533 @ 16
[2211374:MainThread](2024-04-22 23:15:11,462) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-02-25 SH600000    0.214774
           SH600004    0.041815
           SH600009   -0.165356
           SH600010    0.231444
           SH600011    0.060457
[2211374:MainThread](2024-04-22 23:15:13,111) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  61%|██████▏   | 27/44 [35:19<24:27, 86.35s/it][2211374:MainThread](2024-04-22 23:15:13,119) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:15:13,128) INFO - qlib.workflow - [recorder.py:341] - Recorder 6a540452b7dd417183767221991dc6b6 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:15:13,606) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:15:13,607) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:15:13,609) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:15:13,610) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:15:21,216) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.927424
            SH600004      0.927424
            SH600006      0.927424
            SH600007      0.927424
            SH600008      0.927424
                            ...   
2017-05-10  SZ300133      1.391278
            SZ300144      1.391278
            SZ300146      1.391278
            SZ300182      1.391278
            SZ300251      1.391278
Length: 630244, dtype: float64
[2211374:MainThread](2024-04-22 23:15:21,218) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:15:21,218) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:15:21,219) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:15:24,167) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:15:24,379) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995424
[2211374:MainThread](2024-04-22 23:15:24,380) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:15:24,380) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:15:27,315) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:15:27,524) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994521
[2211374:MainThread](2024-04-22 23:15:27,525) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:15:27,525) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:15:30,463) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:15:30,671) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994461
[2211374:MainThread](2024-04-22 23:15:30,672) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:15:30,673) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:15:33,642) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:15:33,850) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993822
[2211374:MainThread](2024-04-22 23:15:33,851) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:15:33,851) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:15:36,797) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:15:37,006) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993136
[2211374:MainThread](2024-04-22 23:15:37,007) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:15:37,007) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:15:39,959) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:15:40,168) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994024
[2211374:MainThread](2024-04-22 23:15:40,168) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:15:40,169) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:15:43,107) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:15:43,316) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992519
[2211374:MainThread](2024-04-22 23:15:43,317) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:15:43,318) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:15:46,326) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:15:46,535) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992493
[2211374:MainThread](2024-04-22 23:15:46,536) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:15:46,536) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:15:49,531) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:15:49,739) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992362
[2211374:MainThread](2024-04-22 23:15:49,740) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:15:49,741) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:15:52,743) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:15:52,951) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991838
[2211374:MainThread](2024-04-22 23:15:52,952) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:15:52,952) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:15:55,945) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:15:56,154) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992499
[2211374:MainThread](2024-04-22 23:15:56,154) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:15:56,154) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:15:59,131) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:15:59,339) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992735
[2211374:MainThread](2024-04-22 23:15:59,340) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:15:59,340) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:16:02,276) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:16:02,485) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991495
[2211374:MainThread](2024-04-22 23:16:02,486) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:16:02,486) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:16:05,433) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:16:05,643) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991995
[2211374:MainThread](2024-04-22 23:16:05,644) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:16:05,644) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:16:08,625) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:16:08,833) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991862
[2211374:MainThread](2024-04-22 23:16:08,833) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:16:08,834) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:16:11,823) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:16:12,034) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992150
[2211374:MainThread](2024-04-22 23:16:12,034) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:16:12,035) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:16:14,971) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:16:15,180) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992900
[2211374:MainThread](2024-04-22 23:16:15,180) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:16:15,180) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:16:18,111) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:16:18,320) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992922
[2211374:MainThread](2024-04-22 23:16:18,320) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:16:18,321) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:16:21,262) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:16:21,471) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993878
[2211374:MainThread](2024-04-22 23:16:21,472) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:16:21,472) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:16:24,415) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:16:24,624) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992121
[2211374:MainThread](2024-04-22 23:16:24,624) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:16:24,625) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:16:27,606) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:16:27,815) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993799
[2211374:MainThread](2024-04-22 23:16:27,816) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:16:27,816) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991495 @ 12
[2211374:MainThread](2024-04-22 23:16:27,864) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-03-25 SH600000    0.066980
           SH600004    0.131375
           SH600009    0.096996
           SH600010    0.051635
           SH600011   -0.090908
[2211374:MainThread](2024-04-22 23:16:29,515) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  64%|██████▎   | 28/44 [36:35<22:13, 83.36s/it][2211374:MainThread](2024-04-22 23:16:29,523) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:16:29,532) INFO - qlib.workflow - [recorder.py:341] - Recorder 7c575438a3084a43b3d81dfd6337b87b starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:16:30,007) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:16:30,008) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:16:30,011) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:16:30,011) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:16:37,622) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.856061
            SH600004      1.856061
            SH600006      1.856061
            SH600007      1.856061
            SH600008      1.856061
                            ...   
2017-06-09  SZ300133      1.798144
            SZ300144      1.798144
            SZ300146      1.798144
            SZ300182      1.798144
            SZ300251      1.798144
Length: 635820, dtype: float64
[2211374:MainThread](2024-04-22 23:16:37,624) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:16:37,624) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:16:37,624) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:16:40,636) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:16:40,834) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995684
[2211374:MainThread](2024-04-22 23:16:40,835) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:16:40,836) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:16:43,796) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:16:43,997) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994966
[2211374:MainThread](2024-04-22 23:16:43,998) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:16:43,998) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:16:46,995) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:16:47,194) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993440
[2211374:MainThread](2024-04-22 23:16:47,195) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:16:47,196) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:16:50,204) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:16:50,404) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993711
[2211374:MainThread](2024-04-22 23:16:50,404) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:16:50,404) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:16:53,432) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:16:53,631) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993760
[2211374:MainThread](2024-04-22 23:16:53,631) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:16:53,632) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:16:56,621) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:16:56,819) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993326
[2211374:MainThread](2024-04-22 23:16:56,820) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:16:56,821) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:16:59,846) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:17:00,046) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992468
[2211374:MainThread](2024-04-22 23:17:00,047) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:17:00,047) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:17:03,036) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:17:03,234) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993416
[2211374:MainThread](2024-04-22 23:17:03,235) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:17:03,235) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:17:06,192) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:17:06,393) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993194
[2211374:MainThread](2024-04-22 23:17:06,393) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:17:06,393) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:17:09,395) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:17:09,594) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992358
[2211374:MainThread](2024-04-22 23:17:09,595) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:17:09,595) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:17:12,600) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:17:12,800) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992715
[2211374:MainThread](2024-04-22 23:17:12,800) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:17:12,800) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:17:15,829) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:17:16,029) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992155
[2211374:MainThread](2024-04-22 23:17:16,030) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:17:16,031) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:17:19,059) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:17:19,257) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992905
[2211374:MainThread](2024-04-22 23:17:19,258) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:17:19,258) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:17:22,289) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:17:22,487) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993299
[2211374:MainThread](2024-04-22 23:17:22,488) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:17:22,488) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:17:25,504) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:17:25,702) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992614
[2211374:MainThread](2024-04-22 23:17:25,703) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:17:25,703) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:17:28,727) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:17:28,927) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993069
[2211374:MainThread](2024-04-22 23:17:28,927) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:17:28,927) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:17:31,951) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:17:32,149) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992754
[2211374:MainThread](2024-04-22 23:17:32,149) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:17:32,149) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:17:35,178) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:17:35,379) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992311
[2211374:MainThread](2024-04-22 23:17:35,379) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:17:35,379) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:17:38,394) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:17:38,593) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994297
[2211374:MainThread](2024-04-22 23:17:38,593) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:17:38,593) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:17:41,618) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:17:41,817) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993470
[2211374:MainThread](2024-04-22 23:17:41,817) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:17:41,817) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992155 @ 11
[2211374:MainThread](2024-04-22 23:17:41,866) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-04-23 SH600000    0.061872
           SH600004   -0.035723
           SH600009   -0.220050
           SH600010    0.007210
           SH600011   -0.017153
[2211374:MainThread](2024-04-22 23:17:43,527) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  66%|██████▌   | 29/44 [37:49<20:08, 80.56s/it][2211374:MainThread](2024-04-22 23:17:43,535) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:17:43,544) INFO - qlib.workflow - [recorder.py:341] - Recorder 6d1bf06957c6476a88b0943eab41a11e starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:17:44,000) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:17:44,001) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:17:44,004) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:17:44,005) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:17:51,619) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.448100
            SH600004      1.448100
            SH600006      1.448100
            SH600007      1.448100
            SH600008      1.448100
                            ...   
2017-07-07  SZ300133      1.381557
            SZ300144      1.381557
            SZ300168      1.381557
            SZ300251      1.381557
            SZ300315      1.381557
Length: 641204, dtype: float64
[2211374:MainThread](2024-04-22 23:17:51,621) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:17:51,621) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:17:51,622) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:17:54,579) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:17:54,789) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995613
[2211374:MainThread](2024-04-22 23:17:54,790) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:17:54,791) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:17:57,831) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:17:58,042) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995088
[2211374:MainThread](2024-04-22 23:17:58,043) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:17:58,043) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:18:01,094) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:18:01,307) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994056
[2211374:MainThread](2024-04-22 23:18:01,308) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:18:01,308) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:18:04,330) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:18:04,543) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993397
[2211374:MainThread](2024-04-22 23:18:04,544) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:18:04,545) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:18:07,639) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:18:07,852) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993176
[2211374:MainThread](2024-04-22 23:18:07,853) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:18:07,853) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:18:10,933) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:18:11,145) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992837
[2211374:MainThread](2024-04-22 23:18:11,146) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:18:11,146) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:18:14,230) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:18:14,445) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995231
[2211374:MainThread](2024-04-22 23:18:14,445) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:18:14,445) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:18:17,527) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:18:17,740) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992275
[2211374:MainThread](2024-04-22 23:18:17,741) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:18:17,741) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:18:20,826) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:18:21,043) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993195
[2211374:MainThread](2024-04-22 23:18:21,043) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:18:21,043) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:18:24,136) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:18:24,349) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992369
[2211374:MainThread](2024-04-22 23:18:24,350) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:18:24,350) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:18:27,435) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:18:27,648) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992940
[2211374:MainThread](2024-04-22 23:18:27,648) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:18:27,649) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:18:30,744) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:18:30,958) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993669
[2211374:MainThread](2024-04-22 23:18:30,959) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:18:30,959) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:18:34,041) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:18:34,254) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991680
[2211374:MainThread](2024-04-22 23:18:34,255) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:18:34,255) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:18:37,348) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:18:37,561) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994206
[2211374:MainThread](2024-04-22 23:18:37,561) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:18:37,562) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:18:40,647) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:18:40,860) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992236
[2211374:MainThread](2024-04-22 23:18:40,861) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:18:40,861) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:18:43,953) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:18:44,166) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993978
[2211374:MainThread](2024-04-22 23:18:44,166) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:18:44,166) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:18:47,186) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:18:47,398) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992290
[2211374:MainThread](2024-04-22 23:18:47,398) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:18:47,398) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:18:50,403) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:18:50,616) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992361
[2211374:MainThread](2024-04-22 23:18:50,616) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:18:50,616) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:18:53,605) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:18:53,817) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994726
[2211374:MainThread](2024-04-22 23:18:53,818) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:18:53,818) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:18:56,822) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:18:57,036) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995335
[2211374:MainThread](2024-04-22 23:18:57,037) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:18:57,037) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:19:00,025) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:19:00,237) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993774
[2211374:MainThread](2024-04-22 23:19:00,237) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:19:00,237) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991680 @ 12
[2211374:MainThread](2024-04-22 23:19:00,286) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-05-24 SH600000   -0.076333
           SH600004   -0.070575
           SH600009    0.049433
           SH600010   -0.135082
           SH600011   -0.075782
[2211374:MainThread](2024-04-22 23:19:01,948) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  68%|██████▊   | 30/44 [39:08<18:38, 79.92s/it][2211374:MainThread](2024-04-22 23:19:01,956) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:19:01,966) INFO - qlib.workflow - [recorder.py:341] - Recorder 4005dbc2893f42cbbfba86d0a7264122 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:19:02,432) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:19:02,432) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:19:02,435) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:19:02,436) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:19:10,032) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.774793
            SH600004      0.774793
            SH600006      0.774793
            SH600007      0.774793
            SH600008      0.774793
                            ...   
2017-08-04  SZ300133      1.041838
            SZ300144      1.041838
            SZ300168      1.041838
            SZ300251      1.041838
            SZ300315      1.041838
Length: 646851, dtype: float64
[2211374:MainThread](2024-04-22 23:19:10,035) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:19:10,035) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:19:10,035) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:19:13,053) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:19:13,288) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995255
[2211374:MainThread](2024-04-22 23:19:13,289) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:19:13,289) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:19:16,307) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:19:16,541) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994598
[2211374:MainThread](2024-04-22 23:19:16,542) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:19:16,542) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:19:19,550) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:19:19,785) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993729
[2211374:MainThread](2024-04-22 23:19:19,786) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:19:19,786) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:19:22,801) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:19:23,035) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993172
[2211374:MainThread](2024-04-22 23:19:23,036) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:19:23,037) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:19:26,044) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:19:26,280) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993084
[2211374:MainThread](2024-04-22 23:19:26,281) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:19:26,282) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:19:29,296) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:19:29,532) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992772
[2211374:MainThread](2024-04-22 23:19:29,533) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:19:29,533) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:19:32,543) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:19:32,778) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992989
[2211374:MainThread](2024-04-22 23:19:32,778) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:19:32,779) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:19:35,793) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:19:36,029) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993306
[2211374:MainThread](2024-04-22 23:19:36,030) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:19:36,030) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:19:39,042) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:19:39,278) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992820
[2211374:MainThread](2024-04-22 23:19:39,279) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:19:39,279) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:19:42,288) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:19:42,523) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993591
[2211374:MainThread](2024-04-22 23:19:42,523) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:19:42,523) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:19:45,604) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:19:45,839) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993417
[2211374:MainThread](2024-04-22 23:19:45,840) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:19:45,840) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:19:48,906) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:19:49,141) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993401
[2211374:MainThread](2024-04-22 23:19:49,141) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:19:49,141) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:19:52,229) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:19:52,464) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993009
[2211374:MainThread](2024-04-22 23:19:52,465) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:19:52,465) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:19:55,402) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:19:55,638) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993569
[2211374:MainThread](2024-04-22 23:19:55,639) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:19:55,639) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992772 @ 5
[2211374:MainThread](2024-04-22 23:19:55,688) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-06-24 SH600000    0.020255
           SH600004   -0.220585
           SH600009   -0.144343
           SH600010   -0.021068
           SH600011    0.061694
[2211374:MainThread](2024-04-22 23:19:57,362) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  70%|███████   | 31/44 [40:03<15:43, 72.57s/it][2211374:MainThread](2024-04-22 23:19:57,369) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:19:57,379) INFO - qlib.workflow - [recorder.py:341] - Recorder 2f190dc228f04ed1a4c0b879ad153aa3 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:19:57,854) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:19:57,855) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:19:57,857) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:19:57,857) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:20:05,476) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.704366
            SH600004      0.704366
            SH600006      0.704366
            SH600007      0.704366
            SH600008      0.704366
                            ...   
2017-09-01  SZ300133      1.498610
            SZ300144      1.498610
            SZ300168      1.498610
            SZ300251      1.498610
            SZ300315      1.498610
Length: 652446, dtype: float64
[2211374:MainThread](2024-04-22 23:20:05,478) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:20:05,478) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:20:05,478) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:20:08,442) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:20:08,649) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995577
[2211374:MainThread](2024-04-22 23:20:08,651) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:20:08,651) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:20:11,754) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:20:11,960) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995341
[2211374:MainThread](2024-04-22 23:20:11,961) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:20:11,961) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:20:15,046) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:20:15,252) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994189
[2211374:MainThread](2024-04-22 23:20:15,253) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:20:15,254) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:20:18,387) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:20:18,594) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993606
[2211374:MainThread](2024-04-22 23:20:18,595) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:20:18,596) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:20:21,721) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:20:21,929) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993827
[2211374:MainThread](2024-04-22 23:20:21,929) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:20:21,929) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:20:25,064) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:20:25,274) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993544
[2211374:MainThread](2024-04-22 23:20:25,275) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:20:25,275) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:20:28,398) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:20:28,607) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993125
[2211374:MainThread](2024-04-22 23:20:28,608) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:20:28,608) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:20:31,720) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:20:31,929) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991897
[2211374:MainThread](2024-04-22 23:20:31,930) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:20:31,930) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:20:34,996) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:20:35,207) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993572
[2211374:MainThread](2024-04-22 23:20:35,207) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:20:35,208) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:20:38,282) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:20:38,491) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993139
[2211374:MainThread](2024-04-22 23:20:38,491) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:20:38,492) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:20:41,555) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:20:41,763) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993032
[2211374:MainThread](2024-04-22 23:20:41,764) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:20:41,764) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:20:44,833) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:20:45,043) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994141
[2211374:MainThread](2024-04-22 23:20:45,044) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:20:45,044) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:20:48,109) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:20:48,318) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994774
[2211374:MainThread](2024-04-22 23:20:48,319) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:20:48,319) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:20:51,406) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:20:51,614) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992855
[2211374:MainThread](2024-04-22 23:20:51,614) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:20:51,615) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:20:54,712) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:20:54,919) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995008
[2211374:MainThread](2024-04-22 23:20:54,920) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:20:54,920) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:20:58,023) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:20:58,230) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994025
[2211374:MainThread](2024-04-22 23:20:58,230) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:20:58,231) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991897 @ 7
[2211374:MainThread](2024-04-22 23:20:58,280) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-07-22 SH600000    0.015265
           SH600004   -0.001108
           SH600009   -0.058342
           SH600010   -0.028191
           SH600011    0.017297
[2211374:MainThread](2024-04-22 23:20:59,932) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  73%|███████▎  | 32/44 [41:06<13:54, 69.57s/it][2211374:MainThread](2024-04-22 23:20:59,940) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:20:59,949) INFO - qlib.workflow - [recorder.py:341] - Recorder 8ed8d093dd694354970529e878a8844e starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:21:00,417) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:21:00,417) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:21:00,420) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:21:00,420) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:21:08,122) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.332682
            SH600004      1.332682
            SH600006      1.332682
            SH600007      1.332682
            SH600008      1.332682
                            ...   
2017-09-29  SZ300133      1.673049
            SZ300144      1.673049
            SZ300168      1.673049
            SZ300251      1.673049
            SZ300315      1.673049
Length: 658139, dtype: float64
[2211374:MainThread](2024-04-22 23:21:08,124) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:21:08,125) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:21:08,125) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:21:11,275) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:21:11,509) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995719
[2211374:MainThread](2024-04-22 23:21:11,511) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:21:11,511) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:21:14,638) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:21:14,870) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995607
[2211374:MainThread](2024-04-22 23:21:14,871) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:21:14,871) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:21:17,997) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:21:18,230) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994843
[2211374:MainThread](2024-04-22 23:21:18,231) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:21:18,232) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:21:21,363) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:21:21,595) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993823
[2211374:MainThread](2024-04-22 23:21:21,596) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:21:21,597) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:21:24,730) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:21:24,967) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993779
[2211374:MainThread](2024-04-22 23:21:24,968) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:21:24,968) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:21:28,100) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:21:28,333) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992924
[2211374:MainThread](2024-04-22 23:21:28,334) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:21:28,335) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:21:31,461) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:21:31,696) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993671
[2211374:MainThread](2024-04-22 23:21:31,696) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:21:31,696) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:21:34,827) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:21:35,060) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992472
[2211374:MainThread](2024-04-22 23:21:35,061) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:21:35,061) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:21:38,194) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:21:38,428) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992758
[2211374:MainThread](2024-04-22 23:21:38,428) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:21:38,429) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:21:41,561) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:21:41,793) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992340
[2211374:MainThread](2024-04-22 23:21:41,794) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:21:41,795) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:21:44,920) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:21:45,154) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992987
[2211374:MainThread](2024-04-22 23:21:45,154) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:21:45,154) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:21:48,287) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:21:48,520) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993098
[2211374:MainThread](2024-04-22 23:21:48,521) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:21:48,521) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:21:51,654) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:21:51,887) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994201
[2211374:MainThread](2024-04-22 23:21:51,888) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:21:51,888) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:21:55,021) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:21:55,253) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993205
[2211374:MainThread](2024-04-22 23:21:55,254) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:21:55,254) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:21:58,379) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:21:58,612) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993129
[2211374:MainThread](2024-04-22 23:21:58,612) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:21:58,612) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:22:01,745) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:22:01,978) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993768
[2211374:MainThread](2024-04-22 23:22:01,978) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:22:01,978) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:22:05,115) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:22:05,348) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993085
[2211374:MainThread](2024-04-22 23:22:05,348) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:22:05,348) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:22:08,480) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:22:08,713) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994040
[2211374:MainThread](2024-04-22 23:22:08,714) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:22:08,714) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992340 @ 9
[2211374:MainThread](2024-04-22 23:22:08,764) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-08-19 SH600000    0.005360
           SH600004    0.000505
           SH600009    0.024168
           SH600010   -0.042758
           SH600011   -0.042661
[2211374:MainThread](2024-04-22 23:22:10,446) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  75%|███████▌  | 33/44 [42:16<12:48, 69.85s/it][2211374:MainThread](2024-04-22 23:22:10,453) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:22:10,463) INFO - qlib.workflow - [recorder.py:341] - Recorder e78ef493351b48f59e98482e88fa2756 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:22:10,986) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:22:10,987) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:22:10,991) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:22:10,991) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:22:19,139) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.161482
            SH600004      1.161482
            SH600006      1.161482
            SH600007      1.161482
            SH600008      1.161482
                            ...   
2017-11-03  SZ300133      1.710401
            SZ300144      1.710401
            SZ300168      1.710401
            SZ300251      1.710401
            SZ300315      1.710401
Length: 663832, dtype: float64
[2211374:MainThread](2024-04-22 23:22:19,149) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:22:19,150) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:22:19,150) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:22:22,277) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:22:22,511) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996911
[2211374:MainThread](2024-04-22 23:22:22,512) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:22:22,513) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:22:25,601) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:22:25,835) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996214
[2211374:MainThread](2024-04-22 23:22:25,836) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:22:25,836) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:22:28,933) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:22:29,167) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994438
[2211374:MainThread](2024-04-22 23:22:29,168) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:22:29,168) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:22:32,253) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:22:32,487) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994211
[2211374:MainThread](2024-04-22 23:22:32,488) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:22:32,488) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:22:35,578) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:22:35,812) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994552
[2211374:MainThread](2024-04-22 23:22:35,812) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:22:35,812) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:22:38,905) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:22:39,142) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995650
[2211374:MainThread](2024-04-22 23:22:39,143) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:22:39,143) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:22:42,277) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:22:42,514) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993792
[2211374:MainThread](2024-04-22 23:22:42,515) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:22:42,516) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:22:45,637) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:22:45,874) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994082
[2211374:MainThread](2024-04-22 23:22:45,875) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:22:45,875) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:22:49,001) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:22:49,240) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994029
[2211374:MainThread](2024-04-22 23:22:49,240) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:22:49,241) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:22:52,361) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:22:52,598) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993841
[2211374:MainThread](2024-04-22 23:22:52,598) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:22:52,599) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:22:55,719) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:22:55,957) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993658
[2211374:MainThread](2024-04-22 23:22:55,958) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:22:55,958) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:22:59,080) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:22:59,318) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993505
[2211374:MainThread](2024-04-22 23:22:59,319) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:22:59,319) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:23:02,423) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:23:02,657) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993199
[2211374:MainThread](2024-04-22 23:23:02,658) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:23:02,659) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:23:05,773) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:23:06,011) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994569
[2211374:MainThread](2024-04-22 23:23:06,011) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:23:06,011) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:23:09,113) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:23:09,348) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994441
[2211374:MainThread](2024-04-22 23:23:09,348) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:23:09,349) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:23:12,427) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:23:12,661) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994028
[2211374:MainThread](2024-04-22 23:23:12,661) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:23:12,662) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:23:15,751) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:23:15,986) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994363
[2211374:MainThread](2024-04-22 23:23:15,986) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:23:15,986) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:23:19,065) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:23:19,299) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994251
[2211374:MainThread](2024-04-22 23:23:19,300) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:23:19,300) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:23:22,392) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:23:22,626) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992976
[2211374:MainThread](2024-04-22 23:23:22,627) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:23:22,627) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:23:25,703) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:23:25,937) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995757
[2211374:MainThread](2024-04-22 23:23:25,937) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:23:25,937) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:23:29,023) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:23:29,256) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994136
[2211374:MainThread](2024-04-22 23:23:29,256) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:23:29,257) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:23:32,340) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:23:32,573) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995429
[2211374:MainThread](2024-04-22 23:23:32,573) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 23:23:32,574) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:23:35,718) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:23:35,951) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995515
[2211374:MainThread](2024-04-22 23:23:35,952) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 23:23:35,952) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:23:39,088) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:23:39,321) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995159
[2211374:MainThread](2024-04-22 23:23:39,321) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 23:23:39,322) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:23:42,410) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:23:42,644) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995608
[2211374:MainThread](2024-04-22 23:23:42,644) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 23:23:42,644) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:23:45,792) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:23:46,025) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996415
[2211374:MainThread](2024-04-22 23:23:46,025) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-22 23:23:46,026) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:23:49,169) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:23:49,402) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997803
[2211374:MainThread](2024-04-22 23:23:49,402) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:23:49,403) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992976 @ 18
[2211374:MainThread](2024-04-22 23:23:49,452) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-09-17 SH600000    0.079972
           SH600004    0.219284
           SH600009    0.043862
           SH600010    0.013443
           SH600011   -0.039738
[2211374:MainThread](2024-04-22 23:23:51,110) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  77%|███████▋  | 34/44 [43:57<13:10, 79.10s/it][2211374:MainThread](2024-04-22 23:23:51,118) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:23:51,127) INFO - qlib.workflow - [recorder.py:341] - Recorder 02c180e204ea41f2a2b79121947d45d9 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:23:51,574) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:23:51,574) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:23:51,576) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:23:51,576) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:23:59,204) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.650605
            SH600004      0.650605
            SH600006      0.650605
            SH600007      0.650605
            SH600008      0.650605
                            ...   
2017-12-01  SZ300133      1.075220
            SZ300144      1.075220
            SZ300168      1.075220
            SZ300251      1.075220
            SZ300315      1.075220
Length: 669550, dtype: float64
[2211374:MainThread](2024-04-22 23:23:59,206) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:23:59,206) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:23:59,207) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:24:02,427) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:24:02,663) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996107
[2211374:MainThread](2024-04-22 23:24:02,664) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:24:02,664) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:24:05,881) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:24:06,114) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994787
[2211374:MainThread](2024-04-22 23:24:06,115) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:24:06,115) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:24:09,332) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:24:09,569) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994805
[2211374:MainThread](2024-04-22 23:24:09,569) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:24:09,569) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:24:12,777) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:24:13,010) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994303
[2211374:MainThread](2024-04-22 23:24:13,012) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:24:13,012) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:24:16,224) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:24:16,461) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994312
[2211374:MainThread](2024-04-22 23:24:16,461) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:24:16,461) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:24:19,662) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:24:19,899) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993948
[2211374:MainThread](2024-04-22 23:24:19,900) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:24:19,900) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:24:23,114) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:24:23,351) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993762
[2211374:MainThread](2024-04-22 23:24:23,352) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:24:23,352) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:24:26,552) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:24:26,789) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994073
[2211374:MainThread](2024-04-22 23:24:26,789) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:24:26,790) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:24:30,002) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:24:30,236) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993878
[2211374:MainThread](2024-04-22 23:24:30,236) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:24:30,236) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:24:33,430) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:24:33,662) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993838
[2211374:MainThread](2024-04-22 23:24:33,662) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:24:33,663) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:24:36,868) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:24:37,103) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995593
[2211374:MainThread](2024-04-22 23:24:37,103) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:24:37,103) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:24:40,284) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:24:40,517) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993182
[2211374:MainThread](2024-04-22 23:24:40,518) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:24:40,519) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:24:43,698) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:24:43,935) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993071
[2211374:MainThread](2024-04-22 23:24:43,936) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:24:43,936) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:24:47,075) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:24:47,312) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993481
[2211374:MainThread](2024-04-22 23:24:47,313) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:24:47,313) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:24:50,464) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:24:50,701) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993943
[2211374:MainThread](2024-04-22 23:24:50,702) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:24:50,702) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:24:53,841) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:24:54,078) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995166
[2211374:MainThread](2024-04-22 23:24:54,079) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:24:54,079) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:24:57,233) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:24:57,470) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994687
[2211374:MainThread](2024-04-22 23:24:57,471) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:24:57,471) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:25:00,607) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:25:00,845) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993887
[2211374:MainThread](2024-04-22 23:25:00,845) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:25:00,846) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:25:03,987) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:25:04,226) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994983
[2211374:MainThread](2024-04-22 23:25:04,227) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:25:04,227) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:25:07,350) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:25:07,584) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994294
[2211374:MainThread](2024-04-22 23:25:07,584) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:25:07,584) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:25:10,696) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:25:10,930) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996499
[2211374:MainThread](2024-04-22 23:25:10,930) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:25:10,931) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993071 @ 12
[2211374:MainThread](2024-04-22 23:25:10,981) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-10-22 SH600000    0.087425
           SH600004    0.150250
           SH600009   -0.124630
           SH600010   -0.020032
           SH600011   -0.052339
[2211374:MainThread](2024-04-22 23:25:12,632) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  80%|███████▉  | 35/44 [45:18<11:58, 79.82s/it][2211374:MainThread](2024-04-22 23:25:12,640) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:25:12,649) INFO - qlib.workflow - [recorder.py:341] - Recorder 181af13886d64d5ca7ec2665e072f6ee starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:25:13,120) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:25:13,121) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:25:13,124) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:25:13,124) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:25:20,757) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.712726
            SH600004      0.712726
            SH600006      0.712726
            SH600007      0.712726
            SH600008      0.712726
                            ...   
2017-12-29  SZ300124      1.556143
            SZ300136      1.556143
            SZ300144      1.556143
            SZ300251      1.556143
            SZ300315      1.556143
Length: 675267, dtype: float64
[2211374:MainThread](2024-04-22 23:25:20,759) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:25:20,760) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:25:20,760) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:25:23,976) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:25:24,186) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997816
[2211374:MainThread](2024-04-22 23:25:24,187) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:25:24,187) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:25:27,386) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:25:27,596) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995475
[2211374:MainThread](2024-04-22 23:25:27,597) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:25:27,597) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:25:30,803) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:25:31,013) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994639
[2211374:MainThread](2024-04-22 23:25:31,014) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:25:31,014) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:25:34,214) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:25:34,424) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995329
[2211374:MainThread](2024-04-22 23:25:34,424) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:25:34,424) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:25:37,626) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:25:37,835) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994389
[2211374:MainThread](2024-04-22 23:25:37,836) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:25:37,836) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:25:40,968) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:25:41,175) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994948
[2211374:MainThread](2024-04-22 23:25:41,176) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:25:41,176) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:25:44,348) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:25:44,555) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994697
[2211374:MainThread](2024-04-22 23:25:44,555) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:25:44,556) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:25:47,711) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:25:47,919) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994839
[2211374:MainThread](2024-04-22 23:25:47,919) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:25:47,919) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:25:51,095) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:25:51,303) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995185
[2211374:MainThread](2024-04-22 23:25:51,303) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:25:51,304) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:25:54,468) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:25:54,676) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996054
[2211374:MainThread](2024-04-22 23:25:54,677) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:25:54,677) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:25:57,850) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:25:58,058) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994323
[2211374:MainThread](2024-04-22 23:25:58,059) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:25:58,059) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:26:01,217) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:26:01,428) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994241
[2211374:MainThread](2024-04-22 23:26:01,429) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:26:01,429) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:26:04,608) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:26:04,816) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995182
[2211374:MainThread](2024-04-22 23:26:04,816) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:26:04,816) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:26:07,976) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:26:08,184) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995793
[2211374:MainThread](2024-04-22 23:26:08,185) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:26:08,185) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:26:11,353) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:26:11,561) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995358
[2211374:MainThread](2024-04-22 23:26:11,561) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:26:11,562) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:26:14,719) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:26:14,927) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996280
[2211374:MainThread](2024-04-22 23:26:14,927) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:26:14,927) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:26:18,122) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:26:18,330) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995115
[2211374:MainThread](2024-04-22 23:26:18,330) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:26:18,330) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:26:21,491) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:26:21,699) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996016
[2211374:MainThread](2024-04-22 23:26:21,700) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:26:21,700) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:26:24,883) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:26:25,091) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995547
[2211374:MainThread](2024-04-22 23:26:25,091) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:26:25,092) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:26:28,255) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:26:28,463) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995700
[2211374:MainThread](2024-04-22 23:26:28,463) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:26:28,464) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.994241 @ 11
[2211374:MainThread](2024-04-22 23:26:28,514) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-11-19 SH600000   -0.028066
           SH600004   -0.021152
           SH600009   -0.008671
           SH600010   -0.040999
           SH600011    0.073002
[2211374:MainThread](2024-04-22 23:26:30,166) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  82%|████████▏ | 36/44 [46:36<10:33, 79.14s/it][2211374:MainThread](2024-04-22 23:26:30,174) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:26:30,183) INFO - qlib.workflow - [recorder.py:341] - Recorder 1495706a2dc3485797b93b2941c69a4f starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:26:30,807) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:26:30,808) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:26:30,811) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:26:30,812) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:26:38,911) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.776269
            SH600004      0.776269
            SH600006      0.776269
            SH600007      0.776269
            SH600008      0.776269
                            ...   
2018-01-29  SZ300124      1.931228
            SZ300136      1.931228
            SZ300144      1.931228
            SZ300251      1.931228
            SZ300315      1.931228
Length: 680999, dtype: float64
[2211374:MainThread](2024-04-22 23:26:38,913) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:26:38,914) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:26:38,914) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:26:42,190) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:26:42,421) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996758
[2211374:MainThread](2024-04-22 23:26:42,422) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:26:42,423) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:26:45,650) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:26:45,882) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996132
[2211374:MainThread](2024-04-22 23:26:45,883) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:26:45,884) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:26:49,070) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:26:49,302) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995544
[2211374:MainThread](2024-04-22 23:26:49,303) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:26:49,303) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:26:52,499) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:26:52,732) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995152
[2211374:MainThread](2024-04-22 23:26:52,733) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:26:52,733) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:26:55,919) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:26:56,152) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995050
[2211374:MainThread](2024-04-22 23:26:56,153) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:26:56,153) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:26:59,356) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:26:59,588) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995647
[2211374:MainThread](2024-04-22 23:26:59,589) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:26:59,589) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:27:02,772) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:27:03,004) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994417
[2211374:MainThread](2024-04-22 23:27:03,005) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:27:03,006) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:27:06,226) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:27:06,464) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994153
[2211374:MainThread](2024-04-22 23:27:06,465) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:27:06,465) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:27:09,655) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:27:09,888) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994427
[2211374:MainThread](2024-04-22 23:27:09,889) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:27:09,889) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:27:13,089) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:27:13,322) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994760
[2211374:MainThread](2024-04-22 23:27:13,322) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:27:13,322) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:27:16,509) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:27:16,743) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995350
[2211374:MainThread](2024-04-22 23:27:16,743) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:27:16,744) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:27:19,937) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:27:20,170) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995495
[2211374:MainThread](2024-04-22 23:27:20,171) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:27:20,171) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:27:23,348) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:27:23,581) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996670
[2211374:MainThread](2024-04-22 23:27:23,582) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:27:23,582) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:27:26,779) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:27:27,013) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995776
[2211374:MainThread](2024-04-22 23:27:27,013) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:27:27,013) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:27:30,189) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:27:30,423) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995110
[2211374:MainThread](2024-04-22 23:27:30,423) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:27:30,423) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:27:33,612) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:27:33,845) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995975
[2211374:MainThread](2024-04-22 23:27:33,846) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:27:33,846) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.994153 @ 7
[2211374:MainThread](2024-04-22 23:27:33,895) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-12-17 SH600000   -0.025577
           SH600004    0.049697
           SH600009    0.047727
           SH600010   -0.070885
           SH600011    0.011712
[2211374:MainThread](2024-04-22 23:27:35,558) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  84%|████████▍ | 37/44 [47:41<08:45, 75.01s/it][2211374:MainThread](2024-04-22 23:27:35,566) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:27:35,575) INFO - qlib.workflow - [recorder.py:341] - Recorder 16c9e875d34149ec8f30d1c8cfce0cd1 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:27:36,064) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:27:36,064) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:27:36,068) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:27:36,068) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:27:43,744) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.892654
            SH600004      0.892654
            SH600006      0.892654
            SH600007      0.892654
            SH600008      0.892654
                            ...   
2018-03-05  SZ300124      1.983090
            SZ300136      1.983090
            SZ300144      1.983090
            SZ300251      1.983090
            SZ300315      1.983090
Length: 686698, dtype: float64
[2211374:MainThread](2024-04-22 23:27:43,746) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:27:43,746) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:27:43,747) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:27:46,938) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:27:47,169) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998392
[2211374:MainThread](2024-04-22 23:27:47,171) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:27:47,171) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:27:50,365) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:27:50,596) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995412
[2211374:MainThread](2024-04-22 23:27:50,597) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:27:50,598) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:27:53,804) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:27:54,036) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995553
[2211374:MainThread](2024-04-22 23:27:54,036) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:27:54,036) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:27:57,237) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:27:57,469) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994919
[2211374:MainThread](2024-04-22 23:27:57,470) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:27:57,470) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:28:00,668) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:28:00,900) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995245
[2211374:MainThread](2024-04-22 23:28:00,900) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:28:00,901) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:28:04,102) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:28:04,335) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997193
[2211374:MainThread](2024-04-22 23:28:04,335) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:28:04,335) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:28:07,541) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:28:07,773) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994771
[2211374:MainThread](2024-04-22 23:28:07,774) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:28:07,775) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:28:10,919) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:28:11,151) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994578
[2211374:MainThread](2024-04-22 23:28:11,152) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:28:11,153) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:28:14,291) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:28:14,523) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995542
[2211374:MainThread](2024-04-22 23:28:14,524) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:28:14,524) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:28:17,641) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:28:17,874) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995081
[2211374:MainThread](2024-04-22 23:28:17,874) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:28:17,874) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:28:21,003) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:28:21,235) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995239
[2211374:MainThread](2024-04-22 23:28:21,236) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:28:21,236) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:28:24,397) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:28:24,629) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995127
[2211374:MainThread](2024-04-22 23:28:24,630) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:28:24,630) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:28:27,835) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:28:28,068) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995209
[2211374:MainThread](2024-04-22 23:28:28,068) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:28:28,068) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:28:31,258) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:28:31,490) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995136
[2211374:MainThread](2024-04-22 23:28:31,490) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:28:31,491) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:28:34,764) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:28:34,996) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994806
[2211374:MainThread](2024-04-22 23:28:34,996) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:28:34,996) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:28:38,247) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:28:38,481) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996170
[2211374:MainThread](2024-04-22 23:28:38,481) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:28:38,481) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.994578 @ 7
[2211374:MainThread](2024-04-22 23:28:38,533) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-01-15 SH600000   -0.024346
           SH600004   -0.002863
           SH600009   -0.101527
           SH600010    0.008010
           SH600011   -0.030885
[2211374:MainThread](2024-04-22 23:28:40,215) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  86%|████████▋ | 38/44 [48:46<07:11, 71.91s/it][2211374:MainThread](2024-04-22 23:28:40,222) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:28:40,232) INFO - qlib.workflow - [recorder.py:341] - Recorder fbfba2d0f156454184c8562cd110fbb8 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:28:40,723) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:28:40,723) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:28:40,726) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:28:40,727) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:28:48,410) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.644440
            SH600004      0.644440
            SH600006      0.644440
            SH600007      0.644440
            SH600008      0.644440
                            ...   
2018-04-02  SZ300124      1.922787
            SZ300136      1.922787
            SZ300144      1.922787
            SZ300251      1.922787
            SZ300315      1.922787
Length: 692433, dtype: float64
[2211374:MainThread](2024-04-22 23:28:48,412) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:28:48,412) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:28:48,413) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:28:51,647) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:28:51,854) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999250
[2211374:MainThread](2024-04-22 23:28:51,856) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:28:51,856) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:28:55,088) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:28:55,296) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996748
[2211374:MainThread](2024-04-22 23:28:55,297) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:28:55,297) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:28:58,507) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:28:58,715) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995717
[2211374:MainThread](2024-04-22 23:28:58,716) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:28:58,717) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:29:01,948) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:29:02,156) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995349
[2211374:MainThread](2024-04-22 23:29:02,157) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:29:02,158) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:29:05,411) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:29:05,618) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995795
[2211374:MainThread](2024-04-22 23:29:05,619) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:29:05,619) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:29:08,922) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:29:09,129) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996219
[2211374:MainThread](2024-04-22 23:29:09,130) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:29:09,130) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:29:12,407) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:29:12,616) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995329
[2211374:MainThread](2024-04-22 23:29:12,617) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:29:12,617) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:29:15,909) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:29:16,116) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996549
[2211374:MainThread](2024-04-22 23:29:16,116) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:29:16,117) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:29:19,411) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:29:19,625) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997717
[2211374:MainThread](2024-04-22 23:29:19,626) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:29:19,626) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:29:22,917) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:29:23,125) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999037
[2211374:MainThread](2024-04-22 23:29:23,126) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:29:23,126) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:29:26,412) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:29:26,620) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996618
[2211374:MainThread](2024-04-22 23:29:26,621) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:29:26,621) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:29:29,841) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:29:30,049) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996090
[2211374:MainThread](2024-04-22 23:29:30,050) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:29:30,050) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:29:33,277) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:29:33,486) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996442
[2211374:MainThread](2024-04-22 23:29:33,487) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:29:33,487) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:29:36,710) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:29:36,918) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997661
[2211374:MainThread](2024-04-22 23:29:36,919) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:29:36,919) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:29:40,159) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:29:40,368) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997241
[2211374:MainThread](2024-04-22 23:29:40,369) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:29:40,369) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995329 @ 6
[2211374:MainThread](2024-04-22 23:29:40,420) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-02-20 SH600000   -0.053043
           SH600004    0.109406
           SH600009    0.010738
           SH600010   -0.031259
           SH600011   -0.037361
[2211374:MainThread](2024-04-22 23:29:42,101) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  89%|████████▊ | 39/44 [49:48<05:44, 68.90s/it][2211374:MainThread](2024-04-22 23:29:42,109) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:29:42,119) INFO - qlib.workflow - [recorder.py:341] - Recorder a87c12fa0a1f4815bd8a96f13e63e0fd starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:29:42,601) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:29:42,602) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:29:42,606) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:29:42,606) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:29:50,373) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.706024
            SH600004      0.706024
            SH600006      0.706024
            SH600007      0.706024
            SH600008      0.706024
                            ...   
2018-05-04  SZ300124      1.754309
            SZ300136      1.754309
            SZ300144      1.754309
            SZ300251      1.754309
            SZ300315      1.754309
Length: 698132, dtype: float64
[2211374:MainThread](2024-04-22 23:29:50,375) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:29:50,375) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:29:50,376) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:29:53,717) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:29:53,924) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996734
[2211374:MainThread](2024-04-22 23:29:53,925) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:29:53,925) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:29:57,230) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:29:57,436) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996984
[2211374:MainThread](2024-04-22 23:29:57,437) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:29:57,437) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:30:00,752) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:30:00,958) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996985
[2211374:MainThread](2024-04-22 23:30:00,958) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:30:00,959) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:30:04,270) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:30:04,476) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996407
[2211374:MainThread](2024-04-22 23:30:04,477) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:30:04,478) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:30:07,819) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:30:08,027) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997929
[2211374:MainThread](2024-04-22 23:30:08,028) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:30:08,028) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:30:11,355) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:30:11,563) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995706
[2211374:MainThread](2024-04-22 23:30:11,564) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:30:11,564) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:30:14,919) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:30:15,127) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995687
[2211374:MainThread](2024-04-22 23:30:15,128) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:30:15,128) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:30:18,461) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:30:18,669) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995888
[2211374:MainThread](2024-04-22 23:30:18,670) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:30:18,670) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:30:22,005) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:30:22,210) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996610
[2211374:MainThread](2024-04-22 23:30:22,211) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:30:22,211) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:30:25,508) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:30:25,714) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996327
[2211374:MainThread](2024-04-22 23:30:25,715) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:30:25,715) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:30:29,038) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:30:29,245) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995674
[2211374:MainThread](2024-04-22 23:30:29,246) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:30:29,247) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:30:32,558) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:30:32,764) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996657
[2211374:MainThread](2024-04-22 23:30:32,765) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:30:32,765) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:30:36,107) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:30:36,316) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997443
[2211374:MainThread](2024-04-22 23:30:36,317) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:30:36,317) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:30:39,652) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:30:39,861) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996712
[2211374:MainThread](2024-04-22 23:30:39,861) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:30:39,861) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:30:43,136) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:30:43,344) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996169
[2211374:MainThread](2024-04-22 23:30:43,344) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:30:43,344) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:30:46,643) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:30:46,850) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996545
[2211374:MainThread](2024-04-22 23:30:46,850) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:30:46,850) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:30:50,120) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:30:50,328) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997959
[2211374:MainThread](2024-04-22 23:30:50,328) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:30:50,329) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:30:53,568) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:30:53,776) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999464
[2211374:MainThread](2024-04-22 23:30:53,776) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:30:53,776) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:30:57,027) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:30:57,237) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998015
[2211374:MainThread](2024-04-22 23:30:57,237) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:30:57,237) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995674 @ 10
[2211374:MainThread](2024-04-22 23:30:57,287) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-03-19 SH600000    0.016158
           SH600004    0.254770
           SH600009    0.097617
           SH600010   -0.050823
           SH600011    0.010218
[2211374:MainThread](2024-04-22 23:30:58,938) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  91%|█████████ | 40/44 [51:05<04:45, 71.28s/it][2211374:MainThread](2024-04-22 23:30:58,946) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:30:58,955) INFO - qlib.workflow - [recorder.py:341] - Recorder 74e26f38ed8f4b0790a81ae153cc466d starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:30:59,431) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:30:59,432) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:30:59,435) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:30:59,436) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:31:07,096) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.317286
            SH600004      1.317286
            SH600006      1.317286
            SH600007      1.317286
            SH600008      1.317286
                            ...   
2018-06-01  SZ300124      1.708045
            SZ300136      1.708045
            SZ300144      1.708045
            SZ300251      1.708045
            SZ300315      1.708045
Length: 703856, dtype: float64
[2211374:MainThread](2024-04-22 23:31:07,098) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:31:07,099) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:31:07,099) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:31:10,385) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:31:10,590) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998406
[2211374:MainThread](2024-04-22 23:31:10,591) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:31:10,592) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:31:13,854) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:31:14,059) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996625
[2211374:MainThread](2024-04-22 23:31:14,060) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:31:14,060) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:31:17,337) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:31:17,542) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997830
[2211374:MainThread](2024-04-22 23:31:17,542) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:31:17,542) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:31:20,810) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:31:21,015) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995554
[2211374:MainThread](2024-04-22 23:31:21,016) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:31:21,016) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:31:24,294) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:31:24,500) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996552
[2211374:MainThread](2024-04-22 23:31:24,500) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:31:24,500) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:31:27,765) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:31:27,973) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996728
[2211374:MainThread](2024-04-22 23:31:27,973) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:31:27,974) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:31:31,244) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:31:31,449) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996056
[2211374:MainThread](2024-04-22 23:31:31,449) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:31:31,450) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:31:34,720) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:31:34,927) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996698
[2211374:MainThread](2024-04-22 23:31:34,927) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:31:34,928) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:31:38,194) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:31:38,399) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995404
[2211374:MainThread](2024-04-22 23:31:38,400) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:31:38,401) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:31:41,679) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:31:41,891) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995745
[2211374:MainThread](2024-04-22 23:31:41,891) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:31:41,891) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:31:45,236) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:31:45,441) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997860
[2211374:MainThread](2024-04-22 23:31:45,442) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:31:45,442) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:31:48,795) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:31:49,002) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997599
[2211374:MainThread](2024-04-22 23:31:49,003) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:31:49,003) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:31:52,334) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:31:52,540) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996468
[2211374:MainThread](2024-04-22 23:31:52,541) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:31:52,541) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:31:55,893) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:31:56,098) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998034
[2211374:MainThread](2024-04-22 23:31:56,099) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:31:56,099) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:31:59,433) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:31:59,639) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998533
[2211374:MainThread](2024-04-22 23:31:59,639) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:31:59,639) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:32:02,988) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:32:03,193) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996652
[2211374:MainThread](2024-04-22 23:32:03,194) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:32:03,194) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:32:06,504) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:32:06,711) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998160
[2211374:MainThread](2024-04-22 23:32:06,711) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:32:06,712) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995404 @ 8
[2211374:MainThread](2024-04-22 23:32:06,762) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-04-17 SH600000   -0.014732
           SH600004    0.040400
           SH600009    0.035578
           SH600010   -0.016843
           SH600011   -0.020456
[2211374:MainThread](2024-04-22 23:32:08,437) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  93%|█████████▎| 41/44 [52:14<03:32, 70.75s/it][2211374:MainThread](2024-04-22 23:32:08,445) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:32:08,455) INFO - qlib.workflow - [recorder.py:341] - Recorder ca5fa7e2611f4004bfa8959db9dd22b1 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:32:09,042) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:32:09,043) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:32:09,047) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:32:09,047) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:32:17,173) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.939308
            SH600004      0.939308
            SH600006      0.939308
            SH600007      0.939308
            SH600008      0.939308
                            ...   
2018-07-02  SZ300136      1.561612
            SZ300144      1.561612
            SZ300251      1.561612
            SZ300408      1.561612
            SZ300433      1.561612
Length: 709547, dtype: float64
[2211374:MainThread](2024-04-22 23:32:17,176) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:32:17,176) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:32:17,176) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:32:20,585) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:32:20,816) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997320
[2211374:MainThread](2024-04-22 23:32:20,818) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:32:20,818) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:32:24,211) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:32:24,443) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996359
[2211374:MainThread](2024-04-22 23:32:24,444) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:32:24,444) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:32:27,821) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:32:28,053) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995890
[2211374:MainThread](2024-04-22 23:32:28,055) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:32:28,055) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:32:31,420) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:32:31,652) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995743
[2211374:MainThread](2024-04-22 23:32:31,653) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:32:31,653) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:32:34,988) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:32:35,220) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996248
[2211374:MainThread](2024-04-22 23:32:35,221) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:32:35,221) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:32:38,558) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:32:38,792) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996073
[2211374:MainThread](2024-04-22 23:32:38,792) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:32:38,792) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:32:42,118) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:32:42,352) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997768
[2211374:MainThread](2024-04-22 23:32:42,352) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:32:42,352) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:32:45,689) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:32:45,921) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997433
[2211374:MainThread](2024-04-22 23:32:45,922) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:32:45,922) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:32:49,241) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:32:49,472) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996961
[2211374:MainThread](2024-04-22 23:32:49,472) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:32:49,472) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:32:52,781) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:32:53,014) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997733
[2211374:MainThread](2024-04-22 23:32:53,014) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:32:53,014) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:32:56,399) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:32:56,629) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997593
[2211374:MainThread](2024-04-22 23:32:56,629) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:32:56,629) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:32:59,921) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:33:00,150) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997503
[2211374:MainThread](2024-04-22 23:33:00,150) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:33:00,151) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995743 @ 3
[2211374:MainThread](2024-04-22 23:33:00,200) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-05-20 SH600000   -0.043835
           SH600004    0.208875
           SH600009    0.064587
           SH600010    0.009520
           SH600011   -0.037847
[2211374:MainThread](2024-04-22 23:33:01,864) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  95%|█████████▌| 42/44 [53:08<02:11, 65.55s/it][2211374:MainThread](2024-04-22 23:33:01,872) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:33:01,881) INFO - qlib.workflow - [recorder.py:341] - Recorder 19740967ecac4516895153df4a67979c starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:33:02,345) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:33:02,345) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:33:02,348) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:33:02,348) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:33:10,054) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.639000
            SH600004      0.639000
            SH600006      0.639000
            SH600007      0.639000
            SH600008      0.639000
                            ...   
2018-07-30  SZ300136      1.372813
            SZ300144      1.372813
            SZ300251      1.372813
            SZ300408      1.372813
            SZ300433      1.372813
Length: 715298, dtype: float64
[2211374:MainThread](2024-04-22 23:33:10,056) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:33:10,057) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:33:10,057) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:33:13,404) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:33:13,600) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996678
[2211374:MainThread](2024-04-22 23:33:13,601) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:33:13,601) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:33:16,951) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:33:17,146) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997540
[2211374:MainThread](2024-04-22 23:33:17,147) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:33:17,147) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:33:20,451) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:33:20,646) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995566
[2211374:MainThread](2024-04-22 23:33:20,647) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:33:20,648) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:33:24,001) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:33:24,197) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995383
[2211374:MainThread](2024-04-22 23:33:24,198) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:33:24,198) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:33:27,539) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:33:27,735) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997422
[2211374:MainThread](2024-04-22 23:33:27,736) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:33:27,736) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:33:31,083) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:33:31,279) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996134
[2211374:MainThread](2024-04-22 23:33:31,279) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:33:31,280) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:33:34,613) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:33:34,809) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996060
[2211374:MainThread](2024-04-22 23:33:34,809) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:33:34,809) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:33:38,160) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:33:38,356) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996409
[2211374:MainThread](2024-04-22 23:33:38,356) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:33:38,357) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:33:41,694) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:33:41,890) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997076
[2211374:MainThread](2024-04-22 23:33:41,890) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:33:41,891) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:33:45,224) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:33:45,420) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997146
[2211374:MainThread](2024-04-22 23:33:45,421) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:33:45,421) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:33:48,746) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:33:48,942) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998041
[2211374:MainThread](2024-04-22 23:33:48,943) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:33:48,943) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:33:52,290) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:33:52,486) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998290
[2211374:MainThread](2024-04-22 23:33:52,487) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:33:52,487) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995383 @ 3
[2211374:MainThread](2024-04-22 23:33:52,537) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-06-17 SH600000    0.027688
           SH600004    0.061559
           SH600009    0.029989
           SH600010   -0.003304
           SH600011    0.014077
[2211374:MainThread](2024-04-22 23:33:54,199) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  98%|█████████▊| 43/44 [54:00<01:01, 61.59s/it][2211374:MainThread](2024-04-22 23:33:54,206) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[2211374:MainThread](2024-04-22 23:33:54,216) INFO - qlib.workflow - [recorder.py:341] - Recorder cbfc274127ff4b9ba7b66c19dfcbb419 starts running under Experiment 13 ...
[2211374:MainThread](2024-04-22 23:33:54,680) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:33:54,681) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:33:54,683) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:33:54,683) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:34:02,419) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.017368
            SH600004      1.017368
            SH600006      1.017368
            SH600007      1.017368
            SH600008      1.017368
                            ...   
2018-08-27  SZ300136      1.846867
            SZ300144      1.846867
            SZ300251      1.846867
            SZ300408      1.846867
            SZ300433      1.846867
Length: 721109, dtype: float64
[2211374:MainThread](2024-04-22 23:34:02,421) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:34:02,421) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:34:02,422) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:34:05,897) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:34:06,137) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997036
[2211374:MainThread](2024-04-22 23:34:06,138) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:34:06,139) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:34:09,600) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:34:09,839) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996832
[2211374:MainThread](2024-04-22 23:34:09,840) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:34:09,840) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:34:13,310) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:34:13,545) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996060
[2211374:MainThread](2024-04-22 23:34:13,546) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:34:13,546) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:34:17,010) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:34:17,247) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996378
[2211374:MainThread](2024-04-22 23:34:17,247) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:34:17,248) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:34:20,597) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:34:20,832) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995829
[2211374:MainThread](2024-04-22 23:34:20,833) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:34:20,834) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:34:24,200) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:34:24,439) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996674
[2211374:MainThread](2024-04-22 23:34:24,439) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:34:24,440) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:34:27,803) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:34:28,038) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997365
[2211374:MainThread](2024-04-22 23:34:28,039) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:34:28,039) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:34:31,404) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:34:31,640) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997367
[2211374:MainThread](2024-04-22 23:34:31,640) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:34:31,641) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:34:35,003) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:34:35,238) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996677
[2211374:MainThread](2024-04-22 23:34:35,239) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:34:35,239) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:34:38,618) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:34:38,855) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999444
[2211374:MainThread](2024-04-22 23:34:38,855) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:34:38,856) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:34:42,211) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:34:42,450) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999254
[2211374:MainThread](2024-04-22 23:34:42,450) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:34:42,451) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:34:45,854) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:34:46,093) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997166
[2211374:MainThread](2024-04-22 23:34:46,093) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:34:46,094) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:34:49,515) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:34:49,751) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998170
[2211374:MainThread](2024-04-22 23:34:49,751) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:34:49,751) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995829 @ 4
[2211374:MainThread](2024-04-22 23:34:49,792) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-07-17 SH600000    0.098391
           SH600004   -0.076958
           SH600009    0.063822
           SH600010    0.088542
           SH600011    0.120997
[2211374:MainThread](2024-04-22 23:34:51,460) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks: 100%|██████████| 44/44 [54:57<00:00, 60.29s/it]train tasks: 100%|██████████| 44/44 [54:57<00:00, 74.95s/it]
[2211374:MainThread](2024-04-22 23:34:51,577) INFO - qlib.timer - [log.py:127] - Time cost: 0.076s | Time to `list_recorders` in RecorderCollector Done
[2211374:MainThread](2024-04-22 23:34:51,577) INFO - qlib.RecorderCollector - [collect.py:226] - Nubmer of recorders after filter: defaultdict(<class 'int'>, {'FINISHED': 44})
[2211374:MainThread](2024-04-22 23:34:51,616) INFO - qlib.RollingEnsemble - [ensemble.py:83] - keys in group: ['cbfc274127ff4b9ba7b66c19dfcbb419', '19740967ecac4516895153df4a67979c', 'ca5fa7e2611f4004bfa8959db9dd22b1', '74e26f38ed8f4b0790a81ae153cc466d', 'a87c12fa0a1f4815bd8a96f13e63e0fd', 'fbfba2d0f156454184c8562cd110fbb8', '16c9e875d34149ec8f30d1c8cfce0cd1', '1495706a2dc3485797b93b2941c69a4f', '181af13886d64d5ca7ec2665e072f6ee', '02c180e204ea41f2a2b79121947d45d9', 'e78ef493351b48f59e98482e88fa2756', '8ed8d093dd694354970529e878a8844e', '2f190dc228f04ed1a4c0b879ad153aa3', '4005dbc2893f42cbbfba86d0a7264122', '6d1bf06957c6476a88b0943eab41a11e', '7c575438a3084a43b3d81dfd6337b87b', '6a540452b7dd417183767221991dc6b6', '1af72d5b2e104d90a1eb00b9f0a1a52b', 'a4cca9b96bed49858c21e69ff0943508', 'b6a91210c4ee465bae7d633802150352', '96c176e155f14c899fde11fb1ee61103', '38b2d634b9e04ec4a737913d00cd5167', 'a03b14cbca4542c2bd4f6f41a84422c5', '289c581fd58e466680543c37912cb1e9', 'd8067c9af7d24c75b9859f98138f068b', '2baacc4a09974634a642911909299bea', 'c7263f731c0e4ce79de6005be5ad58d9', '64cbe886318e410388391b0d2b70d293', 'd0d05869a5d74f6eb58516cb0ae25863', 'd664e6e6b6ab4f598aab40bfdac39834', '5c85cbd418464e3ebc7198369b57c8b2', '62c950c772344517ab60bd3332c65c5d', 'a4f9f9951dd343ebb225eecdb8d99ef9', '0ed2913244814f5eaf7556203ff0c853', '328d35a47fba4b9685f98049b7e5391b', 'da397a0e30ec47c2aec3b23766400efe', '3965991483714ef591843e222c022ec3', 'd6656f329b8d4d48b459679b62bee2c8', '1e3c6863486e4aafaa714dff90945d7b', 'a683f87d6d404f87ae4f6b38bf959991', 'a4a0fa15ac4941eca44b0f85e940119f', '5b24e52b44c748689cb8f065eb6133d4', '4ad034c69e2342b0b3e09948d6ed44db', '72e712dd1b5f4db69e58b13113701f88']
[2211374:MainThread](2024-04-22 23:34:51,711) INFO - qlib.RollingEnsemble - [ensemble.py:83] - keys in group: ['cbfc274127ff4b9ba7b66c19dfcbb419', '19740967ecac4516895153df4a67979c', 'ca5fa7e2611f4004bfa8959db9dd22b1', '74e26f38ed8f4b0790a81ae153cc466d', 'a87c12fa0a1f4815bd8a96f13e63e0fd', 'fbfba2d0f156454184c8562cd110fbb8', '16c9e875d34149ec8f30d1c8cfce0cd1', '1495706a2dc3485797b93b2941c69a4f', '181af13886d64d5ca7ec2665e072f6ee', '02c180e204ea41f2a2b79121947d45d9', 'e78ef493351b48f59e98482e88fa2756', '8ed8d093dd694354970529e878a8844e', '2f190dc228f04ed1a4c0b879ad153aa3', '4005dbc2893f42cbbfba86d0a7264122', '6d1bf06957c6476a88b0943eab41a11e', '7c575438a3084a43b3d81dfd6337b87b', '6a540452b7dd417183767221991dc6b6', '1af72d5b2e104d90a1eb00b9f0a1a52b', 'a4cca9b96bed49858c21e69ff0943508', 'b6a91210c4ee465bae7d633802150352', '96c176e155f14c899fde11fb1ee61103', '38b2d634b9e04ec4a737913d00cd5167', 'a03b14cbca4542c2bd4f6f41a84422c5', '289c581fd58e466680543c37912cb1e9', 'd8067c9af7d24c75b9859f98138f068b', '2baacc4a09974634a642911909299bea', 'c7263f731c0e4ce79de6005be5ad58d9', '64cbe886318e410388391b0d2b70d293', 'd0d05869a5d74f6eb58516cb0ae25863', 'd664e6e6b6ab4f598aab40bfdac39834', '5c85cbd418464e3ebc7198369b57c8b2', '62c950c772344517ab60bd3332c65c5d', 'a4f9f9951dd343ebb225eecdb8d99ef9', '0ed2913244814f5eaf7556203ff0c853', '328d35a47fba4b9685f98049b7e5391b', 'da397a0e30ec47c2aec3b23766400efe', '3965991483714ef591843e222c022ec3', 'd6656f329b8d4d48b459679b62bee2c8', '1e3c6863486e4aafaa714dff90945d7b', 'a683f87d6d404f87ae4f6b38bf959991', 'a4a0fa15ac4941eca44b0f85e940119f', '5b24e52b44c748689cb8f065eb6133d4', '4ad034c69e2342b0b3e09948d6ed44db', '72e712dd1b5f4db69e58b13113701f88']
[2211374:MainThread](2024-04-22 23:34:51,807) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name final_rolling_cn_data_csi300_GRU_alpha360_h1_step20_rankFalse_2024-04-22_22:39:53_DDG-DA.
[2211374:MainThread](2024-04-22 23:34:51,816) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[2211374:MainThread](2024-04-22 23:34:51,825) INFO - qlib.workflow - [recorder.py:341] - Recorder c1826abd9e3d4d438f36b249e6e62af5 starts running under Experiment 14 ...
[2211374:MainThread](2024-04-22 23:34:52,310) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/scipy/stats/_stats_py.py:4916: ConstantInputWarning: An input array is constant; the correlation coefficient is not defined.
  warnings.warn(stats.ConstantInputWarning(warn_msg))
{'IC': 0.054664481501801206,
 'ICIR': 0.4444813839897373,
 'Rank IC': 0.05509317193255259,
 'Rank ICIR': 0.45438042600711764}
[2211374:MainThread](2024-04-22 23:34:54,001) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2211374:MainThread](2024-04-22 23:35:19,085) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2211374:MainThread](2024-04-22 23:35:19,087) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2211374:MainThread](2024-04-22 23:35:19,093) WARNING - qlib.online operator - [exchange.py:226] - factor.day.bin file not exists or factor contains `nan`. Order using adjusted_price.
[2211374:MainThread](2024-04-22 23:35:19,093) WARNING - qlib.online operator - [exchange.py:228] - trade unit 100 is not supported in adjusted_price mode.
[2211374:MainThread](2024-04-22 23:35:27,044) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fb8d21b35b0>
backtest loop:   0%|          | 0/872 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 7/872 [00:00<00:13, 62.57it/s]backtest loop:   2%|▏         | 14/872 [00:00<00:15, 57.02it/s]backtest loop:   2%|▏         | 20/872 [00:00<00:15, 53.65it/s]backtest loop:   3%|▎         | 27/872 [00:00<00:14, 56.89it/s]backtest loop:   4%|▍         | 34/872 [00:00<00:15, 55.22it/s]backtest loop:   5%|▍         | 41/872 [00:00<00:14, 57.58it/s]backtest loop:   6%|▌         | 48/872 [00:00<00:13, 59.19it/s]backtest loop:   6%|▌         | 54/872 [00:00<00:14, 56.26it/s]backtest loop:   7%|▋         | 61/872 [00:01<00:13, 58.23it/s]backtest loop:   8%|▊         | 67/872 [00:01<00:14, 55.86it/s]backtest loop:   8%|▊         | 74/872 [00:01<00:13, 58.04it/s]backtest loop:   9%|▉         | 81/872 [00:01<00:14, 56.42it/s]backtest loop:  10%|█         | 88/872 [00:01<00:13, 58.45it/s]backtest loop:  11%|█         | 95/872 [00:01<00:12, 59.99it/s]backtest loop:  12%|█▏        | 102/872 [00:01<00:13, 58.43it/s]backtest loop:  12%|█▎        | 109/872 [00:01<00:13, 57.32it/s]backtest loop:  13%|█▎        | 116/872 [00:01<00:12, 60.44it/s]backtest loop:  14%|█▍        | 123/872 [00:02<00:12, 62.24it/s]backtest loop:  15%|█▍        | 130/872 [00:02<00:15, 49.07it/s]backtest loop:  16%|█▌        | 137/872 [00:02<00:13, 53.68it/s]backtest loop:  17%|█▋        | 144/872 [00:02<00:13, 54.63it/s]backtest loop:  17%|█▋        | 151/872 [00:02<00:12, 58.10it/s]backtest loop:  18%|█▊        | 158/872 [00:02<00:11, 61.11it/s]backtest loop:  19%|█▉        | 165/872 [00:02<00:11, 60.05it/s]backtest loop:  20%|█▉        | 172/872 [00:02<00:11, 62.24it/s]backtest loop:  21%|██        | 179/872 [00:03<00:11, 60.89it/s]backtest loop:  21%|██▏       | 186/872 [00:03<00:10, 62.90it/s]backtest loop:  22%|██▏       | 194/872 [00:03<00:10, 62.63it/s]backtest loop:  23%|██▎       | 202/872 [00:03<00:10, 65.71it/s]backtest loop:  24%|██▍       | 209/872 [00:03<00:10, 63.14it/s]backtest loop:  25%|██▍       | 216/872 [00:03<00:10, 64.55it/s]backtest loop:  26%|██▌       | 223/872 [00:03<00:09, 65.72it/s]backtest loop:  26%|██▋       | 230/872 [00:03<00:10, 63.02it/s]backtest loop:  27%|██▋       | 238/872 [00:03<00:09, 65.62it/s]backtest loop:  28%|██▊       | 245/872 [00:04<00:09, 63.89it/s]backtest loop:  29%|██▉       | 252/872 [00:04<00:09, 65.24it/s]backtest loop:  30%|██▉       | 259/872 [00:04<00:09, 63.08it/s]backtest loop:  31%|███       | 266/872 [00:04<00:09, 64.11it/s]backtest loop:  31%|███▏      | 273/872 [00:04<00:09, 62.62it/s]backtest loop:  32%|███▏      | 280/872 [00:04<00:09, 60.56it/s]backtest loop:  33%|███▎      | 288/872 [00:04<00:09, 61.19it/s]backtest loop:  34%|███▍      | 296/872 [00:04<00:08, 65.04it/s]backtest loop:  35%|███▍      | 303/872 [00:05<00:08, 63.86it/s]backtest loop:  36%|███▌      | 310/872 [00:05<00:08, 64.89it/s]backtest loop:  36%|███▋      | 317/872 [00:05<00:08, 62.49it/s]backtest loop:  37%|███▋      | 324/872 [00:05<00:09, 60.66it/s]backtest loop:  38%|███▊      | 331/872 [00:05<00:08, 62.72it/s]backtest loop:  39%|███▉      | 338/872 [00:05<00:08, 64.06it/s]backtest loop:  40%|███▉      | 345/872 [00:05<00:08, 62.71it/s]backtest loop:  40%|████      | 352/872 [00:05<00:08, 63.55it/s]backtest loop:  41%|████      | 359/872 [00:05<00:08, 63.21it/s]backtest loop:  42%|████▏     | 366/872 [00:06<00:07, 63.66it/s]backtest loop:  43%|████▎     | 373/872 [00:06<00:08, 60.91it/s]backtest loop:  44%|████▎     | 380/872 [00:06<00:07, 62.08it/s]backtest loop:  44%|████▍     | 387/872 [00:06<00:07, 63.21it/s]backtest loop:  45%|████▌     | 394/872 [00:06<00:07, 60.91it/s]backtest loop:  46%|████▌     | 401/872 [00:06<00:07, 63.04it/s]backtest loop:  47%|████▋     | 408/872 [00:06<00:07, 60.29it/s]backtest loop:  48%|████▊     | 415/872 [00:06<00:07, 62.57it/s]backtest loop:  48%|████▊     | 422/872 [00:06<00:07, 63.94it/s]backtest loop:  49%|████▉     | 429/872 [00:07<00:07, 61.09it/s]backtest loop:  50%|█████     | 437/872 [00:07<00:07, 61.65it/s]backtest loop:  51%|█████     | 444/872 [00:07<00:06, 62.83it/s]backtest loop:  52%|█████▏    | 451/872 [00:07<00:06, 63.73it/s]backtest loop:  53%|█████▎    | 458/872 [00:07<00:06, 61.11it/s]backtest loop:  53%|█████▎    | 465/872 [00:07<00:06, 62.48it/s]backtest loop:  54%|█████▍    | 472/872 [00:07<00:06, 60.48it/s]backtest loop:  55%|█████▍    | 479/872 [00:07<00:06, 61.83it/s]backtest loop:  56%|█████▌    | 486/872 [00:07<00:06, 63.06it/s]backtest loop:  57%|█████▋    | 493/872 [00:08<00:06, 60.50it/s]backtest loop:  57%|█████▋    | 500/872 [00:08<00:06, 58.23it/s]backtest loop:  58%|█████▊    | 507/872 [00:08<00:06, 59.56it/s]backtest loop:  59%|█████▉    | 514/872 [00:08<00:05, 60.58it/s]backtest loop:  60%|█████▉    | 521/872 [00:08<00:05, 58.77it/s]backtest loop:  61%|██████    | 528/872 [00:08<00:05, 60.65it/s]backtest loop:  61%|██████▏   | 535/872 [00:08<00:05, 58.54it/s]backtest loop:  62%|██████▏   | 542/872 [00:08<00:05, 60.25it/s]backtest loop:  63%|██████▎   | 549/872 [00:09<00:05, 58.19it/s]backtest loop:  64%|██████▍   | 556/872 [00:09<00:05, 59.91it/s]backtest loop:  65%|██████▍   | 563/872 [00:09<00:05, 60.80it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:  65%|██████▌   | 570/872 [00:09<00:04, 62.74it/s]backtest loop:  66%|██████▌   | 577/872 [00:09<00:04, 59.16it/s]backtest loop:  67%|██████▋   | 584/872 [00:09<00:04, 60.17it/s]backtest loop:  68%|██████▊   | 591/872 [00:09<00:04, 57.93it/s]backtest loop:  69%|██████▊   | 598/872 [00:09<00:04, 60.00it/s]backtest loop:  69%|██████▉   | 605/872 [00:09<00:04, 57.95it/s]backtest loop:  70%|███████   | 612/872 [00:10<00:04, 59.35it/s]backtest loop:  71%|███████   | 619/872 [00:10<00:04, 60.43it/s]backtest loop:  72%|███████▏  | 626/872 [00:10<00:04, 57.86it/s]backtest loop:  73%|███████▎  | 633/872 [00:10<00:04, 59.20it/s]backtest loop:  73%|███████▎  | 640/872 [00:10<00:04, 57.30it/s]backtest loop:  74%|███████▍  | 647/872 [00:10<00:03, 58.96it/s]backtest loop:  75%|███████▌  | 654/872 [00:10<00:03, 59.98it/s]backtest loop:  76%|███████▌  | 661/872 [00:10<00:03, 57.58it/s]backtest loop:  77%|███████▋  | 668/872 [00:11<00:03, 59.06it/s]backtest loop:  77%|███████▋  | 674/872 [00:11<00:03, 53.22it/s]backtest loop:  78%|███████▊  | 681/872 [00:11<00:03, 55.77it/s]backtest loop:  79%|███████▉  | 687/872 [00:11<00:03, 56.65it/s]backtest loop:  80%|███████▉  | 694/872 [00:11<00:03, 55.30it/s]backtest loop:  80%|████████  | 701/872 [00:11<00:02, 57.45it/s]backtest loop:  81%|████████  | 708/872 [00:11<00:02, 59.12it/s]backtest loop:  82%|████████▏ | 714/872 [00:11<00:02, 56.39it/s]backtest loop:  83%|████████▎ | 721/872 [00:11<00:02, 58.20it/s]backtest loop:  83%|████████▎ | 728/872 [00:12<00:02, 59.57it/s]backtest loop:  84%|████████▍ | 734/872 [00:12<00:02, 53.66it/s]backtest loop:  85%|████████▍ | 741/872 [00:12<00:02, 56.06it/s]backtest loop:  86%|████████▌ | 747/872 [00:12<00:02, 54.37it/s]backtest loop:  86%|████████▋ | 754/872 [00:12<00:02, 57.17it/s]backtest loop:  87%|████████▋ | 761/872 [00:12<00:01, 58.99it/s]backtest loop:  88%|████████▊ | 767/872 [00:12<00:01, 55.57it/s]backtest loop:  89%|████████▉ | 774/872 [00:12<00:01, 57.55it/s]backtest loop:  90%|████████▉ | 781/872 [00:13<00:01, 59.12it/s]backtest loop:  90%|█████████ | 787/872 [00:13<00:01, 56.45it/s]backtest loop:  91%|█████████ | 794/872 [00:13<00:01, 58.29it/s]backtest loop:  92%|█████████▏| 801/872 [00:13<00:01, 56.49it/s]backtest loop:  93%|█████████▎| 808/872 [00:13<00:01, 58.33it/s]backtest loop:  93%|█████████▎| 814/872 [00:13<00:01, 55.92it/s]backtest loop:  94%|█████████▍| 821/872 [00:13<00:00, 58.15it/s]backtest loop:  95%|█████████▍| 828/872 [00:13<00:00, 56.41it/s]backtest loop:  96%|█████████▌| 835/872 [00:13<00:00, 58.45it/s]backtest loop:  97%|█████████▋| 842/872 [00:14<00:00, 59.70it/s]backtest loop:  97%|█████████▋| 849/872 [00:14<00:00, 57.43it/s]backtest loop:  98%|█████████▊| 856/872 [00:14<00:00, 56.07it/s]backtest loop:  99%|█████████▉| 863/872 [00:14<00:00, 57.96it/s]backtest loop: 100%|█████████▉| 870/872 [00:14<00:00, 59.47it/s]backtest loop: 100%|██████████| 872/872 [00:14<00:00, 59.60it/s]
[2211374:MainThread](2024-04-22 23:35:41,770) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 14
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000495
std                0.012300
annualized_return  0.117864
information_ratio  0.621155
max_drawdown      -0.370479
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000564
std                0.005338
annualized_return  0.134313
information_ratio  1.630898
max_drawdown      -0.053170
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000388
std                0.005337
annualized_return  0.092374
information_ratio  1.121913
max_drawdown      -0.057206
[2211374:MainThread](2024-04-22 23:35:41,783) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 14
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Remove CSRankNorm
{'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': datetime.date(2008, 1, 1), 'end_time': datetime.date(2020, 8, 1), 'fit_start_time': datetime.date(2008, 1, 1), 'fit_end_time': datetime.date(2014, 12, 31), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
[2211374:MainThread](2024-04-22 23:35:42,597) INFO - qlib.RollingBenchmark - [rolling_benchmark.py:208] - {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 5000, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/baseline/cn_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': [datetime.date(2008, 1, 1), datetime.date(2014, 12, 31)], 'valid': [datetime.date(2015, 1, 1), datetime.date(2016, 12, 31)], 'test': [datetime.date(2017, 1, 1), datetime.date(2020, 8, 1)]}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `final_rolling_cn_data_csi300_GRU_alpha360_h1_step20_rankFalse_2024-04-22_22:39:53_DDG-DA`.
{'1day.excess_return_with_cost.annualized_return': [0.0923740706897112],
 '1day.excess_return_with_cost.information_ratio': [1.12191299950881],
 '1day.excess_return_with_cost.max_drawdown': [-0.05720611471621033],
 'IC': [0.054664481501801206],
 'ICIR': [0.4444813839897373],
 'Rank IC': [0.05509317193255259],
 'Rank ICIR': [0.45438042600711764],
 'mae': [0.6961897611618042],
 'mse': [0.9954380989074707]}
Remove CSRankNorm
{'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': datetime.date(2008, 1, 1), 'end_time': datetime.date(2020, 8, 1), 'fit_start_time': datetime.date(2008, 1, 1), 'fit_end_time': datetime.date(2014, 12, 31), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
[2211374:MainThread](2024-04-22 23:35:46,983) INFO - qlib.RollingBenchmark - [rolling_benchmark.py:208] - {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 5000, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/baseline/cn_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': [datetime.date(2008, 1, 1), datetime.date(2014, 12, 31)], 'valid': [datetime.date(2015, 1, 1), datetime.date(2016, 12, 31)], 'test': [datetime.date(2017, 1, 1), datetime.date(2020, 8, 1)]}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
[2211374:MainThread](2024-04-22 23:35:46,994) INFO - qlib.MetaDatasetDS - [dataset.py:316] - Example task for training meta model: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 5000, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/baseline/cn_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-02 00:00:00'), Timestamp('2014-12-31 00:00:00')), 'valid': (Timestamp('2015-01-05 00:00:00'), Timestamp('2016-12-29 00:00:00')), 'test': (Timestamp('2017-01-03 00:00:00'), Timestamp('2017-02-06 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/44 [00:00<?, ?it/s]creating meta tasks:   2%|▏         | 1/44 [00:00<00:15,  2.70it/s]creating meta tasks:   5%|▍         | 2/44 [00:00<00:16,  2.49it/s]creating meta tasks:   7%|▋         | 3/44 [00:01<00:16,  2.44it/s]creating meta tasks:   9%|▉         | 4/44 [00:01<00:16,  2.41it/s]creating meta tasks:  11%|█▏        | 5/44 [00:02<00:16,  2.36it/s]creating meta tasks:  14%|█▎        | 6/44 [00:02<00:16,  2.32it/s]creating meta tasks:  16%|█▌        | 7/44 [00:02<00:16,  2.30it/s]creating meta tasks:  18%|█▊        | 8/44 [00:03<00:15,  2.28it/s]creating meta tasks:  20%|██        | 9/44 [00:03<00:14,  2.36it/s]creating meta tasks:  23%|██▎       | 10/44 [00:04<00:14,  2.41it/s]creating meta tasks:  25%|██▌       | 11/44 [00:04<00:13,  2.44it/s]creating meta tasks:  27%|██▋       | 12/44 [00:04<00:13,  2.46it/s]creating meta tasks:  30%|██▉       | 13/44 [00:05<00:12,  2.47it/s]creating meta tasks:  32%|███▏      | 14/44 [00:05<00:12,  2.48it/s]creating meta tasks:  34%|███▍      | 15/44 [00:06<00:11,  2.48it/s]creating meta tasks:  36%|███▋      | 16/44 [00:06<00:11,  2.48it/s]creating meta tasks:  39%|███▊      | 17/44 [00:07<00:10,  2.48it/s]creating meta tasks:  41%|████      | 18/44 [00:07<00:10,  2.47it/s]creating meta tasks:  43%|████▎     | 19/44 [00:07<00:10,  2.46it/s]creating meta tasks:  45%|████▌     | 20/44 [00:08<00:09,  2.45it/s]creating meta tasks:  48%|████▊     | 21/44 [00:08<00:09,  2.44it/s]creating meta tasks:  50%|█████     | 22/44 [00:09<00:09,  2.43it/s]creating meta tasks:  52%|█████▏    | 23/44 [00:09<00:08,  2.43it/s]creating meta tasks:  55%|█████▍    | 24/44 [00:09<00:08,  2.43it/s]creating meta tasks:  57%|█████▋    | 25/44 [00:10<00:07,  2.42it/s]creating meta tasks:  59%|█████▉    | 26/44 [00:10<00:07,  2.42it/s]creating meta tasks:  61%|██████▏   | 27/44 [00:11<00:07,  2.40it/s]creating meta tasks:  64%|██████▎   | 28/44 [00:11<00:06,  2.39it/s]creating meta tasks:  66%|██████▌   | 29/44 [00:12<00:06,  2.29it/s]creating meta tasks:  68%|██████▊   | 30/44 [00:12<00:06,  2.22it/s]creating meta tasks:  70%|███████   | 31/44 [00:13<00:06,  2.16it/s]creating meta tasks:  73%|███████▎  | 32/44 [00:13<00:05,  2.20it/s]creating meta tasks:  75%|███████▌  | 33/44 [00:13<00:04,  2.23it/s]creating meta tasks:  77%|███████▋  | 34/44 [00:14<00:04,  2.25it/s]creating meta tasks:  80%|███████▉  | 35/44 [00:14<00:03,  2.27it/s]creating meta tasks:  82%|████████▏ | 36/44 [00:15<00:03,  2.27it/s]creating meta tasks:  84%|████████▍ | 37/44 [00:15<00:03,  2.27it/s]creating meta tasks:  86%|████████▋ | 38/44 [00:16<00:02,  2.27it/s]creating meta tasks:  89%|████████▊ | 39/44 [00:16<00:02,  2.09it/s]creating meta tasks:  91%|█████████ | 40/44 [00:17<00:01,  2.14it/s]creating meta tasks:  93%|█████████▎| 41/44 [00:17<00:01,  2.17it/s]creating meta tasks:  95%|█████████▌| 42/44 [00:17<00:00,  2.19it/s]creating meta tasks:  98%|█████████▊| 43/44 [00:18<00:00,  2.17it/s]creating meta tasks: 100%|██████████| 44/44 [00:18<00:00,  2.18it/s]creating meta tasks: 100%|██████████| 44/44 [00:18<00:00,  2.33it/s]
train tasks:   0%|          | 0/44 [00:00<?, ?it/s][2211374:MainThread](2024-04-22 23:36:06,191) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name rolling_cn_data_csi300_GRU_alpha360_h1_step20_rankFalse_2024-04-22_23:36:06_DDG-DA.
[2211374:MainThread](2024-04-22 23:36:06,201) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:36:06,211) INFO - qlib.workflow - [recorder.py:341] - Recorder 96c1053246af4f1b96f6b2e125f73efb starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:36:06,871) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:36:06,872) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:36:06,875) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:36:06,876) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:36:14,816) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.531157
            SH600004      0.531157
            SH600006      0.531157
            SH600007      0.531157
            SH600008      0.531157
                            ...   
2014-12-31  SZ300070      1.926482
            SZ300124      1.926482
            SZ300133      1.926482
            SZ300146      1.926482
            SZ300251      1.926482
Length: 478007, dtype: float64
[2211374:MainThread](2024-04-22 23:36:14,819) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:36:14,819) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:36:14,819) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:36:17,147) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:36:17,369) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995033
[2211374:MainThread](2024-04-22 23:36:17,371) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:36:17,371) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:36:19,690) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:36:19,909) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994848
[2211374:MainThread](2024-04-22 23:36:19,910) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:36:19,911) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:36:22,202) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:36:22,421) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994572
[2211374:MainThread](2024-04-22 23:36:22,422) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:36:22,423) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:36:24,717) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:36:24,936) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993579
[2211374:MainThread](2024-04-22 23:36:24,938) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:36:24,938) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:36:27,245) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:36:27,465) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993552
[2211374:MainThread](2024-04-22 23:36:27,466) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:36:27,466) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:36:29,754) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:36:29,973) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993951
[2211374:MainThread](2024-04-22 23:36:29,974) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:36:29,974) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:36:32,275) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:36:32,496) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994075
[2211374:MainThread](2024-04-22 23:36:32,497) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:36:32,497) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:36:34,809) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:36:35,031) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993192
[2211374:MainThread](2024-04-22 23:36:35,033) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:36:35,033) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:36:37,336) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:36:37,558) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992761
[2211374:MainThread](2024-04-22 23:36:37,559) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:36:37,560) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:36:39,885) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:36:40,105) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993057
[2211374:MainThread](2024-04-22 23:36:40,106) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:36:40,106) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:36:42,406) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:36:42,628) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992940
[2211374:MainThread](2024-04-22 23:36:42,628) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:36:42,628) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:36:44,932) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:36:45,155) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994390
[2211374:MainThread](2024-04-22 23:36:45,155) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:36:45,155) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:36:47,459) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:36:47,678) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994204
[2211374:MainThread](2024-04-22 23:36:47,679) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:36:47,679) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:36:49,955) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:36:50,175) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992419
[2211374:MainThread](2024-04-22 23:36:50,176) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:36:50,177) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:36:52,428) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:36:52,653) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992268
[2211374:MainThread](2024-04-22 23:36:52,654) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:36:52,654) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:36:54,912) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:36:55,135) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992371
[2211374:MainThread](2024-04-22 23:36:55,136) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:36:55,136) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:36:57,396) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:36:57,619) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992642
[2211374:MainThread](2024-04-22 23:36:57,619) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:36:57,620) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:36:59,901) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:00,122) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993502
[2211374:MainThread](2024-04-22 23:37:00,123) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:37:00,123) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:37:02,420) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:02,642) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992835
[2211374:MainThread](2024-04-22 23:37:02,642) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:37:02,642) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:37:04,921) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:05,142) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993823
[2211374:MainThread](2024-04-22 23:37:05,142) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:37:05,142) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:37:07,432) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:07,652) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994683
[2211374:MainThread](2024-04-22 23:37:07,653) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:37:07,653) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:37:09,952) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:10,176) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995471
[2211374:MainThread](2024-04-22 23:37:10,176) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 23:37:10,176) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:37:12,478) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:12,704) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994797
[2211374:MainThread](2024-04-22 23:37:12,705) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:37:12,705) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992268 @ 14
[2211374:MainThread](2024-04-22 23:37:12,755) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-01-03 SH600000   -0.039998
           SH600008    0.003016
           SH600009    0.035476
           SH600010   -0.059661
           SH600015   -0.049842
[2211374:MainThread](2024-04-22 23:37:14,434) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   2%|▏         | 1/44 [01:08<48:54, 68.25s/it][2211374:MainThread](2024-04-22 23:37:14,443) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:37:14,453) INFO - qlib.workflow - [recorder.py:341] - Recorder 1e1db6d842c448b6b910f940d50d38de starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:37:15,003) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:37:15,004) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:37:15,007) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:37:15,008) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:37:22,950) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.540720
            SH600004      0.540720
            SH600006      0.540720
            SH600007      0.540720
            SH600008      0.540720
                            ...   
2015-01-30  SZ300070      1.993667
            SZ300124      1.993667
            SZ300133      1.993667
            SZ300146      1.993667
            SZ300251      1.993667
Length: 483831, dtype: float64
[2211374:MainThread](2024-04-22 23:37:22,952) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:37:22,953) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:37:22,953) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:37:25,262) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:25,486) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995037
[2211374:MainThread](2024-04-22 23:37:25,487) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:37:25,488) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:37:27,771) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:27,994) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994696
[2211374:MainThread](2024-04-22 23:37:27,995) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:37:27,995) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:37:30,251) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:30,475) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994549
[2211374:MainThread](2024-04-22 23:37:30,476) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:37:30,476) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:37:32,786) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:33,011) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994187
[2211374:MainThread](2024-04-22 23:37:33,012) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:37:33,012) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:37:35,316) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:35,540) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993556
[2211374:MainThread](2024-04-22 23:37:35,541) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:37:35,541) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:37:37,835) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:38,059) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994343
[2211374:MainThread](2024-04-22 23:37:38,059) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:37:38,059) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:37:40,370) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:40,593) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993889
[2211374:MainThread](2024-04-22 23:37:40,594) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:37:40,594) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:37:42,895) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:43,118) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993433
[2211374:MainThread](2024-04-22 23:37:43,119) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:37:43,120) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:37:45,414) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:45,638) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993589
[2211374:MainThread](2024-04-22 23:37:45,638) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:37:45,638) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:37:47,955) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:48,179) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993700
[2211374:MainThread](2024-04-22 23:37:48,179) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:37:48,179) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:37:50,484) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:50,709) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993833
[2211374:MainThread](2024-04-22 23:37:50,709) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:37:50,710) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:37:53,026) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:53,253) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994141
[2211374:MainThread](2024-04-22 23:37:53,253) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:37:53,253) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:37:55,509) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:55,732) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993387
[2211374:MainThread](2024-04-22 23:37:55,733) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:37:55,734) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:37:58,049) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:37:58,276) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993337
[2211374:MainThread](2024-04-22 23:37:58,277) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:37:58,278) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:00,593) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:00,821) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994338
[2211374:MainThread](2024-04-22 23:38:00,822) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:38:00,822) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:03,103) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:03,328) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993830
[2211374:MainThread](2024-04-22 23:38:03,329) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:38:03,329) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:05,638) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:05,867) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995383
[2211374:MainThread](2024-04-22 23:38:05,868) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:38:05,868) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:08,184) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:08,409) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994298
[2211374:MainThread](2024-04-22 23:38:08,410) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:38:08,410) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:10,742) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:10,969) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994048
[2211374:MainThread](2024-04-22 23:38:10,970) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:38:10,970) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:13,299) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:13,527) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994118
[2211374:MainThread](2024-04-22 23:38:13,527) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:38:13,528) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:15,796) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:16,022) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995509
[2211374:MainThread](2024-04-22 23:38:16,022) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:38:16,023) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:18,341) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:18,568) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995790
[2211374:MainThread](2024-04-22 23:38:18,569) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:38:18,569) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993337 @ 13
[2211374:MainThread](2024-04-22 23:38:18,619) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-02-07 SH600000    0.014788
           SH600008    0.030484
           SH600009    0.009722
           SH600010   -0.064921
           SH600015    0.070915
[2211374:MainThread](2024-04-22 23:38:20,290) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   5%|▍         | 2/44 [02:14<46:47, 66.84s/it][2211374:MainThread](2024-04-22 23:38:20,299) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:38:20,309) INFO - qlib.workflow - [recorder.py:341] - Recorder cb42006c2d5a4c449e0d07c55b8f13f0 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:38:20,855) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:38:20,856) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:38:20,859) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:38:20,860) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:38:28,499) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.632847
            SH600004      0.632847
            SH600006      0.632847
            SH600007      0.632847
            SH600008      0.632847
                            ...   
2015-03-06  SZ300070      1.927196
            SZ300124      1.927196
            SZ300133      1.927196
            SZ300146      1.927196
            SZ300251      1.927196
Length: 489365, dtype: float64
[2211374:MainThread](2024-04-22 23:38:28,501) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:38:28,502) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:38:28,502) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:30,866) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:31,091) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995464
[2211374:MainThread](2024-04-22 23:38:31,092) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:38:31,092) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:33,445) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:33,671) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995284
[2211374:MainThread](2024-04-22 23:38:33,672) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:38:33,672) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:35,989) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:36,215) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994532
[2211374:MainThread](2024-04-22 23:38:36,216) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:38:36,216) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:38,522) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:38,748) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993877
[2211374:MainThread](2024-04-22 23:38:38,749) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:38:38,749) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:41,069) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:41,296) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994171
[2211374:MainThread](2024-04-22 23:38:41,297) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:38:41,297) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:43,646) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:43,869) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995212
[2211374:MainThread](2024-04-22 23:38:43,870) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:38:43,870) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:46,228) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:46,453) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994378
[2211374:MainThread](2024-04-22 23:38:46,453) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:38:46,454) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:48,806) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:49,029) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993964
[2211374:MainThread](2024-04-22 23:38:49,029) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:38:49,030) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:51,381) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:51,607) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993811
[2211374:MainThread](2024-04-22 23:38:51,608) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:38:51,608) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:53,913) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:54,142) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994104
[2211374:MainThread](2024-04-22 23:38:54,142) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:38:54,142) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:56,447) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:56,673) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994725
[2211374:MainThread](2024-04-22 23:38:56,674) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:38:56,674) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:38:58,980) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:38:59,205) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994331
[2211374:MainThread](2024-04-22 23:38:59,206) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:38:59,206) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:01,522) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:39:01,748) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993047
[2211374:MainThread](2024-04-22 23:39:01,749) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:39:01,750) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:04,055) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:39:04,281) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993167
[2211374:MainThread](2024-04-22 23:39:04,281) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:39:04,281) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:06,592) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:39:06,818) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994376
[2211374:MainThread](2024-04-22 23:39:06,818) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:39:06,818) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:09,134) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:39:09,360) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994772
[2211374:MainThread](2024-04-22 23:39:09,361) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:39:09,361) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:11,665) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:39:11,891) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994005
[2211374:MainThread](2024-04-22 23:39:11,892) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:39:11,892) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:14,205) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:39:14,433) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994112
[2211374:MainThread](2024-04-22 23:39:14,433) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:39:14,433) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:16,738) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:39:16,964) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994564
[2211374:MainThread](2024-04-22 23:39:16,964) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:39:16,965) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:19,271) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:39:19,497) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996371
[2211374:MainThread](2024-04-22 23:39:19,497) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:39:19,497) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:21,813) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:39:22,039) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994545
[2211374:MainThread](2024-04-22 23:39:22,040) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:39:22,040) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993047 @ 12
[2211374:MainThread](2024-04-22 23:39:22,089) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-03-07 SH600000   -0.003276
           SH600008    0.006759
           SH600009    0.023649
           SH600010   -0.009696
           SH600015    0.024576
[2211374:MainThread](2024-04-22 23:39:23,760) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   7%|▋         | 3/44 [03:17<44:37, 65.30s/it][2211374:MainThread](2024-04-22 23:39:23,769) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:39:23,779) INFO - qlib.workflow - [recorder.py:341] - Recorder 8ced70295d994866b02a0325a305f20d starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:39:24,321) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:39:24,322) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:39:24,326) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:39:24,326) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:39:31,972) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.655959
            SH600004      0.655959
            SH600006      0.655959
            SH600007      0.655959
            SH600008      0.655959
                            ...   
2015-04-03  SZ300070      0.662208
            SZ300124      0.662208
            SZ300133      0.662208
            SZ300146      0.662208
            SZ300251      0.662208
Length: 495049, dtype: float64
[2211374:MainThread](2024-04-22 23:39:31,975) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:39:31,975) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:39:31,975) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:34,329) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:39:34,557) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995785
[2211374:MainThread](2024-04-22 23:39:34,558) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:39:34,558) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:36,898) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:39:37,123) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995353
[2211374:MainThread](2024-04-22 23:39:37,124) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:39:37,125) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:39,467) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:39:39,693) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995065
[2211374:MainThread](2024-04-22 23:39:39,694) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:39:39,694) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:42,047) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:39:42,275) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994629
[2211374:MainThread](2024-04-22 23:39:42,276) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:39:42,276) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:44,619) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:39:44,845) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993901
[2211374:MainThread](2024-04-22 23:39:44,846) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:39:44,846) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:47,189) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:39:47,415) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995022
[2211374:MainThread](2024-04-22 23:39:47,416) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:39:47,416) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:49,715) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:39:49,941) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997044
[2211374:MainThread](2024-04-22 23:39:49,942) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:39:49,942) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:52,224) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:39:52,451) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994184
[2211374:MainThread](2024-04-22 23:39:52,452) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:39:52,452) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:54,760) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:39:54,984) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995238
[2211374:MainThread](2024-04-22 23:39:54,984) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:39:54,985) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:57,306) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:39:57,533) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994400
[2211374:MainThread](2024-04-22 23:39:57,533) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:39:57,534) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:39:59,880) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:00,107) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994246
[2211374:MainThread](2024-04-22 23:40:00,107) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:40:00,107) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:40:02,467) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:02,693) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994593
[2211374:MainThread](2024-04-22 23:40:02,694) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:40:02,694) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:40:05,044) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:05,270) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994810
[2211374:MainThread](2024-04-22 23:40:05,271) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:40:05,271) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993901 @ 4
[2211374:MainThread](2024-04-22 23:40:05,321) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-04-06 SH600000    0.026819
           SH600008   -0.135753
           SH600009   -0.077282
           SH600010    0.011413
           SH600015    0.016664
[2211374:MainThread](2024-04-22 23:40:06,845) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   9%|▉         | 4/44 [04:00<37:41, 56.53s/it][2211374:MainThread](2024-04-22 23:40:06,853) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:40:06,863) INFO - qlib.workflow - [recorder.py:341] - Recorder a58831a97ad4466ea13db9d1e817585f starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:40:07,411) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:40:07,412) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:40:07,415) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:40:07,416) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:40:15,044) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.007233
            SH600004      1.007233
            SH600006      1.007233
            SH600007      1.007233
            SH600008      1.007233
                            ...   
2015-05-05  SZ300070      1.864241
            SZ300124      1.864241
            SZ300133      1.864241
            SZ300146      1.864241
            SZ300251      1.864241
Length: 500679, dtype: float64
[2211374:MainThread](2024-04-22 23:40:15,047) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:40:15,047) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:40:15,047) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:40:17,425) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:17,624) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995798
[2211374:MainThread](2024-04-22 23:40:17,625) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:40:17,625) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:40:20,019) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:20,216) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995498
[2211374:MainThread](2024-04-22 23:40:20,217) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:40:20,217) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:40:22,612) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:22,811) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995379
[2211374:MainThread](2024-04-22 23:40:22,812) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:40:22,813) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:40:25,211) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:25,409) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995138
[2211374:MainThread](2024-04-22 23:40:25,410) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:40:25,410) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:40:27,823) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:28,022) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994993
[2211374:MainThread](2024-04-22 23:40:28,023) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:40:28,023) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:40:30,443) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:30,640) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994393
[2211374:MainThread](2024-04-22 23:40:30,641) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:40:30,642) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:40:33,037) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:33,235) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994251
[2211374:MainThread](2024-04-22 23:40:33,236) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:40:33,236) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:40:35,644) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:35,842) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994678
[2211374:MainThread](2024-04-22 23:40:35,842) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:40:35,843) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:40:38,236) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:38,434) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995575
[2211374:MainThread](2024-04-22 23:40:38,435) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:40:38,435) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:40:40,829) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:41,026) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995374
[2211374:MainThread](2024-04-22 23:40:41,027) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:40:41,027) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:40:43,437) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:43,636) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995802
[2211374:MainThread](2024-04-22 23:40:43,636) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:40:43,636) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:40:46,032) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:46,230) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995044
[2211374:MainThread](2024-04-22 23:40:46,230) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:40:46,230) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:40:48,642) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:48,844) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994065
[2211374:MainThread](2024-04-22 23:40:48,845) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:40:48,845) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:40:51,248) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:51,446) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994364
[2211374:MainThread](2024-04-22 23:40:51,446) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:40:51,447) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:40:53,841) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:54,041) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994258
[2211374:MainThread](2024-04-22 23:40:54,041) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:40:54,041) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:40:56,468) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:56,668) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994333
[2211374:MainThread](2024-04-22 23:40:56,668) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:40:56,669) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:40:59,086) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:40:59,285) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994911
[2211374:MainThread](2024-04-22 23:40:59,286) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:40:59,286) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:41:01,697) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:41:01,896) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994829
[2211374:MainThread](2024-04-22 23:41:01,896) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:41:01,897) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:41:04,315) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:41:04,512) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995039
[2211374:MainThread](2024-04-22 23:41:04,513) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:41:04,513) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:41:06,915) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:41:07,113) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995548
[2211374:MainThread](2024-04-22 23:41:07,113) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:41:07,114) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:41:09,528) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:41:09,726) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994989
[2211374:MainThread](2024-04-22 23:41:09,726) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:41:09,727) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.994065 @ 12
[2211374:MainThread](2024-04-22 23:41:09,776) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-05-05 SH600000   -0.073549
           SH600008   -0.129546
           SH600009   -0.217134
           SH600010   -0.060957
           SH600015   -0.069422
[2211374:MainThread](2024-04-22 23:41:11,416) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  11%|█▏        | 5/44 [05:05<38:37, 59.43s/it][2211374:MainThread](2024-04-22 23:41:11,425) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:41:11,435) INFO - qlib.workflow - [recorder.py:341] - Recorder e0f6088cd1ee46a6861bf7a20c5c94dc starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:41:12,095) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:41:12,095) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:41:12,100) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:41:12,100) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:41:20,046) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.561266
            SH600004      0.561266
            SH600006      0.561266
            SH600007      0.561266
            SH600008      0.561266
                            ...   
2015-06-02  SZ300070      0.735755
            SZ300124      0.735755
            SZ300133      0.735755
            SZ300146      0.735755
            SZ300251      0.735755
Length: 506316, dtype: float64
[2211374:MainThread](2024-04-22 23:41:20,049) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:41:20,049) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:41:20,049) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:41:22,502) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:41:22,707) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996403
[2211374:MainThread](2024-04-22 23:41:22,709) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:41:22,709) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:41:25,144) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:41:25,348) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995954
[2211374:MainThread](2024-04-22 23:41:25,349) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:41:25,349) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:41:27,785) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:41:27,991) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995253
[2211374:MainThread](2024-04-22 23:41:27,992) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:41:27,992) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:41:30,451) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:41:30,657) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996128
[2211374:MainThread](2024-04-22 23:41:30,658) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:41:30,658) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:41:33,096) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:41:33,300) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994915
[2211374:MainThread](2024-04-22 23:41:33,301) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:41:33,302) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:41:35,732) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:41:35,938) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995212
[2211374:MainThread](2024-04-22 23:41:35,938) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:41:35,939) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:41:38,390) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:41:38,596) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994498
[2211374:MainThread](2024-04-22 23:41:38,597) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:41:38,597) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:41:41,045) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:41:41,252) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994549
[2211374:MainThread](2024-04-22 23:41:41,252) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:41:41,253) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:41:43,718) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:41:43,923) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996323
[2211374:MainThread](2024-04-22 23:41:43,924) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:41:43,924) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:41:46,376) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:41:46,581) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994984
[2211374:MainThread](2024-04-22 23:41:46,582) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:41:46,582) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:41:49,032) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:41:49,240) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995250
[2211374:MainThread](2024-04-22 23:41:49,241) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:41:49,241) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:41:51,638) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:41:51,844) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994323
[2211374:MainThread](2024-04-22 23:41:51,845) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:41:51,846) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:41:54,241) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:41:54,446) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993123
[2211374:MainThread](2024-04-22 23:41:54,447) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:41:54,447) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:41:56,836) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:41:57,041) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995946
[2211374:MainThread](2024-04-22 23:41:57,041) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:41:57,042) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:41:59,419) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:41:59,624) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995431
[2211374:MainThread](2024-04-22 23:41:59,624) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:41:59,624) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:42:01,997) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:42:02,202) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994855
[2211374:MainThread](2024-04-22 23:42:02,202) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:42:02,202) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:42:04,583) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:42:04,788) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995937
[2211374:MainThread](2024-04-22 23:42:04,788) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:42:04,788) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:42:07,164) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:42:07,370) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994286
[2211374:MainThread](2024-04-22 23:42:07,370) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:42:07,370) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:42:09,756) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:42:09,961) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995603
[2211374:MainThread](2024-04-22 23:42:09,961) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:42:09,961) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:42:12,332) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:42:12,538) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996155
[2211374:MainThread](2024-04-22 23:42:12,538) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:42:12,538) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:42:14,909) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:42:15,114) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995609
[2211374:MainThread](2024-04-22 23:42:15,114) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:42:15,115) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993123 @ 12
[2211374:MainThread](2024-04-22 23:42:15,163) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-06-06 SH600000    0.006417
           SH600008   -0.025900
           SH600009    0.022894
           SH600010   -0.005524
           SH600015    0.018738
[2211374:MainThread](2024-04-22 23:42:16,802) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  14%|█▎        | 6/44 [06:10<38:55, 61.46s/it][2211374:MainThread](2024-04-22 23:42:16,811) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:42:16,821) INFO - qlib.workflow - [recorder.py:341] - Recorder 5fca05689ffb4367861799edc2ddbf1c starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:42:17,358) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:42:17,358) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:42:17,361) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:42:17,362) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:42:24,925) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.766885
            SH600004      1.766885
            SH600006      1.766885
            SH600007      1.766885
            SH600008      1.766885
                            ...   
2015-07-10  SZ300059      1.511778
            SZ300070      1.511778
            SZ300104      1.511778
            SZ300124      1.511778
            SZ300146      1.511778
Length: 511531, dtype: float64
[2211374:MainThread](2024-04-22 23:42:24,927) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:42:24,927) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:42:24,927) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:42:27,342) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:42:27,566) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995342
[2211374:MainThread](2024-04-22 23:42:27,567) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:42:27,567) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:42:29,973) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:42:30,197) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995256
[2211374:MainThread](2024-04-22 23:42:30,198) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:42:30,199) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:42:32,592) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:42:32,816) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994121
[2211374:MainThread](2024-04-22 23:42:32,817) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:42:32,817) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:42:35,212) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:42:35,436) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993404
[2211374:MainThread](2024-04-22 23:42:35,437) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:42:35,437) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:42:37,851) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:42:38,075) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993002
[2211374:MainThread](2024-04-22 23:42:38,076) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:42:38,077) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:42:40,468) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:42:40,693) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993020
[2211374:MainThread](2024-04-22 23:42:40,693) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:42:40,693) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:42:43,089) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:42:43,315) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992224
[2211374:MainThread](2024-04-22 23:42:43,316) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:42:43,316) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:42:45,654) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:42:45,880) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991560
[2211374:MainThread](2024-04-22 23:42:45,881) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:42:45,881) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:42:48,194) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:42:48,422) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991093
[2211374:MainThread](2024-04-22 23:42:48,423) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:42:48,423) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:42:50,801) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:42:51,027) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991946
[2211374:MainThread](2024-04-22 23:42:51,027) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:42:51,027) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:42:53,418) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:42:53,643) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992481
[2211374:MainThread](2024-04-22 23:42:53,643) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:42:53,643) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:42:56,041) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:42:56,266) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993292
[2211374:MainThread](2024-04-22 23:42:56,266) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:42:56,267) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:42:58,670) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:42:58,895) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992050
[2211374:MainThread](2024-04-22 23:42:58,896) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:42:58,896) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:43:01,282) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:43:01,508) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991511
[2211374:MainThread](2024-04-22 23:43:01,508) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:43:01,508) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:43:03,907) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:43:04,133) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991982
[2211374:MainThread](2024-04-22 23:43:04,134) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:43:04,134) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:43:06,525) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:43:06,751) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992416
[2211374:MainThread](2024-04-22 23:43:06,751) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:43:06,751) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:43:09,141) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:43:09,367) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992219
[2211374:MainThread](2024-04-22 23:43:09,367) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:43:09,367) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991093 @ 8
[2211374:MainThread](2024-04-22 23:43:09,417) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-07-04 SH600000    0.004962
           SH600008   -0.042257
           SH600009   -0.065481
           SH600010    0.011032
           SH600015   -0.004032
[2211374:MainThread](2024-04-22 23:43:11,077) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  16%|█▌        | 7/44 [07:04<36:26, 59.11s/it][2211374:MainThread](2024-04-22 23:43:11,085) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:43:11,095) INFO - qlib.workflow - [recorder.py:341] - Recorder 6ac81980f90a4b48b8f55c544ed1d46c starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:43:11,647) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:43:11,648) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:43:11,651) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:43:11,652) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:43:19,166) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.031063
            SH600004      1.031063
            SH600006      1.031063
            SH600007      1.031063
            SH600008      1.031063
                            ...   
2015-08-07  SZ300104      1.693139
            SZ300124      1.693139
            SZ300133      1.693139
            SZ300146      1.693139
            SZ300251      1.693139
Length: 516849, dtype: float64
[2211374:MainThread](2024-04-22 23:43:19,168) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:43:19,169) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:43:19,169) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:43:21,587) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:43:21,809) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995440
[2211374:MainThread](2024-04-22 23:43:21,810) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:43:21,811) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:43:24,193) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:43:24,416) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994697
[2211374:MainThread](2024-04-22 23:43:24,417) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:43:24,417) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:43:26,803) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:43:27,024) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994510
[2211374:MainThread](2024-04-22 23:43:27,025) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:43:27,025) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:43:29,397) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:43:29,619) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994222
[2211374:MainThread](2024-04-22 23:43:29,620) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:43:29,620) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:43:32,038) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:43:32,260) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994415
[2211374:MainThread](2024-04-22 23:43:32,260) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:43:32,261) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:43:34,680) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:43:34,902) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993910
[2211374:MainThread](2024-04-22 23:43:34,903) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:43:34,903) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:43:37,318) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:43:37,540) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993762
[2211374:MainThread](2024-04-22 23:43:37,541) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:43:37,541) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:43:39,888) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:43:40,111) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994554
[2211374:MainThread](2024-04-22 23:43:40,112) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:43:40,112) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:43:42,445) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:43:42,668) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993504
[2211374:MainThread](2024-04-22 23:43:42,669) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:43:42,669) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:43:45,003) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:43:45,226) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993898
[2211374:MainThread](2024-04-22 23:43:45,227) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:43:45,227) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:43:47,629) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:43:47,852) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992469
[2211374:MainThread](2024-04-22 23:43:47,853) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:43:47,853) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:43:50,268) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:43:50,492) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993954
[2211374:MainThread](2024-04-22 23:43:50,492) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:43:50,493) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:43:52,832) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:43:53,054) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993317
[2211374:MainThread](2024-04-22 23:43:53,055) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:43:53,055) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:43:55,485) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:43:55,707) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992688
[2211374:MainThread](2024-04-22 23:43:55,707) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:43:55,708) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:43:58,160) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:43:58,385) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991721
[2211374:MainThread](2024-04-22 23:43:58,387) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:43:58,387) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:44:00,839) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:44:01,064) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992770
[2211374:MainThread](2024-04-22 23:44:01,065) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:44:01,065) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:44:03,518) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:44:03,743) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992124
[2211374:MainThread](2024-04-22 23:44:03,744) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:44:03,744) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:44:06,194) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:44:06,416) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993383
[2211374:MainThread](2024-04-22 23:44:06,417) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:44:06,417) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:44:08,842) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:44:09,064) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993480
[2211374:MainThread](2024-04-22 23:44:09,065) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:44:09,065) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:44:11,501) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:44:11,723) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993841
[2211374:MainThread](2024-04-22 23:44:11,724) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:44:11,724) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:44:14,146) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:44:14,369) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992216
[2211374:MainThread](2024-04-22 23:44:14,370) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:44:14,370) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:44:16,790) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:44:17,013) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994063
[2211374:MainThread](2024-04-22 23:44:17,013) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 23:44:17,013) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:44:19,441) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:44:19,664) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993901
[2211374:MainThread](2024-04-22 23:44:19,665) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:44:19,665) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991721 @ 14
[2211374:MainThread](2024-04-22 23:44:19,714) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-08-01 SH600000   -0.021960
           SH600008    0.002686
           SH600009   -0.027765
           SH600010    0.080972
           SH600015   -0.123747
[2211374:MainThread](2024-04-22 23:44:21,363) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  18%|█▊        | 8/44 [08:15<37:35, 62.67s/it][2211374:MainThread](2024-04-22 23:44:21,372) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:44:21,382) INFO - qlib.workflow - [recorder.py:341] - Recorder db6b6dc0b6f448c3a9c3dd7bbcb589ad starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:44:21,916) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:44:21,916) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:44:21,918) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:44:21,919) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:44:29,457) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.438722
            SH600004      1.438722
            SH600006      1.438722
            SH600007      1.438722
            SH600008      1.438722
                            ...   
2015-09-08  SZ300104      1.792363
            SZ300124      1.792363
            SZ300133      1.792363
            SZ300146      1.792363
            SZ300251      1.792363
Length: 522220, dtype: float64
[2211374:MainThread](2024-04-22 23:44:29,459) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:44:29,460) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:44:29,460) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:44:31,985) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:44:32,172) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995831
[2211374:MainThread](2024-04-22 23:44:32,173) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:44:32,173) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:44:34,703) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:44:34,889) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994609
[2211374:MainThread](2024-04-22 23:44:34,890) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:44:34,890) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:44:37,423) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:44:37,612) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993787
[2211374:MainThread](2024-04-22 23:44:37,613) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:44:37,613) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:44:40,147) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:44:40,334) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994258
[2211374:MainThread](2024-04-22 23:44:40,335) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:44:40,335) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:44:42,869) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:44:43,056) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992975
[2211374:MainThread](2024-04-22 23:44:43,057) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:44:43,057) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:44:45,596) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:44:45,783) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993504
[2211374:MainThread](2024-04-22 23:44:45,783) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:44:45,784) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:44:48,314) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:44:48,501) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993395
[2211374:MainThread](2024-04-22 23:44:48,501) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:44:48,501) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:44:51,047) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:44:51,236) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992850
[2211374:MainThread](2024-04-22 23:44:51,237) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:44:51,237) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:44:53,794) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:44:53,982) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992801
[2211374:MainThread](2024-04-22 23:44:53,983) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:44:53,984) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:44:56,492) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:44:56,681) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993126
[2211374:MainThread](2024-04-22 23:44:56,682) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:44:56,682) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:44:59,217) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:44:59,407) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992212
[2211374:MainThread](2024-04-22 23:44:59,408) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:44:59,408) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:01,966) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:02,156) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993072
[2211374:MainThread](2024-04-22 23:45:02,156) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:45:02,156) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:04,718) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:04,906) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991701
[2211374:MainThread](2024-04-22 23:45:04,907) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:45:04,907) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:07,472) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:07,661) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991652
[2211374:MainThread](2024-04-22 23:45:07,662) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:45:07,662) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:10,223) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:10,411) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991226
[2211374:MainThread](2024-04-22 23:45:10,412) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:45:10,413) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:12,972) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:13,160) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991646
[2211374:MainThread](2024-04-22 23:45:13,161) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:45:13,161) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:15,714) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:15,903) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991107
[2211374:MainThread](2024-04-22 23:45:15,904) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:45:15,904) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:18,440) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:18,631) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991452
[2211374:MainThread](2024-04-22 23:45:18,631) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:45:18,631) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:21,080) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:21,269) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991394
[2211374:MainThread](2024-04-22 23:45:21,270) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:45:21,270) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:23,713) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:23,903) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992006
[2211374:MainThread](2024-04-22 23:45:23,903) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:45:23,904) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:26,353) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:26,543) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991850
[2211374:MainThread](2024-04-22 23:45:26,543) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:45:26,544) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:28,987) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:29,177) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991561
[2211374:MainThread](2024-04-22 23:45:29,177) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 23:45:29,177) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:31,686) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:31,875) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990897
[2211374:MainThread](2024-04-22 23:45:31,876) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 23:45:31,877) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:34,436) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:34,625) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991465
[2211374:MainThread](2024-04-22 23:45:34,626) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 23:45:34,626) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:37,182) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:37,370) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991762
[2211374:MainThread](2024-04-22 23:45:37,371) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 23:45:37,371) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:39,927) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:40,116) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991552
[2211374:MainThread](2024-04-22 23:45:40,116) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-22 23:45:40,117) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:42,671) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:42,859) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992956
[2211374:MainThread](2024-04-22 23:45:42,859) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[2211374:MainThread](2024-04-22 23:45:42,860) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:45,421) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:45,610) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992002
[2211374:MainThread](2024-04-22 23:45:45,611) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[2211374:MainThread](2024-04-22 23:45:45,611) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:48,165) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:48,355) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992585
[2211374:MainThread](2024-04-22 23:45:48,355) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[2211374:MainThread](2024-04-22 23:45:48,355) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:50,830) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:51,019) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992823
[2211374:MainThread](2024-04-22 23:45:51,019) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch30:
[2211374:MainThread](2024-04-22 23:45:51,019) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:45:53,579) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:45:53,768) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993246
[2211374:MainThread](2024-04-22 23:45:53,769) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:45:53,769) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990897 @ 22
[2211374:MainThread](2024-04-22 23:45:53,819) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-08-29 SH600000   -0.016430
           SH600008   -0.107486
           SH600009    0.182941
           SH600010   -0.169290
           SH600015   -0.008964
[2211374:MainThread](2024-04-22 23:45:55,491) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  20%|██        | 9/44 [09:49<42:17, 72.50s/it][2211374:MainThread](2024-04-22 23:45:55,500) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:45:55,510) INFO - qlib.workflow - [recorder.py:341] - Recorder 3cb5f2d1cdea429fbc82c19763593708 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:45:56,073) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:45:56,074) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:45:56,077) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:45:56,078) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:46:03,750) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.322640
            SH600004      1.322640
            SH600006      1.322640
            SH600007      1.322640
            SH600008      1.322640
                            ...   
2015-10-13  SZ300104      1.789477
            SZ300124      1.789477
            SZ300133      1.789477
            SZ300146      1.789477
            SZ300251      1.789477
Length: 527673, dtype: float64
[2211374:MainThread](2024-04-22 23:46:03,752) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:46:03,753) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:46:03,753) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:06,340) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:06,563) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995080
[2211374:MainThread](2024-04-22 23:46:06,564) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:46:06,564) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:09,127) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:09,350) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994707
[2211374:MainThread](2024-04-22 23:46:09,351) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:46:09,352) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:11,918) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:12,141) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993531
[2211374:MainThread](2024-04-22 23:46:12,142) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:46:12,142) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:14,681) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:14,906) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994103
[2211374:MainThread](2024-04-22 23:46:14,906) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:46:14,907) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:17,422) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:17,646) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995196
[2211374:MainThread](2024-04-22 23:46:17,646) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:46:17,647) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:20,237) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:20,460) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993414
[2211374:MainThread](2024-04-22 23:46:20,461) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:46:20,461) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:23,022) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:23,245) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992336
[2211374:MainThread](2024-04-22 23:46:23,246) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:46:23,247) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:25,827) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:26,048) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992699
[2211374:MainThread](2024-04-22 23:46:26,049) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:46:26,049) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:28,601) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:28,821) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992267
[2211374:MainThread](2024-04-22 23:46:28,822) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:46:28,822) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:31,393) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:31,616) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992652
[2211374:MainThread](2024-04-22 23:46:31,616) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:46:31,617) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:34,198) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:34,422) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992957
[2211374:MainThread](2024-04-22 23:46:34,423) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:46:34,423) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:36,988) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:37,209) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991505
[2211374:MainThread](2024-04-22 23:46:37,210) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:46:37,211) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:39,789) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:40,013) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991916
[2211374:MainThread](2024-04-22 23:46:40,014) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:46:40,014) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:42,577) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:42,801) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991018
[2211374:MainThread](2024-04-22 23:46:42,802) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:46:42,803) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:45,371) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:45,595) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991800
[2211374:MainThread](2024-04-22 23:46:45,595) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:46:45,595) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:48,166) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:48,390) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991455
[2211374:MainThread](2024-04-22 23:46:48,390) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:46:48,390) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:50,957) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:51,181) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991749
[2211374:MainThread](2024-04-22 23:46:51,181) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:46:51,182) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:53,757) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:53,979) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992170
[2211374:MainThread](2024-04-22 23:46:53,980) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:46:53,980) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:56,540) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:56,764) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992441
[2211374:MainThread](2024-04-22 23:46:56,764) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:46:56,765) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:46:59,347) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:46:59,569) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992135
[2211374:MainThread](2024-04-22 23:46:59,570) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:46:59,570) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:47:02,135) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:47:02,356) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992087
[2211374:MainThread](2024-04-22 23:47:02,357) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:47:02,357) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:47:04,922) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:47:05,145) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991323
[2211374:MainThread](2024-04-22 23:47:05,145) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:47:05,145) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991018 @ 13
[2211374:MainThread](2024-04-22 23:47:05,197) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-09-26 SH600000    0.021415
           SH600008   -0.002738
           SH600009    0.030358
           SH600010   -0.018502
           SH600015    0.009519
[2211374:MainThread](2024-04-22 23:47:06,844) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  23%|██▎       | 10/44 [11:00<40:52, 72.15s/it][2211374:MainThread](2024-04-22 23:47:06,852) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:47:06,862) INFO - qlib.workflow - [recorder.py:341] - Recorder ebb4e0e51993431998fa8a0c72339782 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:47:07,420) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:47:07,420) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:47:07,424) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:47:07,424) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:47:14,932) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.465434
            SH600004      1.465434
            SH600006      1.465434
            SH600007      1.465434
            SH600008      1.465434
                            ...   
2015-11-19  SZ300104      1.883899
            SZ300124      1.883899
            SZ300133      1.883899
            SZ300146      1.883899
            SZ300251      1.883899
Length: 533252, dtype: float64
[2211374:MainThread](2024-04-22 23:47:14,934) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:47:14,935) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:47:14,935) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:47:17,459) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:47:17,682) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995164
[2211374:MainThread](2024-04-22 23:47:17,683) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:47:17,684) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:47:20,214) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:47:20,437) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994204
[2211374:MainThread](2024-04-22 23:47:20,438) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:47:20,438) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:47:22,949) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:47:23,172) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993886
[2211374:MainThread](2024-04-22 23:47:23,173) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:47:23,173) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:47:25,685) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:47:25,911) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993002
[2211374:MainThread](2024-04-22 23:47:25,912) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:47:25,912) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:47:28,425) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:47:28,648) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993299
[2211374:MainThread](2024-04-22 23:47:28,649) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:47:28,649) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:47:31,160) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:47:31,384) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993622
[2211374:MainThread](2024-04-22 23:47:31,384) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:47:31,384) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:47:33,905) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:47:34,129) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992855
[2211374:MainThread](2024-04-22 23:47:34,130) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:47:34,131) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:47:36,639) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:47:36,862) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992372
[2211374:MainThread](2024-04-22 23:47:36,863) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:47:36,864) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:47:39,376) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:47:39,601) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991992
[2211374:MainThread](2024-04-22 23:47:39,602) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:47:39,602) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:47:42,111) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:47:42,335) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992197
[2211374:MainThread](2024-04-22 23:47:42,336) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:47:42,336) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:47:44,880) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:47:45,107) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991780
[2211374:MainThread](2024-04-22 23:47:45,108) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:47:45,108) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:47:47,600) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:47:47,824) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991215
[2211374:MainThread](2024-04-22 23:47:47,825) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:47:47,826) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:47:50,270) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:47:50,494) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991745
[2211374:MainThread](2024-04-22 23:47:50,494) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:47:50,495) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:47:52,946) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:47:53,171) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992179
[2211374:MainThread](2024-04-22 23:47:53,171) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:47:53,171) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:47:55,684) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:47:55,908) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991615
[2211374:MainThread](2024-04-22 23:47:55,908) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:47:55,908) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:47:58,456) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:47:58,680) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991248
[2211374:MainThread](2024-04-22 23:47:58,680) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:47:58,680) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:48:01,223) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:48:01,447) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991450
[2211374:MainThread](2024-04-22 23:48:01,448) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:48:01,448) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:48:03,960) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:48:04,185) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991403
[2211374:MainThread](2024-04-22 23:48:04,186) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:48:04,186) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:48:06,715) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:48:06,939) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991526
[2211374:MainThread](2024-04-22 23:48:06,939) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:48:06,939) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:48:09,451) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:48:09,674) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991890
[2211374:MainThread](2024-04-22 23:48:09,674) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:48:09,674) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991215 @ 11
[2211374:MainThread](2024-04-22 23:48:09,724) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-10-31 SH600000   -0.057959
           SH600008   -0.090618
           SH600009    0.194090
           SH600010    0.033787
           SH600015   -0.085485
[2211374:MainThread](2024-04-22 23:48:11,362) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  25%|██▌       | 11/44 [12:05<38:23, 69.81s/it][2211374:MainThread](2024-04-22 23:48:11,371) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:48:11,381) INFO - qlib.workflow - [recorder.py:341] - Recorder a7fdbe0f715746028637c84dd8e6f793 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:48:11,924) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:48:11,924) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:48:11,926) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:48:11,927) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:48:19,437) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.071763
            SH600004      1.071763
            SH600006      1.071763
            SH600007      1.071763
            SH600008      1.071763
                            ...   
2015-12-17  SZ300133      1.984647
            SZ300144      1.984647
            SZ300146      1.984647
            SZ300251      1.984647
            SZ300315      1.984647
Length: 538891, dtype: float64
[2211374:MainThread](2024-04-22 23:48:19,439) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:48:19,439) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:48:19,440) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:48:21,967) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:48:22,190) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995557
[2211374:MainThread](2024-04-22 23:48:22,191) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:48:22,191) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:48:24,695) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:48:24,919) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994947
[2211374:MainThread](2024-04-22 23:48:24,920) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:48:24,920) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:48:27,436) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:48:27,660) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995452
[2211374:MainThread](2024-04-22 23:48:27,660) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:48:27,660) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:48:30,164) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:48:30,387) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993692
[2211374:MainThread](2024-04-22 23:48:30,388) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:48:30,388) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:48:32,917) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:48:33,143) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993284
[2211374:MainThread](2024-04-22 23:48:33,144) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:48:33,145) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:48:35,710) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:48:35,933) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994679
[2211374:MainThread](2024-04-22 23:48:35,934) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:48:35,934) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:48:38,489) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:48:38,712) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993226
[2211374:MainThread](2024-04-22 23:48:38,713) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:48:38,713) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:48:41,290) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:48:41,516) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993321
[2211374:MainThread](2024-04-22 23:48:41,516) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:48:41,516) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:48:44,080) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:48:44,303) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992759
[2211374:MainThread](2024-04-22 23:48:44,304) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:48:44,304) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:48:46,869) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:48:47,093) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993709
[2211374:MainThread](2024-04-22 23:48:47,093) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:48:47,093) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:48:49,648) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:48:49,871) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992520
[2211374:MainThread](2024-04-22 23:48:49,872) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:48:49,872) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:48:52,421) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:48:52,645) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992978
[2211374:MainThread](2024-04-22 23:48:52,646) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:48:52,646) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:48:55,205) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:48:55,431) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992444
[2211374:MainThread](2024-04-22 23:48:55,432) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:48:55,432) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:48:57,975) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:48:58,201) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993684
[2211374:MainThread](2024-04-22 23:48:58,201) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:48:58,201) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:49:00,814) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:49:01,042) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992047
[2211374:MainThread](2024-04-22 23:49:01,043) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:49:01,043) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:49:03,634) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:49:03,861) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991979
[2211374:MainThread](2024-04-22 23:49:03,862) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:49:03,863) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:49:06,458) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:49:06,687) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991971
[2211374:MainThread](2024-04-22 23:49:06,688) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:49:06,689) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:49:09,285) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:49:09,514) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991115
[2211374:MainThread](2024-04-22 23:49:09,515) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:49:09,515) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:49:12,085) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:49:12,313) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991917
[2211374:MainThread](2024-04-22 23:49:12,313) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:49:12,314) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:49:14,867) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:49:15,096) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992120
[2211374:MainThread](2024-04-22 23:49:15,096) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:49:15,096) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:49:17,682) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:49:17,912) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991144
[2211374:MainThread](2024-04-22 23:49:17,912) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:49:17,912) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:49:20,517) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:49:20,743) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991515
[2211374:MainThread](2024-04-22 23:49:20,744) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 23:49:20,744) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:49:23,332) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:49:23,560) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993223
[2211374:MainThread](2024-04-22 23:49:23,560) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 23:49:23,561) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:49:26,150) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:49:26,377) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992510
[2211374:MainThread](2024-04-22 23:49:26,378) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 23:49:26,378) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:49:28,978) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:49:29,206) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993369
[2211374:MainThread](2024-04-22 23:49:29,207) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 23:49:29,207) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:49:31,799) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:49:32,026) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991694
[2211374:MainThread](2024-04-22 23:49:32,027) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:49:32,027) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991115 @ 17
[2211374:MainThread](2024-04-22 23:49:32,076) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-11-28 SH600000   -0.019700
           SH600008   -0.104922
           SH600009   -0.025018
           SH600010   -0.031834
           SH600015    0.001003
[2211374:MainThread](2024-04-22 23:49:33,752) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  27%|██▋       | 12/44 [13:27<39:16, 73.64s/it][2211374:MainThread](2024-04-22 23:49:33,761) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:49:33,771) INFO - qlib.workflow - [recorder.py:341] - Recorder 308669ab7690492891a8e2064f740cd6 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:49:34,330) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:49:34,330) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:49:34,333) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:49:34,334) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:49:42,025) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.602246
            SH600004      1.602246
            SH600006      1.602246
            SH600007      1.602246
            SH600008      1.602246
                            ...   
2016-01-15  SZ300133      1.050917
            SZ300144      1.050917
            SZ300146      1.050917
            SZ300251      1.050917
            SZ300315      1.050917
Length: 544436, dtype: float64
[2211374:MainThread](2024-04-22 23:49:42,028) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:49:42,028) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:49:42,028) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:49:44,654) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:49:44,880) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995708
[2211374:MainThread](2024-04-22 23:49:44,881) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:49:44,881) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:49:47,504) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:49:47,728) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995582
[2211374:MainThread](2024-04-22 23:49:47,729) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:49:47,729) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:49:50,342) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:49:50,566) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994092
[2211374:MainThread](2024-04-22 23:49:50,567) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:49:50,568) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:49:53,150) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:49:53,374) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993378
[2211374:MainThread](2024-04-22 23:49:53,375) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:49:53,376) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:49:55,978) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:49:56,202) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993924
[2211374:MainThread](2024-04-22 23:49:56,203) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:49:56,203) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:49:58,818) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:49:59,042) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992821
[2211374:MainThread](2024-04-22 23:49:59,044) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:49:59,044) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:01,678) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:01,904) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993618
[2211374:MainThread](2024-04-22 23:50:01,904) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:50:01,905) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:04,520) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:04,746) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993075
[2211374:MainThread](2024-04-22 23:50:04,747) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:50:04,747) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:07,364) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:07,589) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991951
[2211374:MainThread](2024-04-22 23:50:07,590) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:50:07,590) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:10,210) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:10,435) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992574
[2211374:MainThread](2024-04-22 23:50:10,435) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:50:10,435) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:13,053) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:13,278) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991029
[2211374:MainThread](2024-04-22 23:50:13,279) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:50:13,280) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:15,896) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:16,121) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991045
[2211374:MainThread](2024-04-22 23:50:16,122) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:50:16,122) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:18,683) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:18,908) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991462
[2211374:MainThread](2024-04-22 23:50:18,909) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:50:18,909) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:21,496) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:21,721) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991006
[2211374:MainThread](2024-04-22 23:50:21,722) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:50:21,723) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:24,338) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:24,564) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991581
[2211374:MainThread](2024-04-22 23:50:24,565) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:50:24,565) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:27,185) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:27,416) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991182
[2211374:MainThread](2024-04-22 23:50:27,416) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:50:27,416) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:30,040) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:30,265) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990821
[2211374:MainThread](2024-04-22 23:50:30,266) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:50:30,266) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:32,886) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:33,111) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991582
[2211374:MainThread](2024-04-22 23:50:33,112) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:50:33,112) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:35,740) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:35,967) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990950
[2211374:MainThread](2024-04-22 23:50:35,968) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:50:35,968) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:38,589) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:38,816) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990563
[2211374:MainThread](2024-04-22 23:50:38,817) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:50:38,817) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:41,426) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:41,653) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991960
[2211374:MainThread](2024-04-22 23:50:41,654) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:50:41,654) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:44,199) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:44,423) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990427
[2211374:MainThread](2024-04-22 23:50:44,425) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 23:50:44,425) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:46,961) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:47,185) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992092
[2211374:MainThread](2024-04-22 23:50:47,186) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 23:50:47,186) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:49,732) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:49,957) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991736
[2211374:MainThread](2024-04-22 23:50:49,957) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 23:50:49,957) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:52,494) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:52,718) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991556
[2211374:MainThread](2024-04-22 23:50:52,718) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 23:50:52,719) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:55,275) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:55,499) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991613
[2211374:MainThread](2024-04-22 23:50:55,500) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-22 23:50:55,500) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:50:58,041) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:50:58,266) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992134
[2211374:MainThread](2024-04-22 23:50:58,266) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[2211374:MainThread](2024-04-22 23:50:58,266) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:51:00,803) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:51:01,030) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992174
[2211374:MainThread](2024-04-22 23:51:01,030) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[2211374:MainThread](2024-04-22 23:51:01,031) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:51:03,570) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:51:03,795) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992557
[2211374:MainThread](2024-04-22 23:51:03,795) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[2211374:MainThread](2024-04-22 23:51:03,796) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:51:06,338) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:51:06,563) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993101
[2211374:MainThread](2024-04-22 23:51:06,563) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:51:06,564) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990427 @ 21
[2211374:MainThread](2024-04-22 23:51:06,613) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-12-26 SH600000    0.006625
           SH600008    0.085375
           SH600009    0.040314
           SH600010   -0.053806
           SH600011    0.040739
[2211374:MainThread](2024-04-22 23:51:08,259) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  30%|██▉       | 13/44 [15:02<41:18, 79.96s/it][2211374:MainThread](2024-04-22 23:51:08,268) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:51:08,278) INFO - qlib.workflow - [recorder.py:341] - Recorder b857f1e0bf8b49a9b26dbd092938a85f starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:51:08,814) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:51:08,815) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:51:08,818) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:51:08,819) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:51:16,379) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.745323
            SH600004      0.745323
            SH600006      0.745323
            SH600007      0.745323
            SH600008      0.745323
                            ...   
2016-03-16  SZ300133      1.471723
            SZ300144      1.471723
            SZ300146      1.471723
            SZ300251      1.471723
            SZ300315      1.471723
Length: 550075, dtype: float64
[2211374:MainThread](2024-04-22 23:51:16,381) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:51:16,381) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:51:16,382) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:51:18,980) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:51:19,167) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995834
[2211374:MainThread](2024-04-22 23:51:19,169) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:51:19,169) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:51:21,758) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:51:21,946) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995279
[2211374:MainThread](2024-04-22 23:51:21,947) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:51:21,947) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:51:24,540) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:51:24,728) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993680
[2211374:MainThread](2024-04-22 23:51:24,729) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:51:24,729) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:51:27,312) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:51:27,500) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993990
[2211374:MainThread](2024-04-22 23:51:27,501) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:51:27,501) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:51:30,099) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:51:30,287) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993112
[2211374:MainThread](2024-04-22 23:51:30,288) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:51:30,288) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:51:32,875) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:51:33,063) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992977
[2211374:MainThread](2024-04-22 23:51:33,064) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:51:33,064) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:51:35,666) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:51:35,854) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992697
[2211374:MainThread](2024-04-22 23:51:35,855) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:51:35,856) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:51:38,448) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:51:38,636) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992763
[2211374:MainThread](2024-04-22 23:51:38,636) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:51:38,637) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:51:41,233) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:51:41,423) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992258
[2211374:MainThread](2024-04-22 23:51:41,424) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:51:41,424) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:51:44,015) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:51:44,204) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991839
[2211374:MainThread](2024-04-22 23:51:44,205) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:51:44,205) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:51:46,794) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:51:46,983) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991718
[2211374:MainThread](2024-04-22 23:51:46,984) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:51:46,984) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:51:49,585) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:51:49,774) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991826
[2211374:MainThread](2024-04-22 23:51:49,775) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:51:49,775) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:51:52,364) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:51:52,552) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991779
[2211374:MainThread](2024-04-22 23:51:52,552) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:51:52,553) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:51:55,156) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:51:55,344) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991451
[2211374:MainThread](2024-04-22 23:51:55,345) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:51:55,346) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:51:57,936) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:51:58,125) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992231
[2211374:MainThread](2024-04-22 23:51:58,125) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:51:58,125) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:52:00,711) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:52:00,902) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991957
[2211374:MainThread](2024-04-22 23:52:00,902) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:52:00,902) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:52:03,499) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:52:03,688) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991513
[2211374:MainThread](2024-04-22 23:52:03,689) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:52:03,689) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:52:06,280) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:52:06,470) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991635
[2211374:MainThread](2024-04-22 23:52:06,470) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:52:06,470) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:52:09,065) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:52:09,253) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992010
[2211374:MainThread](2024-04-22 23:52:09,254) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:52:09,254) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:52:11,830) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:52:12,019) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992093
[2211374:MainThread](2024-04-22 23:52:12,019) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:52:12,020) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:52:14,607) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:52:14,799) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992494
[2211374:MainThread](2024-04-22 23:52:14,799) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:52:14,799) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:52:17,391) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:52:17,580) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991881
[2211374:MainThread](2024-04-22 23:52:17,580) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:52:17,580) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991451 @ 13
[2211374:MainThread](2024-04-22 23:52:17,630) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-01-24 SH600000    0.058940
           SH600008   -0.106482
           SH600009    0.125789
           SH600010   -0.027179
           SH600011   -0.088883
[2211374:MainThread](2024-04-22 23:52:19,283) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  32%|███▏      | 14/44 [16:13<38:37, 77.26s/it][2211374:MainThread](2024-04-22 23:52:19,291) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:52:19,301) INFO - qlib.workflow - [recorder.py:341] - Recorder 946d31670bb647de90923a474a68c6a7 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:52:19,849) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:52:19,850) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:52:19,854) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:52:19,855) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:52:27,524) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.084266
            SH600004      1.084266
            SH600006      1.084266
            SH600007      1.084266
            SH600008      1.084266
                            ...   
2016-04-14  SZ300124      1.939886
            SZ300133      1.939886
            SZ300144      1.939886
            SZ300146      1.939886
            SZ300315      1.939886
Length: 555663, dtype: float64
[2211374:MainThread](2024-04-22 23:52:27,526) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:52:27,527) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:52:27,527) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:52:30,164) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:52:30,355) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995376
[2211374:MainThread](2024-04-22 23:52:30,356) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:52:30,356) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:52:32,967) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:52:33,156) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994605
[2211374:MainThread](2024-04-22 23:52:33,157) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:52:33,157) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:52:35,784) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:52:35,972) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994283
[2211374:MainThread](2024-04-22 23:52:35,973) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:52:35,974) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:52:38,584) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:52:38,773) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993600
[2211374:MainThread](2024-04-22 23:52:38,774) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:52:38,774) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:52:41,388) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:52:41,577) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993865
[2211374:MainThread](2024-04-22 23:52:41,578) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:52:41,578) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:52:44,194) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:52:44,383) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993256
[2211374:MainThread](2024-04-22 23:52:44,384) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:52:44,384) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:52:46,997) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:52:47,185) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992578
[2211374:MainThread](2024-04-22 23:52:47,186) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:52:47,186) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:52:49,810) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:52:49,999) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992538
[2211374:MainThread](2024-04-22 23:52:50,000) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:52:50,000) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:52:52,609) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:52:52,798) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992095
[2211374:MainThread](2024-04-22 23:52:52,799) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:52:52,799) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:52:55,426) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:52:55,615) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991943
[2211374:MainThread](2024-04-22 23:52:55,616) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:52:55,616) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:52:58,226) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:52:58,415) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991496
[2211374:MainThread](2024-04-22 23:52:58,416) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:52:58,416) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:53:01,028) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:53:01,217) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991196
[2211374:MainThread](2024-04-22 23:53:01,218) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:53:01,219) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:53:03,839) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:53:04,029) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993236
[2211374:MainThread](2024-04-22 23:53:04,029) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:53:04,030) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:53:06,676) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:53:06,864) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991337
[2211374:MainThread](2024-04-22 23:53:06,865) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:53:06,865) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:53:09,545) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:53:09,735) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991483
[2211374:MainThread](2024-04-22 23:53:09,735) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:53:09,736) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:53:12,361) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:53:12,550) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991324
[2211374:MainThread](2024-04-22 23:53:12,550) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:53:12,551) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:53:15,162) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:53:15,355) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991849
[2211374:MainThread](2024-04-22 23:53:15,355) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:53:15,356) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:53:17,959) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:53:18,149) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991634
[2211374:MainThread](2024-04-22 23:53:18,150) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:53:18,150) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:53:20,789) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:53:20,979) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991876
[2211374:MainThread](2024-04-22 23:53:20,980) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:53:20,980) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:53:23,621) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:53:23,810) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990731
[2211374:MainThread](2024-04-22 23:53:23,811) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:53:23,812) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:53:26,420) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:53:26,609) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992485
[2211374:MainThread](2024-04-22 23:53:26,610) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:53:26,610) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:53:29,247) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:53:29,436) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991243
[2211374:MainThread](2024-04-22 23:53:29,437) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 23:53:29,437) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:53:32,130) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:53:32,321) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991908
[2211374:MainThread](2024-04-22 23:53:32,321) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 23:53:32,322) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:53:35,011) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:53:35,200) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992264
[2211374:MainThread](2024-04-22 23:53:35,201) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 23:53:35,201) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:53:37,884) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:53:38,073) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991731
[2211374:MainThread](2024-04-22 23:53:38,074) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 23:53:38,074) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:53:40,745) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:53:40,934) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993350
[2211374:MainThread](2024-04-22 23:53:40,935) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-22 23:53:40,935) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:53:43,632) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:53:43,822) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993069
[2211374:MainThread](2024-04-22 23:53:43,822) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[2211374:MainThread](2024-04-22 23:53:43,822) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:53:46,496) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:53:46,686) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992050
[2211374:MainThread](2024-04-22 23:53:46,686) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:53:46,687) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990731 @ 19
[2211374:MainThread](2024-04-22 23:53:46,736) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-02-28 SH600000   -0.130866
           SH600008   -0.008629
           SH600009    0.091339
           SH600010   -0.076647
           SH600011   -0.044862
[2211374:MainThread](2024-04-22 23:53:48,398) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  34%|███▍      | 15/44 [17:42<39:04, 80.83s/it][2211374:MainThread](2024-04-22 23:53:48,407) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:53:48,417) INFO - qlib.workflow - [recorder.py:341] - Recorder 604a066850eb47e7880ed4baf9efdb38 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:53:48,963) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:53:48,964) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:53:48,966) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:53:48,966) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:53:56,622) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.802339
            SH600004      0.802339
            SH600006      0.802339
            SH600007      0.802339
            SH600008      0.802339
                            ...   
2016-05-13  SZ300124      0.811511
            SZ300133      0.811511
            SZ300144      0.811511
            SZ300146      0.811511
            SZ300315      0.811511
Length: 561275, dtype: float64
[2211374:MainThread](2024-04-22 23:53:56,624) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:53:56,624) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:53:56,625) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:53:59,336) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:53:59,559) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995747
[2211374:MainThread](2024-04-22 23:53:59,560) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:53:59,560) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:02,244) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:02,469) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995151
[2211374:MainThread](2024-04-22 23:54:02,470) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:54:02,471) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:05,093) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:05,317) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994112
[2211374:MainThread](2024-04-22 23:54:05,318) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:54:05,319) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:07,946) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:08,171) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994141
[2211374:MainThread](2024-04-22 23:54:08,171) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:54:08,171) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:10,722) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:10,948) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993391
[2211374:MainThread](2024-04-22 23:54:10,949) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:54:10,949) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:13,503) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:13,727) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992898
[2211374:MainThread](2024-04-22 23:54:13,728) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:54:13,728) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:16,358) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:16,583) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992831
[2211374:MainThread](2024-04-22 23:54:16,584) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:54:16,584) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:19,150) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:19,374) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993003
[2211374:MainThread](2024-04-22 23:54:19,374) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:54:19,374) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:22,010) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:22,234) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992441
[2211374:MainThread](2024-04-22 23:54:22,235) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:54:22,236) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:24,870) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:25,095) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992604
[2211374:MainThread](2024-04-22 23:54:25,095) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:54:25,095) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:27,721) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:27,946) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992899
[2211374:MainThread](2024-04-22 23:54:27,946) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:54:27,947) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:30,585) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:30,810) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992121
[2211374:MainThread](2024-04-22 23:54:30,811) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:54:30,811) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:33,441) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:33,665) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992393
[2211374:MainThread](2024-04-22 23:54:33,665) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:54:33,665) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:36,319) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:36,544) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992285
[2211374:MainThread](2024-04-22 23:54:36,544) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:54:36,544) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:39,229) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:39,453) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992997
[2211374:MainThread](2024-04-22 23:54:39,453) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:54:39,454) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:42,150) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:42,374) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991726
[2211374:MainThread](2024-04-22 23:54:42,375) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:54:42,375) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:45,087) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:45,311) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991620
[2211374:MainThread](2024-04-22 23:54:45,312) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:54:45,312) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:48,011) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:48,236) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991351
[2211374:MainThread](2024-04-22 23:54:48,237) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:54:48,237) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:50,952) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:51,176) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991334
[2211374:MainThread](2024-04-22 23:54:51,177) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:54:51,177) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:53,880) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:54,104) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991163
[2211374:MainThread](2024-04-22 23:54:54,105) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:54:54,106) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:56,815) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:57,039) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991046
[2211374:MainThread](2024-04-22 23:54:57,040) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:54:57,041) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:54:59,740) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:54:59,965) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990827
[2211374:MainThread](2024-04-22 23:54:59,966) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 23:54:59,966) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:55:02,663) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:55:02,889) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991157
[2211374:MainThread](2024-04-22 23:55:02,890) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 23:55:02,890) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:55:05,582) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:55:05,805) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990989
[2211374:MainThread](2024-04-22 23:55:05,806) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 23:55:05,806) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:55:08,512) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:55:08,736) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993573
[2211374:MainThread](2024-04-22 23:55:08,737) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 23:55:08,737) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:55:11,441) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:55:11,668) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991494
[2211374:MainThread](2024-04-22 23:55:11,669) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-22 23:55:11,669) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:55:14,331) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:55:14,559) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991516
[2211374:MainThread](2024-04-22 23:55:14,559) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[2211374:MainThread](2024-04-22 23:55:14,559) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:55:17,255) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:55:17,480) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992567
[2211374:MainThread](2024-04-22 23:55:17,481) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[2211374:MainThread](2024-04-22 23:55:17,481) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:55:20,117) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:55:20,342) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992931
[2211374:MainThread](2024-04-22 23:55:20,342) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[2211374:MainThread](2024-04-22 23:55:20,342) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:55:23,015) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:55:23,242) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993755
[2211374:MainThread](2024-04-22 23:55:23,243) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:55:23,243) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990827 @ 21
[2211374:MainThread](2024-04-22 23:55:23,292) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-03-28 SH600000   -0.055191
           SH600008   -0.157444
           SH600009    0.078979
           SH600010    0.116706
           SH600011   -0.106761
[2211374:MainThread](2024-04-22 23:55:25,008) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  36%|███▋      | 16/44 [19:18<39:56, 85.58s/it][2211374:MainThread](2024-04-22 23:55:25,017) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:55:25,027) INFO - qlib.workflow - [recorder.py:341] - Recorder 4225283024934cf08ede5b8873703330 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:55:25,580) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:55:25,581) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:55:25,584) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:55:25,584) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:55:33,581) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.773766
            SH600004      0.773766
            SH600006      0.773766
            SH600007      0.773766
            SH600008      0.773766
                            ...   
2016-06-14  SZ300133      1.551924
            SZ300144      1.551924
            SZ300146      1.551924
            SZ300251      1.551924
            SZ300315      1.551924
Length: 566995, dtype: float64
[2211374:MainThread](2024-04-22 23:55:33,584) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:55:33,584) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:55:33,585) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:55:36,334) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:55:36,557) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996358
[2211374:MainThread](2024-04-22 23:55:36,559) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:55:36,559) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:55:39,301) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:55:39,526) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994671
[2211374:MainThread](2024-04-22 23:55:39,527) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:55:39,528) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:55:42,270) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:55:42,497) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994068
[2211374:MainThread](2024-04-22 23:55:42,498) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:55:42,498) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:55:45,245) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:55:45,470) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993877
[2211374:MainThread](2024-04-22 23:55:45,471) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:55:45,471) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:55:48,210) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:55:48,437) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993196
[2211374:MainThread](2024-04-22 23:55:48,438) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:55:48,439) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:55:51,176) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:55:51,402) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992440
[2211374:MainThread](2024-04-22 23:55:51,403) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:55:51,403) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:55:54,073) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:55:54,297) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992704
[2211374:MainThread](2024-04-22 23:55:54,297) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:55:54,297) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:55:56,978) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:55:57,203) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992251
[2211374:MainThread](2024-04-22 23:55:57,204) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:55:57,205) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:55:59,866) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:56:00,090) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991944
[2211374:MainThread](2024-04-22 23:56:00,091) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:56:00,091) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:56:02,741) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:56:02,967) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992322
[2211374:MainThread](2024-04-22 23:56:02,967) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:56:02,968) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:56:05,624) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:56:05,848) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991941
[2211374:MainThread](2024-04-22 23:56:05,849) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:56:05,850) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:56:08,503) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:56:08,727) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992018
[2211374:MainThread](2024-04-22 23:56:08,728) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:56:08,728) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:56:11,391) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:56:11,616) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991323
[2211374:MainThread](2024-04-22 23:56:11,617) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:56:11,617) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:56:14,268) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:56:14,492) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991901
[2211374:MainThread](2024-04-22 23:56:14,492) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:56:14,493) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:56:17,128) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:56:17,353) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991831
[2211374:MainThread](2024-04-22 23:56:17,353) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:56:17,354) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:56:20,003) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:56:20,229) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992056
[2211374:MainThread](2024-04-22 23:56:20,229) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:56:20,229) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:56:22,882) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:56:23,108) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991934
[2211374:MainThread](2024-04-22 23:56:23,108) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:56:23,109) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:56:25,764) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:56:25,989) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991430
[2211374:MainThread](2024-04-22 23:56:25,989) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:56:25,990) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:56:28,644) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:56:28,868) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991285
[2211374:MainThread](2024-04-22 23:56:28,869) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:56:28,870) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:56:31,532) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:56:31,757) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992742
[2211374:MainThread](2024-04-22 23:56:31,758) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:56:31,758) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:56:34,407) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:56:34,632) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992359
[2211374:MainThread](2024-04-22 23:56:34,632) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:56:34,633) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:56:37,300) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:56:37,526) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991342
[2211374:MainThread](2024-04-22 23:56:37,526) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 23:56:37,526) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:56:40,177) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:56:40,402) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992682
[2211374:MainThread](2024-04-22 23:56:40,403) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 23:56:40,403) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:56:43,058) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:56:43,284) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991945
[2211374:MainThread](2024-04-22 23:56:43,285) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 23:56:43,285) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:56:45,953) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:56:46,178) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993209
[2211374:MainThread](2024-04-22 23:56:46,178) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 23:56:46,178) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:56:48,835) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:56:49,060) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993694
[2211374:MainThread](2024-04-22 23:56:49,061) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-22 23:56:49,061) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:56:51,725) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:56:51,951) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994081
[2211374:MainThread](2024-04-22 23:56:51,951) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:56:51,952) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991285 @ 18
[2211374:MainThread](2024-04-22 23:56:52,001) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-04-27 SH600000    0.025023
           SH600008   -0.033208
           SH600009    0.015620
           SH600010   -0.037511
           SH600011   -0.090612
[2211374:MainThread](2024-04-22 23:56:53,655) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  39%|███▊      | 17/44 [20:47<38:55, 86.50s/it][2211374:MainThread](2024-04-22 23:56:53,664) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:56:53,674) INFO - qlib.workflow - [recorder.py:341] - Recorder 399e70c4e36d47df907f1956e8dcd1e8 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:56:54,225) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:56:54,225) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:56:54,229) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:56:54,230) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:57:01,790) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.117705
            SH600004      1.117705
            SH600006      1.117705
            SH600007      1.117705
            SH600008      1.117705
                            ...   
2016-07-12  SZ300144      1.725862
            SZ300146      1.725862
            SZ300168      1.725862
            SZ300251      1.725862
            SZ300315      1.725862
Length: 572790, dtype: float64
[2211374:MainThread](2024-04-22 23:57:01,792) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:57:01,792) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:57:01,793) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:04,481) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:04,706) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995599
[2211374:MainThread](2024-04-22 23:57:04,708) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:57:04,708) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:07,366) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:07,591) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994750
[2211374:MainThread](2024-04-22 23:57:07,592) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:57:07,592) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:10,251) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:10,475) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993706
[2211374:MainThread](2024-04-22 23:57:10,476) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:57:10,477) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:13,136) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:13,359) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994236
[2211374:MainThread](2024-04-22 23:57:13,359) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:57:13,360) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:16,011) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:16,234) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992795
[2211374:MainThread](2024-04-22 23:57:16,235) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:57:16,236) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:18,922) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:19,149) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993085
[2211374:MainThread](2024-04-22 23:57:19,149) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:57:19,150) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:21,833) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:22,060) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992664
[2211374:MainThread](2024-04-22 23:57:22,061) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:57:22,061) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:24,747) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:24,971) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991680
[2211374:MainThread](2024-04-22 23:57:24,972) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:57:24,972) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:27,633) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:27,858) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991748
[2211374:MainThread](2024-04-22 23:57:27,858) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:57:27,859) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:30,519) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:30,750) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992758
[2211374:MainThread](2024-04-22 23:57:30,750) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:57:30,751) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:33,412) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:33,636) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991909
[2211374:MainThread](2024-04-22 23:57:33,636) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:57:33,636) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:36,295) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:36,519) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990898
[2211374:MainThread](2024-04-22 23:57:36,521) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:57:36,521) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:39,190) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:39,414) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990719
[2211374:MainThread](2024-04-22 23:57:39,415) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:57:39,416) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:42,070) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:42,294) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990968
[2211374:MainThread](2024-04-22 23:57:42,295) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:57:42,295) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:44,964) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:45,189) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991144
[2211374:MainThread](2024-04-22 23:57:45,190) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:57:45,190) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:47,857) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:48,084) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991319
[2211374:MainThread](2024-04-22 23:57:48,085) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:57:48,085) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:50,779) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:51,004) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992433
[2211374:MainThread](2024-04-22 23:57:51,004) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:57:51,005) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:53,662) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:53,889) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990182
[2211374:MainThread](2024-04-22 23:57:53,890) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:57:53,891) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:56,541) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:56,765) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990506
[2211374:MainThread](2024-04-22 23:57:56,765) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:57:56,766) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:57:59,450) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:57:59,677) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991876
[2211374:MainThread](2024-04-22 23:57:59,677) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:57:59,678) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:58:02,368) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:58:02,595) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991098
[2211374:MainThread](2024-04-22 23:58:02,596) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:58:02,596) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:58:05,293) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:58:05,517) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991039
[2211374:MainThread](2024-04-22 23:58:05,518) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 23:58:05,518) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:58:08,187) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:58:08,412) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992207
[2211374:MainThread](2024-04-22 23:58:08,412) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 23:58:08,413) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:58:11,113) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:58:11,341) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992656
[2211374:MainThread](2024-04-22 23:58:11,342) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 23:58:11,342) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:58:14,068) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:58:14,293) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992050
[2211374:MainThread](2024-04-22 23:58:14,294) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 23:58:14,294) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:58:16,949) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:58:17,174) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991765
[2211374:MainThread](2024-04-22 23:58:17,175) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:58:17,175) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990182 @ 17
[2211374:MainThread](2024-04-22 23:58:17,225) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-05-29 SH600000   -0.054242
           SH600008    0.003881
           SH600009   -0.011019
           SH600010   -0.158238
           SH600011   -0.064215
[2211374:MainThread](2024-04-22 23:58:18,877) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  41%|████      | 18/44 [22:12<37:19, 86.12s/it][2211374:MainThread](2024-04-22 23:58:18,885) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:58:18,896) INFO - qlib.workflow - [recorder.py:341] - Recorder 58d9655a87854f7eaa3eaef14093dd67 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:58:19,441) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:58:19,441) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:58:19,444) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:58:19,444) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:58:27,056) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.959617
            SH600004      0.959617
            SH600006      0.959617
            SH600007      0.959617
            SH600008      0.959617
                            ...   
2016-08-09  SZ300144      1.895097
            SZ300146      1.895097
            SZ300168      1.895097
            SZ300251      1.895097
            SZ300315      1.895097
Length: 578598, dtype: float64
[2211374:MainThread](2024-04-22 23:58:27,058) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:58:27,059) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:58:27,059) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:58:29,797) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:58:29,999) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995591
[2211374:MainThread](2024-04-22 23:58:30,000) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:58:30,000) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:58:32,739) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:58:32,940) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994886
[2211374:MainThread](2024-04-22 23:58:32,941) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:58:32,942) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:58:35,676) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:58:35,877) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993878
[2211374:MainThread](2024-04-22 23:58:35,879) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-22 23:58:35,879) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:58:38,624) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:58:38,825) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993712
[2211374:MainThread](2024-04-22 23:58:38,826) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-22 23:58:38,827) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:58:41,557) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:58:41,758) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993760
[2211374:MainThread](2024-04-22 23:58:41,759) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-22 23:58:41,759) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:58:44,497) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:58:44,697) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992706
[2211374:MainThread](2024-04-22 23:58:44,698) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-22 23:58:44,698) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:58:47,406) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:58:47,606) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992934
[2211374:MainThread](2024-04-22 23:58:47,606) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-22 23:58:47,607) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:58:50,316) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:58:50,515) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992458
[2211374:MainThread](2024-04-22 23:58:50,517) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-22 23:58:50,517) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:58:53,237) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:58:53,438) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992411
[2211374:MainThread](2024-04-22 23:58:53,439) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-22 23:58:53,439) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:58:56,148) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:58:56,348) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992202
[2211374:MainThread](2024-04-22 23:58:56,349) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-22 23:58:56,349) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:58:59,060) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:58:59,259) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993396
[2211374:MainThread](2024-04-22 23:58:59,260) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-22 23:58:59,260) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:59:01,956) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:59:02,155) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991878
[2211374:MainThread](2024-04-22 23:59:02,156) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-22 23:59:02,156) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:59:04,866) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:59:05,067) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991286
[2211374:MainThread](2024-04-22 23:59:05,068) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-22 23:59:05,068) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:59:07,768) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:59:07,968) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992113
[2211374:MainThread](2024-04-22 23:59:07,968) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-22 23:59:07,968) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:59:10,669) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:59:10,869) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992470
[2211374:MainThread](2024-04-22 23:59:10,870) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-22 23:59:10,870) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:59:13,571) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:59:13,771) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991536
[2211374:MainThread](2024-04-22 23:59:13,772) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-22 23:59:13,772) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:59:16,475) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:59:16,675) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991819
[2211374:MainThread](2024-04-22 23:59:16,676) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-22 23:59:16,676) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:59:19,401) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:59:19,601) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991100
[2211374:MainThread](2024-04-22 23:59:19,602) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-22 23:59:19,603) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:59:22,301) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:59:22,501) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991743
[2211374:MainThread](2024-04-22 23:59:22,502) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-22 23:59:22,502) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:59:25,209) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:59:25,408) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991653
[2211374:MainThread](2024-04-22 23:59:25,409) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-22 23:59:25,409) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:59:28,106) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:59:28,307) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991426
[2211374:MainThread](2024-04-22 23:59:28,307) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-22 23:59:28,308) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:59:31,004) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:59:31,206) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991355
[2211374:MainThread](2024-04-22 23:59:31,206) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-22 23:59:31,207) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:59:33,913) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:59:34,113) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991641
[2211374:MainThread](2024-04-22 23:59:34,114) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-22 23:59:34,114) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:59:36,807) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:59:37,007) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991582
[2211374:MainThread](2024-04-22 23:59:37,007) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-22 23:59:37,008) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:59:39,717) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:59:39,917) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992068
[2211374:MainThread](2024-04-22 23:59:39,918) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-22 23:59:39,918) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:59:42,617) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:59:42,817) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992217
[2211374:MainThread](2024-04-22 23:59:42,817) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-22 23:59:42,817) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991100 @ 17
[2211374:MainThread](2024-04-22 23:59:42,867) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-06-27 SH600000   -0.084012
           SH600008   -0.033190
           SH600009    0.090621
           SH600010    0.005655
           SH600011   -0.075392
[2211374:MainThread](2024-04-22 23:59:44,505) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  43%|████▎     | 19/44 [23:38<35:49, 85.97s/it][2211374:MainThread](2024-04-22 23:59:44,514) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-22 23:59:44,524) INFO - qlib.workflow - [recorder.py:341] - Recorder 2f70561bdfe7447cacb2f2b0571537aa starts running under Experiment 15 ...
[2211374:MainThread](2024-04-22 23:59:45,064) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-22 23:59:45,065) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-22 23:59:45,068) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-22 23:59:45,069) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-22 23:59:52,618) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.741478
            SH600004      0.741478
            SH600006      0.741478
            SH600007      0.741478
            SH600008      0.741478
                            ...   
2016-09-06  SZ300144      1.279543
            SZ300146      1.279543
            SZ300168      1.279543
            SZ300251      1.279543
            SZ300315      1.279543
Length: 584401, dtype: float64
[2211374:MainThread](2024-04-22 23:59:52,620) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-22 23:59:52,620) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-22 23:59:52,621) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:59:55,349) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:59:55,575) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995855
[2211374:MainThread](2024-04-22 23:59:55,576) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-22 23:59:55,576) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-22 23:59:58,302) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-22 23:59:58,527) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994397
[2211374:MainThread](2024-04-22 23:59:58,528) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-22 23:59:58,529) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:01,248) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:01,476) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994497
[2211374:MainThread](2024-04-23 00:00:01,477) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:00:01,477) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:04,203) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:04,429) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993428
[2211374:MainThread](2024-04-23 00:00:04,430) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:00:04,430) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:07,161) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:07,387) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993149
[2211374:MainThread](2024-04-23 00:00:07,388) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:00:07,388) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:10,106) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:10,332) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993208
[2211374:MainThread](2024-04-23 00:00:10,332) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:00:10,333) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:13,086) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:13,311) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992081
[2211374:MainThread](2024-04-23 00:00:13,312) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:00:13,313) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:16,059) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:16,287) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992218
[2211374:MainThread](2024-04-23 00:00:16,288) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:00:16,288) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:19,058) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:19,287) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991998
[2211374:MainThread](2024-04-23 00:00:19,288) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:00:19,288) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:22,047) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:22,276) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991406
[2211374:MainThread](2024-04-23 00:00:22,277) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:00:22,277) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:25,045) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:25,273) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991322
[2211374:MainThread](2024-04-23 00:00:25,274) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:00:25,275) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:28,031) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:28,261) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991481
[2211374:MainThread](2024-04-23 00:00:28,262) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:00:28,262) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:31,013) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:31,242) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991589
[2211374:MainThread](2024-04-23 00:00:31,242) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:00:31,242) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:34,014) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:34,243) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992326
[2211374:MainThread](2024-04-23 00:00:34,244) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:00:34,244) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:37,002) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:37,231) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990802
[2211374:MainThread](2024-04-23 00:00:37,232) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:00:37,233) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:40,004) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:40,232) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991203
[2211374:MainThread](2024-04-23 00:00:40,233) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:00:40,233) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:42,988) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:43,218) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991640
[2211374:MainThread](2024-04-23 00:00:43,218) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:00:43,218) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:45,984) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:46,213) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990877
[2211374:MainThread](2024-04-23 00:00:46,213) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:00:46,214) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:48,969) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:49,198) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992274
[2211374:MainThread](2024-04-23 00:00:49,199) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:00:49,199) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:51,966) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:52,195) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991483
[2211374:MainThread](2024-04-23 00:00:52,195) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:00:52,196) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:54,950) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:55,180) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992769
[2211374:MainThread](2024-04-23 00:00:55,180) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:00:55,180) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:00:57,934) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:00:58,164) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991777
[2211374:MainThread](2024-04-23 00:00:58,164) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:00:58,164) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:01:00,928) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:01:01,157) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993382
[2211374:MainThread](2024-04-23 00:01:01,157) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:01:01,158) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990802 @ 14
[2211374:MainThread](2024-04-23 00:01:01,208) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-07-25 SH600000    0.028897
           SH600008    0.044473
           SH600009   -0.109619
           SH600010   -0.109095
           SH600011   -0.016105
[2211374:MainThread](2024-04-23 00:01:02,895) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  45%|████▌     | 20/44 [24:56<33:28, 83.70s/it][2211374:MainThread](2024-04-23 00:01:02,904) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:01:02,914) INFO - qlib.workflow - [recorder.py:341] - Recorder 0632c2b76ad946878a83d678a618ead2 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:01:03,457) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:01:03,458) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:01:03,461) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:01:03,461) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:01:11,202) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.363866
            SH600004      1.363866
            SH600006      1.363866
            SH600007      1.363866
            SH600008      1.363866
                            ...   
2016-10-13  SZ300144      0.705235
            SZ300146      0.705235
            SZ300168      0.705235
            SZ300251      0.705235
            SZ300315      0.705235
Length: 590146, dtype: float64
[2211374:MainThread](2024-04-23 00:01:11,204) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:01:11,205) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:01:11,205) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:01:14,035) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:01:14,239) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995492
[2211374:MainThread](2024-04-23 00:01:14,240) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:01:14,240) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:01:17,050) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:01:17,254) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994417
[2211374:MainThread](2024-04-23 00:01:17,256) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:01:17,256) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:01:20,078) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:01:20,282) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993463
[2211374:MainThread](2024-04-23 00:01:20,283) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:01:20,283) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:01:23,090) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:01:23,294) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993016
[2211374:MainThread](2024-04-23 00:01:23,295) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:01:23,296) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:01:26,113) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:01:26,317) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993577
[2211374:MainThread](2024-04-23 00:01:26,318) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:01:26,318) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:01:29,129) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:01:29,333) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992164
[2211374:MainThread](2024-04-23 00:01:29,334) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:01:29,334) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:01:32,123) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:01:32,326) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993067
[2211374:MainThread](2024-04-23 00:01:32,326) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:01:32,326) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:01:35,082) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:01:35,286) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991927
[2211374:MainThread](2024-04-23 00:01:35,287) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:01:35,288) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:01:38,076) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:01:38,279) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991651
[2211374:MainThread](2024-04-23 00:01:38,280) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:01:38,280) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:01:41,145) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:01:41,348) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991881
[2211374:MainThread](2024-04-23 00:01:41,349) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:01:41,349) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:01:44,207) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:01:44,411) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991475
[2211374:MainThread](2024-04-23 00:01:44,412) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:01:44,412) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:01:47,239) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:01:47,443) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991184
[2211374:MainThread](2024-04-23 00:01:47,444) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:01:47,445) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:01:50,250) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:01:50,455) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990642
[2211374:MainThread](2024-04-23 00:01:50,456) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:01:50,456) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:01:53,295) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:01:53,499) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991403
[2211374:MainThread](2024-04-23 00:01:53,499) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:01:53,499) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:01:56,358) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:01:56,563) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991549
[2211374:MainThread](2024-04-23 00:01:56,563) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:01:56,563) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:01:59,438) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:01:59,643) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991594
[2211374:MainThread](2024-04-23 00:01:59,643) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:01:59,643) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:02:02,501) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:02:02,705) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990765
[2211374:MainThread](2024-04-23 00:02:02,706) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:02:02,706) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:02:05,573) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:02:05,778) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992296
[2211374:MainThread](2024-04-23 00:02:05,778) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:02:05,778) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:02:08,643) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:02:08,847) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991759
[2211374:MainThread](2024-04-23 00:02:08,848) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:02:08,848) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:02:11,702) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:02:11,908) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991512
[2211374:MainThread](2024-04-23 00:02:11,908) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:02:11,908) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:02:14,782) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:02:14,986) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991793
[2211374:MainThread](2024-04-23 00:02:14,987) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:02:14,987) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990642 @ 12
[2211374:MainThread](2024-04-23 00:02:15,037) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-08-22 SH600000   -0.003366
           SH600008   -0.086080
           SH600009    0.143511
           SH600010   -0.040062
           SH600011   -0.120008
[2211374:MainThread](2024-04-23 00:02:16,761) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  48%|████▊     | 21/44 [26:10<30:57, 80.74s/it][2211374:MainThread](2024-04-23 00:02:16,769) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:02:16,780) INFO - qlib.workflow - [recorder.py:341] - Recorder 4fd0011d4eab44b496af2245b6ed8f94 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:02:17,313) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:02:17,314) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:02:17,316) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:02:17,317) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:02:25,350) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.262838
            SH600004      1.262838
            SH600006      1.262838
            SH600007      1.262838
            SH600008      1.262838
                            ...   
2016-11-10  SZ300144      1.077128
            SZ300146      1.077128
            SZ300168      1.077128
            SZ300251      1.077128
            SZ300315      1.077128
Length: 595946, dtype: float64
[2211374:MainThread](2024-04-23 00:02:25,353) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:02:25,353) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:02:25,353) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:02:28,270) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:02:28,491) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995328
[2211374:MainThread](2024-04-23 00:02:28,492) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:02:28,492) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:02:31,384) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:02:31,607) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994106
[2211374:MainThread](2024-04-23 00:02:31,608) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:02:31,608) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:02:34,455) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:02:34,678) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993997
[2211374:MainThread](2024-04-23 00:02:34,680) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:02:34,680) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:02:37,508) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:02:37,731) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992807
[2211374:MainThread](2024-04-23 00:02:37,732) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:02:37,733) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:02:40,618) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:02:40,842) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992774
[2211374:MainThread](2024-04-23 00:02:40,843) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:02:40,843) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:02:43,731) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:02:43,955) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991924
[2211374:MainThread](2024-04-23 00:02:43,956) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:02:43,957) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:02:46,853) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:02:47,076) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991617
[2211374:MainThread](2024-04-23 00:02:47,078) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:02:47,078) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:02:49,940) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:02:50,165) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991961
[2211374:MainThread](2024-04-23 00:02:50,165) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:02:50,165) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:02:53,061) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:02:53,284) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990996
[2211374:MainThread](2024-04-23 00:02:53,285) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:02:53,286) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:02:56,170) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:02:56,393) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991158
[2211374:MainThread](2024-04-23 00:02:56,393) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:02:56,394) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:02:59,296) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:02:59,520) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990564
[2211374:MainThread](2024-04-23 00:02:59,522) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:02:59,522) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:03:02,406) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:03:02,629) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990347
[2211374:MainThread](2024-04-23 00:03:02,630) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:03:02,630) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:03:05,516) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:03:05,740) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991198
[2211374:MainThread](2024-04-23 00:03:05,740) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:03:05,741) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:03:08,637) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:03:08,859) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990891
[2211374:MainThread](2024-04-23 00:03:08,859) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:03:08,859) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:03:11,740) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:03:11,964) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990512
[2211374:MainThread](2024-04-23 00:03:11,964) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:03:11,964) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:03:14,856) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:03:15,078) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990650
[2211374:MainThread](2024-04-23 00:03:15,078) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:03:15,078) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:03:17,958) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:03:18,183) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990186
[2211374:MainThread](2024-04-23 00:03:18,184) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:03:18,184) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:03:21,078) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:03:21,302) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991116
[2211374:MainThread](2024-04-23 00:03:21,303) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:03:21,303) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:03:24,178) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:03:24,399) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990241
[2211374:MainThread](2024-04-23 00:03:24,400) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:03:24,400) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:03:27,291) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:03:27,513) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991156
[2211374:MainThread](2024-04-23 00:03:27,513) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:03:27,513) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:03:30,394) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:03:30,615) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990101
[2211374:MainThread](2024-04-23 00:03:30,617) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:03:30,617) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:03:33,481) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:03:33,705) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991423
[2211374:MainThread](2024-04-23 00:03:33,705) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:03:33,706) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:03:36,570) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:03:36,795) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991482
[2211374:MainThread](2024-04-23 00:03:36,795) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 00:03:36,795) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:03:39,682) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:03:39,907) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990263
[2211374:MainThread](2024-04-23 00:03:39,907) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-23 00:03:39,908) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:03:42,734) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:03:42,959) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990692
[2211374:MainThread](2024-04-23 00:03:42,960) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-23 00:03:42,960) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:03:45,794) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:03:46,016) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991650
[2211374:MainThread](2024-04-23 00:03:46,016) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-23 00:03:46,016) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:03:48,826) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:03:49,047) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991547
[2211374:MainThread](2024-04-23 00:03:49,048) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[2211374:MainThread](2024-04-23 00:03:49,048) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:03:51,882) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:03:52,106) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991650
[2211374:MainThread](2024-04-23 00:03:52,106) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[2211374:MainThread](2024-04-23 00:03:52,107) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:03:54,921) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:03:55,142) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992286
[2211374:MainThread](2024-04-23 00:03:55,143) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:03:55,143) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990101 @ 20
[2211374:MainThread](2024-04-23 00:03:55,193) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-09-19 SH600000    0.025839
           SH600008    0.047852
           SH600009   -0.020182
           SH600010    0.017553
           SH600011    0.128055
[2211374:MainThread](2024-04-23 00:03:56,848) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  50%|█████     | 22/44 [27:50<31:44, 86.55s/it][2211374:MainThread](2024-04-23 00:03:56,857) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:03:56,867) INFO - qlib.workflow - [recorder.py:341] - Recorder 45c8358045c540acaf41837559fb0dff starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:03:57,411) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:03:57,412) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:03:57,415) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:03:57,416) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:04:05,008) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.958080
            SH600004      0.958080
            SH600006      0.958080
            SH600007      0.958080
            SH600008      0.958080
                            ...   
2016-12-08  SZ300144      1.834576
            SZ300146      1.834576
            SZ300168      1.834576
            SZ300251      1.834576
            SZ300315      1.834576
Length: 601711, dtype: float64
[2211374:MainThread](2024-04-23 00:04:05,010) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:04:05,010) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:04:05,011) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:04:07,854) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:04:08,075) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995290
[2211374:MainThread](2024-04-23 00:04:08,076) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:04:08,076) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:04:10,903) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:04:11,127) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995597
[2211374:MainThread](2024-04-23 00:04:11,127) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:04:11,128) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:04:13,985) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:04:14,209) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993079
[2211374:MainThread](2024-04-23 00:04:14,210) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:04:14,211) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:04:17,060) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:04:17,284) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993355
[2211374:MainThread](2024-04-23 00:04:17,284) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:04:17,285) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:04:20,150) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:04:20,373) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992730
[2211374:MainThread](2024-04-23 00:04:20,374) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:04:20,374) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:04:23,189) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:04:23,411) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992238
[2211374:MainThread](2024-04-23 00:04:23,412) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:04:23,412) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:04:26,251) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:04:26,473) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992315
[2211374:MainThread](2024-04-23 00:04:26,474) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:04:26,474) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:04:29,269) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:04:29,491) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992009
[2211374:MainThread](2024-04-23 00:04:29,492) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:04:29,492) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:04:32,293) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:04:32,518) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991512
[2211374:MainThread](2024-04-23 00:04:32,519) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:04:32,520) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:04:35,321) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:04:35,543) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991521
[2211374:MainThread](2024-04-23 00:04:35,544) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:04:35,544) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:04:38,343) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:04:38,565) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992577
[2211374:MainThread](2024-04-23 00:04:38,565) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:04:38,565) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:04:41,440) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:04:41,661) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990770
[2211374:MainThread](2024-04-23 00:04:41,662) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:04:41,663) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:04:44,510) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:04:44,732) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992242
[2211374:MainThread](2024-04-23 00:04:44,732) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:04:44,733) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:04:47,615) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:04:47,839) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991289
[2211374:MainThread](2024-04-23 00:04:47,840) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:04:47,840) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:04:50,702) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:04:50,927) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992195
[2211374:MainThread](2024-04-23 00:04:50,927) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:04:50,927) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:04:53,828) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:04:54,052) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991026
[2211374:MainThread](2024-04-23 00:04:54,053) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:04:54,053) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:04:56,853) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:04:57,079) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990526
[2211374:MainThread](2024-04-23 00:04:57,081) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:04:57,081) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:04:59,836) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:05:00,059) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990739
[2211374:MainThread](2024-04-23 00:05:00,060) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:05:00,060) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:05:02,881) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:05:03,103) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990564
[2211374:MainThread](2024-04-23 00:05:03,103) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:05:03,104) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:05:05,978) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:05:06,205) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991287
[2211374:MainThread](2024-04-23 00:05:06,205) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:05:06,206) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:05:09,073) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:05:09,296) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991345
[2211374:MainThread](2024-04-23 00:05:09,297) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:05:09,297) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:05:12,162) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:05:12,385) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991816
[2211374:MainThread](2024-04-23 00:05:12,385) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:05:12,385) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:05:15,258) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:05:15,481) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993330
[2211374:MainThread](2024-04-23 00:05:15,481) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 00:05:15,481) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:05:18,353) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:05:18,576) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992110
[2211374:MainThread](2024-04-23 00:05:18,576) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-23 00:05:18,576) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:05:21,466) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:05:21,688) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990976
[2211374:MainThread](2024-04-23 00:05:21,688) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:05:21,689) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990526 @ 16
[2211374:MainThread](2024-04-23 00:05:21,739) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-10-25 SH600000   -0.114266
           SH600008    0.095401
           SH600009   -0.273703
           SH600010    0.002267
           SH600011   -0.023102
[2211374:MainThread](2024-04-23 00:05:23,395) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  52%|█████▏    | 23/44 [29:17<30:17, 86.55s/it][2211374:MainThread](2024-04-23 00:05:23,404) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:05:23,414) INFO - qlib.workflow - [recorder.py:341] - Recorder 37d34f673b054ab1ab431e204e269f1f starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:05:23,959) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:05:23,960) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:05:23,963) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:05:23,964) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:05:31,551) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.762900
            SH600004      1.762900
            SH600006      1.762900
            SH600007      1.762900
            SH600008      1.762900
                            ...   
2017-01-06  SZ300146      1.663911
            SZ300168      1.663911
            SZ300182      1.663911
            SZ300251      1.663911
            SZ300315      1.663911
Length: 607469, dtype: float64
[2211374:MainThread](2024-04-23 00:05:31,554) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:05:31,554) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:05:31,554) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:05:34,482) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:05:34,707) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995491
[2211374:MainThread](2024-04-23 00:05:34,708) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:05:34,708) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:05:37,609) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:05:37,834) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994749
[2211374:MainThread](2024-04-23 00:05:37,835) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:05:37,835) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:05:40,714) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:05:40,937) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993698
[2211374:MainThread](2024-04-23 00:05:40,938) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:05:40,938) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:05:43,849) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:05:44,074) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992981
[2211374:MainThread](2024-04-23 00:05:44,075) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:05:44,075) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:05:47,001) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:05:47,227) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992278
[2211374:MainThread](2024-04-23 00:05:47,228) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:05:47,228) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:05:50,140) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:05:50,363) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992229
[2211374:MainThread](2024-04-23 00:05:50,364) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:05:50,365) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:05:53,289) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:05:53,514) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992798
[2211374:MainThread](2024-04-23 00:05:53,515) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:05:53,515) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:05:56,428) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:05:56,652) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991661
[2211374:MainThread](2024-04-23 00:05:56,653) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:05:56,653) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:05:59,578) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:05:59,803) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992315
[2211374:MainThread](2024-04-23 00:05:59,803) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:05:59,804) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:06:02,717) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:06:02,943) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991564
[2211374:MainThread](2024-04-23 00:06:02,944) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:06:02,944) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:06:05,856) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:06:06,082) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991467
[2211374:MainThread](2024-04-23 00:06:06,083) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:06:06,083) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:06:09,006) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:06:09,230) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990398
[2211374:MainThread](2024-04-23 00:06:09,231) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:06:09,231) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:06:12,143) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:06:12,369) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992038
[2211374:MainThread](2024-04-23 00:06:12,369) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:06:12,370) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:06:15,293) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:06:15,516) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991772
[2211374:MainThread](2024-04-23 00:06:15,516) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:06:15,516) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:06:18,367) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:06:18,593) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991766
[2211374:MainThread](2024-04-23 00:06:18,594) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:06:18,594) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:06:21,461) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:06:21,685) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990874
[2211374:MainThread](2024-04-23 00:06:21,686) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:06:21,686) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:06:24,511) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:06:24,734) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990172
[2211374:MainThread](2024-04-23 00:06:24,735) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:06:24,735) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:06:27,572) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:06:27,796) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991479
[2211374:MainThread](2024-04-23 00:06:27,796) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:06:27,796) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:06:30,620) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:06:30,843) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991405
[2211374:MainThread](2024-04-23 00:06:30,844) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:06:30,844) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:06:33,678) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:06:33,902) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991197
[2211374:MainThread](2024-04-23 00:06:33,903) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:06:33,903) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:06:36,725) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:06:36,949) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991365
[2211374:MainThread](2024-04-23 00:06:36,950) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:06:36,950) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:06:39,786) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:06:40,013) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990628
[2211374:MainThread](2024-04-23 00:06:40,013) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:06:40,013) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:06:42,839) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:06:43,062) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992116
[2211374:MainThread](2024-04-23 00:06:43,063) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 00:06:43,063) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:06:45,884) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:06:46,109) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992129
[2211374:MainThread](2024-04-23 00:06:46,109) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-23 00:06:46,110) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:06:48,938) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:06:49,162) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992242
[2211374:MainThread](2024-04-23 00:06:49,163) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:06:49,163) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990172 @ 16
[2211374:MainThread](2024-04-23 00:06:49,210) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-11-22 SH600000    0.004546
           SH600008   -0.071408
           SH600009   -0.109391
           SH600010    0.045164
           SH600011    0.156316
[2211374:MainThread](2024-04-23 00:06:50,867) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  55%|█████▍    | 24/44 [30:44<28:56, 86.83s/it][2211374:MainThread](2024-04-23 00:06:50,875) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:06:50,886) INFO - qlib.workflow - [recorder.py:341] - Recorder d9a939449d7247b08ccba787156439cd starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:06:51,424) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:06:51,424) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:06:51,428) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:06:51,429) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:06:59,009) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.522822
            SH600004      1.522822
            SH600006      1.522822
            SH600007      1.522822
            SH600008      1.522822
                            ...   
2017-02-10  SZ300144      1.763289
            SZ300146      1.763289
            SZ300168      1.763289
            SZ300182      1.763289
            SZ300251      1.763289
Length: 613211, dtype: float64
[2211374:MainThread](2024-04-23 00:06:59,011) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:06:59,012) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:06:59,012) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:07:01,904) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:07:02,130) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995345
[2211374:MainThread](2024-04-23 00:07:02,132) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:07:02,132) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:07:04,994) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:07:05,221) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994239
[2211374:MainThread](2024-04-23 00:07:05,222) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:07:05,222) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:07:08,117) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:07:08,343) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994337
[2211374:MainThread](2024-04-23 00:07:08,343) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:07:08,343) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:07:11,228) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:07:11,458) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992723
[2211374:MainThread](2024-04-23 00:07:11,459) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:07:11,459) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:07:14,321) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:07:14,551) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993574
[2211374:MainThread](2024-04-23 00:07:14,552) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:07:14,552) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:07:17,328) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:07:17,555) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992131
[2211374:MainThread](2024-04-23 00:07:17,556) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:07:17,556) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:07:20,392) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:07:20,622) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991548
[2211374:MainThread](2024-04-23 00:07:20,623) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:07:20,623) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:07:23,452) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:07:23,680) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991766
[2211374:MainThread](2024-04-23 00:07:23,680) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:07:23,680) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:07:26,481) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:07:26,712) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991414
[2211374:MainThread](2024-04-23 00:07:26,713) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:07:26,714) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:07:29,596) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:07:29,826) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991534
[2211374:MainThread](2024-04-23 00:07:29,827) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:07:29,827) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:07:32,718) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:07:32,948) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990952
[2211374:MainThread](2024-04-23 00:07:32,949) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:07:32,950) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:07:35,812) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:07:36,039) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990737
[2211374:MainThread](2024-04-23 00:07:36,040) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:07:36,040) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:07:38,889) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:07:39,116) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991439
[2211374:MainThread](2024-04-23 00:07:39,116) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:07:39,117) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:07:41,982) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:07:42,208) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991680
[2211374:MainThread](2024-04-23 00:07:42,208) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:07:42,209) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:07:45,061) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:07:45,287) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990585
[2211374:MainThread](2024-04-23 00:07:45,288) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:07:45,288) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:07:48,154) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:07:48,381) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990822
[2211374:MainThread](2024-04-23 00:07:48,381) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:07:48,382) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:07:51,249) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:07:51,475) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991388
[2211374:MainThread](2024-04-23 00:07:51,476) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:07:51,476) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:07:54,313) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:07:54,540) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991280
[2211374:MainThread](2024-04-23 00:07:54,540) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:07:54,540) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:07:57,468) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:07:57,696) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992875
[2211374:MainThread](2024-04-23 00:07:57,696) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:07:57,697) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:08:00,618) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:08:00,846) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991862
[2211374:MainThread](2024-04-23 00:08:00,847) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:08:00,847) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:08:03,756) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:08:03,984) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991653
[2211374:MainThread](2024-04-23 00:08:03,985) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:08:03,985) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:08:06,935) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:08:07,164) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993504
[2211374:MainThread](2024-04-23 00:08:07,164) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:08:07,164) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:08:10,054) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:08:10,283) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993700
[2211374:MainThread](2024-04-23 00:08:10,283) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:08:10,283) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990585 @ 14
[2211374:MainThread](2024-04-23 00:08:10,332) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-12-20 SH600000    0.066901
           SH600004   -0.003723
           SH600009    0.020474
           SH600010   -0.039839
           SH600011   -0.010973
[2211374:MainThread](2024-04-23 00:08:11,996) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  57%|█████▋    | 25/44 [32:05<26:57, 85.12s/it][2211374:MainThread](2024-04-23 00:08:12,005) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:08:12,015) INFO - qlib.workflow - [recorder.py:341] - Recorder 5f3fcabc56da4cbea7cd51b9911d2c77 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:08:12,566) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:08:12,566) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:08:12,569) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:08:12,570) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:08:20,273) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.523390
            SH600004      1.523390
            SH600006      1.523390
            SH600007      1.523390
            SH600008      1.523390
                            ...   
2017-03-10  SZ300144      1.973418
            SZ300146      1.973418
            SZ300168      1.973418
            SZ300182      1.973418
            SZ300251      1.973418
Length: 618892, dtype: float64
[2211374:MainThread](2024-04-23 00:08:20,275) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:08:20,276) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:08:20,276) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:08:23,232) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:08:23,459) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996090
[2211374:MainThread](2024-04-23 00:08:23,460) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:08:23,460) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:08:26,416) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:08:26,645) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994675
[2211374:MainThread](2024-04-23 00:08:26,646) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:08:26,647) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:08:29,600) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:08:29,827) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993582
[2211374:MainThread](2024-04-23 00:08:29,828) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:08:29,828) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:08:32,770) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:08:32,997) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993977
[2211374:MainThread](2024-04-23 00:08:32,998) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:08:32,998) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:08:35,945) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:08:36,175) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993472
[2211374:MainThread](2024-04-23 00:08:36,176) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:08:36,176) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:08:39,070) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:08:39,298) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992677
[2211374:MainThread](2024-04-23 00:08:39,299) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:08:39,300) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:08:42,253) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:08:42,481) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993491
[2211374:MainThread](2024-04-23 00:08:42,481) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:08:42,482) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:08:45,421) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:08:45,648) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992062
[2211374:MainThread](2024-04-23 00:08:45,649) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:08:45,650) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:08:48,604) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:08:48,831) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992799
[2211374:MainThread](2024-04-23 00:08:48,832) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:08:48,832) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:08:51,772) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:08:51,999) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991565
[2211374:MainThread](2024-04-23 00:08:52,000) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:08:52,001) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:08:54,957) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:08:55,184) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993091
[2211374:MainThread](2024-04-23 00:08:55,185) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:08:55,185) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:08:58,123) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:08:58,351) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991909
[2211374:MainThread](2024-04-23 00:08:58,351) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:08:58,352) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:09:01,331) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:09:01,560) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992045
[2211374:MainThread](2024-04-23 00:09:01,560) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:09:01,560) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:09:04,519) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:09:04,748) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992604
[2211374:MainThread](2024-04-23 00:09:04,748) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:09:04,749) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:09:07,735) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:09:07,963) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992312
[2211374:MainThread](2024-04-23 00:09:07,964) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:09:07,964) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:09:10,914) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:09:11,141) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993955
[2211374:MainThread](2024-04-23 00:09:11,142) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:09:11,142) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:09:14,090) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:09:14,319) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993877
[2211374:MainThread](2024-04-23 00:09:14,319) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:09:14,320) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:09:17,268) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:09:17,496) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992810
[2211374:MainThread](2024-04-23 00:09:17,496) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:09:17,497) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991565 @ 9
[2211374:MainThread](2024-04-23 00:09:17,545) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-01-21 SH600000    0.017820
           SH600004    0.206397
           SH600009    0.083051
           SH600010    0.032152
           SH600011   -0.045427
[2211374:MainThread](2024-04-23 00:09:19,189) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  59%|█████▉    | 26/44 [33:13<23:55, 79.74s/it][2211374:MainThread](2024-04-23 00:09:19,198) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:09:19,208) INFO - qlib.workflow - [recorder.py:341] - Recorder 0ae35dff3ab5420a88575b92b1569ffe starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:09:19,757) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:09:19,758) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:09:19,762) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:09:19,763) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:09:27,451) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.978415
            SH600004      0.978415
            SH600006      0.978415
            SH600007      0.978415
            SH600008      0.978415
                            ...   
2017-04-11  SZ300144      1.743305
            SZ300146      1.743305
            SZ300168      1.743305
            SZ300182      1.743305
            SZ300251      1.743305
Length: 624606, dtype: float64
[2211374:MainThread](2024-04-23 00:09:27,453) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:09:27,454) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:09:27,454) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:09:30,415) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:09:30,609) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995562
[2211374:MainThread](2024-04-23 00:09:30,610) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:09:30,610) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:09:33,575) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:09:33,770) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994651
[2211374:MainThread](2024-04-23 00:09:33,771) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:09:33,771) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:09:36,693) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:09:36,887) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994140
[2211374:MainThread](2024-04-23 00:09:36,888) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:09:36,888) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:09:39,851) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:09:40,048) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993699
[2211374:MainThread](2024-04-23 00:09:40,049) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:09:40,049) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:09:43,019) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:09:43,212) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992906
[2211374:MainThread](2024-04-23 00:09:43,213) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:09:43,214) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:09:46,185) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:09:46,379) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993663
[2211374:MainThread](2024-04-23 00:09:46,379) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:09:46,380) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:09:49,349) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:09:49,543) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993100
[2211374:MainThread](2024-04-23 00:09:49,544) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:09:49,544) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:09:52,503) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:09:52,698) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992618
[2211374:MainThread](2024-04-23 00:09:52,699) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:09:52,699) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:09:55,668) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:09:55,862) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992429
[2211374:MainThread](2024-04-23 00:09:55,863) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:09:55,864) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:09:58,822) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:09:59,016) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992665
[2211374:MainThread](2024-04-23 00:09:59,017) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:09:59,017) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:10:01,998) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:10:02,193) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992225
[2211374:MainThread](2024-04-23 00:10:02,194) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:10:02,194) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:10:05,168) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:10:05,364) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991790
[2211374:MainThread](2024-04-23 00:10:05,365) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:10:05,366) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:10:08,242) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:10:08,438) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991336
[2211374:MainThread](2024-04-23 00:10:08,439) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:10:08,439) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:10:11,260) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:10:11,456) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992974
[2211374:MainThread](2024-04-23 00:10:11,457) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:10:11,457) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:10:14,457) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:10:14,651) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993728
[2211374:MainThread](2024-04-23 00:10:14,651) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:10:14,651) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:10:17,613) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:10:17,807) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992775
[2211374:MainThread](2024-04-23 00:10:17,808) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:10:17,808) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:10:20,786) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:10:20,982) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992744
[2211374:MainThread](2024-04-23 00:10:20,982) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:10:20,983) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:10:23,941) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:10:24,137) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992109
[2211374:MainThread](2024-04-23 00:10:24,138) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:10:24,138) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:10:27,143) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:10:27,340) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992860
[2211374:MainThread](2024-04-23 00:10:27,340) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:10:27,340) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:10:30,301) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:10:30,497) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993231
[2211374:MainThread](2024-04-23 00:10:30,497) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:10:30,497) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:10:33,444) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:10:33,640) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992243
[2211374:MainThread](2024-04-23 00:10:33,640) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:10:33,641) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991336 @ 12
[2211374:MainThread](2024-04-23 00:10:33,689) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-02-25 SH600000    0.105977
           SH600004    0.020739
           SH600009   -0.287839
           SH600010    0.084381
           SH600011    0.012584
[2211374:MainThread](2024-04-23 00:10:35,375) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  61%|██████▏   | 27/44 [34:29<22:17, 78.67s/it][2211374:MainThread](2024-04-23 00:10:35,384) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:10:35,394) INFO - qlib.workflow - [recorder.py:341] - Recorder 5acb9bef8c354e9e93e476c9a381fe54 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:10:35,936) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:10:35,936) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:10:35,939) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:10:35,939) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:10:43,692) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.926852
            SH600004      0.926852
            SH600006      0.926852
            SH600007      0.926852
            SH600008      0.926852
                            ...   
2017-05-10  SZ300133      1.392713
            SZ300144      1.392713
            SZ300146      1.392713
            SZ300182      1.392713
            SZ300251      1.392713
Length: 630244, dtype: float64
[2211374:MainThread](2024-04-23 00:10:43,694) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:10:43,694) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:10:43,695) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:10:46,691) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:10:46,899) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995376
[2211374:MainThread](2024-04-23 00:10:46,900) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:10:46,901) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:10:49,870) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:10:50,077) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995623
[2211374:MainThread](2024-04-23 00:10:50,077) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:10:50,078) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:10:53,065) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:10:53,277) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993783
[2211374:MainThread](2024-04-23 00:10:53,278) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:10:53,278) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:10:56,273) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:10:56,483) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993849
[2211374:MainThread](2024-04-23 00:10:56,483) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:10:56,483) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:10:59,472) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:10:59,681) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993736
[2211374:MainThread](2024-04-23 00:10:59,682) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:10:59,682) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:11:02,684) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:11:02,893) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992396
[2211374:MainThread](2024-04-23 00:11:02,894) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:11:02,894) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:11:05,883) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:11:06,092) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993709
[2211374:MainThread](2024-04-23 00:11:06,093) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:11:06,093) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:11:09,098) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:11:09,308) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994421
[2211374:MainThread](2024-04-23 00:11:09,308) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:11:09,308) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:11:12,279) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:11:12,488) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991763
[2211374:MainThread](2024-04-23 00:11:12,489) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:11:12,490) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:11:15,490) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:11:15,700) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992006
[2211374:MainThread](2024-04-23 00:11:15,700) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:11:15,701) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:11:18,693) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:11:18,902) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992201
[2211374:MainThread](2024-04-23 00:11:18,903) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:11:18,903) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:11:21,891) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:11:22,101) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993296
[2211374:MainThread](2024-04-23 00:11:22,101) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:11:22,102) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:11:25,071) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:11:25,281) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992116
[2211374:MainThread](2024-04-23 00:11:25,281) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:11:25,282) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:11:28,285) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:11:28,495) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992353
[2211374:MainThread](2024-04-23 00:11:28,495) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:11:28,496) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:11:31,485) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:11:31,696) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992809
[2211374:MainThread](2024-04-23 00:11:31,696) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:11:31,697) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:11:34,695) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:11:34,905) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991475
[2211374:MainThread](2024-04-23 00:11:34,906) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:11:34,906) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:11:37,898) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:11:38,108) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992080
[2211374:MainThread](2024-04-23 00:11:38,108) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:11:38,109) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:11:41,109) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:11:41,319) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992718
[2211374:MainThread](2024-04-23 00:11:41,319) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:11:41,319) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:11:44,313) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:11:44,523) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992631
[2211374:MainThread](2024-04-23 00:11:44,523) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:11:44,524) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:11:47,527) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:11:47,737) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991664
[2211374:MainThread](2024-04-23 00:11:47,737) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:11:47,738) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:11:50,730) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:11:50,939) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992332
[2211374:MainThread](2024-04-23 00:11:50,939) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:11:50,939) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:11:53,918) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:11:54,126) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994472
[2211374:MainThread](2024-04-23 00:11:54,126) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:11:54,127) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:11:57,083) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:11:57,291) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993426
[2211374:MainThread](2024-04-23 00:11:57,291) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 00:11:57,292) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:12:00,260) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:12:00,468) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993386
[2211374:MainThread](2024-04-23 00:12:00,468) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:12:00,469) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991475 @ 15
[2211374:MainThread](2024-04-23 00:12:00,517) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-03-25 SH600000    0.018311
           SH600004    0.090776
           SH600009    0.005414
           SH600010    0.009795
           SH600011   -0.170710
[2211374:MainThread](2024-04-23 00:12:02,177) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  64%|██████▎   | 28/44 [35:55<21:37, 81.11s/it][2211374:MainThread](2024-04-23 00:12:02,185) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:12:02,195) INFO - qlib.workflow - [recorder.py:341] - Recorder c0cf51c007d7419bafaf24cffd2a709e starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:12:02,735) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:12:02,736) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:12:02,739) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:12:02,739) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:12:10,354) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.856279
            SH600004      1.856279
            SH600006      1.856279
            SH600007      1.856279
            SH600008      1.856279
                            ...   
2017-06-09  SZ300133      1.798304
            SZ300144      1.798304
            SZ300146      1.798304
            SZ300182      1.798304
            SZ300251      1.798304
Length: 635820, dtype: float64
[2211374:MainThread](2024-04-23 00:12:10,356) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:12:10,357) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:12:10,357) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:12:13,358) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:12:13,554) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995673
[2211374:MainThread](2024-04-23 00:12:13,555) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:12:13,556) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:12:16,531) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:12:16,728) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995092
[2211374:MainThread](2024-04-23 00:12:16,729) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:12:16,729) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:12:19,719) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:12:19,919) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994137
[2211374:MainThread](2024-04-23 00:12:19,920) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:12:19,921) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:12:22,913) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:12:23,110) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993587
[2211374:MainThread](2024-04-23 00:12:23,111) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:12:23,112) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:12:26,105) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:12:26,302) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992984
[2211374:MainThread](2024-04-23 00:12:26,303) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:12:26,304) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:12:29,310) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:12:29,507) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993285
[2211374:MainThread](2024-04-23 00:12:29,507) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:12:29,507) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:12:32,488) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:12:32,685) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992444
[2211374:MainThread](2024-04-23 00:12:32,686) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:12:32,687) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:12:35,685) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:12:35,882) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993243
[2211374:MainThread](2024-04-23 00:12:35,882) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:12:35,883) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:12:38,861) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:12:39,058) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992611
[2211374:MainThread](2024-04-23 00:12:39,058) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:12:39,059) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:12:42,050) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:12:42,247) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992707
[2211374:MainThread](2024-04-23 00:12:42,248) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:12:42,248) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:12:45,229) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:12:45,426) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992130
[2211374:MainThread](2024-04-23 00:12:45,427) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:12:45,427) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:12:48,431) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:12:48,628) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991918
[2211374:MainThread](2024-04-23 00:12:48,629) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:12:48,630) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:12:51,620) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:12:51,818) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994459
[2211374:MainThread](2024-04-23 00:12:51,818) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:12:51,819) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:12:54,816) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:12:55,012) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991574
[2211374:MainThread](2024-04-23 00:12:55,013) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:12:55,014) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:12:57,985) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:12:58,182) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992262
[2211374:MainThread](2024-04-23 00:12:58,183) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:12:58,183) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:13:01,167) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:13:01,364) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991775
[2211374:MainThread](2024-04-23 00:13:01,364) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:13:01,364) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:13:04,341) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:13:04,538) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992897
[2211374:MainThread](2024-04-23 00:13:04,539) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:13:04,539) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:13:07,543) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:13:07,741) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992430
[2211374:MainThread](2024-04-23 00:13:07,741) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:13:07,742) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:13:10,727) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:13:10,925) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992768
[2211374:MainThread](2024-04-23 00:13:10,925) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:13:10,925) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:13:13,922) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:13:14,119) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992371
[2211374:MainThread](2024-04-23 00:13:14,120) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:13:14,120) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:13:17,108) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:13:17,305) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993902
[2211374:MainThread](2024-04-23 00:13:17,306) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:13:17,306) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:13:20,305) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:13:20,503) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993741
[2211374:MainThread](2024-04-23 00:13:20,503) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:13:20,504) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991574 @ 13
[2211374:MainThread](2024-04-23 00:13:20,552) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-04-23 SH600000    0.031358
           SH600004    0.000898
           SH600009   -0.152973
           SH600010    0.003339
           SH600011   -0.023234
[2211374:MainThread](2024-04-23 00:13:22,228) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  66%|██████▌   | 29/44 [37:16<20:11, 80.79s/it][2211374:MainThread](2024-04-23 00:13:22,237) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:13:22,247) INFO - qlib.workflow - [recorder.py:341] - Recorder ab75c528341d4977a9ef22d5250c8eee starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:13:22,780) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:13:22,780) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:13:22,783) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:13:22,783) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:13:30,502) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.447775
            SH600004      1.447775
            SH600006      1.447775
            SH600007      1.447775
            SH600008      1.447775
                            ...   
2017-07-07  SZ300133      1.382270
            SZ300144      1.382270
            SZ300168      1.382270
            SZ300251      1.382270
            SZ300315      1.382270
Length: 641204, dtype: float64
[2211374:MainThread](2024-04-23 00:13:30,504) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:13:30,504) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:13:30,504) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:13:33,545) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:13:33,754) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996087
[2211374:MainThread](2024-04-23 00:13:33,755) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:13:33,756) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:13:36,770) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:13:36,980) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995050
[2211374:MainThread](2024-04-23 00:13:36,981) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:13:36,982) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:13:39,996) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:13:40,207) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994524
[2211374:MainThread](2024-04-23 00:13:40,208) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:13:40,209) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:13:43,156) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:13:43,368) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993868
[2211374:MainThread](2024-04-23 00:13:43,369) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:13:43,369) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:13:46,328) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:13:46,540) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993564
[2211374:MainThread](2024-04-23 00:13:46,541) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:13:46,541) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:13:49,551) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:13:49,761) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992976
[2211374:MainThread](2024-04-23 00:13:49,762) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:13:49,763) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:13:52,770) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:13:52,980) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992302
[2211374:MainThread](2024-04-23 00:13:52,981) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:13:52,982) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:13:55,998) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:13:56,207) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992838
[2211374:MainThread](2024-04-23 00:13:56,207) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:13:56,208) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:13:59,214) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:13:59,425) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993749
[2211374:MainThread](2024-04-23 00:13:59,425) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:13:59,425) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:14:02,438) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:14:02,649) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992741
[2211374:MainThread](2024-04-23 00:14:02,649) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:14:02,649) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:14:05,651) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:14:05,862) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992485
[2211374:MainThread](2024-04-23 00:14:05,862) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:14:05,862) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:14:08,878) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:14:09,088) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992749
[2211374:MainThread](2024-04-23 00:14:09,089) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:14:09,089) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:14:12,091) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:14:12,302) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992519
[2211374:MainThread](2024-04-23 00:14:12,303) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:14:12,303) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:14:15,316) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:14:15,526) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993016
[2211374:MainThread](2024-04-23 00:14:15,527) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:14:15,527) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:14:18,528) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:14:18,739) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993759
[2211374:MainThread](2024-04-23 00:14:18,739) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:14:18,739) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992302 @ 6
[2211374:MainThread](2024-04-23 00:14:18,787) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-05-24 SH600000   -0.037055
           SH600004   -0.056505
           SH600009    0.016502
           SH600010   -0.053141
           SH600011   -0.059786
[2211374:MainThread](2024-04-23 00:14:20,443) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  68%|██████▊   | 30/44 [38:14<17:16, 74.02s/it][2211374:MainThread](2024-04-23 00:14:20,452) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:14:20,462) INFO - qlib.workflow - [recorder.py:341] - Recorder 11ddc0b548e843a5b7b988eca5c56415 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:14:21,006) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:14:21,007) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:14:21,010) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:14:21,011) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:14:28,622) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.774841
            SH600004      0.774841
            SH600006      0.774841
            SH600007      0.774841
            SH600008      0.774841
                            ...   
2017-08-04  SZ300133      1.042580
            SZ300144      1.042580
            SZ300168      1.042580
            SZ300251      1.042580
            SZ300315      1.042580
Length: 646851, dtype: float64
[2211374:MainThread](2024-04-23 00:14:28,624) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:14:28,624) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:14:28,625) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:14:31,659) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:14:31,892) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995851
[2211374:MainThread](2024-04-23 00:14:31,893) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:14:31,893) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:14:34,929) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:14:35,162) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994690
[2211374:MainThread](2024-04-23 00:14:35,163) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:14:35,163) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:14:38,185) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:14:38,418) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993319
[2211374:MainThread](2024-04-23 00:14:38,419) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:14:38,419) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:14:41,456) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:14:41,689) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992851
[2211374:MainThread](2024-04-23 00:14:41,690) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:14:41,690) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:14:44,710) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:14:44,944) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994316
[2211374:MainThread](2024-04-23 00:14:44,944) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:14:44,944) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:14:48,016) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:14:48,248) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993010
[2211374:MainThread](2024-04-23 00:14:48,248) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:14:48,248) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:14:51,328) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:14:51,560) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992585
[2211374:MainThread](2024-04-23 00:14:51,561) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:14:51,561) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:14:54,657) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:14:54,888) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993351
[2211374:MainThread](2024-04-23 00:14:54,889) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:14:54,889) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:14:57,971) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:14:58,203) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992611
[2211374:MainThread](2024-04-23 00:14:58,203) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:14:58,203) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:15:01,310) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:15:01,541) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994249
[2211374:MainThread](2024-04-23 00:15:01,542) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:15:01,542) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:15:04,628) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:15:04,859) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993766
[2211374:MainThread](2024-04-23 00:15:04,860) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:15:04,860) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:15:07,956) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:15:08,189) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993123
[2211374:MainThread](2024-04-23 00:15:08,190) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:15:08,190) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:15:11,290) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:15:11,522) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995160
[2211374:MainThread](2024-04-23 00:15:11,523) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:15:11,523) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:15:14,635) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:15:14,867) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992913
[2211374:MainThread](2024-04-23 00:15:14,868) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:15:14,868) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:15:17,969) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:15:18,201) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992842
[2211374:MainThread](2024-04-23 00:15:18,202) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:15:18,202) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992585 @ 6
[2211374:MainThread](2024-04-23 00:15:18,250) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-06-24 SH600000    0.015963
           SH600004   -0.207430
           SH600009   -0.157451
           SH600010    0.000248
           SH600011    0.057837
[2211374:MainThread](2024-04-23 00:15:20,782) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  70%|███████   | 31/44 [39:14<15:08, 69.92s/it][2211374:MainThread](2024-04-23 00:15:20,794) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:15:20,806) INFO - qlib.workflow - [recorder.py:341] - Recorder 0eea34810f584f8a853164dbe71a414c starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:15:21,550) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:15:21,550) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:15:21,553) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:15:21,554) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:15:29,954) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.704263
            SH600004      0.704263
            SH600006      0.704263
            SH600007      0.704263
            SH600008      0.704263
                            ...   
2017-09-01  SZ300133      1.500845
            SZ300144      1.500845
            SZ300168      1.500845
            SZ300251      1.500845
            SZ300315      1.500845
Length: 652446, dtype: float64
[2211374:MainThread](2024-04-23 00:15:29,957) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:15:29,957) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:15:29,958) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:15:33,171) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:15:33,378) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995811
[2211374:MainThread](2024-04-23 00:15:33,379) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:15:33,380) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:15:36,352) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:15:36,561) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995071
[2211374:MainThread](2024-04-23 00:15:36,562) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:15:36,563) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:15:39,522) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:15:39,731) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994321
[2211374:MainThread](2024-04-23 00:15:39,732) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:15:39,733) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:15:42,746) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:15:42,952) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994236
[2211374:MainThread](2024-04-23 00:15:42,953) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:15:42,954) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:15:45,992) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:15:46,198) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993910
[2211374:MainThread](2024-04-23 00:15:46,200) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:15:46,200) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:15:49,239) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:15:49,446) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992779
[2211374:MainThread](2024-04-23 00:15:49,447) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:15:49,448) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:15:52,457) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:15:52,664) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992838
[2211374:MainThread](2024-04-23 00:15:52,664) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:15:52,664) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:15:55,689) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:15:55,896) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992806
[2211374:MainThread](2024-04-23 00:15:55,897) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:15:55,897) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:15:58,927) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:15:59,134) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992898
[2211374:MainThread](2024-04-23 00:15:59,134) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:15:59,135) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:16:02,179) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:16:02,387) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992530
[2211374:MainThread](2024-04-23 00:16:02,388) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:16:02,388) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:16:05,415) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:16:05,622) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992762
[2211374:MainThread](2024-04-23 00:16:05,622) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:16:05,622) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:16:08,677) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:16:08,884) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993468
[2211374:MainThread](2024-04-23 00:16:08,885) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:16:08,885) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:16:11,928) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:16:12,135) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992264
[2211374:MainThread](2024-04-23 00:16:12,137) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:16:12,137) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:16:15,188) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:16:15,395) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993241
[2211374:MainThread](2024-04-23 00:16:15,395) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:16:15,395) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:16:18,437) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:16:18,644) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993459
[2211374:MainThread](2024-04-23 00:16:18,645) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:16:18,645) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:16:21,704) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:16:21,911) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993102
[2211374:MainThread](2024-04-23 00:16:21,911) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:16:21,912) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:16:24,960) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:16:25,167) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993378
[2211374:MainThread](2024-04-23 00:16:25,167) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:16:25,167) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:16:28,222) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:16:28,429) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993930
[2211374:MainThread](2024-04-23 00:16:28,429) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:16:28,430) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:16:31,469) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:16:31,677) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995161
[2211374:MainThread](2024-04-23 00:16:31,677) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:16:31,678) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:16:34,735) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:16:34,942) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994234
[2211374:MainThread](2024-04-23 00:16:34,943) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:16:34,943) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:16:37,990) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:16:38,197) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993049
[2211374:MainThread](2024-04-23 00:16:38,198) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:16:38,198) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992264 @ 12
[2211374:MainThread](2024-04-23 00:16:38,260) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-07-22 SH600000   -0.002857
           SH600004    0.045590
           SH600009   -0.073641
           SH600010   -0.038916
           SH600011    0.006372
[2211374:MainThread](2024-04-23 00:16:40,900) INFO - qlib.timer - [log.py:127] - Time cost: 0.001s | waiting `async_log` Done
train tasks:  73%|███████▎  | 32/44 [40:34<14:35, 72.98s/it][2211374:MainThread](2024-04-23 00:16:40,911) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:16:40,922) INFO - qlib.workflow - [recorder.py:341] - Recorder 8ea7e04b54f74ed68dd66fad8c712f95 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:16:41,466) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:16:41,467) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:16:41,471) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:16:41,472) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:16:49,339) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.333059
            SH600004      1.333059
            SH600006      1.333059
            SH600007      1.333059
            SH600008      1.333059
                            ...   
2017-09-29  SZ300133      1.674899
            SZ300144      1.674899
            SZ300168      1.674899
            SZ300251      1.674899
            SZ300315      1.674899
Length: 658139, dtype: float64
[2211374:MainThread](2024-04-23 00:16:49,341) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:16:49,342) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:16:49,342) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:16:52,431) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:16:52,664) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995703
[2211374:MainThread](2024-04-23 00:16:52,665) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:16:52,665) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:16:55,743) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:16:55,976) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994718
[2211374:MainThread](2024-04-23 00:16:55,977) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:16:55,978) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:16:59,052) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:16:59,285) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993822
[2211374:MainThread](2024-04-23 00:16:59,286) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:16:59,286) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:17:02,369) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:17:02,603) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994047
[2211374:MainThread](2024-04-23 00:17:02,603) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:17:02,603) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:17:05,676) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:17:05,909) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993284
[2211374:MainThread](2024-04-23 00:17:05,910) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:17:05,911) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:17:09,000) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:17:09,233) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995696
[2211374:MainThread](2024-04-23 00:17:09,234) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:17:09,234) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:17:12,306) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:17:12,540) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992599
[2211374:MainThread](2024-04-23 00:17:12,541) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:17:12,541) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:17:15,681) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:17:15,913) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992700
[2211374:MainThread](2024-04-23 00:17:15,914) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:17:15,914) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:17:19,055) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:17:19,287) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992843
[2211374:MainThread](2024-04-23 00:17:19,288) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:17:19,288) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:17:22,465) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:17:22,702) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993154
[2211374:MainThread](2024-04-23 00:17:22,702) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:17:22,703) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:17:25,864) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:17:26,103) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992284
[2211374:MainThread](2024-04-23 00:17:26,104) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:17:26,105) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:17:29,249) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:17:29,486) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993602
[2211374:MainThread](2024-04-23 00:17:29,486) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:17:29,487) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:17:32,661) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:17:32,897) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992584
[2211374:MainThread](2024-04-23 00:17:32,898) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:17:32,898) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:17:36,069) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:17:36,305) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993383
[2211374:MainThread](2024-04-23 00:17:36,306) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:17:36,306) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:17:39,455) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:17:39,690) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992418
[2211374:MainThread](2024-04-23 00:17:39,690) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:17:39,691) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:17:42,857) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:17:43,094) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992389
[2211374:MainThread](2024-04-23 00:17:43,095) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:17:43,095) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:17:46,277) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:17:46,514) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993846
[2211374:MainThread](2024-04-23 00:17:46,514) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:17:46,514) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:17:49,682) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:17:49,919) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995456
[2211374:MainThread](2024-04-23 00:17:49,919) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:17:49,919) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:17:53,101) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:17:53,335) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994282
[2211374:MainThread](2024-04-23 00:17:53,335) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:17:53,336) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992284 @ 10
[2211374:MainThread](2024-04-23 00:17:53,385) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-08-19 SH600000    0.017833
           SH600004   -0.039740
           SH600009    0.072457
           SH600010   -0.001421
           SH600011   -0.051290
[2211374:MainThread](2024-04-23 00:17:55,062) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  75%|███████▌  | 33/44 [41:48<13:26, 73.33s/it][2211374:MainThread](2024-04-23 00:17:55,072) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:17:55,083) INFO - qlib.workflow - [recorder.py:341] - Recorder fec37bd2db0048349ef343e26f27d15b starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:17:55,616) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:17:55,616) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:17:55,619) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:17:55,620) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:18:03,349) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.161882
            SH600004      1.161882
            SH600006      1.161882
            SH600007      1.161882
            SH600008      1.161882
                            ...   
2017-11-03  SZ300133      1.710750
            SZ300144      1.710750
            SZ300168      1.710750
            SZ300251      1.710750
            SZ300315      1.710750
Length: 663832, dtype: float64
[2211374:MainThread](2024-04-23 00:18:03,351) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:18:03,352) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:18:03,352) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:18:06,577) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:18:06,814) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996191
[2211374:MainThread](2024-04-23 00:18:06,815) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:18:06,815) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:18:10,006) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:18:10,241) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994975
[2211374:MainThread](2024-04-23 00:18:10,242) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:18:10,243) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:18:13,445) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:18:13,682) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996097
[2211374:MainThread](2024-04-23 00:18:13,683) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:18:13,683) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:18:16,865) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:18:17,101) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994344
[2211374:MainThread](2024-04-23 00:18:17,102) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:18:17,103) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:18:20,276) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:18:20,510) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993806
[2211374:MainThread](2024-04-23 00:18:20,511) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:18:20,511) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:18:23,699) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:18:23,936) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994416
[2211374:MainThread](2024-04-23 00:18:23,936) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:18:23,936) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:18:27,138) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:18:27,372) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994002
[2211374:MainThread](2024-04-23 00:18:27,372) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:18:27,372) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:18:30,565) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:18:30,801) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994917
[2211374:MainThread](2024-04-23 00:18:30,801) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:18:30,801) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:18:33,987) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:18:34,224) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994174
[2211374:MainThread](2024-04-23 00:18:34,224) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:18:34,225) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:18:37,356) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:18:37,592) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994356
[2211374:MainThread](2024-04-23 00:18:37,593) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:18:37,593) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:18:40,738) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:18:40,975) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993998
[2211374:MainThread](2024-04-23 00:18:40,975) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:18:40,976) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:18:44,108) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:18:44,345) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996107
[2211374:MainThread](2024-04-23 00:18:44,345) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:18:44,346) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:18:47,492) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:18:47,729) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994541
[2211374:MainThread](2024-04-23 00:18:47,730) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:18:47,730) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993806 @ 4
[2211374:MainThread](2024-04-23 00:18:47,776) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-09-17 SH600000    0.073070
           SH600004    0.127189
           SH600009   -0.050297
           SH600010   -0.041601
           SH600011   -0.074836
[2211374:MainThread](2024-04-23 00:18:49,453) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  77%|███████▋  | 34/44 [42:43<11:16, 67.65s/it][2211374:MainThread](2024-04-23 00:18:49,467) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:18:49,477) INFO - qlib.workflow - [recorder.py:341] - Recorder 563643656c8f45a092b2328e317ce1b8 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:18:50,022) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:18:50,023) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:18:50,027) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:18:50,027) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:18:57,769) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.650422
            SH600004      0.650422
            SH600006      0.650422
            SH600007      0.650422
            SH600008      0.650422
                            ...   
2017-12-01  SZ300133      1.076438
            SZ300144      1.076438
            SZ300168      1.076438
            SZ300251      1.076438
            SZ300315      1.076438
Length: 669550, dtype: float64
[2211374:MainThread](2024-04-23 00:18:57,771) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:18:57,772) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:18:57,772) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:19:00,994) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:19:01,227) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996900
[2211374:MainThread](2024-04-23 00:19:01,228) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:19:01,229) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:19:04,438) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:19:04,668) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995095
[2211374:MainThread](2024-04-23 00:19:04,669) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:19:04,670) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:19:07,886) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:19:08,119) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994390
[2211374:MainThread](2024-04-23 00:19:08,120) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:19:08,120) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:19:11,329) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:19:11,564) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993937
[2211374:MainThread](2024-04-23 00:19:11,565) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:19:11,566) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:19:14,758) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:19:14,992) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994893
[2211374:MainThread](2024-04-23 00:19:14,992) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:19:14,992) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:19:18,205) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:19:18,442) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994930
[2211374:MainThread](2024-04-23 00:19:18,442) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:19:18,442) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:19:21,591) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:19:21,831) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994402
[2211374:MainThread](2024-04-23 00:19:21,831) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:19:21,831) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:19:24,978) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:19:25,210) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995069
[2211374:MainThread](2024-04-23 00:19:25,211) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:19:25,211) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:19:28,371) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:19:28,608) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993178
[2211374:MainThread](2024-04-23 00:19:28,609) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:19:28,609) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:19:31,753) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:19:31,990) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995168
[2211374:MainThread](2024-04-23 00:19:31,990) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:19:31,990) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:19:35,144) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:19:35,381) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994212
[2211374:MainThread](2024-04-23 00:19:35,381) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:19:35,382) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:19:38,563) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:19:38,800) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993749
[2211374:MainThread](2024-04-23 00:19:38,800) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:19:38,801) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:19:41,968) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:19:42,205) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994140
[2211374:MainThread](2024-04-23 00:19:42,205) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:19:42,206) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:19:45,354) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:19:45,591) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995673
[2211374:MainThread](2024-04-23 00:19:45,591) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:19:45,591) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:19:48,756) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:19:48,993) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993834
[2211374:MainThread](2024-04-23 00:19:48,993) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:19:48,994) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:19:52,125) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:19:52,358) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994154
[2211374:MainThread](2024-04-23 00:19:52,358) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:19:52,358) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:19:55,490) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:19:55,723) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993647
[2211374:MainThread](2024-04-23 00:19:55,723) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:19:55,723) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993178 @ 8
[2211374:MainThread](2024-04-23 00:19:55,772) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-10-22 SH600000    0.101423
           SH600004    0.141966
           SH600009   -0.109790
           SH600010   -0.024795
           SH600011   -0.031307
[2211374:MainThread](2024-04-23 00:19:57,428) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  80%|███████▉  | 35/44 [43:51<10:09, 67.75s/it][2211374:MainThread](2024-04-23 00:19:57,437) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:19:57,447) INFO - qlib.workflow - [recorder.py:341] - Recorder 9594f801ae8740c7a6a1657d94a559a7 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:19:57,969) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:19:57,969) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:19:57,972) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:19:57,972) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:20:05,616) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.712987
            SH600004      0.712987
            SH600006      0.712987
            SH600007      0.712987
            SH600008      0.712987
                            ...   
2017-12-29  SZ300124      1.555787
            SZ300136      1.555787
            SZ300144      1.555787
            SZ300251      1.555787
            SZ300315      1.555787
Length: 675267, dtype: float64
[2211374:MainThread](2024-04-23 00:20:05,619) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:20:05,619) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:20:05,620) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:20:08,782) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:20:08,990) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996296
[2211374:MainThread](2024-04-23 00:20:08,991) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:20:08,991) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:20:12,165) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:20:12,373) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995572
[2211374:MainThread](2024-04-23 00:20:12,374) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:20:12,374) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:20:15,555) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:20:15,763) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995656
[2211374:MainThread](2024-04-23 00:20:15,763) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:20:15,764) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:20:18,936) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:20:19,146) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994355
[2211374:MainThread](2024-04-23 00:20:19,147) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:20:19,147) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:20:22,308) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:20:22,517) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994265
[2211374:MainThread](2024-04-23 00:20:22,518) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:20:22,518) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:20:25,730) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:20:25,943) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995640
[2211374:MainThread](2024-04-23 00:20:25,943) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:20:25,944) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:20:29,127) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:20:29,336) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994281
[2211374:MainThread](2024-04-23 00:20:29,336) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:20:29,336) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:20:32,519) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:20:32,729) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994963
[2211374:MainThread](2024-04-23 00:20:32,729) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:20:32,729) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:20:35,906) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:20:36,115) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995079
[2211374:MainThread](2024-04-23 00:20:36,116) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:20:36,116) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:20:39,309) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:20:39,520) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994488
[2211374:MainThread](2024-04-23 00:20:39,520) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:20:39,520) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:20:42,721) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:20:42,930) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994865
[2211374:MainThread](2024-04-23 00:20:42,930) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:20:42,931) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:20:46,131) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:20:46,340) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996333
[2211374:MainThread](2024-04-23 00:20:46,340) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:20:46,340) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:20:49,516) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:20:49,725) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994512
[2211374:MainThread](2024-04-23 00:20:49,726) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:20:49,726) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.994265 @ 4
[2211374:MainThread](2024-04-23 00:20:49,772) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-11-19 SH600000   -0.001624
           SH600004   -0.024188
           SH600009    0.003945
           SH600010    0.002186
           SH600011    0.037430
[2211374:MainThread](2024-04-23 00:20:51,412) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  82%|████████▏ | 36/44 [44:45<08:28, 63.62s/it][2211374:MainThread](2024-04-23 00:20:51,420) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:20:51,431) INFO - qlib.workflow - [recorder.py:341] - Recorder f838fb4d7cc0466d89928eaccb80438d starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:20:51,973) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:20:51,973) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:20:51,976) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:20:51,977) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:20:59,615) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.776857
            SH600004      0.776857
            SH600006      0.776857
            SH600007      0.776857
            SH600008      0.776857
                            ...   
2018-01-29  SZ300124      1.931388
            SZ300136      1.931388
            SZ300144      1.931388
            SZ300251      1.931388
            SZ300315      1.931388
Length: 680999, dtype: float64
[2211374:MainThread](2024-04-23 00:20:59,618) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:20:59,618) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:20:59,618) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:21:02,819) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:21:03,051) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996902
[2211374:MainThread](2024-04-23 00:21:03,052) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:21:03,053) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:21:06,248) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:21:06,480) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997382
[2211374:MainThread](2024-04-23 00:21:06,480) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:21:06,480) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:21:09,674) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:21:09,905) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994797
[2211374:MainThread](2024-04-23 00:21:09,907) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:21:09,907) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:21:13,107) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:21:13,339) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995228
[2211374:MainThread](2024-04-23 00:21:13,340) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:21:13,340) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:21:16,550) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:21:16,785) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995434
[2211374:MainThread](2024-04-23 00:21:16,785) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:21:16,785) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:21:20,003) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:21:20,235) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994977
[2211374:MainThread](2024-04-23 00:21:20,235) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:21:20,236) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:21:23,428) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:21:23,660) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994559
[2211374:MainThread](2024-04-23 00:21:23,661) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:21:23,661) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:21:26,875) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:21:27,110) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995036
[2211374:MainThread](2024-04-23 00:21:27,110) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:21:27,110) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:21:30,305) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:21:30,539) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994556
[2211374:MainThread](2024-04-23 00:21:30,540) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:21:30,541) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:21:33,746) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:21:33,979) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994617
[2211374:MainThread](2024-04-23 00:21:33,979) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:21:33,979) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:21:37,206) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:21:37,441) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995477
[2211374:MainThread](2024-04-23 00:21:37,441) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:21:37,442) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:21:40,682) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:21:40,917) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994190
[2211374:MainThread](2024-04-23 00:21:40,918) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:21:40,918) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:21:44,138) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:21:44,372) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994657
[2211374:MainThread](2024-04-23 00:21:44,373) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:21:44,373) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:21:47,566) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:21:47,799) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995578
[2211374:MainThread](2024-04-23 00:21:47,799) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:21:47,799) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:21:50,983) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:21:51,215) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995414
[2211374:MainThread](2024-04-23 00:21:51,216) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:21:51,216) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:21:54,446) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:21:54,681) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994564
[2211374:MainThread](2024-04-23 00:21:54,682) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:21:54,682) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:21:57,880) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:21:58,112) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996024
[2211374:MainThread](2024-04-23 00:21:58,113) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:21:58,113) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:22:01,316) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:22:01,550) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994916
[2211374:MainThread](2024-04-23 00:22:01,550) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:22:01,550) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:22:04,739) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:22:04,971) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996639
[2211374:MainThread](2024-04-23 00:22:04,972) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:22:04,972) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:22:08,189) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:22:08,424) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996118
[2211374:MainThread](2024-04-23 00:22:08,425) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:22:08,425) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.994190 @ 11
[2211374:MainThread](2024-04-23 00:22:08,473) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-12-17 SH600000   -0.082282
           SH600004    0.044321
           SH600009    0.043109
           SH600010   -0.073985
           SH600011   -0.020306
[2211374:MainThread](2024-04-23 00:22:10,150) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  84%|████████▍ | 37/44 [46:03<07:57, 68.15s/it][2211374:MainThread](2024-04-23 00:22:10,158) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:22:10,169) INFO - qlib.workflow - [recorder.py:341] - Recorder c06826836fa84d8da88b518ae969a78a starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:22:10,720) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:22:10,721) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:22:10,724) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:22:10,725) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:22:18,526) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.892742
            SH600004      0.892742
            SH600006      0.892742
            SH600007      0.892742
            SH600008      0.892742
                            ...   
2018-03-05  SZ300124      1.983164
            SZ300136      1.983164
            SZ300144      1.983164
            SZ300251      1.983164
            SZ300315      1.983164
Length: 686698, dtype: float64
[2211374:MainThread](2024-04-23 00:22:18,529) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:22:18,529) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:22:18,529) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:22:21,767) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:22:21,999) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996500
[2211374:MainThread](2024-04-23 00:22:22,001) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:22:22,001) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:22:25,210) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:22:25,445) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995672
[2211374:MainThread](2024-04-23 00:22:25,446) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:22:25,446) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:22:28,680) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:22:28,915) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994859
[2211374:MainThread](2024-04-23 00:22:28,916) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:22:28,917) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:22:32,151) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:22:32,389) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995049
[2211374:MainThread](2024-04-23 00:22:32,389) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:22:32,390) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:22:35,615) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:22:35,851) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994984
[2211374:MainThread](2024-04-23 00:22:35,851) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:22:35,851) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:22:39,094) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:22:39,328) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994761
[2211374:MainThread](2024-04-23 00:22:39,329) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:22:39,330) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:22:42,537) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:22:42,771) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994884
[2211374:MainThread](2024-04-23 00:22:42,772) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:22:42,772) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:22:45,990) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:22:46,225) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994832
[2211374:MainThread](2024-04-23 00:22:46,225) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:22:46,225) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:22:49,429) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:22:49,665) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994700
[2211374:MainThread](2024-04-23 00:22:49,666) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:22:49,666) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:22:52,886) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:22:53,122) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996585
[2211374:MainThread](2024-04-23 00:22:53,122) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:22:53,123) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:22:56,328) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:22:56,561) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995184
[2211374:MainThread](2024-04-23 00:22:56,561) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:22:56,562) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:22:59,788) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:23:00,022) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996626
[2211374:MainThread](2024-04-23 00:23:00,022) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:23:00,022) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:23:03,229) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:23:03,461) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994247
[2211374:MainThread](2024-04-23 00:23:03,462) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:23:03,463) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:23:06,682) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:23:06,914) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995093
[2211374:MainThread](2024-04-23 00:23:06,914) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:23:06,914) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:23:10,120) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:23:10,352) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994474
[2211374:MainThread](2024-04-23 00:23:10,352) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:23:10,352) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:23:13,569) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:23:13,802) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994846
[2211374:MainThread](2024-04-23 00:23:13,803) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:23:13,803) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:23:17,005) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:23:17,239) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997075
[2211374:MainThread](2024-04-23 00:23:17,239) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:23:17,239) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:23:20,488) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:23:20,721) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997226
[2211374:MainThread](2024-04-23 00:23:20,721) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:23:20,721) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:23:23,929) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:23:24,162) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995676
[2211374:MainThread](2024-04-23 00:23:24,162) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:23:24,163) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:23:27,393) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:23:27,625) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995629
[2211374:MainThread](2024-04-23 00:23:27,625) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:23:27,625) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:23:30,843) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:23:31,075) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996170
[2211374:MainThread](2024-04-23 00:23:31,076) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:23:31,076) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.994247 @ 12
[2211374:MainThread](2024-04-23 00:23:31,125) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-01-15 SH600000    0.004062
           SH600004   -0.020133
           SH600009   -0.089998
           SH600010   -0.006212
           SH600011   -0.008279
[2211374:MainThread](2024-04-23 00:23:32,803) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  86%|████████▋ | 38/44 [47:26<07:15, 72.50s/it][2211374:MainThread](2024-04-23 00:23:32,811) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:23:32,822) INFO - qlib.workflow - [recorder.py:341] - Recorder b5bb6eb776a14f64b15d83800f1c6068 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:23:33,355) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:23:33,356) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:23:33,358) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:23:33,359) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:23:41,111) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.644521
            SH600004      0.644521
            SH600006      0.644521
            SH600007      0.644521
            SH600008      0.644521
                            ...   
2018-04-02  SZ300124      1.923241
            SZ300136      1.923241
            SZ300144      1.923241
            SZ300251      1.923241
            SZ300315      1.923241
Length: 692433, dtype: float64
[2211374:MainThread](2024-04-23 00:23:41,113) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:23:41,114) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:23:41,114) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:23:44,377) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:23:44,583) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996735
[2211374:MainThread](2024-04-23 00:23:44,584) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:23:44,584) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:23:47,847) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:23:48,054) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996362
[2211374:MainThread](2024-04-23 00:23:48,055) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:23:48,055) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:23:51,307) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:23:51,514) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996491
[2211374:MainThread](2024-04-23 00:23:51,514) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:23:51,514) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:23:54,773) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:23:54,979) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995584
[2211374:MainThread](2024-04-23 00:23:54,980) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:23:54,980) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:23:58,233) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:23:58,439) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995921
[2211374:MainThread](2024-04-23 00:23:58,440) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:23:58,440) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:24:01,757) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:24:01,963) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997728
[2211374:MainThread](2024-04-23 00:24:01,964) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:24:01,964) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:24:05,275) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:24:05,482) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996299
[2211374:MainThread](2024-04-23 00:24:05,483) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:24:05,483) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:24:08,810) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:24:09,019) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995849
[2211374:MainThread](2024-04-23 00:24:09,019) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:24:09,019) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:24:12,326) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:24:12,534) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997107
[2211374:MainThread](2024-04-23 00:24:12,535) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:24:12,535) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:24:15,881) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:24:16,088) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997115
[2211374:MainThread](2024-04-23 00:24:16,089) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:24:16,089) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:24:19,438) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:24:19,645) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995754
[2211374:MainThread](2024-04-23 00:24:19,646) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:24:19,646) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:24:22,979) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:24:23,187) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997884
[2211374:MainThread](2024-04-23 00:24:23,188) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:24:23,188) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995584 @ 3
[2211374:MainThread](2024-04-23 00:24:23,234) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-02-20 SH600000   -0.026194
           SH600004    0.090401
           SH600009    0.027066
           SH600010   -0.007896
           SH600011   -0.013936
[2211374:MainThread](2024-04-23 00:24:24,923) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  89%|████████▊ | 39/44 [48:18<05:31, 66.39s/it][2211374:MainThread](2024-04-23 00:24:24,932) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:24:24,942) INFO - qlib.workflow - [recorder.py:341] - Recorder 64d95e420bca4aae8239eb8bb49c20be starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:24:25,486) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:24:25,486) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:24:25,488) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:24:25,488) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:24:33,296) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.706359
            SH600004      0.706359
            SH600006      0.706359
            SH600007      0.706359
            SH600008      0.706359
                            ...   
2018-05-04  SZ300124      1.755172
            SZ300136      1.755172
            SZ300144      1.755172
            SZ300251      1.755172
            SZ300315      1.755172
Length: 698132, dtype: float64
[2211374:MainThread](2024-04-23 00:24:33,299) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:24:33,299) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:24:33,300) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:24:36,669) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:24:36,876) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997235
[2211374:MainThread](2024-04-23 00:24:36,877) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:24:36,877) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:24:40,250) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:24:40,457) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996836
[2211374:MainThread](2024-04-23 00:24:40,458) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:24:40,458) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:24:43,813) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:24:44,021) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996628
[2211374:MainThread](2024-04-23 00:24:44,022) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:24:44,022) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:24:47,360) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:24:47,565) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995610
[2211374:MainThread](2024-04-23 00:24:47,566) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:24:47,567) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:24:50,881) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:24:51,086) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997140
[2211374:MainThread](2024-04-23 00:24:51,086) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:24:51,087) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:24:54,411) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:24:54,617) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996166
[2211374:MainThread](2024-04-23 00:24:54,617) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:24:54,618) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:24:57,937) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:24:58,143) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996613
[2211374:MainThread](2024-04-23 00:24:58,143) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:24:58,143) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:25:01,474) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:25:01,679) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996956
[2211374:MainThread](2024-04-23 00:25:01,679) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:25:01,680) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:25:05,028) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:25:05,238) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996262
[2211374:MainThread](2024-04-23 00:25:05,238) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:25:05,239) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:25:08,602) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:25:08,810) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996278
[2211374:MainThread](2024-04-23 00:25:08,810) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:25:08,810) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:25:12,173) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:25:12,381) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997112
[2211374:MainThread](2024-04-23 00:25:12,382) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:25:12,382) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:25:15,682) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:25:15,891) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996319
[2211374:MainThread](2024-04-23 00:25:15,891) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:25:15,892) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995610 @ 3
[2211374:MainThread](2024-04-23 00:25:15,937) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-03-19 SH600000   -0.030611
           SH600004    0.117442
           SH600009   -0.005434
           SH600010   -0.030005
           SH600011   -0.021472
[2211374:MainThread](2024-04-23 00:25:17,322) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  91%|█████████ | 40/44 [49:11<04:08, 62.19s/it][2211374:MainThread](2024-04-23 00:25:17,331) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:25:17,341) INFO - qlib.workflow - [recorder.py:341] - Recorder 5b04ee33fc164cb4accb219f9de938f6 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:25:17,863) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:25:17,863) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:25:17,866) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:25:17,866) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:25:25,689) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.318546
            SH600004      1.318546
            SH600006      1.318546
            SH600007      1.318546
            SH600008      1.318546
                            ...   
2018-06-01  SZ300124      1.709063
            SZ300136      1.709063
            SZ300144      1.709063
            SZ300251      1.709063
            SZ300315      1.709063
Length: 703856, dtype: float64
[2211374:MainThread](2024-04-23 00:25:25,691) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:25:25,691) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:25:25,691) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:25:29,077) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:25:29,281) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997650
[2211374:MainThread](2024-04-23 00:25:29,282) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:25:29,283) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:25:32,667) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:25:32,872) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995851
[2211374:MainThread](2024-04-23 00:25:32,873) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:25:32,873) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:25:36,221) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:25:36,426) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995348
[2211374:MainThread](2024-04-23 00:25:36,427) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:25:36,427) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:25:39,799) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:25:40,003) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996119
[2211374:MainThread](2024-04-23 00:25:40,004) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:25:40,004) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:25:43,326) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:25:43,531) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995314
[2211374:MainThread](2024-04-23 00:25:43,532) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:25:43,532) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:25:46,894) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:25:47,099) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996411
[2211374:MainThread](2024-04-23 00:25:47,100) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:25:47,100) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:25:50,419) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:25:50,625) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995760
[2211374:MainThread](2024-04-23 00:25:50,625) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:25:50,625) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:25:53,955) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:25:54,160) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995309
[2211374:MainThread](2024-04-23 00:25:54,161) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:25:54,161) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:25:57,480) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:25:57,686) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996661
[2211374:MainThread](2024-04-23 00:25:57,686) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:25:57,686) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:26:01,058) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:26:01,265) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996053
[2211374:MainThread](2024-04-23 00:26:01,265) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:26:01,265) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:26:04,657) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:26:04,863) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996124
[2211374:MainThread](2024-04-23 00:26:04,863) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:26:04,864) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:26:08,269) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:26:08,475) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996066
[2211374:MainThread](2024-04-23 00:26:08,475) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:26:08,476) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:26:11,885) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:26:12,090) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996442
[2211374:MainThread](2024-04-23 00:26:12,091) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:26:12,091) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:26:15,485) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:26:15,690) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996333
[2211374:MainThread](2024-04-23 00:26:15,691) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:26:15,691) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:26:19,051) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:26:19,255) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997760
[2211374:MainThread](2024-04-23 00:26:19,256) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:26:19,256) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:26:22,589) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:26:22,792) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996050
[2211374:MainThread](2024-04-23 00:26:22,793) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:26:22,793) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995309 @ 7
[2211374:MainThread](2024-04-23 00:26:22,841) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-04-17 SH600000   -0.041143
           SH600004    0.022732
           SH600009   -0.019863
           SH600010   -0.036020
           SH600011   -0.016590
[2211374:MainThread](2024-04-23 00:26:24,488) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  93%|█████████▎| 41/44 [50:18<03:11, 63.68s/it][2211374:MainThread](2024-04-23 00:26:24,497) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:26:24,507) INFO - qlib.workflow - [recorder.py:341] - Recorder 381f370e9f9b4500a74c5564483e9aac starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:26:25,049) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:26:25,049) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:26:25,053) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:26:25,054) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:26:32,722) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.938928
            SH600004      0.938928
            SH600006      0.938928
            SH600007      0.938928
            SH600008      0.938928
                            ...   
2018-07-02  SZ300136      1.563876
            SZ300144      1.563876
            SZ300251      1.563876
            SZ300408      1.563876
            SZ300433      1.563876
Length: 709547, dtype: float64
[2211374:MainThread](2024-04-23 00:26:32,724) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:26:32,724) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:26:32,725) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:26:36,099) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:26:36,327) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996736
[2211374:MainThread](2024-04-23 00:26:36,328) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:26:36,328) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:26:39,729) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:26:39,956) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997768
[2211374:MainThread](2024-04-23 00:26:39,956) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:26:39,957) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:26:43,263) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:26:43,492) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996681
[2211374:MainThread](2024-04-23 00:26:43,493) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:26:43,493) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:26:46,832) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:26:47,060) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995562
[2211374:MainThread](2024-04-23 00:26:47,061) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:26:47,062) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:26:50,423) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:26:50,651) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996305
[2211374:MainThread](2024-04-23 00:26:50,652) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:26:50,652) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:26:53,990) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:26:54,221) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996842
[2211374:MainThread](2024-04-23 00:26:54,222) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:26:54,222) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:26:57,530) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:26:57,759) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995248
[2211374:MainThread](2024-04-23 00:26:57,760) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:26:57,760) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:27:01,096) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:27:01,325) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996963
[2211374:MainThread](2024-04-23 00:27:01,326) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:27:01,326) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:27:04,593) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:27:04,826) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995897
[2211374:MainThread](2024-04-23 00:27:04,827) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:27:04,827) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:27:08,128) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:27:08,358) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996537
[2211374:MainThread](2024-04-23 00:27:08,358) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:27:08,358) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:27:11,633) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:27:11,868) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996367
[2211374:MainThread](2024-04-23 00:27:11,869) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:27:11,869) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:27:15,222) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:27:15,454) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998020
[2211374:MainThread](2024-04-23 00:27:15,454) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:27:15,455) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:27:18,819) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:27:19,052) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997974
[2211374:MainThread](2024-04-23 00:27:19,052) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:27:19,052) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:27:22,410) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:27:22,641) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996871
[2211374:MainThread](2024-04-23 00:27:22,642) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:27:22,642) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:27:26,013) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:27:26,245) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997527
[2211374:MainThread](2024-04-23 00:27:26,245) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:27:26,246) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995248 @ 6
[2211374:MainThread](2024-04-23 00:27:26,293) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-05-20 SH600000   -0.029493
           SH600004    0.126772
           SH600009    0.079684
           SH600010    0.007474
           SH600011    0.016369
[2211374:MainThread](2024-04-23 00:27:27,982) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  95%|█████████▌| 42/44 [51:21<02:07, 63.63s/it][2211374:MainThread](2024-04-23 00:27:27,991) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:27:28,001) INFO - qlib.workflow - [recorder.py:341] - Recorder 64066ce8dc2942efac338ab45fff25f5 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:27:28,530) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:27:28,531) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:27:28,533) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:27:28,534) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:27:36,368) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.638899
            SH600004      0.638899
            SH600006      0.638899
            SH600007      0.638899
            SH600008      0.638899
                            ...   
2018-07-30  SZ300136      1.373707
            SZ300144      1.373707
            SZ300251      1.373707
            SZ300408      1.373707
            SZ300433      1.373707
Length: 715298, dtype: float64
[2211374:MainThread](2024-04-23 00:27:36,370) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:27:36,370) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:27:36,371) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:27:39,788) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:27:39,982) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997297
[2211374:MainThread](2024-04-23 00:27:39,983) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:27:39,983) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:27:43,351) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:27:43,544) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996149
[2211374:MainThread](2024-04-23 00:27:43,545) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:27:43,546) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:27:46,926) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:27:47,120) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996163
[2211374:MainThread](2024-04-23 00:27:47,120) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:27:47,121) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:27:50,487) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:27:50,681) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995245
[2211374:MainThread](2024-04-23 00:27:50,682) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:27:50,682) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:27:54,060) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:27:54,254) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995470
[2211374:MainThread](2024-04-23 00:27:54,255) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:27:54,255) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:27:57,621) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:27:57,815) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996044
[2211374:MainThread](2024-04-23 00:27:57,816) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:27:57,816) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:28:01,193) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:28:01,387) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996185
[2211374:MainThread](2024-04-23 00:28:01,388) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:28:01,388) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:28:04,768) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:28:04,963) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995644
[2211374:MainThread](2024-04-23 00:28:04,963) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:28:04,963) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:28:08,323) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:28:08,517) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996739
[2211374:MainThread](2024-04-23 00:28:08,518) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:28:08,518) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:28:11,886) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:28:12,080) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996269
[2211374:MainThread](2024-04-23 00:28:12,080) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:28:12,081) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:28:15,438) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:28:15,632) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996873
[2211374:MainThread](2024-04-23 00:28:15,632) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:28:15,632) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:28:19,003) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:28:19,197) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995515
[2211374:MainThread](2024-04-23 00:28:19,198) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:28:19,198) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995245 @ 3
[2211374:MainThread](2024-04-23 00:28:19,244) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-06-17 SH600000    0.004974
           SH600004    0.058324
           SH600009    0.036551
           SH600010   -0.016700
           SH600011   -0.036910
[2211374:MainThread](2024-04-23 00:28:20,741) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  98%|█████████▊| 43/44 [52:14<01:00, 60.37s/it][2211374:MainThread](2024-04-23 00:28:20,750) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[2211374:MainThread](2024-04-23 00:28:20,760) INFO - qlib.workflow - [recorder.py:341] - Recorder 7c190383a93946cba3e00a1713f4fe79 starts running under Experiment 15 ...
[2211374:MainThread](2024-04-23 00:28:21,291) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:28:21,292) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:28:21,295) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:28:21,295) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:28:28,973) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.017713
            SH600004      1.017713
            SH600006      1.017713
            SH600007      1.017713
            SH600008      1.017713
                            ...   
2018-08-27  SZ300136      1.847241
            SZ300144      1.847241
            SZ300251      1.847241
            SZ300408      1.847241
            SZ300433      1.847241
Length: 721109, dtype: float64
[2211374:MainThread](2024-04-23 00:28:28,975) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:28:28,976) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:28:28,976) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:28:32,374) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:28:32,608) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997422
[2211374:MainThread](2024-04-23 00:28:32,609) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:28:32,609) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:28:35,983) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:28:36,217) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996414
[2211374:MainThread](2024-04-23 00:28:36,218) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:28:36,218) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:28:39,529) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:28:39,764) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996687
[2211374:MainThread](2024-04-23 00:28:39,764) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:28:39,765) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:28:43,063) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:28:43,298) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996231
[2211374:MainThread](2024-04-23 00:28:43,299) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:28:43,299) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:28:46,680) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:28:46,915) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996508
[2211374:MainThread](2024-04-23 00:28:46,915) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:28:46,915) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:28:50,288) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:28:50,522) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996381
[2211374:MainThread](2024-04-23 00:28:50,523) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:28:50,523) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:28:53,940) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:28:54,174) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996809
[2211374:MainThread](2024-04-23 00:28:54,175) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:28:54,175) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:28:57,615) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:28:57,854) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996235
[2211374:MainThread](2024-04-23 00:28:57,855) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:28:57,855) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:29:01,294) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:29:01,529) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996345
[2211374:MainThread](2024-04-23 00:29:01,529) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:29:01,529) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:29:04,986) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:29:05,220) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996663
[2211374:MainThread](2024-04-23 00:29:05,221) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:29:05,221) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:29:08,599) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:29:08,834) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997321
[2211374:MainThread](2024-04-23 00:29:08,835) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:29:08,835) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:29:12,248) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:29:12,482) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997660
[2211374:MainThread](2024-04-23 00:29:12,482) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:29:12,483) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.996231 @ 3
[2211374:MainThread](2024-04-23 00:29:12,521) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-07-17 SH600000    0.099320
           SH600004   -0.011315
           SH600009    0.081343
           SH600010    0.152784
           SH600011    0.157006
[2211374:MainThread](2024-04-23 00:29:14,165) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks: 100%|██████████| 44/44 [53:07<00:00, 58.28s/it]train tasks: 100%|██████████| 44/44 [53:07<00:00, 72.45s/it]
[2211374:MainThread](2024-04-23 00:29:14,290) INFO - qlib.timer - [log.py:127] - Time cost: 0.077s | Time to `list_recorders` in RecorderCollector Done
[2211374:MainThread](2024-04-23 00:29:14,290) INFO - qlib.RecorderCollector - [collect.py:226] - Nubmer of recorders after filter: defaultdict(<class 'int'>, {'FINISHED': 44})
[2211374:MainThread](2024-04-23 00:29:14,330) INFO - qlib.RollingEnsemble - [ensemble.py:83] - keys in group: ['7c190383a93946cba3e00a1713f4fe79', '64066ce8dc2942efac338ab45fff25f5', '381f370e9f9b4500a74c5564483e9aac', '5b04ee33fc164cb4accb219f9de938f6', '64d95e420bca4aae8239eb8bb49c20be', 'b5bb6eb776a14f64b15d83800f1c6068', 'c06826836fa84d8da88b518ae969a78a', 'f838fb4d7cc0466d89928eaccb80438d', '9594f801ae8740c7a6a1657d94a559a7', '563643656c8f45a092b2328e317ce1b8', 'fec37bd2db0048349ef343e26f27d15b', '8ea7e04b54f74ed68dd66fad8c712f95', '0eea34810f584f8a853164dbe71a414c', '11ddc0b548e843a5b7b988eca5c56415', 'ab75c528341d4977a9ef22d5250c8eee', 'c0cf51c007d7419bafaf24cffd2a709e', '5acb9bef8c354e9e93e476c9a381fe54', '0ae35dff3ab5420a88575b92b1569ffe', '5f3fcabc56da4cbea7cd51b9911d2c77', 'd9a939449d7247b08ccba787156439cd', '37d34f673b054ab1ab431e204e269f1f', '45c8358045c540acaf41837559fb0dff', '4fd0011d4eab44b496af2245b6ed8f94', '0632c2b76ad946878a83d678a618ead2', '2f70561bdfe7447cacb2f2b0571537aa', '58d9655a87854f7eaa3eaef14093dd67', '399e70c4e36d47df907f1956e8dcd1e8', '4225283024934cf08ede5b8873703330', '604a066850eb47e7880ed4baf9efdb38', '946d31670bb647de90923a474a68c6a7', 'b857f1e0bf8b49a9b26dbd092938a85f', '308669ab7690492891a8e2064f740cd6', 'a7fdbe0f715746028637c84dd8e6f793', 'ebb4e0e51993431998fa8a0c72339782', '3cb5f2d1cdea429fbc82c19763593708', 'db6b6dc0b6f448c3a9c3dd7bbcb589ad', '6ac81980f90a4b48b8f55c544ed1d46c', '5fca05689ffb4367861799edc2ddbf1c', 'e0f6088cd1ee46a6861bf7a20c5c94dc', 'a58831a97ad4466ea13db9d1e817585f', '8ced70295d994866b02a0325a305f20d', 'cb42006c2d5a4c449e0d07c55b8f13f0', '1e1db6d842c448b6b910f940d50d38de', '96c1053246af4f1b96f6b2e125f73efb']
[2211374:MainThread](2024-04-23 00:29:14,420) INFO - qlib.RollingEnsemble - [ensemble.py:83] - keys in group: ['7c190383a93946cba3e00a1713f4fe79', '64066ce8dc2942efac338ab45fff25f5', '381f370e9f9b4500a74c5564483e9aac', '5b04ee33fc164cb4accb219f9de938f6', '64d95e420bca4aae8239eb8bb49c20be', 'b5bb6eb776a14f64b15d83800f1c6068', 'c06826836fa84d8da88b518ae969a78a', 'f838fb4d7cc0466d89928eaccb80438d', '9594f801ae8740c7a6a1657d94a559a7', '563643656c8f45a092b2328e317ce1b8', 'fec37bd2db0048349ef343e26f27d15b', '8ea7e04b54f74ed68dd66fad8c712f95', '0eea34810f584f8a853164dbe71a414c', '11ddc0b548e843a5b7b988eca5c56415', 'ab75c528341d4977a9ef22d5250c8eee', 'c0cf51c007d7419bafaf24cffd2a709e', '5acb9bef8c354e9e93e476c9a381fe54', '0ae35dff3ab5420a88575b92b1569ffe', '5f3fcabc56da4cbea7cd51b9911d2c77', 'd9a939449d7247b08ccba787156439cd', '37d34f673b054ab1ab431e204e269f1f', '45c8358045c540acaf41837559fb0dff', '4fd0011d4eab44b496af2245b6ed8f94', '0632c2b76ad946878a83d678a618ead2', '2f70561bdfe7447cacb2f2b0571537aa', '58d9655a87854f7eaa3eaef14093dd67', '399e70c4e36d47df907f1956e8dcd1e8', '4225283024934cf08ede5b8873703330', '604a066850eb47e7880ed4baf9efdb38', '946d31670bb647de90923a474a68c6a7', 'b857f1e0bf8b49a9b26dbd092938a85f', '308669ab7690492891a8e2064f740cd6', 'a7fdbe0f715746028637c84dd8e6f793', 'ebb4e0e51993431998fa8a0c72339782', '3cb5f2d1cdea429fbc82c19763593708', 'db6b6dc0b6f448c3a9c3dd7bbcb589ad', '6ac81980f90a4b48b8f55c544ed1d46c', '5fca05689ffb4367861799edc2ddbf1c', 'e0f6088cd1ee46a6861bf7a20c5c94dc', 'a58831a97ad4466ea13db9d1e817585f', '8ced70295d994866b02a0325a305f20d', 'cb42006c2d5a4c449e0d07c55b8f13f0', '1e1db6d842c448b6b910f940d50d38de', '96c1053246af4f1b96f6b2e125f73efb']
[2211374:MainThread](2024-04-23 00:29:14,516) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name final_rolling_cn_data_csi300_GRU_alpha360_h1_step20_rankFalse_2024-04-22_23:36:06_DDG-DA.
[2211374:MainThread](2024-04-23 00:29:14,527) INFO - qlib.workflow - [exp.py:258] - Experiment 16 starts running ...
[2211374:MainThread](2024-04-23 00:29:14,536) INFO - qlib.workflow - [recorder.py:341] - Recorder b204d8cdafe14c1f94437b098a1b61be starts running under Experiment 16 ...
[2211374:MainThread](2024-04-23 00:29:15,098) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/scipy/stats/_stats_py.py:4916: ConstantInputWarning: An input array is constant; the correlation coefficient is not defined.
  warnings.warn(stats.ConstantInputWarning(warn_msg))
{'IC': 0.059840142296515936,
 'ICIR': 0.4807125725287673,
 'Rank IC': 0.05902222435167277,
 'Rank ICIR': 0.4853890219712274}
[2211374:MainThread](2024-04-23 00:29:16,646) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2211374:MainThread](2024-04-23 00:29:41,400) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2211374:MainThread](2024-04-23 00:29:41,402) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2211374:MainThread](2024-04-23 00:29:41,408) WARNING - qlib.online operator - [exchange.py:226] - factor.day.bin file not exists or factor contains `nan`. Order using adjusted_price.
[2211374:MainThread](2024-04-23 00:29:41,409) WARNING - qlib.online operator - [exchange.py:228] - trade unit 100 is not supported in adjusted_price mode.
[2211374:MainThread](2024-04-23 00:29:45,407) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fb89894db20>
backtest loop:   0%|          | 0/872 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/872 [00:00<00:58, 14.86it/s]backtest loop:   1%|          | 9/872 [00:00<00:27, 31.04it/s]backtest loop:   2%|▏         | 16/872 [00:00<00:19, 43.15it/s]backtest loop:   2%|▏         | 21/872 [00:00<00:19, 44.25it/s]backtest loop:   3%|▎         | 28/872 [00:00<00:16, 50.51it/s]backtest loop:   4%|▍         | 34/872 [00:00<00:16, 50.67it/s]backtest loop:   5%|▍         | 41/872 [00:00<00:15, 54.61it/s]backtest loop:   6%|▌         | 48/872 [00:00<00:14, 57.39it/s]backtest loop:   6%|▌         | 54/872 [00:01<00:14, 55.20it/s]backtest loop:   7%|▋         | 61/872 [00:01<00:14, 57.65it/s]backtest loop:   8%|▊         | 67/872 [00:01<00:14, 55.59it/s]backtest loop:   8%|▊         | 74/872 [00:01<00:13, 57.88it/s]backtest loop:   9%|▉         | 81/872 [00:01<00:14, 56.23it/s]backtest loop:  10%|█         | 88/872 [00:01<00:13, 58.51it/s]backtest loop:  11%|█         | 95/872 [00:01<00:12, 60.13it/s]backtest loop:  12%|█▏        | 102/872 [00:01<00:13, 58.96it/s]backtest loop:  12%|█▎        | 109/872 [00:02<00:13, 57.42it/s]backtest loop:  13%|█▎        | 116/872 [00:02<00:12, 59.74it/s]backtest loop:  14%|█▍        | 123/872 [00:02<00:12, 61.06it/s]backtest loop:  15%|█▍        | 130/872 [00:02<00:12, 59.64it/s]backtest loop:  16%|█▌        | 137/872 [00:02<00:11, 62.27it/s]backtest loop:  17%|█▋        | 144/872 [00:02<00:12, 59.94it/s]backtest loop:  17%|█▋        | 151/872 [00:02<00:11, 61.46it/s]backtest loop:  18%|█▊        | 158/872 [00:02<00:11, 62.76it/s]backtest loop:  19%|█▉        | 165/872 [00:02<00:11, 61.11it/s]backtest loop:  20%|█▉        | 173/872 [00:03<00:10, 64.85it/s]backtest loop:  21%|██        | 180/872 [00:03<00:11, 62.84it/s]backtest loop:  21%|██▏       | 187/872 [00:03<00:10, 63.75it/s]backtest loop:  22%|██▏       | 194/872 [00:03<00:11, 60.68it/s]backtest loop:  23%|██▎       | 201/872 [00:03<00:10, 61.70it/s]backtest loop:  24%|██▍       | 208/872 [00:03<00:10, 62.51it/s]backtest loop:  25%|██▍       | 215/872 [00:03<00:11, 59.29it/s]backtest loop:  25%|██▌       | 222/872 [00:03<00:10, 60.31it/s]backtest loop:  26%|██▋       | 229/872 [00:04<00:11, 57.85it/s]backtest loop:  27%|██▋       | 236/872 [00:04<00:10, 60.01it/s]backtest loop:  28%|██▊       | 243/872 [00:04<00:10, 61.45it/s]backtest loop:  29%|██▊       | 250/872 [00:04<00:10, 59.34it/s]backtest loop:  29%|██▉       | 257/872 [00:04<00:10, 61.38it/s]backtest loop:  30%|███       | 264/872 [00:04<00:10, 58.98it/s]backtest loop:  31%|███       | 271/872 [00:04<00:09, 60.79it/s]backtest loop:  32%|███▏      | 278/872 [00:04<00:10, 57.14it/s]backtest loop:  33%|███▎      | 285/872 [00:04<00:09, 59.51it/s]backtest loop:  33%|███▎      | 292/872 [00:05<00:09, 62.01it/s]backtest loop:  34%|███▍      | 299/872 [00:05<00:09, 60.75it/s]backtest loop:  35%|███▌      | 306/872 [00:05<00:09, 58.70it/s]backtest loop:  36%|███▌      | 313/872 [00:05<00:09, 60.04it/s]backtest loop:  37%|███▋      | 320/872 [00:05<00:09, 61.11it/s]backtest loop:  38%|███▊      | 327/872 [00:05<00:09, 58.43it/s]backtest loop:  38%|███▊      | 333/872 [00:05<00:09, 58.80it/s]backtest loop:  39%|███▉      | 339/872 [00:05<00:09, 56.31it/s]backtest loop:  40%|███▉      | 346/872 [00:05<00:08, 60.02it/s]backtest loop:  41%|████      | 354/872 [00:06<00:08, 60.60it/s]backtest loop:  41%|████▏     | 361/872 [00:06<00:08, 62.90it/s]backtest loop:  42%|████▏     | 368/872 [00:06<00:08, 59.97it/s]backtest loop:  43%|████▎     | 375/872 [00:06<00:08, 61.03it/s]backtest loop:  44%|████▍     | 382/872 [00:06<00:07, 61.72it/s]backtest loop:  45%|████▍     | 389/872 [00:06<00:08, 59.96it/s]backtest loop:  45%|████▌     | 396/872 [00:06<00:07, 61.57it/s]backtest loop:  46%|████▌     | 403/872 [00:06<00:07, 60.43it/s]backtest loop:  47%|████▋     | 410/872 [00:07<00:07, 61.39it/s]backtest loop:  48%|████▊     | 417/872 [00:07<00:07, 63.28it/s]backtest loop:  49%|████▊     | 424/872 [00:07<00:07, 60.82it/s]backtest loop:  49%|████▉     | 431/872 [00:07<00:07, 62.56it/s]backtest loop:  50%|█████     | 438/872 [00:07<00:07, 61.52it/s]backtest loop:  51%|█████     | 445/872 [00:07<00:06, 63.29it/s]backtest loop:  52%|█████▏    | 452/872 [00:07<00:06, 61.08it/s]backtest loop:  53%|█████▎    | 459/872 [00:07<00:06, 62.19it/s]backtest loop:  53%|█████▎    | 466/872 [00:07<00:06, 62.93it/s]backtest loop:  54%|█████▍    | 473/872 [00:08<00:06, 59.82it/s]backtest loop:  55%|█████▌    | 480/872 [00:08<00:06, 61.62it/s]backtest loop:  56%|█████▌    | 487/872 [00:08<00:06, 60.09it/s]backtest loop:  57%|█████▋    | 494/872 [00:08<00:06, 61.41it/s]backtest loop:  57%|█████▋    | 501/872 [00:08<00:06, 59.20it/s]backtest loop:  58%|█████▊    | 508/872 [00:08<00:06, 60.18it/s]backtest loop:  59%|█████▉    | 515/872 [00:08<00:06, 57.59it/s]backtest loop:  60%|█████▉    | 522/872 [00:08<00:05, 59.41it/s]backtest loop:  61%|██████    | 529/872 [00:08<00:05, 60.91it/s]backtest loop:  61%|██████▏   | 536/872 [00:09<00:05, 58.27it/s]backtest loop:  62%|██████▏   | 543/872 [00:09<00:05, 59.85it/s]backtest loop:  63%|██████▎   | 550/872 [00:09<00:05, 58.02it/s]backtest loop:  64%|██████▍   | 557/872 [00:09<00:05, 59.93it/s]backtest loop:  65%|██████▍   | 564/872 [00:09<00:05, 57.67it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:  65%|██████▌   | 571/872 [00:09<00:04, 60.85it/s]backtest loop:  66%|██████▋   | 578/872 [00:09<00:06, 45.36it/s]backtest loop:  67%|██████▋   | 585/872 [00:10<00:05, 49.72it/s]backtest loop:  68%|██████▊   | 591/872 [00:10<00:05, 49.80it/s]backtest loop:  69%|██████▊   | 598/872 [00:10<00:05, 53.29it/s]backtest loop:  69%|██████▉   | 605/872 [00:10<00:05, 53.17it/s]backtest loop:  70%|███████   | 612/872 [00:10<00:04, 55.67it/s]backtest loop:  71%|███████   | 619/872 [00:10<00:04, 57.54it/s]backtest loop:  72%|███████▏  | 625/872 [00:10<00:04, 55.21it/s]backtest loop:  72%|███████▏  | 632/872 [00:10<00:04, 57.22it/s]backtest loop:  73%|███████▎  | 639/872 [00:10<00:03, 58.89it/s]backtest loop:  74%|███████▍  | 645/872 [00:11<00:04, 56.29it/s]backtest loop:  75%|███████▍  | 652/872 [00:11<00:03, 58.17it/s]backtest loop:  75%|███████▌  | 658/872 [00:11<00:03, 58.57it/s]backtest loop:  76%|███████▌  | 664/872 [00:11<00:03, 55.46it/s]backtest loop:  77%|███████▋  | 670/872 [00:11<00:03, 53.32it/s]backtest loop:  78%|███████▊  | 676/872 [00:11<00:03, 54.80it/s]backtest loop:  78%|███████▊  | 682/872 [00:11<00:03, 56.10it/s]backtest loop:  79%|███████▉  | 688/872 [00:11<00:03, 56.60it/s]backtest loop:  80%|███████▉  | 694/872 [00:11<00:03, 53.96it/s]backtest loop:  80%|████████  | 700/872 [00:12<00:03, 55.12it/s]backtest loop:  81%|████████  | 706/872 [00:12<00:02, 56.16it/s]backtest loop:  82%|████████▏ | 713/872 [00:12<00:02, 58.09it/s]backtest loop:  82%|████████▏ | 719/872 [00:12<00:02, 55.15it/s]backtest loop:  83%|████████▎ | 725/872 [00:12<00:02, 56.34it/s]backtest loop:  84%|████████▍ | 731/872 [00:12<00:02, 53.95it/s]backtest loop:  85%|████████▍ | 738/872 [00:12<00:02, 53.32it/s]backtest loop:  85%|████████▌ | 745/872 [00:12<00:02, 56.05it/s]backtest loop:  86%|████████▌ | 752/872 [00:12<00:02, 55.21it/s]backtest loop:  87%|████████▋ | 759/872 [00:13<00:01, 57.32it/s]backtest loop:  88%|████████▊ | 766/872 [00:13<00:01, 58.86it/s]backtest loop:  89%|████████▊ | 772/872 [00:13<00:01, 55.95it/s]backtest loop:  89%|████████▉ | 779/872 [00:13<00:01, 57.92it/s]backtest loop:  90%|█████████ | 786/872 [00:13<00:01, 59.24it/s]backtest loop:  91%|█████████ | 792/872 [00:13<00:01, 56.32it/s]backtest loop:  92%|█████████▏| 799/872 [00:13<00:01, 58.12it/s]backtest loop:  92%|█████████▏| 806/872 [00:13<00:01, 56.54it/s]backtest loop:  93%|█████████▎| 813/872 [00:14<00:01, 55.42it/s]backtest loop:  94%|█████████▍| 820/872 [00:14<00:00, 57.70it/s]backtest loop:  95%|█████████▍| 827/872 [00:14<00:00, 58.98it/s]backtest loop:  96%|█████████▌| 833/872 [00:14<00:00, 56.47it/s]backtest loop:  96%|█████████▋| 840/872 [00:14<00:00, 58.11it/s]backtest loop:  97%|█████████▋| 846/872 [00:14<00:00, 55.77it/s]backtest loop:  98%|█████████▊| 853/872 [00:14<00:00, 58.13it/s]backtest loop:  99%|█████████▊| 860/872 [00:14<00:00, 59.47it/s]backtest loop:  99%|█████████▉| 866/872 [00:14<00:00, 56.84it/s]backtest loop: 100%|██████████| 872/872 [00:15<00:00, 57.85it/s]
[2211374:MainThread](2024-04-23 00:30:00,540) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 16
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000495
std                0.012300
annualized_return  0.117864
information_ratio  0.621155
max_drawdown      -0.370479
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000633
std                0.005486
annualized_return  0.150767
information_ratio  1.781389
max_drawdown      -0.086809
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000451
std                0.005485
annualized_return  0.107336
information_ratio  1.268377
max_drawdown      -0.107734
[2211374:MainThread](2024-04-23 00:30:00,554) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 16
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Remove CSRankNorm
{'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': datetime.date(2008, 1, 1), 'end_time': datetime.date(2020, 8, 1), 'fit_start_time': datetime.date(2008, 1, 1), 'fit_end_time': datetime.date(2014, 12, 31), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
[2211374:MainThread](2024-04-23 00:30:01,401) INFO - qlib.RollingBenchmark - [rolling_benchmark.py:208] - {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 5000, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/baseline/cn_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': [datetime.date(2008, 1, 1), datetime.date(2014, 12, 31)], 'valid': [datetime.date(2015, 1, 1), datetime.date(2016, 12, 31)], 'test': [datetime.date(2017, 1, 1), datetime.date(2020, 8, 1)]}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `final_rolling_cn_data_csi300_GRU_alpha360_h1_step20_rankFalse_2024-04-22_23:36:06_DDG-DA`.
{'1day.excess_return_with_cost.annualized_return': [0.0923740706897112,
                                                    0.10733613259180923],
 '1day.excess_return_with_cost.information_ratio': [1.12191299950881,
                                                    1.2683771172061278],
 '1day.excess_return_with_cost.max_drawdown': [-0.05720611471621033,
                                               -0.10773399649935425],
 'IC': [0.054664481501801206, 0.059840142296515936],
 'ICIR': [0.4444813839897373, 0.4807125725287673],
 'Rank IC': [0.05509317193255259, 0.05902222435167277],
 'Rank ICIR': [0.45438042600711764, 0.4853890219712274],
 'mae': [0.6961897611618042, 0.6959193348884583],
 'mse': [0.9954380989074707, 0.9945641160011292]}
Remove CSRankNorm
{'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': datetime.date(2008, 1, 1), 'end_time': datetime.date(2020, 8, 1), 'fit_start_time': datetime.date(2008, 1, 1), 'fit_end_time': datetime.date(2014, 12, 31), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
[2211374:MainThread](2024-04-23 00:30:05,778) INFO - qlib.RollingBenchmark - [rolling_benchmark.py:208] - {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 5000, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/baseline/cn_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': [datetime.date(2008, 1, 1), datetime.date(2014, 12, 31)], 'valid': [datetime.date(2015, 1, 1), datetime.date(2016, 12, 31)], 'test': [datetime.date(2017, 1, 1), datetime.date(2020, 8, 1)]}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
[2211374:MainThread](2024-04-23 00:30:05,789) INFO - qlib.MetaDatasetDS - [dataset.py:316] - Example task for training meta model: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 5000, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/baseline/cn_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-02 00:00:00'), Timestamp('2014-12-31 00:00:00')), 'valid': (Timestamp('2015-01-05 00:00:00'), Timestamp('2016-12-29 00:00:00')), 'test': (Timestamp('2017-01-03 00:00:00'), Timestamp('2017-02-06 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/44 [00:00<?, ?it/s]creating meta tasks:   2%|▏         | 1/44 [00:00<00:17,  2.39it/s]creating meta tasks:   5%|▍         | 2/44 [00:00<00:17,  2.45it/s]creating meta tasks:   7%|▋         | 3/44 [00:01<00:16,  2.47it/s]creating meta tasks:   9%|▉         | 4/44 [00:01<00:16,  2.46it/s]creating meta tasks:  11%|█▏        | 5/44 [00:02<00:15,  2.46it/s]creating meta tasks:  14%|█▎        | 6/44 [00:02<00:15,  2.46it/s]creating meta tasks:  16%|█▌        | 7/44 [00:02<00:15,  2.46it/s]creating meta tasks:  18%|█▊        | 8/44 [00:03<00:14,  2.45it/s]creating meta tasks:  20%|██        | 9/44 [00:03<00:14,  2.42it/s]creating meta tasks:  23%|██▎       | 10/44 [00:04<00:14,  2.40it/s]creating meta tasks:  25%|██▌       | 11/44 [00:04<00:13,  2.40it/s]creating meta tasks:  27%|██▋       | 12/44 [00:04<00:13,  2.41it/s]creating meta tasks:  30%|██▉       | 13/44 [00:05<00:12,  2.41it/s]creating meta tasks:  32%|███▏      | 14/44 [00:05<00:12,  2.32it/s]creating meta tasks:  34%|███▍      | 15/44 [00:06<00:12,  2.34it/s]creating meta tasks:  36%|███▋      | 16/44 [00:06<00:11,  2.33it/s]creating meta tasks:  39%|███▊      | 17/44 [00:07<00:11,  2.33it/s]creating meta tasks:  41%|████      | 18/44 [00:07<00:11,  2.34it/s]creating meta tasks:  43%|████▎     | 19/44 [00:07<00:10,  2.35it/s]creating meta tasks:  45%|████▌     | 20/44 [00:08<00:10,  2.35it/s]creating meta tasks:  48%|████▊     | 21/44 [00:08<00:09,  2.34it/s]creating meta tasks:  50%|█████     | 22/44 [00:09<00:09,  2.34it/s]creating meta tasks:  52%|█████▏    | 23/44 [00:09<00:08,  2.34it/s]creating meta tasks:  55%|█████▍    | 24/44 [00:10<00:08,  2.33it/s]creating meta tasks:  57%|█████▋    | 25/44 [00:10<00:08,  2.32it/s]creating meta tasks:  59%|█████▉    | 26/44 [00:10<00:07,  2.26it/s]creating meta tasks:  61%|██████▏   | 27/44 [00:11<00:07,  2.25it/s]creating meta tasks:  64%|██████▎   | 28/44 [00:11<00:07,  2.25it/s]creating meta tasks:  66%|██████▌   | 29/44 [00:12<00:06,  2.25it/s]creating meta tasks:  68%|██████▊   | 30/44 [00:12<00:06,  2.25it/s]creating meta tasks:  70%|███████   | 31/44 [00:13<00:05,  2.25it/s]creating meta tasks:  73%|███████▎  | 32/44 [00:13<00:05,  2.25it/s]creating meta tasks:  75%|███████▌  | 33/44 [00:14<00:04,  2.25it/s]creating meta tasks:  77%|███████▋  | 34/44 [00:14<00:04,  2.24it/s]creating meta tasks:  80%|███████▉  | 35/44 [00:15<00:04,  2.23it/s]creating meta tasks:  82%|████████▏ | 36/44 [00:15<00:03,  2.18it/s]creating meta tasks:  84%|████████▍ | 37/44 [00:15<00:03,  2.19it/s]creating meta tasks:  86%|████████▋ | 38/44 [00:16<00:02,  2.19it/s]creating meta tasks:  89%|████████▊ | 39/44 [00:16<00:02,  2.19it/s]creating meta tasks:  91%|█████████ | 40/44 [00:17<00:01,  2.19it/s]creating meta tasks:  93%|█████████▎| 41/44 [00:17<00:01,  2.19it/s]creating meta tasks:  95%|█████████▌| 42/44 [00:18<00:00,  2.18it/s]creating meta tasks:  98%|█████████▊| 43/44 [00:18<00:00,  2.17it/s]creating meta tasks: 100%|██████████| 44/44 [00:19<00:00,  2.16it/s]creating meta tasks: 100%|██████████| 44/44 [00:19<00:00,  2.30it/s]
train tasks:   0%|          | 0/44 [00:00<?, ?it/s][2211374:MainThread](2024-04-23 00:30:25,253) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name rolling_cn_data_csi300_GRU_alpha360_h1_step20_rankFalse_2024-04-23_00:30:25_DDG-DA.
[2211374:MainThread](2024-04-23 00:30:25,265) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:30:25,279) INFO - qlib.workflow - [recorder.py:341] - Recorder 62a356a105214f2183c335ffb8241ea2 starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:30:25,927) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:30:25,928) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:30:25,931) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:30:25,931) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:30:33,903) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.531190
            SH600004      0.531190
            SH600006      0.531190
            SH600007      0.531190
            SH600008      0.531190
                            ...   
2014-12-31  SZ300070      1.926131
            SZ300124      1.926131
            SZ300133      1.926131
            SZ300146      1.926131
            SZ300251      1.926131
Length: 478007, dtype: float64
[2211374:MainThread](2024-04-23 00:30:33,905) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:30:33,906) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:30:33,906) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:30:36,247) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:30:36,468) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995417
[2211374:MainThread](2024-04-23 00:30:36,469) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:30:36,470) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:30:38,775) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:30:38,995) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994779
[2211374:MainThread](2024-04-23 00:30:38,996) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:30:38,996) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:30:41,314) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:30:41,535) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994761
[2211374:MainThread](2024-04-23 00:30:41,537) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:30:41,537) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:30:43,819) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:30:44,041) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993510
[2211374:MainThread](2024-04-23 00:30:44,042) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:30:44,042) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:30:46,297) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:30:46,519) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994803
[2211374:MainThread](2024-04-23 00:30:46,519) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:30:46,520) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:30:48,779) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:30:49,001) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993925
[2211374:MainThread](2024-04-23 00:30:49,002) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:30:49,002) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:30:51,273) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:30:51,495) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993845
[2211374:MainThread](2024-04-23 00:30:51,496) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:30:51,496) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:30:53,766) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:30:53,988) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993816
[2211374:MainThread](2024-04-23 00:30:53,988) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:30:53,989) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:30:56,233) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:30:56,452) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993668
[2211374:MainThread](2024-04-23 00:30:56,452) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:30:56,453) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:30:58,717) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:30:58,939) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995686
[2211374:MainThread](2024-04-23 00:30:58,939) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:30:58,939) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:01,209) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:01,431) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993204
[2211374:MainThread](2024-04-23 00:31:01,432) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:31:01,433) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:03,699) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:03,922) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993657
[2211374:MainThread](2024-04-23 00:31:03,923) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:31:03,923) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:06,191) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:06,410) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993629
[2211374:MainThread](2024-04-23 00:31:06,411) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:31:06,411) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:08,653) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:08,872) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994032
[2211374:MainThread](2024-04-23 00:31:08,873) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:31:08,873) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:11,113) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:11,333) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993966
[2211374:MainThread](2024-04-23 00:31:11,334) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:31:11,334) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:13,601) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:13,823) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994122
[2211374:MainThread](2024-04-23 00:31:13,824) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:31:13,824) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:16,084) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:16,306) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995915
[2211374:MainThread](2024-04-23 00:31:16,306) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:31:16,307) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:18,575) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:18,797) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998063
[2211374:MainThread](2024-04-23 00:31:18,798) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:31:18,798) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:21,052) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:21,272) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994432
[2211374:MainThread](2024-04-23 00:31:21,273) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:31:21,273) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993204 @ 10
[2211374:MainThread](2024-04-23 00:31:21,325) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-01-03 SH600000   -0.019323
           SH600008   -0.003871
           SH600009    0.034169
           SH600010   -0.023387
           SH600015   -0.016999
[2211374:MainThread](2024-04-23 00:31:22,989) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   2%|▏         | 1/44 [00:57<41:23, 57.75s/it][2211374:MainThread](2024-04-23 00:31:22,999) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:31:23,010) INFO - qlib.workflow - [recorder.py:341] - Recorder 89a337caf68b4b269c1dbbdb3f1c10c0 starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:31:23,599) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:31:23,600) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:31:23,603) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:31:23,604) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:31:31,179) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.540706
            SH600004      0.540706
            SH600006      0.540706
            SH600007      0.540706
            SH600008      0.540706
                            ...   
2015-01-30  SZ300070      1.993639
            SZ300124      1.993639
            SZ300133      1.993639
            SZ300146      1.993639
            SZ300251      1.993639
Length: 483831, dtype: float64
[2211374:MainThread](2024-04-23 00:31:31,181) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:31:31,182) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:31:31,182) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:33,489) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:33,711) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995248
[2211374:MainThread](2024-04-23 00:31:33,712) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:31:33,712) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:36,005) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:36,229) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996208
[2211374:MainThread](2024-04-23 00:31:36,229) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:31:36,230) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:38,554) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:38,777) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995419
[2211374:MainThread](2024-04-23 00:31:38,777) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:31:38,777) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:41,074) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:41,299) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993651
[2211374:MainThread](2024-04-23 00:31:41,300) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:31:41,301) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:43,599) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:43,826) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996391
[2211374:MainThread](2024-04-23 00:31:43,827) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:31:43,827) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:46,132) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:46,355) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994580
[2211374:MainThread](2024-04-23 00:31:46,355) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:31:46,356) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:48,663) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:48,887) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993898
[2211374:MainThread](2024-04-23 00:31:48,888) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:31:48,888) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:51,190) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:51,414) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993274
[2211374:MainThread](2024-04-23 00:31:51,415) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:31:51,415) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:53,687) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:53,916) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993610
[2211374:MainThread](2024-04-23 00:31:53,917) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:31:53,917) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:56,188) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:56,415) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993740
[2211374:MainThread](2024-04-23 00:31:56,415) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:31:56,416) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:31:58,702) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:31:58,934) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995789
[2211374:MainThread](2024-04-23 00:31:58,934) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:31:58,935) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:01,207) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:01,430) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992908
[2211374:MainThread](2024-04-23 00:32:01,431) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:32:01,431) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:03,715) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:03,942) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993288
[2211374:MainThread](2024-04-23 00:32:03,943) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:32:03,943) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:06,231) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:06,457) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993416
[2211374:MainThread](2024-04-23 00:32:06,457) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:32:06,458) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:08,739) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:08,966) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993657
[2211374:MainThread](2024-04-23 00:32:08,967) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:32:08,967) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:11,273) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:11,502) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993771
[2211374:MainThread](2024-04-23 00:32:11,503) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:32:11,503) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:13,854) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:14,080) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993391
[2211374:MainThread](2024-04-23 00:32:14,080) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:32:14,081) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:16,416) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:16,643) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994216
[2211374:MainThread](2024-04-23 00:32:16,643) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:32:16,643) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:18,961) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:19,185) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992840
[2211374:MainThread](2024-04-23 00:32:19,186) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:32:19,187) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:21,505) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:21,731) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994664
[2211374:MainThread](2024-04-23 00:32:21,731) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:32:21,732) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:24,058) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:24,285) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993678
[2211374:MainThread](2024-04-23 00:32:24,286) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:32:24,286) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:26,601) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:26,827) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993523
[2211374:MainThread](2024-04-23 00:32:26,827) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:32:26,828) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:29,148) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:29,375) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995517
[2211374:MainThread](2024-04-23 00:32:29,375) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 00:32:29,375) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:31,707) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:31,932) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995572
[2211374:MainThread](2024-04-23 00:32:31,932) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-23 00:32:31,933) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:34,201) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:34,424) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995640
[2211374:MainThread](2024-04-23 00:32:34,424) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-23 00:32:34,425) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:36,713) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:36,941) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995249
[2211374:MainThread](2024-04-23 00:32:36,941) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-23 00:32:36,942) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:39,287) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:39,510) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999194
[2211374:MainThread](2024-04-23 00:32:39,511) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:32:39,511) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992840 @ 18
[2211374:MainThread](2024-04-23 00:32:39,561) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-02-07 SH600000    0.035999
           SH600008    0.053175
           SH600009    0.049976
           SH600010   -0.005953
           SH600015    0.059262
[2211374:MainThread](2024-04-23 00:32:41,195) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   5%|▍         | 2/44 [02:15<48:50, 69.78s/it][2211374:MainThread](2024-04-23 00:32:41,205) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:32:41,216) INFO - qlib.workflow - [recorder.py:341] - Recorder 5b15cf97eea741d1b12887a8cbe39e60 starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:32:41,801) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:32:41,802) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:32:41,805) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:32:41,806) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:32:49,275) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.633202
            SH600004      0.633202
            SH600006      0.633202
            SH600007      0.633202
            SH600008      0.633202
                            ...   
2015-03-06  SZ300070      1.927306
            SZ300124      1.927306
            SZ300133      1.927306
            SZ300146      1.927306
            SZ300251      1.927306
Length: 489365, dtype: float64
[2211374:MainThread](2024-04-23 00:32:49,277) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:32:49,277) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:32:49,277) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:51,585) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:51,808) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998067
[2211374:MainThread](2024-04-23 00:32:51,809) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:32:51,809) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:54,085) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:54,307) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995234
[2211374:MainThread](2024-04-23 00:32:54,308) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:32:54,309) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:56,587) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:56,809) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994384
[2211374:MainThread](2024-04-23 00:32:56,811) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:32:56,811) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:32:59,109) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:32:59,331) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994788
[2211374:MainThread](2024-04-23 00:32:59,332) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:32:59,332) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:01,618) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:01,840) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994537
[2211374:MainThread](2024-04-23 00:33:01,841) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:33:01,841) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:04,159) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:04,386) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994262
[2211374:MainThread](2024-04-23 00:33:04,387) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:33:04,387) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:06,684) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:06,908) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995139
[2211374:MainThread](2024-04-23 00:33:06,909) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:33:06,909) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:09,205) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:09,429) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994102
[2211374:MainThread](2024-04-23 00:33:09,430) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:33:09,430) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:11,726) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:11,950) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993888
[2211374:MainThread](2024-04-23 00:33:11,951) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:33:11,951) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:14,335) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:14,569) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994113
[2211374:MainThread](2024-04-23 00:33:14,569) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:33:14,570) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:17,063) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:17,297) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993728
[2211374:MainThread](2024-04-23 00:33:17,298) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:33:17,298) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:19,817) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:20,040) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994345
[2211374:MainThread](2024-04-23 00:33:20,041) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:33:20,041) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:22,364) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:22,588) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993301
[2211374:MainThread](2024-04-23 00:33:22,589) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:33:22,589) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:24,898) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:25,126) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993497
[2211374:MainThread](2024-04-23 00:33:25,126) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:33:25,126) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:27,451) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:27,674) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993932
[2211374:MainThread](2024-04-23 00:33:27,674) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:33:27,675) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:30,001) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:30,224) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994261
[2211374:MainThread](2024-04-23 00:33:30,225) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:33:30,225) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:32,541) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:32,765) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993989
[2211374:MainThread](2024-04-23 00:33:32,766) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:33:32,766) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:35,070) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:35,294) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993215
[2211374:MainThread](2024-04-23 00:33:35,296) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:33:35,296) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:37,653) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:37,879) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993967
[2211374:MainThread](2024-04-23 00:33:37,880) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:33:37,880) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:40,242) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:40,468) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994454
[2211374:MainThread](2024-04-23 00:33:40,469) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:33:40,469) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:42,830) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:43,056) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994242
[2211374:MainThread](2024-04-23 00:33:43,056) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:33:43,057) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:45,391) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:45,614) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994734
[2211374:MainThread](2024-04-23 00:33:45,614) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:33:45,615) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:47,897) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:48,120) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995165
[2211374:MainThread](2024-04-23 00:33:48,121) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 00:33:48,121) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:50,429) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:50,652) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996102
[2211374:MainThread](2024-04-23 00:33:50,652) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-23 00:33:50,652) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:52,969) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:53,193) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997667
[2211374:MainThread](2024-04-23 00:33:53,194) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-23 00:33:53,194) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:33:55,474) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:33:55,697) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000325
[2211374:MainThread](2024-04-23 00:33:55,697) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:33:55,698) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993215 @ 17
[2211374:MainThread](2024-04-23 00:33:55,747) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-03-07 SH600000   -0.016931
           SH600008   -0.004430
           SH600009    0.016226
           SH600010   -0.006138
           SH600015    0.026794
[2211374:MainThread](2024-04-23 00:33:57,384) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   7%|▋         | 3/44 [03:32<49:40, 72.71s/it][2211374:MainThread](2024-04-23 00:33:57,394) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:33:57,406) INFO - qlib.workflow - [recorder.py:341] - Recorder 13ac80a37f314a6fb1828f865a17e4b1 starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:33:57,991) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:33:57,992) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:33:57,995) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:33:57,996) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:34:05,478) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.656092
            SH600004      0.656092
            SH600006      0.656092
            SH600007      0.656092
            SH600008      0.656092
                            ...   
2015-04-03  SZ300070      0.662065
            SZ300124      0.662065
            SZ300133      0.662065
            SZ300146      0.662065
            SZ300251      0.662065
Length: 495049, dtype: float64
[2211374:MainThread](2024-04-23 00:34:05,481) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:34:05,481) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:34:05,481) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:07,803) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:08,025) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995701
[2211374:MainThread](2024-04-23 00:34:08,026) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:34:08,027) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:10,334) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:10,557) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995218
[2211374:MainThread](2024-04-23 00:34:10,558) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:34:10,558) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:12,876) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:13,099) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994522
[2211374:MainThread](2024-04-23 00:34:13,100) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:34:13,100) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:15,409) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:15,631) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994472
[2211374:MainThread](2024-04-23 00:34:15,632) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:34:15,632) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:18,007) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:18,229) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994100
[2211374:MainThread](2024-04-23 00:34:18,230) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:34:18,231) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:20,566) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:20,789) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994720
[2211374:MainThread](2024-04-23 00:34:20,789) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:34:20,790) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:23,127) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:23,350) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994386
[2211374:MainThread](2024-04-23 00:34:23,350) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:34:23,351) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:25,723) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:25,946) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994959
[2211374:MainThread](2024-04-23 00:34:25,947) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:34:25,947) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:28,303) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:28,526) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993811
[2211374:MainThread](2024-04-23 00:34:28,527) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:34:28,527) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:30,890) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:31,114) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994334
[2211374:MainThread](2024-04-23 00:34:31,114) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:34:31,115) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:33,429) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:33,652) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993868
[2211374:MainThread](2024-04-23 00:34:33,653) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:34:33,653) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:35,962) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:36,185) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994222
[2211374:MainThread](2024-04-23 00:34:36,186) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:34:36,186) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:38,527) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:38,751) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993830
[2211374:MainThread](2024-04-23 00:34:38,751) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:34:38,751) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:41,060) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:41,284) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994631
[2211374:MainThread](2024-04-23 00:34:41,284) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:34:41,285) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:43,596) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:43,824) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993463
[2211374:MainThread](2024-04-23 00:34:43,825) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:34:43,825) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:46,145) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:46,368) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995166
[2211374:MainThread](2024-04-23 00:34:46,369) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:34:46,369) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:48,677) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:48,902) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994917
[2211374:MainThread](2024-04-23 00:34:48,902) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:34:48,903) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:51,222) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:51,446) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993762
[2211374:MainThread](2024-04-23 00:34:51,447) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:34:51,447) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:53,755) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:53,979) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994488
[2211374:MainThread](2024-04-23 00:34:53,979) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:34:53,980) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:56,318) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:56,542) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996198
[2211374:MainThread](2024-04-23 00:34:56,542) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:34:56,542) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:34:58,854) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:34:59,079) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997143
[2211374:MainThread](2024-04-23 00:34:59,079) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:34:59,080) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:01,395) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:01,619) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994668
[2211374:MainThread](2024-04-23 00:35:01,620) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:35:01,620) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:03,938) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:04,163) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996287
[2211374:MainThread](2024-04-23 00:35:04,163) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:35:04,163) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993463 @ 14
[2211374:MainThread](2024-04-23 00:35:04,213) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-04-06 SH600000    0.026640
           SH600008   -0.165776
           SH600009   -0.082410
           SH600010    0.029175
           SH600015    0.020083
[2211374:MainThread](2024-04-23 00:35:05,845) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   9%|▉         | 4/44 [04:40<47:21, 71.03s/it][2211374:MainThread](2024-04-23 00:35:05,855) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:35:05,866) INFO - qlib.workflow - [recorder.py:341] - Recorder 29bd9e9a0ac749ea93821acd6e197bdf starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:35:06,449) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:35:06,450) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:35:06,453) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:35:06,453) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:35:13,939) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.008650
            SH600004      1.008650
            SH600006      1.008650
            SH600007      1.008650
            SH600008      1.008650
                            ...   
2015-05-05  SZ300070      1.864348
            SZ300124      1.864348
            SZ300133      1.864348
            SZ300146      1.864348
            SZ300251      1.864348
Length: 500679, dtype: float64
[2211374:MainThread](2024-04-23 00:35:13,941) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:35:13,942) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:35:13,942) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:16,309) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:16,507) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996132
[2211374:MainThread](2024-04-23 00:35:16,508) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:35:16,509) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:18,877) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:19,075) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995890
[2211374:MainThread](2024-04-23 00:35:19,076) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:35:19,076) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:21,427) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:21,624) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996854
[2211374:MainThread](2024-04-23 00:35:21,625) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:35:21,625) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:23,985) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:24,182) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995964
[2211374:MainThread](2024-04-23 00:35:24,183) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:35:24,183) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:26,538) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:26,736) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994923
[2211374:MainThread](2024-04-23 00:35:26,737) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:35:26,737) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:29,089) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:29,286) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994649
[2211374:MainThread](2024-04-23 00:35:29,287) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:35:29,288) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:31,669) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:31,867) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995165
[2211374:MainThread](2024-04-23 00:35:31,867) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:35:31,868) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:34,195) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:34,394) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995229
[2211374:MainThread](2024-04-23 00:35:34,394) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:35:34,395) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:36,745) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:36,942) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996658
[2211374:MainThread](2024-04-23 00:35:36,943) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:35:36,943) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:39,312) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:39,510) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994113
[2211374:MainThread](2024-04-23 00:35:39,511) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:35:39,511) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:41,874) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:42,073) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995589
[2211374:MainThread](2024-04-23 00:35:42,073) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:35:42,073) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:44,443) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:44,641) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994804
[2211374:MainThread](2024-04-23 00:35:44,641) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:35:44,642) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:46,996) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:47,194) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994548
[2211374:MainThread](2024-04-23 00:35:47,195) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:35:47,195) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:49,550) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:49,748) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995169
[2211374:MainThread](2024-04-23 00:35:49,749) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:35:49,749) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:52,116) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:52,313) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993789
[2211374:MainThread](2024-04-23 00:35:52,315) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:35:52,315) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:54,670) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:54,868) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996718
[2211374:MainThread](2024-04-23 00:35:54,869) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:35:54,869) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:57,228) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:57,428) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995575
[2211374:MainThread](2024-04-23 00:35:57,429) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:35:57,429) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:35:59,765) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:35:59,964) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994227
[2211374:MainThread](2024-04-23 00:35:59,965) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:35:59,965) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:36:02,256) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:36:02,455) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994568
[2211374:MainThread](2024-04-23 00:36:02,455) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:36:02,455) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:36:04,788) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:36:04,987) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995438
[2211374:MainThread](2024-04-23 00:36:04,987) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:36:04,988) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:36:07,352) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:36:07,552) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994914
[2211374:MainThread](2024-04-23 00:36:07,553) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:36:07,553) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:36:09,944) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:36:10,143) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995348
[2211374:MainThread](2024-04-23 00:36:10,144) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:36:10,144) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:36:12,595) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:36:12,794) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995290
[2211374:MainThread](2024-04-23 00:36:12,795) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:36:12,795) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993789 @ 14
[2211374:MainThread](2024-04-23 00:36:12,846) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-05-05 SH600000   -0.068884
           SH600008   -0.065342
           SH600009   -0.249248
           SH600010   -0.070229
           SH600015   -0.084312
[2211374:MainThread](2024-04-23 00:36:14,497) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  11%|█▏        | 5/44 [05:49<45:36, 70.17s/it][2211374:MainThread](2024-04-23 00:36:14,507) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:36:14,518) INFO - qlib.workflow - [recorder.py:341] - Recorder 54151182cd8043dc9c65ec9d9e7f03ca starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:36:15,126) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:36:15,127) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:36:15,130) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:36:15,131) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:36:22,724) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.561276
            SH600004      0.561276
            SH600006      0.561276
            SH600007      0.561276
            SH600008      0.561276
                            ...   
2015-06-02  SZ300070      0.735789
            SZ300124      0.735789
            SZ300133      0.735789
            SZ300146      0.735789
            SZ300251      0.735789
Length: 506316, dtype: float64
[2211374:MainThread](2024-04-23 00:36:22,727) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:36:22,727) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:36:22,727) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:36:25,190) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:36:25,394) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995615
[2211374:MainThread](2024-04-23 00:36:25,395) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:36:25,395) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:36:27,842) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:36:28,046) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995500
[2211374:MainThread](2024-04-23 00:36:28,047) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:36:28,047) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:36:30,498) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:36:30,702) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994939
[2211374:MainThread](2024-04-23 00:36:30,703) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:36:30,703) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:36:33,178) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:36:33,383) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995077
[2211374:MainThread](2024-04-23 00:36:33,383) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:36:33,384) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:36:35,790) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:36:35,994) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995196
[2211374:MainThread](2024-04-23 00:36:35,995) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:36:35,995) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:36:38,369) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:36:38,573) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996086
[2211374:MainThread](2024-04-23 00:36:38,573) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:36:38,574) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:36:40,951) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:36:41,155) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996237
[2211374:MainThread](2024-04-23 00:36:41,156) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:36:41,156) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:36:43,548) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:36:43,751) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994417
[2211374:MainThread](2024-04-23 00:36:43,752) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:36:43,753) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:36:46,150) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:36:46,355) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995081
[2211374:MainThread](2024-04-23 00:36:46,355) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:36:46,356) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:36:48,761) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:36:48,965) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994701
[2211374:MainThread](2024-04-23 00:36:48,966) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:36:48,966) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:36:51,365) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:36:51,570) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993505
[2211374:MainThread](2024-04-23 00:36:51,571) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:36:51,572) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:36:53,972) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:36:54,177) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994593
[2211374:MainThread](2024-04-23 00:36:54,177) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:36:54,177) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:36:56,579) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:36:56,785) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995242
[2211374:MainThread](2024-04-23 00:36:56,786) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:36:56,786) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:36:59,156) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:36:59,361) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994664
[2211374:MainThread](2024-04-23 00:36:59,361) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:36:59,361) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:37:01,733) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:37:01,936) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994180
[2211374:MainThread](2024-04-23 00:37:01,937) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:37:01,937) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:37:04,341) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:37:04,547) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994439
[2211374:MainThread](2024-04-23 00:37:04,547) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:37:04,547) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:37:06,936) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:37:07,140) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994982
[2211374:MainThread](2024-04-23 00:37:07,140) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:37:07,141) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:37:09,510) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:37:09,713) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995372
[2211374:MainThread](2024-04-23 00:37:09,714) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:37:09,714) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:37:12,102) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:37:12,306) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995292
[2211374:MainThread](2024-04-23 00:37:12,306) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:37:12,306) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993505 @ 10
[2211374:MainThread](2024-04-23 00:37:12,356) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-06-06 SH600000   -0.012078
           SH600008   -0.035293
           SH600009    0.003528
           SH600010   -0.022050
           SH600015   -0.014263
[2211374:MainThread](2024-04-23 00:37:13,989) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  14%|█▎        | 6/44 [06:48<42:08, 66.54s/it][2211374:MainThread](2024-04-23 00:37:13,999) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:37:14,010) INFO - qlib.workflow - [recorder.py:341] - Recorder 6a3dc56e0b06440b8f309cee65aaaf92 starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:37:14,593) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:37:14,594) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:37:14,596) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:37:14,597) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:37:22,154) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.767348
            SH600004      1.767348
            SH600006      1.767348
            SH600007      1.767348
            SH600008      1.767348
                            ...   
2015-07-10  SZ300059      1.510429
            SZ300070      1.510429
            SZ300104      1.510429
            SZ300124      1.510429
            SZ300146      1.510429
Length: 511531, dtype: float64
[2211374:MainThread](2024-04-23 00:37:22,156) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:37:22,156) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:37:22,157) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:37:24,560) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:37:24,785) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995614
[2211374:MainThread](2024-04-23 00:37:24,786) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:37:24,786) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:37:27,175) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:37:27,399) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995115
[2211374:MainThread](2024-04-23 00:37:27,400) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:37:27,400) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:37:29,791) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:37:30,015) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993634
[2211374:MainThread](2024-04-23 00:37:30,016) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:37:30,016) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:37:32,413) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:37:32,637) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994476
[2211374:MainThread](2024-04-23 00:37:32,638) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:37:32,638) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:37:35,093) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:37:35,322) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993114
[2211374:MainThread](2024-04-23 00:37:35,323) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:37:35,324) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:37:37,913) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:37:38,142) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992854
[2211374:MainThread](2024-04-23 00:37:38,143) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:37:38,144) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:37:40,625) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:37:40,851) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993667
[2211374:MainThread](2024-04-23 00:37:40,851) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:37:40,852) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:37:43,350) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:37:43,575) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992442
[2211374:MainThread](2024-04-23 00:37:43,576) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:37:43,577) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:37:46,019) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:37:46,243) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992001
[2211374:MainThread](2024-04-23 00:37:46,244) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:37:46,245) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:37:48,696) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:37:48,920) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991751
[2211374:MainThread](2024-04-23 00:37:48,921) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:37:48,921) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:37:51,380) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:37:51,605) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992803
[2211374:MainThread](2024-04-23 00:37:51,605) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:37:51,606) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:37:54,056) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:37:54,280) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992100
[2211374:MainThread](2024-04-23 00:37:54,281) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:37:54,281) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:37:56,729) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:37:56,953) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991774
[2211374:MainThread](2024-04-23 00:37:56,954) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:37:56,954) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:37:59,412) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:37:59,638) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991611
[2211374:MainThread](2024-04-23 00:37:59,639) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:37:59,640) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:38:02,098) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:38:02,322) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991339
[2211374:MainThread](2024-04-23 00:38:02,323) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:38:02,324) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:38:04,793) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:38:05,018) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991319
[2211374:MainThread](2024-04-23 00:38:05,020) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:38:05,020) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:38:07,465) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:38:07,690) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990714
[2211374:MainThread](2024-04-23 00:38:07,692) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:38:07,692) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:38:10,162) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:38:10,390) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992289
[2211374:MainThread](2024-04-23 00:38:10,390) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:38:10,391) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:38:12,829) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:38:13,058) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991684
[2211374:MainThread](2024-04-23 00:38:13,059) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:38:13,059) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:38:15,475) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:38:15,704) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992525
[2211374:MainThread](2024-04-23 00:38:15,704) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:38:15,704) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:38:18,106) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:38:18,332) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992584
[2211374:MainThread](2024-04-23 00:38:18,332) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:38:18,332) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:38:20,722) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:38:20,948) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991864
[2211374:MainThread](2024-04-23 00:38:20,948) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:38:20,948) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:38:23,348) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:38:23,581) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992267
[2211374:MainThread](2024-04-23 00:38:23,581) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 00:38:23,582) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:38:25,975) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:38:26,201) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992514
[2211374:MainThread](2024-04-23 00:38:26,201) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-23 00:38:26,201) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:38:28,594) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:38:28,819) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993367
[2211374:MainThread](2024-04-23 00:38:28,820) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:38:28,820) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990714 @ 16
[2211374:MainThread](2024-04-23 00:38:28,870) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-07-04 SH600000    0.037038
           SH600008   -0.080016
           SH600009   -0.016724
           SH600010    0.052428
           SH600015    0.009675
[2211374:MainThread](2024-04-23 00:38:30,576) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  16%|█▌        | 7/44 [08:05<43:03, 69.83s/it][2211374:MainThread](2024-04-23 00:38:30,586) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:38:30,598) INFO - qlib.workflow - [recorder.py:341] - Recorder 2ae166f24eed41628bac4ebf70c7c569 starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:38:31,198) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:38:31,199) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:38:31,201) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:38:31,202) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:38:38,751) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.031645
            SH600004      1.031645
            SH600006      1.031645
            SH600007      1.031645
            SH600008      1.031645
                            ...   
2015-08-07  SZ300104      1.692058
            SZ300124      1.692058
            SZ300133      1.692058
            SZ300146      1.692058
            SZ300251      1.692058
Length: 516849, dtype: float64
[2211374:MainThread](2024-04-23 00:38:38,753) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:38:38,753) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:38:38,754) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:38:41,195) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:38:41,415) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995482
[2211374:MainThread](2024-04-23 00:38:41,416) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:38:41,416) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:38:43,856) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:38:44,077) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995762
[2211374:MainThread](2024-04-23 00:38:44,077) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:38:44,077) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:38:46,505) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:38:46,726) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994246
[2211374:MainThread](2024-04-23 00:38:46,727) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:38:46,727) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:38:49,153) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:38:49,373) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994285
[2211374:MainThread](2024-04-23 00:38:49,374) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:38:49,374) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:38:51,885) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:38:52,109) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993323
[2211374:MainThread](2024-04-23 00:38:52,110) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:38:52,111) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:38:54,592) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:38:54,815) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993218
[2211374:MainThread](2024-04-23 00:38:54,816) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:38:54,817) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:38:57,308) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:38:57,528) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993801
[2211374:MainThread](2024-04-23 00:38:57,529) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:38:57,529) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:39:00,016) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:39:00,238) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993544
[2211374:MainThread](2024-04-23 00:39:00,238) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:39:00,238) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:39:02,719) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:39:02,940) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993080
[2211374:MainThread](2024-04-23 00:39:02,941) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:39:02,941) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:39:05,447) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:39:05,671) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992584
[2211374:MainThread](2024-04-23 00:39:05,672) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:39:05,672) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:39:08,171) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:39:08,395) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992447
[2211374:MainThread](2024-04-23 00:39:08,396) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:39:08,396) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:39:10,909) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:39:11,134) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992725
[2211374:MainThread](2024-04-23 00:39:11,134) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:39:11,134) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:39:13,635) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:39:13,859) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992790
[2211374:MainThread](2024-04-23 00:39:13,860) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:39:13,860) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:39:16,359) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:39:16,584) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993430
[2211374:MainThread](2024-04-23 00:39:16,584) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:39:16,584) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:39:19,030) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:39:19,255) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992627
[2211374:MainThread](2024-04-23 00:39:19,255) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:39:19,255) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:39:21,703) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:39:21,925) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993676
[2211374:MainThread](2024-04-23 00:39:21,925) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:39:21,926) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:39:24,365) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:39:24,587) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991880
[2211374:MainThread](2024-04-23 00:39:24,588) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:39:24,588) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:39:27,009) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:39:27,232) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992378
[2211374:MainThread](2024-04-23 00:39:27,232) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:39:27,233) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:39:29,684) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:39:29,912) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993047
[2211374:MainThread](2024-04-23 00:39:29,913) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:39:29,913) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:39:32,366) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:39:32,591) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993724
[2211374:MainThread](2024-04-23 00:39:32,591) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:39:32,592) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:39:35,013) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:39:35,234) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992546
[2211374:MainThread](2024-04-23 00:39:35,235) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:39:35,235) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:39:37,671) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:39:37,893) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992464
[2211374:MainThread](2024-04-23 00:39:37,894) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:39:37,894) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:39:40,315) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:39:40,537) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994901
[2211374:MainThread](2024-04-23 00:39:40,537) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 00:39:40,537) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:39:42,991) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:39:43,236) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993236
[2211374:MainThread](2024-04-23 00:39:43,236) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-23 00:39:43,236) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:39:45,687) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:39:45,908) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994000
[2211374:MainThread](2024-04-23 00:39:45,909) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:39:45,909) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991880 @ 16
[2211374:MainThread](2024-04-23 00:39:45,958) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-08-01 SH600000    0.008611
           SH600008    0.008897
           SH600009   -0.012158
           SH600010   -0.051195
           SH600015   -0.071045
[2211374:MainThread](2024-04-23 00:39:47,641) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  18%|█▊        | 8/44 [09:22<43:16, 72.13s/it][2211374:MainThread](2024-04-23 00:39:47,651) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:39:47,662) INFO - qlib.workflow - [recorder.py:341] - Recorder 65329cc0bfe145c8bd97f59257ad9200 starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:39:48,267) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:39:48,268) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:39:48,270) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:39:48,270) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:39:55,832) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.439626
            SH600004      1.439626
            SH600006      1.439626
            SH600007      1.439626
            SH600008      1.439626
                            ...   
2015-09-08  SZ300104      1.791060
            SZ300124      1.791060
            SZ300133      1.791060
            SZ300146      1.791060
            SZ300251      1.791060
Length: 522220, dtype: float64
[2211374:MainThread](2024-04-23 00:39:55,834) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:39:55,835) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:39:55,835) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:39:58,426) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:39:58,617) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995489
[2211374:MainThread](2024-04-23 00:39:58,618) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:39:58,618) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:01,165) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:01,354) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994052
[2211374:MainThread](2024-04-23 00:40:01,355) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:40:01,356) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:03,935) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:04,124) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993493
[2211374:MainThread](2024-04-23 00:40:04,125) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:40:04,126) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:06,691) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:06,880) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993596
[2211374:MainThread](2024-04-23 00:40:06,880) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:40:06,880) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:09,445) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:09,636) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993837
[2211374:MainThread](2024-04-23 00:40:09,636) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:40:09,636) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:12,176) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:12,367) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993097
[2211374:MainThread](2024-04-23 00:40:12,368) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:40:12,369) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:14,961) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:15,155) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992932
[2211374:MainThread](2024-04-23 00:40:15,156) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:40:15,156) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:17,776) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:17,967) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993254
[2211374:MainThread](2024-04-23 00:40:17,967) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:40:17,968) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:20,525) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:20,716) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993605
[2211374:MainThread](2024-04-23 00:40:20,716) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:40:20,716) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:23,281) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:23,470) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992551
[2211374:MainThread](2024-04-23 00:40:23,471) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:40:23,472) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:25,991) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:26,179) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992474
[2211374:MainThread](2024-04-23 00:40:26,180) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:40:26,181) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:28,690) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:28,880) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992501
[2211374:MainThread](2024-04-23 00:40:28,880) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:40:28,880) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:31,444) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:31,632) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991678
[2211374:MainThread](2024-04-23 00:40:31,633) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:40:31,633) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:34,180) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:34,370) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991947
[2211374:MainThread](2024-04-23 00:40:34,371) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:40:34,371) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:36,892) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:37,081) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992640
[2211374:MainThread](2024-04-23 00:40:37,082) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:40:37,082) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:39,508) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:39,697) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992603
[2211374:MainThread](2024-04-23 00:40:39,697) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:40:39,697) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:42,179) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:42,368) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991096
[2211374:MainThread](2024-04-23 00:40:42,369) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:40:42,369) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:44,888) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:45,076) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991863
[2211374:MainThread](2024-04-23 00:40:45,077) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:40:45,077) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:47,564) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:47,752) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991707
[2211374:MainThread](2024-04-23 00:40:47,752) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:40:47,753) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:50,248) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:50,437) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991520
[2211374:MainThread](2024-04-23 00:40:50,438) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:40:50,438) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:52,929) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:53,118) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992134
[2211374:MainThread](2024-04-23 00:40:53,118) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:40:53,119) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:55,612) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:55,801) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992106
[2211374:MainThread](2024-04-23 00:40:55,801) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:40:55,801) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:40:58,315) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:40:58,505) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992488
[2211374:MainThread](2024-04-23 00:40:58,506) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 00:40:58,506) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:41:01,003) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:41:01,191) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992494
[2211374:MainThread](2024-04-23 00:41:01,191) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-23 00:41:01,191) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:41:03,700) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:41:03,890) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994190
[2211374:MainThread](2024-04-23 00:41:03,890) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:41:03,890) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991096 @ 16
[2211374:MainThread](2024-04-23 00:41:03,940) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-08-29 SH600000   -0.056902
           SH600008   -0.015026
           SH600009    0.165192
           SH600010   -0.197950
           SH600015   -0.041258
[2211374:MainThread](2024-04-23 00:41:05,629) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  20%|██        | 9/44 [10:40<43:08, 73.96s/it][2211374:MainThread](2024-04-23 00:41:05,639) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:41:05,650) INFO - qlib.workflow - [recorder.py:341] - Recorder b593fe50146b4b0e9b8a7b20536362e8 starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:41:06,238) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:41:06,239) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:41:06,242) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:41:06,243) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:41:13,813) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.322096
            SH600004      1.322096
            SH600006      1.322096
            SH600007      1.322096
            SH600008      1.322096
                            ...   
2015-10-13  SZ300104      1.789254
            SZ300124      1.789254
            SZ300133      1.789254
            SZ300146      1.789254
            SZ300251      1.789254
Length: 527673, dtype: float64
[2211374:MainThread](2024-04-23 00:41:13,816) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:41:13,816) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:41:13,816) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:41:16,333) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:41:16,553) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995217
[2211374:MainThread](2024-04-23 00:41:16,554) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:41:16,555) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:41:19,049) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:41:19,267) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994224
[2211374:MainThread](2024-04-23 00:41:19,268) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:41:19,269) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:41:21,775) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:41:21,995) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993518
[2211374:MainThread](2024-04-23 00:41:21,996) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:41:21,997) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:41:24,501) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:41:24,720) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993512
[2211374:MainThread](2024-04-23 00:41:24,721) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:41:24,721) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:41:27,211) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:41:27,431) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992897
[2211374:MainThread](2024-04-23 00:41:27,432) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:41:27,432) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:41:29,957) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:41:30,180) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992562
[2211374:MainThread](2024-04-23 00:41:30,181) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:41:30,182) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:41:32,750) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:41:32,973) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992230
[2211374:MainThread](2024-04-23 00:41:32,974) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:41:32,974) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:41:35,539) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:41:35,762) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991888
[2211374:MainThread](2024-04-23 00:41:35,763) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:41:35,764) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:41:38,347) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:41:38,570) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992219
[2211374:MainThread](2024-04-23 00:41:38,570) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:41:38,570) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:41:41,144) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:41:41,382) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991665
[2211374:MainThread](2024-04-23 00:41:41,383) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:41:41,384) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:41:44,177) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:41:44,491) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991631
[2211374:MainThread](2024-04-23 00:41:44,492) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:41:44,492) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:41:47,731) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:41:48,028) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993457
[2211374:MainThread](2024-04-23 00:41:48,029) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:41:48,030) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:41:51,284) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:41:51,610) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992682
[2211374:MainThread](2024-04-23 00:41:51,612) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:41:51,613) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:41:55,023) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:41:55,347) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991419
[2211374:MainThread](2024-04-23 00:41:55,349) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:41:55,350) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:41:58,394) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:41:58,616) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990895
[2211374:MainThread](2024-04-23 00:41:58,617) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:41:58,617) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:42:01,064) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:42:01,285) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990998
[2211374:MainThread](2024-04-23 00:42:01,285) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:42:01,286) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:42:03,806) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:42:04,027) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991513
[2211374:MainThread](2024-04-23 00:42:04,027) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:42:04,028) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:42:06,593) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:42:06,817) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991049
[2211374:MainThread](2024-04-23 00:42:06,817) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:42:06,817) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:42:09,392) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:42:09,615) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990864
[2211374:MainThread](2024-04-23 00:42:09,617) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:42:09,617) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:42:12,161) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:42:12,385) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990712
[2211374:MainThread](2024-04-23 00:42:12,386) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:42:12,386) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:42:14,904) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:42:15,128) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991219
[2211374:MainThread](2024-04-23 00:42:15,128) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:42:15,129) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:42:17,715) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:42:17,944) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991721
[2211374:MainThread](2024-04-23 00:42:17,945) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:42:17,945) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:42:20,495) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:42:20,715) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991529
[2211374:MainThread](2024-04-23 00:42:20,716) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 00:42:20,716) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:42:23,279) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:42:23,515) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991311
[2211374:MainThread](2024-04-23 00:42:23,515) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-23 00:42:23,516) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:42:26,083) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:42:26,302) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991417
[2211374:MainThread](2024-04-23 00:42:26,303) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-23 00:42:26,303) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:42:28,855) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:42:29,077) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991080
[2211374:MainThread](2024-04-23 00:42:29,078) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-23 00:42:29,078) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:42:31,625) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:42:31,846) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991908
[2211374:MainThread](2024-04-23 00:42:31,846) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[2211374:MainThread](2024-04-23 00:42:31,846) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:42:34,292) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:42:34,513) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992048
[2211374:MainThread](2024-04-23 00:42:34,514) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:42:34,514) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990712 @ 19
[2211374:MainThread](2024-04-23 00:42:34,564) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-09-26 SH600000    0.055996
           SH600008   -0.130921
           SH600009   -0.050797
           SH600010   -0.030749
           SH600015    0.031443
[2211374:MainThread](2024-04-23 00:42:36,266) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  23%|██▎       | 10/44 [12:11<44:49, 79.11s/it][2211374:MainThread](2024-04-23 00:42:36,276) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:42:36,287) INFO - qlib.workflow - [recorder.py:341] - Recorder a9d842077eb14411bb341eea085ecfd1 starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:42:36,893) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:42:36,893) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:42:36,895) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:42:36,896) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:42:44,462) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.466937
            SH600004      1.466937
            SH600006      1.466937
            SH600007      1.466937
            SH600008      1.466937
                            ...   
2015-11-19  SZ300104      1.883373
            SZ300124      1.883373
            SZ300133      1.883373
            SZ300146      1.883373
            SZ300251      1.883373
Length: 533252, dtype: float64
[2211374:MainThread](2024-04-23 00:42:44,465) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:42:44,465) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:42:44,465) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:42:46,995) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:42:47,220) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995255
[2211374:MainThread](2024-04-23 00:42:47,221) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:42:47,221) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:42:49,739) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:42:49,966) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994855
[2211374:MainThread](2024-04-23 00:42:49,967) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:42:49,968) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:42:52,496) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:42:52,721) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994292
[2211374:MainThread](2024-04-23 00:42:52,722) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:42:52,722) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:42:55,254) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:42:55,479) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993059
[2211374:MainThread](2024-04-23 00:42:55,480) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:42:55,480) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:42:58,013) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:42:58,240) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993101
[2211374:MainThread](2024-04-23 00:42:58,241) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:42:58,241) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:00,785) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:01,013) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993457
[2211374:MainThread](2024-04-23 00:43:01,013) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:43:01,014) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:03,566) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:03,794) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992491
[2211374:MainThread](2024-04-23 00:43:03,795) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:43:03,795) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:06,329) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:06,554) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992160
[2211374:MainThread](2024-04-23 00:43:06,555) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:43:06,556) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:09,084) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:09,316) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992441
[2211374:MainThread](2024-04-23 00:43:09,317) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:43:09,317) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:11,845) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:12,070) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992056
[2211374:MainThread](2024-04-23 00:43:12,071) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:43:12,072) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:14,565) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:14,791) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991976
[2211374:MainThread](2024-04-23 00:43:14,792) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:43:14,792) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:17,315) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:17,543) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991803
[2211374:MainThread](2024-04-23 00:43:17,544) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:43:17,544) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:20,103) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:20,328) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992108
[2211374:MainThread](2024-04-23 00:43:20,329) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:43:20,329) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:22,885) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:23,113) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991763
[2211374:MainThread](2024-04-23 00:43:23,114) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:43:23,115) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:25,677) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:25,903) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991716
[2211374:MainThread](2024-04-23 00:43:25,904) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:43:25,904) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:28,461) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:28,686) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991253
[2211374:MainThread](2024-04-23 00:43:28,687) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:43:28,687) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:31,257) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:31,483) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991727
[2211374:MainThread](2024-04-23 00:43:31,484) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:43:31,484) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:34,041) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:34,266) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991235
[2211374:MainThread](2024-04-23 00:43:34,267) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:43:34,267) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:36,837) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:37,063) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991744
[2211374:MainThread](2024-04-23 00:43:37,064) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:43:37,064) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:39,620) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:39,846) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991262
[2211374:MainThread](2024-04-23 00:43:39,847) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:43:39,847) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:42,404) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:42,630) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992008
[2211374:MainThread](2024-04-23 00:43:42,630) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:43:42,631) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:45,205) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:45,430) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991976
[2211374:MainThread](2024-04-23 00:43:45,430) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:43:45,431) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:47,989) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:48,215) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991767
[2211374:MainThread](2024-04-23 00:43:48,215) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 00:43:48,216) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:50,789) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:51,015) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990908
[2211374:MainThread](2024-04-23 00:43:51,016) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-23 00:43:51,017) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:53,537) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:53,763) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992299
[2211374:MainThread](2024-04-23 00:43:53,763) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-23 00:43:53,763) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:56,283) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:56,511) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991106
[2211374:MainThread](2024-04-23 00:43:56,512) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-23 00:43:56,512) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:43:59,068) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:43:59,294) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993110
[2211374:MainThread](2024-04-23 00:43:59,294) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[2211374:MainThread](2024-04-23 00:43:59,295) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:44:01,853) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:44:02,078) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991802
[2211374:MainThread](2024-04-23 00:44:02,079) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[2211374:MainThread](2024-04-23 00:44:02,079) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:44:04,652) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:44:04,878) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992238
[2211374:MainThread](2024-04-23 00:44:04,879) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[2211374:MainThread](2024-04-23 00:44:04,879) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:44:07,433) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:44:07,658) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992947
[2211374:MainThread](2024-04-23 00:44:07,658) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch30:
[2211374:MainThread](2024-04-23 00:44:07,659) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:44:10,233) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:44:10,459) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993099
[2211374:MainThread](2024-04-23 00:44:10,459) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch31:
[2211374:MainThread](2024-04-23 00:44:10,459) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:44:13,017) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:44:13,243) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993894
[2211374:MainThread](2024-04-23 00:44:13,243) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:44:13,243) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990908 @ 23
[2211374:MainThread](2024-04-23 00:44:13,293) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-10-31 SH600000   -0.063371
           SH600008   -0.091923
           SH600009    0.200379
           SH600010    0.013153
           SH600015   -0.073300
[2211374:MainThread](2024-04-23 00:44:14,984) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  25%|██▌       | 11/44 [13:49<46:48, 85.11s/it][2211374:MainThread](2024-04-23 00:44:14,994) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:44:15,006) INFO - qlib.workflow - [recorder.py:341] - Recorder 91240481537c4536b3526ad498f68a5c starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:44:15,595) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:44:15,596) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:44:15,600) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:44:15,600) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:44:23,190) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.071155
            SH600004      1.071155
            SH600006      1.071155
            SH600007      1.071155
            SH600008      1.071155
                            ...   
2015-12-17  SZ300133      1.984742
            SZ300144      1.984742
            SZ300146      1.984742
            SZ300251      1.984742
            SZ300315      1.984742
Length: 538891, dtype: float64
[2211374:MainThread](2024-04-23 00:44:23,193) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:44:23,193) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:44:23,194) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:44:25,772) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:44:25,998) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995954
[2211374:MainThread](2024-04-23 00:44:25,999) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:44:26,000) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:44:28,567) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:44:28,792) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995057
[2211374:MainThread](2024-04-23 00:44:28,793) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:44:28,793) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:44:31,410) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:44:31,636) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994144
[2211374:MainThread](2024-04-23 00:44:31,637) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:44:31,638) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:44:34,224) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:44:34,461) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994290
[2211374:MainThread](2024-04-23 00:44:34,462) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:44:34,462) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:44:37,252) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:44:37,602) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993639
[2211374:MainThread](2024-04-23 00:44:37,603) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:44:37,604) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:44:41,112) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:44:41,491) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993265
[2211374:MainThread](2024-04-23 00:44:41,492) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:44:41,492) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:44:44,975) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:44:45,330) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993361
[2211374:MainThread](2024-04-23 00:44:45,331) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:44:45,331) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:44:48,837) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:44:49,191) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993072
[2211374:MainThread](2024-04-23 00:44:49,192) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:44:49,192) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:44:52,695) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:44:53,053) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992677
[2211374:MainThread](2024-04-23 00:44:53,054) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:44:53,054) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:44:56,553) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:44:56,907) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992480
[2211374:MainThread](2024-04-23 00:44:56,908) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:44:56,909) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:45:00,393) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:45:00,745) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992659
[2211374:MainThread](2024-04-23 00:45:00,745) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:45:00,746) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:45:04,216) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:45:04,579) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992496
[2211374:MainThread](2024-04-23 00:45:04,580) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:45:04,580) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:45:08,052) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:45:08,399) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991703
[2211374:MainThread](2024-04-23 00:45:08,400) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:45:08,401) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:45:11,880) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:45:12,236) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992200
[2211374:MainThread](2024-04-23 00:45:12,236) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:45:12,236) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:45:15,671) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:45:16,023) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991969
[2211374:MainThread](2024-04-23 00:45:16,024) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:45:16,024) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:45:19,281) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:45:19,510) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991310
[2211374:MainThread](2024-04-23 00:45:19,511) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:45:19,512) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:45:22,112) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:45:22,340) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991335
[2211374:MainThread](2024-04-23 00:45:22,340) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:45:22,341) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:45:24,917) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:45:25,143) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992313
[2211374:MainThread](2024-04-23 00:45:25,143) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:45:25,144) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:45:27,659) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:45:27,886) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991642
[2211374:MainThread](2024-04-23 00:45:27,886) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:45:27,887) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:45:30,410) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:45:30,636) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991090
[2211374:MainThread](2024-04-23 00:45:30,637) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:45:30,638) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:45:33,155) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:45:33,381) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991670
[2211374:MainThread](2024-04-23 00:45:33,381) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:45:33,382) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:45:35,926) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:45:36,157) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991972
[2211374:MainThread](2024-04-23 00:45:36,157) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:45:36,157) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:45:38,691) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:45:38,917) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992305
[2211374:MainThread](2024-04-23 00:45:38,917) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 00:45:38,917) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:45:41,456) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:45:41,685) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992250
[2211374:MainThread](2024-04-23 00:45:41,685) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-23 00:45:41,686) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:45:44,247) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:45:44,475) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991986
[2211374:MainThread](2024-04-23 00:45:44,476) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-23 00:45:44,476) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:45:47,024) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:45:47,252) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991971
[2211374:MainThread](2024-04-23 00:45:47,252) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-23 00:45:47,253) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:45:49,812) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:45:50,041) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991649
[2211374:MainThread](2024-04-23 00:45:50,041) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[2211374:MainThread](2024-04-23 00:45:50,042) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:45:52,573) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:45:52,799) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992303
[2211374:MainThread](2024-04-23 00:45:52,799) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:45:52,799) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991090 @ 19
[2211374:MainThread](2024-04-23 00:45:52,857) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-11-28 SH600000   -0.033851
           SH600008   -0.074580
           SH600009    0.046794
           SH600010   -0.002078
           SH600015   -0.003909
[2211374:MainThread](2024-04-23 00:45:54,562) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  27%|██▋       | 12/44 [15:29<47:44, 89.51s/it][2211374:MainThread](2024-04-23 00:45:54,572) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:45:54,583) INFO - qlib.workflow - [recorder.py:341] - Recorder 763f0b5c172a44958a0503c6bbca7e42 starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:45:55,175) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:45:55,176) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:45:55,178) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:45:55,178) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:46:03,079) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.602878
            SH600004      1.602878
            SH600006      1.602878
            SH600007      1.602878
            SH600008      1.602878
                            ...   
2016-01-15  SZ300133      1.050756
            SZ300144      1.050756
            SZ300146      1.050756
            SZ300251      1.050756
            SZ300315      1.050756
Length: 544436, dtype: float64
[2211374:MainThread](2024-04-23 00:46:03,081) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:46:03,081) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:46:03,082) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:05,633) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:05,861) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995816
[2211374:MainThread](2024-04-23 00:46:05,862) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:46:05,863) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:08,401) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:08,625) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995828
[2211374:MainThread](2024-04-23 00:46:08,625) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:46:08,625) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:11,182) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:11,406) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994237
[2211374:MainThread](2024-04-23 00:46:11,407) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:46:11,407) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:13,958) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:14,182) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994197
[2211374:MainThread](2024-04-23 00:46:14,183) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:46:14,183) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:16,741) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:16,965) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994853
[2211374:MainThread](2024-04-23 00:46:16,966) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:46:16,966) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:19,512) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:19,737) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992543
[2211374:MainThread](2024-04-23 00:46:19,739) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:46:19,739) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:22,239) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:22,466) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993099
[2211374:MainThread](2024-04-23 00:46:22,466) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:46:22,467) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:24,967) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:25,190) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993018
[2211374:MainThread](2024-04-23 00:46:25,191) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:46:25,191) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:27,723) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:27,947) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992566
[2211374:MainThread](2024-04-23 00:46:27,948) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:46:27,948) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:30,495) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:30,719) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992265
[2211374:MainThread](2024-04-23 00:46:30,720) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:46:30,721) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:33,252) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:33,477) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992021
[2211374:MainThread](2024-04-23 00:46:33,478) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:46:33,478) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:36,026) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:36,254) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991393
[2211374:MainThread](2024-04-23 00:46:36,255) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:46:36,255) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:38,805) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:39,029) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991409
[2211374:MainThread](2024-04-23 00:46:39,029) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:46:39,029) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:41,561) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:41,784) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992604
[2211374:MainThread](2024-04-23 00:46:41,784) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:46:41,785) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:44,409) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:44,639) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991979
[2211374:MainThread](2024-04-23 00:46:44,639) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:46:44,639) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:47,266) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:47,492) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991078
[2211374:MainThread](2024-04-23 00:46:47,493) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:46:47,494) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:50,136) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:50,361) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991509
[2211374:MainThread](2024-04-23 00:46:50,362) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:46:50,362) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:52,981) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:53,210) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991028
[2211374:MainThread](2024-04-23 00:46:53,211) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:46:53,211) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:55,838) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:56,066) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990481
[2211374:MainThread](2024-04-23 00:46:56,067) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:46:56,067) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:46:58,694) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:46:58,920) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991154
[2211374:MainThread](2024-04-23 00:46:58,920) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:46:58,921) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:47:01,580) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:47:01,809) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992343
[2211374:MainThread](2024-04-23 00:47:01,809) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:47:01,810) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:47:04,424) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:47:04,648) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991236
[2211374:MainThread](2024-04-23 00:47:04,649) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:47:04,649) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:47:07,240) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:47:07,464) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991828
[2211374:MainThread](2024-04-23 00:47:07,465) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 00:47:07,465) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:47:10,096) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:47:10,323) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992110
[2211374:MainThread](2024-04-23 00:47:10,323) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-23 00:47:10,323) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:47:12,952) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:47:13,179) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994351
[2211374:MainThread](2024-04-23 00:47:13,180) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-23 00:47:13,180) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:47:15,814) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:47:16,041) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991576
[2211374:MainThread](2024-04-23 00:47:16,042) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-23 00:47:16,042) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:47:18,675) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:47:18,902) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992096
[2211374:MainThread](2024-04-23 00:47:18,902) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:47:18,903) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990481 @ 18
[2211374:MainThread](2024-04-23 00:47:18,954) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-12-26 SH600000   -0.008734
           SH600008    0.127494
           SH600009    0.042214
           SH600010   -0.009129
           SH600011    0.026959
[2211374:MainThread](2024-04-23 00:47:20,704) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  30%|██▉       | 13/44 [16:55<45:43, 88.49s/it][2211374:MainThread](2024-04-23 00:47:20,714) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:47:20,725) INFO - qlib.workflow - [recorder.py:341] - Recorder 8e489f741a454d69909fbfa42716df36 starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:47:21,321) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:47:21,322) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:47:21,325) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:47:21,325) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:47:29,124) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.744753
            SH600004      0.744753
            SH600006      0.744753
            SH600007      0.744753
            SH600008      0.744753
                            ...   
2016-03-16  SZ300133      1.470206
            SZ300144      1.470206
            SZ300146      1.470206
            SZ300251      1.470206
            SZ300315      1.470206
Length: 550075, dtype: float64
[2211374:MainThread](2024-04-23 00:47:29,126) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:47:29,127) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:47:29,127) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:47:31,786) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:47:31,977) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995989
[2211374:MainThread](2024-04-23 00:47:31,979) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:47:31,979) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:47:35,142) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:47:35,391) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994555
[2211374:MainThread](2024-04-23 00:47:35,394) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:47:35,395) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:47:38,838) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:47:39,087) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994277
[2211374:MainThread](2024-04-23 00:47:39,090) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:47:39,091) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:47:42,700) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:47:42,963) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994006
[2211374:MainThread](2024-04-23 00:47:42,965) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:47:42,967) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:47:46,462) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:47:46,721) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993980
[2211374:MainThread](2024-04-23 00:47:46,724) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:47:46,726) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:47:50,122) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:47:50,377) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993312
[2211374:MainThread](2024-04-23 00:47:50,380) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:47:50,381) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:47:53,471) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:47:53,668) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993287
[2211374:MainThread](2024-04-23 00:47:53,670) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:47:53,670) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:47:56,482) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:47:56,682) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993096
[2211374:MainThread](2024-04-23 00:47:56,683) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:47:56,683) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:47:59,464) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:47:59,656) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992460
[2211374:MainThread](2024-04-23 00:47:59,657) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:47:59,658) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:02,524) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:02,725) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992534
[2211374:MainThread](2024-04-23 00:48:02,726) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:48:02,726) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:05,539) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:05,735) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991854
[2211374:MainThread](2024-04-23 00:48:05,737) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:48:05,737) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:08,404) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:08,599) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991843
[2211374:MainThread](2024-04-23 00:48:08,600) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:48:08,600) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:11,304) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:11,497) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991264
[2211374:MainThread](2024-04-23 00:48:11,499) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:48:11,499) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:14,195) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:14,390) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992425
[2211374:MainThread](2024-04-23 00:48:14,391) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:48:14,391) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:17,296) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:17,498) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990989
[2211374:MainThread](2024-04-23 00:48:17,499) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:48:17,500) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:20,349) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:20,538) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991405
[2211374:MainThread](2024-04-23 00:48:20,539) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:48:20,539) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:23,309) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:23,504) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990958
[2211374:MainThread](2024-04-23 00:48:23,505) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:48:23,506) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:26,289) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:26,485) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990979
[2211374:MainThread](2024-04-23 00:48:26,485) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:48:26,486) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:29,297) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:29,496) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991349
[2211374:MainThread](2024-04-23 00:48:29,496) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:48:29,496) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:32,357) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:32,555) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991418
[2211374:MainThread](2024-04-23 00:48:32,555) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:48:32,555) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:35,427) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:35,625) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991980
[2211374:MainThread](2024-04-23 00:48:35,626) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:48:35,626) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:38,532) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:38,730) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990457
[2211374:MainThread](2024-04-23 00:48:38,731) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:48:38,732) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:41,633) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:41,834) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991082
[2211374:MainThread](2024-04-23 00:48:41,834) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 00:48:41,834) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:44,703) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:44,900) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991258
[2211374:MainThread](2024-04-23 00:48:44,901) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-23 00:48:44,901) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:47,766) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:47,963) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991587
[2211374:MainThread](2024-04-23 00:48:47,964) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-23 00:48:47,964) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:50,611) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:50,802) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992137
[2211374:MainThread](2024-04-23 00:48:50,802) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-23 00:48:50,802) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:53,422) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:53,612) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991768
[2211374:MainThread](2024-04-23 00:48:53,613) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[2211374:MainThread](2024-04-23 00:48:53,613) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:56,216) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:56,405) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992177
[2211374:MainThread](2024-04-23 00:48:56,405) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[2211374:MainThread](2024-04-23 00:48:56,405) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:48:59,008) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:48:59,201) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991839
[2211374:MainThread](2024-04-23 00:48:59,202) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[2211374:MainThread](2024-04-23 00:48:59,202) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:49:01,827) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:49:02,017) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993328
[2211374:MainThread](2024-04-23 00:49:02,017) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:49:02,017) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990457 @ 21
[2211374:MainThread](2024-04-23 00:49:02,069) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-01-24 SH600000    0.081698
           SH600008   -0.168455
           SH600009    0.176854
           SH600010    0.007048
           SH600011   -0.011931
[2211374:MainThread](2024-04-23 00:49:03,869) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  32%|███▏      | 14/44 [18:38<46:27, 92.92s/it][2211374:MainThread](2024-04-23 00:49:03,879) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:49:03,890) INFO - qlib.workflow - [recorder.py:341] - Recorder d2eb0480e0ba45f19dd0e536ccc811d9 starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:49:04,483) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:49:04,483) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:49:04,485) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:49:04,485) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:49:12,247) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.085428
            SH600004      1.085428
            SH600006      1.085428
            SH600007      1.085428
            SH600008      1.085428
                            ...   
2016-04-14  SZ300124      1.939677
            SZ300133      1.939677
            SZ300144      1.939677
            SZ300146      1.939677
            SZ300315      1.939677
Length: 555663, dtype: float64
[2211374:MainThread](2024-04-23 00:49:12,250) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:49:12,250) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:49:12,250) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:49:14,905) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:49:15,094) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995677
[2211374:MainThread](2024-04-23 00:49:15,095) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:49:15,096) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:49:17,750) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:49:17,939) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994366
[2211374:MainThread](2024-04-23 00:49:17,940) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:49:17,940) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:49:20,618) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:49:20,807) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993884
[2211374:MainThread](2024-04-23 00:49:20,808) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:49:20,808) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:49:23,442) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:49:23,630) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993232
[2211374:MainThread](2024-04-23 00:49:23,631) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:49:23,631) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:49:26,284) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:49:26,474) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994512
[2211374:MainThread](2024-04-23 00:49:26,474) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:49:26,474) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:49:29,125) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:49:29,314) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992988
[2211374:MainThread](2024-04-23 00:49:29,315) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:49:29,315) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:49:31,963) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:49:32,152) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992128
[2211374:MainThread](2024-04-23 00:49:32,153) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:49:32,154) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:49:34,799) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:49:34,988) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992242
[2211374:MainThread](2024-04-23 00:49:34,989) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:49:34,989) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:49:37,676) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:49:37,865) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991319
[2211374:MainThread](2024-04-23 00:49:37,866) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:49:37,866) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:49:40,516) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:49:40,705) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991395
[2211374:MainThread](2024-04-23 00:49:40,706) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:49:40,706) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:49:43,364) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:49:43,553) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991674
[2211374:MainThread](2024-04-23 00:49:43,554) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:49:43,554) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:49:46,194) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:49:46,383) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991631
[2211374:MainThread](2024-04-23 00:49:46,384) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:49:46,384) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:49:49,034) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:49:49,223) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991098
[2211374:MainThread](2024-04-23 00:49:49,224) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:49:49,225) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:49:52,177) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:49:52,387) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991293
[2211374:MainThread](2024-04-23 00:49:52,388) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:49:52,389) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:49:57,228) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:49:57,486) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991489
[2211374:MainThread](2024-04-23 00:49:57,487) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:49:57,489) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:50:01,710) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:50:01,961) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991018
[2211374:MainThread](2024-04-23 00:50:01,965) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:50:01,966) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:50:05,378) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:50:05,618) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991819
[2211374:MainThread](2024-04-23 00:50:05,620) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:50:05,621) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:50:08,964) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:50:09,205) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991997
[2211374:MainThread](2024-04-23 00:50:09,206) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:50:09,207) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:50:12,260) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:50:12,449) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991508
[2211374:MainThread](2024-04-23 00:50:12,449) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:50:12,450) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:50:15,164) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:50:15,354) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991520
[2211374:MainThread](2024-04-23 00:50:15,355) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:50:15,355) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:50:18,081) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:50:18,270) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992536
[2211374:MainThread](2024-04-23 00:50:18,271) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:50:18,271) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:50:20,964) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:50:21,154) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992357
[2211374:MainThread](2024-04-23 00:50:21,154) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:50:21,154) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:50:23,711) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:50:23,901) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991569
[2211374:MainThread](2024-04-23 00:50:23,902) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 00:50:23,902) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:50:26,447) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:50:26,637) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992209
[2211374:MainThread](2024-04-23 00:50:26,638) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:50:26,638) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991018 @ 15
[2211374:MainThread](2024-04-23 00:50:26,689) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-02-28 SH600000   -0.114308
           SH600008    0.040685
           SH600009    0.177812
           SH600010   -0.093121
           SH600011    0.026311
[2211374:MainThread](2024-04-23 00:50:28,457) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  34%|███▍      | 15/44 [20:03<43:41, 90.41s/it][2211374:MainThread](2024-04-23 00:50:28,468) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:50:28,481) INFO - qlib.workflow - [recorder.py:341] - Recorder 458cee2d11fd455681470336188e962e starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:50:29,083) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:50:29,084) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:50:29,088) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:50:29,088) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:50:36,741) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.802622
            SH600004      0.802622
            SH600006      0.802622
            SH600007      0.802622
            SH600008      0.802622
                            ...   
2016-05-13  SZ300124      0.810267
            SZ300133      0.810267
            SZ300144      0.810267
            SZ300146      0.810267
            SZ300315      0.810267
Length: 561275, dtype: float64
[2211374:MainThread](2024-04-23 00:50:36,744) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:50:36,744) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:50:36,744) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:50:39,401) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:50:39,624) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995571
[2211374:MainThread](2024-04-23 00:50:39,626) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:50:39,626) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:50:42,277) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:50:42,501) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995617
[2211374:MainThread](2024-04-23 00:50:42,501) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:50:42,502) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:50:45,161) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:50:45,385) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994337
[2211374:MainThread](2024-04-23 00:50:45,386) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:50:45,386) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:50:47,972) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:50:48,197) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994079
[2211374:MainThread](2024-04-23 00:50:48,198) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:50:48,199) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:50:50,839) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:50:51,062) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994266
[2211374:MainThread](2024-04-23 00:50:51,063) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:50:51,063) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:50:53,705) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:50:53,929) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993671
[2211374:MainThread](2024-04-23 00:50:53,930) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:50:53,931) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:50:56,575) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:50:56,800) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994105
[2211374:MainThread](2024-04-23 00:50:56,800) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:50:56,800) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:50:59,441) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:50:59,665) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992631
[2211374:MainThread](2024-04-23 00:50:59,666) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:50:59,666) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:51:02,302) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:51:02,529) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993274
[2211374:MainThread](2024-04-23 00:51:02,529) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:51:02,529) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:51:05,169) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:51:05,393) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992841
[2211374:MainThread](2024-04-23 00:51:05,393) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:51:05,394) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:51:08,036) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:51:08,260) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992655
[2211374:MainThread](2024-04-23 00:51:08,261) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:51:08,261) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:51:10,915) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:51:11,139) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992773
[2211374:MainThread](2024-04-23 00:51:11,140) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:51:11,140) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:51:13,779) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:51:14,004) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991809
[2211374:MainThread](2024-04-23 00:51:14,005) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:51:14,006) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:51:16,661) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:51:16,885) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992017
[2211374:MainThread](2024-04-23 00:51:16,886) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:51:16,886) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:51:19,609) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:51:19,834) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991406
[2211374:MainThread](2024-04-23 00:51:19,835) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:51:19,836) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:51:22,570) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:51:22,796) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992112
[2211374:MainThread](2024-04-23 00:51:22,796) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:51:22,797) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:51:25,527) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:51:25,754) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991723
[2211374:MainThread](2024-04-23 00:51:25,755) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:51:25,755) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:51:28,469) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:51:28,692) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991694
[2211374:MainThread](2024-04-23 00:51:28,692) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:51:28,693) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:51:31,391) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:51:31,614) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991717
[2211374:MainThread](2024-04-23 00:51:31,614) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:51:31,615) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:51:34,322) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:51:34,550) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991771
[2211374:MainThread](2024-04-23 00:51:34,551) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:51:34,551) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:51:37,280) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:51:37,508) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991599
[2211374:MainThread](2024-04-23 00:51:37,509) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:51:37,509) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:51:40,210) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:51:40,438) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991824
[2211374:MainThread](2024-04-23 00:51:40,438) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:51:40,439) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:51:43,130) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:51:43,355) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992688
[2211374:MainThread](2024-04-23 00:51:43,355) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:51:43,356) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991406 @ 14
[2211374:MainThread](2024-04-23 00:51:43,407) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-03-28 SH600000   -0.041965
           SH600008   -0.130855
           SH600009    0.026855
           SH600010    0.061635
           SH600011   -0.139839
[2211374:MainThread](2024-04-23 00:51:45,166) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  36%|███▋      | 16/44 [21:19<40:16, 86.29s/it][2211374:MainThread](2024-04-23 00:51:45,176) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:51:45,188) INFO - qlib.workflow - [recorder.py:341] - Recorder 4108ab4c2dbb43a7bcfe2342ef14f8bb starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:51:45,792) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:51:45,792) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:51:45,795) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:51:45,796) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:51:53,536) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.774289
            SH600004      0.774289
            SH600006      0.774289
            SH600007      0.774289
            SH600008      0.774289
                            ...   
2016-06-14  SZ300133      1.550961
            SZ300144      1.550961
            SZ300146      1.550961
            SZ300251      1.550961
            SZ300315      1.550961
Length: 566995, dtype: float64
[2211374:MainThread](2024-04-23 00:51:53,538) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:51:53,538) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:51:53,539) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:51:56,199) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:51:56,423) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995807
[2211374:MainThread](2024-04-23 00:51:56,424) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:51:56,424) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:51:59,032) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:51:59,255) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994947
[2211374:MainThread](2024-04-23 00:51:59,256) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:51:59,257) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:01,914) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:02,139) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994639
[2211374:MainThread](2024-04-23 00:52:02,140) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:52:02,140) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:04,758) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:04,986) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994114
[2211374:MainThread](2024-04-23 00:52:04,987) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:52:04,987) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:07,649) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:07,873) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993580
[2211374:MainThread](2024-04-23 00:52:07,874) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:52:07,874) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:10,547) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:10,771) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994434
[2211374:MainThread](2024-04-23 00:52:10,771) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:52:10,771) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:13,434) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:13,657) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993143
[2211374:MainThread](2024-04-23 00:52:13,658) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:52:13,658) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:16,328) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:16,551) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992373
[2211374:MainThread](2024-04-23 00:52:16,552) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:52:16,553) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:19,214) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:19,438) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992280
[2211374:MainThread](2024-04-23 00:52:19,439) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:52:19,440) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:22,100) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:22,325) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991781
[2211374:MainThread](2024-04-23 00:52:22,326) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:52:22,326) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:24,982) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:25,206) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992125
[2211374:MainThread](2024-04-23 00:52:25,206) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:52:25,207) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:27,871) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:28,095) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991601
[2211374:MainThread](2024-04-23 00:52:28,097) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:52:28,097) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:30,812) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:31,035) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992311
[2211374:MainThread](2024-04-23 00:52:31,035) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:52:31,035) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:33,733) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:33,958) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991337
[2211374:MainThread](2024-04-23 00:52:33,959) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:52:33,959) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:36,679) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:36,903) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991791
[2211374:MainThread](2024-04-23 00:52:36,903) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:52:36,903) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:39,600) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:39,826) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992157
[2211374:MainThread](2024-04-23 00:52:39,827) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:52:39,827) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:42,531) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:42,758) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991700
[2211374:MainThread](2024-04-23 00:52:42,758) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:52:42,759) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:45,441) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:45,666) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991966
[2211374:MainThread](2024-04-23 00:52:45,667) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:52:45,667) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:48,324) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:48,548) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992481
[2211374:MainThread](2024-04-23 00:52:48,548) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:52:48,549) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:51,215) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:51,440) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991079
[2211374:MainThread](2024-04-23 00:52:51,441) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:52:51,441) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:54,097) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:54,322) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992963
[2211374:MainThread](2024-04-23 00:52:54,322) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:52:54,323) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:56,990) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:52:57,214) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991950
[2211374:MainThread](2024-04-23 00:52:57,215) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:52:57,215) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:52:59,866) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:53:00,090) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992571
[2211374:MainThread](2024-04-23 00:53:00,090) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 00:53:00,090) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:53:02,764) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:53:02,989) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992974
[2211374:MainThread](2024-04-23 00:53:02,989) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-23 00:53:02,990) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:53:05,653) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:53:05,881) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992823
[2211374:MainThread](2024-04-23 00:53:05,881) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-23 00:53:05,882) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:53:08,559) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:53:08,785) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992592
[2211374:MainThread](2024-04-23 00:53:08,785) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[2211374:MainThread](2024-04-23 00:53:08,786) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:53:11,452) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:53:11,676) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992867
[2211374:MainThread](2024-04-23 00:53:11,676) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[2211374:MainThread](2024-04-23 00:53:11,677) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:53:14,332) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:53:14,557) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992406
[2211374:MainThread](2024-04-23 00:53:14,557) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:53:14,557) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991079 @ 19
[2211374:MainThread](2024-04-23 00:53:14,608) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-04-27 SH600000    0.016770
           SH600008   -0.018672
           SH600009    0.086886
           SH600010   -0.070117
           SH600011   -0.050544
[2211374:MainThread](2024-04-23 00:53:16,356) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  39%|███▊      | 17/44 [22:51<39:29, 87.76s/it][2211374:MainThread](2024-04-23 00:53:16,366) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:53:16,378) INFO - qlib.workflow - [recorder.py:341] - Recorder 263792a7d0754590beaa02612f0f9c7b starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:53:16,976) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:53:16,977) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:53:16,981) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:53:16,981) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:53:24,686) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.117992
            SH600004      1.117992
            SH600006      1.117992
            SH600007      1.117992
            SH600008      1.117992
                            ...   
2016-07-12  SZ300144      1.725324
            SZ300146      1.725324
            SZ300168      1.725324
            SZ300251      1.725324
            SZ300315      1.725324
Length: 572790, dtype: float64
[2211374:MainThread](2024-04-23 00:53:24,689) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:53:24,689) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:53:24,689) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:53:27,347) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:53:27,575) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995693
[2211374:MainThread](2024-04-23 00:53:27,576) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:53:27,576) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:53:30,302) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:53:31,172) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994919
[2211374:MainThread](2024-04-23 00:53:31,173) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:53:31,174) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:53:34,048) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:53:34,404) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993430
[2211374:MainThread](2024-04-23 00:53:34,406) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:53:34,406) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:53:38,104) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:53:38,478) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993299
[2211374:MainThread](2024-04-23 00:53:38,479) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:53:38,480) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:53:42,221) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:53:42,571) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992690
[2211374:MainThread](2024-04-23 00:53:42,572) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:53:42,572) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:53:46,329) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:53:46,682) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992095
[2211374:MainThread](2024-04-23 00:53:46,683) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:53:46,683) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:53:50,426) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:53:50,788) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993758
[2211374:MainThread](2024-04-23 00:53:50,789) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:53:50,789) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:53:54,483) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:53:54,837) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991427
[2211374:MainThread](2024-04-23 00:53:54,838) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:53:54,838) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:53:58,535) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:53:58,888) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992177
[2211374:MainThread](2024-04-23 00:53:58,889) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:53:58,889) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:54:02,547) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:54:02,905) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993034
[2211374:MainThread](2024-04-23 00:54:02,905) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:54:02,905) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:54:06,595) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:54:06,953) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991874
[2211374:MainThread](2024-04-23 00:54:06,954) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:54:06,954) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:54:10,652) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:54:11,018) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991142
[2211374:MainThread](2024-04-23 00:54:11,019) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:54:11,019) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:54:14,707) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:54:15,054) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992065
[2211374:MainThread](2024-04-23 00:54:15,054) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:54:15,054) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:54:18,820) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:54:19,188) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991015
[2211374:MainThread](2024-04-23 00:54:19,189) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:54:19,189) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:54:22,962) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:54:23,342) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991723
[2211374:MainThread](2024-04-23 00:54:23,343) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:54:23,343) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:54:27,086) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:54:27,436) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990818
[2211374:MainThread](2024-04-23 00:54:27,437) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:54:27,438) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:54:31,153) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:54:31,508) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991439
[2211374:MainThread](2024-04-23 00:54:31,508) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:54:31,508) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:54:35,255) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:54:35,612) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990540
[2211374:MainThread](2024-04-23 00:54:35,613) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:54:35,613) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:54:39,349) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:54:39,706) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991535
[2211374:MainThread](2024-04-23 00:54:39,706) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:54:39,706) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:54:43,425) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:54:43,782) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991508
[2211374:MainThread](2024-04-23 00:54:43,782) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:54:43,782) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:54:47,508) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:54:47,857) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991177
[2211374:MainThread](2024-04-23 00:54:47,857) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:54:47,857) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:54:51,579) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:54:51,938) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992006
[2211374:MainThread](2024-04-23 00:54:51,939) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:54:51,939) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:54:55,671) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:54:56,029) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991358
[2211374:MainThread](2024-04-23 00:54:56,030) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 00:54:56,030) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:54:59,747) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:55:00,098) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991328
[2211374:MainThread](2024-04-23 00:55:00,098) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-23 00:55:00,099) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:55:03,861) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:55:04,227) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992250
[2211374:MainThread](2024-04-23 00:55:04,228) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-23 00:55:04,228) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:55:07,983) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:55:08,333) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992105
[2211374:MainThread](2024-04-23 00:55:08,333) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:55:08,333) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990540 @ 17
[2211374:MainThread](2024-04-23 00:55:08,385) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-05-29 SH600000   -0.056465
           SH600008    0.039503
           SH600009    0.063899
           SH600010   -0.113439
           SH600011    0.040432
[2211374:MainThread](2024-04-23 00:55:10,130) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  41%|████      | 18/44 [24:44<41:25, 95.58s/it][2211374:MainThread](2024-04-23 00:55:10,140) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:55:10,152) INFO - qlib.workflow - [recorder.py:341] - Recorder 07eb85eb419b408ebfa5ec77e2941d42 starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:55:10,752) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:55:10,753) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:55:10,755) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:55:10,756) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:55:18,376) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.960518
            SH600004      0.960518
            SH600006      0.960518
            SH600007      0.960518
            SH600008      0.960518
                            ...   
2016-08-09  SZ300144      1.894772
            SZ300146      1.894772
            SZ300168      1.894772
            SZ300251      1.894772
            SZ300315      1.894772
Length: 578598, dtype: float64
[2211374:MainThread](2024-04-23 00:55:18,379) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:55:18,379) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:55:18,379) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:55:22,240) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:55:22,561) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995908
[2211374:MainThread](2024-04-23 00:55:22,562) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:55:22,563) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:55:26,323) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:55:26,645) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994834
[2211374:MainThread](2024-04-23 00:55:26,646) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:55:26,647) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:55:30,399) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:55:30,716) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994220
[2211374:MainThread](2024-04-23 00:55:30,717) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:55:30,718) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:55:34,449) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:55:34,783) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994101
[2211374:MainThread](2024-04-23 00:55:34,784) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:55:34,785) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:55:38,523) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:55:38,851) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993378
[2211374:MainThread](2024-04-23 00:55:38,853) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:55:38,853) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:55:42,581) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:55:42,906) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993244
[2211374:MainThread](2024-04-23 00:55:42,907) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:55:42,907) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:55:46,626) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:55:46,955) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992328
[2211374:MainThread](2024-04-23 00:55:46,956) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:55:46,956) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:55:50,745) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:55:51,081) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992935
[2211374:MainThread](2024-04-23 00:55:51,081) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:55:51,082) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:55:54,838) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:55:55,162) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992291
[2211374:MainThread](2024-04-23 00:55:55,163) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:55:55,164) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:55:58,951) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:55:59,280) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991884
[2211374:MainThread](2024-04-23 00:55:59,281) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:55:59,282) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:56:03,072) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:56:03,388) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991823
[2211374:MainThread](2024-04-23 00:56:03,389) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:56:03,389) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:56:07,169) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:56:07,492) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991587
[2211374:MainThread](2024-04-23 00:56:07,493) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:56:07,494) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:56:11,274) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:56:11,610) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991624
[2211374:MainThread](2024-04-23 00:56:11,611) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:56:11,611) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:56:15,383) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:56:15,719) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991604
[2211374:MainThread](2024-04-23 00:56:15,720) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:56:15,720) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:56:19,483) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:56:19,792) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992056
[2211374:MainThread](2024-04-23 00:56:19,792) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:56:19,792) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:56:23,540) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:56:23,861) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990960
[2211374:MainThread](2024-04-23 00:56:23,862) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:56:23,862) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:56:27,612) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:56:27,934) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991086
[2211374:MainThread](2024-04-23 00:56:27,934) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:56:27,934) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:56:31,701) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:56:32,026) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991294
[2211374:MainThread](2024-04-23 00:56:32,027) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:56:32,027) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:56:35,809) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:56:36,145) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991442
[2211374:MainThread](2024-04-23 00:56:36,145) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:56:36,145) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:56:39,914) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:56:40,245) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990986
[2211374:MainThread](2024-04-23 00:56:40,245) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:56:40,246) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:56:44,005) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:56:44,318) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991318
[2211374:MainThread](2024-04-23 00:56:44,318) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:56:44,319) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:56:48,102) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:56:48,429) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991344
[2211374:MainThread](2024-04-23 00:56:48,429) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:56:48,430) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:56:52,221) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:56:52,546) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992126
[2211374:MainThread](2024-04-23 00:56:52,547) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 00:56:52,547) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:56:56,349) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:56:56,671) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992431
[2211374:MainThread](2024-04-23 00:56:56,671) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:56:56,672) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990960 @ 15
[2211374:MainThread](2024-04-23 00:56:56,729) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-06-27 SH600000   -0.007722
           SH600008   -0.027893
           SH600009    0.130155
           SH600010    0.056976
           SH600011   -0.113533
[2211374:MainThread](2024-04-23 00:56:58,502) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  43%|████▎     | 19/44 [26:33<41:25, 99.42s/it][2211374:MainThread](2024-04-23 00:56:58,512) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:56:58,523) INFO - qlib.workflow - [recorder.py:341] - Recorder 42420cd9a28f4d57a17d4ff10dbd59d6 starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:56:59,118) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:56:59,119) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:56:59,122) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:56:59,122) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:57:06,810) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.741805
            SH600004      0.741805
            SH600006      0.741805
            SH600007      0.741805
            SH600008      0.741805
                            ...   
2016-09-06  SZ300144      1.279270
            SZ300146      1.279270
            SZ300168      1.279270
            SZ300251      1.279270
            SZ300315      1.279270
Length: 584401, dtype: float64
[2211374:MainThread](2024-04-23 00:57:06,812) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:57:06,812) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:57:06,813) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:57:10,663) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:57:11,022) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995592
[2211374:MainThread](2024-04-23 00:57:11,023) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:57:11,023) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:57:14,761) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:57:15,119) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994822
[2211374:MainThread](2024-04-23 00:57:15,120) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:57:15,121) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:57:18,940) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:57:19,310) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994819
[2211374:MainThread](2024-04-23 00:57:19,311) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:57:19,311) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:57:23,129) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:57:23,482) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993549
[2211374:MainThread](2024-04-23 00:57:23,483) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:57:23,483) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:57:27,263) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:57:27,621) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993235
[2211374:MainThread](2024-04-23 00:57:27,622) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:57:27,622) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:57:31,379) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:57:31,725) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992553
[2211374:MainThread](2024-04-23 00:57:31,726) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:57:31,727) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:57:35,507) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:57:35,863) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992565
[2211374:MainThread](2024-04-23 00:57:35,863) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:57:35,863) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:57:39,655) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:57:40,023) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992215
[2211374:MainThread](2024-04-23 00:57:40,024) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:57:40,025) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:57:43,837) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:57:44,198) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992031
[2211374:MainThread](2024-04-23 00:57:44,199) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:57:44,199) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:57:48,018) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:57:48,369) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991765
[2211374:MainThread](2024-04-23 00:57:48,370) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:57:48,371) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:57:52,140) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:57:52,498) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992469
[2211374:MainThread](2024-04-23 00:57:52,498) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:57:52,499) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:57:56,263) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:57:56,615) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991371
[2211374:MainThread](2024-04-23 00:57:56,616) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:57:56,617) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:58:00,355) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:58:00,710) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991663
[2211374:MainThread](2024-04-23 00:58:00,710) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:58:00,710) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:58:04,464) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:58:04,819) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992492
[2211374:MainThread](2024-04-23 00:58:04,819) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 00:58:04,820) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:58:08,617) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:58:08,979) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991502
[2211374:MainThread](2024-04-23 00:58:08,980) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 00:58:08,980) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:58:12,783) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:58:13,150) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991662
[2211374:MainThread](2024-04-23 00:58:13,150) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 00:58:13,150) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:58:16,988) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:58:17,344) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991032
[2211374:MainThread](2024-04-23 00:58:17,345) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 00:58:17,345) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:58:21,152) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:58:21,508) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990566
[2211374:MainThread](2024-04-23 00:58:21,509) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 00:58:21,509) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:58:25,324) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:58:25,677) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991607
[2211374:MainThread](2024-04-23 00:58:25,677) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 00:58:25,677) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:58:29,506) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:58:29,854) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991284
[2211374:MainThread](2024-04-23 00:58:29,854) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 00:58:29,854) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:58:33,697) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:58:34,078) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991813
[2211374:MainThread](2024-04-23 00:58:34,078) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 00:58:34,079) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:58:37,898) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:58:38,268) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993334
[2211374:MainThread](2024-04-23 00:58:38,268) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 00:58:38,268) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:58:42,054) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:58:42,409) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991752
[2211374:MainThread](2024-04-23 00:58:42,410) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 00:58:42,410) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:58:46,184) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:58:46,538) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993145
[2211374:MainThread](2024-04-23 00:58:46,538) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[2211374:MainThread](2024-04-23 00:58:46,538) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:58:50,292) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:58:50,673) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991857
[2211374:MainThread](2024-04-23 00:58:50,674) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[2211374:MainThread](2024-04-23 00:58:50,674) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:58:54,451) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:58:54,805) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993568
[2211374:MainThread](2024-04-23 00:58:54,805) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 00:58:54,806) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990566 @ 17
[2211374:MainThread](2024-04-23 00:58:54,861) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-07-25 SH600000    0.029730
           SH600008    0.037739
           SH600009   -0.025847
           SH600010    0.010812
           SH600011   -0.031213
[2211374:MainThread](2024-04-23 00:58:56,618) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  45%|████▌     | 20/44 [28:31<42:00, 105.03s/it][2211374:MainThread](2024-04-23 00:58:56,628) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 00:58:56,640) INFO - qlib.workflow - [recorder.py:341] - Recorder 1f93b9d346f842208233f1fa903fccfe starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 00:58:57,239) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 00:58:57,241) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 00:58:57,244) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 00:58:57,245) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 00:59:05,001) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.364563
            SH600004      1.364563
            SH600006      1.364563
            SH600007      1.364563
            SH600008      1.364563
                            ...   
2016-10-13  SZ300144      0.703691
            SZ300146      0.703691
            SZ300168      0.703691
            SZ300251      0.703691
            SZ300315      0.703691
Length: 590146, dtype: float64
[2211374:MainThread](2024-04-23 00:59:05,004) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 00:59:05,004) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 00:59:05,004) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:59:08,860) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:59:09,187) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996181
[2211374:MainThread](2024-04-23 00:59:09,188) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 00:59:09,189) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:59:13,040) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:59:13,369) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994693
[2211374:MainThread](2024-04-23 00:59:13,370) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 00:59:13,371) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:59:17,217) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:59:17,543) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994314
[2211374:MainThread](2024-04-23 00:59:17,544) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 00:59:17,545) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:59:21,402) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:59:21,717) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993392
[2211374:MainThread](2024-04-23 00:59:21,718) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 00:59:21,718) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:59:25,554) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:59:25,870) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992378
[2211374:MainThread](2024-04-23 00:59:25,872) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 00:59:25,872) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:59:29,707) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:59:30,033) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992497
[2211374:MainThread](2024-04-23 00:59:30,033) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 00:59:30,033) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:59:33,876) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:59:34,217) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991868
[2211374:MainThread](2024-04-23 00:59:34,218) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 00:59:34,218) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:59:38,029) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:59:38,347) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991262
[2211374:MainThread](2024-04-23 00:59:38,348) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 00:59:38,348) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:59:42,146) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:59:42,469) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991597
[2211374:MainThread](2024-04-23 00:59:42,470) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 00:59:42,470) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:59:46,280) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:59:46,615) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991453
[2211374:MainThread](2024-04-23 00:59:46,616) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 00:59:46,616) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:59:50,461) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:59:50,778) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991340
[2211374:MainThread](2024-04-23 00:59:50,779) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 00:59:50,779) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:59:54,635) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:59:54,965) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992197
[2211374:MainThread](2024-04-23 00:59:54,966) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 00:59:54,966) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 00:59:58,805) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 00:59:59,140) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991500
[2211374:MainThread](2024-04-23 00:59:59,140) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 00:59:59,141) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:00:03,019) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:00:03,354) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991165
[2211374:MainThread](2024-04-23 01:00:03,355) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 01:00:03,356) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:00:07,239) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:00:07,563) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990693
[2211374:MainThread](2024-04-23 01:00:07,564) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 01:00:07,564) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:00:11,412) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:00:11,738) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990341
[2211374:MainThread](2024-04-23 01:00:11,739) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 01:00:11,740) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:00:15,591) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:00:15,939) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991508
[2211374:MainThread](2024-04-23 01:00:15,939) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 01:00:15,940) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:00:19,766) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:00:20,117) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991350
[2211374:MainThread](2024-04-23 01:00:20,117) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 01:00:20,118) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:00:24,289) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:00:24,617) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991619
[2211374:MainThread](2024-04-23 01:00:24,617) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 01:00:24,618) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:00:28,433) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:00:28,764) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991491
[2211374:MainThread](2024-04-23 01:00:28,765) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 01:00:28,765) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:00:32,386) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:00:32,723) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991493
[2211374:MainThread](2024-04-23 01:00:32,723) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 01:00:32,724) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:00:36,598) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:00:36,935) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992870
[2211374:MainThread](2024-04-23 01:00:36,935) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 01:00:36,935) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:00:40,788) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:00:41,120) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991809
[2211374:MainThread](2024-04-23 01:00:41,120) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[2211374:MainThread](2024-04-23 01:00:41,121) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:00:44,962) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:00:45,296) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991601
[2211374:MainThread](2024-04-23 01:00:45,296) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 01:00:45,297) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990341 @ 15
[2211374:MainThread](2024-04-23 01:00:45,632) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-08-22 SH600000   -0.023983
           SH600008   -0.092895
           SH600009    0.121276
           SH600010   -0.036002
           SH600011   -0.081722
[2211374:MainThread](2024-04-23 01:00:47,416) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  48%|████▊     | 21/44 [30:22<40:55, 106.76s/it][2211374:MainThread](2024-04-23 01:00:47,426) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 01:00:47,438) INFO - qlib.workflow - [recorder.py:341] - Recorder 5f6b938f0eb343b3b78b877cf7cc4e83 starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 01:00:48,046) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 01:00:48,047) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 01:00:48,050) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 01:00:48,051) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 01:00:55,895) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.264023
            SH600004      1.264023
            SH600006      1.264023
            SH600007      1.264023
            SH600008      1.264023
                            ...   
2016-11-10  SZ300144      1.076348
            SZ300146      1.076348
            SZ300168      1.076348
            SZ300251      1.076348
            SZ300315      1.076348
Length: 595946, dtype: float64
[2211374:MainThread](2024-04-23 01:00:55,897) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 01:00:55,898) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 01:00:55,898) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:00:59,600) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:00:59,957) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995094
[2211374:MainThread](2024-04-23 01:00:59,958) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 01:00:59,959) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:01:03,783) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:01:04,118) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994511
[2211374:MainThread](2024-04-23 01:01:04,119) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 01:01:04,119) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:01:07,950) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:01:08,299) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993232
[2211374:MainThread](2024-04-23 01:01:08,300) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 01:01:08,301) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:01:12,089) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:01:12,439) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992535
[2211374:MainThread](2024-04-23 01:01:12,440) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 01:01:12,441) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:01:16,201) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:01:16,445) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992474
[2211374:MainThread](2024-04-23 01:01:16,446) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 01:01:16,447) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:01:19,993) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:01:20,248) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991690
[2211374:MainThread](2024-04-23 01:01:20,249) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 01:01:20,250) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:01:23,213) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:01:23,444) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992046
[2211374:MainThread](2024-04-23 01:01:23,444) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 01:01:23,445) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:01:26,437) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:01:26,670) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991342
[2211374:MainThread](2024-04-23 01:01:26,671) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 01:01:26,671) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:01:29,764) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:01:30,022) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991189
[2211374:MainThread](2024-04-23 01:01:30,023) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 01:01:30,023) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:01:32,957) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:01:33,191) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991538
[2211374:MainThread](2024-04-23 01:01:33,191) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 01:01:33,192) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:01:36,153) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:01:36,393) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991483
[2211374:MainThread](2024-04-23 01:01:36,394) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 01:01:36,394) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:01:39,854) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:01:40,194) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991384
[2211374:MainThread](2024-04-23 01:01:40,194) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 01:01:40,194) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:01:43,899) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:01:44,239) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.989988
[2211374:MainThread](2024-04-23 01:01:44,240) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 01:01:44,241) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:01:47,948) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:01:48,283) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990973
[2211374:MainThread](2024-04-23 01:01:48,283) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 01:01:48,284) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:01:52,003) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:01:52,345) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990395
[2211374:MainThread](2024-04-23 01:01:52,345) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 01:01:52,346) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:01:56,123) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:01:56,459) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991055
[2211374:MainThread](2024-04-23 01:01:56,459) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 01:01:56,459) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:02:00,189) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:02:00,525) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990708
[2211374:MainThread](2024-04-23 01:02:00,525) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 01:02:00,526) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:02:04,309) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:02:04,655) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991988
[2211374:MainThread](2024-04-23 01:02:04,655) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 01:02:04,656) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:02:08,430) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:02:08,781) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991394
[2211374:MainThread](2024-04-23 01:02:08,781) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 01:02:08,782) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:02:12,573) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:02:12,915) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991120
[2211374:MainThread](2024-04-23 01:02:12,916) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 01:02:12,916) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:02:16,724) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:02:17,069) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991370
[2211374:MainThread](2024-04-23 01:02:17,070) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 01:02:17,070) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.989988 @ 12
[2211374:MainThread](2024-04-23 01:02:17,125) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-09-19 SH600000    0.002508
           SH600008    0.012616
           SH600009   -0.030157
           SH600010   -0.005117
           SH600011    0.076702
[2211374:MainThread](2024-04-23 01:02:18,919) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  50%|█████     | 22/44 [31:53<37:28, 102.18s/it][2211374:MainThread](2024-04-23 01:02:18,929) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 01:02:18,941) INFO - qlib.workflow - [recorder.py:341] - Recorder cbe6fc922bf244da9bb2c4f207d923b2 starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 01:02:19,533) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 01:02:19,533) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 01:02:19,537) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 01:02:19,538) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 01:02:27,350) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.957770
            SH600004      0.957770
            SH600006      0.957770
            SH600007      0.957770
            SH600008      0.957770
                            ...   
2016-12-08  SZ300144      1.834512
            SZ300146      1.834512
            SZ300168      1.834512
            SZ300251      1.834512
            SZ300315      1.834512
Length: 601711, dtype: float64
[2211374:MainThread](2024-04-23 01:02:27,352) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 01:02:27,353) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 01:02:27,353) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:02:31,186) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:02:31,522) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995739
[2211374:MainThread](2024-04-23 01:02:31,523) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 01:02:31,523) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:02:35,399) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:02:35,745) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994397
[2211374:MainThread](2024-04-23 01:02:35,746) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 01:02:35,746) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:02:39,608) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:02:39,960) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994229
[2211374:MainThread](2024-04-23 01:02:39,961) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 01:02:39,961) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:02:43,767) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:02:44,110) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993375
[2211374:MainThread](2024-04-23 01:02:44,111) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 01:02:44,111) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:02:47,957) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:02:48,304) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992756
[2211374:MainThread](2024-04-23 01:02:48,305) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 01:02:48,305) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:02:52,170) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:02:52,520) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992748
[2211374:MainThread](2024-04-23 01:02:52,521) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 01:02:52,521) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:02:56,356) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:02:56,707) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991544
[2211374:MainThread](2024-04-23 01:02:56,708) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 01:02:56,708) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:03:00,551) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:03:00,890) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992047
[2211374:MainThread](2024-04-23 01:03:00,891) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 01:03:00,891) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:03:04,753) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:03:05,100) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992033
[2211374:MainThread](2024-04-23 01:03:05,101) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 01:03:05,101) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:03:08,941) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:03:09,287) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991368
[2211374:MainThread](2024-04-23 01:03:09,289) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 01:03:09,289) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:03:13,138) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:03:13,483) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992736
[2211374:MainThread](2024-04-23 01:03:13,483) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 01:03:13,484) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:03:17,365) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:03:17,711) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991127
[2211374:MainThread](2024-04-23 01:03:17,712) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 01:03:17,713) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:03:21,599) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:03:21,935) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991345
[2211374:MainThread](2024-04-23 01:03:21,936) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 01:03:21,936) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:03:25,797) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:03:26,143) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991245
[2211374:MainThread](2024-04-23 01:03:26,143) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 01:03:26,143) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:03:29,978) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:03:30,321) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991890
[2211374:MainThread](2024-04-23 01:03:30,322) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 01:03:30,322) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:03:34,168) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:03:34,515) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991175
[2211374:MainThread](2024-04-23 01:03:34,515) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 01:03:34,515) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:03:38,334) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:03:38,685) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991174
[2211374:MainThread](2024-04-23 01:03:38,685) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 01:03:38,685) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:03:42,538) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:03:42,882) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992717
[2211374:MainThread](2024-04-23 01:03:42,882) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 01:03:42,883) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:03:46,761) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:03:47,098) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991835
[2211374:MainThread](2024-04-23 01:03:47,098) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 01:03:47,099) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:03:50,988) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:03:51,326) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992400
[2211374:MainThread](2024-04-23 01:03:51,327) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 01:03:51,327) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991127 @ 11
[2211374:MainThread](2024-04-23 01:03:51,380) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-10-25 SH600000   -0.099074
           SH600008    0.087983
           SH600009   -0.169623
           SH600010   -0.011077
           SH600011   -0.004702
[2211374:MainThread](2024-04-23 01:03:53,164) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  52%|█████▏    | 23/44 [33:27<34:55, 99.80s/it] [2211374:MainThread](2024-04-23 01:03:53,174) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 01:03:53,186) INFO - qlib.workflow - [recorder.py:341] - Recorder 8f40b75e599f4688b958b15307b4fdc2 starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 01:03:53,797) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 01:03:53,799) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 01:03:53,802) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 01:03:53,803) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 01:04:01,845) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.763289
            SH600004      1.763289
            SH600006      1.763289
            SH600007      1.763289
            SH600008      1.763289
                            ...   
2017-01-06  SZ300146      1.662444
            SZ300168      1.662444
            SZ300182      1.662444
            SZ300251      1.662444
            SZ300315      1.662444
Length: 607469, dtype: float64
[2211374:MainThread](2024-04-23 01:04:01,847) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 01:04:01,848) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 01:04:01,848) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:04:05,674) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:04:06,017) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996059
[2211374:MainThread](2024-04-23 01:04:06,018) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 01:04:06,019) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:04:09,922) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:04:10,267) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995719
[2211374:MainThread](2024-04-23 01:04:10,268) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 01:04:10,268) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:04:14,183) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:04:14,527) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994066
[2211374:MainThread](2024-04-23 01:04:14,528) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 01:04:14,529) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:04:18,432) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:04:18,774) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992896
[2211374:MainThread](2024-04-23 01:04:18,775) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 01:04:18,775) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:04:22,714) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:04:23,056) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992825
[2211374:MainThread](2024-04-23 01:04:23,057) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 01:04:23,057) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:04:26,974) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:04:27,311) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991956
[2211374:MainThread](2024-04-23 01:04:27,312) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 01:04:27,313) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:04:31,218) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:04:31,560) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993259
[2211374:MainThread](2024-04-23 01:04:31,561) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 01:04:31,561) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:04:35,476) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:04:35,813) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992282
[2211374:MainThread](2024-04-23 01:04:35,813) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 01:04:35,814) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:04:39,732) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:04:40,092) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991054
[2211374:MainThread](2024-04-23 01:04:40,093) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 01:04:40,093) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:04:43,965) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:04:44,308) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992179
[2211374:MainThread](2024-04-23 01:04:44,308) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 01:04:44,309) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:04:48,188) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:04:48,523) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992113
[2211374:MainThread](2024-04-23 01:04:48,523) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 01:04:48,524) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:04:52,407) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:04:52,750) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991286
[2211374:MainThread](2024-04-23 01:04:52,750) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 01:04:52,751) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:04:56,652) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:04:57,002) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991043
[2211374:MainThread](2024-04-23 01:04:57,003) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 01:04:57,003) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:05:00,886) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:05:01,224) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991720
[2211374:MainThread](2024-04-23 01:05:01,224) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 01:05:01,224) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:05:05,120) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:05:05,468) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990701
[2211374:MainThread](2024-04-23 01:05:05,469) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 01:05:05,470) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:05:09,392) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:05:09,734) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991785
[2211374:MainThread](2024-04-23 01:05:09,734) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 01:05:09,734) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:05:13,674) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:05:14,016) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991032
[2211374:MainThread](2024-04-23 01:05:14,016) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 01:05:14,017) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:05:17,974) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:05:18,311) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992393
[2211374:MainThread](2024-04-23 01:05:18,311) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[2211374:MainThread](2024-04-23 01:05:18,311) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:05:22,264) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:05:22,603) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991697
[2211374:MainThread](2024-04-23 01:05:22,604) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[2211374:MainThread](2024-04-23 01:05:22,604) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:05:26,541) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:05:26,876) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992664
[2211374:MainThread](2024-04-23 01:05:26,877) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[2211374:MainThread](2024-04-23 01:05:26,877) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:05:30,798) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:05:31,140) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991306
[2211374:MainThread](2024-04-23 01:05:31,141) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[2211374:MainThread](2024-04-23 01:05:31,141) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:05:35,047) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:05:35,391) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991534
[2211374:MainThread](2024-04-23 01:05:35,391) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[2211374:MainThread](2024-04-23 01:05:35,391) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:05:39,293) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:05:39,635) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992715
[2211374:MainThread](2024-04-23 01:05:39,636) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 01:05:39,636) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990701 @ 14
[2211374:MainThread](2024-04-23 01:05:39,692) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-11-22 SH600000    0.028523
           SH600008   -0.338408
           SH600009   -0.068021
           SH600010    0.029712
           SH600011    0.060172
[2211374:MainThread](2024-04-23 01:05:41,473) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  55%|█████▍    | 24/44 [35:16<34:07, 102.35s/it][2211374:MainThread](2024-04-23 01:05:41,483) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 01:05:41,494) INFO - qlib.workflow - [recorder.py:341] - Recorder 129a624243d04b91b206e91c7a583967 starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 01:05:42,194) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 01:05:42,194) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 01:05:42,197) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 01:05:42,197) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 01:05:50,402) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.52268
            SH600004      1.52268
            SH600006      1.52268
            SH600007      1.52268
            SH600008      1.52268
                           ...   
2017-02-10  SZ300144      1.76258
            SZ300146      1.76258
            SZ300168      1.76258
            SZ300182      1.76258
            SZ300251      1.76258
Length: 613211, dtype: float64
[2211374:MainThread](2024-04-23 01:05:50,405) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 01:05:50,405) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 01:05:50,405) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:05:53,478) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:05:53,718) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995359
[2211374:MainThread](2024-04-23 01:05:53,719) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 01:05:53,720) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:05:56,871) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:05:57,110) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994946
[2211374:MainThread](2024-04-23 01:05:57,112) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 01:05:57,112) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:06:00,374) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:06:00,605) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993758
[2211374:MainThread](2024-04-23 01:06:00,606) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 01:06:00,607) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:06:03,687) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:06:03,935) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992413
[2211374:MainThread](2024-04-23 01:06:03,936) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 01:06:03,936) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:06:07,649) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:06:07,996) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992654
[2211374:MainThread](2024-04-23 01:06:07,997) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 01:06:07,997) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:06:11,744) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:06:12,093) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992242
[2211374:MainThread](2024-04-23 01:06:12,094) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 01:06:12,095) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:06:15,865) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:06:16,209) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991981
[2211374:MainThread](2024-04-23 01:06:16,210) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 01:06:16,211) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:06:19,995) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:06:20,341) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992031
[2211374:MainThread](2024-04-23 01:06:20,342) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 01:06:20,342) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:06:24,179) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:06:24,515) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991595
[2211374:MainThread](2024-04-23 01:06:24,516) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 01:06:24,517) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:06:28,366) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:06:28,716) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990750
[2211374:MainThread](2024-04-23 01:06:28,717) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 01:06:28,718) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:06:32,589) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:06:32,926) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992090
[2211374:MainThread](2024-04-23 01:06:32,926) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 01:06:32,927) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:06:36,824) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:06:37,163) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991700
[2211374:MainThread](2024-04-23 01:06:37,163) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 01:06:37,163) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:06:41,084) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:06:41,430) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991537
[2211374:MainThread](2024-04-23 01:06:41,431) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 01:06:41,431) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:06:45,345) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:06:45,680) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991595
[2211374:MainThread](2024-04-23 01:06:45,681) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[2211374:MainThread](2024-04-23 01:06:45,681) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:06:49,562) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:06:49,911) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991748
[2211374:MainThread](2024-04-23 01:06:49,911) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[2211374:MainThread](2024-04-23 01:06:49,912) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:06:53,769) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:06:54,117) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991278
[2211374:MainThread](2024-04-23 01:06:54,118) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[2211374:MainThread](2024-04-23 01:06:54,118) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:06:58,045) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:06:58,387) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992732
[2211374:MainThread](2024-04-23 01:06:58,388) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[2211374:MainThread](2024-04-23 01:06:58,388) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:07:02,321) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:07:02,667) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992303
[2211374:MainThread](2024-04-23 01:07:02,667) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[2211374:MainThread](2024-04-23 01:07:02,668) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990750 @ 9
[2211374:MainThread](2024-04-23 01:07:02,912) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-12-20 SH600000    0.002294
           SH600004   -0.062353
           SH600009   -0.000534
           SH600010   -0.076482
           SH600011   -0.077180
[2211374:MainThread](2024-04-23 01:07:04,708) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  57%|█████▋    | 25/44 [36:39<30:35, 96.62s/it] [2211374:MainThread](2024-04-23 01:07:04,718) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[2211374:MainThread](2024-04-23 01:07:04,729) INFO - qlib.workflow - [recorder.py:341] - Recorder 88945c5a683b4d54836d4f9ec3ee4ee0 starts running under Experiment 17 ...
[2211374:MainThread](2024-04-23 01:07:05,352) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2211374:MainThread](2024-04-23 01:07:05,353) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2211374:MainThread](2024-04-23 01:07:05,356) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2211374:MainThread](2024-04-23 01:07:05,357) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[2211374:MainThread](2024-04-23 01:07:13,106) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.523603
            SH600004      1.523603
            SH600006      1.523603
            SH600007      1.523603
            SH600008      1.523603
                            ...   
2017-03-10  SZ300144      1.973320
            SZ300146      1.973320
            SZ300168      1.973320
            SZ300182      1.973320
            SZ300251      1.973320
Length: 618892, dtype: float64
[2211374:MainThread](2024-04-23 01:07:13,108) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[2211374:MainThread](2024-04-23 01:07:13,109) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[2211374:MainThread](2024-04-23 01:07:13,109) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:07:17,228) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:07:17,576) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996016
[2211374:MainThread](2024-04-23 01:07:17,577) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[2211374:MainThread](2024-04-23 01:07:17,578) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:07:21,443) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:07:21,798) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994494
[2211374:MainThread](2024-04-23 01:07:21,799) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[2211374:MainThread](2024-04-23 01:07:21,799) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:07:25,737) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:07:26,078) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994174
[2211374:MainThread](2024-04-23 01:07:26,079) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[2211374:MainThread](2024-04-23 01:07:26,080) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:07:29,632) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:07:29,862) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993415
[2211374:MainThread](2024-04-23 01:07:29,863) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[2211374:MainThread](2024-04-23 01:07:29,863) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:07:32,962) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:07:33,199) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993063
[2211374:MainThread](2024-04-23 01:07:33,200) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[2211374:MainThread](2024-04-23 01:07:33,201) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:07:36,195) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:07:36,424) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993250
[2211374:MainThread](2024-04-23 01:07:36,425) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[2211374:MainThread](2024-04-23 01:07:36,425) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:07:39,382) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:07:39,611) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993472
[2211374:MainThread](2024-04-23 01:07:39,611) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[2211374:MainThread](2024-04-23 01:07:39,612) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:07:42,553) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:07:42,784) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991954
[2211374:MainThread](2024-04-23 01:07:42,785) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[2211374:MainThread](2024-04-23 01:07:42,785) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:07:46,270) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:07:46,657) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992860
[2211374:MainThread](2024-04-23 01:07:46,657) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[2211374:MainThread](2024-04-23 01:07:46,658) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:07:50,705) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:07:51,093) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992854
[2211374:MainThread](2024-04-23 01:07:51,093) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[2211374:MainThread](2024-04-23 01:07:51,093) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:07:55,335) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:07:55,722) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991530
[2211374:MainThread](2024-04-23 01:07:55,723) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[2211374:MainThread](2024-04-23 01:07:55,724) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:07:59,931) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:08:00,312) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992430
[2211374:MainThread](2024-04-23 01:08:00,313) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[2211374:MainThread](2024-04-23 01:08:00,313) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[2211374:MainThread](2024-04-23 01:08:04,510) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[2211374:MainThread](2024-04-23 01:08:04,891) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992144
[2211374:MainThread](2024-04-23 01:08:04,892) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[2211374:MainThread](2024-04-23 01:08:04,892) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
Killed

2024-04-25 18:17:29.894 | WARNING  | qlib.tests.data:qlib_data:175 - Data already exists: ~/.qlib/qlib_data/cn_data, the data download will be skipped
	If downloading is required: `exists_skip=False` or `change target_dir`
[3380957:MainThread](2024-04-25 18:17:29,903) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[3380957:MainThread](2024-04-25 18:17:29,906) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[3380957:MainThread](2024-04-25 18:17:29,906) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/cn_data')}
Remove CSRankNorm
{'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': datetime.date(2008, 1, 1), 'end_time': datetime.date(2020, 8, 1), 'fit_start_time': datetime.date(2008, 1, 1), 'fit_end_time': datetime.date(2014, 12, 31), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
[3380957:MainThread](2024-04-25 18:17:30,085) INFO - qlib.RollingBenchmark - [rolling_benchmark.py:208] - {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 5000, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/baseline/cn_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': [datetime.date(2008, 1, 1), datetime.date(2014, 12, 31)], 'valid': [datetime.date(2015, 1, 1), datetime.date(2016, 12, 31)], 'test': [datetime.date(2017, 1, 1), datetime.date(2020, 8, 1)]}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
[3380957:MainThread](2024-04-25 18:17:30,087) WARNING - qlib.data - [data.py:666] - load calendar error: freq=day, future=True; return current calendar!
[3380957:MainThread](2024-04-25 18:17:30,087) WARNING - qlib.data - [data.py:669] - You can get future calendar by referring to the following document: https://github.com/microsoft/qlib/blob/main/scripts/data_collector/contrib/README.md
[3380957:MainThread](2024-04-25 18:17:30,141) INFO - qlib.MetaDatasetDS - [dataset.py:316] - Example task for training meta model: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 5000, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/baseline/cn_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-02 00:00:00'), Timestamp('2014-12-31 00:00:00')), 'valid': (Timestamp('2015-01-05 00:00:00'), Timestamp('2016-12-29 00:00:00')), 'test': (Timestamp('2017-01-03 00:00:00'), Timestamp('2017-02-06 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/44 [00:00<?, ?it/s]creating meta tasks:   2%|▏         | 1/44 [00:00<00:17,  2.43it/s]creating meta tasks:   5%|▍         | 2/44 [00:00<00:17,  2.36it/s]creating meta tasks:   7%|▋         | 3/44 [00:01<00:17,  2.34it/s]creating meta tasks:   9%|▉         | 4/44 [00:01<00:17,  2.34it/s]creating meta tasks:  11%|█▏        | 5/44 [00:02<00:16,  2.30it/s]creating meta tasks:  14%|█▎        | 6/44 [00:02<00:17,  2.15it/s]creating meta tasks:  16%|█▌        | 7/44 [00:03<00:16,  2.19it/s]creating meta tasks:  18%|█▊        | 8/44 [00:03<00:16,  2.20it/s]creating meta tasks:  20%|██        | 9/44 [00:03<00:15,  2.25it/s]creating meta tasks:  23%|██▎       | 10/44 [00:04<00:15,  2.23it/s]creating meta tasks:  25%|██▌       | 11/44 [00:04<00:14,  2.21it/s]creating meta tasks:  27%|██▋       | 12/44 [00:05<00:14,  2.19it/s]creating meta tasks:  30%|██▉       | 13/44 [00:05<00:14,  2.18it/s]creating meta tasks:  32%|███▏      | 14/44 [00:06<00:13,  2.17it/s]creating meta tasks:  34%|███▍      | 15/44 [00:06<00:13,  2.16it/s]creating meta tasks:  36%|███▋      | 16/44 [00:07<00:13,  2.15it/s]creating meta tasks:  39%|███▊      | 17/44 [00:07<00:12,  2.15it/s]creating meta tasks:  41%|████      | 18/44 [00:08<00:12,  2.14it/s]creating meta tasks:  43%|████▎     | 19/44 [00:08<00:11,  2.13it/s]creating meta tasks:  45%|████▌     | 20/44 [00:09<00:11,  2.13it/s]creating meta tasks:  48%|████▊     | 21/44 [00:09<00:10,  2.12it/s]creating meta tasks:  50%|█████     | 22/44 [00:10<00:10,  2.12it/s]creating meta tasks:  52%|█████▏    | 23/44 [00:10<00:09,  2.11it/s]creating meta tasks:  55%|█████▍    | 24/44 [00:11<00:09,  2.10it/s]creating meta tasks:  57%|█████▋    | 25/44 [00:11<00:09,  2.10it/s]creating meta tasks:  59%|█████▉    | 26/44 [00:11<00:08,  2.10it/s]creating meta tasks:  61%|██████▏   | 27/44 [00:12<00:08,  2.09it/s]creating meta tasks:  64%|██████▎   | 28/44 [00:12<00:07,  2.09it/s]creating meta tasks:  66%|██████▌   | 29/44 [00:13<00:07,  2.08it/s]creating meta tasks:  68%|██████▊   | 30/44 [00:13<00:06,  2.07it/s]creating meta tasks:  70%|███████   | 31/44 [00:14<00:06,  2.07it/s]creating meta tasks:  73%|███████▎  | 32/44 [00:14<00:05,  2.06it/s]creating meta tasks:  75%|███████▌  | 33/44 [00:15<00:05,  2.05it/s]creating meta tasks:  77%|███████▋  | 34/44 [00:15<00:04,  2.05it/s]creating meta tasks:  80%|███████▉  | 35/44 [00:16<00:04,  2.04it/s]creating meta tasks:  82%|████████▏ | 36/44 [00:16<00:03,  2.04it/s]creating meta tasks:  84%|████████▍ | 37/44 [00:17<00:03,  2.03it/s]creating meta tasks:  86%|████████▋ | 38/44 [00:17<00:02,  2.03it/s]creating meta tasks:  89%|████████▊ | 39/44 [00:18<00:02,  2.02it/s]creating meta tasks:  91%|█████████ | 40/44 [00:18<00:01,  2.01it/s]creating meta tasks:  93%|█████████▎| 41/44 [00:19<00:01,  2.01it/s]creating meta tasks:  95%|█████████▌| 42/44 [00:19<00:00,  2.00it/s]creating meta tasks:  98%|█████████▊| 43/44 [00:20<00:00,  2.00it/s]creating meta tasks: 100%|██████████| 44/44 [00:20<00:00,  1.99it/s]creating meta tasks: 100%|██████████| 44/44 [00:20<00:00,  2.11it/s]
train tasks:   0%|          | 0/44 [00:00<?, ?it/s][3380957:MainThread](2024-04-25 18:17:51,345) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name rolling_cn_data_csi300_GRU_alpha360_h1_step20_rankFalse_2024-04-25_18:17:51_DDG-DA.
[3380957:MainThread](2024-04-25 18:17:51,359) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:17:52,132) INFO - qlib.workflow - [recorder.py:341] - Recorder 2bdfaa9422f948288568358c5721930e starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:17:55,041) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:17:55,265) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:17:55,267) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:17:55,267) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:18:14,765) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.531170
            SH600004      0.531170
            SH600006      0.531170
            SH600007      0.531170
            SH600008      0.531170
                            ...   
2014-12-31  SZ300070      1.926194
            SZ300124      1.926194
            SZ300133      1.926194
            SZ300146      1.926194
            SZ300251      1.926194
Length: 478007, dtype: float64
[3380957:MainThread](2024-04-25 18:18:14,767) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:18:14,768) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:18:14,768) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:18:17,489) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:18:17,710) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994998
[3380957:MainThread](2024-04-25 18:18:17,711) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:18:17,711) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:18:19,954) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:18:20,175) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995443
[3380957:MainThread](2024-04-25 18:18:20,175) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:18:20,175) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:18:22,444) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:18:22,664) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995178
[3380957:MainThread](2024-04-25 18:18:22,664) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:18:22,664) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:18:24,928) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:18:25,147) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994440
[3380957:MainThread](2024-04-25 18:18:25,148) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:18:25,149) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:18:27,422) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:18:27,642) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994104
[3380957:MainThread](2024-04-25 18:18:27,643) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:18:27,643) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:18:29,909) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:18:30,129) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994704
[3380957:MainThread](2024-04-25 18:18:30,129) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:18:30,129) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:18:32,396) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:18:32,616) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994970
[3380957:MainThread](2024-04-25 18:18:32,617) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:18:32,617) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:18:34,884) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:18:35,104) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994371
[3380957:MainThread](2024-04-25 18:18:35,104) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:18:35,105) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:18:37,376) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:18:37,596) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994428
[3380957:MainThread](2024-04-25 18:18:37,596) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:18:37,597) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:18:39,887) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:18:40,109) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994726
[3380957:MainThread](2024-04-25 18:18:40,109) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:18:40,110) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:18:42,364) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:18:42,585) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993531
[3380957:MainThread](2024-04-25 18:18:42,586) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:18:42,586) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:18:44,803) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:18:45,024) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993688
[3380957:MainThread](2024-04-25 18:18:45,025) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:18:45,025) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:18:47,250) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:18:47,471) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992599
[3380957:MainThread](2024-04-25 18:18:47,472) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:18:47,472) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:18:49,694) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:18:49,915) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992424
[3380957:MainThread](2024-04-25 18:18:49,916) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:18:49,917) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:18:52,143) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:18:52,364) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993024
[3380957:MainThread](2024-04-25 18:18:52,364) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:18:52,365) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:18:54,578) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:18:54,799) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992793
[3380957:MainThread](2024-04-25 18:18:54,799) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:18:54,800) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:18:57,012) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:18:57,233) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993391
[3380957:MainThread](2024-04-25 18:18:57,233) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:18:57,233) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:18:59,456) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:18:59,677) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993695
[3380957:MainThread](2024-04-25 18:18:59,677) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:18:59,678) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:19:01,898) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:19:02,120) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994944
[3380957:MainThread](2024-04-25 18:19:02,120) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:19:02,120) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:19:04,338) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:19:04,560) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994263
[3380957:MainThread](2024-04-25 18:19:04,560) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:19:04,560) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:19:06,795) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:19:07,016) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994016
[3380957:MainThread](2024-04-25 18:19:07,017) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:19:07,017) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:19:09,261) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:19:09,483) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994510
[3380957:MainThread](2024-04-25 18:19:09,483) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:19:09,484) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992424 @ 13
[3380957:MainThread](2024-04-25 18:19:09,632) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-01-03 SH600000   -0.012507
           SH600008    0.027396
           SH600009    0.064809
           SH600010   -0.018968
           SH600015   -0.021878
[3380957:MainThread](2024-04-25 18:19:11,036) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   2%|▏         | 1/44 [01:19<57:07, 79.70s/it][3380957:MainThread](2024-04-25 18:19:11,043) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:19:11,052) INFO - qlib.workflow - [recorder.py:341] - Recorder 1a12943b1c5440c58151d36c8aee40fa starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:19:11,808) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:19:11,809) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:19:11,812) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:19:11,813) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:19:19,679) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.540694
            SH600004      0.540694
            SH600006      0.540694
            SH600007      0.540694
            SH600008      0.540694
                            ...   
2015-01-30  SZ300070      1.993659
            SZ300124      1.993659
            SZ300133      1.993659
            SZ300146      1.993659
            SZ300251      1.993659
Length: 483831, dtype: float64
[3380957:MainThread](2024-04-25 18:19:19,708) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:19:19,708) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:19:19,708) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:19:22,122) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:19:22,345) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995726
[3380957:MainThread](2024-04-25 18:19:22,347) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:19:22,347) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:19:24,630) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:19:24,854) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995340
[3380957:MainThread](2024-04-25 18:19:24,855) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:19:24,855) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:19:27,120) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:19:27,345) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994508
[3380957:MainThread](2024-04-25 18:19:27,346) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:19:27,346) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:19:29,603) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:19:29,831) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994028
[3380957:MainThread](2024-04-25 18:19:29,832) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:19:29,832) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:19:32,096) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:19:32,321) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993811
[3380957:MainThread](2024-04-25 18:19:32,322) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:19:32,322) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:19:34,576) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:19:34,800) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993826
[3380957:MainThread](2024-04-25 18:19:34,800) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:19:34,800) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:19:37,062) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:19:37,290) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993505
[3380957:MainThread](2024-04-25 18:19:37,291) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:19:37,292) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:19:39,557) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:19:39,781) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994050
[3380957:MainThread](2024-04-25 18:19:39,782) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:19:39,782) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:19:42,060) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:19:42,288) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994176
[3380957:MainThread](2024-04-25 18:19:42,288) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:19:42,288) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:19:44,568) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:19:44,797) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994696
[3380957:MainThread](2024-04-25 18:19:44,797) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:19:44,797) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:19:47,074) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:19:47,303) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994613
[3380957:MainThread](2024-04-25 18:19:47,303) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:19:47,303) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:19:49,552) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:19:49,780) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993845
[3380957:MainThread](2024-04-25 18:19:49,781) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:19:49,781) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:19:52,008) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:19:52,237) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994410
[3380957:MainThread](2024-04-25 18:19:52,237) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:19:52,238) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:19:54,489) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:19:54,714) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994799
[3380957:MainThread](2024-04-25 18:19:54,714) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:19:54,714) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:19:56,974) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:19:57,202) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994552
[3380957:MainThread](2024-04-25 18:19:57,202) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:19:57,203) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993505 @ 6
[3380957:MainThread](2024-04-25 18:19:57,339) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-02-07 SH600000    0.028848
           SH600008    0.040573
           SH600009    0.016871
           SH600010   -0.057035
           SH600015    0.026850
[3380957:MainThread](2024-04-25 18:19:59,092) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   5%|▍         | 2/44 [02:07<42:45, 61.09s/it][3380957:MainThread](2024-04-25 18:19:59,099) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:19:59,108) INFO - qlib.workflow - [recorder.py:341] - Recorder 293a6c7b779b4c838dabd9bd7db1fc29 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:19:59,806) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:19:59,807) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:19:59,809) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:19:59,809) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:20:07,412) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.632694
            SH600004      0.632694
            SH600006      0.632694
            SH600007      0.632694
            SH600008      0.632694
                            ...   
2015-03-06  SZ300070      1.926944
            SZ300124      1.926944
            SZ300133      1.926944
            SZ300146      1.926944
            SZ300251      1.926944
Length: 489365, dtype: float64
[3380957:MainThread](2024-04-25 18:20:07,414) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:20:07,415) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:20:07,415) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:20:09,687) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:20:09,911) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995621
[3380957:MainThread](2024-04-25 18:20:09,912) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:20:09,913) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:20:12,175) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:20:12,399) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994985
[3380957:MainThread](2024-04-25 18:20:12,400) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:20:12,400) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:20:14,665) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:20:14,890) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995563
[3380957:MainThread](2024-04-25 18:20:14,890) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:20:14,891) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:20:17,158) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:20:17,381) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994570
[3380957:MainThread](2024-04-25 18:20:17,382) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:20:17,382) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:20:19,654) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:20:19,879) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994675
[3380957:MainThread](2024-04-25 18:20:19,879) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:20:19,879) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:20:22,166) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:20:22,390) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994451
[3380957:MainThread](2024-04-25 18:20:22,391) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:20:22,392) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:20:24,662) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:20:24,886) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996021
[3380957:MainThread](2024-04-25 18:20:24,886) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:20:24,887) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:20:27,155) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:20:27,379) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993823
[3380957:MainThread](2024-04-25 18:20:27,380) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:20:27,381) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:20:29,654) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:20:29,878) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994629
[3380957:MainThread](2024-04-25 18:20:29,879) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:20:29,879) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:20:32,155) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:20:32,383) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993435
[3380957:MainThread](2024-04-25 18:20:32,384) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:20:32,384) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:20:34,676) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:20:34,904) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993695
[3380957:MainThread](2024-04-25 18:20:34,904) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:20:34,904) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:20:37,198) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:20:37,425) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994751
[3380957:MainThread](2024-04-25 18:20:37,426) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:20:37,426) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:20:39,685) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:20:39,909) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993477
[3380957:MainThread](2024-04-25 18:20:39,910) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:20:39,910) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:20:42,179) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:20:42,403) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995965
[3380957:MainThread](2024-04-25 18:20:42,404) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:20:42,404) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:20:44,668) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:20:44,895) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994602
[3380957:MainThread](2024-04-25 18:20:44,895) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:20:44,895) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:20:47,132) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:20:47,356) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995757
[3380957:MainThread](2024-04-25 18:20:47,357) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:20:47,357) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:20:49,618) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:20:49,844) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994334
[3380957:MainThread](2024-04-25 18:20:49,844) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:20:49,845) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:20:52,192) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:20:52,419) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994351
[3380957:MainThread](2024-04-25 18:20:52,420) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:20:52,420) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993435 @ 9
[3380957:MainThread](2024-04-25 18:20:52,469) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-03-07 SH600000    0.011569
           SH600008    0.002049
           SH600009    0.035796
           SH600010    0.024599
           SH600015    0.047985
[3380957:MainThread](2024-04-25 18:20:54,220) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   7%|▋         | 3/44 [03:02<39:52, 58.37s/it][3380957:MainThread](2024-04-25 18:20:54,227) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:20:54,236) INFO - qlib.workflow - [recorder.py:341] - Recorder 7ef631ba394048b48a8c601cfe9110e4 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:20:54,924) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:20:54,925) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:20:54,928) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:20:54,928) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:21:02,648) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.655666
            SH600004      0.655666
            SH600006      0.655666
            SH600007      0.655666
            SH600008      0.655666
                            ...   
2015-04-03  SZ300070      0.662130
            SZ300124      0.662130
            SZ300133      0.662130
            SZ300146      0.662130
            SZ300251      0.662130
Length: 495049, dtype: float64
[3380957:MainThread](2024-04-25 18:21:02,650) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:21:02,650) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:21:02,651) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:05,037) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:05,263) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995446
[3380957:MainThread](2024-04-25 18:21:05,264) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:21:05,265) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:07,642) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:07,865) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995952
[3380957:MainThread](2024-04-25 18:21:07,866) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:21:07,866) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:10,238) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:10,464) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995293
[3380957:MainThread](2024-04-25 18:21:10,465) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:21:10,465) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:12,833) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:13,059) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996257
[3380957:MainThread](2024-04-25 18:21:13,059) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:21:13,059) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:15,438) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:15,665) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994726
[3380957:MainThread](2024-04-25 18:21:15,666) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:21:15,666) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:18,048) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:18,273) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995732
[3380957:MainThread](2024-04-25 18:21:18,273) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:21:18,274) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:20,646) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:20,870) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994077
[3380957:MainThread](2024-04-25 18:21:20,871) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:21:20,871) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:23,222) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:23,446) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994061
[3380957:MainThread](2024-04-25 18:21:23,447) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:21:23,447) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:25,807) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:26,031) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994748
[3380957:MainThread](2024-04-25 18:21:26,031) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:21:26,032) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:28,378) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:28,602) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995974
[3380957:MainThread](2024-04-25 18:21:28,603) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:21:28,603) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:30,907) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:31,131) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994013
[3380957:MainThread](2024-04-25 18:21:31,132) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:21:31,133) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:33,432) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:33,657) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995959
[3380957:MainThread](2024-04-25 18:21:33,657) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:21:33,658) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:35,963) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:36,187) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994781
[3380957:MainThread](2024-04-25 18:21:36,188) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:21:36,188) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:38,508) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:38,732) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995249
[3380957:MainThread](2024-04-25 18:21:38,732) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:21:38,733) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:41,074) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:41,302) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993489
[3380957:MainThread](2024-04-25 18:21:41,303) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:21:41,303) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:43,647) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:43,875) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994032
[3380957:MainThread](2024-04-25 18:21:43,875) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:21:43,875) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:46,222) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:46,451) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994797
[3380957:MainThread](2024-04-25 18:21:46,451) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:21:46,451) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:48,825) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:49,053) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995564
[3380957:MainThread](2024-04-25 18:21:49,053) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:21:49,053) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:51,446) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:51,677) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996495
[3380957:MainThread](2024-04-25 18:21:51,678) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:21:51,678) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:54,048) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:54,274) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995084
[3380957:MainThread](2024-04-25 18:21:54,275) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:21:54,275) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:56,664) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:56,891) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995420
[3380957:MainThread](2024-04-25 18:21:56,892) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:21:56,892) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:21:59,288) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:21:59,516) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996096
[3380957:MainThread](2024-04-25 18:21:59,517) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 18:21:59,517) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:22:01,880) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:22:02,108) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997702
[3380957:MainThread](2024-04-25 18:22:02,108) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:22:02,108) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993489 @ 14
[3380957:MainThread](2024-04-25 18:22:02,167) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-04-06 SH600000   -0.011462
           SH600008   -0.205099
           SH600009   -0.113152
           SH600010   -0.007506
           SH600015   -0.010198
[3380957:MainThread](2024-04-25 18:22:03,918) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   9%|▉         | 4/44 [04:12<41:53, 62.84s/it][3380957:MainThread](2024-04-25 18:22:03,925) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:22:03,934) INFO - qlib.workflow - [recorder.py:341] - Recorder cd87c80a6f384640becaace5eecada86 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:22:04,645) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:22:04,646) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:22:04,650) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:22:04,651) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:22:12,278) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.007423
            SH600004      1.007423
            SH600006      1.007423
            SH600007      1.007423
            SH600008      1.007423
                            ...   
2015-05-05  SZ300070      1.863816
            SZ300124      1.863816
            SZ300133      1.863816
            SZ300146      1.863816
            SZ300251      1.863816
Length: 500679, dtype: float64
[3380957:MainThread](2024-04-25 18:22:12,287) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:22:12,287) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:22:12,287) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:22:14,690) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:22:14,891) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995893
[3380957:MainThread](2024-04-25 18:22:14,892) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:22:14,893) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:22:17,303) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:22:17,502) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996550
[3380957:MainThread](2024-04-25 18:22:17,502) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:22:17,503) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:22:19,920) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:22:20,120) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994673
[3380957:MainThread](2024-04-25 18:22:20,121) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:22:20,121) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:22:22,548) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:22:22,752) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994548
[3380957:MainThread](2024-04-25 18:22:22,753) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:22:22,754) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:22:25,119) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:22:25,318) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994722
[3380957:MainThread](2024-04-25 18:22:25,319) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:22:25,319) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:22:27,726) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:22:27,925) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994741
[3380957:MainThread](2024-04-25 18:22:27,925) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:22:27,925) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:22:30,334) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:22:30,532) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993872
[3380957:MainThread](2024-04-25 18:22:30,533) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:22:30,534) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:22:32,936) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:22:33,136) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993923
[3380957:MainThread](2024-04-25 18:22:33,136) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:22:33,137) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:22:35,559) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:22:35,759) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994079
[3380957:MainThread](2024-04-25 18:22:35,760) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:22:35,760) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:22:38,172) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:22:38,371) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993684
[3380957:MainThread](2024-04-25 18:22:38,372) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:22:38,373) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:22:40,800) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:22:41,000) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994868
[3380957:MainThread](2024-04-25 18:22:41,001) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:22:41,001) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:22:43,437) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:22:43,643) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993648
[3380957:MainThread](2024-04-25 18:22:43,644) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:22:43,645) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:22:46,057) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:22:46,255) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994116
[3380957:MainThread](2024-04-25 18:22:46,256) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:22:46,256) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:22:48,656) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:22:48,855) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993593
[3380957:MainThread](2024-04-25 18:22:48,856) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:22:48,856) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:22:51,239) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:22:51,438) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994830
[3380957:MainThread](2024-04-25 18:22:51,438) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:22:51,439) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:22:53,842) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:22:54,041) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994616
[3380957:MainThread](2024-04-25 18:22:54,041) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:22:54,041) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:22:56,437) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:22:56,635) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993845
[3380957:MainThread](2024-04-25 18:22:56,635) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:22:56,636) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:22:59,005) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:22:59,205) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995223
[3380957:MainThread](2024-04-25 18:22:59,205) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:22:59,206) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:23:01,591) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:23:01,789) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996242
[3380957:MainThread](2024-04-25 18:23:01,790) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:23:01,790) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:23:04,197) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:23:04,396) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995398
[3380957:MainThread](2024-04-25 18:23:04,397) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:23:04,397) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:23:06,765) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:23:06,966) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995926
[3380957:MainThread](2024-04-25 18:23:06,967) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:23:06,967) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:23:09,344) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:23:09,545) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994967
[3380957:MainThread](2024-04-25 18:23:09,545) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:23:09,545) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993593 @ 13
[3380957:MainThread](2024-04-25 18:23:09,594) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-05-05 SH600000   -0.030400
           SH600008   -0.120490
           SH600009   -0.256232
           SH600010   -0.029957
           SH600015   -0.037082
[3380957:MainThread](2024-04-25 18:23:11,345) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  11%|█▏        | 5/44 [05:20<41:55, 64.49s/it][3380957:MainThread](2024-04-25 18:23:11,352) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:23:11,361) INFO - qlib.workflow - [recorder.py:341] - Recorder 5e147be4f3e244ed9985763d0cd760e9 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:23:12,054) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:23:12,055) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:23:12,058) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:23:12,058) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:23:19,616) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.561147
            SH600004      0.561147
            SH600006      0.561147
            SH600007      0.561147
            SH600008      0.561147
                            ...   
2015-06-02  SZ300070      0.736107
            SZ300124      0.736107
            SZ300133      0.736107
            SZ300146      0.736107
            SZ300251      0.736107
Length: 506316, dtype: float64
[3380957:MainThread](2024-04-25 18:23:19,619) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:23:19,619) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:23:19,619) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:23:21,930) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:23:22,136) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997644
[3380957:MainThread](2024-04-25 18:23:22,137) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:23:22,137) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:23:24,516) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:23:24,722) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995795
[3380957:MainThread](2024-04-25 18:23:24,723) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:23:24,723) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:23:27,093) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:23:27,299) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995597
[3380957:MainThread](2024-04-25 18:23:27,300) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:23:27,300) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:23:29,682) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:23:29,888) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994662
[3380957:MainThread](2024-04-25 18:23:29,890) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:23:29,890) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:23:32,276) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:23:32,483) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995443
[3380957:MainThread](2024-04-25 18:23:32,483) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:23:32,484) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:23:34,844) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:23:35,049) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995265
[3380957:MainThread](2024-04-25 18:23:35,050) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:23:35,050) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:23:37,405) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:23:37,611) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994596
[3380957:MainThread](2024-04-25 18:23:37,612) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:23:37,612) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:23:39,974) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:23:40,181) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993702
[3380957:MainThread](2024-04-25 18:23:40,182) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:23:40,182) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:23:42,538) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:23:42,744) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995064
[3380957:MainThread](2024-04-25 18:23:42,745) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:23:42,745) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:23:45,103) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:23:45,309) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994138
[3380957:MainThread](2024-04-25 18:23:45,309) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:23:45,310) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:23:47,668) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:23:47,874) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994825
[3380957:MainThread](2024-04-25 18:23:47,875) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:23:47,875) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:23:50,234) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:23:50,440) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994880
[3380957:MainThread](2024-04-25 18:23:50,441) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:23:50,441) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:23:52,800) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:23:53,006) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993294
[3380957:MainThread](2024-04-25 18:23:53,007) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:23:53,007) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:23:55,367) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:23:55,574) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995238
[3380957:MainThread](2024-04-25 18:23:55,574) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:23:55,574) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:23:57,942) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:23:58,149) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993154
[3380957:MainThread](2024-04-25 18:23:58,150) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:23:58,150) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:00,510) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:24:00,716) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994782
[3380957:MainThread](2024-04-25 18:24:00,716) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:24:00,716) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:03,075) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:24:03,286) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994210
[3380957:MainThread](2024-04-25 18:24:03,286) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:24:03,286) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:05,649) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:24:05,855) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995683
[3380957:MainThread](2024-04-25 18:24:05,855) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:24:05,855) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:08,215) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:24:08,421) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994942
[3380957:MainThread](2024-04-25 18:24:08,422) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:24:08,422) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:10,782) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:24:10,988) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995957
[3380957:MainThread](2024-04-25 18:24:10,989) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:24:10,989) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:13,348) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:24:13,554) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995856
[3380957:MainThread](2024-04-25 18:24:13,554) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:24:13,555) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:15,910) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:24:16,116) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996710
[3380957:MainThread](2024-04-25 18:24:16,117) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 18:24:16,117) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:18,476) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:24:18,682) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996030
[3380957:MainThread](2024-04-25 18:24:18,683) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:24:18,683) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993154 @ 14
[3380957:MainThread](2024-04-25 18:24:18,732) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-06-06 SH600000    0.006939
           SH600008    0.007078
           SH600009    0.085440
           SH600010   -0.003460
           SH600015    0.036041
[3380957:MainThread](2024-04-25 18:24:20,452) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  14%|█▎        | 6/44 [06:29<41:50, 66.06s/it][3380957:MainThread](2024-04-25 18:24:20,459) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:24:20,468) INFO - qlib.workflow - [recorder.py:341] - Recorder c8614b93a3c44b00ac55bbe205973df8 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:24:21,143) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:24:21,143) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:24:21,146) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:24:21,147) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:24:28,708) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.76658
            SH600004      1.76658
            SH600006      1.76658
            SH600007      1.76658
            SH600008      1.76658
                           ...   
2015-07-10  SZ300059      1.50935
            SZ300070      1.50935
            SZ300104      1.50935
            SZ300124      1.50935
            SZ300146      1.50935
Length: 511531, dtype: float64
[3380957:MainThread](2024-04-25 18:24:28,711) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:24:28,711) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:24:28,711) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:31,075) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:24:31,300) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995835
[3380957:MainThread](2024-04-25 18:24:31,301) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:24:31,302) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:33,684) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:24:33,909) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994711
[3380957:MainThread](2024-04-25 18:24:33,910) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:24:33,910) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:36,291) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:24:36,516) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993593
[3380957:MainThread](2024-04-25 18:24:36,517) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:24:36,517) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:38,901) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:24:39,127) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993404
[3380957:MainThread](2024-04-25 18:24:39,128) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:24:39,128) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:41,518) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:24:41,743) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994353
[3380957:MainThread](2024-04-25 18:24:41,744) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:24:41,744) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:44,130) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:24:44,355) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992637
[3380957:MainThread](2024-04-25 18:24:44,356) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:24:44,356) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:46,742) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:24:46,968) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992761
[3380957:MainThread](2024-04-25 18:24:46,968) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:24:46,968) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:49,348) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:24:49,574) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991809
[3380957:MainThread](2024-04-25 18:24:49,575) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:24:49,575) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:51,958) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:24:52,183) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991469
[3380957:MainThread](2024-04-25 18:24:52,184) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:24:52,185) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:54,575) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:24:54,803) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991748
[3380957:MainThread](2024-04-25 18:24:54,804) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:24:54,804) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:57,185) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:24:57,411) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991870
[3380957:MainThread](2024-04-25 18:24:57,411) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:24:57,411) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:24:59,793) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:25:00,019) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991481
[3380957:MainThread](2024-04-25 18:25:00,019) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:25:00,020) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:25:02,400) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:25:02,627) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992428
[3380957:MainThread](2024-04-25 18:25:02,627) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:25:02,627) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:25:05,024) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:25:05,253) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991714
[3380957:MainThread](2024-04-25 18:25:05,253) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:25:05,254) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:25:07,625) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:25:07,851) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991227
[3380957:MainThread](2024-04-25 18:25:07,852) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:25:07,852) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:25:10,244) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:25:10,470) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991945
[3380957:MainThread](2024-04-25 18:25:10,470) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:25:10,470) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:25:12,863) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:25:13,093) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991317
[3380957:MainThread](2024-04-25 18:25:13,093) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:25:13,094) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:25:15,482) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:25:15,708) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991626
[3380957:MainThread](2024-04-25 18:25:15,708) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:25:15,708) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:25:18,094) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:25:18,320) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993606
[3380957:MainThread](2024-04-25 18:25:18,320) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:25:18,321) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:25:20,715) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:25:20,940) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992890
[3380957:MainThread](2024-04-25 18:25:20,941) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:25:20,941) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:25:23,322) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:25:23,548) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993228
[3380957:MainThread](2024-04-25 18:25:23,548) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:25:23,548) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:25:25,943) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:25:26,172) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993903
[3380957:MainThread](2024-04-25 18:25:26,173) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 18:25:26,173) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:25:28,562) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:25:28,792) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993709
[3380957:MainThread](2024-04-25 18:25:28,792) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:25:28,792) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991227 @ 14
[3380957:MainThread](2024-04-25 18:25:28,843) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-07-04 SH600000    0.050114
           SH600008   -0.117599
           SH600009   -0.018710
           SH600010    0.028285
           SH600015    0.035992
[3380957:MainThread](2024-04-25 18:25:30,593) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  16%|█▌        | 7/44 [07:39<41:33, 67.40s/it][3380957:MainThread](2024-04-25 18:25:30,601) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:25:30,610) INFO - qlib.workflow - [recorder.py:341] - Recorder f9194fe76a7d4d9983a2b13e88f133bb starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:25:31,302) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:25:31,303) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:25:31,305) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:25:31,305) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:25:39,039) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.032032
            SH600004      1.032032
            SH600006      1.032032
            SH600007      1.032032
            SH600008      1.032032
                            ...   
2015-08-07  SZ300104      1.692227
            SZ300124      1.692227
            SZ300133      1.692227
            SZ300146      1.692227
            SZ300251      1.692227
Length: 516849, dtype: float64
[3380957:MainThread](2024-04-25 18:25:39,041) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:25:39,041) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:25:39,042) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:25:41,470) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:25:41,691) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995586
[3380957:MainThread](2024-04-25 18:25:41,692) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:25:41,693) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:25:44,109) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:25:44,330) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994611
[3380957:MainThread](2024-04-25 18:25:44,331) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:25:44,332) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:25:46,752) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:25:46,974) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994130
[3380957:MainThread](2024-04-25 18:25:46,975) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:25:46,975) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:25:49,385) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:25:49,607) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994282
[3380957:MainThread](2024-04-25 18:25:49,607) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:25:49,607) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:25:52,037) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:25:52,259) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993646
[3380957:MainThread](2024-04-25 18:25:52,260) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:25:52,260) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:25:54,687) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:25:54,910) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993977
[3380957:MainThread](2024-04-25 18:25:54,911) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:25:54,911) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:25:57,343) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:25:57,566) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994312
[3380957:MainThread](2024-04-25 18:25:57,567) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:25:57,567) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:26:00,006) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:26:00,228) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993829
[3380957:MainThread](2024-04-25 18:26:00,229) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:26:00,229) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:26:02,664) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:26:02,885) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992936
[3380957:MainThread](2024-04-25 18:26:02,886) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:26:02,887) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:26:05,277) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:26:05,499) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993461
[3380957:MainThread](2024-04-25 18:26:05,500) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:26:05,500) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:26:07,928) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:26:08,150) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992894
[3380957:MainThread](2024-04-25 18:26:08,151) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:26:08,151) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:26:10,589) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:26:10,811) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992900
[3380957:MainThread](2024-04-25 18:26:10,811) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:26:10,812) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:26:13,262) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:26:13,486) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992474
[3380957:MainThread](2024-04-25 18:26:13,487) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:26:13,488) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:26:15,958) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:26:16,183) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994552
[3380957:MainThread](2024-04-25 18:26:16,184) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:26:16,184) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:26:18,671) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:26:18,895) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993066
[3380957:MainThread](2024-04-25 18:26:18,895) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:26:18,895) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:26:21,348) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:26:21,571) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992175
[3380957:MainThread](2024-04-25 18:26:21,572) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:26:21,573) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:26:24,049) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:26:24,271) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992230
[3380957:MainThread](2024-04-25 18:26:24,272) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:26:24,272) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:26:26,760) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:26:26,984) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992807
[3380957:MainThread](2024-04-25 18:26:26,985) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:26:26,985) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:26:29,498) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:26:29,724) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992523
[3380957:MainThread](2024-04-25 18:26:29,725) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:26:29,725) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:26:32,231) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:26:32,453) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992225
[3380957:MainThread](2024-04-25 18:26:32,453) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:26:32,454) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:26:34,954) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:26:35,179) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993054
[3380957:MainThread](2024-04-25 18:26:35,179) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:26:35,180) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:26:37,659) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:26:37,883) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992813
[3380957:MainThread](2024-04-25 18:26:37,883) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 18:26:37,883) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:26:40,393) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:26:40,618) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994484
[3380957:MainThread](2024-04-25 18:26:40,619) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 18:26:40,619) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:26:43,116) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:26:43,340) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994286
[3380957:MainThread](2024-04-25 18:26:43,340) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:26:43,340) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992175 @ 15
[3380957:MainThread](2024-04-25 18:26:43,429) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-08-01 SH600000   -0.038612
           SH600008    0.059178
           SH600009   -0.046071
           SH600010    0.162070
           SH600015   -0.117982
[3380957:MainThread](2024-04-25 18:26:45,156) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  18%|█▊        | 8/44 [08:53<41:48, 69.68s/it][3380957:MainThread](2024-04-25 18:26:45,164) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:26:45,173) INFO - qlib.workflow - [recorder.py:341] - Recorder 24d1c9cb879747409e721c37a1e709c5 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:26:45,877) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:26:45,879) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:26:45,881) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:26:45,881) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:26:53,555) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.439813
            SH600004      1.439813
            SH600006      1.439813
            SH600007      1.439813
            SH600008      1.439813
                            ...   
2015-09-08  SZ300104      1.791494
            SZ300124      1.791494
            SZ300133      1.791494
            SZ300146      1.791494
            SZ300251      1.791494
Length: 522220, dtype: float64
[3380957:MainThread](2024-04-25 18:26:53,557) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:26:53,558) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:26:53,558) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:26:56,053) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:26:56,245) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996082
[3380957:MainThread](2024-04-25 18:26:56,246) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:26:56,246) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:26:58,746) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:26:58,941) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994404
[3380957:MainThread](2024-04-25 18:26:58,942) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:26:58,942) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:01,498) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:01,690) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993734
[3380957:MainThread](2024-04-25 18:27:01,691) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:27:01,691) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:04,246) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:04,436) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993331
[3380957:MainThread](2024-04-25 18:27:04,437) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:27:04,437) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:06,981) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:07,169) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993535
[3380957:MainThread](2024-04-25 18:27:07,169) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:27:07,170) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:09,724) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:09,914) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993581
[3380957:MainThread](2024-04-25 18:27:09,915) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:27:09,915) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:12,489) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:12,681) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992825
[3380957:MainThread](2024-04-25 18:27:12,682) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:27:12,682) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:15,255) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:15,446) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992229
[3380957:MainThread](2024-04-25 18:27:15,447) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:27:15,447) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:18,027) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:18,218) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992512
[3380957:MainThread](2024-04-25 18:27:18,219) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:27:18,219) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:20,716) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:20,909) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992612
[3380957:MainThread](2024-04-25 18:27:20,910) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:27:20,910) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:23,441) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:23,632) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992160
[3380957:MainThread](2024-04-25 18:27:23,633) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:27:23,633) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:26,155) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:26,347) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991888
[3380957:MainThread](2024-04-25 18:27:26,348) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:27:26,348) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:28,869) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:29,060) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991649
[3380957:MainThread](2024-04-25 18:27:29,061) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:27:29,061) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:31,624) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:31,814) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991956
[3380957:MainThread](2024-04-25 18:27:31,815) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:27:31,815) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:34,369) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:34,560) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992817
[3380957:MainThread](2024-04-25 18:27:34,561) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:27:34,561) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:37,064) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:37,255) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991381
[3380957:MainThread](2024-04-25 18:27:37,256) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:27:37,257) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:39,785) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:39,977) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991075
[3380957:MainThread](2024-04-25 18:27:39,978) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:27:39,979) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:42,527) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:42,720) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991991
[3380957:MainThread](2024-04-25 18:27:42,720) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:27:42,721) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:45,253) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:45,443) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991013
[3380957:MainThread](2024-04-25 18:27:45,444) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:27:45,445) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:47,968) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:48,159) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991856
[3380957:MainThread](2024-04-25 18:27:48,159) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:27:48,160) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:50,711) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:50,903) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991163
[3380957:MainThread](2024-04-25 18:27:50,903) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:27:50,904) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:53,465) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:53,656) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990662
[3380957:MainThread](2024-04-25 18:27:53,657) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 18:27:53,657) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:56,221) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:56,413) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991331
[3380957:MainThread](2024-04-25 18:27:56,413) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 18:27:56,414) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:27:58,956) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:27:59,149) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991170
[3380957:MainThread](2024-04-25 18:27:59,149) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 18:27:59,149) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:28:01,684) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:28:01,876) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991606
[3380957:MainThread](2024-04-25 18:28:01,876) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 18:28:01,877) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:28:04,399) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:28:04,591) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991449
[3380957:MainThread](2024-04-25 18:28:04,591) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 18:28:04,591) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:28:07,113) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:28:07,304) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991529
[3380957:MainThread](2024-04-25 18:28:07,305) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[3380957:MainThread](2024-04-25 18:28:07,305) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:28:09,830) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:28:10,024) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992674
[3380957:MainThread](2024-04-25 18:28:10,024) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[3380957:MainThread](2024-04-25 18:28:10,024) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:28:12,548) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:28:12,742) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992193
[3380957:MainThread](2024-04-25 18:28:12,742) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[3380957:MainThread](2024-04-25 18:28:12,742) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:28:15,239) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:28:15,432) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992868
[3380957:MainThread](2024-04-25 18:28:15,432) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:28:15,433) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990662 @ 21
[3380957:MainThread](2024-04-25 18:28:15,482) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-08-29 SH600000   -0.060155
           SH600008   -0.023855
           SH600009    0.218282
           SH600010   -0.133727
           SH600015    0.003110
[3380957:MainThread](2024-04-25 18:28:17,231) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  20%|██        | 9/44 [10:25<44:43, 76.68s/it][3380957:MainThread](2024-04-25 18:28:17,238) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:28:17,248) INFO - qlib.workflow - [recorder.py:341] - Recorder 09bd4e2418fa4b71a319422bd03f75c5 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:28:17,941) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:28:17,942) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:28:17,945) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:28:17,945) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:28:25,510) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.323618
            SH600004      1.323618
            SH600006      1.323618
            SH600007      1.323618
            SH600008      1.323618
                            ...   
2015-10-13  SZ300104      1.789056
            SZ300124      1.789056
            SZ300133      1.789056
            SZ300146      1.789056
            SZ300251      1.789056
Length: 527673, dtype: float64
[3380957:MainThread](2024-04-25 18:28:25,512) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:28:25,512) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:28:25,513) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:28:27,996) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:28:28,216) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995098
[3380957:MainThread](2024-04-25 18:28:28,217) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:28:28,217) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:28:30,698) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:28:30,919) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994539
[3380957:MainThread](2024-04-25 18:28:30,921) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:28:30,921) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:28:33,411) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:28:33,634) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993896
[3380957:MainThread](2024-04-25 18:28:33,635) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:28:33,635) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:28:36,123) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:28:36,347) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993677
[3380957:MainThread](2024-04-25 18:28:36,348) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:28:36,348) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:28:38,839) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:28:39,063) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993768
[3380957:MainThread](2024-04-25 18:28:39,063) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:28:39,063) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:28:41,552) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:28:41,775) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993582
[3380957:MainThread](2024-04-25 18:28:41,776) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:28:41,776) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:28:44,260) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:28:44,479) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992683
[3380957:MainThread](2024-04-25 18:28:44,480) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:28:44,481) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:28:46,948) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:28:47,167) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992553
[3380957:MainThread](2024-04-25 18:28:47,168) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:28:47,168) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:28:49,634) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:28:49,854) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992757
[3380957:MainThread](2024-04-25 18:28:49,855) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:28:49,855) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:28:52,322) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:28:52,544) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992319
[3380957:MainThread](2024-04-25 18:28:52,545) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:28:52,545) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:28:55,010) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:28:55,232) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991843
[3380957:MainThread](2024-04-25 18:28:55,233) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:28:55,234) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:28:57,703) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:28:57,923) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992886
[3380957:MainThread](2024-04-25 18:28:57,923) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:28:57,924) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:29:00,388) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:29:00,609) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992459
[3380957:MainThread](2024-04-25 18:29:00,609) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:29:00,609) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:29:03,087) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:29:03,307) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992334
[3380957:MainThread](2024-04-25 18:29:03,308) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:29:03,308) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:29:05,777) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:29:05,995) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991929
[3380957:MainThread](2024-04-25 18:29:05,996) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:29:05,996) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:29:08,470) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:29:08,698) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992289
[3380957:MainThread](2024-04-25 18:29:08,698) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:29:08,699) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:29:11,170) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:29:11,390) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991833
[3380957:MainThread](2024-04-25 18:29:11,391) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:29:11,391) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:29:13,859) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:29:14,079) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992034
[3380957:MainThread](2024-04-25 18:29:14,080) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:29:14,080) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:29:16,545) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:29:16,765) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991748
[3380957:MainThread](2024-04-25 18:29:16,766) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:29:16,767) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:29:19,237) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:29:19,457) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991857
[3380957:MainThread](2024-04-25 18:29:19,457) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:29:19,457) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:29:21,923) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:29:22,143) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991890
[3380957:MainThread](2024-04-25 18:29:22,143) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:29:22,144) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:29:24,606) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:29:24,827) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991676
[3380957:MainThread](2024-04-25 18:29:24,828) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 18:29:24,829) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:29:27,293) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:29:27,513) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992670
[3380957:MainThread](2024-04-25 18:29:27,514) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 18:29:27,514) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:29:29,983) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:29:30,204) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992203
[3380957:MainThread](2024-04-25 18:29:30,205) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 18:29:30,205) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:29:32,741) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:29:32,964) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992208
[3380957:MainThread](2024-04-25 18:29:32,965) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 18:29:32,965) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:29:35,505) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:29:35,729) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992071
[3380957:MainThread](2024-04-25 18:29:35,729) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 18:29:35,730) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:29:38,271) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:29:38,496) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992450
[3380957:MainThread](2024-04-25 18:29:38,496) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[3380957:MainThread](2024-04-25 18:29:38,496) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:29:41,029) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:29:41,253) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993290
[3380957:MainThread](2024-04-25 18:29:41,254) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[3380957:MainThread](2024-04-25 18:29:41,254) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:29:43,797) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:29:44,021) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993144
[3380957:MainThread](2024-04-25 18:29:44,021) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[3380957:MainThread](2024-04-25 18:29:44,021) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:29:46,499) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:29:46,719) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992353
[3380957:MainThread](2024-04-25 18:29:46,719) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:29:46,719) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991676 @ 21
[3380957:MainThread](2024-04-25 18:29:46,769) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-09-26 SH600000    0.050192
           SH600008   -0.104566
           SH600009    0.007119
           SH600010    0.008923
           SH600015    0.046222
[3380957:MainThread](2024-04-25 18:29:48,484) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  23%|██▎       | 10/44 [11:57<46:00, 81.18s/it][3380957:MainThread](2024-04-25 18:29:48,491) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:29:48,501) INFO - qlib.workflow - [recorder.py:341] - Recorder 867b952c6b5a4517a80d7814591ba9d4 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:29:49,228) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:29:49,229) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:29:49,234) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:29:49,235) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:29:56,822) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.465659
            SH600004      1.465659
            SH600006      1.465659
            SH600007      1.465659
            SH600008      1.465659
                            ...   
2015-11-19  SZ300104      1.883061
            SZ300124      1.883061
            SZ300133      1.883061
            SZ300146      1.883061
            SZ300251      1.883061
Length: 533252, dtype: float64
[3380957:MainThread](2024-04-25 18:29:56,824) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:29:56,825) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:29:56,825) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:29:59,275) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:29:59,501) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995151
[3380957:MainThread](2024-04-25 18:29:59,502) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:29:59,503) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:01,946) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:02,171) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994952
[3380957:MainThread](2024-04-25 18:30:02,172) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:30:02,172) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:04,673) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:04,898) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994193
[3380957:MainThread](2024-04-25 18:30:04,899) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:30:04,899) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:07,400) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:07,625) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993735
[3380957:MainThread](2024-04-25 18:30:07,626) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:30:07,626) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:10,105) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:10,331) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993538
[3380957:MainThread](2024-04-25 18:30:10,332) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:30:10,332) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:12,831) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:13,056) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993953
[3380957:MainThread](2024-04-25 18:30:13,057) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:30:13,057) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:15,552) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:15,777) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993506
[3380957:MainThread](2024-04-25 18:30:15,778) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:30:15,778) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:18,276) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:18,500) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993104
[3380957:MainThread](2024-04-25 18:30:18,501) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:30:18,501) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:21,024) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:21,252) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993684
[3380957:MainThread](2024-04-25 18:30:21,253) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:30:21,253) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:23,753) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:23,978) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994751
[3380957:MainThread](2024-04-25 18:30:23,979) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:30:23,979) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:26,484) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:26,712) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992828
[3380957:MainThread](2024-04-25 18:30:26,713) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:30:26,714) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:29,214) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:29,439) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991887
[3380957:MainThread](2024-04-25 18:30:29,440) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:30:29,441) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:32,007) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:32,235) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992239
[3380957:MainThread](2024-04-25 18:30:32,236) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:30:32,236) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:34,809) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:35,038) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990952
[3380957:MainThread](2024-04-25 18:30:35,039) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:30:35,039) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:37,594) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:37,823) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991982
[3380957:MainThread](2024-04-25 18:30:37,823) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:30:37,823) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:40,352) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:40,579) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991525
[3380957:MainThread](2024-04-25 18:30:40,579) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:30:40,579) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:43,116) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:43,349) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992548
[3380957:MainThread](2024-04-25 18:30:43,349) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:30:43,349) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:45,884) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:46,110) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991448
[3380957:MainThread](2024-04-25 18:30:46,111) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:30:46,111) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:48,661) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:48,886) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990993
[3380957:MainThread](2024-04-25 18:30:48,887) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:30:48,887) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:51,435) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:51,660) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991300
[3380957:MainThread](2024-04-25 18:30:51,660) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:30:51,661) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:54,225) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:54,450) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991202
[3380957:MainThread](2024-04-25 18:30:54,451) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:30:54,451) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:30:57,010) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:30:57,236) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991294
[3380957:MainThread](2024-04-25 18:30:57,237) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:30:57,237) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990952 @ 13
[3380957:MainThread](2024-04-25 18:30:57,286) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-10-31 SH600000   -0.022023
           SH600008   -0.069062
           SH600009    0.120290
           SH600010    0.023907
           SH600015   -0.008435
[3380957:MainThread](2024-04-25 18:30:59,010) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  25%|██▌       | 11/44 [13:07<42:51, 77.92s/it][3380957:MainThread](2024-04-25 18:30:59,018) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:30:59,027) INFO - qlib.workflow - [recorder.py:341] - Recorder 029e08821adb4e85959e38f2ef92d3fe starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:30:59,730) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:30:59,730) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:30:59,733) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:30:59,733) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:31:07,471) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.073025
            SH600004      1.073025
            SH600006      1.073025
            SH600007      1.073025
            SH600008      1.073025
                            ...   
2015-12-17  SZ300133      1.984583
            SZ300144      1.984583
            SZ300146      1.984583
            SZ300251      1.984583
            SZ300315      1.984583
Length: 538891, dtype: float64
[3380957:MainThread](2024-04-25 18:31:07,485) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:31:07,486) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:31:07,486) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:31:10,028) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:31:10,254) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995524
[3380957:MainThread](2024-04-25 18:31:10,255) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:31:10,256) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:31:12,791) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:31:13,016) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994820
[3380957:MainThread](2024-04-25 18:31:13,017) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:31:13,018) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:31:15,543) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:31:15,768) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993921
[3380957:MainThread](2024-04-25 18:31:15,769) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:31:15,770) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:31:18,361) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:31:18,589) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993986
[3380957:MainThread](2024-04-25 18:31:18,589) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:31:18,589) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:31:21,190) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:31:21,417) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993683
[3380957:MainThread](2024-04-25 18:31:21,418) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:31:21,419) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:31:23,967) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:31:24,193) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992955
[3380957:MainThread](2024-04-25 18:31:24,195) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:31:24,195) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:31:26,792) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:31:27,022) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993093
[3380957:MainThread](2024-04-25 18:31:27,022) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:31:27,022) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:31:29,617) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:31:29,846) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992918
[3380957:MainThread](2024-04-25 18:31:29,847) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:31:29,848) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:31:32,370) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:31:32,596) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992509
[3380957:MainThread](2024-04-25 18:31:32,597) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:31:32,597) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:31:35,143) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:31:35,367) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992503
[3380957:MainThread](2024-04-25 18:31:35,368) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:31:35,368) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:31:37,835) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:31:38,061) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991837
[3380957:MainThread](2024-04-25 18:31:38,062) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:31:38,062) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:31:40,520) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:31:40,751) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992518
[3380957:MainThread](2024-04-25 18:31:40,751) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:31:40,751) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:31:43,261) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:31:43,486) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992240
[3380957:MainThread](2024-04-25 18:31:43,487) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:31:43,487) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:31:45,951) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:31:46,177) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991522
[3380957:MainThread](2024-04-25 18:31:46,178) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:31:46,179) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:31:48,731) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:31:48,960) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992174
[3380957:MainThread](2024-04-25 18:31:48,961) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:31:48,961) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:31:51,491) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:31:51,721) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991977
[3380957:MainThread](2024-04-25 18:31:51,722) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:31:51,722) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:31:54,274) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:31:54,504) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992368
[3380957:MainThread](2024-04-25 18:31:54,504) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:31:54,505) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:31:57,058) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:31:57,288) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991500
[3380957:MainThread](2024-04-25 18:31:57,289) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:31:57,290) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:31:59,835) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:32:00,064) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991519
[3380957:MainThread](2024-04-25 18:32:00,065) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:32:00,065) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:32:02,608) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:32:02,841) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991395
[3380957:MainThread](2024-04-25 18:32:02,842) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:32:02,843) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:32:05,373) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:32:05,603) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991413
[3380957:MainThread](2024-04-25 18:32:05,604) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:32:05,604) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:32:08,150) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:32:08,379) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991167
[3380957:MainThread](2024-04-25 18:32:08,380) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 18:32:08,381) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:32:10,888) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:32:11,115) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991179
[3380957:MainThread](2024-04-25 18:32:11,116) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 18:32:11,116) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:32:13,688) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:32:13,914) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992050
[3380957:MainThread](2024-04-25 18:32:13,914) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 18:32:13,915) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:32:16,455) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:32:16,681) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991694
[3380957:MainThread](2024-04-25 18:32:16,682) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 18:32:16,682) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:32:19,213) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:32:19,445) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991667
[3380957:MainThread](2024-04-25 18:32:19,445) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 18:32:19,445) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:32:21,970) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:32:22,198) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991379
[3380957:MainThread](2024-04-25 18:32:22,199) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[3380957:MainThread](2024-04-25 18:32:22,199) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:32:24,717) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:32:24,943) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992165
[3380957:MainThread](2024-04-25 18:32:24,944) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[3380957:MainThread](2024-04-25 18:32:24,944) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:32:27,466) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:32:27,694) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991729
[3380957:MainThread](2024-04-25 18:32:27,694) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[3380957:MainThread](2024-04-25 18:32:27,694) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:32:30,248) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:32:30,475) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992265
[3380957:MainThread](2024-04-25 18:32:30,475) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:32:30,476) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991167 @ 21
[3380957:MainThread](2024-04-25 18:32:30,524) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-11-28 SH600000   -0.015968
           SH600008   -0.070271
           SH600009    0.018343
           SH600010   -0.004300
           SH600015   -0.010175
[3380957:MainThread](2024-04-25 18:32:32,247) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  27%|██▋       | 12/44 [14:40<44:02, 82.58s/it][3380957:MainThread](2024-04-25 18:32:32,254) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:32:32,263) INFO - qlib.workflow - [recorder.py:341] - Recorder 434280f7d7fd4308ba8b8a1ac848e1dd starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:32:32,988) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:32:32,989) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:32:32,993) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:32:32,993) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:32:40,664) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.603100
            SH600004      1.603100
            SH600006      1.603100
            SH600007      1.603100
            SH600008      1.603100
                            ...   
2016-01-15  SZ300133      1.050707
            SZ300144      1.050707
            SZ300146      1.050707
            SZ300251      1.050707
            SZ300315      1.050707
Length: 544436, dtype: float64
[3380957:MainThread](2024-04-25 18:32:40,667) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:32:40,667) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:32:40,667) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:32:43,243) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:32:43,468) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995611
[3380957:MainThread](2024-04-25 18:32:43,469) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:32:43,470) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:32:46,005) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:32:46,231) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994710
[3380957:MainThread](2024-04-25 18:32:46,232) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:32:46,232) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:32:48,802) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:32:49,029) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994493
[3380957:MainThread](2024-04-25 18:32:49,030) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:32:49,030) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:32:51,627) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:32:51,851) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993617
[3380957:MainThread](2024-04-25 18:32:51,852) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:32:51,852) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:32:54,438) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:32:54,662) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993018
[3380957:MainThread](2024-04-25 18:32:54,663) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:32:54,663) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:32:57,278) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:32:57,505) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993506
[3380957:MainThread](2024-04-25 18:32:57,505) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:32:57,506) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:00,132) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:00,361) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993039
[3380957:MainThread](2024-04-25 18:33:00,362) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:33:00,362) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:02,987) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:03,212) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991924
[3380957:MainThread](2024-04-25 18:33:03,213) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:33:03,214) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:05,812) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:06,042) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991968
[3380957:MainThread](2024-04-25 18:33:06,042) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:33:06,043) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:08,614) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:08,839) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992326
[3380957:MainThread](2024-04-25 18:33:08,839) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:33:08,840) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:11,460) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:11,688) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992364
[3380957:MainThread](2024-04-25 18:33:11,689) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:33:11,689) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:14,274) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:14,500) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991922
[3380957:MainThread](2024-04-25 18:33:14,501) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:33:14,501) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:17,099) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:17,327) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991251
[3380957:MainThread](2024-04-25 18:33:17,328) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:33:17,328) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:19,925) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:20,152) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990887
[3380957:MainThread](2024-04-25 18:33:20,153) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:33:20,154) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:22,702) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:22,930) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990758
[3380957:MainThread](2024-04-25 18:33:22,931) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:33:22,932) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:25,475) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:25,700) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990780
[3380957:MainThread](2024-04-25 18:33:25,700) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:33:25,701) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:28,235) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:28,462) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991277
[3380957:MainThread](2024-04-25 18:33:28,463) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:33:28,463) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:31,013) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:31,241) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990615
[3380957:MainThread](2024-04-25 18:33:31,242) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:33:31,243) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:33,811) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:34,040) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990963
[3380957:MainThread](2024-04-25 18:33:34,040) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:33:34,041) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:36,602) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:36,831) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991310
[3380957:MainThread](2024-04-25 18:33:36,831) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:33:36,832) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:39,320) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:39,546) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992064
[3380957:MainThread](2024-04-25 18:33:39,546) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:33:39,546) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:42,112) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:42,339) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991581
[3380957:MainThread](2024-04-25 18:33:42,340) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 18:33:42,340) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:44,829) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:45,055) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991774
[3380957:MainThread](2024-04-25 18:33:45,055) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 18:33:45,056) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:47,606) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:47,832) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991791
[3380957:MainThread](2024-04-25 18:33:47,832) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 18:33:47,832) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:50,380) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:50,606) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992221
[3380957:MainThread](2024-04-25 18:33:50,606) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 18:33:50,607) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:33:53,157) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:33:53,383) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993623
[3380957:MainThread](2024-04-25 18:33:53,383) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:33:53,383) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990615 @ 17
[3380957:MainThread](2024-04-25 18:33:53,433) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-12-26 SH600000   -0.022785
           SH600008    0.043531
           SH600009   -0.001239
           SH600010   -0.052704
           SH600011    0.031759
[3380957:MainThread](2024-04-25 18:33:55,167) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  30%|██▉       | 13/44 [16:03<42:43, 82.68s/it][3380957:MainThread](2024-04-25 18:33:55,175) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:33:55,184) INFO - qlib.workflow - [recorder.py:341] - Recorder 5726cd681ee64b54af3236407d05398a starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:33:55,867) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:33:55,868) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:33:55,871) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:33:55,871) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:34:03,573) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.745300
            SH600004      0.745300
            SH600006      0.745300
            SH600007      0.745300
            SH600008      0.745300
                            ...   
2016-03-16  SZ300133      1.471089
            SZ300144      1.471089
            SZ300146      1.471089
            SZ300251      1.471089
            SZ300315      1.471089
Length: 550075, dtype: float64
[3380957:MainThread](2024-04-25 18:34:03,575) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:34:03,576) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:34:03,576) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:06,330) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:34:06,522) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995231
[3380957:MainThread](2024-04-25 18:34:06,524) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:34:06,524) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:09,139) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:34:09,326) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995383
[3380957:MainThread](2024-04-25 18:34:09,327) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:34:09,327) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:11,915) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:34:12,102) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994466
[3380957:MainThread](2024-04-25 18:34:12,103) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:34:12,103) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:14,694) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:34:14,882) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993519
[3380957:MainThread](2024-04-25 18:34:14,883) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:34:14,883) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:17,462) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:34:17,650) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993613
[3380957:MainThread](2024-04-25 18:34:17,650) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:34:17,651) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:20,270) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:34:20,458) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993337
[3380957:MainThread](2024-04-25 18:34:20,459) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:34:20,460) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:23,132) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:34:23,322) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992777
[3380957:MainThread](2024-04-25 18:34:23,323) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:34:23,324) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:25,993) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:34:26,183) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993160
[3380957:MainThread](2024-04-25 18:34:26,183) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:34:26,184) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:28,851) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:34:29,042) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992780
[3380957:MainThread](2024-04-25 18:34:29,042) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:34:29,042) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:31,704) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:34:31,893) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992034
[3380957:MainThread](2024-04-25 18:34:31,894) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:34:31,894) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:34,548) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:34:34,737) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991923
[3380957:MainThread](2024-04-25 18:34:34,738) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:34:34,738) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:37,382) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:34:37,570) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992257
[3380957:MainThread](2024-04-25 18:34:37,570) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:34:37,571) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:40,224) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:34:40,413) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991817
[3380957:MainThread](2024-04-25 18:34:40,414) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:34:40,414) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:43,046) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:34:43,235) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991520
[3380957:MainThread](2024-04-25 18:34:43,236) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:34:43,236) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:45,870) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:34:46,059) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991582
[3380957:MainThread](2024-04-25 18:34:46,059) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:34:46,059) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:48,683) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:34:48,872) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992189
[3380957:MainThread](2024-04-25 18:34:48,872) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:34:48,873) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:51,501) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:34:51,691) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991762
[3380957:MainThread](2024-04-25 18:34:51,691) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:34:51,692) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:54,312) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:34:54,501) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990979
[3380957:MainThread](2024-04-25 18:34:54,502) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:34:54,502) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:57,101) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:34:57,290) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992289
[3380957:MainThread](2024-04-25 18:34:57,290) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:34:57,291) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:34:59,879) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:35:00,068) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990953
[3380957:MainThread](2024-04-25 18:35:00,069) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:35:00,070) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:35:02,657) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:35:02,846) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991499
[3380957:MainThread](2024-04-25 18:35:02,846) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:35:02,847) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:35:05,425) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:35:05,613) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991390
[3380957:MainThread](2024-04-25 18:35:05,614) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 18:35:05,614) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:35:08,171) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:35:08,358) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991746
[3380957:MainThread](2024-04-25 18:35:08,359) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 18:35:08,359) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:35:10,914) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:35:11,102) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991100
[3380957:MainThread](2024-04-25 18:35:11,102) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 18:35:11,102) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:35:13,661) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:35:13,849) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992108
[3380957:MainThread](2024-04-25 18:35:13,850) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 18:35:13,850) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:35:16,400) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:35:16,588) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992851
[3380957:MainThread](2024-04-25 18:35:16,589) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 18:35:16,589) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:35:19,140) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:35:19,328) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993105
[3380957:MainThread](2024-04-25 18:35:19,329) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[3380957:MainThread](2024-04-25 18:35:19,329) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:35:21,882) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:35:22,070) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992378
[3380957:MainThread](2024-04-25 18:35:22,070) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:35:22,071) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990953 @ 19
[3380957:MainThread](2024-04-25 18:35:22,283) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-01-24 SH600000   -0.015089
           SH600008   -0.146094
           SH600009    0.158778
           SH600010    0.002340
           SH600011   -0.012133
[3380957:MainThread](2024-04-25 18:35:23,994) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  32%|███▏      | 14/44 [17:32<42:16, 84.54s/it][3380957:MainThread](2024-04-25 18:35:24,001) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:35:24,011) INFO - qlib.workflow - [recorder.py:341] - Recorder 4d299aaf93e34851bff2c7569a2cde25 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:35:24,711) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:35:24,712) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:35:24,715) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:35:24,716) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:35:32,298) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.084706
            SH600004      1.084706
            SH600006      1.084706
            SH600007      1.084706
            SH600008      1.084706
                            ...   
2016-04-14  SZ300124      1.939610
            SZ300133      1.939610
            SZ300144      1.939610
            SZ300146      1.939610
            SZ300315      1.939610
Length: 555663, dtype: float64
[3380957:MainThread](2024-04-25 18:35:32,300) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:35:32,301) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:35:32,301) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:35:34,901) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:35:35,089) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995541
[3380957:MainThread](2024-04-25 18:35:35,090) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:35:35,091) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:35:37,673) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:35:37,860) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995212
[3380957:MainThread](2024-04-25 18:35:37,861) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:35:37,862) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:35:40,441) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:35:40,628) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993682
[3380957:MainThread](2024-04-25 18:35:40,629) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:35:40,630) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:35:43,195) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:35:43,382) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993572
[3380957:MainThread](2024-04-25 18:35:43,383) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:35:43,384) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:35:45,968) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:35:46,158) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993293
[3380957:MainThread](2024-04-25 18:35:46,159) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:35:46,159) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:35:48,743) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:35:48,930) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993089
[3380957:MainThread](2024-04-25 18:35:48,931) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:35:48,931) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:35:51,517) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:35:51,704) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992884
[3380957:MainThread](2024-04-25 18:35:51,705) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:35:51,706) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:35:54,293) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:35:54,480) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991972
[3380957:MainThread](2024-04-25 18:35:54,481) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:35:54,482) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:35:57,067) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:35:57,254) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992818
[3380957:MainThread](2024-04-25 18:35:57,254) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:35:57,255) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:35:59,913) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:36:00,105) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991216
[3380957:MainThread](2024-04-25 18:36:00,106) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:36:00,107) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:36:02,764) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:36:02,953) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992114
[3380957:MainThread](2024-04-25 18:36:02,954) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:36:02,954) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:36:05,557) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:36:05,745) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991408
[3380957:MainThread](2024-04-25 18:36:05,745) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:36:05,745) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:36:08,329) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:36:08,517) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991181
[3380957:MainThread](2024-04-25 18:36:08,518) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:36:08,518) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:36:11,114) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:36:11,302) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991526
[3380957:MainThread](2024-04-25 18:36:11,302) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:36:11,302) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:36:13,894) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:36:14,081) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991678
[3380957:MainThread](2024-04-25 18:36:14,082) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:36:14,082) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:36:16,675) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:36:16,865) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990867
[3380957:MainThread](2024-04-25 18:36:16,866) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:36:16,866) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:36:19,466) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:36:19,655) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992097
[3380957:MainThread](2024-04-25 18:36:19,656) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:36:19,656) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:36:22,258) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:36:22,448) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991924
[3380957:MainThread](2024-04-25 18:36:22,448) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:36:22,449) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:36:25,027) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:36:25,216) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990673
[3380957:MainThread](2024-04-25 18:36:25,217) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:36:25,217) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:36:27,843) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:36:28,031) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991274
[3380957:MainThread](2024-04-25 18:36:28,031) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:36:28,031) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:36:30,662) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:36:30,850) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991540
[3380957:MainThread](2024-04-25 18:36:30,851) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:36:30,851) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:36:33,490) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:36:33,679) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992490
[3380957:MainThread](2024-04-25 18:36:33,679) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 18:36:33,680) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:36:36,300) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:36:36,490) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991491
[3380957:MainThread](2024-04-25 18:36:36,490) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 18:36:36,490) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:36:39,156) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:36:39,345) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992371
[3380957:MainThread](2024-04-25 18:36:39,345) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 18:36:39,346) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:36:41,959) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:36:42,149) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992237
[3380957:MainThread](2024-04-25 18:36:42,150) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 18:36:42,150) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:36:44,781) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:36:44,971) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992843
[3380957:MainThread](2024-04-25 18:36:44,971) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 18:36:44,972) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:36:47,598) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:36:47,787) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992792
[3380957:MainThread](2024-04-25 18:36:47,787) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:36:47,788) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990673 @ 18
[3380957:MainThread](2024-04-25 18:36:47,837) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-02-28 SH600000   -0.111793
           SH600008   -0.024959
           SH600009    0.047422
           SH600010   -0.080296
           SH600011   -0.079918
[3380957:MainThread](2024-04-25 18:36:49,551) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  34%|███▍      | 15/44 [18:58<41:00, 84.85s/it][3380957:MainThread](2024-04-25 18:36:49,559) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:36:49,568) INFO - qlib.workflow - [recorder.py:341] - Recorder f8c6c774f1a14d67b90df6a249746e3e starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:36:50,253) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:36:50,253) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:36:50,256) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:36:50,257) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:36:57,857) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.802728
            SH600004      0.802728
            SH600006      0.802728
            SH600007      0.802728
            SH600008      0.802728
                            ...   
2016-05-13  SZ300124      0.810072
            SZ300133      0.810072
            SZ300144      0.810072
            SZ300146      0.810072
            SZ300315      0.810072
Length: 561275, dtype: float64
[3380957:MainThread](2024-04-25 18:36:57,859) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:36:57,859) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:36:57,860) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:00,534) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:00,758) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995833
[3380957:MainThread](2024-04-25 18:37:00,759) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:37:00,759) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:03,412) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:03,636) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995441
[3380957:MainThread](2024-04-25 18:37:03,637) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:37:03,638) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:06,251) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:06,476) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994142
[3380957:MainThread](2024-04-25 18:37:06,477) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:37:06,477) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:09,091) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:09,315) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994891
[3380957:MainThread](2024-04-25 18:37:09,316) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:37:09,316) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:11,933) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:12,158) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994039
[3380957:MainThread](2024-04-25 18:37:12,159) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:37:12,159) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:14,788) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:15,012) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994050
[3380957:MainThread](2024-04-25 18:37:15,012) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:37:15,013) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:17,695) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:17,920) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993310
[3380957:MainThread](2024-04-25 18:37:17,921) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:37:17,921) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:20,603) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:20,830) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992927
[3380957:MainThread](2024-04-25 18:37:20,831) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:37:20,831) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:23,546) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:23,772) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992501
[3380957:MainThread](2024-04-25 18:37:23,773) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:37:23,774) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:26,481) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:26,705) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993147
[3380957:MainThread](2024-04-25 18:37:26,705) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:37:26,705) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:29,413) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:29,640) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992781
[3380957:MainThread](2024-04-25 18:37:29,640) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:37:29,641) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:32,350) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:32,577) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992336
[3380957:MainThread](2024-04-25 18:37:32,578) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:37:32,578) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:35,276) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:35,503) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992230
[3380957:MainThread](2024-04-25 18:37:35,504) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:37:35,504) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:38,185) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:38,410) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992665
[3380957:MainThread](2024-04-25 18:37:38,410) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:37:38,410) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:41,106) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:41,334) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992346
[3380957:MainThread](2024-04-25 18:37:41,334) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:37:41,334) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:43,979) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:44,202) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991690
[3380957:MainThread](2024-04-25 18:37:44,203) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:37:44,204) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:46,839) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:47,063) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991637
[3380957:MainThread](2024-04-25 18:37:47,064) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:37:47,064) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:49,700) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:49,924) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991584
[3380957:MainThread](2024-04-25 18:37:49,925) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:37:49,925) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:52,545) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:52,769) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991270
[3380957:MainThread](2024-04-25 18:37:52,771) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:37:52,771) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:55,387) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:55,611) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991584
[3380957:MainThread](2024-04-25 18:37:55,611) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:37:55,611) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:37:58,230) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:37:58,454) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992479
[3380957:MainThread](2024-04-25 18:37:58,455) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:37:58,455) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:38:01,083) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:38:01,308) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992227
[3380957:MainThread](2024-04-25 18:38:01,308) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 18:38:01,308) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:38:03,922) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:38:04,147) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992539
[3380957:MainThread](2024-04-25 18:38:04,147) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 18:38:04,147) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:38:06,810) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:38:07,035) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992910
[3380957:MainThread](2024-04-25 18:38:07,035) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 18:38:07,036) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:38:09,665) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:38:09,889) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992019
[3380957:MainThread](2024-04-25 18:38:09,890) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 18:38:09,890) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:38:12,509) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:38:12,733) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992122
[3380957:MainThread](2024-04-25 18:38:12,734) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 18:38:12,734) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:38:15,389) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:38:15,613) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992250
[3380957:MainThread](2024-04-25 18:38:15,614) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:38:15,614) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991270 @ 18
[3380957:MainThread](2024-04-25 18:38:15,663) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-03-28 SH600000   -0.086058
           SH600008   -0.167965
           SH600009    0.078279
           SH600010    0.106593
           SH600011   -0.167344
[3380957:MainThread](2024-04-25 18:38:17,377) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  36%|███▋      | 16/44 [20:26<40:00, 85.74s/it][3380957:MainThread](2024-04-25 18:38:17,384) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:38:17,393) INFO - qlib.workflow - [recorder.py:341] - Recorder 00f2d65b3e034281966e865641466a2e starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:38:18,099) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:38:18,099) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:38:18,101) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:38:18,102) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:38:25,844) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.773870
            SH600004      0.773870
            SH600006      0.773870
            SH600007      0.773870
            SH600008      0.773870
                            ...   
2016-06-14  SZ300133      1.552051
            SZ300144      1.552051
            SZ300146      1.552051
            SZ300251      1.552051
            SZ300315      1.552051
Length: 566995, dtype: float64
[3380957:MainThread](2024-04-25 18:38:25,847) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:38:25,847) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:38:25,847) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:38:28,564) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:38:28,788) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995623
[3380957:MainThread](2024-04-25 18:38:28,789) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:38:28,790) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:38:31,505) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:38:31,730) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994804
[3380957:MainThread](2024-04-25 18:38:31,732) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:38:31,732) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:38:34,429) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:38:34,655) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994376
[3380957:MainThread](2024-04-25 18:38:34,656) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:38:34,656) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:38:37,383) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:38:37,608) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993929
[3380957:MainThread](2024-04-25 18:38:37,609) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:38:37,610) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:38:40,327) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:38:40,554) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993188
[3380957:MainThread](2024-04-25 18:38:40,556) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:38:40,556) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:38:43,262) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:38:43,487) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992731
[3380957:MainThread](2024-04-25 18:38:43,488) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:38:43,488) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:38:46,136) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:38:46,364) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992434
[3380957:MainThread](2024-04-25 18:38:46,365) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:38:46,365) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:38:49,020) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:38:49,250) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992496
[3380957:MainThread](2024-04-25 18:38:49,250) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:38:49,250) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:38:51,876) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:38:52,104) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992500
[3380957:MainThread](2024-04-25 18:38:52,105) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:38:52,105) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:38:54,753) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:38:54,981) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992704
[3380957:MainThread](2024-04-25 18:38:54,981) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:38:54,982) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:38:57,648) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:38:57,872) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991893
[3380957:MainThread](2024-04-25 18:38:57,874) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:38:57,874) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:39:00,532) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:39:00,757) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991229
[3380957:MainThread](2024-04-25 18:39:00,758) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:39:00,758) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:39:03,409) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:39:03,634) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991270
[3380957:MainThread](2024-04-25 18:39:03,634) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:39:03,635) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:39:06,275) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:39:06,503) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991336
[3380957:MainThread](2024-04-25 18:39:06,504) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:39:06,504) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:39:09,138) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:39:09,364) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991096
[3380957:MainThread](2024-04-25 18:39:09,365) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:39:09,365) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:39:12,004) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:39:12,230) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991452
[3380957:MainThread](2024-04-25 18:39:12,230) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:39:12,230) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:39:14,870) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:39:15,095) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991139
[3380957:MainThread](2024-04-25 18:39:15,096) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:39:15,096) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:39:17,742) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:39:17,968) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991749
[3380957:MainThread](2024-04-25 18:39:17,968) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:39:17,968) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:39:20,602) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:39:20,827) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990746
[3380957:MainThread](2024-04-25 18:39:20,828) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:39:20,829) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:39:23,488) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:39:23,717) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991269
[3380957:MainThread](2024-04-25 18:39:23,717) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:39:23,718) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:39:26,383) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:39:26,609) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991263
[3380957:MainThread](2024-04-25 18:39:26,609) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:39:26,610) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:39:29,257) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:39:29,483) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991352
[3380957:MainThread](2024-04-25 18:39:29,484) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 18:39:29,484) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:39:32,130) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:39:32,354) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991724
[3380957:MainThread](2024-04-25 18:39:32,355) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 18:39:32,355) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:39:35,036) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:39:35,263) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991674
[3380957:MainThread](2024-04-25 18:39:35,263) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 18:39:35,264) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:39:37,968) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:39:38,195) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991940
[3380957:MainThread](2024-04-25 18:39:38,196) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 18:39:38,196) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:39:40,919) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:39:41,146) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992166
[3380957:MainThread](2024-04-25 18:39:41,146) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 18:39:41,147) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:39:43,871) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:39:44,100) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993108
[3380957:MainThread](2024-04-25 18:39:44,100) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:39:44,100) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990746 @ 18
[3380957:MainThread](2024-04-25 18:39:44,153) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-04-27 SH600000   -0.000412
           SH600008   -0.019763
           SH600009    0.070778
           SH600010   -0.088786
           SH600011   -0.092780
[3380957:MainThread](2024-04-25 18:39:45,899) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  39%|███▊      | 17/44 [21:54<38:57, 86.58s/it][3380957:MainThread](2024-04-25 18:39:45,907) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:39:45,916) INFO - qlib.workflow - [recorder.py:341] - Recorder ba351b4ad2e343b38aa17b67856e9234 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:39:46,593) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:39:46,594) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:39:46,596) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:39:46,596) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:39:54,498) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.117558
            SH600004      1.117558
            SH600006      1.117558
            SH600007      1.117558
            SH600008      1.117558
                            ...   
2016-07-12  SZ300144      1.724637
            SZ300146      1.724637
            SZ300168      1.724637
            SZ300251      1.724637
            SZ300315      1.724637
Length: 572790, dtype: float64
[3380957:MainThread](2024-04-25 18:39:54,501) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:39:54,501) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:39:54,501) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:39:57,248) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:39:57,474) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995388
[3380957:MainThread](2024-04-25 18:39:57,475) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:39:57,475) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:40:00,204) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:40:00,431) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994578
[3380957:MainThread](2024-04-25 18:40:00,432) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:40:00,432) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:40:03,162) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:40:03,392) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993609
[3380957:MainThread](2024-04-25 18:40:03,393) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:40:03,393) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:40:06,117) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:40:06,341) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993250
[3380957:MainThread](2024-04-25 18:40:06,343) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:40:06,343) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:40:09,070) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:40:09,297) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994081
[3380957:MainThread](2024-04-25 18:40:09,298) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:40:09,298) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:40:11,969) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:40:12,196) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994186
[3380957:MainThread](2024-04-25 18:40:12,197) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:40:12,197) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:40:14,835) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:40:15,059) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992446
[3380957:MainThread](2024-04-25 18:40:15,060) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:40:15,060) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:40:17,700) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:40:17,925) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992520
[3380957:MainThread](2024-04-25 18:40:17,926) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:40:17,926) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:40:20,566) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:40:20,790) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991546
[3380957:MainThread](2024-04-25 18:40:20,791) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:40:20,791) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:40:23,433) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:40:23,657) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992105
[3380957:MainThread](2024-04-25 18:40:23,657) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:40:23,657) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:40:26,296) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:40:26,520) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991238
[3380957:MainThread](2024-04-25 18:40:26,522) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:40:26,522) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:40:29,156) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:40:29,381) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992472
[3380957:MainThread](2024-04-25 18:40:29,381) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:40:29,382) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:40:32,012) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:40:32,237) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991492
[3380957:MainThread](2024-04-25 18:40:32,237) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:40:32,238) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:40:34,874) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:40:35,099) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991773
[3380957:MainThread](2024-04-25 18:40:35,100) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:40:35,100) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:40:37,734) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:40:37,959) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991419
[3380957:MainThread](2024-04-25 18:40:37,959) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:40:37,960) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:40:40,609) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:40:40,832) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991480
[3380957:MainThread](2024-04-25 18:40:40,832) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:40:40,832) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:40:43,512) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:40:43,737) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991376
[3380957:MainThread](2024-04-25 18:40:43,737) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:40:43,737) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:40:46,379) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:40:46,603) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992090
[3380957:MainThread](2024-04-25 18:40:46,603) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:40:46,604) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:40:49,246) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:40:49,470) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992463
[3380957:MainThread](2024-04-25 18:40:49,470) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:40:49,471) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991238 @ 10
[3380957:MainThread](2024-04-25 18:40:49,520) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-05-29 SH600000   -0.028580
           SH600008    0.008142
           SH600009   -0.013656
           SH600010   -0.001253
           SH600011   -0.088673
[3380957:MainThread](2024-04-25 18:40:51,237) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  41%|████      | 18/44 [22:59<34:45, 80.20s/it][3380957:MainThread](2024-04-25 18:40:51,244) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:40:51,253) INFO - qlib.workflow - [recorder.py:341] - Recorder 156288b420f14231a5e02334750e5e85 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:40:51,941) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:40:51,941) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:40:51,944) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:40:51,944) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:40:59,577) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.959204
            SH600004      0.959204
            SH600006      0.959204
            SH600007      0.959204
            SH600008      0.959204
                            ...   
2016-08-09  SZ300144      1.894663
            SZ300146      1.894663
            SZ300168      1.894663
            SZ300251      1.894663
            SZ300315      1.894663
Length: 578598, dtype: float64
[3380957:MainThread](2024-04-25 18:40:59,579) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:40:59,579) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:40:59,579) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:02,284) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:02,485) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995724
[3380957:MainThread](2024-04-25 18:41:02,486) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:41:02,486) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:05,183) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:05,383) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994664
[3380957:MainThread](2024-04-25 18:41:05,384) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:41:05,384) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:08,089) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:08,289) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994105
[3380957:MainThread](2024-04-25 18:41:08,290) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:41:08,290) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:11,007) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:11,210) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993003
[3380957:MainThread](2024-04-25 18:41:11,211) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:41:11,211) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:13,934) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:14,137) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992926
[3380957:MainThread](2024-04-25 18:41:14,138) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:41:14,139) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:16,858) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:17,061) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992957
[3380957:MainThread](2024-04-25 18:41:17,061) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:41:17,062) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:19,775) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:19,978) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992481
[3380957:MainThread](2024-04-25 18:41:19,979) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:41:19,979) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:22,697) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:22,899) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992600
[3380957:MainThread](2024-04-25 18:41:22,900) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:41:22,900) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:25,674) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:25,877) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992439
[3380957:MainThread](2024-04-25 18:41:25,878) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:41:25,878) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:28,639) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:28,840) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992952
[3380957:MainThread](2024-04-25 18:41:28,840) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:41:28,840) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:31,619) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:31,822) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992982
[3380957:MainThread](2024-04-25 18:41:31,822) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:41:31,822) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:34,566) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:34,769) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991376
[3380957:MainThread](2024-04-25 18:41:34,770) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:41:34,771) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:37,494) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:37,701) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991733
[3380957:MainThread](2024-04-25 18:41:37,701) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:41:37,701) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:40,427) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:40,630) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991448
[3380957:MainThread](2024-04-25 18:41:40,631) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:41:40,631) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:43,353) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:43,556) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993396
[3380957:MainThread](2024-04-25 18:41:43,557) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:41:43,557) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:46,285) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:46,488) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991804
[3380957:MainThread](2024-04-25 18:41:46,489) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:41:46,489) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:49,203) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:49,404) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993258
[3380957:MainThread](2024-04-25 18:41:49,405) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:41:49,405) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:52,119) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:52,320) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991645
[3380957:MainThread](2024-04-25 18:41:52,321) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:41:52,321) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:55,033) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:55,234) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993238
[3380957:MainThread](2024-04-25 18:41:55,235) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:41:55,235) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:41:57,980) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:41:58,182) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992244
[3380957:MainThread](2024-04-25 18:41:58,183) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:41:58,183) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991376 @ 11
[3380957:MainThread](2024-04-25 18:41:58,233) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-06-27 SH600000    0.006837
           SH600008   -0.043367
           SH600009    0.111687
           SH600010    0.066068
           SH600011   -0.075295
[3380957:MainThread](2024-04-25 18:41:59,964) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  43%|████▎     | 19/44 [24:08<31:58, 76.75s/it][3380957:MainThread](2024-04-25 18:41:59,972) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:41:59,981) INFO - qlib.workflow - [recorder.py:341] - Recorder 7210588525134303a2a7ff7c5bcb7d3f starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:42:00,670) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:42:00,670) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:42:00,673) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:42:00,673) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:42:08,383) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.741250
            SH600004      0.741250
            SH600006      0.741250
            SH600007      0.741250
            SH600008      0.741250
                            ...   
2016-09-06  SZ300144      1.278683
            SZ300146      1.278683
            SZ300168      1.278683
            SZ300251      1.278683
            SZ300315      1.278683
Length: 584401, dtype: float64
[3380957:MainThread](2024-04-25 18:42:08,386) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:42:08,386) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:42:08,386) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:42:11,165) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:42:11,390) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996589
[3380957:MainThread](2024-04-25 18:42:11,391) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:42:11,392) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:42:14,153) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:42:14,379) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995622
[3380957:MainThread](2024-04-25 18:42:14,380) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:42:14,380) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:42:17,143) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:42:17,368) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994254
[3380957:MainThread](2024-04-25 18:42:17,369) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:42:17,370) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:42:20,136) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:42:20,363) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993248
[3380957:MainThread](2024-04-25 18:42:20,364) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:42:20,364) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:42:23,137) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:42:23,362) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993048
[3380957:MainThread](2024-04-25 18:42:23,363) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:42:23,364) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:42:26,121) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:42:26,347) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992256
[3380957:MainThread](2024-04-25 18:42:26,348) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:42:26,348) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:42:29,135) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:42:29,364) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992134
[3380957:MainThread](2024-04-25 18:42:29,365) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:42:29,366) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:42:32,166) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:42:32,393) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991912
[3380957:MainThread](2024-04-25 18:42:32,394) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:42:32,395) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:42:35,177) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:42:35,407) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992611
[3380957:MainThread](2024-04-25 18:42:35,408) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:42:35,408) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:42:38,154) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:42:38,384) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991739
[3380957:MainThread](2024-04-25 18:42:38,385) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:42:38,385) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:42:41,126) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:42:41,357) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991606
[3380957:MainThread](2024-04-25 18:42:41,358) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:42:41,358) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:42:44,120) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:42:44,350) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991135
[3380957:MainThread](2024-04-25 18:42:44,351) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:42:44,351) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:42:47,069) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:42:47,295) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991833
[3380957:MainThread](2024-04-25 18:42:47,296) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:42:47,296) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:42:50,005) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:42:50,232) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991357
[3380957:MainThread](2024-04-25 18:42:50,233) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:42:50,233) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:42:52,947) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:42:53,173) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991401
[3380957:MainThread](2024-04-25 18:42:53,174) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:42:53,174) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:42:55,919) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:42:56,146) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991045
[3380957:MainThread](2024-04-25 18:42:56,147) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:42:56,147) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:42:58,923) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:42:59,151) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991303
[3380957:MainThread](2024-04-25 18:42:59,151) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:42:59,151) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:43:01,936) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:43:02,166) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990589
[3380957:MainThread](2024-04-25 18:43:02,167) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:43:02,167) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:43:04,962) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:43:05,190) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991125
[3380957:MainThread](2024-04-25 18:43:05,190) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:43:05,190) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:43:07,980) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:43:08,210) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990963
[3380957:MainThread](2024-04-25 18:43:08,211) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:43:08,211) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:43:10,972) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:43:11,202) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991405
[3380957:MainThread](2024-04-25 18:43:11,203) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:43:11,203) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:43:13,957) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:43:14,183) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990523
[3380957:MainThread](2024-04-25 18:43:14,184) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 18:43:14,185) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:43:16,892) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:43:17,118) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991584
[3380957:MainThread](2024-04-25 18:43:17,119) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 18:43:17,119) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:43:19,819) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:43:20,046) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992171
[3380957:MainThread](2024-04-25 18:43:20,046) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 18:43:20,047) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:43:22,754) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:43:22,982) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991338
[3380957:MainThread](2024-04-25 18:43:22,982) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 18:43:22,982) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:43:25,685) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:43:25,912) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991961
[3380957:MainThread](2024-04-25 18:43:25,912) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 18:43:25,913) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:43:28,645) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:43:28,872) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991516
[3380957:MainThread](2024-04-25 18:43:28,872) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[3380957:MainThread](2024-04-25 18:43:28,872) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:43:31,597) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:43:31,824) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991882
[3380957:MainThread](2024-04-25 18:43:31,825) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[3380957:MainThread](2024-04-25 18:43:31,825) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:43:34,526) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:43:34,753) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991561
[3380957:MainThread](2024-04-25 18:43:34,753) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[3380957:MainThread](2024-04-25 18:43:34,754) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:43:37,462) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:43:37,690) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991031
[3380957:MainThread](2024-04-25 18:43:37,690) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:43:37,691) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990523 @ 21
[3380957:MainThread](2024-04-25 18:43:37,740) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-07-25 SH600000    0.022063
           SH600008    0.033183
           SH600009   -0.050525
           SH600010   -0.108045
           SH600011   -0.130657
[3380957:MainThread](2024-04-25 18:43:39,453) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  45%|████▌     | 20/44 [25:48<33:25, 83.58s/it][3380957:MainThread](2024-04-25 18:43:39,461) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:43:39,470) INFO - qlib.workflow - [recorder.py:341] - Recorder 10ebac13b45442bdae4688ac30c9d8be starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:43:40,155) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:43:40,155) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:43:40,158) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:43:40,158) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:43:47,768) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.364261
            SH600004      1.364261
            SH600006      1.364261
            SH600007      1.364261
            SH600008      1.364261
                            ...   
2016-10-13  SZ300144      0.704851
            SZ300146      0.704851
            SZ300168      0.704851
            SZ300251      0.704851
            SZ300315      0.704851
Length: 590146, dtype: float64
[3380957:MainThread](2024-04-25 18:43:47,770) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:43:47,770) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:43:47,771) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:43:50,439) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:43:50,643) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995247
[3380957:MainThread](2024-04-25 18:43:50,644) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:43:50,644) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:43:53,339) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:43:53,542) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994769
[3380957:MainThread](2024-04-25 18:43:53,543) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:43:53,543) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:43:56,295) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:43:56,499) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993817
[3380957:MainThread](2024-04-25 18:43:56,500) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:43:56,500) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:43:59,249) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:43:59,453) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993841
[3380957:MainThread](2024-04-25 18:43:59,453) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:43:59,453) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:44:02,205) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:44:02,408) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993068
[3380957:MainThread](2024-04-25 18:44:02,409) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:44:02,410) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:44:05,170) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:44:05,375) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992340
[3380957:MainThread](2024-04-25 18:44:05,376) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:44:05,376) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:44:08,146) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:44:08,350) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992796
[3380957:MainThread](2024-04-25 18:44:08,350) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:44:08,350) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:44:11,142) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:44:11,346) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992326
[3380957:MainThread](2024-04-25 18:44:11,347) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:44:11,347) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:44:14,127) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:44:14,334) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991106
[3380957:MainThread](2024-04-25 18:44:14,335) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:44:14,336) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:44:17,136) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:44:17,342) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991171
[3380957:MainThread](2024-04-25 18:44:17,343) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:44:17,343) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:44:20,204) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:44:20,409) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992411
[3380957:MainThread](2024-04-25 18:44:20,409) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:44:20,410) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:44:23,257) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:44:23,465) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991194
[3380957:MainThread](2024-04-25 18:44:23,465) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:44:23,466) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:44:26,285) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:44:26,492) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990605
[3380957:MainThread](2024-04-25 18:44:26,493) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:44:26,493) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:44:29,390) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:44:29,595) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990381
[3380957:MainThread](2024-04-25 18:44:29,596) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:44:29,597) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:44:32,453) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:44:32,661) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990944
[3380957:MainThread](2024-04-25 18:44:32,661) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:44:32,662) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:44:35,528) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:44:35,734) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990863
[3380957:MainThread](2024-04-25 18:44:35,734) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:44:35,735) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:44:38,583) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:44:38,790) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990465
[3380957:MainThread](2024-04-25 18:44:38,790) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:44:38,790) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:44:41,599) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:44:41,804) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990861
[3380957:MainThread](2024-04-25 18:44:41,804) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:44:41,804) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:44:44,665) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:44:44,872) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991469
[3380957:MainThread](2024-04-25 18:44:44,872) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:44:44,872) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:44:47,711) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:44:47,917) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991499
[3380957:MainThread](2024-04-25 18:44:47,918) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:44:47,918) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:44:50,695) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:44:50,901) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991701
[3380957:MainThread](2024-04-25 18:44:50,901) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:44:50,901) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:44:53,672) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:44:53,876) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991124
[3380957:MainThread](2024-04-25 18:44:53,877) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:44:53,877) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990381 @ 13
[3380957:MainThread](2024-04-25 18:44:53,930) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-08-22 SH600000    0.003553
           SH600008   -0.115583
           SH600009    0.123691
           SH600010   -0.082821
           SH600011   -0.038337
[3380957:MainThread](2024-04-25 18:44:55,661) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  48%|████▊     | 21/44 [27:04<31:11, 81.37s/it][3380957:MainThread](2024-04-25 18:44:55,668) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:44:55,677) INFO - qlib.workflow - [recorder.py:341] - Recorder 5087353d3b9e43f1aeb8ed0412e408de starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:44:56,370) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:44:56,371) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:44:56,374) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:44:56,374) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:45:04,096) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.262473
            SH600004      1.262473
            SH600006      1.262473
            SH600007      1.262473
            SH600008      1.262473
                            ...   
2016-11-10  SZ300144      1.076950
            SZ300146      1.076950
            SZ300168      1.076950
            SZ300251      1.076950
            SZ300315      1.076950
Length: 595946, dtype: float64
[3380957:MainThread](2024-04-25 18:45:04,098) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:45:04,098) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:45:04,099) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:45:06,883) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:45:07,102) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994960
[3380957:MainThread](2024-04-25 18:45:07,103) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:45:07,104) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:45:09,798) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:45:10,018) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994204
[3380957:MainThread](2024-04-25 18:45:10,019) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:45:10,019) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:45:12,793) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:45:13,012) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993546
[3380957:MainThread](2024-04-25 18:45:13,013) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:45:13,013) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:45:15,791) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:45:16,011) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992261
[3380957:MainThread](2024-04-25 18:45:16,012) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:45:16,012) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:45:18,819) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:45:19,039) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992640
[3380957:MainThread](2024-04-25 18:45:19,040) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:45:19,040) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:45:21,877) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:45:22,096) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991917
[3380957:MainThread](2024-04-25 18:45:22,097) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:45:22,097) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:45:24,950) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:45:25,168) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991785
[3380957:MainThread](2024-04-25 18:45:25,170) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:45:25,170) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:45:27,995) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:45:28,216) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991691
[3380957:MainThread](2024-04-25 18:45:28,217) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:45:28,217) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:45:31,078) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:45:31,302) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991252
[3380957:MainThread](2024-04-25 18:45:31,303) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:45:31,304) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:45:34,156) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:45:34,376) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991344
[3380957:MainThread](2024-04-25 18:45:34,376) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:45:34,377) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:45:37,215) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:45:37,434) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990431
[3380957:MainThread](2024-04-25 18:45:37,435) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:45:37,436) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:45:40,268) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:45:40,492) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990008
[3380957:MainThread](2024-04-25 18:45:40,493) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:45:40,493) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:45:43,299) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:45:43,519) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990529
[3380957:MainThread](2024-04-25 18:45:43,519) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:45:43,520) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:45:46,315) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:45:46,535) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990219
[3380957:MainThread](2024-04-25 18:45:46,535) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:45:46,535) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:45:49,339) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:45:49,559) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990650
[3380957:MainThread](2024-04-25 18:45:49,560) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:45:49,560) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:45:52,353) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:45:52,574) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990664
[3380957:MainThread](2024-04-25 18:45:52,574) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:45:52,575) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:45:55,400) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:45:55,622) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990067
[3380957:MainThread](2024-04-25 18:45:55,623) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:45:55,623) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:45:58,435) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:45:58,656) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990907
[3380957:MainThread](2024-04-25 18:45:58,657) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:45:58,657) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:46:01,499) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:46:01,720) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991483
[3380957:MainThread](2024-04-25 18:46:01,720) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:46:01,721) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:46:04,592) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:46:04,812) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991023
[3380957:MainThread](2024-04-25 18:46:04,812) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:46:04,813) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990008 @ 11
[3380957:MainThread](2024-04-25 18:46:04,861) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-09-19 SH600000   -0.002058
           SH600008    0.009242
           SH600009   -0.010552
           SH600010   -0.011657
           SH600011    0.021611
[3380957:MainThread](2024-04-25 18:46:06,573) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  50%|█████     | 22/44 [28:15<28:41, 78.23s/it][3380957:MainThread](2024-04-25 18:46:06,581) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:46:06,590) INFO - qlib.workflow - [recorder.py:341] - Recorder 18a8a654a3444258b781c95054fde69f starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:46:07,299) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:46:07,300) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:46:07,302) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:46:07,303) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:46:15,131) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.958155
            SH600004      0.958155
            SH600006      0.958155
            SH600007      0.958155
            SH600008      0.958155
                            ...   
2016-12-08  SZ300144      1.834290
            SZ300146      1.834290
            SZ300168      1.834290
            SZ300251      1.834290
            SZ300315      1.834290
Length: 601711, dtype: float64
[3380957:MainThread](2024-04-25 18:46:15,134) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:46:15,134) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:46:15,134) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:46:18,011) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:46:18,233) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995663
[3380957:MainThread](2024-04-25 18:46:18,234) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:46:18,234) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:46:21,110) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:46:21,333) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994837
[3380957:MainThread](2024-04-25 18:46:21,334) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:46:21,334) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:46:24,199) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:46:24,421) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993544
[3380957:MainThread](2024-04-25 18:46:24,422) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:46:24,422) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:46:27,276) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:46:27,500) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993819
[3380957:MainThread](2024-04-25 18:46:27,500) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:46:27,500) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:46:30,378) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:46:30,602) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993414
[3380957:MainThread](2024-04-25 18:46:30,603) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:46:30,603) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:46:33,504) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:46:33,727) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992604
[3380957:MainThread](2024-04-25 18:46:33,729) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:46:33,729) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:46:36,612) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:46:36,837) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992439
[3380957:MainThread](2024-04-25 18:46:36,838) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:46:36,839) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:46:39,739) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:46:39,964) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992023
[3380957:MainThread](2024-04-25 18:46:39,965) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:46:39,965) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:46:42,865) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:46:43,090) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991407
[3380957:MainThread](2024-04-25 18:46:43,091) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:46:43,091) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:46:45,979) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:46:46,202) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991356
[3380957:MainThread](2024-04-25 18:46:46,203) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:46:46,203) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:46:49,097) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:46:49,322) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992824
[3380957:MainThread](2024-04-25 18:46:49,322) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:46:49,323) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:46:52,213) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:46:52,438) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991642
[3380957:MainThread](2024-04-25 18:46:52,439) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:46:52,439) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:46:55,327) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:46:55,553) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991852
[3380957:MainThread](2024-04-25 18:46:55,553) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:46:55,553) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:46:58,445) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:46:58,668) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990470
[3380957:MainThread](2024-04-25 18:46:58,669) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:46:58,669) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:47:01,520) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:47:01,747) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990926
[3380957:MainThread](2024-04-25 18:47:01,748) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:47:01,748) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:47:04,579) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:47:04,806) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991097
[3380957:MainThread](2024-04-25 18:47:04,806) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:47:04,807) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:47:07,637) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:47:07,863) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990913
[3380957:MainThread](2024-04-25 18:47:07,864) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:47:07,864) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:47:10,676) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:47:10,899) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990884
[3380957:MainThread](2024-04-25 18:47:10,900) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:47:10,900) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:47:13,706) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:47:13,929) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990954
[3380957:MainThread](2024-04-25 18:47:13,930) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:47:13,930) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:47:16,732) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:47:16,955) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990300
[3380957:MainThread](2024-04-25 18:47:16,956) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:47:16,957) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:47:19,760) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:47:19,984) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990718
[3380957:MainThread](2024-04-25 18:47:19,984) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:47:19,984) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:47:22,785) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:47:23,008) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990188
[3380957:MainThread](2024-04-25 18:47:23,009) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 18:47:23,009) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:47:25,816) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:47:26,040) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991269
[3380957:MainThread](2024-04-25 18:47:26,040) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 18:47:26,040) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:47:28,843) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:47:29,066) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990957
[3380957:MainThread](2024-04-25 18:47:29,067) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 18:47:29,067) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:47:31,868) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:47:32,091) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990556
[3380957:MainThread](2024-04-25 18:47:32,092) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 18:47:32,092) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:47:34,891) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:47:35,114) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991908
[3380957:MainThread](2024-04-25 18:47:35,115) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 18:47:35,115) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:47:37,923) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:47:38,146) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991789
[3380957:MainThread](2024-04-25 18:47:38,147) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[3380957:MainThread](2024-04-25 18:47:38,147) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:47:40,946) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:47:41,171) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991214
[3380957:MainThread](2024-04-25 18:47:41,171) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[3380957:MainThread](2024-04-25 18:47:41,171) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:47:43,977) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:47:44,200) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991062
[3380957:MainThread](2024-04-25 18:47:44,200) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[3380957:MainThread](2024-04-25 18:47:44,201) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:47:47,001) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:47:47,223) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992050
[3380957:MainThread](2024-04-25 18:47:47,223) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:47:47,224) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990188 @ 21
[3380957:MainThread](2024-04-25 18:47:47,272) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-10-25 SH600000   -0.151170
           SH600008   -0.068947
           SH600009   -0.486170
           SH600010   -0.004457
           SH600011   -0.130963
[3380957:MainThread](2024-04-25 18:47:48,975) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  52%|█████▏    | 23/44 [29:57<29:55, 85.48s/it][3380957:MainThread](2024-04-25 18:47:48,983) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:47:48,992) INFO - qlib.workflow - [recorder.py:341] - Recorder 10bbda9f28084b8c80c6433c609a9972 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:47:49,676) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:47:49,676) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:47:49,679) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:47:49,679) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:47:57,459) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.762962
            SH600004      1.762962
            SH600006      1.762962
            SH600007      1.762962
            SH600008      1.762962
                            ...   
2017-01-06  SZ300146      1.662914
            SZ300168      1.662914
            SZ300182      1.662914
            SZ300251      1.662914
            SZ300315      1.662914
Length: 607469, dtype: float64
[3380957:MainThread](2024-04-25 18:47:57,462) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:47:57,462) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:47:57,462) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:00,282) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:00,506) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996723
[3380957:MainThread](2024-04-25 18:48:00,507) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:48:00,507) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:03,306) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:03,530) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994832
[3380957:MainThread](2024-04-25 18:48:03,531) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:48:03,531) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:06,332) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:06,558) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993556
[3380957:MainThread](2024-04-25 18:48:06,559) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:48:06,559) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:09,423) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:09,646) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993329
[3380957:MainThread](2024-04-25 18:48:09,647) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:48:09,648) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:12,531) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:12,757) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992361
[3380957:MainThread](2024-04-25 18:48:12,758) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:48:12,758) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:15,646) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:15,876) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992543
[3380957:MainThread](2024-04-25 18:48:15,876) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:48:15,876) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:18,760) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:18,986) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991809
[3380957:MainThread](2024-04-25 18:48:18,987) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:48:18,987) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:21,898) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:22,123) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992613
[3380957:MainThread](2024-04-25 18:48:22,123) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:48:22,124) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:25,020) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:25,246) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990818
[3380957:MainThread](2024-04-25 18:48:25,247) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:48:25,248) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:28,138) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:28,365) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991255
[3380957:MainThread](2024-04-25 18:48:28,366) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:48:28,366) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:31,256) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:31,481) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991597
[3380957:MainThread](2024-04-25 18:48:31,482) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:48:31,482) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:34,370) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:34,597) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990236
[3380957:MainThread](2024-04-25 18:48:34,598) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:48:34,598) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:37,483) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:37,709) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.989864
[3380957:MainThread](2024-04-25 18:48:37,710) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:48:37,710) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:40,595) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:40,821) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991035
[3380957:MainThread](2024-04-25 18:48:40,821) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:48:40,822) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:43,718) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:43,946) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991919
[3380957:MainThread](2024-04-25 18:48:43,946) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:48:43,946) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:46,876) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:47,105) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991205
[3380957:MainThread](2024-04-25 18:48:47,105) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:48:47,105) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:50,001) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:50,226) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.989984
[3380957:MainThread](2024-04-25 18:48:50,227) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:48:50,227) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:53,094) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:53,319) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990533
[3380957:MainThread](2024-04-25 18:48:53,320) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:48:53,320) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:56,215) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:56,441) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990601
[3380957:MainThread](2024-04-25 18:48:56,441) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:48:56,441) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:48:59,328) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:48:59,557) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991023
[3380957:MainThread](2024-04-25 18:48:59,558) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:48:59,558) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:49:02,452) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:49:02,676) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990854
[3380957:MainThread](2024-04-25 18:49:02,676) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:49:02,676) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.989864 @ 12
[3380957:MainThread](2024-04-25 18:49:02,725) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-11-22 SH600000    0.004860
           SH600008   -0.120858
           SH600009   -0.108130
           SH600010    0.048124
           SH600011    0.036854
[3380957:MainThread](2024-04-25 18:49:04,430) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  55%|█████▍    | 24/44 [31:13<27:29, 82.47s/it][3380957:MainThread](2024-04-25 18:49:04,437) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:49:04,446) INFO - qlib.workflow - [recorder.py:341] - Recorder dfb4fe3c6224427bbc75aeeda7640626 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:49:05,137) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:49:05,137) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:49:05,140) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:49:05,141) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:49:12,768) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.523405
            SH600004      1.523405
            SH600006      1.523405
            SH600007      1.523405
            SH600008      1.523405
                            ...   
2017-02-10  SZ300144      1.762724
            SZ300146      1.762724
            SZ300168      1.762724
            SZ300182      1.762724
            SZ300251      1.762724
Length: 613211, dtype: float64
[3380957:MainThread](2024-04-25 18:49:12,770) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:49:12,770) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:49:12,770) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:49:15,674) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:49:15,901) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995587
[3380957:MainThread](2024-04-25 18:49:15,902) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:49:15,902) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:49:18,784) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:49:19,012) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994136
[3380957:MainThread](2024-04-25 18:49:19,013) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:49:19,013) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:49:21,887) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:49:22,115) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993175
[3380957:MainThread](2024-04-25 18:49:22,116) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:49:22,116) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:49:25,016) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:49:25,246) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993040
[3380957:MainThread](2024-04-25 18:49:25,247) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:49:25,247) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:49:28,113) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:49:28,342) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992310
[3380957:MainThread](2024-04-25 18:49:28,343) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:49:28,344) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:49:31,210) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:49:31,440) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994010
[3380957:MainThread](2024-04-25 18:49:31,440) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:49:31,441) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:49:34,302) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:49:34,528) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992197
[3380957:MainThread](2024-04-25 18:49:34,529) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:49:34,529) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:49:37,412) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:49:37,639) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992205
[3380957:MainThread](2024-04-25 18:49:37,639) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:49:37,640) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:49:40,480) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:49:40,710) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992225
[3380957:MainThread](2024-04-25 18:49:40,710) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:49:40,711) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:49:43,565) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:49:43,795) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992247
[3380957:MainThread](2024-04-25 18:49:43,796) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:49:43,796) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:49:46,664) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:49:46,894) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991783
[3380957:MainThread](2024-04-25 18:49:46,895) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:49:46,896) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:49:49,764) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:49:49,994) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992525
[3380957:MainThread](2024-04-25 18:49:49,995) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:49:49,995) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:49:52,861) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:49:53,088) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992233
[3380957:MainThread](2024-04-25 18:49:53,088) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:49:53,089) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:49:55,969) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:49:56,198) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991609
[3380957:MainThread](2024-04-25 18:49:56,199) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:49:56,199) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:49:59,114) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:49:59,341) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991736
[3380957:MainThread](2024-04-25 18:49:59,342) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:49:59,342) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:50:02,291) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:50:02,521) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992309
[3380957:MainThread](2024-04-25 18:50:02,521) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:50:02,521) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:50:05,465) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:50:05,692) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991679
[3380957:MainThread](2024-04-25 18:50:05,693) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:50:05,693) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:50:08,617) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:50:08,845) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992342
[3380957:MainThread](2024-04-25 18:50:08,846) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:50:08,846) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:50:11,748) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:50:11,985) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991827
[3380957:MainThread](2024-04-25 18:50:11,986) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:50:11,986) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:50:14,901) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:50:15,130) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992666
[3380957:MainThread](2024-04-25 18:50:15,130) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:50:15,131) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:50:18,016) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:50:18,244) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994390
[3380957:MainThread](2024-04-25 18:50:18,244) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:50:18,244) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:50:21,189) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:50:21,417) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992952
[3380957:MainThread](2024-04-25 18:50:21,418) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:50:21,418) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991609 @ 13
[3380957:MainThread](2024-04-25 18:50:21,531) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-12-20 SH600000    0.014897
           SH600004   -0.007587
           SH600009    0.014730
           SH600010   -0.064366
           SH600011   -0.100083
[3380957:MainThread](2024-04-25 18:50:23,252) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  57%|█████▋    | 25/44 [32:31<25:46, 81.38s/it][3380957:MainThread](2024-04-25 18:50:23,259) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:50:23,268) INFO - qlib.workflow - [recorder.py:341] - Recorder 7c1f52532dee42bfb332f01b1ebec83e starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:50:23,981) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:50:23,982) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:50:23,986) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:50:23,987) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:50:31,710) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.523432
            SH600004      1.523432
            SH600006      1.523432
            SH600007      1.523432
            SH600008      1.523432
                            ...   
2017-03-10  SZ300144      1.973282
            SZ300146      1.973282
            SZ300168      1.973282
            SZ300182      1.973282
            SZ300251      1.973282
Length: 618892, dtype: float64
[3380957:MainThread](2024-04-25 18:50:31,712) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:50:31,713) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:50:31,713) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:50:34,657) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:50:34,886) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996144
[3380957:MainThread](2024-04-25 18:50:34,887) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:50:34,888) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:50:37,829) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:50:38,060) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995169
[3380957:MainThread](2024-04-25 18:50:38,061) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:50:38,061) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:50:41,025) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:50:41,255) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994214
[3380957:MainThread](2024-04-25 18:50:41,256) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:50:41,256) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:50:44,249) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:50:44,479) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993378
[3380957:MainThread](2024-04-25 18:50:44,480) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:50:44,481) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:50:47,474) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:50:47,702) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993078
[3380957:MainThread](2024-04-25 18:50:47,704) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:50:47,704) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:50:50,696) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:50:50,926) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992317
[3380957:MainThread](2024-04-25 18:50:50,927) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:50:50,927) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:50:53,895) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:50:54,126) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992001
[3380957:MainThread](2024-04-25 18:50:54,127) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:50:54,127) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:50:57,065) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:50:57,298) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992984
[3380957:MainThread](2024-04-25 18:50:57,299) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:50:57,299) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:51:00,273) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:51:00,503) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992726
[3380957:MainThread](2024-04-25 18:51:00,504) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:51:00,504) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:51:03,499) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:51:03,728) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992139
[3380957:MainThread](2024-04-25 18:51:03,728) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:51:03,729) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:51:06,715) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:51:06,946) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991869
[3380957:MainThread](2024-04-25 18:51:06,947) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:51:06,948) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:51:09,913) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:51:10,143) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992914
[3380957:MainThread](2024-04-25 18:51:10,144) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:51:10,144) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:51:13,103) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:51:13,335) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991619
[3380957:MainThread](2024-04-25 18:51:13,336) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:51:13,336) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:51:16,291) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:51:16,520) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991898
[3380957:MainThread](2024-04-25 18:51:16,520) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:51:16,521) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:51:19,476) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:51:19,706) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991988
[3380957:MainThread](2024-04-25 18:51:19,706) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:51:19,707) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:51:22,658) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:51:22,887) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991538
[3380957:MainThread](2024-04-25 18:51:22,888) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:51:22,889) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:51:25,856) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:51:26,087) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991586
[3380957:MainThread](2024-04-25 18:51:26,088) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:51:26,088) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:51:29,051) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:51:29,281) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991480
[3380957:MainThread](2024-04-25 18:51:29,282) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:51:29,282) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:51:32,242) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:51:32,473) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992264
[3380957:MainThread](2024-04-25 18:51:32,474) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:51:32,474) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:51:35,428) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:51:35,659) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991471
[3380957:MainThread](2024-04-25 18:51:35,660) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:51:35,661) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:51:38,601) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:51:38,832) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992465
[3380957:MainThread](2024-04-25 18:51:38,833) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:51:38,833) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:51:41,796) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:51:42,026) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993124
[3380957:MainThread](2024-04-25 18:51:42,026) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 18:51:42,027) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:51:44,988) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:51:45,219) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992914
[3380957:MainThread](2024-04-25 18:51:45,220) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 18:51:45,220) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:51:48,182) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:51:48,413) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993349
[3380957:MainThread](2024-04-25 18:51:48,413) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 18:51:48,413) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:51:51,372) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:51:51,602) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994471
[3380957:MainThread](2024-04-25 18:51:51,602) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 18:51:51,602) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:51:54,561) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:51:54,790) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994866
[3380957:MainThread](2024-04-25 18:51:54,790) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 18:51:54,791) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:51:57,748) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:51:57,980) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994033
[3380957:MainThread](2024-04-25 18:51:57,980) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[3380957:MainThread](2024-04-25 18:51:57,980) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:52:00,942) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:52:01,172) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994447
[3380957:MainThread](2024-04-25 18:52:01,172) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:52:01,173) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991471 @ 19
[3380957:MainThread](2024-04-25 18:52:01,222) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-01-21 SH600000   -0.040432
           SH600004    0.145653
           SH600009    0.070003
           SH600010    0.007997
           SH600011   -0.039517
[3380957:MainThread](2024-04-25 18:52:02,939) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  59%|█████▉    | 26/44 [34:11<26:03, 86.87s/it][3380957:MainThread](2024-04-25 18:52:02,946) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:52:02,956) INFO - qlib.workflow - [recorder.py:341] - Recorder 1ccf6ab971c74513828b4cc4ecaedb42 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:52:03,639) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:52:03,639) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:52:03,642) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:52:03,643) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:52:11,394) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.978591
            SH600004      0.978591
            SH600006      0.978591
            SH600007      0.978591
            SH600008      0.978591
                            ...   
2017-04-11  SZ300144      1.742480
            SZ300146      1.742480
            SZ300168      1.742480
            SZ300182      1.742480
            SZ300251      1.742480
Length: 624606, dtype: float64
[3380957:MainThread](2024-04-25 18:52:11,396) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:52:11,397) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:52:11,397) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:52:14,322) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:52:14,515) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996363
[3380957:MainThread](2024-04-25 18:52:14,516) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:52:14,516) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:52:17,395) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:52:17,588) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995273
[3380957:MainThread](2024-04-25 18:52:17,589) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:52:17,589) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:52:20,479) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:52:20,673) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994292
[3380957:MainThread](2024-04-25 18:52:20,674) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:52:20,675) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:52:23,554) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:52:23,748) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993465
[3380957:MainThread](2024-04-25 18:52:23,749) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:52:23,749) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:52:26,627) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:52:26,821) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993876
[3380957:MainThread](2024-04-25 18:52:26,821) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:52:26,822) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:52:29,703) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:52:29,897) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992659
[3380957:MainThread](2024-04-25 18:52:29,898) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:52:29,898) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:52:32,795) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:52:32,990) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992379
[3380957:MainThread](2024-04-25 18:52:32,991) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:52:32,991) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:52:35,881) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:52:36,074) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992707
[3380957:MainThread](2024-04-25 18:52:36,075) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:52:36,075) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:52:38,974) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:52:39,168) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992489
[3380957:MainThread](2024-04-25 18:52:39,168) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:52:39,168) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:52:42,066) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:52:42,261) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992362
[3380957:MainThread](2024-04-25 18:52:42,262) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:52:42,262) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:52:45,151) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:52:45,345) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992231
[3380957:MainThread](2024-04-25 18:52:45,346) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:52:45,346) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:52:48,231) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:52:48,425) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993048
[3380957:MainThread](2024-04-25 18:52:48,426) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:52:48,426) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:52:51,308) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:52:51,502) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992410
[3380957:MainThread](2024-04-25 18:52:51,503) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:52:51,503) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:52:54,387) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:52:54,581) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991740
[3380957:MainThread](2024-04-25 18:52:54,582) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:52:54,582) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:52:57,465) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:52:57,659) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992406
[3380957:MainThread](2024-04-25 18:52:57,659) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:52:57,660) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:53:00,545) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:53:00,739) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993143
[3380957:MainThread](2024-04-25 18:53:00,739) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:53:00,739) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:53:03,611) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:53:03,805) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991533
[3380957:MainThread](2024-04-25 18:53:03,806) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:53:03,807) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:53:06,680) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:53:06,874) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992531
[3380957:MainThread](2024-04-25 18:53:06,874) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:53:06,875) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:53:09,749) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:53:09,944) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992293
[3380957:MainThread](2024-04-25 18:53:09,944) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:53:09,944) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:53:12,812) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:53:13,006) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993710
[3380957:MainThread](2024-04-25 18:53:13,006) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:53:13,007) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:53:15,925) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:53:16,118) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992980
[3380957:MainThread](2024-04-25 18:53:16,119) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 18:53:16,119) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:53:19,059) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:53:19,253) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993296
[3380957:MainThread](2024-04-25 18:53:19,253) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 18:53:19,254) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:53:22,189) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:53:22,386) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993227
[3380957:MainThread](2024-04-25 18:53:22,386) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 18:53:22,387) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:53:25,284) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:53:25,480) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993006
[3380957:MainThread](2024-04-25 18:53:25,480) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 18:53:25,481) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:53:28,453) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:53:28,649) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994832
[3380957:MainThread](2024-04-25 18:53:28,650) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:53:28,650) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991533 @ 16
[3380957:MainThread](2024-04-25 18:53:28,759) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-02-25 SH600000    0.214836
           SH600004    0.041761
           SH600009   -0.165193
           SH600010    0.231530
           SH600011    0.060440
[3380957:MainThread](2024-04-25 18:53:30,478) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  61%|██████▏   | 27/44 [35:39<24:40, 87.07s/it][3380957:MainThread](2024-04-25 18:53:30,486) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:53:30,495) INFO - qlib.workflow - [recorder.py:341] - Recorder 38687e067e7e4b2cb56cb65d2e0e993f starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:53:31,212) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:53:31,212) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:53:31,216) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:53:31,216) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:53:39,030) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.927426
            SH600004      0.927426
            SH600006      0.927426
            SH600007      0.927426
            SH600008      0.927426
                            ...   
2017-05-10  SZ300133      1.391275
            SZ300144      1.391275
            SZ300146      1.391275
            SZ300182      1.391275
            SZ300251      1.391275
Length: 630244, dtype: float64
[3380957:MainThread](2024-04-25 18:53:39,032) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:53:39,032) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:53:39,033) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:53:42,064) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:53:42,273) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995424
[3380957:MainThread](2024-04-25 18:53:42,274) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:53:42,275) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:53:45,302) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:53:45,511) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994521
[3380957:MainThread](2024-04-25 18:53:45,513) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:53:45,513) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:53:48,537) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:53:48,746) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994462
[3380957:MainThread](2024-04-25 18:53:48,747) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:53:48,748) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:53:51,762) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:53:51,972) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993822
[3380957:MainThread](2024-04-25 18:53:51,973) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:53:51,973) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:53:54,933) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:53:55,142) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993136
[3380957:MainThread](2024-04-25 18:53:55,143) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:53:55,143) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:53:58,107) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:53:58,318) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994024
[3380957:MainThread](2024-04-25 18:53:58,318) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:53:58,319) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:54:01,280) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:54:01,489) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992519
[3380957:MainThread](2024-04-25 18:54:01,490) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:54:01,490) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:54:04,438) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:54:04,648) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992493
[3380957:MainThread](2024-04-25 18:54:04,649) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:54:04,649) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:54:07,588) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:54:07,796) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992362
[3380957:MainThread](2024-04-25 18:54:07,797) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:54:07,798) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:54:10,736) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:54:10,948) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991838
[3380957:MainThread](2024-04-25 18:54:10,949) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:54:10,949) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:54:13,879) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:54:14,087) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992498
[3380957:MainThread](2024-04-25 18:54:14,088) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:54:14,088) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:54:17,022) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:54:17,230) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992735
[3380957:MainThread](2024-04-25 18:54:17,231) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:54:17,231) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:54:20,169) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:54:20,381) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991495
[3380957:MainThread](2024-04-25 18:54:20,382) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:54:20,383) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:54:23,314) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:54:23,523) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991995
[3380957:MainThread](2024-04-25 18:54:23,523) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:54:23,524) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:54:26,465) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:54:26,673) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991863
[3380957:MainThread](2024-04-25 18:54:26,674) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:54:26,674) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:54:29,620) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:54:29,828) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992150
[3380957:MainThread](2024-04-25 18:54:29,829) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:54:29,829) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:54:32,788) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:54:32,997) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992902
[3380957:MainThread](2024-04-25 18:54:32,997) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:54:32,998) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:54:35,948) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:54:36,156) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992923
[3380957:MainThread](2024-04-25 18:54:36,157) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:54:36,157) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:54:39,098) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:54:39,306) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993877
[3380957:MainThread](2024-04-25 18:54:39,307) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:54:39,307) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:54:42,242) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:54:42,451) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992120
[3380957:MainThread](2024-04-25 18:54:42,451) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:54:42,451) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:54:45,381) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:54:45,590) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993797
[3380957:MainThread](2024-04-25 18:54:45,591) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:54:45,591) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991495 @ 12
[3380957:MainThread](2024-04-25 18:54:45,640) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-03-25 SH600000    0.066954
           SH600004    0.131357
           SH600009    0.097022
           SH600010    0.051608
           SH600011   -0.090934
[3380957:MainThread](2024-04-25 18:54:47,368) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  64%|██████▎   | 28/44 [36:56<22:24, 84.02s/it][3380957:MainThread](2024-04-25 18:54:47,375) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:54:47,385) INFO - qlib.workflow - [recorder.py:341] - Recorder 144ea12ce8714809b8881b7ed95c0f36 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:54:48,101) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:54:48,101) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:54:48,103) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:54:48,103) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:54:55,926) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.856062
            SH600004      1.856062
            SH600006      1.856062
            SH600007      1.856062
            SH600008      1.856062
                            ...   
2017-06-09  SZ300133      1.798143
            SZ300144      1.798143
            SZ300146      1.798143
            SZ300182      1.798143
            SZ300251      1.798143
Length: 635820, dtype: float64
[3380957:MainThread](2024-04-25 18:54:55,928) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:54:55,929) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:54:55,929) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:54:59,010) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:54:59,208) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995684
[3380957:MainThread](2024-04-25 18:54:59,209) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:54:59,210) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:55:02,229) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:55:02,427) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994966
[3380957:MainThread](2024-04-25 18:55:02,428) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:55:02,429) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:55:05,415) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:55:05,614) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993440
[3380957:MainThread](2024-04-25 18:55:05,615) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:55:05,615) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:55:08,604) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:55:08,806) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993711
[3380957:MainThread](2024-04-25 18:55:08,807) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:55:08,807) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:55:11,795) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:55:11,994) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993760
[3380957:MainThread](2024-04-25 18:55:11,994) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:55:11,994) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:55:15,024) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:55:15,223) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993326
[3380957:MainThread](2024-04-25 18:55:15,224) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:55:15,224) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:55:18,280) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:55:18,479) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992467
[3380957:MainThread](2024-04-25 18:55:18,480) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:55:18,480) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:55:21,565) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:55:21,762) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993416
[3380957:MainThread](2024-04-25 18:55:21,763) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:55:21,763) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:55:24,855) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:55:25,054) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993195
[3380957:MainThread](2024-04-25 18:55:25,055) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:55:25,055) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:55:28,103) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:55:28,301) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992359
[3380957:MainThread](2024-04-25 18:55:28,302) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:55:28,303) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:55:31,363) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:55:31,561) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992715
[3380957:MainThread](2024-04-25 18:55:31,562) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:55:31,562) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:55:34,651) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:55:34,851) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992155
[3380957:MainThread](2024-04-25 18:55:34,852) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:55:34,852) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:55:37,923) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:55:38,123) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992905
[3380957:MainThread](2024-04-25 18:55:38,124) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:55:38,124) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:55:41,188) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:55:41,387) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993299
[3380957:MainThread](2024-04-25 18:55:41,387) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:55:41,388) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:55:44,434) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:55:44,633) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992614
[3380957:MainThread](2024-04-25 18:55:44,634) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:55:44,634) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:55:47,704) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:55:47,902) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993070
[3380957:MainThread](2024-04-25 18:55:47,903) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:55:47,903) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:55:50,980) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:55:51,179) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992754
[3380957:MainThread](2024-04-25 18:55:51,180) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:55:51,180) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:55:54,180) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:55:54,379) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992310
[3380957:MainThread](2024-04-25 18:55:54,379) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:55:54,379) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:55:57,389) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:55:57,589) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994296
[3380957:MainThread](2024-04-25 18:55:57,589) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:55:57,589) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:56:00,620) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:56:00,819) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993471
[3380957:MainThread](2024-04-25 18:56:00,820) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:56:00,820) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992155 @ 11
[3380957:MainThread](2024-04-25 18:56:00,869) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-04-23 SH600000    0.061884
           SH600004   -0.035725
           SH600009   -0.220032
           SH600010    0.007223
           SH600011   -0.017138
[3380957:MainThread](2024-04-25 18:56:02,588) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  66%|██████▌   | 29/44 [38:11<20:20, 81.38s/it][3380957:MainThread](2024-04-25 18:56:02,596) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:56:02,605) INFO - qlib.workflow - [recorder.py:341] - Recorder 3f29f6a0f6dd46c18bb5e15fa6025215 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:56:03,304) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:56:03,305) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:56:03,308) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:56:03,309) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:56:11,145) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.448101
            SH600004      1.448101
            SH600006      1.448101
            SH600007      1.448101
            SH600008      1.448101
                            ...   
2017-07-07  SZ300133      1.381555
            SZ300144      1.381555
            SZ300168      1.381555
            SZ300251      1.381555
            SZ300315      1.381555
Length: 641204, dtype: float64
[3380957:MainThread](2024-04-25 18:56:11,147) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:56:11,147) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:56:11,148) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:56:14,176) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:56:14,387) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995613
[3380957:MainThread](2024-04-25 18:56:14,388) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:56:14,388) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:56:17,430) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:56:17,640) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995088
[3380957:MainThread](2024-04-25 18:56:17,641) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:56:17,641) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:56:20,714) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:56:20,926) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994056
[3380957:MainThread](2024-04-25 18:56:20,927) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:56:20,927) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:56:23,958) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:56:24,169) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993398
[3380957:MainThread](2024-04-25 18:56:24,170) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:56:24,171) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:56:27,192) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:56:27,403) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993176
[3380957:MainThread](2024-04-25 18:56:27,404) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:56:27,405) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:56:30,422) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:56:30,634) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992837
[3380957:MainThread](2024-04-25 18:56:30,635) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:56:30,635) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:56:33,680) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:56:33,890) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995231
[3380957:MainThread](2024-04-25 18:56:33,890) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:56:33,891) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:56:36,947) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:56:37,158) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992275
[3380957:MainThread](2024-04-25 18:56:37,159) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:56:37,159) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:56:40,212) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:56:40,422) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993194
[3380957:MainThread](2024-04-25 18:56:40,423) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:56:40,423) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:56:43,491) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:56:43,702) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992369
[3380957:MainThread](2024-04-25 18:56:43,703) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:56:43,703) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:56:46,748) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:56:46,958) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992940
[3380957:MainThread](2024-04-25 18:56:46,959) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:56:46,959) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:56:50,024) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:56:50,236) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993669
[3380957:MainThread](2024-04-25 18:56:50,236) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:56:50,236) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:56:53,315) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:56:53,527) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991680
[3380957:MainThread](2024-04-25 18:56:53,528) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:56:53,528) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:56:56,565) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:56:56,775) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994206
[3380957:MainThread](2024-04-25 18:56:56,776) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:56:56,776) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:56:59,762) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:56:59,974) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992236
[3380957:MainThread](2024-04-25 18:56:59,974) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:56:59,975) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:57:02,969) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:57:03,180) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993978
[3380957:MainThread](2024-04-25 18:57:03,181) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 18:57:03,181) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:57:06,169) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:57:06,379) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992291
[3380957:MainThread](2024-04-25 18:57:06,380) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 18:57:06,380) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:57:09,360) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:57:09,571) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992361
[3380957:MainThread](2024-04-25 18:57:09,572) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 18:57:09,572) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:57:12,606) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:57:12,817) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994725
[3380957:MainThread](2024-04-25 18:57:12,818) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 18:57:12,818) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:57:15,848) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:57:16,059) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995336
[3380957:MainThread](2024-04-25 18:57:16,059) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 18:57:16,060) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:57:19,155) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:57:19,367) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993774
[3380957:MainThread](2024-04-25 18:57:19,367) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:57:19,368) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991680 @ 12
[3380957:MainThread](2024-04-25 18:57:19,418) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-05-24 SH600000   -0.076311
           SH600004   -0.070533
           SH600009    0.049419
           SH600010   -0.135033
           SH600011   -0.075778
[3380957:MainThread](2024-04-25 18:57:21,133) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  68%|██████▊   | 30/44 [39:29<18:47, 80.53s/it][3380957:MainThread](2024-04-25 18:57:21,141) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:57:21,150) INFO - qlib.workflow - [recorder.py:341] - Recorder f21978ca575f47b8b633633a5f17ea2e starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:57:21,855) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:57:21,857) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:57:21,862) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:57:21,863) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:57:29,620) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.774792
            SH600004      0.774792
            SH600006      0.774792
            SH600007      0.774792
            SH600008      0.774792
                            ...   
2017-08-04  SZ300133      1.041838
            SZ300144      1.041838
            SZ300168      1.041838
            SZ300251      1.041838
            SZ300315      1.041838
Length: 646851, dtype: float64
[3380957:MainThread](2024-04-25 18:57:29,622) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:57:29,622) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:57:29,623) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:57:32,666) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:57:32,902) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995255
[3380957:MainThread](2024-04-25 18:57:32,903) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:57:32,903) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:57:35,901) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:57:36,134) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994599
[3380957:MainThread](2024-04-25 18:57:36,135) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:57:36,135) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:57:39,148) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:57:39,381) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993729
[3380957:MainThread](2024-04-25 18:57:39,382) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:57:39,383) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:57:42,378) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:57:42,611) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993172
[3380957:MainThread](2024-04-25 18:57:42,612) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:57:42,612) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:57:45,611) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:57:45,844) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993085
[3380957:MainThread](2024-04-25 18:57:45,845) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:57:45,845) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:57:48,844) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:57:49,076) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992773
[3380957:MainThread](2024-04-25 18:57:49,077) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:57:49,077) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:57:52,079) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:57:52,312) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992989
[3380957:MainThread](2024-04-25 18:57:52,312) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:57:52,313) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:57:55,312) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:57:55,546) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993306
[3380957:MainThread](2024-04-25 18:57:55,546) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:57:55,547) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:57:58,630) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:57:58,862) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992819
[3380957:MainThread](2024-04-25 18:57:58,862) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:57:58,863) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:58:01,915) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:58:02,148) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993591
[3380957:MainThread](2024-04-25 18:58:02,149) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:58:02,149) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:58:05,157) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:58:05,391) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993416
[3380957:MainThread](2024-04-25 18:58:05,391) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:58:05,391) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:58:08,395) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:58:08,628) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993401
[3380957:MainThread](2024-04-25 18:58:08,629) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:58:08,629) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:58:11,632) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:58:11,869) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993009
[3380957:MainThread](2024-04-25 18:58:11,869) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:58:11,869) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:58:14,869) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:58:15,102) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993569
[3380957:MainThread](2024-04-25 18:58:15,102) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:58:15,103) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992773 @ 5
[3380957:MainThread](2024-04-25 18:58:15,148) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-06-24 SH600000    0.020254
           SH600004   -0.220619
           SH600009   -0.144375
           SH600010   -0.021080
           SH600011    0.061726
[3380957:MainThread](2024-04-25 18:58:16,823) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  70%|███████   | 31/44 [40:25<15:49, 73.08s/it][3380957:MainThread](2024-04-25 18:58:16,830) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:58:16,839) INFO - qlib.workflow - [recorder.py:341] - Recorder ad15da6f871b4478ab8c89e4d422ff6e starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:58:17,531) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:58:17,531) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:58:17,533) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:58:17,534) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:58:25,196) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.704366
            SH600004      0.704366
            SH600006      0.704366
            SH600007      0.704366
            SH600008      0.704366
                            ...   
2017-09-01  SZ300133      1.498607
            SZ300144      1.498607
            SZ300168      1.498607
            SZ300251      1.498607
            SZ300315      1.498607
Length: 652446, dtype: float64
[3380957:MainThread](2024-04-25 18:58:25,198) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:58:25,198) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:58:25,199) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:58:28,232) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:58:28,439) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995577
[3380957:MainThread](2024-04-25 18:58:28,440) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:58:28,440) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:58:31,478) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:58:31,685) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995341
[3380957:MainThread](2024-04-25 18:58:31,686) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:58:31,686) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:58:34,705) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:58:34,912) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994189
[3380957:MainThread](2024-04-25 18:58:34,913) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:58:34,913) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:58:37,937) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:58:38,144) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993606
[3380957:MainThread](2024-04-25 18:58:38,145) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:58:38,146) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:58:41,161) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:58:41,369) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993826
[3380957:MainThread](2024-04-25 18:58:41,369) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:58:41,370) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:58:44,377) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:58:44,584) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993545
[3380957:MainThread](2024-04-25 18:58:44,585) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:58:44,585) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:58:47,590) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:58:47,797) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993125
[3380957:MainThread](2024-04-25 18:58:47,798) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:58:47,799) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:58:50,804) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:58:51,011) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991897
[3380957:MainThread](2024-04-25 18:58:51,012) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:58:51,013) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:58:54,080) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:58:54,286) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993572
[3380957:MainThread](2024-04-25 18:58:54,287) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:58:54,287) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:58:57,357) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:58:57,564) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993139
[3380957:MainThread](2024-04-25 18:58:57,564) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 18:58:57,565) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:59:00,646) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:59:00,853) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993032
[3380957:MainThread](2024-04-25 18:59:00,854) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 18:59:00,854) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:59:03,952) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:59:04,161) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994141
[3380957:MainThread](2024-04-25 18:59:04,162) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 18:59:04,162) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:59:07,278) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:59:07,487) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994772
[3380957:MainThread](2024-04-25 18:59:07,488) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 18:59:07,488) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:59:10,603) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:59:10,812) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992855
[3380957:MainThread](2024-04-25 18:59:10,812) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 18:59:10,813) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:59:13,931) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:59:14,140) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995009
[3380957:MainThread](2024-04-25 18:59:14,141) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 18:59:14,141) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:59:17,256) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:59:17,469) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994027
[3380957:MainThread](2024-04-25 18:59:17,469) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 18:59:17,469) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991897 @ 7
[3380957:MainThread](2024-04-25 18:59:17,515) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-07-22 SH600000    0.015272
           SH600004   -0.001096
           SH600009   -0.058357
           SH600010   -0.028178
           SH600011    0.017302
[3380957:MainThread](2024-04-25 18:59:18,893) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  73%|███████▎  | 32/44 [41:27<13:57, 69.77s/it][3380957:MainThread](2024-04-25 18:59:18,901) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 18:59:18,912) INFO - qlib.workflow - [recorder.py:341] - Recorder 59006b973da949cfb7317ec9d85eae05 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 18:59:19,623) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 18:59:19,624) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 18:59:19,627) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 18:59:19,628) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 18:59:27,318) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.332682
            SH600004      1.332682
            SH600006      1.332682
            SH600007      1.332682
            SH600008      1.332682
                            ...   
2017-09-29  SZ300133      1.673046
            SZ300144      1.673046
            SZ300168      1.673046
            SZ300251      1.673046
            SZ300315      1.673046
Length: 658139, dtype: float64
[3380957:MainThread](2024-04-25 18:59:27,320) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 18:59:27,321) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 18:59:27,321) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:59:30,483) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:59:30,715) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995719
[3380957:MainThread](2024-04-25 18:59:30,716) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 18:59:30,716) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:59:33,866) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:59:34,099) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995607
[3380957:MainThread](2024-04-25 18:59:34,100) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 18:59:34,100) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:59:37,252) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:59:37,486) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994843
[3380957:MainThread](2024-04-25 18:59:37,487) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 18:59:37,488) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:59:40,606) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:59:40,843) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993824
[3380957:MainThread](2024-04-25 18:59:40,844) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 18:59:40,844) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:59:44,031) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:59:44,267) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993779
[3380957:MainThread](2024-04-25 18:59:44,268) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 18:59:44,268) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:59:47,452) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:59:47,688) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992924
[3380957:MainThread](2024-04-25 18:59:47,689) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 18:59:47,689) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:59:50,870) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:59:51,107) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993671
[3380957:MainThread](2024-04-25 18:59:51,107) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 18:59:51,107) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:59:54,276) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:59:54,509) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992471
[3380957:MainThread](2024-04-25 18:59:54,511) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 18:59:54,511) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 18:59:57,631) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 18:59:57,868) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992758
[3380957:MainThread](2024-04-25 18:59:57,868) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 18:59:57,869) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:00:00,984) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:00:01,221) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992340
[3380957:MainThread](2024-04-25 19:00:01,222) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:00:01,222) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:00:04,341) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:00:04,578) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992987
[3380957:MainThread](2024-04-25 19:00:04,578) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:00:04,579) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:00:07,735) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:00:07,968) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993098
[3380957:MainThread](2024-04-25 19:00:07,968) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:00:07,968) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:00:11,168) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:00:11,404) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994202
[3380957:MainThread](2024-04-25 19:00:11,405) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:00:11,405) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:00:14,580) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:00:14,816) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993207
[3380957:MainThread](2024-04-25 19:00:14,817) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:00:14,817) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:00:17,936) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:00:18,174) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993128
[3380957:MainThread](2024-04-25 19:00:18,174) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:00:18,174) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:00:21,280) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:00:21,514) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993769
[3380957:MainThread](2024-04-25 19:00:21,515) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:00:21,515) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:00:24,630) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:00:24,864) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993086
[3380957:MainThread](2024-04-25 19:00:24,865) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:00:24,865) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:00:27,969) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:00:28,203) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994041
[3380957:MainThread](2024-04-25 19:00:28,203) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:00:28,203) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992340 @ 9
[3380957:MainThread](2024-04-25 19:00:28,404) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-08-19 SH600000    0.005355
           SH600004    0.000529
           SH600009    0.024203
           SH600010   -0.042772
           SH600011   -0.042653
[3380957:MainThread](2024-04-25 19:00:30,173) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  75%|███████▌  | 33/44 [42:38<12:52, 70.23s/it][3380957:MainThread](2024-04-25 19:00:30,181) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 19:00:30,190) INFO - qlib.workflow - [recorder.py:341] - Recorder 6884123c48104a55af4d98ed83dc5372 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 19:00:30,880) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:00:30,881) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:00:30,884) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:00:30,885) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:00:38,669) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.16148
            SH600004      1.16148
            SH600006      1.16148
            SH600007      1.16148
            SH600008      1.16148
                           ...   
2017-11-03  SZ300133      1.71040
            SZ300144      1.71040
            SZ300168      1.71040
            SZ300251      1.71040
            SZ300315      1.71040
Length: 663832, dtype: float64
[3380957:MainThread](2024-04-25 19:00:38,671) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:00:38,672) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:00:38,672) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:00:41,874) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:00:42,111) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996911
[3380957:MainThread](2024-04-25 19:00:42,112) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:00:42,112) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:00:45,227) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:00:45,461) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996214
[3380957:MainThread](2024-04-25 19:00:45,462) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:00:45,462) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:00:48,573) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:00:48,806) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994438
[3380957:MainThread](2024-04-25 19:00:48,807) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:00:48,807) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:00:51,970) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:00:52,204) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994211
[3380957:MainThread](2024-04-25 19:00:52,205) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:00:52,206) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:00:55,320) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:00:55,554) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994551
[3380957:MainThread](2024-04-25 19:00:55,555) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:00:55,555) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:00:58,764) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:00:59,002) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995651
[3380957:MainThread](2024-04-25 19:00:59,003) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:00:59,003) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:01:02,114) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:01:02,347) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993792
[3380957:MainThread](2024-04-25 19:01:02,348) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:01:02,348) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:01:05,443) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:01:05,676) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994083
[3380957:MainThread](2024-04-25 19:01:05,676) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:01:05,676) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:01:08,770) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:01:09,002) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994029
[3380957:MainThread](2024-04-25 19:01:09,003) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:01:09,003) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:01:12,096) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:01:12,329) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993840
[3380957:MainThread](2024-04-25 19:01:12,329) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:01:12,329) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:01:15,483) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:01:15,718) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993657
[3380957:MainThread](2024-04-25 19:01:15,719) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:01:15,720) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:01:18,880) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:01:19,113) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993505
[3380957:MainThread](2024-04-25 19:01:19,114) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:01:19,114) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:01:22,283) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:01:22,522) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993198
[3380957:MainThread](2024-04-25 19:01:22,523) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:01:22,523) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:01:25,735) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:01:25,970) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994568
[3380957:MainThread](2024-04-25 19:01:25,970) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:01:25,971) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:01:29,184) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:01:29,419) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994441
[3380957:MainThread](2024-04-25 19:01:29,419) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:01:29,419) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:01:32,625) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:01:32,860) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994028
[3380957:MainThread](2024-04-25 19:01:32,861) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:01:32,861) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:01:36,060) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:01:36,297) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994364
[3380957:MainThread](2024-04-25 19:01:36,297) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:01:36,298) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:01:39,499) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:01:39,736) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994251
[3380957:MainThread](2024-04-25 19:01:39,736) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:01:39,737) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:01:42,954) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:01:43,188) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992976
[3380957:MainThread](2024-04-25 19:01:43,190) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:01:43,190) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:01:46,392) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:01:46,629) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995757
[3380957:MainThread](2024-04-25 19:01:46,630) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:01:46,630) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:01:49,772) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:01:50,009) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994136
[3380957:MainThread](2024-04-25 19:01:50,010) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:01:50,010) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:01:53,208) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:01:53,443) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995429
[3380957:MainThread](2024-04-25 19:01:53,443) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 19:01:53,443) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:01:56,629) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:01:56,863) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995517
[3380957:MainThread](2024-04-25 19:01:56,863) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 19:01:56,864) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:02:00,002) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:02:00,236) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995160
[3380957:MainThread](2024-04-25 19:02:00,236) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 19:02:00,236) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:02:03,331) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:02:03,565) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995609
[3380957:MainThread](2024-04-25 19:02:03,566) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 19:02:03,566) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:02:06,677) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:02:06,913) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996416
[3380957:MainThread](2024-04-25 19:02:06,913) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 19:02:06,913) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:02:10,022) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:02:10,258) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997804
[3380957:MainThread](2024-04-25 19:02:10,258) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:02:10,258) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992976 @ 18
[3380957:MainThread](2024-04-25 19:02:10,308) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-09-17 SH600000    0.079941
           SH600004    0.219281
           SH600009    0.043846
           SH600010    0.013470
           SH600011   -0.039719
[3380957:MainThread](2024-04-25 19:02:12,020) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  77%|███████▋  | 34/44 [44:20<13:17, 79.71s/it][3380957:MainThread](2024-04-25 19:02:12,028) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 19:02:12,037) INFO - qlib.workflow - [recorder.py:341] - Recorder 8264a934e3914bcda0c5ca58d2a2d3f9 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 19:02:12,735) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:02:12,735) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:02:12,738) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:02:12,739) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:02:20,477) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.650605
            SH600004      0.650605
            SH600006      0.650605
            SH600007      0.650605
            SH600008      0.650605
                            ...   
2017-12-01  SZ300133      1.075215
            SZ300144      1.075215
            SZ300168      1.075215
            SZ300251      1.075215
            SZ300315      1.075215
Length: 669550, dtype: float64
[3380957:MainThread](2024-04-25 19:02:20,509) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:02:20,510) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:02:20,510) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:02:23,713) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:02:23,948) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996107
[3380957:MainThread](2024-04-25 19:02:23,949) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:02:23,949) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:02:27,102) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:02:27,341) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994787
[3380957:MainThread](2024-04-25 19:02:27,342) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:02:27,343) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:02:30,490) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:02:30,728) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994805
[3380957:MainThread](2024-04-25 19:02:30,728) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:02:30,728) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:02:33,905) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:02:34,144) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994303
[3380957:MainThread](2024-04-25 19:02:34,145) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:02:34,145) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:02:37,383) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:02:37,620) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994313
[3380957:MainThread](2024-04-25 19:02:37,620) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:02:37,620) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:02:40,833) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:02:41,071) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993948
[3380957:MainThread](2024-04-25 19:02:41,072) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:02:41,073) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:02:44,223) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:02:44,461) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993762
[3380957:MainThread](2024-04-25 19:02:44,462) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:02:44,462) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:02:47,637) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:02:47,875) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994073
[3380957:MainThread](2024-04-25 19:02:47,875) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:02:47,875) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:02:51,021) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:02:51,259) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993879
[3380957:MainThread](2024-04-25 19:02:51,259) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:02:51,260) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:02:54,388) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:02:54,626) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993838
[3380957:MainThread](2024-04-25 19:02:54,626) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:02:54,627) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:02:57,761) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:02:57,997) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995592
[3380957:MainThread](2024-04-25 19:02:57,997) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:02:57,997) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:03:01,092) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:03:01,326) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993183
[3380957:MainThread](2024-04-25 19:03:01,327) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:03:01,328) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:03:04,430) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:03:04,665) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993071
[3380957:MainThread](2024-04-25 19:03:04,666) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:03:04,666) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:03:07,781) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:03:08,016) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993483
[3380957:MainThread](2024-04-25 19:03:08,016) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:03:08,017) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:03:11,122) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:03:11,360) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993943
[3380957:MainThread](2024-04-25 19:03:11,360) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:03:11,361) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:03:14,458) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:03:14,693) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995166
[3380957:MainThread](2024-04-25 19:03:14,693) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:03:14,693) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:03:17,833) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:03:18,068) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994688
[3380957:MainThread](2024-04-25 19:03:18,068) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:03:18,068) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:03:21,197) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:03:21,436) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993888
[3380957:MainThread](2024-04-25 19:03:21,436) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:03:21,436) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:03:24,528) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:03:24,762) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994983
[3380957:MainThread](2024-04-25 19:03:24,762) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:03:24,763) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:03:27,856) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:03:28,090) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994293
[3380957:MainThread](2024-04-25 19:03:28,091) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:03:28,091) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:03:31,194) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:03:31,427) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996500
[3380957:MainThread](2024-04-25 19:03:31,428) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:03:31,428) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993071 @ 12
[3380957:MainThread](2024-04-25 19:03:31,478) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-10-22 SH600000    0.087410
           SH600004    0.150245
           SH600009   -0.124615
           SH600010   -0.020054
           SH600011   -0.052337
[3380957:MainThread](2024-04-25 19:03:33,206) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  80%|███████▉  | 35/44 [45:41<12:01, 80.15s/it][3380957:MainThread](2024-04-25 19:03:33,214) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 19:03:33,223) INFO - qlib.workflow - [recorder.py:341] - Recorder 66c530e088fa4c7592ecc0a2c596b6f4 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 19:03:33,914) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:03:33,915) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:03:33,917) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:03:33,918) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:03:41,718) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.712725
            SH600004      0.712725
            SH600006      0.712725
            SH600007      0.712725
            SH600008      0.712725
                            ...   
2017-12-29  SZ300124      1.556143
            SZ300136      1.556143
            SZ300144      1.556143
            SZ300251      1.556143
            SZ300315      1.556143
Length: 675267, dtype: float64
[3380957:MainThread](2024-04-25 19:03:41,720) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:03:41,720) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:03:41,721) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:03:44,972) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:03:45,180) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997816
[3380957:MainThread](2024-04-25 19:03:45,182) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:03:45,182) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:03:48,457) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:03:48,667) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995475
[3380957:MainThread](2024-04-25 19:03:48,668) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:03:48,669) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:03:51,891) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:03:52,101) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994639
[3380957:MainThread](2024-04-25 19:03:52,102) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:03:52,103) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:03:55,299) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:03:55,510) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995329
[3380957:MainThread](2024-04-25 19:03:55,510) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:03:55,510) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:03:58,701) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:03:58,912) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994389
[3380957:MainThread](2024-04-25 19:03:58,913) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:03:58,913) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:04:02,096) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:04:02,307) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994948
[3380957:MainThread](2024-04-25 19:04:02,307) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:04:02,307) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:04:05,506) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:04:05,717) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994697
[3380957:MainThread](2024-04-25 19:04:05,717) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:04:05,718) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:04:08,910) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:04:09,121) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994840
[3380957:MainThread](2024-04-25 19:04:09,121) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:04:09,122) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:04:12,304) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:04:12,514) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995185
[3380957:MainThread](2024-04-25 19:04:12,514) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:04:12,514) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:04:15,655) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:04:15,864) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996055
[3380957:MainThread](2024-04-25 19:04:15,864) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:04:15,864) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:04:19,018) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:04:19,227) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994324
[3380957:MainThread](2024-04-25 19:04:19,228) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:04:19,228) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:04:22,388) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:04:22,596) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994241
[3380957:MainThread](2024-04-25 19:04:22,597) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:04:22,598) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:04:25,753) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:04:25,962) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995182
[3380957:MainThread](2024-04-25 19:04:25,962) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:04:25,963) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:04:29,117) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:04:29,327) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995791
[3380957:MainThread](2024-04-25 19:04:29,327) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:04:29,327) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:04:32,489) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:04:32,698) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995357
[3380957:MainThread](2024-04-25 19:04:32,699) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:04:32,699) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:04:35,860) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:04:36,069) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996278
[3380957:MainThread](2024-04-25 19:04:36,070) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:04:36,070) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:04:39,240) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:04:39,449) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995115
[3380957:MainThread](2024-04-25 19:04:39,450) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:04:39,450) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:04:42,629) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:04:42,839) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996014
[3380957:MainThread](2024-04-25 19:04:42,839) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:04:42,840) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:04:45,995) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:04:46,204) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995546
[3380957:MainThread](2024-04-25 19:04:46,204) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:04:46,205) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:04:49,363) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:04:49,573) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995700
[3380957:MainThread](2024-04-25 19:04:49,573) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:04:49,574) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.994241 @ 11
[3380957:MainThread](2024-04-25 19:04:49,624) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-11-19 SH600000   -0.028073
           SH600004   -0.021124
           SH600009   -0.008680
           SH600010   -0.040984
           SH600011    0.072998
[3380957:MainThread](2024-04-25 19:04:51,335) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  82%|████████▏ | 36/44 [46:59<10:36, 79.55s/it][3380957:MainThread](2024-04-25 19:04:51,343) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 19:04:51,352) INFO - qlib.workflow - [recorder.py:341] - Recorder c283bd7dcdcc433fab58912a12b3a659 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 19:04:52,024) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:04:52,025) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:04:52,027) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:04:52,027) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:04:59,717) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.776269
            SH600004      0.776269
            SH600006      0.776269
            SH600007      0.776269
            SH600008      0.776269
                            ...   
2018-01-29  SZ300124      1.931228
            SZ300136      1.931228
            SZ300144      1.931228
            SZ300251      1.931228
            SZ300315      1.931228
Length: 680999, dtype: float64
[3380957:MainThread](2024-04-25 19:04:59,719) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:04:59,719) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:04:59,720) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:05:02,895) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:05:03,127) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996758
[3380957:MainThread](2024-04-25 19:05:03,128) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:05:03,128) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:05:06,301) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:05:06,533) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996132
[3380957:MainThread](2024-04-25 19:05:06,534) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:05:06,534) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:05:09,677) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:05:09,910) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995544
[3380957:MainThread](2024-04-25 19:05:09,911) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:05:09,911) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:05:13,014) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:05:13,247) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995152
[3380957:MainThread](2024-04-25 19:05:13,248) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:05:13,248) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:05:16,410) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:05:16,642) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995050
[3380957:MainThread](2024-04-25 19:05:16,643) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:05:16,643) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:05:19,834) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:05:20,068) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995647
[3380957:MainThread](2024-04-25 19:05:20,068) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:05:20,068) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:05:23,280) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:05:23,516) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994417
[3380957:MainThread](2024-04-25 19:05:23,517) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:05:23,517) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:05:26,721) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:05:26,955) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994153
[3380957:MainThread](2024-04-25 19:05:26,956) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:05:26,957) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:05:30,162) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:05:30,394) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994427
[3380957:MainThread](2024-04-25 19:05:30,395) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:05:30,395) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:05:33,596) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:05:33,834) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994759
[3380957:MainThread](2024-04-25 19:05:33,835) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:05:33,835) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:05:37,073) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:05:37,309) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995350
[3380957:MainThread](2024-04-25 19:05:37,310) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:05:37,310) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:05:40,536) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:05:40,771) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995495
[3380957:MainThread](2024-04-25 19:05:40,772) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:05:40,772) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:05:44,024) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:05:44,256) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996671
[3380957:MainThread](2024-04-25 19:05:44,257) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:05:44,257) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:05:47,499) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:05:47,737) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995778
[3380957:MainThread](2024-04-25 19:05:47,737) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:05:47,738) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:05:51,003) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:05:51,239) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995110
[3380957:MainThread](2024-04-25 19:05:51,240) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:05:51,240) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:05:54,441) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:05:54,676) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995975
[3380957:MainThread](2024-04-25 19:05:54,676) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:05:54,677) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.994153 @ 7
[3380957:MainThread](2024-04-25 19:05:54,727) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-12-17 SH600000   -0.025572
           SH600004    0.049704
           SH600009    0.047725
           SH600010   -0.070881
           SH600011    0.011704
[3380957:MainThread](2024-04-25 19:05:56,490) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  84%|████████▍ | 37/44 [48:05<08:46, 75.23s/it][3380957:MainThread](2024-04-25 19:05:56,497) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 19:05:56,507) INFO - qlib.workflow - [recorder.py:341] - Recorder 6432274c05414416a551537b8a9148c5 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 19:05:57,283) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:05:57,284) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:05:57,287) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:05:57,287) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:06:05,069) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.892654
            SH600004      0.892654
            SH600006      0.892654
            SH600007      0.892654
            SH600008      0.892654
                            ...   
2018-03-05  SZ300124      1.983090
            SZ300136      1.983090
            SZ300144      1.983090
            SZ300251      1.983090
            SZ300315      1.983090
Length: 686698, dtype: float64
[3380957:MainThread](2024-04-25 19:06:05,071) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:06:05,071) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:06:05,072) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:06:08,532) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:06:08,765) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998392
[3380957:MainThread](2024-04-25 19:06:08,766) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:06:08,766) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:06:11,966) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:06:12,197) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995412
[3380957:MainThread](2024-04-25 19:06:12,198) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:06:12,198) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:06:15,391) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:06:15,623) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995553
[3380957:MainThread](2024-04-25 19:06:15,623) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:06:15,624) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:06:18,906) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:06:19,140) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994918
[3380957:MainThread](2024-04-25 19:06:19,141) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:06:19,142) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:06:22,428) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:06:22,660) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995245
[3380957:MainThread](2024-04-25 19:06:22,660) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:06:22,661) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:06:25,952) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:06:26,187) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997193
[3380957:MainThread](2024-04-25 19:06:26,188) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:06:26,188) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:06:29,471) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:06:29,703) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994770
[3380957:MainThread](2024-04-25 19:06:29,704) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:06:29,705) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:06:33,011) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:06:33,245) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994578
[3380957:MainThread](2024-04-25 19:06:33,246) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:06:33,246) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:06:36,534) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:06:36,768) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995543
[3380957:MainThread](2024-04-25 19:06:36,768) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:06:36,768) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:06:40,009) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:06:40,243) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995081
[3380957:MainThread](2024-04-25 19:06:40,244) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:06:40,244) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:06:43,501) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:06:43,732) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995239
[3380957:MainThread](2024-04-25 19:06:43,732) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:06:43,733) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:06:47,003) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:06:47,234) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995127
[3380957:MainThread](2024-04-25 19:06:47,234) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:06:47,235) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:06:50,485) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:06:50,718) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995209
[3380957:MainThread](2024-04-25 19:06:50,719) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:06:50,719) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:06:53,992) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:06:54,224) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995135
[3380957:MainThread](2024-04-25 19:06:54,224) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:06:54,225) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:06:57,500) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:06:57,733) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994806
[3380957:MainThread](2024-04-25 19:06:57,733) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:06:57,733) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:07:01,010) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:07:01,243) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996170
[3380957:MainThread](2024-04-25 19:07:01,243) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:07:01,244) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.994578 @ 7
[3380957:MainThread](2024-04-25 19:07:01,326) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-01-15 SH600000   -0.024357
           SH600004   -0.002876
           SH600009   -0.101567
           SH600010    0.007986
           SH600011   -0.030901
[3380957:MainThread](2024-04-25 19:07:03,046) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  86%|████████▋ | 38/44 [49:11<07:15, 72.63s/it][3380957:MainThread](2024-04-25 19:07:03,054) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 19:07:03,063) INFO - qlib.workflow - [recorder.py:341] - Recorder 641d015713c0433a8552826b1d3fd445 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 19:07:03,809) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:07:03,810) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:07:03,812) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:07:03,813) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:07:11,673) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.644439
            SH600004      0.644439
            SH600006      0.644439
            SH600007      0.644439
            SH600008      0.644439
                            ...   
2018-04-02  SZ300124      1.922787
            SZ300136      1.922787
            SZ300144      1.922787
            SZ300251      1.922787
            SZ300315      1.922787
Length: 692433, dtype: float64
[3380957:MainThread](2024-04-25 19:07:11,675) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:07:11,675) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:07:11,676) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:07:15,019) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:07:15,227) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999250
[3380957:MainThread](2024-04-25 19:07:15,229) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:07:15,229) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:07:18,552) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:07:18,761) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996748
[3380957:MainThread](2024-04-25 19:07:18,762) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:07:18,762) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:07:22,067) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:07:22,274) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995717
[3380957:MainThread](2024-04-25 19:07:22,275) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:07:22,275) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:07:25,536) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:07:25,743) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995349
[3380957:MainThread](2024-04-25 19:07:25,744) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:07:25,744) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:07:28,975) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:07:29,183) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995796
[3380957:MainThread](2024-04-25 19:07:29,184) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:07:29,184) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:07:32,414) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:07:32,621) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996219
[3380957:MainThread](2024-04-25 19:07:32,622) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:07:32,622) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:07:35,869) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:07:36,077) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995329
[3380957:MainThread](2024-04-25 19:07:36,078) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:07:36,079) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:07:39,321) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:07:39,528) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996548
[3380957:MainThread](2024-04-25 19:07:39,529) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:07:39,529) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:07:42,764) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:07:42,975) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997717
[3380957:MainThread](2024-04-25 19:07:42,976) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:07:42,976) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:07:46,287) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:07:46,496) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999038
[3380957:MainThread](2024-04-25 19:07:46,496) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:07:46,497) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:07:49,780) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:07:49,991) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996618
[3380957:MainThread](2024-04-25 19:07:49,992) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:07:49,992) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:07:53,301) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:07:53,511) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996090
[3380957:MainThread](2024-04-25 19:07:53,511) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:07:53,511) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:07:56,845) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:07:57,053) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996442
[3380957:MainThread](2024-04-25 19:07:57,053) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:07:57,053) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:08:00,384) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:08:00,593) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997661
[3380957:MainThread](2024-04-25 19:08:00,594) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:08:00,594) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:08:03,875) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:08:04,090) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997241
[3380957:MainThread](2024-04-25 19:08:04,091) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:08:04,091) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995329 @ 6
[3380957:MainThread](2024-04-25 19:08:04,313) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-02-20 SH600000   -0.053049
           SH600004    0.109362
           SH600009    0.010741
           SH600010   -0.031265
           SH600011   -0.037379
[3380957:MainThread](2024-04-25 19:08:06,030) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  89%|████████▊ | 39/44 [50:14<05:48, 69.74s/it][3380957:MainThread](2024-04-25 19:08:06,047) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 19:08:06,057) INFO - qlib.workflow - [recorder.py:341] - Recorder 71908046c16842199a701bd6d61e03dc starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 19:08:06,775) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:08:06,775) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:08:06,777) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:08:06,777) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:08:14,563) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.706023
            SH600004      0.706023
            SH600006      0.706023
            SH600007      0.706023
            SH600008      0.706023
                            ...   
2018-05-04  SZ300124      1.754306
            SZ300136      1.754306
            SZ300144      1.754306
            SZ300251      1.754306
            SZ300315      1.754306
Length: 698132, dtype: float64
[3380957:MainThread](2024-04-25 19:08:14,565) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:08:14,566) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:08:14,566) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:08:17,902) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:08:18,110) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996734
[3380957:MainThread](2024-04-25 19:08:18,111) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:08:18,111) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:08:21,404) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:08:21,612) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996984
[3380957:MainThread](2024-04-25 19:08:21,612) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:08:21,613) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:08:24,899) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:08:25,105) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996985
[3380957:MainThread](2024-04-25 19:08:25,105) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:08:25,106) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:08:28,437) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:08:28,644) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996407
[3380957:MainThread](2024-04-25 19:08:28,645) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:08:28,646) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:08:31,980) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:08:32,189) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997929
[3380957:MainThread](2024-04-25 19:08:32,189) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:08:32,190) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:08:35,490) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:08:35,701) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995706
[3380957:MainThread](2024-04-25 19:08:35,702) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:08:35,703) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:08:38,983) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:08:39,191) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995687
[3380957:MainThread](2024-04-25 19:08:39,192) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:08:39,192) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:08:42,478) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:08:42,686) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995887
[3380957:MainThread](2024-04-25 19:08:42,686) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:08:42,686) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:08:46,016) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:08:46,224) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996609
[3380957:MainThread](2024-04-25 19:08:46,224) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:08:46,225) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:08:49,541) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:08:49,747) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996327
[3380957:MainThread](2024-04-25 19:08:49,748) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:08:49,748) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:08:53,012) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:08:53,223) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995674
[3380957:MainThread](2024-04-25 19:08:53,224) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:08:53,225) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:08:56,539) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:08:56,746) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996658
[3380957:MainThread](2024-04-25 19:08:56,747) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:08:56,747) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:08:59,997) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:09:00,205) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997443
[3380957:MainThread](2024-04-25 19:09:00,205) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:09:00,206) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:09:03,453) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:09:03,661) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996713
[3380957:MainThread](2024-04-25 19:09:03,662) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:09:03,662) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:09:06,937) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:09:07,145) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996169
[3380957:MainThread](2024-04-25 19:09:07,145) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:09:07,145) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:09:10,421) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:09:10,630) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996546
[3380957:MainThread](2024-04-25 19:09:10,630) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:09:10,631) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:09:13,875) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:09:14,083) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997961
[3380957:MainThread](2024-04-25 19:09:14,083) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:09:14,084) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:09:17,322) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:09:17,531) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999465
[3380957:MainThread](2024-04-25 19:09:17,531) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:09:17,531) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:09:20,769) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:09:20,977) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998015
[3380957:MainThread](2024-04-25 19:09:20,977) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:09:20,977) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995674 @ 10
[3380957:MainThread](2024-04-25 19:09:21,311) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-03-19 SH600000    0.016126
           SH600004    0.254760
           SH600009    0.097580
           SH600010   -0.050829
           SH600011    0.010197
[3380957:MainThread](2024-04-25 19:09:23,011) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  91%|█████████ | 40/44 [51:31<04:47, 71.91s/it][3380957:MainThread](2024-04-25 19:09:23,019) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 19:09:23,028) INFO - qlib.workflow - [recorder.py:341] - Recorder 283806a893aa4894b723873f54a55e37 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 19:09:23,720) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:09:23,721) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:09:23,723) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:09:23,724) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:09:31,433) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.317284
            SH600004      1.317284
            SH600006      1.317284
            SH600007      1.317284
            SH600008      1.317284
                            ...   
2018-06-01  SZ300124      1.708045
            SZ300136      1.708045
            SZ300144      1.708045
            SZ300251      1.708045
            SZ300315      1.708045
Length: 703856, dtype: float64
[3380957:MainThread](2024-04-25 19:09:31,436) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:09:31,436) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:09:31,436) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:09:34,697) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:09:34,904) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998406
[3380957:MainThread](2024-04-25 19:09:34,905) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:09:34,905) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:09:38,092) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:09:38,297) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996625
[3380957:MainThread](2024-04-25 19:09:38,298) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:09:38,299) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:09:41,486) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:09:41,693) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997831
[3380957:MainThread](2024-04-25 19:09:41,693) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:09:41,693) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:09:44,888) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:09:45,095) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995554
[3380957:MainThread](2024-04-25 19:09:45,096) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:09:45,096) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:09:48,407) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:09:48,613) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996553
[3380957:MainThread](2024-04-25 19:09:48,613) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:09:48,613) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:09:51,970) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:09:52,175) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996728
[3380957:MainThread](2024-04-25 19:09:52,175) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:09:52,176) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:09:55,433) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:09:55,639) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996055
[3380957:MainThread](2024-04-25 19:09:55,640) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:09:55,640) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:09:58,915) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:09:59,121) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996699
[3380957:MainThread](2024-04-25 19:09:59,121) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:09:59,122) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:10:02,443) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:10:02,648) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995404
[3380957:MainThread](2024-04-25 19:10:02,649) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:10:02,650) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:10:06,010) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:10:06,216) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995745
[3380957:MainThread](2024-04-25 19:10:06,216) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:10:06,217) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:10:09,583) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:10:09,790) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997860
[3380957:MainThread](2024-04-25 19:10:09,790) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:10:09,791) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:10:13,166) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:10:13,371) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997599
[3380957:MainThread](2024-04-25 19:10:13,372) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:10:13,372) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:10:16,732) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:10:16,937) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996468
[3380957:MainThread](2024-04-25 19:10:16,937) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:10:16,938) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:10:20,277) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:10:20,485) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998034
[3380957:MainThread](2024-04-25 19:10:20,486) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:10:20,486) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:10:23,784) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:10:23,992) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998533
[3380957:MainThread](2024-04-25 19:10:23,992) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:10:23,992) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:10:27,330) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:10:27,538) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996652
[3380957:MainThread](2024-04-25 19:10:27,538) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:10:27,539) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:10:30,890) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:10:31,097) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998159
[3380957:MainThread](2024-04-25 19:10:31,097) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:10:31,097) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995404 @ 8
[3380957:MainThread](2024-04-25 19:10:31,147) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-04-17 SH600000   -0.014692
           SH600004    0.040377
           SH600009    0.035612
           SH600010   -0.016829
           SH600011   -0.020446
[3380957:MainThread](2024-04-25 19:10:32,860) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  93%|█████████▎| 41/44 [52:41<03:33, 71.29s/it][3380957:MainThread](2024-04-25 19:10:32,868) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 19:10:32,877) INFO - qlib.workflow - [recorder.py:341] - Recorder 666c0228b9814dd8bb2e4c1568c270c4 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 19:10:33,728) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:10:33,729) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:10:33,733) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:10:33,733) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:10:41,534) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.939308
            SH600004      0.939308
            SH600006      0.939308
            SH600007      0.939308
            SH600008      0.939308
                            ...   
2018-07-02  SZ300136      1.561607
            SZ300144      1.561607
            SZ300251      1.561607
            SZ300408      1.561607
            SZ300433      1.561607
Length: 709547, dtype: float64
[3380957:MainThread](2024-04-25 19:10:41,536) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:10:41,537) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:10:41,537) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:10:45,073) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:10:45,304) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997320
[3380957:MainThread](2024-04-25 19:10:45,306) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:10:45,306) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:10:48,673) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:10:48,906) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996359
[3380957:MainThread](2024-04-25 19:10:48,907) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:10:48,907) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:10:52,267) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:10:52,497) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995891
[3380957:MainThread](2024-04-25 19:10:52,498) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:10:52,498) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:10:55,830) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:10:56,060) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995743
[3380957:MainThread](2024-04-25 19:10:56,061) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:10:56,061) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:10:59,447) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:10:59,677) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996248
[3380957:MainThread](2024-04-25 19:10:59,677) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:10:59,678) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:11:03,085) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:11:03,315) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996073
[3380957:MainThread](2024-04-25 19:11:03,315) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:11:03,315) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:11:06,701) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:11:06,929) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997768
[3380957:MainThread](2024-04-25 19:11:06,930) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:11:06,930) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:11:10,331) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:11:10,564) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997433
[3380957:MainThread](2024-04-25 19:11:10,564) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:11:10,564) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:11:13,948) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:11:14,178) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996961
[3380957:MainThread](2024-04-25 19:11:14,178) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:11:14,178) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:11:17,553) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:11:17,789) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997734
[3380957:MainThread](2024-04-25 19:11:17,789) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:11:17,790) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:11:21,137) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:11:21,368) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997593
[3380957:MainThread](2024-04-25 19:11:21,369) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:11:21,369) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:11:24,696) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:11:24,930) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997504
[3380957:MainThread](2024-04-25 19:11:24,930) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:11:24,931) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995743 @ 3
[3380957:MainThread](2024-04-25 19:11:25,308) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-05-20 SH600000   -0.043847
           SH600004    0.208885
           SH600009    0.064580
           SH600010    0.009513
           SH600011   -0.037838
[3380957:MainThread](2024-04-25 19:11:27,055) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  95%|█████████▌| 42/44 [53:35<02:12, 66.16s/it][3380957:MainThread](2024-04-25 19:11:27,063) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 19:11:27,072) INFO - qlib.workflow - [recorder.py:341] - Recorder 19546cff99e54687abc625484a5b0fc9 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 19:11:27,811) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:11:27,811) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:11:27,814) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:11:27,814) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:11:35,645) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.639000
            SH600004      0.639000
            SH600006      0.639000
            SH600007      0.639000
            SH600008      0.639000
                            ...   
2018-07-30  SZ300136      1.372811
            SZ300144      1.372811
            SZ300251      1.372811
            SZ300408      1.372811
            SZ300433      1.372811
Length: 715298, dtype: float64
[3380957:MainThread](2024-04-25 19:11:35,647) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:11:35,648) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:11:35,648) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:11:39,418) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:11:39,613) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996678
[3380957:MainThread](2024-04-25 19:11:39,614) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:11:39,614) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:11:43,095) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:11:43,290) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997540
[3380957:MainThread](2024-04-25 19:11:43,291) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:11:43,291) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:11:46,767) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:11:46,963) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995566
[3380957:MainThread](2024-04-25 19:11:46,964) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:11:46,964) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:11:50,402) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:11:50,599) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995383
[3380957:MainThread](2024-04-25 19:11:50,600) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:11:50,600) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:11:54,031) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:11:54,232) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997422
[3380957:MainThread](2024-04-25 19:11:54,233) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:11:54,233) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:11:57,696) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:11:57,895) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996135
[3380957:MainThread](2024-04-25 19:11:57,895) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:11:57,895) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:12:01,320) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:12:01,516) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996059
[3380957:MainThread](2024-04-25 19:12:01,516) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:12:01,516) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:12:04,936) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:12:05,133) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996409
[3380957:MainThread](2024-04-25 19:12:05,134) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:12:05,134) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:12:08,553) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:12:08,749) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997076
[3380957:MainThread](2024-04-25 19:12:08,750) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:12:08,750) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:12:12,180) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:12:12,375) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997147
[3380957:MainThread](2024-04-25 19:12:12,375) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:12:12,376) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:12:15,729) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:12:15,925) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998041
[3380957:MainThread](2024-04-25 19:12:15,925) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:12:15,926) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:12:19,279) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:12:19,476) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998291
[3380957:MainThread](2024-04-25 19:12:19,476) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:12:19,477) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995383 @ 3
[3380957:MainThread](2024-04-25 19:12:19,642) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-06-17 SH600000    0.027679
           SH600004    0.061570
           SH600009    0.029973
           SH600010   -0.003296
           SH600011    0.014079
[3380957:MainThread](2024-04-25 19:12:21,344) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  98%|█████████▊| 43/44 [54:30<01:02, 62.60s/it][3380957:MainThread](2024-04-25 19:12:21,352) INFO - qlib.workflow - [exp.py:258] - Experiment 13 starts running ...
[3380957:MainThread](2024-04-25 19:12:21,362) INFO - qlib.workflow - [recorder.py:341] - Recorder 4885d36c24f34bf093d35c0c3d6791d7 starts running under Experiment 13 ...
[3380957:MainThread](2024-04-25 19:12:22,072) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:12:22,073) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:12:22,076) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:12:22,077) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:12:29,918) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.017367
            SH600004      1.017367
            SH600006      1.017367
            SH600007      1.017367
            SH600008      1.017367
                            ...   
2018-08-27  SZ300136      1.846868
            SZ300144      1.846868
            SZ300251      1.846868
            SZ300408      1.846868
            SZ300433      1.846868
Length: 721109, dtype: float64
[3380957:MainThread](2024-04-25 19:12:29,921) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:12:29,921) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:12:29,921) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:12:33,397) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:12:33,631) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997036
[3380957:MainThread](2024-04-25 19:12:33,632) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:12:33,633) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:12:37,037) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:12:37,272) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996832
[3380957:MainThread](2024-04-25 19:12:37,273) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:12:37,273) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:12:40,681) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:12:40,916) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996059
[3380957:MainThread](2024-04-25 19:12:40,917) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:12:40,917) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:12:44,325) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:12:44,559) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996378
[3380957:MainThread](2024-04-25 19:12:44,559) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:12:44,560) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:12:47,971) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:12:48,210) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995829
[3380957:MainThread](2024-04-25 19:12:48,211) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:12:48,211) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:12:51,595) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:12:51,830) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996673
[3380957:MainThread](2024-04-25 19:12:51,830) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:12:51,830) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:12:55,194) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:12:55,427) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997365
[3380957:MainThread](2024-04-25 19:12:55,427) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:12:55,428) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:12:58,769) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:12:59,002) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997366
[3380957:MainThread](2024-04-25 19:12:59,003) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:12:59,003) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:13:02,368) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:13:02,602) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996677
[3380957:MainThread](2024-04-25 19:13:02,602) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:13:02,602) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:13:05,953) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:13:06,190) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999444
[3380957:MainThread](2024-04-25 19:13:06,190) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:13:06,190) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:13:09,576) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:13:09,810) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999255
[3380957:MainThread](2024-04-25 19:13:09,810) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:13:09,810) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:13:13,274) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:13:13,509) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997166
[3380957:MainThread](2024-04-25 19:13:13,509) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:13:13,509) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:13:16,959) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:13:17,195) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998171
[3380957:MainThread](2024-04-25 19:13:17,195) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:13:17,196) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995829 @ 4
[3380957:MainThread](2024-04-25 19:13:17,237) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 13
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-07-17 SH600000    0.098395
           SH600004   -0.076953
           SH600009    0.063825
           SH600010    0.088540
           SH600011    0.121001
[3380957:MainThread](2024-04-25 19:13:18,960) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks: 100%|██████████| 44/44 [55:27<00:00, 61.10s/it]train tasks: 100%|██████████| 44/44 [55:27<00:00, 75.63s/it]
[3380957:MainThread](2024-04-25 19:13:19,076) INFO - qlib.timer - [log.py:127] - Time cost: 0.075s | Time to `list_recorders` in RecorderCollector Done
[3380957:MainThread](2024-04-25 19:13:19,077) INFO - qlib.RecorderCollector - [collect.py:226] - Nubmer of recorders after filter: defaultdict(<class 'int'>, {'FINISHED': 44})
[3380957:MainThread](2024-04-25 19:13:19,116) INFO - qlib.RollingEnsemble - [ensemble.py:83] - keys in group: ['4885d36c24f34bf093d35c0c3d6791d7', '19546cff99e54687abc625484a5b0fc9', '666c0228b9814dd8bb2e4c1568c270c4', '283806a893aa4894b723873f54a55e37', '71908046c16842199a701bd6d61e03dc', '641d015713c0433a8552826b1d3fd445', '6432274c05414416a551537b8a9148c5', 'c283bd7dcdcc433fab58912a12b3a659', '66c530e088fa4c7592ecc0a2c596b6f4', '8264a934e3914bcda0c5ca58d2a2d3f9', '6884123c48104a55af4d98ed83dc5372', '59006b973da949cfb7317ec9d85eae05', 'ad15da6f871b4478ab8c89e4d422ff6e', 'f21978ca575f47b8b633633a5f17ea2e', '3f29f6a0f6dd46c18bb5e15fa6025215', '144ea12ce8714809b8881b7ed95c0f36', '38687e067e7e4b2cb56cb65d2e0e993f', '1ccf6ab971c74513828b4cc4ecaedb42', '7c1f52532dee42bfb332f01b1ebec83e', 'dfb4fe3c6224427bbc75aeeda7640626', '10bbda9f28084b8c80c6433c609a9972', '18a8a654a3444258b781c95054fde69f', '5087353d3b9e43f1aeb8ed0412e408de', '10ebac13b45442bdae4688ac30c9d8be', '7210588525134303a2a7ff7c5bcb7d3f', '156288b420f14231a5e02334750e5e85', 'ba351b4ad2e343b38aa17b67856e9234', '00f2d65b3e034281966e865641466a2e', 'f8c6c774f1a14d67b90df6a249746e3e', '4d299aaf93e34851bff2c7569a2cde25', '5726cd681ee64b54af3236407d05398a', '434280f7d7fd4308ba8b8a1ac848e1dd', '029e08821adb4e85959e38f2ef92d3fe', '867b952c6b5a4517a80d7814591ba9d4', '09bd4e2418fa4b71a319422bd03f75c5', '24d1c9cb879747409e721c37a1e709c5', 'f9194fe76a7d4d9983a2b13e88f133bb', 'c8614b93a3c44b00ac55bbe205973df8', '5e147be4f3e244ed9985763d0cd760e9', 'cd87c80a6f384640becaace5eecada86', '7ef631ba394048b48a8c601cfe9110e4', '293a6c7b779b4c838dabd9bd7db1fc29', '1a12943b1c5440c58151d36c8aee40fa', '2bdfaa9422f948288568358c5721930e']
[3380957:MainThread](2024-04-25 19:13:19,210) INFO - qlib.RollingEnsemble - [ensemble.py:83] - keys in group: ['4885d36c24f34bf093d35c0c3d6791d7', '19546cff99e54687abc625484a5b0fc9', '666c0228b9814dd8bb2e4c1568c270c4', '283806a893aa4894b723873f54a55e37', '71908046c16842199a701bd6d61e03dc', '641d015713c0433a8552826b1d3fd445', '6432274c05414416a551537b8a9148c5', 'c283bd7dcdcc433fab58912a12b3a659', '66c530e088fa4c7592ecc0a2c596b6f4', '8264a934e3914bcda0c5ca58d2a2d3f9', '6884123c48104a55af4d98ed83dc5372', '59006b973da949cfb7317ec9d85eae05', 'ad15da6f871b4478ab8c89e4d422ff6e', 'f21978ca575f47b8b633633a5f17ea2e', '3f29f6a0f6dd46c18bb5e15fa6025215', '144ea12ce8714809b8881b7ed95c0f36', '38687e067e7e4b2cb56cb65d2e0e993f', '1ccf6ab971c74513828b4cc4ecaedb42', '7c1f52532dee42bfb332f01b1ebec83e', 'dfb4fe3c6224427bbc75aeeda7640626', '10bbda9f28084b8c80c6433c609a9972', '18a8a654a3444258b781c95054fde69f', '5087353d3b9e43f1aeb8ed0412e408de', '10ebac13b45442bdae4688ac30c9d8be', '7210588525134303a2a7ff7c5bcb7d3f', '156288b420f14231a5e02334750e5e85', 'ba351b4ad2e343b38aa17b67856e9234', '00f2d65b3e034281966e865641466a2e', 'f8c6c774f1a14d67b90df6a249746e3e', '4d299aaf93e34851bff2c7569a2cde25', '5726cd681ee64b54af3236407d05398a', '434280f7d7fd4308ba8b8a1ac848e1dd', '029e08821adb4e85959e38f2ef92d3fe', '867b952c6b5a4517a80d7814591ba9d4', '09bd4e2418fa4b71a319422bd03f75c5', '24d1c9cb879747409e721c37a1e709c5', 'f9194fe76a7d4d9983a2b13e88f133bb', 'c8614b93a3c44b00ac55bbe205973df8', '5e147be4f3e244ed9985763d0cd760e9', 'cd87c80a6f384640becaace5eecada86', '7ef631ba394048b48a8c601cfe9110e4', '293a6c7b779b4c838dabd9bd7db1fc29', '1a12943b1c5440c58151d36c8aee40fa', '2bdfaa9422f948288568358c5721930e']
[3380957:MainThread](2024-04-25 19:13:19,308) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name final_rolling_cn_data_csi300_GRU_alpha360_h1_step20_rankFalse_2024-04-25_18:17:51_DDG-DA.
[3380957:MainThread](2024-04-25 19:13:19,317) INFO - qlib.workflow - [exp.py:258] - Experiment 14 starts running ...
[3380957:MainThread](2024-04-25 19:13:19,326) INFO - qlib.workflow - [recorder.py:341] - Recorder 6ab0636e62284888b77f14ef32bd31fa starts running under Experiment 14 ...
[3380957:MainThread](2024-04-25 19:13:20,054) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/scipy/stats/_stats_py.py:4916: ConstantInputWarning: An input array is constant; the correlation coefficient is not defined.
  warnings.warn(stats.ConstantInputWarning(warn_msg))
{'IC': 0.05466413562417747,
 'ICIR': 0.4444839315354363,
 'Rank IC': 0.05508946664532743,
 'Rank ICIR': 0.45435263981091156}
[3380957:MainThread](2024-04-25 19:13:21,703) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3380957:MainThread](2024-04-25 19:13:45,871) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3380957:MainThread](2024-04-25 19:13:45,873) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3380957:MainThread](2024-04-25 19:13:45,879) WARNING - qlib.online operator - [exchange.py:226] - factor.day.bin file not exists or factor contains `nan`. Order using adjusted_price.
[3380957:MainThread](2024-04-25 19:13:45,879) WARNING - qlib.online operator - [exchange.py:228] - trade unit 100 is not supported in adjusted_price mode.
[3380957:MainThread](2024-04-25 19:13:53,708) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f27c6710100>
backtest loop:   0%|          | 0/872 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 6/872 [00:00<00:15, 54.78it/s]backtest loop:   1%|▏         | 13/872 [00:00<00:14, 60.14it/s]backtest loop:   2%|▏         | 20/872 [00:00<00:16, 52.00it/s]backtest loop:   3%|▎         | 27/872 [00:00<00:15, 55.87it/s]backtest loop:   4%|▍         | 34/872 [00:00<00:15, 54.65it/s]backtest loop:   5%|▍         | 40/872 [00:00<00:14, 56.19it/s]backtest loop:   5%|▌         | 47/872 [00:00<00:14, 58.29it/s]backtest loop:   6%|▌         | 54/872 [00:00<00:14, 56.40it/s]backtest loop:   7%|▋         | 60/872 [00:01<00:17, 46.21it/s]backtest loop:   8%|▊         | 67/872 [00:01<00:16, 48.19it/s]backtest loop:   8%|▊         | 74/872 [00:01<00:15, 52.10it/s]backtest loop:   9%|▉         | 81/872 [00:01<00:15, 52.43it/s]backtest loop:  10%|█         | 88/872 [00:01<00:14, 55.21it/s]backtest loop:  11%|█         | 95/872 [00:01<00:13, 57.60it/s]backtest loop:  12%|█▏        | 101/872 [00:01<00:13, 55.96it/s]backtest loop:  12%|█▏        | 108/872 [00:01<00:13, 58.62it/s]backtest loop:  13%|█▎        | 114/872 [00:02<00:13, 57.51it/s]backtest loop:  14%|█▍        | 121/872 [00:02<00:12, 60.23it/s]backtest loop:  15%|█▍        | 128/872 [00:02<00:11, 62.84it/s]backtest loop:  15%|█▌        | 135/872 [00:02<00:12, 61.30it/s]backtest loop:  16%|█▋        | 142/872 [00:02<00:11, 63.20it/s]backtest loop:  17%|█▋        | 149/872 [00:02<00:11, 61.17it/s]backtest loop:  18%|█▊        | 156/872 [00:02<00:11, 63.21it/s]backtest loop:  19%|█▊        | 163/872 [00:02<00:10, 64.91it/s]backtest loop:  19%|█▉        | 170/872 [00:02<00:11, 62.33it/s]backtest loop:  20%|██        | 177/872 [00:03<00:10, 64.39it/s]backtest loop:  21%|██        | 184/872 [00:03<00:11, 61.96it/s]backtest loop:  22%|██▏       | 192/872 [00:03<00:10, 65.23it/s]backtest loop:  23%|██▎       | 199/872 [00:03<00:10, 63.38it/s]backtest loop:  24%|██▎       | 206/872 [00:03<00:10, 65.06it/s]backtest loop:  24%|██▍       | 213/872 [00:03<00:09, 66.11it/s]backtest loop:  25%|██▌       | 220/872 [00:03<00:10, 63.38it/s]backtest loop:  26%|██▌       | 227/872 [00:03<00:09, 64.85it/s]backtest loop:  27%|██▋       | 234/872 [00:03<00:10, 62.50it/s]backtest loop:  28%|██▊       | 242/872 [00:04<00:09, 65.49it/s]backtest loop:  29%|██▊       | 249/872 [00:04<00:09, 63.80it/s]backtest loop:  29%|██▉       | 256/872 [00:04<00:09, 65.27it/s]backtest loop:  30%|███       | 263/872 [00:04<00:09, 61.82it/s]backtest loop:  31%|███       | 270/872 [00:04<00:09, 63.82it/s]backtest loop:  32%|███▏      | 277/872 [00:04<00:09, 62.54it/s]backtest loop:  33%|███▎      | 284/872 [00:04<00:09, 61.00it/s]backtest loop:  33%|███▎      | 292/872 [00:04<00:08, 65.30it/s]backtest loop:  34%|███▍      | 299/872 [00:04<00:08, 64.17it/s]backtest loop:  35%|███▌      | 306/872 [00:05<00:09, 62.42it/s]backtest loop:  36%|███▌      | 313/872 [00:05<00:08, 63.80it/s]backtest loop:  37%|███▋      | 320/872 [00:05<00:08, 65.10it/s]backtest loop:  38%|███▊      | 327/872 [00:05<00:09, 60.15it/s]backtest loop:  38%|███▊      | 334/872 [00:05<00:09, 57.60it/s]backtest loop:  39%|███▉      | 342/872 [00:05<00:08, 61.48it/s]backtest loop:  40%|████      | 349/872 [00:05<00:08, 60.50it/s]backtest loop:  41%|████      | 357/872 [00:05<00:08, 64.28it/s]backtest loop:  42%|████▏     | 364/872 [00:06<00:08, 62.09it/s]backtest loop:  43%|████▎     | 371/872 [00:06<00:07, 62.97it/s]backtest loop:  43%|████▎     | 378/872 [00:06<00:08, 60.18it/s]backtest loop:  44%|████▍     | 385/872 [00:06<00:07, 61.78it/s]backtest loop:  45%|████▍     | 392/872 [00:06<00:07, 63.54it/s]backtest loop:  46%|████▌     | 399/872 [00:06<00:07, 61.48it/s]backtest loop:  47%|████▋     | 406/872 [00:06<00:07, 62.63it/s]backtest loop:  47%|████▋     | 413/872 [00:06<00:07, 60.79it/s]backtest loop:  48%|████▊     | 420/872 [00:06<00:07, 62.87it/s]backtest loop:  49%|████▉     | 427/872 [00:07<00:07, 60.20it/s]backtest loop:  50%|████▉     | 435/872 [00:07<00:06, 64.02it/s]backtest loop:  51%|█████     | 442/872 [00:07<00:06, 61.62it/s]backtest loop:  51%|█████▏    | 449/872 [00:07<00:06, 62.73it/s]backtest loop:  52%|█████▏    | 456/872 [00:07<00:06, 64.13it/s]backtest loop:  53%|█████▎    | 463/872 [00:07<00:06, 60.84it/s]backtest loop:  54%|█████▍    | 470/872 [00:07<00:06, 62.92it/s]backtest loop:  55%|█████▍    | 477/872 [00:07<00:06, 60.39it/s]backtest loop:  56%|█████▌    | 484/872 [00:07<00:06, 61.87it/s]backtest loop:  56%|█████▋    | 491/872 [00:08<00:06, 59.88it/s]backtest loop:  57%|█████▋    | 498/872 [00:08<00:06, 61.12it/s]backtest loop:  58%|█████▊    | 505/872 [00:08<00:06, 58.43it/s]backtest loop:  59%|█████▊    | 512/872 [00:08<00:06, 59.72it/s]backtest loop:  60%|█████▉    | 519/872 [00:08<00:05, 60.92it/s]backtest loop:  60%|██████    | 526/872 [00:08<00:05, 59.42it/s]backtest loop:  61%|██████    | 533/872 [00:08<00:05, 61.05it/s]backtest loop:  62%|██████▏   | 540/872 [00:08<00:05, 58.58it/s]backtest loop:  63%|██████▎   | 547/872 [00:09<00:05, 59.99it/s]backtest loop:  64%|██████▎   | 554/872 [00:09<00:05, 57.92it/s]backtest loop:  64%|██████▍   | 561/872 [00:09<00:05, 59.57it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:  65%|██████▌   | 568/872 [00:09<00:04, 61.82it/s]backtest loop:  66%|██████▌   | 575/872 [00:09<00:04, 62.17it/s]backtest loop:  67%|██████▋   | 582/872 [00:09<00:04, 58.97it/s]backtest loop:  68%|██████▊   | 589/872 [00:09<00:04, 60.01it/s]backtest loop:  68%|██████▊   | 596/872 [00:09<00:04, 58.35it/s]backtest loop:  69%|██████▉   | 603/872 [00:09<00:04, 60.07it/s]backtest loop:  70%|██████▉   | 610/872 [00:10<00:04, 57.64it/s]backtest loop:  71%|███████   | 617/872 [00:10<00:04, 59.19it/s]backtest loop:  72%|███████▏  | 624/872 [00:10<00:04, 60.23it/s]backtest loop:  72%|███████▏  | 631/872 [00:10<00:04, 57.72it/s]backtest loop:  73%|███████▎  | 638/872 [00:10<00:03, 59.28it/s]backtest loop:  74%|███████▍  | 645/872 [00:10<00:03, 57.03it/s]backtest loop:  75%|███████▍  | 652/872 [00:10<00:03, 58.66it/s]backtest loop:  76%|███████▌  | 659/872 [00:10<00:03, 56.75it/s]backtest loop:  76%|███████▋  | 666/872 [00:11<00:03, 58.45it/s]backtest loop:  77%|███████▋  | 672/872 [00:11<00:03, 55.88it/s]backtest loop:  78%|███████▊  | 679/872 [00:11<00:03, 54.79it/s]backtest loop:  79%|███████▊  | 686/872 [00:11<00:03, 57.01it/s]backtest loop:  79%|███████▉  | 693/872 [00:11<00:03, 58.54it/s]backtest loop:  80%|████████  | 699/872 [00:11<00:03, 55.91it/s]backtest loop:  81%|████████  | 706/872 [00:11<00:02, 57.92it/s]backtest loop:  82%|████████▏ | 713/872 [00:11<00:02, 59.61it/s]backtest loop:  82%|████████▏ | 719/872 [00:11<00:02, 56.53it/s]backtest loop:  83%|████████▎ | 726/872 [00:12<00:02, 58.45it/s]backtest loop:  84%|████████▍ | 732/872 [00:12<00:02, 55.84it/s]backtest loop:  85%|████████▍ | 738/872 [00:12<00:02, 53.99it/s]backtest loop:  85%|████████▌ | 745/872 [00:12<00:02, 56.70it/s]backtest loop:  86%|████████▌ | 752/872 [00:12<00:02, 55.72it/s]backtest loop:  87%|████████▋ | 759/872 [00:12<00:01, 57.92it/s]backtest loop:  88%|████████▊ | 765/872 [00:12<00:01, 57.85it/s]backtest loop:  89%|████████▊ | 772/872 [00:12<00:01, 56.08it/s]backtest loop:  89%|████████▉ | 779/872 [00:13<00:01, 58.23it/s]backtest loop:  90%|█████████ | 786/872 [00:13<00:01, 59.89it/s]backtest loop:  91%|█████████ | 793/872 [00:13<00:01, 57.51it/s]backtest loop:  92%|█████████▏| 799/872 [00:13<00:01, 58.10it/s]backtest loop:  92%|█████████▏| 806/872 [00:13<00:01, 56.46it/s]backtest loop:  93%|█████████▎| 813/872 [00:13<00:01, 55.48it/s]backtest loop:  94%|█████████▍| 819/872 [00:13<00:00, 56.16it/s]backtest loop:  95%|█████████▍| 826/872 [00:13<00:00, 58.14it/s]backtest loop:  96%|█████████▌| 833/872 [00:13<00:00, 56.73it/s]backtest loop:  96%|█████████▋| 840/872 [00:14<00:00, 58.43it/s]backtest loop:  97%|█████████▋| 846/872 [00:14<00:00, 55.75it/s]backtest loop:  98%|█████████▊| 853/872 [00:14<00:00, 57.78it/s]backtest loop:  99%|█████████▊| 860/872 [00:14<00:00, 59.33it/s]backtest loop:  99%|█████████▉| 866/872 [00:14<00:00, 56.48it/s]backtest loop: 100%|██████████| 872/872 [00:14<00:00, 59.49it/s]
[3380957:MainThread](2024-04-25 19:14:08,449) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 14
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000495
std                0.012300
annualized_return  0.117864
information_ratio  0.621155
max_drawdown      -0.370479
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000546
std                0.005324
annualized_return  0.129915
information_ratio  1.581776
max_drawdown      -0.053170
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000370
std                0.005323
annualized_return  0.088077
information_ratio  1.072585
max_drawdown      -0.059188
[3380957:MainThread](2024-04-25 19:14:08,463) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 14
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Remove CSRankNorm
{'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': datetime.date(2008, 1, 1), 'end_time': datetime.date(2020, 8, 1), 'fit_start_time': datetime.date(2008, 1, 1), 'fit_end_time': datetime.date(2014, 12, 31), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
[3380957:MainThread](2024-04-25 19:14:09,274) INFO - qlib.RollingBenchmark - [rolling_benchmark.py:208] - {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 5000, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/baseline/cn_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': [datetime.date(2008, 1, 1), datetime.date(2014, 12, 31)], 'valid': [datetime.date(2015, 1, 1), datetime.date(2016, 12, 31)], 'test': [datetime.date(2017, 1, 1), datetime.date(2020, 8, 1)]}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `final_rolling_cn_data_csi300_GRU_alpha360_h1_step20_rankFalse_2024-04-25_18:17:51_DDG-DA`.
{'1day.excess_return_with_cost.annualized_return': [0.08807704690081429],
 '1day.excess_return_with_cost.information_ratio': [1.0725851666845683],
 '1day.excess_return_with_cost.max_drawdown': [-0.05918751178811195],
 'IC': [0.05466413562417747],
 'ICIR': [0.4444839315354363],
 'Rank IC': [0.05508946664532743],
 'Rank ICIR': [0.45435263981091156],
 'mae': [0.6961899399757385],
 'mse': [0.995438277721405]}
Remove CSRankNorm
{'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': datetime.date(2008, 1, 1), 'end_time': datetime.date(2020, 8, 1), 'fit_start_time': datetime.date(2008, 1, 1), 'fit_end_time': datetime.date(2014, 12, 31), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
[3380957:MainThread](2024-04-25 19:14:13,849) INFO - qlib.RollingBenchmark - [rolling_benchmark.py:208] - {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 5000, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/baseline/cn_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': [datetime.date(2008, 1, 1), datetime.date(2014, 12, 31)], 'valid': [datetime.date(2015, 1, 1), datetime.date(2016, 12, 31)], 'test': [datetime.date(2017, 1, 1), datetime.date(2020, 8, 1)]}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
[3380957:MainThread](2024-04-25 19:14:13,860) INFO - qlib.MetaDatasetDS - [dataset.py:316] - Example task for training meta model: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 5000, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/baseline/cn_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-02 00:00:00'), Timestamp('2014-12-31 00:00:00')), 'valid': (Timestamp('2015-01-05 00:00:00'), Timestamp('2016-12-29 00:00:00')), 'test': (Timestamp('2017-01-03 00:00:00'), Timestamp('2017-02-06 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/44 [00:00<?, ?it/s]creating meta tasks:   2%|▏         | 1/44 [00:00<00:16,  2.65it/s]creating meta tasks:   5%|▍         | 2/44 [00:00<00:17,  2.46it/s]creating meta tasks:   7%|▋         | 3/44 [00:01<00:16,  2.55it/s]creating meta tasks:   9%|▉         | 4/44 [00:01<00:15,  2.59it/s]creating meta tasks:  11%|█▏        | 5/44 [00:01<00:14,  2.61it/s]creating meta tasks:  14%|█▎        | 6/44 [00:02<00:14,  2.62it/s]creating meta tasks:  16%|█▌        | 7/44 [00:02<00:14,  2.62it/s]creating meta tasks:  18%|█▊        | 8/44 [00:03<00:13,  2.62it/s]creating meta tasks:  20%|██        | 9/44 [00:03<00:13,  2.61it/s]creating meta tasks:  23%|██▎       | 10/44 [00:03<00:13,  2.61it/s]creating meta tasks:  25%|██▌       | 11/44 [00:04<00:12,  2.60it/s]creating meta tasks:  27%|██▋       | 12/44 [00:04<00:12,  2.60it/s]creating meta tasks:  30%|██▉       | 13/44 [00:05<00:11,  2.59it/s]creating meta tasks:  32%|███▏      | 14/44 [00:05<00:11,  2.58it/s]creating meta tasks:  34%|███▍      | 15/44 [00:05<00:11,  2.56it/s]creating meta tasks:  36%|███▋      | 16/44 [00:06<00:10,  2.55it/s]creating meta tasks:  39%|███▊      | 17/44 [00:06<00:10,  2.54it/s]creating meta tasks:  41%|████      | 18/44 [00:06<00:10,  2.54it/s]creating meta tasks:  43%|████▎     | 19/44 [00:07<00:09,  2.51it/s]creating meta tasks:  45%|████▌     | 20/44 [00:07<00:09,  2.49it/s]creating meta tasks:  48%|████▊     | 21/44 [00:08<00:09,  2.47it/s]creating meta tasks:  50%|█████     | 22/44 [00:08<00:09,  2.26it/s]creating meta tasks:  52%|█████▏    | 23/44 [00:09<00:09,  2.30it/s]creating meta tasks:  55%|█████▍    | 24/44 [00:09<00:08,  2.33it/s]creating meta tasks:  57%|█████▋    | 25/44 [00:09<00:08,  2.35it/s]creating meta tasks:  59%|█████▉    | 26/44 [00:10<00:07,  2.36it/s]creating meta tasks:  61%|██████▏   | 27/44 [00:10<00:07,  2.37it/s]creating meta tasks:  64%|██████▎   | 28/44 [00:11<00:06,  2.36it/s]creating meta tasks:  66%|██████▌   | 29/44 [00:11<00:06,  2.36it/s]creating meta tasks:  68%|██████▊   | 30/44 [00:12<00:05,  2.35it/s]creating meta tasks:  70%|███████   | 31/44 [00:12<00:05,  2.36it/s]creating meta tasks:  73%|███████▎  | 32/44 [00:12<00:05,  2.36it/s]creating meta tasks:  75%|███████▌  | 33/44 [00:13<00:04,  2.35it/s]creating meta tasks:  77%|███████▋  | 34/44 [00:13<00:04,  2.35it/s]creating meta tasks:  80%|███████▉  | 35/44 [00:14<00:03,  2.34it/s]creating meta tasks:  82%|████████▏ | 36/44 [00:14<00:03,  2.33it/s]creating meta tasks:  84%|████████▍ | 37/44 [00:15<00:03,  2.31it/s]creating meta tasks:  86%|████████▋ | 38/44 [00:15<00:02,  2.31it/s]creating meta tasks:  89%|████████▊ | 39/44 [00:15<00:02,  2.30it/s]creating meta tasks:  91%|█████████ | 40/44 [00:16<00:01,  2.29it/s]creating meta tasks:  93%|█████████▎| 41/44 [00:16<00:01,  2.28it/s]creating meta tasks:  95%|█████████▌| 42/44 [00:17<00:00,  2.28it/s]creating meta tasks:  98%|█████████▊| 43/44 [00:17<00:00,  2.27it/s]creating meta tasks: 100%|██████████| 44/44 [00:18<00:00,  2.26it/s]creating meta tasks: 100%|██████████| 44/44 [00:18<00:00,  2.42it/s]
train tasks:   0%|          | 0/44 [00:00<?, ?it/s][3380957:MainThread](2024-04-25 19:14:32,285) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name rolling_cn_data_csi300_GRU_alpha360_h1_step20_rankFalse_2024-04-25_19:14:32_DDG-DA.
[3380957:MainThread](2024-04-25 19:14:32,295) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:14:32,308) INFO - qlib.workflow - [recorder.py:341] - Recorder 57a21a6a2c234fb9a1d7171ce08cc051 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:14:33,121) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:14:33,121) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:14:33,124) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:14:33,124) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:14:41,125) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.531157
            SH600004      0.531157
            SH600006      0.531157
            SH600007      0.531157
            SH600008      0.531157
                            ...   
2014-12-31  SZ300070      1.926482
            SZ300124      1.926482
            SZ300133      1.926482
            SZ300146      1.926482
            SZ300251      1.926482
Length: 478007, dtype: float64
[3380957:MainThread](2024-04-25 19:14:41,128) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:14:41,128) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:14:41,128) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:14:43,477) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:14:43,698) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995033
[3380957:MainThread](2024-04-25 19:14:43,699) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:14:43,699) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:14:46,014) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:14:46,234) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994848
[3380957:MainThread](2024-04-25 19:14:46,235) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:14:46,235) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:14:48,544) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:14:48,764) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994572
[3380957:MainThread](2024-04-25 19:14:48,765) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:14:48,765) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:14:51,084) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:14:51,305) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993579
[3380957:MainThread](2024-04-25 19:14:51,306) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:14:51,307) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:14:53,619) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:14:53,841) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993552
[3380957:MainThread](2024-04-25 19:14:53,842) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:14:53,842) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:14:56,155) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:14:56,374) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993951
[3380957:MainThread](2024-04-25 19:14:56,374) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:14:56,375) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:14:58,678) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:14:58,899) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994075
[3380957:MainThread](2024-04-25 19:14:58,899) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:14:58,899) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:01,216) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:01,439) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993193
[3380957:MainThread](2024-04-25 19:15:01,440) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:15:01,440) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:03,746) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:03,966) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992762
[3380957:MainThread](2024-04-25 19:15:03,967) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:15:03,968) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:06,228) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:06,451) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993057
[3380957:MainThread](2024-04-25 19:15:06,452) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:15:06,452) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:08,762) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:08,982) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992941
[3380957:MainThread](2024-04-25 19:15:08,982) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:15:08,983) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:11,284) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:11,504) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994390
[3380957:MainThread](2024-04-25 19:15:11,504) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:15:11,504) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:13,760) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:13,980) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994204
[3380957:MainThread](2024-04-25 19:15:13,980) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:15:13,981) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:16,227) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:16,447) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992419
[3380957:MainThread](2024-04-25 19:15:16,448) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:15:16,448) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:18,628) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:18,848) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992268
[3380957:MainThread](2024-04-25 19:15:18,849) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:15:18,850) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:21,064) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:21,284) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992371
[3380957:MainThread](2024-04-25 19:15:21,284) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:15:21,285) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:23,538) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:23,755) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992642
[3380957:MainThread](2024-04-25 19:15:23,755) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:15:23,755) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:26,046) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:26,265) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993502
[3380957:MainThread](2024-04-25 19:15:26,266) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:15:26,266) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:28,513) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:28,736) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992835
[3380957:MainThread](2024-04-25 19:15:28,736) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:15:28,736) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:30,998) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:31,221) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993823
[3380957:MainThread](2024-04-25 19:15:31,221) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:15:31,221) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:33,466) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:33,687) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994684
[3380957:MainThread](2024-04-25 19:15:33,687) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:15:33,687) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:35,923) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:36,143) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995473
[3380957:MainThread](2024-04-25 19:15:36,143) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 19:15:36,144) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:38,352) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:38,572) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994798
[3380957:MainThread](2024-04-25 19:15:38,573) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:15:38,573) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992268 @ 14
[3380957:MainThread](2024-04-25 19:15:38,624) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-01-03 SH600000   -0.040032
           SH600008    0.002995
           SH600009    0.035449
           SH600010   -0.059652
           SH600015   -0.049876
[3380957:MainThread](2024-04-25 19:15:40,334) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   2%|▏         | 1/44 [01:08<48:46, 68.06s/it][3380957:MainThread](2024-04-25 19:15:40,343) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:15:40,354) INFO - qlib.workflow - [recorder.py:341] - Recorder 41daf3a2bef14ece82265af0e7fe1130 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:15:41,173) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:15:41,174) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:15:41,176) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:15:41,177) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:15:49,148) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.540720
            SH600004      0.540720
            SH600006      0.540720
            SH600007      0.540720
            SH600008      0.540720
                            ...   
2015-01-30  SZ300070      1.993667
            SZ300124      1.993667
            SZ300133      1.993667
            SZ300146      1.993667
            SZ300251      1.993667
Length: 483831, dtype: float64
[3380957:MainThread](2024-04-25 19:15:49,151) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:15:49,151) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:15:49,151) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:51,513) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:51,738) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995037
[3380957:MainThread](2024-04-25 19:15:51,739) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:15:51,740) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:53,998) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:54,222) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994696
[3380957:MainThread](2024-04-25 19:15:54,223) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:15:54,223) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:56,516) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:56,742) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994550
[3380957:MainThread](2024-04-25 19:15:56,743) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:15:56,744) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:15:58,963) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:15:59,190) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994187
[3380957:MainThread](2024-04-25 19:15:59,192) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:15:59,192) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:01,454) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:01,677) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993556
[3380957:MainThread](2024-04-25 19:16:01,678) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:16:01,679) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:03,941) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:04,165) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994342
[3380957:MainThread](2024-04-25 19:16:04,165) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:16:04,165) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:06,419) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:06,645) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993889
[3380957:MainThread](2024-04-25 19:16:06,645) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:16:06,646) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:08,913) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:09,138) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993433
[3380957:MainThread](2024-04-25 19:16:09,139) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:16:09,139) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:11,405) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:11,633) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993589
[3380957:MainThread](2024-04-25 19:16:11,633) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:16:11,633) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:13,924) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:14,150) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993700
[3380957:MainThread](2024-04-25 19:16:14,150) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:16:14,151) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:16,418) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:16,645) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993833
[3380957:MainThread](2024-04-25 19:16:16,646) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:16:16,646) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:18,925) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:19,150) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994141
[3380957:MainThread](2024-04-25 19:16:19,150) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:16:19,151) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:21,444) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:21,671) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993387
[3380957:MainThread](2024-04-25 19:16:21,672) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:16:21,672) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:23,973) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:24,199) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993336
[3380957:MainThread](2024-04-25 19:16:24,200) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:16:24,201) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:26,517) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:26,742) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994337
[3380957:MainThread](2024-04-25 19:16:26,742) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:16:26,743) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:29,051) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:29,275) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993830
[3380957:MainThread](2024-04-25 19:16:29,276) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:16:29,276) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:31,501) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:31,727) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995383
[3380957:MainThread](2024-04-25 19:16:31,727) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:16:31,727) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:33,942) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:34,167) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994298
[3380957:MainThread](2024-04-25 19:16:34,168) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:16:34,168) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:36,404) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:36,632) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994047
[3380957:MainThread](2024-04-25 19:16:36,633) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:16:36,633) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:38,873) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:39,099) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994117
[3380957:MainThread](2024-04-25 19:16:39,099) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:16:39,099) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:41,359) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:41,583) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995510
[3380957:MainThread](2024-04-25 19:16:41,584) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:16:41,584) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:43,845) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:44,071) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995796
[3380957:MainThread](2024-04-25 19:16:44,071) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:16:44,071) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993336 @ 13
[3380957:MainThread](2024-04-25 19:16:44,149) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-02-07 SH600000    0.014791
           SH600008    0.030494
           SH600009    0.009725
           SH600010   -0.064933
           SH600015    0.070892
[3380957:MainThread](2024-04-25 19:16:45,856) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   5%|▍         | 2/44 [02:13<46:35, 66.57s/it][3380957:MainThread](2024-04-25 19:16:45,865) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:16:45,876) INFO - qlib.workflow - [recorder.py:341] - Recorder 3ed1410e51674672a12f0b00596a97bb starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:16:46,933) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:16:46,933) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:16:46,937) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:16:46,938) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:16:54,627) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.632848
            SH600004      0.632848
            SH600006      0.632848
            SH600007      0.632848
            SH600008      0.632848
                            ...   
2015-03-06  SZ300070      1.927196
            SZ300124      1.927196
            SZ300133      1.927196
            SZ300146      1.927196
            SZ300251      1.927196
Length: 489365, dtype: float64
[3380957:MainThread](2024-04-25 19:16:54,630) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:16:54,630) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:16:54,630) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:57,189) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:57,417) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995464
[3380957:MainThread](2024-04-25 19:16:57,419) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:16:57,419) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:16:59,760) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:16:59,983) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995284
[3380957:MainThread](2024-04-25 19:16:59,984) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:16:59,985) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:17:02,324) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:17:02,552) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994532
[3380957:MainThread](2024-04-25 19:17:02,553) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:17:02,553) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:17:04,890) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:17:05,116) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993877
[3380957:MainThread](2024-04-25 19:17:05,117) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:17:05,118) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:17:07,445) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:17:07,672) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994171
[3380957:MainThread](2024-04-25 19:17:07,673) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:17:07,673) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:17:10,035) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:17:10,259) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995211
[3380957:MainThread](2024-04-25 19:17:10,260) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:17:10,260) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:17:12,610) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:17:12,836) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994378
[3380957:MainThread](2024-04-25 19:17:12,837) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:17:12,837) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:17:15,139) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:17:15,362) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993964
[3380957:MainThread](2024-04-25 19:17:15,362) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:17:15,363) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:17:17,666) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:17:17,893) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993811
[3380957:MainThread](2024-04-25 19:17:17,895) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:17:17,895) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:17:20,209) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:17:20,436) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994104
[3380957:MainThread](2024-04-25 19:17:20,436) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:17:20,437) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:17:22,747) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:17:22,973) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994726
[3380957:MainThread](2024-04-25 19:17:22,974) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:17:22,974) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:17:25,267) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:17:25,491) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994332
[3380957:MainThread](2024-04-25 19:17:25,491) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:17:25,491) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:17:27,771) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:17:27,995) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993047
[3380957:MainThread](2024-04-25 19:17:27,996) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:17:27,996) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:17:30,365) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:17:30,590) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993167
[3380957:MainThread](2024-04-25 19:17:30,590) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:17:30,590) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:17:32,925) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:17:33,148) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994376
[3380957:MainThread](2024-04-25 19:17:33,149) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:17:33,149) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:17:35,439) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:17:35,664) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994770
[3380957:MainThread](2024-04-25 19:17:35,665) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:17:35,665) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:17:37,981) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:17:38,209) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994004
[3380957:MainThread](2024-04-25 19:17:38,210) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:17:38,210) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:17:40,532) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:17:40,762) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994112
[3380957:MainThread](2024-04-25 19:17:40,762) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:17:40,762) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:17:43,084) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:17:43,312) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994564
[3380957:MainThread](2024-04-25 19:17:43,312) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:17:43,313) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:17:45,639) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:17:45,864) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996371
[3380957:MainThread](2024-04-25 19:17:45,864) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:17:45,865) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:17:48,161) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:17:48,385) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994545
[3380957:MainThread](2024-04-25 19:17:48,385) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:17:48,385) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993047 @ 12
[3380957:MainThread](2024-04-25 19:17:48,436) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-03-07 SH600000   -0.003232
           SH600008    0.006787
           SH600009    0.023658
           SH600010   -0.009674
           SH600015    0.024625
[3380957:MainThread](2024-04-25 19:17:50,144) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   7%|▋         | 3/44 [03:17<44:46, 65.53s/it][3380957:MainThread](2024-04-25 19:17:50,153) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:17:50,165) INFO - qlib.workflow - [recorder.py:341] - Recorder d543cc90224f45cd961e0c29207368f9 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:17:50,953) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:17:50,953) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:17:50,956) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:17:50,957) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:17:58,509) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.655959
            SH600004      0.655959
            SH600006      0.655959
            SH600007      0.655959
            SH600008      0.655959
                            ...   
2015-04-03  SZ300070      0.662208
            SZ300124      0.662208
            SZ300133      0.662208
            SZ300146      0.662208
            SZ300251      0.662208
Length: 495049, dtype: float64
[3380957:MainThread](2024-04-25 19:17:58,511) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:17:58,512) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:17:58,512) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:18:01,029) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:18:01,251) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995785
[3380957:MainThread](2024-04-25 19:18:01,252) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:18:01,253) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:18:03,610) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:18:03,830) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995353
[3380957:MainThread](2024-04-25 19:18:03,832) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:18:03,832) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:18:06,217) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:18:06,440) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995065
[3380957:MainThread](2024-04-25 19:18:06,441) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:18:06,441) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:18:08,842) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:18:09,064) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994629
[3380957:MainThread](2024-04-25 19:18:09,065) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:18:09,065) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:18:11,453) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:18:11,677) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993901
[3380957:MainThread](2024-04-25 19:18:11,678) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:18:11,678) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:18:14,067) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:18:14,292) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995022
[3380957:MainThread](2024-04-25 19:18:14,292) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:18:14,293) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:18:16,675) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:18:16,901) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997045
[3380957:MainThread](2024-04-25 19:18:16,901) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:18:16,901) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:18:19,234) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:18:19,456) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994184
[3380957:MainThread](2024-04-25 19:18:19,457) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:18:19,457) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:18:21,767) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:18:21,990) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995238
[3380957:MainThread](2024-04-25 19:18:21,990) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:18:21,990) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:18:24,329) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:18:24,555) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994400
[3380957:MainThread](2024-04-25 19:18:24,555) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:18:24,555) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:18:26,892) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:18:27,117) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994246
[3380957:MainThread](2024-04-25 19:18:27,117) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:18:27,118) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:18:29,442) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:18:29,664) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994592
[3380957:MainThread](2024-04-25 19:18:29,664) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:18:29,665) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:18:31,989) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:18:32,211) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994810
[3380957:MainThread](2024-04-25 19:18:32,211) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:18:32,212) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993901 @ 4
[3380957:MainThread](2024-04-25 19:18:32,304) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-04-06 SH600000    0.026821
           SH600008   -0.135730
           SH600009   -0.077303
           SH600010    0.011402
           SH600015    0.016661
[3380957:MainThread](2024-04-25 19:18:33,710) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   9%|▉         | 4/44 [04:01<37:54, 56.86s/it][3380957:MainThread](2024-04-25 19:18:33,718) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:18:33,729) INFO - qlib.workflow - [recorder.py:341] - Recorder b6615246ff554f3888ee355ec804845f starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:18:34,502) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:18:34,503) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:18:34,507) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:18:34,508) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:18:42,219) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.007232
            SH600004      1.007232
            SH600006      1.007232
            SH600007      1.007232
            SH600008      1.007232
                            ...   
2015-05-05  SZ300070      1.864241
            SZ300124      1.864241
            SZ300133      1.864241
            SZ300146      1.864241
            SZ300251      1.864241
Length: 500679, dtype: float64
[3380957:MainThread](2024-04-25 19:18:42,221) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:18:42,221) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:18:42,222) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:18:44,559) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:18:44,758) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995798
[3380957:MainThread](2024-04-25 19:18:44,759) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:18:44,759) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:18:47,090) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:18:47,287) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995497
[3380957:MainThread](2024-04-25 19:18:47,288) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:18:47,289) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:18:49,696) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:18:49,893) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995379
[3380957:MainThread](2024-04-25 19:18:49,894) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:18:49,894) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:18:52,297) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:18:52,493) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995138
[3380957:MainThread](2024-04-25 19:18:52,494) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:18:52,494) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:18:54,896) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:18:55,092) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994993
[3380957:MainThread](2024-04-25 19:18:55,093) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:18:55,094) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:18:57,505) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:18:57,703) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994393
[3380957:MainThread](2024-04-25 19:18:57,704) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:18:57,704) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:00,111) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:00,308) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994251
[3380957:MainThread](2024-04-25 19:19:00,309) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:19:00,309) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:02,679) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:02,876) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994678
[3380957:MainThread](2024-04-25 19:19:02,877) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:19:02,877) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:05,286) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:05,482) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995575
[3380957:MainThread](2024-04-25 19:19:05,483) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:19:05,483) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:07,900) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:08,097) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995375
[3380957:MainThread](2024-04-25 19:19:08,098) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:19:08,098) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:10,489) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:10,685) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995803
[3380957:MainThread](2024-04-25 19:19:10,686) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:19:10,686) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:13,085) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:13,283) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995045
[3380957:MainThread](2024-04-25 19:19:13,283) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:19:13,284) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:15,677) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:15,874) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994065
[3380957:MainThread](2024-04-25 19:19:15,875) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:19:15,876) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:18,267) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:18,464) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994364
[3380957:MainThread](2024-04-25 19:19:18,464) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:19:18,465) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:20,853) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:21,052) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994258
[3380957:MainThread](2024-04-25 19:19:21,052) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:19:21,052) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:23,380) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:23,578) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994333
[3380957:MainThread](2024-04-25 19:19:23,579) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:19:23,579) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:25,982) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:26,181) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994911
[3380957:MainThread](2024-04-25 19:19:26,182) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:19:26,182) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:28,594) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:28,792) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994829
[3380957:MainThread](2024-04-25 19:19:28,793) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:19:28,793) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:31,223) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:31,424) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995039
[3380957:MainThread](2024-04-25 19:19:31,425) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:19:31,425) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:33,811) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:34,010) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995549
[3380957:MainThread](2024-04-25 19:19:34,010) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:19:34,010) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:36,429) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:36,629) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994989
[3380957:MainThread](2024-04-25 19:19:36,629) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:19:36,630) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.994065 @ 12
[3380957:MainThread](2024-04-25 19:19:36,676) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-05-05 SH600000   -0.073536
           SH600008   -0.129607
           SH600009   -0.217149
           SH600010   -0.060950
           SH600015   -0.069424
[3380957:MainThread](2024-04-25 19:19:38,071) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  11%|█▏        | 5/44 [05:05<38:42, 59.56s/it][3380957:MainThread](2024-04-25 19:19:38,079) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:19:38,091) INFO - qlib.workflow - [recorder.py:341] - Recorder 41b6e49538794da8b4f76307293636c9 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:19:38,892) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:19:38,892) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:19:38,896) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:19:38,896) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:19:46,545) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.561265
            SH600004      0.561265
            SH600006      0.561265
            SH600007      0.561265
            SH600008      0.561265
                            ...   
2015-06-02  SZ300070      0.735755
            SZ300124      0.735755
            SZ300133      0.735755
            SZ300146      0.735755
            SZ300251      0.735755
Length: 506316, dtype: float64
[3380957:MainThread](2024-04-25 19:19:46,548) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:19:46,548) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:19:46,548) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:48,995) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:49,200) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996403
[3380957:MainThread](2024-04-25 19:19:49,201) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:19:49,201) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:51,598) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:51,803) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995955
[3380957:MainThread](2024-04-25 19:19:51,804) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:19:51,804) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:54,197) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:54,400) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995253
[3380957:MainThread](2024-04-25 19:19:54,401) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:19:54,401) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:56,783) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:56,986) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996128
[3380957:MainThread](2024-04-25 19:19:56,986) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:19:56,986) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:19:59,391) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:19:59,595) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994916
[3380957:MainThread](2024-04-25 19:19:59,596) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:19:59,596) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:20:01,977) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:20:02,181) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995212
[3380957:MainThread](2024-04-25 19:20:02,181) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:20:02,181) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:20:04,597) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:20:04,803) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994498
[3380957:MainThread](2024-04-25 19:20:04,804) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:20:04,804) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:20:07,249) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:20:07,453) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994549
[3380957:MainThread](2024-04-25 19:20:07,453) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:20:07,454) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:20:09,894) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:20:10,099) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996323
[3380957:MainThread](2024-04-25 19:20:10,099) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:20:10,099) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:20:12,540) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:20:12,745) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994984
[3380957:MainThread](2024-04-25 19:20:12,746) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:20:12,746) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:20:15,152) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:20:15,357) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995250
[3380957:MainThread](2024-04-25 19:20:15,358) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:20:15,358) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:20:17,755) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:20:17,960) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994323
[3380957:MainThread](2024-04-25 19:20:17,961) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:20:17,962) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:20:20,350) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:20:20,555) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993123
[3380957:MainThread](2024-04-25 19:20:20,556) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:20:20,556) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:20:22,918) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:20:23,122) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995946
[3380957:MainThread](2024-04-25 19:20:23,123) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:20:23,123) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:20:25,497) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:20:25,702) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995430
[3380957:MainThread](2024-04-25 19:20:25,702) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:20:25,702) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:20:28,063) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:20:28,270) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994854
[3380957:MainThread](2024-04-25 19:20:28,271) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:20:28,271) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:20:30,653) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:20:30,858) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995938
[3380957:MainThread](2024-04-25 19:20:30,858) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:20:30,858) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:20:33,211) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:20:33,417) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994285
[3380957:MainThread](2024-04-25 19:20:33,417) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:20:33,417) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:20:35,777) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:20:35,982) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995603
[3380957:MainThread](2024-04-25 19:20:35,982) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:20:35,982) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:20:38,355) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:20:38,561) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996156
[3380957:MainThread](2024-04-25 19:20:38,561) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:20:38,561) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:20:40,933) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:20:41,137) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995610
[3380957:MainThread](2024-04-25 19:20:41,138) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:20:41,138) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993123 @ 12
[3380957:MainThread](2024-04-25 19:20:41,244) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-06-06 SH600000    0.006427
           SH600008   -0.025902
           SH600009    0.022911
           SH600010   -0.005532
           SH600015    0.018743
[3380957:MainThread](2024-04-25 19:20:42,938) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  14%|█▎        | 6/44 [06:10<38:51, 61.37s/it][3380957:MainThread](2024-04-25 19:20:42,947) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:20:42,959) INFO - qlib.workflow - [recorder.py:341] - Recorder 62fb85808bf445779d3ccf13f4d737c4 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:20:43,768) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:20:43,769) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:20:43,773) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:20:43,773) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:20:51,449) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.766885
            SH600004      1.766885
            SH600006      1.766885
            SH600007      1.766885
            SH600008      1.766885
                            ...   
2015-07-10  SZ300059      1.511773
            SZ300070      1.511773
            SZ300104      1.511773
            SZ300124      1.511773
            SZ300146      1.511773
Length: 511531, dtype: float64
[3380957:MainThread](2024-04-25 19:20:51,451) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:20:51,451) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:20:51,452) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:20:53,893) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:20:54,118) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995342
[3380957:MainThread](2024-04-25 19:20:54,119) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:20:54,119) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:20:56,524) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:20:56,750) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995256
[3380957:MainThread](2024-04-25 19:20:56,751) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:20:56,751) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:20:59,119) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:20:59,348) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994121
[3380957:MainThread](2024-04-25 19:20:59,349) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:20:59,350) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:21:01,761) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:21:01,991) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993404
[3380957:MainThread](2024-04-25 19:21:01,992) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:21:01,993) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:21:04,449) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:21:04,679) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993002
[3380957:MainThread](2024-04-25 19:21:04,680) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:21:04,680) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:21:07,086) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:21:07,310) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993020
[3380957:MainThread](2024-04-25 19:21:07,310) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:21:07,311) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:21:09,736) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:21:09,964) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992224
[3380957:MainThread](2024-04-25 19:21:09,965) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:21:09,965) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:21:12,456) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:21:12,687) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991560
[3380957:MainThread](2024-04-25 19:21:12,688) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:21:12,689) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:21:15,169) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:21:15,398) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991093
[3380957:MainThread](2024-04-25 19:21:15,399) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:21:15,399) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:21:17,884) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:21:18,112) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991946
[3380957:MainThread](2024-04-25 19:21:18,113) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:21:18,113) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:21:20,597) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:21:20,827) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992482
[3380957:MainThread](2024-04-25 19:21:20,827) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:21:20,828) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:21:23,313) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:21:23,539) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993291
[3380957:MainThread](2024-04-25 19:21:23,539) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:21:23,540) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:21:26,021) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:21:26,252) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992050
[3380957:MainThread](2024-04-25 19:21:26,253) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:21:26,253) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:21:28,669) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:21:28,896) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991511
[3380957:MainThread](2024-04-25 19:21:28,897) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:21:28,897) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:21:31,221) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:21:31,446) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991982
[3380957:MainThread](2024-04-25 19:21:31,446) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:21:31,447) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:21:33,863) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:21:34,088) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992416
[3380957:MainThread](2024-04-25 19:21:34,088) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:21:34,088) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:21:36,523) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:21:36,749) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992218
[3380957:MainThread](2024-04-25 19:21:36,749) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:21:36,749) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991093 @ 8
[3380957:MainThread](2024-04-25 19:21:36,800) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-07-04 SH600000    0.004966
           SH600008   -0.042276
           SH600009   -0.065471
           SH600010    0.011037
           SH600015   -0.004023
[3380957:MainThread](2024-04-25 19:21:38,518) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  16%|█▌        | 7/44 [07:06<36:40, 59.47s/it][3380957:MainThread](2024-04-25 19:21:38,527) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:21:38,540) INFO - qlib.workflow - [recorder.py:341] - Recorder da9b37b3a5a540dfa9a3721cabc191ab starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:21:39,370) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:21:39,370) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:21:39,373) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:21:39,374) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:21:47,400) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.031062
            SH600004      1.031062
            SH600006      1.031062
            SH600007      1.031062
            SH600008      1.031062
                            ...   
2015-08-07  SZ300104      1.693138
            SZ300124      1.693138
            SZ300133      1.693138
            SZ300146      1.693138
            SZ300251      1.693138
Length: 516849, dtype: float64
[3380957:MainThread](2024-04-25 19:21:47,402) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:21:47,403) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:21:47,403) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:21:49,945) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:21:50,166) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995440
[3380957:MainThread](2024-04-25 19:21:50,168) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:21:50,168) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:21:52,680) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:21:52,904) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994697
[3380957:MainThread](2024-04-25 19:21:52,905) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:21:52,905) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:21:55,415) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:21:55,640) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994510
[3380957:MainThread](2024-04-25 19:21:55,641) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:21:55,642) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:21:58,144) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:21:58,369) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994222
[3380957:MainThread](2024-04-25 19:21:58,370) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:21:58,370) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:22:00,878) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:22:01,101) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994415
[3380957:MainThread](2024-04-25 19:22:01,102) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:22:01,102) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:22:03,590) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:22:03,812) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993911
[3380957:MainThread](2024-04-25 19:22:03,813) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:22:03,813) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:22:06,267) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:22:06,490) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993762
[3380957:MainThread](2024-04-25 19:22:06,491) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:22:06,492) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:22:08,945) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:22:09,169) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994553
[3380957:MainThread](2024-04-25 19:22:09,169) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:22:09,169) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:22:11,676) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:22:11,900) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993504
[3380957:MainThread](2024-04-25 19:22:11,902) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:22:11,902) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:22:14,380) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:22:14,605) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993898
[3380957:MainThread](2024-04-25 19:22:14,605) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:22:14,606) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:22:17,094) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:22:17,317) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992469
[3380957:MainThread](2024-04-25 19:22:17,318) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:22:17,319) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:22:19,767) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:22:19,989) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993953
[3380957:MainThread](2024-04-25 19:22:19,989) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:22:19,990) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:22:22,366) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:22:22,589) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993317
[3380957:MainThread](2024-04-25 19:22:22,589) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:22:22,589) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:22:25,014) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:22:25,238) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992688
[3380957:MainThread](2024-04-25 19:22:25,238) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:22:25,238) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:22:27,677) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:22:27,903) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991721
[3380957:MainThread](2024-04-25 19:22:27,904) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:22:27,904) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:22:30,378) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:22:30,602) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992770
[3380957:MainThread](2024-04-25 19:22:30,603) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:22:30,603) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:22:32,992) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:22:33,214) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992124
[3380957:MainThread](2024-04-25 19:22:33,214) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:22:33,215) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:22:35,653) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:22:35,876) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993383
[3380957:MainThread](2024-04-25 19:22:35,876) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:22:35,876) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:22:38,339) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:22:38,561) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993481
[3380957:MainThread](2024-04-25 19:22:38,561) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:22:38,561) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:22:41,058) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:22:41,281) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993841
[3380957:MainThread](2024-04-25 19:22:41,281) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:22:41,282) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:22:43,796) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:22:44,021) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992217
[3380957:MainThread](2024-04-25 19:22:44,021) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:22:44,022) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:22:46,524) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:22:46,749) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994060
[3380957:MainThread](2024-04-25 19:22:46,749) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 19:22:46,749) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:22:49,255) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:22:49,482) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993902
[3380957:MainThread](2024-04-25 19:22:49,483) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:22:49,483) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991721 @ 14
[3380957:MainThread](2024-04-25 19:22:49,534) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-08-01 SH600000   -0.021961
           SH600008    0.002718
           SH600009   -0.027750
           SH600010    0.081050
           SH600015   -0.123744
[3380957:MainThread](2024-04-25 19:22:51,242) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  18%|█▊        | 8/44 [08:18<38:12, 63.69s/it][3380957:MainThread](2024-04-25 19:22:51,252) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:22:51,265) INFO - qlib.workflow - [recorder.py:341] - Recorder 5de1a8eae0704beb8aab0d18af4aca66 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:22:52,207) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:22:52,208) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:22:52,211) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:22:52,212) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:23:00,191) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.438725
            SH600004      1.438725
            SH600006      1.438725
            SH600007      1.438725
            SH600008      1.438725
                            ...   
2015-09-08  SZ300104      1.792362
            SZ300124      1.792362
            SZ300133      1.792362
            SZ300146      1.792362
            SZ300251      1.792362
Length: 522220, dtype: float64
[3380957:MainThread](2024-04-25 19:23:00,194) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:23:00,194) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:23:00,194) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:02,818) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:03,008) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995831
[3380957:MainThread](2024-04-25 19:23:03,009) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:23:03,010) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:05,576) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:05,765) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994608
[3380957:MainThread](2024-04-25 19:23:05,766) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:23:05,766) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:08,361) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:08,550) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993787
[3380957:MainThread](2024-04-25 19:23:08,551) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:23:08,551) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:11,130) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:11,320) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994257
[3380957:MainThread](2024-04-25 19:23:11,320) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:23:11,320) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:13,894) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:14,084) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992975
[3380957:MainThread](2024-04-25 19:23:14,085) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:23:14,086) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:16,645) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:16,839) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993504
[3380957:MainThread](2024-04-25 19:23:16,839) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:23:16,840) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:19,421) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:19,612) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993395
[3380957:MainThread](2024-04-25 19:23:19,612) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:23:19,612) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:22,151) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:22,340) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992850
[3380957:MainThread](2024-04-25 19:23:22,341) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:23:22,341) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:24,884) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:25,073) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992801
[3380957:MainThread](2024-04-25 19:23:25,074) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:23:25,075) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:27,565) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:27,758) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993126
[3380957:MainThread](2024-04-25 19:23:27,758) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:23:27,759) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:30,285) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:30,474) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992212
[3380957:MainThread](2024-04-25 19:23:30,475) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:23:30,476) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:32,967) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:33,157) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993071
[3380957:MainThread](2024-04-25 19:23:33,158) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:23:33,158) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:35,660) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:35,848) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991700
[3380957:MainThread](2024-04-25 19:23:35,849) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:23:35,850) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:38,346) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:38,535) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991652
[3380957:MainThread](2024-04-25 19:23:38,536) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:23:38,536) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:41,096) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:41,286) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991225
[3380957:MainThread](2024-04-25 19:23:41,287) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:23:41,287) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:43,833) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:44,023) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991645
[3380957:MainThread](2024-04-25 19:23:44,024) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:23:44,024) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:46,524) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:46,713) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991107
[3380957:MainThread](2024-04-25 19:23:46,714) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:23:46,715) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:49,216) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:49,407) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991452
[3380957:MainThread](2024-04-25 19:23:49,408) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:23:49,408) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:51,917) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:52,105) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991394
[3380957:MainThread](2024-04-25 19:23:52,106) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:23:52,106) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:54,612) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:54,801) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992006
[3380957:MainThread](2024-04-25 19:23:54,802) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:23:54,802) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:57,301) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:23:57,491) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991850
[3380957:MainThread](2024-04-25 19:23:57,491) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:23:57,492) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:23:59,992) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:24:00,181) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991561
[3380957:MainThread](2024-04-25 19:24:00,182) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 19:24:00,182) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:24:02,695) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:24:02,886) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990898
[3380957:MainThread](2024-04-25 19:24:02,887) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 19:24:02,887) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:24:05,414) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:24:05,604) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991465
[3380957:MainThread](2024-04-25 19:24:05,605) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 19:24:05,605) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:24:08,111) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:24:08,301) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991764
[3380957:MainThread](2024-04-25 19:24:08,301) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 19:24:08,301) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:24:10,810) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:24:10,999) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991552
[3380957:MainThread](2024-04-25 19:24:11,000) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 19:24:11,000) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:24:13,475) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:24:13,664) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992956
[3380957:MainThread](2024-04-25 19:24:13,665) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[3380957:MainThread](2024-04-25 19:24:13,665) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:24:16,173) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:24:16,362) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992003
[3380957:MainThread](2024-04-25 19:24:16,362) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[3380957:MainThread](2024-04-25 19:24:16,363) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:24:18,910) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:24:19,101) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992585
[3380957:MainThread](2024-04-25 19:24:19,102) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[3380957:MainThread](2024-04-25 19:24:19,102) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:24:21,673) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:24:21,862) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992822
[3380957:MainThread](2024-04-25 19:24:21,862) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch30:
[3380957:MainThread](2024-04-25 19:24:21,863) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:24:24,428) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:24:24,617) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993247
[3380957:MainThread](2024-04-25 19:24:24,618) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:24:24,618) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990898 @ 22
[3380957:MainThread](2024-04-25 19:24:24,674) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-08-29 SH600000   -0.016421
           SH600008   -0.107512
           SH600009    0.182935
           SH600010   -0.169310
           SH600015   -0.009018
[3380957:MainThread](2024-04-25 19:24:26,410) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  20%|██        | 9/44 [09:54<42:53, 73.53s/it][3380957:MainThread](2024-04-25 19:24:26,419) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:24:26,430) INFO - qlib.workflow - [recorder.py:341] - Recorder 5dba63fd56ce43298f18cc29284e8f27 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:24:27,271) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:24:27,272) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:24:27,275) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:24:27,275) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:24:35,269) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.322642
            SH600004      1.322642
            SH600006      1.322642
            SH600007      1.322642
            SH600008      1.322642
                            ...   
2015-10-13  SZ300104      1.789476
            SZ300124      1.789476
            SZ300133      1.789476
            SZ300146      1.789476
            SZ300251      1.789476
Length: 527673, dtype: float64
[3380957:MainThread](2024-04-25 19:24:35,271) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:24:35,271) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:24:35,272) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:24:37,908) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:24:38,128) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995080
[3380957:MainThread](2024-04-25 19:24:38,129) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:24:38,130) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:24:40,665) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:24:40,887) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994707
[3380957:MainThread](2024-04-25 19:24:40,888) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:24:40,888) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:24:43,447) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:24:43,669) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993531
[3380957:MainThread](2024-04-25 19:24:43,670) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:24:43,671) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:24:46,234) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:24:46,455) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994104
[3380957:MainThread](2024-04-25 19:24:46,455) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:24:46,456) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:24:49,006) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:24:49,227) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995195
[3380957:MainThread](2024-04-25 19:24:49,228) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:24:49,228) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:24:51,782) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:24:52,003) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993414
[3380957:MainThread](2024-04-25 19:24:52,004) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:24:52,004) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:24:54,546) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:24:54,770) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992335
[3380957:MainThread](2024-04-25 19:24:54,771) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:24:54,772) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:24:57,297) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:24:57,519) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992699
[3380957:MainThread](2024-04-25 19:24:57,519) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:24:57,519) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:25:00,039) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:25:00,260) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992267
[3380957:MainThread](2024-04-25 19:25:00,261) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:25:00,262) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:25:02,801) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:25:03,023) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992653
[3380957:MainThread](2024-04-25 19:25:03,023) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:25:03,023) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:25:05,549) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:25:05,770) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992958
[3380957:MainThread](2024-04-25 19:25:05,770) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:25:05,770) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:25:08,319) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:25:08,540) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991505
[3380957:MainThread](2024-04-25 19:25:08,541) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:25:08,541) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:25:11,077) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:25:11,297) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991916
[3380957:MainThread](2024-04-25 19:25:11,298) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:25:11,298) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:25:13,851) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:25:14,071) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991018
[3380957:MainThread](2024-04-25 19:25:14,072) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:25:14,073) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:25:16,629) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:25:16,855) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991800
[3380957:MainThread](2024-04-25 19:25:16,856) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:25:16,856) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:25:19,423) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:25:19,648) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991455
[3380957:MainThread](2024-04-25 19:25:19,648) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:25:19,649) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:25:22,186) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:25:22,410) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991750
[3380957:MainThread](2024-04-25 19:25:22,411) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:25:22,411) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:25:25,004) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:25:25,225) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992170
[3380957:MainThread](2024-04-25 19:25:25,226) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:25:25,226) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:25:27,796) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:25:28,021) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992442
[3380957:MainThread](2024-04-25 19:25:28,021) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:25:28,021) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:25:30,590) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:25:30,811) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992136
[3380957:MainThread](2024-04-25 19:25:30,812) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:25:30,812) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:25:33,354) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:25:33,575) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992088
[3380957:MainThread](2024-04-25 19:25:33,575) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:25:33,575) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:25:36,110) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:25:36,335) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991324
[3380957:MainThread](2024-04-25 19:25:36,335) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:25:36,335) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991018 @ 13
[3380957:MainThread](2024-04-25 19:25:36,458) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-09-26 SH600000    0.021440
           SH600008   -0.002766
           SH600009    0.030386
           SH600010   -0.018523
           SH600015    0.009509
[3380957:MainThread](2024-04-25 19:25:38,203) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  23%|██▎       | 10/44 [11:05<41:21, 73.00s/it][3380957:MainThread](2024-04-25 19:25:38,212) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:25:38,224) INFO - qlib.workflow - [recorder.py:341] - Recorder 832bb0ad0eca45aeae8b55fc8a9a840f starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:25:39,137) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:25:39,138) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:25:39,141) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:25:39,141) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:25:47,223) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.465435
            SH600004      1.465435
            SH600006      1.465435
            SH600007      1.465435
            SH600008      1.465435
                            ...   
2015-11-19  SZ300104      1.883898
            SZ300124      1.883898
            SZ300133      1.883898
            SZ300146      1.883898
            SZ300251      1.883898
Length: 533252, dtype: float64
[3380957:MainThread](2024-04-25 19:25:47,226) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:25:47,226) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:25:47,227) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:25:49,859) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:25:50,085) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995164
[3380957:MainThread](2024-04-25 19:25:50,086) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:25:50,087) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:25:52,676) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:25:52,903) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994204
[3380957:MainThread](2024-04-25 19:25:52,904) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:25:52,904) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:25:55,461) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:25:55,687) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993886
[3380957:MainThread](2024-04-25 19:25:55,688) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:25:55,689) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:25:58,227) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:25:58,452) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993002
[3380957:MainThread](2024-04-25 19:25:58,453) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:25:58,454) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:26:00,988) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:26:01,212) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993299
[3380957:MainThread](2024-04-25 19:26:01,213) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:26:01,213) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:26:03,744) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:26:03,969) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993622
[3380957:MainThread](2024-04-25 19:26:03,970) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:26:03,970) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:26:06,497) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:26:06,725) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992855
[3380957:MainThread](2024-04-25 19:26:06,726) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:26:06,726) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:26:09,298) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:26:09,523) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992372
[3380957:MainThread](2024-04-25 19:26:09,524) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:26:09,524) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:26:12,122) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:26:12,346) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991991
[3380957:MainThread](2024-04-25 19:26:12,348) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:26:12,348) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:26:14,925) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:26:15,151) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992197
[3380957:MainThread](2024-04-25 19:26:15,152) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:26:15,152) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:26:17,698) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:26:17,923) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991781
[3380957:MainThread](2024-04-25 19:26:17,924) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:26:17,924) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:26:20,509) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:26:20,739) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991215
[3380957:MainThread](2024-04-25 19:26:20,740) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:26:20,740) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:26:23,334) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:26:23,560) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991745
[3380957:MainThread](2024-04-25 19:26:23,561) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:26:23,561) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:26:26,161) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:26:26,389) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992178
[3380957:MainThread](2024-04-25 19:26:26,389) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:26:26,390) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:26:28,944) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:26:29,172) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991615
[3380957:MainThread](2024-04-25 19:26:29,172) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:26:29,173) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:26:31,769) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:26:31,994) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991249
[3380957:MainThread](2024-04-25 19:26:31,994) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:26:31,995) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:26:34,573) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:26:34,798) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991449
[3380957:MainThread](2024-04-25 19:26:34,799) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:26:34,799) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:26:37,358) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:26:37,583) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991402
[3380957:MainThread](2024-04-25 19:26:37,584) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:26:37,584) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:26:40,146) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:26:40,371) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991526
[3380957:MainThread](2024-04-25 19:26:40,372) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:26:40,372) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:26:42,926) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:26:43,151) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991890
[3380957:MainThread](2024-04-25 19:26:43,151) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:26:43,152) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991215 @ 11
[3380957:MainThread](2024-04-25 19:26:43,203) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-10-31 SH600000   -0.057936
           SH600008   -0.090584
           SH600009    0.194054
           SH600010    0.033805
           SH600015   -0.085458
[3380957:MainThread](2024-04-25 19:26:44,928) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  25%|██▌       | 11/44 [12:12<39:05, 71.08s/it][3380957:MainThread](2024-04-25 19:26:44,937) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:26:44,948) INFO - qlib.workflow - [recorder.py:341] - Recorder ec153cdb283246bcb79c5cd43cc8a966 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:26:45,703) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:26:45,704) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:26:45,706) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:26:45,707) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:26:53,376) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.071764
            SH600004      1.071764
            SH600006      1.071764
            SH600007      1.071764
            SH600008      1.071764
                            ...   
2015-12-17  SZ300133      1.984647
            SZ300144      1.984647
            SZ300146      1.984647
            SZ300251      1.984647
            SZ300315      1.984647
Length: 538891, dtype: float64
[3380957:MainThread](2024-04-25 19:26:53,378) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:26:53,379) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:26:53,379) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:26:56,104) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:26:56,329) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995557
[3380957:MainThread](2024-04-25 19:26:56,330) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:26:56,331) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:26:58,890) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:26:59,115) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994947
[3380957:MainThread](2024-04-25 19:26:59,116) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:26:59,117) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:01,639) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:01,864) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995452
[3380957:MainThread](2024-04-25 19:27:01,864) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:27:01,865) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:04,397) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:04,624) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993692
[3380957:MainThread](2024-04-25 19:27:04,625) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:27:04,626) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:07,151) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:07,376) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993285
[3380957:MainThread](2024-04-25 19:27:07,377) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:27:07,378) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:09,883) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:10,108) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994679
[3380957:MainThread](2024-04-25 19:27:10,108) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:27:10,108) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:12,625) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:12,851) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993226
[3380957:MainThread](2024-04-25 19:27:12,852) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:27:12,852) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:15,360) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:15,586) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993321
[3380957:MainThread](2024-04-25 19:27:15,586) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:27:15,586) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:18,105) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:18,330) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992759
[3380957:MainThread](2024-04-25 19:27:18,331) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:27:18,332) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:20,860) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:21,085) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993709
[3380957:MainThread](2024-04-25 19:27:21,085) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:27:21,086) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:23,639) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:23,867) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992520
[3380957:MainThread](2024-04-25 19:27:23,868) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:27:23,869) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:26,466) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:26,694) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992979
[3380957:MainThread](2024-04-25 19:27:26,694) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:27:26,695) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:29,301) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:29,527) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992445
[3380957:MainThread](2024-04-25 19:27:29,528) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:27:29,528) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:32,081) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:32,310) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993685
[3380957:MainThread](2024-04-25 19:27:32,311) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:27:32,311) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:34,847) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:35,073) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992047
[3380957:MainThread](2024-04-25 19:27:35,074) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:27:35,074) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:37,541) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:37,767) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991979
[3380957:MainThread](2024-04-25 19:27:37,768) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:27:37,769) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:40,221) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:40,447) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991971
[3380957:MainThread](2024-04-25 19:27:40,448) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:27:40,448) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:42,908) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:43,135) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991115
[3380957:MainThread](2024-04-25 19:27:43,136) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:27:43,136) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:45,589) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:45,815) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991916
[3380957:MainThread](2024-04-25 19:27:45,816) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:27:45,816) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:48,268) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:48,494) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992120
[3380957:MainThread](2024-04-25 19:27:48,495) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:27:48,495) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:50,979) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:51,204) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991143
[3380957:MainThread](2024-04-25 19:27:51,204) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:27:51,205) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:53,795) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:54,026) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991515
[3380957:MainThread](2024-04-25 19:27:54,026) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 19:27:54,026) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:56,553) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:56,778) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993222
[3380957:MainThread](2024-04-25 19:27:56,779) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 19:27:56,779) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:27:59,311) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:27:59,538) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992509
[3380957:MainThread](2024-04-25 19:27:59,538) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 19:27:59,538) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:28:02,032) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:28:02,259) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993368
[3380957:MainThread](2024-04-25 19:28:02,259) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 19:28:02,259) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:28:04,775) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:28:05,001) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991694
[3380957:MainThread](2024-04-25 19:28:05,002) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:28:05,002) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991115 @ 17
[3380957:MainThread](2024-04-25 19:28:05,356) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-11-28 SH600000   -0.019694
           SH600008   -0.104941
           SH600009   -0.025009
           SH600010   -0.031834
           SH600015    0.001051
[3380957:MainThread](2024-04-25 19:28:07,059) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  27%|██▋       | 12/44 [13:34<39:42, 74.44s/it][3380957:MainThread](2024-04-25 19:28:07,068) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:28:07,080) INFO - qlib.workflow - [recorder.py:341] - Recorder 70898a493fd14e51b1294a1f7592bc70 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:28:07,843) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:28:07,843) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:28:07,845) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:28:07,846) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:28:15,427) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.602251
            SH600004      1.602251
            SH600006      1.602251
            SH600007      1.602251
            SH600008      1.602251
                            ...   
2016-01-15  SZ300133      1.050919
            SZ300144      1.050919
            SZ300146      1.050919
            SZ300251      1.050919
            SZ300315      1.050919
Length: 544436, dtype: float64
[3380957:MainThread](2024-04-25 19:28:15,429) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:28:15,429) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:28:15,430) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:28:17,953) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:28:18,177) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995708
[3380957:MainThread](2024-04-25 19:28:18,178) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:28:18,179) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:28:20,707) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:28:20,931) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995582
[3380957:MainThread](2024-04-25 19:28:20,932) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:28:20,932) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:28:23,529) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:28:23,756) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994092
[3380957:MainThread](2024-04-25 19:28:23,757) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:28:23,757) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:28:26,327) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:28:26,552) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993378
[3380957:MainThread](2024-04-25 19:28:26,553) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:28:26,553) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:28:29,148) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:28:29,372) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993924
[3380957:MainThread](2024-04-25 19:28:29,372) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:28:29,372) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:28:31,912) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:28:32,136) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992821
[3380957:MainThread](2024-04-25 19:28:32,137) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:28:32,137) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:28:34,733) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:28:34,957) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993618
[3380957:MainThread](2024-04-25 19:28:34,957) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:28:34,957) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:28:37,547) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:28:37,770) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993075
[3380957:MainThread](2024-04-25 19:28:37,771) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:28:37,771) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:28:40,375) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:28:40,599) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991951
[3380957:MainThread](2024-04-25 19:28:40,600) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:28:40,601) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:28:43,196) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:28:43,424) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992574
[3380957:MainThread](2024-04-25 19:28:43,424) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:28:43,424) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:28:46,024) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:28:46,248) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991029
[3380957:MainThread](2024-04-25 19:28:46,249) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:28:46,250) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:28:48,852) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:28:49,077) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991045
[3380957:MainThread](2024-04-25 19:28:49,078) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:28:49,078) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:28:51,726) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:28:51,954) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991462
[3380957:MainThread](2024-04-25 19:28:51,954) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:28:51,955) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:28:54,580) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:28:54,805) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991007
[3380957:MainThread](2024-04-25 19:28:54,807) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:28:54,807) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:28:57,443) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:28:57,668) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991582
[3380957:MainThread](2024-04-25 19:28:57,668) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:28:57,669) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:29:00,282) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:29:00,507) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991182
[3380957:MainThread](2024-04-25 19:29:00,507) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:29:00,508) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:29:03,095) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:29:03,324) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990820
[3380957:MainThread](2024-04-25 19:29:03,325) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:29:03,326) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:29:05,948) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:29:06,177) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991582
[3380957:MainThread](2024-04-25 19:29:06,178) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:29:06,178) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:29:08,756) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:29:08,982) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990950
[3380957:MainThread](2024-04-25 19:29:08,982) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:29:08,983) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:29:11,582) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:29:11,809) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990563
[3380957:MainThread](2024-04-25 19:29:11,810) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:29:11,810) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:29:14,382) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:29:14,606) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991961
[3380957:MainThread](2024-04-25 19:29:14,606) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:29:14,607) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:29:17,215) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:29:17,442) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990426
[3380957:MainThread](2024-04-25 19:29:17,444) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 19:29:17,444) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:29:20,082) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:29:20,308) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992093
[3380957:MainThread](2024-04-25 19:29:20,308) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 19:29:20,309) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:29:22,948) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:29:23,171) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991736
[3380957:MainThread](2024-04-25 19:29:23,171) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 19:29:23,172) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:29:25,695) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:29:25,924) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991557
[3380957:MainThread](2024-04-25 19:29:25,924) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 19:29:25,924) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:29:28,500) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:29:28,729) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991612
[3380957:MainThread](2024-04-25 19:29:28,729) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 19:29:28,729) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:29:31,299) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:29:31,527) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992134
[3380957:MainThread](2024-04-25 19:29:31,528) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[3380957:MainThread](2024-04-25 19:29:31,528) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:29:34,105) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:29:34,334) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992175
[3380957:MainThread](2024-04-25 19:29:34,334) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[3380957:MainThread](2024-04-25 19:29:34,334) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:29:36,910) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:29:37,138) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992557
[3380957:MainThread](2024-04-25 19:29:37,138) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[3380957:MainThread](2024-04-25 19:29:37,139) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:29:39,752) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:29:39,977) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993101
[3380957:MainThread](2024-04-25 19:29:39,977) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:29:39,978) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990426 @ 21
[3380957:MainThread](2024-04-25 19:29:40,028) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-12-26 SH600000    0.006612
           SH600008    0.085357
           SH600009    0.040295
           SH600010   -0.053775
           SH600011    0.040721
[3380957:MainThread](2024-04-25 19:29:41,748) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  30%|██▉       | 13/44 [15:09<41:37, 80.57s/it][3380957:MainThread](2024-04-25 19:29:41,757) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:29:41,769) INFO - qlib.workflow - [recorder.py:341] - Recorder bcf96c25062c42c5aea8a7af25acfa30 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:29:42,582) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:29:42,583) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:29:42,585) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:29:42,586) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:29:50,573) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.745322
            SH600004      0.745322
            SH600006      0.745322
            SH600007      0.745322
            SH600008      0.745322
                            ...   
2016-03-16  SZ300133      1.471721
            SZ300144      1.471721
            SZ300146      1.471721
            SZ300251      1.471721
            SZ300315      1.471721
Length: 550075, dtype: float64
[3380957:MainThread](2024-04-25 19:29:50,576) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:29:50,576) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:29:50,576) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:29:53,270) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:29:53,460) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995834
[3380957:MainThread](2024-04-25 19:29:53,462) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:29:53,462) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:29:56,087) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:29:56,276) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995279
[3380957:MainThread](2024-04-25 19:29:56,277) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:29:56,277) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:29:58,893) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:29:59,081) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993680
[3380957:MainThread](2024-04-25 19:29:59,082) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:29:59,082) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:30:01,753) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:30:01,942) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993990
[3380957:MainThread](2024-04-25 19:30:01,942) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:30:01,943) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:30:04,615) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:30:04,803) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993112
[3380957:MainThread](2024-04-25 19:30:04,805) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:30:04,805) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:30:07,486) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:30:07,675) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992977
[3380957:MainThread](2024-04-25 19:30:07,676) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:30:07,677) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:30:10,362) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:30:10,553) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992697
[3380957:MainThread](2024-04-25 19:30:10,554) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:30:10,555) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:30:13,214) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:30:13,405) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992763
[3380957:MainThread](2024-04-25 19:30:13,405) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:30:13,406) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:30:16,038) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:30:16,227) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992258
[3380957:MainThread](2024-04-25 19:30:16,229) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:30:16,229) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:30:18,830) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:30:19,019) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991839
[3380957:MainThread](2024-04-25 19:30:19,020) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:30:19,020) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:30:21,611) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:30:21,800) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991718
[3380957:MainThread](2024-04-25 19:30:21,801) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:30:21,801) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:30:24,433) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:30:24,622) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991827
[3380957:MainThread](2024-04-25 19:30:24,622) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:30:24,622) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:30:27,229) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:30:27,418) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991778
[3380957:MainThread](2024-04-25 19:30:27,419) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:30:27,419) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:30:30,065) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:30:30,254) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991451
[3380957:MainThread](2024-04-25 19:30:30,255) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:30:30,255) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:30:32,879) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:30:33,069) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992231
[3380957:MainThread](2024-04-25 19:30:33,069) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:30:33,070) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:30:35,673) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:30:35,863) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991956
[3380957:MainThread](2024-04-25 19:30:35,864) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:30:35,864) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:30:38,503) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:30:38,691) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991513
[3380957:MainThread](2024-04-25 19:30:38,691) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:30:38,692) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:30:41,361) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:30:41,550) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991635
[3380957:MainThread](2024-04-25 19:30:41,550) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:30:41,551) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:30:44,194) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:30:44,384) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992009
[3380957:MainThread](2024-04-25 19:30:44,384) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:30:44,385) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:30:47,014) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:30:47,204) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992093
[3380957:MainThread](2024-04-25 19:30:47,205) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:30:47,205) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:30:49,849) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:30:50,038) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992494
[3380957:MainThread](2024-04-25 19:30:50,038) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:30:50,039) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:30:52,650) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:30:52,840) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991880
[3380957:MainThread](2024-04-25 19:30:52,840) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:30:52,841) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991451 @ 13
[3380957:MainThread](2024-04-25 19:30:52,891) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-01-24 SH600000    0.058949
           SH600008   -0.106465
           SH600009    0.125765
           SH600010   -0.027182
           SH600011   -0.088886
[3380957:MainThread](2024-04-25 19:30:54,606) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  32%|███▏      | 14/44 [16:22<39:07, 78.24s/it][3380957:MainThread](2024-04-25 19:30:54,615) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:30:54,626) INFO - qlib.workflow - [recorder.py:341] - Recorder 34a63083f168441594d4e849647f6e4b starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:30:55,451) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:30:55,452) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:30:55,455) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:30:55,456) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:31:03,575) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.084269
            SH600004      1.084269
            SH600006      1.084269
            SH600007      1.084269
            SH600008      1.084269
                            ...   
2016-04-14  SZ300124      1.939885
            SZ300133      1.939885
            SZ300144      1.939885
            SZ300146      1.939885
            SZ300315      1.939885
Length: 555663, dtype: float64
[3380957:MainThread](2024-04-25 19:31:03,577) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:31:03,578) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:31:03,578) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:31:06,326) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:31:06,516) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995377
[3380957:MainThread](2024-04-25 19:31:06,517) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:31:06,518) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:31:09,191) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:31:09,382) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994605
[3380957:MainThread](2024-04-25 19:31:09,383) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:31:09,383) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:31:12,088) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:31:12,280) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994284
[3380957:MainThread](2024-04-25 19:31:12,281) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:31:12,282) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:31:14,982) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:31:15,171) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993600
[3380957:MainThread](2024-04-25 19:31:15,173) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:31:15,173) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:31:17,853) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:31:18,043) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993864
[3380957:MainThread](2024-04-25 19:31:18,043) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:31:18,043) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:31:20,755) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:31:20,945) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993256
[3380957:MainThread](2024-04-25 19:31:20,946) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:31:20,946) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:31:23,655) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:31:23,845) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992578
[3380957:MainThread](2024-04-25 19:31:23,846) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:31:23,846) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:31:26,502) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:31:26,690) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992539
[3380957:MainThread](2024-04-25 19:31:26,691) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:31:26,691) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:31:29,327) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:31:29,516) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992094
[3380957:MainThread](2024-04-25 19:31:29,517) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:31:29,517) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:31:32,171) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:31:32,361) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991943
[3380957:MainThread](2024-04-25 19:31:32,362) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:31:32,363) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:31:35,057) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:31:35,247) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991496
[3380957:MainThread](2024-04-25 19:31:35,248) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:31:35,248) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:31:37,962) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:31:38,153) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991196
[3380957:MainThread](2024-04-25 19:31:38,154) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:31:38,154) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:31:40,855) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:31:41,045) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993235
[3380957:MainThread](2024-04-25 19:31:41,046) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:31:41,046) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:31:43,741) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:31:43,932) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991337
[3380957:MainThread](2024-04-25 19:31:43,932) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:31:43,933) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:31:46,627) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:31:46,820) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991482
[3380957:MainThread](2024-04-25 19:31:46,821) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:31:46,821) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:31:49,513) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:31:49,701) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991324
[3380957:MainThread](2024-04-25 19:31:49,702) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:31:49,702) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:31:52,398) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:31:52,586) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991849
[3380957:MainThread](2024-04-25 19:31:52,587) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:31:52,587) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:31:55,238) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:31:55,428) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991634
[3380957:MainThread](2024-04-25 19:31:55,428) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:31:55,428) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:31:58,128) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:31:58,318) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991875
[3380957:MainThread](2024-04-25 19:31:58,319) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:31:58,319) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:32:01,039) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:32:01,229) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990731
[3380957:MainThread](2024-04-25 19:32:01,230) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:32:01,231) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:32:03,944) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:32:04,136) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992484
[3380957:MainThread](2024-04-25 19:32:04,136) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:32:04,137) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:32:06,811) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:32:07,003) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991243
[3380957:MainThread](2024-04-25 19:32:07,003) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 19:32:07,004) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:32:09,692) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:32:09,884) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991908
[3380957:MainThread](2024-04-25 19:32:09,884) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 19:32:09,884) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:32:12,479) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:32:12,668) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992265
[3380957:MainThread](2024-04-25 19:32:12,668) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 19:32:12,668) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:32:15,366) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:32:15,557) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991733
[3380957:MainThread](2024-04-25 19:32:15,557) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 19:32:15,557) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:32:18,264) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:32:18,456) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993351
[3380957:MainThread](2024-04-25 19:32:18,456) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 19:32:18,456) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:32:21,138) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:32:21,327) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993070
[3380957:MainThread](2024-04-25 19:32:21,328) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[3380957:MainThread](2024-04-25 19:32:21,328) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:32:24,034) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:32:24,223) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992050
[3380957:MainThread](2024-04-25 19:32:24,223) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:32:24,224) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990731 @ 19
[3380957:MainThread](2024-04-25 19:32:24,275) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-02-28 SH600000   -0.130857
           SH600008   -0.008568
           SH600009    0.091368
           SH600010   -0.076654
           SH600011   -0.044869
[3380957:MainThread](2024-04-25 19:32:25,980) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  34%|███▍      | 15/44 [17:53<39:43, 82.20s/it][3380957:MainThread](2024-04-25 19:32:25,989) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:32:26,001) INFO - qlib.workflow - [recorder.py:341] - Recorder e54a741e00d04ef79fb87dc46a49b6eb starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:32:26,767) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:32:26,768) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:32:26,770) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:32:26,771) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:32:34,398) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.802339
            SH600004      0.802339
            SH600006      0.802339
            SH600007      0.802339
            SH600008      0.802339
                            ...   
2016-05-13  SZ300124      0.811507
            SZ300133      0.811507
            SZ300144      0.811507
            SZ300146      0.811507
            SZ300315      0.811507
Length: 561275, dtype: float64
[3380957:MainThread](2024-04-25 19:32:34,400) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:32:34,400) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:32:34,401) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:32:37,346) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:32:37,570) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995747
[3380957:MainThread](2024-04-25 19:32:37,571) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:32:37,571) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:32:40,280) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:32:40,504) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995151
[3380957:MainThread](2024-04-25 19:32:40,505) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:32:40,505) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:32:43,180) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:32:43,407) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994112
[3380957:MainThread](2024-04-25 19:32:43,408) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:32:43,408) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:32:46,088) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:32:46,315) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994140
[3380957:MainThread](2024-04-25 19:32:46,315) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:32:46,315) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:32:49,044) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:32:49,268) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993391
[3380957:MainThread](2024-04-25 19:32:49,269) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:32:49,270) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:32:51,987) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:32:52,213) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992898
[3380957:MainThread](2024-04-25 19:32:52,214) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:32:52,215) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:32:54,933) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:32:55,160) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992832
[3380957:MainThread](2024-04-25 19:32:55,161) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:32:55,161) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:32:57,819) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:32:58,047) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993003
[3380957:MainThread](2024-04-25 19:32:58,048) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:32:58,048) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:00,715) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:00,942) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992441
[3380957:MainThread](2024-04-25 19:33:00,943) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:33:00,944) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:03,605) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:03,832) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992604
[3380957:MainThread](2024-04-25 19:33:03,832) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:33:03,833) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:06,503) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:06,727) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992899
[3380957:MainThread](2024-04-25 19:33:06,727) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:33:06,727) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:09,389) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:09,616) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992121
[3380957:MainThread](2024-04-25 19:33:09,617) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:33:09,618) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:12,240) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:12,465) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992394
[3380957:MainThread](2024-04-25 19:33:12,465) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:33:12,465) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:15,025) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:15,250) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992285
[3380957:MainThread](2024-04-25 19:33:15,250) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:33:15,251) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:17,812) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:18,036) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992996
[3380957:MainThread](2024-04-25 19:33:18,037) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:33:18,037) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:20,672) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:20,896) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991725
[3380957:MainThread](2024-04-25 19:33:20,897) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:33:20,897) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:23,532) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:23,756) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991619
[3380957:MainThread](2024-04-25 19:33:23,757) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:33:23,757) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:26,391) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:26,615) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991351
[3380957:MainThread](2024-04-25 19:33:26,616) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:33:26,617) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:29,244) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:29,468) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991334
[3380957:MainThread](2024-04-25 19:33:29,469) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:33:29,470) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:32,097) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:32,322) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991162
[3380957:MainThread](2024-04-25 19:33:32,323) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:33:32,323) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:34,952) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:35,177) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991046
[3380957:MainThread](2024-04-25 19:33:35,178) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:33:35,178) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:37,813) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:38,038) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990827
[3380957:MainThread](2024-04-25 19:33:38,039) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 19:33:38,040) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:40,663) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:40,888) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991157
[3380957:MainThread](2024-04-25 19:33:40,888) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 19:33:40,889) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:43,538) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:43,767) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990988
[3380957:MainThread](2024-04-25 19:33:43,768) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 19:33:43,768) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:46,413) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:46,637) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993573
[3380957:MainThread](2024-04-25 19:33:46,638) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 19:33:46,638) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:49,316) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:49,545) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991494
[3380957:MainThread](2024-04-25 19:33:49,546) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 19:33:49,546) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:52,291) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:52,516) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991515
[3380957:MainThread](2024-04-25 19:33:52,517) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[3380957:MainThread](2024-04-25 19:33:52,517) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:55,237) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:55,465) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992566
[3380957:MainThread](2024-04-25 19:33:55,465) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[3380957:MainThread](2024-04-25 19:33:55,465) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:33:58,181) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:33:58,409) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992931
[3380957:MainThread](2024-04-25 19:33:58,410) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[3380957:MainThread](2024-04-25 19:33:58,410) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:34:01,085) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:34:01,313) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993755
[3380957:MainThread](2024-04-25 19:34:01,313) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:34:01,314) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990827 @ 21
[3380957:MainThread](2024-04-25 19:34:01,365) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-03-28 SH600000   -0.055184
           SH600008   -0.157496
           SH600009    0.078943
           SH600010    0.116685
           SH600011   -0.106768
[3380957:MainThread](2024-04-25 19:34:03,148) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  36%|███▋      | 16/44 [19:30<40:27, 86.71s/it][3380957:MainThread](2024-04-25 19:34:03,157) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:34:03,169) INFO - qlib.workflow - [recorder.py:341] - Recorder 75b3bbc60257452cbd3b4069507d9e97 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:34:03,970) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:34:03,971) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:34:03,973) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:34:03,974) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:34:12,043) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.773767
            SH600004      0.773767
            SH600006      0.773767
            SH600007      0.773767
            SH600008      0.773767
                            ...   
2016-06-14  SZ300133      1.551924
            SZ300144      1.551924
            SZ300146      1.551924
            SZ300251      1.551924
            SZ300315      1.551924
Length: 566995, dtype: float64
[3380957:MainThread](2024-04-25 19:34:12,045) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:34:12,046) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:34:12,046) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:34:14,740) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:34:14,966) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996358
[3380957:MainThread](2024-04-25 19:34:14,967) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:34:14,968) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:34:17,650) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:34:17,877) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994671
[3380957:MainThread](2024-04-25 19:34:17,878) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:34:17,879) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:34:20,561) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:34:20,786) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994069
[3380957:MainThread](2024-04-25 19:34:20,787) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:34:20,787) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:34:23,443) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:34:23,667) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993877
[3380957:MainThread](2024-04-25 19:34:23,668) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:34:23,668) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:34:26,324) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:34:26,548) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993197
[3380957:MainThread](2024-04-25 19:34:26,549) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:34:26,549) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:34:29,267) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:34:29,490) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992439
[3380957:MainThread](2024-04-25 19:34:29,491) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:34:29,492) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:34:32,204) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:34:32,432) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992704
[3380957:MainThread](2024-04-25 19:34:32,432) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:34:32,432) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:34:35,131) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:34:35,356) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992251
[3380957:MainThread](2024-04-25 19:34:35,357) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:34:35,357) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:34:38,008) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:34:38,232) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991944
[3380957:MainThread](2024-04-25 19:34:38,233) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:34:38,233) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:34:40,895) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:34:41,120) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992322
[3380957:MainThread](2024-04-25 19:34:41,121) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:34:41,121) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:34:43,773) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:34:43,997) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991940
[3380957:MainThread](2024-04-25 19:34:43,998) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:34:43,998) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:34:46,661) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:34:46,886) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992018
[3380957:MainThread](2024-04-25 19:34:46,886) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:34:46,887) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:34:49,542) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:34:49,767) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991323
[3380957:MainThread](2024-04-25 19:34:49,768) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:34:49,769) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:34:52,438) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:34:52,663) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991901
[3380957:MainThread](2024-04-25 19:34:52,664) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:34:52,664) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:34:55,323) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:34:55,548) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991832
[3380957:MainThread](2024-04-25 19:34:55,549) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:34:55,549) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:34:58,208) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:34:58,433) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992056
[3380957:MainThread](2024-04-25 19:34:58,433) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:34:58,433) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:35:01,095) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:35:01,326) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991934
[3380957:MainThread](2024-04-25 19:35:01,327) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:35:01,327) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:35:04,039) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:35:04,264) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991430
[3380957:MainThread](2024-04-25 19:35:04,265) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:35:04,265) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:35:06,968) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:35:07,193) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991284
[3380957:MainThread](2024-04-25 19:35:07,194) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:35:07,195) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:35:09,935) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:35:10,162) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992743
[3380957:MainThread](2024-04-25 19:35:10,163) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:35:10,163) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:35:12,905) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:35:13,132) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992358
[3380957:MainThread](2024-04-25 19:35:13,133) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:35:13,133) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:35:15,810) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:35:16,038) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991343
[3380957:MainThread](2024-04-25 19:35:16,038) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 19:35:16,039) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:35:18,718) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:35:18,943) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992682
[3380957:MainThread](2024-04-25 19:35:18,943) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 19:35:18,944) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:35:21,588) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:35:21,815) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991944
[3380957:MainThread](2024-04-25 19:35:21,816) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 19:35:21,816) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:35:24,480) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:35:24,705) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993208
[3380957:MainThread](2024-04-25 19:35:24,705) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 19:35:24,706) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:35:27,398) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:35:27,623) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993695
[3380957:MainThread](2024-04-25 19:35:27,623) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 19:35:27,624) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:35:30,353) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:35:30,579) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994082
[3380957:MainThread](2024-04-25 19:35:30,579) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:35:30,580) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991284 @ 18
[3380957:MainThread](2024-04-25 19:35:30,630) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-04-27 SH600000    0.025034
           SH600008   -0.033179
           SH600009    0.015667
           SH600010   -0.037527
           SH600011   -0.090574
[3380957:MainThread](2024-04-25 19:35:32,343) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  39%|███▊      | 17/44 [21:00<39:21, 87.45s/it][3380957:MainThread](2024-04-25 19:35:32,352) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:35:32,364) INFO - qlib.workflow - [recorder.py:341] - Recorder 86e92796ef2d44c690b781b043ebfdfd starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:35:33,156) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:35:33,156) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:35:33,160) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:35:33,161) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:35:40,864) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.117705
            SH600004      1.117705
            SH600006      1.117705
            SH600007      1.117705
            SH600008      1.117705
                            ...   
2016-07-12  SZ300144      1.725861
            SZ300146      1.725861
            SZ300168      1.725861
            SZ300251      1.725861
            SZ300315      1.725861
Length: 572790, dtype: float64
[3380957:MainThread](2024-04-25 19:35:40,866) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:35:40,867) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:35:40,867) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:35:43,785) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:35:44,009) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995599
[3380957:MainThread](2024-04-25 19:35:44,011) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:35:44,011) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:35:46,745) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:35:46,971) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994750
[3380957:MainThread](2024-04-25 19:35:46,972) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:35:46,972) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:35:49,695) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:35:49,921) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993706
[3380957:MainThread](2024-04-25 19:35:49,922) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:35:49,923) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:35:52,644) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:35:52,868) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994236
[3380957:MainThread](2024-04-25 19:35:52,868) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:35:52,868) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:35:55,495) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:35:55,720) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992795
[3380957:MainThread](2024-04-25 19:35:55,721) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:35:55,721) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:35:58,343) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:35:58,569) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993084
[3380957:MainThread](2024-04-25 19:35:58,569) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:35:58,570) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:01,293) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:01,516) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992665
[3380957:MainThread](2024-04-25 19:36:01,517) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:36:01,517) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:04,243) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:04,467) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991680
[3380957:MainThread](2024-04-25 19:36:04,469) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:36:04,469) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:07,210) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:07,434) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991747
[3380957:MainThread](2024-04-25 19:36:07,435) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:36:07,435) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:10,179) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:10,406) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992758
[3380957:MainThread](2024-04-25 19:36:10,407) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:36:10,407) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:13,131) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:13,357) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991910
[3380957:MainThread](2024-04-25 19:36:13,357) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:36:13,357) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:16,038) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:16,262) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990899
[3380957:MainThread](2024-04-25 19:36:16,263) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:36:16,263) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:18,938) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:19,163) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990719
[3380957:MainThread](2024-04-25 19:36:19,164) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:36:19,164) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:21,919) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:22,147) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990968
[3380957:MainThread](2024-04-25 19:36:22,147) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:36:22,147) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:24,905) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:25,130) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991144
[3380957:MainThread](2024-04-25 19:36:25,131) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:36:25,131) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:27,870) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:28,096) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991319
[3380957:MainThread](2024-04-25 19:36:28,096) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:36:28,097) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:30,865) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:31,093) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992432
[3380957:MainThread](2024-04-25 19:36:31,094) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:36:31,094) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:33,823) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:34,052) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990183
[3380957:MainThread](2024-04-25 19:36:34,053) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:36:34,053) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:36,682) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:36,908) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990507
[3380957:MainThread](2024-04-25 19:36:36,909) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:36:36,909) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:39,583) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:39,812) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991876
[3380957:MainThread](2024-04-25 19:36:39,812) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:36:39,813) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:42,528) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:42,754) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991099
[3380957:MainThread](2024-04-25 19:36:42,754) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:36:42,754) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:45,500) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:45,724) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991041
[3380957:MainThread](2024-04-25 19:36:45,725) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 19:36:45,725) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:48,449) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:48,673) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992208
[3380957:MainThread](2024-04-25 19:36:48,674) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 19:36:48,674) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:51,405) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:51,629) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992658
[3380957:MainThread](2024-04-25 19:36:51,630) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 19:36:51,630) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:54,306) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:54,534) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992052
[3380957:MainThread](2024-04-25 19:36:54,535) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 19:36:54,535) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:36:57,273) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:36:57,499) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991768
[3380957:MainThread](2024-04-25 19:36:57,499) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:36:57,499) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990183 @ 17
[3380957:MainThread](2024-04-25 19:36:57,551) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-05-29 SH600000   -0.054268
           SH600008    0.003869
           SH600009   -0.010979
           SH600010   -0.158172
           SH600011   -0.064204
[3380957:MainThread](2024-04-25 19:36:59,262) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  41%|████      | 18/44 [22:26<37:49, 87.29s/it][3380957:MainThread](2024-04-25 19:36:59,272) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:36:59,284) INFO - qlib.workflow - [recorder.py:341] - Recorder 42bc77dd46fd4e908e8912d36ec397a1 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:37:00,071) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:37:00,071) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:37:00,074) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:37:00,075) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:37:08,533) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.959616
            SH600004      0.959616
            SH600006      0.959616
            SH600007      0.959616
            SH600008      0.959616
                            ...   
2016-08-09  SZ300144      1.895097
            SZ300146      1.895097
            SZ300168      1.895097
            SZ300251      1.895097
            SZ300315      1.895097
Length: 578598, dtype: float64
[3380957:MainThread](2024-04-25 19:37:08,538) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:37:08,538) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:37:08,539) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:37:12,145) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:37:12,432) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995591
[3380957:MainThread](2024-04-25 19:37:12,435) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:37:12,436) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:37:16,055) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:37:16,339) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994886
[3380957:MainThread](2024-04-25 19:37:16,341) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:37:16,342) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:37:19,796) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:37:20,082) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993878
[3380957:MainThread](2024-04-25 19:37:20,085) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:37:20,087) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:37:23,484) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:37:23,753) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993712
[3380957:MainThread](2024-04-25 19:37:23,756) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:37:23,758) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:37:26,954) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:37:27,161) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993760
[3380957:MainThread](2024-04-25 19:37:27,162) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:37:27,162) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:37:30,167) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:37:30,374) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992706
[3380957:MainThread](2024-04-25 19:37:30,375) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:37:30,376) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:37:33,310) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:37:33,513) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992934
[3380957:MainThread](2024-04-25 19:37:33,513) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:37:33,514) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:37:36,550) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:37:36,760) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992458
[3380957:MainThread](2024-04-25 19:37:36,761) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:37:36,761) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:37:39,788) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:37:39,993) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992411
[3380957:MainThread](2024-04-25 19:37:39,995) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:37:39,995) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:37:42,870) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:37:43,087) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992202
[3380957:MainThread](2024-04-25 19:37:43,088) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:37:43,088) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:37:45,993) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:37:46,197) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993396
[3380957:MainThread](2024-04-25 19:37:46,197) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:37:46,198) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:37:49,176) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:37:49,386) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991878
[3380957:MainThread](2024-04-25 19:37:49,388) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:37:49,388) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:37:52,325) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:37:52,538) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991286
[3380957:MainThread](2024-04-25 19:37:52,540) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:37:52,540) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:37:55,493) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:37:55,708) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992112
[3380957:MainThread](2024-04-25 19:37:55,709) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:37:55,709) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:37:58,703) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:37:58,914) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992470
[3380957:MainThread](2024-04-25 19:37:58,914) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:37:58,914) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:38:01,915) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:38:02,124) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991536
[3380957:MainThread](2024-04-25 19:38:02,124) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:38:02,125) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:38:05,124) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:38:05,333) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991819
[3380957:MainThread](2024-04-25 19:38:05,333) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:38:05,334) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:38:08,358) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:38:08,565) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991101
[3380957:MainThread](2024-04-25 19:38:08,566) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:38:08,567) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:38:11,596) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:38:11,804) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991744
[3380957:MainThread](2024-04-25 19:38:11,805) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:38:11,805) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:38:14,824) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:38:15,033) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991652
[3380957:MainThread](2024-04-25 19:38:15,034) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:38:15,034) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:38:18,067) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:38:18,273) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991425
[3380957:MainThread](2024-04-25 19:38:18,273) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:38:18,274) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:38:21,278) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:38:21,488) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991355
[3380957:MainThread](2024-04-25 19:38:21,488) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 19:38:21,488) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:38:24,509) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:38:24,717) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991641
[3380957:MainThread](2024-04-25 19:38:24,717) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 19:38:24,718) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:38:27,689) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:38:27,897) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991582
[3380957:MainThread](2024-04-25 19:38:27,898) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 19:38:27,898) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:38:30,926) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:38:31,135) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992068
[3380957:MainThread](2024-04-25 19:38:31,136) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 19:38:31,136) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:38:34,160) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:38:34,368) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992218
[3380957:MainThread](2024-04-25 19:38:34,368) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:38:34,368) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991101 @ 17
[3380957:MainThread](2024-04-25 19:38:34,421) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-06-27 SH600000   -0.084047
           SH600008   -0.033187
           SH600009    0.090644
           SH600010    0.005657
           SH600011   -0.075401
[3380957:MainThread](2024-04-25 19:38:36,170) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  43%|████▎     | 19/44 [24:03<37:34, 90.18s/it][3380957:MainThread](2024-04-25 19:38:36,179) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:38:36,191) INFO - qlib.workflow - [recorder.py:341] - Recorder b175fa2694144d45a03a55cb72f35809 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:38:37,015) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:38:37,017) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:38:37,020) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:38:37,020) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:38:44,928) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.741477
            SH600004      0.741477
            SH600006      0.741477
            SH600007      0.741477
            SH600008      0.741477
                            ...   
2016-09-06  SZ300144      1.279540
            SZ300146      1.279540
            SZ300168      1.279540
            SZ300251      1.279540
            SZ300315      1.279540
Length: 584401, dtype: float64
[3380957:MainThread](2024-04-25 19:38:44,931) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:38:44,931) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:38:44,932) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:38:47,998) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:38:48,232) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995855
[3380957:MainThread](2024-04-25 19:38:48,233) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:38:48,234) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:38:51,272) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:38:51,507) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994397
[3380957:MainThread](2024-04-25 19:38:51,508) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:38:51,509) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:38:54,547) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:38:54,784) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994497
[3380957:MainThread](2024-04-25 19:38:54,784) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:38:54,785) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:38:57,800) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:38:58,036) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993428
[3380957:MainThread](2024-04-25 19:38:58,037) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:38:58,038) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:39:01,080) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:39:01,315) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993149
[3380957:MainThread](2024-04-25 19:39:01,316) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:39:01,316) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:39:04,361) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:39:04,597) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993209
[3380957:MainThread](2024-04-25 19:39:04,598) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:39:04,598) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:39:07,629) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:39:07,863) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992081
[3380957:MainThread](2024-04-25 19:39:07,864) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:39:07,864) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:39:10,845) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:39:11,080) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992218
[3380957:MainThread](2024-04-25 19:39:11,080) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:39:11,081) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:39:14,061) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:39:14,298) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991998
[3380957:MainThread](2024-04-25 19:39:14,299) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:39:14,299) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:39:17,275) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:39:17,508) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991406
[3380957:MainThread](2024-04-25 19:39:17,509) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:39:17,510) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:39:20,514) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:39:20,748) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991323
[3380957:MainThread](2024-04-25 19:39:20,749) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:39:20,750) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:39:23,644) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:39:23,878) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991482
[3380957:MainThread](2024-04-25 19:39:23,878) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:39:23,879) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:39:26,779) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:39:27,014) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991589
[3380957:MainThread](2024-04-25 19:39:27,015) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:39:27,015) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:39:29,910) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:39:30,145) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992325
[3380957:MainThread](2024-04-25 19:39:30,145) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:39:30,146) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:39:33,053) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:39:33,287) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990802
[3380957:MainThread](2024-04-25 19:39:33,288) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:39:33,288) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:39:36,181) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:39:36,415) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991203
[3380957:MainThread](2024-04-25 19:39:36,416) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:39:36,416) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:39:39,394) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:39:39,629) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991640
[3380957:MainThread](2024-04-25 19:39:39,630) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:39:39,630) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:39:42,675) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:39:42,910) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990876
[3380957:MainThread](2024-04-25 19:39:42,910) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:39:42,911) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:39:45,968) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:39:46,202) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992274
[3380957:MainThread](2024-04-25 19:39:46,203) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:39:46,203) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:39:49,159) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:39:49,398) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991484
[3380957:MainThread](2024-04-25 19:39:49,398) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:39:49,399) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:39:52,376) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:39:52,611) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992770
[3380957:MainThread](2024-04-25 19:39:52,611) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:39:52,611) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:39:55,576) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:39:55,813) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991778
[3380957:MainThread](2024-04-25 19:39:55,814) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 19:39:55,814) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:39:58,795) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:39:59,030) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993387
[3380957:MainThread](2024-04-25 19:39:59,031) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:39:59,031) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990802 @ 14
[3380957:MainThread](2024-04-25 19:39:59,220) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-07-25 SH600000    0.028925
           SH600008    0.044483
           SH600009   -0.109661
           SH600010   -0.109141
           SH600011   -0.016184
[3380957:MainThread](2024-04-25 19:40:00,968) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  45%|████▌     | 20/44 [25:28<35:25, 88.56s/it][3380957:MainThread](2024-04-25 19:40:00,977) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:40:00,989) INFO - qlib.workflow - [recorder.py:341] - Recorder a51ebbd3594e434a8a62ad7d81b7f2be starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:40:01,782) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:40:01,782) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:40:01,785) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:40:01,786) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:40:09,569) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.363867
            SH600004      1.363867
            SH600006      1.363867
            SH600007      1.363867
            SH600008      1.363867
                            ...   
2016-10-13  SZ300144      0.705234
            SZ300146      0.705234
            SZ300168      0.705234
            SZ300251      0.705234
            SZ300315      0.705234
Length: 590146, dtype: float64
[3380957:MainThread](2024-04-25 19:40:09,571) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:40:09,572) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:40:09,572) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:40:12,587) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:40:12,799) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995492
[3380957:MainThread](2024-04-25 19:40:12,800) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:40:12,801) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:40:15,835) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:40:16,047) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994417
[3380957:MainThread](2024-04-25 19:40:16,048) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:40:16,048) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:40:19,093) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:40:19,303) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993463
[3380957:MainThread](2024-04-25 19:40:19,304) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:40:19,304) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:40:22,310) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:40:22,522) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993015
[3380957:MainThread](2024-04-25 19:40:22,523) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:40:22,524) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:40:25,497) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:40:25,717) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993577
[3380957:MainThread](2024-04-25 19:40:25,718) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:40:25,718) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:40:28,615) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:40:28,818) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992164
[3380957:MainThread](2024-04-25 19:40:28,819) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:40:28,819) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:40:31,670) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:40:31,875) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993067
[3380957:MainThread](2024-04-25 19:40:31,875) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:40:31,876) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:40:34,768) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:40:34,974) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991927
[3380957:MainThread](2024-04-25 19:40:34,975) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:40:34,976) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:40:37,856) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:40:38,064) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991650
[3380957:MainThread](2024-04-25 19:40:38,065) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:40:38,065) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:40:40,962) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:40:41,172) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991881
[3380957:MainThread](2024-04-25 19:40:41,172) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:40:41,172) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:40:44,143) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:40:44,357) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991475
[3380957:MainThread](2024-04-25 19:40:44,359) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:40:44,359) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:40:47,341) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:40:47,544) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991184
[3380957:MainThread](2024-04-25 19:40:47,545) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:40:47,545) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:40:51,539) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:40:51,762) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990642
[3380957:MainThread](2024-04-25 19:40:51,765) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:40:51,766) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:40:54,871) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:40:55,110) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991403
[3380957:MainThread](2024-04-25 19:40:55,766) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:40:55,767) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:40:58,651) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:40:58,854) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991549
[3380957:MainThread](2024-04-25 19:40:58,854) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:40:58,855) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:41:01,753) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:41:01,961) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991594
[3380957:MainThread](2024-04-25 19:41:01,961) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:41:01,961) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:41:04,825) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:41:05,031) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990765
[3380957:MainThread](2024-04-25 19:41:05,031) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:41:05,032) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:41:07,840) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:41:08,046) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992295
[3380957:MainThread](2024-04-25 19:41:08,047) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:41:08,047) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:41:10,933) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:41:11,138) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991760
[3380957:MainThread](2024-04-25 19:41:11,138) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:41:11,139) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:41:13,973) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:41:14,178) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991512
[3380957:MainThread](2024-04-25 19:41:14,179) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:41:14,179) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:41:17,056) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:41:17,260) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991794
[3380957:MainThread](2024-04-25 19:41:17,260) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:41:17,261) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990642 @ 12
[3380957:MainThread](2024-04-25 19:41:17,621) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-08-22 SH600000   -0.003381
           SH600008   -0.086108
           SH600009    0.143403
           SH600010   -0.040063
           SH600011   -0.120020
[3380957:MainThread](2024-04-25 19:41:19,377) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  48%|████▊     | 21/44 [26:47<32:46, 85.52s/it][3380957:MainThread](2024-04-25 19:41:19,386) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:41:19,398) INFO - qlib.workflow - [recorder.py:341] - Recorder 6e5d2bb37e6e4942b12f3170a5692808 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:41:20,244) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:41:20,245) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:41:20,247) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:41:20,248) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:41:28,012) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.262837
            SH600004      1.262837
            SH600006      1.262837
            SH600007      1.262837
            SH600008      1.262837
                            ...   
2016-11-10  SZ300144      1.077125
            SZ300146      1.077125
            SZ300168      1.077125
            SZ300251      1.077125
            SZ300315      1.077125
Length: 595946, dtype: float64
[3380957:MainThread](2024-04-25 19:41:28,015) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:41:28,015) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:41:28,015) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:41:30,882) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:41:31,104) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995328
[3380957:MainThread](2024-04-25 19:41:31,105) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:41:31,105) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:41:33,974) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:41:34,196) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994106
[3380957:MainThread](2024-04-25 19:41:34,197) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:41:34,197) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:41:37,053) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:41:37,279) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993997
[3380957:MainThread](2024-04-25 19:41:37,280) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:41:37,280) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:41:40,139) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:41:40,359) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992807
[3380957:MainThread](2024-04-25 19:41:40,360) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:41:40,360) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:41:43,274) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:41:43,494) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992773
[3380957:MainThread](2024-04-25 19:41:43,495) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:41:43,496) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:41:46,394) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:41:46,617) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991924
[3380957:MainThread](2024-04-25 19:41:46,618) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:41:46,618) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:41:49,551) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:41:49,776) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991616
[3380957:MainThread](2024-04-25 19:41:49,777) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:41:49,777) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:41:52,724) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:41:52,949) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991961
[3380957:MainThread](2024-04-25 19:41:52,950) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:41:52,950) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:41:55,925) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:41:56,148) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990996
[3380957:MainThread](2024-04-25 19:41:56,149) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:41:56,149) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:41:59,048) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:41:59,272) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991159
[3380957:MainThread](2024-04-25 19:41:59,272) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:41:59,273) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:42:02,168) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:42:02,394) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990564
[3380957:MainThread](2024-04-25 19:42:02,395) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:42:02,396) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:42:05,309) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:42:05,535) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990347
[3380957:MainThread](2024-04-25 19:42:05,536) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:42:05,536) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:42:08,405) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:42:08,628) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991198
[3380957:MainThread](2024-04-25 19:42:08,628) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:42:08,629) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:42:11,447) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:42:11,669) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990891
[3380957:MainThread](2024-04-25 19:42:11,670) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:42:11,670) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:42:14,499) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:42:14,720) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990512
[3380957:MainThread](2024-04-25 19:42:14,720) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:42:14,721) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:42:17,596) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:42:17,823) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990649
[3380957:MainThread](2024-04-25 19:42:17,823) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:42:17,824) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:42:20,693) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:42:20,915) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990186
[3380957:MainThread](2024-04-25 19:42:20,916) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:42:20,916) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:42:23,779) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:42:24,009) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991116
[3380957:MainThread](2024-04-25 19:42:24,010) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:42:24,010) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:42:26,837) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:42:27,064) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990242
[3380957:MainThread](2024-04-25 19:42:27,064) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:42:27,065) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:42:29,901) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:42:30,126) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991155
[3380957:MainThread](2024-04-25 19:42:30,127) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:42:30,127) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:42:32,930) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:42:33,153) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990101
[3380957:MainThread](2024-04-25 19:42:33,154) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:42:33,154) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:42:36,032) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:42:36,260) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991423
[3380957:MainThread](2024-04-25 19:42:36,260) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 19:42:36,260) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:42:39,116) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:42:39,340) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991481
[3380957:MainThread](2024-04-25 19:42:39,340) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 19:42:39,340) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:42:42,165) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:42:42,390) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990263
[3380957:MainThread](2024-04-25 19:42:42,390) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 19:42:42,390) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:42:45,247) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:42:45,473) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990691
[3380957:MainThread](2024-04-25 19:42:45,474) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 19:42:45,474) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:42:48,385) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:42:48,611) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991642
[3380957:MainThread](2024-04-25 19:42:48,612) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 19:42:48,612) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:42:51,490) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:42:51,715) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991545
[3380957:MainThread](2024-04-25 19:42:51,715) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[3380957:MainThread](2024-04-25 19:42:51,715) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:42:54,590) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:42:54,814) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991652
[3380957:MainThread](2024-04-25 19:42:54,815) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[3380957:MainThread](2024-04-25 19:42:54,815) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:42:57,658) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:42:57,882) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992285
[3380957:MainThread](2024-04-25 19:42:57,883) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:42:57,883) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990101 @ 20
[3380957:MainThread](2024-04-25 19:42:57,934) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-09-19 SH600000    0.025837
           SH600008    0.047876
           SH600009   -0.020246
           SH600010    0.017539
           SH600011    0.128083
[3380957:MainThread](2024-04-25 19:42:59,649) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  50%|█████     | 22/44 [28:27<32:58, 89.94s/it][3380957:MainThread](2024-04-25 19:42:59,658) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:42:59,670) INFO - qlib.workflow - [recorder.py:341] - Recorder 638da4b5af804b249b9ceb968f8dc018 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:43:00,516) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:43:00,517) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:43:00,520) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:43:00,521) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:43:08,372) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.958080
            SH600004      0.958080
            SH600006      0.958080
            SH600007      0.958080
            SH600008      0.958080
                            ...   
2016-12-08  SZ300144      1.834576
            SZ300146      1.834576
            SZ300168      1.834576
            SZ300251      1.834576
            SZ300315      1.834576
Length: 601711, dtype: float64
[3380957:MainThread](2024-04-25 19:43:08,375) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:43:08,375) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:43:08,375) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:43:11,712) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:43:11,937) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995290
[3380957:MainThread](2024-04-25 19:43:11,938) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:43:11,939) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:43:14,903) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:43:15,131) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995597
[3380957:MainThread](2024-04-25 19:43:15,132) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:43:15,132) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:43:18,043) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:43:18,270) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993079
[3380957:MainThread](2024-04-25 19:43:18,271) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:43:18,271) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:43:21,171) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:43:21,396) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993355
[3380957:MainThread](2024-04-25 19:43:21,396) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:43:21,396) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:43:24,273) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:43:24,498) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992730
[3380957:MainThread](2024-04-25 19:43:24,499) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:43:24,499) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:43:27,378) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:43:27,603) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992238
[3380957:MainThread](2024-04-25 19:43:27,604) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:43:27,605) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:43:30,489) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:43:30,714) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992315
[3380957:MainThread](2024-04-25 19:43:30,714) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:43:30,715) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:43:33,594) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:43:33,819) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992009
[3380957:MainThread](2024-04-25 19:43:33,820) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:43:33,820) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:43:36,797) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:43:37,045) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991512
[3380957:MainThread](2024-04-25 19:43:37,046) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:43:37,047) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:43:39,969) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:43:40,202) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991521
[3380957:MainThread](2024-04-25 19:43:40,202) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:43:40,203) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:43:43,097) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:43:43,323) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992578
[3380957:MainThread](2024-04-25 19:43:43,323) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:43:43,324) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:43:46,213) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:43:46,438) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990770
[3380957:MainThread](2024-04-25 19:43:46,439) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:43:46,439) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:43:49,376) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:43:49,602) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992242
[3380957:MainThread](2024-04-25 19:43:49,602) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:43:49,603) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:43:52,525) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:43:52,753) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991290
[3380957:MainThread](2024-04-25 19:43:52,753) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:43:52,754) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:43:55,678) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:43:55,903) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992195
[3380957:MainThread](2024-04-25 19:43:55,903) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:43:55,904) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:43:58,850) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:43:59,076) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991026
[3380957:MainThread](2024-04-25 19:43:59,076) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:43:59,076) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:44:02,011) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:44:02,236) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990526
[3380957:MainThread](2024-04-25 19:44:02,237) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:44:02,237) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:44:05,186) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:44:05,412) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990739
[3380957:MainThread](2024-04-25 19:44:05,412) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:44:05,413) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:44:08,360) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:44:08,589) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990565
[3380957:MainThread](2024-04-25 19:44:08,589) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:44:08,589) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:44:11,496) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:44:11,725) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991287
[3380957:MainThread](2024-04-25 19:44:11,726) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:44:11,726) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:44:14,668) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:44:14,897) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991345
[3380957:MainThread](2024-04-25 19:44:14,898) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:44:14,898) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:44:17,812) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:44:18,040) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991817
[3380957:MainThread](2024-04-25 19:44:18,040) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 19:44:18,041) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:44:21,033) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:44:21,267) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993330
[3380957:MainThread](2024-04-25 19:44:21,267) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 19:44:21,268) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:44:24,283) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:44:24,508) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992111
[3380957:MainThread](2024-04-25 19:44:24,509) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 19:44:24,509) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:44:27,456) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:44:27,681) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990977
[3380957:MainThread](2024-04-25 19:44:27,681) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:44:27,682) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990526 @ 16
[3380957:MainThread](2024-04-25 19:44:27,914) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-10-25 SH600000   -0.114247
           SH600008    0.095330
           SH600009   -0.273615
           SH600010    0.002261
           SH600011   -0.023098
[3380957:MainThread](2024-04-25 19:44:29,621) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  52%|█████▏    | 23/44 [29:57<31:29, 89.95s/it][3380957:MainThread](2024-04-25 19:44:29,630) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:44:29,658) INFO - qlib.workflow - [recorder.py:341] - Recorder 312afe6b849d41099b9df3141540ead4 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:44:30,456) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:44:30,457) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:44:30,460) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:44:30,460) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:44:38,607) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.762901
            SH600004      1.762901
            SH600006      1.762901
            SH600007      1.762901
            SH600008      1.762901
                            ...   
2017-01-06  SZ300146      1.663911
            SZ300168      1.663911
            SZ300182      1.663911
            SZ300251      1.663911
            SZ300315      1.663911
Length: 607469, dtype: float64
[3380957:MainThread](2024-04-25 19:44:38,610) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:44:38,610) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:44:38,610) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:44:41,588) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:44:41,813) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995491
[3380957:MainThread](2024-04-25 19:44:41,815) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:44:41,815) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:44:44,787) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:44:45,015) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994749
[3380957:MainThread](2024-04-25 19:44:45,016) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:44:45,016) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:44:47,903) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:44:48,127) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993698
[3380957:MainThread](2024-04-25 19:44:48,128) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:44:48,129) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:44:50,938) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:44:51,162) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992981
[3380957:MainThread](2024-04-25 19:44:51,163) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:44:51,164) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:44:54,060) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:44:54,284) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992278
[3380957:MainThread](2024-04-25 19:44:54,286) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:44:54,286) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:44:57,168) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:44:57,393) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992229
[3380957:MainThread](2024-04-25 19:44:57,394) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:44:57,395) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:45:00,281) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:45:00,506) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992798
[3380957:MainThread](2024-04-25 19:45:00,506) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:45:00,506) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:45:03,394) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:45:03,618) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991661
[3380957:MainThread](2024-04-25 19:45:03,619) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:45:03,619) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:45:06,537) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:45:06,764) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992315
[3380957:MainThread](2024-04-25 19:45:06,765) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:45:06,765) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:45:09,662) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:45:09,887) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991564
[3380957:MainThread](2024-04-25 19:45:09,888) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:45:09,889) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:45:12,798) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:45:13,024) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991467
[3380957:MainThread](2024-04-25 19:45:13,025) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:45:13,025) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:45:15,958) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:45:16,185) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990398
[3380957:MainThread](2024-04-25 19:45:16,186) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:45:16,186) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:45:19,103) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:45:19,331) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992038
[3380957:MainThread](2024-04-25 19:45:19,332) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:45:19,332) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:45:22,282) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:45:22,509) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991772
[3380957:MainThread](2024-04-25 19:45:22,510) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:45:22,510) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:45:25,424) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:45:25,652) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991767
[3380957:MainThread](2024-04-25 19:45:25,652) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:45:25,653) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:45:28,626) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:45:28,852) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990875
[3380957:MainThread](2024-04-25 19:45:28,852) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:45:28,853) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:45:31,808) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:45:32,037) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990172
[3380957:MainThread](2024-04-25 19:45:32,038) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:45:32,038) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:45:34,963) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:45:35,193) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991479
[3380957:MainThread](2024-04-25 19:45:35,193) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:45:35,193) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:45:38,065) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:45:38,295) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991405
[3380957:MainThread](2024-04-25 19:45:38,295) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:45:38,295) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:45:41,199) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:45:41,426) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991198
[3380957:MainThread](2024-04-25 19:45:41,427) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:45:41,427) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:45:44,324) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:45:44,550) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991365
[3380957:MainThread](2024-04-25 19:45:44,550) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:45:44,550) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:45:47,457) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:45:47,684) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990627
[3380957:MainThread](2024-04-25 19:45:47,684) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 19:45:47,685) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:45:50,561) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:45:50,788) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992116
[3380957:MainThread](2024-04-25 19:45:50,788) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 19:45:50,788) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:45:53,658) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:45:53,886) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992129
[3380957:MainThread](2024-04-25 19:45:53,886) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 19:45:53,887) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:45:56,873) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:45:57,100) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992242
[3380957:MainThread](2024-04-25 19:45:57,100) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:45:57,100) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990172 @ 16
[3380957:MainThread](2024-04-25 19:45:57,419) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-11-22 SH600000    0.004560
           SH600008   -0.071406
           SH600009   -0.109414
           SH600010    0.045171
           SH600011    0.156392
[3380957:MainThread](2024-04-25 19:45:59,155) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  55%|█████▍    | 24/44 [31:26<29:56, 89.83s/it][3380957:MainThread](2024-04-25 19:45:59,164) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:45:59,176) INFO - qlib.workflow - [recorder.py:341] - Recorder 8d96ce290f0449568d2f638a613d3170 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:46:00,127) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:46:00,127) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:46:00,131) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:46:00,131) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:46:08,265) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.522822
            SH600004      1.522822
            SH600006      1.522822
            SH600007      1.522822
            SH600008      1.522822
                            ...   
2017-02-10  SZ300144      1.763287
            SZ300146      1.763287
            SZ300168      1.763287
            SZ300182      1.763287
            SZ300251      1.763287
Length: 613211, dtype: float64
[3380957:MainThread](2024-04-25 19:46:08,267) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:46:08,267) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:46:08,268) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:46:11,357) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:46:11,585) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995345
[3380957:MainThread](2024-04-25 19:46:11,587) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:46:11,587) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:46:14,528) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:46:14,758) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994238
[3380957:MainThread](2024-04-25 19:46:14,759) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:46:14,760) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:46:17,713) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:46:17,945) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994337
[3380957:MainThread](2024-04-25 19:46:17,946) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:46:17,946) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:46:20,905) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:46:21,133) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992723
[3380957:MainThread](2024-04-25 19:46:21,135) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:46:21,135) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:46:24,118) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:46:24,347) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993574
[3380957:MainThread](2024-04-25 19:46:24,347) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:46:24,348) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:46:27,355) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:46:27,584) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992131
[3380957:MainThread](2024-04-25 19:46:27,585) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:46:27,585) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:46:30,596) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:46:30,828) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991548
[3380957:MainThread](2024-04-25 19:46:30,829) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:46:30,829) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:46:33,822) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:46:34,051) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991766
[3380957:MainThread](2024-04-25 19:46:34,052) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:46:34,052) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:46:37,062) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:46:37,290) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991414
[3380957:MainThread](2024-04-25 19:46:37,291) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:46:37,291) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:46:40,324) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:46:40,553) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991534
[3380957:MainThread](2024-04-25 19:46:40,553) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:46:40,554) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:46:43,522) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:46:43,751) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990952
[3380957:MainThread](2024-04-25 19:46:43,752) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:46:43,752) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:46:46,705) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:46:46,935) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990737
[3380957:MainThread](2024-04-25 19:46:46,936) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:46:46,936) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:46:49,879) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:46:50,110) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991439
[3380957:MainThread](2024-04-25 19:46:50,110) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:46:50,111) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:46:53,048) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:46:53,281) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991679
[3380957:MainThread](2024-04-25 19:46:53,281) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:46:53,282) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:46:56,242) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:46:56,470) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990585
[3380957:MainThread](2024-04-25 19:46:56,471) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:46:56,471) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:46:59,420) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:46:59,649) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990822
[3380957:MainThread](2024-04-25 19:46:59,650) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:46:59,650) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:47:02,601) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:47:02,831) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991387
[3380957:MainThread](2024-04-25 19:47:02,832) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:47:02,832) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:47:05,776) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:47:06,005) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991280
[3380957:MainThread](2024-04-25 19:47:06,006) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:47:06,006) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:47:08,984) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:47:09,213) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992875
[3380957:MainThread](2024-04-25 19:47:09,214) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:47:09,214) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:47:12,147) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:47:12,377) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991863
[3380957:MainThread](2024-04-25 19:47:12,378) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:47:12,378) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:47:15,335) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:47:15,564) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991653
[3380957:MainThread](2024-04-25 19:47:15,564) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:47:15,565) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:47:18,546) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:47:18,779) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993503
[3380957:MainThread](2024-04-25 19:47:18,779) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 19:47:18,780) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:47:21,794) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:47:22,025) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993701
[3380957:MainThread](2024-04-25 19:47:22,025) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:47:22,026) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990585 @ 14
[3380957:MainThread](2024-04-25 19:47:22,077) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-12-20 SH600000    0.066920
           SH600004   -0.003714
           SH600009    0.020452
           SH600010   -0.039887
           SH600011   -0.011001
[3380957:MainThread](2024-04-25 19:47:23,802) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  57%|█████▋    | 25/44 [32:51<27:57, 88.27s/it][3380957:MainThread](2024-04-25 19:47:23,812) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:47:23,824) INFO - qlib.workflow - [recorder.py:341] - Recorder 708d65b1fffc4242940c575e037a034c starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:47:24,624) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:47:24,625) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:47:24,628) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:47:24,628) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:47:32,342) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.523391
            SH600004      1.523391
            SH600006      1.523391
            SH600007      1.523391
            SH600008      1.523391
                            ...   
2017-03-10  SZ300144      1.973417
            SZ300146      1.973417
            SZ300168      1.973417
            SZ300182      1.973417
            SZ300251      1.973417
Length: 618892, dtype: float64
[3380957:MainThread](2024-04-25 19:47:32,344) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:47:32,344) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:47:32,344) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:47:35,284) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:47:35,515) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996090
[3380957:MainThread](2024-04-25 19:47:35,516) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:47:35,517) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:47:38,411) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:47:38,643) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994675
[3380957:MainThread](2024-04-25 19:47:38,645) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:47:38,645) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:47:41,585) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:47:41,815) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993582
[3380957:MainThread](2024-04-25 19:47:41,816) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:47:41,817) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:47:44,742) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:47:44,973) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993977
[3380957:MainThread](2024-04-25 19:47:44,973) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:47:44,974) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:47:47,936) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:47:48,166) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993472
[3380957:MainThread](2024-04-25 19:47:48,167) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:47:48,167) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:47:51,122) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:47:51,352) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992677
[3380957:MainThread](2024-04-25 19:47:51,353) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:47:51,354) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:47:54,349) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:47:54,580) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993492
[3380957:MainThread](2024-04-25 19:47:54,580) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:47:54,580) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:47:57,531) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:47:57,763) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992062
[3380957:MainThread](2024-04-25 19:47:57,764) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:47:57,764) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:48:00,724) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:48:00,954) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992799
[3380957:MainThread](2024-04-25 19:48:00,955) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:48:00,955) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:48:03,908) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:48:04,139) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991564
[3380957:MainThread](2024-04-25 19:48:04,140) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:48:04,140) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:48:07,098) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:48:07,334) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993091
[3380957:MainThread](2024-04-25 19:48:07,334) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:48:07,335) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:48:10,353) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:48:10,584) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991908
[3380957:MainThread](2024-04-25 19:48:10,584) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:48:10,585) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:48:13,549) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:48:13,780) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992045
[3380957:MainThread](2024-04-25 19:48:13,781) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:48:13,781) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:48:16,825) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:48:17,055) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992605
[3380957:MainThread](2024-04-25 19:48:17,056) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:48:17,056) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:48:20,082) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:48:20,314) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992312
[3380957:MainThread](2024-04-25 19:48:20,315) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:48:20,315) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:48:23,365) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:48:23,597) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993954
[3380957:MainThread](2024-04-25 19:48:23,598) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:48:23,598) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:48:26,730) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:48:26,971) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993877
[3380957:MainThread](2024-04-25 19:48:26,972) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:48:26,973) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:48:30,160) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:48:30,391) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992810
[3380957:MainThread](2024-04-25 19:48:30,391) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:48:30,392) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991564 @ 9
[3380957:MainThread](2024-04-25 19:48:30,443) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-01-21 SH600000    0.017805
           SH600004    0.206393
           SH600009    0.083040
           SH600010    0.032158
           SH600011   -0.045429
[3380957:MainThread](2024-04-25 19:48:32,197) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  59%|█████▉    | 26/44 [33:59<24:41, 82.31s/it][3380957:MainThread](2024-04-25 19:48:32,206) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:48:32,220) INFO - qlib.workflow - [recorder.py:341] - Recorder f8b41c077ea14afb80124741f6ab325e starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:48:33,001) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:48:33,001) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:48:33,004) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:48:33,004) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:48:41,922) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.978415
            SH600004      0.978415
            SH600006      0.978415
            SH600007      0.978415
            SH600008      0.978415
                            ...   
2017-04-11  SZ300144      1.743304
            SZ300146      1.743304
            SZ300168      1.743304
            SZ300182      1.743304
            SZ300251      1.743304
Length: 624606, dtype: float64
[3380957:MainThread](2024-04-25 19:48:41,924) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:48:41,925) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:48:41,925) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:48:45,186) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:48:45,380) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995562
[3380957:MainThread](2024-04-25 19:48:45,381) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:48:45,382) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:48:48,436) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:48:48,633) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994651
[3380957:MainThread](2024-04-25 19:48:48,635) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:48:48,635) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:48:51,725) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:48:51,925) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994140
[3380957:MainThread](2024-04-25 19:48:51,926) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:48:51,926) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:48:54,993) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:48:55,187) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993699
[3380957:MainThread](2024-04-25 19:48:55,188) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:48:55,189) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:48:58,261) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:48:58,458) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992906
[3380957:MainThread](2024-04-25 19:48:58,459) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:48:58,459) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:49:01,524) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:49:01,720) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993662
[3380957:MainThread](2024-04-25 19:49:01,720) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:49:01,721) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:49:04,789) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:49:04,987) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993100
[3380957:MainThread](2024-04-25 19:49:04,987) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:49:04,987) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:49:08,048) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:49:08,244) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992618
[3380957:MainThread](2024-04-25 19:49:08,245) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:49:08,246) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:49:11,236) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:49:11,434) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992429
[3380957:MainThread](2024-04-25 19:49:11,435) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:49:11,435) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:49:14,429) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:49:14,625) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992665
[3380957:MainThread](2024-04-25 19:49:14,626) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:49:14,626) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:49:17,607) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:49:17,803) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992225
[3380957:MainThread](2024-04-25 19:49:17,804) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:49:17,804) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:49:20,803) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:49:21,001) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991790
[3380957:MainThread](2024-04-25 19:49:21,002) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:49:21,002) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:49:23,990) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:49:24,191) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991336
[3380957:MainThread](2024-04-25 19:49:24,192) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:49:24,192) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:49:27,164) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:49:27,361) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992973
[3380957:MainThread](2024-04-25 19:49:27,361) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:49:27,361) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:49:30,365) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:49:30,563) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993727
[3380957:MainThread](2024-04-25 19:49:30,564) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:49:30,564) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:49:33,568) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:49:33,767) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992775
[3380957:MainThread](2024-04-25 19:49:33,767) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:49:33,767) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:49:36,789) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:49:36,987) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992745
[3380957:MainThread](2024-04-25 19:49:36,987) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:49:36,987) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:49:39,959) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:49:40,156) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992109
[3380957:MainThread](2024-04-25 19:49:40,156) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:49:40,156) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:49:43,203) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:49:43,399) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992861
[3380957:MainThread](2024-04-25 19:49:43,400) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:49:43,400) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:49:46,376) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:49:46,574) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993231
[3380957:MainThread](2024-04-25 19:49:46,575) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:49:46,575) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:49:49,549) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:49:49,748) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992243
[3380957:MainThread](2024-04-25 19:49:49,749) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:49:49,749) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991336 @ 12
[3380957:MainThread](2024-04-25 19:49:49,801) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-02-25 SH600000    0.105912
           SH600004    0.020729
           SH600009   -0.287841
           SH600010    0.084420
           SH600011    0.012574
[3380957:MainThread](2024-04-25 19:49:51,548) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  61%|██████▏   | 27/44 [35:19<23:04, 81.42s/it][3380957:MainThread](2024-04-25 19:49:51,557) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:49:51,569) INFO - qlib.workflow - [recorder.py:341] - Recorder e6ccccdc8934477abc5b51e6c074adf6 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:49:52,376) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:49:52,377) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:49:52,380) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:49:52,380) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:50:00,098) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.926853
            SH600004      0.926853
            SH600006      0.926853
            SH600007      0.926853
            SH600008      0.926853
                            ...   
2017-05-10  SZ300133      1.392711
            SZ300144      1.392711
            SZ300146      1.392711
            SZ300182      1.392711
            SZ300251      1.392711
Length: 630244, dtype: float64
[3380957:MainThread](2024-04-25 19:50:00,100) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:50:00,100) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:50:00,101) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:50:03,222) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:50:03,432) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995376
[3380957:MainThread](2024-04-25 19:50:03,433) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:50:03,433) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:50:06,562) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:50:06,774) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995623
[3380957:MainThread](2024-04-25 19:50:06,775) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:50:06,775) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:50:09,897) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:50:10,107) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993783
[3380957:MainThread](2024-04-25 19:50:10,108) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:50:10,108) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:50:13,133) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:50:13,343) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993848
[3380957:MainThread](2024-04-25 19:50:13,343) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:50:13,343) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:50:16,413) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:50:16,625) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993736
[3380957:MainThread](2024-04-25 19:50:16,626) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:50:16,626) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:50:19,735) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:50:19,949) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992396
[3380957:MainThread](2024-04-25 19:50:19,950) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:50:19,950) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:50:23,018) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:50:23,228) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993710
[3380957:MainThread](2024-04-25 19:50:23,229) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:50:23,229) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:50:26,262) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:50:26,472) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994421
[3380957:MainThread](2024-04-25 19:50:26,472) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:50:26,473) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:50:29,538) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:50:29,753) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991763
[3380957:MainThread](2024-04-25 19:50:29,754) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:50:29,754) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:50:32,824) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:50:33,036) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992006
[3380957:MainThread](2024-04-25 19:50:33,037) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:50:33,037) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:50:36,105) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:50:36,317) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992201
[3380957:MainThread](2024-04-25 19:50:36,317) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:50:36,318) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:50:39,382) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:50:39,593) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993296
[3380957:MainThread](2024-04-25 19:50:39,593) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:50:39,593) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:50:42,644) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:50:42,854) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992115
[3380957:MainThread](2024-04-25 19:50:42,854) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:50:42,854) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:50:45,995) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:50:46,206) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992354
[3380957:MainThread](2024-04-25 19:50:46,207) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:50:46,207) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:50:49,306) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:50:49,520) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992809
[3380957:MainThread](2024-04-25 19:50:49,520) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:50:49,520) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:50:52,513) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:50:52,725) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991476
[3380957:MainThread](2024-04-25 19:50:52,726) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:50:52,726) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:50:55,767) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:50:55,978) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992081
[3380957:MainThread](2024-04-25 19:50:55,978) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:50:55,978) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:50:58,993) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:50:59,204) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992719
[3380957:MainThread](2024-04-25 19:50:59,204) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:50:59,204) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:51:02,231) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:51:02,442) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992630
[3380957:MainThread](2024-04-25 19:51:02,442) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:51:02,442) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:51:05,478) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:51:05,688) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991664
[3380957:MainThread](2024-04-25 19:51:05,689) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:51:05,689) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:51:08,652) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:51:08,863) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992333
[3380957:MainThread](2024-04-25 19:51:08,864) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:51:08,864) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:51:11,966) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:51:12,174) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994472
[3380957:MainThread](2024-04-25 19:51:12,174) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 19:51:12,174) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:51:15,209) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:51:15,419) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993425
[3380957:MainThread](2024-04-25 19:51:15,420) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 19:51:15,420) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:51:18,404) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:51:18,614) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993387
[3380957:MainThread](2024-04-25 19:51:18,615) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:51:18,615) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991476 @ 15
[3380957:MainThread](2024-04-25 19:51:19,007) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-03-25 SH600000    0.018362
           SH600004    0.090692
           SH600009    0.005387
           SH600010    0.009818
           SH600011   -0.170695
[3380957:MainThread](2024-04-25 19:51:20,721) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  64%|██████▎   | 28/44 [36:48<22:19, 83.75s/it][3380957:MainThread](2024-04-25 19:51:20,731) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:51:20,742) INFO - qlib.workflow - [recorder.py:341] - Recorder cf1130fd09114c52894bb549ddb80423 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:51:21,565) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:51:21,566) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:51:21,570) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:51:21,571) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:51:29,471) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.856280
            SH600004      1.856280
            SH600006      1.856280
            SH600007      1.856280
            SH600008      1.856280
                            ...   
2017-06-09  SZ300133      1.798303
            SZ300144      1.798303
            SZ300146      1.798303
            SZ300182      1.798303
            SZ300251      1.798303
Length: 635820, dtype: float64
[3380957:MainThread](2024-04-25 19:51:29,474) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:51:29,474) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:51:29,474) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:51:32,634) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:51:32,854) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995673
[3380957:MainThread](2024-04-25 19:51:32,856) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:51:32,856) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:51:35,984) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:51:36,184) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995092
[3380957:MainThread](2024-04-25 19:51:36,185) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:51:36,185) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:51:39,322) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:51:39,520) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994137
[3380957:MainThread](2024-04-25 19:51:39,521) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:51:39,522) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:51:42,580) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:51:42,779) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993587
[3380957:MainThread](2024-04-25 19:51:42,780) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:51:42,780) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:51:45,829) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:51:46,028) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992984
[3380957:MainThread](2024-04-25 19:51:46,029) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:51:46,029) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:51:49,162) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:51:49,363) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993284
[3380957:MainThread](2024-04-25 19:51:49,364) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:51:49,364) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:51:52,511) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:51:52,711) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992444
[3380957:MainThread](2024-04-25 19:51:52,712) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:51:52,713) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:51:55,778) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:51:55,977) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993243
[3380957:MainThread](2024-04-25 19:51:55,977) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:51:55,977) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:51:59,040) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:51:59,240) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992611
[3380957:MainThread](2024-04-25 19:51:59,240) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:51:59,240) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:52:02,324) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:52:02,524) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992707
[3380957:MainThread](2024-04-25 19:52:02,524) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:52:02,524) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:52:05,583) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:52:05,781) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992130
[3380957:MainThread](2024-04-25 19:52:05,783) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:52:05,783) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:52:08,852) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:52:09,052) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991918
[3380957:MainThread](2024-04-25 19:52:09,053) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:52:09,054) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:52:12,206) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:52:12,407) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994459
[3380957:MainThread](2024-04-25 19:52:12,407) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:52:12,407) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:52:15,450) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:52:15,650) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991574
[3380957:MainThread](2024-04-25 19:52:15,651) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:52:15,651) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:52:18,710) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:52:18,917) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992262
[3380957:MainThread](2024-04-25 19:52:18,917) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:52:18,917) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:52:21,996) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:52:22,196) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991774
[3380957:MainThread](2024-04-25 19:52:22,197) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:52:22,197) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:52:25,290) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:52:25,491) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992896
[3380957:MainThread](2024-04-25 19:52:25,491) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:52:25,492) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:52:28,625) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:52:28,824) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992429
[3380957:MainThread](2024-04-25 19:52:28,825) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:52:28,825) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:52:32,056) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:52:32,261) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992768
[3380957:MainThread](2024-04-25 19:52:32,262) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:52:32,262) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:52:35,537) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:52:35,738) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992370
[3380957:MainThread](2024-04-25 19:52:35,738) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:52:35,739) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:52:38,912) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:52:39,112) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993902
[3380957:MainThread](2024-04-25 19:52:39,112) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 19:52:39,113) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:52:42,307) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:52:42,509) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993742
[3380957:MainThread](2024-04-25 19:52:42,510) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:52:42,510) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991574 @ 13
[3380957:MainThread](2024-04-25 19:52:42,733) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-04-23 SH600000    0.031354
           SH600004    0.000892
           SH600009   -0.153007
           SH600010    0.003352
           SH600011   -0.023220
[3380957:MainThread](2024-04-25 19:52:44,468) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  66%|██████▌   | 29/44 [38:12<20:56, 83.75s/it][3380957:MainThread](2024-04-25 19:52:44,478) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:52:44,490) INFO - qlib.workflow - [recorder.py:341] - Recorder 2880400bcf8c41e191b2844facde5572 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:52:45,406) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:52:45,407) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:52:45,411) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:52:45,412) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:52:53,903) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.447776
            SH600004      1.447776
            SH600006      1.447776
            SH600007      1.447776
            SH600008      1.447776
                            ...   
2017-07-07  SZ300133      1.382269
            SZ300144      1.382269
            SZ300168      1.382269
            SZ300251      1.382269
            SZ300315      1.382269
Length: 641204, dtype: float64
[3380957:MainThread](2024-04-25 19:52:53,905) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:52:53,905) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:52:53,906) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:52:57,138) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:52:57,351) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996087
[3380957:MainThread](2024-04-25 19:52:57,352) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:52:57,352) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:53:00,566) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:53:00,779) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995050
[3380957:MainThread](2024-04-25 19:53:00,780) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:53:00,780) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:53:03,950) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:53:04,163) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994524
[3380957:MainThread](2024-04-25 19:53:04,164) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:53:04,164) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:53:07,342) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:53:07,554) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993867
[3380957:MainThread](2024-04-25 19:53:07,555) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:53:07,556) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:53:10,725) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:53:10,936) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993564
[3380957:MainThread](2024-04-25 19:53:10,937) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:53:10,937) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:53:14,027) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:53:14,237) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992976
[3380957:MainThread](2024-04-25 19:53:14,238) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:53:14,238) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:53:17,327) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:53:17,540) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992302
[3380957:MainThread](2024-04-25 19:53:17,541) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:53:17,542) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:53:20,641) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:53:20,853) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992838
[3380957:MainThread](2024-04-25 19:53:20,853) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:53:20,853) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:53:23,886) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:53:24,104) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993749
[3380957:MainThread](2024-04-25 19:53:24,105) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:53:24,105) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:53:27,293) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:53:27,503) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992742
[3380957:MainThread](2024-04-25 19:53:27,504) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:53:27,504) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:53:30,578) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:53:30,790) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992485
[3380957:MainThread](2024-04-25 19:53:30,791) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:53:30,791) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:53:33,856) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:53:34,068) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992749
[3380957:MainThread](2024-04-25 19:53:34,069) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:53:34,069) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:53:37,175) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:53:37,390) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992519
[3380957:MainThread](2024-04-25 19:53:37,390) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:53:37,390) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:53:40,603) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:53:40,818) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993016
[3380957:MainThread](2024-04-25 19:53:40,818) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:53:40,818) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:53:43,933) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:53:44,146) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993758
[3380957:MainThread](2024-04-25 19:53:44,146) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:53:44,147) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992302 @ 6
[3380957:MainThread](2024-04-25 19:53:44,198) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-05-24 SH600000   -0.037057
           SH600004   -0.056520
           SH600009    0.016520
           SH600010   -0.053161
           SH600011   -0.059773
[3380957:MainThread](2024-04-25 19:53:45,942) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  68%|██████▊   | 30/44 [39:13<17:58, 77.06s/it][3380957:MainThread](2024-04-25 19:53:45,951) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:53:45,963) INFO - qlib.workflow - [recorder.py:341] - Recorder 502e46703a5341ffb2c553f540b2f0d2 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:53:46,757) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:53:46,757) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:53:46,760) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:53:46,761) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:53:54,590) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.774841
            SH600004      0.774841
            SH600006      0.774841
            SH600007      0.774841
            SH600008      0.774841
                            ...   
2017-08-04  SZ300133      1.042581
            SZ300144      1.042581
            SZ300168      1.042581
            SZ300251      1.042581
            SZ300315      1.042581
Length: 646851, dtype: float64
[3380957:MainThread](2024-04-25 19:53:54,592) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:53:54,593) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:53:54,593) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:53:57,821) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:53:58,060) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995851
[3380957:MainThread](2024-04-25 19:53:58,062) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:53:58,062) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:54:01,201) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:54:01,439) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994690
[3380957:MainThread](2024-04-25 19:54:01,440) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:54:01,441) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:54:04,512) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:54:04,751) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993319
[3380957:MainThread](2024-04-25 19:54:04,752) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:54:04,752) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:54:07,927) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:54:08,163) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992851
[3380957:MainThread](2024-04-25 19:54:08,164) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:54:08,164) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:54:11,356) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:54:11,609) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994316
[3380957:MainThread](2024-04-25 19:54:11,610) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:54:11,610) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:54:14,729) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:54:14,966) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993010
[3380957:MainThread](2024-04-25 19:54:14,967) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:54:14,967) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:54:18,084) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:54:18,323) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992585
[3380957:MainThread](2024-04-25 19:54:18,324) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:54:18,324) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:54:21,442) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:54:21,678) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993351
[3380957:MainThread](2024-04-25 19:54:21,679) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:54:21,679) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:54:24,765) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:54:25,002) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992611
[3380957:MainThread](2024-04-25 19:54:25,002) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:54:25,002) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:54:28,110) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:54:28,345) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994249
[3380957:MainThread](2024-04-25 19:54:28,346) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:54:28,346) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:54:31,470) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:54:31,708) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993766
[3380957:MainThread](2024-04-25 19:54:31,708) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:54:31,709) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:54:34,835) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:54:35,072) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993122
[3380957:MainThread](2024-04-25 19:54:35,073) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:54:35,073) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:54:38,206) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:54:38,444) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995159
[3380957:MainThread](2024-04-25 19:54:38,444) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:54:38,444) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:54:41,600) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:54:41,839) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992913
[3380957:MainThread](2024-04-25 19:54:41,840) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:54:41,840) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:54:44,936) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:54:45,176) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992842
[3380957:MainThread](2024-04-25 19:54:45,177) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:54:45,177) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992585 @ 6
[3380957:MainThread](2024-04-25 19:54:45,494) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-06-24 SH600000    0.015964
           SH600004   -0.207432
           SH600009   -0.157440
           SH600010    0.000243
           SH600011    0.057834
[3380957:MainThread](2024-04-25 19:54:46,860) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  70%|███████   | 31/44 [40:14<15:38, 72.22s/it][3380957:MainThread](2024-04-25 19:54:46,869) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:54:46,881) INFO - qlib.workflow - [recorder.py:341] - Recorder 1c72eab0fa5c4467917ca6deecb8ac7f starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:54:47,854) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:54:47,855) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:54:47,859) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:54:47,859) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:54:55,951) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.704263
            SH600004      0.704263
            SH600006      0.704263
            SH600007      0.704263
            SH600008      0.704263
                            ...   
2017-09-01  SZ300133      1.500843
            SZ300144      1.500843
            SZ300168      1.500843
            SZ300251      1.500843
            SZ300315      1.500843
Length: 652446, dtype: float64
[3380957:MainThread](2024-04-25 19:54:55,954) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:54:55,954) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:54:55,954) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:54:59,168) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:54:59,380) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995811
[3380957:MainThread](2024-04-25 19:54:59,381) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:54:59,381) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:55:02,575) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:55:02,788) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995071
[3380957:MainThread](2024-04-25 19:55:02,789) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:55:02,790) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:55:05,917) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:55:06,128) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994321
[3380957:MainThread](2024-04-25 19:55:06,129) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:55:06,129) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:55:09,210) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:55:09,418) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994236
[3380957:MainThread](2024-04-25 19:55:09,419) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:55:09,420) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:55:12,529) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:55:12,736) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993911
[3380957:MainThread](2024-04-25 19:55:12,737) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:55:12,738) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:55:15,864) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:55:16,074) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992779
[3380957:MainThread](2024-04-25 19:55:16,075) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:55:16,076) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:55:19,215) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:55:19,429) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992838
[3380957:MainThread](2024-04-25 19:55:19,429) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:55:19,429) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:55:22,535) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:55:22,743) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992806
[3380957:MainThread](2024-04-25 19:55:22,743) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:55:22,744) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:55:25,926) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:55:26,178) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992898
[3380957:MainThread](2024-04-25 19:55:26,179) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:55:26,180) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:55:29,342) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:55:29,553) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992531
[3380957:MainThread](2024-04-25 19:55:29,554) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:55:29,555) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:55:32,733) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:55:32,942) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992763
[3380957:MainThread](2024-04-25 19:55:32,943) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:55:32,943) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:55:36,096) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:55:36,311) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993468
[3380957:MainThread](2024-04-25 19:55:36,311) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:55:36,312) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:55:39,492) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:55:39,702) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992264
[3380957:MainThread](2024-04-25 19:55:39,703) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:55:39,704) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:55:42,824) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:55:43,032) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993243
[3380957:MainThread](2024-04-25 19:55:43,032) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:55:43,033) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:55:46,182) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:55:46,394) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993460
[3380957:MainThread](2024-04-25 19:55:46,394) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:55:46,395) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:55:49,553) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:55:49,763) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993103
[3380957:MainThread](2024-04-25 19:55:49,763) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:55:49,764) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:55:52,950) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:55:53,160) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993379
[3380957:MainThread](2024-04-25 19:55:53,161) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:55:53,161) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:55:56,306) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:55:56,515) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993932
[3380957:MainThread](2024-04-25 19:55:56,516) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:55:56,516) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:55:59,637) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:55:59,846) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995161
[3380957:MainThread](2024-04-25 19:55:59,846) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 19:55:59,847) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:56:02,930) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:56:03,139) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994235
[3380957:MainThread](2024-04-25 19:56:03,139) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 19:56:03,139) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:56:06,261) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:56:06,472) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993049
[3380957:MainThread](2024-04-25 19:56:06,472) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:56:06,472) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992264 @ 12
[3380957:MainThread](2024-04-25 19:56:06,523) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-07-22 SH600000   -0.002877
           SH600004    0.045624
           SH600009   -0.073671
           SH600010   -0.038904
           SH600011    0.006369
[3380957:MainThread](2024-04-25 19:56:08,239) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  73%|███████▎  | 32/44 [41:35<14:59, 74.97s/it][3380957:MainThread](2024-04-25 19:56:08,248) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:56:08,260) INFO - qlib.workflow - [recorder.py:341] - Recorder b09b66a13a4942e9a48604a1d5f9105a starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:56:09,132) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:56:09,133) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:56:09,136) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:56:09,136) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:56:17,021) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.333060
            SH600004      1.333060
            SH600006      1.333060
            SH600007      1.333060
            SH600008      1.333060
                            ...   
2017-09-29  SZ300133      1.674896
            SZ300144      1.674896
            SZ300168      1.674896
            SZ300251      1.674896
            SZ300315      1.674896
Length: 658139, dtype: float64
[3380957:MainThread](2024-04-25 19:56:17,023) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:56:17,023) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:56:17,024) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:56:20,181) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:56:20,419) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995703
[3380957:MainThread](2024-04-25 19:56:20,420) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:56:20,420) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:56:23,611) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:56:23,847) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994718
[3380957:MainThread](2024-04-25 19:56:23,848) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:56:23,848) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:56:27,010) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:56:27,248) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993822
[3380957:MainThread](2024-04-25 19:56:27,249) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:56:27,250) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:56:30,435) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:56:30,673) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994047
[3380957:MainThread](2024-04-25 19:56:30,673) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:56:30,674) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:56:33,865) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:56:34,103) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993284
[3380957:MainThread](2024-04-25 19:56:34,105) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:56:34,105) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:56:37,307) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:56:37,543) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995696
[3380957:MainThread](2024-04-25 19:56:37,543) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:56:37,544) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:56:40,767) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:56:41,005) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992600
[3380957:MainThread](2024-04-25 19:56:41,007) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:56:41,007) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:56:44,211) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:56:44,448) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992700
[3380957:MainThread](2024-04-25 19:56:44,448) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:56:44,448) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:56:47,636) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:56:47,876) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992842
[3380957:MainThread](2024-04-25 19:56:47,876) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:56:47,877) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:56:51,150) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:56:51,391) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993153
[3380957:MainThread](2024-04-25 19:56:51,391) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:56:51,391) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:56:54,643) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:56:54,878) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992284
[3380957:MainThread](2024-04-25 19:56:54,879) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:56:54,880) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:56:58,088) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:56:58,325) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993601
[3380957:MainThread](2024-04-25 19:56:58,325) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:56:58,326) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:57:01,516) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:57:01,756) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992584
[3380957:MainThread](2024-04-25 19:57:01,756) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:57:01,756) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:57:05,107) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:57:05,404) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993382
[3380957:MainThread](2024-04-25 19:57:05,404) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:57:05,405) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:57:08,757) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:57:08,993) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992418
[3380957:MainThread](2024-04-25 19:57:08,994) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:57:08,994) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:57:12,177) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:57:12,415) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992388
[3380957:MainThread](2024-04-25 19:57:12,416) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:57:12,416) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:57:15,537) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:57:15,773) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993845
[3380957:MainThread](2024-04-25 19:57:15,773) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 19:57:15,774) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:57:18,843) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:57:19,077) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995455
[3380957:MainThread](2024-04-25 19:57:19,078) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 19:57:19,078) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:57:22,133) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:57:22,368) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994281
[3380957:MainThread](2024-04-25 19:57:22,368) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:57:22,368) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992284 @ 10
[3380957:MainThread](2024-04-25 19:57:22,420) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-08-19 SH600000    0.017840
           SH600004   -0.039780
           SH600009    0.072456
           SH600010   -0.001440
           SH600011   -0.051278
[3380957:MainThread](2024-04-25 19:57:24,151) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  75%|███████▌  | 33/44 [42:51<13:47, 75.25s/it][3380957:MainThread](2024-04-25 19:57:24,160) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:57:24,172) INFO - qlib.workflow - [recorder.py:341] - Recorder eb28b6ed479542c98ede118ade85cbf9 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:57:24,950) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:57:24,950) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:57:24,952) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:57:24,953) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:57:32,989) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.161880
            SH600004      1.161880
            SH600006      1.161880
            SH600007      1.161880
            SH600008      1.161880
                            ...   
2017-11-03  SZ300133      1.710749
            SZ300144      1.710749
            SZ300168      1.710749
            SZ300251      1.710749
            SZ300315      1.710749
Length: 663832, dtype: float64
[3380957:MainThread](2024-04-25 19:57:32,992) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:57:32,992) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:57:32,992) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:57:36,254) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:57:36,492) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996191
[3380957:MainThread](2024-04-25 19:57:36,493) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:57:36,493) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:57:39,753) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:57:39,992) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994975
[3380957:MainThread](2024-04-25 19:57:39,993) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:57:39,993) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:57:43,189) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:57:43,432) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996097
[3380957:MainThread](2024-04-25 19:57:43,432) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:57:43,432) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:57:46,633) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:57:46,873) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994344
[3380957:MainThread](2024-04-25 19:57:46,874) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:57:46,874) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:57:50,136) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:57:50,373) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993805
[3380957:MainThread](2024-04-25 19:57:50,374) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:57:50,375) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:57:53,613) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:57:53,850) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994416
[3380957:MainThread](2024-04-25 19:57:53,851) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:57:53,851) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:57:57,011) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:57:57,250) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994002
[3380957:MainThread](2024-04-25 19:57:57,250) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:57:57,250) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:58:00,451) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:58:00,691) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994918
[3380957:MainThread](2024-04-25 19:58:00,691) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:58:00,692) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:58:03,916) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:58:04,156) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994174
[3380957:MainThread](2024-04-25 19:58:04,157) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:58:04,157) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:58:07,446) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:58:07,682) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994357
[3380957:MainThread](2024-04-25 19:58:07,682) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:58:07,683) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:58:10,864) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:58:11,101) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993998
[3380957:MainThread](2024-04-25 19:58:11,101) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:58:11,102) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:58:14,355) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:58:14,594) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996108
[3380957:MainThread](2024-04-25 19:58:14,594) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:58:14,594) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:58:17,846) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:58:18,084) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994542
[3380957:MainThread](2024-04-25 19:58:18,085) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:58:18,085) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993805 @ 4
[3380957:MainThread](2024-04-25 19:58:18,135) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-09-17 SH600000    0.073052
           SH600004    0.127198
           SH600009   -0.050289
           SH600010   -0.041574
           SH600011   -0.074834
[3380957:MainThread](2024-04-25 19:58:19,864) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  77%|███████▋  | 34/44 [43:47<11:33, 69.39s/it][3380957:MainThread](2024-04-25 19:58:19,873) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:58:19,885) INFO - qlib.workflow - [recorder.py:341] - Recorder 9800500608574995839ab266e26c82cd starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:58:20,689) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:58:20,689) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:58:20,694) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:58:20,694) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:58:28,582) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.650422
            SH600004      0.650422
            SH600006      0.650422
            SH600007      0.650422
            SH600008      0.650422
                            ...   
2017-12-01  SZ300133      1.076432
            SZ300144      1.076432
            SZ300168      1.076432
            SZ300251      1.076432
            SZ300315      1.076432
Length: 669550, dtype: float64
[3380957:MainThread](2024-04-25 19:58:28,584) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:58:28,585) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:58:28,585) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:58:32,007) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:58:32,243) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996900
[3380957:MainThread](2024-04-25 19:58:32,244) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:58:32,244) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:58:35,528) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:58:35,766) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995095
[3380957:MainThread](2024-04-25 19:58:35,767) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:58:35,768) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:58:39,016) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:58:39,254) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994390
[3380957:MainThread](2024-04-25 19:58:39,255) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:58:39,256) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:58:42,467) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:58:42,707) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993937
[3380957:MainThread](2024-04-25 19:58:42,709) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:58:42,709) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:58:45,975) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:58:46,212) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994894
[3380957:MainThread](2024-04-25 19:58:46,212) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:58:46,212) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:58:49,508) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:58:49,749) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994930
[3380957:MainThread](2024-04-25 19:58:49,750) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:58:49,750) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:58:53,055) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:58:53,292) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994403
[3380957:MainThread](2024-04-25 19:58:53,292) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 19:58:53,292) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:58:56,505) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:58:56,745) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995069
[3380957:MainThread](2024-04-25 19:58:56,745) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 19:58:56,746) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:58:59,973) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:59:00,213) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993178
[3380957:MainThread](2024-04-25 19:59:00,214) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 19:59:00,215) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:59:03,420) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:59:03,656) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995168
[3380957:MainThread](2024-04-25 19:59:03,656) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 19:59:03,656) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:59:06,892) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:59:07,130) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994213
[3380957:MainThread](2024-04-25 19:59:07,130) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 19:59:07,131) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:59:10,344) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:59:10,581) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993749
[3380957:MainThread](2024-04-25 19:59:10,582) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 19:59:10,582) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:59:13,847) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:59:14,083) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994140
[3380957:MainThread](2024-04-25 19:59:14,083) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 19:59:14,084) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:59:17,284) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:59:17,521) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995673
[3380957:MainThread](2024-04-25 19:59:17,521) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 19:59:17,521) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:59:20,769) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:59:21,006) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993833
[3380957:MainThread](2024-04-25 19:59:21,006) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 19:59:21,006) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:59:24,313) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:59:24,551) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994153
[3380957:MainThread](2024-04-25 19:59:24,552) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 19:59:24,552) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:59:27,863) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:59:28,101) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993649
[3380957:MainThread](2024-04-25 19:59:28,101) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 19:59:28,102) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993178 @ 8
[3380957:MainThread](2024-04-25 19:59:28,153) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-10-22 SH600000    0.101438
           SH600004    0.141972
           SH600009   -0.109803
           SH600010   -0.024801
           SH600011   -0.031311
[3380957:MainThread](2024-04-25 19:59:29,873) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  80%|███████▉  | 35/44 [44:57<10:26, 69.58s/it][3380957:MainThread](2024-04-25 19:59:29,882) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 19:59:29,894) INFO - qlib.workflow - [recorder.py:341] - Recorder e6e1045a7d19400fac44b74d4bff7aec starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 19:59:30,716) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 19:59:30,717) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 19:59:30,720) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 19:59:30,720) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 19:59:38,568) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.712987
            SH600004      0.712987
            SH600006      0.712987
            SH600007      0.712987
            SH600008      0.712987
                            ...   
2017-12-29  SZ300124      1.555788
            SZ300136      1.555788
            SZ300144      1.555788
            SZ300251      1.555788
            SZ300315      1.555788
Length: 675267, dtype: float64
[3380957:MainThread](2024-04-25 19:59:38,571) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 19:59:38,571) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 19:59:38,572) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:59:41,921) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:59:42,130) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996296
[3380957:MainThread](2024-04-25 19:59:42,131) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 19:59:42,132) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:59:45,474) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:59:45,685) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995572
[3380957:MainThread](2024-04-25 19:59:45,686) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 19:59:45,686) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:59:48,984) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:59:49,194) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995657
[3380957:MainThread](2024-04-25 19:59:49,194) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 19:59:49,195) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:59:52,439) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:59:52,648) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994355
[3380957:MainThread](2024-04-25 19:59:52,649) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 19:59:52,650) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:59:55,919) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:59:56,132) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994265
[3380957:MainThread](2024-04-25 19:59:56,133) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 19:59:56,133) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 19:59:59,448) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 19:59:59,658) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995640
[3380957:MainThread](2024-04-25 19:59:59,659) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 19:59:59,659) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:00:02,967) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:00:03,179) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994281
[3380957:MainThread](2024-04-25 20:00:03,180) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:00:03,180) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:00:06,460) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:00:06,669) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994964
[3380957:MainThread](2024-04-25 20:00:06,670) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:00:06,670) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:00:09,988) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:00:10,198) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995079
[3380957:MainThread](2024-04-25 20:00:10,199) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:00:10,199) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:00:13,495) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:00:13,707) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994488
[3380957:MainThread](2024-04-25 20:00:13,707) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:00:13,707) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:00:17,012) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:00:17,232) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994865
[3380957:MainThread](2024-04-25 20:00:17,232) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:00:17,232) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:00:20,522) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:00:20,733) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996331
[3380957:MainThread](2024-04-25 20:00:20,734) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:00:20,734) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:00:23,925) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:00:24,136) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994512
[3380957:MainThread](2024-04-25 20:00:24,137) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:00:24,137) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.994265 @ 4
[3380957:MainThread](2024-04-25 20:00:24,187) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-11-19 SH600000   -0.001619
           SH600004   -0.024190
           SH600009    0.003945
           SH600010    0.002192
           SH600011    0.037431
[3380957:MainThread](2024-04-25 20:00:25,902) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  82%|████████▏ | 36/44 [45:53<08:44, 65.51s/it][3380957:MainThread](2024-04-25 20:00:25,911) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 20:00:25,923) INFO - qlib.workflow - [recorder.py:341] - Recorder f86f8e7a72bd4542bc538de6b6f1fb97 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 20:00:26,723) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:00:26,724) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:00:26,727) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:00:26,727) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:00:34,617) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.776856
            SH600004      0.776856
            SH600006      0.776856
            SH600007      0.776856
            SH600008      0.776856
                            ...   
2018-01-29  SZ300124      1.931388
            SZ300136      1.931388
            SZ300144      1.931388
            SZ300251      1.931388
            SZ300315      1.931388
Length: 680999, dtype: float64
[3380957:MainThread](2024-04-25 20:00:34,619) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:00:34,620) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:00:34,620) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:00:37,941) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:00:38,180) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996902
[3380957:MainThread](2024-04-25 20:00:38,181) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:00:38,181) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:00:41,505) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:00:41,740) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997382
[3380957:MainThread](2024-04-25 20:00:41,741) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:00:41,741) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:00:45,037) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:00:45,270) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994798
[3380957:MainThread](2024-04-25 20:00:45,271) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:00:45,271) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:00:48,562) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:00:48,800) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995228
[3380957:MainThread](2024-04-25 20:00:48,801) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:00:48,801) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:00:52,075) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:00:52,311) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995434
[3380957:MainThread](2024-04-25 20:00:52,311) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:00:52,312) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:00:55,577) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:00:55,812) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994977
[3380957:MainThread](2024-04-25 20:00:55,812) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:00:55,813) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:00:59,110) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:00:59,345) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994559
[3380957:MainThread](2024-04-25 20:00:59,346) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:00:59,346) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:01:02,610) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:01:02,849) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995036
[3380957:MainThread](2024-04-25 20:01:02,850) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:01:02,850) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:01:06,185) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:01:06,425) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994556
[3380957:MainThread](2024-04-25 20:01:06,426) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:01:06,426) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:01:09,668) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:01:09,903) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994617
[3380957:MainThread](2024-04-25 20:01:09,903) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:01:09,904) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:01:13,201) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:01:13,436) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995475
[3380957:MainThread](2024-04-25 20:01:13,436) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:01:13,437) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:01:16,703) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:01:16,937) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994190
[3380957:MainThread](2024-04-25 20:01:16,938) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:01:16,939) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:01:20,234) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:01:20,471) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994656
[3380957:MainThread](2024-04-25 20:01:20,471) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:01:20,472) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:01:23,847) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:01:24,082) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995578
[3380957:MainThread](2024-04-25 20:01:24,083) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:01:24,083) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:01:27,345) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:01:27,581) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995414
[3380957:MainThread](2024-04-25 20:01:27,582) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:01:27,582) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:01:30,879) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:01:31,114) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994564
[3380957:MainThread](2024-04-25 20:01:31,114) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:01:31,115) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:01:34,478) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:01:34,714) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996025
[3380957:MainThread](2024-04-25 20:01:34,715) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:01:34,715) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:01:38,067) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:01:38,304) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994916
[3380957:MainThread](2024-04-25 20:01:38,304) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:01:38,304) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:01:41,629) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:01:41,866) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996638
[3380957:MainThread](2024-04-25 20:01:41,866) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:01:41,867) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:01:45,232) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:01:45,468) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996118
[3380957:MainThread](2024-04-25 20:01:45,469) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:01:45,469) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.994190 @ 11
[3380957:MainThread](2024-04-25 20:01:45,829) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-12-17 SH600000   -0.082243
           SH600004    0.044318
           SH600009    0.043103
           SH600010   -0.073952
           SH600011   -0.020315
[3380957:MainThread](2024-04-25 20:01:47,539) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  84%|████████▍ | 37/44 [47:15<08:12, 70.35s/it][3380957:MainThread](2024-04-25 20:01:47,548) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 20:01:47,560) INFO - qlib.workflow - [recorder.py:341] - Recorder f790222c32a24a70be8791c51e09aebb starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 20:01:48,387) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:01:48,387) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:01:48,390) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:01:48,391) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:01:56,608) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.892742
            SH600004      0.892742
            SH600006      0.892742
            SH600007      0.892742
            SH600008      0.892742
                            ...   
2018-03-05  SZ300124      1.983164
            SZ300136      1.983164
            SZ300144      1.983164
            SZ300251      1.983164
            SZ300315      1.983164
Length: 686698, dtype: float64
[3380957:MainThread](2024-04-25 20:01:56,610) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:01:56,611) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:01:56,611) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:02:00,248) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:02:00,482) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996500
[3380957:MainThread](2024-04-25 20:02:00,484) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:02:00,484) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:02:03,859) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:02:04,097) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995672
[3380957:MainThread](2024-04-25 20:02:04,098) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:02:04,098) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:02:07,421) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:02:07,653) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994859
[3380957:MainThread](2024-04-25 20:02:07,654) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:02:07,654) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:02:11,094) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:02:11,332) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995049
[3380957:MainThread](2024-04-25 20:02:11,333) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:02:11,333) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:02:14,726) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:02:14,961) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994984
[3380957:MainThread](2024-04-25 20:02:14,961) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:02:14,962) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:02:18,306) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:02:18,540) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994761
[3380957:MainThread](2024-04-25 20:02:18,541) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:02:18,541) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:02:21,896) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:02:22,135) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994884
[3380957:MainThread](2024-04-25 20:02:22,136) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:02:22,136) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:02:25,691) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:02:25,969) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994832
[3380957:MainThread](2024-04-25 20:02:25,969) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:02:25,970) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:02:29,488) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:02:29,723) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994699
[3380957:MainThread](2024-04-25 20:02:29,724) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:02:29,724) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:02:33,066) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:02:33,303) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996585
[3380957:MainThread](2024-04-25 20:02:33,304) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:02:33,304) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:02:36,658) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:02:36,893) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995184
[3380957:MainThread](2024-04-25 20:02:36,893) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:02:36,894) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:02:40,194) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:02:40,428) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996626
[3380957:MainThread](2024-04-25 20:02:40,429) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:02:40,429) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:02:43,766) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:02:44,000) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994247
[3380957:MainThread](2024-04-25 20:02:44,001) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:02:44,002) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:02:47,387) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:02:47,621) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995094
[3380957:MainThread](2024-04-25 20:02:47,622) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:02:47,622) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:02:50,983) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:02:51,216) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994474
[3380957:MainThread](2024-04-25 20:02:51,217) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:02:51,217) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:02:54,538) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:02:54,775) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994846
[3380957:MainThread](2024-04-25 20:02:54,775) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:02:54,776) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:02:58,178) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:02:58,413) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997074
[3380957:MainThread](2024-04-25 20:02:58,413) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:02:58,414) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:03:01,791) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:03:02,027) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997226
[3380957:MainThread](2024-04-25 20:03:02,027) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:03:02,027) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:03:05,415) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:03:05,652) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995675
[3380957:MainThread](2024-04-25 20:03:05,652) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:03:05,652) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:03:09,033) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:03:09,269) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995628
[3380957:MainThread](2024-04-25 20:03:09,269) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:03:09,269) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:03:12,646) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:03:12,881) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996169
[3380957:MainThread](2024-04-25 20:03:12,882) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:03:12,882) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.994247 @ 12
[3380957:MainThread](2024-04-25 20:03:12,934) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-01-15 SH600000    0.004065
           SH600004   -0.020132
           SH600009   -0.089992
           SH600010   -0.006223
           SH600011   -0.008285
[3380957:MainThread](2024-04-25 20:03:14,663) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  86%|████████▋ | 38/44 [48:42<07:32, 75.38s/it][3380957:MainThread](2024-04-25 20:03:14,672) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 20:03:14,684) INFO - qlib.workflow - [recorder.py:341] - Recorder dfb14916098d4ee2ad35ce317b85d7a7 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 20:03:15,514) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:03:15,514) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:03:15,517) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:03:15,517) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:03:23,446) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.644520
            SH600004      0.644520
            SH600006      0.644520
            SH600007      0.644520
            SH600008      0.644520
                            ...   
2018-04-02  SZ300124      1.923241
            SZ300136      1.923241
            SZ300144      1.923241
            SZ300251      1.923241
            SZ300315      1.923241
Length: 692433, dtype: float64
[3380957:MainThread](2024-04-25 20:03:23,449) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:03:23,449) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:03:23,449) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:03:26,826) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:03:27,036) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996735
[3380957:MainThread](2024-04-25 20:03:27,037) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:03:27,037) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:03:30,408) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:03:30,618) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996362
[3380957:MainThread](2024-04-25 20:03:30,620) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:03:30,620) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:03:33,992) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:03:34,201) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996491
[3380957:MainThread](2024-04-25 20:03:34,202) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:03:34,202) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:03:37,614) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:03:37,824) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995584
[3380957:MainThread](2024-04-25 20:03:37,825) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:03:37,826) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:03:41,253) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:03:41,462) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995921
[3380957:MainThread](2024-04-25 20:03:41,463) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:03:41,463) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:03:44,880) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:03:45,090) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997727
[3380957:MainThread](2024-04-25 20:03:45,091) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:03:45,091) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:03:48,516) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:03:48,726) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996299
[3380957:MainThread](2024-04-25 20:03:48,727) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:03:48,727) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:03:52,094) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:03:52,303) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995849
[3380957:MainThread](2024-04-25 20:03:52,303) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:03:52,303) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:03:55,661) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:03:55,871) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997107
[3380957:MainThread](2024-04-25 20:03:55,872) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:03:55,872) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:03:59,217) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:03:59,429) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997115
[3380957:MainThread](2024-04-25 20:03:59,430) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:03:59,430) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:04:02,776) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:04:02,985) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995754
[3380957:MainThread](2024-04-25 20:04:02,985) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:04:02,985) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:04:06,357) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:04:06,567) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997884
[3380957:MainThread](2024-04-25 20:04:06,568) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:04:06,568) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995584 @ 3
[3380957:MainThread](2024-04-25 20:04:06,619) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-02-20 SH600000   -0.026188
           SH600004    0.090420
           SH600009    0.027075
           SH600010   -0.007896
           SH600011   -0.013917
[3380957:MainThread](2024-04-25 20:04:08,390) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  89%|████████▊ | 39/44 [49:36<05:44, 68.89s/it][3380957:MainThread](2024-04-25 20:04:08,399) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 20:04:08,411) INFO - qlib.workflow - [recorder.py:341] - Recorder 96d3d941d11f4aebbf4b95b29774b12e starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 20:04:09,190) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:04:09,191) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:04:09,194) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:04:09,195) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:04:17,016) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.706358
            SH600004      0.706358
            SH600006      0.706358
            SH600007      0.706358
            SH600008      0.706358
                            ...   
2018-05-04  SZ300124      1.755170
            SZ300136      1.755170
            SZ300144      1.755170
            SZ300251      1.755170
            SZ300315      1.755170
Length: 698132, dtype: float64
[3380957:MainThread](2024-04-25 20:04:17,019) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:04:17,019) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:04:17,019) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:04:20,490) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:04:20,700) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997235
[3380957:MainThread](2024-04-25 20:04:20,701) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:04:20,702) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:04:24,099) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:04:24,307) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996837
[3380957:MainThread](2024-04-25 20:04:24,308) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:04:24,308) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:04:27,676) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:04:27,884) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996628
[3380957:MainThread](2024-04-25 20:04:27,885) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:04:27,886) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:04:31,287) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:04:31,494) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995610
[3380957:MainThread](2024-04-25 20:04:31,495) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:04:31,496) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:04:34,925) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:04:35,135) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997140
[3380957:MainThread](2024-04-25 20:04:35,136) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:04:35,136) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:04:38,521) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:04:38,731) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996167
[3380957:MainThread](2024-04-25 20:04:38,732) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:04:38,732) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:04:42,084) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:04:42,295) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996613
[3380957:MainThread](2024-04-25 20:04:42,296) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:04:42,296) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:04:45,646) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:04:45,855) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996956
[3380957:MainThread](2024-04-25 20:04:45,855) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:04:45,855) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:04:49,200) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:04:49,411) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996262
[3380957:MainThread](2024-04-25 20:04:49,412) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:04:49,412) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:04:52,665) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:04:52,874) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996278
[3380957:MainThread](2024-04-25 20:04:52,875) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:04:52,875) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:04:56,128) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:04:56,338) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997112
[3380957:MainThread](2024-04-25 20:04:56,338) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:04:56,339) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:04:59,682) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:04:59,893) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996319
[3380957:MainThread](2024-04-25 20:04:59,893) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:04:59,894) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995610 @ 3
[3380957:MainThread](2024-04-25 20:05:00,256) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-03-19 SH600000   -0.030612
           SH600004    0.117442
           SH600009   -0.005408
           SH600010   -0.030002
           SH600011   -0.021443
[3380957:MainThread](2024-04-25 20:05:02,000) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  91%|█████████ | 40/44 [50:29<04:17, 64.30s/it][3380957:MainThread](2024-04-25 20:05:02,010) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 20:05:02,024) INFO - qlib.workflow - [recorder.py:341] - Recorder 34f62aa1642942d6884f873910d430d9 starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 20:05:02,885) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:05:02,886) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:05:02,890) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:05:02,891) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:05:10,770) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.318544
            SH600004      1.318544
            SH600006      1.318544
            SH600007      1.318544
            SH600008      1.318544
                            ...   
2018-06-01  SZ300124      1.709063
            SZ300136      1.709063
            SZ300144      1.709063
            SZ300251      1.709063
            SZ300315      1.709063
Length: 703856, dtype: float64
[3380957:MainThread](2024-04-25 20:05:10,773) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:05:10,773) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:05:10,773) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:05:14,166) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:05:14,373) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997650
[3380957:MainThread](2024-04-25 20:05:14,374) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:05:14,375) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:05:17,838) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:05:18,046) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995851
[3380957:MainThread](2024-04-25 20:05:18,048) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:05:18,048) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:05:21,517) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:05:21,724) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995348
[3380957:MainThread](2024-04-25 20:05:21,725) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:05:21,726) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:05:25,131) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:05:25,339) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996119
[3380957:MainThread](2024-04-25 20:05:25,340) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:05:25,340) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:05:28,746) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:05:28,953) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995313
[3380957:MainThread](2024-04-25 20:05:28,955) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:05:28,955) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:05:32,393) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:05:32,601) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996412
[3380957:MainThread](2024-04-25 20:05:32,602) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:05:32,602) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:05:36,038) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:05:36,245) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995760
[3380957:MainThread](2024-04-25 20:05:36,246) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:05:36,246) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:05:39,664) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:05:39,872) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995310
[3380957:MainThread](2024-04-25 20:05:39,873) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:05:39,873) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:05:43,252) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:05:43,460) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996661
[3380957:MainThread](2024-04-25 20:05:43,461) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:05:43,461) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:05:46,850) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:05:47,057) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996054
[3380957:MainThread](2024-04-25 20:05:47,057) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:05:47,058) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:05:50,470) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:05:50,678) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996124
[3380957:MainThread](2024-04-25 20:05:50,678) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:05:50,679) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:05:54,103) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:05:54,313) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996066
[3380957:MainThread](2024-04-25 20:05:54,313) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:05:54,314) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:05:57,794) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:05:58,002) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996442
[3380957:MainThread](2024-04-25 20:05:58,003) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:05:58,003) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:06:01,427) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:06:01,635) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996333
[3380957:MainThread](2024-04-25 20:06:01,635) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:06:01,635) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:06:05,101) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:06:05,311) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997761
[3380957:MainThread](2024-04-25 20:06:05,311) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:06:05,311) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:06:08,751) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:06:08,960) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996049
[3380957:MainThread](2024-04-25 20:06:08,960) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:06:08,961) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995310 @ 7
[3380957:MainThread](2024-04-25 20:06:09,017) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-04-17 SH600000   -0.041144
           SH600004    0.022729
           SH600009   -0.019904
           SH600010   -0.036009
           SH600011   -0.016588
[3380957:MainThread](2024-04-25 20:06:10,741) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  93%|█████████▎| 41/44 [51:38<03:16, 65.63s/it][3380957:MainThread](2024-04-25 20:06:10,750) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 20:06:10,762) INFO - qlib.workflow - [recorder.py:341] - Recorder a14b2a85eee049e0bc2cc683bcb65d4c starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 20:06:11,552) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:06:11,552) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:06:11,555) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:06:11,555) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:06:19,441) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.938927
            SH600004      0.938927
            SH600006      0.938927
            SH600007      0.938927
            SH600008      0.938927
                            ...   
2018-07-02  SZ300136      1.563872
            SZ300144      1.563872
            SZ300251      1.563872
            SZ300408      1.563872
            SZ300433      1.563872
Length: 709547, dtype: float64
[3380957:MainThread](2024-04-25 20:06:19,443) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:06:19,444) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:06:19,444) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:06:22,991) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:06:23,226) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996736
[3380957:MainThread](2024-04-25 20:06:23,227) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:06:23,228) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:06:26,736) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:06:26,969) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997768
[3380957:MainThread](2024-04-25 20:06:26,969) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:06:26,970) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:06:30,410) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:06:30,646) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996680
[3380957:MainThread](2024-04-25 20:06:30,647) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:06:30,647) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:06:34,068) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:06:34,304) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995562
[3380957:MainThread](2024-04-25 20:06:34,305) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:06:34,306) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:06:37,770) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:06:38,005) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996305
[3380957:MainThread](2024-04-25 20:06:38,006) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:06:38,006) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:06:41,435) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:06:41,670) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996842
[3380957:MainThread](2024-04-25 20:06:41,671) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:06:41,671) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:06:45,101) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:06:45,334) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995248
[3380957:MainThread](2024-04-25 20:06:45,335) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:06:45,335) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:06:48,738) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:06:48,970) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996963
[3380957:MainThread](2024-04-25 20:06:48,970) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:06:48,971) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:06:52,403) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:06:52,637) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995897
[3380957:MainThread](2024-04-25 20:06:52,637) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:06:52,638) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:06:56,038) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:06:56,271) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996538
[3380957:MainThread](2024-04-25 20:06:56,271) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:06:56,271) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:06:59,669) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:06:59,902) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996366
[3380957:MainThread](2024-04-25 20:06:59,902) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:06:59,902) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:07:03,306) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:07:03,539) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998020
[3380957:MainThread](2024-04-25 20:07:03,539) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:07:03,540) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:07:07,018) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:07:07,251) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997974
[3380957:MainThread](2024-04-25 20:07:07,252) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:07:07,252) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:07:10,715) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:07:10,956) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996872
[3380957:MainThread](2024-04-25 20:07:10,956) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:07:10,956) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:07:14,582) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:07:14,821) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997527
[3380957:MainThread](2024-04-25 20:07:14,822) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:07:14,822) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995248 @ 6
[3380957:MainThread](2024-04-25 20:07:14,874) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-05-20 SH600000   -0.029482
           SH600004    0.126795
           SH600009    0.079666
           SH600010    0.007485
           SH600011    0.016385
[3380957:MainThread](2024-04-25 20:07:16,583) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  95%|█████████▌| 42/44 [52:44<02:11, 65.70s/it][3380957:MainThread](2024-04-25 20:07:16,592) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 20:07:16,606) INFO - qlib.workflow - [recorder.py:341] - Recorder 6d66c2375df3475ab485b8e814a6cead starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 20:07:17,409) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:07:17,410) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:07:17,413) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:07:17,414) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:07:26,642) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.638899
            SH600004      0.638899
            SH600006      0.638899
            SH600007      0.638899
            SH600008      0.638899
                            ...   
2018-07-30  SZ300136      1.373704
            SZ300144      1.373704
            SZ300251      1.373704
            SZ300408      1.373704
            SZ300433      1.373704
Length: 715298, dtype: float64
[3380957:MainThread](2024-04-25 20:07:26,645) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:07:26,646) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:07:26,646) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:07:30,389) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:07:30,585) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997297
[3380957:MainThread](2024-04-25 20:07:30,586) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:07:30,586) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:07:34,145) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:07:34,343) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996149
[3380957:MainThread](2024-04-25 20:07:34,344) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:07:34,344) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:07:37,900) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:07:38,098) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996163
[3380957:MainThread](2024-04-25 20:07:38,098) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:07:38,098) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:07:41,580) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:07:41,777) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995245
[3380957:MainThread](2024-04-25 20:07:41,778) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:07:41,779) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:07:45,197) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:07:45,396) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995469
[3380957:MainThread](2024-04-25 20:07:45,396) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:07:45,396) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:07:48,838) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:07:49,033) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996044
[3380957:MainThread](2024-04-25 20:07:49,033) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:07:49,034) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:07:52,490) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:07:52,686) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996185
[3380957:MainThread](2024-04-25 20:07:52,686) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:07:52,686) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:07:56,124) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:07:56,320) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995644
[3380957:MainThread](2024-04-25 20:07:56,320) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:07:56,321) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:07:59,785) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:07:59,981) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996739
[3380957:MainThread](2024-04-25 20:07:59,982) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:07:59,982) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:08:03,454) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:08:03,652) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996269
[3380957:MainThread](2024-04-25 20:08:03,652) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:08:03,653) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:08:07,205) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:08:07,404) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996873
[3380957:MainThread](2024-04-25 20:08:07,404) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:08:07,404) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:08:10,948) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:08:11,146) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995515
[3380957:MainThread](2024-04-25 20:08:11,147) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:08:11,147) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.995245 @ 3
[3380957:MainThread](2024-04-25 20:08:11,195) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-06-17 SH600000    0.004976
           SH600004    0.058330
           SH600009    0.036550
           SH600010   -0.016687
           SH600011   -0.036900
[3380957:MainThread](2024-04-25 20:08:12,941) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  98%|█████████▊| 43/44 [53:40<01:02, 62.89s/it][3380957:MainThread](2024-04-25 20:08:12,950) INFO - qlib.workflow - [exp.py:258] - Experiment 15 starts running ...
[3380957:MainThread](2024-04-25 20:08:12,962) INFO - qlib.workflow - [recorder.py:341] - Recorder 78d0ff5a7a114bff801ef0b37fc6cb7d starts running under Experiment 15 ...
[3380957:MainThread](2024-04-25 20:08:13,759) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:08:13,760) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:08:13,762) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:08:13,763) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:08:21,659) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.017712
            SH600004      1.017712
            SH600006      1.017712
            SH600007      1.017712
            SH600008      1.017712
                            ...   
2018-08-27  SZ300136      1.847242
            SZ300144      1.847242
            SZ300251      1.847242
            SZ300408      1.847242
            SZ300433      1.847242
Length: 721109, dtype: float64
[3380957:MainThread](2024-04-25 20:08:21,662) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:08:21,662) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:08:21,662) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:08:25,380) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:08:25,618) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997422
[3380957:MainThread](2024-04-25 20:08:25,619) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:08:25,619) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:08:29,178) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:08:29,415) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996414
[3380957:MainThread](2024-04-25 20:08:29,416) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:08:29,416) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:08:32,954) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:08:33,192) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996687
[3380957:MainThread](2024-04-25 20:08:33,193) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:08:33,193) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:08:36,744) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:08:36,985) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996231
[3380957:MainThread](2024-04-25 20:08:36,986) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:08:36,986) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:08:40,522) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:08:40,764) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996508
[3380957:MainThread](2024-04-25 20:08:40,764) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:08:40,765) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:08:44,313) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:08:44,551) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996381
[3380957:MainThread](2024-04-25 20:08:44,551) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:08:44,551) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:08:48,037) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:08:48,275) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996809
[3380957:MainThread](2024-04-25 20:08:48,276) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:08:48,276) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:08:51,761) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:08:51,999) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996235
[3380957:MainThread](2024-04-25 20:08:51,999) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:08:51,999) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:08:55,541) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:08:55,779) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996345
[3380957:MainThread](2024-04-25 20:08:55,779) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:08:55,780) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:08:59,322) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:08:59,562) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996663
[3380957:MainThread](2024-04-25 20:08:59,562) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:08:59,563) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:09:03,115) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:09:03,355) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997322
[3380957:MainThread](2024-04-25 20:09:03,355) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:09:03,355) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:09:06,938) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:09:07,177) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997660
[3380957:MainThread](2024-04-25 20:09:07,178) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:09:07,178) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.996231 @ 3
[3380957:MainThread](2024-04-25 20:09:07,219) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 15
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2020-07-17 SH600000    0.099322
           SH600004   -0.011298
           SH600009    0.081354
           SH600010    0.152794
           SH600011    0.157004
[3380957:MainThread](2024-04-25 20:09:08,696) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks: 100%|██████████| 44/44 [54:36<00:00, 60.75s/it]train tasks: 100%|██████████| 44/44 [54:36<00:00, 74.46s/it]
[3380957:MainThread](2024-04-25 20:09:08,838) INFO - qlib.timer - [log.py:127] - Time cost: 0.079s | Time to `list_recorders` in RecorderCollector Done
[3380957:MainThread](2024-04-25 20:09:08,838) INFO - qlib.RecorderCollector - [collect.py:226] - Nubmer of recorders after filter: defaultdict(<class 'int'>, {'FINISHED': 44})
[3380957:MainThread](2024-04-25 20:09:08,880) INFO - qlib.RollingEnsemble - [ensemble.py:83] - keys in group: ['78d0ff5a7a114bff801ef0b37fc6cb7d', '6d66c2375df3475ab485b8e814a6cead', 'a14b2a85eee049e0bc2cc683bcb65d4c', '34f62aa1642942d6884f873910d430d9', '96d3d941d11f4aebbf4b95b29774b12e', 'dfb14916098d4ee2ad35ce317b85d7a7', 'f790222c32a24a70be8791c51e09aebb', 'f86f8e7a72bd4542bc538de6b6f1fb97', 'e6e1045a7d19400fac44b74d4bff7aec', '9800500608574995839ab266e26c82cd', 'eb28b6ed479542c98ede118ade85cbf9', 'b09b66a13a4942e9a48604a1d5f9105a', '1c72eab0fa5c4467917ca6deecb8ac7f', '502e46703a5341ffb2c553f540b2f0d2', '2880400bcf8c41e191b2844facde5572', 'cf1130fd09114c52894bb549ddb80423', 'e6ccccdc8934477abc5b51e6c074adf6', 'f8b41c077ea14afb80124741f6ab325e', '708d65b1fffc4242940c575e037a034c', '8d96ce290f0449568d2f638a613d3170', '312afe6b849d41099b9df3141540ead4', '638da4b5af804b249b9ceb968f8dc018', '6e5d2bb37e6e4942b12f3170a5692808', 'a51ebbd3594e434a8a62ad7d81b7f2be', 'b175fa2694144d45a03a55cb72f35809', '42bc77dd46fd4e908e8912d36ec397a1', '86e92796ef2d44c690b781b043ebfdfd', '75b3bbc60257452cbd3b4069507d9e97', 'e54a741e00d04ef79fb87dc46a49b6eb', '34a63083f168441594d4e849647f6e4b', 'bcf96c25062c42c5aea8a7af25acfa30', '70898a493fd14e51b1294a1f7592bc70', 'ec153cdb283246bcb79c5cd43cc8a966', '832bb0ad0eca45aeae8b55fc8a9a840f', '5dba63fd56ce43298f18cc29284e8f27', '5de1a8eae0704beb8aab0d18af4aca66', 'da9b37b3a5a540dfa9a3721cabc191ab', '62fb85808bf445779d3ccf13f4d737c4', '41b6e49538794da8b4f76307293636c9', 'b6615246ff554f3888ee355ec804845f', 'd543cc90224f45cd961e0c29207368f9', '3ed1410e51674672a12f0b00596a97bb', '41daf3a2bef14ece82265af0e7fe1130', '57a21a6a2c234fb9a1d7171ce08cc051']
[3380957:MainThread](2024-04-25 20:09:08,977) INFO - qlib.RollingEnsemble - [ensemble.py:83] - keys in group: ['78d0ff5a7a114bff801ef0b37fc6cb7d', '6d66c2375df3475ab485b8e814a6cead', 'a14b2a85eee049e0bc2cc683bcb65d4c', '34f62aa1642942d6884f873910d430d9', '96d3d941d11f4aebbf4b95b29774b12e', 'dfb14916098d4ee2ad35ce317b85d7a7', 'f790222c32a24a70be8791c51e09aebb', 'f86f8e7a72bd4542bc538de6b6f1fb97', 'e6e1045a7d19400fac44b74d4bff7aec', '9800500608574995839ab266e26c82cd', 'eb28b6ed479542c98ede118ade85cbf9', 'b09b66a13a4942e9a48604a1d5f9105a', '1c72eab0fa5c4467917ca6deecb8ac7f', '502e46703a5341ffb2c553f540b2f0d2', '2880400bcf8c41e191b2844facde5572', 'cf1130fd09114c52894bb549ddb80423', 'e6ccccdc8934477abc5b51e6c074adf6', 'f8b41c077ea14afb80124741f6ab325e', '708d65b1fffc4242940c575e037a034c', '8d96ce290f0449568d2f638a613d3170', '312afe6b849d41099b9df3141540ead4', '638da4b5af804b249b9ceb968f8dc018', '6e5d2bb37e6e4942b12f3170a5692808', 'a51ebbd3594e434a8a62ad7d81b7f2be', 'b175fa2694144d45a03a55cb72f35809', '42bc77dd46fd4e908e8912d36ec397a1', '86e92796ef2d44c690b781b043ebfdfd', '75b3bbc60257452cbd3b4069507d9e97', 'e54a741e00d04ef79fb87dc46a49b6eb', '34a63083f168441594d4e849647f6e4b', 'bcf96c25062c42c5aea8a7af25acfa30', '70898a493fd14e51b1294a1f7592bc70', 'ec153cdb283246bcb79c5cd43cc8a966', '832bb0ad0eca45aeae8b55fc8a9a840f', '5dba63fd56ce43298f18cc29284e8f27', '5de1a8eae0704beb8aab0d18af4aca66', 'da9b37b3a5a540dfa9a3721cabc191ab', '62fb85808bf445779d3ccf13f4d737c4', '41b6e49538794da8b4f76307293636c9', 'b6615246ff554f3888ee355ec804845f', 'd543cc90224f45cd961e0c29207368f9', '3ed1410e51674672a12f0b00596a97bb', '41daf3a2bef14ece82265af0e7fe1130', '57a21a6a2c234fb9a1d7171ce08cc051']
[3380957:MainThread](2024-04-25 20:09:09,078) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name final_rolling_cn_data_csi300_GRU_alpha360_h1_step20_rankFalse_2024-04-25_19:14:32_DDG-DA.
[3380957:MainThread](2024-04-25 20:09:09,089) INFO - qlib.workflow - [exp.py:258] - Experiment 16 starts running ...
[3380957:MainThread](2024-04-25 20:09:09,098) INFO - qlib.workflow - [recorder.py:341] - Recorder 60e7d1a6a3604f488ec2afae5d38fb20 starts running under Experiment 16 ...
[3380957:MainThread](2024-04-25 20:09:09,905) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/scipy/stats/_stats_py.py:4916: ConstantInputWarning: An input array is constant; the correlation coefficient is not defined.
  warnings.warn(stats.ConstantInputWarning(warn_msg))
{'IC': 0.0598383684057312,
 'ICIR': 0.48069665848118337,
 'Rank IC': 0.05902098965148756,
 'Rank ICIR': 0.4853844082007087}
[3380957:MainThread](2024-04-25 20:09:11,552) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3380957:MainThread](2024-04-25 20:09:35,559) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3380957:MainThread](2024-04-25 20:09:35,561) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3380957:MainThread](2024-04-25 20:09:35,571) WARNING - qlib.online operator - [exchange.py:226] - factor.day.bin file not exists or factor contains `nan`. Order using adjusted_price.
[3380957:MainThread](2024-04-25 20:09:35,572) WARNING - qlib.online operator - [exchange.py:228] - trade unit 100 is not supported in adjusted_price mode.
[3380957:MainThread](2024-04-25 20:09:39,603) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f278c9109a0>
backtest loop:   0%|          | 0/872 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/872 [00:00<00:57, 15.11it/s]backtest loop:   1%|          | 9/872 [00:00<00:27, 31.28it/s]backtest loop:   2%|▏         | 16/872 [00:00<00:19, 43.30it/s]backtest loop:   2%|▏         | 21/872 [00:00<00:19, 44.25it/s]backtest loop:   3%|▎         | 28/872 [00:00<00:16, 50.45it/s]backtest loop:   4%|▍         | 34/872 [00:00<00:16, 50.57it/s]backtest loop:   5%|▍         | 41/872 [00:00<00:15, 54.47it/s]backtest loop:   5%|▌         | 47/872 [00:00<00:14, 56.01it/s]backtest loop:   6%|▌         | 54/872 [00:01<00:14, 54.88it/s]backtest loop:   7%|▋         | 61/872 [00:01<00:14, 57.22it/s]backtest loop:   8%|▊         | 67/872 [00:01<00:14, 55.15it/s]backtest loop:   8%|▊         | 74/872 [00:01<00:13, 57.43it/s]backtest loop:   9%|▉         | 81/872 [00:01<00:14, 55.81it/s]backtest loop:  10%|█         | 88/872 [00:01<00:13, 57.99it/s]backtest loop:  11%|█         | 95/872 [00:01<00:13, 59.67it/s]backtest loop:  12%|█▏        | 102/872 [00:01<00:13, 58.21it/s]backtest loop:  12%|█▎        | 109/872 [00:02<00:13, 56.80it/s]backtest loop:  13%|█▎        | 116/872 [00:02<00:12, 59.21it/s]backtest loop:  14%|█▍        | 123/872 [00:02<00:12, 60.49it/s]backtest loop:  15%|█▍        | 130/872 [00:02<00:12, 59.03it/s]backtest loop:  16%|█▌        | 137/872 [00:02<00:11, 61.87it/s]backtest loop:  17%|█▋        | 144/872 [00:02<00:12, 59.52it/s]backtest loop:  17%|█▋        | 151/872 [00:02<00:11, 60.95it/s]backtest loop:  18%|█▊        | 158/872 [00:02<00:11, 62.01it/s]backtest loop:  19%|█▉        | 165/872 [00:02<00:11, 60.48it/s]backtest loop:  20%|█▉        | 173/872 [00:03<00:10, 64.28it/s]backtest loop:  21%|██        | 180/872 [00:03<00:11, 61.07it/s]backtest loop:  21%|██▏       | 187/872 [00:03<00:10, 62.41it/s]backtest loop:  22%|██▏       | 194/872 [00:03<00:11, 60.01it/s]backtest loop:  23%|██▎       | 201/872 [00:03<00:10, 61.30it/s]backtest loop:  24%|██▍       | 208/872 [00:03<00:10, 62.57it/s]backtest loop:  25%|██▍       | 215/872 [00:03<00:11, 59.29it/s]backtest loop:  25%|██▌       | 222/872 [00:03<00:10, 60.27it/s]backtest loop:  26%|██▋       | 229/872 [00:04<00:11, 56.65it/s]backtest loop:  27%|██▋       | 235/872 [00:04<00:11, 57.15it/s]backtest loop:  28%|██▊       | 241/872 [00:04<00:10, 57.45it/s]backtest loop:  28%|██▊       | 247/872 [00:04<00:10, 58.09it/s]backtest loop:  29%|██▉       | 253/872 [00:04<00:11, 54.90it/s]backtest loop:  30%|██▉       | 259/872 [00:04<00:10, 56.07it/s]backtest loop:  30%|███       | 265/872 [00:04<00:10, 55.78it/s]backtest loop:  31%|███       | 271/872 [00:04<00:10, 56.75it/s]backtest loop:  32%|███▏      | 277/872 [00:04<00:10, 55.74it/s]backtest loop:  32%|███▏      | 283/872 [00:05<00:11, 52.78it/s]backtest loop:  33%|███▎      | 290/872 [00:05<00:10, 55.64it/s]backtest loop:  34%|███▍      | 297/872 [00:05<00:09, 58.10it/s]backtest loop:  35%|███▍      | 303/872 [00:05<00:10, 55.86it/s]backtest loop:  35%|███▌      | 309/872 [00:05<00:10, 56.00it/s]backtest loop:  36%|███▌      | 315/872 [00:05<00:09, 55.79it/s]backtest loop:  37%|███▋      | 321/872 [00:05<00:10, 52.77it/s]backtest loop:  38%|███▊      | 327/872 [00:05<00:10, 53.85it/s]backtest loop:  38%|███▊      | 333/872 [00:05<00:09, 54.46it/s]backtest loop:  39%|███▉      | 339/872 [00:06<00:10, 52.08it/s]backtest loop:  40%|███▉      | 346/872 [00:06<00:09, 55.42it/s]backtest loop:  40%|████      | 353/872 [00:06<00:08, 57.94it/s]backtest loop:  41%|████      | 359/872 [00:06<00:09, 55.75it/s]backtest loop:  42%|████▏     | 365/872 [00:06<00:09, 55.68it/s]backtest loop:  43%|████▎     | 371/872 [00:06<00:08, 55.94it/s]backtest loop:  43%|████▎     | 377/872 [00:06<00:08, 55.83it/s]backtest loop:  44%|████▍     | 383/872 [00:06<00:09, 51.87it/s]backtest loop:  45%|████▍     | 390/872 [00:06<00:08, 56.36it/s]backtest loop:  46%|████▌     | 397/872 [00:07<00:08, 59.05it/s]backtest loop:  46%|████▌     | 403/872 [00:07<00:08, 57.72it/s]backtest loop:  47%|████▋     | 410/872 [00:07<00:07, 59.89it/s]backtest loop:  48%|████▊     | 417/872 [00:07<00:07, 62.32it/s]backtest loop:  49%|████▊     | 424/872 [00:07<00:07, 60.00it/s]backtest loop:  49%|████▉     | 431/872 [00:07<00:07, 62.08it/s]backtest loop:  50%|█████     | 438/872 [00:07<00:07, 61.16it/s]backtest loop:  51%|█████     | 445/872 [00:07<00:06, 63.05it/s]backtest loop:  52%|█████▏    | 452/872 [00:07<00:06, 61.17it/s]backtest loop:  53%|█████▎    | 459/872 [00:08<00:06, 62.40it/s]backtest loop:  53%|█████▎    | 466/872 [00:08<00:06, 63.15it/s]backtest loop:  54%|█████▍    | 473/872 [00:08<00:06, 59.66it/s]backtest loop:  55%|█████▌    | 480/872 [00:08<00:06, 61.29it/s]backtest loop:  56%|█████▌    | 487/872 [00:08<00:06, 59.82it/s]backtest loop:  57%|█████▋    | 494/872 [00:08<00:06, 61.15it/s]backtest loop:  57%|█████▋    | 501/872 [00:08<00:06, 58.86it/s]backtest loop:  58%|█████▊    | 508/872 [00:08<00:06, 59.82it/s]backtest loop:  59%|█████▉    | 515/872 [00:09<00:08, 44.37it/s]backtest loop:  60%|█████▉    | 522/872 [00:09<00:07, 48.65it/s]backtest loop:  61%|██████    | 529/872 [00:09<00:06, 52.51it/s]backtest loop:  61%|██████▏   | 535/872 [00:09<00:06, 51.72it/s]backtest loop:  62%|██████▏   | 542/872 [00:09<00:06, 54.86it/s]backtest loop:  63%|██████▎   | 548/872 [00:09<00:05, 56.18it/s]backtest loop:  64%|██████▎   | 554/872 [00:09<00:05, 54.43it/s]backtest loop:  64%|██████▍   | 561/872 [00:09<00:05, 57.35it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:  65%|██████▌   | 568/872 [00:10<00:05, 60.46it/s]backtest loop:  66%|██████▌   | 575/872 [00:10<00:04, 61.12it/s]backtest loop:  67%|██████▋   | 582/872 [00:10<00:04, 58.83it/s]backtest loop:  68%|██████▊   | 589/872 [00:10<00:04, 59.97it/s]backtest loop:  68%|██████▊   | 596/872 [00:10<00:04, 57.75it/s]backtest loop:  69%|██████▉   | 603/872 [00:10<00:04, 59.22it/s]backtest loop:  70%|██████▉   | 610/872 [00:10<00:04, 57.01it/s]backtest loop:  71%|███████   | 617/872 [00:10<00:04, 58.61it/s]backtest loop:  72%|███████▏  | 624/872 [00:10<00:04, 59.71it/s]backtest loop:  72%|███████▏  | 631/872 [00:11<00:04, 56.88it/s]backtest loop:  73%|███████▎  | 638/872 [00:11<00:04, 58.42it/s]backtest loop:  74%|███████▍  | 645/872 [00:11<00:03, 56.82it/s]backtest loop:  75%|███████▍  | 652/872 [00:11<00:03, 58.41it/s]backtest loop:  76%|███████▌  | 659/872 [00:11<00:03, 56.46it/s]backtest loop:  76%|███████▋  | 666/872 [00:11<00:03, 58.12it/s]backtest loop:  77%|███████▋  | 672/872 [00:11<00:03, 55.49it/s]backtest loop:  78%|███████▊  | 679/872 [00:11<00:03, 54.35it/s]backtest loop:  79%|███████▊  | 685/872 [00:12<00:03, 55.38it/s]backtest loop:  79%|███████▉  | 692/872 [00:12<00:03, 57.46it/s]backtest loop:  80%|████████  | 698/872 [00:12<00:03, 57.38it/s]backtest loop:  81%|████████  | 704/872 [00:12<00:03, 54.78it/s]backtest loop:  82%|████████▏ | 711/872 [00:12<00:02, 57.07it/s]backtest loop:  82%|████████▏ | 718/872 [00:12<00:02, 58.56it/s]backtest loop:  83%|████████▎ | 724/872 [00:12<00:02, 55.65it/s]backtest loop:  84%|████████▎ | 730/872 [00:12<00:02, 56.82it/s]backtest loop:  84%|████████▍ | 736/872 [00:12<00:02, 54.05it/s]backtest loop:  85%|████████▌ | 743/872 [00:13<00:02, 53.35it/s]backtest loop:  86%|████████▌ | 750/872 [00:13<00:02, 56.25it/s]backtest loop:  87%|████████▋ | 756/872 [00:13<00:02, 57.17it/s]backtest loop:  87%|████████▋ | 762/872 [00:13<00:02, 54.68it/s]backtest loop:  88%|████████▊ | 768/872 [00:13<00:01, 55.95it/s]backtest loop:  89%|████████▉ | 774/872 [00:13<00:01, 55.83it/s]backtest loop:  89%|████████▉ | 780/872 [00:13<00:01, 55.72it/s]backtest loop:  90%|█████████ | 786/872 [00:13<00:01, 55.12it/s]backtest loop:  91%|█████████ | 792/872 [00:13<00:01, 51.86it/s]backtest loop:  92%|█████████▏| 798/872 [00:14<00:01, 52.79it/s]backtest loop:  92%|█████████▏| 804/872 [00:14<00:01, 53.60it/s]backtest loop:  93%|█████████▎| 810/872 [00:14<00:01, 51.06it/s]backtest loop:  94%|█████████▎| 816/872 [00:14<00:01, 52.39it/s]backtest loop:  94%|█████████▍| 822/872 [00:14<00:00, 53.43it/s]backtest loop:  95%|█████████▍| 828/872 [00:14<00:00, 50.70it/s]backtest loop:  96%|█████████▌| 834/872 [00:14<00:00, 51.79it/s]backtest loop:  96%|█████████▋| 840/872 [00:14<00:00, 52.71it/s]backtest loop:  97%|█████████▋| 846/872 [00:15<00:00, 50.52it/s]backtest loop:  98%|█████████▊| 852/872 [00:15<00:00, 52.00it/s]backtest loop:  98%|█████████▊| 858/872 [00:15<00:00, 53.03it/s]backtest loop:  99%|█████████▉| 864/872 [00:15<00:00, 53.99it/s]backtest loop: 100%|█████████▉| 870/872 [00:15<00:00, 54.50it/s]backtest loop: 100%|██████████| 872/872 [00:15<00:00, 56.19it/s]
[3380957:MainThread](2024-04-25 20:09:55,180) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 16
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000495
std                0.012300
annualized_return  0.117864
information_ratio  0.621155
max_drawdown      -0.370479
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000635
std                0.005491
annualized_return  0.151122
information_ratio  1.783982
max_drawdown      -0.086818
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000452
std                0.005490
annualized_return  0.107676
information_ratio  1.271246
max_drawdown      -0.107742
[3380957:MainThread](2024-04-25 20:09:55,194) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 16
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Remove CSRankNorm
{'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': datetime.date(2008, 1, 1), 'end_time': datetime.date(2020, 8, 1), 'fit_start_time': datetime.date(2008, 1, 1), 'fit_end_time': datetime.date(2014, 12, 31), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
[3380957:MainThread](2024-04-25 20:09:56,040) INFO - qlib.RollingBenchmark - [rolling_benchmark.py:208] - {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 5000, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/baseline/cn_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': [datetime.date(2008, 1, 1), datetime.date(2014, 12, 31)], 'valid': [datetime.date(2015, 1, 1), datetime.date(2016, 12, 31)], 'test': [datetime.date(2017, 1, 1), datetime.date(2020, 8, 1)]}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
Your evaluation results can be found in the experiment named `final_rolling_cn_data_csi300_GRU_alpha360_h1_step20_rankFalse_2024-04-25_19:14:32_DDG-DA`.
{'1day.excess_return_with_cost.annualized_return': [0.08807704690081429,
                                                    0.10767635879407857],
 '1day.excess_return_with_cost.information_ratio': [1.0725851666845683,
                                                    1.271245548635908],
 '1day.excess_return_with_cost.max_drawdown': [-0.05918751178811195,
                                               -0.10774249308940961],
 'IC': [0.05466413562417747, 0.0598383684057312],
 'ICIR': [0.4444839315354363, 0.48069665848118337],
 'Rank IC': [0.05508946664532743, 0.05902098965148756],
 'Rank ICIR': [0.45435263981091156, 0.4853844082007087],
 'mae': [0.6961899399757385, 0.6959196329116821],
 'mse': [0.995438277721405, 0.9945645332336426]}
Remove CSRankNorm
{'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': datetime.date(2008, 1, 1), 'end_time': datetime.date(2020, 8, 1), 'fit_start_time': datetime.date(2008, 1, 1), 'fit_end_time': datetime.date(2014, 12, 31), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
[3380957:MainThread](2024-04-25 20:10:00,585) INFO - qlib.RollingBenchmark - [rolling_benchmark.py:208] - {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 5000, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/baseline/cn_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': [datetime.date(2008, 1, 1), datetime.date(2014, 12, 31)], 'valid': [datetime.date(2015, 1, 1), datetime.date(2016, 12, 31)], 'test': [datetime.date(2017, 1, 1), datetime.date(2020, 8, 1)]}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
[3380957:MainThread](2024-04-25 20:10:00,596) INFO - qlib.MetaDatasetDS - [dataset.py:316] - Example task for training meta model: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 5000, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/baseline/cn_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-02 00:00:00'), Timestamp('2014-12-31 00:00:00')), 'valid': (Timestamp('2015-01-05 00:00:00'), Timestamp('2016-12-29 00:00:00')), 'test': (Timestamp('2017-01-03 00:00:00'), Timestamp('2017-02-06 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/44 [00:00<?, ?it/s]creating meta tasks:   2%|▏         | 1/44 [00:00<00:23,  1.80it/s]creating meta tasks:   5%|▍         | 2/44 [00:00<00:19,  2.13it/s]creating meta tasks:   7%|▋         | 3/44 [00:01<00:18,  2.26it/s]creating meta tasks:   9%|▉         | 4/44 [00:01<00:17,  2.33it/s]creating meta tasks:  11%|█▏        | 5/44 [00:02<00:16,  2.35it/s]creating meta tasks:  14%|█▎        | 6/44 [00:02<00:16,  2.37it/s]creating meta tasks:  16%|█▌        | 7/44 [00:03<00:15,  2.38it/s]creating meta tasks:  18%|█▊        | 8/44 [00:03<00:15,  2.39it/s]creating meta tasks:  20%|██        | 9/44 [00:03<00:14,  2.38it/s]creating meta tasks:  23%|██▎       | 10/44 [00:04<00:14,  2.39it/s]creating meta tasks:  25%|██▌       | 11/44 [00:04<00:13,  2.39it/s]creating meta tasks:  27%|██▋       | 12/44 [00:05<00:13,  2.37it/s]creating meta tasks:  30%|██▉       | 13/44 [00:05<00:14,  2.18it/s]creating meta tasks:  32%|███▏      | 14/44 [00:06<00:13,  2.23it/s]creating meta tasks:  34%|███▍      | 15/44 [00:06<00:13,  2.10it/s]creating meta tasks:  36%|███▋      | 16/44 [00:07<00:13,  2.08it/s]creating meta tasks:  39%|███▊      | 17/44 [00:07<00:13,  1.99it/s]creating meta tasks:  41%|████      | 18/44 [00:08<00:13,  1.97it/s]creating meta tasks:  43%|████▎     | 19/44 [00:08<00:12,  1.94it/s]creating meta tasks:  45%|████▌     | 20/44 [00:09<00:12,  1.91it/s]creating meta tasks:  48%|████▊     | 21/44 [00:09<00:11,  1.98it/s]creating meta tasks:  50%|█████     | 22/44 [00:10<00:10,  2.07it/s]creating meta tasks:  52%|█████▏    | 23/44 [00:10<00:09,  2.13it/s]creating meta tasks:  55%|█████▍    | 24/44 [00:11<00:09,  2.19it/s]creating meta tasks:  57%|█████▋    | 25/44 [00:11<00:08,  2.23it/s]creating meta tasks:  59%|█████▉    | 26/44 [00:11<00:07,  2.26it/s]creating meta tasks:  61%|██████▏   | 27/44 [00:12<00:07,  2.28it/s]creating meta tasks:  64%|██████▎   | 28/44 [00:12<00:06,  2.29it/s]creating meta tasks:  66%|██████▌   | 29/44 [00:13<00:06,  2.30it/s]creating meta tasks:  68%|██████▊   | 30/44 [00:13<00:06,  2.22it/s]creating meta tasks:  70%|███████   | 31/44 [00:14<00:05,  2.20it/s]creating meta tasks:  73%|███████▎  | 32/44 [00:14<00:05,  2.15it/s]creating meta tasks:  75%|███████▌  | 33/44 [00:15<00:05,  2.12it/s]creating meta tasks:  77%|███████▋  | 34/44 [00:15<00:04,  2.10it/s]creating meta tasks:  80%|███████▉  | 35/44 [00:16<00:04,  2.06it/s]creating meta tasks:  82%|████████▏ | 36/44 [00:16<00:03,  2.10it/s]creating meta tasks:  84%|████████▍ | 37/44 [00:17<00:03,  2.12it/s]creating meta tasks:  86%|████████▋ | 38/44 [00:17<00:02,  2.13it/s]creating meta tasks:  89%|████████▊ | 39/44 [00:17<00:02,  2.14it/s]creating meta tasks:  91%|█████████ | 40/44 [00:18<00:01,  2.15it/s]creating meta tasks:  93%|█████████▎| 41/44 [00:18<00:01,  2.11it/s]creating meta tasks:  95%|█████████▌| 42/44 [00:19<00:00,  2.12it/s]creating meta tasks:  98%|█████████▊| 43/44 [00:19<00:00,  2.12it/s]creating meta tasks: 100%|██████████| 44/44 [00:20<00:00,  2.12it/s]creating meta tasks: 100%|██████████| 44/44 [00:20<00:00,  2.17it/s]
train tasks:   0%|          | 0/44 [00:00<?, ?it/s][3380957:MainThread](2024-04-25 20:10:21,205) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name rolling_cn_data_csi300_GRU_alpha360_h1_step20_rankFalse_2024-04-25_20:10:21_DDG-DA.
[3380957:MainThread](2024-04-25 20:10:21,217) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:10:21,232) INFO - qlib.workflow - [recorder.py:341] - Recorder 9d6f9d1a17f943f1830233f67c14f584 starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:10:22,116) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:10:22,116) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:10:22,119) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:10:22,119) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:10:29,673) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.531189
            SH600004      0.531189
            SH600006      0.531189
            SH600007      0.531189
            SH600008      0.531189
                            ...   
2014-12-31  SZ300070      1.926130
            SZ300124      1.926130
            SZ300133      1.926130
            SZ300146      1.926130
            SZ300251      1.926130
Length: 478007, dtype: float64
[3380957:MainThread](2024-04-25 20:10:29,676) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:10:29,676) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:10:29,676) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:10:32,071) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:10:32,294) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995417
[3380957:MainThread](2024-04-25 20:10:32,295) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:10:32,295) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:10:34,592) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:10:34,815) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994779
[3380957:MainThread](2024-04-25 20:10:34,816) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:10:34,816) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:10:37,087) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:10:37,310) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994762
[3380957:MainThread](2024-04-25 20:10:37,311) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:10:37,311) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:10:39,592) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:10:39,815) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993510
[3380957:MainThread](2024-04-25 20:10:39,816) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:10:39,816) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:10:42,093) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:10:42,318) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994803
[3380957:MainThread](2024-04-25 20:10:42,318) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:10:42,318) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:10:44,609) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:10:44,831) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993925
[3380957:MainThread](2024-04-25 20:10:44,831) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:10:44,832) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:10:47,119) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:10:47,344) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993845
[3380957:MainThread](2024-04-25 20:10:47,344) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:10:47,344) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:10:49,648) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:10:49,869) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993816
[3380957:MainThread](2024-04-25 20:10:49,870) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:10:49,870) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:10:52,222) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:10:52,445) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993668
[3380957:MainThread](2024-04-25 20:10:52,446) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:10:52,446) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:10:54,797) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:10:55,022) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995686
[3380957:MainThread](2024-04-25 20:10:55,023) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:10:55,023) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:10:57,377) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:10:57,603) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993204
[3380957:MainThread](2024-04-25 20:10:57,604) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:10:57,604) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:10:59,960) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:00,187) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993657
[3380957:MainThread](2024-04-25 20:11:00,187) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:11:00,188) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:11:02,544) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:02,774) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993629
[3380957:MainThread](2024-04-25 20:11:02,774) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:11:02,775) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:11:05,081) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:05,304) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994031
[3380957:MainThread](2024-04-25 20:11:05,304) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:11:05,304) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:11:07,607) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:07,830) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993966
[3380957:MainThread](2024-04-25 20:11:07,830) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:11:07,831) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:11:10,137) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:10,360) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994121
[3380957:MainThread](2024-04-25 20:11:10,361) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:11:10,361) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:11:12,664) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:12,891) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995916
[3380957:MainThread](2024-04-25 20:11:12,892) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:11:12,892) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:11:15,279) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:15,512) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998062
[3380957:MainThread](2024-04-25 20:11:15,512) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:11:15,512) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:11:17,914) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:18,139) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994432
[3380957:MainThread](2024-04-25 20:11:18,139) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:11:18,140) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993204 @ 10
[3380957:MainThread](2024-04-25 20:11:18,315) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-01-03 SH600000   -0.019328
           SH600008   -0.003863
           SH600009    0.034168
           SH600010   -0.023390
           SH600015   -0.017013
[3380957:MainThread](2024-04-25 20:11:19,679) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   2%|▏         | 1/44 [00:58<41:54, 58.48s/it][3380957:MainThread](2024-04-25 20:11:19,688) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:11:19,701) INFO - qlib.workflow - [recorder.py:341] - Recorder 4c90694306324cb98914354b9715138a starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:11:20,531) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:11:20,532) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:11:20,534) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:11:20,535) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:11:28,655) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.540706
            SH600004      0.540706
            SH600006      0.540706
            SH600007      0.540706
            SH600008      0.540706
                            ...   
2015-01-30  SZ300070      1.993639
            SZ300124      1.993639
            SZ300133      1.993639
            SZ300146      1.993639
            SZ300251      1.993639
Length: 483831, dtype: float64
[3380957:MainThread](2024-04-25 20:11:28,657) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:11:28,658) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:11:28,658) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:11:31,313) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:31,689) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995248
[3380957:MainThread](2024-04-25 20:11:31,691) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:11:31,692) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:11:34,050) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:34,274) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996208
[3380957:MainThread](2024-04-25 20:11:34,274) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:11:34,274) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:11:36,642) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:36,869) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995418
[3380957:MainThread](2024-04-25 20:11:36,869) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:11:36,869) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:11:39,205) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:39,434) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993651
[3380957:MainThread](2024-04-25 20:11:39,435) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:11:39,436) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:11:41,765) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:41,990) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996391
[3380957:MainThread](2024-04-25 20:11:41,991) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:11:41,991) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:11:44,323) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:44,548) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994580
[3380957:MainThread](2024-04-25 20:11:44,548) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:11:44,549) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:11:46,859) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:47,083) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993898
[3380957:MainThread](2024-04-25 20:11:47,084) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:11:47,084) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:11:49,406) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:49,634) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993274
[3380957:MainThread](2024-04-25 20:11:49,636) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:11:49,636) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:11:51,943) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:52,168) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993610
[3380957:MainThread](2024-04-25 20:11:52,168) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:11:52,168) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:11:54,492) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:54,717) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993740
[3380957:MainThread](2024-04-25 20:11:54,717) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:11:54,718) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:11:57,025) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:57,250) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995789
[3380957:MainThread](2024-04-25 20:11:57,251) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:11:57,251) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:11:59,544) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:11:59,770) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992908
[3380957:MainThread](2024-04-25 20:11:59,771) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:11:59,771) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:12:02,102) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:12:02,330) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993288
[3380957:MainThread](2024-04-25 20:12:02,331) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:12:02,331) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:12:04,723) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:12:04,949) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993416
[3380957:MainThread](2024-04-25 20:12:04,949) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:12:04,950) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:12:07,315) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:12:07,541) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993657
[3380957:MainThread](2024-04-25 20:12:07,541) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:12:07,541) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:12:09,932) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:12:10,159) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993770
[3380957:MainThread](2024-04-25 20:12:10,160) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:12:10,160) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:12:12,518) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:12:12,744) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993391
[3380957:MainThread](2024-04-25 20:12:12,744) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:12:12,745) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:12:15,074) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:12:15,299) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994217
[3380957:MainThread](2024-04-25 20:12:15,299) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:12:15,300) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:12:17,633) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:12:17,862) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992841
[3380957:MainThread](2024-04-25 20:12:17,864) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:12:17,864) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:12:20,190) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:12:20,419) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994662
[3380957:MainThread](2024-04-25 20:12:20,420) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:12:20,420) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:12:22,746) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:12:22,977) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993677
[3380957:MainThread](2024-04-25 20:12:22,977) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:12:22,977) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:12:25,311) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:12:25,540) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993523
[3380957:MainThread](2024-04-25 20:12:25,540) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:12:25,541) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:12:27,847) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:12:28,073) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995517
[3380957:MainThread](2024-04-25 20:12:28,073) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 20:12:28,073) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:12:30,380) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:12:30,609) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995572
[3380957:MainThread](2024-04-25 20:12:30,609) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 20:12:30,609) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:12:32,995) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:12:33,221) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995639
[3380957:MainThread](2024-04-25 20:12:33,221) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 20:12:33,222) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:12:35,574) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:12:35,803) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995248
[3380957:MainThread](2024-04-25 20:12:35,804) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 20:12:35,804) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:12:38,135) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:12:38,365) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.999194
[3380957:MainThread](2024-04-25 20:12:38,365) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:12:38,365) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.992841 @ 18
[3380957:MainThread](2024-04-25 20:12:38,415) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-02-07 SH600000    0.036010
           SH600008    0.053205
           SH600009    0.049976
           SH600010   -0.005931
           SH600015    0.059286
[3380957:MainThread](2024-04-25 20:12:40,147) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   5%|▍         | 2/44 [02:18<49:59, 71.42s/it][3380957:MainThread](2024-04-25 20:12:40,158) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:12:40,172) INFO - qlib.workflow - [recorder.py:341] - Recorder 81dc9edad484482da19c1bbb78ecdabe starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:12:41,012) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:12:41,013) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:12:41,016) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:12:41,016) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:12:48,611) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.633202
            SH600004      0.633202
            SH600006      0.633202
            SH600007      0.633202
            SH600008      0.633202
                            ...   
2015-03-06  SZ300070      1.927306
            SZ300124      1.927306
            SZ300133      1.927306
            SZ300146      1.927306
            SZ300251      1.927306
Length: 489365, dtype: float64
[3380957:MainThread](2024-04-25 20:12:48,613) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:12:48,614) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:12:48,614) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:12:50,952) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:12:51,177) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.998067
[3380957:MainThread](2024-04-25 20:12:51,179) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:12:51,179) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:12:53,520) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:12:53,745) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995235
[3380957:MainThread](2024-04-25 20:12:53,746) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:12:53,747) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:12:56,100) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:12:56,325) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994384
[3380957:MainThread](2024-04-25 20:12:56,326) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:12:56,327) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:12:58,663) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:12:58,889) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994788
[3380957:MainThread](2024-04-25 20:12:58,890) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:12:58,890) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:01,236) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:01,462) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994538
[3380957:MainThread](2024-04-25 20:13:01,463) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:13:01,463) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:03,805) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:04,030) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994262
[3380957:MainThread](2024-04-25 20:13:04,031) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:13:04,031) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:06,382) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:06,611) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995138
[3380957:MainThread](2024-04-25 20:13:06,611) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:13:06,612) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:08,953) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:09,186) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994102
[3380957:MainThread](2024-04-25 20:13:09,187) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:13:09,187) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:11,588) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:11,814) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993888
[3380957:MainThread](2024-04-25 20:13:11,815) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:13:11,816) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:14,187) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:14,414) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994113
[3380957:MainThread](2024-04-25 20:13:14,415) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:13:14,415) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:16,811) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:17,037) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993728
[3380957:MainThread](2024-04-25 20:13:17,038) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:13:17,039) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:19,450) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:19,680) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994345
[3380957:MainThread](2024-04-25 20:13:19,680) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:13:19,681) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:22,026) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:22,252) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993301
[3380957:MainThread](2024-04-25 20:13:22,253) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:13:22,254) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:24,640) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:24,868) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993500
[3380957:MainThread](2024-04-25 20:13:24,868) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:13:24,869) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:27,271) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:27,498) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993933
[3380957:MainThread](2024-04-25 20:13:27,499) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:13:27,499) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:29,895) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:30,125) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994259
[3380957:MainThread](2024-04-25 20:13:30,125) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:13:30,125) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:32,535) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:32,765) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993989
[3380957:MainThread](2024-04-25 20:13:32,765) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:13:32,766) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:35,123) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:35,350) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993215
[3380957:MainThread](2024-04-25 20:13:35,351) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:13:35,352) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:37,738) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:37,965) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993963
[3380957:MainThread](2024-04-25 20:13:37,965) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:13:37,965) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:40,359) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:40,587) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994455
[3380957:MainThread](2024-04-25 20:13:40,587) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:13:40,588) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:42,881) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:43,107) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994252
[3380957:MainThread](2024-04-25 20:13:43,108) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:13:43,108) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:45,469) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:45,699) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994758
[3380957:MainThread](2024-04-25 20:13:45,699) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:13:45,699) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:48,054) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:48,280) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995175
[3380957:MainThread](2024-04-25 20:13:48,280) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 20:13:48,280) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:50,623) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:50,849) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996094
[3380957:MainThread](2024-04-25 20:13:50,849) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 20:13:50,850) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:53,183) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:53,414) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997739
[3380957:MainThread](2024-04-25 20:13:53,414) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 20:13:53,415) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:13:55,733) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:13:55,963) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -1.000277
[3380957:MainThread](2024-04-25 20:13:55,963) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:13:55,963) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993215 @ 17
[3380957:MainThread](2024-04-25 20:13:56,282) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-03-07 SH600000   -0.016946
           SH600008   -0.004454
           SH600009    0.016228
           SH600010   -0.006132
           SH600015    0.026791
[3380957:MainThread](2024-04-25 20:13:58,078) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   7%|▋         | 3/44 [03:36<50:50, 74.39s/it][3380957:MainThread](2024-04-25 20:13:58,088) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:13:58,101) INFO - qlib.workflow - [recorder.py:341] - Recorder e301ef51d7d04af2a643dc4dfd76c11e starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:13:59,022) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:13:59,023) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:13:59,025) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:13:59,025) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:14:06,754) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.656091
            SH600004      0.656091
            SH600006      0.656091
            SH600007      0.656091
            SH600008      0.656091
                            ...   
2015-04-03  SZ300070      0.662065
            SZ300124      0.662065
            SZ300133      0.662065
            SZ300146      0.662065
            SZ300251      0.662065
Length: 495049, dtype: float64
[3380957:MainThread](2024-04-25 20:14:06,756) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:14:06,757) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:14:06,757) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:09,204) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:09,432) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995701
[3380957:MainThread](2024-04-25 20:14:09,433) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:14:09,433) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:11,845) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:12,069) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995218
[3380957:MainThread](2024-04-25 20:14:12,070) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:14:12,071) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:14,456) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:14,684) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994521
[3380957:MainThread](2024-04-25 20:14:14,685) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:14:14,686) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:17,101) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:17,327) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994472
[3380957:MainThread](2024-04-25 20:14:17,328) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:14:17,328) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:19,732) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:19,958) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994099
[3380957:MainThread](2024-04-25 20:14:19,960) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:14:19,960) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:22,408) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:22,638) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994720
[3380957:MainThread](2024-04-25 20:14:22,638) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:14:22,639) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:25,078) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:25,308) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994386
[3380957:MainThread](2024-04-25 20:14:25,308) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:14:25,308) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:27,756) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:27,985) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994959
[3380957:MainThread](2024-04-25 20:14:27,986) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:14:27,986) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:30,433) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:30,661) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993811
[3380957:MainThread](2024-04-25 20:14:30,662) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:14:30,663) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:33,110) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:33,336) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994334
[3380957:MainThread](2024-04-25 20:14:33,336) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:14:33,336) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:35,769) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:35,995) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993868
[3380957:MainThread](2024-04-25 20:14:35,995) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:14:35,995) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:38,373) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:38,604) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994222
[3380957:MainThread](2024-04-25 20:14:38,604) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:14:38,604) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:41,034) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:41,263) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993830
[3380957:MainThread](2024-04-25 20:14:41,264) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:14:41,264) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:43,651) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:43,876) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994630
[3380957:MainThread](2024-04-25 20:14:43,877) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:14:43,877) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:46,251) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:46,477) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993463
[3380957:MainThread](2024-04-25 20:14:46,479) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:14:46,479) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:48,865) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:49,094) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995167
[3380957:MainThread](2024-04-25 20:14:49,094) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:14:49,094) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:51,537) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:51,766) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994918
[3380957:MainThread](2024-04-25 20:14:51,766) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:14:51,767) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:54,184) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:54,415) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993763
[3380957:MainThread](2024-04-25 20:14:54,415) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:14:54,415) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:56,814) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:57,043) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994489
[3380957:MainThread](2024-04-25 20:14:57,044) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:14:57,044) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:14:59,442) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:14:59,669) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996198
[3380957:MainThread](2024-04-25 20:14:59,669) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:14:59,669) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:15:02,071) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:15:02,301) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.997143
[3380957:MainThread](2024-04-25 20:15:02,301) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:15:02,301) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:15:04,707) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:15:04,935) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994668
[3380957:MainThread](2024-04-25 20:15:04,936) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:15:04,936) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:15:07,353) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:15:07,583) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996287
[3380957:MainThread](2024-04-25 20:15:07,584) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:15:07,584) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993463 @ 14
[3380957:MainThread](2024-04-25 20:15:07,635) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-04-06 SH600000    0.026632
           SH600008   -0.165765
           SH600009   -0.082409
           SH600010    0.029133
           SH600015    0.020068
[3380957:MainThread](2024-04-25 20:15:09,371) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:   9%|▉         | 4/44 [04:48<48:46, 73.17s/it][3380957:MainThread](2024-04-25 20:15:09,381) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:15:09,395) INFO - qlib.workflow - [recorder.py:341] - Recorder 8623c18c37054f69aefa6f3c5d8e6605 starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:15:10,269) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:15:10,270) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:15:10,273) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:15:10,273) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:15:18,014) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.008649
            SH600004      1.008649
            SH600006      1.008649
            SH600007      1.008649
            SH600008      1.008649
                            ...   
2015-05-05  SZ300070      1.864348
            SZ300124      1.864348
            SZ300133      1.864348
            SZ300146      1.864348
            SZ300251      1.864348
Length: 500679, dtype: float64
[3380957:MainThread](2024-04-25 20:15:18,017) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:15:18,017) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:15:18,017) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:15:20,760) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:15:20,960) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996132
[3380957:MainThread](2024-04-25 20:15:20,961) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:15:20,961) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:15:23,353) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:15:23,553) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995890
[3380957:MainThread](2024-04-25 20:15:23,554) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:15:23,554) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:15:25,925) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:15:26,125) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996853
[3380957:MainThread](2024-04-25 20:15:26,125) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:15:26,125) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:15:28,545) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:15:28,744) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995964
[3380957:MainThread](2024-04-25 20:15:28,745) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:15:28,745) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:15:31,221) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:15:31,424) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994923
[3380957:MainThread](2024-04-25 20:15:31,425) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:15:31,425) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:15:33,983) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:15:34,190) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994650
[3380957:MainThread](2024-04-25 20:15:34,191) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:15:34,191) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:15:36,808) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:15:37,010) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995165
[3380957:MainThread](2024-04-25 20:15:37,010) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:15:37,011) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:15:39,500) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:15:39,709) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995228
[3380957:MainThread](2024-04-25 20:15:39,710) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:15:39,711) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:15:42,228) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:15:42,431) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996659
[3380957:MainThread](2024-04-25 20:15:42,431) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:15:42,432) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:15:44,944) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:15:45,146) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994113
[3380957:MainThread](2024-04-25 20:15:45,147) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:15:45,148) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:15:47,719) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:15:47,982) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995589
[3380957:MainThread](2024-04-25 20:15:47,982) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:15:47,983) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:15:50,662) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:15:50,860) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994805
[3380957:MainThread](2024-04-25 20:15:50,860) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:15:50,861) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:15:53,235) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:15:53,435) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994548
[3380957:MainThread](2024-04-25 20:15:53,435) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:15:53,435) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:15:55,897) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:15:56,101) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995169
[3380957:MainThread](2024-04-25 20:15:56,102) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:15:56,102) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:15:58,592) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:15:58,793) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993789
[3380957:MainThread](2024-04-25 20:15:58,794) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:15:58,795) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:16:01,297) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:16:01,499) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996718
[3380957:MainThread](2024-04-25 20:16:01,499) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:16:01,499) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:16:03,980) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:16:04,185) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995576
[3380957:MainThread](2024-04-25 20:16:04,185) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:16:04,185) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:16:06,629) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:16:06,828) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994227
[3380957:MainThread](2024-04-25 20:16:06,829) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:16:06,829) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:16:09,236) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:16:09,434) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994568
[3380957:MainThread](2024-04-25 20:16:09,435) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:16:09,435) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:16:11,847) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:16:12,046) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995439
[3380957:MainThread](2024-04-25 20:16:12,047) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:16:12,047) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:16:14,461) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:16:14,660) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994915
[3380957:MainThread](2024-04-25 20:16:14,661) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:16:14,661) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:16:17,048) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:16:17,248) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995349
[3380957:MainThread](2024-04-25 20:16:17,248) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:16:17,248) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:16:19,660) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:16:19,861) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995290
[3380957:MainThread](2024-04-25 20:16:19,861) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:16:19,861) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993789 @ 14
[3380957:MainThread](2024-04-25 20:16:19,911) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-05-05 SH600000   -0.068874
           SH600008   -0.065319
           SH600009   -0.249284
           SH600010   -0.070230
           SH600015   -0.084298
[3380957:MainThread](2024-04-25 20:16:21,625) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  11%|█▏        | 5/44 [06:00<47:20, 72.84s/it][3380957:MainThread](2024-04-25 20:16:21,636) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:16:21,649) INFO - qlib.workflow - [recorder.py:341] - Recorder 713f24c3b1244fcc93c45d906094ea01 starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:16:22,527) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:16:22,527) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:16:22,529) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:16:22,530) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:16:30,162) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.561275
            SH600004      0.561275
            SH600006      0.561275
            SH600007      0.561275
            SH600008      0.561275
                            ...   
2015-06-02  SZ300070      0.735789
            SZ300124      0.735789
            SZ300133      0.735789
            SZ300146      0.735789
            SZ300251      0.735789
Length: 506316, dtype: float64
[3380957:MainThread](2024-04-25 20:16:30,165) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:16:30,165) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:16:30,165) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:16:32,619) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:16:32,827) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995615
[3380957:MainThread](2024-04-25 20:16:32,828) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:16:32,828) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:16:35,267) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:16:35,473) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995500
[3380957:MainThread](2024-04-25 20:16:35,474) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:16:35,474) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:16:37,905) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:16:38,112) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994939
[3380957:MainThread](2024-04-25 20:16:38,113) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:16:38,113) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:16:40,570) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:16:40,774) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995076
[3380957:MainThread](2024-04-25 20:16:40,775) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:16:40,775) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:16:43,234) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:16:43,440) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995196
[3380957:MainThread](2024-04-25 20:16:43,440) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:16:43,441) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:16:45,882) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:16:46,086) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996085
[3380957:MainThread](2024-04-25 20:16:46,087) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:16:46,087) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:16:48,569) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:16:48,775) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996237
[3380957:MainThread](2024-04-25 20:16:48,775) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:16:48,776) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:16:51,207) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:16:51,412) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994417
[3380957:MainThread](2024-04-25 20:16:51,413) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:16:51,413) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:16:53,847) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:16:54,052) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995082
[3380957:MainThread](2024-04-25 20:16:54,053) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:16:54,053) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:16:56,424) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:16:56,629) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994701
[3380957:MainThread](2024-04-25 20:16:56,630) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:16:56,630) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:16:59,098) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:16:59,303) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993505
[3380957:MainThread](2024-04-25 20:16:59,304) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:16:59,304) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:17:01,744) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:17:01,955) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994592
[3380957:MainThread](2024-04-25 20:17:01,955) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:17:01,956) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:17:04,330) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:17:04,536) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995243
[3380957:MainThread](2024-04-25 20:17:04,536) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:17:04,536) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:17:07,020) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:17:07,226) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994664
[3380957:MainThread](2024-04-25 20:17:07,226) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:17:07,227) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:17:09,712) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:17:09,916) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994180
[3380957:MainThread](2024-04-25 20:17:09,917) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:17:09,917) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:17:12,379) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:17:12,586) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994439
[3380957:MainThread](2024-04-25 20:17:12,586) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:17:12,586) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:17:15,057) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:17:15,264) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994982
[3380957:MainThread](2024-04-25 20:17:15,264) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:17:15,264) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:17:17,727) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:17:17,934) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995372
[3380957:MainThread](2024-04-25 20:17:17,935) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:17:17,935) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:17:20,467) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:17:20,673) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995292
[3380957:MainThread](2024-04-25 20:17:20,673) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:17:20,673) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.993505 @ 10
[3380957:MainThread](2024-04-25 20:17:20,726) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-06-06 SH600000   -0.012101
           SH600008   -0.035304
           SH600009    0.003530
           SH600010   -0.022068
           SH600015   -0.014280
[3380957:MainThread](2024-04-25 20:17:22,479) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  14%|█▎        | 6/44 [07:01<43:33, 68.76s/it][3380957:MainThread](2024-04-25 20:17:22,490) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:17:22,503) INFO - qlib.workflow - [recorder.py:341] - Recorder 1b7edc9ec02f4b398be89f86bb7c22f0 starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:17:23,359) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:17:23,360) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:17:23,363) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:17:23,364) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:17:31,186) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.767348
            SH600004      1.767348
            SH600006      1.767348
            SH600007      1.767348
            SH600008      1.767348
                            ...   
2015-07-10  SZ300059      1.510424
            SZ300070      1.510424
            SZ300104      1.510424
            SZ300124      1.510424
            SZ300146      1.510424
Length: 511531, dtype: float64
[3380957:MainThread](2024-04-25 20:17:31,188) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:17:31,189) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:17:31,189) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:17:33,676) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:17:33,928) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995614
[3380957:MainThread](2024-04-25 20:17:33,929) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:17:33,929) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:17:36,341) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:17:36,574) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995114
[3380957:MainThread](2024-04-25 20:17:36,575) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:17:36,575) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:17:39,059) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:17:39,290) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993634
[3380957:MainThread](2024-04-25 20:17:39,291) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:17:39,291) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:17:41,768) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:17:41,998) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994476
[3380957:MainThread](2024-04-25 20:17:41,999) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:17:41,999) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:17:44,464) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:17:44,692) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993114
[3380957:MainThread](2024-04-25 20:17:44,693) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:17:44,694) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:17:47,194) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:17:47,421) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992854
[3380957:MainThread](2024-04-25 20:17:47,422) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:17:47,422) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:17:49,946) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:17:50,176) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993667
[3380957:MainThread](2024-04-25 20:17:50,177) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:17:50,177) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:17:52,657) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:17:52,887) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992442
[3380957:MainThread](2024-04-25 20:17:52,888) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:17:52,888) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:17:55,388) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:17:55,647) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992001
[3380957:MainThread](2024-04-25 20:17:55,649) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:17:55,649) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:17:58,124) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:17:58,355) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991751
[3380957:MainThread](2024-04-25 20:17:58,356) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:17:58,356) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:18:00,822) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:18:01,053) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992802
[3380957:MainThread](2024-04-25 20:18:01,054) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:18:01,054) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:18:03,540) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:18:03,772) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992099
[3380957:MainThread](2024-04-25 20:18:03,772) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:18:03,773) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:18:06,239) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:18:06,470) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991773
[3380957:MainThread](2024-04-25 20:18:06,470) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:18:06,470) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:18:08,949) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:18:09,181) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991611
[3380957:MainThread](2024-04-25 20:18:09,182) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:18:09,182) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:18:11,642) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:18:11,870) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991339
[3380957:MainThread](2024-04-25 20:18:11,871) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:18:11,872) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:18:14,333) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:18:14,563) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991320
[3380957:MainThread](2024-04-25 20:18:14,564) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:18:14,564) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:18:17,040) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:18:17,269) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990714
[3380957:MainThread](2024-04-25 20:18:17,270) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:18:17,270) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:18:19,695) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:18:19,925) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992288
[3380957:MainThread](2024-04-25 20:18:19,925) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:18:19,926) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:18:22,415) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:18:22,644) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991684
[3380957:MainThread](2024-04-25 20:18:22,645) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:18:22,645) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:18:25,175) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:18:25,405) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992525
[3380957:MainThread](2024-04-25 20:18:25,405) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:18:25,405) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:18:27,940) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:18:28,167) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992584
[3380957:MainThread](2024-04-25 20:18:28,168) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:18:28,168) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:18:30,672) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:18:30,903) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991865
[3380957:MainThread](2024-04-25 20:18:30,904) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:18:30,904) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:18:33,413) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:18:33,645) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992268
[3380957:MainThread](2024-04-25 20:18:33,645) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 20:18:33,646) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:18:36,140) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:18:36,372) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992512
[3380957:MainThread](2024-04-25 20:18:36,372) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 20:18:36,372) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:18:38,841) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:18:39,073) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993366
[3380957:MainThread](2024-04-25 20:18:39,073) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:18:39,073) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990714 @ 16
[3380957:MainThread](2024-04-25 20:18:39,414) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-07-04 SH600000    0.037032
           SH600008   -0.080077
           SH600009   -0.016671
           SH600010    0.052490
           SH600015    0.009695
[3380957:MainThread](2024-04-25 20:18:41,154) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  16%|█▌        | 7/44 [08:19<44:24, 72.00s/it][3380957:MainThread](2024-04-25 20:18:41,164) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:18:41,177) INFO - qlib.workflow - [recorder.py:341] - Recorder 07c2f21767024c18ace42e9ef3a17cf3 starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:18:42,010) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:18:42,010) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:18:42,014) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:18:42,014) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:18:49,732) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.031644
            SH600004      1.031644
            SH600006      1.031644
            SH600007      1.031644
            SH600008      1.031644
                            ...   
2015-08-07  SZ300104      1.692057
            SZ300124      1.692057
            SZ300133      1.692057
            SZ300146      1.692057
            SZ300251      1.692057
Length: 516849, dtype: float64
[3380957:MainThread](2024-04-25 20:18:49,734) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:18:49,735) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:18:49,735) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:18:52,224) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:18:52,447) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995482
[3380957:MainThread](2024-04-25 20:18:52,448) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:18:52,448) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:18:54,935) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:18:55,158) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995762
[3380957:MainThread](2024-04-25 20:18:55,159) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:18:55,159) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:18:57,657) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:18:57,884) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994246
[3380957:MainThread](2024-04-25 20:18:57,885) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:18:57,885) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:00,379) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:00,603) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994285
[3380957:MainThread](2024-04-25 20:19:00,603) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:19:00,603) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:03,103) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:03,327) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993323
[3380957:MainThread](2024-04-25 20:19:03,328) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:19:03,329) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:05,888) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:06,114) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993218
[3380957:MainThread](2024-04-25 20:19:06,115) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:19:06,116) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:08,669) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:08,891) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993801
[3380957:MainThread](2024-04-25 20:19:08,892) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:19:08,892) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:11,399) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:11,624) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993544
[3380957:MainThread](2024-04-25 20:19:11,624) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:19:11,625) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:14,184) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:14,408) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993080
[3380957:MainThread](2024-04-25 20:19:14,409) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:19:14,409) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:16,896) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:17,121) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992584
[3380957:MainThread](2024-04-25 20:19:17,122) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:19:17,123) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:19,660) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:19,883) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992447
[3380957:MainThread](2024-04-25 20:19:19,884) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:19:19,884) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:22,356) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:22,581) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992725
[3380957:MainThread](2024-04-25 20:19:22,581) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:19:22,581) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:25,074) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:25,299) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992789
[3380957:MainThread](2024-04-25 20:19:25,299) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:19:25,299) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:27,929) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:28,161) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993429
[3380957:MainThread](2024-04-25 20:19:28,161) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:19:28,161) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:30,850) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:31,082) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992627
[3380957:MainThread](2024-04-25 20:19:31,082) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:19:31,082) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:33,587) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:33,811) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993677
[3380957:MainThread](2024-04-25 20:19:33,811) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:19:33,812) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:36,339) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:36,563) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991880
[3380957:MainThread](2024-04-25 20:19:36,564) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:19:36,564) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:39,165) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:39,392) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992379
[3380957:MainThread](2024-04-25 20:19:39,392) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:19:39,393) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:41,976) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:42,243) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993047
[3380957:MainThread](2024-04-25 20:19:42,243) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:19:42,244) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:45,077) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:45,300) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993725
[3380957:MainThread](2024-04-25 20:19:45,301) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:19:45,301) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:47,669) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:47,893) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992547
[3380957:MainThread](2024-04-25 20:19:47,893) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:19:47,894) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:50,454) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:50,677) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992464
[3380957:MainThread](2024-04-25 20:19:50,678) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:19:50,678) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:53,196) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:53,424) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994899
[3380957:MainThread](2024-04-25 20:19:53,425) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 20:19:53,425) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:55,941) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:56,168) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993237
[3380957:MainThread](2024-04-25 20:19:56,168) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 20:19:56,168) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:19:58,668) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:19:58,895) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994001
[3380957:MainThread](2024-04-25 20:19:58,895) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:19:58,896) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991880 @ 16
[3380957:MainThread](2024-04-25 20:19:59,230) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-08-01 SH600000    0.008617
           SH600008    0.008924
           SH600009   -0.012139
           SH600010   -0.051182
           SH600015   -0.071030
[3380957:MainThread](2024-04-25 20:20:00,964) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  18%|█▊        | 8/44 [09:39<44:41, 74.49s/it][3380957:MainThread](2024-04-25 20:20:00,974) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:20:00,987) INFO - qlib.workflow - [recorder.py:341] - Recorder 8ae6d697f5524c50a696fd98ed358f05 starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:20:01,953) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:20:01,954) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:20:01,957) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:20:01,957) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:20:11,048) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.439628
            SH600004      1.439628
            SH600006      1.439628
            SH600007      1.439628
            SH600008      1.439628
                            ...   
2015-09-08  SZ300104      1.791058
            SZ300124      1.791058
            SZ300133      1.791058
            SZ300146      1.791058
            SZ300251      1.791058
Length: 522220, dtype: float64
[3380957:MainThread](2024-04-25 20:20:11,051) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:20:11,051) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:20:11,052) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:20:13,676) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:20:13,865) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995489
[3380957:MainThread](2024-04-25 20:20:13,866) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:20:13,866) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:20:16,436) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:20:16,626) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994052
[3380957:MainThread](2024-04-25 20:20:16,627) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:20:16,627) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:20:19,194) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:20:19,384) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993493
[3380957:MainThread](2024-04-25 20:20:19,385) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:20:19,385) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:20:21,949) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:20:22,140) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993596
[3380957:MainThread](2024-04-25 20:20:22,141) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:20:22,141) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:20:24,695) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:20:24,886) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993837
[3380957:MainThread](2024-04-25 20:20:24,886) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:20:24,886) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:20:27,453) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:20:27,643) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993098
[3380957:MainThread](2024-04-25 20:20:27,644) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:20:27,645) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:20:30,194) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:20:30,386) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992931
[3380957:MainThread](2024-04-25 20:20:30,387) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:20:30,387) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:20:32,965) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:20:33,156) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993253
[3380957:MainThread](2024-04-25 20:20:33,156) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:20:33,156) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:20:35,752) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:20:35,941) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993605
[3380957:MainThread](2024-04-25 20:20:35,941) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:20:35,942) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:20:38,521) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:20:38,711) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992552
[3380957:MainThread](2024-04-25 20:20:38,713) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:20:38,713) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:20:41,247) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:20:41,437) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992474
[3380957:MainThread](2024-04-25 20:20:41,438) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:20:41,438) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:20:43,976) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:20:44,166) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992500
[3380957:MainThread](2024-04-25 20:20:44,166) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:20:44,167) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:20:46,710) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:20:46,900) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991678
[3380957:MainThread](2024-04-25 20:20:46,901) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:20:46,901) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:20:49,448) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:20:49,639) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991948
[3380957:MainThread](2024-04-25 20:20:49,639) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:20:49,639) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:20:52,182) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:20:52,372) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992639
[3380957:MainThread](2024-04-25 20:20:52,373) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:20:52,373) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:20:54,920) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:20:55,110) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992603
[3380957:MainThread](2024-04-25 20:20:55,110) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:20:55,110) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:20:57,684) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:20:57,874) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991096
[3380957:MainThread](2024-04-25 20:20:57,875) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:20:57,875) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:21:00,452) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:21:00,643) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991862
[3380957:MainThread](2024-04-25 20:21:00,644) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:21:00,644) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:21:03,219) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:21:03,410) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991707
[3380957:MainThread](2024-04-25 20:21:03,411) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:21:03,411) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:21:06,020) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:21:06,211) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991520
[3380957:MainThread](2024-04-25 20:21:06,211) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:21:06,211) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:21:08,828) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:21:09,018) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992134
[3380957:MainThread](2024-04-25 20:21:09,019) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:21:09,019) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:21:11,629) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:21:11,820) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992106
[3380957:MainThread](2024-04-25 20:21:11,820) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:21:11,821) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:21:14,386) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:21:14,578) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992486
[3380957:MainThread](2024-04-25 20:21:14,579) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 20:21:14,579) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:21:17,205) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:21:17,397) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992494
[3380957:MainThread](2024-04-25 20:21:17,398) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 20:21:17,398) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:21:20,045) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:21:20,236) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994189
[3380957:MainThread](2024-04-25 20:21:20,236) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:21:20,236) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991096 @ 16
[3380957:MainThread](2024-04-25 20:21:20,606) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-08-29 SH600000   -0.056916
           SH600008   -0.015037
           SH600009    0.165226
           SH600010   -0.197947
           SH600015   -0.041262
[3380957:MainThread](2024-04-25 20:21:22,322) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  20%|██        | 9/44 [11:01<44:42, 76.64s/it][3380957:MainThread](2024-04-25 20:21:22,333) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:21:22,346) INFO - qlib.workflow - [recorder.py:341] - Recorder 5b6ddb53964e407f88d755f142bd488b starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:21:23,220) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:21:23,221) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:21:23,223) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:21:23,223) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:21:30,998) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.322097
            SH600004      1.322097
            SH600006      1.322097
            SH600007      1.322097
            SH600008      1.322097
                            ...   
2015-10-13  SZ300104      1.789253
            SZ300124      1.789253
            SZ300133      1.789253
            SZ300146      1.789253
            SZ300251      1.789253
Length: 527673, dtype: float64
[3380957:MainThread](2024-04-25 20:21:31,001) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:21:31,001) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:21:31,001) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:21:33,635) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:21:33,862) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995217
[3380957:MainThread](2024-04-25 20:21:33,863) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:21:33,864) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:21:36,474) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:21:36,698) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994224
[3380957:MainThread](2024-04-25 20:21:36,699) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:21:36,699) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:21:39,314) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:21:39,540) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993518
[3380957:MainThread](2024-04-25 20:21:39,541) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:21:39,541) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:21:42,168) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:21:42,393) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993512
[3380957:MainThread](2024-04-25 20:21:42,394) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:21:42,394) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:21:44,981) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:21:45,207) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992897
[3380957:MainThread](2024-04-25 20:21:45,208) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:21:45,209) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:21:47,842) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:21:48,066) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992562
[3380957:MainThread](2024-04-25 20:21:48,067) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:21:48,068) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:21:50,710) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:21:50,934) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992230
[3380957:MainThread](2024-04-25 20:21:50,935) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:21:50,935) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:21:53,564) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:21:53,790) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991888
[3380957:MainThread](2024-04-25 20:21:53,792) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:21:53,792) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:21:56,429) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:21:56,655) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992219
[3380957:MainThread](2024-04-25 20:21:56,655) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:21:56,655) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:21:59,222) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:21:59,445) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991665
[3380957:MainThread](2024-04-25 20:21:59,446) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:21:59,446) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:22:02,020) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:22:02,243) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991631
[3380957:MainThread](2024-04-25 20:22:02,244) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:22:02,244) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:22:04,811) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:22:05,034) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993458
[3380957:MainThread](2024-04-25 20:22:05,035) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:22:05,035) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:22:07,620) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:22:07,846) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992682
[3380957:MainThread](2024-04-25 20:22:07,847) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:22:07,847) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:22:10,426) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:22:10,651) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991418
[3380957:MainThread](2024-04-25 20:22:10,652) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:22:10,652) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:22:13,245) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:22:13,472) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990895
[3380957:MainThread](2024-04-25 20:22:13,474) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:22:13,474) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:22:16,045) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:22:16,269) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990998
[3380957:MainThread](2024-04-25 20:22:16,270) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:22:16,270) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:22:18,823) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:22:19,047) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991511
[3380957:MainThread](2024-04-25 20:22:19,047) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:22:19,048) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:22:21,671) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:22:21,896) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991049
[3380957:MainThread](2024-04-25 20:22:21,897) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:22:21,897) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:22:24,534) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:22:24,759) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990863
[3380957:MainThread](2024-04-25 20:22:24,760) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:22:24,761) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:22:27,347) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:22:27,575) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990712
[3380957:MainThread](2024-04-25 20:22:27,576) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:22:27,576) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:22:30,193) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:22:30,419) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991219
[3380957:MainThread](2024-04-25 20:22:30,420) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:22:30,420) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:22:33,054) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:22:33,278) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991722
[3380957:MainThread](2024-04-25 20:22:33,278) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:22:33,278) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:22:35,895) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:22:36,121) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991530
[3380957:MainThread](2024-04-25 20:22:36,121) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 20:22:36,122) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:22:38,711) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:22:38,936) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991311
[3380957:MainThread](2024-04-25 20:22:38,936) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 20:22:38,937) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:22:41,568) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:22:41,795) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991416
[3380957:MainThread](2024-04-25 20:22:41,796) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 20:22:41,796) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:22:44,430) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:22:44,656) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991080
[3380957:MainThread](2024-04-25 20:22:44,656) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 20:22:44,657) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:22:47,284) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:22:47,512) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991909
[3380957:MainThread](2024-04-25 20:22:47,513) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[3380957:MainThread](2024-04-25 20:22:47,513) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:22:50,066) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:22:50,292) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992046
[3380957:MainThread](2024-04-25 20:22:50,293) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:22:50,293) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990712 @ 19
[3380957:MainThread](2024-04-25 20:22:50,669) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-09-26 SH600000    0.056026
           SH600008   -0.130928
           SH600009   -0.050797
           SH600010   -0.030685
           SH600015    0.031468
[3380957:MainThread](2024-04-25 20:22:52,394) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  23%|██▎       | 10/44 [12:31<45:46, 80.78s/it][3380957:MainThread](2024-04-25 20:22:52,405) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:22:52,418) INFO - qlib.workflow - [recorder.py:341] - Recorder b46ea8b608304696a6a731ae5edc67e3 starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:22:53,305) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:22:53,306) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:22:53,308) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:22:53,308) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:23:01,069) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.466939
            SH600004      1.466939
            SH600006      1.466939
            SH600007      1.466939
            SH600008      1.466939
                            ...   
2015-11-19  SZ300104      1.883372
            SZ300124      1.883372
            SZ300133      1.883372
            SZ300146      1.883372
            SZ300251      1.883372
Length: 533252, dtype: float64
[3380957:MainThread](2024-04-25 20:23:01,071) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:23:01,071) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:23:01,072) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:03,737) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:03,964) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995255
[3380957:MainThread](2024-04-25 20:23:03,965) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:23:03,965) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:06,589) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:06,817) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994855
[3380957:MainThread](2024-04-25 20:23:06,818) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:23:06,818) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:09,479) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:09,708) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994292
[3380957:MainThread](2024-04-25 20:23:09,709) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:23:09,709) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:12,380) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:12,608) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993059
[3380957:MainThread](2024-04-25 20:23:12,609) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:23:12,609) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:15,213) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:15,441) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993101
[3380957:MainThread](2024-04-25 20:23:15,442) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:23:15,442) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:18,014) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:18,243) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993457
[3380957:MainThread](2024-04-25 20:23:18,243) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:23:18,244) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:20,824) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:21,053) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992491
[3380957:MainThread](2024-04-25 20:23:21,054) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:23:21,054) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:23,684) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:23,912) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992160
[3380957:MainThread](2024-04-25 20:23:23,913) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:23:23,914) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:26,504) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:26,739) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992442
[3380957:MainThread](2024-04-25 20:23:26,740) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:23:26,740) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:29,365) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:29,597) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992056
[3380957:MainThread](2024-04-25 20:23:29,598) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:23:29,598) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:32,362) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:32,597) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991976
[3380957:MainThread](2024-04-25 20:23:32,598) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:23:32,598) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:35,360) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:35,589) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991802
[3380957:MainThread](2024-04-25 20:23:35,590) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:23:35,590) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:38,291) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:38,519) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992109
[3380957:MainThread](2024-04-25 20:23:38,519) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:23:38,520) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:41,221) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:41,451) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991765
[3380957:MainThread](2024-04-25 20:23:41,452) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:23:41,452) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:44,156) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:44,388) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991717
[3380957:MainThread](2024-04-25 20:23:44,389) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:23:44,390) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:47,270) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:47,573) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991253
[3380957:MainThread](2024-04-25 20:23:47,575) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:23:47,576) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:50,180) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:50,406) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991728
[3380957:MainThread](2024-04-25 20:23:50,406) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:23:50,407) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:52,931) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:53,160) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991235
[3380957:MainThread](2024-04-25 20:23:53,161) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:23:53,162) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:55,689) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:55,917) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991745
[3380957:MainThread](2024-04-25 20:23:55,917) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:23:55,917) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:23:58,442) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:23:58,671) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991262
[3380957:MainThread](2024-04-25 20:23:58,671) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:23:58,672) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:24:01,177) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:24:01,403) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992009
[3380957:MainThread](2024-04-25 20:24:01,404) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:24:01,404) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:24:04,013) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:24:04,241) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991977
[3380957:MainThread](2024-04-25 20:24:04,241) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:24:04,241) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:24:06,893) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:24:07,120) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991766
[3380957:MainThread](2024-04-25 20:24:07,121) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 20:24:07,121) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:24:09,783) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:24:10,011) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990909
[3380957:MainThread](2024-04-25 20:24:10,012) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 20:24:10,012) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:24:12,682) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:24:12,911) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992300
[3380957:MainThread](2024-04-25 20:24:12,911) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 20:24:12,911) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:24:15,555) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:24:15,782) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991099
[3380957:MainThread](2024-04-25 20:24:15,783) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 20:24:15,783) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:24:18,453) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:24:18,680) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993073
[3380957:MainThread](2024-04-25 20:24:18,681) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[3380957:MainThread](2024-04-25 20:24:18,681) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:24:21,399) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:24:21,629) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991814
[3380957:MainThread](2024-04-25 20:24:21,629) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[3380957:MainThread](2024-04-25 20:24:21,630) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:24:24,224) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:24:24,450) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992288
[3380957:MainThread](2024-04-25 20:24:24,451) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[3380957:MainThread](2024-04-25 20:24:24,451) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:24:27,047) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:24:27,275) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992964
[3380957:MainThread](2024-04-25 20:24:27,276) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch30:
[3380957:MainThread](2024-04-25 20:24:27,276) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:24:29,871) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:24:30,098) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993125
[3380957:MainThread](2024-04-25 20:24:30,098) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch31:
[3380957:MainThread](2024-04-25 20:24:30,098) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:24:32,696) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:24:32,924) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993885
[3380957:MainThread](2024-04-25 20:24:32,924) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:24:32,924) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990909 @ 23
[3380957:MainThread](2024-04-25 20:24:33,256) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-10-31 SH600000   -0.063414
           SH600008   -0.091903
           SH600009    0.200514
           SH600010    0.013121
           SH600015   -0.073231
[3380957:MainThread](2024-04-25 20:24:34,989) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  25%|██▌       | 11/44 [14:13<48:06, 87.46s/it][3380957:MainThread](2024-04-25 20:24:34,999) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:24:35,013) INFO - qlib.workflow - [recorder.py:341] - Recorder 1c6c3ab8e9184886982038fe334cb960 starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:24:35,843) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:24:35,843) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:24:35,847) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:24:35,847) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:24:43,592) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.071155
            SH600004      1.071155
            SH600006      1.071155
            SH600007      1.071155
            SH600008      1.071155
                            ...   
2015-12-17  SZ300133      1.984742
            SZ300144      1.984742
            SZ300146      1.984742
            SZ300251      1.984742
            SZ300315      1.984742
Length: 538891, dtype: float64
[3380957:MainThread](2024-04-25 20:24:43,594) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:24:43,594) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:24:43,595) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:24:46,201) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:24:46,430) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995954
[3380957:MainThread](2024-04-25 20:24:46,431) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:24:46,431) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:24:48,975) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:24:49,204) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995057
[3380957:MainThread](2024-04-25 20:24:49,205) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:24:49,205) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:24:51,669) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:24:51,895) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994144
[3380957:MainThread](2024-04-25 20:24:51,896) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:24:51,896) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:24:54,345) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:24:54,571) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994290
[3380957:MainThread](2024-04-25 20:24:54,571) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:24:54,571) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:24:57,032) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:24:57,257) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993639
[3380957:MainThread](2024-04-25 20:24:57,258) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:24:57,258) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:24:59,766) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:24:59,991) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993265
[3380957:MainThread](2024-04-25 20:24:59,992) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:24:59,993) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:02,499) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:02,724) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993361
[3380957:MainThread](2024-04-25 20:25:02,725) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:25:02,725) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:05,244) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:05,468) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993072
[3380957:MainThread](2024-04-25 20:25:05,469) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:25:05,470) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:07,995) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:08,222) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992677
[3380957:MainThread](2024-04-25 20:25:08,223) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:25:08,223) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:10,747) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:10,972) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992480
[3380957:MainThread](2024-04-25 20:25:10,973) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:25:10,973) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:13,505) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:13,729) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992659
[3380957:MainThread](2024-04-25 20:25:13,730) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:25:13,730) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:16,253) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:16,479) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992496
[3380957:MainThread](2024-04-25 20:25:16,479) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:25:16,479) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:19,012) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:19,241) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991704
[3380957:MainThread](2024-04-25 20:25:19,242) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:25:19,242) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:21,805) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:22,031) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992200
[3380957:MainThread](2024-04-25 20:25:22,031) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:25:22,032) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:24,579) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:24,808) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991970
[3380957:MainThread](2024-04-25 20:25:24,808) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:25:24,808) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:27,343) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:27,568) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991310
[3380957:MainThread](2024-04-25 20:25:27,569) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:25:27,570) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:30,093) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:30,319) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991334
[3380957:MainThread](2024-04-25 20:25:30,319) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:25:30,320) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:32,841) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:33,067) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992315
[3380957:MainThread](2024-04-25 20:25:33,067) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:25:33,068) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:35,587) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:35,812) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991642
[3380957:MainThread](2024-04-25 20:25:35,813) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:25:35,813) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:38,334) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:38,559) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991090
[3380957:MainThread](2024-04-25 20:25:38,560) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:25:38,561) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:41,085) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:41,309) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991671
[3380957:MainThread](2024-04-25 20:25:41,310) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:25:41,310) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:43,818) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:44,045) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991972
[3380957:MainThread](2024-04-25 20:25:44,045) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:25:44,045) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:46,553) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:46,778) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992304
[3380957:MainThread](2024-04-25 20:25:46,779) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 20:25:46,779) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:49,289) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:49,512) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992250
[3380957:MainThread](2024-04-25 20:25:49,513) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 20:25:49,513) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:52,025) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:52,251) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991986
[3380957:MainThread](2024-04-25 20:25:52,252) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 20:25:52,252) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:54,759) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:54,984) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991970
[3380957:MainThread](2024-04-25 20:25:54,985) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 20:25:54,985) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:25:57,490) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:25:57,716) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991648
[3380957:MainThread](2024-04-25 20:25:57,716) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[3380957:MainThread](2024-04-25 20:25:57,716) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:26:00,241) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:26:00,467) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992304
[3380957:MainThread](2024-04-25 20:26:00,467) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:26:00,468) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991090 @ 19
[3380957:MainThread](2024-04-25 20:26:00,639) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-11-28 SH600000   -0.033894
           SH600008   -0.074546
           SH600009    0.046735
           SH600010   -0.002046
           SH600015   -0.003936
[3380957:MainThread](2024-04-25 20:26:02,344) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  27%|██▋       | 12/44 [15:41<46:37, 87.43s/it][3380957:MainThread](2024-04-25 20:26:02,354) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:26:02,367) INFO - qlib.workflow - [recorder.py:341] - Recorder bb2b007fdb58474580ba34cf9a32e313 starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:26:03,196) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:26:03,197) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:26:03,199) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:26:03,200) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:26:10,779) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.602882
            SH600004      1.602882
            SH600006      1.602882
            SH600007      1.602882
            SH600008      1.602882
                            ...   
2016-01-15  SZ300133      1.050757
            SZ300144      1.050757
            SZ300146      1.050757
            SZ300251      1.050757
            SZ300315      1.050757
Length: 544436, dtype: float64
[3380957:MainThread](2024-04-25 20:26:10,781) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:26:10,782) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:26:10,782) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:26:13,389) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:26:13,612) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995816
[3380957:MainThread](2024-04-25 20:26:13,613) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:26:13,613) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:26:16,229) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:26:16,454) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995828
[3380957:MainThread](2024-04-25 20:26:16,454) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:26:16,454) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:26:19,023) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:26:19,250) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994237
[3380957:MainThread](2024-04-25 20:26:19,251) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:26:19,251) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:26:21,754) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:26:21,982) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994197
[3380957:MainThread](2024-04-25 20:26:21,983) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:26:21,983) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:26:24,490) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:26:24,717) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994853
[3380957:MainThread](2024-04-25 20:26:24,717) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:26:24,718) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:26:27,222) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:26:27,449) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992543
[3380957:MainThread](2024-04-25 20:26:27,450) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:26:27,450) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:26:29,957) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:26:30,185) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993099
[3380957:MainThread](2024-04-25 20:26:30,185) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:26:30,185) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:26:32,729) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:26:32,956) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993018
[3380957:MainThread](2024-04-25 20:26:32,956) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:26:32,957) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:26:35,529) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:26:35,756) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992566
[3380957:MainThread](2024-04-25 20:26:35,756) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:26:35,756) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:26:38,338) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:26:38,562) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992264
[3380957:MainThread](2024-04-25 20:26:38,564) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:26:38,564) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:26:41,188) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:26:41,418) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992022
[3380957:MainThread](2024-04-25 20:26:41,419) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:26:41,419) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:26:43,991) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:26:44,215) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991393
[3380957:MainThread](2024-04-25 20:26:44,216) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:26:44,216) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:26:46,783) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:26:47,010) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991409
[3380957:MainThread](2024-04-25 20:26:47,010) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:26:47,011) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:26:49,562) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:26:49,786) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992603
[3380957:MainThread](2024-04-25 20:26:49,787) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:26:49,787) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:26:52,329) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:26:52,553) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991979
[3380957:MainThread](2024-04-25 20:26:52,554) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:26:52,554) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:26:55,098) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:26:55,323) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991077
[3380957:MainThread](2024-04-25 20:26:55,324) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:26:55,324) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:26:57,870) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:26:58,094) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991509
[3380957:MainThread](2024-04-25 20:26:58,095) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:26:58,095) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:27:00,651) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:27:00,875) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991029
[3380957:MainThread](2024-04-25 20:27:00,876) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:27:00,876) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:27:03,420) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:27:03,644) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990480
[3380957:MainThread](2024-04-25 20:27:03,645) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:27:03,646) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:27:06,177) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:27:06,401) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991154
[3380957:MainThread](2024-04-25 20:27:06,401) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:27:06,401) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:27:08,951) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:27:09,173) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992343
[3380957:MainThread](2024-04-25 20:27:09,174) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:27:09,174) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:27:11,780) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:27:12,005) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991235
[3380957:MainThread](2024-04-25 20:27:12,005) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:27:12,006) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:27:14,610) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:27:14,834) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991828
[3380957:MainThread](2024-04-25 20:27:14,835) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 20:27:14,835) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:27:17,401) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:27:17,628) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992111
[3380957:MainThread](2024-04-25 20:27:17,628) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 20:27:17,629) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:27:20,197) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:27:20,424) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994353
[3380957:MainThread](2024-04-25 20:27:20,424) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 20:27:20,425) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:27:22,997) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:27:23,225) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991576
[3380957:MainThread](2024-04-25 20:27:23,225) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 20:27:23,225) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:27:25,799) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:27:26,027) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992096
[3380957:MainThread](2024-04-25 20:27:26,028) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:27:26,028) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990480 @ 18
[3380957:MainThread](2024-04-25 20:27:26,078) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2017-12-26 SH600000   -0.008732
           SH600008    0.127501
           SH600009    0.042241
           SH600010   -0.009177
           SH600011    0.026957
[3380957:MainThread](2024-04-25 20:27:27,817) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  30%|██▉       | 13/44 [17:06<44:51, 86.84s/it][3380957:MainThread](2024-04-25 20:27:27,827) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:27:27,840) INFO - qlib.workflow - [recorder.py:341] - Recorder 58e77c5666b2465aad421349b5fbdd33 starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:27:28,657) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:27:28,658) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:27:28,660) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:27:28,661) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:27:36,421) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.744752
            SH600004      0.744752
            SH600006      0.744752
            SH600007      0.744752
            SH600008      0.744752
                            ...   
2016-03-16  SZ300133      1.470204
            SZ300144      1.470204
            SZ300146      1.470204
            SZ300251      1.470204
            SZ300315      1.470204
Length: 550075, dtype: float64
[3380957:MainThread](2024-04-25 20:27:36,424) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:27:36,424) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:27:36,424) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:27:39,266) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:27:39,455) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995989
[3380957:MainThread](2024-04-25 20:27:39,457) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:27:39,457) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:27:42,045) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:27:42,233) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994555
[3380957:MainThread](2024-04-25 20:27:42,234) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:27:42,235) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:27:44,822) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:27:45,011) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994277
[3380957:MainThread](2024-04-25 20:27:45,012) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:27:45,012) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:27:47,600) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:27:47,789) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994006
[3380957:MainThread](2024-04-25 20:27:47,790) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:27:47,790) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:27:50,383) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:27:50,570) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993980
[3380957:MainThread](2024-04-25 20:27:50,571) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:27:50,572) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:27:53,159) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:27:53,347) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993312
[3380957:MainThread](2024-04-25 20:27:53,348) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:27:53,348) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:27:55,942) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:27:56,131) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993287
[3380957:MainThread](2024-04-25 20:27:56,132) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:27:56,133) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:27:58,742) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:27:58,931) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993096
[3380957:MainThread](2024-04-25 20:27:58,932) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:27:58,932) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:01,565) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:01,754) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992460
[3380957:MainThread](2024-04-25 20:28:01,755) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:28:01,756) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:04,383) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:04,572) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992534
[3380957:MainThread](2024-04-25 20:28:04,572) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:28:04,572) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:07,190) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:07,379) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991854
[3380957:MainThread](2024-04-25 20:28:07,380) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:28:07,381) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:10,010) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:10,200) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991843
[3380957:MainThread](2024-04-25 20:28:10,201) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:28:10,201) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:12,820) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:13,009) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991264
[3380957:MainThread](2024-04-25 20:28:13,010) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:28:13,010) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:15,607) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:15,797) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992425
[3380957:MainThread](2024-04-25 20:28:15,797) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:28:15,797) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:18,366) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:18,555) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990989
[3380957:MainThread](2024-04-25 20:28:18,556) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:28:18,557) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:21,101) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:21,289) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991404
[3380957:MainThread](2024-04-25 20:28:21,290) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:28:21,290) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:23,848) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:24,036) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990958
[3380957:MainThread](2024-04-25 20:28:24,037) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:28:24,038) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:26,609) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:26,798) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990979
[3380957:MainThread](2024-04-25 20:28:26,798) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:28:26,799) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:29,342) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:29,531) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991349
[3380957:MainThread](2024-04-25 20:28:29,531) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:28:29,532) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:32,134) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:32,322) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991418
[3380957:MainThread](2024-04-25 20:28:32,323) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:28:32,323) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:34,967) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:35,155) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991980
[3380957:MainThread](2024-04-25 20:28:35,156) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:28:35,156) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:37,711) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:37,899) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990457
[3380957:MainThread](2024-04-25 20:28:37,900) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:28:37,901) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:40,485) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:40,674) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991082
[3380957:MainThread](2024-04-25 20:28:40,674) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 20:28:40,674) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:43,253) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:43,443) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991259
[3380957:MainThread](2024-04-25 20:28:43,443) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 20:28:43,443) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:46,027) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:46,216) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991587
[3380957:MainThread](2024-04-25 20:28:46,216) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 20:28:46,216) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:48,837) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:49,027) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992137
[3380957:MainThread](2024-04-25 20:28:49,028) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 20:28:49,028) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:51,631) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:51,820) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991769
[3380957:MainThread](2024-04-25 20:28:51,820) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[3380957:MainThread](2024-04-25 20:28:51,820) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:54,482) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:54,672) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992177
[3380957:MainThread](2024-04-25 20:28:54,672) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch28:
[3380957:MainThread](2024-04-25 20:28:54,673) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:28:57,305) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:28:57,494) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991838
[3380957:MainThread](2024-04-25 20:28:57,494) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch29:
[3380957:MainThread](2024-04-25 20:28:57,495) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:29:00,090) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:29:00,279) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993325
[3380957:MainThread](2024-04-25 20:29:00,279) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:29:00,279) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990457 @ 21
[3380957:MainThread](2024-04-25 20:29:00,505) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-01-24 SH600000    0.081564
           SH600008   -0.168478
           SH600009    0.176892
           SH600010    0.007005
           SH600011   -0.011943
[3380957:MainThread](2024-04-25 20:29:02,210) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  32%|███▏      | 14/44 [18:41<44:33, 89.12s/it][3380957:MainThread](2024-04-25 20:29:02,220) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:29:02,233) INFO - qlib.workflow - [recorder.py:341] - Recorder d4eb609632e8406fa8208d22991d3574 starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:29:03,054) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:29:03,054) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:29:03,057) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:29:03,057) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:29:10,647) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.085430
            SH600004      1.085430
            SH600006      1.085430
            SH600007      1.085430
            SH600008      1.085430
                            ...   
2016-04-14  SZ300124      1.939677
            SZ300133      1.939677
            SZ300144      1.939677
            SZ300146      1.939677
            SZ300315      1.939677
Length: 555663, dtype: float64
[3380957:MainThread](2024-04-25 20:29:10,649) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:29:10,650) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:29:10,650) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:29:13,235) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:29:13,422) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995677
[3380957:MainThread](2024-04-25 20:29:13,423) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:29:13,423) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:29:16,042) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:29:16,229) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994366
[3380957:MainThread](2024-04-25 20:29:16,230) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:29:16,231) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:29:18,853) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:29:19,044) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993884
[3380957:MainThread](2024-04-25 20:29:19,045) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:29:19,046) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:29:21,679) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:29:21,867) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993232
[3380957:MainThread](2024-04-25 20:29:21,868) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:29:21,869) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:29:24,508) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:29:24,696) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994512
[3380957:MainThread](2024-04-25 20:29:24,696) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:29:24,696) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:29:27,358) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:29:27,547) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992988
[3380957:MainThread](2024-04-25 20:29:27,548) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:29:27,548) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:29:30,214) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:29:30,402) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992127
[3380957:MainThread](2024-04-25 20:29:30,404) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:29:30,404) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:29:33,109) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:29:33,300) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992242
[3380957:MainThread](2024-04-25 20:29:33,300) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:29:33,301) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:29:36,016) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:29:36,205) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991319
[3380957:MainThread](2024-04-25 20:29:36,206) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:29:36,206) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:29:38,924) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:29:39,113) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991395
[3380957:MainThread](2024-04-25 20:29:39,113) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:29:39,113) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:29:41,797) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:29:41,991) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991674
[3380957:MainThread](2024-04-25 20:29:41,991) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:29:41,991) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:29:44,708) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:29:44,897) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991632
[3380957:MainThread](2024-04-25 20:29:44,898) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:29:44,898) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:29:47,618) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:29:47,808) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991098
[3380957:MainThread](2024-04-25 20:29:47,809) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:29:47,809) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:29:50,516) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:29:50,705) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991293
[3380957:MainThread](2024-04-25 20:29:50,706) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:29:50,706) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:29:53,410) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:29:53,602) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991489
[3380957:MainThread](2024-04-25 20:29:53,603) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:29:53,603) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:29:56,276) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:29:56,472) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991018
[3380957:MainThread](2024-04-25 20:29:56,473) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:29:56,473) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:29:59,167) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:29:59,356) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991819
[3380957:MainThread](2024-04-25 20:29:59,356) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:29:59,357) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:30:02,070) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:30:02,261) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991997
[3380957:MainThread](2024-04-25 20:30:02,262) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:30:02,262) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:30:04,958) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:30:05,148) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991508
[3380957:MainThread](2024-04-25 20:30:05,148) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:30:05,149) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:30:07,869) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:30:08,059) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991521
[3380957:MainThread](2024-04-25 20:30:08,059) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:30:08,059) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:30:10,740) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:30:10,930) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992536
[3380957:MainThread](2024-04-25 20:30:10,931) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:30:10,931) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:30:13,626) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:30:13,816) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992357
[3380957:MainThread](2024-04-25 20:30:13,817) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:30:13,817) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:30:16,522) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:30:16,713) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991569
[3380957:MainThread](2024-04-25 20:30:16,713) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 20:30:16,714) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:30:19,412) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:30:19,602) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992209
[3380957:MainThread](2024-04-25 20:30:19,603) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:30:19,603) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991018 @ 15
[3380957:MainThread](2024-04-25 20:30:19,859) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-02-28 SH600000   -0.114376
           SH600008    0.040698
           SH600009    0.177877
           SH600010   -0.093126
           SH600011    0.026309
[3380957:MainThread](2024-04-25 20:30:21,571) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  34%|███▍      | 15/44 [20:00<41:39, 86.18s/it][3380957:MainThread](2024-04-25 20:30:21,582) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:30:21,595) INFO - qlib.workflow - [recorder.py:341] - Recorder 5739318a97ea47f68ae6e00fb9d1e32c starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:30:22,435) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:30:22,435) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:30:22,439) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:30:22,440) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:30:30,505) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.802622
            SH600004      0.802622
            SH600006      0.802622
            SH600007      0.802622
            SH600008      0.802622
                            ...   
2016-05-13  SZ300124      0.810263
            SZ300133      0.810263
            SZ300144      0.810263
            SZ300146      0.810263
            SZ300315      0.810263
Length: 561275, dtype: float64
[3380957:MainThread](2024-04-25 20:30:30,508) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:30:30,508) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:30:30,509) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:30:33,279) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:30:33,504) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995571
[3380957:MainThread](2024-04-25 20:30:33,505) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:30:33,506) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:30:36,209) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:30:36,433) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995617
[3380957:MainThread](2024-04-25 20:30:36,434) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:30:36,434) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:30:39,157) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:30:39,385) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994337
[3380957:MainThread](2024-04-25 20:30:39,386) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:30:39,386) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:30:42,123) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:30:42,348) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994078
[3380957:MainThread](2024-04-25 20:30:42,350) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:30:42,350) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:30:45,056) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:30:45,280) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994265
[3380957:MainThread](2024-04-25 20:30:45,281) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:30:45,281) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:30:48,019) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:30:48,243) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993671
[3380957:MainThread](2024-04-25 20:30:48,245) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:30:48,245) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:30:50,981) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:30:51,206) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994105
[3380957:MainThread](2024-04-25 20:30:51,206) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:30:51,207) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:30:53,919) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:30:54,147) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992631
[3380957:MainThread](2024-04-25 20:30:54,148) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:30:54,149) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:30:56,872) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:30:57,096) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993274
[3380957:MainThread](2024-04-25 20:30:57,096) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:30:57,097) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:30:59,755) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:30:59,979) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992841
[3380957:MainThread](2024-04-25 20:30:59,980) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:30:59,980) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:31:02,730) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:31:02,957) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992655
[3380957:MainThread](2024-04-25 20:31:02,957) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:31:02,957) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:31:05,652) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:31:05,876) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992773
[3380957:MainThread](2024-04-25 20:31:05,877) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:31:05,877) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:31:08,617) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:31:08,845) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991808
[3380957:MainThread](2024-04-25 20:31:08,846) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:31:08,847) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:31:11,564) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:31:11,791) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992018
[3380957:MainThread](2024-04-25 20:31:11,792) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:31:11,792) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:31:14,523) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:31:14,748) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991406
[3380957:MainThread](2024-04-25 20:31:14,749) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:31:14,749) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:31:17,435) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:31:17,665) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992112
[3380957:MainThread](2024-04-25 20:31:17,666) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:31:17,666) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:31:20,374) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:31:20,602) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991723
[3380957:MainThread](2024-04-25 20:31:20,603) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:31:20,603) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:31:23,284) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:31:23,512) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991694
[3380957:MainThread](2024-04-25 20:31:23,512) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:31:23,512) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:31:26,203) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:31:26,428) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991716
[3380957:MainThread](2024-04-25 20:31:26,428) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:31:26,429) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:31:29,113) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:31:29,339) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991771
[3380957:MainThread](2024-04-25 20:31:29,340) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:31:29,340) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:31:32,071) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:31:32,298) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991599
[3380957:MainThread](2024-04-25 20:31:32,299) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:31:32,299) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:31:34,989) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:31:35,214) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991824
[3380957:MainThread](2024-04-25 20:31:35,214) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:31:35,214) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:31:37,901) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:31:38,126) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992688
[3380957:MainThread](2024-04-25 20:31:38,127) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:31:38,127) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991406 @ 14
[3380957:MainThread](2024-04-25 20:31:38,177) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-03-28 SH600000   -0.041933
           SH600008   -0.130886
           SH600009    0.026828
           SH600010    0.061642
           SH600011   -0.139838
[3380957:MainThread](2024-04-25 20:31:39,879) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  36%|███▋      | 16/44 [21:18<39:06, 83.81s/it][3380957:MainThread](2024-04-25 20:31:39,889) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:31:39,903) INFO - qlib.workflow - [recorder.py:341] - Recorder fbee1f6e0ed048be8507d9bcad7b8b2c starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:31:40,890) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:31:40,891) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:31:40,894) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:31:40,895) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:31:48,946) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.774290
            SH600004      0.774290
            SH600006      0.774290
            SH600007      0.774290
            SH600008      0.774290
                            ...   
2016-06-14  SZ300133      1.550961
            SZ300144      1.550961
            SZ300146      1.550961
            SZ300251      1.550961
            SZ300315      1.550961
Length: 566995, dtype: float64
[3380957:MainThread](2024-04-25 20:31:48,948) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:31:48,949) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:31:48,949) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:31:51,735) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:31:51,961) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995807
[3380957:MainThread](2024-04-25 20:31:51,962) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:31:51,963) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:31:54,666) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:31:54,894) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994947
[3380957:MainThread](2024-04-25 20:31:54,895) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:31:54,896) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:31:57,612) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:31:57,841) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994639
[3380957:MainThread](2024-04-25 20:31:57,842) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:31:57,842) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:00,580) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:00,805) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994114
[3380957:MainThread](2024-04-25 20:32:00,806) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:32:00,806) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:03,540) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:03,764) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993580
[3380957:MainThread](2024-04-25 20:32:03,765) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:32:03,766) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:06,506) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:06,731) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994434
[3380957:MainThread](2024-04-25 20:32:06,731) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:32:06,731) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:09,484) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:09,712) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993143
[3380957:MainThread](2024-04-25 20:32:09,713) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:32:09,713) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:12,460) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:12,691) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992373
[3380957:MainThread](2024-04-25 20:32:12,692) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:32:12,692) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:15,455) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:15,681) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992280
[3380957:MainThread](2024-04-25 20:32:15,682) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:32:15,683) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:18,429) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:18,654) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991781
[3380957:MainThread](2024-04-25 20:32:18,655) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:32:18,655) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:21,412) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:21,639) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992126
[3380957:MainThread](2024-04-25 20:32:21,639) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:32:21,640) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:24,394) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:24,624) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991601
[3380957:MainThread](2024-04-25 20:32:24,625) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:32:24,625) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:27,377) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:27,604) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992311
[3380957:MainThread](2024-04-25 20:32:27,604) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:32:27,605) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:30,368) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:30,595) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991337
[3380957:MainThread](2024-04-25 20:32:30,596) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:32:30,597) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:33,341) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:33,565) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991790
[3380957:MainThread](2024-04-25 20:32:33,566) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:32:33,566) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:36,327) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:36,555) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992156
[3380957:MainThread](2024-04-25 20:32:36,555) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:32:36,556) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:39,320) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:39,546) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991700
[3380957:MainThread](2024-04-25 20:32:39,546) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:32:39,547) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:42,291) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:42,518) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991966
[3380957:MainThread](2024-04-25 20:32:42,519) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:32:42,519) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:45,223) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:45,451) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992480
[3380957:MainThread](2024-04-25 20:32:45,451) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:32:45,451) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:48,181) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:48,408) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991078
[3380957:MainThread](2024-04-25 20:32:48,409) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:32:48,409) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:51,149) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:51,373) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992964
[3380957:MainThread](2024-04-25 20:32:51,374) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:32:51,374) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:54,110) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:54,336) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991950
[3380957:MainThread](2024-04-25 20:32:54,336) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:32:54,337) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:32:57,078) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:32:57,303) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992571
[3380957:MainThread](2024-04-25 20:32:57,304) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 20:32:57,304) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:33:00,065) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:33:00,291) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992976
[3380957:MainThread](2024-04-25 20:33:00,291) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 20:33:00,292) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:33:03,048) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:33:03,273) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992824
[3380957:MainThread](2024-04-25 20:33:03,274) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 20:33:03,274) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:33:05,987) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:33:06,212) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992592
[3380957:MainThread](2024-04-25 20:33:06,213) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch26:
[3380957:MainThread](2024-04-25 20:33:06,213) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:33:08,961) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:33:09,187) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992865
[3380957:MainThread](2024-04-25 20:33:09,187) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch27:
[3380957:MainThread](2024-04-25 20:33:09,187) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:33:11,937) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:33:12,166) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992403
[3380957:MainThread](2024-04-25 20:33:12,167) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:33:12,167) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991078 @ 19
[3380957:MainThread](2024-04-25 20:33:12,218) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-04-27 SH600000    0.016770
           SH600008   -0.018699
           SH600009    0.086903
           SH600010   -0.070121
           SH600011   -0.050562
[3380957:MainThread](2024-04-25 20:33:13,966) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  39%|███▊      | 17/44 [22:52<39:06, 86.90s/it][3380957:MainThread](2024-04-25 20:33:13,976) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:33:13,989) INFO - qlib.workflow - [recorder.py:341] - Recorder 072f6eb910e74479a8b855c74282fce9 starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:33:14,834) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:33:14,835) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:33:14,838) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:33:14,838) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:33:22,550) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.117991
            SH600004      1.117991
            SH600006      1.117991
            SH600007      1.117991
            SH600008      1.117991
                            ...   
2016-07-12  SZ300144      1.725323
            SZ300146      1.725323
            SZ300168      1.725323
            SZ300251      1.725323
            SZ300315      1.725323
Length: 572790, dtype: float64
[3380957:MainThread](2024-04-25 20:33:22,553) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:33:22,553) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:33:22,553) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:33:25,393) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:33:25,616) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995693
[3380957:MainThread](2024-04-25 20:33:25,618) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:33:25,618) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:33:28,369) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:33:28,596) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994919
[3380957:MainThread](2024-04-25 20:33:28,597) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:33:28,597) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:33:31,276) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:33:31,499) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993430
[3380957:MainThread](2024-04-25 20:33:31,500) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:33:31,501) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:33:34,183) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:33:34,407) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993299
[3380957:MainThread](2024-04-25 20:33:34,408) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:33:34,408) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:33:37,078) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:33:37,301) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992690
[3380957:MainThread](2024-04-25 20:33:37,302) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:33:37,302) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:33:39,984) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:33:40,208) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992095
[3380957:MainThread](2024-04-25 20:33:40,209) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:33:40,209) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:33:42,878) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:33:43,102) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993759
[3380957:MainThread](2024-04-25 20:33:43,103) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:33:43,103) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:33:45,782) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:33:46,006) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991426
[3380957:MainThread](2024-04-25 20:33:46,007) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:33:46,007) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:33:48,652) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:33:48,879) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992177
[3380957:MainThread](2024-04-25 20:33:48,880) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:33:48,880) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:33:51,547) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:33:51,771) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993034
[3380957:MainThread](2024-04-25 20:33:51,771) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:33:51,771) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:33:54,450) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:33:54,674) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991873
[3380957:MainThread](2024-04-25 20:33:54,674) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:33:54,674) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:33:57,338) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:33:57,562) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991142
[3380957:MainThread](2024-04-25 20:33:57,563) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:33:57,564) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:34:00,154) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:34:00,378) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992065
[3380957:MainThread](2024-04-25 20:34:00,379) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:34:00,379) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:34:02,979) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:34:03,203) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991015
[3380957:MainThread](2024-04-25 20:34:03,204) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:34:03,204) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:34:05,944) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:34:06,168) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991722
[3380957:MainThread](2024-04-25 20:34:06,168) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:34:06,168) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:34:08,854) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:34:09,078) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990817
[3380957:MainThread](2024-04-25 20:34:09,079) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:34:09,079) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:34:11,763) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:34:11,987) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991440
[3380957:MainThread](2024-04-25 20:34:11,987) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:34:11,988) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:34:14,674) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:34:14,900) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990540
[3380957:MainThread](2024-04-25 20:34:14,901) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:34:14,901) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:34:17,629) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:34:17,855) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991534
[3380957:MainThread](2024-04-25 20:34:17,855) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:34:17,855) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:34:20,536) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:34:20,762) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991508
[3380957:MainThread](2024-04-25 20:34:20,762) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:34:20,762) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:34:23,449) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:34:23,675) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991176
[3380957:MainThread](2024-04-25 20:34:23,676) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:34:23,676) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:34:26,358) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:34:26,585) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992006
[3380957:MainThread](2024-04-25 20:34:26,586) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:34:26,586) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:34:29,324) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:34:29,548) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991358
[3380957:MainThread](2024-04-25 20:34:29,548) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 20:34:29,549) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:34:32,235) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:34:32,463) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991329
[3380957:MainThread](2024-04-25 20:34:32,463) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 20:34:32,464) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:34:35,164) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:34:35,392) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992227
[3380957:MainThread](2024-04-25 20:34:35,393) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 20:34:35,393) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:34:38,100) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:34:38,324) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992117
[3380957:MainThread](2024-04-25 20:34:38,325) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:34:38,325) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990540 @ 17
[3380957:MainThread](2024-04-25 20:34:38,375) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-05-29 SH600000   -0.056502
           SH600008    0.039468
           SH600009    0.063858
           SH600010   -0.113430
           SH600011    0.040340
[3380957:MainThread](2024-04-25 20:34:40,089) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  41%|████      | 18/44 [24:18<37:33, 86.67s/it][3380957:MainThread](2024-04-25 20:34:40,100) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:34:40,113) INFO - qlib.workflow - [recorder.py:341] - Recorder f91dfac6803647f5a82d80c90de8fb0e starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:34:40,941) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:34:40,941) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:34:40,944) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:34:40,945) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:34:48,716) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.960517
            SH600004      0.960517
            SH600006      0.960517
            SH600007      0.960517
            SH600008      0.960517
                            ...   
2016-08-09  SZ300144      1.894772
            SZ300146      1.894772
            SZ300168      1.894772
            SZ300251      1.894772
            SZ300315      1.894772
Length: 578598, dtype: float64
[3380957:MainThread](2024-04-25 20:34:48,719) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:34:48,719) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:34:48,719) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:34:51,475) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:34:51,675) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995908
[3380957:MainThread](2024-04-25 20:34:51,676) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:34:51,676) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:34:54,355) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:34:54,555) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994834
[3380957:MainThread](2024-04-25 20:34:54,556) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:34:54,557) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:34:57,304) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:34:57,505) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994220
[3380957:MainThread](2024-04-25 20:34:57,506) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:34:57,507) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:00,247) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:00,449) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994101
[3380957:MainThread](2024-04-25 20:35:00,450) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:35:00,450) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:03,193) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:03,395) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993378
[3380957:MainThread](2024-04-25 20:35:03,396) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:35:03,396) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:06,147) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:06,348) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993244
[3380957:MainThread](2024-04-25 20:35:06,349) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:35:06,350) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:09,106) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:09,308) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992328
[3380957:MainThread](2024-04-25 20:35:09,309) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:35:09,309) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:12,060) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:12,262) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992935
[3380957:MainThread](2024-04-25 20:35:12,263) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:35:12,263) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:15,009) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:15,211) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992290
[3380957:MainThread](2024-04-25 20:35:15,212) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:35:15,212) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:17,967) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:18,166) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991885
[3380957:MainThread](2024-04-25 20:35:18,167) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:35:18,168) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:20,882) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:21,086) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991822
[3380957:MainThread](2024-04-25 20:35:21,087) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:35:21,087) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:23,865) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:24,069) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991587
[3380957:MainThread](2024-04-25 20:35:24,070) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:35:24,071) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:26,852) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:27,052) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991624
[3380957:MainThread](2024-04-25 20:35:27,052) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:35:27,053) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:29,871) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:30,072) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991604
[3380957:MainThread](2024-04-25 20:35:30,072) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:35:30,073) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:32,874) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:33,077) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992057
[3380957:MainThread](2024-04-25 20:35:33,077) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:35:33,078) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:35,857) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:36,059) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990960
[3380957:MainThread](2024-04-25 20:35:36,060) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:35:36,060) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:38,852) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:39,053) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991086
[3380957:MainThread](2024-04-25 20:35:39,054) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:35:39,054) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:41,857) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:42,058) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991295
[3380957:MainThread](2024-04-25 20:35:42,059) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:35:42,059) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:44,867) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:45,070) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991442
[3380957:MainThread](2024-04-25 20:35:45,071) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:35:45,071) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:47,866) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:48,066) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990987
[3380957:MainThread](2024-04-25 20:35:48,066) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:35:48,067) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:50,813) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:51,013) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991319
[3380957:MainThread](2024-04-25 20:35:51,013) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:35:51,014) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:53,800) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:54,002) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991344
[3380957:MainThread](2024-04-25 20:35:54,002) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:35:54,002) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:56,800) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:57,001) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992126
[3380957:MainThread](2024-04-25 20:35:57,001) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 20:35:57,002) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:35:59,793) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:35:59,995) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992430
[3380957:MainThread](2024-04-25 20:35:59,996) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:35:59,996) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990960 @ 15
[3380957:MainThread](2024-04-25 20:36:00,276) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-06-27 SH600000   -0.007727
           SH600008   -0.027930
           SH600009    0.130196
           SH600010    0.056973
           SH600011   -0.113514
[3380957:MainThread](2024-04-25 20:36:02,013) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  43%|████▎     | 19/44 [25:40<35:31, 85.24s/it][3380957:MainThread](2024-04-25 20:36:02,024) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:36:02,037) INFO - qlib.workflow - [recorder.py:341] - Recorder c019be425935481cb7b178f417ffaadd starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:36:02,858) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:36:02,858) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:36:02,860) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:36:02,861) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:36:10,484) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.741805
            SH600004      0.741805
            SH600006      0.741805
            SH600007      0.741805
            SH600008      0.741805
                            ...   
2016-09-06  SZ300144      1.279267
            SZ300146      1.279267
            SZ300168      1.279267
            SZ300251      1.279267
            SZ300315      1.279267
Length: 584401, dtype: float64
[3380957:MainThread](2024-04-25 20:36:10,487) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:36:10,487) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:36:10,487) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:36:13,250) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:36:13,475) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995592
[3380957:MainThread](2024-04-25 20:36:13,476) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:36:13,476) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:36:16,208) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:36:16,433) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994822
[3380957:MainThread](2024-04-25 20:36:16,434) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:36:16,434) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:36:19,161) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:36:19,386) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994820
[3380957:MainThread](2024-04-25 20:36:19,387) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:36:19,388) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:36:22,113) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:36:22,338) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993549
[3380957:MainThread](2024-04-25 20:36:22,339) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:36:22,340) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:36:25,050) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:36:25,274) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993235
[3380957:MainThread](2024-04-25 20:36:25,275) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:36:25,276) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:36:28,032) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:36:28,257) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992553
[3380957:MainThread](2024-04-25 20:36:28,258) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:36:28,258) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:36:30,987) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:36:31,212) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992566
[3380957:MainThread](2024-04-25 20:36:31,213) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:36:31,213) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:36:33,928) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:36:34,154) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992215
[3380957:MainThread](2024-04-25 20:36:34,155) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:36:34,156) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:36:36,811) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:36:37,037) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992031
[3380957:MainThread](2024-04-25 20:36:37,039) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:36:37,039) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:36:39,730) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:36:39,955) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991765
[3380957:MainThread](2024-04-25 20:36:39,956) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:36:39,956) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:36:42,638) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:36:42,863) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992469
[3380957:MainThread](2024-04-25 20:36:42,864) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:36:42,864) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:36:45,599) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:36:45,825) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991371
[3380957:MainThread](2024-04-25 20:36:45,826) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:36:45,827) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:36:48,561) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:36:48,785) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991664
[3380957:MainThread](2024-04-25 20:36:48,786) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:36:48,786) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:36:51,513) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:36:51,742) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992493
[3380957:MainThread](2024-04-25 20:36:51,742) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:36:51,743) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:36:54,535) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:36:54,759) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991502
[3380957:MainThread](2024-04-25 20:36:54,760) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:36:54,760) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:36:57,565) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:36:57,792) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991662
[3380957:MainThread](2024-04-25 20:36:57,792) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:36:57,792) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:37:00,602) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:37:00,830) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991033
[3380957:MainThread](2024-04-25 20:37:00,831) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:37:00,832) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:37:03,654) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:37:03,880) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990566
[3380957:MainThread](2024-04-25 20:37:03,881) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:37:03,882) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:37:06,687) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:37:06,916) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991606
[3380957:MainThread](2024-04-25 20:37:06,916) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:37:06,917) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:37:09,675) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:37:09,904) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991285
[3380957:MainThread](2024-04-25 20:37:09,904) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:37:09,904) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:37:12,631) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:37:12,857) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991812
[3380957:MainThread](2024-04-25 20:37:12,858) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:37:12,858) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:37:15,574) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:37:15,799) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993332
[3380957:MainThread](2024-04-25 20:37:15,800) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:37:15,800) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:37:18,533) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:37:18,759) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991752
[3380957:MainThread](2024-04-25 20:37:18,759) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 20:37:18,760) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:37:21,466) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:37:21,693) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993145
[3380957:MainThread](2024-04-25 20:37:21,693) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch24:
[3380957:MainThread](2024-04-25 20:37:21,693) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:37:24,426) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:37:24,652) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991852
[3380957:MainThread](2024-04-25 20:37:24,653) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch25:
[3380957:MainThread](2024-04-25 20:37:24,653) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:37:27,378) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:37:27,604) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993569
[3380957:MainThread](2024-04-25 20:37:27,604) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:37:27,605) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990566 @ 17
[3380957:MainThread](2024-04-25 20:37:27,656) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-07-25 SH600000    0.029721
           SH600008    0.037765
           SH600009   -0.025859
           SH600010    0.010789
           SH600011   -0.031110
[3380957:MainThread](2024-04-25 20:37:29,405) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  45%|████▌     | 20/44 [27:08<34:21, 85.89s/it][3380957:MainThread](2024-04-25 20:37:29,416) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:37:29,429) INFO - qlib.workflow - [recorder.py:341] - Recorder 0fce72f18ea74399ae14e1d986f8ef80 starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:37:30,278) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:37:30,279) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:37:30,282) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:37:30,283) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:37:38,068) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.364565
            SH600004      1.364565
            SH600006      1.364565
            SH600007      1.364565
            SH600008      1.364565
                            ...   
2016-10-13  SZ300144      0.703690
            SZ300146      0.703690
            SZ300168      0.703690
            SZ300251      0.703690
            SZ300315      0.703690
Length: 590146, dtype: float64
[3380957:MainThread](2024-04-25 20:37:38,070) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:37:38,070) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:37:38,071) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:37:40,880) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:37:41,081) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996181
[3380957:MainThread](2024-04-25 20:37:41,082) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:37:41,082) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:37:43,878) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:37:44,080) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994693
[3380957:MainThread](2024-04-25 20:37:44,081) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:37:44,081) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:37:46,872) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:37:47,075) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994314
[3380957:MainThread](2024-04-25 20:37:47,076) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:37:47,076) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:37:49,868) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:37:50,068) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993392
[3380957:MainThread](2024-04-25 20:37:50,069) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:37:50,070) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:37:52,829) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:37:53,030) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992377
[3380957:MainThread](2024-04-25 20:37:53,031) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:37:53,032) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:37:55,821) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:37:56,022) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992497
[3380957:MainThread](2024-04-25 20:37:56,023) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:37:56,023) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:37:58,841) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:37:59,042) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991868
[3380957:MainThread](2024-04-25 20:37:59,043) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:37:59,044) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:38:01,929) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:38:02,132) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991262
[3380957:MainThread](2024-04-25 20:38:02,133) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:38:02,134) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:38:05,012) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:38:05,214) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991597
[3380957:MainThread](2024-04-25 20:38:05,215) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:38:05,215) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:38:08,073) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:38:08,276) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991453
[3380957:MainThread](2024-04-25 20:38:08,277) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:38:08,277) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:38:11,097) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:38:11,300) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991339
[3380957:MainThread](2024-04-25 20:38:11,300) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:38:11,301) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:38:14,085) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:38:14,286) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992198
[3380957:MainThread](2024-04-25 20:38:14,286) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:38:14,287) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:38:17,075) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:38:17,277) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991500
[3380957:MainThread](2024-04-25 20:38:17,277) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:38:17,277) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:38:20,122) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:38:20,327) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991165
[3380957:MainThread](2024-04-25 20:38:20,328) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:38:20,328) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:38:23,189) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:38:23,392) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990692
[3380957:MainThread](2024-04-25 20:38:23,393) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:38:23,393) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:38:26,253) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:38:26,457) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990342
[3380957:MainThread](2024-04-25 20:38:26,458) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:38:26,458) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:38:29,313) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:38:29,516) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991507
[3380957:MainThread](2024-04-25 20:38:29,516) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:38:29,517) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:38:32,248) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:38:32,452) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991351
[3380957:MainThread](2024-04-25 20:38:32,453) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:38:32,453) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:38:35,296) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:38:35,500) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991618
[3380957:MainThread](2024-04-25 20:38:35,500) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:38:35,500) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:38:38,366) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:38:38,569) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991491
[3380957:MainThread](2024-04-25 20:38:38,569) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:38:38,570) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:38:41,439) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:38:41,642) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991493
[3380957:MainThread](2024-04-25 20:38:41,643) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:38:41,643) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:38:44,523) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:38:44,727) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992872
[3380957:MainThread](2024-04-25 20:38:44,728) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:38:44,728) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:38:47,599) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:38:47,803) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991810
[3380957:MainThread](2024-04-25 20:38:47,804) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 20:38:47,804) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:38:50,670) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:38:50,874) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991601
[3380957:MainThread](2024-04-25 20:38:50,874) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:38:50,875) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990342 @ 15
[3380957:MainThread](2024-04-25 20:38:50,926) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-08-22 SH600000   -0.023978
           SH600008   -0.092912
           SH600009    0.121297
           SH600010   -0.036008
           SH600011   -0.081664
[3380957:MainThread](2024-04-25 20:38:52,656) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  48%|████▊     | 21/44 [28:31<32:37, 85.10s/it][3380957:MainThread](2024-04-25 20:38:52,667) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:38:52,680) INFO - qlib.workflow - [recorder.py:341] - Recorder dec3f925f9724ca5b3cdc32e7836c317 starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:38:53,512) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:38:53,513) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:38:53,515) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:38:53,516) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:39:01,270) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.264023
            SH600004      1.264023
            SH600006      1.264023
            SH600007      1.264023
            SH600008      1.264023
                            ...   
2016-11-10  SZ300144      1.076345
            SZ300146      1.076345
            SZ300168      1.076345
            SZ300251      1.076345
            SZ300315      1.076345
Length: 595946, dtype: float64
[3380957:MainThread](2024-04-25 20:39:01,272) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:39:01,273) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:39:01,273) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:39:04,129) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:39:04,351) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995093
[3380957:MainThread](2024-04-25 20:39:04,352) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:39:04,352) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:39:07,170) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:39:07,393) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994511
[3380957:MainThread](2024-04-25 20:39:07,394) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:39:07,394) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:39:10,226) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:39:10,446) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993232
[3380957:MainThread](2024-04-25 20:39:10,447) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:39:10,447) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:39:13,250) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:39:13,468) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992535
[3380957:MainThread](2024-04-25 20:39:13,469) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:39:13,470) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:39:16,311) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:39:16,531) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992474
[3380957:MainThread](2024-04-25 20:39:16,532) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:39:16,532) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:39:19,408) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:39:19,628) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991690
[3380957:MainThread](2024-04-25 20:39:19,629) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:39:19,629) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:39:22,517) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:39:22,737) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992046
[3380957:MainThread](2024-04-25 20:39:22,737) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:39:22,738) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:39:25,575) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:39:25,796) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991342
[3380957:MainThread](2024-04-25 20:39:25,797) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:39:25,797) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:39:28,598) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:39:28,817) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991189
[3380957:MainThread](2024-04-25 20:39:28,818) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:39:28,819) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:39:31,630) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:39:31,850) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991539
[3380957:MainThread](2024-04-25 20:39:31,851) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:39:31,851) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:39:34,666) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:39:34,886) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991483
[3380957:MainThread](2024-04-25 20:39:34,886) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:39:34,887) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:39:37,719) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:39:37,942) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991384
[3380957:MainThread](2024-04-25 20:39:37,943) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:39:37,943) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:39:40,747) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:39:40,967) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.989987
[3380957:MainThread](2024-04-25 20:39:40,968) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:39:40,968) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:39:43,781) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:39:44,001) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990973
[3380957:MainThread](2024-04-25 20:39:44,002) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:39:44,002) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:39:46,825) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:39:47,044) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990395
[3380957:MainThread](2024-04-25 20:39:47,044) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:39:47,045) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:39:49,858) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:39:50,079) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991055
[3380957:MainThread](2024-04-25 20:39:50,079) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:39:50,079) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:39:52,893) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:39:53,113) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990708
[3380957:MainThread](2024-04-25 20:39:53,113) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:39:53,114) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:39:55,911) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:39:56,131) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991987
[3380957:MainThread](2024-04-25 20:39:56,132) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:39:56,132) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:39:58,933) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:39:59,155) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991394
[3380957:MainThread](2024-04-25 20:39:59,155) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:39:59,155) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:40:01,952) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:40:02,171) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991119
[3380957:MainThread](2024-04-25 20:40:02,172) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:40:02,172) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:40:04,970) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:40:05,191) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991370
[3380957:MainThread](2024-04-25 20:40:05,191) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:40:05,192) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.989987 @ 12
[3380957:MainThread](2024-04-25 20:40:05,247) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-09-19 SH600000    0.002513
           SH600008    0.012633
           SH600009   -0.030129
           SH600010   -0.005091
           SH600011    0.076649
[3380957:MainThread](2024-04-25 20:40:06,946) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  50%|█████     | 22/44 [29:45<30:00, 81.85s/it][3380957:MainThread](2024-04-25 20:40:06,956) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:40:06,969) INFO - qlib.workflow - [recorder.py:341] - Recorder 9e532f97f8004eed91d158e31beebce3 starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:40:07,806) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:40:07,807) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:40:07,810) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:40:07,811) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:40:15,434) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.957770
            SH600004      0.957770
            SH600006      0.957770
            SH600007      0.957770
            SH600008      0.957770
                            ...   
2016-12-08  SZ300144      1.834511
            SZ300146      1.834511
            SZ300168      1.834511
            SZ300251      1.834511
            SZ300315      1.834511
Length: 601711, dtype: float64
[3380957:MainThread](2024-04-25 20:40:15,436) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:40:15,437) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:40:15,437) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:40:18,318) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:40:18,539) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995739
[3380957:MainThread](2024-04-25 20:40:18,541) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:40:18,541) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:40:21,426) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:40:21,647) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994397
[3380957:MainThread](2024-04-25 20:40:21,648) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:40:21,649) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:40:24,555) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:40:24,776) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994229
[3380957:MainThread](2024-04-25 20:40:24,777) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:40:24,777) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:40:27,656) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:40:27,880) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993375
[3380957:MainThread](2024-04-25 20:40:27,881) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:40:27,882) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:40:30,755) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:40:30,979) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992756
[3380957:MainThread](2024-04-25 20:40:30,980) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:40:30,980) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:40:33,836) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:40:34,059) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992748
[3380957:MainThread](2024-04-25 20:40:34,060) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:40:34,060) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:40:36,937) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:40:37,159) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991545
[3380957:MainThread](2024-04-25 20:40:37,160) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:40:37,160) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:40:40,069) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:40:40,295) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992047
[3380957:MainThread](2024-04-25 20:40:40,296) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:40:40,296) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:40:43,225) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:40:43,448) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992033
[3380957:MainThread](2024-04-25 20:40:43,449) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:40:43,449) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:40:46,325) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:40:46,548) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991367
[3380957:MainThread](2024-04-25 20:40:46,549) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:40:46,550) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:40:49,478) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:40:49,706) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992735
[3380957:MainThread](2024-04-25 20:40:49,706) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:40:49,706) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:40:52,597) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:40:52,822) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991127
[3380957:MainThread](2024-04-25 20:40:52,823) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:40:52,824) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:40:55,746) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:40:55,973) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991345
[3380957:MainThread](2024-04-25 20:40:55,973) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:40:55,973) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:40:58,885) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:40:59,109) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991245
[3380957:MainThread](2024-04-25 20:40:59,109) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:40:59,109) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:41:02,039) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:41:02,264) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991890
[3380957:MainThread](2024-04-25 20:41:02,265) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:41:02,265) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:41:05,196) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:41:05,419) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991174
[3380957:MainThread](2024-04-25 20:41:05,419) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:41:05,420) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:41:08,354) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:41:08,579) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991175
[3380957:MainThread](2024-04-25 20:41:08,580) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:41:08,580) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:41:11,506) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:41:11,731) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992718
[3380957:MainThread](2024-04-25 20:41:11,731) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:41:11,731) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:41:14,625) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:41:14,848) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991836
[3380957:MainThread](2024-04-25 20:41:14,848) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:41:14,849) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:41:17,644) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:41:17,868) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992399
[3380957:MainThread](2024-04-25 20:41:17,869) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:41:17,869) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991127 @ 11
[3380957:MainThread](2024-04-25 20:41:17,919) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-10-25 SH600000   -0.099065
           SH600008    0.088016
           SH600009   -0.169573
           SH600010   -0.011046
           SH600011   -0.004675
[3380957:MainThread](2024-04-25 20:41:19,619) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  52%|█████▏    | 23/44 [30:58<27:41, 79.10s/it][3380957:MainThread](2024-04-25 20:41:19,629) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:41:19,642) INFO - qlib.workflow - [recorder.py:341] - Recorder 75c4d269cfab4fd6a2644a962c874c7a starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:41:20,487) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:41:20,488) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:41:20,491) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:41:20,492) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:41:28,113) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.763289
            SH600004      1.763289
            SH600006      1.763289
            SH600007      1.763289
            SH600008      1.763289
                            ...   
2017-01-06  SZ300146      1.662444
            SZ300168      1.662444
            SZ300182      1.662444
            SZ300251      1.662444
            SZ300315      1.662444
Length: 607469, dtype: float64
[3380957:MainThread](2024-04-25 20:41:28,116) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:41:28,116) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:41:28,116) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:41:31,212) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:41:31,435) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996059
[3380957:MainThread](2024-04-25 20:41:31,436) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:41:31,436) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:41:34,340) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:41:34,563) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995719
[3380957:MainThread](2024-04-25 20:41:34,564) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:41:34,564) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:41:37,465) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:41:37,687) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994066
[3380957:MainThread](2024-04-25 20:41:37,688) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:41:37,688) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:41:40,608) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:41:40,831) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992896
[3380957:MainThread](2024-04-25 20:41:40,832) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:41:40,833) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:41:43,755) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:41:43,981) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992825
[3380957:MainThread](2024-04-25 20:41:43,982) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:41:43,982) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:41:46,925) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:41:47,154) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991955
[3380957:MainThread](2024-04-25 20:41:47,155) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:41:47,156) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:41:50,093) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:41:50,320) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993259
[3380957:MainThread](2024-04-25 20:41:50,320) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:41:50,321) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:41:53,221) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:41:53,447) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992282
[3380957:MainThread](2024-04-25 20:41:53,447) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:41:53,448) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:41:56,344) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:41:56,569) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991055
[3380957:MainThread](2024-04-25 20:41:56,570) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:41:56,570) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:41:59,472) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:41:59,696) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992179
[3380957:MainThread](2024-04-25 20:41:59,696) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:41:59,697) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:42:02,594) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:42:02,821) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992114
[3380957:MainThread](2024-04-25 20:42:02,821) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:42:02,821) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:42:05,717) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:42:05,943) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991286
[3380957:MainThread](2024-04-25 20:42:05,943) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:42:05,944) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:42:08,828) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:42:09,054) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991044
[3380957:MainThread](2024-04-25 20:42:09,055) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:42:09,055) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:42:11,923) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:42:12,149) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991720
[3380957:MainThread](2024-04-25 20:42:12,149) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:42:12,150) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:42:15,083) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:42:15,308) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990702
[3380957:MainThread](2024-04-25 20:42:15,310) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:42:15,310) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:42:18,213) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:42:18,439) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991785
[3380957:MainThread](2024-04-25 20:42:18,439) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:42:18,440) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:42:21,323) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:42:21,549) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991033
[3380957:MainThread](2024-04-25 20:42:21,549) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:42:21,550) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:42:24,481) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:42:24,706) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992393
[3380957:MainThread](2024-04-25 20:42:24,706) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:42:24,706) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:42:27,645) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:42:27,869) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991698
[3380957:MainThread](2024-04-25 20:42:27,870) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:42:27,870) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:42:30,809) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:42:31,033) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992664
[3380957:MainThread](2024-04-25 20:42:31,034) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:42:31,034) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:42:33,896) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:42:34,123) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991308
[3380957:MainThread](2024-04-25 20:42:34,123) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:42:34,124) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:42:37,054) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:42:37,278) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991535
[3380957:MainThread](2024-04-25 20:42:37,278) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:42:37,279) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:42:40,223) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:42:40,449) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992716
[3380957:MainThread](2024-04-25 20:42:40,450) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:42:40,450) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990702 @ 14
[3380957:MainThread](2024-04-25 20:42:40,709) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-11-22 SH600000    0.028539
           SH600008   -0.338372
           SH600009   -0.068007
           SH600010    0.029697
           SH600011    0.060164
[3380957:MainThread](2024-04-25 20:42:42,439) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  55%|█████▍    | 24/44 [32:21<26:44, 80.21s/it][3380957:MainThread](2024-04-25 20:42:42,449) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:42:42,463) INFO - qlib.workflow - [recorder.py:341] - Recorder 18310167336e4fb5bc547e8c26c8109c starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:42:43,342) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:42:43,343) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:42:43,345) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:42:43,346) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:42:51,480) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.522680
            SH600004      1.522680
            SH600006      1.522680
            SH600007      1.522680
            SH600008      1.522680
                            ...   
2017-02-10  SZ300144      1.762578
            SZ300146      1.762578
            SZ300168      1.762578
            SZ300182      1.762578
            SZ300251      1.762578
Length: 613211, dtype: float64
[3380957:MainThread](2024-04-25 20:42:51,482) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:42:51,482) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:42:51,483) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:42:54,474) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:42:54,703) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995359
[3380957:MainThread](2024-04-25 20:42:54,704) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:42:54,704) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:42:57,679) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:42:57,908) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994946
[3380957:MainThread](2024-04-25 20:42:57,909) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:42:57,910) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:43:00,903) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:43:01,133) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993758
[3380957:MainThread](2024-04-25 20:43:01,134) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:43:01,134) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:43:04,064) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:43:04,289) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992413
[3380957:MainThread](2024-04-25 20:43:04,290) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:43:04,291) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:43:07,240) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:43:07,469) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992653
[3380957:MainThread](2024-04-25 20:43:07,469) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:43:07,469) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:43:10,392) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:43:10,623) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992241
[3380957:MainThread](2024-04-25 20:43:10,624) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:43:10,625) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:43:13,586) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:43:13,816) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991982
[3380957:MainThread](2024-04-25 20:43:13,817) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:43:13,818) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:43:16,792) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:43:17,020) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992031
[3380957:MainThread](2024-04-25 20:43:17,020) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:43:17,020) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:43:19,978) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:43:20,203) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991595
[3380957:MainThread](2024-04-25 20:43:20,205) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:43:20,205) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:43:23,168) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:43:23,398) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.990750
[3380957:MainThread](2024-04-25 20:43:23,399) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:43:23,399) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:43:26,332) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:43:26,561) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992090
[3380957:MainThread](2024-04-25 20:43:26,562) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:43:26,562) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:43:29,532) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:43:29,761) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991701
[3380957:MainThread](2024-04-25 20:43:29,761) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:43:29,762) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:43:32,677) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:43:32,905) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991537
[3380957:MainThread](2024-04-25 20:43:32,905) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:43:32,905) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:43:35,826) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:43:36,060) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991597
[3380957:MainThread](2024-04-25 20:43:36,060) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:43:36,061) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:43:39,037) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:43:39,267) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991748
[3380957:MainThread](2024-04-25 20:43:39,267) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:43:39,268) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:43:42,192) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:43:42,422) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991278
[3380957:MainThread](2024-04-25 20:43:42,422) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:43:42,422) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:43:45,302) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:43:45,529) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992731
[3380957:MainThread](2024-04-25 20:43:45,529) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:43:45,529) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:43:48,388) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:43:48,615) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992304
[3380957:MainThread](2024-04-25 20:43:48,616) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:43:48,616) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.990750 @ 9
[3380957:MainThread](2024-04-25 20:43:48,971) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2018-12-20 SH600000    0.002279
           SH600004   -0.062373
           SH600009   -0.000541
           SH600010   -0.076489
           SH600011   -0.077191
[3380957:MainThread](2024-04-25 20:43:50,675) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  57%|█████▋    | 25/44 [33:29<24:15, 76.62s/it][3380957:MainThread](2024-04-25 20:43:50,686) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:43:50,699) INFO - qlib.workflow - [recorder.py:341] - Recorder d93622fac5a24258b422a7aea9eefa4f starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:43:51,528) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:43:51,529) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:43:51,532) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:43:51,533) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:43:59,172) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.523604
            SH600004      1.523604
            SH600006      1.523604
            SH600007      1.523604
            SH600008      1.523604
                            ...   
2017-03-10  SZ300144      1.973320
            SZ300146      1.973320
            SZ300168      1.973320
            SZ300182      1.973320
            SZ300251      1.973320
Length: 618892, dtype: float64
[3380957:MainThread](2024-04-25 20:43:59,174) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:43:59,175) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:43:59,175) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:44:02,014) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:44:02,241) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996016
[3380957:MainThread](2024-04-25 20:44:02,242) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:44:02,242) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:44:05,067) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:44:05,294) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994494
[3380957:MainThread](2024-04-25 20:44:05,295) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:44:05,296) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:44:08,123) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:44:08,351) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994174
[3380957:MainThread](2024-04-25 20:44:08,352) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:44:08,352) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:44:11,241) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:44:11,468) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993415
[3380957:MainThread](2024-04-25 20:44:11,469) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:44:11,470) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:44:14,359) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:44:14,586) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993063
[3380957:MainThread](2024-04-25 20:44:14,587) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:44:14,588) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:44:17,497) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:44:17,730) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993250
[3380957:MainThread](2024-04-25 20:44:17,730) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:44:17,731) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:44:20,706) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:44:20,936) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993471
[3380957:MainThread](2024-04-25 20:44:20,936) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:44:20,937) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:44:23,881) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:44:24,111) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991954
[3380957:MainThread](2024-04-25 20:44:24,112) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:44:24,112) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:44:27,049) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:44:27,280) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992860
[3380957:MainThread](2024-04-25 20:44:27,280) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:44:27,281) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:44:30,191) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:44:30,419) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992855
[3380957:MainThread](2024-04-25 20:44:30,419) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:44:30,419) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:44:33,353) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:44:33,583) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991530
[3380957:MainThread](2024-04-25 20:44:33,584) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:44:33,584) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:44:36,509) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:44:36,737) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992430
[3380957:MainThread](2024-04-25 20:44:36,738) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:44:36,738) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:44:39,666) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:44:39,896) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992144
[3380957:MainThread](2024-04-25 20:44:39,896) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:44:39,896) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:44:42,859) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:44:43,094) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992400
[3380957:MainThread](2024-04-25 20:44:43,094) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:44:43,094) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:44:46,033) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:44:46,263) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991783
[3380957:MainThread](2024-04-25 20:44:46,263) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:44:46,264) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:44:49,185) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:44:49,412) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992093
[3380957:MainThread](2024-04-25 20:44:49,413) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:44:49,413) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:44:52,312) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:44:52,540) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992525
[3380957:MainThread](2024-04-25 20:44:52,540) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:44:52,540) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:44:55,452) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:44:55,683) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991916
[3380957:MainThread](2024-04-25 20:44:55,683) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:44:55,684) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:44:58,616) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:44:58,846) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991966
[3380957:MainThread](2024-04-25 20:44:58,846) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:44:58,847) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991530 @ 10
[3380957:MainThread](2024-04-25 20:44:58,898) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-01-21 SH600000   -0.034317
           SH600004    0.246495
           SH600009    0.100151
           SH600010    0.031032
           SH600011   -0.084118
[3380957:MainThread](2024-04-25 20:45:00,641) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  59%|█████▉    | 26/44 [34:39<22:23, 74.62s/it][3380957:MainThread](2024-04-25 20:45:00,652) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:45:00,665) INFO - qlib.workflow - [recorder.py:341] - Recorder a3fb20eb6f18428e8030c63042b39beb starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:45:01,493) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:45:01,493) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:45:01,496) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:45:01,496) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:45:09,313) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.978565
            SH600004      0.978565
            SH600006      0.978565
            SH600007      0.978565
            SH600008      0.978565
                            ...   
2017-04-11  SZ300144      1.742362
            SZ300146      1.742362
            SZ300168      1.742362
            SZ300182      1.742362
            SZ300251      1.742362
Length: 624606, dtype: float64
[3380957:MainThread](2024-04-25 20:45:09,315) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:45:09,316) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:45:09,316) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:45:12,281) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:45:12,476) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996348
[3380957:MainThread](2024-04-25 20:45:12,477) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:45:12,477) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:45:15,422) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:45:15,616) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995007
[3380957:MainThread](2024-04-25 20:45:15,618) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:45:15,618) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:45:18,571) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:45:18,767) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.995465
[3380957:MainThread](2024-04-25 20:45:18,767) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:45:18,767) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:45:21,701) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:45:21,894) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993133
[3380957:MainThread](2024-04-25 20:45:21,895) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:45:21,896) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:45:24,814) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:45:25,010) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992385
[3380957:MainThread](2024-04-25 20:45:25,011) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:45:25,011) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:45:27,966) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:45:28,159) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992698
[3380957:MainThread](2024-04-25 20:45:28,159) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:45:28,160) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:45:31,126) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:45:31,321) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992144
[3380957:MainThread](2024-04-25 20:45:31,322) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:45:31,323) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:45:34,273) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:45:34,469) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992145
[3380957:MainThread](2024-04-25 20:45:34,469) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:45:34,469) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:45:37,432) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:45:37,628) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992438
[3380957:MainThread](2024-04-25 20:45:37,629) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:45:37,629) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:45:40,573) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:45:40,772) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993089
[3380957:MainThread](2024-04-25 20:45:40,772) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:45:40,773) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:45:43,721) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:45:43,916) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992135
[3380957:MainThread](2024-04-25 20:45:43,917) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:45:43,917) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:45:46,833) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:45:47,028) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992067
[3380957:MainThread](2024-04-25 20:45:47,029) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:45:47,029) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:45:49,971) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:45:50,166) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991663
[3380957:MainThread](2024-04-25 20:45:50,167) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:45:50,167) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:45:53,111) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:45:53,307) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991819
[3380957:MainThread](2024-04-25 20:45:53,307) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:45:53,307) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:45:56,239) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:45:56,435) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992367
[3380957:MainThread](2024-04-25 20:45:56,435) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:45:56,435) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:45:59,330) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:45:59,525) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992601
[3380957:MainThread](2024-04-25 20:45:59,525) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:45:59,526) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:46:02,519) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:46:02,714) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991894
[3380957:MainThread](2024-04-25 20:46:02,715) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:46:02,715) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:46:05,694) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:46:05,889) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992632
[3380957:MainThread](2024-04-25 20:46:05,889) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:46:05,889) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:46:08,855) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:46:09,051) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993028
[3380957:MainThread](2024-04-25 20:46:09,052) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:46:09,052) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:46:11,992) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:46:12,189) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993201
[3380957:MainThread](2024-04-25 20:46:12,189) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:46:12,190) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:46:15,135) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:46:15,330) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993354
[3380957:MainThread](2024-04-25 20:46:15,330) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:46:15,330) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991663 @ 12
[3380957:MainThread](2024-04-25 20:46:15,512) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-02-25 SH600000    0.158230
           SH600004    0.055572
           SH600009   -0.178102
           SH600010    0.137152
           SH600011    0.092878
[3380957:MainThread](2024-04-25 20:46:17,224) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  61%|██████▏   | 27/44 [35:56<21:18, 75.21s/it][3380957:MainThread](2024-04-25 20:46:17,234) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:46:17,247) INFO - qlib.workflow - [recorder.py:341] - Recorder fdad4ecf14af4719bb5891af8544e41a starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:46:18,309) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:46:18,310) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:46:18,313) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:46:18,313) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:46:26,416) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.926275
            SH600004      0.926275
            SH600006      0.926275
            SH600007      0.926275
            SH600008      0.926275
                            ...   
2017-05-10  SZ300133      1.391789
            SZ300144      1.391789
            SZ300146      1.391789
            SZ300182      1.391789
            SZ300251      1.391789
Length: 630244, dtype: float64
[3380957:MainThread](2024-04-25 20:46:26,418) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:46:26,419) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:46:26,419) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:46:29,441) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:46:29,650) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.996569
[3380957:MainThread](2024-04-25 20:46:29,651) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch1:
[3380957:MainThread](2024-04-25 20:46:29,652) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:46:32,665) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:46:32,872) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994683
[3380957:MainThread](2024-04-25 20:46:32,873) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch2:
[3380957:MainThread](2024-04-25 20:46:32,873) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:46:35,888) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:46:36,098) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993366
[3380957:MainThread](2024-04-25 20:46:36,099) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch3:
[3380957:MainThread](2024-04-25 20:46:36,100) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:46:39,144) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:46:39,353) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993680
[3380957:MainThread](2024-04-25 20:46:39,354) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch4:
[3380957:MainThread](2024-04-25 20:46:39,354) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:46:42,397) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:46:42,606) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992593
[3380957:MainThread](2024-04-25 20:46:42,607) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch5:
[3380957:MainThread](2024-04-25 20:46:42,608) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:46:45,681) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:46:45,890) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991893
[3380957:MainThread](2024-04-25 20:46:45,891) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch6:
[3380957:MainThread](2024-04-25 20:46:45,891) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:46:48,969) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:46:49,179) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992621
[3380957:MainThread](2024-04-25 20:46:49,180) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch7:
[3380957:MainThread](2024-04-25 20:46:49,180) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:46:52,250) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:46:52,457) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.994555
[3380957:MainThread](2024-04-25 20:46:52,458) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch8:
[3380957:MainThread](2024-04-25 20:46:52,458) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:46:55,533) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:46:55,740) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991634
[3380957:MainThread](2024-04-25 20:46:55,742) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch9:
[3380957:MainThread](2024-04-25 20:46:55,742) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:46:58,819) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:46:59,027) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991621
[3380957:MainThread](2024-04-25 20:46:59,028) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch10:
[3380957:MainThread](2024-04-25 20:46:59,029) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:47:02,100) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:47:02,308) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992168
[3380957:MainThread](2024-04-25 20:47:02,308) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch11:
[3380957:MainThread](2024-04-25 20:47:02,309) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:47:05,338) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:47:05,546) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992003
[3380957:MainThread](2024-04-25 20:47:05,547) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch12:
[3380957:MainThread](2024-04-25 20:47:05,547) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:47:08,543) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:47:08,750) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991939
[3380957:MainThread](2024-04-25 20:47:08,750) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch13:
[3380957:MainThread](2024-04-25 20:47:08,751) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:47:11,773) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:47:11,983) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992238
[3380957:MainThread](2024-04-25 20:47:11,983) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch14:
[3380957:MainThread](2024-04-25 20:47:11,983) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:47:15,050) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:47:15,259) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991980
[3380957:MainThread](2024-04-25 20:47:15,259) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch15:
[3380957:MainThread](2024-04-25 20:47:15,259) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:47:18,275) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:47:18,483) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991573
[3380957:MainThread](2024-04-25 20:47:18,484) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch16:
[3380957:MainThread](2024-04-25 20:47:18,484) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:47:21,479) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:47:21,688) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.991800
[3380957:MainThread](2024-04-25 20:47:21,688) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch17:
[3380957:MainThread](2024-04-25 20:47:21,688) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:47:24,707) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:47:24,915) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992768
[3380957:MainThread](2024-04-25 20:47:24,916) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch18:
[3380957:MainThread](2024-04-25 20:47:24,916) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:47:27,904) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:47:28,113) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992053
[3380957:MainThread](2024-04-25 20:47:28,113) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch19:
[3380957:MainThread](2024-04-25 20:47:28,114) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:47:31,133) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:47:31,342) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993481
[3380957:MainThread](2024-04-25 20:47:31,343) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch20:
[3380957:MainThread](2024-04-25 20:47:31,343) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:47:34,415) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:47:34,622) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993631
[3380957:MainThread](2024-04-25 20:47:34,622) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch21:
[3380957:MainThread](2024-04-25 20:47:34,623) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:47:37,660) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:47:37,867) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993854
[3380957:MainThread](2024-04-25 20:47:37,868) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch22:
[3380957:MainThread](2024-04-25 20:47:37,868) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:47:40,888) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:47:41,098) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.992098
[3380957:MainThread](2024-04-25 20:47:41,099) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch23:
[3380957:MainThread](2024-04-25 20:47:41,099) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
[3380957:MainThread](2024-04-25 20:47:44,073) INFO - qlib.GRU - [pytorch_gru.py:274] - evaluating...
[3380957:MainThread](2024-04-25 20:47:44,281) INFO - qlib.GRU - [pytorch_gru.py:277] - valid -0.993546
[3380957:MainThread](2024-04-25 20:47:44,282) INFO - qlib.GRU - [pytorch_gru.py:289] - early stop
[3380957:MainThread](2024-04-25 20:47:44,282) INFO - qlib.GRU - [pytorch_gru.py:292] - best score: -0.991573 @ 15
[3380957:MainThread](2024-04-25 20:47:44,333) INFO - qlib.workflow - [record_temp.py:198] - Signal record 'pred.pkl' has been saved as the artifact of the Experiment 17
'The following are prediction results of the GRU model.'
                          score
datetime   instrument          
2019-03-25 SH600000    0.068169
           SH600004    0.273756
           SH600009    0.012879
           SH600010    0.073945
           SH600011   -0.166581
[3380957:MainThread](2024-04-25 20:47:46,068) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
train tasks:  64%|██████▎   | 28/44 [37:24<21:08, 79.30s/it][3380957:MainThread](2024-04-25 20:47:46,079) INFO - qlib.workflow - [exp.py:258] - Experiment 17 starts running ...
[3380957:MainThread](2024-04-25 20:47:46,092) INFO - qlib.workflow - [recorder.py:341] - Recorder fc0431df01024d80a5d19c76defad833 starts running under Experiment 17 ...
[3380957:MainThread](2024-04-25 20:47:46,973) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[3380957:MainThread](2024-04-25 20:47:46,974) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 5000
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[3380957:MainThread](2024-04-25 20:47:46,978) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[3380957:MainThread](2024-04-25 20:47:46,978) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
[3380957:MainThread](2024-04-25 20:47:55,073) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      1.855959
            SH600004      1.855959
            SH600006      1.855959
            SH600007      1.855959
            SH600008      1.855959
                            ...   
2017-06-09  SZ300133      1.797257
            SZ300144      1.797257
            SZ300146      1.797257
            SZ300182      1.797257
            SZ300251      1.797257
Length: 635820, dtype: float64
[3380957:MainThread](2024-04-25 20:47:55,078) INFO - qlib.GRU - [pytorch_gru.py:267] - training...
[3380957:MainThread](2024-04-25 20:47:55,079) INFO - qlib.GRU - [pytorch_gru.py:271] - Epoch0:
[3380957:MainThread](2024-04-25 20:47:55,079) INFO - qlib.GRU - [pytorch_gru.py:272] - training...
Killed

2024-04-23 01:09:51.396 | WARNING  | qlib.tests.data:qlib_data:175 - Data already exists: ~/.qlib/qlib_data/cn_data, the data download will be skipped
	If downloading is required: `exists_skip=False` or `change target_dir`
[2233072:MainThread](2024-04-23 01:09:51,398) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[2233072:MainThread](2024-04-23 01:09:51,400) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[2233072:MainThread](2024-04-23 01:09:51,400) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/cn_data')}
Remove CSRankNorm
{'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': datetime.date(2008, 1, 1), 'end_time': datetime.date(2020, 8, 1), 'fit_start_time': datetime.date(2008, 1, 1), 'fit_end_time': datetime.date(2014, 12, 31), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
[2233072:MainThread](2024-04-23 01:09:51,430) INFO - qlib.RollingBenchmark - [rolling_benchmark.py:208] - {'model': {'class': 'TransformerModel', 'module_path': 'qlib.contrib.model.pytorch_transformer', 'kwargs': {'d_feat': 6, 'seed': None, 'dim_feedforward': 32, 'reg': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/baseline/cn_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': [datetime.date(2008, 1, 1), datetime.date(2014, 12, 31)], 'valid': [datetime.date(2015, 1, 1), datetime.date(2016, 12, 31)], 'test': [datetime.date(2017, 1, 1), datetime.date(2020, 8, 1)]}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
[2233072:MainThread](2024-04-23 01:09:51,432) WARNING - qlib.data - [data.py:666] - load calendar error: freq=day, future=True; return current calendar!
[2233072:MainThread](2024-04-23 01:09:51,432) WARNING - qlib.data - [data.py:669] - You can get future calendar by referring to the following document: https://github.com/microsoft/qlib/blob/main/scripts/data_collector/contrib/README.md
[2233072:MainThread](2024-04-23 01:09:51,478) INFO - qlib.MetaDatasetDS - [dataset.py:316] - Example task for training meta model: {'model': {'class': 'TransformerModel', 'module_path': 'qlib.contrib.model.pytorch_transformer', 'kwargs': {'d_feat': 6, 'seed': None, 'dim_feedforward': 32, 'reg': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks_dynamic/baseline/cn_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-02 00:00:00'), Timestamp('2014-12-31 00:00:00')), 'valid': (Timestamp('2015-01-05 00:00:00'), Timestamp('2016-12-29 00:00:00')), 'test': (Timestamp('2017-01-03 00:00:00'), Timestamp('2017-02-06 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/44 [00:00<?, ?it/s]creating meta tasks:   2%|▏         | 1/44 [00:00<00:17,  2.45it/s]creating meta tasks:   5%|▍         | 2/44 [00:00<00:16,  2.57it/s]creating meta tasks:   7%|▋         | 3/44 [00:01<00:15,  2.59it/s]creating meta tasks:   9%|▉         | 4/44 [00:01<00:15,  2.59it/s]creating meta tasks:  11%|█▏        | 5/44 [00:01<00:15,  2.58it/s]creating meta tasks:  14%|█▎        | 6/44 [00:02<00:17,  2.21it/s]creating meta tasks:  16%|█▌        | 7/44 [00:02<00:15,  2.32it/s]creating meta tasks:  18%|█▊        | 8/44 [00:03<00:15,  2.38it/s]creating meta tasks:  20%|██        | 9/44 [00:03<00:14,  2.43it/s]creating meta tasks:  23%|██▎       | 10/44 [00:04<00:14,  2.27it/s]creating meta tasks:  25%|██▌       | 11/44 [00:04<00:14,  2.28it/s]creating meta tasks:  27%|██▋       | 12/44 [00:05<00:14,  2.28it/s]creating meta tasks:  30%|██▉       | 13/44 [00:05<00:13,  2.29it/s]creating meta tasks:  32%|███▏      | 14/44 [00:05<00:13,  2.29it/s]creating meta tasks:  34%|███▍      | 15/44 [00:06<00:12,  2.34it/s]creating meta tasks:  36%|███▋      | 16/44 [00:06<00:12,  2.32it/s]creating meta tasks:  39%|███▊      | 17/44 [00:07<00:11,  2.30it/s]creating meta tasks:  41%|████      | 18/44 [00:07<00:11,  2.33it/s]creating meta tasks:  43%|████▎     | 19/44 [00:08<00:10,  2.41it/s]creating meta tasks:  45%|████▌     | 20/44 [00:08<00:09,  2.46it/s]creating meta tasks:  48%|████▊     | 21/44 [00:08<00:09,  2.49it/s]creating meta tasks:  50%|█████     | 22/44 [00:09<00:08,  2.51it/s]creating meta tasks:  52%|█████▏    | 23/44 [00:09<00:08,  2.52it/s]creating meta tasks:  55%|█████▍    | 24/44 [00:09<00:07,  2.52it/s]creating meta tasks:  57%|█████▋    | 25/44 [00:10<00:07,  2.53it/s]creating meta tasks:  59%|█████▉    | 26/44 [00:10<00:07,  2.53it/s]creating meta tasks:  61%|██████▏   | 27/44 [00:11<00:06,  2.53it/s]creating meta tasks:  64%|██████▎   | 28/44 [00:11<00:06,  2.52it/s]creating meta tasks:  66%|██████▌   | 29/44 [00:11<00:05,  2.51it/s]creating meta tasks:  68%|██████▊   | 30/44 [00:12<00:05,  2.50it/s]creating meta tasks:  70%|███████   | 31/44 [00:12<00:05,  2.50it/s]creating meta tasks:  73%|███████▎  | 32/44 [00:13<00:04,  2.49it/s]creating meta tasks:  75%|███████▌  | 33/44 [00:13<00:04,  2.48it/s]creating meta tasks:  77%|███████▋  | 34/44 [00:13<00:04,  2.47it/s]creating meta tasks:  80%|███████▉  | 35/44 [00:14<00:03,  2.47it/s]creating meta tasks:  82%|████████▏ | 36/44 [00:14<00:03,  2.46it/s]creating meta tasks:  84%|████████▍ | 37/44 [00:15<00:02,  2.45it/s]creating meta tasks:  86%|████████▋ | 38/44 [00:15<00:02,  2.45it/s]creating meta tasks:  89%|████████▊ | 39/44 [00:16<00:02,  2.44it/s]creating meta tasks:  91%|█████████ | 40/44 [00:16<00:01,  2.43it/s]creating meta tasks:  93%|█████████▎| 41/44 [00:16<00:01,  2.42it/s]creating meta tasks:  95%|█████████▌| 42/44 [00:17<00:00,  2.41it/s]creating meta tasks:  98%|█████████▊| 43/44 [00:17<00:00,  2.41it/s]creating meta tasks: 100%|██████████| 44/44 [00:18<00:00,  2.40it/s]creating meta tasks: 100%|██████████| 44/44 [00:18<00:00,  2.43it/s]
train tasks:   0%|          | 0/44 [00:00<?, ?it/s][2233072:MainThread](2024-04-23 01:10:09,848) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name rolling_cn_data_csi300_Transformer_alpha360_h1_step20_rankFalse_2024-04-23_01:10:09_DDG-DA.
[2233072:MainThread](2024-04-23 01:10:09,861) INFO - qlib.workflow - [exp.py:258] - Experiment 20 starts running ...
[2233072:MainThread](2024-04-23 01:10:10,029) INFO - qlib.workflow - [recorder.py:341] - Recorder a25930329fbb463984c042d2fa8530b5 starts running under Experiment 20 ...
[2233072:MainThread](2024-04-23 01:10:10,856) INFO - qlib.TransformerModel - [pytorch_transformer.py:66] - Naive Transformer:
batch_size : 2048
dim : 32
[2233072:MainThread](2024-04-23 01:10:20,821) INFO - qlib.data selection - [model.py:40] - Reweighting result: datetime    instrument
2008-01-02  SH600000      0.531170
            SH600004      0.531170
            SH600006      0.531170
            SH600007      0.531170
            SH600008      0.531170
                            ...   
2014-12-31  SZ300070      1.926194
            SZ300124      1.926194
            SZ300133      1.926194
            SZ300146      1.926194
            SZ300251      1.926194
Length: 478007, dtype: float64
[2233072:MainThread](2024-04-23 01:10:20,824) INFO - qlib.TransformerModel - [pytorch_transformer.py:212] - training...
[2233072:MainThread](2024-04-23 01:10:20,824) INFO - qlib.TransformerModel - [pytorch_transformer.py:216] - Epoch0:
[2233072:MainThread](2024-04-23 01:10:20,825) INFO - qlib.TransformerModel - [pytorch_transformer.py:217] - training...
[2233072:MainThread](2024-04-23 01:10:26,442) INFO - qlib.TransformerModel - [pytorch_transformer.py:219] - evaluating...
[2233072:MainThread](2024-04-23 01:10:26,909) INFO - qlib.TransformerModel - [pytorch_transformer.py:222] - valid -0.995820
[2233072:MainThread](2024-04-23 01:10:26,912) INFO - qlib.TransformerModel - [pytorch_transformer.py:216] - Epoch1:
[2233072:MainThread](2024-04-23 01:10:26,913) INFO - qlib.TransformerModel - [pytorch_transformer.py:217] - training...
[2233072:MainThread](2024-04-23 01:10:31,195) INFO - qlib.TransformerModel - [pytorch_transformer.py:219] - evaluating...
[2233072:MainThread](2024-04-23 01:10:31,658) INFO - qlib.TransformerModel - [pytorch_transformer.py:222] - valid -0.995825
[2233072:MainThread](2024-04-23 01:10:31,659) INFO - qlib.TransformerModel - [pytorch_transformer.py:216] - Epoch2:
[2233072:MainThread](2024-04-23 01:10:31,659) INFO - qlib.TransformerModel - [pytorch_transformer.py:217] - training...
[2233072:MainThread](2024-04-23 01:10:35,933) INFO - qlib.TransformerModel - [pytorch_transformer.py:219] - evaluating...
[2233072:MainThread](2024-04-23 01:10:36,398) INFO - qlib.TransformerModel - [pytorch_transformer.py:222] - valid -0.996285
[2233072:MainThread](2024-04-23 01:10:36,398) INFO - qlib.TransformerModel - [pytorch_transformer.py:216] - Epoch3:
[2233072:MainThread](2024-04-23 01:10:36,399) INFO - qlib.TransformerModel - [pytorch_transformer.py:217] - training...
[2233072:MainThread](2024-04-23 01:10:40,668) INFO - qlib.TransformerModel - [pytorch_transformer.py:219] - evaluating...
[2233072:MainThread](2024-04-23 01:10:41,134) INFO - qlib.TransformerModel - [pytorch_transformer.py:222] - valid -0.995442
[2233072:MainThread](2024-04-23 01:10:41,138) INFO - qlib.TransformerModel - [pytorch_transformer.py:216] - Epoch4:
[2233072:MainThread](2024-04-23 01:10:41,138) INFO - qlib.TransformerModel - [pytorch_transformer.py:217] - training...
[2233072:MainThread](2024-04-23 01:10:45,419) INFO - qlib.TransformerModel - [pytorch_transformer.py:219] - evaluating...
[2233072:MainThread](2024-04-23 01:10:45,882) INFO - qlib.TransformerModel - [pytorch_transformer.py:222] - valid -0.996985
[2233072:MainThread](2024-04-23 01:10:45,883) INFO - qlib.TransformerModel - [pytorch_transformer.py:216] - Epoch5:
[2233072:MainThread](2024-04-23 01:10:45,883) INFO - qlib.TransformerModel - [pytorch_transformer.py:217] - training...
Terminated

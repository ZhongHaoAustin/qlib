['main.py', 'run_all', '--forecast_model', 'GRU', '-num_head', '8', '--train_start=2008-01-01', '--train_end=2018-12-31', '--valid_start=2019-01-01', '--valid_end=2020-03-31', '--test_start=2020-04-01', '--test_end=2024-03-31', '--tau', '10', '--lr_da', '0.01', '--market', 'csi500', '--data_dir', 'crowd_data', '--rank_label', 'False', '--begin_valid_epoch', '30']
[2928948:MainThread](2024-04-24 22:04:05,920) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[2928948:MainThread](2024-04-24 22:04:05,923) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[2928948:MainThread](2024-04-24 22:04:05,923) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/crowd_data')}
Remove CSRankNorm
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi500', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
[2928948:MainThread](2024-04-24 22:04:59,485) INFO - qlib.timer - [log.py:127] - Time cost: 53.550s | Loading data Done
[2928948:MainThread](2024-04-24 22:09:35,843) INFO - qlib.timer - [log.py:127] - Time cost: 272.528s | RobustZScoreNorm Done
[2928948:MainThread](2024-04-24 22:09:40,229) INFO - qlib.timer - [log.py:127] - Time cost: 4.386s | Fillna Done
[2928948:MainThread](2024-04-24 22:09:43,070) INFO - qlib.timer - [log.py:127] - Time cost: 1.531s | DropnaLabel Done
[2928948:MainThread](2024-04-24 22:09:52,641) INFO - qlib.timer - [log.py:127] - Time cost: 9.570s | CSZScoreNorm Done
[2928948:MainThread](2024-04-24 22:09:52,648) INFO - qlib.timer - [log.py:127] - Time cost: 293.162s | fit & process data Done
[2928948:MainThread](2024-04-24 22:09:52,648) INFO - qlib.timer - [log.py:127] - Time cost: 346.713s | Init data Done
Save handler file to /home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi500_rankFalse_alpha360_handler_horizon1.pkl
Task: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi500_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
[2928948:MainThread](2024-04-24 22:10:40,645) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi500_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-02 00:00:00'), Timestamp('2008-01-29 00:00:00')), 'test': (Timestamp('2008-01-31 00:00:00'), Timestamp('2008-03-05 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/147 [00:00<?, ?it/s]creating meta tasks:  25%|██▌       | 37/147 [00:00<00:00, 366.95it/s]creating meta tasks:  54%|█████▍    | 80/147 [00:00<00:00, 400.95it/s]creating meta tasks:  84%|████████▎ | 123/147 [00:00<00:00, 411.52it/s]creating meta tasks: 100%|██████████| 147/147 [00:00<00:00, 408.31it/s]
[2928948:MainThread](2024-04-24 22:10:41,406) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'GRU', 'module_path': 'qlib.contrib.model.pytorch_gru', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi500_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2019-01-02 00:00:00'), Timestamp('2019-01-29 00:00:00')), 'test': (Timestamp('2019-01-31 00:00:00'), Timestamp('2019-03-06 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/63 [00:00<?, ?it/s]creating meta tasks:  52%|█████▏    | 33/63 [00:00<00:00, 328.79it/s]creating meta tasks: 100%|██████████| 63/63 [00:00<00:00, 367.24it/s]
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2928948:MainThread](2024-04-24 22:10:42,901) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2928948:MainThread](2024-04-24 22:10:43,117) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2928948:MainThread](2024-04-24 22:10:43,119) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2928948:MainThread](2024-04-24 22:10:43,119) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:12<19:51, 12.04s/it]epoch:   2%|▏         | 2/100 [00:23<18:47, 11.51s/it]epoch:   3%|▎         | 3/100 [00:34<18:28, 11.43s/it]epoch:   4%|▍         | 4/100 [00:45<18:07, 11.33s/it]epoch:   5%|▌         | 5/100 [00:56<17:41, 11.17s/it]epoch:   6%|▌         | 6/100 [01:07<17:26, 11.13s/it]epoch:   7%|▋         | 7/100 [01:18<17:18, 11.16s/it]epoch:   8%|▊         | 8/100 [01:29<17:05, 11.15s/it]epoch:   9%|▉         | 9/100 [01:40<16:45, 11.05s/it]epoch:  10%|█         | 10/100 [01:51<16:33, 11.04s/it]epoch:  11%|█         | 11/100 [02:03<16:28, 11.11s/it]epoch:  12%|█▏        | 12/100 [02:14<16:20, 11.14s/it]epoch:  13%|█▎        | 13/100 [02:25<16:03, 11.07s/it]epoch:  14%|█▍        | 14/100 [02:36<15:49, 11.04s/it]epoch:  15%|█▌        | 15/100 [02:47<15:43, 11.10s/it]epoch:  16%|█▌        | 16/100 [02:58<15:32, 11.10s/it]epoch:  17%|█▋        | 17/100 [03:09<15:17, 11.05s/it]epoch:  18%|█▊        | 18/100 [03:20<15:06, 11.05s/it]epoch:  19%|█▉        | 19/100 [03:31<14:59, 11.11s/it]epoch:  20%|██        | 20/100 [03:42<14:47, 11.09s/it]epoch:  21%|██        | 21/100 [03:53<14:30, 11.02s/it]epoch:  22%|██▏       | 22/100 [04:04<14:22, 11.06s/it]epoch:  23%|██▎       | 23/100 [04:16<14:17, 11.14s/it]epoch:  24%|██▍       | 24/100 [04:27<14:04, 11.11s/it]epoch:  25%|██▌       | 25/100 [04:38<13:49, 11.07s/it]epoch:  26%|██▌       | 26/100 [04:49<13:41, 11.11s/it]epoch:  27%|██▋       | 27/100 [05:00<13:32, 11.14s/it]epoch:  28%|██▊       | 28/100 [05:11<13:20, 11.12s/it]epoch:  29%|██▉       | 29/100 [05:22<13:06, 11.08s/it]epoch:  30%|███       | 30/100 [05:33<12:58, 11.12s/it]0.05695832983556241
best ic: 0.05695832983556241
epoch:  31%|███       | 31/100 [05:47<13:37, 11.84s/it]0.058016074710963275
best ic: 0.058016074710963275
epoch:  32%|███▏      | 32/100 [05:59<13:38, 12.04s/it]0.05647564534982814
epoch:  33%|███▎      | 33/100 [06:12<13:35, 12.18s/it]0.059763520150267646
best ic: 0.059763520150267646
epoch:  34%|███▍      | 34/100 [06:25<13:35, 12.35s/it]0.05800082507663217
epoch:  35%|███▌      | 35/100 [06:37<13:30, 12.47s/it]0.0572614806412134
epoch:  36%|███▌      | 36/100 [06:50<13:16, 12.45s/it]0.06030606830096825
best ic: 0.06030606830096825
epoch:  37%|███▋      | 37/100 [07:02<13:07, 12.49s/it]0.05886445541288963
epoch:  38%|███▊      | 38/100 [07:15<13:00, 12.60s/it]0.05660208129098133
epoch:  39%|███▉      | 39/100 [07:28<12:46, 12.56s/it]0.05691355443458408
epoch:  40%|████      | 40/100 [07:40<12:31, 12.52s/it]0.056647506177435754
epoch:  41%|████      | 41/100 [07:53<12:21, 12.57s/it]0.058105518761365646
epoch:  42%|████▏     | 42/100 [08:06<12:13, 12.65s/it]0.0598547924264268
epoch:  43%|████▎     | 43/100 [08:18<11:57, 12.60s/it]0.05471790882817025
epoch:  44%|████▍     | 44/100 [08:31<11:45, 12.60s/it]0.05647453209437972
epoch:  44%|████▍     | 44/100 [08:44<11:06, 11.91s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2928948:MainThread](2024-04-24 22:19:31,366) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name csi500_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_22:10:42_online.
[2928948:MainThread](2024-04-24 22:19:31,396) INFO - qlib.workflow - [exp.py:258] - Experiment 40 starts running ...
[2928948:MainThread](2024-04-24 22:19:32,688) INFO - qlib.workflow - [recorder.py:341] - Recorder ac7f71efdc6649458e3c113de35ae889 starts running under Experiment 40 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:05, 11.59it/s]online:   6%|▋         | 4/63 [00:00<00:05, 11.12it/s]online:  10%|▉         | 6/63 [00:00<00:05, 10.91it/s]online:  13%|█▎        | 8/63 [00:00<00:05, 10.66it/s]online:  16%|█▌        | 10/63 [00:00<00:04, 10.64it/s]online:  19%|█▉        | 12/63 [00:01<00:04, 10.62it/s]online:  22%|██▏       | 14/63 [00:01<00:04, 10.23it/s]online:  25%|██▌       | 16/63 [00:01<00:04, 10.12it/s]online:  29%|██▊       | 18/63 [00:01<00:04, 10.02it/s]online:  32%|███▏      | 20/63 [00:01<00:04,  9.97it/s]online:  33%|███▎      | 21/63 [00:02<00:04,  9.96it/s]online:  35%|███▍      | 22/63 [00:02<00:04,  9.91it/s]online:  38%|███▊      | 24/63 [00:02<00:03, 10.02it/s]online:  40%|███▉      | 25/63 [00:02<00:03, 10.01it/s]online:  43%|████▎     | 27/63 [00:02<00:03, 10.05it/s]online:  46%|████▌     | 29/63 [00:02<00:03, 10.10it/s]online:  49%|████▉     | 31/63 [00:03<00:03, 10.10it/s]online:  52%|█████▏    | 33/63 [00:03<00:03,  9.94it/s]online:  56%|█████▌    | 35/63 [00:03<00:02, 10.31it/s]online:  59%|█████▊    | 37/63 [00:03<00:02, 10.09it/s]online:  62%|██████▏   | 39/63 [00:03<00:02,  9.99it/s]online:  65%|██████▌   | 41/63 [00:04<00:02,  9.96it/s]online:  67%|██████▋   | 42/63 [00:04<00:02,  9.95it/s]online:  70%|██████▉   | 44/63 [00:04<00:01,  9.89it/s]online:  71%|███████▏  | 45/63 [00:04<00:01,  9.88it/s]online:  75%|███████▍  | 47/63 [00:04<00:01,  9.93it/s]online:  78%|███████▊  | 49/63 [00:04<00:01,  9.95it/s]online:  81%|████████  | 51/63 [00:05<00:01,  9.93it/s]online:  84%|████████▍ | 53/63 [00:05<00:01,  9.91it/s]online:  86%|████████▌ | 54/63 [00:05<00:00,  9.85it/s]online:  87%|████████▋ | 55/63 [00:05<00:00,  9.75it/s]online:  89%|████████▉ | 56/63 [00:05<00:00,  9.80it/s]online:  90%|█████████ | 57/63 [00:05<00:00,  9.67it/s]online:  92%|█████████▏| 58/63 [00:05<00:00,  9.73it/s]online:  94%|█████████▎| 59/63 [00:05<00:00,  9.80it/s]online:  97%|█████████▋| 61/63 [00:06<00:00,  9.95it/s]online:  98%|█████████▊| 62/63 [00:06<00:00,  9.95it/s]online: 100%|██████████| 63/63 [00:06<00:00, 10.09it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2928948:MainThread](2024-04-24 22:19:54,632) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99788296 mae 0.6861681
{'IC': 0.02891690000013004,
 'ICIR': 0.26326419201305706,
 'Rank IC': 0.02552035915838527,
 'Rank ICIR': 0.23664898746209853}
[2928948:MainThread](2024-04-24 22:19:56,536) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2928948:MainThread](2024-04-24 22:20:10,139) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 22:20:10,142) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 22:20:16,330) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f9882c11e50>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 5/971 [00:00<00:19, 48.65it/s]backtest loop:   1%|          | 11/971 [00:00<00:18, 53.16it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:19, 48.72it/s]backtest loop:   2%|▏         | 23/971 [00:00<00:18, 50.85it/s]backtest loop:   3%|▎         | 29/971 [00:00<00:19, 47.91it/s]backtest loop:   4%|▎         | 35/971 [00:00<00:18, 49.79it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:18, 51.30it/s]backtest loop:   5%|▍         | 47/971 [00:00<00:17, 51.82it/s]backtest loop:   5%|▌         | 53/971 [00:01<00:17, 52.90it/s]backtest loop:   6%|▌         | 59/971 [00:01<00:18, 49.60it/s]backtest loop:   7%|▋         | 65/971 [00:01<00:17, 51.20it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:17, 52.06it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:17, 49.80it/s]backtest loop:   9%|▊         | 83/971 [00:01<00:17, 51.11it/s]backtest loop:   9%|▉         | 89/971 [00:01<00:16, 52.21it/s]backtest loop:  10%|▉         | 95/971 [00:01<00:16, 53.00it/s]backtest loop:  10%|█         | 101/971 [00:01<00:16, 53.13it/s]backtest loop:  11%|█         | 107/971 [00:02<00:17, 50.28it/s]backtest loop:  12%|█▏        | 113/971 [00:02<00:16, 51.28it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:16, 52.21it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:17, 49.62it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:17, 47.84it/s]backtest loop:  14%|█▍        | 137/971 [00:02<00:16, 49.50it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:16, 50.75it/s]backtest loop:  15%|█▌        | 149/971 [00:02<00:15, 51.60it/s]backtest loop:  16%|█▌        | 155/971 [00:03<00:15, 52.19it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:16, 49.44it/s]backtest loop:  17%|█▋        | 167/971 [00:03<00:15, 50.83it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:15, 51.91it/s]backtest loop:  18%|█▊        | 179/971 [00:03<00:15, 52.50it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:15, 50.86it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:14, 54.42it/s]backtest loop:  20%|██        | 198/971 [00:03<00:13, 55.65it/s]backtest loop:  21%|██        | 204/971 [00:03<00:13, 56.65it/s]backtest loop:  22%|██▏       | 210/971 [00:04<00:14, 53.29it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:14, 51.76it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:13, 54.74it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 53.75it/s]backtest loop:  24%|██▍       | 236/971 [00:04<00:13, 55.25it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:12, 56.53it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:13, 54.93it/s]backtest loop:  26%|██▋       | 255/971 [00:04<00:12, 55.73it/s]backtest loop:  27%|██▋       | 261/971 [00:04<00:12, 56.83it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:13, 53.98it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 55.40it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:12, 56.36it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:12, 57.16it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 54.30it/s]backtest loop:  31%|███       | 297/971 [00:05<00:12, 55.77it/s]backtest loop:  31%|███       | 303/971 [00:05<00:11, 56.88it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:11, 55.23it/s]backtest loop:  33%|███▎      | 316/971 [00:05<00:11, 56.35it/s]backtest loop:  33%|███▎      | 322/971 [00:06<00:11, 57.25it/s]backtest loop:  34%|███▍      | 329/971 [00:06<00:10, 59.10it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:11, 55.57it/s]backtest loop:  35%|███▌      | 341/971 [00:06<00:11, 56.78it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:10, 57.31it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:10, 59.17it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 56.86it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.22it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 53.20it/s]backtest loop:  39%|███▉      | 379/971 [00:07<00:10, 54.87it/s]backtest loop:  40%|███▉      | 385/971 [00:07<00:10, 56.12it/s]backtest loop:  40%|████      | 391/971 [00:07<00:10, 56.62it/s]backtest loop:  41%|████      | 397/971 [00:07<00:09, 57.50it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 54.46it/s]backtest loop:  42%|████▏     | 409/971 [00:07<00:10, 55.66it/s]backtest loop:  43%|████▎     | 415/971 [00:07<00:09, 56.49it/s]backtest loop:  43%|████▎     | 421/971 [00:07<00:09, 57.08it/s]backtest loop:  44%|████▍     | 427/971 [00:07<00:09, 57.36it/s]backtest loop:  45%|████▍     | 433/971 [00:08<00:09, 54.27it/s]backtest loop:  45%|████▌     | 439/971 [00:08<00:09, 55.25it/s]backtest loop:  46%|████▌     | 445/971 [00:08<00:09, 56.36it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:09, 57.16it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:09, 53.99it/s]backtest loop:  48%|████▊     | 463/971 [00:08<00:09, 55.25it/s]backtest loop:  48%|████▊     | 469/971 [00:08<00:08, 56.40it/s]backtest loop:  49%|████▉     | 475/971 [00:08<00:08, 57.13it/s]backtest loop:  50%|████▉     | 482/971 [00:08<00:08, 55.56it/s]backtest loop:  50%|█████     | 488/971 [00:09<00:08, 56.59it/s]backtest loop:  51%|█████     | 494/971 [00:09<00:08, 57.46it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 52.94it/s]backtest loop:  52%|█████▏    | 506/971 [00:09<00:08, 53.53it/s]backtest loop:  53%|█████▎    | 512/971 [00:09<00:09, 50.40it/s]backtest loop:  53%|█████▎    | 518/971 [00:09<00:08, 51.58it/s]backtest loop:  54%|█████▍    | 524/971 [00:09<00:08, 52.02it/s]backtest loop:  55%|█████▍    | 530/971 [00:09<00:08, 52.45it/s]backtest loop:  55%|█████▌    | 536/971 [00:09<00:08, 49.74it/s]backtest loop:  56%|█████▌    | 542/971 [00:10<00:08, 51.10it/s]backtest loop:  56%|█████▋    | 548/971 [00:10<00:08, 51.60it/s]backtest loop:  57%|█████▋    | 554/971 [00:10<00:07, 52.33it/s]backtest loop:  58%|█████▊    | 560/971 [00:10<00:07, 52.85it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:08, 50.00it/s]backtest loop:  59%|█████▉    | 572/971 [00:10<00:07, 51.16it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:07, 51.84it/s]backtest loop:  60%|██████    | 584/971 [00:10<00:07, 52.52it/s]backtest loop:  61%|██████    | 590/971 [00:11<00:07, 53.23it/s]backtest loop:  61%|██████▏   | 596/971 [00:11<00:07, 50.10it/s]backtest loop:  62%|██████▏   | 602/971 [00:11<00:07, 51.21it/s]backtest loop:  63%|██████▎   | 608/971 [00:11<00:06, 52.13it/s]backtest loop:  63%|██████▎   | 614/971 [00:11<00:06, 52.77it/s]backtest loop:  64%|██████▍   | 620/971 [00:11<00:07, 49.85it/s]backtest loop:  64%|██████▍   | 626/971 [00:11<00:06, 50.76it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:06, 51.68it/s]backtest loop:  66%|██████▌   | 638/971 [00:11<00:06, 52.37it/s]backtest loop:  66%|██████▋   | 644/971 [00:12<00:06, 52.84it/s]backtest loop:  67%|██████▋   | 650/971 [00:12<00:06, 50.08it/s]backtest loop:  68%|██████▊   | 656/971 [00:12<00:06, 51.48it/s]backtest loop:  68%|██████▊   | 662/971 [00:12<00:05, 52.02it/s]backtest loop:  69%|██████▉   | 668/971 [00:12<00:05, 52.57it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:05, 49.60it/s]backtest loop:  70%|███████   | 680/971 [00:12<00:05, 50.78it/s]backtest loop:  71%|███████   | 686/971 [00:12<00:05, 51.60it/s]backtest loop:  71%|███████▏  | 692/971 [00:12<00:05, 52.30it/s]backtest loop:  72%|███████▏  | 698/971 [00:13<00:05, 52.76it/s]backtest loop:  73%|███████▎  | 704/971 [00:13<00:05, 49.94it/s]backtest loop:  73%|███████▎  | 710/971 [00:13<00:05, 51.19it/s]backtest loop:  74%|███████▎  | 716/971 [00:13<00:04, 52.15it/s]backtest loop:  74%|███████▍  | 722/971 [00:13<00:04, 52.62it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 53.06it/s]backtest loop:  76%|███████▌  | 734/971 [00:13<00:04, 47.45it/s]backtest loop:  76%|███████▌  | 740/971 [00:13<00:04, 49.20it/s]backtest loop:  77%|███████▋  | 746/971 [00:14<00:04, 50.65it/s]backtest loop:  77%|███████▋  | 752/971 [00:14<00:04, 48.52it/s]backtest loop:  78%|███████▊  | 758/971 [00:14<00:04, 50.19it/s]backtest loop:  79%|███████▊  | 764/971 [00:14<00:04, 51.47it/s]backtest loop:  79%|███████▉  | 770/971 [00:14<00:04, 49.07it/s]backtest loop:  80%|███████▉  | 776/971 [00:14<00:03, 50.60it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 51.39it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 49.08it/s]backtest loop:  82%|████████▏ | 794/971 [00:15<00:03, 50.57it/s]backtest loop:  82%|████████▏ | 800/971 [00:15<00:03, 51.76it/s]backtest loop:  83%|████████▎ | 806/971 [00:15<00:03, 52.44it/s]backtest loop:  84%|████████▎ | 812/971 [00:15<00:02, 53.01it/s]backtest loop:  84%|████████▍ | 818/971 [00:15<00:03, 49.89it/s]backtest loop:  85%|████████▍ | 824/971 [00:15<00:02, 51.07it/s]backtest loop:  85%|████████▌ | 830/971 [00:15<00:02, 51.91it/s]backtest loop:  86%|████████▌ | 836/971 [00:15<00:02, 52.54it/s]backtest loop:  87%|████████▋ | 842/971 [00:15<00:02, 52.99it/s]backtest loop:  87%|████████▋ | 848/971 [00:16<00:02, 50.11it/s]backtest loop:  88%|████████▊ | 854/971 [00:16<00:02, 51.35it/s]backtest loop:  89%|████████▊ | 860/971 [00:16<00:02, 51.83it/s]backtest loop:  89%|████████▉ | 866/971 [00:16<00:02, 52.21it/s]backtest loop:  90%|████████▉ | 872/971 [00:16<00:01, 49.56it/s]backtest loop:  90%|█████████ | 878/971 [00:16<00:01, 50.77it/s]backtest loop:  91%|█████████ | 884/971 [00:16<00:01, 51.68it/s]backtest loop:  92%|█████████▏| 890/971 [00:16<00:01, 52.33it/s]backtest loop:  92%|█████████▏| 896/971 [00:16<00:01, 52.88it/s]backtest loop:  93%|█████████▎| 902/971 [00:17<00:01, 50.01it/s]backtest loop:  94%|█████████▎| 908/971 [00:17<00:01, 51.12it/s]backtest loop:  94%|█████████▍| 914/971 [00:17<00:01, 51.78it/s]backtest loop:  95%|█████████▍| 920/971 [00:17<00:00, 52.39it/s]backtest loop:  95%|█████████▌| 926/971 [00:17<00:00, 49.61it/s]backtest loop:  96%|█████████▌| 932/971 [00:17<00:00, 50.84it/s]backtest loop:  97%|█████████▋| 938/971 [00:17<00:00, 51.68it/s]backtest loop:  97%|█████████▋| 944/971 [00:17<00:00, 52.32it/s]backtest loop:  98%|█████████▊| 950/971 [00:18<00:00, 49.66it/s]backtest loop:  98%|█████████▊| 956/971 [00:18<00:00, 50.84it/s]backtest loop:  99%|█████████▉| 962/971 [00:18<00:00, 51.52it/s]backtest loop: 100%|█████████▉| 968/971 [00:18<00:00, 52.18it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 52.58it/s]
[2928948:MainThread](2024-04-24 22:20:34,870) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000387
std                0.004967
annualized_return  0.092217
information_ratio  1.203567
max_drawdown      -0.096260
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000193
std                0.004968
annualized_return  0.045907
information_ratio  0.598968
max_drawdown      -0.125400
[2928948:MainThread](2024-04-24 22:20:34,887) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_22:10:42_online`.
Round 1 Done!
{'1day.excess_return_with_cost.annualized_return': [0.045906596817093956],
 '1day.excess_return_with_cost.information_ratio': [0.5989675803012956],
 '1day.excess_return_with_cost.max_drawdown': [-0.12540023303514702],
 'IC': [0.02891690000013004],
 'ICIR': [0.26326419201305706],
 'Rank IC': [0.02552035915838527],
 'Rank ICIR': [0.23664898746209853],
 'mae': [0.6861680746078491],
 'mse': [0.9978829622268677]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2928948:MainThread](2024-04-24 22:20:36,211) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2928948:MainThread](2024-04-24 22:20:36,212) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2928948:MainThread](2024-04-24 22:20:36,213) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2928948:MainThread](2024-04-24 22:20:36,214) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:11<19:02, 11.54s/it]epoch:   2%|▏         | 2/100 [00:22<18:23, 11.26s/it]epoch:   3%|▎         | 3/100 [00:33<18:08, 11.22s/it]epoch:   4%|▍         | 4/100 [00:44<17:49, 11.14s/it]epoch:   5%|▌         | 5/100 [00:55<17:30, 11.06s/it]epoch:   6%|▌         | 6/100 [01:06<17:23, 11.10s/it]epoch:   7%|▋         | 7/100 [01:18<17:19, 11.18s/it]epoch:   8%|▊         | 8/100 [01:29<17:06, 11.16s/it]epoch:   9%|▉         | 9/100 [01:40<16:49, 11.10s/it]epoch:  10%|█         | 10/100 [01:51<16:42, 11.13s/it]epoch:  11%|█         | 11/100 [02:02<16:34, 11.18s/it]epoch:  12%|█▏        | 12/100 [02:13<16:20, 11.14s/it]epoch:  13%|█▎        | 13/100 [02:24<16:05, 11.10s/it]epoch:  14%|█▍        | 14/100 [02:36<15:58, 11.14s/it]epoch:  15%|█▌        | 15/100 [02:47<15:52, 11.20s/it]epoch:  16%|█▌        | 16/100 [02:58<15:35, 11.14s/it]epoch:  17%|█▋        | 17/100 [03:09<15:18, 11.06s/it]epoch:  18%|█▊        | 18/100 [03:20<15:11, 11.12s/it]epoch:  19%|█▉        | 19/100 [03:32<15:08, 11.21s/it]epoch:  20%|██        | 20/100 [03:43<14:52, 11.16s/it]epoch:  21%|██        | 21/100 [03:53<14:36, 11.09s/it]epoch:  22%|██▏       | 22/100 [04:05<14:26, 11.10s/it]epoch:  23%|██▎       | 23/100 [04:16<14:21, 11.19s/it]epoch:  24%|██▍       | 24/100 [04:27<14:07, 11.15s/it]epoch:  25%|██▌       | 25/100 [04:38<13:51, 11.08s/it]epoch:  26%|██▌       | 26/100 [04:49<13:40, 11.09s/it]epoch:  27%|██▋       | 27/100 [05:00<13:34, 11.16s/it]epoch:  28%|██▊       | 28/100 [05:12<13:24, 11.18s/it]epoch:  29%|██▉       | 29/100 [05:23<13:10, 11.13s/it]epoch:  30%|███       | 30/100 [05:34<13:00, 11.16s/it]0.05642397309324873
best ic: 0.05642397309324873
epoch:  31%|███       | 31/100 [05:47<13:23, 11.64s/it]0.05634229450813258
epoch:  32%|███▏      | 32/100 [05:59<13:29, 11.91s/it]0.0542718854708329
epoch:  33%|███▎      | 33/100 [06:12<13:27, 12.06s/it]0.0542498928554289
epoch:  34%|███▍      | 34/100 [06:24<13:27, 12.24s/it]0.05776063050126287
best ic: 0.05776063050126287
epoch:  35%|███▌      | 35/100 [06:37<13:27, 12.42s/it]0.05917716341699408
best ic: 0.05917716341699408
epoch:  36%|███▌      | 36/100 [06:49<13:14, 12.41s/it]0.05658029389864442
epoch:  37%|███▋      | 37/100 [07:02<13:05, 12.47s/it]0.05666422489179901
epoch:  38%|███▊      | 38/100 [07:15<12:59, 12.58s/it]0.05736674920939798
epoch:  39%|███▉      | 39/100 [07:28<12:48, 12.60s/it]0.05422511200029705
epoch:  40%|████      | 40/100 [07:40<12:32, 12.55s/it]0.05595509748513244
epoch:  41%|████      | 41/100 [07:53<12:21, 12.57s/it]0.056098449673918284
epoch:  42%|████▏     | 42/100 [08:06<12:17, 12.72s/it]0.05780471217461423
epoch:  43%|████▎     | 43/100 [08:18<12:03, 12.69s/it]0.05479034237035634
epoch:  43%|████▎     | 43/100 [08:31<11:17, 11.89s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2928948:MainThread](2024-04-24 22:29:07,572) INFO - qlib.workflow - [exp.py:258] - Experiment 40 starts running ...
[2928948:MainThread](2024-04-24 22:29:07,585) INFO - qlib.workflow - [recorder.py:341] - Recorder 7092ae45045646dab369bd10e6788023 starts running under Experiment 40 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:06,  9.07it/s]online:   5%|▍         | 3/63 [00:00<00:05, 10.53it/s]online:   8%|▊         | 5/63 [00:00<00:05, 10.69it/s]online:  11%|█         | 7/63 [00:00<00:05, 10.63it/s]online:  14%|█▍        | 9/63 [00:00<00:05, 10.66it/s]online:  17%|█▋        | 11/63 [00:01<00:04, 10.73it/s]online:  21%|██        | 13/63 [00:01<00:04, 10.78it/s]online:  24%|██▍       | 15/63 [00:01<00:04, 10.78it/s]online:  27%|██▋       | 17/63 [00:01<00:04, 10.75it/s]online:  30%|███       | 19/63 [00:01<00:04, 10.71it/s]online:  33%|███▎      | 21/63 [00:01<00:03, 10.82it/s]online:  37%|███▋      | 23/63 [00:02<00:03, 10.85it/s]online:  40%|███▉      | 25/63 [00:02<00:03, 10.85it/s]online:  43%|████▎     | 27/63 [00:02<00:03, 10.87it/s]online:  46%|████▌     | 29/63 [00:02<00:03, 10.82it/s]online:  49%|████▉     | 31/63 [00:02<00:02, 10.91it/s]online:  52%|█████▏    | 33/63 [00:03<00:02, 10.85it/s]online:  56%|█████▌    | 35/63 [00:03<00:02, 10.79it/s]online:  59%|█████▊    | 37/63 [00:03<00:02, 10.77it/s]online:  62%|██████▏   | 39/63 [00:03<00:02, 10.80it/s]online:  65%|██████▌   | 41/63 [00:03<00:02, 10.74it/s]online:  68%|██████▊   | 43/63 [00:03<00:01, 10.85it/s]online:  71%|███████▏  | 45/63 [00:04<00:01, 10.84it/s]online:  75%|███████▍  | 47/63 [00:04<00:01, 10.85it/s]online:  78%|███████▊  | 49/63 [00:04<00:01, 10.95it/s]online:  81%|████████  | 51/63 [00:04<00:01, 10.86it/s]online:  84%|████████▍ | 53/63 [00:04<00:00, 10.87it/s]online:  87%|████████▋ | 55/63 [00:05<00:00, 10.83it/s]online:  90%|█████████ | 57/63 [00:05<00:00, 10.88it/s]online:  94%|█████████▎| 59/63 [00:05<00:00, 10.92it/s]online:  97%|█████████▋| 61/63 [00:05<00:00, 10.86it/s]online: 100%|██████████| 63/63 [00:05<00:00, 11.00it/s]online: 100%|██████████| 63/63 [00:05<00:00, 10.82it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2928948:MainThread](2024-04-24 22:29:38,682) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9977895 mae 0.68615806
{'IC': 0.027223277140580798,
 'ICIR': 0.2457576703726845,
 'Rank IC': 0.019222991218935784,
 'Rank ICIR': 0.17981857761811082}
[2928948:MainThread](2024-04-24 22:29:40,866) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2928948:MainThread](2024-04-24 22:29:59,382) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 22:29:59,385) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 22:30:05,406) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f988ae93f10>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:43,  9.40it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 24.98it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:26, 35.65it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.27it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.81it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:18, 49.86it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:18, 49.55it/s]backtest loop:   5%|▍         | 46/971 [00:01<00:17, 53.55it/s]backtest loop:   5%|▌         | 53/971 [00:01<00:16, 56.25it/s]backtest loop:   6%|▌         | 59/971 [00:01<00:16, 53.86it/s]backtest loop:   7%|▋         | 66/971 [00:01<00:16, 56.51it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 53.91it/s]backtest loop:   8%|▊         | 79/971 [00:01<00:15, 56.52it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:15, 58.11it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:15, 55.52it/s]backtest loop:  10%|█         | 99/971 [00:02<00:15, 57.45it/s]backtest loop:  11%|█         | 105/971 [00:02<00:14, 57.86it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 55.86it/s]backtest loop:  12%|█▏        | 118/971 [00:02<00:15, 56.78it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 55.11it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 53.16it/s]backtest loop:  14%|█▍        | 137/971 [00:02<00:15, 54.94it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:14, 56.25it/s]backtest loop:  15%|█▌        | 149/971 [00:02<00:14, 57.15it/s]backtest loop:  16%|█▌        | 155/971 [00:03<00:14, 57.46it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 54.68it/s]backtest loop:  17%|█▋        | 167/971 [00:03<00:14, 56.01it/s]backtest loop:  18%|█▊        | 174/971 [00:03<00:13, 57.94it/s]backtest loop:  19%|█▊        | 180/971 [00:03<00:13, 58.47it/s]backtest loop:  19%|█▉        | 186/971 [00:03<00:14, 55.44it/s]backtest loop:  20%|█▉        | 193/971 [00:03<00:13, 57.58it/s]backtest loop:  21%|██        | 200/971 [00:03<00:13, 55.63it/s]backtest loop:  21%|██        | 206/971 [00:03<00:13, 56.65it/s]backtest loop:  22%|██▏       | 212/971 [00:04<00:13, 57.34it/s]backtest loop:  22%|██▏       | 218/971 [00:04<00:13, 54.89it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:13, 53.96it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:13, 55.51it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 56.62it/s]backtest loop:  25%|██▌       | 243/971 [00:04<00:12, 57.45it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:13, 51.89it/s]backtest loop:  26%|██▋       | 255/971 [00:04<00:14, 50.48it/s]backtest loop:  27%|██▋       | 261/971 [00:04<00:14, 49.22it/s]backtest loop:  27%|██▋       | 266/971 [00:05<00:16, 43.72it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:16, 42.68it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:16, 40.92it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:16, 41.40it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:16, 41.11it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:17, 38.53it/s]backtest loop:  30%|███       | 296/971 [00:05<00:17, 39.07it/s]backtest loop:  31%|███       | 300/971 [00:06<00:17, 37.93it/s]backtest loop:  31%|███▏      | 305/971 [00:06<00:16, 40.23it/s]backtest loop:  32%|███▏      | 310/971 [00:06<00:15, 42.09it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:16, 39.90it/s]backtest loop:  33%|███▎      | 320/971 [00:06<00:15, 41.00it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:14, 43.28it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:15, 41.96it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:14, 43.65it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:14, 44.10it/s]backtest loop:  36%|███▌      | 345/971 [00:07<00:14, 43.26it/s]backtest loop:  36%|███▌      | 350/971 [00:07<00:15, 41.16it/s]backtest loop:  37%|███▋      | 355/971 [00:07<00:15, 41.06it/s]backtest loop:  37%|███▋      | 360/971 [00:07<00:14, 43.14it/s]backtest loop:  38%|███▊      | 367/971 [00:07<00:13, 46.19it/s]backtest loop:  38%|███▊      | 373/971 [00:07<00:12, 46.81it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:11, 51.11it/s]backtest loop:  40%|███▉      | 386/971 [00:07<00:10, 53.24it/s]backtest loop:  40%|████      | 392/971 [00:07<00:10, 54.90it/s]backtest loop:  41%|████      | 398/971 [00:08<00:10, 53.05it/s]backtest loop:  42%|████▏     | 404/971 [00:08<00:10, 54.87it/s]backtest loop:  42%|████▏     | 410/971 [00:08<00:09, 56.13it/s]backtest loop:  43%|████▎     | 416/971 [00:08<00:09, 56.71it/s]backtest loop:  43%|████▎     | 422/971 [00:08<00:09, 57.49it/s]backtest loop:  44%|████▍     | 428/971 [00:08<00:09, 54.63it/s]backtest loop:  45%|████▍     | 434/971 [00:08<00:09, 55.71it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 57.73it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 54.61it/s]backtest loop:  47%|████▋     | 453/971 [00:09<00:09, 55.92it/s]backtest loop:  47%|████▋     | 459/971 [00:09<00:09, 56.36it/s]backtest loop:  48%|████▊     | 465/971 [00:09<00:08, 56.98it/s]backtest loop:  49%|████▊     | 471/971 [00:09<00:08, 57.39it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 54.87it/s]backtest loop:  50%|████▉     | 484/971 [00:09<00:08, 57.18it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:08, 54.35it/s]backtest loop:  51%|█████     | 497/971 [00:09<00:08, 56.59it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:08, 57.91it/s]backtest loop:  53%|█████▎    | 510/971 [00:10<00:08, 54.81it/s]backtest loop:  53%|█████▎    | 516/971 [00:10<00:08, 55.66it/s]backtest loop:  54%|█████▍    | 522/971 [00:10<00:08, 53.23it/s]backtest loop:  54%|█████▍    | 528/971 [00:10<00:08, 54.50it/s]backtest loop:  55%|█████▍    | 534/971 [00:10<00:07, 55.90it/s]backtest loop:  56%|█████▌    | 540/971 [00:10<00:07, 57.02it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 54.42it/s]backtest loop:  57%|█████▋    | 552/971 [00:10<00:07, 55.45it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 56.43it/s]backtest loop:  58%|█████▊    | 564/971 [00:11<00:07, 57.13it/s]backtest loop:  59%|█████▊    | 570/971 [00:11<00:06, 57.45it/s]backtest loop:  59%|█████▉    | 576/971 [00:11<00:07, 53.90it/s]backtest loop:  60%|█████▉    | 582/971 [00:11<00:07, 55.35it/s]backtest loop:  61%|██████    | 588/971 [00:11<00:06, 56.23it/s]backtest loop:  61%|██████    | 594/971 [00:11<00:06, 57.01it/s]backtest loop:  62%|██████▏   | 600/971 [00:11<00:06, 54.01it/s]backtest loop:  62%|██████▏   | 606/971 [00:11<00:06, 55.36it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 56.27it/s]backtest loop:  64%|██████▎   | 618/971 [00:12<00:06, 56.77it/s]backtest loop:  64%|██████▍   | 624/971 [00:12<00:06, 57.50it/s]backtest loop:  65%|██████▍   | 630/971 [00:12<00:06, 54.90it/s]backtest loop:  65%|██████▌   | 636/971 [00:12<00:06, 55.19it/s]backtest loop:  66%|██████▌   | 642/971 [00:12<00:05, 56.21it/s]backtest loop:  67%|██████▋   | 648/971 [00:12<00:05, 57.01it/s]backtest loop:  67%|██████▋   | 654/971 [00:12<00:05, 57.83it/s]backtest loop:  68%|██████▊   | 660/971 [00:12<00:05, 54.77it/s]backtest loop:  69%|██████▊   | 666/971 [00:12<00:05, 55.61it/s]backtest loop:  69%|██████▉   | 672/971 [00:12<00:05, 56.54it/s]backtest loop:  70%|██████▉   | 678/971 [00:13<00:05, 57.20it/s]backtest loop:  70%|███████   | 684/971 [00:13<00:05, 53.97it/s]backtest loop:  71%|███████   | 690/971 [00:13<00:05, 55.26it/s]backtest loop:  72%|███████▏  | 696/971 [00:13<00:04, 56.28it/s]backtest loop:  72%|███████▏  | 702/971 [00:13<00:04, 57.14it/s]backtest loop:  73%|███████▎  | 708/971 [00:13<00:04, 57.68it/s]backtest loop:  74%|███████▎  | 714/971 [00:13<00:04, 54.37it/s]backtest loop:  74%|███████▍  | 720/971 [00:13<00:04, 55.41it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 56.37it/s]backtest loop:  75%|███████▌  | 732/971 [00:14<00:04, 53.65it/s]backtest loop:  76%|███████▌  | 738/971 [00:14<00:04, 51.94it/s]backtest loop:  77%|███████▋  | 744/971 [00:14<00:04, 53.87it/s]backtest loop:  77%|███████▋  | 750/971 [00:14<00:04, 52.28it/s]backtest loop:  78%|███████▊  | 756/971 [00:14<00:03, 54.06it/s]backtest loop:  78%|███████▊  | 762/971 [00:14<00:03, 55.49it/s]backtest loop:  79%|███████▉  | 768/971 [00:14<00:03, 56.45it/s]backtest loop:  80%|███████▉  | 774/971 [00:14<00:03, 57.35it/s]backtest loop:  80%|████████  | 780/971 [00:14<00:03, 54.79it/s]backtest loop:  81%|████████  | 787/971 [00:15<00:03, 57.06it/s]backtest loop:  82%|████████▏ | 793/971 [00:15<00:03, 54.13it/s]backtest loop:  82%|████████▏ | 799/971 [00:15<00:03, 55.28it/s]backtest loop:  83%|████████▎ | 805/971 [00:15<00:02, 56.28it/s]backtest loop:  84%|████████▎ | 811/971 [00:15<00:02, 57.11it/s]backtest loop:  84%|████████▍ | 817/971 [00:15<00:02, 57.37it/s]backtest loop:  85%|████████▍ | 823/971 [00:15<00:02, 54.17it/s]backtest loop:  85%|████████▌ | 829/971 [00:15<00:02, 55.53it/s]backtest loop:  86%|████████▌ | 835/971 [00:15<00:02, 56.47it/s]backtest loop:  87%|████████▋ | 841/971 [00:16<00:02, 57.15it/s]backtest loop:  87%|████████▋ | 847/971 [00:16<00:02, 57.72it/s]backtest loop:  88%|████████▊ | 853/971 [00:16<00:02, 54.58it/s]backtest loop:  88%|████████▊ | 859/971 [00:16<00:02, 55.75it/s]backtest loop:  89%|████████▉ | 865/971 [00:16<00:01, 56.81it/s]backtest loop:  90%|████████▉ | 871/971 [00:16<00:01, 57.36it/s]backtest loop:  90%|█████████ | 877/971 [00:16<00:01, 54.34it/s]backtest loop:  91%|█████████ | 883/971 [00:16<00:01, 55.91it/s]backtest loop:  92%|█████████▏| 889/971 [00:16<00:01, 55.97it/s]backtest loop:  92%|█████████▏| 895/971 [00:16<00:01, 56.98it/s]backtest loop:  93%|█████████▎| 901/971 [00:17<00:01, 57.74it/s]backtest loop:  93%|█████████▎| 907/971 [00:17<00:01, 54.45it/s]backtest loop:  94%|█████████▍| 913/971 [00:17<00:01, 55.83it/s]backtest loop:  95%|█████████▍| 919/971 [00:17<00:00, 56.59it/s]backtest loop:  95%|█████████▌| 925/971 [00:17<00:00, 57.25it/s]backtest loop:  96%|█████████▌| 931/971 [00:17<00:00, 54.33it/s]backtest loop:  96%|█████████▋| 937/971 [00:17<00:00, 55.68it/s]backtest loop:  97%|█████████▋| 944/971 [00:17<00:00, 57.69it/s]backtest loop:  98%|█████████▊| 950/971 [00:17<00:00, 54.69it/s]backtest loop:  98%|█████████▊| 956/971 [00:18<00:00, 55.94it/s]backtest loop:  99%|█████████▉| 962/971 [00:18<00:00, 56.91it/s]backtest loop: 100%|█████████▉| 968/971 [00:18<00:00, 57.31it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 52.93it/s]
[2928948:MainThread](2024-04-24 22:30:23,822) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000443
std                0.004820
annualized_return  0.105458
information_ratio  1.418089
max_drawdown      -0.110603
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000250
std                0.004823
annualized_return  0.059472
information_ratio  0.799282
max_drawdown      -0.120261
[2928948:MainThread](2024-04-24 22:30:23,837) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_22:10:42_online`.
Round 2 Done!
{'1day.excess_return_with_cost.annualized_return': [0.045906596817093956,
                                                    0.05947199783795087],
 '1day.excess_return_with_cost.information_ratio': [0.5989675803012956,
                                                    0.7992822081517327],
 '1day.excess_return_with_cost.max_drawdown': [-0.12540023303514702,
                                               -0.12026081261057461],
 'IC': [0.02891690000013004, 0.027223277140580798],
 'ICIR': [0.26326419201305706, 0.2457576703726845],
 'Rank IC': [0.02552035915838527, 0.019222991218935784],
 'Rank ICIR': [0.23664898746209853, 0.17981857761811082],
 'mae': [0.6861680746078491, 0.6861580610275269],
 'mse': [0.9978829622268677, 0.9977895021438599]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2928948:MainThread](2024-04-24 22:30:25,280) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2928948:MainThread](2024-04-24 22:30:25,280) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2928948:MainThread](2024-04-24 22:30:25,310) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2928948:MainThread](2024-04-24 22:30:25,311) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:11<18:56, 11.48s/it]epoch:   2%|▏         | 2/100 [00:22<18:15, 11.18s/it]epoch:   3%|▎         | 3/100 [00:33<18:07, 11.21s/it]epoch:   4%|▍         | 4/100 [00:44<17:52, 11.17s/it]epoch:   5%|▌         | 5/100 [00:55<17:31, 11.07s/it]epoch:   6%|▌         | 6/100 [01:06<17:16, 11.03s/it]epoch:   7%|▋         | 7/100 [01:17<17:12, 11.11s/it]epoch:   8%|▊         | 8/100 [01:29<17:01, 11.11s/it]epoch:   9%|▉         | 9/100 [01:39<16:45, 11.05s/it]epoch:  10%|█         | 10/100 [01:50<16:32, 11.03s/it]epoch:  11%|█         | 11/100 [02:02<16:29, 11.11s/it]epoch:  12%|█▏        | 12/100 [02:13<16:20, 11.15s/it]epoch:  13%|█▎        | 13/100 [02:24<16:03, 11.08s/it]epoch:  14%|█▍        | 14/100 [02:35<15:46, 11.01s/it]epoch:  15%|█▌        | 15/100 [02:46<15:41, 11.08s/it]epoch:  16%|█▌        | 16/100 [02:57<15:32, 11.10s/it]epoch:  17%|█▋        | 17/100 [03:08<15:16, 11.04s/it]epoch:  18%|█▊        | 18/100 [03:19<15:01, 11.00s/it]epoch:  19%|█▉        | 19/100 [03:30<14:57, 11.08s/it]epoch:  20%|██        | 20/100 [03:41<14:49, 11.12s/it]epoch:  21%|██        | 21/100 [03:52<14:33, 11.06s/it]epoch:  22%|██▏       | 22/100 [04:03<14:20, 11.03s/it]epoch:  23%|██▎       | 23/100 [04:15<14:14, 11.10s/it]epoch:  24%|██▍       | 24/100 [04:26<14:08, 11.16s/it]epoch:  25%|██▌       | 25/100 [04:37<13:52, 11.10s/it]epoch:  26%|██▌       | 26/100 [04:48<13:38, 11.06s/it]epoch:  27%|██▋       | 27/100 [04:59<13:31, 11.12s/it]epoch:  28%|██▊       | 28/100 [05:10<13:23, 11.15s/it]epoch:  29%|██▉       | 29/100 [05:21<13:07, 11.09s/it]epoch:  30%|███       | 30/100 [05:32<12:55, 11.07s/it]0.0536252056746833
best ic: 0.0536252056746833
epoch:  31%|███       | 31/100 [05:45<13:22, 11.64s/it]0.051658042798112855
epoch:  32%|███▏      | 32/100 [05:58<13:34, 11.98s/it]0.05553205929749313
best ic: 0.05553205929749313
epoch:  33%|███▎      | 33/100 [06:11<13:34, 12.16s/it]0.057042196145924796
best ic: 0.057042196145924796
epoch:  34%|███▍      | 34/100 [06:23<13:30, 12.29s/it]0.05508899310437139
epoch:  35%|███▌      | 35/100 [06:36<13:30, 12.47s/it]0.054653476624042956
epoch:  36%|███▌      | 36/100 [06:49<13:28, 12.63s/it]0.0563738972232543
epoch:  37%|███▋      | 37/100 [07:01<13:12, 12.57s/it]0.054873731318625024
epoch:  38%|███▊      | 38/100 [07:14<13:01, 12.60s/it]0.052229247818326933
epoch:  39%|███▉      | 39/100 [07:27<12:58, 12.76s/it]0.057858403228892165
best ic: 0.057858403228892165
epoch:  40%|████      | 40/100 [07:40<12:42, 12.70s/it]0.05538844118596638
epoch:  41%|████      | 41/100 [07:52<12:24, 12.62s/it]0.05729936565511732
epoch:  42%|████▏     | 42/100 [08:05<12:14, 12.66s/it]0.05580550519438699
epoch:  43%|████▎     | 43/100 [08:18<12:03, 12.70s/it]0.05621432633869136
epoch:  44%|████▍     | 44/100 [08:30<11:47, 12.64s/it]0.057196101550508846
epoch:  45%|████▌     | 45/100 [08:43<11:34, 12.62s/it]0.05649011134851895
epoch:  46%|████▌     | 46/100 [08:56<11:24, 12.67s/it]0.0557632981580128
epoch:  47%|████▋     | 47/100 [09:08<11:13, 12.70s/it]0.0568481158567054
epoch:  47%|████▋     | 47/100 [09:21<10:33, 11.94s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2928948:MainThread](2024-04-24 22:39:46,712) INFO - qlib.workflow - [exp.py:258] - Experiment 40 starts running ...
[2928948:MainThread](2024-04-24 22:39:46,725) INFO - qlib.workflow - [recorder.py:341] - Recorder 5a1453554bb04e728f2df725d2707853 starts running under Experiment 40 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:06,  9.86it/s]online:   6%|▋         | 4/63 [00:00<00:06,  9.78it/s]online:   8%|▊         | 5/63 [00:00<00:05,  9.80it/s]online:  11%|█         | 7/63 [00:00<00:05, 10.13it/s]online:  14%|█▍        | 9/63 [00:00<00:05, 10.46it/s]online:  17%|█▋        | 11/63 [00:01<00:04, 10.62it/s]online:  21%|██        | 13/63 [00:01<00:04, 10.72it/s]online:  24%|██▍       | 15/63 [00:01<00:04, 10.74it/s]online:  27%|██▋       | 17/63 [00:01<00:04, 10.71it/s]online:  30%|███       | 19/63 [00:01<00:04, 10.75it/s]online:  33%|███▎      | 21/63 [00:01<00:03, 10.83it/s]online:  37%|███▋      | 23/63 [00:02<00:03, 10.77it/s]online:  40%|███▉      | 25/63 [00:02<00:03, 10.82it/s]online:  43%|████▎     | 27/63 [00:02<00:03, 10.77it/s]online:  46%|████▌     | 29/63 [00:02<00:03, 10.77it/s]online:  49%|████▉     | 31/63 [00:02<00:02, 10.75it/s]online:  52%|█████▏    | 33/63 [00:03<00:02, 10.72it/s]online:  56%|█████▌    | 35/63 [00:03<00:02, 10.48it/s]online:  59%|█████▊    | 37/63 [00:03<00:02, 10.58it/s]online:  62%|██████▏   | 39/63 [00:03<00:02, 10.67it/s]online:  65%|██████▌   | 41/63 [00:03<00:02, 10.73it/s]online:  68%|██████▊   | 43/63 [00:04<00:01, 10.77it/s]online:  71%|███████▏  | 45/63 [00:04<00:01, 10.85it/s]online:  75%|███████▍  | 47/63 [00:04<00:01, 10.82it/s]online:  78%|███████▊  | 49/63 [00:04<00:01, 10.90it/s]online:  81%|████████  | 51/63 [00:04<00:01, 10.81it/s]online:  84%|████████▍ | 53/63 [00:04<00:00, 10.79it/s]online:  87%|████████▋ | 55/63 [00:05<00:00, 10.83it/s]online:  90%|█████████ | 57/63 [00:05<00:00, 10.84it/s]online:  94%|█████████▎| 59/63 [00:05<00:00, 10.81it/s]online:  97%|█████████▋| 61/63 [00:05<00:00, 10.82it/s]online: 100%|██████████| 63/63 [00:05<00:00, 10.87it/s]online: 100%|██████████| 63/63 [00:05<00:00, 10.70it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2928948:MainThread](2024-04-24 22:40:11,637) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99792373 mae 0.686071
{'IC': 0.02621109579435717,
 'ICIR': 0.24059646907054116,
 'Rank IC': 0.020849039173561842,
 'Rank ICIR': 0.19444642706951779}
[2928948:MainThread](2024-04-24 22:40:13,480) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2928948:MainThread](2024-04-24 22:40:28,430) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 22:40:28,433) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 22:40:34,440) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f975bf79ca0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:30, 10.66it/s]backtest loop:   1%|          | 9/971 [00:00<00:35, 27.04it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:25, 37.54it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:22, 41.82it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.45it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 48.14it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:19, 46.60it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:18, 49.14it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 50.73it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 48.31it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:18, 49.89it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 51.00it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:17, 52.40it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 52.97it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 50.20it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 52.03it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 52.79it/s]backtest loop:  11%|█         | 105/971 [00:02<00:16, 52.57it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:16, 53.35it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:17, 50.09it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 50.81it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:17, 48.87it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:16, 49.99it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:17, 48.13it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:16, 49.59it/s]backtest loop:  16%|█▌        | 152/971 [00:03<00:16, 49.60it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:16, 50.79it/s]backtest loop:  17%|█▋        | 164/971 [00:03<00:15, 51.68it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:15, 51.75it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:15, 50.94it/s]backtest loop:  19%|█▊        | 182/971 [00:03<00:14, 53.13it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:13, 56.00it/s]backtest loop:  20%|██        | 195/971 [00:03<00:14, 54.11it/s]backtest loop:  21%|██        | 202/971 [00:04<00:13, 57.25it/s]backtest loop:  22%|██▏       | 209/971 [00:04<00:12, 58.68it/s]backtest loop:  22%|██▏       | 215/971 [00:04<00:14, 52.44it/s]backtest loop:  23%|██▎       | 221/971 [00:04<00:14, 53.29it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:13, 53.50it/s]backtest loop:  24%|██▍       | 233/971 [00:04<00:13, 53.63it/s]backtest loop:  25%|██▍       | 239/971 [00:04<00:13, 54.20it/s]backtest loop:  25%|██▌       | 245/971 [00:04<00:14, 51.07it/s]backtest loop:  26%|██▌       | 251/971 [00:05<00:13, 51.86it/s]backtest loop:  26%|██▋       | 257/971 [00:05<00:13, 52.25it/s]backtest loop:  27%|██▋       | 263/971 [00:05<00:13, 53.01it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:14, 50.09it/s]backtest loop:  28%|██▊       | 275/971 [00:05<00:13, 50.82it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:14, 48.66it/s]backtest loop:  30%|██▉       | 287/971 [00:05<00:13, 50.24it/s]backtest loop:  30%|███       | 293/971 [00:05<00:13, 51.43it/s]backtest loop:  31%|███       | 299/971 [00:05<00:12, 51.74it/s]backtest loop:  31%|███▏      | 305/971 [00:06<00:13, 49.44it/s]backtest loop:  32%|███▏      | 311/971 [00:06<00:12, 51.02it/s]backtest loop:  33%|███▎      | 317/971 [00:06<00:12, 51.64it/s]backtest loop:  33%|███▎      | 323/971 [00:06<00:12, 52.86it/s]backtest loop:  34%|███▍      | 329/971 [00:06<00:12, 53.36it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:12, 50.39it/s]backtest loop:  35%|███▌      | 341/971 [00:06<00:12, 51.39it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:12, 51.90it/s]backtest loop:  36%|███▋      | 353/971 [00:07<00:11, 52.90it/s]backtest loop:  37%|███▋      | 359/971 [00:07<00:11, 53.48it/s]backtest loop:  38%|███▊      | 365/971 [00:07<00:11, 51.25it/s]backtest loop:  38%|███▊      | 371/971 [00:07<00:12, 49.10it/s]backtest loop:  39%|███▉      | 377/971 [00:07<00:11, 50.52it/s]backtest loop:  39%|███▉      | 383/971 [00:07<00:12, 48.40it/s]backtest loop:  40%|████      | 389/971 [00:07<00:11, 50.12it/s]backtest loop:  41%|████      | 395/971 [00:07<00:11, 51.21it/s]backtest loop:  41%|████▏     | 401/971 [00:07<00:10, 52.18it/s]backtest loop:  42%|████▏     | 407/971 [00:08<00:10, 52.88it/s]backtest loop:  43%|████▎     | 413/971 [00:08<00:10, 51.43it/s]backtest loop:  43%|████▎     | 419/971 [00:08<00:10, 53.10it/s]backtest loop:  44%|████▍     | 425/971 [00:08<00:10, 53.99it/s]backtest loop:  44%|████▍     | 431/971 [00:08<00:09, 55.28it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:10, 52.72it/s]backtest loop:  46%|████▌     | 443/971 [00:08<00:09, 54.15it/s]backtest loop:  46%|████▌     | 449/971 [00:08<00:09, 54.86it/s]backtest loop:  47%|████▋     | 455/971 [00:08<00:09, 55.92it/s]backtest loop:  47%|████▋     | 461/971 [00:09<00:09, 55.89it/s]backtest loop:  48%|████▊     | 467/971 [00:09<00:09, 53.23it/s]backtest loop:  49%|████▊     | 473/971 [00:09<00:09, 53.59it/s]backtest loop:  49%|████▉     | 480/971 [00:09<00:08, 56.40it/s]backtest loop:  50%|█████     | 486/971 [00:09<00:08, 57.24it/s]backtest loop:  51%|█████     | 492/971 [00:09<00:08, 54.09it/s]backtest loop:  51%|█████▏    | 498/971 [00:09<00:08, 55.14it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:08, 56.44it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:08, 54.03it/s]backtest loop:  53%|█████▎    | 516/971 [00:10<00:08, 55.10it/s]backtest loop:  54%|█████▍    | 522/971 [00:10<00:08, 52.85it/s]backtest loop:  54%|█████▍    | 528/971 [00:10<00:08, 54.65it/s]backtest loop:  55%|█████▍    | 534/971 [00:10<00:07, 55.82it/s]backtest loop:  56%|█████▌    | 540/971 [00:10<00:07, 56.87it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 54.10it/s]backtest loop:  57%|█████▋    | 552/971 [00:10<00:07, 55.53it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 56.72it/s]backtest loop:  58%|█████▊    | 565/971 [00:10<00:06, 58.43it/s]backtest loop:  59%|█████▉    | 571/971 [00:11<00:07, 55.15it/s]backtest loop:  59%|█████▉    | 577/971 [00:11<00:07, 56.10it/s]backtest loop:  60%|██████    | 583/971 [00:11<00:06, 56.84it/s]backtest loop:  61%|██████    | 589/971 [00:11<00:06, 57.41it/s]backtest loop:  61%|██████▏   | 595/971 [00:11<00:06, 58.05it/s]backtest loop:  62%|██████▏   | 601/971 [00:11<00:06, 54.70it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 55.71it/s]backtest loop:  63%|██████▎   | 613/971 [00:11<00:06, 56.52it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:06, 57.22it/s]backtest loop:  64%|██████▍   | 625/971 [00:12<00:06, 54.45it/s]backtest loop:  65%|██████▌   | 632/971 [00:12<00:05, 56.81it/s]backtest loop:  66%|██████▌   | 638/971 [00:12<00:05, 57.52it/s]backtest loop:  66%|██████▋   | 644/971 [00:12<00:05, 57.99it/s]backtest loop:  67%|██████▋   | 650/971 [00:12<00:05, 54.58it/s]backtest loop:  68%|██████▊   | 656/971 [00:12<00:05, 56.00it/s]backtest loop:  68%|██████▊   | 662/971 [00:12<00:05, 56.73it/s]backtest loop:  69%|██████▉   | 668/971 [00:12<00:05, 57.44it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:05, 53.84it/s]backtest loop:  70%|███████   | 680/971 [00:12<00:05, 55.37it/s]backtest loop:  71%|███████   | 686/971 [00:13<00:05, 56.18it/s]backtest loop:  71%|███████▏  | 692/971 [00:13<00:04, 57.02it/s]backtest loop:  72%|███████▏  | 698/971 [00:13<00:04, 57.62it/s]backtest loop:  73%|███████▎  | 704/971 [00:13<00:04, 54.52it/s]backtest loop:  73%|███████▎  | 710/971 [00:13<00:04, 55.73it/s]backtest loop:  74%|███████▎  | 716/971 [00:13<00:04, 56.26it/s]backtest loop:  74%|███████▍  | 722/971 [00:13<00:04, 57.12it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 57.93it/s]backtest loop:  76%|███████▌  | 734/971 [00:13<00:04, 50.29it/s]backtest loop:  76%|███████▌  | 740/971 [00:14<00:04, 52.48it/s]backtest loop:  77%|███████▋  | 746/971 [00:14<00:04, 54.27it/s]backtest loop:  77%|███████▋  | 752/971 [00:14<00:04, 52.54it/s]backtest loop:  78%|███████▊  | 758/971 [00:14<00:03, 54.18it/s]backtest loop:  79%|███████▊  | 764/971 [00:14<00:03, 55.36it/s]backtest loop:  79%|███████▉  | 770/971 [00:14<00:03, 54.41it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 57.43it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 54.76it/s]backtest loop:  81%|████████▏ | 789/971 [00:14<00:03, 55.97it/s]backtest loop:  82%|████████▏ | 795/971 [00:15<00:03, 56.84it/s]backtest loop:  82%|████████▏ | 801/971 [00:15<00:02, 57.52it/s]backtest loop:  83%|████████▎ | 807/971 [00:15<00:02, 57.85it/s]backtest loop:  84%|████████▎ | 813/971 [00:15<00:02, 54.54it/s]backtest loop:  84%|████████▍ | 819/971 [00:15<00:02, 55.53it/s]backtest loop:  85%|████████▍ | 825/971 [00:15<00:02, 56.50it/s]backtest loop:  86%|████████▌ | 831/971 [00:15<00:02, 57.16it/s]backtest loop:  86%|████████▌ | 837/971 [00:15<00:02, 57.66it/s]backtest loop:  87%|████████▋ | 843/971 [00:15<00:02, 54.40it/s]backtest loop:  87%|████████▋ | 849/971 [00:16<00:02, 55.66it/s]backtest loop:  88%|████████▊ | 855/971 [00:16<00:02, 56.59it/s]backtest loop:  89%|████████▊ | 861/971 [00:16<00:01, 57.33it/s]backtest loop:  89%|████████▉ | 867/971 [00:16<00:01, 54.46it/s]backtest loop:  90%|████████▉ | 873/971 [00:16<00:01, 55.38it/s]backtest loop:  91%|█████████ | 879/971 [00:16<00:01, 56.38it/s]backtest loop:  91%|█████████ | 885/971 [00:16<00:01, 57.10it/s]backtest loop:  92%|█████████▏| 891/971 [00:16<00:01, 57.66it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 54.55it/s]backtest loop:  93%|█████████▎| 903/971 [00:16<00:01, 55.83it/s]backtest loop:  94%|█████████▎| 909/971 [00:17<00:01, 56.70it/s]backtest loop:  94%|█████████▍| 915/971 [00:17<00:00, 57.37it/s]backtest loop:  95%|█████████▍| 921/971 [00:17<00:00, 53.98it/s]backtest loop:  95%|█████████▌| 927/971 [00:17<00:00, 55.12it/s]backtest loop:  96%|█████████▌| 933/971 [00:17<00:00, 56.20it/s]backtest loop:  97%|█████████▋| 940/971 [00:17<00:00, 54.55it/s]backtest loop:  97%|█████████▋| 946/971 [00:17<00:00, 55.73it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 56.76it/s]backtest loop:  99%|█████████▊| 958/971 [00:17<00:00, 57.36it/s]backtest loop:  99%|█████████▉| 964/971 [00:18<00:00, 57.58it/s]backtest loop: 100%|█████████▉| 970/971 [00:18<00:00, 54.48it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 53.35it/s]
[2928948:MainThread](2024-04-24 22:40:52,710) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000410
std                0.004975
annualized_return  0.097663
information_ratio  1.272366
max_drawdown      -0.107484
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000219
std                0.004978
annualized_return  0.052021
information_ratio  0.677391
max_drawdown      -0.132296
[2928948:MainThread](2024-04-24 22:40:52,726) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_22:10:42_online`.
Round 3 Done!
{'1day.excess_return_with_cost.annualized_return': [0.045906596817093956,
                                                    0.05947199783795087,
                                                    0.052020827576630645],
 '1day.excess_return_with_cost.information_ratio': [0.5989675803012956,
                                                    0.7992822081517327,
                                                    0.6773909197836762],
 '1day.excess_return_with_cost.max_drawdown': [-0.12540023303514702,
                                               -0.12026081261057461,
                                               -0.13229595910483233],
 'IC': [0.02891690000013004, 0.027223277140580798, 0.02621109579435717],
 'ICIR': [0.26326419201305706, 0.2457576703726845, 0.24059646907054116],
 'Rank IC': [0.02552035915838527, 0.019222991218935784, 0.020849039173561842],
 'Rank ICIR': [0.23664898746209853, 0.17981857761811082, 0.19444642706951779],
 'mae': [0.6861680746078491, 0.6861580610275269, 0.68607097864151],
 'mse': [0.9978829622268677, 0.9977895021438599, 0.997923731803894]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2928948:MainThread](2024-04-24 22:40:54,081) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2928948:MainThread](2024-04-24 22:40:54,082) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2928948:MainThread](2024-04-24 22:40:54,083) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2928948:MainThread](2024-04-24 22:40:54,084) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:11<19:00, 11.52s/it]epoch:   2%|▏         | 2/100 [00:22<18:22, 11.25s/it]epoch:   3%|▎         | 3/100 [00:33<18:12, 11.26s/it]epoch:   4%|▍         | 4/100 [00:44<17:50, 11.15s/it]epoch:   5%|▌         | 5/100 [00:55<17:32, 11.08s/it]epoch:   6%|▌         | 6/100 [01:06<17:22, 11.09s/it]epoch:   7%|▋         | 7/100 [01:18<17:15, 11.13s/it]epoch:   8%|▊         | 8/100 [01:29<17:04, 11.13s/it]epoch:   9%|▉         | 9/100 [01:40<16:49, 11.10s/it]epoch:  10%|█         | 10/100 [01:51<16:36, 11.07s/it]epoch:  11%|█         | 11/100 [02:02<16:31, 11.14s/it]epoch:  12%|█▏        | 12/100 [02:13<16:19, 11.13s/it]epoch:  13%|█▎        | 13/100 [02:24<16:02, 11.07s/it]epoch:  14%|█▍        | 14/100 [02:35<15:49, 11.04s/it]epoch:  15%|█▌        | 15/100 [02:46<15:44, 11.11s/it]epoch:  16%|█▌        | 16/100 [02:58<15:34, 11.12s/it]epoch:  17%|█▋        | 17/100 [03:08<15:19, 11.08s/it]epoch:  18%|█▊        | 18/100 [03:20<15:09, 11.09s/it]epoch:  19%|█▉        | 19/100 [03:31<15:02, 11.14s/it]epoch:  20%|██        | 20/100 [03:42<14:50, 11.13s/it]epoch:  21%|██        | 21/100 [03:53<14:35, 11.08s/it]epoch:  22%|██▏       | 22/100 [04:04<14:25, 11.10s/it]epoch:  23%|██▎       | 23/100 [04:15<14:20, 11.17s/it]epoch:  24%|██▍       | 24/100 [04:27<14:08, 11.17s/it]epoch:  25%|██▌       | 25/100 [04:38<13:53, 11.12s/it]epoch:  26%|██▌       | 26/100 [04:49<13:43, 11.13s/it]epoch:  27%|██▋       | 27/100 [05:00<13:37, 11.21s/it]epoch:  28%|██▊       | 28/100 [05:11<13:23, 11.16s/it]epoch:  29%|██▉       | 29/100 [05:22<13:07, 11.09s/it]epoch:  30%|███       | 30/100 [05:33<12:58, 11.13s/it]0.05811988302911974
best ic: 0.05811988302911974
epoch:  31%|███       | 31/100 [05:46<13:25, 11.67s/it]0.05911926014892946
best ic: 0.05911926014892946
epoch:  32%|███▏      | 32/100 [05:59<13:32, 11.95s/it]0.056844229547877066
epoch:  33%|███▎      | 33/100 [06:11<13:31, 12.11s/it]0.05760990850134204
epoch:  34%|███▍      | 34/100 [06:24<13:29, 12.27s/it]0.0578694963874211
epoch:  35%|███▌      | 35/100 [06:37<13:31, 12.48s/it]0.05894801541362734
epoch:  36%|███▌      | 36/100 [06:49<13:18, 12.48s/it]0.05838974822230431
epoch:  37%|███▋      | 37/100 [07:02<13:05, 12.47s/it]0.054142372766105486
epoch:  38%|███▊      | 38/100 [07:15<12:57, 12.55s/it]0.057597386122601166
epoch:  39%|███▉      | 39/100 [07:27<12:50, 12.63s/it]0.05687109865655903
epoch:  39%|███▉      | 39/100 [07:40<12:00, 11.80s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2928948:MainThread](2024-04-24 22:48:34,478) INFO - qlib.workflow - [exp.py:258] - Experiment 40 starts running ...
[2928948:MainThread](2024-04-24 22:48:34,490) INFO - qlib.workflow - [recorder.py:341] - Recorder 6aacb47ea2fc451283618a851eadb532 starts running under Experiment 40 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:05, 11.26it/s]online:   6%|▋         | 4/63 [00:00<00:05, 10.74it/s]online:  10%|▉         | 6/63 [00:00<00:05, 10.26it/s]online:  13%|█▎        | 8/63 [00:00<00:05, 10.19it/s]online:  16%|█▌        | 10/63 [00:00<00:05, 10.05it/s]online:  19%|█▉        | 12/63 [00:01<00:04, 10.21it/s]online:  22%|██▏       | 14/63 [00:01<00:04, 10.34it/s]online:  25%|██▌       | 16/63 [00:01<00:04, 10.52it/s]online:  29%|██▊       | 18/63 [00:01<00:04, 10.64it/s]online:  32%|███▏      | 20/63 [00:01<00:04, 10.65it/s]online:  35%|███▍      | 22/63 [00:02<00:03, 10.80it/s]online:  38%|███▊      | 24/63 [00:02<00:03, 10.82it/s]online:  41%|████▏     | 26/63 [00:02<00:03, 10.78it/s]online:  44%|████▍     | 28/63 [00:02<00:03, 10.88it/s]online:  48%|████▊     | 30/63 [00:02<00:03, 10.85it/s]online:  51%|█████     | 32/63 [00:03<00:02, 10.88it/s]online:  54%|█████▍    | 34/63 [00:03<00:02, 10.82it/s]online:  57%|█████▋    | 36/63 [00:03<00:02, 10.82it/s]online:  60%|██████    | 38/63 [00:03<00:02, 10.84it/s]online:  63%|██████▎   | 40/63 [00:03<00:02, 10.89it/s]online:  67%|██████▋   | 42/63 [00:03<00:01, 10.87it/s]online:  70%|██████▉   | 44/63 [00:04<00:01, 10.96it/s]online:  73%|███████▎  | 46/63 [00:04<00:01, 10.97it/s]online:  76%|███████▌  | 48/63 [00:04<00:01, 11.00it/s]online:  79%|███████▉  | 50/63 [00:04<00:01, 11.06it/s]online:  83%|████████▎ | 52/63 [00:04<00:00, 11.02it/s]online:  86%|████████▌ | 54/63 [00:05<00:00, 11.00it/s]online:  89%|████████▉ | 56/63 [00:05<00:00, 11.01it/s]online:  92%|█████████▏| 58/63 [00:05<00:00, 11.01it/s]online:  95%|█████████▌| 60/63 [00:05<00:00, 11.00it/s]online:  98%|█████████▊| 62/63 [00:05<00:00, 11.00it/s]online: 100%|██████████| 63/63 [00:05<00:00, 10.82it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2928948:MainThread](2024-04-24 22:48:55,860) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9978707 mae 0.6861946
{'IC': 0.028330089929604008,
 'ICIR': 0.25260126906960617,
 'Rank IC': 0.024555272432961062,
 'Rank ICIR': 0.22629638137184316}
[2928948:MainThread](2024-04-24 22:48:57,719) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2928948:MainThread](2024-04-24 22:49:12,771) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 22:49:12,774) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 22:49:18,858) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f989c01ec40>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:46,  9.07it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.20it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 34.80it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 39.44it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.01it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 49.00it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:18, 49.18it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:17, 51.78it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:17, 53.64it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 51.24it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:16, 54.60it/s]backtest loop:   7%|▋         | 70/971 [00:01<00:16, 56.03it/s]backtest loop:   8%|▊         | 76/971 [00:01<00:15, 56.84it/s]backtest loop:   8%|▊         | 82/971 [00:01<00:16, 54.02it/s]backtest loop:   9%|▉         | 88/971 [00:01<00:15, 55.62it/s]backtest loop:  10%|▉         | 95/971 [00:01<00:15, 58.29it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 58.39it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 55.11it/s]backtest loop:  12%|█▏        | 113/971 [00:02<00:15, 56.18it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:14, 57.11it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 54.19it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:16, 52.30it/s]backtest loop:  14%|█▍        | 137/971 [00:02<00:15, 54.24it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:14, 55.51it/s]backtest loop:  15%|█▌        | 149/971 [00:02<00:14, 56.47it/s]backtest loop:  16%|█▌        | 155/971 [00:03<00:14, 57.17it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 54.01it/s]backtest loop:  17%|█▋        | 167/971 [00:03<00:14, 55.22it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:14, 56.36it/s]backtest loop:  19%|█▊        | 180/971 [00:03<00:13, 58.11it/s]backtest loop:  19%|█▉        | 186/971 [00:03<00:14, 55.11it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:13, 56.40it/s]backtest loop:  20%|██        | 198/971 [00:03<00:13, 57.33it/s]backtest loop:  21%|██        | 204/971 [00:03<00:13, 58.05it/s]backtest loop:  22%|██▏       | 210/971 [00:04<00:13, 54.85it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:14, 52.47it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:13, 54.47it/s]backtest loop:  23%|██▎       | 228/971 [00:04<00:13, 55.75it/s]backtest loop:  24%|██▍       | 234/971 [00:04<00:13, 54.75it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:14, 51.22it/s]backtest loop:  25%|██▌       | 246/971 [00:04<00:13, 52.19it/s]backtest loop:  26%|██▌       | 252/971 [00:04<00:13, 52.85it/s]backtest loop:  27%|██▋       | 258/971 [00:04<00:13, 53.03it/s]backtest loop:  27%|██▋       | 264/971 [00:05<00:14, 49.92it/s]backtest loop:  28%|██▊       | 270/971 [00:05<00:13, 51.01it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:14, 48.43it/s]backtest loop:  29%|██▉       | 282/971 [00:05<00:13, 50.01it/s]backtest loop:  30%|██▉       | 288/971 [00:05<00:13, 51.29it/s]backtest loop:  30%|███       | 294/971 [00:05<00:12, 52.44it/s]backtest loop:  31%|███       | 300/971 [00:05<00:13, 49.40it/s]backtest loop:  32%|███▏      | 306/971 [00:05<00:13, 50.72it/s]backtest loop:  32%|███▏      | 312/971 [00:06<00:12, 52.07it/s]backtest loop:  33%|███▎      | 318/971 [00:06<00:12, 52.58it/s]backtest loop:  33%|███▎      | 324/971 [00:06<00:12, 53.16it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:12, 50.04it/s]backtest loop:  35%|███▍      | 336/971 [00:06<00:12, 51.18it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:12, 51.64it/s]backtest loop:  36%|███▌      | 348/971 [00:06<00:11, 52.52it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:11, 53.29it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:12, 50.33it/s]backtest loop:  38%|███▊      | 366/971 [00:07<00:11, 52.01it/s]backtest loop:  38%|███▊      | 372/971 [00:07<00:12, 49.46it/s]backtest loop:  39%|███▉      | 378/971 [00:07<00:12, 47.78it/s]backtest loop:  40%|███▉      | 384/971 [00:07<00:11, 49.64it/s]backtest loop:  40%|████      | 390/971 [00:07<00:11, 50.93it/s]backtest loop:  41%|████      | 396/971 [00:07<00:11, 51.68it/s]backtest loop:  41%|████▏     | 402/971 [00:07<00:10, 52.58it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:11, 49.68it/s]backtest loop:  43%|████▎     | 414/971 [00:08<00:10, 51.21it/s]backtest loop:  43%|████▎     | 420/971 [00:08<00:10, 51.97it/s]backtest loop:  44%|████▍     | 426/971 [00:08<00:10, 52.52it/s]backtest loop:  44%|████▍     | 432/971 [00:08<00:10, 49.71it/s]backtest loop:  45%|████▌     | 438/971 [00:08<00:10, 50.83it/s]backtest loop:  46%|████▌     | 444/971 [00:08<00:10, 51.59it/s]backtest loop:  46%|████▋     | 450/971 [00:08<00:09, 52.39it/s]backtest loop:  47%|████▋     | 456/971 [00:08<00:09, 52.75it/s]backtest loop:  48%|████▊     | 462/971 [00:08<00:10, 49.90it/s]backtest loop:  48%|████▊     | 468/971 [00:09<00:09, 51.93it/s]backtest loop:  49%|████▉     | 474/971 [00:09<00:09, 53.19it/s]backtest loop:  49%|████▉     | 480/971 [00:09<00:09, 54.26it/s]backtest loop:  50%|█████     | 486/971 [00:09<00:09, 53.82it/s]backtest loop:  51%|█████     | 492/971 [00:09<00:09, 50.47it/s]backtest loop:  51%|█████▏    | 498/971 [00:09<00:09, 51.29it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:08, 52.12it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:09, 49.38it/s]backtest loop:  53%|█████▎    | 516/971 [00:10<00:08, 50.73it/s]backtest loop:  54%|█████▍    | 522/971 [00:10<00:09, 48.45it/s]backtest loop:  54%|█████▍    | 527/971 [00:10<00:09, 48.35it/s]backtest loop:  55%|█████▍    | 533/971 [00:10<00:08, 49.90it/s]backtest loop:  56%|█████▌    | 539/971 [00:10<00:08, 51.08it/s]backtest loop:  56%|█████▌    | 545/971 [00:10<00:08, 51.97it/s]backtest loop:  57%|█████▋    | 551/971 [00:10<00:08, 49.48it/s]backtest loop:  57%|█████▋    | 557/971 [00:10<00:08, 50.82it/s]backtest loop:  58%|█████▊    | 563/971 [00:10<00:07, 51.73it/s]backtest loop:  59%|█████▊    | 569/971 [00:11<00:07, 52.53it/s]backtest loop:  59%|█████▉    | 575/971 [00:11<00:07, 53.24it/s]backtest loop:  60%|█████▉    | 581/971 [00:11<00:07, 49.90it/s]backtest loop:  60%|██████    | 587/971 [00:11<00:07, 51.03it/s]backtest loop:  61%|██████    | 593/971 [00:11<00:07, 51.83it/s]backtest loop:  62%|██████▏   | 599/971 [00:11<00:07, 52.42it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:07, 49.52it/s]backtest loop:  63%|██████▎   | 611/971 [00:11<00:07, 50.81it/s]backtest loop:  64%|██████▎   | 617/971 [00:11<00:06, 51.73it/s]backtest loop:  64%|██████▍   | 623/971 [00:12<00:06, 52.08it/s]backtest loop:  65%|██████▍   | 629/971 [00:12<00:06, 52.90it/s]backtest loop:  65%|██████▌   | 635/971 [00:12<00:06, 49.98it/s]backtest loop:  66%|██████▌   | 641/971 [00:12<00:06, 51.10it/s]backtest loop:  67%|██████▋   | 647/971 [00:12<00:06, 51.76it/s]backtest loop:  67%|██████▋   | 653/971 [00:12<00:06, 52.34it/s]backtest loop:  68%|██████▊   | 659/971 [00:12<00:05, 52.87it/s]backtest loop:  68%|██████▊   | 665/971 [00:12<00:06, 49.97it/s]backtest loop:  69%|██████▉   | 671/971 [00:13<00:05, 50.71it/s]backtest loop:  70%|██████▉   | 677/971 [00:13<00:05, 52.91it/s]backtest loop:  70%|███████   | 683/971 [00:13<00:05, 54.47it/s]backtest loop:  71%|███████   | 689/971 [00:13<00:05, 52.46it/s]backtest loop:  72%|███████▏  | 695/971 [00:13<00:05, 54.26it/s]backtest loop:  72%|███████▏  | 701/971 [00:13<00:04, 55.38it/s]backtest loop:  73%|███████▎  | 707/971 [00:13<00:04, 56.44it/s]backtest loop:  73%|███████▎  | 713/971 [00:13<00:04, 57.26it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 54.42it/s]backtest loop:  75%|███████▍  | 725/971 [00:13<00:04, 55.85it/s]backtest loop:  75%|███████▌  | 731/971 [00:14<00:04, 53.37it/s]backtest loop:  76%|███████▌  | 737/971 [00:14<00:04, 55.05it/s]backtest loop:  77%|███████▋  | 743/971 [00:14<00:04, 52.58it/s]backtest loop:  77%|███████▋  | 749/971 [00:14<00:04, 54.52it/s]backtest loop:  78%|███████▊  | 755/971 [00:14<00:04, 52.59it/s]backtest loop:  78%|███████▊  | 761/971 [00:14<00:03, 54.61it/s]backtest loop:  79%|███████▉  | 768/971 [00:14<00:03, 57.52it/s]backtest loop:  80%|███████▉  | 775/971 [00:14<00:03, 56.28it/s]backtest loop:  81%|████████  | 782/971 [00:15<00:03, 57.97it/s]backtest loop:  81%|████████  | 788/971 [00:15<00:03, 55.22it/s]backtest loop:  82%|████████▏ | 794/971 [00:15<00:03, 56.27it/s]backtest loop:  82%|████████▏ | 801/971 [00:15<00:02, 57.98it/s]backtest loop:  83%|████████▎ | 807/971 [00:15<00:02, 58.08it/s]backtest loop:  84%|████████▎ | 813/971 [00:15<00:02, 55.02it/s]backtest loop:  84%|████████▍ | 819/971 [00:15<00:02, 56.15it/s]backtest loop:  85%|████████▍ | 825/971 [00:15<00:02, 56.69it/s]backtest loop:  86%|████████▌ | 831/971 [00:15<00:02, 57.30it/s]backtest loop:  86%|████████▌ | 837/971 [00:15<00:02, 57.77it/s]backtest loop:  87%|████████▋ | 843/971 [00:16<00:02, 54.59it/s]backtest loop:  87%|████████▋ | 849/971 [00:16<00:02, 55.87it/s]backtest loop:  88%|████████▊ | 855/971 [00:16<00:02, 56.70it/s]backtest loop:  89%|████████▊ | 861/971 [00:16<00:01, 57.17it/s]backtest loop:  89%|████████▉ | 867/971 [00:16<00:01, 53.98it/s]backtest loop:  90%|████████▉ | 873/971 [00:16<00:01, 55.37it/s]backtest loop:  91%|█████████ | 879/971 [00:16<00:01, 55.65it/s]backtest loop:  91%|█████████ | 885/971 [00:16<00:01, 56.72it/s]backtest loop:  92%|█████████▏| 891/971 [00:16<00:01, 57.29it/s]backtest loop:  92%|█████████▏| 897/971 [00:17<00:01, 54.31it/s]backtest loop:  93%|█████████▎| 903/971 [00:17<00:01, 55.61it/s]backtest loop:  94%|█████████▎| 909/971 [00:17<00:01, 56.27it/s]backtest loop:  94%|█████████▍| 915/971 [00:17<00:00, 56.82it/s]backtest loop:  95%|█████████▍| 921/971 [00:17<00:00, 53.88it/s]backtest loop:  95%|█████████▌| 927/971 [00:17<00:00, 55.28it/s]backtest loop:  96%|█████████▌| 933/971 [00:17<00:00, 56.17it/s]backtest loop:  97%|█████████▋| 940/971 [00:17<00:00, 54.91it/s]backtest loop:  97%|█████████▋| 946/971 [00:17<00:00, 56.00it/s]backtest loop:  98%|█████████▊| 952/971 [00:18<00:00, 56.57it/s]backtest loop:  99%|█████████▊| 958/971 [00:18<00:00, 57.22it/s]backtest loop:  99%|█████████▉| 964/971 [00:18<00:00, 57.48it/s]backtest loop: 100%|█████████▉| 970/971 [00:18<00:00, 54.32it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 52.75it/s]
[2928948:MainThread](2024-04-24 22:49:37,334) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000473
std                0.005025
annualized_return  0.112536
information_ratio  1.451764
max_drawdown      -0.082794
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000280
std                0.005027
annualized_return  0.066609
information_ratio  0.858868
max_drawdown      -0.103068
[2928948:MainThread](2024-04-24 22:49:37,349) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_22:10:42_online`.
Round 4 Done!
{'1day.excess_return_with_cost.annualized_return': [0.045906596817093956,
                                                    0.05947199783795087,
                                                    0.052020827576630645,
                                                    0.06660907356381215],
 '1day.excess_return_with_cost.information_ratio': [0.5989675803012956,
                                                    0.7992822081517327,
                                                    0.6773909197836762,
                                                    0.858868379402361],
 '1day.excess_return_with_cost.max_drawdown': [-0.12540023303514702,
                                               -0.12026081261057461,
                                               -0.13229595910483233,
                                               -0.10306790444738279],
 'IC': [0.02891690000013004,
        0.027223277140580798,
        0.02621109579435717,
        0.028330089929604008],
 'ICIR': [0.26326419201305706,
          0.2457576703726845,
          0.24059646907054116,
          0.25260126906960617],
 'Rank IC': [0.02552035915838527,
             0.019222991218935784,
             0.020849039173561842,
             0.024555272432961062],
 'Rank ICIR': [0.23664898746209853,
               0.17981857761811082,
               0.19444642706951779,
               0.22629638137184316],
 'mae': [0.6861680746078491,
         0.6861580610275269,
         0.68607097864151,
         0.6861945986747742],
 'mse': [0.9978829622268677,
         0.9977895021438599,
         0.997923731803894,
         0.997870683670044]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2928948:MainThread](2024-04-24 22:49:38,705) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2928948:MainThread](2024-04-24 22:49:38,706) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2928948:MainThread](2024-04-24 22:49:38,707) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2928948:MainThread](2024-04-24 22:49:38,708) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:11<18:58, 11.50s/it]epoch:   2%|▏         | 2/100 [00:22<18:20, 11.23s/it]epoch:   3%|▎         | 3/100 [00:33<18:08, 11.22s/it]epoch:   4%|▍         | 4/100 [00:44<17:46, 11.11s/it]epoch:   5%|▌         | 5/100 [00:55<17:33, 11.09s/it]epoch:   6%|▌         | 6/100 [01:06<17:21, 11.08s/it]epoch:   7%|▋         | 7/100 [01:18<17:17, 11.15s/it]epoch:   8%|▊         | 8/100 [01:29<17:03, 11.13s/it]epoch:   9%|▉         | 9/100 [01:40<16:47, 11.07s/it]epoch:  10%|█         | 10/100 [01:51<16:38, 11.09s/it]epoch:  11%|█         | 11/100 [02:02<16:30, 11.13s/it]epoch:  12%|█▏        | 12/100 [02:13<16:14, 11.08s/it]epoch:  13%|█▎        | 13/100 [02:24<15:56, 11.00s/it]epoch:  14%|█▍        | 14/100 [02:35<15:46, 11.01s/it]epoch:  15%|█▌        | 15/100 [02:46<15:43, 11.10s/it]epoch:  16%|█▌        | 16/100 [02:57<15:30, 11.08s/it]epoch:  17%|█▋        | 17/100 [03:08<15:16, 11.04s/it]epoch:  18%|█▊        | 18/100 [03:19<15:10, 11.10s/it]epoch:  19%|█▉        | 19/100 [03:31<15:08, 11.22s/it]epoch:  20%|██        | 20/100 [03:42<14:53, 11.17s/it]epoch:  21%|██        | 21/100 [03:53<14:37, 11.11s/it]epoch:  22%|██▏       | 22/100 [04:04<14:27, 11.13s/it]epoch:  23%|██▎       | 23/100 [04:16<14:25, 11.24s/it]epoch:  24%|██▍       | 24/100 [04:27<14:12, 11.22s/it]epoch:  25%|██▌       | 25/100 [04:38<13:55, 11.15s/it]epoch:  26%|██▌       | 26/100 [04:49<13:46, 11.17s/it]epoch:  27%|██▋       | 27/100 [05:00<13:38, 11.22s/it]epoch:  28%|██▊       | 28/100 [05:11<13:24, 11.17s/it]epoch:  29%|██▉       | 29/100 [05:22<13:11, 11.15s/it]epoch:  30%|███       | 30/100 [05:34<13:02, 11.18s/it]0.05488407974018781
best ic: 0.05488407974018781
epoch:  31%|███       | 31/100 [05:47<13:26, 11.69s/it]0.057298611603217114
best ic: 0.057298611603217114
epoch:  32%|███▏      | 32/100 [05:59<13:33, 11.96s/it]0.057458863034054064
best ic: 0.057458863034054064
epoch:  33%|███▎      | 33/100 [06:12<13:31, 12.11s/it]0.05353820855664403
epoch:  34%|███▍      | 34/100 [06:24<13:32, 12.30s/it]0.055454769496460964
epoch:  35%|███▌      | 35/100 [06:37<13:31, 12.48s/it]0.05567011244667561
epoch:  36%|███▌      | 36/100 [06:50<13:19, 12.48s/it]0.052399398548791394
epoch:  37%|███▋      | 37/100 [07:02<13:07, 12.50s/it]0.05523029530617471
epoch:  38%|███▊      | 38/100 [07:15<13:02, 12.62s/it]0.052768653871275766
epoch:  39%|███▉      | 39/100 [07:28<12:52, 12.66s/it]0.05382214765153191
epoch:  40%|████      | 40/100 [07:40<12:36, 12.60s/it]0.05455117025704755
epoch:  40%|████      | 40/100 [07:53<11:50, 11.84s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2928948:MainThread](2024-04-24 22:57:32,349) INFO - qlib.workflow - [exp.py:258] - Experiment 40 starts running ...
[2928948:MainThread](2024-04-24 22:57:32,362) INFO - qlib.workflow - [recorder.py:341] - Recorder 8355b2da4f52484c8983bff9fbefbece starts running under Experiment 40 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:05, 11.21it/s]online:   6%|▋         | 4/63 [00:00<00:05, 10.52it/s]online:  10%|▉         | 6/63 [00:00<00:05, 10.30it/s]online:  13%|█▎        | 8/63 [00:00<00:05, 10.19it/s]online:  16%|█▌        | 10/63 [00:00<00:05, 10.02it/s]online:  19%|█▉        | 12/63 [00:01<00:05, 10.06it/s]online:  22%|██▏       | 14/63 [00:01<00:04, 10.02it/s]online:  25%|██▌       | 16/63 [00:01<00:04, 10.24it/s]online:  29%|██▊       | 18/63 [00:01<00:04, 10.52it/s]online:  32%|███▏      | 20/63 [00:01<00:04, 10.63it/s]online:  35%|███▍      | 22/63 [00:02<00:03, 10.67it/s]online:  38%|███▊      | 24/63 [00:02<00:03, 10.78it/s]online:  41%|████▏     | 26/63 [00:02<00:03, 10.81it/s]online:  44%|████▍     | 28/63 [00:02<00:03, 10.83it/s]online:  48%|████▊     | 30/63 [00:02<00:03, 10.84it/s]online:  51%|█████     | 32/63 [00:03<00:02, 10.83it/s]online:  54%|█████▍    | 34/63 [00:03<00:02, 10.79it/s]online:  57%|█████▋    | 36/63 [00:03<00:02, 10.72it/s]online:  60%|██████    | 38/63 [00:03<00:02, 10.79it/s]online:  63%|██████▎   | 40/63 [00:03<00:02, 10.74it/s]online:  67%|██████▋   | 42/63 [00:03<00:01, 10.76it/s]online:  70%|██████▉   | 44/63 [00:04<00:01, 10.71it/s]online:  73%|███████▎  | 46/63 [00:04<00:01, 10.74it/s]online:  76%|███████▌  | 48/63 [00:04<00:01, 10.72it/s]online:  79%|███████▉  | 50/63 [00:04<00:01, 10.70it/s]online:  83%|████████▎ | 52/63 [00:04<00:01, 10.71it/s]online:  86%|████████▌ | 54/63 [00:05<00:00, 10.68it/s]online:  89%|████████▉ | 56/63 [00:05<00:00, 10.69it/s]online:  92%|█████████▏| 58/63 [00:05<00:00, 10.79it/s]online:  95%|█████████▌| 60/63 [00:05<00:00, 10.87it/s]online:  98%|█████████▊| 62/63 [00:05<00:00, 10.74it/s]online: 100%|██████████| 63/63 [00:05<00:00, 10.66it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2928948:MainThread](2024-04-24 22:57:59,140) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9978796 mae 0.686108
{'IC': 0.029365079789197276,
 'ICIR': 0.2675765575196645,
 'Rank IC': 0.023807031887618256,
 'Rank ICIR': 0.2248322860520228}
[2928948:MainThread](2024-04-24 22:58:01,086) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2928948:MainThread](2024-04-24 22:58:18,233) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 22:58:18,236) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 22:58:24,343) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f992c0a0f70>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:41,  9.58it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 25.19it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:26, 35.86it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.04it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.72it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 49.25it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:19, 48.94it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:17, 51.48it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:17, 53.65it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 51.46it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:16, 53.80it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:16, 55.38it/s]backtest loop:   8%|▊         | 76/971 [00:01<00:15, 57.70it/s]backtest loop:   8%|▊         | 82/971 [00:01<00:16, 54.26it/s]backtest loop:   9%|▉         | 88/971 [00:01<00:15, 55.81it/s]backtest loop:  10%|▉         | 95/971 [00:01<00:15, 57.94it/s]backtest loop:  10%|█         | 101/971 [00:02<00:15, 57.99it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 55.14it/s]backtest loop:  12%|█▏        | 113/971 [00:02<00:15, 55.80it/s]backtest loop:  12%|█▏        | 120/971 [00:02<00:14, 57.80it/s]backtest loop:  13%|█▎        | 126/971 [00:02<00:16, 51.57it/s]backtest loop:  14%|█▎        | 132/971 [00:02<00:15, 53.56it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:15, 54.85it/s]backtest loop:  15%|█▍        | 144/971 [00:02<00:14, 56.04it/s]backtest loop:  15%|█▌        | 150/971 [00:02<00:14, 56.55it/s]backtest loop:  16%|█▌        | 156/971 [00:03<00:15, 54.02it/s]backtest loop:  17%|█▋        | 162/971 [00:03<00:14, 55.10it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:14, 56.24it/s]backtest loop:  18%|█▊        | 174/971 [00:03<00:14, 56.63it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:14, 54.54it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 57.00it/s]backtest loop:  20%|██        | 195/971 [00:03<00:14, 55.38it/s]backtest loop:  21%|██        | 201/971 [00:03<00:13, 56.42it/s]backtest loop:  21%|██▏       | 207/971 [00:03<00:13, 57.13it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:13, 54.55it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:13, 55.53it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:13, 53.34it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:13, 54.68it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:13, 55.78it/s]backtest loop:  25%|██▌       | 243/971 [00:04<00:12, 56.15it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:13, 53.23it/s]backtest loop:  26%|██▋       | 255/971 [00:04<00:13, 54.78it/s]backtest loop:  27%|██▋       | 261/971 [00:04<00:12, 55.75it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:13, 53.19it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 54.39it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:12, 55.76it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:12, 56.54it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 53.52it/s]backtest loop:  31%|███       | 297/971 [00:05<00:12, 55.11it/s]backtest loop:  31%|███       | 303/971 [00:05<00:11, 56.21it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 56.83it/s]backtest loop:  32%|███▏      | 315/971 [00:05<00:12, 53.91it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:11, 54.97it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:11, 55.80it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:11, 56.22it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:11, 57.13it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 53.08it/s]backtest loop:  36%|███▌      | 351/971 [00:06<00:11, 54.55it/s]backtest loop:  37%|███▋      | 357/971 [00:06<00:10, 55.90it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:11, 54.24it/s]backtest loop:  38%|███▊      | 369/971 [00:06<00:11, 52.21it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 53.95it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:10, 55.20it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 55.48it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 53.28it/s]backtest loop:  41%|████      | 400/971 [00:07<00:10, 55.95it/s]backtest loop:  42%|████▏     | 406/971 [00:07<00:09, 56.78it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:09, 57.01it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:10, 54.13it/s]backtest loop:  44%|████▎     | 424/971 [00:07<00:09, 55.26it/s]backtest loop:  44%|████▍     | 430/971 [00:08<00:09, 56.33it/s]backtest loop:  45%|████▍     | 436/971 [00:08<00:09, 56.82it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:09, 54.08it/s]backtest loop:  46%|████▌     | 448/971 [00:08<00:09, 55.69it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:09, 56.65it/s]backtest loop:  47%|████▋     | 460/971 [00:08<00:08, 56.86it/s]backtest loop:  48%|████▊     | 466/971 [00:08<00:08, 57.31it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:09, 54.11it/s]backtest loop:  49%|████▉     | 478/971 [00:08<00:08, 55.21it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:08, 56.26it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:08, 53.46it/s]backtest loop:  51%|█████     | 496/971 [00:09<00:08, 54.93it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:08, 55.85it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:08, 53.38it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 54.82it/s]backtest loop:  54%|█████▎    | 520/971 [00:09<00:08, 56.12it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 53.19it/s]backtest loop:  55%|█████▍    | 532/971 [00:09<00:08, 54.56it/s]backtest loop:  55%|█████▌    | 538/971 [00:09<00:07, 55.80it/s]backtest loop:  56%|█████▌    | 544/971 [00:10<00:07, 56.07it/s]backtest loop:  57%|█████▋    | 550/971 [00:10<00:07, 55.63it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:08, 51.28it/s]backtest loop:  58%|█████▊    | 562/971 [00:10<00:07, 53.19it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:07, 54.55it/s]backtest loop:  59%|█████▉    | 574/971 [00:10<00:07, 55.84it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 56.36it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:07, 53.72it/s]backtest loop:  61%|██████    | 592/971 [00:10<00:06, 54.92it/s]backtest loop:  62%|██████▏   | 598/971 [00:11<00:06, 55.89it/s]backtest loop:  62%|██████▏   | 604/971 [00:11<00:06, 56.74it/s]backtest loop:  63%|██████▎   | 610/971 [00:11<00:06, 53.78it/s]backtest loop:  63%|██████▎   | 616/971 [00:11<00:06, 55.02it/s]backtest loop:  64%|██████▍   | 622/971 [00:11<00:06, 55.95it/s]backtest loop:  65%|██████▍   | 628/971 [00:11<00:06, 56.77it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:05, 57.44it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:06, 54.13it/s]backtest loop:  67%|██████▋   | 646/971 [00:11<00:05, 55.04it/s]backtest loop:  67%|██████▋   | 653/971 [00:12<00:05, 57.18it/s]backtest loop:  68%|██████▊   | 659/971 [00:12<00:05, 57.58it/s]backtest loop:  68%|██████▊   | 665/971 [00:12<00:05, 54.36it/s]backtest loop:  69%|██████▉   | 671/971 [00:12<00:05, 55.51it/s]backtest loop:  70%|██████▉   | 677/971 [00:12<00:05, 55.99it/s]backtest loop:  70%|███████   | 683/971 [00:12<00:05, 56.42it/s]backtest loop:  71%|███████   | 689/971 [00:12<00:05, 53.60it/s]backtest loop:  72%|███████▏  | 695/971 [00:12<00:05, 54.98it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 56.36it/s]backtest loop:  73%|███████▎  | 707/971 [00:13<00:04, 56.95it/s]backtest loop:  73%|███████▎  | 713/971 [00:13<00:04, 57.47it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 54.45it/s]backtest loop:  75%|███████▍  | 725/971 [00:13<00:04, 55.60it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 52.98it/s]backtest loop:  76%|███████▌  | 737/971 [00:13<00:04, 54.64it/s]backtest loop:  77%|███████▋  | 743/971 [00:13<00:04, 52.39it/s]backtest loop:  77%|███████▋  | 749/971 [00:13<00:04, 54.23it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 52.30it/s]backtest loop:  78%|███████▊  | 761/971 [00:14<00:03, 54.33it/s]backtest loop:  79%|███████▉  | 768/971 [00:14<00:03, 57.39it/s]backtest loop:  80%|███████▉  | 775/971 [00:14<00:03, 55.94it/s]backtest loop:  80%|████████  | 781/971 [00:14<00:03, 56.72it/s]backtest loop:  81%|████████  | 787/971 [00:14<00:03, 57.31it/s]backtest loop:  82%|████████▏ | 793/971 [00:14<00:03, 53.94it/s]backtest loop:  82%|████████▏ | 799/971 [00:14<00:03, 55.42it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:02, 56.32it/s]backtest loop:  84%|████████▎ | 811/971 [00:14<00:02, 57.08it/s]backtest loop:  84%|████████▍ | 817/971 [00:15<00:02, 57.85it/s]backtest loop:  85%|████████▍ | 823/971 [00:15<00:02, 54.68it/s]backtest loop:  85%|████████▌ | 829/971 [00:15<00:02, 55.64it/s]backtest loop:  86%|████████▌ | 835/971 [00:15<00:02, 56.34it/s]backtest loop:  87%|████████▋ | 841/971 [00:15<00:02, 57.01it/s]backtest loop:  87%|████████▋ | 847/971 [00:15<00:02, 57.59it/s]backtest loop:  88%|████████▊ | 853/971 [00:15<00:02, 54.36it/s]backtest loop:  88%|████████▊ | 859/971 [00:15<00:02, 55.72it/s]backtest loop:  89%|████████▉ | 865/971 [00:15<00:01, 56.72it/s]backtest loop:  90%|████████▉ | 871/971 [00:15<00:01, 57.24it/s]backtest loop:  90%|█████████ | 877/971 [00:16<00:01, 53.76it/s]backtest loop:  91%|█████████ | 883/971 [00:16<00:01, 55.11it/s]backtest loop:  92%|█████████▏| 889/971 [00:16<00:01, 52.25it/s]backtest loop:  92%|█████████▏| 895/971 [00:16<00:01, 52.75it/s]backtest loop:  93%|█████████▎| 901/971 [00:16<00:01, 53.16it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 50.21it/s]backtest loop:  94%|█████████▍| 913/971 [00:16<00:01, 51.28it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:01, 51.90it/s]backtest loop:  95%|█████████▌| 925/971 [00:17<00:00, 52.17it/s]backtest loop:  96%|█████████▌| 931/971 [00:17<00:00, 49.45it/s]backtest loop:  96%|█████████▋| 937/971 [00:17<00:00, 50.86it/s]backtest loop:  97%|█████████▋| 943/971 [00:17<00:00, 51.59it/s]backtest loop:  98%|█████████▊| 949/971 [00:17<00:00, 52.25it/s]backtest loop:  98%|█████████▊| 955/971 [00:17<00:00, 49.42it/s]backtest loop:  99%|█████████▉| 961/971 [00:17<00:00, 50.65it/s]backtest loop: 100%|█████████▉| 967/971 [00:17<00:00, 51.58it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.10it/s]
[2928948:MainThread](2024-04-24 22:58:42,362) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000367
std                0.004668
annualized_return  0.087262
information_ratio  1.211801
max_drawdown      -0.119564
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000173
std                0.004669
annualized_return  0.041062
information_ratio  0.570105
max_drawdown      -0.156496
[2928948:MainThread](2024-04-24 22:58:42,377) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_22:10:42_online`.
Round 5 Done!
{'1day.excess_return_with_cost.annualized_return': [0.045906596817093956,
                                                    0.05947199783795087,
                                                    0.052020827576630645,
                                                    0.06660907356381215,
                                                    0.041062380160693655],
 '1day.excess_return_with_cost.information_ratio': [0.5989675803012956,
                                                    0.7992822081517327,
                                                    0.6773909197836762,
                                                    0.858868379402361,
                                                    0.5701050273115824],
 '1day.excess_return_with_cost.max_drawdown': [-0.12540023303514702,
                                               -0.12026081261057461,
                                               -0.13229595910483233,
                                               -0.10306790444738279,
                                               -0.15649562411434487],
 'IC': [0.02891690000013004,
        0.027223277140580798,
        0.02621109579435717,
        0.028330089929604008,
        0.029365079789197276],
 'ICIR': [0.26326419201305706,
          0.2457576703726845,
          0.24059646907054116,
          0.25260126906960617,
          0.2675765575196645],
 'Rank IC': [0.02552035915838527,
             0.019222991218935784,
             0.020849039173561842,
             0.024555272432961062,
             0.023807031887618256],
 'Rank ICIR': [0.23664898746209853,
               0.17981857761811082,
               0.19444642706951779,
               0.22629638137184316,
               0.2248322860520228],
 'mae': [0.6861680746078491,
         0.6861580610275269,
         0.68607097864151,
         0.6861945986747742,
         0.6861079931259155],
 'mse': [0.9978829622268677,
         0.9977895021438599,
         0.997923731803894,
         0.997870683670044,
         0.9978796243667603]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2928948:MainThread](2024-04-24 22:58:43,896) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2928948:MainThread](2024-04-24 22:58:43,896) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2928948:MainThread](2024-04-24 22:58:43,898) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2928948:MainThread](2024-04-24 22:58:43,898) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:11<19:10, 11.63s/it]epoch:   2%|▏         | 2/100 [00:22<18:19, 11.22s/it]epoch:   3%|▎         | 3/100 [00:33<18:08, 11.22s/it]epoch:   4%|▍         | 4/100 [00:44<17:56, 11.21s/it]epoch:   5%|▌         | 5/100 [00:55<17:34, 11.10s/it]epoch:   6%|▌         | 6/100 [01:06<17:19, 11.05s/it]epoch:   7%|▋         | 7/100 [01:18<17:13, 11.11s/it]epoch:   8%|▊         | 8/100 [01:29<17:07, 11.17s/it]epoch:   9%|▉         | 9/100 [01:40<16:48, 11.08s/it]epoch:  10%|█         | 10/100 [01:51<16:33, 11.03s/it]epoch:  11%|█         | 11/100 [02:02<16:29, 11.11s/it]epoch:  12%|█▏        | 12/100 [02:13<16:22, 11.16s/it]epoch:  13%|█▎        | 13/100 [02:24<16:04, 11.09s/it]epoch:  14%|█▍        | 14/100 [02:35<15:51, 11.06s/it]epoch:  15%|█▌        | 15/100 [02:46<15:44, 11.11s/it]epoch:  16%|█▌        | 16/100 [02:58<15:36, 11.15s/it]epoch:  17%|█▋        | 17/100 [03:09<15:20, 11.09s/it]epoch:  18%|█▊        | 18/100 [03:20<15:05, 11.05s/it]epoch:  19%|█▉        | 19/100 [03:31<15:01, 11.13s/it]epoch:  20%|██        | 20/100 [03:42<14:54, 11.19s/it]epoch:  21%|██        | 21/100 [03:53<14:39, 11.13s/it]epoch:  22%|██▏       | 22/100 [04:04<14:23, 11.08s/it]epoch:  23%|██▎       | 23/100 [04:15<14:16, 11.12s/it]epoch:  24%|██▍       | 24/100 [04:27<14:08, 11.16s/it]epoch:  25%|██▌       | 25/100 [04:38<13:53, 11.11s/it]epoch:  26%|██▌       | 26/100 [04:49<13:38, 11.06s/it]epoch:  27%|██▋       | 27/100 [05:00<13:35, 11.17s/it]epoch:  28%|██▊       | 28/100 [05:11<13:27, 11.22s/it]epoch:  29%|██▉       | 29/100 [05:22<13:14, 11.18s/it]epoch:  30%|███       | 30/100 [05:33<12:59, 11.14s/it]0.05417041966631929
best ic: 0.05417041966631929
epoch:  31%|███       | 31/100 [05:46<13:24, 11.66s/it]0.05722308194197628
best ic: 0.05722308194197628
epoch:  32%|███▏      | 32/100 [05:59<13:37, 12.02s/it]0.055307249393362574
epoch:  33%|███▎      | 33/100 [06:12<13:35, 12.18s/it]0.055536670376222355
epoch:  34%|███▍      | 34/100 [06:24<13:31, 12.29s/it]0.05602029913468288
epoch:  35%|███▌      | 35/100 [06:37<13:31, 12.49s/it]0.056810940701692444
epoch:  36%|███▌      | 36/100 [06:50<13:22, 12.54s/it]0.05794289397139732
best ic: 0.05794289397139732
epoch:  37%|███▋      | 37/100 [07:02<13:08, 12.52s/it]0.05309269098424169
epoch:  38%|███▊      | 38/100 [07:15<12:57, 12.54s/it]0.05641108688655722
epoch:  39%|███▉      | 39/100 [07:28<12:52, 12.66s/it]0.055798401763006426
epoch:  40%|████      | 40/100 [07:41<12:39, 12.66s/it]0.05564282769086219
epoch:  41%|████      | 41/100 [07:53<12:24, 12.62s/it]0.05289301663500946
epoch:  42%|████▏     | 42/100 [08:06<12:14, 12.67s/it]0.05259181407178978
epoch:  43%|████▎     | 43/100 [08:19<12:07, 12.76s/it]0.05754408345836186
epoch:  44%|████▍     | 44/100 [08:31<11:50, 12.69s/it]0.054501923788252214
epoch:  44%|████▍     | 44/100 [08:44<11:07, 11.92s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2928948:MainThread](2024-04-24 23:07:28,206) INFO - qlib.workflow - [exp.py:258] - Experiment 40 starts running ...
[2928948:MainThread](2024-04-24 23:07:28,218) INFO - qlib.workflow - [recorder.py:341] - Recorder 8f484e4ddeda4494ba40593b1ce2c73d starts running under Experiment 40 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:05, 11.22it/s]online:   6%|▋         | 4/63 [00:00<00:05, 10.91it/s]online:  10%|▉         | 6/63 [00:00<00:05, 10.97it/s]online:  13%|█▎        | 8/63 [00:00<00:05, 10.82it/s]online:  16%|█▌        | 10/63 [00:00<00:04, 10.86it/s]online:  19%|█▉        | 12/63 [00:01<00:04, 10.90it/s]online:  22%|██▏       | 14/63 [00:01<00:04, 10.88it/s]online:  25%|██▌       | 16/63 [00:01<00:04, 10.78it/s]online:  29%|██▊       | 18/63 [00:01<00:04, 10.87it/s]online:  32%|███▏      | 20/63 [00:01<00:03, 10.79it/s]online:  35%|███▍      | 22/63 [00:02<00:03, 10.81it/s]online:  38%|███▊      | 24/63 [00:02<00:03, 10.88it/s]online:  41%|████▏     | 26/63 [00:02<00:03, 10.85it/s]online:  44%|████▍     | 28/63 [00:02<00:03, 10.81it/s]online:  48%|████▊     | 30/63 [00:02<00:03, 10.87it/s]online:  51%|█████     | 32/63 [00:02<00:02, 10.87it/s]online:  54%|█████▍    | 34/63 [00:03<00:02, 10.80it/s]online:  57%|█████▋    | 36/63 [00:03<00:02, 10.77it/s]online:  60%|██████    | 38/63 [00:03<00:02, 10.79it/s]online:  63%|██████▎   | 40/63 [00:03<00:02, 10.78it/s]online:  67%|██████▋   | 42/63 [00:03<00:01, 10.88it/s]online:  70%|██████▉   | 44/63 [00:04<00:01, 10.86it/s]online:  73%|███████▎  | 46/63 [00:04<00:01, 10.87it/s]online:  76%|███████▌  | 48/63 [00:04<00:01, 10.83it/s]online:  79%|███████▉  | 50/63 [00:04<00:01, 10.84it/s]online:  83%|████████▎ | 52/63 [00:04<00:01, 10.86it/s]online:  86%|████████▌ | 54/63 [00:04<00:00, 10.85it/s]online:  89%|████████▉ | 56/63 [00:05<00:00, 10.82it/s]online:  92%|█████████▏| 58/63 [00:05<00:00, 10.78it/s]online:  95%|█████████▌| 60/63 [00:05<00:00, 10.77it/s]online:  98%|█████████▊| 62/63 [00:05<00:00, 10.85it/s]online: 100%|██████████| 63/63 [00:05<00:00, 10.86it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2928948:MainThread](2024-04-24 23:07:53,540) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9980701 mae 0.68631804
{'IC': 0.026172185682743515,
 'ICIR': 0.246492573957277,
 'Rank IC': 0.0200698216143074,
 'Rank ICIR': 0.19274257572483314}
[2928948:MainThread](2024-04-24 23:07:55,414) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2928948:MainThread](2024-04-24 23:08:11,134) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 23:08:11,137) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 23:08:17,292) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f976c1cdfa0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:47,  9.02it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 23.64it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 33.39it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:25, 37.05it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:22, 42.14it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 45.64it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 45.43it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:19, 48.13it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 49.86it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 48.21it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:18, 49.74it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 51.18it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:17, 52.37it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 53.21it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 50.30it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 52.05it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 52.57it/s]backtest loop:  11%|█         | 105/971 [00:02<00:16, 53.11it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:16, 53.71it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 50.78it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 51.81it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:17, 49.17it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:16, 50.59it/s]backtest loop:  15%|█▍        | 141/971 [00:03<00:17, 48.70it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:16, 49.95it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:16, 51.11it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 52.27it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:15, 52.99it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:16, 49.76it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:15, 51.21it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:15, 52.15it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:14, 52.83it/s]backtest loop:  20%|██        | 195/971 [00:04<00:15, 50.25it/s]backtest loop:  21%|██        | 201/971 [00:04<00:14, 51.41it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:14, 52.26it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:15, 49.83it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:14, 51.10it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:15, 49.02it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:14, 50.15it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:14, 51.21it/s]backtest loop:  25%|██▌       | 243/971 [00:05<00:13, 52.49it/s]backtest loop:  26%|██▌       | 249/971 [00:05<00:14, 49.99it/s]backtest loop:  26%|██▋       | 255/971 [00:05<00:14, 50.88it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:13, 51.76it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:14, 49.26it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:13, 50.17it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:13, 51.32it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:13, 52.09it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:13, 49.85it/s]backtest loop:  31%|███       | 297/971 [00:06<00:13, 51.32it/s]backtest loop:  31%|███       | 303/971 [00:06<00:12, 52.28it/s]backtest loop:  32%|███▏      | 309/971 [00:06<00:12, 52.77it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:13, 50.15it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:12, 51.48it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:12, 52.51it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:12, 53.02it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:11, 53.44it/s]backtest loop:  36%|███▌      | 345/971 [00:07<00:12, 50.30it/s]backtest loop:  36%|███▌      | 351/971 [00:07<00:12, 51.48it/s]backtest loop:  37%|███▋      | 357/971 [00:07<00:11, 52.33it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:12, 50.31it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:12, 48.61it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 50.39it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:11, 51.34it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:11, 52.01it/s]backtest loop:  40%|████      | 393/971 [00:07<00:11, 49.44it/s]backtest loop:  41%|████      | 399/971 [00:08<00:11, 50.80it/s]backtest loop:  42%|████▏     | 405/971 [00:08<00:10, 51.69it/s]backtest loop:  42%|████▏     | 411/971 [00:08<00:10, 52.33it/s]backtest loop:  43%|████▎     | 417/971 [00:08<00:10, 52.74it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:10, 49.91it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:10, 51.12it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:10, 51.86it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:10, 52.11it/s]backtest loop:  46%|████▌     | 447/971 [00:09<00:10, 49.38it/s]backtest loop:  47%|████▋     | 453/971 [00:09<00:10, 50.72it/s]backtest loop:  47%|████▋     | 459/971 [00:09<00:09, 51.59it/s]backtest loop:  48%|████▊     | 465/971 [00:09<00:09, 51.77it/s]backtest loop:  49%|████▊     | 471/971 [00:09<00:09, 52.69it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 50.51it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:09, 51.82it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:09, 52.45it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:09, 49.75it/s]backtest loop:  52%|█████▏    | 501/971 [00:10<00:09, 51.12it/s]backtest loop:  52%|█████▏    | 507/971 [00:10<00:09, 49.31it/s]backtest loop:  53%|█████▎    | 513/971 [00:10<00:09, 50.66it/s]backtest loop:  53%|█████▎    | 519/971 [00:10<00:08, 51.73it/s]backtest loop:  54%|█████▍    | 525/971 [00:10<00:08, 52.34it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 49.61it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:08, 50.52it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:08, 52.06it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 52.95it/s]backtest loop:  57%|█████▋    | 555/971 [00:11<00:07, 53.50it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:08, 50.48it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:07, 51.46it/s]backtest loop:  59%|█████▉    | 573/971 [00:11<00:07, 52.17it/s]backtest loop:  60%|█████▉    | 579/971 [00:11<00:07, 52.30it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:07, 52.77it/s]backtest loop:  61%|██████    | 591/971 [00:11<00:07, 49.89it/s]backtest loop:  61%|██████▏   | 597/971 [00:11<00:07, 51.15it/s]backtest loop:  62%|██████▏   | 603/971 [00:12<00:07, 51.93it/s]backtest loop:  63%|██████▎   | 609/971 [00:12<00:06, 52.89it/s]backtest loop:  63%|██████▎   | 615/971 [00:12<00:07, 49.78it/s]backtest loop:  64%|██████▍   | 621/971 [00:12<00:06, 51.03it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:06, 51.91it/s]backtest loop:  65%|██████▌   | 633/971 [00:12<00:06, 52.60it/s]backtest loop:  66%|██████▌   | 639/971 [00:12<00:06, 53.00it/s]backtest loop:  66%|██████▋   | 645/971 [00:12<00:06, 50.04it/s]backtest loop:  67%|██████▋   | 651/971 [00:12<00:06, 51.15it/s]backtest loop:  68%|██████▊   | 657/971 [00:13<00:06, 52.30it/s]backtest loop:  68%|██████▊   | 663/971 [00:13<00:05, 52.80it/s]backtest loop:  69%|██████▉   | 669/971 [00:13<00:05, 53.16it/s]backtest loop:  70%|██████▉   | 675/971 [00:13<00:05, 50.07it/s]backtest loop:  70%|███████   | 681/971 [00:13<00:05, 51.20it/s]backtest loop:  71%|███████   | 687/971 [00:13<00:05, 51.86it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:05, 52.33it/s]backtest loop:  72%|███████▏  | 699/971 [00:13<00:05, 49.77it/s]backtest loop:  73%|███████▎  | 705/971 [00:14<00:05, 51.10it/s]backtest loop:  73%|███████▎  | 711/971 [00:14<00:05, 52.00it/s]backtest loop:  74%|███████▍  | 717/971 [00:14<00:04, 52.64it/s]backtest loop:  74%|███████▍  | 723/971 [00:14<00:04, 53.00it/s]backtest loop:  75%|███████▌  | 729/971 [00:14<00:04, 49.99it/s]backtest loop:  76%|███████▌  | 735/971 [00:14<00:04, 48.24it/s]backtest loop:  76%|███████▋  | 741/971 [00:14<00:04, 49.73it/s]backtest loop:  77%|███████▋  | 747/971 [00:14<00:04, 50.91it/s]backtest loop:  78%|███████▊  | 753/971 [00:14<00:04, 48.98it/s]backtest loop:  78%|███████▊  | 759/971 [00:15<00:04, 50.58it/s]backtest loop:  79%|███████▉  | 765/971 [00:15<00:04, 48.88it/s]backtest loop:  79%|███████▉  | 771/971 [00:15<00:03, 50.85it/s]backtest loop:  80%|████████  | 777/971 [00:15<00:03, 52.37it/s]backtest loop:  81%|████████  | 783/971 [00:15<00:03, 49.78it/s]backtest loop:  81%|████████▏ | 789/971 [00:15<00:03, 51.11it/s]backtest loop:  82%|████████▏ | 795/971 [00:15<00:03, 51.87it/s]backtest loop:  82%|████████▏ | 801/971 [00:15<00:03, 52.72it/s]backtest loop:  83%|████████▎ | 807/971 [00:16<00:03, 52.91it/s]backtest loop:  84%|████████▎ | 813/971 [00:16<00:03, 49.96it/s]backtest loop:  84%|████████▍ | 819/971 [00:16<00:02, 51.04it/s]backtest loop:  85%|████████▍ | 825/971 [00:16<00:02, 51.90it/s]backtest loop:  86%|████████▌ | 831/971 [00:16<00:02, 52.39it/s]backtest loop:  86%|████████▌ | 837/971 [00:16<00:02, 52.94it/s]backtest loop:  87%|████████▋ | 843/971 [00:16<00:02, 50.06it/s]backtest loop:  87%|████████▋ | 849/971 [00:16<00:02, 50.95it/s]backtest loop:  88%|████████▊ | 855/971 [00:16<00:02, 51.81it/s]backtest loop:  89%|████████▊ | 861/971 [00:17<00:02, 52.56it/s]backtest loop:  89%|████████▉ | 867/971 [00:17<00:02, 49.84it/s]backtest loop:  90%|████████▉ | 873/971 [00:17<00:01, 50.85it/s]backtest loop:  91%|█████████ | 879/971 [00:17<00:01, 51.77it/s]backtest loop:  91%|█████████ | 885/971 [00:17<00:01, 52.27it/s]backtest loop:  92%|█████████▏| 891/971 [00:17<00:01, 52.64it/s]backtest loop:  92%|█████████▏| 897/971 [00:17<00:01, 49.93it/s]backtest loop:  93%|█████████▎| 903/971 [00:17<00:01, 51.07it/s]backtest loop:  94%|█████████▎| 909/971 [00:17<00:01, 51.90it/s]backtest loop:  94%|█████████▍| 915/971 [00:18<00:01, 52.49it/s]backtest loop:  95%|█████████▍| 921/971 [00:18<00:01, 49.56it/s]backtest loop:  95%|█████████▌| 927/971 [00:18<00:00, 50.77it/s]backtest loop:  96%|█████████▌| 933/971 [00:18<00:00, 51.69it/s]backtest loop:  97%|█████████▋| 939/971 [00:18<00:00, 52.43it/s]backtest loop:  97%|█████████▋| 945/971 [00:18<00:00, 49.49it/s]backtest loop:  98%|█████████▊| 951/971 [00:18<00:00, 50.78it/s]backtest loop:  99%|█████████▊| 957/971 [00:18<00:00, 51.76it/s]backtest loop:  99%|█████████▉| 963/971 [00:19<00:00, 52.06it/s]backtest loop: 100%|█████████▉| 969/971 [00:19<00:00, 52.57it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 50.53it/s]
[2928948:MainThread](2024-04-24 23:08:36,579) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000489
std                0.004535
annualized_return  0.116447
information_ratio  1.664517
max_drawdown      -0.058405
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000295
std                0.004538
annualized_return  0.070311
information_ratio  1.004415
max_drawdown      -0.083407
[2928948:MainThread](2024-04-24 23:08:36,595) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_22:10:42_online`.
Round 6 Done!
{'1day.excess_return_with_cost.annualized_return': [0.045906596817093956,
                                                    0.05947199783795087,
                                                    0.052020827576630645,
                                                    0.06660907356381215,
                                                    0.041062380160693655,
                                                    0.07031148260595382],
 '1day.excess_return_with_cost.information_ratio': [0.5989675803012956,
                                                    0.7992822081517327,
                                                    0.6773909197836762,
                                                    0.858868379402361,
                                                    0.5701050273115824,
                                                    1.0044152558669466],
 '1day.excess_return_with_cost.max_drawdown': [-0.12540023303514702,
                                               -0.12026081261057461,
                                               -0.13229595910483233,
                                               -0.10306790444738279,
                                               -0.15649562411434487,
                                               -0.08340678371365234],
 'IC': [0.02891690000013004,
        0.027223277140580798,
        0.02621109579435717,
        0.028330089929604008,
        0.029365079789197276,
        0.026172185682743515],
 'ICIR': [0.26326419201305706,
          0.2457576703726845,
          0.24059646907054116,
          0.25260126906960617,
          0.2675765575196645,
          0.246492573957277],
 'Rank IC': [0.02552035915838527,
             0.019222991218935784,
             0.020849039173561842,
             0.024555272432961062,
             0.023807031887618256,
             0.0200698216143074],
 'Rank ICIR': [0.23664898746209853,
               0.17981857761811082,
               0.19444642706951779,
               0.22629638137184316,
               0.2248322860520228,
               0.19274257572483314],
 'mae': [0.6861680746078491,
         0.6861580610275269,
         0.68607097864151,
         0.6861945986747742,
         0.6861079931259155,
         0.686318039894104],
 'mse': [0.9978829622268677,
         0.9977895021438599,
         0.997923731803894,
         0.997870683670044,
         0.9978796243667603,
         0.9980701208114624]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2928948:MainThread](2024-04-24 23:08:37,962) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2928948:MainThread](2024-04-24 23:08:37,962) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2928948:MainThread](2024-04-24 23:08:37,964) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2928948:MainThread](2024-04-24 23:08:37,964) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:11<19:11, 11.63s/it]epoch:   2%|▏         | 2/100 [00:22<18:42, 11.45s/it]epoch:   3%|▎         | 3/100 [00:34<18:23, 11.38s/it]epoch:   4%|▍         | 4/100 [00:45<17:57, 11.23s/it]epoch:   5%|▌         | 5/100 [00:56<17:32, 11.08s/it]epoch:   6%|▌         | 6/100 [01:07<17:22, 11.09s/it]epoch:   7%|▋         | 7/100 [01:18<17:16, 11.15s/it]epoch:   8%|▊         | 8/100 [01:29<17:03, 11.13s/it]epoch:   9%|▉         | 9/100 [01:40<16:47, 11.07s/it]epoch:  10%|█         | 10/100 [01:51<16:38, 11.09s/it]epoch:  11%|█         | 11/100 [02:02<16:30, 11.13s/it]epoch:  12%|█▏        | 12/100 [02:13<16:19, 11.13s/it]epoch:  13%|█▎        | 13/100 [02:25<16:06, 11.11s/it]epoch:  14%|█▍        | 14/100 [02:36<15:56, 11.12s/it]epoch:  15%|█▌        | 15/100 [02:47<15:52, 11.20s/it]epoch:  16%|█▌        | 16/100 [02:58<15:36, 11.15s/it]epoch:  17%|█▋        | 17/100 [03:09<15:22, 11.12s/it]epoch:  18%|█▊        | 18/100 [03:20<15:14, 11.15s/it]epoch:  19%|█▉        | 19/100 [03:32<15:06, 11.19s/it]epoch:  20%|██        | 20/100 [03:43<14:53, 11.16s/it]epoch:  21%|██        | 21/100 [03:54<14:33, 11.06s/it]epoch:  22%|██▏       | 22/100 [04:05<14:24, 11.09s/it]epoch:  23%|██▎       | 23/100 [04:16<14:18, 11.15s/it]epoch:  24%|██▍       | 24/100 [04:27<14:03, 11.10s/it]epoch:  25%|██▌       | 25/100 [04:38<13:49, 11.06s/it]epoch:  26%|██▌       | 26/100 [04:49<13:41, 11.10s/it]epoch:  27%|██▋       | 27/100 [05:01<13:36, 11.19s/it]epoch:  28%|██▊       | 28/100 [05:12<13:22, 11.15s/it]epoch:  29%|██▉       | 29/100 [05:23<13:07, 11.09s/it]epoch:  30%|███       | 30/100 [05:34<12:57, 11.11s/it]0.05609780924220582
best ic: 0.05609780924220582
epoch:  31%|███       | 31/100 [05:47<13:26, 11.69s/it]0.05297239316842452
epoch:  32%|███▏      | 32/100 [05:59<13:32, 11.95s/it]0.05438006509748644
epoch:  33%|███▎      | 33/100 [06:12<13:31, 12.11s/it]0.05562876005937955
epoch:  34%|███▍      | 34/100 [06:25<13:33, 12.32s/it]0.05231221108402805
epoch:  35%|███▌      | 35/100 [06:37<13:31, 12.49s/it]0.05277363148015471
epoch:  36%|███▌      | 36/100 [06:50<13:20, 12.51s/it]0.05635709752013914
best ic: 0.05635709752013914
epoch:  37%|███▋      | 37/100 [07:03<13:10, 12.54s/it]0.05727210417334667
best ic: 0.05727210417334667
epoch:  38%|███▊      | 38/100 [07:16<13:04, 12.66s/it]0.05629728729879171
epoch:  39%|███▉      | 39/100 [07:28<12:54, 12.69s/it]0.05718799941676482
epoch:  40%|████      | 40/100 [07:41<12:37, 12.62s/it]0.05284412703558008
epoch:  41%|████      | 41/100 [07:53<12:23, 12.61s/it]0.05460392501937463
epoch:  42%|████▏     | 42/100 [08:06<12:17, 12.71s/it]0.05900104755205535
best ic: 0.05900104755205535
epoch:  43%|████▎     | 43/100 [08:19<12:01, 12.66s/it]0.060344442711217236
best ic: 0.060344442711217236
epoch:  44%|████▍     | 44/100 [08:31<11:46, 12.62s/it]0.058056202020181864
epoch:  45%|████▌     | 45/100 [08:44<11:34, 12.63s/it]0.056843637776402244
epoch:  46%|████▌     | 46/100 [08:57<11:28, 12.74s/it]0.05455218723787918
epoch:  47%|████▋     | 47/100 [09:10<11:13, 12.70s/it]0.05864092471833968
epoch:  48%|████▊     | 48/100 [09:22<10:56, 12.62s/it]0.05696367948423024
epoch:  49%|████▉     | 49/100 [09:35<10:46, 12.67s/it]0.05696428048555018
epoch:  50%|█████     | 50/100 [09:48<10:35, 12.71s/it]0.0577554049076828
epoch:  51%|█████     | 51/100 [10:00<10:18, 12.62s/it]0.05558374212625968
epoch:  51%|█████     | 51/100 [10:13<09:49, 12.02s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2928948:MainThread](2024-04-24 23:18:51,217) INFO - qlib.workflow - [exp.py:258] - Experiment 40 starts running ...
[2928948:MainThread](2024-04-24 23:18:51,230) INFO - qlib.workflow - [recorder.py:341] - Recorder 6edfb9a1e5414ca9a44bcb5690781da3 starts running under Experiment 40 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:05, 11.00it/s]online:   6%|▋         | 4/63 [00:00<00:05, 10.92it/s]online:  10%|▉         | 6/63 [00:00<00:05, 10.73it/s]online:  13%|█▎        | 8/63 [00:00<00:05, 10.73it/s]online:  16%|█▌        | 10/63 [00:00<00:04, 10.71it/s]online:  19%|█▉        | 12/63 [00:01<00:04, 10.62it/s]online:  22%|██▏       | 14/63 [00:01<00:04, 10.68it/s]online:  25%|██▌       | 16/63 [00:01<00:04, 10.79it/s]online:  29%|██▊       | 18/63 [00:01<00:04, 10.83it/s]online:  32%|███▏      | 20/63 [00:01<00:03, 10.80it/s]online:  35%|███▍      | 22/63 [00:02<00:03, 10.79it/s]online:  38%|███▊      | 24/63 [00:02<00:03, 10.73it/s]online:  41%|████▏     | 26/63 [00:02<00:03, 10.80it/s]online:  44%|████▍     | 28/63 [00:02<00:03, 10.76it/s]online:  48%|████▊     | 30/63 [00:02<00:03, 10.82it/s]online:  51%|█████     | 32/63 [00:02<00:02, 10.73it/s]online:  54%|█████▍    | 34/63 [00:03<00:02, 10.77it/s]online:  57%|█████▋    | 36/63 [00:03<00:02, 10.84it/s]online:  60%|██████    | 38/63 [00:03<00:02, 10.81it/s]online:  63%|██████▎   | 40/63 [00:03<00:02, 10.89it/s]online:  67%|██████▋   | 42/63 [00:03<00:01, 10.94it/s]online:  70%|██████▉   | 44/63 [00:04<00:01, 10.81it/s]online:  73%|███████▎  | 46/63 [00:04<00:01, 10.77it/s]online:  76%|███████▌  | 48/63 [00:04<00:01, 10.86it/s]online:  79%|███████▉  | 50/63 [00:04<00:01, 10.88it/s]online:  83%|████████▎ | 52/63 [00:04<00:01, 10.92it/s]online:  86%|████████▌ | 54/63 [00:04<00:00, 10.88it/s]online:  89%|████████▉ | 56/63 [00:05<00:00, 10.84it/s]online:  92%|█████████▏| 58/63 [00:05<00:00, 10.78it/s]online:  95%|█████████▌| 60/63 [00:05<00:00, 10.83it/s]online:  98%|█████████▊| 62/63 [00:05<00:00, 10.86it/s]online: 100%|██████████| 63/63 [00:05<00:00, 10.83it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2928948:MainThread](2024-04-24 23:19:10,291) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99800885 mae 0.6863036
{'IC': 0.02924021200620926,
 'ICIR': 0.2701075098113818,
 'Rank IC': 0.024127009610319244,
 'Rank ICIR': 0.229834080976146}
[2928948:MainThread](2024-04-24 23:19:12,170) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2928948:MainThread](2024-04-24 23:19:27,799) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 23:19:27,802) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 23:19:33,810) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f977d96cf10>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:44,  9.29it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 24.84it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 35.35it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.96it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.55it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:18, 49.47it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:18, 49.52it/s]backtest loop:   5%|▍         | 46/971 [00:01<00:17, 53.67it/s]backtest loop:   5%|▌         | 53/971 [00:01<00:16, 56.46it/s]backtest loop:   6%|▌         | 59/971 [00:01<00:16, 54.07it/s]backtest loop:   7%|▋         | 66/971 [00:01<00:15, 57.10it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 55.23it/s]backtest loop:   8%|▊         | 79/971 [00:01<00:15, 57.33it/s]backtest loop:   9%|▉         | 85/971 [00:01<00:15, 57.97it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:15, 56.20it/s]backtest loop:  10%|█         | 99/971 [00:02<00:15, 57.88it/s]backtest loop:  11%|█         | 105/971 [00:02<00:14, 58.29it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 56.34it/s]backtest loop:  12%|█▏        | 118/971 [00:02<00:14, 57.17it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:14, 57.87it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:15, 54.83it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 52.86it/s]backtest loop:  15%|█▍        | 142/971 [00:02<00:15, 54.76it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 56.01it/s]backtest loop:  16%|█▌        | 154/971 [00:02<00:14, 56.88it/s]backtest loop:  16%|█▋        | 160/971 [00:03<00:14, 57.75it/s]backtest loop:  17%|█▋        | 166/971 [00:03<00:14, 54.64it/s]backtest loop:  18%|█▊        | 172/971 [00:03<00:14, 56.06it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:13, 57.09it/s]backtest loop:  19%|█▉        | 184/971 [00:03<00:13, 57.90it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:14, 55.53it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 58.54it/s]backtest loop:  21%|██        | 204/971 [00:03<00:12, 60.65it/s]backtest loop:  22%|██▏       | 211/971 [00:03<00:13, 57.72it/s]backtest loop:  22%|██▏       | 217/971 [00:04<00:13, 54.77it/s]backtest loop:  23%|██▎       | 224/971 [00:04<00:13, 57.01it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 54.21it/s]backtest loop:  24%|██▍       | 236/971 [00:04<00:13, 55.57it/s]backtest loop:  25%|██▌       | 243/971 [00:04<00:12, 57.74it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:13, 54.88it/s]backtest loop:  26%|██▋       | 255/971 [00:04<00:12, 55.92it/s]backtest loop:  27%|██▋       | 261/971 [00:04<00:12, 56.92it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:12, 54.16it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 55.44it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:12, 56.65it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:11, 57.35it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 54.38it/s]backtest loop:  31%|███       | 297/971 [00:05<00:12, 55.58it/s]backtest loop:  31%|███▏      | 304/971 [00:05<00:11, 57.81it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:12, 54.71it/s]backtest loop:  33%|███▎      | 316/971 [00:05<00:11, 55.98it/s]backtest loop:  33%|███▎      | 323/971 [00:05<00:11, 58.10it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:11, 56.11it/s]backtest loop:  35%|███▍      | 336/971 [00:06<00:11, 56.80it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:10, 57.68it/s]backtest loop:  36%|███▌      | 349/971 [00:06<00:10, 59.26it/s]backtest loop:  37%|███▋      | 355/971 [00:06<00:10, 56.34it/s]backtest loop:  37%|███▋      | 362/971 [00:06<00:10, 58.34it/s]backtest loop:  38%|███▊      | 368/971 [00:06<00:11, 52.85it/s]backtest loop:  39%|███▊      | 375/971 [00:06<00:10, 55.54it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:10, 56.18it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 57.00it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 54.48it/s]backtest loop:  41%|████      | 399/971 [00:07<00:10, 55.94it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 56.89it/s]backtest loop:  42%|████▏     | 411/971 [00:07<00:09, 57.71it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 58.32it/s]backtest loop:  44%|████▎     | 423/971 [00:07<00:10, 54.49it/s]backtest loop:  44%|████▍     | 429/971 [00:07<00:09, 55.80it/s]backtest loop:  45%|████▍     | 435/971 [00:07<00:09, 56.82it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:09, 54.99it/s]backtest loop:  46%|████▌     | 448/971 [00:08<00:09, 56.25it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:09, 57.11it/s]backtest loop:  47%|████▋     | 460/971 [00:08<00:08, 57.65it/s]backtest loop:  48%|████▊     | 466/971 [00:08<00:08, 57.42it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:09, 54.31it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 56.97it/s]backtest loop:  50%|█████     | 486/971 [00:08<00:08, 58.79it/s]backtest loop:  51%|█████     | 492/971 [00:08<00:08, 55.53it/s]backtest loop:  51%|█████▏    | 499/971 [00:09<00:08, 57.55it/s]backtest loop:  52%|█████▏    | 505/971 [00:09<00:08, 54.87it/s]backtest loop:  53%|█████▎    | 511/971 [00:09<00:08, 56.11it/s]backtest loop:  53%|█████▎    | 517/971 [00:09<00:08, 53.58it/s]backtest loop:  54%|█████▍    | 523/971 [00:09<00:08, 55.15it/s]backtest loop:  55%|█████▍    | 530/971 [00:09<00:07, 57.42it/s]backtest loop:  55%|█████▌    | 536/971 [00:09<00:07, 54.65it/s]backtest loop:  56%|█████▌    | 542/971 [00:09<00:07, 55.80it/s]backtest loop:  56%|█████▋    | 548/971 [00:09<00:07, 56.65it/s]backtest loop:  57%|█████▋    | 554/971 [00:10<00:07, 57.33it/s]backtest loop:  58%|█████▊    | 560/971 [00:10<00:07, 57.84it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 54.78it/s]backtest loop:  59%|█████▉    | 572/971 [00:10<00:07, 56.02it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:06, 56.92it/s]backtest loop:  60%|██████    | 584/971 [00:10<00:06, 57.66it/s]backtest loop:  61%|██████    | 590/971 [00:10<00:06, 57.50it/s]backtest loop:  61%|██████▏   | 596/971 [00:10<00:06, 54.40it/s]backtest loop:  62%|██████▏   | 602/971 [00:10<00:06, 55.62it/s]backtest loop:  63%|██████▎   | 608/971 [00:11<00:06, 56.57it/s]backtest loop:  63%|██████▎   | 614/971 [00:11<00:06, 57.31it/s]backtest loop:  64%|██████▍   | 620/971 [00:11<00:06, 54.60it/s]backtest loop:  64%|██████▍   | 626/971 [00:11<00:06, 55.91it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 56.82it/s]backtest loop:  66%|██████▌   | 638/971 [00:11<00:05, 57.50it/s]backtest loop:  66%|██████▋   | 644/971 [00:11<00:05, 57.82it/s]backtest loop:  67%|██████▋   | 650/971 [00:11<00:05, 54.60it/s]backtest loop:  68%|██████▊   | 657/971 [00:11<00:05, 56.82it/s]backtest loop:  68%|██████▊   | 663/971 [00:12<00:05, 57.43it/s]backtest loop:  69%|██████▉   | 669/971 [00:12<00:05, 57.82it/s]backtest loop:  70%|██████▉   | 675/971 [00:12<00:05, 54.55it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:05, 55.86it/s]backtest loop:  71%|███████   | 687/971 [00:12<00:05, 56.48it/s]backtest loop:  71%|███████▏  | 693/971 [00:12<00:04, 57.27it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 54.49it/s]backtest loop:  73%|███████▎  | 705/971 [00:12<00:04, 55.82it/s]backtest loop:  73%|███████▎  | 711/971 [00:12<00:04, 56.89it/s]backtest loop:  74%|███████▍  | 717/971 [00:12<00:04, 57.51it/s]backtest loop:  74%|███████▍  | 723/971 [00:13<00:04, 58.11it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 54.92it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 52.96it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 54.63it/s]backtest loop:  77%|███████▋  | 747/971 [00:13<00:03, 56.04it/s]backtest loop:  78%|███████▊  | 753/971 [00:13<00:04, 53.82it/s]backtest loop:  78%|███████▊  | 760/971 [00:13<00:03, 53.65it/s]backtest loop:  79%|███████▉  | 766/971 [00:13<00:03, 55.33it/s]backtest loop:  80%|███████▉  | 772/971 [00:13<00:03, 56.30it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 58.85it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 56.44it/s]backtest loop:  81%|████████▏ | 791/971 [00:14<00:03, 57.19it/s]backtest loop:  82%|████████▏ | 797/971 [00:14<00:03, 57.81it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:03, 54.96it/s]backtest loop:  83%|████████▎ | 809/971 [00:14<00:02, 56.12it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 56.99it/s]backtest loop:  85%|████████▍ | 821/971 [00:14<00:02, 57.66it/s]backtest loop:  85%|████████▌ | 827/971 [00:14<00:02, 58.06it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 54.78it/s]backtest loop:  86%|████████▋ | 839/971 [00:15<00:02, 55.98it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 56.91it/s]backtest loop:  88%|████████▊ | 851/971 [00:15<00:02, 57.57it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 54.50it/s]backtest loop:  89%|████████▉ | 863/971 [00:15<00:01, 55.77it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 56.67it/s]backtest loop:  90%|█████████ | 875/971 [00:15<00:01, 57.40it/s]backtest loop:  91%|█████████ | 881/971 [00:15<00:01, 57.90it/s]backtest loop:  91%|█████████▏| 887/971 [00:16<00:01, 54.59it/s]backtest loop:  92%|█████████▏| 893/971 [00:16<00:01, 55.88it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 56.86it/s]backtest loop:  93%|█████████▎| 905/971 [00:16<00:01, 57.51it/s]backtest loop:  94%|█████████▍| 911/971 [00:16<00:01, 58.12it/s]backtest loop:  94%|█████████▍| 917/971 [00:16<00:00, 54.75it/s]backtest loop:  95%|█████████▌| 923/971 [00:16<00:00, 55.96it/s]backtest loop:  96%|█████████▌| 929/971 [00:16<00:00, 56.58it/s]backtest loop:  96%|█████████▋| 935/971 [00:16<00:00, 57.25it/s]backtest loop:  97%|█████████▋| 941/971 [00:16<00:00, 54.35it/s]backtest loop:  98%|█████████▊| 947/971 [00:17<00:00, 55.68it/s]backtest loop:  98%|█████████▊| 953/971 [00:17<00:00, 56.78it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 57.44it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 54.40it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.53it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.46it/s]
[2928948:MainThread](2024-04-24 23:19:51,386) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000569
std                0.005259
annualized_return  0.135382
information_ratio  1.668743
max_drawdown      -0.105056
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000377
std                0.005260
annualized_return  0.089652
information_ratio  1.104713
max_drawdown      -0.122875
[2928948:MainThread](2024-04-24 23:19:51,401) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_22:10:42_online`.
Round 7 Done!
{'1day.excess_return_with_cost.annualized_return': [0.045906596817093956,
                                                    0.05947199783795087,
                                                    0.052020827576630645,
                                                    0.06660907356381215,
                                                    0.041062380160693655,
                                                    0.07031148260595382,
                                                    0.08965249269425685],
 '1day.excess_return_with_cost.information_ratio': [0.5989675803012956,
                                                    0.7992822081517327,
                                                    0.6773909197836762,
                                                    0.858868379402361,
                                                    0.5701050273115824,
                                                    1.0044152558669466,
                                                    1.1047130614499032],
 '1day.excess_return_with_cost.max_drawdown': [-0.12540023303514702,
                                               -0.12026081261057461,
                                               -0.13229595910483233,
                                               -0.10306790444738279,
                                               -0.15649562411434487,
                                               -0.08340678371365234,
                                               -0.12287546361542118],
 'IC': [0.02891690000013004,
        0.027223277140580798,
        0.02621109579435717,
        0.028330089929604008,
        0.029365079789197276,
        0.026172185682743515,
        0.02924021200620926],
 'ICIR': [0.26326419201305706,
          0.2457576703726845,
          0.24059646907054116,
          0.25260126906960617,
          0.2675765575196645,
          0.246492573957277,
          0.2701075098113818],
 'Rank IC': [0.02552035915838527,
             0.019222991218935784,
             0.020849039173561842,
             0.024555272432961062,
             0.023807031887618256,
             0.0200698216143074,
             0.024127009610319244],
 'Rank ICIR': [0.23664898746209853,
               0.17981857761811082,
               0.19444642706951779,
               0.22629638137184316,
               0.2248322860520228,
               0.19274257572483314,
               0.229834080976146],
 'mae': [0.6861680746078491,
         0.6861580610275269,
         0.68607097864151,
         0.6861945986747742,
         0.6861079931259155,
         0.686318039894104,
         0.6863036155700684],
 'mse': [0.9978829622268677,
         0.9977895021438599,
         0.997923731803894,
         0.997870683670044,
         0.9978796243667603,
         0.9980701208114624,
         0.9980088472366333]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2928948:MainThread](2024-04-24 23:19:52,761) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2928948:MainThread](2024-04-24 23:19:52,761) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2928948:MainThread](2024-04-24 23:19:52,763) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2928948:MainThread](2024-04-24 23:19:52,764) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:11<19:03, 11.55s/it]epoch:   2%|▏         | 2/100 [00:22<18:32, 11.35s/it]epoch:   3%|▎         | 3/100 [00:33<18:06, 11.20s/it]epoch:   4%|▍         | 4/100 [00:44<17:44, 11.08s/it]epoch:   5%|▌         | 5/100 [00:55<17:29, 11.05s/it]epoch:   6%|▌         | 6/100 [01:06<17:24, 11.11s/it]epoch:   7%|▋         | 7/100 [01:18<17:14, 11.13s/it]epoch:   8%|▊         | 8/100 [01:28<16:57, 11.06s/it]epoch:   9%|▉         | 9/100 [01:39<16:43, 11.03s/it]epoch:  10%|█         | 10/100 [01:51<16:39, 11.11s/it]epoch:  11%|█         | 11/100 [02:02<16:31, 11.14s/it]epoch:  12%|█▏        | 12/100 [02:13<16:15, 11.09s/it]epoch:  13%|█▎        | 13/100 [02:24<16:04, 11.09s/it]epoch:  14%|█▍        | 14/100 [02:35<15:58, 11.14s/it]epoch:  15%|█▌        | 15/100 [02:46<15:49, 11.17s/it]epoch:  16%|█▌        | 16/100 [02:57<15:32, 11.11s/it]epoch:  17%|█▋        | 17/100 [03:08<15:19, 11.08s/it]epoch:  18%|█▊        | 18/100 [03:20<15:12, 11.13s/it]epoch:  19%|█▉        | 19/100 [03:31<15:04, 11.17s/it]epoch:  20%|██        | 20/100 [03:42<14:48, 11.11s/it]epoch:  21%|██        | 21/100 [03:53<14:35, 11.08s/it]epoch:  22%|██▏       | 22/100 [04:04<14:30, 11.16s/it]epoch:  23%|██▎       | 23/100 [04:16<14:22, 11.20s/it]epoch:  24%|██▍       | 24/100 [04:27<14:05, 11.12s/it]epoch:  25%|██▌       | 25/100 [04:38<13:50, 11.07s/it]epoch:  26%|██▌       | 26/100 [04:49<13:45, 11.16s/it]epoch:  27%|██▋       | 27/100 [05:00<13:38, 11.21s/it]epoch:  28%|██▊       | 28/100 [05:11<13:22, 11.15s/it]epoch:  29%|██▉       | 29/100 [05:22<13:08, 11.11s/it]epoch:  30%|███       | 30/100 [05:33<13:00, 11.16s/it]0.05543046399025044
best ic: 0.05543046399025044
epoch:  31%|███       | 31/100 [05:46<13:24, 11.65s/it]0.05515782027737821
epoch:  32%|███▏      | 32/100 [05:59<13:29, 11.91s/it]0.056017663815956006
best ic: 0.056017663815956006
epoch:  33%|███▎      | 33/100 [06:11<13:30, 12.09s/it]0.05625251058083182
best ic: 0.05625251058083182
epoch:  34%|███▍      | 34/100 [06:24<13:32, 12.32s/it]0.05623585206717268
epoch:  35%|███▌      | 35/100 [06:37<13:28, 12.43s/it]0.059139437619958955
best ic: 0.059139437619958955
epoch:  36%|███▌      | 36/100 [06:49<13:17, 12.45s/it]0.05519988231758575
epoch:  37%|███▋      | 37/100 [07:02<13:07, 12.50s/it]0.05451775398262169
epoch:  38%|███▊      | 38/100 [07:15<13:01, 12.61s/it]0.05329392102464299
epoch:  39%|███▉      | 39/100 [07:27<12:49, 12.61s/it]0.05714978903020809
epoch:  40%|████      | 40/100 [07:40<12:35, 12.59s/it]0.05690425310789706
epoch:  41%|████      | 41/100 [07:53<12:25, 12.64s/it]0.05506088644226023
epoch:  42%|████▏     | 42/100 [08:06<12:18, 12.72s/it]0.057001749907474454
epoch:  43%|████▎     | 43/100 [08:18<12:00, 12.63s/it]0.054827654754069484
epoch:  43%|████▎     | 43/100 [08:31<11:17, 11.88s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2928948:MainThread](2024-04-24 23:28:23,823) INFO - qlib.workflow - [exp.py:258] - Experiment 40 starts running ...
[2928948:MainThread](2024-04-24 23:28:23,835) INFO - qlib.workflow - [recorder.py:341] - Recorder 1f820f11d47a4f1099c16f32135e6bc1 starts running under Experiment 40 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:05, 11.25it/s]online:   6%|▋         | 4/63 [00:00<00:05, 11.05it/s]online:  10%|▉         | 6/63 [00:00<00:05, 10.89it/s]online:  13%|█▎        | 8/63 [00:00<00:05, 10.89it/s]online:  16%|█▌        | 10/63 [00:00<00:04, 10.79it/s]online:  19%|█▉        | 12/63 [00:01<00:04, 10.76it/s]online:  22%|██▏       | 14/63 [00:01<00:04, 10.68it/s]online:  25%|██▌       | 16/63 [00:01<00:04, 10.66it/s]online:  29%|██▊       | 18/63 [00:01<00:04, 10.71it/s]online:  32%|███▏      | 20/63 [00:01<00:04, 10.67it/s]online:  35%|███▍      | 22/63 [00:02<00:03, 10.71it/s]online:  38%|███▊      | 24/63 [00:02<00:03, 10.72it/s]online:  41%|████▏     | 26/63 [00:02<00:03, 10.72it/s]online:  44%|████▍     | 28/63 [00:02<00:03, 10.86it/s]online:  48%|████▊     | 30/63 [00:02<00:03, 10.83it/s]online:  51%|█████     | 32/63 [00:02<00:02, 10.77it/s]online:  54%|█████▍    | 34/63 [00:03<00:02, 10.79it/s]online:  57%|█████▋    | 36/63 [00:03<00:02, 10.77it/s]online:  60%|██████    | 38/63 [00:03<00:02, 10.79it/s]online:  63%|██████▎   | 40/63 [00:03<00:02, 10.80it/s]online:  67%|██████▋   | 42/63 [00:03<00:01, 10.78it/s]online:  70%|██████▉   | 44/63 [00:04<00:01, 10.77it/s]online:  73%|███████▎  | 46/63 [00:04<00:01, 10.76it/s]online:  76%|███████▌  | 48/63 [00:04<00:01, 10.79it/s]online:  79%|███████▉  | 50/63 [00:04<00:01, 10.80it/s]online:  83%|████████▎ | 52/63 [00:04<00:01, 10.81it/s]online:  86%|████████▌ | 54/63 [00:05<00:00, 10.78it/s]online:  89%|████████▉ | 56/63 [00:05<00:00, 10.80it/s]online:  92%|█████████▏| 58/63 [00:05<00:00, 10.81it/s]online:  95%|█████████▌| 60/63 [00:05<00:00, 10.80it/s]online:  98%|█████████▊| 62/63 [00:05<00:00, 10.82it/s]online: 100%|██████████| 63/63 [00:05<00:00, 10.81it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2928948:MainThread](2024-04-24 23:28:42,038) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99814236 mae 0.6861899
{'IC': 0.026437084579882433,
 'ICIR': 0.24599690790000178,
 'Rank IC': 0.02163665414350632,
 'Rank ICIR': 0.2039190061968451}
[2928948:MainThread](2024-04-24 23:28:43,928) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2928948:MainThread](2024-04-24 23:28:59,657) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 23:28:59,660) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 23:29:05,723) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f975d2b4040>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:45,  9.17it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.51it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 34.76it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 39.58it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 44.94it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 49.24it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:19, 48.77it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:18, 51.06it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:17, 53.25it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 51.09it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 53.10it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:16, 54.37it/s]backtest loop:   8%|▊         | 76/971 [00:01<00:15, 57.17it/s]backtest loop:   8%|▊         | 82/971 [00:01<00:16, 53.82it/s]backtest loop:   9%|▉         | 88/971 [00:01<00:16, 53.94it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 55.53it/s]backtest loop:  10%|█         | 100/971 [00:02<00:15, 56.56it/s]backtest loop:  11%|█         | 106/971 [00:02<00:15, 56.98it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 54.14it/s]backtest loop:  12%|█▏        | 118/971 [00:02<00:15, 54.99it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:15, 56.09it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:15, 53.35it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:16, 51.60it/s]backtest loop:  15%|█▍        | 142/971 [00:02<00:15, 53.66it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 54.96it/s]backtest loop:  16%|█▌        | 154/971 [00:03<00:14, 56.05it/s]backtest loop:  16%|█▋        | 160/971 [00:03<00:14, 56.85it/s]backtest loop:  17%|█▋        | 166/971 [00:03<00:15, 53.64it/s]backtest loop:  18%|█▊        | 172/971 [00:03<00:14, 55.08it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:14, 56.36it/s]backtest loop:  19%|█▉        | 184/971 [00:03<00:13, 57.05it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:14, 54.44it/s]backtest loop:  20%|██        | 196/971 [00:03<00:13, 55.59it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 56.81it/s]backtest loop:  22%|██▏       | 209/971 [00:04<00:12, 58.62it/s]backtest loop:  22%|██▏       | 215/971 [00:04<00:14, 52.24it/s]backtest loop:  23%|██▎       | 221/971 [00:04<00:13, 53.68it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:13, 54.96it/s]backtest loop:  24%|██▍       | 233/971 [00:04<00:13, 55.77it/s]backtest loop:  25%|██▍       | 239/971 [00:04<00:12, 56.71it/s]backtest loop:  25%|██▌       | 245/971 [00:04<00:13, 53.72it/s]backtest loop:  26%|██▌       | 251/971 [00:04<00:13, 55.21it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 56.24it/s]backtest loop:  27%|██▋       | 264/971 [00:05<00:13, 54.22it/s]backtest loop:  28%|██▊       | 270/971 [00:05<00:12, 55.29it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:13, 51.48it/s]backtest loop:  29%|██▉       | 282/971 [00:05<00:13, 52.16it/s]backtest loop:  30%|██▉       | 288/971 [00:05<00:12, 52.65it/s]backtest loop:  30%|███       | 294/971 [00:05<00:12, 52.95it/s]backtest loop:  31%|███       | 300/971 [00:05<00:13, 49.99it/s]backtest loop:  32%|███▏      | 306/971 [00:05<00:13, 50.99it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:12, 51.77it/s]backtest loop:  33%|███▎      | 318/971 [00:06<00:12, 52.16it/s]backtest loop:  33%|███▎      | 324/971 [00:06<00:12, 52.92it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:12, 50.00it/s]backtest loop:  35%|███▍      | 336/971 [00:06<00:12, 51.17it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:12, 51.86it/s]backtest loop:  36%|███▌      | 348/971 [00:06<00:11, 52.48it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:11, 53.25it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:12, 50.73it/s]backtest loop:  38%|███▊      | 366/971 [00:07<00:11, 52.02it/s]backtest loop:  38%|███▊      | 372/971 [00:07<00:12, 49.44it/s]backtest loop:  39%|███▉      | 378/971 [00:07<00:12, 47.86it/s]backtest loop:  40%|███▉      | 384/971 [00:07<00:11, 49.64it/s]backtest loop:  40%|████      | 390/971 [00:07<00:11, 50.58it/s]backtest loop:  41%|████      | 396/971 [00:07<00:11, 51.70it/s]backtest loop:  41%|████▏     | 402/971 [00:07<00:10, 52.72it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:11, 49.94it/s]backtest loop:  43%|████▎     | 414/971 [00:07<00:10, 50.98it/s]backtest loop:  43%|████▎     | 420/971 [00:08<00:10, 51.57it/s]backtest loop:  44%|████▍     | 426/971 [00:08<00:10, 52.26it/s]backtest loop:  44%|████▍     | 432/971 [00:08<00:10, 49.43it/s]backtest loop:  45%|████▌     | 438/971 [00:08<00:10, 50.55it/s]backtest loop:  46%|████▌     | 444/971 [00:08<00:10, 51.38it/s]backtest loop:  46%|████▋     | 450/971 [00:08<00:09, 52.20it/s]backtest loop:  47%|████▋     | 456/971 [00:08<00:09, 52.47it/s]backtest loop:  48%|████▊     | 462/971 [00:08<00:10, 49.52it/s]backtest loop:  48%|████▊     | 468/971 [00:09<00:09, 50.51it/s]backtest loop:  49%|████▉     | 474/971 [00:09<00:09, 51.45it/s]backtest loop:  49%|████▉     | 480/971 [00:09<00:09, 52.27it/s]backtest loop:  50%|█████     | 486/971 [00:09<00:09, 52.73it/s]backtest loop:  51%|█████     | 492/971 [00:09<00:09, 49.74it/s]backtest loop:  51%|█████▏    | 498/971 [00:09<00:09, 50.89it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:08, 51.94it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:09, 49.60it/s]backtest loop:  53%|█████▎    | 516/971 [00:09<00:09, 50.40it/s]backtest loop:  54%|█████▍    | 522/971 [00:10<00:09, 48.48it/s]backtest loop:  54%|█████▍    | 528/971 [00:10<00:08, 49.97it/s]backtest loop:  55%|█████▍    | 534/971 [00:10<00:08, 51.13it/s]backtest loop:  56%|█████▌    | 540/971 [00:10<00:08, 51.97it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:08, 49.71it/s]backtest loop:  57%|█████▋    | 552/971 [00:10<00:08, 50.97it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 51.63it/s]backtest loop:  58%|█████▊    | 564/971 [00:10<00:07, 52.04it/s]backtest loop:  59%|█████▊    | 570/971 [00:11<00:07, 52.51it/s]backtest loop:  59%|█████▉    | 576/971 [00:11<00:07, 49.71it/s]backtest loop:  60%|█████▉    | 582/971 [00:11<00:07, 51.00it/s]backtest loop:  61%|██████    | 588/971 [00:11<00:07, 51.81it/s]backtest loop:  61%|██████    | 594/971 [00:11<00:07, 52.53it/s]backtest loop:  62%|██████▏   | 600/971 [00:11<00:07, 49.46it/s]backtest loop:  62%|██████▏   | 606/971 [00:11<00:07, 50.82it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 51.52it/s]backtest loop:  64%|██████▎   | 618/971 [00:11<00:06, 51.76it/s]backtest loop:  64%|██████▍   | 624/971 [00:12<00:06, 52.40it/s]backtest loop:  65%|██████▍   | 630/971 [00:12<00:06, 49.75it/s]backtest loop:  65%|██████▌   | 636/971 [00:12<00:06, 50.91it/s]backtest loop:  66%|██████▌   | 642/971 [00:12<00:06, 51.70it/s]backtest loop:  67%|██████▋   | 648/971 [00:12<00:06, 52.37it/s]backtest loop:  67%|██████▋   | 654/971 [00:12<00:05, 53.03it/s]backtest loop:  68%|██████▊   | 660/971 [00:12<00:06, 49.74it/s]backtest loop:  69%|██████▊   | 666/971 [00:12<00:05, 50.87it/s]backtest loop:  69%|██████▉   | 672/971 [00:13<00:05, 51.64it/s]backtest loop:  70%|██████▉   | 678/971 [00:13<00:05, 52.30it/s]backtest loop:  70%|███████   | 684/971 [00:13<00:05, 49.38it/s]backtest loop:  71%|███████   | 690/971 [00:13<00:05, 50.67it/s]backtest loop:  72%|███████▏  | 696/971 [00:13<00:05, 51.42it/s]backtest loop:  72%|███████▏  | 702/971 [00:13<00:05, 52.31it/s]backtest loop:  73%|███████▎  | 708/971 [00:13<00:04, 52.70it/s]backtest loop:  74%|███████▎  | 714/971 [00:13<00:05, 49.80it/s]backtest loop:  74%|███████▍  | 720/971 [00:13<00:04, 50.92it/s]backtest loop:  75%|███████▍  | 726/971 [00:14<00:04, 51.78it/s]backtest loop:  75%|███████▌  | 732/971 [00:14<00:04, 49.28it/s]backtest loop:  76%|███████▌  | 738/971 [00:14<00:04, 47.56it/s]backtest loop:  77%|███████▋  | 744/971 [00:14<00:04, 49.42it/s]backtest loop:  77%|███████▋  | 750/971 [00:14<00:04, 48.02it/s]backtest loop:  78%|███████▊  | 756/971 [00:14<00:04, 49.58it/s]backtest loop:  78%|███████▊  | 762/971 [00:14<00:04, 50.96it/s]backtest loop:  79%|███████▉  | 768/971 [00:14<00:03, 52.80it/s]backtest loop:  80%|███████▉  | 774/971 [00:15<00:03, 53.94it/s]backtest loop:  80%|████████  | 780/971 [00:15<00:03, 51.06it/s]backtest loop:  81%|████████  | 786/971 [00:15<00:03, 51.90it/s]backtest loop:  82%|████████▏ | 792/971 [00:15<00:03, 52.66it/s]backtest loop:  82%|████████▏ | 798/971 [00:15<00:03, 50.07it/s]backtest loop:  83%|████████▎ | 804/971 [00:15<00:03, 51.04it/s]backtest loop:  83%|████████▎ | 810/971 [00:15<00:03, 51.53it/s]backtest loop:  84%|████████▍ | 816/971 [00:15<00:02, 52.44it/s]backtest loop:  85%|████████▍ | 822/971 [00:15<00:02, 52.89it/s]backtest loop:  85%|████████▌ | 828/971 [00:16<00:02, 49.96it/s]backtest loop:  86%|████████▌ | 834/971 [00:16<00:02, 50.99it/s]backtest loop:  87%|████████▋ | 840/971 [00:16<00:02, 51.74it/s]backtest loop:  87%|████████▋ | 846/971 [00:16<00:02, 52.35it/s]backtest loop:  88%|████████▊ | 852/971 [00:16<00:02, 49.40it/s]backtest loop:  88%|████████▊ | 858/971 [00:16<00:02, 50.46it/s]backtest loop:  89%|████████▉ | 864/971 [00:16<00:02, 51.46it/s]backtest loop:  90%|████████▉ | 870/971 [00:16<00:01, 52.10it/s]backtest loop:  90%|█████████ | 876/971 [00:17<00:01, 52.70it/s]backtest loop:  91%|█████████ | 882/971 [00:17<00:01, 49.91it/s]backtest loop:  91%|█████████▏| 888/971 [00:17<00:01, 50.84it/s]backtest loop:  92%|█████████▏| 894/971 [00:17<00:01, 51.68it/s]backtest loop:  93%|█████████▎| 900/971 [00:17<00:01, 52.40it/s]backtest loop:  93%|█████████▎| 906/971 [00:17<00:01, 52.60it/s]backtest loop:  94%|█████████▍| 912/971 [00:17<00:01, 49.93it/s]backtest loop:  95%|█████████▍| 918/971 [00:17<00:01, 50.77it/s]backtest loop:  95%|█████████▌| 924/971 [00:17<00:00, 51.47it/s]backtest loop:  96%|█████████▌| 930/971 [00:18<00:00, 52.15it/s]backtest loop:  96%|█████████▋| 936/971 [00:18<00:00, 49.31it/s]backtest loop:  97%|█████████▋| 942/971 [00:18<00:00, 50.51it/s]backtest loop:  98%|█████████▊| 948/971 [00:18<00:00, 51.46it/s]backtest loop:  98%|█████████▊| 954/971 [00:18<00:00, 52.44it/s]backtest loop:  99%|█████████▉| 960/971 [00:18<00:00, 49.67it/s]backtest loop:  99%|█████████▉| 966/971 [00:18<00:00, 50.65it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 51.36it/s]
[2928948:MainThread](2024-04-24 23:29:24,698) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000271
std                0.004604
annualized_return  0.064581
information_ratio  0.909248
max_drawdown      -0.073767
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000077
std                0.004606
annualized_return  0.018428
information_ratio  0.259337
max_drawdown      -0.119627
[2928948:MainThread](2024-04-24 23:29:24,714) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_22:10:42_online`.
Round 8 Done!
{'1day.excess_return_with_cost.annualized_return': [0.045906596817093956,
                                                    0.05947199783795087,
                                                    0.052020827576630645,
                                                    0.06660907356381215,
                                                    0.041062380160693655,
                                                    0.07031148260595382,
                                                    0.08965249269425685,
                                                    0.018427776873876485],
 '1day.excess_return_with_cost.information_ratio': [0.5989675803012956,
                                                    0.7992822081517327,
                                                    0.6773909197836762,
                                                    0.858868379402361,
                                                    0.5701050273115824,
                                                    1.0044152558669466,
                                                    1.1047130614499032,
                                                    0.2593370774822796],
 '1day.excess_return_with_cost.max_drawdown': [-0.12540023303514702,
                                               -0.12026081261057461,
                                               -0.13229595910483233,
                                               -0.10306790444738279,
                                               -0.15649562411434487,
                                               -0.08340678371365234,
                                               -0.12287546361542118,
                                               -0.1196267135266065],
 'IC': [0.02891690000013004,
        0.027223277140580798,
        0.02621109579435717,
        0.028330089929604008,
        0.029365079789197276,
        0.026172185682743515,
        0.02924021200620926,
        0.026437084579882433],
 'ICIR': [0.26326419201305706,
          0.2457576703726845,
          0.24059646907054116,
          0.25260126906960617,
          0.2675765575196645,
          0.246492573957277,
          0.2701075098113818,
          0.24599690790000178],
 'Rank IC': [0.02552035915838527,
             0.019222991218935784,
             0.020849039173561842,
             0.024555272432961062,
             0.023807031887618256,
             0.0200698216143074,
             0.024127009610319244,
             0.02163665414350632],
 'Rank ICIR': [0.23664898746209853,
               0.17981857761811082,
               0.19444642706951779,
               0.22629638137184316,
               0.2248322860520228,
               0.19274257572483314,
               0.229834080976146,
               0.2039190061968451],
 'mae': [0.6861680746078491,
         0.6861580610275269,
         0.68607097864151,
         0.6861945986747742,
         0.6861079931259155,
         0.686318039894104,
         0.6863036155700684,
         0.6861898899078369],
 'mse': [0.9978829622268677,
         0.9977895021438599,
         0.997923731803894,
         0.997870683670044,
         0.9978796243667603,
         0.9980701208114624,
         0.9980088472366333,
         0.9981423616409302]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2928948:MainThread](2024-04-24 23:29:26,064) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2928948:MainThread](2024-04-24 23:29:26,065) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2928948:MainThread](2024-04-24 23:29:26,067) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2928948:MainThread](2024-04-24 23:29:26,067) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:11<18:59, 11.51s/it]epoch:   2%|▏         | 2/100 [00:22<18:24, 11.27s/it]epoch:   3%|▎         | 3/100 [00:33<18:16, 11.31s/it]epoch:   4%|▍         | 4/100 [00:45<18:01, 11.27s/it]epoch:   5%|▌         | 5/100 [00:55<17:33, 11.09s/it]epoch:   6%|▌         | 6/100 [01:06<17:17, 11.04s/it]epoch:   7%|▋         | 7/100 [01:18<17:15, 11.13s/it]epoch:   8%|▊         | 8/100 [01:29<17:01, 11.10s/it]epoch:   9%|▉         | 9/100 [01:40<16:47, 11.07s/it]epoch:  10%|█         | 10/100 [01:51<16:38, 11.09s/it]epoch:  11%|█         | 11/100 [02:02<16:33, 11.16s/it]epoch:  12%|█▏        | 12/100 [02:13<16:19, 11.13s/it]epoch:  13%|█▎        | 13/100 [02:24<16:02, 11.06s/it]epoch:  14%|█▍        | 14/100 [02:35<15:50, 11.05s/it]epoch:  15%|█▌        | 15/100 [02:47<15:46, 11.13s/it]epoch:  16%|█▌        | 16/100 [02:58<15:35, 11.13s/it]epoch:  17%|█▋        | 17/100 [03:09<15:18, 11.07s/it]epoch:  18%|█▊        | 18/100 [03:20<15:06, 11.05s/it]epoch:  19%|█▉        | 19/100 [03:31<15:01, 11.12s/it]epoch:  20%|██        | 20/100 [03:42<14:50, 11.13s/it]epoch:  21%|██        | 21/100 [03:53<14:34, 11.07s/it]epoch:  22%|██▏       | 22/100 [04:04<14:21, 11.04s/it]epoch:  23%|██▎       | 23/100 [04:15<14:17, 11.13s/it]epoch:  24%|██▍       | 24/100 [04:26<14:05, 11.12s/it]epoch:  25%|██▌       | 25/100 [04:37<13:50, 11.07s/it]epoch:  26%|██▌       | 26/100 [04:48<13:39, 11.08s/it]epoch:  27%|██▋       | 27/100 [05:00<13:32, 11.13s/it]epoch:  28%|██▊       | 28/100 [05:11<13:23, 11.16s/it]epoch:  29%|██▉       | 29/100 [05:22<13:09, 11.12s/it]epoch:  30%|███       | 30/100 [05:33<12:56, 11.10s/it]0.056167587425431244
best ic: 0.056167587425431244
epoch:  31%|███       | 31/100 [05:46<13:23, 11.65s/it]0.05292452548479049
epoch:  32%|███▏      | 32/100 [05:59<13:31, 11.94s/it]0.055997086186736024
epoch:  33%|███▎      | 33/100 [06:11<13:29, 12.09s/it]0.055971335690815374
epoch:  34%|███▍      | 34/100 [06:24<13:30, 12.27s/it]0.05677945976341003
best ic: 0.05677945976341003
epoch:  35%|███▌      | 35/100 [06:37<13:31, 12.48s/it]0.058500002594573164
best ic: 0.058500002594573164
epoch:  36%|███▌      | 36/100 [06:49<13:18, 12.48s/it]0.05598878114634244
epoch:  37%|███▋      | 37/100 [07:02<13:05, 12.47s/it]0.055267983449431575
epoch:  38%|███▊      | 38/100 [07:14<12:58, 12.56s/it]0.055277696137273215
epoch:  39%|███▉      | 39/100 [07:27<12:53, 12.68s/it]0.05438977623313177
epoch:  40%|████      | 40/100 [07:40<12:37, 12.63s/it]0.05800179690646805
epoch:  41%|████      | 41/100 [07:52<12:23, 12.60s/it]0.05539865602680646
epoch:  42%|████▏     | 42/100 [08:05<12:14, 12.66s/it]0.05550642670608751
epoch:  43%|████▎     | 43/100 [08:18<12:02, 12.68s/it]0.057551456240260826
epoch:  43%|████▎     | 43/100 [08:30<11:17, 11.88s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2928948:MainThread](2024-04-24 23:37:56,905) INFO - qlib.workflow - [exp.py:258] - Experiment 40 starts running ...
[2928948:MainThread](2024-04-24 23:37:56,918) INFO - qlib.workflow - [recorder.py:341] - Recorder f7fb86866e034216a032e36b4284a841 starts running under Experiment 40 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:05, 11.73it/s]online:   6%|▋         | 4/63 [00:00<00:05, 11.31it/s]online:  10%|▉         | 6/63 [00:00<00:05, 11.19it/s]online:  13%|█▎        | 8/63 [00:00<00:04, 11.12it/s]online:  16%|█▌        | 10/63 [00:00<00:04, 11.08it/s]online:  19%|█▉        | 12/63 [00:01<00:04, 11.03it/s]online:  22%|██▏       | 14/63 [00:01<00:04, 11.03it/s]online:  25%|██▌       | 16/63 [00:01<00:04, 11.03it/s]online:  29%|██▊       | 18/63 [00:01<00:04, 11.00it/s]online:  32%|███▏      | 20/63 [00:01<00:03, 11.02it/s]online:  35%|███▍      | 22/63 [00:01<00:03, 11.03it/s]online:  38%|███▊      | 24/63 [00:02<00:03, 10.87it/s]online:  41%|████▏     | 26/63 [00:02<00:03, 10.91it/s]online:  44%|████▍     | 28/63 [00:02<00:03, 10.77it/s]online:  48%|████▊     | 30/63 [00:02<00:03, 10.83it/s]online:  51%|█████     | 32/63 [00:02<00:02, 10.80it/s]online:  54%|█████▍    | 34/63 [00:03<00:02, 10.92it/s]online:  57%|█████▋    | 36/63 [00:03<00:02, 10.96it/s]online:  60%|██████    | 38/63 [00:03<00:02, 10.95it/s]online:  63%|██████▎   | 40/63 [00:03<00:02, 10.98it/s]online:  67%|██████▋   | 42/63 [00:03<00:01, 10.95it/s]online:  70%|██████▉   | 44/63 [00:04<00:01, 11.04it/s]online:  73%|███████▎  | 46/63 [00:04<00:01, 11.01it/s]online:  76%|███████▌  | 48/63 [00:04<00:01, 11.03it/s]online:  79%|███████▉  | 50/63 [00:04<00:01, 11.04it/s]online:  83%|████████▎ | 52/63 [00:04<00:01, 10.97it/s]online:  86%|████████▌ | 54/63 [00:04<00:00, 11.00it/s]online:  89%|████████▉ | 56/63 [00:05<00:00, 11.05it/s]online:  92%|█████████▏| 58/63 [00:05<00:00, 11.06it/s]online:  95%|█████████▌| 60/63 [00:05<00:00, 11.03it/s]online:  98%|█████████▊| 62/63 [00:05<00:00, 11.01it/s]online: 100%|██████████| 63/63 [00:05<00:00, 11.02it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2928948:MainThread](2024-04-24 23:38:15,692) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99764216 mae 0.68608063
{'IC': 0.03089042233933558,
 'ICIR': 0.2741929711324064,
 'Rank IC': 0.027167432051046304,
 'Rank ICIR': 0.2472696686663908}
[2928948:MainThread](2024-04-24 23:38:17,579) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2928948:MainThread](2024-04-24 23:38:33,311) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 23:38:33,314) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 23:38:39,507) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f975c2da430>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:49,  8.87it/s]backtest loop:   1%|          | 9/971 [00:00<00:41, 23.26it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:29, 32.79it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:25, 37.10it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:22, 41.76it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 45.59it/s]backtest loop:   4%|▍         | 38/971 [00:01<00:20, 46.60it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:20, 45.59it/s]backtest loop:   5%|▌         | 50/971 [00:01<00:19, 47.87it/s]backtest loop:   6%|▌         | 56/971 [00:01<00:18, 49.48it/s]backtest loop:   6%|▋         | 62/971 [00:01<00:18, 47.94it/s]backtest loop:   7%|▋         | 68/971 [00:01<00:18, 49.58it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:17, 51.27it/s]backtest loop:   8%|▊         | 80/971 [00:01<00:17, 51.63it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:16, 52.33it/s]backtest loop:   9%|▉         | 92/971 [00:02<00:17, 49.93it/s]backtest loop:  10%|█         | 98/971 [00:02<00:17, 51.11it/s]backtest loop:  11%|█         | 104/971 [00:02<00:16, 51.84it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:16, 52.55it/s]backtest loop:  12%|█▏        | 116/971 [00:02<00:16, 52.88it/s]backtest loop:  13%|█▎        | 122/971 [00:02<00:16, 49.99it/s]backtest loop:  13%|█▎        | 128/971 [00:02<00:17, 48.15it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:16, 49.79it/s]backtest loop:  14%|█▍        | 140/971 [00:03<00:16, 51.05it/s]backtest loop:  15%|█▌        | 146/971 [00:03<00:16, 48.92it/s]backtest loop:  16%|█▌        | 152/971 [00:03<00:16, 50.32it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:15, 51.52it/s]backtest loop:  17%|█▋        | 164/971 [00:03<00:15, 52.17it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:15, 52.66it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:15, 49.96it/s]backtest loop:  19%|█▊        | 182/971 [00:03<00:15, 51.12it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:15, 51.88it/s]backtest loop:  20%|█▉        | 194/971 [00:04<00:14, 52.60it/s]backtest loop:  21%|██        | 200/971 [00:04<00:15, 50.23it/s]backtest loop:  21%|██        | 206/971 [00:04<00:14, 51.74it/s]backtest loop:  22%|██▏       | 212/971 [00:04<00:14, 52.46it/s]backtest loop:  22%|██▏       | 218/971 [00:04<00:15, 49.73it/s]backtest loop:  23%|██▎       | 224/971 [00:04<00:14, 51.06it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:15, 48.79it/s]backtest loop:  24%|██▍       | 236/971 [00:04<00:14, 49.98it/s]backtest loop:  25%|██▍       | 242/971 [00:05<00:14, 51.21it/s]backtest loop:  26%|██▌       | 248/971 [00:05<00:13, 52.26it/s]backtest loop:  26%|██▌       | 254/971 [00:05<00:14, 49.47it/s]backtest loop:  27%|██▋       | 260/971 [00:05<00:14, 50.60it/s]backtest loop:  27%|██▋       | 266/971 [00:05<00:14, 48.44it/s]backtest loop:  28%|██▊       | 272/971 [00:05<00:14, 49.93it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:13, 51.17it/s]backtest loop:  29%|██▉       | 284/971 [00:05<00:13, 51.98it/s]backtest loop:  30%|██▉       | 290/971 [00:05<00:12, 52.85it/s]backtest loop:  30%|███       | 296/971 [00:06<00:13, 50.14it/s]backtest loop:  31%|███       | 302/971 [00:06<00:13, 51.14it/s]backtest loop:  32%|███▏      | 308/971 [00:06<00:12, 52.04it/s]backtest loop:  32%|███▏      | 314/971 [00:06<00:12, 52.92it/s]backtest loop:  33%|███▎      | 320/971 [00:06<00:13, 49.88it/s]backtest loop:  34%|███▎      | 326/971 [00:06<00:12, 51.45it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:12, 52.18it/s]backtest loop:  35%|███▍      | 338/971 [00:06<00:11, 52.80it/s]backtest loop:  35%|███▌      | 344/971 [00:07<00:11, 53.09it/s]backtest loop:  36%|███▌      | 350/971 [00:07<00:12, 50.31it/s]backtest loop:  37%|███▋      | 356/971 [00:07<00:11, 51.74it/s]backtest loop:  37%|███▋      | 362/971 [00:07<00:11, 52.80it/s]backtest loop:  38%|███▊      | 368/971 [00:07<00:12, 47.45it/s]backtest loop:  39%|███▊      | 374/971 [00:07<00:12, 49.18it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:11, 50.50it/s]backtest loop:  40%|███▉      | 386/971 [00:07<00:11, 51.65it/s]backtest loop:  40%|████      | 392/971 [00:07<00:11, 52.40it/s]backtest loop:  41%|████      | 398/971 [00:08<00:11, 49.71it/s]backtest loop:  42%|████▏     | 404/971 [00:08<00:11, 50.88it/s]backtest loop:  42%|████▏     | 410/971 [00:08<00:10, 51.82it/s]backtest loop:  43%|████▎     | 416/971 [00:08<00:10, 52.39it/s]backtest loop:  43%|████▎     | 422/971 [00:08<00:10, 52.92it/s]backtest loop:  44%|████▍     | 428/971 [00:08<00:10, 49.61it/s]backtest loop:  45%|████▍     | 434/971 [00:08<00:10, 50.74it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:10, 51.63it/s]backtest loop:  46%|████▌     | 446/971 [00:09<00:10, 52.09it/s]backtest loop:  47%|████▋     | 452/971 [00:09<00:10, 49.43it/s]backtest loop:  47%|████▋     | 458/971 [00:09<00:10, 50.62it/s]backtest loop:  48%|████▊     | 464/971 [00:09<00:09, 51.36it/s]backtest loop:  48%|████▊     | 470/971 [00:09<00:09, 52.03it/s]backtest loop:  49%|████▉     | 476/971 [00:09<00:09, 52.95it/s]backtest loop:  50%|████▉     | 482/971 [00:09<00:09, 50.57it/s]backtest loop:  50%|█████     | 488/971 [00:09<00:09, 51.48it/s]backtest loop:  51%|█████     | 494/971 [00:09<00:09, 52.29it/s]backtest loop:  51%|█████▏    | 500/971 [00:10<00:09, 49.58it/s]backtest loop:  52%|█████▏    | 506/971 [00:10<00:09, 51.26it/s]backtest loop:  53%|█████▎    | 512/971 [00:10<00:09, 48.95it/s]backtest loop:  53%|█████▎    | 518/971 [00:10<00:08, 50.38it/s]backtest loop:  54%|█████▍    | 524/971 [00:10<00:08, 51.34it/s]backtest loop:  55%|█████▍    | 530/971 [00:10<00:08, 51.96it/s]backtest loop:  55%|█████▌    | 536/971 [00:10<00:08, 49.49it/s]backtest loop:  56%|█████▌    | 542/971 [00:10<00:08, 50.96it/s]backtest loop:  56%|█████▋    | 548/971 [00:11<00:08, 51.77it/s]backtest loop:  57%|█████▋    | 554/971 [00:11<00:07, 52.36it/s]backtest loop:  58%|█████▊    | 560/971 [00:11<00:07, 52.94it/s]backtest loop:  58%|█████▊    | 566/971 [00:11<00:08, 50.15it/s]backtest loop:  59%|█████▉    | 572/971 [00:11<00:07, 50.73it/s]backtest loop:  60%|█████▉    | 578/971 [00:11<00:07, 51.65it/s]backtest loop:  60%|██████    | 584/971 [00:11<00:07, 52.32it/s]backtest loop:  61%|██████    | 590/971 [00:11<00:07, 52.82it/s]backtest loop:  61%|██████▏   | 596/971 [00:11<00:07, 49.98it/s]backtest loop:  62%|██████▏   | 602/971 [00:12<00:07, 51.12it/s]backtest loop:  63%|██████▎   | 608/971 [00:12<00:06, 51.88it/s]backtest loop:  63%|██████▎   | 614/971 [00:12<00:06, 52.51it/s]backtest loop:  64%|██████▍   | 620/971 [00:12<00:07, 49.61it/s]backtest loop:  64%|██████▍   | 626/971 [00:12<00:06, 50.81it/s]backtest loop:  65%|██████▌   | 632/971 [00:12<00:06, 51.93it/s]backtest loop:  66%|██████▌   | 638/971 [00:12<00:06, 52.54it/s]backtest loop:  66%|██████▋   | 644/971 [00:12<00:06, 53.00it/s]backtest loop:  67%|██████▋   | 650/971 [00:13<00:06, 50.06it/s]backtest loop:  68%|██████▊   | 656/971 [00:13<00:06, 52.31it/s]backtest loop:  68%|██████▊   | 662/971 [00:13<00:05, 52.77it/s]backtest loop:  69%|██████▉   | 668/971 [00:13<00:05, 53.12it/s]backtest loop:  69%|██████▉   | 674/971 [00:13<00:05, 51.45it/s]backtest loop:  70%|███████   | 680/971 [00:13<00:05, 53.53it/s]backtest loop:  71%|███████   | 686/971 [00:13<00:05, 54.65it/s]backtest loop:  71%|███████▏  | 692/971 [00:13<00:04, 55.81it/s]backtest loop:  72%|███████▏  | 698/971 [00:13<00:04, 56.69it/s]backtest loop:  73%|███████▎  | 704/971 [00:13<00:04, 53.94it/s]backtest loop:  73%|███████▎  | 710/971 [00:14<00:04, 55.32it/s]backtest loop:  74%|███████▎  | 716/971 [00:14<00:04, 56.31it/s]backtest loop:  74%|███████▍  | 722/971 [00:14<00:04, 57.09it/s]backtest loop:  75%|███████▍  | 728/971 [00:14<00:04, 57.76it/s]backtest loop:  76%|███████▌  | 734/971 [00:14<00:04, 51.71it/s]backtest loop:  76%|███████▌  | 740/971 [00:14<00:04, 53.56it/s]backtest loop:  77%|███████▋  | 746/971 [00:14<00:04, 55.04it/s]backtest loop:  77%|███████▋  | 752/971 [00:14<00:04, 53.28it/s]backtest loop:  78%|███████▊  | 759/971 [00:14<00:03, 55.97it/s]backtest loop:  79%|███████▉  | 765/971 [00:15<00:03, 53.65it/s]backtest loop:  79%|███████▉  | 771/971 [00:15<00:03, 54.95it/s]backtest loop:  80%|████████  | 777/971 [00:15<00:03, 56.16it/s]backtest loop:  81%|████████  | 783/971 [00:15<00:03, 53.50it/s]backtest loop:  81%|████████▏ | 789/971 [00:15<00:03, 54.97it/s]backtest loop:  82%|████████▏ | 795/971 [00:15<00:03, 56.15it/s]backtest loop:  83%|████████▎ | 802/971 [00:15<00:02, 58.01it/s]backtest loop:  83%|████████▎ | 808/971 [00:15<00:02, 54.90it/s]backtest loop:  84%|████████▍ | 814/971 [00:15<00:02, 55.73it/s]backtest loop:  84%|████████▍ | 820/971 [00:16<00:02, 56.60it/s]backtest loop:  85%|████████▌ | 826/971 [00:16<00:02, 57.27it/s]backtest loop:  86%|████████▌ | 832/971 [00:16<00:02, 57.80it/s]backtest loop:  86%|████████▋ | 838/971 [00:16<00:02, 54.63it/s]backtest loop:  87%|████████▋ | 844/971 [00:16<00:02, 55.91it/s]backtest loop:  88%|████████▊ | 850/971 [00:16<00:02, 56.76it/s]backtest loop:  88%|████████▊ | 856/971 [00:16<00:02, 57.14it/s]backtest loop:  89%|████████▉ | 862/971 [00:16<00:02, 54.26it/s]backtest loop:  89%|████████▉ | 868/971 [00:16<00:01, 55.49it/s]backtest loop:  90%|█████████ | 874/971 [00:17<00:01, 56.44it/s]backtest loop:  91%|█████████ | 880/971 [00:17<00:01, 57.33it/s]backtest loop:  91%|█████████ | 886/971 [00:17<00:01, 57.94it/s]backtest loop:  92%|█████████▏| 892/971 [00:17<00:01, 54.69it/s]backtest loop:  92%|█████████▏| 898/971 [00:17<00:01, 55.80it/s]backtest loop:  93%|█████████▎| 904/971 [00:17<00:01, 56.67it/s]backtest loop:  94%|█████████▎| 910/971 [00:17<00:01, 57.38it/s]backtest loop:  94%|█████████▍| 916/971 [00:17<00:01, 54.39it/s]backtest loop:  95%|█████████▍| 922/971 [00:17<00:00, 55.65it/s]backtest loop:  96%|█████████▌| 928/971 [00:18<00:00, 56.61it/s]backtest loop:  96%|█████████▌| 934/971 [00:18<00:00, 57.18it/s]backtest loop:  97%|█████████▋| 940/971 [00:18<00:00, 54.10it/s]backtest loop:  97%|█████████▋| 946/971 [00:18<00:00, 55.28it/s]backtest loop:  98%|█████████▊| 952/971 [00:18<00:00, 56.20it/s]backtest loop:  99%|█████████▊| 958/971 [00:18<00:00, 56.85it/s]backtest loop:  99%|█████████▉| 964/971 [00:18<00:00, 57.35it/s]backtest loop: 100%|█████████▉| 970/971 [00:18<00:00, 54.19it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 51.71it/s]
[2928948:MainThread](2024-04-24 23:38:58,354) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000612
std                0.004817
annualized_return  0.145757
information_ratio  1.961339
max_drawdown      -0.063338
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000418
std                0.004818
annualized_return  0.099479
information_ratio  1.338273
max_drawdown      -0.085173
[2928948:MainThread](2024-04-24 23:38:58,370) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_22:10:42_online`.
Round 9 Done!
{'1day.excess_return_with_cost.annualized_return': [0.045906596817093956,
                                                    0.05947199783795087,
                                                    0.052020827576630645,
                                                    0.06660907356381215,
                                                    0.041062380160693655,
                                                    0.07031148260595382,
                                                    0.08965249269425685,
                                                    0.018427776873876485,
                                                    0.09947911136395558],
 '1day.excess_return_with_cost.information_ratio': [0.5989675803012956,
                                                    0.7992822081517327,
                                                    0.6773909197836762,
                                                    0.858868379402361,
                                                    0.5701050273115824,
                                                    1.0044152558669466,
                                                    1.1047130614499032,
                                                    0.2593370774822796,
                                                    1.338272777501338],
 '1day.excess_return_with_cost.max_drawdown': [-0.12540023303514702,
                                               -0.12026081261057461,
                                               -0.13229595910483233,
                                               -0.10306790444738279,
                                               -0.15649562411434487,
                                               -0.08340678371365234,
                                               -0.12287546361542118,
                                               -0.1196267135266065,
                                               -0.08517341159727754],
 'IC': [0.02891690000013004,
        0.027223277140580798,
        0.02621109579435717,
        0.028330089929604008,
        0.029365079789197276,
        0.026172185682743515,
        0.02924021200620926,
        0.026437084579882433,
        0.03089042233933558],
 'ICIR': [0.26326419201305706,
          0.2457576703726845,
          0.24059646907054116,
          0.25260126906960617,
          0.2675765575196645,
          0.246492573957277,
          0.2701075098113818,
          0.24599690790000178,
          0.2741929711324064],
 'Rank IC': [0.02552035915838527,
             0.019222991218935784,
             0.020849039173561842,
             0.024555272432961062,
             0.023807031887618256,
             0.0200698216143074,
             0.024127009610319244,
             0.02163665414350632,
             0.027167432051046304],
 'Rank ICIR': [0.23664898746209853,
               0.17981857761811082,
               0.19444642706951779,
               0.22629638137184316,
               0.2248322860520228,
               0.19274257572483314,
               0.229834080976146,
               0.2039190061968451,
               0.2472696686663908],
 'mae': [0.6861680746078491,
         0.6861580610275269,
         0.68607097864151,
         0.6861945986747742,
         0.6861079931259155,
         0.686318039894104,
         0.6863036155700684,
         0.6861898899078369,
         0.6860806345939636],
 'mse': [0.9978829622268677,
         0.9977895021438599,
         0.997923731803894,
         0.997870683670044,
         0.9978796243667603,
         0.9980701208114624,
         0.9980088472366333,
         0.9981423616409302,
         0.9976421594619751]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2928948:MainThread](2024-04-24 23:38:59,744) INFO - qlib.GRU - [pytorch_gru.py:64] - GRU pytorch version...
[2928948:MainThread](2024-04-24 23:38:59,744) INFO - qlib.GRU - [pytorch_gru.py:81] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[2928948:MainThread](2024-04-24 23:38:59,746) INFO - qlib.GRU - [pytorch_gru.py:124] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[2928948:MainThread](2024-04-24 23:38:59,746) INFO - qlib.GRU - [pytorch_gru.py:125] - model size: 0.0370 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:11<18:58, 11.50s/it]epoch:   2%|▏         | 2/100 [00:22<18:22, 11.25s/it]epoch:   3%|▎         | 3/100 [00:33<18:05, 11.20s/it]epoch:   4%|▍         | 4/100 [00:44<17:41, 11.06s/it]epoch:   5%|▌         | 5/100 [00:55<17:24, 11.00s/it]epoch:   6%|▌         | 6/100 [01:06<17:20, 11.07s/it]epoch:   7%|▋         | 7/100 [01:17<17:15, 11.13s/it]epoch:   8%|▊         | 8/100 [01:28<17:02, 11.11s/it]epoch:   9%|▉         | 9/100 [01:39<16:45, 11.05s/it]epoch:  10%|█         | 10/100 [01:51<16:40, 11.11s/it]epoch:  11%|█         | 11/100 [02:02<16:34, 11.18s/it]epoch:  12%|█▏        | 12/100 [02:13<16:19, 11.13s/it]epoch:  13%|█▎        | 13/100 [02:24<16:02, 11.06s/it]epoch:  14%|█▍        | 14/100 [02:35<15:55, 11.11s/it]epoch:  15%|█▌        | 15/100 [02:46<15:50, 11.19s/it]epoch:  16%|█▌        | 16/100 [02:58<15:38, 11.17s/it]epoch:  17%|█▋        | 17/100 [03:09<15:23, 11.13s/it]epoch:  18%|█▊        | 18/100 [03:20<15:13, 11.14s/it]epoch:  19%|█▉        | 19/100 [03:31<15:06, 11.20s/it]epoch:  20%|██        | 20/100 [03:42<14:51, 11.15s/it]epoch:  21%|██        | 21/100 [03:53<14:36, 11.09s/it]epoch:  22%|██▏       | 22/100 [04:04<14:24, 11.08s/it]epoch:  23%|██▎       | 23/100 [04:16<14:18, 11.15s/it]epoch:  24%|██▍       | 24/100 [04:27<14:09, 11.17s/it]epoch:  25%|██▌       | 25/100 [04:38<13:54, 11.13s/it]epoch:  26%|██▌       | 26/100 [04:49<13:44, 11.15s/it]epoch:  27%|██▋       | 27/100 [05:00<13:37, 11.19s/it]epoch:  28%|██▊       | 28/100 [05:11<13:23, 11.16s/it]epoch:  29%|██▉       | 29/100 [05:22<13:08, 11.10s/it]epoch:  30%|███       | 30/100 [05:33<12:58, 11.12s/it]0.05272234853464162
best ic: 0.05272234853464162
epoch:  31%|███       | 31/100 [05:46<13:24, 11.66s/it]0.05114868912892606
epoch:  32%|███▏      | 32/100 [05:59<13:29, 11.90s/it]0.051545011283279575
epoch:  33%|███▎      | 33/100 [06:11<13:28, 12.06s/it]0.05707355062301445
best ic: 0.05707355062301445
epoch:  34%|███▍      | 34/100 [06:24<13:28, 12.26s/it]0.0557622585443152
epoch:  35%|███▌      | 35/100 [06:37<13:30, 12.47s/it]0.05424347450266242
epoch:  36%|███▌      | 36/100 [06:49<13:19, 12.49s/it]0.051522177050957345
epoch:  37%|███▋      | 37/100 [07:02<13:07, 12.49s/it]0.05207358468067278
epoch:  38%|███▊      | 38/100 [07:15<13:01, 12.60s/it]0.05421245235919718
epoch:  39%|███▉      | 39/100 [07:28<12:53, 12.69s/it]0.05468367005988353
epoch:  40%|████      | 40/100 [07:40<12:37, 12.62s/it]0.05275859515640486
epoch:  41%|████      | 41/100 [07:53<12:23, 12.60s/it]0.053003026600473506
epoch:  41%|████      | 41/100 [08:06<11:39, 11.86s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2928948:MainThread](2024-04-24 23:47:05,899) INFO - qlib.workflow - [exp.py:258] - Experiment 40 starts running ...
[2928948:MainThread](2024-04-24 23:47:05,912) INFO - qlib.workflow - [recorder.py:341] - Recorder 3fb3f8f4f07b44ecabb87cd0918fb4c8 starts running under Experiment 40 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:05, 10.96it/s]online:   6%|▋         | 4/63 [00:00<00:05, 10.82it/s]online:  10%|▉         | 6/63 [00:00<00:05, 10.83it/s]online:  13%|█▎        | 8/63 [00:00<00:05, 10.78it/s]online:  16%|█▌        | 10/63 [00:00<00:04, 10.81it/s]online:  19%|█▉        | 12/63 [00:01<00:04, 10.81it/s]online:  22%|██▏       | 14/63 [00:01<00:04, 10.76it/s]online:  25%|██▌       | 16/63 [00:01<00:04, 10.78it/s]online:  29%|██▊       | 18/63 [00:01<00:04, 10.77it/s]online:  32%|███▏      | 20/63 [00:01<00:03, 10.79it/s]online:  35%|███▍      | 22/63 [00:02<00:03, 10.81it/s]online:  38%|███▊      | 24/63 [00:02<00:03, 10.75it/s]online:  41%|████▏     | 26/63 [00:02<00:03, 10.79it/s]online:  44%|████▍     | 28/63 [00:02<00:03, 10.79it/s]online:  48%|████▊     | 30/63 [00:02<00:03, 10.78it/s]online:  51%|█████     | 32/63 [00:02<00:02, 10.81it/s]online:  54%|█████▍    | 34/63 [00:03<00:02, 10.77it/s]online:  57%|█████▋    | 36/63 [00:03<00:02, 10.74it/s]online:  60%|██████    | 38/63 [00:03<00:02, 10.84it/s]online:  63%|██████▎   | 40/63 [00:03<00:02, 10.86it/s]online:  67%|██████▋   | 42/63 [00:03<00:01, 10.88it/s]online:  70%|██████▉   | 44/63 [00:04<00:01, 10.85it/s]online:  73%|███████▎  | 46/63 [00:04<00:01, 10.91it/s]online:  76%|███████▌  | 48/63 [00:04<00:01, 10.86it/s]online:  79%|███████▉  | 50/63 [00:04<00:01, 10.91it/s]online:  83%|████████▎ | 52/63 [00:04<00:01, 10.84it/s]online:  86%|████████▌ | 54/63 [00:04<00:00, 10.88it/s]online:  89%|████████▉ | 56/63 [00:05<00:00, 10.85it/s]online:  92%|█████████▏| 58/63 [00:05<00:00, 10.85it/s]online:  95%|█████████▌| 60/63 [00:05<00:00, 10.86it/s]online:  98%|█████████▊| 62/63 [00:05<00:00, 10.81it/s]online: 100%|██████████| 63/63 [00:05<00:00, 10.84it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2928948:MainThread](2024-04-24 23:47:25,873) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9978553 mae 0.68613887
{'IC': 0.028738320006192062,
 'ICIR': 0.2658888418633266,
 'Rank IC': 0.02729439971744578,
 'Rank ICIR': 0.2558111120781947}
[2928948:MainThread](2024-04-24 23:47:27,769) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2928948:MainThread](2024-04-24 23:47:43,586) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 23:47:43,589) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2928948:MainThread](2024-04-24 23:47:49,732) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f976e0d8190>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:47,  9.03it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 23.66it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 33.50it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:25, 37.39it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:22, 42.35it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 45.57it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 45.26it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:19, 47.79it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 49.86it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 48.12it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:18, 49.78it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 51.27it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:17, 52.60it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 53.38it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 50.38it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 51.99it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 52.54it/s]backtest loop:  11%|█         | 105/971 [00:02<00:16, 53.35it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:16, 53.60it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 50.80it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 51.82it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:17, 49.53it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:16, 50.91it/s]backtest loop:  15%|█▍        | 141/971 [00:03<00:16, 48.89it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:16, 50.27it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 51.34it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 52.13it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:15, 52.06it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 51.03it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:14, 54.34it/s]backtest loop:  19%|█▉        | 184/971 [00:03<00:14, 55.79it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:14, 53.51it/s]backtest loop:  20%|██        | 196/971 [00:04<00:14, 55.24it/s]backtest loop:  21%|██        | 202/971 [00:04<00:13, 56.45it/s]backtest loop:  21%|██▏       | 208/971 [00:04<00:13, 57.20it/s]backtest loop:  22%|██▏       | 214/971 [00:04<00:13, 54.50it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:14, 52.45it/s]backtest loop:  23%|██▎       | 226/971 [00:04<00:13, 53.25it/s]backtest loop:  24%|██▍       | 232/971 [00:04<00:13, 54.24it/s]backtest loop:  25%|██▍       | 238/971 [00:04<00:13, 55.62it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 56.70it/s]backtest loop:  26%|██▌       | 250/971 [00:05<00:13, 54.14it/s]backtest loop:  26%|██▋       | 256/971 [00:05<00:12, 55.62it/s]backtest loop:  27%|██▋       | 262/971 [00:05<00:12, 56.69it/s]backtest loop:  28%|██▊       | 268/971 [00:05<00:13, 54.04it/s]backtest loop:  28%|██▊       | 274/971 [00:05<00:12, 55.39it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:12, 56.50it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 53.82it/s]backtest loop:  30%|███       | 292/971 [00:05<00:12, 55.45it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 56.63it/s]backtest loop:  31%|███▏      | 304/971 [00:05<00:11, 57.50it/s]backtest loop:  32%|███▏      | 310/971 [00:06<00:12, 54.44it/s]backtest loop:  33%|███▎      | 316/971 [00:06<00:11, 55.51it/s]backtest loop:  33%|███▎      | 323/971 [00:06<00:11, 57.83it/s]backtest loop:  34%|███▍      | 329/971 [00:06<00:10, 58.39it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:11, 55.34it/s]backtest loop:  35%|███▌      | 341/971 [00:06<00:11, 56.61it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:10, 57.26it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:10, 59.06it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 56.15it/s]backtest loop:  38%|███▊      | 367/971 [00:07<00:11, 54.64it/s]backtest loop:  38%|███▊      | 373/971 [00:07<00:11, 52.71it/s]backtest loop:  39%|███▉      | 379/971 [00:07<00:10, 54.50it/s]backtest loop:  40%|███▉      | 385/971 [00:07<00:10, 55.75it/s]backtest loop:  40%|████      | 391/971 [00:07<00:10, 56.75it/s]backtest loop:  41%|████      | 397/971 [00:07<00:10, 57.26it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 54.48it/s]backtest loop:  42%|████▏     | 409/971 [00:07<00:10, 55.82it/s]backtest loop:  43%|████▎     | 415/971 [00:07<00:09, 56.97it/s]backtest loop:  43%|████▎     | 421/971 [00:08<00:09, 57.40it/s]backtest loop:  44%|████▍     | 428/971 [00:08<00:09, 55.52it/s]backtest loop:  45%|████▍     | 434/971 [00:08<00:09, 56.53it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:09, 56.99it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:09, 57.56it/s]backtest loop:  47%|████▋     | 452/971 [00:08<00:09, 54.69it/s]backtest loop:  47%|████▋     | 458/971 [00:08<00:09, 56.09it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:08, 56.93it/s]backtest loop:  48%|████▊     | 470/971 [00:08<00:08, 57.75it/s]backtest loop:  49%|████▉     | 476/971 [00:09<00:08, 58.39it/s]backtest loop:  50%|████▉     | 482/971 [00:09<00:08, 55.65it/s]backtest loop:  50%|█████     | 488/971 [00:09<00:08, 56.66it/s]backtest loop:  51%|█████     | 494/971 [00:09<00:08, 57.57it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 54.49it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 53.57it/s]backtest loop:  53%|█████▎    | 513/971 [00:09<00:08, 55.10it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:08, 56.33it/s]backtest loop:  54%|█████▍    | 525/971 [00:09<00:07, 56.98it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 53.88it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:07, 55.34it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:07, 56.34it/s]backtest loop:  57%|█████▋    | 550/971 [00:10<00:07, 58.19it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:07, 55.50it/s]backtest loop:  58%|█████▊    | 562/971 [00:10<00:07, 56.66it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:06, 57.57it/s]backtest loop:  59%|█████▉    | 574/971 [00:10<00:06, 58.09it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:06, 55.74it/s]backtest loop:  60%|██████    | 587/971 [00:11<00:06, 56.54it/s]backtest loop:  61%|██████    | 593/971 [00:11<00:06, 57.35it/s]backtest loop:  62%|██████▏   | 599/971 [00:11<00:06, 57.98it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:06, 53.84it/s]backtest loop:  63%|██████▎   | 611/971 [00:11<00:06, 55.35it/s]backtest loop:  64%|██████▎   | 617/971 [00:11<00:06, 56.43it/s]backtest loop:  64%|██████▍   | 623/971 [00:11<00:06, 57.19it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:06, 55.44it/s]backtest loop:  65%|██████▌   | 636/971 [00:11<00:05, 56.18it/s]backtest loop:  66%|██████▌   | 642/971 [00:11<00:05, 56.94it/s]backtest loop:  67%|██████▋   | 648/971 [00:12<00:05, 57.61it/s]backtest loop:  67%|██████▋   | 655/971 [00:12<00:05, 55.62it/s]backtest loop:  68%|██████▊   | 661/971 [00:12<00:05, 56.64it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 57.27it/s]backtest loop:  69%|██████▉   | 673/971 [00:12<00:05, 57.89it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 54.78it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 55.95it/s]backtest loop:  71%|███████   | 691/971 [00:12<00:04, 56.54it/s]backtest loop:  72%|███████▏  | 697/971 [00:12<00:04, 57.31it/s]backtest loop:  73%|███████▎  | 704/971 [00:13<00:04, 55.34it/s]backtest loop:  73%|███████▎  | 711/971 [00:13<00:04, 57.27it/s]backtest loop:  74%|███████▍  | 717/971 [00:13<00:04, 58.00it/s]backtest loop:  74%|███████▍  | 723/971 [00:13<00:04, 58.45it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 55.33it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 53.16it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 54.78it/s]backtest loop:  77%|███████▋  | 747/971 [00:13<00:04, 55.99it/s]backtest loop:  78%|███████▊  | 753/971 [00:13<00:04, 53.58it/s]backtest loop:  78%|███████▊  | 760/971 [00:14<00:03, 53.28it/s]backtest loop:  79%|███████▉  | 766/971 [00:14<00:03, 54.87it/s]backtest loop:  80%|███████▉  | 772/971 [00:14<00:03, 56.25it/s]backtest loop:  80%|████████  | 778/971 [00:14<00:03, 57.17it/s]backtest loop:  81%|████████  | 784/971 [00:14<00:03, 54.56it/s]backtest loop:  81%|████████▏ | 790/971 [00:14<00:03, 55.88it/s]backtest loop:  82%|████████▏ | 796/971 [00:14<00:03, 56.77it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 57.62it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 54.58it/s]backtest loop:  84%|████████▍ | 814/971 [00:15<00:02, 55.94it/s]backtest loop:  84%|████████▍ | 820/971 [00:15<00:02, 56.84it/s]backtest loop:  85%|████████▌ | 826/971 [00:15<00:02, 57.55it/s]backtest loop:  86%|████████▌ | 832/971 [00:15<00:02, 58.06it/s]backtest loop:  86%|████████▋ | 838/971 [00:15<00:02, 54.83it/s]backtest loop:  87%|████████▋ | 844/971 [00:15<00:02, 56.20it/s]backtest loop:  88%|████████▊ | 850/971 [00:15<00:02, 56.93it/s]backtest loop:  88%|████████▊ | 856/971 [00:15<00:02, 57.47it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 54.65it/s]backtest loop:  89%|████████▉ | 868/971 [00:16<00:01, 55.98it/s]backtest loop:  90%|█████████ | 874/971 [00:16<00:01, 56.93it/s]backtest loop:  91%|█████████ | 880/971 [00:16<00:01, 57.60it/s]backtest loop:  91%|█████████ | 886/971 [00:16<00:01, 58.18it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 54.94it/s]backtest loop:  92%|█████████▏| 898/971 [00:16<00:01, 56.35it/s]backtest loop:  93%|█████████▎| 904/971 [00:16<00:01, 56.90it/s]backtest loop:  94%|█████████▎| 910/971 [00:16<00:01, 57.45it/s]backtest loop:  94%|█████████▍| 916/971 [00:16<00:01, 54.53it/s]backtest loop:  95%|█████████▍| 922/971 [00:16<00:00, 55.84it/s]backtest loop:  96%|█████████▌| 928/971 [00:17<00:00, 55.25it/s]backtest loop:  96%|█████████▌| 934/971 [00:17<00:00, 56.46it/s]backtest loop:  97%|█████████▋| 940/971 [00:17<00:00, 53.90it/s]backtest loop:  97%|█████████▋| 946/971 [00:17<00:00, 55.35it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 56.46it/s]backtest loop:  99%|█████████▊| 958/971 [00:17<00:00, 57.24it/s]backtest loop:  99%|█████████▉| 964/971 [00:17<00:00, 57.76it/s]backtest loop: 100%|█████████▉| 970/971 [00:17<00:00, 54.64it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.37it/s]
[2928948:MainThread](2024-04-24 23:48:07,660) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000500
std                0.004779
annualized_return  0.119020
information_ratio  1.614363
max_drawdown      -0.096722
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000307
std                0.004778
annualized_return  0.073039
information_ratio  0.990801
max_drawdown      -0.114903
[2928948:MainThread](2024-04-24 23:48:07,675) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 40
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_22:10:42_online`.
Round 10 Done!
{'1day.excess_return_with_cost.annualized_return': [0.045906596817093956,
                                                    0.05947199783795087,
                                                    0.052020827576630645,
                                                    0.06660907356381215,
                                                    0.041062380160693655,
                                                    0.07031148260595382,
                                                    0.08965249269425685,
                                                    0.018427776873876485,
                                                    0.09947911136395558,
                                                    0.07303908379309895],
 '1day.excess_return_with_cost.information_ratio': [0.5989675803012956,
                                                    0.7992822081517327,
                                                    0.6773909197836762,
                                                    0.858868379402361,
                                                    0.5701050273115824,
                                                    1.0044152558669466,
                                                    1.1047130614499032,
                                                    0.2593370774822796,
                                                    1.338272777501338,
                                                    0.9908013587013507],
 '1day.excess_return_with_cost.max_drawdown': [-0.12540023303514702,
                                               -0.12026081261057461,
                                               -0.13229595910483233,
                                               -0.10306790444738279,
                                               -0.15649562411434487,
                                               -0.08340678371365234,
                                               -0.12287546361542118,
                                               -0.1196267135266065,
                                               -0.08517341159727754,
                                               -0.11490288739898141],
 'IC': [0.02891690000013004,
        0.027223277140580798,
        0.02621109579435717,
        0.028330089929604008,
        0.029365079789197276,
        0.026172185682743515,
        0.02924021200620926,
        0.026437084579882433,
        0.03089042233933558,
        0.028738320006192062],
 'ICIR': [0.26326419201305706,
          0.2457576703726845,
          0.24059646907054116,
          0.25260126906960617,
          0.2675765575196645,
          0.246492573957277,
          0.2701075098113818,
          0.24599690790000178,
          0.2741929711324064,
          0.2658888418633266],
 'Rank IC': [0.02552035915838527,
             0.019222991218935784,
             0.020849039173561842,
             0.024555272432961062,
             0.023807031887618256,
             0.0200698216143074,
             0.024127009610319244,
             0.02163665414350632,
             0.027167432051046304,
             0.02729439971744578],
 'Rank ICIR': [0.23664898746209853,
               0.17981857761811082,
               0.19444642706951779,
               0.22629638137184316,
               0.2248322860520228,
               0.19274257572483314,
               0.229834080976146,
               0.2039190061968451,
               0.2472696686663908,
               0.2558111120781947],
 'mae': [0.6861680746078491,
         0.6861580610275269,
         0.68607097864151,
         0.6861945986747742,
         0.6861079931259155,
         0.686318039894104,
         0.6863036155700684,
         0.6861898899078369,
         0.6860806345939636,
         0.6861388683319092],
 'mse': [0.9978829622268677,
         0.9977895021438599,
         0.997923731803894,
         0.997870683670044,
         0.9978796243667603,
         0.9980701208114624,
         0.9980088472366333,
         0.9981423616409302,
         0.9976421594619751,
         0.9978553056716919]}
[2928948:MainThread](2024-04-24 23:48:09,016) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name csi500_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_22:10:42_final.
[2928948:MainThread](2024-04-24 23:48:09,048) INFO - qlib.workflow - [exp.py:258] - Experiment 43 starts running ...
[2928948:MainThread](2024-04-24 23:48:09,060) INFO - qlib.workflow - [recorder.py:341] - Recorder b5f30a04ed5d4dac8c5dd26ecfd27103 starts running under Experiment 43 ...
Time cost: 518.1576921224594	66.52809388637543
Final results:
{'1day.excess_return_with_cost.annualized_return': [0.0615980823287323,
                                                    0.02254286869897428],
 '1day.excess_return_with_cost.information_ratio': [0.8202153645952466,
                                                    0.29338931377373617],
 '1day.excess_return_with_cost.max_drawdown': [-0.11635057931642205,
                                               0.02062088214654028],
 'IC': [0.028152466726823217, 0.0015035131117684575],
 'ICIR': [0.25724749627099464, 0.011589634938139273],
 'Rank IC': [0.023425001100808723, 0.0027208954103249937],
 'Rank ICIR': [0.21916191032160032, 0.023927050188744442],
 'mae': [0.6861730754375458, 7.964090375440717e-05],
 'mse': [0.9979065299034119, 0.0001348772701862154]}
Your final results can be found in the experiment named `csi500_GRU_alpha360_horizon1_step20_rankFalse_2024-04-24_22:10:42_final`.
All Done!
[2928948:MainThread](2024-04-24 23:48:10,492) INFO - qlib.timer - [log.py:127] - Time cost: 0.024s | waiting `async_log` Done

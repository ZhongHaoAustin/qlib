['main.py', 'run_all', '--forecast_model', 'ALSTM', '-num_head', '8', '--train_start=2008-01-01', '--train_end=2018-12-31', '--valid_start=2019-01-01', '--valid_end=2020-03-31', '--test_start=2020-04-01', '--test_end=2024-03-31', '--tau', '10', '--lr_da', '0.01', '--market', 'csi500', '--data_dir', 'crowd_data', '--rank_label', 'False', '--begin_valid_epoch', '30']
[3004062:MainThread](2024-04-25 01:25:00,415) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[3004062:MainThread](2024-04-25 01:25:00,418) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[3004062:MainThread](2024-04-25 01:25:00,418) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/crowd_data')}
Remove CSRankNorm
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi500', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi500_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
[3004062:MainThread](2024-04-25 01:25:13,459) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi500_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-02 00:00:00'), Timestamp('2008-01-29 00:00:00')), 'test': (Timestamp('2008-01-31 00:00:00'), Timestamp('2008-03-05 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/147 [00:00<?, ?it/s]creating meta tasks:  24%|██▍       | 36/147 [00:00<00:00, 357.42it/s]creating meta tasks:  53%|█████▎    | 78/147 [00:00<00:00, 393.56it/s]creating meta tasks:  82%|████████▏ | 120/147 [00:00<00:00, 405.59it/s]creating meta tasks: 100%|██████████| 147/147 [00:00<00:00, 402.86it/s]
[3004062:MainThread](2024-04-25 01:25:14,211) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi500_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2019-01-02 00:00:00'), Timestamp('2019-01-29 00:00:00')), 'test': (Timestamp('2019-01-31 00:00:00'), Timestamp('2019-03-06 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/63 [00:00<?, ?it/s]creating meta tasks:  68%|██████▊   | 43/63 [00:00<00:00, 425.21it/s]creating meta tasks: 100%|██████████| 63/63 [00:00<00:00, 427.86it/s]
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3004062:MainThread](2024-04-25 01:25:15,241) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3004062:MainThread](2024-04-25 01:25:15,327) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3004062:MainThread](2024-04-25 01:25:15,329) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3004062:MainThread](2024-04-25 01:25:15,330) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:13<22:31, 13.65s/it]epoch:   2%|▏         | 2/100 [00:26<21:46, 13.33s/it]epoch:   3%|▎         | 3/100 [00:39<20:59, 12.98s/it]epoch:   4%|▍         | 4/100 [00:52<20:42, 12.95s/it]epoch:   5%|▌         | 5/100 [01:05<20:25, 12.90s/it]epoch:   6%|▌         | 6/100 [01:17<20:01, 12.79s/it]epoch:   7%|▋         | 7/100 [01:30<19:54, 12.85s/it]epoch:   8%|▊         | 8/100 [01:43<19:43, 12.87s/it]epoch:   9%|▉         | 9/100 [01:56<19:23, 12.79s/it]epoch:  10%|█         | 10/100 [02:08<19:05, 12.73s/it]epoch:  11%|█         | 11/100 [02:21<18:55, 12.76s/it]epoch:  12%|█▏        | 12/100 [02:34<18:46, 12.80s/it]epoch:  13%|█▎        | 13/100 [02:47<18:28, 12.74s/it]epoch:  14%|█▍        | 14/100 [02:59<18:11, 12.70s/it]epoch:  15%|█▌        | 15/100 [03:12<17:56, 12.67s/it]epoch:  16%|█▌        | 16/100 [03:24<17:46, 12.70s/it]epoch:  17%|█▋        | 17/100 [03:37<17:40, 12.77s/it]epoch:  18%|█▊        | 18/100 [03:50<17:23, 12.73s/it]epoch:  19%|█▉        | 19/100 [04:03<17:06, 12.67s/it]epoch:  20%|██        | 20/100 [04:15<16:53, 12.67s/it]epoch:  21%|██        | 21/100 [04:28<16:44, 12.72s/it]epoch:  22%|██▏       | 22/100 [04:41<16:33, 12.73s/it]epoch:  23%|██▎       | 23/100 [04:53<16:16, 12.68s/it]epoch:  24%|██▍       | 24/100 [05:06<16:00, 12.63s/it]epoch:  25%|██▌       | 25/100 [05:19<15:49, 12.66s/it]epoch:  26%|██▌       | 26/100 [05:31<15:40, 12.71s/it]epoch:  27%|██▋       | 27/100 [05:44<15:29, 12.74s/it]epoch:  28%|██▊       | 28/100 [05:57<15:14, 12.70s/it]epoch:  29%|██▉       | 29/100 [06:10<14:59, 12.67s/it]epoch:  30%|███       | 30/100 [06:22<14:48, 12.70s/it]0.051467352389835394
best ic: 0.051467352389835394
epoch:  31%|███       | 31/100 [06:37<15:26, 13.42s/it]0.05174401353646402
best ic: 0.05174401353646402
epoch:  32%|███▏      | 32/100 [06:52<15:35, 13.75s/it]0.05057182284766856
epoch:  33%|███▎      | 33/100 [07:06<15:33, 13.93s/it]0.0549604911933872
best ic: 0.0549604911933872
epoch:  34%|███▍      | 34/100 [07:21<15:27, 14.05s/it]0.05094162395593819
epoch:  35%|███▌      | 35/100 [07:35<15:23, 14.20s/it]0.05118367059044637
epoch:  36%|███▌      | 36/100 [07:50<15:17, 14.34s/it]0.05174470548833969
epoch:  37%|███▋      | 37/100 [08:04<15:02, 14.33s/it]0.05218911912402007
epoch:  38%|███▊      | 38/100 [08:18<14:48, 14.33s/it]0.05027377100391521
epoch:  39%|███▉      | 39/100 [08:33<14:37, 14.39s/it]0.050504241795135296
epoch:  40%|████      | 40/100 [08:48<14:29, 14.48s/it]0.050747444451925666
epoch:  41%|████      | 41/100 [09:02<14:12, 14.44s/it]0.05093976303558775
epoch:  41%|████      | 41/100 [09:16<13:21, 13.58s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3004062:MainThread](2024-04-25 01:34:35,793) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name csi500_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-25_01:25:15_online.
[3004062:MainThread](2024-04-25 01:34:35,829) INFO - qlib.workflow - [exp.py:258] - Experiment 47 starts running ...
[3004062:MainThread](2024-04-25 01:34:36,859) INFO - qlib.workflow - [recorder.py:341] - Recorder 4498c60d877c405386a79269d610fdc3 starts running under Experiment 47 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:06,  9.84it/s]online:   3%|▎         | 2/63 [00:00<00:06,  9.65it/s]online:   5%|▍         | 3/63 [00:00<00:06,  9.15it/s]online:   6%|▋         | 4/63 [00:00<00:06,  9.05it/s]online:   8%|▊         | 5/63 [00:00<00:06,  9.15it/s]online:  10%|▉         | 6/63 [00:00<00:06,  9.07it/s]online:  11%|█         | 7/63 [00:00<00:06,  9.16it/s]online:  13%|█▎        | 8/63 [00:00<00:05,  9.19it/s]online:  14%|█▍        | 9/63 [00:00<00:05,  9.18it/s]online:  16%|█▌        | 10/63 [00:01<00:05,  9.01it/s]online:  17%|█▋        | 11/63 [00:01<00:05,  9.15it/s]online:  19%|█▉        | 12/63 [00:01<00:05,  9.14it/s]online:  21%|██        | 13/63 [00:01<00:05,  9.05it/s]online:  22%|██▏       | 14/63 [00:01<00:05,  9.03it/s]online:  24%|██▍       | 15/63 [00:01<00:05,  9.06it/s]online:  25%|██▌       | 16/63 [00:01<00:05,  8.95it/s]online:  27%|██▋       | 17/63 [00:01<00:05,  9.17it/s]online:  29%|██▊       | 18/63 [00:01<00:04,  9.10it/s]online:  30%|███       | 19/63 [00:02<00:04,  9.08it/s]online:  32%|███▏      | 20/63 [00:02<00:04,  9.12it/s]online:  33%|███▎      | 21/63 [00:02<00:04,  9.04it/s]online:  35%|███▍      | 22/63 [00:02<00:04,  9.03it/s]online:  37%|███▋      | 23/63 [00:02<00:04,  9.12it/s]online:  38%|███▊      | 24/63 [00:02<00:04,  9.07it/s]online:  40%|███▉      | 25/63 [00:02<00:04,  9.14it/s]online:  41%|████▏     | 26/63 [00:02<00:04,  9.24it/s]online:  43%|████▎     | 27/63 [00:02<00:03,  9.16it/s]online:  44%|████▍     | 28/63 [00:03<00:03,  9.22it/s]online:  46%|████▌     | 29/63 [00:03<00:03,  9.10it/s]online:  48%|████▊     | 30/63 [00:03<00:03,  9.07it/s]online:  49%|████▉     | 31/63 [00:03<00:03,  9.11it/s]online:  51%|█████     | 32/63 [00:03<00:03,  9.05it/s]online:  52%|█████▏    | 33/63 [00:03<00:03,  9.03it/s]online:  54%|█████▍    | 34/63 [00:03<00:03,  9.24it/s]online:  56%|█████▌    | 35/63 [00:03<00:03,  9.15it/s]online:  57%|█████▋    | 36/63 [00:03<00:02,  9.13it/s]online:  59%|█████▊    | 37/63 [00:04<00:02,  9.16it/s]online:  60%|██████    | 38/63 [00:04<00:02,  9.07it/s]online:  62%|██████▏   | 39/63 [00:04<00:02,  9.11it/s]online:  63%|██████▎   | 40/63 [00:04<00:02,  9.07it/s]online:  65%|██████▌   | 41/63 [00:04<00:02,  9.14it/s]online:  67%|██████▋   | 42/63 [00:04<00:02,  9.03it/s]online:  68%|██████▊   | 43/63 [00:04<00:02,  9.04it/s]online:  70%|██████▉   | 44/63 [00:04<00:02,  9.09it/s]online:  71%|███████▏  | 45/63 [00:04<00:01,  9.09it/s]online:  73%|███████▎  | 46/63 [00:05<00:01,  9.07it/s]online:  75%|███████▍  | 47/63 [00:05<00:01,  8.96it/s]online:  76%|███████▌  | 48/63 [00:05<00:01,  9.16it/s]online:  78%|███████▊  | 49/63 [00:05<00:01,  9.07it/s]online:  79%|███████▉  | 50/63 [00:05<00:01,  9.09it/s]online:  81%|████████  | 51/63 [00:05<00:01,  9.03it/s]online:  83%|████████▎ | 52/63 [00:05<00:01,  9.02it/s]online:  84%|████████▍ | 53/63 [00:05<00:01,  8.94it/s]online:  86%|████████▌ | 54/63 [00:05<00:01,  8.95it/s]online:  87%|████████▋ | 55/63 [00:06<00:00,  9.02it/s]online:  89%|████████▉ | 56/63 [00:06<00:00,  8.99it/s]online:  90%|█████████ | 57/63 [00:06<00:00,  9.05it/s]online:  92%|█████████▏| 58/63 [00:06<00:00,  8.98it/s]online:  94%|█████████▎| 59/63 [00:06<00:00,  9.01it/s]online:  95%|█████████▌| 60/63 [00:06<00:00,  9.10it/s]online:  97%|█████████▋| 61/63 [00:06<00:00,  9.12it/s]online:  98%|█████████▊| 62/63 [00:06<00:00,  9.03it/s]online: 100%|██████████| 63/63 [00:06<00:00,  9.11it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3004062:MainThread](2024-04-25 01:34:59,432) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9976044 mae 0.6860609
{'IC': 0.027040578141343165,
 'ICIR': 0.22347151688066197,
 'Rank IC': 0.023053889583337525,
 'Rank ICIR': 0.19913024732178053}
[3004062:MainThread](2024-04-25 01:35:01,304) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3004062:MainThread](2024-04-25 01:35:13,631) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 01:35:13,634) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 01:35:20,213) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8a31955970>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 6/971 [00:00<00:17, 55.77it/s]backtest loop:   1%|          | 12/971 [00:00<00:18, 51.37it/s]backtest loop:   2%|▏         | 18/971 [00:00<00:17, 54.63it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:17, 52.96it/s]backtest loop:   3%|▎         | 30/971 [00:00<00:17, 55.22it/s]backtest loop:   4%|▎         | 36/971 [00:00<00:16, 56.75it/s]backtest loop:   4%|▍         | 43/971 [00:00<00:15, 58.80it/s]backtest loop:   5%|▌         | 49/971 [00:00<00:16, 55.73it/s]backtest loop:   6%|▌         | 55/971 [00:00<00:16, 56.73it/s]backtest loop:   6%|▋         | 62/971 [00:01<00:16, 54.87it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:15, 57.87it/s]backtest loop:   8%|▊         | 76/971 [00:01<00:15, 59.57it/s]backtest loop:   8%|▊         | 82/971 [00:01<00:15, 56.30it/s]backtest loop:   9%|▉         | 88/971 [00:01<00:15, 57.19it/s]backtest loop:  10%|▉         | 95/971 [00:01<00:14, 58.79it/s]backtest loop:  11%|█         | 102/971 [00:01<00:15, 56.55it/s]backtest loop:  11%|█         | 108/971 [00:01<00:15, 56.89it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 57.18it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 58.69it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:16, 52.35it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:15, 55.16it/s]backtest loop:  14%|█▍        | 140/971 [00:02<00:14, 56.43it/s]backtest loop:  15%|█▌        | 146/971 [00:02<00:15, 54.16it/s]backtest loop:  16%|█▌        | 152/971 [00:02<00:14, 55.39it/s]backtest loop:  16%|█▋        | 159/971 [00:02<00:14, 57.37it/s]backtest loop:  17%|█▋        | 166/971 [00:02<00:14, 55.49it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:13, 57.29it/s]backtest loop:  19%|█▊        | 180/971 [00:03<00:13, 58.54it/s]backtest loop:  19%|█▉        | 186/971 [00:03<00:14, 56.07it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:13, 56.62it/s]backtest loop:  20%|██        | 199/971 [00:03<00:12, 59.40it/s]backtest loop:  21%|██        | 205/971 [00:03<00:13, 57.49it/s]backtest loop:  22%|██▏       | 212/971 [00:03<00:12, 58.91it/s]backtest loop:  22%|██▏       | 218/971 [00:03<00:13, 56.20it/s]backtest loop:  23%|██▎       | 225/971 [00:03<00:13, 54.96it/s]backtest loop:  24%|██▍       | 232/971 [00:04<00:12, 57.34it/s]backtest loop:  25%|██▍       | 239/971 [00:04<00:12, 59.11it/s]backtest loop:  25%|██▌       | 245/971 [00:04<00:12, 56.32it/s]backtest loop:  26%|██▌       | 252/971 [00:04<00:12, 58.05it/s]backtest loop:  27%|██▋       | 258/971 [00:04<00:12, 58.53it/s]backtest loop:  27%|██▋       | 264/971 [00:04<00:12, 55.43it/s]backtest loop:  28%|██▊       | 271/971 [00:04<00:12, 53.94it/s]backtest loop:  29%|██▊       | 277/971 [00:04<00:12, 55.52it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:12, 56.53it/s]backtest loop:  30%|██▉       | 289/971 [00:05<00:11, 57.31it/s]backtest loop:  30%|███       | 295/971 [00:05<00:12, 54.10it/s]backtest loop:  31%|███       | 301/971 [00:05<00:12, 54.67it/s]backtest loop:  32%|███▏      | 307/971 [00:05<00:11, 56.02it/s]backtest loop:  32%|███▏      | 313/971 [00:05<00:11, 56.97it/s]backtest loop:  33%|███▎      | 320/971 [00:05<00:11, 55.31it/s]backtest loop:  34%|███▎      | 327/971 [00:05<00:11, 57.41it/s]backtest loop:  34%|███▍      | 333/971 [00:05<00:10, 58.05it/s]backtest loop:  35%|███▍      | 339/971 [00:05<00:10, 58.52it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 55.29it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 57.43it/s]backtest loop:  37%|███▋      | 358/971 [00:06<00:10, 58.01it/s]backtest loop:  37%|███▋      | 364/971 [00:06<00:10, 55.76it/s]backtest loop:  38%|███▊      | 370/971 [00:06<00:11, 53.19it/s]backtest loop:  39%|███▉      | 377/971 [00:06<00:10, 55.94it/s]backtest loop:  39%|███▉      | 383/971 [00:06<00:10, 53.98it/s]backtest loop:  40%|████      | 390/971 [00:06<00:10, 56.53it/s]backtest loop:  41%|████      | 396/971 [00:07<00:10, 57.26it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 55.42it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:09, 57.35it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 58.84it/s]backtest loop:  44%|████▎     | 423/971 [00:07<00:09, 55.81it/s]backtest loop:  44%|████▍     | 430/971 [00:07<00:09, 57.88it/s]backtest loop:  45%|████▍     | 436/971 [00:07<00:09, 58.17it/s]backtest loop:  46%|████▌     | 442/971 [00:07<00:09, 55.36it/s]backtest loop:  46%|████▌     | 448/971 [00:07<00:09, 56.38it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:09, 56.97it/s]backtest loop:  47%|████▋     | 460/971 [00:08<00:08, 57.63it/s]backtest loop:  48%|████▊     | 466/971 [00:08<00:08, 57.68it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:09, 54.90it/s]backtest loop:  49%|████▉     | 478/971 [00:08<00:08, 56.23it/s]backtest loop:  50%|████▉     | 485/971 [00:08<00:08, 58.54it/s]backtest loop:  51%|█████     | 491/971 [00:08<00:08, 55.29it/s]backtest loop:  51%|█████▏    | 498/971 [00:08<00:08, 57.46it/s]backtest loop:  52%|█████▏    | 505/971 [00:08<00:08, 55.78it/s]backtest loop:  53%|█████▎    | 512/971 [00:09<00:08, 54.58it/s]backtest loop:  53%|█████▎    | 518/971 [00:09<00:08, 55.98it/s]backtest loop:  54%|█████▍    | 524/971 [00:09<00:07, 57.00it/s]backtest loop:  55%|█████▍    | 530/971 [00:09<00:07, 57.75it/s]backtest loop:  55%|█████▌    | 536/971 [00:09<00:07, 55.36it/s]backtest loop:  56%|█████▌    | 542/971 [00:09<00:07, 56.31it/s]backtest loop:  56%|█████▋    | 548/971 [00:09<00:07, 57.32it/s]backtest loop:  57%|█████▋    | 554/971 [00:09<00:07, 57.74it/s]backtest loop:  58%|█████▊    | 561/971 [00:09<00:07, 55.71it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:06, 57.79it/s]backtest loop:  59%|█████▉    | 574/971 [00:10<00:06, 58.08it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 58.56it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:06, 55.52it/s]backtest loop:  61%|██████    | 592/971 [00:10<00:06, 56.48it/s]backtest loop:  62%|██████▏   | 599/971 [00:10<00:06, 58.22it/s]backtest loop:  62%|██████▏   | 605/971 [00:10<00:06, 55.18it/s]backtest loop:  63%|██████▎   | 611/971 [00:10<00:06, 56.47it/s]backtest loop:  64%|██████▎   | 618/971 [00:10<00:06, 58.26it/s]backtest loop:  64%|██████▍   | 624/971 [00:11<00:05, 58.71it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:06, 55.76it/s]backtest loop:  65%|██████▌   | 636/971 [00:11<00:05, 56.91it/s]backtest loop:  66%|██████▌   | 642/971 [00:11<00:05, 57.67it/s]backtest loop:  67%|██████▋   | 649/971 [00:11<00:05, 59.21it/s]backtest loop:  67%|██████▋   | 655/971 [00:11<00:05, 56.15it/s]backtest loop:  68%|██████▊   | 661/971 [00:11<00:05, 56.52it/s]backtest loop:  69%|██████▊   | 667/971 [00:11<00:05, 57.21it/s]backtest loop:  69%|██████▉   | 673/971 [00:11<00:05, 57.91it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 54.87it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 56.17it/s]backtest loop:  71%|███████   | 691/971 [00:12<00:04, 57.25it/s]backtest loop:  72%|███████▏  | 697/971 [00:12<00:04, 57.82it/s]backtest loop:  73%|███████▎  | 704/971 [00:12<00:04, 55.89it/s]backtest loop:  73%|███████▎  | 710/971 [00:12<00:04, 56.76it/s]backtest loop:  74%|███████▎  | 716/971 [00:12<00:04, 57.59it/s]backtest loop:  74%|███████▍  | 722/971 [00:12<00:04, 58.07it/s]backtest loop:  75%|███████▍  | 728/971 [00:12<00:04, 58.47it/s]backtest loop:  76%|███████▌  | 734/971 [00:12<00:04, 52.40it/s]backtest loop:  76%|███████▌  | 740/971 [00:13<00:04, 54.37it/s]backtest loop:  77%|███████▋  | 746/971 [00:13<00:04, 55.82it/s]backtest loop:  77%|███████▋  | 752/971 [00:13<00:04, 54.02it/s]backtest loop:  78%|███████▊  | 759/971 [00:13<00:03, 56.71it/s]backtest loop:  79%|███████▉  | 765/971 [00:13<00:03, 54.77it/s]backtest loop:  80%|███████▉  | 772/971 [00:13<00:03, 58.05it/s]backtest loop:  80%|████████  | 779/971 [00:13<00:03, 60.28it/s]backtest loop:  81%|████████  | 786/971 [00:13<00:03, 57.33it/s]backtest loop:  82%|████████▏ | 792/971 [00:13<00:03, 58.04it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 55.20it/s]backtest loop:  83%|████████▎ | 804/971 [00:14<00:02, 56.16it/s]backtest loop:  83%|████████▎ | 810/971 [00:14<00:02, 56.96it/s]backtest loop:  84%|████████▍ | 816/971 [00:14<00:02, 57.07it/s]backtest loop:  85%|████████▍ | 822/971 [00:14<00:02, 57.90it/s]backtest loop:  85%|████████▌ | 828/971 [00:14<00:02, 55.00it/s]backtest loop:  86%|████████▌ | 835/971 [00:14<00:02, 57.22it/s]backtest loop:  87%|████████▋ | 841/971 [00:14<00:02, 57.58it/s]backtest loop:  87%|████████▋ | 847/971 [00:14<00:02, 58.21it/s]backtest loop:  88%|████████▊ | 853/971 [00:15<00:02, 55.15it/s]backtest loop:  88%|████████▊ | 859/971 [00:15<00:01, 56.20it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 58.01it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 55.22it/s]backtest loop:  90%|█████████ | 878/971 [00:15<00:01, 56.52it/s]backtest loop:  91%|█████████ | 884/971 [00:15<00:01, 57.40it/s]backtest loop:  92%|█████████▏| 890/971 [00:15<00:01, 57.97it/s]backtest loop:  92%|█████████▏| 897/971 [00:15<00:01, 55.89it/s]backtest loop:  93%|█████████▎| 904/971 [00:15<00:01, 57.66it/s]backtest loop:  94%|█████████▍| 911/971 [00:16<00:01, 58.98it/s]backtest loop:  94%|█████████▍| 917/971 [00:16<00:00, 55.87it/s]backtest loop:  95%|█████████▌| 924/971 [00:16<00:00, 57.63it/s]backtest loop:  96%|█████████▌| 930/971 [00:16<00:00, 58.23it/s]backtest loop:  96%|█████████▋| 936/971 [00:16<00:00, 55.32it/s]backtest loop:  97%|█████████▋| 943/971 [00:16<00:00, 57.69it/s]backtest loop:  98%|█████████▊| 950/971 [00:16<00:00, 55.67it/s]backtest loop:  99%|█████████▊| 957/971 [00:16<00:00, 57.56it/s]backtest loop:  99%|█████████▉| 963/971 [00:16<00:00, 58.17it/s]backtest loop: 100%|█████████▉| 970/971 [00:17<00:00, 56.11it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 56.66it/s]
[3004062:MainThread](2024-04-25 01:35:37,448) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000446
std                0.005076
annualized_return  0.106180
information_ratio  1.355976
max_drawdown      -0.077625
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000253
std                0.005078
annualized_return  0.060160
information_ratio  0.767993
max_drawdown      -0.086703
[3004062:MainThread](2024-04-25 01:35:37,465) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-25_01:25:15_online`.
Round 1 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06015972005648005],
 '1day.excess_return_with_cost.information_ratio': [0.7679933092923739],
 '1day.excess_return_with_cost.max_drawdown': [-0.08670293338962837],
 'IC': [0.027040578141343165],
 'ICIR': [0.22347151688066197],
 'Rank IC': [0.023053889583337525],
 'Rank ICIR': [0.19913024732178053],
 'mae': [0.686060905456543],
 'mse': [0.9976044297218323]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3004062:MainThread](2024-04-25 01:35:38,805) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3004062:MainThread](2024-04-25 01:35:38,805) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3004062:MainThread](2024-04-25 01:35:38,807) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3004062:MainThread](2024-04-25 01:35:38,808) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:13<21:49, 13.22s/it]epoch:   2%|▏         | 2/100 [00:26<21:21, 13.07s/it]epoch:   3%|▎         | 3/100 [00:39<21:11, 13.11s/it]epoch:   4%|▍         | 4/100 [00:52<20:45, 12.97s/it]epoch:   5%|▌         | 5/100 [01:05<20:35, 13.00s/it]epoch:   6%|▌         | 6/100 [01:17<20:10, 12.88s/it]epoch:   7%|▋         | 7/100 [01:30<19:57, 12.87s/it]epoch:   8%|▊         | 8/100 [01:43<19:47, 12.91s/it]epoch:   9%|▉         | 9/100 [01:56<19:25, 12.81s/it]epoch:  10%|█         | 10/100 [02:09<19:17, 12.86s/it]epoch:  11%|█         | 11/100 [02:22<19:08, 12.90s/it]epoch:  12%|█▏        | 12/100 [02:34<18:51, 12.86s/it]epoch:  13%|█▎        | 13/100 [02:47<18:32, 12.79s/it]epoch:  14%|█▍        | 14/100 [03:00<18:15, 12.74s/it]epoch:  15%|█▌        | 15/100 [03:13<18:04, 12.76s/it]epoch:  16%|█▌        | 16/100 [03:25<17:53, 12.78s/it]epoch:  17%|█▋        | 17/100 [03:38<17:37, 12.74s/it]epoch:  18%|█▊        | 18/100 [03:51<17:22, 12.72s/it]epoch:  19%|█▉        | 19/100 [04:04<17:14, 12.77s/it]epoch:  20%|██        | 20/100 [04:17<17:05, 12.82s/it]epoch:  21%|██        | 21/100 [04:29<16:52, 12.82s/it]epoch:  22%|██▏       | 22/100 [04:42<16:35, 12.76s/it]epoch:  23%|██▎       | 23/100 [04:55<16:21, 12.74s/it]epoch:  24%|██▍       | 24/100 [05:08<16:14, 12.82s/it]epoch:  25%|██▌       | 25/100 [05:21<16:03, 12.85s/it]epoch:  26%|██▌       | 26/100 [05:33<15:48, 12.82s/it]epoch:  27%|██▋       | 27/100 [05:46<15:30, 12.75s/it]epoch:  28%|██▊       | 28/100 [05:59<15:18, 12.76s/it]epoch:  29%|██▉       | 29/100 [06:12<15:10, 12.83s/it]epoch:  30%|███       | 30/100 [06:24<14:57, 12.83s/it]0.052973325791263015
best ic: 0.052973325791263015
epoch:  31%|███       | 31/100 [06:39<15:19, 13.32s/it]0.053978033574006865
best ic: 0.053978033574006865
epoch:  32%|███▏      | 32/100 [06:53<15:26, 13.63s/it]0.0543875370668322
best ic: 0.0543875370668322
epoch:  33%|███▎      | 33/100 [07:08<15:35, 13.96s/it]0.05133851929689693
epoch:  34%|███▍      | 34/100 [07:23<15:35, 14.18s/it]0.054896560134608474
best ic: 0.054896560134608474
epoch:  35%|███▌      | 35/100 [07:37<15:22, 14.20s/it]0.056030024141631544
best ic: 0.056030024141631544
epoch:  36%|███▌      | 36/100 [07:51<15:12, 14.25s/it]0.05394198952571398
epoch:  37%|███▋      | 37/100 [08:06<15:04, 14.35s/it]0.05496772534120276
epoch:  38%|███▊      | 38/100 [08:21<15:00, 14.53s/it]0.05714877118874611
best ic: 0.05714877118874611
epoch:  39%|███▉      | 39/100 [08:35<14:43, 14.49s/it]0.049600933817309734
epoch:  40%|████      | 40/100 [08:50<14:27, 14.46s/it]0.055871528309230964
epoch:  41%|████      | 41/100 [09:04<14:13, 14.47s/it]0.055483142557118774
epoch:  42%|████▏     | 42/100 [09:19<14:06, 14.59s/it]0.053551226144237137
epoch:  43%|████▎     | 43/100 [09:34<13:55, 14.66s/it]0.056129081454921445
epoch:  44%|████▍     | 44/100 [09:49<13:54, 14.90s/it]0.05107347904869744
epoch:  45%|████▌     | 45/100 [10:05<13:45, 15.00s/it]0.053349971026503316
epoch:  46%|████▌     | 46/100 [10:20<13:33, 15.07s/it]0.05492271005807014
epoch:  46%|████▌     | 46/100 [10:35<12:25, 13.81s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3004062:MainThread](2024-04-25 01:46:14,134) INFO - qlib.workflow - [exp.py:258] - Experiment 47 starts running ...
[3004062:MainThread](2024-04-25 01:46:14,147) INFO - qlib.workflow - [recorder.py:341] - Recorder 37fdb5ca58154aacb681ca327c894ff0 starts running under Experiment 47 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:06,  9.76it/s]online:   5%|▍         | 3/63 [00:00<00:06,  9.50it/s]online:   6%|▋         | 4/63 [00:00<00:06,  9.59it/s]online:   8%|▊         | 5/63 [00:00<00:06,  9.57it/s]online:  10%|▉         | 6/63 [00:00<00:06,  9.42it/s]online:  11%|█         | 7/63 [00:00<00:05,  9.49it/s]online:  13%|█▎        | 8/63 [00:00<00:05,  9.53it/s]online:  14%|█▍        | 9/63 [00:00<00:05,  9.40it/s]online:  16%|█▌        | 10/63 [00:01<00:05,  9.38it/s]online:  17%|█▋        | 11/63 [00:01<00:05,  9.54it/s]online:  19%|█▉        | 12/63 [00:01<00:05,  9.57it/s]online:  21%|██        | 13/63 [00:01<00:05,  9.47it/s]online:  22%|██▏       | 14/63 [00:01<00:05,  9.60it/s]online:  24%|██▍       | 15/63 [00:01<00:05,  9.49it/s]online:  25%|██▌       | 16/63 [00:01<00:05,  9.40it/s]online:  27%|██▋       | 17/63 [00:01<00:04,  9.41it/s]online:  29%|██▊       | 18/63 [00:01<00:04,  9.51it/s]online:  30%|███       | 19/63 [00:02<00:04,  9.43it/s]online:  32%|███▏      | 20/63 [00:02<00:04,  9.49it/s]online:  33%|███▎      | 21/63 [00:02<00:04,  9.59it/s]online:  35%|███▍      | 22/63 [00:02<00:04,  9.42it/s]online:  37%|███▋      | 23/63 [00:02<00:04,  9.49it/s]online:  38%|███▊      | 24/63 [00:02<00:04,  9.56it/s]online:  40%|███▉      | 25/63 [00:02<00:04,  9.44it/s]online:  41%|████▏     | 26/63 [00:02<00:03,  9.37it/s]online:  43%|████▎     | 27/63 [00:02<00:03,  9.45it/s]online:  44%|████▍     | 28/63 [00:02<00:03,  9.37it/s]online:  46%|████▌     | 29/63 [00:03<00:03,  9.46it/s]online:  48%|████▊     | 30/63 [00:03<00:03,  9.48it/s]online:  49%|████▉     | 31/63 [00:03<00:03,  9.39it/s]online:  51%|█████     | 32/63 [00:03<00:03,  9.31it/s]online:  52%|█████▏    | 33/63 [00:03<00:03,  9.37it/s]online:  54%|█████▍    | 34/63 [00:03<00:03,  9.39it/s]online:  56%|█████▌    | 35/63 [00:03<00:02,  9.42it/s]online:  57%|█████▋    | 36/63 [00:03<00:02,  9.47it/s]online:  59%|█████▊    | 37/63 [00:03<00:02,  9.52it/s]online:  60%|██████    | 38/63 [00:04<00:02,  9.60it/s]online:  62%|██████▏   | 39/63 [00:04<00:02,  9.44it/s]online:  63%|██████▎   | 40/63 [00:04<00:02,  9.48it/s]online:  65%|██████▌   | 41/63 [00:04<00:02,  9.44it/s]online:  67%|██████▋   | 42/63 [00:04<00:02,  9.44it/s]online:  68%|██████▊   | 43/63 [00:04<00:02,  9.42it/s]online:  70%|██████▉   | 44/63 [00:04<00:02,  9.49it/s]online:  71%|███████▏  | 45/63 [00:04<00:01,  9.41it/s]online:  73%|███████▎  | 46/63 [00:04<00:01,  9.36it/s]online:  75%|███████▍  | 47/63 [00:04<00:01,  9.48it/s]online:  76%|███████▌  | 48/63 [00:05<00:01,  9.52it/s]online:  78%|███████▊  | 49/63 [00:05<00:01,  9.42it/s]online:  79%|███████▉  | 50/63 [00:05<00:01,  9.49it/s]online:  81%|████████  | 51/63 [00:05<00:01,  9.38it/s]online:  83%|████████▎ | 52/63 [00:05<00:01,  9.44it/s]online:  84%|████████▍ | 53/63 [00:05<00:01,  9.41it/s]online:  86%|████████▌ | 54/63 [00:05<00:00,  9.47it/s]online:  87%|████████▋ | 55/63 [00:05<00:00,  9.48it/s]online:  89%|████████▉ | 56/63 [00:05<00:00,  9.61it/s]online:  90%|█████████ | 57/63 [00:06<00:00,  9.47it/s]online:  92%|█████████▏| 58/63 [00:06<00:00,  9.39it/s]online:  94%|█████████▎| 59/63 [00:06<00:00,  9.48it/s]online:  95%|█████████▌| 60/63 [00:06<00:00,  9.38it/s]online:  97%|█████████▋| 61/63 [00:06<00:00,  9.36it/s]online:  98%|█████████▊| 62/63 [00:06<00:00,  9.42it/s]online: 100%|██████████| 63/63 [00:06<00:00,  9.48it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3004062:MainThread](2024-04-25 01:46:36,515) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9977509 mae 0.68597734
{'IC': 0.02653395980121937,
 'ICIR': 0.22642606515849942,
 'Rank IC': 0.02273519521648915,
 'Rank ICIR': 0.20377985954373565}
[3004062:MainThread](2024-04-25 01:46:38,393) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3004062:MainThread](2024-04-25 01:46:51,795) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 01:46:51,798) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 01:46:57,823) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8a40557940>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:43,  9.40it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 24.82it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 37.21it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.93it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:19, 47.17it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.73it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.33it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.49it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.77it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 56.31it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.49it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 57.12it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 58.71it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:16, 55.24it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 57.45it/s]backtest loop:  10%|█         | 100/971 [00:02<00:15, 57.26it/s]backtest loop:  11%|█         | 106/971 [00:02<00:15, 57.64it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 55.02it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:14, 57.32it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 54.72it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 53.17it/s]backtest loop:  14%|█▍        | 137/971 [00:02<00:15, 54.94it/s]backtest loop:  15%|█▍        | 144/971 [00:02<00:14, 57.16it/s]backtest loop:  15%|█▌        | 150/971 [00:02<00:14, 57.79it/s]backtest loop:  16%|█▌        | 156/971 [00:03<00:14, 55.08it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:14, 57.16it/s]backtest loop:  17%|█▋        | 169/971 [00:03<00:13, 57.31it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 55.48it/s]backtest loop:  19%|█▊        | 182/971 [00:03<00:13, 56.48it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:13, 58.64it/s]backtest loop:  20%|██        | 195/971 [00:03<00:13, 56.15it/s]backtest loop:  21%|██        | 201/971 [00:03<00:13, 57.17it/s]backtest loop:  21%|██▏       | 208/971 [00:03<00:12, 59.03it/s]backtest loop:  22%|██▏       | 214/971 [00:04<00:13, 55.93it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 54.10it/s]backtest loop:  23%|██▎       | 226/971 [00:04<00:13, 55.65it/s]backtest loop:  24%|██▍       | 232/971 [00:04<00:13, 56.62it/s]backtest loop:  25%|██▍       | 239/971 [00:04<00:12, 58.66it/s]backtest loop:  25%|██▌       | 245/971 [00:04<00:13, 55.76it/s]backtest loop:  26%|██▌       | 251/971 [00:04<00:12, 56.80it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 57.56it/s]backtest loop:  27%|██▋       | 264/971 [00:04<00:12, 55.73it/s]backtest loop:  28%|██▊       | 270/971 [00:05<00:12, 56.56it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:12, 54.23it/s]backtest loop:  29%|██▉       | 282/971 [00:05<00:12, 55.35it/s]backtest loop:  30%|██▉       | 288/971 [00:05<00:12, 56.52it/s]backtest loop:  30%|███       | 294/971 [00:05<00:11, 57.28it/s]backtest loop:  31%|███       | 300/971 [00:05<00:12, 54.81it/s]backtest loop:  32%|███▏      | 306/971 [00:05<00:11, 56.03it/s]backtest loop:  32%|███▏      | 313/971 [00:05<00:11, 58.36it/s]backtest loop:  33%|███▎      | 319/971 [00:05<00:11, 58.77it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:11, 55.59it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:11, 57.89it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 59.36it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 55.83it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 57.69it/s]backtest loop:  37%|███▋      | 359/971 [00:06<00:10, 59.52it/s]backtest loop:  38%|███▊      | 365/971 [00:06<00:10, 57.01it/s]backtest loop:  38%|███▊      | 371/971 [00:06<00:10, 54.59it/s]backtest loop:  39%|███▉      | 377/971 [00:06<00:10, 55.99it/s]backtest loop:  39%|███▉      | 383/971 [00:07<00:10, 53.66it/s]backtest loop:  40%|████      | 389/971 [00:07<00:10, 55.35it/s]backtest loop:  41%|████      | 396/971 [00:07<00:09, 57.65it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 55.66it/s]backtest loop:  42%|████▏     | 409/971 [00:07<00:09, 56.69it/s]backtest loop:  43%|████▎     | 416/971 [00:07<00:09, 58.40it/s]backtest loop:  43%|████▎     | 422/971 [00:07<00:09, 58.72it/s]backtest loop:  44%|████▍     | 428/971 [00:07<00:09, 55.64it/s]backtest loop:  45%|████▍     | 434/971 [00:07<00:09, 56.54it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:09, 57.36it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:09, 57.73it/s]backtest loop:  47%|████▋     | 452/971 [00:08<00:09, 54.78it/s]backtest loop:  47%|████▋     | 458/971 [00:08<00:09, 56.15it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:08, 57.10it/s]backtest loop:  48%|████▊     | 470/971 [00:08<00:08, 57.74it/s]backtest loop:  49%|████▉     | 476/971 [00:08<00:08, 58.34it/s]backtest loop:  50%|████▉     | 482/971 [00:08<00:08, 54.84it/s]backtest loop:  50%|█████     | 488/971 [00:08<00:08, 56.15it/s]backtest loop:  51%|█████     | 494/971 [00:08<00:08, 57.01it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 54.51it/s]backtest loop:  52%|█████▏    | 506/971 [00:09<00:08, 56.02it/s]backtest loop:  53%|█████▎    | 512/971 [00:09<00:08, 53.70it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:08, 55.94it/s]backtest loop:  54%|█████▍    | 525/971 [00:09<00:07, 57.06it/s]backtest loop:  55%|█████▍    | 531/971 [00:09<00:08, 54.43it/s]backtest loop:  55%|█████▌    | 537/971 [00:09<00:07, 55.81it/s]backtest loop:  56%|█████▌    | 543/971 [00:09<00:07, 56.24it/s]backtest loop:  57%|█████▋    | 549/971 [00:09<00:07, 56.96it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 57.78it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 54.88it/s]backtest loop:  58%|█████▊    | 567/971 [00:10<00:07, 56.31it/s]backtest loop:  59%|█████▉    | 574/971 [00:10<00:06, 58.16it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 58.48it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:06, 55.56it/s]backtest loop:  61%|██████    | 592/971 [00:10<00:06, 56.79it/s]backtest loop:  62%|██████▏   | 598/971 [00:10<00:06, 57.11it/s]backtest loop:  62%|██████▏   | 605/971 [00:10<00:06, 55.42it/s]backtest loop:  63%|██████▎   | 611/971 [00:11<00:06, 56.37it/s]backtest loop:  64%|██████▎   | 618/971 [00:11<00:06, 58.17it/s]backtest loop:  64%|██████▍   | 624/971 [00:11<00:05, 58.54it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:06, 55.52it/s]backtest loop:  65%|██████▌   | 636/971 [00:11<00:05, 56.66it/s]backtest loop:  66%|██████▌   | 642/971 [00:11<00:05, 57.24it/s]backtest loop:  67%|██████▋   | 648/971 [00:11<00:05, 57.92it/s]backtest loop:  67%|██████▋   | 654/971 [00:11<00:05, 58.38it/s]backtest loop:  68%|██████▊   | 660/971 [00:11<00:05, 55.38it/s]backtest loop:  69%|██████▊   | 666/971 [00:12<00:05, 56.56it/s]backtest loop:  69%|██████▉   | 672/971 [00:12<00:05, 57.28it/s]backtest loop:  70%|██████▉   | 678/971 [00:12<00:05, 58.02it/s]backtest loop:  70%|███████   | 684/971 [00:12<00:05, 54.72it/s]backtest loop:  71%|███████   | 690/971 [00:12<00:05, 56.02it/s]backtest loop:  72%|███████▏  | 696/971 [00:12<00:04, 56.96it/s]backtest loop:  72%|███████▏  | 703/971 [00:12<00:04, 58.57it/s]backtest loop:  73%|███████▎  | 709/971 [00:12<00:04, 55.32it/s]backtest loop:  74%|███████▎  | 715/971 [00:12<00:04, 56.11it/s]backtest loop:  74%|███████▍  | 721/971 [00:13<00:04, 57.06it/s]backtest loop:  75%|███████▍  | 727/971 [00:13<00:04, 57.41it/s]backtest loop:  75%|███████▌  | 733/971 [00:13<00:04, 51.80it/s]backtest loop:  76%|███████▌  | 739/971 [00:13<00:04, 53.82it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:04, 55.06it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 53.30it/s]backtest loop:  78%|███████▊  | 757/971 [00:13<00:03, 55.13it/s]backtest loop:  79%|███████▊  | 763/971 [00:13<00:03, 56.19it/s]backtest loop:  79%|███████▉  | 770/971 [00:13<00:03, 54.90it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 56.97it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 54.08it/s]backtest loop:  81%|████████▏ | 789/971 [00:14<00:03, 55.22it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 56.00it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 57.88it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 55.10it/s]backtest loop:  84%|████████▍ | 814/971 [00:14<00:02, 56.28it/s]backtest loop:  85%|████████▍ | 821/971 [00:14<00:02, 58.04it/s]backtest loop:  85%|████████▌ | 827/971 [00:14<00:02, 58.56it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 55.23it/s]backtest loop:  86%|████████▋ | 839/971 [00:15<00:02, 56.47it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 57.43it/s]backtest loop:  88%|████████▊ | 851/971 [00:15<00:02, 57.92it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 54.98it/s]backtest loop:  89%|████████▉ | 864/971 [00:15<00:01, 57.34it/s]backtest loop:  90%|████████▉ | 870/971 [00:15<00:01, 57.75it/s]backtest loop:  90%|█████████ | 877/971 [00:15<00:01, 55.76it/s]backtest loop:  91%|█████████ | 883/971 [00:15<00:01, 56.77it/s]backtest loop:  92%|█████████▏| 889/971 [00:15<00:01, 57.44it/s]backtest loop:  92%|█████████▏| 895/971 [00:16<00:01, 57.99it/s]backtest loop:  93%|█████████▎| 901/971 [00:16<00:01, 58.29it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 55.02it/s]backtest loop:  94%|█████████▍| 913/971 [00:16<00:01, 56.02it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 56.83it/s]backtest loop:  95%|█████████▌| 925/971 [00:16<00:00, 57.59it/s]backtest loop:  96%|█████████▌| 931/971 [00:16<00:00, 54.61it/s]backtest loop:  96%|█████████▋| 937/971 [00:16<00:00, 55.90it/s]backtest loop:  97%|█████████▋| 944/971 [00:16<00:00, 58.46it/s]backtest loop:  98%|█████████▊| 950/971 [00:17<00:00, 55.28it/s]backtest loop:  98%|█████████▊| 956/971 [00:17<00:00, 56.37it/s]backtest loop:  99%|█████████▉| 962/971 [00:17<00:00, 57.26it/s]backtest loop: 100%|█████████▉| 968/971 [00:17<00:00, 57.95it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.64it/s]
[3004062:MainThread](2024-04-25 01:47:15,347) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000330
std                0.005129
annualized_return  0.078637
information_ratio  0.993886
max_drawdown      -0.134470
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000138
std                0.005133
annualized_return  0.032731
information_ratio  0.413339
max_drawdown      -0.161973
[3004062:MainThread](2024-04-25 01:47:15,362) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-25_01:25:15_online`.
Round 2 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06015972005648005,
                                                    0.03273059938414068],
 '1day.excess_return_with_cost.information_ratio': [0.7679933092923739,
                                                    0.4133389026554145],
 '1day.excess_return_with_cost.max_drawdown': [-0.08670293338962837,
                                               -0.16197255475157407],
 'IC': [0.027040578141343165, 0.02653395980121937],
 'ICIR': [0.22347151688066197, 0.22642606515849942],
 'Rank IC': [0.023053889583337525, 0.02273519521648915],
 'Rank ICIR': [0.19913024732178053, 0.20377985954373565],
 'mae': [0.686060905456543, 0.6859773397445679],
 'mse': [0.9976044297218323, 0.9977508783340454]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3004062:MainThread](2024-04-25 01:47:16,716) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3004062:MainThread](2024-04-25 01:47:16,716) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3004062:MainThread](2024-04-25 01:47:16,719) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3004062:MainThread](2024-04-25 01:47:16,719) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:13<21:51, 13.25s/it]epoch:   2%|▏         | 2/100 [00:26<21:33, 13.20s/it]epoch:   3%|▎         | 3/100 [00:39<21:14, 13.14s/it]epoch:   4%|▍         | 4/100 [00:52<20:51, 13.03s/it]epoch:   5%|▌         | 5/100 [01:05<20:42, 13.07s/it]epoch:   6%|▌         | 6/100 [01:18<20:18, 12.96s/it]epoch:   7%|▋         | 7/100 [01:31<20:11, 13.02s/it]epoch:   8%|▊         | 8/100 [01:44<19:51, 12.95s/it]epoch:   9%|▉         | 9/100 [01:57<19:36, 12.93s/it]epoch:  10%|█         | 10/100 [02:10<19:26, 12.96s/it]epoch:  11%|█         | 11/100 [02:22<19:05, 12.87s/it]epoch:  12%|█▏        | 12/100 [02:35<18:56, 12.92s/it]epoch:  13%|█▎        | 13/100 [02:48<18:45, 12.93s/it]epoch:  14%|█▍        | 14/100 [03:01<18:25, 12.86s/it]epoch:  15%|█▌        | 15/100 [03:14<18:21, 12.96s/it]epoch:  16%|█▌        | 16/100 [03:27<18:11, 12.99s/it]epoch:  17%|█▋        | 17/100 [03:40<17:55, 12.96s/it]epoch:  18%|█▊        | 18/100 [03:53<17:34, 12.86s/it]epoch:  19%|█▉        | 19/100 [04:05<17:17, 12.81s/it]epoch:  20%|██        | 20/100 [04:18<17:08, 12.85s/it]epoch:  21%|██        | 21/100 [04:31<16:57, 12.88s/it]epoch:  22%|██▏       | 22/100 [04:44<16:40, 12.82s/it]epoch:  23%|██▎       | 23/100 [04:57<16:23, 12.77s/it]epoch:  24%|██▍       | 24/100 [05:09<16:10, 12.77s/it]epoch:  25%|██▌       | 25/100 [05:22<16:02, 12.84s/it]epoch:  26%|██▌       | 26/100 [05:35<15:48, 12.82s/it]epoch:  27%|██▋       | 27/100 [05:48<15:30, 12.75s/it]epoch:  28%|██▊       | 28/100 [06:00<15:16, 12.73s/it]epoch:  29%|██▉       | 29/100 [06:13<15:08, 12.79s/it]epoch:  30%|███       | 30/100 [06:26<14:59, 12.85s/it]0.05205302849855894
best ic: 0.05205302849855894
epoch:  31%|███       | 31/100 [06:41<15:22, 13.37s/it]0.0520904807961791
best ic: 0.0520904807961791
epoch:  32%|███▏      | 32/100 [06:55<15:29, 13.67s/it]0.05420730935165101
best ic: 0.05420730935165101
epoch:  33%|███▎      | 33/100 [07:10<15:31, 13.90s/it]0.05458769547380501
best ic: 0.05458769547380501
epoch:  34%|███▍      | 34/100 [07:25<15:34, 14.16s/it]0.051472010566595096
epoch:  35%|███▌      | 35/100 [07:39<15:34, 14.38s/it]0.050144140504305164
epoch:  36%|███▌      | 36/100 [07:55<15:49, 14.83s/it]0.05152152533407278
epoch:  37%|███▋      | 37/100 [08:12<16:12, 15.43s/it]0.05215376577226299
epoch:  38%|███▊      | 38/100 [08:28<15:58, 15.45s/it]0.04837633167462728
epoch:  39%|███▉      | 39/100 [08:43<15:37, 15.36s/it]0.0551533574293959
best ic: 0.0551533574293959
epoch:  40%|████      | 40/100 [08:58<15:15, 15.26s/it]0.05069587413125209
epoch:  41%|████      | 41/100 [09:13<14:56, 15.19s/it]0.05129763883182383
epoch:  42%|████▏     | 42/100 [09:28<14:37, 15.13s/it]0.050826686183541636
epoch:  43%|████▎     | 43/100 [09:43<14:17, 15.05s/it]0.050914408206119234
epoch:  44%|████▍     | 44/100 [09:57<13:56, 14.93s/it]0.050541525816315575
epoch:  45%|████▌     | 45/100 [10:12<13:41, 14.94s/it]0.05100694201282399
epoch:  46%|████▌     | 46/100 [10:27<13:15, 14.74s/it]0.04811076308389705
epoch:  47%|████▋     | 47/100 [10:42<13:04, 14.80s/it]0.0506222214930767
epoch:  47%|████▋     | 47/100 [10:56<12:19, 13.96s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3004062:MainThread](2024-04-25 01:58:12,890) INFO - qlib.workflow - [exp.py:258] - Experiment 47 starts running ...
[3004062:MainThread](2024-04-25 01:58:12,903) INFO - qlib.workflow - [recorder.py:341] - Recorder b59bc24a59884102a640736ca8f739b2 starts running under Experiment 47 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:07,  8.85it/s]online:   3%|▎         | 2/63 [00:00<00:07,  8.69it/s]online:   5%|▍         | 3/63 [00:00<00:06,  8.59it/s]online:   6%|▋         | 4/63 [00:00<00:06,  8.67it/s]online:   8%|▊         | 5/63 [00:00<00:06,  8.57it/s]online:  10%|▉         | 6/63 [00:00<00:06,  8.57it/s]online:  11%|█         | 7/63 [00:00<00:06,  8.53it/s]online:  13%|█▎        | 8/63 [00:00<00:06,  8.62it/s]online:  14%|█▍        | 9/63 [00:01<00:06,  8.61it/s]online:  16%|█▌        | 10/63 [00:01<00:06,  8.53it/s]online:  17%|█▋        | 11/63 [00:01<00:06,  8.55it/s]online:  19%|█▉        | 12/63 [00:01<00:05,  8.57it/s]online:  21%|██        | 13/63 [00:01<00:05,  8.49it/s]online:  22%|██▏       | 14/63 [00:01<00:05,  8.53it/s]online:  24%|██▍       | 15/63 [00:01<00:05,  8.47it/s]online:  25%|██▌       | 16/63 [00:01<00:05,  8.51it/s]online:  27%|██▋       | 17/63 [00:01<00:05,  8.47it/s]online:  29%|██▊       | 18/63 [00:02<00:05,  8.58it/s]online:  30%|███       | 19/63 [00:02<00:05,  8.58it/s]online:  32%|███▏      | 20/63 [00:02<00:04,  8.73it/s]online:  33%|███▎      | 21/63 [00:02<00:04,  8.65it/s]online:  35%|███▍      | 22/63 [00:02<00:04,  8.69it/s]online:  37%|███▋      | 23/63 [00:02<00:04,  8.67it/s]online:  38%|███▊      | 24/63 [00:02<00:04,  8.57it/s]online:  40%|███▉      | 25/63 [00:02<00:04,  8.53it/s]online:  41%|████▏     | 26/63 [00:03<00:04,  8.50it/s]online:  43%|████▎     | 27/63 [00:03<00:04,  8.52it/s]online:  44%|████▍     | 28/63 [00:03<00:04,  8.48it/s]online:  46%|████▌     | 29/63 [00:03<00:04,  8.47it/s]online:  48%|████▊     | 30/63 [00:03<00:03,  8.58it/s]online:  49%|████▉     | 31/63 [00:03<00:03,  8.60it/s]online:  51%|█████     | 32/63 [00:03<00:03,  8.59it/s]online:  52%|█████▏    | 33/63 [00:03<00:03,  8.51it/s]online:  54%|█████▍    | 34/63 [00:03<00:03,  8.47it/s]online:  56%|█████▌    | 35/63 [00:04<00:03,  8.59it/s]online:  57%|█████▋    | 36/63 [00:04<00:03,  8.57it/s]online:  59%|█████▊    | 37/63 [00:04<00:03,  8.38it/s]online:  60%|██████    | 38/63 [00:04<00:02,  8.50it/s]online:  62%|██████▏   | 39/63 [00:04<00:02,  8.51it/s]online:  63%|██████▎   | 40/63 [00:04<00:02,  8.48it/s]online:  65%|██████▌   | 41/63 [00:04<00:02,  8.46it/s]online:  67%|██████▋   | 42/63 [00:04<00:02,  8.56it/s]online:  68%|██████▊   | 43/63 [00:05<00:02,  8.51it/s]online:  70%|██████▉   | 44/63 [00:05<00:02,  8.53it/s]online:  71%|███████▏  | 45/63 [00:05<00:02,  8.57it/s]online:  73%|███████▎  | 46/63 [00:05<00:02,  8.42it/s]online:  75%|███████▍  | 47/63 [00:05<00:01,  8.59it/s]online:  76%|███████▌  | 48/63 [00:05<00:01,  8.58it/s]online:  78%|███████▊  | 49/63 [00:05<00:01,  8.49it/s]online:  79%|███████▉  | 50/63 [00:05<00:01,  8.47it/s]online:  81%|████████  | 51/63 [00:05<00:01,  8.42it/s]online:  83%|████████▎ | 52/63 [00:06<00:01,  8.47it/s]online:  84%|████████▍ | 53/63 [00:06<00:01,  8.44it/s]online:  86%|████████▌ | 54/63 [00:06<00:01,  8.48it/s]online:  87%|████████▋ | 55/63 [00:06<00:00,  8.50it/s]online:  89%|████████▉ | 56/63 [00:06<00:00,  8.49it/s]online:  90%|█████████ | 57/63 [00:06<00:00,  8.42it/s]online:  92%|█████████▏| 58/63 [00:06<00:00,  8.47it/s]online:  94%|█████████▎| 59/63 [00:06<00:00,  8.38it/s]online:  95%|█████████▌| 60/63 [00:07<00:00,  8.52it/s]online:  97%|█████████▋| 61/63 [00:07<00:00,  8.47it/s]online:  98%|█████████▊| 62/63 [00:07<00:00,  8.47it/s]online: 100%|██████████| 63/63 [00:07<00:00,  8.82it/s]online: 100%|██████████| 63/63 [00:07<00:00,  8.54it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3004062:MainThread](2024-04-25 01:58:31,541) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9977037 mae 0.6860174
{'IC': 0.026817808553124933,
 'ICIR': 0.24265733154989236,
 'Rank IC': 0.022998778503316525,
 'Rank ICIR': 0.21844485445366277}
[3004062:MainThread](2024-04-25 01:58:33,441) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3004062:MainThread](2024-04-25 01:58:50,287) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 01:58:50,290) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 01:58:56,692) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8a47b71850>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<03:14,  4.96it/s]backtest loop:   1%|          | 9/971 [00:00<01:03, 15.25it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:39, 24.34it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:31, 30.45it/s]backtest loop:   3%|▎         | 27/971 [00:01<00:25, 36.62it/s]backtest loop:   3%|▎         | 33/971 [00:01<00:22, 41.54it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:21, 42.88it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:19, 46.48it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 48.77it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:19, 47.93it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:18, 50.23it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 51.81it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 53.34it/s]backtest loop:   8%|▊         | 81/971 [00:02<00:16, 54.52it/s]backtest loop:   9%|▉         | 87/971 [00:02<00:17, 51.27it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 52.28it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 52.48it/s]backtest loop:  11%|█         | 105/971 [00:02<00:16, 53.22it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:16, 53.63it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:17, 50.06it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 52.54it/s]backtest loop:  13%|█▎        | 129/971 [00:03<00:16, 50.67it/s]backtest loop:  14%|█▍        | 135/971 [00:03<00:15, 52.86it/s]backtest loop:  15%|█▍        | 141/971 [00:03<00:17, 47.43it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:16, 49.27it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 51.84it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 53.62it/s]backtest loop:  17%|█▋        | 166/971 [00:03<00:15, 52.82it/s]backtest loop:  18%|█▊        | 172/971 [00:03<00:14, 54.43it/s]backtest loop:  18%|█▊        | 179/971 [00:03<00:13, 56.65it/s]backtest loop:  19%|█▉        | 185/971 [00:04<00:14, 53.28it/s]backtest loop:  20%|█▉        | 191/971 [00:04<00:14, 54.55it/s]backtest loop:  20%|██        | 197/971 [00:04<00:13, 55.85it/s]backtest loop:  21%|██        | 203/971 [00:04<00:13, 56.03it/s]backtest loop:  22%|██▏       | 209/971 [00:04<00:13, 56.52it/s]backtest loop:  22%|██▏       | 215/971 [00:04<00:15, 50.26it/s]backtest loop:  23%|██▎       | 221/971 [00:04<00:14, 52.17it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:13, 53.55it/s]backtest loop:  24%|██▍       | 233/971 [00:04<00:13, 54.41it/s]backtest loop:  25%|██▍       | 239/971 [00:05<00:13, 55.31it/s]backtest loop:  25%|██▌       | 245/971 [00:05<00:13, 52.77it/s]backtest loop:  26%|██▌       | 251/971 [00:05<00:13, 53.82it/s]backtest loop:  26%|██▋       | 257/971 [00:05<00:13, 54.65it/s]backtest loop:  27%|██▋       | 263/971 [00:05<00:12, 55.47it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:13, 53.03it/s]backtest loop:  28%|██▊       | 275/971 [00:05<00:12, 54.37it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:13, 52.13it/s]backtest loop:  30%|██▉       | 287/971 [00:05<00:12, 53.50it/s]backtest loop:  30%|███       | 293/971 [00:06<00:12, 54.39it/s]backtest loop:  31%|███       | 299/971 [00:06<00:12, 55.38it/s]backtest loop:  31%|███▏      | 305/971 [00:06<00:12, 52.59it/s]backtest loop:  32%|███▏      | 311/971 [00:06<00:12, 54.22it/s]backtest loop:  33%|███▎      | 317/971 [00:06<00:11, 54.56it/s]backtest loop:  33%|███▎      | 323/971 [00:06<00:11, 55.66it/s]backtest loop:  34%|███▍      | 329/971 [00:06<00:11, 56.09it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:11, 53.05it/s]backtest loop:  35%|███▌      | 341/971 [00:06<00:11, 54.68it/s]backtest loop:  36%|███▌      | 347/971 [00:07<00:11, 55.23it/s]backtest loop:  36%|███▋      | 353/971 [00:07<00:11, 55.97it/s]backtest loop:  37%|███▋      | 359/971 [00:07<00:10, 56.50it/s]backtest loop:  38%|███▊      | 365/971 [00:07<00:11, 53.72it/s]backtest loop:  38%|███▊      | 371/971 [00:07<00:11, 51.72it/s]backtest loop:  39%|███▉      | 377/971 [00:07<00:11, 53.65it/s]backtest loop:  39%|███▉      | 383/971 [00:07<00:11, 51.61it/s]backtest loop:  40%|████      | 389/971 [00:07<00:10, 53.09it/s]backtest loop:  41%|████      | 395/971 [00:07<00:10, 54.38it/s]backtest loop:  41%|████▏     | 401/971 [00:08<00:10, 54.99it/s]backtest loop:  42%|████▏     | 407/971 [00:08<00:10, 55.71it/s]backtest loop:  43%|████▎     | 413/971 [00:08<00:10, 52.90it/s]backtest loop:  43%|████▎     | 419/971 [00:08<00:10, 53.91it/s]backtest loop:  44%|████▍     | 425/971 [00:08<00:09, 54.78it/s]backtest loop:  44%|████▍     | 431/971 [00:08<00:09, 55.37it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:10, 52.38it/s]backtest loop:  46%|████▌     | 443/971 [00:08<00:09, 53.44it/s]backtest loop:  46%|████▌     | 449/971 [00:08<00:09, 54.51it/s]backtest loop:  47%|████▋     | 455/971 [00:09<00:09, 55.22it/s]backtest loop:  47%|████▋     | 461/971 [00:09<00:09, 55.61it/s]backtest loop:  48%|████▊     | 467/971 [00:09<00:09, 53.21it/s]backtest loop:  49%|████▉     | 474/971 [00:09<00:08, 55.90it/s]backtest loop:  49%|████▉     | 480/971 [00:09<00:08, 56.82it/s]backtest loop:  50%|█████     | 486/971 [00:09<00:08, 56.90it/s]backtest loop:  51%|█████     | 492/971 [00:09<00:08, 53.50it/s]backtest loop:  51%|█████▏    | 498/971 [00:09<00:08, 54.47it/s]backtest loop:  52%|█████▏    | 505/971 [00:09<00:08, 53.52it/s]backtest loop:  53%|█████▎    | 511/971 [00:10<00:08, 54.97it/s]backtest loop:  53%|█████▎    | 517/971 [00:10<00:08, 52.66it/s]backtest loop:  54%|█████▍    | 523/971 [00:10<00:08, 54.40it/s]backtest loop:  54%|█████▍    | 529/971 [00:10<00:07, 55.41it/s]backtest loop:  55%|█████▌    | 535/971 [00:10<00:07, 56.19it/s]backtest loop:  56%|█████▌    | 541/971 [00:10<00:08, 53.55it/s]backtest loop:  56%|█████▋    | 547/971 [00:10<00:07, 54.80it/s]backtest loop:  57%|█████▋    | 553/971 [00:10<00:07, 55.89it/s]backtest loop:  58%|█████▊    | 559/971 [00:10<00:07, 56.77it/s]backtest loop:  58%|█████▊    | 565/971 [00:11<00:07, 57.32it/s]backtest loop:  59%|█████▉    | 571/971 [00:11<00:07, 54.22it/s]backtest loop:  59%|█████▉    | 577/971 [00:11<00:07, 55.19it/s]backtest loop:  60%|██████    | 583/971 [00:11<00:06, 56.16it/s]backtest loop:  61%|██████    | 589/971 [00:11<00:06, 55.72it/s]backtest loop:  61%|██████▏   | 596/971 [00:11<00:07, 53.26it/s]backtest loop:  62%|██████▏   | 602/971 [00:11<00:06, 54.64it/s]backtest loop:  63%|██████▎   | 608/971 [00:11<00:06, 55.91it/s]backtest loop:  63%|██████▎   | 614/971 [00:11<00:06, 56.49it/s]backtest loop:  64%|██████▍   | 620/971 [00:12<00:06, 53.57it/s]backtest loop:  64%|██████▍   | 626/971 [00:12<00:06, 54.92it/s]backtest loop:  65%|██████▌   | 632/971 [00:12<00:06, 56.09it/s]backtest loop:  66%|██████▌   | 638/971 [00:12<00:05, 56.26it/s]backtest loop:  66%|██████▋   | 644/971 [00:12<00:05, 57.22it/s]backtest loop:  67%|██████▋   | 650/971 [00:12<00:05, 54.60it/s]backtest loop:  68%|██████▊   | 657/971 [00:12<00:05, 56.73it/s]backtest loop:  68%|██████▊   | 663/971 [00:12<00:05, 57.30it/s]backtest loop:  69%|██████▉   | 669/971 [00:12<00:05, 57.49it/s]backtest loop:  70%|██████▉   | 675/971 [00:13<00:05, 54.25it/s]backtest loop:  70%|███████   | 681/971 [00:13<00:05, 55.77it/s]backtest loop:  71%|███████   | 687/971 [00:13<00:05, 53.99it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:05, 54.17it/s]backtest loop:  72%|███████▏  | 699/971 [00:13<00:05, 51.19it/s]backtest loop:  73%|███████▎  | 705/971 [00:13<00:05, 51.93it/s]backtest loop:  73%|███████▎  | 711/971 [00:13<00:04, 52.35it/s]backtest loop:  74%|███████▍  | 717/971 [00:13<00:04, 51.62it/s]backtest loop:  74%|███████▍  | 723/971 [00:13<00:04, 51.11it/s]backtest loop:  75%|███████▌  | 729/971 [00:14<00:05, 47.72it/s]backtest loop:  76%|███████▌  | 734/971 [00:14<00:05, 45.73it/s]backtest loop:  76%|███████▌  | 740/971 [00:14<00:04, 47.89it/s]backtest loop:  77%|███████▋  | 745/971 [00:14<00:04, 47.80it/s]backtest loop:  77%|███████▋  | 750/971 [00:14<00:04, 44.90it/s]backtest loop:  78%|███████▊  | 755/971 [00:14<00:04, 45.87it/s]backtest loop:  78%|███████▊  | 760/971 [00:14<00:04, 46.51it/s]backtest loop:  79%|███████▉  | 765/971 [00:14<00:04, 46.67it/s]backtest loop:  79%|███████▉  | 770/971 [00:14<00:04, 47.01it/s]backtest loop:  80%|███████▉  | 776/971 [00:15<00:03, 49.17it/s]backtest loop:  81%|████████  | 782/971 [00:15<00:03, 51.83it/s]backtest loop:  81%|████████  | 788/971 [00:15<00:03, 49.76it/s]backtest loop:  82%|████████▏ | 794/971 [00:15<00:03, 52.18it/s]backtest loop:  82%|████████▏ | 800/971 [00:15<00:03, 53.98it/s]backtest loop:  83%|████████▎ | 806/971 [00:15<00:03, 53.88it/s]backtest loop:  84%|████████▎ | 812/971 [00:15<00:02, 55.14it/s]backtest loop:  84%|████████▍ | 818/971 [00:15<00:02, 52.77it/s]backtest loop:  85%|████████▍ | 824/971 [00:15<00:02, 53.52it/s]backtest loop:  85%|████████▌ | 830/971 [00:16<00:02, 55.25it/s]backtest loop:  86%|████████▌ | 836/971 [00:16<00:02, 56.45it/s]backtest loop:  87%|████████▋ | 842/971 [00:16<00:02, 57.38it/s]backtest loop:  87%|████████▋ | 848/971 [00:16<00:02, 54.19it/s]backtest loop:  88%|████████▊ | 854/971 [00:16<00:02, 55.27it/s]backtest loop:  89%|████████▊ | 860/971 [00:16<00:01, 56.14it/s]backtest loop:  89%|████████▉ | 866/971 [00:16<00:01, 57.10it/s]backtest loop:  90%|████████▉ | 872/971 [00:16<00:01, 54.16it/s]backtest loop:  90%|█████████ | 878/971 [00:16<00:01, 55.51it/s]backtest loop:  91%|█████████ | 884/971 [00:17<00:01, 56.18it/s]backtest loop:  92%|█████████▏| 890/971 [00:17<00:01, 55.84it/s]backtest loop:  92%|█████████▏| 896/971 [00:17<00:01, 55.71it/s]backtest loop:  93%|█████████▎| 902/971 [00:17<00:01, 52.63it/s]backtest loop:  94%|█████████▎| 908/971 [00:17<00:01, 54.31it/s]backtest loop:  94%|█████████▍| 914/971 [00:17<00:01, 55.45it/s]backtest loop:  95%|█████████▍| 920/971 [00:17<00:00, 56.29it/s]backtest loop:  95%|█████████▌| 926/971 [00:17<00:00, 53.63it/s]backtest loop:  96%|█████████▌| 932/971 [00:17<00:00, 55.18it/s]backtest loop:  97%|█████████▋| 938/971 [00:18<00:00, 56.33it/s]backtest loop:  97%|█████████▋| 944/971 [00:18<00:00, 56.92it/s]backtest loop:  98%|█████████▊| 950/971 [00:18<00:00, 54.00it/s]backtest loop:  98%|█████████▊| 956/971 [00:18<00:00, 55.27it/s]backtest loop:  99%|█████████▉| 962/971 [00:18<00:00, 56.26it/s]backtest loop: 100%|█████████▉| 968/971 [00:18<00:00, 57.01it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 52.14it/s]
[3004062:MainThread](2024-04-25 01:59:15,388) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000443
std                0.005047
annualized_return  0.105425
information_ratio  1.353897
max_drawdown      -0.094639
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000250
std                0.005049
annualized_return  0.059478
information_ratio  0.763630
max_drawdown      -0.101509
[3004062:MainThread](2024-04-25 01:59:15,403) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-25_01:25:15_online`.
Round 3 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06015972005648005,
                                                    0.03273059938414068,
                                                    0.05947816937582371],
 '1day.excess_return_with_cost.information_ratio': [0.7679933092923739,
                                                    0.4133389026554145,
                                                    0.7636301919612586],
 '1day.excess_return_with_cost.max_drawdown': [-0.08670293338962837,
                                               -0.16197255475157407,
                                               -0.10150852344205823],
 'IC': [0.027040578141343165, 0.02653395980121937, 0.026817808553124933],
 'ICIR': [0.22347151688066197, 0.22642606515849942, 0.24265733154989236],
 'Rank IC': [0.023053889583337525, 0.02273519521648915, 0.022998778503316525],
 'Rank ICIR': [0.19913024732178053, 0.20377985954373565, 0.21844485445366277],
 'mae': [0.686060905456543, 0.6859773397445679, 0.6860173940658569],
 'mse': [0.9976044297218323, 0.9977508783340454, 0.9977036714553833]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3004062:MainThread](2024-04-25 01:59:18,154) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3004062:MainThread](2024-04-25 01:59:18,155) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3004062:MainThread](2024-04-25 01:59:18,161) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3004062:MainThread](2024-04-25 01:59:18,162) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:13<22:12, 13.46s/it]epoch:   2%|▏         | 2/100 [00:26<21:44, 13.31s/it]epoch:   3%|▎         | 3/100 [00:39<21:26, 13.26s/it]epoch:   4%|▍         | 4/100 [00:53<21:08, 13.21s/it]epoch:   5%|▌         | 5/100 [01:06<20:49, 13.15s/it]epoch:   6%|▌         | 6/100 [01:19<20:30, 13.09s/it]epoch:   7%|▋         | 7/100 [01:31<20:12, 13.04s/it]epoch:   8%|▊         | 8/100 [01:45<20:03, 13.08s/it]epoch:   9%|▉         | 9/100 [01:57<19:44, 13.01s/it]epoch:  10%|█         | 10/100 [02:10<19:27, 12.98s/it]epoch:  11%|█         | 11/100 [02:23<19:10, 12.93s/it]epoch:  12%|█▏        | 12/100 [02:36<18:58, 12.94s/it]epoch:  13%|█▎        | 13/100 [02:49<18:33, 12.79s/it]epoch:  14%|█▍        | 14/100 [03:02<18:28, 12.89s/it]epoch:  15%|█▌        | 15/100 [03:15<18:14, 12.88s/it]epoch:  16%|█▌        | 16/100 [03:27<17:55, 12.80s/it]epoch:  17%|█▋        | 17/100 [03:43<18:44, 13.55s/it]epoch:  18%|█▊        | 18/100 [03:55<18:10, 13.30s/it]epoch:  19%|█▉        | 19/100 [04:08<17:35, 13.03s/it]epoch:  20%|██        | 20/100 [04:20<17:13, 12.92s/it]epoch:  21%|██        | 21/100 [04:33<17:02, 12.94s/it]epoch:  22%|██▏       | 22/100 [04:46<16:44, 12.88s/it]epoch:  23%|██▎       | 23/100 [04:58<16:22, 12.76s/it]epoch:  24%|██▍       | 24/100 [05:11<16:05, 12.71s/it]epoch:  25%|██▌       | 25/100 [05:24<15:59, 12.79s/it]epoch:  26%|██▌       | 26/100 [05:37<15:47, 12.81s/it]epoch:  27%|██▋       | 27/100 [05:49<15:29, 12.73s/it]epoch:  28%|██▊       | 28/100 [06:02<15:10, 12.65s/it]epoch:  29%|██▉       | 29/100 [06:15<15:00, 12.68s/it]epoch:  30%|███       | 30/100 [06:28<14:53, 12.76s/it]0.0565183853056064
best ic: 0.0565183853056064
epoch:  31%|███       | 31/100 [06:42<15:16, 13.28s/it]0.05531228842726204
epoch:  32%|███▏      | 32/100 [06:56<15:19, 13.52s/it]0.054893967859592066
epoch:  33%|███▎      | 33/100 [07:10<15:19, 13.72s/it]0.05540282214986199
epoch:  34%|███▍      | 34/100 [07:25<15:23, 13.99s/it]0.05217908468454406
epoch:  35%|███▌      | 35/100 [07:40<15:23, 14.21s/it]0.05416314586851636
epoch:  36%|███▌      | 36/100 [07:54<15:10, 14.23s/it]0.051670373984946553
epoch:  37%|███▋      | 37/100 [08:08<14:55, 14.21s/it]0.049301136209141665
epoch:  38%|███▊      | 38/100 [08:23<14:47, 14.31s/it]0.05499542119207213
epoch:  38%|███▊      | 38/100 [08:38<14:05, 13.63s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3004062:MainThread](2024-04-25 02:07:56,272) INFO - qlib.workflow - [exp.py:258] - Experiment 47 starts running ...
[3004062:MainThread](2024-04-25 02:07:56,285) INFO - qlib.workflow - [recorder.py:341] - Recorder b03b04e76af7494ba0a0e3687f2dee0f starts running under Experiment 47 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:06,  9.98it/s]online:   3%|▎         | 2/63 [00:00<00:06,  9.43it/s]online:   5%|▍         | 3/63 [00:00<00:06,  9.20it/s]online:   6%|▋         | 4/63 [00:00<00:06,  9.12it/s]online:   8%|▊         | 5/63 [00:00<00:06,  8.92it/s]online:  10%|▉         | 6/63 [00:00<00:06,  9.02it/s]online:  11%|█         | 7/63 [00:00<00:06,  8.88it/s]online:  13%|█▎        | 8/63 [00:00<00:06,  8.91it/s]online:  14%|█▍        | 9/63 [00:00<00:06,  8.90it/s]online:  16%|█▌        | 10/63 [00:01<00:05,  8.96it/s]online:  17%|█▋        | 11/63 [00:01<00:05,  9.05it/s]online:  19%|█▉        | 12/63 [00:01<00:05,  9.01it/s]online:  21%|██        | 13/63 [00:01<00:05,  9.04it/s]online:  22%|██▏       | 14/63 [00:01<00:05,  9.01it/s]online:  24%|██▍       | 15/63 [00:01<00:05,  8.89it/s]online:  25%|██▌       | 16/63 [00:01<00:05,  9.03it/s]online:  27%|██▋       | 17/63 [00:01<00:05,  9.06it/s]online:  29%|██▊       | 18/63 [00:01<00:05,  8.90it/s]online:  30%|███       | 19/63 [00:02<00:04,  9.07it/s]online:  32%|███▏      | 20/63 [00:02<00:04,  9.03it/s]online:  33%|███▎      | 21/63 [00:02<00:04,  9.10it/s]online:  35%|███▍      | 22/63 [00:02<00:04,  9.01it/s]online:  37%|███▋      | 23/63 [00:02<00:04,  9.13it/s]online:  38%|███▊      | 24/63 [00:02<00:04,  9.11it/s]online:  40%|███▉      | 25/63 [00:02<00:04,  9.02it/s]online:  41%|████▏     | 26/63 [00:02<00:04,  8.96it/s]online:  43%|████▎     | 27/63 [00:02<00:04,  8.96it/s]online:  44%|████▍     | 28/63 [00:03<00:03,  9.06it/s]online:  46%|████▌     | 29/63 [00:03<00:03,  9.07it/s]online:  48%|████▊     | 30/63 [00:03<00:03,  9.10it/s]online:  49%|████▉     | 31/63 [00:03<00:03,  9.00it/s]online:  51%|█████     | 32/63 [00:03<00:03,  9.20it/s]online:  52%|█████▏    | 33/63 [00:03<00:03,  9.01it/s]online:  54%|█████▍    | 34/63 [00:03<00:03,  9.16it/s]online:  56%|█████▌    | 35/63 [00:03<00:03,  9.20it/s]online:  57%|█████▋    | 36/63 [00:03<00:02,  9.08it/s]online:  59%|█████▊    | 37/63 [00:04<00:02,  8.98it/s]online:  60%|██████    | 38/63 [00:04<00:02,  9.12it/s]online:  62%|██████▏   | 39/63 [00:04<00:02,  9.08it/s]online:  63%|██████▎   | 40/63 [00:04<00:02,  8.96it/s]online:  65%|██████▌   | 41/63 [00:04<00:02,  8.96it/s]online:  67%|██████▋   | 42/63 [00:04<00:02,  8.99it/s]online:  68%|██████▊   | 43/63 [00:04<00:02,  8.93it/s]online:  70%|██████▉   | 44/63 [00:04<00:02,  9.11it/s]online:  71%|███████▏  | 45/63 [00:04<00:02,  8.97it/s]online:  73%|███████▎  | 46/63 [00:05<00:01,  9.04it/s]online:  75%|███████▍  | 47/63 [00:05<00:01,  8.90it/s]online:  76%|███████▌  | 48/63 [00:05<00:01,  8.95it/s]online:  78%|███████▊  | 49/63 [00:05<00:01,  9.10it/s]online:  79%|███████▉  | 50/63 [00:05<00:01,  9.09it/s]online:  81%|████████  | 51/63 [00:05<00:01,  8.91it/s]online:  83%|████████▎ | 52/63 [00:05<00:01,  9.14it/s]online:  84%|████████▍ | 53/63 [00:05<00:01,  8.97it/s]online:  86%|████████▌ | 54/63 [00:05<00:00,  9.05it/s]online:  87%|████████▋ | 55/63 [00:06<00:00,  9.04it/s]online:  89%|████████▉ | 56/63 [00:06<00:00,  8.98it/s]online:  90%|█████████ | 57/63 [00:06<00:00,  9.01it/s]online:  92%|█████████▏| 58/63 [00:06<00:00,  8.96it/s]online:  94%|█████████▎| 59/63 [00:06<00:00,  8.93it/s]online:  95%|█████████▌| 60/63 [00:06<00:00,  9.07it/s]online:  97%|█████████▋| 61/63 [00:06<00:00,  8.99it/s]online:  98%|█████████▊| 62/63 [00:06<00:00,  9.08it/s]online: 100%|██████████| 63/63 [00:06<00:00,  9.33it/s]online: 100%|██████████| 63/63 [00:06<00:00,  9.05it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3004062:MainThread](2024-04-25 02:08:23,889) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99746746 mae 0.68596923
{'IC': 0.02854324574140338,
 'ICIR': 0.24787481021777158,
 'Rank IC': 0.024537121375718042,
 'Rank ICIR': 0.21715884654157896}
[3004062:MainThread](2024-04-25 02:08:25,707) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3004062:MainThread](2024-04-25 02:08:42,074) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 02:08:42,077) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 02:08:48,284) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8a43153e80>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:39,  9.76it/s]backtest loop:   1%|          | 9/971 [00:00<00:37, 25.65it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 37.99it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.78it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 44.83it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 48.03it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:19, 47.20it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:18, 49.41it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:17, 51.45it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 49.43it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 50.97it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 51.52it/s]backtest loop:   8%|▊         | 76/971 [00:01<00:16, 55.13it/s]backtest loop:   8%|▊         | 82/971 [00:01<00:16, 53.51it/s]backtest loop:   9%|▉         | 89/971 [00:01<00:15, 56.24it/s]backtest loop:  10%|▉         | 96/971 [00:01<00:14, 58.70it/s]backtest loop:  11%|█         | 102/971 [00:02<00:15, 55.62it/s]backtest loop:  11%|█         | 109/971 [00:02<00:14, 57.62it/s]backtest loop:  12%|█▏        | 116/971 [00:02<00:14, 59.32it/s]backtest loop:  13%|█▎        | 122/971 [00:02<00:15, 56.15it/s]backtest loop:  13%|█▎        | 128/971 [00:02<00:15, 53.85it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:14, 56.38it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 54.27it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 56.53it/s]backtest loop:  16%|█▌        | 155/971 [00:03<00:13, 58.37it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 55.42it/s]backtest loop:  17%|█▋        | 167/971 [00:03<00:14, 56.61it/s]backtest loop:  18%|█▊        | 174/971 [00:03<00:13, 58.35it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:13, 56.48it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 58.61it/s]backtest loop:  20%|██        | 195/971 [00:03<00:13, 56.70it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 58.54it/s]backtest loop:  22%|██▏       | 209/971 [00:03<00:12, 59.85it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 54.33it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:13, 56.64it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 55.18it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 57.29it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 58.98it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 56.12it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 57.88it/s]backtest loop:  27%|██▋       | 263/971 [00:04<00:12, 57.75it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:13, 53.29it/s]backtest loop:  28%|██▊       | 275/971 [00:05<00:12, 54.05it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:13, 51.35it/s]backtest loop:  30%|██▉       | 287/971 [00:05<00:13, 52.55it/s]backtest loop:  30%|███       | 293/971 [00:05<00:12, 53.21it/s]backtest loop:  31%|███       | 299/971 [00:05<00:12, 54.13it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:13, 51.01it/s]backtest loop:  32%|███▏      | 311/971 [00:05<00:12, 52.61it/s]backtest loop:  33%|███▎      | 317/971 [00:05<00:12, 53.54it/s]backtest loop:  33%|███▎      | 323/971 [00:06<00:12, 53.93it/s]backtest loop:  34%|███▍      | 329/971 [00:06<00:11, 54.59it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:12, 51.67it/s]backtest loop:  35%|███▌      | 341/971 [00:06<00:12, 52.13it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:11, 54.18it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:10, 56.94it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:11, 54.91it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:11, 54.67it/s]backtest loop:  38%|███▊      | 373/971 [00:07<00:11, 52.72it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:10, 55.43it/s]backtest loop:  40%|███▉      | 386/971 [00:07<00:10, 56.39it/s]backtest loop:  40%|████      | 392/971 [00:07<00:10, 57.36it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 54.87it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 56.98it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:09, 58.68it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:09, 55.64it/s]backtest loop:  44%|████▎     | 424/971 [00:07<00:09, 56.77it/s]backtest loop:  44%|████▍     | 430/971 [00:08<00:09, 57.67it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:09, 55.63it/s]backtest loop:  46%|████▌     | 444/971 [00:08<00:09, 57.49it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:08, 58.96it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:09, 55.57it/s]backtest loop:  48%|████▊     | 463/971 [00:08<00:08, 56.74it/s]backtest loop:  48%|████▊     | 470/971 [00:08<00:08, 58.43it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:08, 56.45it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:08, 58.52it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:08, 55.34it/s]backtest loop:  51%|█████     | 497/971 [00:09<00:08, 57.38it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:07, 59.21it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:08, 56.27it/s]backtest loop:  53%|█████▎    | 517/971 [00:09<00:08, 55.02it/s]backtest loop:  54%|█████▍    | 524/971 [00:09<00:07, 57.12it/s]backtest loop:  55%|█████▍    | 531/971 [00:09<00:07, 55.60it/s]backtest loop:  55%|█████▌    | 537/971 [00:09<00:07, 56.56it/s]backtest loop:  56%|█████▌    | 543/971 [00:09<00:07, 57.39it/s]backtest loop:  57%|█████▋    | 550/971 [00:10<00:07, 57.53it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:07, 53.66it/s]backtest loop:  58%|█████▊    | 562/971 [00:10<00:07, 54.00it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:07, 54.49it/s]backtest loop:  59%|█████▉    | 574/971 [00:10<00:07, 54.77it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:07, 55.08it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:07, 51.70it/s]backtest loop:  61%|██████    | 592/971 [00:10<00:07, 52.66it/s]backtest loop:  62%|██████▏   | 598/971 [00:11<00:06, 53.43it/s]backtest loop:  62%|██████▏   | 604/971 [00:11<00:06, 54.11it/s]backtest loop:  63%|██████▎   | 610/971 [00:11<00:07, 51.27it/s]backtest loop:  63%|██████▎   | 616/971 [00:11<00:06, 52.35it/s]backtest loop:  64%|██████▍   | 622/971 [00:11<00:06, 53.12it/s]backtest loop:  65%|██████▍   | 628/971 [00:11<00:06, 54.41it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:06, 54.77it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:06, 51.57it/s]backtest loop:  67%|██████▋   | 646/971 [00:11<00:06, 52.24it/s]backtest loop:  67%|██████▋   | 652/971 [00:12<00:06, 52.98it/s]backtest loop:  68%|██████▊   | 658/971 [00:12<00:05, 53.91it/s]backtest loop:  68%|██████▊   | 664/971 [00:12<00:05, 54.30it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 51.37it/s]backtest loop:  70%|██████▉   | 676/971 [00:12<00:05, 52.41it/s]backtest loop:  70%|███████   | 682/971 [00:12<00:05, 53.19it/s]backtest loop:  71%|███████   | 688/971 [00:12<00:05, 53.66it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:05, 50.94it/s]backtest loop:  72%|███████▏  | 700/971 [00:12<00:05, 52.56it/s]backtest loop:  73%|███████▎  | 706/971 [00:13<00:04, 54.58it/s]backtest loop:  73%|███████▎  | 713/971 [00:13<00:04, 56.99it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 54.56it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 56.75it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 54.00it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 52.52it/s]backtest loop:  77%|███████▋  | 744/971 [00:13<00:04, 54.50it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 53.12it/s]backtest loop:  78%|███████▊  | 757/971 [00:13<00:03, 55.94it/s]backtest loop:  79%|███████▊  | 764/971 [00:14<00:03, 58.00it/s]backtest loop:  79%|███████▉  | 770/971 [00:14<00:03, 56.63it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 59.65it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 57.08it/s]backtest loop:  81%|████████▏ | 789/971 [00:14<00:03, 56.82it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.01it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 58.67it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 55.47it/s]backtest loop:  84%|████████▍ | 814/971 [00:14<00:02, 56.22it/s]backtest loop:  84%|████████▍ | 820/971 [00:15<00:02, 57.23it/s]backtest loop:  85%|████████▌ | 827/971 [00:15<00:02, 58.74it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 55.63it/s]backtest loop:  87%|████████▋ | 840/971 [00:15<00:02, 57.54it/s]backtest loop:  87%|████████▋ | 846/971 [00:15<00:02, 57.89it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 55.23it/s]backtest loop:  88%|████████▊ | 858/971 [00:15<00:02, 56.22it/s]backtest loop:  89%|████████▉ | 865/971 [00:15<00:01, 58.12it/s]backtest loop:  90%|████████▉ | 871/971 [00:15<00:01, 58.59it/s]backtest loop:  90%|█████████ | 877/971 [00:16<00:01, 55.49it/s]backtest loop:  91%|█████████ | 884/971 [00:16<00:01, 57.56it/s]backtest loop:  92%|█████████▏| 890/971 [00:16<00:01, 58.18it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 54.89it/s]backtest loop:  93%|█████████▎| 903/971 [00:16<00:01, 53.89it/s]backtest loop:  94%|█████████▎| 910/971 [00:16<00:01, 56.29it/s]backtest loop:  94%|█████████▍| 916/971 [00:16<00:01, 54.17it/s]backtest loop:  95%|█████████▍| 922/971 [00:16<00:00, 55.71it/s]backtest loop:  96%|█████████▌| 928/971 [00:16<00:00, 56.65it/s]backtest loop:  96%|█████████▌| 934/971 [00:17<00:00, 57.46it/s]backtest loop:  97%|█████████▋| 940/971 [00:17<00:00, 53.41it/s]backtest loop:  97%|█████████▋| 946/971 [00:17<00:00, 53.94it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 54.33it/s]backtest loop:  99%|█████████▊| 958/971 [00:17<00:00, 54.61it/s]backtest loop:  99%|█████████▉| 964/971 [00:17<00:00, 54.83it/s]backtest loop: 100%|█████████▉| 970/971 [00:17<00:00, 51.72it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.52it/s]
[3004062:MainThread](2024-04-25 02:09:06,161) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000226
std                0.005059
annualized_return  0.053714
information_ratio  0.688273
max_drawdown      -0.126961
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000032
std                0.005060
annualized_return  0.007636
information_ratio  0.097814
max_drawdown      -0.166567
[3004062:MainThread](2024-04-25 02:09:06,177) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-25_01:25:15_online`.
Round 4 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06015972005648005,
                                                    0.03273059938414068,
                                                    0.05947816937582371,
                                                    0.0076356952206925776],
 '1day.excess_return_with_cost.information_ratio': [0.7679933092923739,
                                                    0.4133389026554145,
                                                    0.7636301919612586,
                                                    0.0978136867244855],
 '1day.excess_return_with_cost.max_drawdown': [-0.08670293338962837,
                                               -0.16197255475157407,
                                               -0.10150852344205823,
                                               -0.1665674035171944],
 'IC': [0.027040578141343165,
        0.02653395980121937,
        0.026817808553124933,
        0.02854324574140338],
 'ICIR': [0.22347151688066197,
          0.22642606515849942,
          0.24265733154989236,
          0.24787481021777158],
 'Rank IC': [0.023053889583337525,
             0.02273519521648915,
             0.022998778503316525,
             0.024537121375718042],
 'Rank ICIR': [0.19913024732178053,
               0.20377985954373565,
               0.21844485445366277,
               0.21715884654157896],
 'mae': [0.686060905456543,
         0.6859773397445679,
         0.6860173940658569,
         0.6859692335128784],
 'mse': [0.9976044297218323,
         0.9977508783340454,
         0.9977036714553833,
         0.9974674582481384]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3004062:MainThread](2024-04-25 02:09:07,439) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3004062:MainThread](2024-04-25 02:09:07,440) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3004062:MainThread](2024-04-25 02:09:07,442) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3004062:MainThread](2024-04-25 02:09:07,442) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:12<20:50, 12.63s/it]epoch:   2%|▏         | 2/100 [00:26<21:45, 13.32s/it]epoch:   3%|▎         | 3/100 [00:39<21:32, 13.33s/it]epoch:   4%|▍         | 4/100 [00:53<21:29, 13.43s/it]epoch:   5%|▌         | 5/100 [01:06<21:10, 13.38s/it]epoch:   6%|▌         | 6/100 [01:22<22:24, 14.30s/it]epoch:   7%|▋         | 7/100 [01:38<22:51, 14.75s/it]epoch:   8%|▊         | 8/100 [01:51<21:56, 14.31s/it]epoch:   9%|▉         | 9/100 [02:05<21:11, 13.98s/it]epoch:  10%|█         | 10/100 [02:18<20:38, 13.76s/it]epoch:  11%|█         | 11/100 [02:31<20:07, 13.57s/it]epoch:  12%|█▏        | 12/100 [02:44<19:43, 13.45s/it]epoch:  13%|█▎        | 13/100 [02:57<19:26, 13.40s/it]epoch:  14%|█▍        | 14/100 [03:11<19:28, 13.59s/it]epoch:  15%|█▌        | 15/100 [03:27<20:17, 14.33s/it]epoch:  16%|█▌        | 16/100 [03:40<19:17, 13.78s/it]epoch:  17%|█▋        | 17/100 [03:53<18:47, 13.59s/it]epoch:  18%|█▊        | 18/100 [04:06<18:09, 13.29s/it]epoch:  19%|█▉        | 19/100 [04:18<17:42, 13.12s/it]epoch:  20%|██        | 20/100 [04:31<17:27, 13.09s/it]epoch:  21%|██        | 21/100 [04:44<17:01, 12.94s/it]epoch:  22%|██▏       | 22/100 [05:02<18:37, 14.32s/it]epoch:  23%|██▎       | 23/100 [05:15<18:10, 14.16s/it]epoch:  24%|██▍       | 24/100 [05:28<17:16, 13.64s/it]epoch:  25%|██▌       | 25/100 [05:40<16:36, 13.29s/it]epoch:  26%|██▌       | 26/100 [05:53<16:18, 13.22s/it]epoch:  27%|██▋       | 27/100 [06:07<16:14, 13.35s/it]epoch:  28%|██▊       | 28/100 [06:20<15:47, 13.16s/it]epoch:  29%|██▉       | 29/100 [06:33<15:28, 13.07s/it]epoch:  30%|███       | 30/100 [06:50<16:55, 14.51s/it]0.05581248417713575
best ic: 0.05581248417713575
epoch:  31%|███       | 31/100 [07:06<17:09, 14.92s/it]0.05721643079554942
best ic: 0.05721643079554942
epoch:  32%|███▏      | 32/100 [07:21<16:59, 15.00s/it]0.056688461826716656
epoch:  33%|███▎      | 33/100 [07:37<16:48, 15.05s/it]0.050830633318495785
epoch:  34%|███▍      | 34/100 [07:52<16:33, 15.06s/it]0.05413938776091109
epoch:  35%|███▌      | 35/100 [08:07<16:19, 15.07s/it]0.054894458127302447
epoch:  36%|███▌      | 36/100 [08:22<16:04, 15.08s/it]0.052876722865299965
epoch:  37%|███▋      | 37/100 [08:40<16:48, 16.01s/it]0.05597049175057793
epoch:  38%|███▊      | 38/100 [08:55<16:12, 15.68s/it]0.05158303497078476
epoch:  39%|███▉      | 39/100 [09:09<15:32, 15.28s/it]0.053861659817161185
epoch:  39%|███▉      | 39/100 [09:24<14:43, 14.48s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3004062:MainThread](2024-04-25 02:18:32,706) INFO - qlib.workflow - [exp.py:258] - Experiment 47 starts running ...
[3004062:MainThread](2024-04-25 02:18:32,719) INFO - qlib.workflow - [recorder.py:341] - Recorder d6c09255147b439e8de9f02611a66fea starts running under Experiment 47 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:06,  9.68it/s]online:   3%|▎         | 2/63 [00:00<00:06,  9.84it/s]online:   5%|▍         | 3/63 [00:00<00:06,  9.82it/s]online:   6%|▋         | 4/63 [00:00<00:06,  9.67it/s]online:   8%|▊         | 5/63 [00:00<00:06,  9.61it/s]online:  10%|▉         | 6/63 [00:00<00:05,  9.55it/s]online:  11%|█         | 7/63 [00:00<00:05,  9.48it/s]online:  13%|█▎        | 8/63 [00:00<00:05,  9.48it/s]online:  14%|█▍        | 9/63 [00:00<00:05,  9.47it/s]online:  16%|█▌        | 10/63 [00:01<00:05,  9.28it/s]online:  17%|█▋        | 11/63 [00:01<00:05,  9.43it/s]online:  19%|█▉        | 12/63 [00:01<00:05,  9.47it/s]online:  21%|██        | 13/63 [00:01<00:05,  9.33it/s]online:  22%|██▏       | 14/63 [00:01<00:05,  9.39it/s]online:  24%|██▍       | 15/63 [00:01<00:05,  9.39it/s]online:  25%|██▌       | 16/63 [00:01<00:05,  9.28it/s]online:  27%|██▋       | 17/63 [00:01<00:04,  9.36it/s]online:  29%|██▊       | 18/63 [00:01<00:04,  9.44it/s]online:  30%|███       | 19/63 [00:02<00:04,  9.31it/s]online:  32%|███▏      | 20/63 [00:02<00:04,  9.37it/s]online:  33%|███▎      | 21/63 [00:02<00:04,  9.44it/s]online:  35%|███▍      | 22/63 [00:02<00:04,  9.36it/s]online:  37%|███▋      | 23/63 [00:02<00:04,  9.46it/s]online:  38%|███▊      | 24/63 [00:02<00:04,  9.35it/s]online:  40%|███▉      | 25/63 [00:02<00:04,  9.42it/s]online:  41%|████▏     | 26/63 [00:02<00:03,  9.43it/s]online:  43%|████▎     | 27/63 [00:02<00:03,  9.39it/s]online:  44%|████▍     | 28/63 [00:02<00:03,  9.54it/s]online:  46%|████▌     | 29/63 [00:03<00:03,  9.44it/s]online:  48%|████▊     | 30/63 [00:03<00:03,  9.45it/s]online:  49%|████▉     | 31/63 [00:03<00:03,  9.55it/s]online:  51%|█████     | 32/63 [00:03<00:03,  9.56it/s]online:  52%|█████▏    | 33/63 [00:03<00:03,  9.33it/s]online:  54%|█████▍    | 34/63 [00:03<00:03,  9.49it/s]online:  56%|█████▌    | 35/63 [00:03<00:02,  9.50it/s]online:  57%|█████▋    | 36/63 [00:03<00:02,  9.45it/s]online:  59%|█████▊    | 37/63 [00:03<00:02,  9.46it/s]online:  60%|██████    | 38/63 [00:04<00:02,  9.44it/s]online:  62%|██████▏   | 39/63 [00:04<00:02,  9.52it/s]online:  63%|██████▎   | 40/63 [00:04<00:02,  9.45it/s]online:  65%|██████▌   | 41/63 [00:04<00:02,  9.54it/s]online:  67%|██████▋   | 42/63 [00:04<00:02,  9.51it/s]online:  68%|██████▊   | 43/63 [00:04<00:02,  9.32it/s]online:  70%|██████▉   | 44/63 [00:04<00:02,  9.15it/s]online:  71%|███████▏  | 45/63 [00:04<00:02,  9.00it/s]online:  73%|███████▎  | 46/63 [00:04<00:01,  8.98it/s]online:  75%|███████▍  | 47/63 [00:05<00:01,  8.90it/s]online:  76%|███████▌  | 48/63 [00:05<00:01,  9.20it/s]online:  78%|███████▊  | 49/63 [00:05<00:01,  9.21it/s]online:  79%|███████▉  | 50/63 [00:05<00:01,  9.33it/s]online:  81%|████████  | 51/63 [00:05<00:01,  9.30it/s]online:  83%|████████▎ | 52/63 [00:05<00:01,  9.18it/s]online:  84%|████████▍ | 53/63 [00:05<00:01,  9.29it/s]online:  86%|████████▌ | 54/63 [00:05<00:00,  9.20it/s]online:  87%|████████▋ | 55/63 [00:05<00:00,  9.22it/s]online:  89%|████████▉ | 56/63 [00:05<00:00,  9.22it/s]online:  90%|█████████ | 57/63 [00:06<00:00,  9.39it/s]online:  92%|█████████▏| 58/63 [00:06<00:00,  9.44it/s]online:  94%|█████████▎| 59/63 [00:06<00:00,  9.39it/s]online:  95%|█████████▌| 60/63 [00:06<00:00,  9.31it/s]online:  97%|█████████▋| 61/63 [00:06<00:00,  9.38it/s]online:  98%|█████████▊| 62/63 [00:06<00:00,  9.31it/s]online: 100%|██████████| 63/63 [00:06<00:00,  9.40it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3004062:MainThread](2024-04-25 02:19:04,048) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9975618 mae 0.68602556
{'IC': 0.026814229044106942,
 'ICIR': 0.22370551351917856,
 'Rank IC': 0.024870332765134055,
 'Rank ICIR': 0.21568508976946332}
[3004062:MainThread](2024-04-25 02:19:06,049) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3004062:MainThread](2024-04-25 02:19:22,237) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 02:19:22,241) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 02:19:30,455) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8a4a51e2b0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<02:47,  5.76it/s]backtest loop:   1%|          | 7/971 [00:00<01:15, 12.74it/s]backtest loop:   1%|          | 11/971 [00:00<00:50, 18.92it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:40, 23.82it/s]backtest loop:   2%|▏         | 19/971 [00:00<00:37, 25.59it/s]backtest loop:   2%|▏         | 23/971 [00:01<00:33, 28.44it/s]backtest loop:   3%|▎         | 27/971 [00:01<00:33, 28.56it/s]backtest loop:   3%|▎         | 31/971 [00:01<00:30, 30.60it/s]backtest loop:   4%|▎         | 35/971 [00:01<00:30, 30.38it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:28, 32.18it/s]backtest loop:   4%|▍         | 43/971 [00:01<00:27, 33.85it/s]backtest loop:   5%|▍         | 47/971 [00:01<00:26, 34.29it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:27, 33.27it/s]backtest loop:   6%|▌         | 55/971 [00:02<00:27, 33.83it/s]backtest loop:   6%|▌         | 59/971 [00:02<00:27, 33.02it/s]backtest loop:   6%|▋         | 63/971 [00:02<00:26, 34.55it/s]backtest loop:   7%|▋         | 67/971 [00:02<00:27, 33.45it/s]backtest loop:   7%|▋         | 72/971 [00:02<00:25, 34.87it/s]backtest loop:   8%|▊         | 76/971 [00:02<00:24, 36.00it/s]backtest loop:   8%|▊         | 80/971 [00:02<00:24, 36.12it/s]backtest loop:   9%|▊         | 84/971 [00:02<00:24, 35.64it/s]backtest loop:   9%|▉         | 88/971 [00:02<00:25, 35.16it/s]backtest loop:   9%|▉         | 92/971 [00:03<00:25, 35.05it/s]backtest loop:  10%|▉         | 97/971 [00:03<00:24, 35.42it/s]backtest loop:  10%|█         | 101/971 [00:03<00:23, 36.39it/s]backtest loop:  11%|█         | 105/971 [00:03<00:24, 34.90it/s]backtest loop:  11%|█         | 109/971 [00:03<00:24, 34.64it/s]backtest loop:  12%|█▏        | 113/971 [00:03<00:26, 31.98it/s]backtest loop:  12%|█▏        | 117/971 [00:03<00:25, 33.29it/s]backtest loop:  12%|█▏        | 121/971 [00:03<00:24, 34.26it/s]backtest loop:  13%|█▎        | 125/971 [00:04<00:26, 31.76it/s]backtest loop:  13%|█▎        | 129/971 [00:04<00:26, 32.32it/s]backtest loop:  14%|█▎        | 133/971 [00:04<00:25, 32.91it/s]backtest loop:  14%|█▍        | 137/971 [00:04<00:25, 32.47it/s]backtest loop:  15%|█▍        | 141/971 [00:04<00:24, 33.46it/s]backtest loop:  15%|█▌        | 146/971 [00:04<00:24, 33.90it/s]backtest loop:  16%|█▌        | 151/971 [00:04<00:24, 34.11it/s]backtest loop:  16%|█▌        | 156/971 [00:04<00:23, 34.12it/s]backtest loop:  17%|█▋        | 161/971 [00:05<00:23, 34.99it/s]backtest loop:  17%|█▋        | 166/971 [00:05<00:22, 35.82it/s]backtest loop:  18%|█▊        | 171/971 [00:05<00:22, 35.23it/s]backtest loop:  18%|█▊        | 176/971 [00:05<00:22, 35.16it/s]backtest loop:  19%|█▊        | 181/971 [00:05<00:22, 35.33it/s]backtest loop:  19%|█▉        | 185/971 [00:05<00:22, 35.73it/s]backtest loop:  20%|█▉        | 190/971 [00:05<00:21, 36.37it/s]backtest loop:  20%|██        | 195/971 [00:06<00:21, 35.91it/s]backtest loop:  21%|██        | 200/971 [00:06<00:21, 36.49it/s]backtest loop:  21%|██        | 204/971 [00:06<00:20, 37.14it/s]backtest loop:  21%|██▏       | 208/971 [00:06<00:21, 35.58it/s]backtest loop:  22%|██▏       | 212/971 [00:06<00:21, 35.14it/s]backtest loop:  22%|██▏       | 216/971 [00:06<00:23, 32.20it/s]backtest loop:  23%|██▎       | 220/971 [00:06<00:22, 33.34it/s]backtest loop:  23%|██▎       | 225/971 [00:06<00:21, 34.10it/s]backtest loop:  24%|██▎       | 230/971 [00:07<00:21, 34.47it/s]backtest loop:  24%|██▍       | 235/971 [00:07<00:21, 34.23it/s]backtest loop:  25%|██▍       | 240/971 [00:07<00:20, 35.50it/s]backtest loop:  25%|██▌       | 245/971 [00:07<00:20, 36.28it/s]backtest loop:  26%|██▌       | 249/971 [00:07<00:20, 36.00it/s]backtest loop:  26%|██▌       | 254/971 [00:07<00:20, 35.73it/s]backtest loop:  27%|██▋       | 259/971 [00:07<00:20, 35.34it/s]backtest loop:  27%|██▋       | 264/971 [00:08<00:19, 35.97it/s]backtest loop:  28%|██▊       | 268/971 [00:08<00:20, 34.84it/s]backtest loop:  28%|██▊       | 272/971 [00:08<00:20, 34.55it/s]backtest loop:  28%|██▊       | 276/971 [00:08<00:20, 34.00it/s]backtest loop:  29%|██▉       | 281/971 [00:08<00:19, 35.19it/s]backtest loop:  29%|██▉       | 286/971 [00:08<00:19, 35.70it/s]backtest loop:  30%|██▉       | 291/971 [00:08<00:18, 36.20it/s]backtest loop:  30%|███       | 295/971 [00:08<00:19, 35.40it/s]backtest loop:  31%|███       | 300/971 [00:09<00:18, 35.73it/s]backtest loop:  31%|███▏      | 305/971 [00:09<00:18, 36.68it/s]backtest loop:  32%|███▏      | 310/971 [00:09<00:16, 39.35it/s]backtest loop:  33%|███▎      | 316/971 [00:09<00:15, 43.47it/s]backtest loop:  33%|███▎      | 322/971 [00:09<00:13, 46.51it/s]backtest loop:  34%|███▍      | 328/971 [00:09<00:13, 48.83it/s]backtest loop:  34%|███▍      | 334/971 [00:09<00:12, 50.27it/s]backtest loop:  35%|███▌      | 340/971 [00:09<00:13, 47.69it/s]backtest loop:  36%|███▌      | 346/971 [00:09<00:12, 49.63it/s]backtest loop:  36%|███▋      | 352/971 [00:10<00:12, 50.49it/s]backtest loop:  37%|███▋      | 358/971 [00:10<00:11, 51.33it/s]backtest loop:  37%|███▋      | 364/971 [00:10<00:12, 49.47it/s]backtest loop:  38%|███▊      | 369/971 [00:10<00:12, 47.21it/s]backtest loop:  39%|███▊      | 374/971 [00:10<00:12, 47.87it/s]backtest loop:  39%|███▉      | 380/971 [00:10<00:11, 49.54it/s]backtest loop:  40%|███▉      | 386/971 [00:10<00:11, 50.70it/s]backtest loop:  40%|████      | 392/971 [00:10<00:11, 51.64it/s]backtest loop:  41%|████      | 398/971 [00:11<00:11, 49.13it/s]backtest loop:  42%|████▏     | 404/971 [00:11<00:11, 50.45it/s]backtest loop:  42%|████▏     | 410/971 [00:11<00:10, 51.19it/s]backtest loop:  43%|████▎     | 416/971 [00:11<00:10, 51.65it/s]backtest loop:  43%|████▎     | 422/971 [00:11<00:10, 51.67it/s]backtest loop:  44%|████▍     | 428/971 [00:11<00:11, 48.86it/s]backtest loop:  45%|████▍     | 433/971 [00:11<00:10, 48.93it/s]backtest loop:  45%|████▌     | 439/971 [00:11<00:10, 49.97it/s]backtest loop:  46%|████▌     | 445/971 [00:11<00:10, 50.47it/s]backtest loop:  46%|████▋     | 451/971 [00:12<00:11, 45.49it/s]backtest loop:  47%|████▋     | 457/971 [00:12<00:11, 45.31it/s]backtest loop:  48%|████▊     | 463/971 [00:12<00:10, 48.28it/s]backtest loop:  48%|████▊     | 469/971 [00:12<00:10, 49.45it/s]backtest loop:  49%|████▉     | 475/971 [00:12<00:09, 50.48it/s]backtest loop:  50%|████▉     | 481/971 [00:12<00:09, 51.44it/s]backtest loop:  50%|█████     | 487/971 [00:12<00:09, 49.84it/s]backtest loop:  51%|█████     | 493/971 [00:12<00:09, 52.29it/s]backtest loop:  51%|█████▏    | 499/971 [00:13<00:08, 54.32it/s]backtest loop:  52%|█████▏    | 505/971 [00:13<00:08, 52.39it/s]backtest loop:  53%|█████▎    | 511/971 [00:13<00:08, 54.10it/s]backtest loop:  53%|█████▎    | 517/971 [00:13<00:08, 51.64it/s]backtest loop:  54%|█████▍    | 523/971 [00:13<00:08, 52.92it/s]backtest loop:  54%|█████▍    | 529/971 [00:13<00:08, 54.10it/s]backtest loop:  55%|█████▌    | 535/971 [00:13<00:08, 54.46it/s]backtest loop:  56%|█████▌    | 541/971 [00:13<00:08, 52.21it/s]backtest loop:  56%|█████▋    | 548/971 [00:13<00:07, 55.19it/s]backtest loop:  57%|█████▋    | 555/971 [00:14<00:07, 57.45it/s]backtest loop:  58%|█████▊    | 561/971 [00:14<00:07, 54.60it/s]backtest loop:  58%|█████▊    | 568/971 [00:14<00:07, 57.06it/s]backtest loop:  59%|█████▉    | 574/971 [00:14<00:06, 57.08it/s]backtest loop:  60%|█████▉    | 580/971 [00:14<00:06, 57.74it/s]backtest loop:  60%|██████    | 586/971 [00:14<00:07, 54.90it/s]backtest loop:  61%|██████    | 592/971 [00:14<00:06, 56.29it/s]backtest loop:  62%|██████▏   | 598/971 [00:14<00:06, 57.33it/s]backtest loop:  62%|██████▏   | 605/971 [00:14<00:06, 55.49it/s]backtest loop:  63%|██████▎   | 611/971 [00:15<00:06, 56.60it/s]backtest loop:  64%|██████▎   | 618/971 [00:15<00:06, 58.41it/s]backtest loop:  64%|██████▍   | 625/971 [00:15<00:06, 56.19it/s]backtest loop:  65%|██████▌   | 632/971 [00:15<00:05, 57.95it/s]backtest loop:  66%|██████▌   | 638/971 [00:15<00:05, 58.24it/s]backtest loop:  66%|██████▋   | 644/971 [00:15<00:05, 57.93it/s]backtest loop:  67%|██████▋   | 650/971 [00:15<00:05, 54.80it/s]backtest loop:  68%|██████▊   | 656/971 [00:15<00:05, 55.89it/s]backtest loop:  68%|██████▊   | 662/971 [00:15<00:05, 56.56it/s]backtest loop:  69%|██████▉   | 668/971 [00:16<00:05, 56.99it/s]backtest loop:  69%|██████▉   | 674/971 [00:16<00:05, 53.70it/s]backtest loop:  70%|███████   | 680/971 [00:16<00:05, 55.18it/s]backtest loop:  71%|███████   | 686/971 [00:16<00:05, 56.00it/s]backtest loop:  71%|███████▏  | 692/971 [00:16<00:04, 56.86it/s]backtest loop:  72%|███████▏  | 698/971 [00:16<00:04, 57.49it/s]backtest loop:  73%|███████▎  | 704/971 [00:16<00:04, 54.65it/s]backtest loop:  73%|███████▎  | 710/971 [00:16<00:04, 55.99it/s]backtest loop:  74%|███████▎  | 716/971 [00:16<00:04, 57.00it/s]backtest loop:  74%|███████▍  | 722/971 [00:17<00:04, 57.67it/s]backtest loop:  75%|███████▍  | 728/971 [00:17<00:04, 58.11it/s]backtest loop:  76%|███████▌  | 734/971 [00:17<00:04, 51.74it/s]backtest loop:  76%|███████▌  | 740/971 [00:17<00:04, 53.59it/s]backtest loop:  77%|███████▋  | 746/971 [00:17<00:04, 55.31it/s]backtest loop:  77%|███████▋  | 752/971 [00:17<00:04, 52.20it/s]backtest loop:  78%|███████▊  | 758/971 [00:17<00:03, 54.10it/s]backtest loop:  79%|███████▉  | 765/971 [00:17<00:03, 53.68it/s]backtest loop:  80%|███████▉  | 772/971 [00:17<00:03, 56.95it/s]backtest loop:  80%|████████  | 779/971 [00:18<00:03, 59.05it/s]backtest loop:  81%|████████  | 785/971 [00:18<00:03, 55.72it/s]backtest loop:  81%|████████▏ | 791/971 [00:18<00:03, 56.51it/s]backtest loop:  82%|████████▏ | 797/971 [00:18<00:03, 57.12it/s]backtest loop:  83%|████████▎ | 803/971 [00:18<00:03, 54.31it/s]backtest loop:  83%|████████▎ | 809/971 [00:18<00:02, 55.40it/s]backtest loop:  84%|████████▍ | 815/971 [00:18<00:02, 56.39it/s]backtest loop:  85%|████████▍ | 821/971 [00:18<00:02, 57.01it/s]backtest loop:  85%|████████▌ | 827/971 [00:18<00:02, 57.43it/s]backtest loop:  86%|████████▌ | 833/971 [00:19<00:02, 54.22it/s]backtest loop:  86%|████████▋ | 839/971 [00:19<00:02, 55.39it/s]backtest loop:  87%|████████▋ | 845/971 [00:19<00:02, 56.23it/s]backtest loop:  88%|████████▊ | 851/971 [00:19<00:02, 56.90it/s]backtest loop:  88%|████████▊ | 857/971 [00:19<00:02, 53.97it/s]backtest loop:  89%|████████▉ | 863/971 [00:19<00:01, 55.43it/s]backtest loop:  89%|████████▉ | 869/971 [00:19<00:01, 56.27it/s]backtest loop:  90%|█████████ | 875/971 [00:19<00:01, 57.27it/s]backtest loop:  91%|█████████ | 881/971 [00:19<00:01, 58.05it/s]backtest loop:  91%|█████████▏| 887/971 [00:19<00:01, 55.05it/s]backtest loop:  92%|█████████▏| 893/971 [00:20<00:01, 56.09it/s]backtest loop:  93%|█████████▎| 899/971 [00:20<00:01, 57.10it/s]backtest loop:  93%|█████████▎| 905/971 [00:20<00:01, 57.90it/s]backtest loop:  94%|█████████▍| 912/971 [00:20<00:01, 55.83it/s]backtest loop:  95%|█████████▍| 919/971 [00:20<00:00, 57.74it/s]backtest loop:  95%|█████████▌| 925/971 [00:20<00:00, 58.31it/s]backtest loop:  96%|█████████▌| 931/971 [00:20<00:00, 55.23it/s]backtest loop:  96%|█████████▋| 937/971 [00:20<00:00, 56.47it/s]backtest loop:  97%|█████████▋| 943/971 [00:20<00:00, 57.06it/s]backtest loop:  98%|█████████▊| 949/971 [00:21<00:00, 57.62it/s]backtest loop:  98%|█████████▊| 955/971 [00:21<00:00, 54.40it/s]backtest loop:  99%|█████████▉| 961/971 [00:21<00:00, 55.88it/s]backtest loop: 100%|█████████▉| 967/971 [00:21<00:00, 57.00it/s]backtest loop: 100%|██████████| 971/971 [00:21<00:00, 45.21it/s]
[3004062:MainThread](2024-04-25 02:19:52,004) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000408
std                0.004918
annualized_return  0.097204
information_ratio  1.281265
max_drawdown      -0.095502
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000215
std                0.004918
annualized_return  0.051193
information_ratio  0.674722
max_drawdown      -0.113553
[3004062:MainThread](2024-04-25 02:19:52,020) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-25_01:25:15_online`.
Round 5 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06015972005648005,
                                                    0.03273059938414068,
                                                    0.05947816937582371,
                                                    0.0076356952206925776,
                                                    0.05119321329664117],
 '1day.excess_return_with_cost.information_ratio': [0.7679933092923739,
                                                    0.4133389026554145,
                                                    0.7636301919612586,
                                                    0.0978136867244855,
                                                    0.6747217921818092],
 '1day.excess_return_with_cost.max_drawdown': [-0.08670293338962837,
                                               -0.16197255475157407,
                                               -0.10150852344205823,
                                               -0.1665674035171944,
                                               -0.11355296002422188],
 'IC': [0.027040578141343165,
        0.02653395980121937,
        0.026817808553124933,
        0.02854324574140338,
        0.026814229044106942],
 'ICIR': [0.22347151688066197,
          0.22642606515849942,
          0.24265733154989236,
          0.24787481021777158,
          0.22370551351917856],
 'Rank IC': [0.023053889583337525,
             0.02273519521648915,
             0.022998778503316525,
             0.024537121375718042,
             0.024870332765134055],
 'Rank ICIR': [0.19913024732178053,
               0.20377985954373565,
               0.21844485445366277,
               0.21715884654157896,
               0.21568508976946332],
 'mae': [0.686060905456543,
         0.6859773397445679,
         0.6860173940658569,
         0.6859692335128784,
         0.6860255599021912],
 'mse': [0.9976044297218323,
         0.9977508783340454,
         0.9977036714553833,
         0.9974674582481384,
         0.9975618124008179]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3004062:MainThread](2024-04-25 02:19:53,422) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3004062:MainThread](2024-04-25 02:19:53,422) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3004062:MainThread](2024-04-25 02:19:53,438) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3004062:MainThread](2024-04-25 02:19:53,439) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:13<22:01, 13.35s/it]epoch:   2%|▏         | 2/100 [00:26<21:29, 13.16s/it]epoch:   3%|▎         | 3/100 [00:39<21:13, 13.13s/it]epoch:   4%|▍         | 4/100 [00:52<20:57, 13.10s/it]epoch:   5%|▌         | 5/100 [01:05<20:48, 13.14s/it]epoch:   6%|▌         | 6/100 [01:20<21:26, 13.68s/it]epoch:   7%|▋         | 7/100 [01:35<21:47, 14.06s/it]epoch:   8%|▊         | 8/100 [01:47<20:48, 13.57s/it]epoch:   9%|▉         | 9/100 [02:01<20:24, 13.45s/it]epoch:  10%|█         | 10/100 [02:13<19:46, 13.18s/it]epoch:  11%|█         | 11/100 [02:26<19:26, 13.10s/it]epoch:  12%|█▏        | 12/100 [02:39<19:04, 13.01s/it]epoch:  13%|█▎        | 13/100 [02:51<18:39, 12.87s/it]epoch:  14%|█▍        | 14/100 [03:08<20:15, 14.14s/it]epoch:  15%|█▌        | 15/100 [03:23<20:20, 14.35s/it]epoch:  16%|█▌        | 16/100 [03:36<19:17, 13.78s/it]epoch:  17%|█▋        | 17/100 [03:48<18:31, 13.39s/it]epoch:  18%|█▊        | 18/100 [04:01<18:06, 13.25s/it]epoch:  19%|█▉        | 19/100 [04:14<17:42, 13.12s/it]epoch:  20%|██        | 20/100 [04:26<17:11, 12.89s/it]epoch:  21%|██        | 21/100 [04:39<16:47, 12.75s/it]epoch:  22%|██▏       | 22/100 [04:51<16:30, 12.70s/it]epoch:  23%|██▎       | 23/100 [05:04<16:23, 12.77s/it]epoch:  24%|██▍       | 24/100 [05:18<16:29, 13.02s/it]epoch:  25%|██▌       | 25/100 [05:30<16:05, 12.88s/it]epoch:  26%|██▌       | 26/100 [05:43<15:43, 12.75s/it]epoch:  27%|██▋       | 27/100 [05:56<15:32, 12.77s/it]epoch:  28%|██▊       | 28/100 [06:09<15:24, 12.84s/it]epoch:  29%|██▉       | 29/100 [06:21<15:06, 12.77s/it]epoch:  30%|███       | 30/100 [06:34<14:47, 12.68s/it]0.05483937255601681
best ic: 0.05483937255601681
epoch:  31%|███       | 31/100 [06:48<15:13, 13.23s/it]0.0597510055236535
best ic: 0.0597510055236535
epoch:  32%|███▏      | 32/100 [07:05<16:01, 14.14s/it]0.05665338381612661
epoch:  33%|███▎      | 33/100 [07:19<15:56, 14.27s/it]0.0556855661197532
epoch:  34%|███▍      | 34/100 [07:33<15:41, 14.26s/it]0.05401794602574324
epoch:  35%|███▌      | 35/100 [07:47<15:22, 14.19s/it]0.05604096177532041
epoch:  36%|███▌      | 36/100 [08:02<15:13, 14.27s/it]0.05737221687838532
epoch:  37%|███▋      | 37/100 [08:17<15:07, 14.41s/it]0.05345903812300224
epoch:  38%|███▊      | 38/100 [08:33<15:36, 15.11s/it]0.05565525877953192
epoch:  39%|███▉      | 39/100 [08:49<15:38, 15.39s/it]0.052400203974416026
epoch:  39%|███▉      | 39/100 [09:04<14:10, 13.95s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3004062:MainThread](2024-04-25 02:28:57,609) INFO - qlib.workflow - [exp.py:258] - Experiment 47 starts running ...
[3004062:MainThread](2024-04-25 02:28:57,622) INFO - qlib.workflow - [recorder.py:341] - Recorder d0dece1965124a9d9848b0e8cafef853 starts running under Experiment 47 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:06,  9.90it/s]online:   5%|▍         | 3/63 [00:00<00:06,  9.78it/s]online:   6%|▋         | 4/63 [00:00<00:06,  9.57it/s]online:   8%|▊         | 5/63 [00:00<00:06,  9.60it/s]online:  10%|▉         | 6/63 [00:00<00:05,  9.54it/s]online:  11%|█         | 7/63 [00:00<00:05,  9.52it/s]online:  13%|█▎        | 8/63 [00:00<00:05,  9.47it/s]online:  14%|█▍        | 9/63 [00:00<00:05,  9.54it/s]online:  16%|█▌        | 10/63 [00:01<00:05,  9.44it/s]online:  17%|█▋        | 11/63 [00:01<00:05,  9.50it/s]online:  19%|█▉        | 12/63 [00:01<00:05,  9.57it/s]online:  21%|██        | 13/63 [00:01<00:05,  9.57it/s]online:  22%|██▏       | 14/63 [00:01<00:05,  9.50it/s]online:  24%|██▍       | 15/63 [00:01<00:05,  9.49it/s]online:  25%|██▌       | 16/63 [00:01<00:04,  9.45it/s]online:  27%|██▋       | 17/63 [00:01<00:04,  9.43it/s]online:  29%|██▊       | 18/63 [00:01<00:04,  9.49it/s]online:  30%|███       | 19/63 [00:01<00:04,  9.60it/s]online:  32%|███▏      | 20/63 [00:02<00:04,  9.49it/s]online:  33%|███▎      | 21/63 [00:02<00:04,  9.59it/s]online:  35%|███▍      | 22/63 [00:02<00:04,  9.54it/s]online:  37%|███▋      | 23/63 [00:02<00:04,  9.47it/s]online:  38%|███▊      | 24/63 [00:02<00:04,  9.50it/s]online:  40%|███▉      | 25/63 [00:02<00:04,  9.46it/s]online:  41%|████▏     | 26/63 [00:02<00:03,  9.59it/s]online:  43%|████▎     | 27/63 [00:02<00:03,  9.48it/s]online:  44%|████▍     | 28/63 [00:02<00:03,  9.52it/s]online:  46%|████▌     | 29/63 [00:03<00:03,  9.56it/s]online:  48%|████▊     | 30/63 [00:03<00:03,  9.55it/s]online:  49%|████▉     | 31/63 [00:03<00:03,  9.47it/s]online:  51%|█████     | 32/63 [00:03<00:03,  9.54it/s]online:  52%|█████▏    | 33/63 [00:03<00:03,  9.52it/s]online:  54%|█████▍    | 34/63 [00:03<00:03,  9.58it/s]online:  56%|█████▌    | 35/63 [00:03<00:02,  9.60it/s]online:  57%|█████▋    | 36/63 [00:03<00:02,  9.59it/s]online:  59%|█████▊    | 37/63 [00:03<00:02,  9.49it/s]online:  60%|██████    | 38/63 [00:03<00:02,  9.61it/s]online:  62%|██████▏   | 39/63 [00:04<00:02,  9.49it/s]online:  63%|██████▎   | 40/63 [00:04<00:02,  9.47it/s]online:  65%|██████▌   | 41/63 [00:04<00:02,  9.50it/s]online:  67%|██████▋   | 42/63 [00:04<00:02,  9.52it/s]online:  68%|██████▊   | 43/63 [00:04<00:02,  9.44it/s]online:  70%|██████▉   | 44/63 [00:04<00:01,  9.51it/s]online:  71%|███████▏  | 45/63 [00:04<00:01,  9.56it/s]online:  73%|███████▎  | 46/63 [00:04<00:01,  9.55it/s]online:  75%|███████▍  | 47/63 [00:04<00:01,  9.40it/s]online:  76%|███████▌  | 48/63 [00:05<00:01,  9.42it/s]online:  78%|███████▊  | 49/63 [00:05<00:01,  9.54it/s]online:  79%|███████▉  | 50/63 [00:05<00:01,  9.49it/s]online:  81%|████████  | 51/63 [00:05<00:01,  9.54it/s]online:  83%|████████▎ | 52/63 [00:05<00:01,  9.52it/s]online:  84%|████████▍ | 53/63 [00:05<00:01,  9.61it/s]online:  86%|████████▌ | 54/63 [00:05<00:00,  9.47it/s]online:  87%|████████▋ | 55/63 [00:05<00:00,  9.47it/s]online:  89%|████████▉ | 56/63 [00:05<00:00,  9.46it/s]online:  90%|█████████ | 57/63 [00:05<00:00,  9.52it/s]online:  92%|█████████▏| 58/63 [00:06<00:00,  9.50it/s]online:  94%|█████████▎| 59/63 [00:06<00:00,  9.49it/s]online:  95%|█████████▌| 60/63 [00:06<00:00,  9.49it/s]online:  97%|█████████▋| 61/63 [00:06<00:00,  9.54it/s]online:  98%|█████████▊| 62/63 [00:06<00:00,  9.52it/s]online: 100%|██████████| 63/63 [00:06<00:00,  9.54it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3004062:MainThread](2024-04-25 02:29:33,506) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9975087 mae 0.68597203
{'IC': 0.028441496398551678,
 'ICIR': 0.23361485235931148,
 'Rank IC': 0.023579509676170216,
 'Rank ICIR': 0.19894632220749242}
[3004062:MainThread](2024-04-25 02:29:35,375) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3004062:MainThread](2024-04-25 02:29:52,319) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 02:29:52,322) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 02:29:59,171) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8a4d222a30>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<02:30,  6.42it/s]backtest loop:   1%|          | 7/971 [00:00<01:10, 13.71it/s]backtest loop:   1%|          | 12/971 [00:00<00:44, 21.70it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:36, 26.24it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:32, 29.61it/s]backtest loop:   3%|▎         | 25/971 [00:01<00:30, 31.44it/s]backtest loop:   3%|▎         | 29/971 [00:01<00:29, 32.43it/s]backtest loop:   4%|▎         | 34/971 [00:01<00:26, 35.33it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:26, 35.81it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:24, 37.90it/s]backtest loop:   5%|▌         | 49/971 [00:01<00:24, 37.90it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:23, 39.48it/s]backtest loop:   6%|▌         | 59/971 [00:01<00:23, 38.58it/s]backtest loop:   6%|▋         | 63/971 [00:02<00:24, 37.68it/s]backtest loop:   7%|▋         | 67/971 [00:02<00:23, 38.21it/s]backtest loop:   7%|▋         | 72/971 [00:02<00:23, 37.48it/s]backtest loop:   8%|▊         | 77/971 [00:02<00:23, 38.11it/s]backtest loop:   8%|▊         | 82/971 [00:02<00:23, 37.78it/s]backtest loop:   9%|▉         | 87/971 [00:02<00:23, 37.71it/s]backtest loop:   9%|▉         | 92/971 [00:02<00:22, 39.43it/s]backtest loop:  10%|▉         | 97/971 [00:02<00:22, 39.15it/s]backtest loop:  11%|█         | 102/971 [00:03<00:21, 40.39it/s]backtest loop:  11%|█         | 107/971 [00:03<00:21, 39.51it/s]backtest loop:  12%|█▏        | 112/971 [00:03<00:22, 38.99it/s]backtest loop:  12%|█▏        | 117/971 [00:03<00:21, 40.22it/s]backtest loop:  13%|█▎        | 122/971 [00:03<00:21, 38.73it/s]backtest loop:  13%|█▎        | 126/971 [00:03<00:23, 36.19it/s]backtest loop:  13%|█▎        | 131/971 [00:03<00:23, 35.93it/s]backtest loop:  14%|█▍        | 136/971 [00:03<00:22, 36.99it/s]backtest loop:  15%|█▍        | 141/971 [00:04<00:22, 37.05it/s]backtest loop:  15%|█▍        | 145/971 [00:04<00:25, 32.23it/s]backtest loop:  15%|█▌        | 149/971 [00:04<00:35, 22.97it/s]backtest loop:  16%|█▌        | 152/971 [00:04<00:42, 19.13it/s]backtest loop:  16%|█▌        | 155/971 [00:04<00:43, 18.89it/s]backtest loop:  16%|█▋        | 158/971 [00:05<00:47, 17.01it/s]backtest loop:  17%|█▋        | 161/971 [00:05<00:46, 17.33it/s]backtest loop:  17%|█▋        | 163/971 [00:05<00:46, 17.49it/s]backtest loop:  17%|█▋        | 166/971 [00:05<00:47, 16.89it/s]backtest loop:  17%|█▋        | 169/971 [00:05<00:42, 18.85it/s]backtest loop:  18%|█▊        | 172/971 [00:05<00:46, 17.32it/s]backtest loop:  18%|█▊        | 175/971 [00:06<00:43, 18.39it/s]backtest loop:  18%|█▊        | 177/971 [00:06<00:46, 16.95it/s]backtest loop:  18%|█▊        | 179/971 [00:06<00:45, 17.56it/s]backtest loop:  19%|█▊        | 181/971 [00:06<00:47, 16.47it/s]backtest loop:  19%|█▉        | 183/971 [00:06<00:46, 16.98it/s]backtest loop:  19%|█▉        | 185/971 [00:06<00:48, 16.07it/s]backtest loop:  19%|█▉        | 188/971 [00:06<00:40, 19.32it/s]backtest loop:  20%|█▉        | 191/971 [00:07<00:43, 18.09it/s]backtest loop:  20%|█▉        | 194/971 [00:07<00:37, 20.73it/s]backtest loop:  20%|██        | 197/971 [00:07<00:39, 19.69it/s]backtest loop:  21%|██        | 200/971 [00:07<00:40, 18.91it/s]backtest loop:  21%|██        | 203/971 [00:07<00:38, 20.01it/s]backtest loop:  21%|██        | 206/971 [00:07<00:40, 18.69it/s]backtest loop:  22%|██▏       | 210/971 [00:08<00:38, 19.58it/s]backtest loop:  22%|██▏       | 213/971 [00:08<00:39, 19.14it/s]backtest loop:  22%|██▏       | 215/971 [00:08<00:41, 18.06it/s]backtest loop:  22%|██▏       | 218/971 [00:08<00:37, 20.16it/s]backtest loop:  23%|██▎       | 221/971 [00:08<00:38, 19.45it/s]backtest loop:  23%|██▎       | 224/971 [00:08<00:34, 21.57it/s]backtest loop:  23%|██▎       | 227/971 [00:08<00:36, 20.15it/s]backtest loop:  24%|██▎       | 230/971 [00:09<00:38, 19.40it/s]backtest loop:  24%|██▍       | 234/971 [00:09<00:34, 21.55it/s]backtest loop:  24%|██▍       | 237/971 [00:09<00:34, 21.04it/s]backtest loop:  25%|██▍       | 240/971 [00:09<00:31, 22.99it/s]backtest loop:  25%|██▌       | 245/971 [00:09<00:25, 28.90it/s]backtest loop:  26%|██▌       | 250/971 [00:09<00:21, 33.49it/s]backtest loop:  26%|██▋       | 255/971 [00:09<00:19, 36.73it/s]backtest loop:  27%|██▋       | 260/971 [00:09<00:18, 39.15it/s]backtest loop:  27%|██▋       | 265/971 [00:09<00:17, 41.06it/s]backtest loop:  28%|██▊       | 270/971 [00:10<00:16, 42.52it/s]backtest loop:  28%|██▊       | 275/971 [00:10<00:15, 43.64it/s]backtest loop:  29%|██▉       | 280/971 [00:10<00:15, 44.42it/s]backtest loop:  29%|██▉       | 285/971 [00:10<00:15, 44.73it/s]backtest loop:  30%|██▉       | 290/971 [00:10<00:15, 43.70it/s]backtest loop:  30%|███       | 295/971 [00:10<00:16, 41.29it/s]backtest loop:  31%|███       | 300/971 [00:10<00:15, 42.73it/s]backtest loop:  31%|███▏      | 305/971 [00:10<00:15, 42.40it/s]backtest loop:  32%|███▏      | 310/971 [00:10<00:14, 44.20it/s]backtest loop:  32%|███▏      | 315/971 [00:11<00:14, 44.57it/s]backtest loop:  33%|███▎      | 320/971 [00:11<00:14, 44.64it/s]backtest loop:  33%|███▎      | 325/971 [00:11<00:15, 42.76it/s]backtest loop:  34%|███▍      | 330/971 [00:11<00:14, 44.15it/s]backtest loop:  35%|███▍      | 335/971 [00:11<00:14, 44.09it/s]backtest loop:  35%|███▌      | 340/971 [00:11<00:14, 45.02it/s]backtest loop:  36%|███▌      | 345/971 [00:11<00:14, 44.55it/s]backtest loop:  36%|███▌      | 350/971 [00:11<00:13, 44.49it/s]backtest loop:  37%|███▋      | 355/971 [00:12<00:13, 44.30it/s]backtest loop:  37%|███▋      | 360/971 [00:12<00:13, 44.33it/s]backtest loop:  38%|███▊      | 365/971 [00:12<00:13, 44.64it/s]backtest loop:  38%|███▊      | 370/971 [00:12<00:14, 41.74it/s]backtest loop:  39%|███▊      | 375/971 [00:12<00:14, 42.57it/s]backtest loop:  39%|███▉      | 380/971 [00:12<00:13, 43.19it/s]backtest loop:  40%|███▉      | 385/971 [00:12<00:13, 43.49it/s]backtest loop:  40%|████      | 390/971 [00:12<00:13, 43.62it/s]backtest loop:  41%|████      | 395/971 [00:12<00:12, 44.96it/s]backtest loop:  41%|████▏     | 401/971 [00:13<00:11, 47.83it/s]backtest loop:  42%|████▏     | 407/971 [00:13<00:11, 50.51it/s]backtest loop:  43%|████▎     | 413/971 [00:13<00:11, 49.61it/s]backtest loop:  43%|████▎     | 419/971 [00:13<00:10, 52.25it/s]backtest loop:  44%|████▍     | 425/971 [00:13<00:10, 53.99it/s]backtest loop:  44%|████▍     | 431/971 [00:13<00:09, 55.68it/s]backtest loop:  45%|████▌     | 437/971 [00:13<00:10, 53.36it/s]backtest loop:  46%|████▌     | 443/971 [00:13<00:09, 54.74it/s]backtest loop:  46%|████▋     | 450/971 [00:13<00:09, 57.00it/s]backtest loop:  47%|████▋     | 456/971 [00:14<00:08, 57.48it/s]backtest loop:  48%|████▊     | 462/971 [00:14<00:09, 54.61it/s]backtest loop:  48%|████▊     | 468/971 [00:14<00:08, 55.89it/s]backtest loop:  49%|████▉     | 474/971 [00:14<00:08, 56.90it/s]backtest loop:  50%|████▉     | 481/971 [00:14<00:08, 59.33it/s]backtest loop:  50%|█████     | 487/971 [00:14<00:08, 56.30it/s]backtest loop:  51%|█████     | 493/971 [00:14<00:08, 57.21it/s]backtest loop:  51%|█████▏    | 500/971 [00:14<00:08, 55.81it/s]backtest loop:  52%|█████▏    | 507/971 [00:14<00:08, 55.09it/s]backtest loop:  53%|█████▎    | 514/971 [00:15<00:07, 57.19it/s]backtest loop:  54%|█████▎    | 521/971 [00:15<00:07, 58.47it/s]backtest loop:  54%|█████▍    | 527/971 [00:15<00:07, 55.58it/s]backtest loop:  55%|█████▍    | 534/971 [00:15<00:07, 57.81it/s]backtest loop:  56%|█████▌    | 541/971 [00:15<00:07, 55.88it/s]backtest loop:  56%|█████▋    | 548/971 [00:15<00:07, 57.71it/s]backtest loop:  57%|█████▋    | 554/971 [00:15<00:07, 58.25it/s]backtest loop:  58%|█████▊    | 560/971 [00:15<00:07, 58.49it/s]backtest loop:  58%|█████▊    | 566/971 [00:15<00:07, 54.57it/s]backtest loop:  59%|█████▉    | 572/971 [00:16<00:07, 55.85it/s]backtest loop:  60%|█████▉    | 578/971 [00:16<00:06, 56.87it/s]backtest loop:  60%|██████    | 584/971 [00:16<00:06, 57.71it/s]backtest loop:  61%|██████    | 590/971 [00:16<00:06, 58.29it/s]backtest loop:  61%|██████▏   | 596/971 [00:16<00:06, 55.14it/s]backtest loop:  62%|██████▏   | 602/971 [00:16<00:06, 56.37it/s]backtest loop:  63%|██████▎   | 608/971 [00:16<00:06, 57.25it/s]backtest loop:  63%|██████▎   | 614/971 [00:16<00:06, 57.79it/s]backtest loop:  64%|██████▍   | 620/971 [00:16<00:06, 54.49it/s]backtest loop:  65%|██████▍   | 627/971 [00:17<00:06, 56.86it/s]backtest loop:  65%|██████▌   | 633/971 [00:17<00:05, 57.63it/s]backtest loop:  66%|██████▌   | 639/971 [00:17<00:05, 58.05it/s]backtest loop:  66%|██████▋   | 645/971 [00:17<00:05, 54.73it/s]backtest loop:  67%|██████▋   | 651/971 [00:17<00:05, 56.09it/s]backtest loop:  68%|██████▊   | 658/971 [00:17<00:05, 58.01it/s]backtest loop:  68%|██████▊   | 664/971 [00:17<00:05, 58.55it/s]backtest loop:  69%|██████▉   | 670/971 [00:17<00:05, 55.46it/s]backtest loop:  70%|██████▉   | 676/971 [00:17<00:05, 56.56it/s]backtest loop:  70%|███████   | 682/971 [00:17<00:05, 57.44it/s]backtest loop:  71%|███████   | 688/971 [00:18<00:04, 57.54it/s]backtest loop:  71%|███████▏  | 694/971 [00:18<00:05, 54.68it/s]backtest loop:  72%|███████▏  | 701/971 [00:18<00:04, 56.41it/s]backtest loop:  73%|███████▎  | 708/971 [00:18<00:04, 58.17it/s]backtest loop:  74%|███████▎  | 714/971 [00:18<00:04, 55.35it/s]backtest loop:  74%|███████▍  | 720/971 [00:18<00:04, 56.32it/s]backtest loop:  75%|███████▍  | 727/971 [00:18<00:04, 58.14it/s]backtest loop:  75%|███████▌  | 733/971 [00:18<00:04, 52.32it/s]backtest loop:  76%|███████▌  | 739/971 [00:19<00:04, 53.96it/s]backtest loop:  77%|███████▋  | 745/971 [00:19<00:04, 55.58it/s]backtest loop:  77%|███████▋  | 751/971 [00:19<00:04, 54.01it/s]backtest loop:  78%|███████▊  | 757/971 [00:19<00:03, 55.65it/s]backtest loop:  79%|███████▊  | 764/971 [00:19<00:03, 57.64it/s]backtest loop:  79%|███████▉  | 770/971 [00:19<00:03, 55.16it/s]backtest loop:  80%|████████  | 777/971 [00:19<00:03, 58.04it/s]backtest loop:  81%|████████  | 783/971 [00:19<00:03, 56.11it/s]backtest loop:  81%|████████▏ | 790/971 [00:19<00:03, 58.11it/s]backtest loop:  82%|████████▏ | 797/971 [00:20<00:02, 59.38it/s]backtest loop:  83%|████████▎ | 803/971 [00:20<00:02, 56.28it/s]backtest loop:  83%|████████▎ | 809/971 [00:20<00:02, 57.19it/s]backtest loop:  84%|████████▍ | 816/971 [00:20<00:02, 58.87it/s]backtest loop:  85%|████████▍ | 822/971 [00:20<00:02, 59.13it/s]backtest loop:  85%|████████▌ | 828/971 [00:20<00:02, 55.99it/s]backtest loop:  86%|████████▌ | 834/971 [00:20<00:02, 57.07it/s]backtest loop:  87%|████████▋ | 840/971 [00:20<00:02, 57.64it/s]backtest loop:  87%|████████▋ | 846/971 [00:20<00:02, 58.30it/s]backtest loop:  88%|████████▊ | 852/971 [00:21<00:02, 55.28it/s]backtest loop:  88%|████████▊ | 858/971 [00:21<00:02, 56.23it/s]backtest loop:  89%|████████▉ | 865/971 [00:21<00:01, 58.23it/s]backtest loop:  90%|████████▉ | 871/971 [00:21<00:01, 58.33it/s]backtest loop:  90%|█████████ | 877/971 [00:21<00:01, 55.03it/s]backtest loop:  91%|█████████ | 883/971 [00:21<00:01, 56.37it/s]backtest loop:  92%|█████████▏| 889/971 [00:21<00:01, 57.31it/s]backtest loop:  92%|█████████▏| 895/971 [00:21<00:01, 57.96it/s]backtest loop:  93%|█████████▎| 901/971 [00:21<00:01, 58.36it/s]backtest loop:  93%|█████████▎| 907/971 [00:21<00:01, 55.18it/s]backtest loop:  94%|█████████▍| 913/971 [00:22<00:01, 56.52it/s]backtest loop:  95%|█████████▍| 919/971 [00:22<00:00, 57.20it/s]backtest loop:  95%|█████████▌| 925/971 [00:22<00:00, 57.58it/s]backtest loop:  96%|█████████▌| 931/971 [00:22<00:00, 53.79it/s]backtest loop:  96%|█████████▋| 937/971 [00:22<00:00, 55.38it/s]backtest loop:  97%|█████████▋| 943/971 [00:22<00:00, 55.48it/s]backtest loop:  98%|█████████▊| 949/971 [00:22<00:00, 55.99it/s]backtest loop:  98%|█████████▊| 955/971 [00:22<00:00, 53.10it/s]backtest loop:  99%|█████████▉| 962/971 [00:22<00:00, 55.78it/s]backtest loop: 100%|█████████▉| 968/971 [00:23<00:00, 56.91it/s]backtest loop: 100%|██████████| 971/971 [00:23<00:00, 41.99it/s]
[3004062:MainThread](2024-04-25 02:30:22,370) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000410
std                0.005100
annualized_return  0.097471
information_ratio  1.238746
max_drawdown      -0.144274
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000216
std                0.005102
annualized_return  0.051522
information_ratio  0.654583
max_drawdown      -0.162506
[3004062:MainThread](2024-04-25 02:30:22,386) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-25_01:25:15_online`.
Round 6 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06015972005648005,
                                                    0.03273059938414068,
                                                    0.05947816937582371,
                                                    0.0076356952206925776,
                                                    0.05119321329664117,
                                                    0.05152240617919004],
 '1day.excess_return_with_cost.information_ratio': [0.7679933092923739,
                                                    0.4133389026554145,
                                                    0.7636301919612586,
                                                    0.0978136867244855,
                                                    0.6747217921818092,
                                                    0.6545829389734713],
 '1day.excess_return_with_cost.max_drawdown': [-0.08670293338962837,
                                               -0.16197255475157407,
                                               -0.10150852344205823,
                                               -0.1665674035171944,
                                               -0.11355296002422188,
                                               -0.16250574143268212],
 'IC': [0.027040578141343165,
        0.02653395980121937,
        0.026817808553124933,
        0.02854324574140338,
        0.026814229044106942,
        0.028441496398551678],
 'ICIR': [0.22347151688066197,
          0.22642606515849942,
          0.24265733154989236,
          0.24787481021777158,
          0.22370551351917856,
          0.23361485235931148],
 'Rank IC': [0.023053889583337525,
             0.02273519521648915,
             0.022998778503316525,
             0.024537121375718042,
             0.024870332765134055,
             0.023579509676170216],
 'Rank ICIR': [0.19913024732178053,
               0.20377985954373565,
               0.21844485445366277,
               0.21715884654157896,
               0.21568508976946332,
               0.19894632220749242],
 'mae': [0.686060905456543,
         0.6859773397445679,
         0.6860173940658569,
         0.6859692335128784,
         0.6860255599021912,
         0.6859720349311829],
 'mse': [0.9976044297218323,
         0.9977508783340454,
         0.9977036714553833,
         0.9974674582481384,
         0.9975618124008179,
         0.997508704662323]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3004062:MainThread](2024-04-25 02:30:23,776) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3004062:MainThread](2024-04-25 02:30:23,776) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3004062:MainThread](2024-04-25 02:30:23,781) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3004062:MainThread](2024-04-25 02:30:23,781) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:13<21:42, 13.16s/it]epoch:   2%|▏         | 2/100 [00:26<21:21, 13.08s/it]epoch:   3%|▎         | 3/100 [00:38<20:54, 12.94s/it]epoch:   4%|▍         | 4/100 [00:51<20:45, 12.97s/it]epoch:   5%|▌         | 5/100 [01:04<20:18, 12.83s/it]epoch:   6%|▌         | 6/100 [01:20<21:41, 13.85s/it]epoch:   7%|▋         | 7/100 [01:34<21:36, 13.94s/it]epoch:   8%|▊         | 8/100 [01:47<20:58, 13.68s/it]epoch:   9%|▉         | 9/100 [02:00<20:16, 13.37s/it]epoch:  10%|█         | 10/100 [02:12<19:40, 13.11s/it]epoch:  11%|█         | 11/100 [02:25<19:22, 13.06s/it]epoch:  12%|█▏        | 12/100 [02:38<18:54, 12.90s/it]epoch:  13%|█▎        | 13/100 [02:50<18:30, 12.76s/it]epoch:  14%|█▍        | 14/100 [03:05<19:12, 13.40s/it]epoch:  15%|█▌        | 15/100 [03:18<18:56, 13.37s/it]epoch:  16%|█▌        | 16/100 [03:31<18:16, 13.05s/it]epoch:  17%|█▋        | 17/100 [03:43<17:46, 12.85s/it]epoch:  18%|█▊        | 18/100 [03:56<17:31, 12.82s/it]epoch:  19%|█▉        | 19/100 [04:09<17:19, 12.83s/it]epoch:  20%|██        | 20/100 [04:21<16:56, 12.71s/it]epoch:  21%|██        | 21/100 [04:34<16:40, 12.67s/it]epoch:  22%|██▏       | 22/100 [04:48<17:07, 13.17s/it]epoch:  23%|██▎       | 23/100 [05:01<16:50, 13.13s/it]epoch:  24%|██▍       | 24/100 [05:14<16:31, 13.05s/it]epoch:  25%|██▌       | 25/100 [05:26<16:05, 12.88s/it]epoch:  26%|██▌       | 26/100 [05:39<15:42, 12.73s/it]epoch:  27%|██▋       | 27/100 [05:52<15:28, 12.71s/it]epoch:  28%|██▊       | 28/100 [06:04<15:20, 12.78s/it]epoch:  29%|██▉       | 29/100 [06:18<15:16, 12.90s/it]epoch:  30%|███       | 30/100 [06:31<15:17, 13.10s/it]0.054318894506832575
best ic: 0.054318894506832575
epoch:  31%|███       | 31/100 [06:45<15:25, 13.42s/it]0.05081796464303241
epoch:  32%|███▏      | 32/100 [07:00<15:33, 13.73s/it]0.05178733331372192
epoch:  33%|███▎      | 33/100 [07:15<15:42, 14.07s/it]0.05187735264835174
epoch:  34%|███▍      | 34/100 [07:29<15:29, 14.08s/it]0.05165841136965626
epoch:  35%|███▌      | 35/100 [07:43<15:16, 14.10s/it]0.05169459211281349
epoch:  36%|███▌      | 36/100 [07:58<15:18, 14.36s/it]0.053045080156864446
epoch:  37%|███▋      | 37/100 [08:13<15:27, 14.72s/it]0.05402233208247653
epoch:  38%|███▊      | 38/100 [08:28<15:07, 14.64s/it]0.05195117034919744
epoch:  38%|███▊      | 38/100 [08:42<14:12, 13.75s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3004062:MainThread](2024-04-25 02:39:06,357) INFO - qlib.workflow - [exp.py:258] - Experiment 47 starts running ...
[3004062:MainThread](2024-04-25 02:39:06,369) INFO - qlib.workflow - [recorder.py:341] - Recorder a9fba5506abe4cfaa1eb62bf81208b3f starts running under Experiment 47 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:06, 10.03it/s]online:   6%|▋         | 4/63 [00:00<00:06,  9.66it/s]online:   8%|▊         | 5/63 [00:00<00:06,  9.54it/s]online:  10%|▉         | 6/63 [00:00<00:05,  9.54it/s]online:  11%|█         | 7/63 [00:00<00:05,  9.58it/s]online:  13%|█▎        | 8/63 [00:00<00:05,  9.47it/s]online:  14%|█▍        | 9/63 [00:00<00:05,  9.47it/s]online:  16%|█▌        | 10/63 [00:01<00:05,  9.52it/s]online:  17%|█▋        | 11/63 [00:01<00:05,  9.47it/s]online:  19%|█▉        | 12/63 [00:01<00:05,  9.49it/s]online:  21%|██        | 13/63 [00:01<00:05,  9.51it/s]online:  22%|██▏       | 14/63 [00:01<00:05,  9.56it/s]online:  24%|██▍       | 15/63 [00:01<00:05,  9.40it/s]online:  25%|██▌       | 16/63 [00:01<00:04,  9.45it/s]online:  27%|██▋       | 17/63 [00:01<00:04,  9.53it/s]online:  29%|██▊       | 18/63 [00:01<00:04,  9.54it/s]online:  30%|███       | 19/63 [00:01<00:04,  9.56it/s]online:  32%|███▏      | 20/63 [00:02<00:04,  9.54it/s]online:  33%|███▎      | 21/63 [00:02<00:04,  9.61it/s]online:  35%|███▍      | 22/63 [00:02<00:04,  9.53it/s]online:  37%|███▋      | 23/63 [00:02<00:04,  9.53it/s]online:  38%|███▊      | 24/63 [00:02<00:04,  9.52it/s]online:  40%|███▉      | 25/63 [00:02<00:03,  9.51it/s]online:  41%|████▏     | 26/63 [00:02<00:03,  9.50it/s]online:  43%|████▎     | 27/63 [00:02<00:03,  9.42it/s]online:  44%|████▍     | 28/63 [00:02<00:03,  9.54it/s]online:  46%|████▌     | 29/63 [00:03<00:03,  9.39it/s]online:  48%|████▊     | 30/63 [00:03<00:03,  9.45it/s]online:  49%|████▉     | 31/63 [00:03<00:03,  9.52it/s]online:  51%|█████     | 32/63 [00:03<00:03,  9.50it/s]online:  52%|█████▏    | 33/63 [00:03<00:03,  9.57it/s]online:  54%|█████▍    | 34/63 [00:03<00:03,  9.47it/s]online:  56%|█████▌    | 35/63 [00:03<00:02,  9.46it/s]online:  57%|█████▋    | 36/63 [00:03<00:02,  9.51it/s]online:  59%|█████▊    | 37/63 [00:03<00:02,  9.61it/s]online:  60%|██████    | 38/63 [00:03<00:02,  9.55it/s]online:  62%|██████▏   | 39/63 [00:04<00:02,  9.50it/s]online:  63%|██████▎   | 40/63 [00:04<00:02,  9.57it/s]online:  65%|██████▌   | 41/63 [00:04<00:02,  9.48it/s]online:  67%|██████▋   | 42/63 [00:04<00:02,  9.56it/s]online:  68%|██████▊   | 43/63 [00:04<00:02,  9.50it/s]online:  70%|██████▉   | 44/63 [00:04<00:02,  9.47it/s]online:  71%|███████▏  | 45/63 [00:04<00:01,  9.57it/s]online:  73%|███████▎  | 46/63 [00:04<00:01,  9.49it/s]online:  75%|███████▍  | 47/63 [00:04<00:01,  9.46it/s]online:  76%|███████▌  | 48/63 [00:05<00:01,  9.54it/s]online:  78%|███████▊  | 49/63 [00:05<00:01,  9.61it/s]online:  79%|███████▉  | 50/63 [00:05<00:01,  9.50it/s]online:  81%|████████  | 51/63 [00:05<00:01,  9.52it/s]online:  83%|████████▎ | 52/63 [00:05<00:01,  9.55it/s]online:  84%|████████▍ | 53/63 [00:05<00:01,  9.54it/s]online:  86%|████████▌ | 54/63 [00:05<00:00,  9.42it/s]online:  87%|████████▋ | 55/63 [00:05<00:00,  9.48it/s]online:  89%|████████▉ | 56/63 [00:05<00:00,  9.33it/s]online:  90%|█████████ | 57/63 [00:05<00:00,  9.45it/s]online:  92%|█████████▏| 58/63 [00:06<00:00,  9.35it/s]online:  94%|█████████▎| 59/63 [00:06<00:00,  9.46it/s]online:  95%|█████████▌| 60/63 [00:06<00:00,  9.46it/s]online:  97%|█████████▋| 61/63 [00:06<00:00,  9.39it/s]online:  98%|█████████▊| 62/63 [00:06<00:00,  9.47it/s]online: 100%|██████████| 63/63 [00:06<00:00,  9.52it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3004062:MainThread](2024-04-25 02:39:23,389) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99783385 mae 0.6861683
{'IC': 0.024732389642783594,
 'ICIR': 0.214673256268981,
 'Rank IC': 0.019972407900258712,
 'Rank ICIR': 0.17740286536494682}
[3004062:MainThread](2024-04-25 02:39:25,342) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3004062:MainThread](2024-04-25 02:39:42,231) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 02:39:42,234) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 02:39:48,474) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8a52046f70>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:53,  8.53it/s]backtest loop:   1%|          | 8/971 [00:00<00:47, 20.47it/s]backtest loop:   1%|▏         | 14/971 [00:00<00:30, 31.19it/s]backtest loop:   2%|▏         | 20/971 [00:00<00:24, 38.50it/s]backtest loop:   3%|▎         | 25/971 [00:00<00:24, 39.41it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:21, 43.85it/s]backtest loop:   4%|▍         | 37/971 [00:01<00:19, 46.83it/s]backtest loop:   4%|▍         | 43/971 [00:01<00:18, 49.43it/s]backtest loop:   5%|▌         | 49/971 [00:01<00:19, 47.66it/s]backtest loop:   6%|▌         | 55/971 [00:01<00:18, 49.74it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:17, 51.18it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:18, 49.67it/s]backtest loop:   8%|▊         | 73/971 [00:01<00:17, 51.61it/s]backtest loop:   8%|▊         | 79/971 [00:01<00:16, 52.60it/s]backtest loop:   9%|▉         | 85/971 [00:01<00:16, 53.29it/s]backtest loop:   9%|▉         | 91/971 [00:02<00:16, 54.22it/s]backtest loop:  10%|▉         | 97/971 [00:02<00:17, 50.68it/s]backtest loop:  11%|█         | 103/971 [00:02<00:16, 53.16it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:15, 56.13it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:15, 54.29it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:15, 55.80it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:15, 52.95it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 52.38it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:15, 55.05it/s]backtest loop:  15%|█▌        | 149/971 [00:03<00:15, 54.65it/s]backtest loop:  16%|█▌        | 156/971 [00:03<00:15, 53.66it/s]backtest loop:  17%|█▋        | 162/971 [00:03<00:14, 55.22it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:14, 56.29it/s]backtest loop:  18%|█▊        | 174/971 [00:03<00:13, 57.22it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:14, 55.51it/s]backtest loop:  19%|█▉        | 187/971 [00:03<00:13, 56.53it/s]backtest loop:  20%|█▉        | 194/971 [00:03<00:13, 58.48it/s]backtest loop:  21%|██        | 200/971 [00:04<00:13, 55.29it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:13, 57.58it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:13, 55.10it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 54.23it/s]backtest loop:  23%|██▎       | 226/971 [00:04<00:13, 55.58it/s]backtest loop:  24%|██▍       | 232/971 [00:04<00:13, 56.02it/s]backtest loop:  25%|██▍       | 238/971 [00:04<00:12, 56.92it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 57.64it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:13, 54.75it/s]backtest loop:  26%|██▋       | 256/971 [00:05<00:12, 56.18it/s]backtest loop:  27%|██▋       | 262/971 [00:05<00:12, 56.95it/s]backtest loop:  28%|██▊       | 268/971 [00:05<00:12, 54.41it/s]backtest loop:  28%|██▊       | 274/971 [00:05<00:12, 55.90it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:12, 57.04it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 54.41it/s]backtest loop:  30%|███       | 293/971 [00:05<00:11, 56.73it/s]backtest loop:  31%|███       | 299/971 [00:05<00:11, 57.40it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:12, 54.74it/s]backtest loop:  32%|███▏      | 311/971 [00:06<00:11, 55.23it/s]backtest loop:  33%|███▎      | 317/971 [00:06<00:11, 56.50it/s]backtest loop:  33%|███▎      | 323/971 [00:06<00:11, 57.35it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:11, 55.24it/s]backtest loop:  35%|███▍      | 336/971 [00:06<00:11, 53.51it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:11, 52.53it/s]backtest loop:  36%|███▌      | 348/971 [00:06<00:12, 51.75it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:11, 52.47it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:11, 51.62it/s]backtest loop:  38%|███▊      | 367/971 [00:07<00:11, 51.77it/s]backtest loop:  38%|███▊      | 373/971 [00:07<00:11, 50.82it/s]backtest loop:  39%|███▉      | 379/971 [00:07<00:11, 52.61it/s]backtest loop:  40%|███▉      | 385/971 [00:07<00:10, 54.38it/s]backtest loop:  40%|████      | 391/971 [00:07<00:10, 55.05it/s]backtest loop:  41%|████      | 397/971 [00:07<00:10, 56.32it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 53.28it/s]backtest loop:  42%|████▏     | 409/971 [00:07<00:10, 54.83it/s]backtest loop:  43%|████▎     | 415/971 [00:07<00:09, 55.80it/s]backtest loop:  43%|████▎     | 421/971 [00:08<00:09, 56.06it/s]backtest loop:  44%|████▍     | 427/971 [00:08<00:09, 56.56it/s]backtest loop:  45%|████▍     | 433/971 [00:08<00:09, 53.84it/s]backtest loop:  45%|████▌     | 439/971 [00:08<00:09, 55.10it/s]backtest loop:  46%|████▌     | 445/971 [00:08<00:09, 56.14it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:09, 56.97it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:09, 53.71it/s]backtest loop:  48%|████▊     | 463/971 [00:08<00:09, 55.25it/s]backtest loop:  48%|████▊     | 469/971 [00:08<00:08, 56.17it/s]backtest loop:  49%|████▉     | 475/971 [00:09<00:08, 57.12it/s]backtest loop:  50%|████▉     | 482/971 [00:09<00:08, 56.29it/s]backtest loop:  50%|█████     | 488/971 [00:09<00:08, 56.49it/s]backtest loop:  51%|█████     | 494/971 [00:09<00:08, 57.36it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 54.29it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 53.73it/s]backtest loop:  53%|█████▎    | 513/971 [00:09<00:08, 55.14it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:08, 55.03it/s]backtest loop:  54%|█████▍    | 525/971 [00:09<00:08, 55.36it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 53.19it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:07, 54.84it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:07, 55.03it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 53.60it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 53.37it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:08, 49.50it/s]backtest loop:  58%|█████▊    | 567/971 [00:10<00:08, 50.22it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:08, 49.01it/s]backtest loop:  60%|█████▉    | 578/971 [00:11<00:08, 44.75it/s]backtest loop:  60%|██████    | 583/971 [00:11<00:08, 43.35it/s]backtest loop:  61%|██████    | 588/971 [00:11<00:08, 43.70it/s]backtest loop:  61%|██████    | 593/971 [00:11<00:08, 43.00it/s]backtest loop:  62%|██████▏   | 598/971 [00:11<00:08, 42.42it/s]backtest loop:  62%|██████▏   | 603/971 [00:11<00:08, 42.91it/s]backtest loop:  63%|██████▎   | 608/971 [00:11<00:08, 40.99it/s]backtest loop:  63%|██████▎   | 613/971 [00:11<00:08, 41.92it/s]backtest loop:  64%|██████▎   | 618/971 [00:11<00:08, 40.56it/s]backtest loop:  64%|██████▍   | 623/971 [00:12<00:08, 41.50it/s]backtest loop:  65%|██████▍   | 628/971 [00:12<00:08, 42.30it/s]backtest loop:  65%|██████▌   | 633/971 [00:12<00:08, 41.86it/s]backtest loop:  66%|██████▌   | 638/971 [00:12<00:07, 42.95it/s]backtest loop:  66%|██████▌   | 643/971 [00:12<00:07, 41.55it/s]backtest loop:  67%|██████▋   | 648/971 [00:12<00:07, 42.63it/s]backtest loop:  67%|██████▋   | 653/971 [00:12<00:07, 41.54it/s]backtest loop:  68%|██████▊   | 658/971 [00:12<00:07, 42.32it/s]backtest loop:  68%|██████▊   | 663/971 [00:13<00:07, 41.42it/s]backtest loop:  69%|██████▉   | 668/971 [00:13<00:07, 42.52it/s]backtest loop:  69%|██████▉   | 673/971 [00:13<00:07, 41.74it/s]backtest loop:  70%|██████▉   | 678/971 [00:13<00:06, 42.53it/s]backtest loop:  70%|███████   | 683/971 [00:13<00:06, 42.61it/s]backtest loop:  71%|███████   | 688/971 [00:13<00:06, 42.21it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:06, 42.95it/s]backtest loop:  72%|███████▏  | 698/971 [00:13<00:06, 41.65it/s]backtest loop:  72%|███████▏  | 703/971 [00:13<00:06, 43.05it/s]backtest loop:  73%|███████▎  | 708/971 [00:14<00:06, 41.70it/s]backtest loop:  73%|███████▎  | 713/971 [00:14<00:05, 43.00it/s]backtest loop:  74%|███████▍  | 718/971 [00:14<00:06, 41.66it/s]backtest loop:  74%|███████▍  | 723/971 [00:14<00:05, 41.76it/s]backtest loop:  75%|███████▍  | 728/971 [00:14<00:05, 41.64it/s]backtest loop:  75%|███████▌  | 733/971 [00:14<00:06, 36.47it/s]backtest loop:  76%|███████▌  | 738/971 [00:14<00:06, 38.43it/s]backtest loop:  77%|███████▋  | 743/971 [00:15<00:05, 38.44it/s]backtest loop:  77%|███████▋  | 748/971 [00:15<00:05, 38.91it/s]backtest loop:  78%|███████▊  | 753/971 [00:15<00:05, 40.48it/s]backtest loop:  78%|███████▊  | 758/971 [00:15<00:05, 40.60it/s]backtest loop:  79%|███████▊  | 763/971 [00:15<00:04, 41.80it/s]backtest loop:  79%|███████▉  | 768/971 [00:15<00:04, 42.80it/s]backtest loop:  80%|███████▉  | 773/971 [00:15<00:04, 43.73it/s]backtest loop:  80%|████████  | 778/971 [00:15<00:04, 44.55it/s]backtest loop:  81%|████████  | 783/971 [00:15<00:04, 43.17it/s]backtest loop:  81%|████████  | 788/971 [00:16<00:04, 43.06it/s]backtest loop:  82%|████████▏ | 793/971 [00:16<00:04, 42.91it/s]backtest loop:  82%|████████▏ | 798/971 [00:16<00:04, 43.24it/s]backtest loop:  83%|████████▎ | 803/971 [00:16<00:03, 43.03it/s]backtest loop:  83%|████████▎ | 808/971 [00:16<00:03, 43.72it/s]backtest loop:  84%|████████▎ | 813/971 [00:16<00:03, 42.39it/s]backtest loop:  84%|████████▍ | 818/971 [00:16<00:03, 43.88it/s]backtest loop:  85%|████████▍ | 823/971 [00:16<00:03, 42.30it/s]backtest loop:  85%|████████▌ | 828/971 [00:16<00:03, 43.39it/s]backtest loop:  86%|████████▌ | 833/971 [00:17<00:03, 42.30it/s]backtest loop:  86%|████████▋ | 838/971 [00:17<00:03, 41.89it/s]backtest loop:  87%|████████▋ | 843/971 [00:17<00:03, 42.60it/s]backtest loop:  87%|████████▋ | 848/971 [00:17<00:02, 41.93it/s]backtest loop:  88%|████████▊ | 853/971 [00:17<00:02, 42.46it/s]backtest loop:  88%|████████▊ | 858/971 [00:17<00:02, 42.29it/s]backtest loop:  89%|████████▉ | 863/971 [00:17<00:02, 41.71it/s]backtest loop:  89%|████████▉ | 868/971 [00:17<00:02, 43.21it/s]backtest loop:  90%|████████▉ | 873/971 [00:18<00:02, 42.65it/s]backtest loop:  90%|█████████ | 878/971 [00:18<00:02, 43.36it/s]backtest loop:  91%|█████████ | 883/971 [00:18<00:02, 42.85it/s]backtest loop:  91%|█████████▏| 888/971 [00:18<00:01, 41.99it/s]backtest loop:  92%|█████████▏| 893/971 [00:18<00:01, 42.60it/s]backtest loop:  92%|█████████▏| 898/971 [00:18<00:01, 42.49it/s]backtest loop:  93%|█████████▎| 903/971 [00:18<00:01, 42.38it/s]backtest loop:  94%|█████████▎| 908/971 [00:18<00:01, 43.39it/s]backtest loop:  94%|█████████▍| 913/971 [00:18<00:01, 43.10it/s]backtest loop:  95%|█████████▍| 918/971 [00:19<00:01, 43.76it/s]backtest loop:  95%|█████████▌| 923/971 [00:19<00:01, 43.28it/s]backtest loop:  96%|█████████▌| 928/971 [00:19<00:01, 42.67it/s]backtest loop:  96%|█████████▌| 933/971 [00:19<00:00, 42.34it/s]backtest loop:  97%|█████████▋| 938/971 [00:19<00:00, 42.95it/s]backtest loop:  97%|█████████▋| 943/971 [00:19<00:00, 42.14it/s]backtest loop:  98%|█████████▊| 948/971 [00:19<00:00, 42.45it/s]backtest loop:  98%|█████████▊| 953/971 [00:19<00:00, 41.93it/s]backtest loop:  99%|█████████▊| 958/971 [00:20<00:00, 42.17it/s]backtest loop:  99%|█████████▉| 963/971 [00:20<00:00, 42.16it/s]backtest loop: 100%|█████████▉| 968/971 [00:20<00:00, 43.02it/s]backtest loop: 100%|██████████| 971/971 [00:20<00:00, 47.74it/s]
[3004062:MainThread](2024-04-25 02:40:08,906) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000306
std                0.005258
annualized_return  0.072810
information_ratio  0.897533
max_drawdown      -0.096956
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000112
std                0.005260
annualized_return  0.026767
information_ratio  0.329882
max_drawdown      -0.124190
[3004062:MainThread](2024-04-25 02:40:08,929) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-25_01:25:15_online`.
Round 7 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06015972005648005,
                                                    0.03273059938414068,
                                                    0.05947816937582371,
                                                    0.0076356952206925776,
                                                    0.05119321329664117,
                                                    0.05152240617919004,
                                                    0.026766665197175268],
 '1day.excess_return_with_cost.information_ratio': [0.7679933092923739,
                                                    0.4133389026554145,
                                                    0.7636301919612586,
                                                    0.0978136867244855,
                                                    0.6747217921818092,
                                                    0.6545829389734713,
                                                    0.3298821485447942],
 '1day.excess_return_with_cost.max_drawdown': [-0.08670293338962837,
                                               -0.16197255475157407,
                                               -0.10150852344205823,
                                               -0.1665674035171944,
                                               -0.11355296002422188,
                                               -0.16250574143268212,
                                               -0.12418988691040042],
 'IC': [0.027040578141343165,
        0.02653395980121937,
        0.026817808553124933,
        0.02854324574140338,
        0.026814229044106942,
        0.028441496398551678,
        0.024732389642783594],
 'ICIR': [0.22347151688066197,
          0.22642606515849942,
          0.24265733154989236,
          0.24787481021777158,
          0.22370551351917856,
          0.23361485235931148,
          0.214673256268981],
 'Rank IC': [0.023053889583337525,
             0.02273519521648915,
             0.022998778503316525,
             0.024537121375718042,
             0.024870332765134055,
             0.023579509676170216,
             0.019972407900258712],
 'Rank ICIR': [0.19913024732178053,
               0.20377985954373565,
               0.21844485445366277,
               0.21715884654157896,
               0.21568508976946332,
               0.19894632220749242,
               0.17740286536494682],
 'mae': [0.686060905456543,
         0.6859773397445679,
         0.6860173940658569,
         0.6859692335128784,
         0.6860255599021912,
         0.6859720349311829,
         0.6861683130264282],
 'mse': [0.9976044297218323,
         0.9977508783340454,
         0.9977036714553833,
         0.9974674582481384,
         0.9975618124008179,
         0.997508704662323,
         0.9978338479995728]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3004062:MainThread](2024-04-25 02:40:10,790) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3004062:MainThread](2024-04-25 02:40:10,790) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3004062:MainThread](2024-04-25 02:40:10,793) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3004062:MainThread](2024-04-25 02:40:10,793) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:13<21:57, 13.31s/it]epoch:   2%|▏         | 2/100 [00:26<21:26, 13.13s/it]epoch:   3%|▎         | 3/100 [00:39<21:07, 13.06s/it]epoch:   4%|▍         | 4/100 [00:51<20:36, 12.88s/it]epoch:   5%|▌         | 5/100 [01:04<20:29, 12.94s/it]epoch:   6%|▌         | 6/100 [01:17<20:02, 12.79s/it]epoch:   7%|▋         | 7/100 [01:31<20:23, 13.16s/it]epoch:   8%|▊         | 8/100 [01:45<20:34, 13.42s/it]epoch:   9%|▉         | 9/100 [01:58<20:02, 13.21s/it]epoch:  10%|█         | 10/100 [02:11<19:40, 13.12s/it]epoch:  11%|█         | 11/100 [02:23<19:07, 12.89s/it]epoch:  12%|█▏        | 12/100 [02:36<18:49, 12.83s/it]epoch:  13%|█▎        | 13/100 [02:48<18:37, 12.85s/it]epoch:  14%|█▍        | 14/100 [03:01<18:13, 12.72s/it]epoch:  15%|█▌        | 15/100 [03:14<18:00, 12.72s/it]epoch:  16%|█▌        | 16/100 [03:27<17:54, 12.80s/it]epoch:  17%|█▋        | 17/100 [03:39<17:39, 12.76s/it]epoch:  18%|█▊        | 18/100 [03:52<17:19, 12.68s/it]epoch:  19%|█▉        | 19/100 [04:04<17:00, 12.60s/it]epoch:  20%|██        | 20/100 [04:17<16:52, 12.65s/it]epoch:  21%|██        | 21/100 [04:30<16:44, 12.71s/it]epoch:  22%|██▏       | 22/100 [04:42<16:28, 12.67s/it]epoch:  23%|██▎       | 23/100 [04:55<16:12, 12.64s/it]epoch:  24%|██▍       | 24/100 [05:07<15:56, 12.59s/it]epoch:  25%|██▌       | 25/100 [05:20<15:49, 12.66s/it]epoch:  26%|██▌       | 26/100 [05:33<15:44, 12.77s/it]epoch:  27%|██▋       | 27/100 [05:46<15:28, 12.71s/it]epoch:  28%|██▊       | 28/100 [05:58<15:11, 12.65s/it]epoch:  29%|██▉       | 29/100 [06:11<14:56, 12.63s/it]epoch:  30%|███       | 30/100 [06:24<14:47, 12.68s/it]0.05656930949629198
best ic: 0.05656930949629198
epoch:  31%|███       | 31/100 [06:38<15:15, 13.27s/it]0.0596830478953333
best ic: 0.0596830478953333
epoch:  32%|███▏      | 32/100 [06:53<15:22, 13.57s/it]0.05566864623751896
epoch:  33%|███▎      | 33/100 [07:07<15:20, 13.74s/it]0.060005723809232796
best ic: 0.060005723809232796
epoch:  34%|███▍      | 34/100 [07:21<15:17, 13.89s/it]0.0625175994099212
best ic: 0.0625175994099212
epoch:  35%|███▌      | 35/100 [07:36<15:19, 14.15s/it]0.060218647328641746
epoch:  36%|███▌      | 36/100 [07:50<15:14, 14.30s/it]0.05817206926828073
epoch:  37%|███▋      | 37/100 [08:05<14:58, 14.26s/it]0.05846730416089084
epoch:  38%|███▊      | 38/100 [08:19<14:40, 14.20s/it]0.05846410166036565
epoch:  39%|███▉      | 39/100 [08:33<14:30, 14.26s/it]0.05935145793268442
epoch:  40%|████      | 40/100 [08:48<14:22, 14.38s/it]0.058752388053988844
epoch:  41%|████      | 41/100 [09:02<14:03, 14.30s/it]0.05875486935492584
epoch:  42%|████▏     | 42/100 [09:16<13:48, 14.28s/it]0.05984133142362418
epoch:  42%|████▏     | 42/100 [09:31<13:08, 13.60s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3004062:MainThread](2024-04-25 02:49:41,828) INFO - qlib.workflow - [exp.py:258] - Experiment 47 starts running ...
[3004062:MainThread](2024-04-25 02:49:41,842) INFO - qlib.workflow - [recorder.py:341] - Recorder 9ce15b917e584e579bfeac90fcd24752 starts running under Experiment 47 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:05, 10.18it/s]online:   6%|▋         | 4/63 [00:00<00:06,  9.63it/s]online:   8%|▊         | 5/63 [00:00<00:06,  9.60it/s]online:  10%|▉         | 6/63 [00:00<00:06,  9.48it/s]online:  11%|█         | 7/63 [00:00<00:05,  9.55it/s]online:  13%|█▎        | 8/63 [00:00<00:05,  9.41it/s]online:  14%|█▍        | 9/63 [00:00<00:05,  9.27it/s]online:  16%|█▌        | 10/63 [00:01<00:05,  9.38it/s]online:  17%|█▋        | 11/63 [00:01<00:05,  9.37it/s]online:  19%|█▉        | 12/63 [00:01<00:05,  9.32it/s]online:  21%|██        | 13/63 [00:01<00:05,  9.42it/s]online:  22%|██▏       | 14/63 [00:01<00:05,  9.45it/s]online:  24%|██▍       | 15/63 [00:01<00:05,  9.43it/s]online:  25%|██▌       | 16/63 [00:01<00:04,  9.41it/s]online:  27%|██▋       | 17/63 [00:01<00:04,  9.50it/s]online:  29%|██▊       | 18/63 [00:01<00:04,  9.36it/s]online:  30%|███       | 19/63 [00:02<00:04,  9.54it/s]online:  32%|███▏      | 20/63 [00:02<00:04,  9.54it/s]online:  33%|███▎      | 21/63 [00:02<00:04,  9.54it/s]online:  35%|███▍      | 22/63 [00:02<00:04,  9.54it/s]online:  37%|███▋      | 23/63 [00:02<00:04,  9.49it/s]online:  38%|███▊      | 24/63 [00:02<00:04,  9.47it/s]online:  40%|███▉      | 25/63 [00:02<00:04,  9.44it/s]online:  41%|████▏     | 26/63 [00:02<00:03,  9.42it/s]online:  43%|████▎     | 27/63 [00:02<00:03,  9.48it/s]online:  44%|████▍     | 28/63 [00:02<00:03,  9.53it/s]online:  46%|████▌     | 29/63 [00:03<00:03,  9.38it/s]online:  48%|████▊     | 30/63 [00:03<00:03,  9.35it/s]online:  49%|████▉     | 31/63 [00:03<00:03,  9.42it/s]online:  51%|█████     | 32/63 [00:03<00:03,  9.30it/s]online:  52%|█████▏    | 33/63 [00:03<00:03,  9.30it/s]online:  56%|█████▌    | 35/63 [00:03<00:02,  9.57it/s]online:  57%|█████▋    | 36/63 [00:03<00:02,  9.46it/s]online:  59%|█████▊    | 37/63 [00:03<00:02,  9.44it/s]online:  60%|██████    | 38/63 [00:04<00:02,  9.35it/s]online:  62%|██████▏   | 39/63 [00:04<00:02,  9.31it/s]online:  63%|██████▎   | 40/63 [00:04<00:02,  9.46it/s]online:  65%|██████▌   | 41/63 [00:04<00:02,  9.42it/s]online:  67%|██████▋   | 42/63 [00:04<00:02,  9.46it/s]online:  68%|██████▊   | 43/63 [00:04<00:02,  9.33it/s]online:  70%|██████▉   | 44/63 [00:04<00:02,  9.48it/s]online:  71%|███████▏  | 45/63 [00:04<00:01,  9.46it/s]online:  73%|███████▎  | 46/63 [00:04<00:01,  9.46it/s]online:  75%|███████▍  | 47/63 [00:04<00:01,  9.40it/s]online:  76%|███████▌  | 48/63 [00:05<00:01,  9.46it/s]online:  78%|███████▊  | 49/63 [00:05<00:01,  9.52it/s]online:  79%|███████▉  | 50/63 [00:05<00:01,  9.38it/s]online:  81%|████████  | 51/63 [00:05<00:01,  9.51it/s]online:  83%|████████▎ | 52/63 [00:05<00:01,  9.28it/s]online:  84%|████████▍ | 53/63 [00:05<00:01,  9.37it/s]online:  86%|████████▌ | 54/63 [00:05<00:00,  9.37it/s]online:  87%|████████▋ | 55/63 [00:05<00:00,  9.35it/s]online:  89%|████████▉ | 56/63 [00:05<00:00,  9.33it/s]online:  90%|█████████ | 57/63 [00:06<00:00,  8.85it/s]online:  92%|█████████▏| 58/63 [00:06<00:00,  8.86it/s]online:  94%|█████████▎| 59/63 [00:06<00:00,  8.77it/s]online:  95%|█████████▌| 60/63 [00:06<00:00,  8.84it/s]online:  97%|█████████▋| 61/63 [00:06<00:00,  9.03it/s]online:  98%|█████████▊| 62/63 [00:06<00:00,  9.05it/s]online: 100%|██████████| 63/63 [00:06<00:00,  9.38it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3004062:MainThread](2024-04-25 02:50:01,703) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9976095 mae 0.68604684
{'IC': 0.02674986454272586,
 'ICIR': 0.2361810357877373,
 'Rank IC': 0.01962798984676832,
 'Rank ICIR': 0.17582870546691637}
[3004062:MainThread](2024-04-25 02:50:03,612) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3004062:MainThread](2024-04-25 02:50:19,890) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 02:50:19,894) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 02:50:26,093) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8a51b2afa0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:54,  8.48it/s]backtest loop:   1%|          | 8/971 [00:00<00:47, 20.25it/s]backtest loop:   1%|▏         | 14/971 [00:00<00:31, 30.67it/s]backtest loop:   2%|▏         | 20/971 [00:00<00:25, 37.49it/s]backtest loop:   3%|▎         | 25/971 [00:00<00:24, 38.54it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:21, 42.78it/s]backtest loop:   4%|▎         | 36/971 [00:01<00:20, 44.66it/s]backtest loop:   4%|▍         | 42/971 [00:01<00:19, 47.17it/s]backtest loop:   5%|▍         | 47/971 [00:01<00:19, 47.92it/s]backtest loop:   5%|▌         | 53/971 [00:01<00:18, 50.12it/s]backtest loop:   6%|▌         | 59/971 [00:01<00:19, 47.84it/s]backtest loop:   7%|▋         | 65/971 [00:01<00:18, 49.42it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:17, 50.54it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:18, 48.51it/s]backtest loop:   9%|▊         | 83/971 [00:01<00:17, 50.00it/s]backtest loop:   9%|▉         | 89/971 [00:02<00:17, 50.65it/s]backtest loop:  10%|▉         | 95/971 [00:02<00:17, 51.13it/s]backtest loop:  10%|█         | 101/971 [00:02<00:16, 51.28it/s]backtest loop:  11%|█         | 107/971 [00:02<00:17, 49.28it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:17, 49.39it/s]backtest loop:  12%|█▏        | 118/971 [00:02<00:16, 50.55it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:16, 51.33it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:17, 48.55it/s]backtest loop:  14%|█▍        | 136/971 [00:03<00:17, 46.98it/s]backtest loop:  15%|█▍        | 142/971 [00:03<00:17, 48.56it/s]backtest loop:  15%|█▌        | 148/971 [00:03<00:16, 49.74it/s]backtest loop:  16%|█▌        | 154/971 [00:03<00:16, 50.50it/s]backtest loop:  16%|█▋        | 160/971 [00:03<00:15, 51.20it/s]backtest loop:  17%|█▋        | 166/971 [00:03<00:16, 48.56it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:16, 48.92it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:15, 50.11it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:15, 50.76it/s]backtest loop:  19%|█▉        | 189/971 [00:04<00:15, 51.61it/s]backtest loop:  20%|██        | 195/971 [00:04<00:15, 49.15it/s]backtest loop:  21%|██        | 201/971 [00:04<00:15, 50.05it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:15, 50.87it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:15, 48.69it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:15, 50.12it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:15, 48.00it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:15, 49.30it/s]backtest loop:  24%|██▍       | 237/971 [00:05<00:14, 50.39it/s]backtest loop:  25%|██▌       | 243/971 [00:05<00:14, 51.67it/s]backtest loop:  26%|██▌       | 249/971 [00:05<00:14, 49.03it/s]backtest loop:  26%|██▌       | 254/971 [00:05<00:14, 49.12it/s]backtest loop:  27%|██▋       | 260/971 [00:05<00:14, 50.24it/s]backtest loop:  27%|██▋       | 266/971 [00:05<00:14, 47.60it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:14, 48.09it/s]backtest loop:  29%|██▊       | 277/971 [00:05<00:14, 49.39it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:13, 50.40it/s]backtest loop:  30%|██▉       | 289/971 [00:06<00:13, 50.79it/s]backtest loop:  30%|███       | 295/971 [00:06<00:13, 48.73it/s]backtest loop:  31%|███       | 301/971 [00:06<00:13, 50.10it/s]backtest loop:  32%|███▏      | 307/971 [00:06<00:13, 50.85it/s]backtest loop:  32%|███▏      | 313/971 [00:06<00:12, 51.65it/s]backtest loop:  33%|███▎      | 319/971 [00:06<00:12, 51.94it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:13, 49.54it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:12, 49.52it/s]backtest loop:  35%|███▍      | 336/971 [00:07<00:12, 50.61it/s]backtest loop:  35%|███▌      | 342/971 [00:07<00:12, 51.00it/s]backtest loop:  36%|███▌      | 348/971 [00:07<00:12, 51.81it/s]backtest loop:  36%|███▋      | 354/971 [00:07<00:11, 51.95it/s]backtest loop:  37%|███▋      | 360/971 [00:07<00:12, 49.84it/s]backtest loop:  38%|███▊      | 366/971 [00:07<00:11, 50.92it/s]backtest loop:  38%|███▊      | 372/971 [00:07<00:12, 48.64it/s]backtest loop:  39%|███▉      | 378/971 [00:07<00:12, 47.05it/s]backtest loop:  40%|███▉      | 384/971 [00:07<00:12, 48.65it/s]backtest loop:  40%|████      | 390/971 [00:08<00:11, 49.84it/s]backtest loop:  41%|████      | 396/971 [00:08<00:11, 50.67it/s]backtest loop:  41%|████▏     | 402/971 [00:08<00:11, 51.41it/s]backtest loop:  42%|████▏     | 408/971 [00:08<00:11, 48.66it/s]backtest loop:  43%|████▎     | 414/971 [00:08<00:11, 49.66it/s]backtest loop:  43%|████▎     | 420/971 [00:08<00:10, 50.28it/s]backtest loop:  44%|████▍     | 426/971 [00:08<00:10, 50.86it/s]backtest loop:  44%|████▍     | 432/971 [00:08<00:11, 48.20it/s]backtest loop:  45%|████▌     | 437/971 [00:09<00:11, 48.38it/s]backtest loop:  46%|████▌     | 442/971 [00:09<00:10, 48.75it/s]backtest loop:  46%|████▌     | 448/971 [00:09<00:10, 50.03it/s]backtest loop:  47%|████▋     | 454/971 [00:09<00:10, 50.59it/s]backtest loop:  47%|████▋     | 460/971 [00:09<00:09, 51.13it/s]backtest loop:  48%|████▊     | 466/971 [00:09<00:09, 51.37it/s]backtest loop:  49%|████▊     | 472/971 [00:09<00:10, 48.83it/s]backtest loop:  49%|████▉     | 478/971 [00:09<00:09, 50.31it/s]backtest loop:  50%|████▉     | 484/971 [00:09<00:09, 51.04it/s]backtest loop:  50%|█████     | 490/971 [00:10<00:09, 48.42it/s]backtest loop:  51%|█████     | 496/971 [00:10<00:09, 49.59it/s]backtest loop:  52%|█████▏    | 502/971 [00:10<00:09, 50.66it/s]backtest loop:  52%|█████▏    | 508/971 [00:10<00:09, 48.83it/s]backtest loop:  53%|█████▎    | 514/971 [00:10<00:09, 50.08it/s]backtest loop:  54%|█████▎    | 520/971 [00:10<00:08, 50.74it/s]backtest loop:  54%|█████▍    | 526/971 [00:10<00:09, 48.46it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:09, 48.80it/s]backtest loop:  55%|█████▌    | 537/971 [00:11<00:08, 50.10it/s]backtest loop:  56%|█████▌    | 543/971 [00:11<00:08, 50.84it/s]backtest loop:  57%|█████▋    | 549/971 [00:11<00:08, 51.46it/s]backtest loop:  57%|█████▋    | 555/971 [00:11<00:08, 51.85it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:08, 49.02it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:08, 50.04it/s]backtest loop:  59%|█████▉    | 573/971 [00:11<00:07, 50.51it/s]backtest loop:  60%|█████▉    | 579/971 [00:11<00:07, 51.14it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:07, 51.42it/s]backtest loop:  61%|██████    | 591/971 [00:12<00:07, 48.88it/s]backtest loop:  61%|██████▏   | 597/971 [00:12<00:07, 49.84it/s]backtest loop:  62%|██████▏   | 603/971 [00:12<00:07, 50.65it/s]backtest loop:  63%|██████▎   | 609/971 [00:12<00:07, 51.32it/s]backtest loop:  63%|██████▎   | 615/971 [00:12<00:07, 48.59it/s]backtest loop:  64%|██████▍   | 621/971 [00:12<00:07, 49.63it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:06, 50.52it/s]backtest loop:  65%|██████▌   | 633/971 [00:12<00:06, 51.21it/s]backtest loop:  66%|██████▌   | 639/971 [00:13<00:06, 51.64it/s]backtest loop:  66%|██████▋   | 645/971 [00:13<00:06, 48.74it/s]backtest loop:  67%|██████▋   | 651/971 [00:13<00:06, 49.82it/s]backtest loop:  68%|██████▊   | 657/971 [00:13<00:06, 50.89it/s]backtest loop:  68%|██████▊   | 663/971 [00:13<00:06, 50.94it/s]backtest loop:  69%|██████▉   | 669/971 [00:13<00:05, 51.48it/s]backtest loop:  70%|██████▉   | 675/971 [00:13<00:06, 48.32it/s]backtest loop:  70%|███████   | 681/971 [00:13<00:05, 49.68it/s]backtest loop:  71%|███████   | 687/971 [00:14<00:05, 50.36it/s]backtest loop:  71%|███████▏  | 693/971 [00:14<00:05, 50.75it/s]backtest loop:  72%|███████▏  | 699/971 [00:14<00:05, 48.38it/s]backtest loop:  73%|███████▎  | 705/971 [00:14<00:05, 49.47it/s]backtest loop:  73%|███████▎  | 711/971 [00:14<00:05, 50.47it/s]backtest loop:  74%|███████▍  | 717/971 [00:14<00:04, 51.19it/s]backtest loop:  74%|███████▍  | 723/971 [00:14<00:04, 51.58it/s]backtest loop:  75%|███████▌  | 729/971 [00:14<00:04, 49.06it/s]backtest loop:  76%|███████▌  | 734/971 [00:15<00:05, 46.68it/s]backtest loop:  76%|███████▌  | 739/971 [00:15<00:04, 47.47it/s]backtest loop:  77%|███████▋  | 745/971 [00:15<00:04, 49.34it/s]backtest loop:  77%|███████▋  | 750/971 [00:15<00:04, 46.91it/s]backtest loop:  78%|███████▊  | 756/971 [00:15<00:04, 48.52it/s]backtest loop:  78%|███████▊  | 762/971 [00:15<00:04, 50.11it/s]backtest loop:  79%|███████▉  | 768/971 [00:15<00:03, 51.62it/s]backtest loop:  80%|███████▉  | 774/971 [00:15<00:03, 53.15it/s]backtest loop:  80%|████████  | 780/971 [00:15<00:03, 50.07it/s]backtest loop:  81%|████████  | 786/971 [00:16<00:03, 50.58it/s]backtest loop:  82%|████████▏ | 792/971 [00:16<00:03, 51.21it/s]backtest loop:  82%|████████▏ | 798/971 [00:16<00:03, 48.78it/s]backtest loop:  83%|████████▎ | 804/971 [00:16<00:03, 49.81it/s]backtest loop:  83%|████████▎ | 810/971 [00:16<00:03, 50.54it/s]backtest loop:  84%|████████▍ | 816/971 [00:16<00:03, 50.98it/s]backtest loop:  85%|████████▍ | 822/971 [00:16<00:02, 51.41it/s]backtest loop:  85%|████████▌ | 828/971 [00:16<00:02, 48.79it/s]backtest loop:  86%|████████▌ | 833/971 [00:16<00:02, 49.01it/s]backtest loop:  86%|████████▋ | 839/971 [00:17<00:02, 50.00it/s]backtest loop:  87%|████████▋ | 845/971 [00:17<00:02, 50.72it/s]backtest loop:  88%|████████▊ | 851/971 [00:17<00:02, 51.16it/s]backtest loop:  88%|████████▊ | 857/971 [00:17<00:02, 48.56it/s]backtest loop:  89%|████████▉ | 863/971 [00:17<00:02, 49.75it/s]backtest loop:  89%|████████▉ | 869/971 [00:17<00:02, 50.46it/s]backtest loop:  90%|█████████ | 875/971 [00:17<00:01, 51.02it/s]backtest loop:  91%|█████████ | 881/971 [00:17<00:01, 51.48it/s]backtest loop:  91%|█████████▏| 887/971 [00:18<00:01, 48.69it/s]backtest loop:  92%|█████████▏| 892/971 [00:18<00:01, 48.92it/s]backtest loop:  92%|█████████▏| 898/971 [00:18<00:01, 49.92it/s]backtest loop:  93%|█████████▎| 904/971 [00:18<00:01, 50.71it/s]backtest loop:  94%|█████████▎| 910/971 [00:18<00:01, 51.08it/s]backtest loop:  94%|█████████▍| 916/971 [00:18<00:01, 48.55it/s]backtest loop:  95%|█████████▍| 921/971 [00:18<00:01, 48.90it/s]backtest loop:  95%|█████████▌| 926/971 [00:18<00:00, 48.81it/s]backtest loop:  96%|█████████▌| 932/971 [00:18<00:00, 49.82it/s]backtest loop:  97%|█████████▋| 938/971 [00:19<00:00, 50.94it/s]backtest loop:  97%|█████████▋| 944/971 [00:19<00:00, 51.33it/s]backtest loop:  98%|█████████▊| 950/971 [00:19<00:00, 48.56it/s]backtest loop:  98%|█████████▊| 956/971 [00:19<00:00, 49.73it/s]backtest loop:  99%|█████████▉| 962/971 [00:19<00:00, 50.37it/s]backtest loop: 100%|█████████▉| 968/971 [00:19<00:00, 51.04it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 49.20it/s]
[3004062:MainThread](2024-04-25 02:50:45,905) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000526
std                0.004957
annualized_return  0.125111
information_ratio  1.635960
max_drawdown      -0.071070
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000332
std                0.004958
annualized_return  0.079064
information_ratio  1.033629
max_drawdown      -0.096652
[3004062:MainThread](2024-04-25 02:50:45,921) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-25_01:25:15_online`.
Round 8 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06015972005648005,
                                                    0.03273059938414068,
                                                    0.05947816937582371,
                                                    0.0076356952206925776,
                                                    0.05119321329664117,
                                                    0.05152240617919004,
                                                    0.026766665197175268,
                                                    0.07906448012082298],
 '1day.excess_return_with_cost.information_ratio': [0.7679933092923739,
                                                    0.4133389026554145,
                                                    0.7636301919612586,
                                                    0.0978136867244855,
                                                    0.6747217921818092,
                                                    0.6545829389734713,
                                                    0.3298821485447942,
                                                    1.0336294034258753],
 '1day.excess_return_with_cost.max_drawdown': [-0.08670293338962837,
                                               -0.16197255475157407,
                                               -0.10150852344205823,
                                               -0.1665674035171944,
                                               -0.11355296002422188,
                                               -0.16250574143268212,
                                               -0.12418988691040042,
                                               -0.0966524211866357],
 'IC': [0.027040578141343165,
        0.02653395980121937,
        0.026817808553124933,
        0.02854324574140338,
        0.026814229044106942,
        0.028441496398551678,
        0.024732389642783594,
        0.02674986454272586],
 'ICIR': [0.22347151688066197,
          0.22642606515849942,
          0.24265733154989236,
          0.24787481021777158,
          0.22370551351917856,
          0.23361485235931148,
          0.214673256268981,
          0.2361810357877373],
 'Rank IC': [0.023053889583337525,
             0.02273519521648915,
             0.022998778503316525,
             0.024537121375718042,
             0.024870332765134055,
             0.023579509676170216,
             0.019972407900258712,
             0.01962798984676832],
 'Rank ICIR': [0.19913024732178053,
               0.20377985954373565,
               0.21844485445366277,
               0.21715884654157896,
               0.21568508976946332,
               0.19894632220749242,
               0.17740286536494682,
               0.17582870546691637],
 'mae': [0.686060905456543,
         0.6859773397445679,
         0.6860173940658569,
         0.6859692335128784,
         0.6860255599021912,
         0.6859720349311829,
         0.6861683130264282,
         0.686046838760376],
 'mse': [0.9976044297218323,
         0.9977508783340454,
         0.9977036714553833,
         0.9974674582481384,
         0.9975618124008179,
         0.997508704662323,
         0.9978338479995728,
         0.9976094961166382]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3004062:MainThread](2024-04-25 02:50:47,296) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3004062:MainThread](2024-04-25 02:50:47,297) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3004062:MainThread](2024-04-25 02:50:47,299) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3004062:MainThread](2024-04-25 02:50:47,300) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:13<22:25, 13.59s/it]epoch:   2%|▏         | 2/100 [00:26<21:51, 13.38s/it]epoch:   3%|▎         | 3/100 [00:39<21:27, 13.27s/it]epoch:   4%|▍         | 4/100 [00:52<20:57, 13.10s/it]epoch:   5%|▌         | 5/100 [01:06<20:51, 13.17s/it]epoch:   6%|▌         | 6/100 [01:18<20:24, 13.02s/it]epoch:   7%|▋         | 7/100 [01:32<20:18, 13.10s/it]epoch:   8%|▊         | 8/100 [01:44<19:54, 12.98s/it]epoch:   9%|▉         | 9/100 [01:57<19:40, 12.97s/it]epoch:  10%|█         | 10/100 [02:10<19:24, 12.94s/it]epoch:  11%|█         | 11/100 [02:22<18:54, 12.74s/it]epoch:  12%|█▏        | 12/100 [02:35<18:42, 12.76s/it]epoch:  13%|█▎        | 13/100 [02:48<18:35, 12.82s/it]epoch:  14%|█▍        | 14/100 [03:01<18:14, 12.73s/it]epoch:  15%|█▌        | 15/100 [03:14<18:09, 12.81s/it]epoch:  16%|█▌        | 16/100 [03:27<18:02, 12.88s/it]epoch:  17%|█▋        | 17/100 [03:39<17:37, 12.75s/it]epoch:  18%|█▊        | 18/100 [03:52<17:21, 12.70s/it]epoch:  19%|█▉        | 19/100 [04:05<17:15, 12.79s/it]epoch:  20%|██        | 20/100 [04:17<16:59, 12.74s/it]epoch:  21%|██        | 21/100 [04:30<16:40, 12.66s/it]epoch:  22%|██▏       | 22/100 [04:43<16:32, 12.73s/it]epoch:  23%|██▎       | 23/100 [04:56<16:23, 12.77s/it]epoch:  24%|██▍       | 24/100 [05:08<16:04, 12.69s/it]epoch:  25%|██▌       | 25/100 [05:21<15:49, 12.66s/it]epoch:  26%|██▌       | 26/100 [05:34<15:42, 12.74s/it]epoch:  27%|██▋       | 27/100 [05:46<15:31, 12.76s/it]epoch:  28%|██▊       | 28/100 [05:59<15:10, 12.65s/it]epoch:  29%|██▉       | 29/100 [06:11<14:57, 12.63s/it]epoch:  30%|███       | 30/100 [06:25<14:53, 12.76s/it]0.05702098912816121
best ic: 0.05702098912816121
epoch:  31%|███       | 31/100 [06:39<15:18, 13.31s/it]0.05308887696564479
epoch:  32%|███▏      | 32/100 [06:53<15:24, 13.60s/it]0.054173892302580455
epoch:  33%|███▎      | 33/100 [07:08<15:22, 13.77s/it]0.05457286759425363
epoch:  34%|███▍      | 34/100 [07:22<15:26, 14.04s/it]0.05665349589930511
epoch:  35%|███▌      | 35/100 [07:37<15:20, 14.16s/it]0.05666789886932598
epoch:  36%|███▌      | 36/100 [07:51<15:08, 14.20s/it]0.05199461236785218
epoch:  37%|███▋      | 37/100 [08:05<14:58, 14.26s/it]0.057351956070116616
best ic: 0.057351956070116616
epoch:  38%|███▊      | 38/100 [08:20<14:48, 14.33s/it]0.05229557659386248
epoch:  39%|███▉      | 39/100 [08:35<14:40, 14.43s/it]0.05189588489835435
epoch:  40%|████      | 40/100 [08:49<14:20, 14.34s/it]0.050127740213666484
epoch:  41%|████      | 41/100 [09:03<14:03, 14.29s/it]0.04977249430970446
epoch:  42%|████▏     | 42/100 [09:17<13:52, 14.36s/it]0.05104291751753907
epoch:  43%|████▎     | 43/100 [09:32<13:42, 14.43s/it]0.052059160635828584
epoch:  44%|████▍     | 44/100 [09:46<13:24, 14.37s/it]0.049554181477342675
epoch:  45%|████▌     | 45/100 [10:00<13:06, 14.30s/it]0.04928702297857344
epoch:  45%|████▌     | 45/100 [10:15<12:31, 13.67s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3004062:MainThread](2024-04-25 03:01:02,389) INFO - qlib.workflow - [exp.py:258] - Experiment 47 starts running ...
[3004062:MainThread](2024-04-25 03:01:02,402) INFO - qlib.workflow - [recorder.py:341] - Recorder a6137c94e7eb47b7952b1e534523d7ba starts running under Experiment 47 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:06, 10.01it/s]online:   6%|▋         | 4/63 [00:00<00:06,  9.63it/s]online:   8%|▊         | 5/63 [00:00<00:06,  9.22it/s]online:  10%|▉         | 6/63 [00:00<00:06,  9.14it/s]online:  11%|█         | 7/63 [00:00<00:06,  9.26it/s]online:  13%|█▎        | 8/63 [00:00<00:05,  9.21it/s]online:  14%|█▍        | 9/63 [00:00<00:05,  9.14it/s]online:  16%|█▌        | 10/63 [00:01<00:05,  9.19it/s]online:  17%|█▋        | 11/63 [00:01<00:05,  9.15it/s]online:  19%|█▉        | 12/63 [00:01<00:05,  9.23it/s]online:  21%|██        | 13/63 [00:01<00:05,  9.21it/s]online:  22%|██▏       | 14/63 [00:01<00:05,  9.29it/s]online:  24%|██▍       | 15/63 [00:01<00:05,  9.31it/s]online:  25%|██▌       | 16/63 [00:01<00:05,  9.27it/s]online:  27%|██▋       | 17/63 [00:01<00:05,  9.18it/s]online:  29%|██▊       | 18/63 [00:01<00:04,  9.16it/s]online:  30%|███       | 19/63 [00:02<00:04,  9.26it/s]online:  32%|███▏      | 20/63 [00:02<00:04,  9.15it/s]online:  33%|███▎      | 21/63 [00:02<00:04,  9.10it/s]online:  35%|███▍      | 22/63 [00:02<00:04,  9.11it/s]online:  37%|███▋      | 23/63 [00:02<00:04,  9.27it/s]online:  38%|███▊      | 24/63 [00:02<00:04,  9.23it/s]online:  40%|███▉      | 25/63 [00:02<00:04,  9.39it/s]online:  41%|████▏     | 26/63 [00:02<00:03,  9.37it/s]online:  43%|████▎     | 27/63 [00:02<00:03,  9.48it/s]online:  44%|████▍     | 28/63 [00:03<00:03,  9.52it/s]online:  46%|████▌     | 29/63 [00:03<00:03,  9.29it/s]online:  48%|████▊     | 30/63 [00:03<00:03,  9.38it/s]online:  49%|████▉     | 31/63 [00:03<00:03,  9.52it/s]online:  51%|█████     | 32/63 [00:03<00:03,  9.54it/s]online:  52%|█████▏    | 33/63 [00:03<00:03,  9.41it/s]online:  54%|█████▍    | 34/63 [00:03<00:03,  9.51it/s]online:  56%|█████▌    | 35/63 [00:03<00:02,  9.35it/s]online:  57%|█████▋    | 36/63 [00:03<00:02,  9.44it/s]online:  59%|█████▊    | 37/63 [00:03<00:02,  9.41it/s]online:  60%|██████    | 38/63 [00:04<00:02,  9.54it/s]online:  62%|██████▏   | 39/63 [00:04<00:02,  9.55it/s]online:  63%|██████▎   | 40/63 [00:04<00:02,  9.41it/s]online:  65%|██████▌   | 41/63 [00:04<00:02,  9.51it/s]online:  67%|██████▋   | 42/63 [00:04<00:02,  9.38it/s]online:  68%|██████▊   | 43/63 [00:04<00:02,  9.47it/s]online:  70%|██████▉   | 44/63 [00:04<00:01,  9.52it/s]online:  71%|███████▏  | 45/63 [00:04<00:01,  9.44it/s]online:  73%|███████▎  | 46/63 [00:04<00:01,  9.38it/s]online:  75%|███████▍  | 47/63 [00:05<00:01,  9.40it/s]online:  76%|███████▌  | 48/63 [00:05<00:01,  9.53it/s]online:  78%|███████▊  | 49/63 [00:05<00:01,  9.56it/s]online:  79%|███████▉  | 50/63 [00:05<00:01,  9.53it/s]online:  81%|████████  | 51/63 [00:05<00:01,  9.46it/s]online:  83%|████████▎ | 52/63 [00:05<00:01,  9.56it/s]online:  84%|████████▍ | 53/63 [00:05<00:01,  9.50it/s]online:  86%|████████▌ | 54/63 [00:05<00:00,  9.55it/s]online:  87%|████████▋ | 55/63 [00:05<00:00,  9.43it/s]online:  89%|████████▉ | 56/63 [00:05<00:00,  9.50it/s]online:  90%|█████████ | 57/63 [00:06<00:00,  9.44it/s]online:  92%|█████████▏| 58/63 [00:06<00:00,  9.53it/s]online:  94%|█████████▎| 59/63 [00:06<00:00,  9.50it/s]online:  95%|█████████▌| 60/63 [00:06<00:00,  9.53it/s]online:  97%|█████████▋| 61/63 [00:06<00:00,  9.48it/s]online:  98%|█████████▊| 62/63 [00:06<00:00,  9.53it/s]online: 100%|██████████| 63/63 [00:06<00:00,  9.41it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3004062:MainThread](2024-04-25 03:01:37,460) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99797297 mae 0.6862643
{'IC': 0.022639728174907545,
 'ICIR': 0.18918663356680376,
 'Rank IC': 0.018600829778738465,
 'Rank ICIR': 0.1639582249710289}
[3004062:MainThread](2024-04-25 03:01:39,412) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3004062:MainThread](2024-04-25 03:01:56,496) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 03:01:56,499) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 03:02:02,611) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8a52145ca0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:49,  8.80it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 23.89it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 34.52it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 39.46it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:20, 46.23it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.08it/s]backtest loop:   4%|▍         | 41/971 [00:01<00:18, 51.64it/s]backtest loop:   5%|▍         | 47/971 [00:01<00:17, 53.75it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.22it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 55.86it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.31it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 56.70it/s]backtest loop:   8%|▊         | 80/971 [00:01<00:15, 57.57it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:15, 58.23it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:15, 55.83it/s]backtest loop:  10%|█         | 99/971 [00:02<00:15, 57.66it/s]backtest loop:  11%|█         | 106/971 [00:02<00:14, 59.22it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 56.27it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:14, 58.25it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 55.54it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 53.62it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:14, 56.07it/s]backtest loop:  15%|█▍        | 145/971 [00:02<00:14, 57.93it/s]backtest loop:  16%|█▌        | 151/971 [00:02<00:14, 54.92it/s]backtest loop:  16%|█▌        | 157/971 [00:03<00:14, 55.97it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:14, 57.01it/s]backtest loop:  17%|█▋        | 169/971 [00:03<00:13, 57.46it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 55.71it/s]backtest loop:  19%|█▊        | 182/971 [00:03<00:13, 56.84it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:13, 58.85it/s]backtest loop:  20%|██        | 195/971 [00:03<00:13, 56.19it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 58.74it/s]backtest loop:  22%|██▏       | 209/971 [00:03<00:12, 60.34it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 54.57it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:13, 55.69it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:12, 57.61it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:13, 54.76it/s]backtest loop:  25%|██▍       | 241/971 [00:04<00:13, 55.97it/s]backtest loop:  26%|██▌       | 248/971 [00:04<00:12, 58.11it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:13, 55.03it/s]backtest loop:  27%|██▋       | 261/971 [00:04<00:12, 57.10it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:12, 54.91it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 56.20it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:11, 58.28it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 55.33it/s]backtest loop:  30%|███       | 292/971 [00:05<00:12, 55.84it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 56.90it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:12, 55.07it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 57.14it/s]backtest loop:  33%|███▎      | 319/971 [00:05<00:11, 58.81it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:11, 56.03it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:10, 58.29it/s]backtest loop:  35%|███▍      | 338/971 [00:06<00:10, 58.68it/s]backtest loop:  35%|███▌      | 344/971 [00:06<00:10, 58.83it/s]backtest loop:  36%|███▌      | 350/971 [00:06<00:11, 55.65it/s]backtest loop:  37%|███▋      | 356/971 [00:06<00:10, 56.56it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:10, 55.51it/s]backtest loop:  38%|███▊      | 369/971 [00:06<00:11, 53.25it/s]backtest loop:  39%|███▊      | 376/971 [00:06<00:10, 55.98it/s]backtest loop:  39%|███▉      | 383/971 [00:07<00:10, 54.66it/s]backtest loop:  40%|████      | 390/971 [00:07<00:10, 56.81it/s]backtest loop:  41%|████      | 396/971 [00:07<00:10, 57.41it/s]backtest loop:  41%|████▏     | 402/971 [00:07<00:09, 58.03it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:10, 55.09it/s]backtest loop:  43%|████▎     | 414/971 [00:07<00:09, 56.16it/s]backtest loop:  43%|████▎     | 420/971 [00:07<00:09, 56.67it/s]backtest loop:  44%|████▍     | 426/971 [00:07<00:09, 57.54it/s]backtest loop:  44%|████▍     | 432/971 [00:07<00:09, 54.58it/s]backtest loop:  45%|████▌     | 438/971 [00:08<00:09, 56.04it/s]backtest loop:  46%|████▌     | 444/971 [00:08<00:09, 56.99it/s]backtest loop:  46%|████▋     | 450/971 [00:08<00:09, 57.41it/s]backtest loop:  47%|████▋     | 456/971 [00:08<00:08, 57.79it/s]backtest loop:  48%|████▊     | 462/971 [00:08<00:09, 54.75it/s]backtest loop:  48%|████▊     | 468/971 [00:08<00:08, 56.00it/s]backtest loop:  49%|████▉     | 474/971 [00:08<00:08, 57.02it/s]backtest loop:  50%|████▉     | 481/971 [00:08<00:08, 58.93it/s]backtest loop:  50%|█████     | 487/971 [00:08<00:08, 55.71it/s]backtest loop:  51%|█████     | 494/971 [00:09<00:08, 57.78it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 55.11it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 54.55it/s]backtest loop:  53%|█████▎    | 513/971 [00:09<00:08, 55.75it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:07, 56.84it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 55.48it/s]backtest loop:  55%|█████▍    | 532/971 [00:09<00:07, 56.54it/s]backtest loop:  55%|█████▌    | 538/971 [00:09<00:07, 57.45it/s]backtest loop:  56%|█████▌    | 544/971 [00:09<00:07, 58.10it/s]backtest loop:  57%|█████▋    | 550/971 [00:09<00:07, 58.25it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:07, 54.71it/s]backtest loop:  58%|█████▊    | 563/971 [00:10<00:07, 57.01it/s]backtest loop:  59%|█████▊    | 569/971 [00:10<00:06, 57.47it/s]backtest loop:  59%|█████▉    | 575/971 [00:10<00:06, 58.16it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:07, 54.86it/s]backtest loop:  60%|██████    | 587/971 [00:10<00:06, 55.81it/s]backtest loop:  61%|██████    | 593/971 [00:10<00:06, 56.88it/s]backtest loop:  62%|██████▏   | 599/971 [00:10<00:06, 57.59it/s]backtest loop:  62%|██████▏   | 605/971 [00:10<00:06, 55.05it/s]backtest loop:  63%|██████▎   | 611/971 [00:11<00:06, 56.10it/s]backtest loop:  64%|██████▎   | 617/971 [00:11<00:06, 56.92it/s]backtest loop:  64%|██████▍   | 623/971 [00:11<00:06, 57.79it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:06, 56.14it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:05, 57.89it/s]backtest loop:  66%|██████▌   | 643/971 [00:11<00:05, 58.17it/s]backtest loop:  67%|██████▋   | 649/971 [00:11<00:05, 58.20it/s]backtest loop:  67%|██████▋   | 655/971 [00:11<00:05, 55.49it/s]backtest loop:  68%|██████▊   | 661/971 [00:11<00:05, 56.57it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 57.51it/s]backtest loop:  69%|██████▉   | 673/971 [00:12<00:05, 57.99it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 54.69it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 55.59it/s]backtest loop:  71%|███████   | 691/971 [00:12<00:04, 56.65it/s]backtest loop:  72%|███████▏  | 697/971 [00:12<00:04, 57.58it/s]backtest loop:  72%|███████▏  | 703/971 [00:12<00:04, 58.02it/s]backtest loop:  73%|███████▎  | 709/971 [00:12<00:04, 54.90it/s]backtest loop:  74%|███████▎  | 715/971 [00:12<00:04, 55.65it/s]backtest loop:  74%|███████▍  | 722/971 [00:13<00:04, 58.01it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 58.50it/s]backtest loop:  76%|███████▌  | 734/971 [00:13<00:04, 52.45it/s]backtest loop:  76%|███████▌  | 740/971 [00:13<00:04, 54.32it/s]backtest loop:  77%|███████▋  | 746/971 [00:13<00:04, 55.64it/s]backtest loop:  77%|███████▋  | 752/971 [00:13<00:04, 53.73it/s]backtest loop:  78%|███████▊  | 759/971 [00:13<00:03, 56.23it/s]backtest loop:  79%|███████▉  | 765/971 [00:13<00:03, 54.17it/s]backtest loop:  80%|███████▉  | 772/971 [00:13<00:03, 56.66it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 58.72it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 56.36it/s]backtest loop:  81%|████████▏ | 791/971 [00:14<00:03, 57.14it/s]backtest loop:  82%|████████▏ | 797/971 [00:14<00:03, 57.79it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:03, 54.60it/s]backtest loop:  83%|████████▎ | 809/971 [00:14<00:02, 55.57it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 56.53it/s]backtest loop:  85%|████████▍ | 821/971 [00:14<00:02, 57.10it/s]backtest loop:  85%|████████▌ | 827/971 [00:14<00:02, 57.87it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 55.13it/s]backtest loop:  86%|████████▋ | 839/971 [00:15<00:02, 56.13it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 56.71it/s]backtest loop:  88%|████████▊ | 851/971 [00:15<00:02, 57.65it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 54.65it/s]backtest loop:  89%|████████▉ | 864/971 [00:15<00:01, 57.04it/s]backtest loop:  90%|████████▉ | 870/971 [00:15<00:01, 57.80it/s]backtest loop:  90%|█████████ | 876/971 [00:15<00:01, 58.05it/s]backtest loop:  91%|█████████ | 882/971 [00:15<00:01, 55.00it/s]backtest loop:  91%|█████████▏| 888/971 [00:15<00:01, 56.36it/s]backtest loop:  92%|█████████▏| 894/971 [00:16<00:01, 57.28it/s]backtest loop:  93%|█████████▎| 901/971 [00:16<00:01, 58.82it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 55.37it/s]backtest loop:  94%|█████████▍| 913/971 [00:16<00:01, 55.80it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 56.46it/s]backtest loop:  95%|█████████▌| 925/971 [00:16<00:00, 56.98it/s]backtest loop:  96%|█████████▌| 931/971 [00:16<00:00, 53.77it/s]backtest loop:  96%|█████████▋| 937/971 [00:16<00:00, 55.18it/s]backtest loop:  97%|█████████▋| 944/971 [00:16<00:00, 57.47it/s]backtest loop:  98%|█████████▊| 950/971 [00:17<00:00, 54.45it/s]backtest loop:  98%|█████████▊| 956/971 [00:17<00:00, 55.23it/s]backtest loop:  99%|█████████▉| 962/971 [00:17<00:00, 55.57it/s]backtest loop: 100%|█████████▉| 968/971 [00:17<00:00, 56.00it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.53it/s]
[3004062:MainThread](2024-04-25 03:02:20,171) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000317
std                0.005300
annualized_return  0.075493
information_ratio  0.923367
max_drawdown      -0.129110
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000124
std                0.005300
annualized_return  0.029435
information_ratio  0.359987
max_drawdown      -0.161472
[3004062:MainThread](2024-04-25 03:02:20,187) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-25_01:25:15_online`.
Round 9 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06015972005648005,
                                                    0.03273059938414068,
                                                    0.05947816937582371,
                                                    0.0076356952206925776,
                                                    0.05119321329664117,
                                                    0.05152240617919004,
                                                    0.026766665197175268,
                                                    0.07906448012082298,
                                                    0.02943458316401825],
 '1day.excess_return_with_cost.information_ratio': [0.7679933092923739,
                                                    0.4133389026554145,
                                                    0.7636301919612586,
                                                    0.0978136867244855,
                                                    0.6747217921818092,
                                                    0.6545829389734713,
                                                    0.3298821485447942,
                                                    1.0336294034258753,
                                                    0.3599871801442111],
 '1day.excess_return_with_cost.max_drawdown': [-0.08670293338962837,
                                               -0.16197255475157407,
                                               -0.10150852344205823,
                                               -0.1665674035171944,
                                               -0.11355296002422188,
                                               -0.16250574143268212,
                                               -0.12418988691040042,
                                               -0.0966524211866357,
                                               -0.16147170612600675],
 'IC': [0.027040578141343165,
        0.02653395980121937,
        0.026817808553124933,
        0.02854324574140338,
        0.026814229044106942,
        0.028441496398551678,
        0.024732389642783594,
        0.02674986454272586,
        0.022639728174907545],
 'ICIR': [0.22347151688066197,
          0.22642606515849942,
          0.24265733154989236,
          0.24787481021777158,
          0.22370551351917856,
          0.23361485235931148,
          0.214673256268981,
          0.2361810357877373,
          0.18918663356680376],
 'Rank IC': [0.023053889583337525,
             0.02273519521648915,
             0.022998778503316525,
             0.024537121375718042,
             0.024870332765134055,
             0.023579509676170216,
             0.019972407900258712,
             0.01962798984676832,
             0.018600829778738465],
 'Rank ICIR': [0.19913024732178053,
               0.20377985954373565,
               0.21844485445366277,
               0.21715884654157896,
               0.21568508976946332,
               0.19894632220749242,
               0.17740286536494682,
               0.17582870546691637,
               0.1639582249710289],
 'mae': [0.686060905456543,
         0.6859773397445679,
         0.6860173940658569,
         0.6859692335128784,
         0.6860255599021912,
         0.6859720349311829,
         0.6861683130264282,
         0.686046838760376,
         0.6862642765045166],
 'mse': [0.9976044297218323,
         0.9977508783340454,
         0.9977036714553833,
         0.9974674582481384,
         0.9975618124008179,
         0.997508704662323,
         0.9978338479995728,
         0.9976094961166382,
         0.9979729652404785]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3004062:MainThread](2024-04-25 03:02:21,609) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[3004062:MainThread](2024-04-25 03:02:21,609) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[3004062:MainThread](2024-04-25 03:02:21,612) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[3004062:MainThread](2024-04-25 03:02:21,612) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:13<22:02, 13.36s/it]epoch:   2%|▏         | 2/100 [00:26<21:37, 13.24s/it]epoch:   3%|▎         | 3/100 [00:39<21:27, 13.28s/it]epoch:   4%|▍         | 4/100 [00:53<21:12, 13.26s/it]epoch:   5%|▌         | 5/100 [01:06<20:55, 13.22s/it]epoch:   6%|▌         | 6/100 [01:19<20:38, 13.18s/it]epoch:   7%|▋         | 7/100 [01:32<20:25, 13.17s/it]epoch:   8%|▊         | 8/100 [01:45<20:01, 13.06s/it]epoch:   9%|▉         | 9/100 [01:58<19:52, 13.10s/it]epoch:  10%|█         | 10/100 [02:11<19:30, 13.00s/it]epoch:  11%|█         | 11/100 [02:24<19:15, 12.99s/it]epoch:  12%|█▏        | 12/100 [02:36<18:54, 12.89s/it]epoch:  13%|█▎        | 13/100 [02:50<18:47, 12.96s/it]epoch:  14%|█▍        | 14/100 [03:02<18:22, 12.82s/it]epoch:  15%|█▌        | 15/100 [03:15<18:22, 12.97s/it]epoch:  16%|█▌        | 16/100 [03:28<18:01, 12.88s/it]epoch:  17%|█▋        | 17/100 [03:40<17:37, 12.74s/it]epoch:  18%|█▊        | 18/100 [03:53<17:27, 12.78s/it]epoch:  19%|█▉        | 19/100 [04:06<17:17, 12.81s/it]epoch:  20%|██        | 20/100 [04:19<16:54, 12.69s/it]epoch:  21%|██        | 21/100 [04:31<16:42, 12.68s/it]epoch:  22%|██▏       | 22/100 [04:44<16:35, 12.76s/it]epoch:  23%|██▎       | 23/100 [04:57<16:19, 12.72s/it]epoch:  24%|██▍       | 24/100 [05:09<15:59, 12.62s/it]epoch:  25%|██▌       | 25/100 [05:22<15:46, 12.62s/it]epoch:  26%|██▌       | 26/100 [05:35<15:42, 12.74s/it]epoch:  27%|██▋       | 27/100 [05:48<15:29, 12.73s/it]epoch:  28%|██▊       | 28/100 [06:00<15:12, 12.67s/it]epoch:  29%|██▉       | 29/100 [06:13<14:55, 12.61s/it]epoch:  30%|███       | 30/100 [06:25<14:39, 12.57s/it]0.056580783079125785
best ic: 0.056580783079125785
epoch:  31%|███       | 31/100 [06:40<15:11, 13.21s/it]0.05477644221801457
epoch:  32%|███▏      | 32/100 [06:54<15:25, 13.61s/it]0.05548588233126066
epoch:  33%|███▎      | 33/100 [07:08<15:22, 13.77s/it]0.05978850458696117
best ic: 0.05978850458696117
epoch:  34%|███▍      | 34/100 [07:23<15:17, 13.90s/it]0.05505707151967068
epoch:  35%|███▌      | 35/100 [07:37<15:13, 14.06s/it]0.05605758080670854
epoch:  36%|███▌      | 36/100 [07:52<15:16, 14.32s/it]0.054130706530233184
epoch:  37%|███▋      | 37/100 [08:06<15:01, 14.32s/it]0.05433484655886318
epoch:  38%|███▊      | 38/100 [08:20<14:43, 14.25s/it]0.05542619270453255
epoch:  39%|███▉      | 39/100 [08:35<14:27, 14.22s/it]0.05308675027402214
epoch:  40%|████      | 40/100 [08:49<14:20, 14.35s/it]0.051619338820433666
epoch:  41%|████      | 41/100 [09:04<14:09, 14.39s/it]0.051835999900671496
epoch:  41%|████      | 41/100 [09:18<13:23, 13.62s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3004062:MainThread](2024-04-25 03:11:39,950) INFO - qlib.workflow - [exp.py:258] - Experiment 47 starts running ...
[3004062:MainThread](2024-04-25 03:11:39,963) INFO - qlib.workflow - [recorder.py:341] - Recorder 288c4c7d64bf4d27b390e0f6b8de41e5 starts running under Experiment 47 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:06,  9.94it/s]online:   5%|▍         | 3/63 [00:00<00:06,  9.80it/s]online:   6%|▋         | 4/63 [00:00<00:06,  9.70it/s]online:   8%|▊         | 5/63 [00:00<00:06,  9.59it/s]online:  10%|▉         | 6/63 [00:00<00:05,  9.57it/s]online:  11%|█         | 7/63 [00:00<00:06,  9.33it/s]online:  13%|█▎        | 8/63 [00:00<00:05,  9.35it/s]online:  14%|█▍        | 9/63 [00:00<00:05,  9.38it/s]online:  16%|█▌        | 10/63 [00:01<00:05,  9.30it/s]online:  17%|█▋        | 11/63 [00:01<00:05,  9.36it/s]online:  19%|█▉        | 12/63 [00:01<00:05,  9.43it/s]online:  21%|██        | 13/63 [00:01<00:05,  9.32it/s]online:  22%|██▏       | 14/63 [00:01<00:05,  9.24it/s]online:  24%|██▍       | 15/63 [00:01<00:05,  9.33it/s]online:  25%|██▌       | 16/63 [00:01<00:05,  9.20it/s]online:  27%|██▋       | 17/63 [00:01<00:04,  9.23it/s]online:  29%|██▊       | 18/63 [00:01<00:04,  9.25it/s]online:  30%|███       | 19/63 [00:02<00:04,  9.25it/s]online:  32%|███▏      | 20/63 [00:02<00:04,  9.39it/s]online:  33%|███▎      | 21/63 [00:02<00:04,  9.32it/s]online:  35%|███▍      | 22/63 [00:02<00:04,  9.16it/s]online:  38%|███▊      | 24/63 [00:02<00:04,  9.28it/s]online:  40%|███▉      | 25/63 [00:02<00:04,  9.35it/s]online:  41%|████▏     | 26/63 [00:02<00:03,  9.34it/s]online:  43%|████▎     | 27/63 [00:02<00:03,  9.45it/s]online:  44%|████▍     | 28/63 [00:02<00:03,  9.34it/s]online:  46%|████▌     | 29/63 [00:03<00:03,  9.32it/s]online:  48%|████▊     | 30/63 [00:03<00:03,  9.46it/s]online:  49%|████▉     | 31/63 [00:03<00:03,  9.45it/s]online:  51%|█████     | 32/63 [00:03<00:03,  9.46it/s]online:  52%|█████▏    | 33/63 [00:03<00:03,  9.48it/s]online:  54%|█████▍    | 34/63 [00:03<00:03,  9.59it/s]online:  56%|█████▌    | 35/63 [00:03<00:02,  9.48it/s]online:  57%|█████▋    | 36/63 [00:03<00:02,  9.41it/s]online:  59%|█████▊    | 37/63 [00:03<00:02,  9.34it/s]online:  62%|██████▏   | 39/63 [00:04<00:02,  9.58it/s]online:  63%|██████▎   | 40/63 [00:04<00:02,  9.50it/s]online:  65%|██████▌   | 41/63 [00:04<00:02,  9.51it/s]online:  67%|██████▋   | 42/63 [00:04<00:02,  9.34it/s]online:  70%|██████▉   | 44/63 [00:04<00:01,  9.53it/s]online:  71%|███████▏  | 45/63 [00:04<00:01,  9.43it/s]online:  73%|███████▎  | 46/63 [00:04<00:01,  9.44it/s]online:  75%|███████▍  | 47/63 [00:04<00:01,  9.42it/s]online:  76%|███████▌  | 48/63 [00:05<00:01,  9.47it/s]online:  78%|███████▊  | 49/63 [00:05<00:01,  9.50it/s]online:  79%|███████▉  | 50/63 [00:05<00:01,  9.43it/s]online:  81%|████████  | 51/63 [00:05<00:01,  9.48it/s]online:  83%|████████▎ | 52/63 [00:05<00:01,  9.42it/s]online:  84%|████████▍ | 53/63 [00:05<00:01,  9.49it/s]online:  86%|████████▌ | 54/63 [00:05<00:00,  9.48it/s]online:  87%|████████▋ | 55/63 [00:05<00:00,  9.55it/s]online:  89%|████████▉ | 56/63 [00:05<00:00,  9.51it/s]online:  90%|█████████ | 57/63 [00:06<00:00,  9.52it/s]online:  92%|█████████▏| 58/63 [00:06<00:00,  9.31it/s]online:  94%|█████████▎| 59/63 [00:06<00:00,  9.40it/s]online:  95%|█████████▌| 60/63 [00:06<00:00,  9.50it/s]online:  97%|█████████▋| 61/63 [00:06<00:00,  9.40it/s]online:  98%|█████████▊| 62/63 [00:06<00:00,  9.35it/s]online: 100%|██████████| 63/63 [00:06<00:00,  9.43it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3004062:MainThread](2024-04-25 03:11:58,402) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99765587 mae 0.6859845
{'IC': 0.025941891439215062,
 'ICIR': 0.2296716924037541,
 'Rank IC': 0.023802406571708387,
 'Rank ICIR': 0.21376244409662987}
[3004062:MainThread](2024-04-25 03:12:00,288) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3004062:MainThread](2024-04-25 03:12:17,903) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 03:12:17,906) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3004062:MainThread](2024-04-25 03:12:23,911) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f8a54a47940>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:41,  9.53it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 24.94it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 35.33it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.98it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:20, 47.12it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.68it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.10it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.22it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.79it/s]backtest loop:   6%|▌         | 60/971 [00:01<00:16, 55.42it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.60it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 57.54it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 59.21it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 55.56it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 58.31it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 59.67it/s]backtest loop:  11%|█         | 108/971 [00:02<00:14, 57.82it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 58.20it/s]backtest loop:  12%|█▏        | 120/971 [00:02<00:14, 58.55it/s]backtest loop:  13%|█▎        | 126/971 [00:02<00:15, 52.85it/s]backtest loop:  14%|█▎        | 133/971 [00:02<00:15, 55.56it/s]backtest loop:  14%|█▍        | 140/971 [00:02<00:14, 57.71it/s]backtest loop:  15%|█▌        | 146/971 [00:02<00:14, 55.10it/s]backtest loop:  16%|█▌        | 152/971 [00:02<00:14, 56.26it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:14, 56.88it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:13, 58.86it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:14, 55.68it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:13, 58.10it/s]backtest loop:  19%|█▉        | 184/971 [00:03<00:13, 58.44it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:13, 55.94it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 58.42it/s]backtest loop:  21%|██        | 204/971 [00:03<00:12, 59.91it/s]backtest loop:  22%|██▏       | 211/971 [00:03<00:13, 57.10it/s]backtest loop:  22%|██▏       | 217/971 [00:04<00:13, 54.75it/s]backtest loop:  23%|██▎       | 224/971 [00:04<00:13, 57.02it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 54.68it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 57.42it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 59.26it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 56.09it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:12, 56.58it/s]backtest loop:  27%|██▋       | 263/971 [00:04<00:12, 58.36it/s]backtest loop:  28%|██▊       | 269/971 [00:04<00:12, 55.71it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:12, 54.71it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:12, 56.86it/s]backtest loop:  30%|██▉       | 289/971 [00:05<00:11, 57.68it/s]backtest loop:  30%|███       | 295/971 [00:05<00:12, 55.59it/s]backtest loop:  31%|███       | 302/971 [00:05<00:11, 57.52it/s]backtest loop:  32%|███▏      | 308/971 [00:05<00:11, 57.79it/s]backtest loop:  32%|███▏      | 315/971 [00:05<00:11, 55.97it/s]backtest loop:  33%|███▎      | 322/971 [00:05<00:11, 58.21it/s]backtest loop:  34%|███▍      | 329/971 [00:06<00:10, 59.69it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:11, 56.74it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:10, 58.54it/s]backtest loop:  36%|███▌      | 348/971 [00:06<00:10, 58.75it/s]backtest loop:  37%|███▋      | 355/971 [00:06<00:10, 56.66it/s]backtest loop:  37%|███▋      | 362/971 [00:06<00:10, 58.78it/s]backtest loop:  38%|███▊      | 368/971 [00:06<00:11, 53.44it/s]backtest loop:  39%|███▊      | 375/971 [00:06<00:10, 56.05it/s]backtest loop:  39%|███▉      | 381/971 [00:06<00:10, 56.92it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:10, 55.83it/s]backtest loop:  41%|████      | 395/971 [00:07<00:09, 57.90it/s]backtest loop:  41%|████▏     | 401/971 [00:07<00:09, 58.02it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:10, 56.16it/s]backtest loop:  43%|████▎     | 415/971 [00:07<00:09, 57.80it/s]backtest loop:  43%|████▎     | 422/971 [00:07<00:09, 59.31it/s]backtest loop:  44%|████▍     | 428/971 [00:07<00:09, 56.16it/s]backtest loop:  45%|████▍     | 435/971 [00:07<00:09, 57.93it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:09, 56.21it/s]backtest loop:  46%|████▌     | 448/971 [00:08<00:09, 57.17it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:08, 57.69it/s]backtest loop:  47%|████▋     | 461/971 [00:08<00:08, 59.19it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:08, 56.08it/s]backtest loop:  49%|████▉     | 474/971 [00:08<00:08, 58.06it/s]backtest loop:  50%|████▉     | 481/971 [00:08<00:08, 59.58it/s]backtest loop:  50%|█████     | 487/971 [00:08<00:08, 56.71it/s]backtest loop:  51%|█████     | 494/971 [00:08<00:08, 58.49it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 55.52it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 54.82it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 57.06it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 58.81it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:07, 55.96it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:07, 55.70it/s]backtest loop:  56%|█████▌    | 540/971 [00:09<00:07, 57.86it/s]backtest loop:  56%|█████▌    | 546/971 [00:09<00:07, 54.86it/s]backtest loop:  57%|█████▋    | 553/971 [00:09<00:07, 56.96it/s]backtest loop:  58%|█████▊    | 560/971 [00:10<00:07, 58.55it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 55.68it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:06, 57.58it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 59.19it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:06, 55.91it/s]backtest loop:  61%|██████    | 593/971 [00:10<00:06, 57.75it/s]backtest loop:  62%|██████▏   | 599/971 [00:10<00:06, 57.65it/s]backtest loop:  62%|██████▏   | 605/971 [00:10<00:06, 55.19it/s]backtest loop:  63%|██████▎   | 611/971 [00:10<00:06, 56.50it/s]backtest loop:  64%|██████▎   | 618/971 [00:11<00:06, 58.23it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 56.16it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 57.82it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 59.28it/s]backtest loop:  66%|██████▋   | 645/971 [00:11<00:05, 55.71it/s]backtest loop:  67%|██████▋   | 652/971 [00:11<00:05, 57.79it/s]backtest loop:  68%|██████▊   | 659/971 [00:11<00:05, 59.39it/s]backtest loop:  68%|██████▊   | 665/971 [00:11<00:05, 56.26it/s]backtest loop:  69%|██████▉   | 672/971 [00:12<00:05, 57.97it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 56.08it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 56.85it/s]backtest loop:  71%|███████▏  | 692/971 [00:12<00:04, 58.43it/s]backtest loop:  72%|███████▏  | 698/971 [00:12<00:04, 58.36it/s]backtest loop:  73%|███████▎  | 704/971 [00:12<00:04, 55.47it/s]backtest loop:  73%|███████▎  | 711/971 [00:12<00:04, 57.42it/s]backtest loop:  74%|███████▍  | 718/971 [00:12<00:04, 58.91it/s]backtest loop:  75%|███████▍  | 724/971 [00:12<00:04, 56.04it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 54.66it/s]backtest loop:  76%|███████▌  | 737/971 [00:13<00:04, 55.71it/s]backtest loop:  77%|███████▋  | 743/971 [00:13<00:04, 52.86it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 52.72it/s]backtest loop:  78%|███████▊  | 757/971 [00:13<00:03, 55.59it/s]backtest loop:  79%|███████▊  | 764/971 [00:13<00:03, 57.61it/s]backtest loop:  79%|███████▉  | 770/971 [00:13<00:03, 55.73it/s]backtest loop:  80%|████████  | 777/971 [00:13<00:03, 58.57it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 55.93it/s]backtest loop:  81%|████████▏ | 789/971 [00:14<00:03, 56.62it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.50it/s]backtest loop:  82%|████████▏ | 801/971 [00:14<00:02, 58.07it/s]backtest loop:  83%|████████▎ | 807/971 [00:14<00:02, 58.60it/s]backtest loop:  84%|████████▎ | 813/971 [00:14<00:02, 55.55it/s]backtest loop:  84%|████████▍ | 820/971 [00:14<00:02, 57.57it/s]backtest loop:  85%|████████▌ | 827/971 [00:14<00:02, 58.96it/s]backtest loop:  86%|████████▌ | 833/971 [00:14<00:02, 55.88it/s]backtest loop:  86%|████████▋ | 839/971 [00:14<00:02, 56.60it/s]backtest loop:  87%|████████▋ | 846/971 [00:15<00:02, 58.39it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 55.51it/s]backtest loop:  88%|████████▊ | 859/971 [00:15<00:01, 57.47it/s]backtest loop:  89%|████████▉ | 865/971 [00:15<00:01, 57.86it/s]backtest loop:  90%|████████▉ | 871/971 [00:15<00:01, 58.33it/s]backtest loop:  90%|█████████ | 877/971 [00:15<00:01, 55.37it/s]backtest loop:  91%|█████████ | 884/971 [00:15<00:01, 57.47it/s]backtest loop:  92%|█████████▏| 890/971 [00:15<00:01, 57.58it/s]backtest loop:  92%|█████████▏| 896/971 [00:15<00:01, 58.26it/s]backtest loop:  93%|█████████▎| 902/971 [00:16<00:01, 54.98it/s]backtest loop:  94%|█████████▎| 908/971 [00:16<00:01, 56.29it/s]backtest loop:  94%|█████████▍| 915/971 [00:16<00:00, 58.12it/s]backtest loop:  95%|█████████▍| 921/971 [00:16<00:00, 55.25it/s]backtest loop:  95%|█████████▌| 927/971 [00:16<00:00, 56.55it/s]backtest loop:  96%|█████████▌| 933/971 [00:16<00:00, 57.06it/s]backtest loop:  97%|█████████▋| 939/971 [00:16<00:00, 57.82it/s]backtest loop:  97%|█████████▋| 945/971 [00:16<00:00, 54.88it/s]backtest loop:  98%|█████████▊| 951/971 [00:16<00:00, 56.17it/s]backtest loop:  99%|█████████▊| 958/971 [00:17<00:00, 58.05it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 56.08it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 56.12it/s]
[3004062:MainThread](2024-04-25 03:12:41,280) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000373
std                0.005029
annualized_return  0.088664
information_ratio  1.142787
max_drawdown      -0.124957
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000179
std                0.005030
annualized_return  0.042678
information_ratio  0.550010
max_drawdown      -0.149426
[3004062:MainThread](2024-04-25 03:12:41,295) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 47
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-25_01:25:15_online`.
Round 10 Done!
{'1day.excess_return_with_cost.annualized_return': [0.06015972005648005,
                                                    0.03273059938414068,
                                                    0.05947816937582371,
                                                    0.0076356952206925776,
                                                    0.05119321329664117,
                                                    0.05152240617919004,
                                                    0.026766665197175268,
                                                    0.07906448012082298,
                                                    0.02943458316401825,
                                                    0.042678088545007715],
 '1day.excess_return_with_cost.information_ratio': [0.7679933092923739,
                                                    0.4133389026554145,
                                                    0.7636301919612586,
                                                    0.0978136867244855,
                                                    0.6747217921818092,
                                                    0.6545829389734713,
                                                    0.3298821485447942,
                                                    1.0336294034258753,
                                                    0.3599871801442111,
                                                    0.5500096009311267],
 '1day.excess_return_with_cost.max_drawdown': [-0.08670293338962837,
                                               -0.16197255475157407,
                                               -0.10150852344205823,
                                               -0.1665674035171944,
                                               -0.11355296002422188,
                                               -0.16250574143268212,
                                               -0.12418988691040042,
                                               -0.0966524211866357,
                                               -0.16147170612600675,
                                               -0.1494261974954724],
 'IC': [0.027040578141343165,
        0.02653395980121937,
        0.026817808553124933,
        0.02854324574140338,
        0.026814229044106942,
        0.028441496398551678,
        0.024732389642783594,
        0.02674986454272586,
        0.022639728174907545,
        0.025941891439215062],
 'ICIR': [0.22347151688066197,
          0.22642606515849942,
          0.24265733154989236,
          0.24787481021777158,
          0.22370551351917856,
          0.23361485235931148,
          0.214673256268981,
          0.2361810357877373,
          0.18918663356680376,
          0.2296716924037541],
 'Rank IC': [0.023053889583337525,
             0.02273519521648915,
             0.022998778503316525,
             0.024537121375718042,
             0.024870332765134055,
             0.023579509676170216,
             0.019972407900258712,
             0.01962798984676832,
             0.018600829778738465,
             0.023802406571708387],
 'Rank ICIR': [0.19913024732178053,
               0.20377985954373565,
               0.21844485445366277,
               0.21715884654157896,
               0.21568508976946332,
               0.19894632220749242,
               0.17740286536494682,
               0.17582870546691637,
               0.1639582249710289,
               0.21376244409662987],
 'mae': [0.686060905456543,
         0.6859773397445679,
         0.6860173940658569,
         0.6859692335128784,
         0.6860255599021912,
         0.6859720349311829,
         0.6861683130264282,
         0.686046838760376,
         0.6862642765045166,
         0.6859844923019409],
 'mse': [0.9976044297218323,
         0.9977508783340454,
         0.9977036714553833,
         0.9974674582481384,
         0.9975618124008179,
         0.997508704662323,
         0.9978338479995728,
         0.9976094961166382,
         0.9979729652404785,
         0.9976558685302734]}
[3004062:MainThread](2024-04-25 03:12:42,658) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name csi500_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-25_01:25:15_final.
[3004062:MainThread](2024-04-25 03:12:42,695) INFO - qlib.workflow - [exp.py:258] - Experiment 48 starts running ...
[3004062:MainThread](2024-04-25 03:12:42,710) INFO - qlib.workflow - [recorder.py:341] - Recorder 1304e62d91894e648f6cafd040787ac8 starts running under Experiment 48 ...
Time cost: 574.6187909603119	70.12736103534698
Final results:
{'1day.excess_return_with_cost.annualized_return': [0.04406636205399925,
                                                    0.019490412045305106],
 '1day.excess_return_with_cost.information_ratio': [0.564558915483482,
                                                    0.25673630359040434],
 '1day.excess_return_with_cost.max_drawdown': [-0.13245503282758744,
                                               0.02970915653716316],
 'IC': [0.026425519147938153, 0.001636519783246894],
 'ICIR': [0.22674627077125914, 0.015559190548890984],
 'Rank IC': [0.02237784612176394, 0.00207201139594457],
 'Rank ICIR': [0.19840974597372357, 0.01858715165242697],
 'mae': [0.6860486388206481, 9.157281304016121e-05],
 'mse': [0.9976669132709504, 0.00014598550623376918]}
Your final results can be found in the experiment named `csi500_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-25_01:25:15_final`.
All Done!
[3004062:MainThread](2024-04-25 03:12:44,017) INFO - qlib.timer - [log.py:127] - Time cost: 0.035s | waiting `async_log` Done

['main.py', 'run_all', '--forecast_model', 'Transformer', '-num_head', '8', '--train_start=2008-01-01', '--train_end=2018-12-31', '--valid_start=2019-01-01', '--valid_end=2020-03-31', '--test_start=2020-04-01', '--test_end=2024-03-31', '--tau', '10', '--lr_da', '0.001', '--market', 'csi500', '--data_dir', 'crowd_data', '--rank_label', 'False', '--begin_valid_epoch', '20']
[3047527:MainThread](2024-04-25 03:12:48,738) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[3047527:MainThread](2024-04-25 03:12:48,740) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[3047527:MainThread](2024-04-25 03:12:48,740) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/crowd_data')}
Remove CSRankNorm
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi500', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'TransformerModel', 'module_path': 'qlib.contrib.model.pytorch_transformer', 'kwargs': {'d_feat': 6, 'seed': None, 'dim_feedforward': 32, 'reg': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi500_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
[3047527:MainThread](2024-04-25 03:12:59,886) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'TransformerModel', 'module_path': 'qlib.contrib.model.pytorch_transformer', 'kwargs': {'d_feat': 6, 'seed': None, 'dim_feedforward': 32, 'reg': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi500_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-02 00:00:00'), Timestamp('2008-01-29 00:00:00')), 'test': (Timestamp('2008-01-31 00:00:00'), Timestamp('2008-03-05 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/147 [00:00<?, ?it/s]creating meta tasks:  24%|██▍       | 36/147 [00:00<00:00, 358.66it/s]creating meta tasks:  53%|█████▎    | 78/147 [00:00<00:00, 394.51it/s]creating meta tasks:  82%|████████▏ | 120/147 [00:00<00:00, 403.34it/s]creating meta tasks: 100%|██████████| 147/147 [00:00<00:00, 401.17it/s]
[3047527:MainThread](2024-04-25 03:13:00,723) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'TransformerModel', 'module_path': 'qlib.contrib.model.pytorch_transformer', 'kwargs': {'d_feat': 6, 'seed': None, 'dim_feedforward': 32, 'reg': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi500_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2019-01-02 00:00:00'), Timestamp('2019-01-29 00:00:00')), 'test': (Timestamp('2019-01-31 00:00:00'), Timestamp('2019-03-06 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/63 [00:00<?, ?it/s]creating meta tasks:  54%|█████▍    | 34/63 [00:00<00:00, 330.68it/s]creating meta tasks: 100%|██████████| 63/63 [00:00<00:00, 331.49it/s]
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3047527:MainThread](2024-04-25 03:13:02,062) INFO - qlib.TransformerModel - [pytorch_transformer.py:66] - Naive Transformer:
batch_size : 2048
dim : 32
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:29<48:12, 29.22s/it]epoch:   2%|▏         | 2/100 [00:56<45:58, 28.15s/it]epoch:   3%|▎         | 3/100 [01:24<45:09, 27.93s/it]epoch:   4%|▍         | 4/100 [01:51<44:17, 27.68s/it]epoch:   5%|▌         | 5/100 [02:19<43:43, 27.62s/it]epoch:   6%|▌         | 6/100 [02:46<43:05, 27.51s/it]epoch:   7%|▋         | 7/100 [03:14<42:42, 27.55s/it]epoch:   8%|▊         | 8/100 [03:41<42:11, 27.52s/it]epoch:   9%|▉         | 9/100 [04:08<41:43, 27.51s/it]epoch:  10%|█         | 10/100 [04:36<41:07, 27.42s/it]epoch:  11%|█         | 11/100 [05:04<40:51, 27.55s/it]epoch:  12%|█▏        | 12/100 [05:31<40:20, 27.51s/it]epoch:  13%|█▎        | 13/100 [05:58<39:51, 27.49s/it]epoch:  14%|█▍        | 14/100 [06:26<39:26, 27.52s/it]epoch:  15%|█▌        | 15/100 [06:53<38:53, 27.45s/it]epoch:  16%|█▌        | 16/100 [07:21<38:33, 27.54s/it]epoch:  17%|█▋        | 17/100 [07:48<38:02, 27.50s/it]epoch:  18%|█▊        | 18/100 [08:16<37:34, 27.49s/it]epoch:  19%|█▉        | 19/100 [08:43<37:04, 27.46s/it]epoch:  20%|██        | 20/100 [09:11<36:38, 27.48s/it]0.036109125850063435
best ic: 0.036109125850063435
epoch:  21%|██        | 21/100 [09:42<37:27, 28.45s/it]0.033502886851422796
epoch:  22%|██▏       | 22/100 [10:12<37:58, 29.21s/it]0.03652769287192492
best ic: 0.03652769287192492
epoch:  23%|██▎       | 23/100 [10:43<37:59, 29.60s/it]0.03574399184185663
epoch:  24%|██▍       | 24/100 [11:14<38:04, 30.06s/it]0.042409781927792004
best ic: 0.042409781927792004
epoch:  25%|██▌       | 25/100 [11:45<37:43, 30.18s/it]0.04071673646178764
epoch:  26%|██▌       | 26/100 [12:16<37:31, 30.42s/it]0.026613604385971393
epoch:  27%|██▋       | 27/100 [12:46<37:03, 30.46s/it]0.040162205028881966
epoch:  28%|██▊       | 28/100 [13:17<36:42, 30.59s/it]0.04319211288883162
best ic: 0.04319211288883162
epoch:  29%|██▉       | 29/100 [13:48<36:13, 30.61s/it]0.04305622190355949
epoch:  30%|███       | 30/100 [14:18<35:44, 30.64s/it]0.045812356266472516
best ic: 0.045812356266472516
epoch:  31%|███       | 31/100 [14:49<35:19, 30.71s/it]0.04526576422833403
epoch:  32%|███▏      | 32/100 [15:20<34:49, 30.73s/it]0.031538834739676634
epoch:  33%|███▎      | 33/100 [15:51<34:22, 30.78s/it]0.04736616743895298
best ic: 0.04736616743895298
epoch:  34%|███▍      | 34/100 [16:22<33:46, 30.71s/it]0.04704210041839879
epoch:  35%|███▌      | 35/100 [16:53<33:24, 30.83s/it]0.042555915262257195
epoch:  36%|███▌      | 36/100 [17:23<32:46, 30.73s/it]0.04798556855579195
best ic: 0.04798556855579195
epoch:  37%|███▋      | 37/100 [17:54<32:20, 30.80s/it]0.0470268179490588
epoch:  38%|███▊      | 38/100 [18:25<31:47, 30.77s/it]0.041216354832348374
epoch:  39%|███▉      | 39/100 [18:56<31:19, 30.81s/it]0.04598873125202232
epoch:  40%|████      | 40/100 [19:26<30:45, 30.76s/it]0.04949819078876457
best ic: 0.04949819078876457
epoch:  41%|████      | 41/100 [19:57<30:19, 30.84s/it]0.044903264363921884
epoch:  42%|████▏     | 42/100 [20:28<29:44, 30.76s/it]0.03166567777569391
epoch:  43%|████▎     | 43/100 [20:59<29:15, 30.80s/it]0.04623208457346941
epoch:  44%|████▍     | 44/100 [21:30<28:43, 30.77s/it]0.04998507271630202
best ic: 0.04998507271630202
epoch:  45%|████▌     | 45/100 [22:00<28:13, 30.79s/it]0.05076524155407479
best ic: 0.05076524155407479
epoch:  46%|████▌     | 46/100 [22:31<27:38, 30.72s/it]0.04918553883801895
epoch:  47%|████▋     | 47/100 [23:02<27:14, 30.83s/it]0.042469786735350824
epoch:  48%|████▊     | 48/100 [23:33<26:38, 30.74s/it]0.030545001542359458
epoch:  49%|████▉     | 49/100 [24:04<26:11, 30.81s/it]0.04704905955101452
epoch:  50%|█████     | 50/100 [24:34<25:37, 30.74s/it]0.044798930758759625
epoch:  51%|█████     | 51/100 [25:05<25:08, 30.78s/it]0.04705918835689169
epoch:  52%|█████▏    | 52/100 [25:36<24:38, 30.79s/it]0.04892420806824244
epoch:  53%|█████▎    | 53/100 [26:06<24:05, 30.76s/it]0.045249974589067654
epoch:  53%|█████▎    | 53/100 [26:37<23:36, 30.15s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3047527:MainThread](2024-04-25 03:39:42,610) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name csi500_Transformer_alpha360_horizon1_step20_rankFalse_2024-04-25_03:13:01_online.
[3047527:MainThread](2024-04-25 03:39:42,648) INFO - qlib.workflow - [exp.py:258] - Experiment 49 starts running ...
[3047527:MainThread](2024-04-25 03:39:43,810) INFO - qlib.workflow - [recorder.py:341] - Recorder a78619a80e954533a744e0a57c5a46c1 starts running under Experiment 49 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:11,  5.57it/s]online:   3%|▎         | 2/63 [00:00<00:12,  4.98it/s]online:   5%|▍         | 3/63 [00:00<00:12,  4.81it/s]online:   6%|▋         | 4/63 [00:00<00:12,  4.73it/s]online:   8%|▊         | 5/63 [00:01<00:12,  4.65it/s]online:  10%|▉         | 6/63 [00:01<00:12,  4.64it/s]online:  11%|█         | 7/63 [00:01<00:12,  4.61it/s]online:  13%|█▎        | 8/63 [00:01<00:11,  4.61it/s]online:  14%|█▍        | 9/63 [00:01<00:11,  4.59it/s]online:  16%|█▌        | 10/63 [00:02<00:11,  4.60it/s]online:  17%|█▋        | 11/63 [00:02<00:11,  4.59it/s]online:  19%|█▉        | 12/63 [00:02<00:11,  4.60it/s]online:  21%|██        | 13/63 [00:02<00:10,  4.58it/s]online:  22%|██▏       | 14/63 [00:03<00:10,  4.56it/s]online:  24%|██▍       | 15/63 [00:03<00:10,  4.58it/s]online:  25%|██▌       | 16/63 [00:03<00:10,  4.57it/s]online:  27%|██▋       | 17/63 [00:03<00:10,  4.56it/s]online:  29%|██▊       | 18/63 [00:03<00:09,  4.58it/s]online:  30%|███       | 19/63 [00:04<00:09,  4.56it/s]online:  32%|███▏      | 20/63 [00:04<00:09,  4.55it/s]online:  33%|███▎      | 21/63 [00:04<00:09,  4.56it/s]online:  35%|███▍      | 22/63 [00:04<00:09,  4.55it/s]online:  37%|███▋      | 23/63 [00:04<00:08,  4.55it/s]online:  38%|███▊      | 24/63 [00:05<00:08,  4.57it/s]online:  40%|███▉      | 25/63 [00:05<00:08,  4.59it/s]online:  41%|████▏     | 26/63 [00:05<00:08,  4.58it/s]online:  43%|████▎     | 27/63 [00:05<00:07,  4.58it/s]online:  44%|████▍     | 28/63 [00:06<00:07,  4.56it/s]online:  46%|████▌     | 29/63 [00:06<00:07,  4.57it/s]online:  48%|████▊     | 30/63 [00:06<00:07,  4.58it/s]online:  49%|████▉     | 31/63 [00:06<00:07,  4.56it/s]online:  51%|█████     | 32/63 [00:06<00:06,  4.58it/s]online:  52%|█████▏    | 33/63 [00:07<00:06,  4.55it/s]online:  54%|█████▍    | 34/63 [00:07<00:06,  4.60it/s]online:  56%|█████▌    | 35/63 [00:07<00:06,  4.59it/s]online:  57%|█████▋    | 36/63 [00:07<00:05,  4.58it/s]online:  59%|█████▊    | 37/63 [00:08<00:05,  4.57it/s]online:  60%|██████    | 38/63 [00:08<00:05,  4.60it/s]online:  62%|██████▏   | 39/63 [00:08<00:05,  4.56it/s]online:  63%|██████▎   | 40/63 [00:08<00:05,  4.58it/s]online:  65%|██████▌   | 41/63 [00:08<00:04,  4.60it/s]online:  67%|██████▋   | 42/63 [00:09<00:04,  4.56it/s]online:  68%|██████▊   | 43/63 [00:09<00:04,  4.58it/s]online:  70%|██████▉   | 44/63 [00:09<00:04,  4.60it/s]online:  71%|███████▏  | 45/63 [00:09<00:03,  4.55it/s]online:  73%|███████▎  | 46/63 [00:10<00:03,  4.60it/s]online:  75%|███████▍  | 47/63 [00:10<00:03,  4.58it/s]online:  76%|███████▌  | 48/63 [00:10<00:03,  4.62it/s]online:  78%|███████▊  | 49/63 [00:10<00:03,  4.58it/s]online:  79%|███████▉  | 50/63 [00:10<00:02,  4.58it/s]online:  81%|████████  | 51/63 [00:11<00:02,  4.58it/s]online:  83%|████████▎ | 52/63 [00:11<00:02,  4.62it/s]online:  84%|████████▍ | 53/63 [00:11<00:02,  4.61it/s]online:  86%|████████▌ | 54/63 [00:11<00:01,  4.59it/s]online:  87%|████████▋ | 55/63 [00:11<00:01,  4.58it/s]online:  89%|████████▉ | 56/63 [00:12<00:01,  4.58it/s]online:  90%|█████████ | 57/63 [00:12<00:01,  4.57it/s]online:  92%|█████████▏| 58/63 [00:12<00:01,  4.61it/s]online:  94%|█████████▎| 59/63 [00:12<00:00,  4.63it/s]online:  95%|█████████▌| 60/63 [00:13<00:00,  4.56it/s]online:  97%|█████████▋| 61/63 [00:13<00:00,  4.57it/s]online:  98%|█████████▊| 62/63 [00:13<00:00,  4.59it/s]online: 100%|██████████| 63/63 [00:13<00:00,  4.71it/s]online: 100%|██████████| 63/63 [00:13<00:00,  4.60it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.001
[3047527:MainThread](2024-04-25 03:40:13,059) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99723506 mae 0.68572414
{'IC': 0.02338127556803707,
 'ICIR': 0.20238622048809674,
 'Rank IC': 0.013917040518004948,
 'Rank ICIR': 0.12551679322509657}
[3047527:MainThread](2024-04-25 03:40:14,855) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3047527:MainThread](2024-04-25 03:40:28,096) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 03:40:28,099) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 03:40:34,177) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f6e00d9a040>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 6/971 [00:00<00:17, 55.31it/s]backtest loop:   1%|          | 12/971 [00:00<00:18, 51.77it/s]backtest loop:   2%|▏         | 18/971 [00:00<00:17, 55.16it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:17, 52.80it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:16, 56.20it/s]backtest loop:   4%|▍         | 38/971 [00:00<00:16, 58.24it/s]backtest loop:   5%|▍         | 44/971 [00:00<00:16, 55.01it/s]backtest loop:   5%|▌         | 51/971 [00:00<00:16, 57.35it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:16, 54.62it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:15, 57.12it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:15, 59.30it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:15, 56.13it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 57.94it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 59.82it/s]backtest loop:  10%|█         | 98/971 [00:01<00:15, 57.56it/s]backtest loop:  11%|█         | 104/971 [00:01<00:14, 58.11it/s]backtest loop:  11%|█▏        | 110/971 [00:01<00:14, 58.46it/s]backtest loop:  12%|█▏        | 116/971 [00:02<00:14, 58.73it/s]backtest loop:  13%|█▎        | 122/971 [00:02<00:15, 55.94it/s]backtest loop:  13%|█▎        | 128/971 [00:02<00:15, 53.77it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:14, 56.40it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 53.80it/s]backtest loop:  15%|█▌        | 147/971 [00:02<00:14, 55.41it/s]backtest loop:  16%|█▌        | 153/971 [00:02<00:14, 56.61it/s]backtest loop:  16%|█▋        | 160/971 [00:02<00:13, 58.49it/s]backtest loop:  17%|█▋        | 166/971 [00:02<00:14, 55.73it/s]backtest loop:  18%|█▊        | 172/971 [00:03<00:14, 54.58it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:14, 55.34it/s]backtest loop:  19%|█▉        | 184/971 [00:03<00:14, 55.45it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:14, 52.53it/s]backtest loop:  20%|██        | 196/971 [00:03<00:14, 54.27it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 55.42it/s]backtest loop:  21%|██▏       | 208/971 [00:03<00:13, 56.10it/s]backtest loop:  22%|██▏       | 214/971 [00:03<00:14, 52.31it/s]backtest loop:  23%|██▎       | 220/971 [00:03<00:15, 49.89it/s]backtest loop:  23%|██▎       | 226/971 [00:04<00:14, 51.44it/s]backtest loop:  24%|██▍       | 232/971 [00:04<00:14, 52.22it/s]backtest loop:  25%|██▍       | 238/971 [00:04<00:13, 53.04it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:13, 53.57it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:14, 51.05it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:13, 52.33it/s]backtest loop:  27%|██▋       | 262/971 [00:04<00:13, 53.06it/s]backtest loop:  28%|██▊       | 268/971 [00:04<00:13, 50.82it/s]backtest loop:  28%|██▊       | 274/971 [00:04<00:13, 51.89it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:13, 52.80it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:13, 50.36it/s]backtest loop:  30%|███       | 292/971 [00:05<00:13, 51.58it/s]backtest loop:  31%|███       | 298/971 [00:05<00:12, 52.80it/s]backtest loop:  31%|███▏      | 304/971 [00:05<00:12, 53.51it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:13, 50.58it/s]backtest loop:  33%|███▎      | 316/971 [00:05<00:12, 52.02it/s]backtest loop:  33%|███▎      | 322/971 [00:05<00:12, 53.24it/s]backtest loop:  34%|███▍      | 328/971 [00:06<00:11, 53.77it/s]backtest loop:  34%|███▍      | 334/971 [00:06<00:11, 54.37it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:12, 51.42it/s]backtest loop:  36%|███▌      | 346/971 [00:06<00:11, 52.48it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:11, 53.76it/s]backtest loop:  37%|███▋      | 358/971 [00:06<00:11, 54.27it/s]backtest loop:  37%|███▋      | 364/971 [00:06<00:11, 51.96it/s]backtest loop:  38%|███▊      | 370/971 [00:06<00:12, 49.81it/s]backtest loop:  39%|███▊      | 376/971 [00:06<00:11, 51.78it/s]backtest loop:  39%|███▉      | 382/971 [00:07<00:11, 52.92it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:11, 50.26it/s]backtest loop:  41%|████      | 394/971 [00:07<00:11, 51.91it/s]backtest loop:  41%|████      | 400/971 [00:07<00:10, 52.94it/s]backtest loop:  42%|████▏     | 406/971 [00:07<00:10, 53.54it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:10, 53.72it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:10, 50.90it/s]backtest loop:  44%|████▎     | 424/971 [00:07<00:10, 52.06it/s]backtest loop:  44%|████▍     | 430/971 [00:07<00:10, 52.87it/s]backtest loop:  45%|████▍     | 436/971 [00:08<00:10, 53.50it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:10, 50.87it/s]backtest loop:  46%|████▌     | 448/971 [00:08<00:10, 51.83it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:09, 52.95it/s]backtest loop:  47%|████▋     | 460/971 [00:08<00:09, 53.57it/s]backtest loop:  48%|████▊     | 466/971 [00:08<00:09, 53.97it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:09, 51.46it/s]backtest loop:  49%|████▉     | 478/971 [00:08<00:09, 52.70it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:09, 53.50it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:09, 50.86it/s]backtest loop:  51%|█████     | 496/971 [00:09<00:09, 52.55it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:08, 53.79it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:09, 50.72it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 51.87it/s]backtest loop:  54%|█████▎    | 520/971 [00:09<00:08, 52.89it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 50.49it/s]backtest loop:  55%|█████▍    | 532/971 [00:09<00:08, 51.91it/s]backtest loop:  55%|█████▌    | 538/971 [00:10<00:08, 52.72it/s]backtest loop:  56%|█████▌    | 544/971 [00:10<00:08, 53.37it/s]backtest loop:  57%|█████▋    | 550/971 [00:10<00:07, 53.91it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:08, 51.31it/s]backtest loop:  58%|█████▊    | 562/971 [00:10<00:07, 52.71it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:07, 53.31it/s]backtest loop:  59%|█████▉    | 574/971 [00:10<00:07, 53.71it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:07, 54.16it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:07, 51.23it/s]backtest loop:  61%|██████    | 592/971 [00:11<00:07, 52.36it/s]backtest loop:  62%|██████▏   | 598/971 [00:11<00:07, 53.12it/s]backtest loop:  62%|██████▏   | 604/971 [00:11<00:06, 53.68it/s]backtest loop:  63%|██████▎   | 610/971 [00:11<00:07, 50.82it/s]backtest loop:  63%|██████▎   | 616/971 [00:11<00:06, 52.20it/s]backtest loop:  64%|██████▍   | 622/971 [00:11<00:06, 53.07it/s]backtest loop:  65%|██████▍   | 628/971 [00:11<00:06, 53.79it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:06, 54.01it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:06, 51.25it/s]backtest loop:  67%|██████▋   | 646/971 [00:12<00:06, 52.45it/s]backtest loop:  67%|██████▋   | 652/971 [00:12<00:05, 53.58it/s]backtest loop:  68%|██████▊   | 658/971 [00:12<00:05, 54.35it/s]backtest loop:  68%|██████▊   | 664/971 [00:12<00:05, 54.35it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 51.11it/s]backtest loop:  70%|██████▉   | 676/971 [00:12<00:05, 52.31it/s]backtest loop:  70%|███████   | 682/971 [00:12<00:05, 53.12it/s]backtest loop:  71%|███████   | 688/971 [00:12<00:05, 53.58it/s]backtest loop:  71%|███████▏  | 694/971 [00:13<00:05, 50.76it/s]backtest loop:  72%|███████▏  | 700/971 [00:13<00:05, 52.23it/s]backtest loop:  73%|███████▎  | 706/971 [00:13<00:04, 53.02it/s]backtest loop:  73%|███████▎  | 712/971 [00:13<00:04, 53.76it/s]backtest loop:  74%|███████▍  | 718/971 [00:13<00:04, 54.25it/s]backtest loop:  75%|███████▍  | 724/971 [00:13<00:04, 51.42it/s]backtest loop:  75%|███████▌  | 730/971 [00:13<00:04, 52.84it/s]backtest loop:  76%|███████▌  | 736/971 [00:13<00:04, 50.58it/s]backtest loop:  76%|███████▋  | 742/971 [00:13<00:04, 51.87it/s]backtest loop:  77%|███████▋  | 748/971 [00:14<00:04, 49.79it/s]backtest loop:  78%|███████▊  | 754/971 [00:14<00:04, 51.21it/s]backtest loop:  78%|███████▊  | 760/971 [00:14<00:04, 49.50it/s]backtest loop:  79%|███████▉  | 766/971 [00:14<00:04, 51.20it/s]backtest loop:  80%|███████▉  | 772/971 [00:14<00:03, 52.62it/s]backtest loop:  80%|████████  | 778/971 [00:14<00:03, 53.68it/s]backtest loop:  81%|████████  | 784/971 [00:14<00:03, 50.86it/s]backtest loop:  81%|████████▏ | 790/971 [00:14<00:03, 52.03it/s]backtest loop:  82%|████████▏ | 796/971 [00:14<00:03, 52.91it/s]backtest loop:  83%|████████▎ | 802/971 [00:15<00:03, 53.28it/s]backtest loop:  83%|████████▎ | 808/971 [00:15<00:03, 50.73it/s]backtest loop:  84%|████████▍ | 814/971 [00:15<00:03, 51.77it/s]backtest loop:  84%|████████▍ | 820/971 [00:15<00:02, 53.01it/s]backtest loop:  85%|████████▌ | 826/971 [00:15<00:02, 53.63it/s]backtest loop:  86%|████████▌ | 832/971 [00:15<00:02, 54.09it/s]backtest loop:  86%|████████▋ | 838/971 [00:15<00:02, 51.14it/s]backtest loop:  87%|████████▋ | 844/971 [00:15<00:02, 52.09it/s]backtest loop:  88%|████████▊ | 850/971 [00:15<00:02, 52.88it/s]backtest loop:  88%|████████▊ | 856/971 [00:16<00:02, 53.55it/s]backtest loop:  89%|████████▉ | 862/971 [00:16<00:02, 50.91it/s]backtest loop:  89%|████████▉ | 868/971 [00:16<00:01, 52.12it/s]backtest loop:  90%|█████████ | 874/971 [00:16<00:01, 52.78it/s]backtest loop:  91%|█████████ | 880/971 [00:16<00:01, 53.57it/s]backtest loop:  91%|█████████ | 886/971 [00:16<00:01, 54.15it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 51.24it/s]backtest loop:  92%|█████████▏| 898/971 [00:16<00:01, 52.56it/s]backtest loop:  93%|█████████▎| 904/971 [00:17<00:01, 53.22it/s]backtest loop:  94%|█████████▎| 910/971 [00:17<00:01, 53.63it/s]backtest loop:  94%|█████████▍| 916/971 [00:17<00:01, 50.95it/s]backtest loop:  95%|█████████▍| 922/971 [00:17<00:00, 52.15it/s]backtest loop:  96%|█████████▌| 928/971 [00:17<00:00, 52.95it/s]backtest loop:  96%|█████████▌| 934/971 [00:17<00:00, 53.86it/s]backtest loop:  97%|█████████▋| 940/971 [00:17<00:00, 51.14it/s]backtest loop:  97%|█████████▋| 946/971 [00:17<00:00, 52.41it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 53.58it/s]backtest loop:  99%|█████████▊| 958/971 [00:18<00:00, 54.08it/s]backtest loop:  99%|█████████▉| 964/971 [00:18<00:00, 54.38it/s]backtest loop: 100%|█████████▉| 970/971 [00:18<00:00, 51.09it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 53.11it/s]
[3047527:MainThread](2024-04-25 03:40:52,535) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000378
std                0.005024
annualized_return  0.089884
information_ratio  1.159676
max_drawdown      -0.087324
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000184
std                0.005025
annualized_return  0.043797
information_ratio  0.564983
max_drawdown      -0.092642
[3047527:MainThread](2024-04-25 03:40:52,553) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_Transformer_alpha360_horizon1_step20_rankFalse_2024-04-25_03:13:01_online`.
Round 1 Done!
{'1day.excess_return_with_cost.annualized_return': [0.043797486231573146],
 '1day.excess_return_with_cost.information_ratio': [0.5649832165888312],
 '1day.excess_return_with_cost.max_drawdown': [-0.09264196275626242],
 'IC': [0.02338127556803707],
 'ICIR': [0.20238622048809674],
 'Rank IC': [0.013917040518004948],
 'Rank ICIR': [0.12551679322509657],
 'mae': [0.685724139213562],
 'mse': [0.9972350597381592]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3047527:MainThread](2024-04-25 03:40:53,871) INFO - qlib.TransformerModel - [pytorch_transformer.py:66] - Naive Transformer:
batch_size : 2048
dim : 32
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:27<45:17, 27.45s/it]epoch:   2%|▏         | 2/100 [00:55<45:05, 27.60s/it]epoch:   3%|▎         | 3/100 [01:22<44:21, 27.44s/it]epoch:   4%|▍         | 4/100 [01:50<44:04, 27.55s/it]epoch:   5%|▌         | 5/100 [02:17<43:31, 27.49s/it]epoch:   6%|▌         | 6/100 [02:45<43:04, 27.49s/it]epoch:   7%|▋         | 7/100 [03:12<42:29, 27.41s/it]epoch:   8%|▊         | 8/100 [03:39<42:06, 27.46s/it]epoch:   9%|▉         | 9/100 [04:07<41:34, 27.41s/it]epoch:  10%|█         | 10/100 [04:34<41:11, 27.46s/it]epoch:  11%|█         | 11/100 [05:01<40:34, 27.36s/it]epoch:  12%|█▏        | 12/100 [05:29<40:19, 27.50s/it]epoch:  13%|█▎        | 13/100 [05:56<39:47, 27.45s/it]epoch:  14%|█▍        | 14/100 [06:24<39:25, 27.50s/it]epoch:  15%|█▌        | 15/100 [06:51<38:51, 27.43s/it]epoch:  16%|█▌        | 16/100 [07:19<38:32, 27.53s/it]epoch:  17%|█▋        | 17/100 [07:46<37:57, 27.45s/it]epoch:  18%|█▊        | 18/100 [08:14<37:31, 27.46s/it]epoch:  19%|█▉        | 19/100 [08:41<37:03, 27.45s/it]epoch:  20%|██        | 20/100 [09:09<36:34, 27.44s/it]0.04070814680756983
best ic: 0.04070814680756983
epoch:  21%|██        | 21/100 [09:40<37:28, 28.46s/it]0.04157218056858332
best ic: 0.04157218056858332
epoch:  22%|██▏       | 22/100 [10:11<37:58, 29.22s/it]0.047962023682405056
best ic: 0.047962023682405056
epoch:  23%|██▎       | 23/100 [10:41<38:05, 29.68s/it]0.044069062956629525
epoch:  24%|██▍       | 24/100 [11:12<38:06, 30.08s/it]0.044376878462557015
epoch:  25%|██▌       | 25/100 [11:43<37:52, 30.30s/it]0.04274097840557201
epoch:  26%|██▌       | 26/100 [12:14<37:45, 30.61s/it]0.045495598436945395
epoch:  27%|██▋       | 27/100 [12:45<37:16, 30.64s/it]0.03908705603875222
epoch:  28%|██▊       | 28/100 [13:16<36:54, 30.76s/it]0.04551833172471284
epoch:  29%|██▉       | 29/100 [13:47<36:26, 30.79s/it]0.04363762300867086
epoch:  30%|███       | 30/100 [14:18<36:03, 30.91s/it]0.042591240840393944
epoch:  30%|███       | 30/100 [14:49<34:35, 29.65s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3047527:MainThread](2024-04-25 03:55:43,293) INFO - qlib.workflow - [exp.py:258] - Experiment 49 starts running ...
[3047527:MainThread](2024-04-25 03:55:43,310) INFO - qlib.workflow - [recorder.py:341] - Recorder 4977a942842d408a93a89233fd005cfa starts running under Experiment 49 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:15,  3.92it/s]online:   3%|▎         | 2/63 [00:00<00:14,  4.26it/s]online:   5%|▍         | 3/63 [00:00<00:13,  4.41it/s]online:   6%|▋         | 4/63 [00:00<00:13,  4.47it/s]online:   8%|▊         | 5/63 [00:01<00:12,  4.53it/s]online:  10%|▉         | 6/63 [00:01<00:12,  4.54it/s]online:  11%|█         | 7/63 [00:01<00:12,  4.54it/s]online:  13%|█▎        | 8/63 [00:01<00:12,  4.56it/s]online:  14%|█▍        | 9/63 [00:02<00:11,  4.57it/s]online:  16%|█▌        | 10/63 [00:02<00:11,  4.57it/s]online:  17%|█▋        | 11/63 [00:02<00:11,  4.57it/s]online:  19%|█▉        | 12/63 [00:02<00:11,  4.58it/s]online:  21%|██        | 13/63 [00:02<00:10,  4.58it/s]online:  22%|██▏       | 14/63 [00:03<00:10,  4.57it/s]online:  24%|██▍       | 15/63 [00:03<00:10,  4.57it/s]online:  25%|██▌       | 16/63 [00:03<00:10,  4.58it/s]online:  27%|██▋       | 17/63 [00:03<00:10,  4.58it/s]online:  29%|██▊       | 18/63 [00:03<00:09,  4.58it/s]online:  30%|███       | 19/63 [00:04<00:09,  4.58it/s]online:  32%|███▏      | 20/63 [00:04<00:09,  4.58it/s]online:  33%|███▎      | 21/63 [00:04<00:09,  4.59it/s]online:  35%|███▍      | 22/63 [00:04<00:08,  4.57it/s]online:  37%|███▋      | 23/63 [00:05<00:08,  4.58it/s]online:  38%|███▊      | 24/63 [00:05<00:08,  4.58it/s]online:  40%|███▉      | 25/63 [00:05<00:08,  4.58it/s]online:  41%|████▏     | 26/63 [00:05<00:08,  4.58it/s]online:  43%|████▎     | 27/63 [00:05<00:07,  4.58it/s]online:  44%|████▍     | 28/63 [00:06<00:07,  4.58it/s]online:  46%|████▌     | 29/63 [00:06<00:07,  4.58it/s]online:  48%|████▊     | 30/63 [00:06<00:07,  4.57it/s]online:  49%|████▉     | 31/63 [00:06<00:07,  4.56it/s]online:  51%|█████     | 32/63 [00:07<00:06,  4.58it/s]online:  52%|█████▏    | 33/63 [00:07<00:06,  4.58it/s]online:  54%|█████▍    | 34/63 [00:07<00:06,  4.58it/s]online:  56%|█████▌    | 35/63 [00:07<00:06,  4.59it/s]online:  57%|█████▋    | 36/63 [00:07<00:05,  4.58it/s]online:  59%|█████▊    | 37/63 [00:08<00:05,  4.59it/s]online:  60%|██████    | 38/63 [00:08<00:05,  4.57it/s]online:  62%|██████▏   | 39/63 [00:08<00:05,  4.57it/s]online:  63%|██████▎   | 40/63 [00:08<00:05,  4.57it/s]online:  65%|██████▌   | 41/63 [00:08<00:04,  4.58it/s]online:  67%|██████▋   | 42/63 [00:09<00:04,  4.56it/s]online:  68%|██████▊   | 43/63 [00:09<00:04,  4.55it/s]online:  70%|██████▉   | 44/63 [00:09<00:04,  4.57it/s]online:  71%|███████▏  | 45/63 [00:09<00:03,  4.53it/s]online:  73%|███████▎  | 46/63 [00:10<00:03,  4.52it/s]online:  75%|███████▍  | 47/63 [00:10<00:04,  3.34it/s]online:  76%|███████▌  | 48/63 [00:10<00:04,  3.65it/s]online:  78%|███████▊  | 49/63 [00:11<00:03,  3.89it/s]online:  79%|███████▉  | 50/63 [00:11<00:03,  4.04it/s]online:  81%|████████  | 51/63 [00:11<00:02,  4.16it/s]online:  83%|████████▎ | 52/63 [00:11<00:02,  4.23it/s]online:  84%|████████▍ | 53/63 [00:11<00:02,  4.28it/s]online:  86%|████████▌ | 54/63 [00:12<00:02,  4.37it/s]online:  87%|████████▋ | 55/63 [00:12<00:01,  4.41it/s]online:  89%|████████▉ | 56/63 [00:12<00:01,  4.44it/s]online:  90%|█████████ | 57/63 [00:12<00:01,  4.46it/s]online:  92%|█████████▏| 58/63 [00:13<00:01,  4.48it/s]online:  94%|█████████▎| 59/63 [00:13<00:00,  4.49it/s]online:  95%|█████████▌| 60/63 [00:13<00:00,  4.52it/s]online:  97%|█████████▋| 61/63 [00:13<00:00,  4.46it/s]online:  98%|█████████▊| 62/63 [00:13<00:00,  4.51it/s]online: 100%|██████████| 63/63 [00:14<00:00,  4.68it/s]online: 100%|██████████| 63/63 [00:14<00:00,  4.47it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.001
[3047527:MainThread](2024-04-25 03:56:29,485) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9971662 mae 0.68574643
{'IC': 0.023874553769198607,
 'ICIR': 0.18560857194822403,
 'Rank IC': 0.012129057369372705,
 'Rank ICIR': 0.09548055549514188}
[3047527:MainThread](2024-04-25 03:56:31,905) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3047527:MainThread](2024-04-25 03:56:47,675) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 03:56:47,678) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 03:56:53,862) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f6e0bdb8d90>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:54,  8.48it/s]backtest loop:   1%|          | 9/971 [00:00<00:42, 22.74it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:29, 32.75it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:25, 37.35it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:22, 42.51it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 46.01it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 45.77it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:19, 48.57it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 50.41it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 48.57it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 50.49it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 52.17it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 53.73it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 54.33it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 51.49it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 52.96it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 53.55it/s]backtest loop:  11%|█         | 105/971 [00:02<00:15, 54.14it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:15, 54.97it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 51.58it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 52.51it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:16, 50.22it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:16, 51.88it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:16, 49.88it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:15, 51.55it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 52.32it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 53.20it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:14, 53.91it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 51.13it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:15, 52.12it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 52.83it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:14, 53.75it/s]backtest loop:  20%|██        | 195/971 [00:04<00:15, 51.34it/s]backtest loop:  21%|██        | 201/971 [00:04<00:14, 52.59it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:14, 53.74it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:14, 51.15it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:14, 52.09it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:14, 49.91it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:14, 51.47it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:13, 52.80it/s]backtest loop:  25%|██▌       | 243/971 [00:04<00:13, 53.44it/s]backtest loop:  26%|██▌       | 249/971 [00:05<00:14, 50.83it/s]backtest loop:  26%|██▋       | 255/971 [00:05<00:13, 52.06it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:13, 52.77it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:13, 50.51it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:13, 51.55it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:13, 52.73it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:12, 53.20it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:13, 50.77it/s]backtest loop:  31%|███       | 297/971 [00:05<00:12, 51.87it/s]backtest loop:  31%|███       | 303/971 [00:06<00:12, 52.47it/s]backtest loop:  32%|███▏      | 309/971 [00:06<00:12, 53.29it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:12, 50.83it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:12, 52.05it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:12, 53.15it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:11, 53.66it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:11, 54.18it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:12, 51.15it/s]backtest loop:  36%|███▌      | 351/971 [00:07<00:11, 52.35it/s]backtest loop:  37%|███▋      | 357/971 [00:07<00:11, 53.59it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:11, 51.85it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:12, 49.70it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 51.43it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:11, 52.50it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 53.37it/s]backtest loop:  40%|████      | 393/971 [00:07<00:11, 50.43it/s]backtest loop:  41%|████      | 399/971 [00:07<00:11, 51.67it/s]backtest loop:  42%|████▏     | 405/971 [00:08<00:10, 52.73it/s]backtest loop:  42%|████▏     | 411/971 [00:08<00:10, 53.06it/s]backtest loop:  43%|████▎     | 417/971 [00:08<00:10, 53.77it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:10, 50.84it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:10, 51.91it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:10, 52.79it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 53.45it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:10, 50.71it/s]backtest loop:  47%|████▋     | 453/971 [00:08<00:09, 51.93it/s]backtest loop:  47%|████▋     | 459/971 [00:09<00:09, 52.63it/s]backtest loop:  48%|████▊     | 465/971 [00:09<00:09, 53.34it/s]backtest loop:  49%|████▊     | 471/971 [00:09<00:09, 53.93it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 51.56it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:09, 52.88it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:09, 53.37it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:09, 50.50it/s]backtest loop:  52%|█████▏    | 501/971 [00:09<00:09, 52.01it/s]backtest loop:  52%|█████▏    | 507/971 [00:10<00:09, 50.08it/s]backtest loop:  53%|█████▎    | 513/971 [00:10<00:08, 51.42it/s]backtest loop:  53%|█████▎    | 519/971 [00:10<00:08, 52.47it/s]backtest loop:  54%|█████▍    | 525/971 [00:10<00:08, 53.39it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 50.87it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:08, 51.84it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:08, 52.95it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 53.32it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 53.93it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:07, 51.29it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:07, 52.56it/s]backtest loop:  59%|█████▉    | 573/971 [00:11<00:07, 53.29it/s]backtest loop:  60%|█████▉    | 579/971 [00:11<00:07, 53.09it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:07, 53.09it/s]backtest loop:  61%|██████    | 591/971 [00:11<00:07, 50.01it/s]backtest loop:  61%|██████▏   | 597/971 [00:11<00:07, 50.70it/s]backtest loop:  62%|██████▏   | 603/971 [00:11<00:07, 50.76it/s]backtest loop:  63%|██████▎   | 609/971 [00:11<00:06, 51.93it/s]backtest loop:  63%|██████▎   | 615/971 [00:12<00:07, 49.66it/s]backtest loop:  64%|██████▍   | 621/971 [00:12<00:06, 50.36it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:06, 51.02it/s]backtest loop:  65%|██████▌   | 633/971 [00:12<00:06, 52.15it/s]backtest loop:  66%|██████▌   | 639/971 [00:12<00:06, 53.09it/s]backtest loop:  66%|██████▋   | 645/971 [00:12<00:06, 50.41it/s]backtest loop:  67%|██████▋   | 651/971 [00:12<00:06, 51.78it/s]backtest loop:  68%|██████▊   | 657/971 [00:12<00:05, 52.85it/s]backtest loop:  68%|██████▊   | 663/971 [00:12<00:05, 53.21it/s]backtest loop:  69%|██████▉   | 669/971 [00:13<00:05, 53.68it/s]backtest loop:  70%|██████▉   | 675/971 [00:13<00:05, 50.75it/s]backtest loop:  70%|███████   | 681/971 [00:13<00:05, 51.92it/s]backtest loop:  71%|███████   | 687/971 [00:13<00:05, 52.46it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:05, 53.11it/s]backtest loop:  72%|███████▏  | 699/971 [00:13<00:05, 50.63it/s]backtest loop:  73%|███████▎  | 705/971 [00:13<00:05, 51.61it/s]backtest loop:  73%|███████▎  | 711/971 [00:13<00:04, 52.52it/s]backtest loop:  74%|███████▍  | 717/971 [00:14<00:04, 53.23it/s]backtest loop:  74%|███████▍  | 723/971 [00:14<00:04, 53.69it/s]backtest loop:  75%|███████▌  | 729/971 [00:14<00:04, 50.94it/s]backtest loop:  76%|███████▌  | 735/971 [00:14<00:04, 49.44it/s]backtest loop:  76%|███████▋  | 741/971 [00:14<00:04, 50.84it/s]backtest loop:  77%|███████▋  | 747/971 [00:14<00:04, 52.05it/s]backtest loop:  78%|███████▊  | 753/971 [00:14<00:04, 49.80it/s]backtest loop:  78%|███████▊  | 759/971 [00:14<00:04, 51.45it/s]backtest loop:  79%|███████▉  | 765/971 [00:14<00:04, 49.85it/s]backtest loop:  79%|███████▉  | 771/971 [00:15<00:03, 52.07it/s]backtest loop:  80%|████████  | 777/971 [00:15<00:03, 53.33it/s]backtest loop:  81%|████████  | 783/971 [00:15<00:03, 50.77it/s]backtest loop:  81%|████████▏ | 789/971 [00:15<00:03, 51.66it/s]backtest loop:  82%|████████▏ | 795/971 [00:15<00:03, 52.40it/s]backtest loop:  82%|████████▏ | 801/971 [00:15<00:03, 53.29it/s]backtest loop:  83%|████████▎ | 807/971 [00:15<00:03, 53.74it/s]backtest loop:  84%|████████▎ | 813/971 [00:15<00:03, 50.76it/s]backtest loop:  84%|████████▍ | 819/971 [00:16<00:02, 51.84it/s]backtest loop:  85%|████████▍ | 825/971 [00:16<00:02, 52.58it/s]backtest loop:  86%|████████▌ | 831/971 [00:16<00:02, 52.95it/s]backtest loop:  86%|████████▌ | 837/971 [00:16<00:02, 53.40it/s]backtest loop:  87%|████████▋ | 843/971 [00:16<00:02, 50.53it/s]backtest loop:  87%|████████▋ | 849/971 [00:16<00:02, 51.65it/s]backtest loop:  88%|████████▊ | 855/971 [00:16<00:02, 52.49it/s]backtest loop:  89%|████████▊ | 861/971 [00:16<00:02, 53.11it/s]backtest loop:  89%|████████▉ | 867/971 [00:16<00:02, 50.37it/s]backtest loop:  90%|████████▉ | 873/971 [00:17<00:01, 51.37it/s]backtest loop:  91%|█████████ | 879/971 [00:17<00:01, 52.34it/s]backtest loop:  91%|█████████ | 885/971 [00:17<00:01, 53.24it/s]backtest loop:  92%|█████████▏| 891/971 [00:17<00:01, 53.69it/s]backtest loop:  92%|█████████▏| 897/971 [00:17<00:01, 50.87it/s]backtest loop:  93%|█████████▎| 903/971 [00:17<00:01, 51.94it/s]backtest loop:  94%|█████████▎| 909/971 [00:17<00:01, 52.94it/s]backtest loop:  94%|█████████▍| 915/971 [00:17<00:01, 53.43it/s]backtest loop:  95%|█████████▍| 921/971 [00:17<00:00, 50.34it/s]backtest loop:  95%|█████████▌| 927/971 [00:18<00:00, 51.58it/s]backtest loop:  96%|█████████▌| 933/971 [00:18<00:00, 52.32it/s]backtest loop:  97%|█████████▋| 939/971 [00:18<00:00, 53.28it/s]backtest loop:  97%|█████████▋| 945/971 [00:18<00:00, 50.69it/s]backtest loop:  98%|█████████▊| 951/971 [00:18<00:00, 51.88it/s]backtest loop:  99%|█████████▊| 957/971 [00:18<00:00, 52.81it/s]backtest loop:  99%|█████████▉| 963/971 [00:18<00:00, 53.42it/s]backtest loop: 100%|█████████▉| 969/971 [00:18<00:00, 53.91it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 51.30it/s]
[3047527:MainThread](2024-04-25 03:57:12,866) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000461
std                0.005231
annualized_return  0.109721
information_ratio  1.359713
max_drawdown      -0.089525
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000266
std                0.005232
annualized_return  0.063423
information_ratio  0.785706
max_drawdown      -0.110421
[3047527:MainThread](2024-04-25 03:57:12,884) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_Transformer_alpha360_horizon1_step20_rankFalse_2024-04-25_03:13:01_online`.
Round 2 Done!
{'1day.excess_return_with_cost.annualized_return': [0.043797486231573146,
                                                    0.0634228370113721],
 '1day.excess_return_with_cost.information_ratio': [0.5649832165888312,
                                                    0.7857064560613483],
 '1day.excess_return_with_cost.max_drawdown': [-0.09264196275626242,
                                               -0.11042126565462691],
 'IC': [0.02338127556803707, 0.023874553769198607],
 'ICIR': [0.20238622048809674, 0.18560857194822403],
 'Rank IC': [0.013917040518004948, 0.012129057369372705],
 'Rank ICIR': [0.12551679322509657, 0.09548055549514188],
 'mae': [0.685724139213562, 0.685746431350708],
 'mse': [0.9972350597381592, 0.9971662163734436]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3047527:MainThread](2024-04-25 03:57:14,310) INFO - qlib.TransformerModel - [pytorch_transformer.py:66] - Naive Transformer:
batch_size : 2048
dim : 32
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:27<45:54, 27.82s/it]epoch:   2%|▏         | 2/100 [00:55<45:07, 27.63s/it]epoch:   3%|▎         | 3/100 [01:22<44:42, 27.65s/it]epoch:   4%|▍         | 4/100 [01:50<44:11, 27.62s/it]epoch:   5%|▌         | 5/100 [02:18<43:42, 27.61s/it]epoch:   6%|▌         | 6/100 [02:45<43:21, 27.67s/it]epoch:   7%|▋         | 7/100 [03:13<42:48, 27.62s/it]epoch:   8%|▊         | 8/100 [03:41<42:20, 27.61s/it]epoch:   9%|▉         | 9/100 [04:08<41:45, 27.53s/it]epoch:  10%|█         | 10/100 [04:36<41:27, 27.64s/it]epoch:  11%|█         | 11/100 [05:03<40:52, 27.55s/it]epoch:  12%|█▏        | 12/100 [05:31<40:26, 27.58s/it]epoch:  13%|█▎        | 13/100 [05:58<40:00, 27.59s/it]epoch:  14%|█▍        | 14/100 [06:26<39:32, 27.59s/it]epoch:  15%|█▌        | 15/100 [06:53<38:58, 27.52s/it]epoch:  16%|█▌        | 16/100 [07:21<38:36, 27.57s/it]epoch:  17%|█▋        | 17/100 [07:49<38:06, 27.55s/it]epoch:  18%|█▊        | 18/100 [08:16<37:39, 27.56s/it]epoch:  19%|█▉        | 19/100 [08:43<37:03, 27.46s/it]epoch:  20%|██        | 20/100 [09:11<36:47, 27.59s/it]0.04193809537168312
best ic: 0.04193809537168312
epoch:  21%|██        | 21/100 [09:42<37:35, 28.55s/it]0.042909086274061946
best ic: 0.042909086274061946
epoch:  22%|██▏       | 22/100 [10:13<38:11, 29.38s/it]0.03455480429854541
epoch:  23%|██▎       | 23/100 [10:44<38:18, 29.85s/it]0.036111111371905424
epoch:  24%|██▍       | 24/100 [11:15<38:14, 30.19s/it]0.04030587681435436
epoch:  25%|██▌       | 25/100 [11:46<37:58, 30.37s/it]0.042679086350800644
epoch:  26%|██▌       | 26/100 [12:17<37:47, 30.64s/it]0.039589947379879725
epoch:  27%|██▋       | 27/100 [12:48<37:26, 30.78s/it]0.04265375690710274
epoch:  28%|██▊       | 28/100 [13:19<36:58, 30.81s/it]0.04434693825818838
best ic: 0.04434693825818838
epoch:  29%|██▉       | 29/100 [13:50<36:33, 30.90s/it]0.04191381970238355
epoch:  30%|███       | 30/100 [14:21<36:00, 30.87s/it]0.04490193617793199
best ic: 0.04490193617793199
epoch:  31%|███       | 31/100 [14:52<35:33, 30.92s/it]0.04364252653915984
epoch:  32%|███▏      | 32/100 [15:23<35:02, 30.92s/it]0.04521644549010016
best ic: 0.04521644549010016
epoch:  33%|███▎      | 33/100 [15:54<34:36, 30.99s/it]0.042979149305750135
epoch:  34%|███▍      | 34/100 [16:25<34:00, 30.92s/it]0.04413069908184123
epoch:  35%|███▌      | 35/100 [16:56<33:31, 30.95s/it]0.04598496549924998
best ic: 0.04598496549924998
epoch:  36%|███▌      | 36/100 [17:27<33:00, 30.95s/it]0.03851280820993972
epoch:  37%|███▋      | 37/100 [17:58<32:33, 31.01s/it]0.04505480190235048
epoch:  38%|███▊      | 38/100 [18:29<31:56, 30.91s/it]0.04029652590854003
epoch:  39%|███▉      | 39/100 [19:00<31:34, 31.05s/it]0.04965363289352997
best ic: 0.04965363289352997
epoch:  40%|████      | 40/100 [19:31<30:56, 30.95s/it]0.034748678890252314
epoch:  41%|████      | 41/100 [20:02<30:29, 31.01s/it]0.0437951871637782
epoch:  42%|████▏     | 42/100 [20:33<29:57, 30.98s/it]0.043184396246107336
epoch:  43%|████▎     | 43/100 [21:04<29:28, 31.02s/it]0.04704033209495135
epoch:  44%|████▍     | 44/100 [21:35<28:52, 30.94s/it]0.04430155044591974
epoch:  45%|████▌     | 45/100 [22:06<28:28, 31.06s/it]0.04710749488420108
epoch:  46%|████▌     | 46/100 [22:37<27:51, 30.95s/it]0.042769881467828376
epoch:  47%|████▋     | 47/100 [23:08<27:23, 31.01s/it]0.04582943558740353
epoch:  47%|████▋     | 47/100 [23:39<26:40, 30.20s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3047527:MainThread](2024-04-25 04:20:53,872) INFO - qlib.workflow - [exp.py:258] - Experiment 49 starts running ...
[3047527:MainThread](2024-04-25 04:20:53,888) INFO - qlib.workflow - [recorder.py:341] - Recorder 6277e03e4d9d433ca76ed8c444b0b83f starts running under Experiment 49 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:11,  5.38it/s]online:   3%|▎         | 2/63 [00:00<00:12,  4.95it/s]online:   5%|▍         | 3/63 [00:00<00:12,  4.79it/s]online:   6%|▋         | 4/63 [00:00<00:12,  4.66it/s]online:   8%|▊         | 5/63 [00:01<00:12,  4.62it/s]online:  10%|▉         | 6/63 [00:01<00:12,  4.61it/s]online:  11%|█         | 7/63 [00:01<00:12,  4.60it/s]online:  13%|█▎        | 8/63 [00:01<00:11,  4.64it/s]online:  14%|█▍        | 9/63 [00:01<00:11,  4.57it/s]online:  16%|█▌        | 10/63 [00:02<00:11,  4.56it/s]online:  17%|█▋        | 11/63 [00:02<00:11,  4.57it/s]online:  19%|█▉        | 12/63 [00:02<00:11,  4.56it/s]online:  21%|██        | 13/63 [00:02<00:10,  4.55it/s]online:  22%|██▏       | 14/63 [00:03<00:10,  4.54it/s]online:  24%|██▍       | 15/63 [00:03<00:10,  4.57it/s]online:  25%|██▌       | 16/63 [00:03<00:10,  4.53it/s]online:  27%|██▋       | 17/63 [00:03<00:10,  4.53it/s]online:  29%|██▊       | 18/63 [00:03<00:09,  4.58it/s]online:  30%|███       | 19/63 [00:04<00:09,  4.56it/s]online:  32%|███▏      | 20/63 [00:04<00:09,  4.53it/s]online:  33%|███▎      | 21/63 [00:04<00:09,  4.55it/s]online:  35%|███▍      | 22/63 [00:04<00:09,  4.55it/s]online:  37%|███▋      | 23/63 [00:05<00:08,  4.55it/s]online:  38%|███▊      | 24/63 [00:05<00:08,  4.61it/s]online:  40%|███▉      | 25/63 [00:05<00:08,  4.57it/s]online:  41%|████▏     | 26/63 [00:05<00:08,  4.57it/s]online:  43%|████▎     | 27/63 [00:05<00:07,  4.56it/s]online:  44%|████▍     | 28/63 [00:06<00:07,  4.56it/s]online:  46%|████▌     | 29/63 [00:06<00:07,  4.58it/s]online:  48%|████▊     | 30/63 [00:06<00:07,  4.57it/s]online:  49%|████▉     | 31/63 [00:06<00:07,  4.56it/s]online:  51%|█████     | 32/63 [00:06<00:06,  4.56it/s]online:  52%|█████▏    | 33/63 [00:07<00:06,  4.57it/s]online:  54%|█████▍    | 34/63 [00:07<00:06,  4.57it/s]online:  56%|█████▌    | 35/63 [00:07<00:06,  4.60it/s]online:  57%|█████▋    | 36/63 [00:07<00:05,  4.55it/s]online:  59%|█████▊    | 37/63 [00:08<00:05,  4.57it/s]online:  60%|██████    | 38/63 [00:08<00:05,  4.58it/s]online:  62%|██████▏   | 39/63 [00:08<00:05,  4.55it/s]online:  63%|██████▎   | 40/63 [00:08<00:04,  4.62it/s]online:  65%|██████▌   | 41/63 [00:08<00:04,  4.57it/s]online:  67%|██████▋   | 42/63 [00:09<00:04,  4.59it/s]online:  68%|██████▊   | 43/63 [00:09<00:04,  4.55it/s]online:  70%|██████▉   | 44/63 [00:09<00:04,  4.53it/s]online:  71%|███████▏  | 45/63 [00:09<00:03,  4.55it/s]online:  73%|███████▎  | 46/63 [00:10<00:03,  4.55it/s]online:  75%|███████▍  | 47/63 [00:10<00:03,  4.57it/s]online:  76%|███████▌  | 48/63 [00:10<00:03,  4.55it/s]online:  78%|███████▊  | 49/63 [00:10<00:03,  4.57it/s]online:  79%|███████▉  | 50/63 [00:10<00:02,  4.61it/s]online:  81%|████████  | 51/63 [00:11<00:02,  4.56it/s]online:  83%|████████▎ | 52/63 [00:11<00:02,  4.56it/s]online:  84%|████████▍ | 53/63 [00:11<00:02,  4.56it/s]online:  86%|████████▌ | 54/63 [00:11<00:01,  4.59it/s]online:  87%|████████▋ | 55/63 [00:12<00:01,  4.59it/s]online:  89%|████████▉ | 56/63 [00:12<00:01,  4.59it/s]online:  90%|█████████ | 57/63 [00:12<00:01,  4.58it/s]online:  92%|█████████▏| 58/63 [00:12<00:01,  4.53it/s]online:  94%|█████████▎| 59/63 [00:12<00:00,  4.54it/s]online:  95%|█████████▌| 60/63 [00:13<00:00,  4.55it/s]online:  97%|█████████▋| 61/63 [00:13<00:00,  4.54it/s]online:  98%|█████████▊| 62/63 [00:13<00:00,  4.54it/s]online: 100%|██████████| 63/63 [00:13<00:00,  4.72it/s]online: 100%|██████████| 63/63 [00:13<00:00,  4.58it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.001
[3047527:MainThread](2024-04-25 04:21:33,127) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9974548 mae 0.68579406
{'IC': 0.021049908565493873,
 'ICIR': 0.1806449258518542,
 'Rank IC': 0.014330230707453042,
 'Rank ICIR': 0.12272525155573737}
[3047527:MainThread](2024-04-25 04:21:34,970) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3047527:MainThread](2024-04-25 04:21:49,921) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 04:21:49,924) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 04:21:55,920) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f6e15baa190>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:41,  9.52it/s]backtest loop:   1%|          | 10/971 [00:00<00:34, 27.46it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:25, 36.72it/s]backtest loop:   2%|▏         | 23/971 [00:00<00:21, 43.15it/s]backtest loop:   3%|▎         | 29/971 [00:00<00:20, 45.22it/s]backtest loop:   4%|▎         | 35/971 [00:00<00:18, 49.27it/s]backtest loop:   4%|▍         | 42/971 [00:00<00:17, 53.97it/s]backtest loop:   5%|▌         | 49/971 [00:01<00:17, 54.06it/s]backtest loop:   6%|▌         | 56/971 [00:01<00:16, 56.72it/s]backtest loop:   6%|▋         | 62/971 [00:01<00:16, 54.76it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:15, 57.29it/s]backtest loop:   8%|▊         | 76/971 [00:01<00:15, 59.58it/s]backtest loop:   9%|▊         | 83/971 [00:01<00:15, 57.18it/s]backtest loop:   9%|▉         | 90/971 [00:01<00:15, 58.58it/s]backtest loop:  10%|▉         | 97/971 [00:01<00:15, 56.59it/s]backtest loop:  11%|█         | 103/971 [00:02<00:15, 57.24it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:14, 58.64it/s]backtest loop:  12%|█▏        | 116/971 [00:02<00:14, 58.71it/s]backtest loop:  13%|█▎        | 122/971 [00:02<00:15, 55.40it/s]backtest loop:  13%|█▎        | 128/971 [00:02<00:15, 52.92it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:15, 54.40it/s]backtest loop:  14%|█▍        | 140/971 [00:02<00:15, 55.32it/s]backtest loop:  15%|█▌        | 146/971 [00:02<00:15, 52.79it/s]backtest loop:  16%|█▌        | 152/971 [00:02<00:15, 54.07it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:14, 55.13it/s]backtest loop:  17%|█▋        | 164/971 [00:03<00:14, 55.93it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:14, 56.56it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 53.76it/s]backtest loop:  19%|█▊        | 182/971 [00:03<00:14, 53.28it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:14, 54.72it/s]backtest loop:  20%|█▉        | 194/971 [00:03<00:13, 55.73it/s]backtest loop:  21%|██        | 200/971 [00:03<00:14, 54.32it/s]backtest loop:  21%|██        | 206/971 [00:03<00:13, 55.89it/s]backtest loop:  22%|██▏       | 212/971 [00:04<00:13, 56.45it/s]backtest loop:  22%|██▏       | 218/971 [00:04<00:14, 53.22it/s]backtest loop:  23%|██▎       | 224/971 [00:04<00:13, 54.61it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:14, 52.22it/s]backtest loop:  24%|██▍       | 236/971 [00:04<00:13, 53.65it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:13, 54.80it/s]backtest loop:  26%|██▌       | 248/971 [00:04<00:12, 55.69it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:13, 52.78it/s]backtest loop:  27%|██▋       | 260/971 [00:04<00:13, 54.37it/s]backtest loop:  27%|██▋       | 266/971 [00:05<00:13, 52.10it/s]backtest loop:  28%|██▊       | 272/971 [00:05<00:13, 53.49it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:12, 54.54it/s]backtest loop:  29%|██▉       | 284/971 [00:05<00:12, 55.31it/s]backtest loop:  30%|██▉       | 290/971 [00:05<00:12, 56.02it/s]backtest loop:  30%|███       | 296/971 [00:05<00:12, 53.45it/s]backtest loop:  31%|███       | 302/971 [00:05<00:12, 54.96it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 57.28it/s]backtest loop:  32%|███▏      | 315/971 [00:05<00:12, 54.61it/s]backtest loop:  33%|███▎      | 322/971 [00:06<00:11, 56.83it/s]backtest loop:  34%|███▍      | 328/971 [00:06<00:11, 57.38it/s]backtest loop:  34%|███▍      | 334/971 [00:06<00:11, 57.43it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:11, 54.26it/s]backtest loop:  36%|███▌      | 346/971 [00:06<00:11, 54.84it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:11, 55.71it/s]backtest loop:  37%|███▋      | 359/971 [00:06<00:10, 58.14it/s]backtest loop:  38%|███▊      | 365/971 [00:06<00:11, 55.05it/s]backtest loop:  38%|███▊      | 371/971 [00:06<00:11, 52.78it/s]backtest loop:  39%|███▉      | 377/971 [00:07<00:10, 54.52it/s]backtest loop:  39%|███▉      | 383/971 [00:07<00:11, 52.53it/s]backtest loop:  40%|████      | 389/971 [00:07<00:10, 54.42it/s]backtest loop:  41%|████      | 395/971 [00:07<00:10, 55.83it/s]backtest loop:  41%|████▏     | 401/971 [00:07<00:10, 56.54it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 56.79it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:10, 53.67it/s]backtest loop:  43%|████▎     | 419/971 [00:07<00:09, 55.29it/s]backtest loop:  44%|████▍     | 425/971 [00:07<00:09, 55.93it/s]backtest loop:  44%|████▍     | 431/971 [00:08<00:09, 56.38it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:10, 53.18it/s]backtest loop:  46%|████▌     | 443/971 [00:08<00:09, 54.32it/s]backtest loop:  46%|████▌     | 449/971 [00:08<00:09, 54.91it/s]backtest loop:  47%|████▋     | 455/971 [00:08<00:09, 55.91it/s]backtest loop:  47%|████▋     | 461/971 [00:08<00:09, 56.12it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:09, 53.34it/s]backtest loop:  49%|████▊     | 473/971 [00:08<00:09, 54.57it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 55.70it/s]backtest loop:  50%|████▉     | 485/971 [00:08<00:08, 56.23it/s]backtest loop:  51%|█████     | 491/971 [00:09<00:09, 53.15it/s]backtest loop:  51%|█████     | 497/971 [00:09<00:08, 54.49it/s]backtest loop:  52%|█████▏    | 503/971 [00:09<00:08, 54.83it/s]backtest loop:  52%|█████▏    | 509/971 [00:09<00:08, 52.18it/s]backtest loop:  53%|█████▎    | 515/971 [00:09<00:08, 53.70it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:08, 54.90it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:08, 52.31it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:08, 53.65it/s]backtest loop:  56%|█████▌    | 539/971 [00:10<00:07, 54.83it/s]backtest loop:  56%|█████▌    | 545/971 [00:10<00:07, 55.56it/s]backtest loop:  57%|█████▋    | 551/971 [00:10<00:08, 52.32it/s]backtest loop:  57%|█████▋    | 557/971 [00:10<00:07, 53.79it/s]backtest loop:  58%|█████▊    | 563/971 [00:10<00:07, 54.89it/s]backtest loop:  59%|█████▊    | 569/971 [00:10<00:07, 55.55it/s]backtest loop:  59%|█████▉    | 575/971 [00:10<00:07, 56.23it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:07, 53.09it/s]backtest loop:  60%|██████    | 587/971 [00:10<00:07, 54.35it/s]backtest loop:  61%|██████    | 593/971 [00:10<00:06, 55.11it/s]backtest loop:  62%|██████▏   | 599/971 [00:11<00:06, 55.65it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:06, 52.93it/s]backtest loop:  63%|██████▎   | 611/971 [00:11<00:06, 53.92it/s]backtest loop:  64%|██████▎   | 617/971 [00:11<00:06, 54.91it/s]backtest loop:  64%|██████▍   | 623/971 [00:11<00:06, 55.67it/s]backtest loop:  65%|██████▍   | 629/971 [00:11<00:06, 56.56it/s]backtest loop:  65%|██████▌   | 635/971 [00:11<00:06, 53.36it/s]backtest loop:  66%|██████▌   | 641/971 [00:11<00:06, 54.51it/s]backtest loop:  67%|██████▋   | 647/971 [00:11<00:05, 55.07it/s]backtest loop:  67%|██████▋   | 653/971 [00:12<00:05, 55.74it/s]backtest loop:  68%|██████▊   | 659/971 [00:12<00:05, 56.48it/s]backtest loop:  68%|██████▊   | 665/971 [00:12<00:05, 53.32it/s]backtest loop:  69%|██████▉   | 671/971 [00:12<00:05, 54.36it/s]backtest loop:  70%|██████▉   | 677/971 [00:12<00:05, 55.11it/s]backtest loop:  70%|███████   | 683/971 [00:12<00:05, 55.55it/s]backtest loop:  71%|███████   | 689/971 [00:12<00:05, 52.72it/s]backtest loop:  72%|███████▏  | 695/971 [00:12<00:05, 53.69it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 54.86it/s]backtest loop:  73%|███████▎  | 707/971 [00:13<00:04, 55.64it/s]backtest loop:  73%|███████▎  | 713/971 [00:13<00:04, 56.08it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 53.16it/s]backtest loop:  75%|███████▍  | 725/971 [00:13<00:04, 54.23it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 52.06it/s]backtest loop:  76%|███████▌  | 737/971 [00:13<00:04, 53.71it/s]backtest loop:  77%|███████▋  | 743/971 [00:13<00:04, 51.35it/s]backtest loop:  77%|███████▋  | 749/971 [00:13<00:04, 53.19it/s]backtest loop:  78%|███████▊  | 755/971 [00:14<00:04, 51.78it/s]backtest loop:  78%|███████▊  | 761/971 [00:14<00:03, 53.57it/s]backtest loop:  79%|███████▉  | 767/971 [00:14<00:03, 54.73it/s]backtest loop:  80%|███████▉  | 773/971 [00:14<00:03, 55.49it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 56.56it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 53.48it/s]backtest loop:  81%|████████▏ | 791/971 [00:14<00:03, 54.98it/s]backtest loop:  82%|████████▏ | 797/971 [00:14<00:03, 55.88it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:03, 53.31it/s]backtest loop:  83%|████████▎ | 809/971 [00:14<00:02, 54.77it/s]backtest loop:  84%|████████▍ | 815/971 [00:15<00:02, 55.98it/s]backtest loop:  85%|████████▍ | 821/971 [00:15<00:02, 56.56it/s]backtest loop:  85%|████████▌ | 827/971 [00:15<00:02, 56.88it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 53.63it/s]backtest loop:  86%|████████▋ | 839/971 [00:15<00:02, 54.94it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 55.74it/s]backtest loop:  88%|████████▊ | 851/971 [00:15<00:02, 56.30it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 53.29it/s]backtest loop:  89%|████████▉ | 863/971 [00:15<00:01, 54.50it/s]backtest loop:  89%|████████▉ | 869/971 [00:16<00:01, 55.25it/s]backtest loop:  90%|█████████ | 875/971 [00:16<00:01, 56.21it/s]backtest loop:  91%|█████████ | 881/971 [00:16<00:01, 56.37it/s]backtest loop:  91%|█████████▏| 887/971 [00:16<00:01, 53.57it/s]backtest loop:  92%|█████████▏| 893/971 [00:16<00:01, 54.90it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 55.93it/s]backtest loop:  93%|█████████▎| 905/971 [00:16<00:01, 56.59it/s]backtest loop:  94%|█████████▍| 911/971 [00:16<00:01, 57.32it/s]backtest loop:  94%|█████████▍| 917/971 [00:16<00:00, 54.18it/s]backtest loop:  95%|█████████▌| 923/971 [00:17<00:00, 55.35it/s]backtest loop:  96%|█████████▌| 929/971 [00:17<00:00, 54.74it/s]backtest loop:  96%|█████████▋| 935/971 [00:17<00:00, 54.47it/s]backtest loop:  97%|█████████▋| 941/971 [00:17<00:00, 50.40it/s]backtest loop:  98%|█████████▊| 947/971 [00:17<00:00, 51.33it/s]backtest loop:  98%|█████████▊| 953/971 [00:17<00:00, 52.06it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 52.50it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 49.84it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 50.88it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.02it/s]
[3047527:MainThread](2024-04-25 04:22:13,974) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000330
std                0.004981
annualized_return  0.078610
information_ratio  1.022938
max_drawdown      -0.098020
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000138
std                0.004981
annualized_return  0.032835
information_ratio  0.427253
max_drawdown      -0.124388
[3047527:MainThread](2024-04-25 04:22:13,993) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_Transformer_alpha360_horizon1_step20_rankFalse_2024-04-25_03:13:01_online`.
Round 3 Done!
{'1day.excess_return_with_cost.annualized_return': [0.043797486231573146,
                                                    0.0634228370113721,
                                                    0.032834642441840194],
 '1day.excess_return_with_cost.information_ratio': [0.5649832165888312,
                                                    0.7857064560613483,
                                                    0.42725276418160857],
 '1day.excess_return_with_cost.max_drawdown': [-0.09264196275626242,
                                               -0.11042126565462691,
                                               -0.12438813489577007],
 'IC': [0.02338127556803707, 0.023874553769198607, 0.021049908565493873],
 'ICIR': [0.20238622048809674, 0.18560857194822403, 0.1806449258518542],
 'Rank IC': [0.013917040518004948, 0.012129057369372705, 0.014330230707453042],
 'Rank ICIR': [0.12551679322509657, 0.09548055549514188, 0.12272525155573737],
 'mae': [0.685724139213562, 0.685746431350708, 0.6857940554618835],
 'mse': [0.9972350597381592, 0.9971662163734436, 0.997454822063446]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3047527:MainThread](2024-04-25 04:22:15,395) INFO - qlib.TransformerModel - [pytorch_transformer.py:66] - Naive Transformer:
batch_size : 2048
dim : 32
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:27<45:57, 27.85s/it]epoch:   2%|▏         | 2/100 [00:55<45:18, 27.74s/it]epoch:   3%|▎         | 3/100 [01:23<44:39, 27.63s/it]epoch:   4%|▍         | 4/100 [01:50<44:17, 27.69s/it]epoch:   5%|▌         | 5/100 [02:18<43:36, 27.54s/it]epoch:   6%|▌         | 6/100 [02:45<43:16, 27.62s/it]epoch:   7%|▋         | 7/100 [03:13<42:45, 27.59s/it]epoch:   8%|▊         | 8/100 [03:41<42:21, 27.62s/it]epoch:   9%|▉         | 9/100 [04:08<41:45, 27.54s/it]epoch:  10%|█         | 10/100 [04:36<41:26, 27.63s/it]epoch:  11%|█         | 11/100 [05:03<40:54, 27.58s/it]epoch:  12%|█▏        | 12/100 [05:31<40:31, 27.63s/it]epoch:  13%|█▎        | 13/100 [05:59<40:01, 27.61s/it]epoch:  14%|█▍        | 14/100 [06:26<39:35, 27.62s/it]epoch:  15%|█▌        | 15/100 [06:54<39:01, 27.54s/it]epoch:  16%|█▌        | 16/100 [07:21<38:38, 27.60s/it]epoch:  17%|█▋        | 17/100 [07:49<38:11, 27.61s/it]epoch:  18%|█▊        | 18/100 [08:17<37:45, 27.63s/it]epoch:  19%|█▉        | 19/100 [08:44<37:14, 27.58s/it]epoch:  20%|██        | 20/100 [09:12<36:52, 27.66s/it]0.026777542420494425
best ic: 0.026777542420494425
epoch:  21%|██        | 21/100 [09:43<37:41, 28.62s/it]0.03088272281592661
best ic: 0.03088272281592661
epoch:  22%|██▏       | 22/100 [10:14<38:12, 29.39s/it]0.03475339335542614
best ic: 0.03475339335542614
epoch:  23%|██▎       | 23/100 [10:45<38:17, 29.84s/it]0.03277755604626095
epoch:  24%|██▍       | 24/100 [11:16<38:18, 30.24s/it]0.03466748642050116
epoch:  25%|██▌       | 25/100 [11:47<37:57, 30.37s/it]0.03956193447570748
best ic: 0.03956193447570748
epoch:  26%|██▌       | 26/100 [12:18<37:47, 30.64s/it]0.03886639868278285
epoch:  27%|██▋       | 27/100 [12:49<37:16, 30.63s/it]0.03352550364323144
epoch:  28%|██▊       | 28/100 [13:20<36:58, 30.81s/it]0.04012562966965835
best ic: 0.04012562966965835
epoch:  29%|██▉       | 29/100 [13:51<36:27, 30.82s/it]0.028697857067517412
epoch:  30%|███       | 30/100 [14:22<35:59, 30.86s/it]0.03370168617625125
epoch:  31%|███       | 31/100 [14:52<35:31, 30.89s/it]0.03206141100656211
epoch:  32%|███▏      | 32/100 [15:23<34:59, 30.88s/it]0.032870115821007344
epoch:  33%|███▎      | 33/100 [15:54<34:33, 30.95s/it]0.03643237752785659
epoch:  34%|███▍      | 34/100 [16:25<34:00, 30.92s/it]0.038534951096451824
epoch:  35%|███▌      | 35/100 [16:56<33:31, 30.95s/it]0.03747815792616038
epoch:  36%|███▌      | 36/100 [17:27<33:00, 30.95s/it]0.03937819016466377
epoch:  36%|███▌      | 36/100 [17:59<31:58, 29.97s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3047527:MainThread](2024-04-25 04:40:14,461) INFO - qlib.workflow - [exp.py:258] - Experiment 49 starts running ...
[3047527:MainThread](2024-04-25 04:40:14,479) INFO - qlib.workflow - [recorder.py:341] - Recorder 20dde1e693014f97959d8462f96a2e73 starts running under Experiment 49 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:15,  4.07it/s]online:   3%|▎         | 2/63 [00:00<00:14,  4.32it/s]online:   5%|▍         | 3/63 [00:00<00:13,  4.42it/s]online:   6%|▋         | 4/63 [00:00<00:13,  4.43it/s]online:   8%|▊         | 5/63 [00:01<00:12,  4.51it/s]online:  10%|▉         | 6/63 [00:01<00:12,  4.50it/s]online:  11%|█         | 7/63 [00:01<00:12,  4.46it/s]online:  13%|█▎        | 8/63 [00:01<00:12,  4.50it/s]online:  14%|█▍        | 9/63 [00:02<00:12,  4.49it/s]online:  16%|█▌        | 10/63 [00:02<00:11,  4.47it/s]online:  17%|█▋        | 11/63 [00:02<00:11,  4.53it/s]online:  19%|█▉        | 12/63 [00:02<00:11,  4.52it/s]online:  21%|██        | 13/63 [00:02<00:11,  4.52it/s]online:  22%|██▏       | 14/63 [00:03<00:10,  4.51it/s]online:  24%|██▍       | 15/63 [00:03<00:10,  4.51it/s]online:  25%|██▌       | 16/63 [00:03<00:10,  4.54it/s]online:  27%|██▋       | 17/63 [00:03<00:10,  4.54it/s]online:  29%|██▊       | 18/63 [00:04<00:09,  4.53it/s]online:  30%|███       | 19/63 [00:04<00:09,  4.54it/s]online:  32%|███▏      | 20/63 [00:04<00:09,  4.61it/s]online:  33%|███▎      | 21/63 [00:04<00:09,  4.59it/s]online:  35%|███▍      | 22/63 [00:04<00:08,  4.60it/s]online:  37%|███▋      | 23/63 [00:05<00:08,  4.58it/s]online:  38%|███▊      | 24/63 [00:05<00:08,  4.58it/s]online:  40%|███▉      | 25/63 [00:05<00:08,  4.58it/s]online:  41%|████▏     | 26/63 [00:05<00:08,  4.58it/s]online:  43%|████▎     | 27/63 [00:05<00:07,  4.58it/s]online:  44%|████▍     | 28/63 [00:06<00:07,  4.58it/s]online:  46%|████▌     | 29/63 [00:06<00:07,  4.57it/s]online:  48%|████▊     | 30/63 [00:06<00:07,  4.58it/s]online:  49%|████▉     | 31/63 [00:06<00:07,  4.52it/s]online:  51%|█████     | 32/63 [00:07<00:06,  4.52it/s]online:  52%|█████▏    | 33/63 [00:07<00:06,  4.50it/s]online:  54%|█████▍    | 34/63 [00:07<00:06,  4.58it/s]online:  56%|█████▌    | 35/63 [00:07<00:06,  4.54it/s]online:  57%|█████▋    | 36/63 [00:07<00:05,  4.58it/s]online:  59%|█████▊    | 37/63 [00:08<00:05,  4.55it/s]online:  60%|██████    | 38/63 [00:08<00:05,  4.56it/s]online:  62%|██████▏   | 39/63 [00:08<00:05,  4.55it/s]online:  63%|██████▎   | 40/63 [00:08<00:05,  4.52it/s]online:  65%|██████▌   | 41/63 [00:09<00:04,  4.56it/s]online:  67%|██████▋   | 42/63 [00:09<00:04,  4.56it/s]online:  68%|██████▊   | 43/63 [00:09<00:04,  4.58it/s]online:  70%|██████▉   | 44/63 [00:09<00:04,  4.54it/s]online:  71%|███████▏  | 45/63 [00:09<00:03,  4.58it/s]online:  73%|███████▎  | 46/63 [00:10<00:03,  4.57it/s]online:  75%|███████▍  | 47/63 [00:10<00:03,  4.57it/s]online:  76%|███████▌  | 48/63 [00:10<00:03,  4.56it/s]online:  78%|███████▊  | 49/63 [00:10<00:03,  4.53it/s]online:  79%|███████▉  | 50/63 [00:11<00:02,  4.57it/s]online:  81%|████████  | 51/63 [00:11<00:02,  4.56it/s]online:  83%|████████▎ | 52/63 [00:11<00:02,  4.55it/s]online:  84%|████████▍ | 53/63 [00:11<00:02,  4.57it/s]online:  86%|████████▌ | 54/63 [00:11<00:01,  4.57it/s]online:  87%|████████▋ | 55/63 [00:12<00:01,  4.57it/s]online:  89%|████████▉ | 56/63 [00:12<00:01,  4.58it/s]online:  90%|█████████ | 57/63 [00:12<00:01,  4.56it/s]online:  92%|█████████▏| 58/63 [00:12<00:01,  4.58it/s]online:  94%|█████████▎| 59/63 [00:12<00:00,  4.59it/s]online:  95%|█████████▌| 60/63 [00:13<00:00,  4.58it/s]online:  97%|█████████▋| 61/63 [00:13<00:00,  4.55it/s]online:  98%|█████████▊| 62/63 [00:13<00:00,  4.58it/s]online: 100%|██████████| 63/63 [00:13<00:00,  4.69it/s]online: 100%|██████████| 63/63 [00:13<00:00,  4.55it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.001
[3047527:MainThread](2024-04-25 04:40:55,365) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99737877 mae 0.6857808
{'IC': 0.022668472335526615,
 'ICIR': 0.20035905213919242,
 'Rank IC': 0.018533569798826154,
 'Rank ICIR': 0.1641887623113997}
[3047527:MainThread](2024-04-25 04:40:57,587) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3047527:MainThread](2024-04-25 04:41:13,196) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 04:41:13,199) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 04:41:19,247) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f6e0e635d30>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:50,  8.76it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 23.67it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 34.33it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 39.17it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 44.73it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 48.32it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:19, 48.16it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:18, 51.01it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:17, 53.24it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 51.72it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 52.93it/s]backtest loop:   7%|▋         | 70/971 [00:01<00:16, 55.73it/s]backtest loop:   8%|▊         | 76/971 [00:01<00:15, 56.72it/s]backtest loop:   8%|▊         | 82/971 [00:01<00:16, 54.74it/s]backtest loop:   9%|▉         | 88/971 [00:01<00:15, 55.76it/s]backtest loop:  10%|▉         | 95/971 [00:01<00:15, 57.84it/s]backtest loop:  10%|█         | 101/971 [00:02<00:15, 57.63it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 54.73it/s]backtest loop:  12%|█▏        | 113/971 [00:02<00:15, 55.60it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:15, 56.43it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 53.91it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:16, 51.38it/s]backtest loop:  14%|█▍        | 137/971 [00:02<00:15, 53.49it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:15, 54.88it/s]backtest loop:  15%|█▌        | 149/971 [00:02<00:14, 55.96it/s]backtest loop:  16%|█▌        | 155/971 [00:03<00:14, 56.37it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:15, 53.36it/s]backtest loop:  17%|█▋        | 167/971 [00:03<00:14, 54.91it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:14, 56.20it/s]backtest loop:  18%|█▊        | 179/971 [00:03<00:13, 56.91it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:14, 54.08it/s]backtest loop:  20%|█▉        | 191/971 [00:03<00:14, 55.56it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 56.28it/s]backtest loop:  21%|██        | 203/971 [00:03<00:13, 56.80it/s]backtest loop:  22%|██▏       | 210/971 [00:04<00:13, 55.33it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:14, 53.09it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:13, 54.39it/s]backtest loop:  23%|██▎       | 228/971 [00:04<00:13, 55.49it/s]backtest loop:  24%|██▍       | 234/971 [00:04<00:13, 56.30it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:13, 53.84it/s]backtest loop:  25%|██▌       | 246/971 [00:04<00:13, 55.26it/s]backtest loop:  26%|██▌       | 252/971 [00:04<00:13, 54.21it/s]backtest loop:  27%|██▋       | 258/971 [00:04<00:13, 53.80it/s]backtest loop:  27%|██▋       | 264/971 [00:05<00:13, 50.58it/s]backtest loop:  28%|██▊       | 270/971 [00:05<00:13, 51.53it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:14, 49.34it/s]backtest loop:  29%|██▉       | 282/971 [00:05<00:13, 50.62it/s]backtest loop:  30%|██▉       | 288/971 [00:05<00:13, 50.83it/s]backtest loop:  30%|███       | 294/971 [00:05<00:13, 51.75it/s]backtest loop:  31%|███       | 300/971 [00:05<00:13, 49.41it/s]backtest loop:  32%|███▏      | 306/971 [00:05<00:13, 50.19it/s]backtest loop:  32%|███▏      | 312/971 [00:06<00:12, 51.60it/s]backtest loop:  33%|███▎      | 318/971 [00:06<00:12, 52.08it/s]backtest loop:  33%|███▎      | 324/971 [00:06<00:12, 52.59it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:12, 50.19it/s]backtest loop:  35%|███▍      | 336/971 [00:06<00:12, 51.58it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:12, 52.14it/s]backtest loop:  36%|███▌      | 348/971 [00:06<00:11, 52.02it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:11, 52.73it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:12, 50.68it/s]backtest loop:  38%|███▊      | 366/971 [00:07<00:11, 52.36it/s]backtest loop:  38%|███▊      | 372/971 [00:07<00:11, 50.02it/s]backtest loop:  39%|███▉      | 378/971 [00:07<00:12, 48.05it/s]backtest loop:  40%|███▉      | 384/971 [00:07<00:11, 49.46it/s]backtest loop:  40%|████      | 390/971 [00:07<00:11, 50.49it/s]backtest loop:  41%|████      | 396/971 [00:07<00:11, 51.35it/s]backtest loop:  41%|████▏     | 402/971 [00:07<00:10, 52.05it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:11, 49.09it/s]backtest loop:  43%|████▎     | 414/971 [00:08<00:11, 50.56it/s]backtest loop:  43%|████▎     | 420/971 [00:08<00:10, 51.63it/s]backtest loop:  44%|████▍     | 426/971 [00:08<00:10, 52.33it/s]backtest loop:  44%|████▍     | 432/971 [00:08<00:10, 49.62it/s]backtest loop:  45%|████▌     | 438/971 [00:08<00:10, 50.35it/s]backtest loop:  46%|████▌     | 444/971 [00:08<00:10, 51.26it/s]backtest loop:  46%|████▋     | 450/971 [00:08<00:10, 51.95it/s]backtest loop:  47%|████▋     | 456/971 [00:08<00:09, 52.42it/s]backtest loop:  48%|████▊     | 462/971 [00:08<00:10, 49.92it/s]backtest loop:  48%|████▊     | 468/971 [00:09<00:09, 50.76it/s]backtest loop:  49%|████▉     | 474/971 [00:09<00:09, 51.47it/s]backtest loop:  49%|████▉     | 480/971 [00:09<00:09, 52.69it/s]backtest loop:  50%|█████     | 486/971 [00:09<00:09, 53.04it/s]backtest loop:  51%|█████     | 492/971 [00:09<00:09, 50.36it/s]backtest loop:  51%|█████▏    | 498/971 [00:09<00:09, 50.80it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:08, 52.02it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:09, 49.61it/s]backtest loop:  53%|█████▎    | 516/971 [00:10<00:09, 50.52it/s]backtest loop:  54%|█████▍    | 522/971 [00:10<00:09, 48.59it/s]backtest loop:  54%|█████▍    | 528/971 [00:10<00:08, 50.05it/s]backtest loop:  55%|█████▍    | 534/971 [00:10<00:08, 51.33it/s]backtest loop:  56%|█████▌    | 540/971 [00:10<00:08, 52.42it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:08, 49.83it/s]backtest loop:  57%|█████▋    | 552/971 [00:10<00:08, 51.18it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:08, 51.52it/s]backtest loop:  58%|█████▊    | 564/971 [00:10<00:07, 52.28it/s]backtest loop:  59%|█████▊    | 570/971 [00:11<00:07, 52.76it/s]backtest loop:  59%|█████▉    | 576/971 [00:11<00:07, 49.96it/s]backtest loop:  60%|█████▉    | 582/971 [00:11<00:07, 51.08it/s]backtest loop:  61%|██████    | 588/971 [00:11<00:07, 51.53it/s]backtest loop:  61%|██████    | 594/971 [00:11<00:07, 52.43it/s]backtest loop:  62%|██████▏   | 600/971 [00:11<00:07, 49.53it/s]backtest loop:  62%|██████▏   | 606/971 [00:11<00:07, 50.61it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 51.45it/s]backtest loop:  64%|██████▎   | 618/971 [00:12<00:06, 51.92it/s]backtest loop:  64%|██████▍   | 624/971 [00:12<00:06, 52.61it/s]backtest loop:  65%|██████▍   | 630/971 [00:12<00:06, 50.00it/s]backtest loop:  65%|██████▌   | 636/971 [00:12<00:06, 51.04it/s]backtest loop:  66%|██████▌   | 642/971 [00:12<00:06, 51.69it/s]backtest loop:  67%|██████▋   | 648/971 [00:12<00:06, 52.18it/s]backtest loop:  67%|██████▋   | 654/971 [00:12<00:06, 52.81it/s]backtest loop:  68%|██████▊   | 660/971 [00:12<00:06, 50.10it/s]backtest loop:  69%|██████▊   | 666/971 [00:12<00:05, 51.14it/s]backtest loop:  69%|██████▉   | 672/971 [00:13<00:05, 51.89it/s]backtest loop:  70%|██████▉   | 678/971 [00:13<00:05, 52.05it/s]backtest loop:  70%|███████   | 684/971 [00:13<00:05, 49.40it/s]backtest loop:  71%|███████   | 690/971 [00:13<00:05, 50.76it/s]backtest loop:  72%|███████▏  | 696/971 [00:13<00:05, 51.62it/s]backtest loop:  72%|███████▏  | 702/971 [00:13<00:05, 52.59it/s]backtest loop:  73%|███████▎  | 708/971 [00:13<00:04, 52.71it/s]backtest loop:  74%|███████▎  | 714/971 [00:13<00:05, 50.01it/s]backtest loop:  74%|███████▍  | 720/971 [00:14<00:04, 50.92it/s]backtest loop:  75%|███████▍  | 726/971 [00:14<00:04, 51.80it/s]backtest loop:  75%|███████▌  | 732/971 [00:14<00:04, 49.66it/s]backtest loop:  76%|███████▌  | 738/971 [00:14<00:04, 47.88it/s]backtest loop:  77%|███████▋  | 744/971 [00:14<00:04, 49.73it/s]backtest loop:  77%|███████▋  | 750/971 [00:14<00:04, 48.14it/s]backtest loop:  78%|███████▊  | 756/971 [00:14<00:04, 50.07it/s]backtest loop:  78%|███████▊  | 762/971 [00:14<00:04, 51.16it/s]backtest loop:  79%|███████▉  | 768/971 [00:14<00:03, 52.04it/s]backtest loop:  80%|███████▉  | 774/971 [00:15<00:03, 52.58it/s]backtest loop:  80%|████████  | 780/971 [00:15<00:03, 50.06it/s]backtest loop:  81%|████████  | 786/971 [00:15<00:03, 51.10it/s]backtest loop:  82%|████████▏ | 792/971 [00:15<00:03, 51.86it/s]backtest loop:  82%|████████▏ | 798/971 [00:15<00:03, 49.66it/s]backtest loop:  83%|████████▎ | 804/971 [00:15<00:03, 50.71it/s]backtest loop:  83%|████████▎ | 810/971 [00:15<00:03, 51.59it/s]backtest loop:  84%|████████▍ | 816/971 [00:15<00:02, 52.38it/s]backtest loop:  85%|████████▍ | 822/971 [00:16<00:02, 52.81it/s]backtest loop:  85%|████████▌ | 828/971 [00:16<00:02, 50.05it/s]backtest loop:  86%|████████▌ | 834/971 [00:16<00:02, 51.09it/s]backtest loop:  87%|████████▋ | 840/971 [00:16<00:02, 51.91it/s]backtest loop:  87%|████████▋ | 846/971 [00:16<00:02, 52.39it/s]backtest loop:  88%|████████▊ | 852/971 [00:16<00:02, 49.80it/s]backtest loop:  88%|████████▊ | 858/971 [00:16<00:02, 50.90it/s]backtest loop:  89%|████████▉ | 864/971 [00:16<00:02, 51.69it/s]backtest loop:  90%|████████▉ | 870/971 [00:16<00:01, 52.38it/s]backtest loop:  90%|█████████ | 876/971 [00:17<00:01, 52.97it/s]backtest loop:  91%|█████████ | 882/971 [00:17<00:01, 50.39it/s]backtest loop:  91%|█████████▏| 888/971 [00:17<00:01, 51.06it/s]backtest loop:  92%|█████████▏| 894/971 [00:17<00:01, 51.82it/s]backtest loop:  93%|█████████▎| 900/971 [00:17<00:01, 52.48it/s]backtest loop:  93%|█████████▎| 906/971 [00:17<00:01, 52.92it/s]backtest loop:  94%|█████████▍| 912/971 [00:17<00:01, 50.19it/s]backtest loop:  95%|█████████▍| 918/971 [00:17<00:01, 51.24it/s]backtest loop:  95%|█████████▌| 924/971 [00:18<00:00, 52.07it/s]backtest loop:  96%|█████████▌| 930/971 [00:18<00:00, 52.14it/s]backtest loop:  96%|█████████▋| 936/971 [00:18<00:00, 49.71it/s]backtest loop:  97%|█████████▋| 942/971 [00:18<00:00, 50.93it/s]backtest loop:  98%|█████████▊| 948/971 [00:18<00:00, 51.84it/s]backtest loop:  98%|█████████▊| 954/971 [00:18<00:00, 52.46it/s]backtest loop:  99%|█████████▉| 960/971 [00:18<00:00, 49.84it/s]backtest loop:  99%|█████████▉| 966/971 [00:18<00:00, 50.97it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 51.27it/s]
[3047527:MainThread](2024-04-25 04:41:38,266) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000583
std                0.004806
annualized_return  0.138781
information_ratio  1.871799
max_drawdown      -0.079114
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000389
std                0.004807
annualized_return  0.092700
information_ratio  1.249897
max_drawdown      -0.091037
[3047527:MainThread](2024-04-25 04:41:38,284) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_Transformer_alpha360_horizon1_step20_rankFalse_2024-04-25_03:13:01_online`.
Round 4 Done!
{'1day.excess_return_with_cost.annualized_return': [0.043797486231573146,
                                                    0.0634228370113721,
                                                    0.032834642441840194,
                                                    0.09269971081251317],
 '1day.excess_return_with_cost.information_ratio': [0.5649832165888312,
                                                    0.7857064560613483,
                                                    0.42725276418160857,
                                                    1.2498966992194853],
 '1day.excess_return_with_cost.max_drawdown': [-0.09264196275626242,
                                               -0.11042126565462691,
                                               -0.12438813489577007,
                                               -0.0910373026769272],
 'IC': [0.02338127556803707,
        0.023874553769198607,
        0.021049908565493873,
        0.022668472335526615],
 'ICIR': [0.20238622048809674,
          0.18560857194822403,
          0.1806449258518542,
          0.20035905213919242],
 'Rank IC': [0.013917040518004948,
             0.012129057369372705,
             0.014330230707453042,
             0.018533569798826154],
 'Rank ICIR': [0.12551679322509657,
               0.09548055549514188,
               0.12272525155573737,
               0.1641887623113997],
 'mae': [0.685724139213562,
         0.685746431350708,
         0.6857940554618835,
         0.6857808232307434],
 'mse': [0.9972350597381592,
         0.9971662163734436,
         0.997454822063446,
         0.9973787665367126]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3047527:MainThread](2024-04-25 04:41:39,739) INFO - qlib.TransformerModel - [pytorch_transformer.py:66] - Naive Transformer:
batch_size : 2048
dim : 32
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:27<45:43, 27.71s/it]epoch:   2%|▏         | 2/100 [00:55<45:17, 27.72s/it]epoch:   3%|▎         | 3/100 [01:22<44:35, 27.59s/it]epoch:   4%|▍         | 4/100 [01:50<44:24, 27.75s/it]epoch:   5%|▌         | 5/100 [02:18<43:46, 27.65s/it]epoch:   6%|▌         | 6/100 [02:46<43:22, 27.69s/it]epoch:   7%|▋         | 7/100 [03:13<42:43, 27.56s/it]epoch:   8%|▊         | 8/100 [03:41<42:18, 27.59s/it]epoch:   9%|▉         | 9/100 [04:08<41:40, 27.48s/it]epoch:  10%|█         | 10/100 [04:35<41:16, 27.52s/it]epoch:  11%|█         | 11/100 [05:03<40:49, 27.52s/it]epoch:  12%|█▏        | 12/100 [05:30<40:23, 27.54s/it]epoch:  13%|█▎        | 13/100 [05:58<39:49, 27.47s/it]epoch:  14%|█▍        | 14/100 [06:26<39:28, 27.54s/it]epoch:  15%|█▌        | 15/100 [06:53<39:00, 27.54s/it]epoch:  16%|█▌        | 16/100 [07:21<38:36, 27.57s/it]epoch:  17%|█▋        | 17/100 [07:48<38:03, 27.51s/it]epoch:  18%|█▊        | 18/100 [08:16<37:42, 27.59s/it]epoch:  19%|█▉        | 19/100 [08:43<37:05, 27.48s/it]epoch:  20%|██        | 20/100 [09:11<36:41, 27.52s/it]0.035374171594648306
best ic: 0.035374171594648306
epoch:  21%|██        | 21/100 [09:42<37:37, 28.57s/it]0.039547780090526556
best ic: 0.039547780090526556
epoch:  22%|██▏       | 22/100 [10:13<38:12, 29.39s/it]0.036407863669449855
epoch:  23%|██▎       | 23/100 [10:44<38:13, 29.78s/it]0.040720097275224916
best ic: 0.040720097275224916
epoch:  24%|██▍       | 24/100 [11:15<38:16, 30.21s/it]0.040048106769390426
epoch:  25%|██▌       | 25/100 [11:46<38:00, 30.40s/it]0.039957106967540096
epoch:  26%|██▌       | 26/100 [12:17<37:45, 30.62s/it]0.03828754025609874
epoch:  27%|██▋       | 27/100 [12:48<37:16, 30.63s/it]0.03704247598549164
epoch:  28%|██▊       | 28/100 [13:19<37:00, 30.84s/it]0.03967719256218205
epoch:  29%|██▉       | 29/100 [13:50<36:25, 30.78s/it]0.03641745892170468
epoch:  30%|███       | 30/100 [14:21<36:04, 30.91s/it]0.041889364245597055
best ic: 0.041889364245597055
epoch:  31%|███       | 31/100 [14:52<35:33, 30.91s/it]0.03844722003646788
epoch:  32%|███▏      | 32/100 [15:23<35:06, 30.97s/it]0.039522392318297545
epoch:  33%|███▎      | 33/100 [15:53<34:28, 30.87s/it]0.03799123940044642
epoch:  34%|███▍      | 34/100 [16:25<34:06, 31.00s/it]0.042215177381358125
best ic: 0.042215177381358125
epoch:  35%|███▌      | 35/100 [16:55<33:28, 30.90s/it]0.04207797547117918
epoch:  36%|███▌      | 36/100 [17:26<33:01, 30.96s/it]0.03489438344064366
epoch:  37%|███▋      | 37/100 [17:57<32:30, 30.96s/it]0.04089358201139613
epoch:  38%|███▊      | 38/100 [18:28<32:00, 30.98s/it]0.039513339987456354
epoch:  39%|███▉      | 39/100 [18:59<31:27, 30.95s/it]0.040205721914718495
epoch:  40%|████      | 40/100 [19:30<30:58, 30.98s/it]0.038341819908492926
epoch:  41%|████      | 41/100 [20:01<30:25, 30.94s/it]0.036968185078721266
epoch:  42%|████▏     | 42/100 [20:32<29:53, 30.92s/it]0.04270799523548777
best ic: 0.04270799523548777
epoch:  43%|████▎     | 43/100 [21:03<29:27, 31.00s/it]0.03458288918187042
epoch:  44%|████▍     | 44/100 [21:34<28:52, 30.95s/it]0.031328923637597206
epoch:  45%|████▌     | 45/100 [22:05<28:25, 31.00s/it]0.04043877370672309
epoch:  46%|████▌     | 46/100 [22:36<27:52, 30.97s/it]0.03636285358978758
epoch:  47%|████▋     | 47/100 [23:07<27:25, 31.04s/it]0.0391418552439879
epoch:  48%|████▊     | 48/100 [23:38<26:48, 30.94s/it]0.03789058056409519
epoch:  49%|████▉     | 49/100 [24:09<26:22, 31.03s/it]0.038475814136641175
epoch:  50%|█████     | 50/100 [24:40<25:46, 30.93s/it]0.04422947718165149
best ic: 0.04422947718165149
epoch:  51%|█████     | 51/100 [25:11<25:19, 31.01s/it]0.040829293270683714
epoch:  52%|█████▏    | 52/100 [25:42<24:44, 30.92s/it]0.03888293032669328
epoch:  53%|█████▎    | 53/100 [26:13<24:15, 30.98s/it]0.041420861193890816
epoch:  54%|█████▍    | 54/100 [26:44<23:41, 30.91s/it]0.04499327808567005
best ic: 0.04499327808567005
epoch:  55%|█████▌    | 55/100 [27:15<23:13, 30.98s/it]0.0385570444348531
epoch:  56%|█████▌    | 56/100 [27:46<22:40, 30.92s/it]0.042749889463216645
epoch:  57%|█████▋    | 57/100 [28:17<22:11, 30.96s/it]0.042534756576311346
epoch:  58%|█████▊    | 58/100 [28:48<21:43, 31.03s/it]0.0337375080700911
epoch:  59%|█████▉    | 59/100 [29:19<21:10, 30.98s/it]0.03956233775889397
epoch:  60%|██████    | 60/100 [29:50<20:40, 31.00s/it]0.03968551998856545
epoch:  61%|██████    | 61/100 [30:21<20:10, 31.05s/it]0.0406344043577638
epoch:  62%|██████▏   | 62/100 [30:52<19:39, 31.04s/it]0.031926723343341575
epoch:  62%|██████▏   | 62/100 [31:23<19:14, 30.38s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3047527:MainThread](2024-04-25 05:13:03,472) INFO - qlib.workflow - [exp.py:258] - Experiment 49 starts running ...
[3047527:MainThread](2024-04-25 05:13:03,489) INFO - qlib.workflow - [recorder.py:341] - Recorder 53d8ec0c43224a6da36e82be214ebb29 starts running under Experiment 49 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:11,  5.41it/s]online:   3%|▎         | 2/63 [00:00<00:12,  4.97it/s]online:   5%|▍         | 3/63 [00:00<00:12,  4.78it/s]online:   6%|▋         | 4/63 [00:00<00:12,  4.71it/s]online:   8%|▊         | 5/63 [00:01<00:12,  4.66it/s]online:  10%|▉         | 6/63 [00:01<00:12,  4.59it/s]online:  11%|█         | 7/63 [00:01<00:12,  4.60it/s]online:  13%|█▎        | 8/63 [00:01<00:12,  4.56it/s]online:  14%|█▍        | 9/63 [00:01<00:11,  4.60it/s]online:  16%|█▌        | 10/63 [00:02<00:11,  4.59it/s]online:  17%|█▋        | 11/63 [00:02<00:11,  4.58it/s]online:  19%|█▉        | 12/63 [00:02<00:11,  4.58it/s]online:  21%|██        | 13/63 [00:02<00:10,  4.58it/s]online:  22%|██▏       | 14/63 [00:03<00:10,  4.57it/s]online:  24%|██▍       | 15/63 [00:03<00:10,  4.58it/s]online:  25%|██▌       | 16/63 [00:03<00:10,  4.56it/s]online:  27%|██▋       | 17/63 [00:03<00:10,  4.52it/s]online:  29%|██▊       | 18/63 [00:03<00:09,  4.53it/s]online:  30%|███       | 19/63 [00:04<00:09,  4.56it/s]online:  32%|███▏      | 20/63 [00:04<00:09,  4.54it/s]online:  33%|███▎      | 21/63 [00:04<00:09,  4.56it/s]online:  35%|███▍      | 22/63 [00:04<00:09,  4.56it/s]online:  37%|███▋      | 23/63 [00:05<00:08,  4.57it/s]online:  38%|███▊      | 24/63 [00:05<00:08,  4.54it/s]online:  40%|███▉      | 25/63 [00:05<00:08,  4.54it/s]online:  41%|████▏     | 26/63 [00:05<00:08,  4.54it/s]online:  43%|████▎     | 27/63 [00:05<00:07,  4.57it/s]online:  44%|████▍     | 28/63 [00:06<00:07,  4.55it/s]online:  46%|████▌     | 29/63 [00:06<00:07,  4.55it/s]online:  48%|████▊     | 30/63 [00:06<00:07,  4.56it/s]online:  49%|████▉     | 31/63 [00:06<00:07,  4.55it/s]online:  51%|█████     | 32/63 [00:06<00:06,  4.60it/s]online:  52%|█████▏    | 33/63 [00:07<00:06,  4.55it/s]online:  54%|█████▍    | 34/63 [00:07<00:06,  4.56it/s]online:  56%|█████▌    | 35/63 [00:07<00:06,  4.56it/s]online:  57%|█████▋    | 36/63 [00:07<00:05,  4.59it/s]online:  59%|█████▊    | 37/63 [00:08<00:05,  4.60it/s]online:  60%|██████    | 38/63 [00:08<00:05,  4.61it/s]online:  62%|██████▏   | 39/63 [00:08<00:05,  4.62it/s]online:  63%|██████▎   | 40/63 [00:08<00:05,  4.53it/s]online:  65%|██████▌   | 41/63 [00:08<00:04,  4.54it/s]online:  67%|██████▋   | 42/63 [00:09<00:04,  4.57it/s]online:  68%|██████▊   | 43/63 [00:09<00:04,  4.56it/s]online:  70%|██████▉   | 44/63 [00:09<00:04,  4.54it/s]online:  71%|███████▏  | 45/63 [00:09<00:03,  4.56it/s]online:  73%|███████▎  | 46/63 [00:10<00:03,  4.56it/s]online:  75%|███████▍  | 47/63 [00:10<00:03,  4.53it/s]online:  76%|███████▌  | 48/63 [00:10<00:03,  4.53it/s]online:  78%|███████▊  | 49/63 [00:10<00:03,  4.54it/s]online:  79%|███████▉  | 50/63 [00:10<00:02,  4.54it/s]online:  81%|████████  | 51/63 [00:11<00:02,  4.52it/s]online:  83%|████████▎ | 52/63 [00:11<00:02,  4.53it/s]online:  84%|████████▍ | 53/63 [00:11<00:02,  4.55it/s]online:  86%|████████▌ | 54/63 [00:11<00:01,  4.54it/s]online:  87%|████████▋ | 55/63 [00:12<00:01,  4.54it/s]online:  89%|████████▉ | 56/63 [00:12<00:01,  4.55it/s]online:  90%|█████████ | 57/63 [00:12<00:01,  4.52it/s]online:  92%|█████████▏| 58/63 [00:12<00:01,  4.55it/s]online:  94%|█████████▎| 59/63 [00:12<00:00,  4.53it/s]online:  95%|█████████▌| 60/63 [00:13<00:00,  4.53it/s]online:  97%|█████████▋| 61/63 [00:13<00:00,  4.54it/s]online:  98%|█████████▊| 62/63 [00:13<00:00,  4.57it/s]online: 100%|██████████| 63/63 [00:13<00:00,  4.72it/s]online: 100%|██████████| 63/63 [00:13<00:00,  4.58it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.001
[3047527:MainThread](2024-04-25 05:13:44,223) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99723417 mae 0.6859009
{'IC': 0.023429347755308673,
 'ICIR': 0.2010511035996123,
 'Rank IC': 0.008485277600671977,
 'Rank ICIR': 0.07311631025877363}
[3047527:MainThread](2024-04-25 05:13:46,089) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3047527:MainThread](2024-04-25 05:14:01,392) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 05:14:01,395) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 05:14:07,484) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f6e182b4be0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:39,  9.74it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 25.30it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:26, 35.85it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.00it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.58it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 48.64it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:19, 48.51it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:17, 51.59it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:17, 53.61it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 51.42it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:16, 54.73it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:15, 57.29it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:16, 54.66it/s]backtest loop:   9%|▊         | 83/971 [00:01<00:15, 55.84it/s]backtest loop:   9%|▉         | 89/971 [00:01<00:15, 56.96it/s]backtest loop:  10%|▉         | 96/971 [00:01<00:14, 58.57it/s]backtest loop:  11%|█         | 102/971 [00:02<00:15, 55.25it/s]backtest loop:  11%|█         | 109/971 [00:02<00:15, 57.26it/s]backtest loop:  12%|█▏        | 115/971 [00:02<00:14, 57.91it/s]backtest loop:  13%|█▎        | 122/971 [00:02<00:15, 55.89it/s]backtest loop:  13%|█▎        | 128/971 [00:02<00:15, 52.91it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:15, 54.15it/s]backtest loop:  14%|█▍        | 140/971 [00:02<00:15, 55.33it/s]backtest loop:  15%|█▌        | 146/971 [00:02<00:15, 53.01it/s]backtest loop:  16%|█▌        | 152/971 [00:02<00:15, 54.54it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:14, 55.62it/s]backtest loop:  17%|█▋        | 164/971 [00:03<00:14, 56.63it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:13, 57.39it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 54.47it/s]backtest loop:  19%|█▊        | 182/971 [00:03<00:14, 55.33it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:13, 57.64it/s]backtest loop:  20%|██        | 195/971 [00:03<00:14, 54.78it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 56.97it/s]backtest loop:  21%|██▏       | 208/971 [00:03<00:13, 57.45it/s]backtest loop:  22%|██▏       | 214/971 [00:04<00:13, 54.88it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:14, 52.70it/s]backtest loop:  23%|██▎       | 226/971 [00:04<00:13, 54.49it/s]backtest loop:  24%|██▍       | 232/971 [00:04<00:13, 55.75it/s]backtest loop:  25%|██▍       | 239/971 [00:04<00:12, 57.72it/s]backtest loop:  25%|██▌       | 245/971 [00:04<00:13, 54.96it/s]backtest loop:  26%|██▌       | 251/971 [00:04<00:12, 55.74it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 56.68it/s]backtest loop:  27%|██▋       | 263/971 [00:04<00:12, 57.34it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:12, 54.22it/s]backtest loop:  28%|██▊       | 275/971 [00:05<00:12, 55.41it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:13, 53.06it/s]backtest loop:  30%|██▉       | 287/971 [00:05<00:12, 54.65it/s]backtest loop:  30%|███       | 293/971 [00:05<00:12, 55.79it/s]backtest loop:  31%|███       | 299/971 [00:05<00:11, 56.62it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:12, 53.73it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 56.24it/s]backtest loop:  33%|███▎      | 318/971 [00:05<00:11, 56.87it/s]backtest loop:  33%|███▎      | 324/971 [00:06<00:11, 57.65it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:11, 54.67it/s]backtest loop:  35%|███▍      | 336/971 [00:06<00:11, 56.05it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:11, 56.66it/s]backtest loop:  36%|███▌      | 348/971 [00:06<00:10, 57.54it/s]backtest loop:  37%|███▋      | 355/971 [00:06<00:11, 55.70it/s]backtest loop:  37%|███▋      | 362/971 [00:06<00:10, 57.96it/s]backtest loop:  38%|███▊      | 368/971 [00:06<00:11, 52.30it/s]backtest loop:  39%|███▊      | 374/971 [00:06<00:11, 54.25it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:10, 55.61it/s]backtest loop:  40%|███▉      | 386/971 [00:07<00:10, 56.57it/s]backtest loop:  40%|████      | 392/971 [00:07<00:10, 57.18it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 54.17it/s]backtest loop:  42%|████▏     | 404/971 [00:07<00:10, 55.76it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:09, 56.39it/s]backtest loop:  43%|████▎     | 416/971 [00:07<00:09, 57.24it/s]backtest loop:  43%|████▎     | 422/971 [00:07<00:09, 57.68it/s]backtest loop:  44%|████▍     | 428/971 [00:07<00:09, 54.49it/s]backtest loop:  45%|████▍     | 434/971 [00:08<00:09, 55.53it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:09, 56.37it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:09, 57.10it/s]backtest loop:  47%|████▋     | 452/971 [00:08<00:09, 53.91it/s]backtest loop:  47%|████▋     | 458/971 [00:08<00:09, 55.17it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:09, 56.10it/s]backtest loop:  48%|████▊     | 470/971 [00:08<00:08, 56.73it/s]backtest loop:  49%|████▉     | 476/971 [00:08<00:08, 57.34it/s]backtest loop:  50%|████▉     | 482/971 [00:08<00:08, 54.82it/s]backtest loop:  50%|█████     | 488/971 [00:09<00:08, 55.89it/s]backtest loop:  51%|█████     | 494/971 [00:09<00:08, 56.55it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 53.31it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 52.75it/s]backtest loop:  53%|█████▎    | 513/971 [00:09<00:08, 54.34it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:08, 55.64it/s]backtest loop:  54%|█████▍    | 525/971 [00:09<00:07, 56.64it/s]backtest loop:  55%|█████▍    | 531/971 [00:09<00:08, 53.88it/s]backtest loop:  55%|█████▌    | 537/971 [00:09<00:07, 55.16it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:07, 55.77it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 56.74it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 57.42it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 54.19it/s]backtest loop:  58%|█████▊    | 567/971 [00:10<00:07, 55.44it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:07, 56.37it/s]backtest loop:  60%|█████▉    | 579/971 [00:10<00:06, 57.03it/s]backtest loop:  60%|██████    | 585/971 [00:10<00:06, 57.52it/s]backtest loop:  61%|██████    | 591/971 [00:10<00:06, 54.30it/s]backtest loop:  61%|██████▏   | 597/971 [00:10<00:06, 55.59it/s]backtest loop:  62%|██████▏   | 603/971 [00:11<00:06, 56.51it/s]backtest loop:  63%|██████▎   | 609/971 [00:11<00:06, 57.18it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:06, 54.19it/s]backtest loop:  64%|██████▍   | 621/971 [00:11<00:06, 55.48it/s]backtest loop:  65%|██████▍   | 627/971 [00:11<00:06, 56.61it/s]backtest loop:  65%|██████▌   | 633/971 [00:11<00:05, 57.26it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 57.53it/s]backtest loop:  66%|██████▋   | 645/971 [00:11<00:05, 54.35it/s]backtest loop:  67%|██████▋   | 651/971 [00:11<00:05, 54.29it/s]backtest loop:  68%|██████▊   | 657/971 [00:12<00:05, 55.78it/s]backtest loop:  68%|██████▊   | 663/971 [00:12<00:05, 56.67it/s]backtest loop:  69%|██████▉   | 669/971 [00:12<00:05, 57.18it/s]backtest loop:  70%|██████▉   | 675/971 [00:12<00:05, 54.15it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:05, 55.43it/s]backtest loop:  71%|███████   | 687/971 [00:12<00:05, 56.11it/s]backtest loop:  71%|███████▏  | 693/971 [00:12<00:04, 56.60it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:05, 53.95it/s]backtest loop:  73%|███████▎  | 705/971 [00:12<00:04, 55.38it/s]backtest loop:  73%|███████▎  | 711/971 [00:13<00:04, 56.28it/s]backtest loop:  74%|███████▍  | 717/971 [00:13<00:04, 57.01it/s]backtest loop:  74%|███████▍  | 723/971 [00:13<00:04, 57.65it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 54.37it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 52.34it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 54.08it/s]backtest loop:  77%|███████▋  | 747/971 [00:13<00:04, 55.29it/s]backtest loop:  78%|███████▊  | 753/971 [00:13<00:04, 53.69it/s]backtest loop:  78%|███████▊  | 759/971 [00:13<00:03, 55.23it/s]backtest loop:  79%|███████▉  | 765/971 [00:14<00:03, 53.50it/s]backtest loop:  80%|███████▉  | 772/971 [00:14<00:03, 56.31it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 58.05it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 55.07it/s]backtest loop:  81%|████████▏ | 791/971 [00:14<00:03, 55.96it/s]backtest loop:  82%|████████▏ | 797/971 [00:14<00:03, 56.67it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:03, 53.90it/s]backtest loop:  83%|████████▎ | 809/971 [00:14<00:02, 55.18it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 55.77it/s]backtest loop:  85%|████████▍ | 821/971 [00:15<00:02, 56.58it/s]backtest loop:  85%|████████▌ | 827/971 [00:15<00:02, 57.18it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 54.10it/s]backtest loop:  86%|████████▋ | 839/971 [00:15<00:02, 55.34it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 56.26it/s]backtest loop:  88%|████████▊ | 851/971 [00:15<00:02, 56.91it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 53.85it/s]backtest loop:  89%|████████▉ | 863/971 [00:15<00:01, 55.02it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 56.02it/s]backtest loop:  90%|█████████ | 875/971 [00:15<00:01, 56.69it/s]backtest loop:  91%|█████████ | 881/971 [00:16<00:01, 57.19it/s]backtest loop:  91%|█████████▏| 887/971 [00:16<00:01, 54.23it/s]backtest loop:  92%|█████████▏| 893/971 [00:16<00:01, 55.36it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 56.40it/s]backtest loop:  93%|█████████▎| 905/971 [00:16<00:01, 56.70it/s]backtest loop:  94%|█████████▍| 911/971 [00:16<00:01, 57.41it/s]backtest loop:  94%|█████████▍| 917/971 [00:16<00:00, 54.24it/s]backtest loop:  95%|█████████▌| 923/971 [00:16<00:00, 55.37it/s]backtest loop:  96%|█████████▌| 929/971 [00:16<00:00, 56.14it/s]backtest loop:  96%|█████████▋| 935/971 [00:17<00:00, 56.75it/s]backtest loop:  97%|█████████▋| 941/971 [00:17<00:00, 53.85it/s]backtest loop:  98%|█████████▊| 947/971 [00:17<00:00, 55.13it/s]backtest loop:  98%|█████████▊| 953/971 [00:17<00:00, 55.66it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 56.43it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 53.57it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.99it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.82it/s]
[3047527:MainThread](2024-04-25 05:14:25,274) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000470
std                0.005049
annualized_return  0.111843
information_ratio  1.435797
max_drawdown      -0.098996
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000276
std                0.005051
annualized_return  0.065718
information_ratio  0.843448
max_drawdown      -0.147954
[3047527:MainThread](2024-04-25 05:14:25,292) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_Transformer_alpha360_horizon1_step20_rankFalse_2024-04-25_03:13:01_online`.
Round 5 Done!
{'1day.excess_return_with_cost.annualized_return': [0.043797486231573146,
                                                    0.0634228370113721,
                                                    0.032834642441840194,
                                                    0.09269971081251317,
                                                    0.0657184256393298],
 '1day.excess_return_with_cost.information_ratio': [0.5649832165888312,
                                                    0.7857064560613483,
                                                    0.42725276418160857,
                                                    1.2498966992194853,
                                                    0.8434476777972351],
 '1day.excess_return_with_cost.max_drawdown': [-0.09264196275626242,
                                               -0.11042126565462691,
                                               -0.12438813489577007,
                                               -0.0910373026769272,
                                               -0.14795385465041527],
 'IC': [0.02338127556803707,
        0.023874553769198607,
        0.021049908565493873,
        0.022668472335526615,
        0.023429347755308673],
 'ICIR': [0.20238622048809674,
          0.18560857194822403,
          0.1806449258518542,
          0.20035905213919242,
          0.2010511035996123],
 'Rank IC': [0.013917040518004948,
             0.012129057369372705,
             0.014330230707453042,
             0.018533569798826154,
             0.008485277600671977],
 'Rank ICIR': [0.12551679322509657,
               0.09548055549514188,
               0.12272525155573737,
               0.1641887623113997,
               0.07311631025877363],
 'mae': [0.685724139213562,
         0.685746431350708,
         0.6857940554618835,
         0.6857808232307434,
         0.6859009265899658],
 'mse': [0.9972350597381592,
         0.9971662163734436,
         0.997454822063446,
         0.9973787665367126,
         0.9972341656684875]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3047527:MainThread](2024-04-25 05:14:26,689) INFO - qlib.TransformerModel - [pytorch_transformer.py:66] - Naive Transformer:
batch_size : 2048
dim : 32
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:27<45:57, 27.86s/it]epoch:   2%|▏         | 2/100 [00:55<45:17, 27.73s/it]epoch:   3%|▎         | 3/100 [01:22<44:34, 27.57s/it]epoch:   4%|▍         | 4/100 [01:50<44:19, 27.70s/it]epoch:   5%|▌         | 5/100 [02:18<43:48, 27.67s/it]epoch:   6%|▌         | 6/100 [02:45<43:16, 27.63s/it]epoch:   7%|▋         | 7/100 [03:13<42:45, 27.59s/it]epoch:   8%|▊         | 8/100 [03:41<42:21, 27.62s/it]epoch:   9%|▉         | 9/100 [04:08<41:47, 27.56s/it]epoch:  10%|█         | 10/100 [04:36<41:26, 27.63s/it]epoch:  11%|█         | 11/100 [05:03<40:58, 27.63s/it]epoch:  12%|█▏        | 12/100 [05:31<40:29, 27.61s/it]epoch:  13%|█▎        | 13/100 [05:59<40:00, 27.60s/it]epoch:  14%|█▍        | 14/100 [06:26<39:34, 27.61s/it]epoch:  15%|█▌        | 15/100 [06:54<39:06, 27.61s/it]epoch:  16%|█▌        | 16/100 [07:21<38:39, 27.62s/it]epoch:  17%|█▋        | 17/100 [07:49<38:06, 27.54s/it]epoch:  18%|█▊        | 18/100 [08:17<37:43, 27.61s/it]epoch:  19%|█▉        | 19/100 [08:44<37:12, 27.56s/it]epoch:  20%|██        | 20/100 [09:12<36:46, 27.58s/it]0.04357885577406992
best ic: 0.04357885577406992
epoch:  21%|██        | 21/100 [09:43<37:45, 28.68s/it]0.03754752561255235
epoch:  22%|██▏       | 22/100 [10:14<38:22, 29.52s/it]0.04212147502524219
epoch:  23%|██▎       | 23/100 [10:46<38:36, 30.08s/it]0.04067688200516302
epoch:  24%|██▍       | 24/100 [11:17<38:37, 30.50s/it]0.04127337590652746
epoch:  25%|██▌       | 25/100 [11:49<38:28, 30.78s/it]0.04087297025266812
epoch:  26%|██▌       | 26/100 [12:20<38:05, 30.88s/it]0.04086289409347661
epoch:  27%|██▋       | 27/100 [12:51<37:36, 30.92s/it]0.039957288733589384
epoch:  28%|██▊       | 28/100 [13:22<37:11, 30.99s/it]0.042115172760728875
epoch:  28%|██▊       | 28/100 [13:53<35:43, 29.77s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3047527:MainThread](2024-04-25 05:28:20,152) INFO - qlib.workflow - [exp.py:258] - Experiment 49 starts running ...
[3047527:MainThread](2024-04-25 05:28:20,170) INFO - qlib.workflow - [recorder.py:341] - Recorder 2cf81d5765fb472291176322ae3b9e55 starts running under Experiment 49 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:13,  4.45it/s]online:   3%|▎         | 2/63 [00:00<00:13,  4.56it/s]online:   5%|▍         | 3/63 [00:00<00:13,  4.51it/s]online:   6%|▋         | 4/63 [00:00<00:13,  4.53it/s]online:   8%|▊         | 5/63 [00:01<00:12,  4.59it/s]online:  10%|▉         | 6/63 [00:01<00:12,  4.56it/s]online:  11%|█         | 7/63 [00:01<00:12,  4.55it/s]online:  13%|█▎        | 8/63 [00:01<00:12,  4.54it/s]online:  14%|█▍        | 9/63 [00:01<00:11,  4.55it/s]online:  16%|█▌        | 10/63 [00:02<00:11,  4.56it/s]online:  17%|█▋        | 11/63 [00:02<00:11,  4.55it/s]online:  19%|█▉        | 12/63 [00:02<00:11,  4.54it/s]online:  21%|██        | 13/63 [00:02<00:10,  4.56it/s]online:  22%|██▏       | 14/63 [00:03<00:10,  4.56it/s]online:  24%|██▍       | 15/63 [00:03<00:10,  4.58it/s]online:  25%|██▌       | 16/63 [00:03<00:10,  4.53it/s]online:  27%|██▋       | 17/63 [00:03<00:10,  4.53it/s]online:  29%|██▊       | 18/63 [00:03<00:09,  4.58it/s]online:  30%|███       | 19/63 [00:04<00:09,  4.55it/s]online:  32%|███▏      | 20/63 [00:04<00:09,  4.55it/s]online:  33%|███▎      | 21/63 [00:04<00:09,  4.56it/s]online:  35%|███▍      | 22/63 [00:04<00:09,  4.55it/s]online:  37%|███▋      | 23/63 [00:05<00:08,  4.54it/s]online:  38%|███▊      | 24/63 [00:05<00:08,  4.54it/s]online:  40%|███▉      | 25/63 [00:05<00:08,  4.54it/s]online:  41%|████▏     | 26/63 [00:05<00:08,  4.55it/s]online:  43%|████▎     | 27/63 [00:05<00:07,  4.55it/s]online:  44%|████▍     | 28/63 [00:06<00:07,  4.56it/s]online:  46%|████▌     | 29/63 [00:06<00:07,  4.54it/s]online:  48%|████▊     | 30/63 [00:06<00:07,  4.55it/s]online:  49%|████▉     | 31/63 [00:06<00:07,  4.56it/s]online:  51%|█████     | 32/63 [00:07<00:06,  4.56it/s]online:  52%|█████▏    | 33/63 [00:07<00:06,  4.57it/s]online:  54%|█████▍    | 34/63 [00:07<00:06,  4.59it/s]online:  56%|█████▌    | 35/63 [00:07<00:06,  4.55it/s]online:  57%|█████▋    | 36/63 [00:07<00:05,  4.55it/s]online:  59%|█████▊    | 37/63 [00:08<00:05,  4.55it/s]online:  60%|██████    | 38/63 [00:08<00:05,  4.55it/s]online:  62%|██████▏   | 39/63 [00:08<00:05,  4.55it/s]online:  63%|██████▎   | 40/63 [00:08<00:05,  4.54it/s]online:  65%|██████▌   | 41/63 [00:09<00:04,  4.55it/s]online:  67%|██████▋   | 42/63 [00:09<00:04,  4.55it/s]online:  68%|██████▊   | 43/63 [00:09<00:04,  4.55it/s]online:  70%|██████▉   | 44/63 [00:09<00:04,  4.56it/s]online:  71%|███████▏  | 45/63 [00:09<00:03,  4.58it/s]online:  73%|███████▎  | 46/63 [00:10<00:03,  4.55it/s]online:  75%|███████▍  | 47/63 [00:10<00:03,  4.55it/s]online:  76%|███████▌  | 48/63 [00:10<00:03,  4.57it/s]online:  78%|███████▊  | 49/63 [00:10<00:03,  4.54it/s]online:  79%|███████▉  | 50/63 [00:10<00:02,  4.57it/s]online:  81%|████████  | 51/63 [00:11<00:02,  4.60it/s]online:  83%|████████▎ | 52/63 [00:11<00:02,  4.57it/s]online:  84%|████████▍ | 53/63 [00:11<00:02,  4.54it/s]online:  86%|████████▌ | 54/63 [00:11<00:01,  4.54it/s]online:  87%|████████▋ | 55/63 [00:12<00:01,  4.58it/s]online:  89%|████████▉ | 56/63 [00:12<00:01,  4.53it/s]online:  90%|█████████ | 57/63 [00:12<00:01,  4.56it/s]online:  92%|█████████▏| 58/63 [00:12<00:01,  4.54it/s]online:  94%|█████████▎| 59/63 [00:12<00:00,  4.57it/s]online:  95%|█████████▌| 60/63 [00:13<00:00,  4.53it/s]online:  97%|█████████▋| 61/63 [00:13<00:00,  4.58it/s]online:  98%|█████████▊| 62/63 [00:13<00:00,  4.55it/s]online: 100%|██████████| 63/63 [00:13<00:00,  4.73it/s]online: 100%|██████████| 63/63 [00:13<00:00,  4.56it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.001
[3047527:MainThread](2024-04-25 05:29:05,669) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9972487 mae 0.6857697
{'IC': 0.02417324596657715,
 'ICIR': 0.1958382849156171,
 'Rank IC': 0.015422447514420396,
 'Rank ICIR': 0.12574576750378694}
[3047527:MainThread](2024-04-25 05:29:08,206) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3047527:MainThread](2024-04-25 05:29:24,161) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 05:29:24,164) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 05:29:30,256) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f6e1d035040>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<02:01,  7.98it/s]backtest loop:   1%|          | 9/971 [00:00<00:43, 22.14it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:29, 32.35it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:25, 37.60it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 43.12it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 47.55it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:19, 47.28it/s]backtest loop:   5%|▍         | 46/971 [00:01<00:17, 51.66it/s]backtest loop:   5%|▌         | 52/971 [00:01<00:17, 53.48it/s]backtest loop:   6%|▌         | 58/971 [00:01<00:17, 51.84it/s]backtest loop:   7%|▋         | 65/971 [00:01<00:16, 55.04it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 54.35it/s]backtest loop:   8%|▊         | 78/971 [00:01<00:16, 55.54it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 56.11it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:15, 57.99it/s]backtest loop:  10%|▉         | 97/971 [00:02<00:15, 55.39it/s]backtest loop:  11%|█         | 103/971 [00:02<00:15, 56.32it/s]backtest loop:  11%|█         | 109/971 [00:02<00:15, 56.93it/s]backtest loop:  12%|█▏        | 115/971 [00:02<00:14, 57.48it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 57.10it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:16, 51.67it/s]backtest loop:  14%|█▎        | 133/971 [00:02<00:15, 53.87it/s]backtest loop:  14%|█▍        | 139/971 [00:02<00:15, 55.34it/s]backtest loop:  15%|█▍        | 145/971 [00:02<00:14, 56.38it/s]backtest loop:  16%|█▌        | 151/971 [00:03<00:15, 53.49it/s]backtest loop:  16%|█▌        | 157/971 [00:03<00:14, 55.24it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:14, 55.88it/s]backtest loop:  17%|█▋        | 169/971 [00:03<00:14, 56.79it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 55.13it/s]backtest loop:  19%|█▊        | 182/971 [00:03<00:14, 55.86it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 56.94it/s]backtest loop:  20%|██        | 195/971 [00:03<00:14, 55.22it/s]backtest loop:  21%|██        | 201/971 [00:03<00:13, 56.33it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:13, 57.21it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:13, 54.82it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:13, 55.90it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:13, 53.50it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:13, 55.13it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:13, 56.25it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 58.35it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:13, 54.88it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:12, 55.87it/s]backtest loop:  27%|██▋       | 262/971 [00:05<00:12, 55.19it/s]backtest loop:  28%|██▊       | 268/971 [00:05<00:13, 51.92it/s]backtest loop:  28%|██▊       | 274/971 [00:05<00:13, 52.52it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:13, 52.86it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:13, 50.32it/s]backtest loop:  30%|███       | 292/971 [00:05<00:13, 51.20it/s]backtest loop:  31%|███       | 298/971 [00:05<00:13, 51.70it/s]backtest loop:  31%|███▏      | 304/971 [00:05<00:12, 52.33it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:13, 49.76it/s]backtest loop:  33%|███▎      | 316/971 [00:06<00:12, 50.88it/s]backtest loop:  33%|███▎      | 322/971 [00:06<00:12, 52.17it/s]backtest loop:  34%|███▍      | 328/971 [00:06<00:12, 52.97it/s]backtest loop:  34%|███▍      | 334/971 [00:06<00:11, 53.31it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:12, 50.06it/s]backtest loop:  36%|███▌      | 346/971 [00:06<00:12, 51.20it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:11, 52.18it/s]backtest loop:  37%|███▋      | 358/971 [00:06<00:11, 53.06it/s]backtest loop:  37%|███▋      | 364/971 [00:07<00:11, 50.90it/s]backtest loop:  38%|███▊      | 370/971 [00:07<00:12, 48.87it/s]backtest loop:  39%|███▊      | 376/971 [00:07<00:11, 50.33it/s]backtest loop:  39%|███▉      | 382/971 [00:07<00:11, 51.25it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:11, 49.04it/s]backtest loop:  41%|████      | 394/971 [00:07<00:11, 50.20it/s]backtest loop:  41%|████      | 400/971 [00:07<00:11, 50.95it/s]backtest loop:  42%|████▏     | 406/971 [00:07<00:10, 51.86it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:10, 52.46it/s]backtest loop:  43%|████▎     | 418/971 [00:08<00:11, 49.89it/s]backtest loop:  44%|████▎     | 424/971 [00:08<00:10, 50.86it/s]backtest loop:  44%|████▍     | 430/971 [00:08<00:10, 51.50it/s]backtest loop:  45%|████▍     | 436/971 [00:08<00:10, 52.21it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:10, 49.50it/s]backtest loop:  46%|████▌     | 448/971 [00:08<00:10, 50.67it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:10, 51.65it/s]backtest loop:  47%|████▋     | 460/971 [00:08<00:09, 52.21it/s]backtest loop:  48%|████▊     | 466/971 [00:09<00:09, 52.30it/s]backtest loop:  49%|████▊     | 472/971 [00:09<00:10, 49.74it/s]backtest loop:  49%|████▉     | 478/971 [00:09<00:09, 51.44it/s]backtest loop:  50%|████▉     | 484/971 [00:09<00:09, 52.09it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:09, 49.71it/s]backtest loop:  51%|█████     | 496/971 [00:09<00:09, 51.13it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:09, 51.86it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:09, 50.01it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 51.17it/s]backtest loop:  54%|█████▎    | 520/971 [00:10<00:08, 51.98it/s]backtest loop:  54%|█████▍    | 526/971 [00:10<00:08, 49.84it/s]backtest loop:  55%|█████▍    | 532/971 [00:10<00:08, 50.96it/s]backtest loop:  55%|█████▌    | 538/971 [00:10<00:08, 51.76it/s]backtest loop:  56%|█████▌    | 544/971 [00:10<00:08, 52.67it/s]backtest loop:  57%|█████▋    | 550/971 [00:10<00:07, 53.13it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:08, 50.52it/s]backtest loop:  58%|█████▊    | 562/971 [00:10<00:07, 51.55it/s]backtest loop:  58%|█████▊    | 568/971 [00:11<00:07, 52.09it/s]backtest loop:  59%|█████▉    | 574/971 [00:11<00:07, 52.76it/s]backtest loop:  60%|█████▉    | 580/971 [00:11<00:07, 53.03it/s]backtest loop:  60%|██████    | 586/971 [00:11<00:07, 50.23it/s]backtest loop:  61%|██████    | 592/971 [00:11<00:07, 51.22it/s]backtest loop:  62%|██████▏   | 598/971 [00:11<00:07, 52.08it/s]backtest loop:  62%|██████▏   | 604/971 [00:11<00:06, 52.62it/s]backtest loop:  63%|██████▎   | 610/971 [00:11<00:07, 49.62it/s]backtest loop:  63%|██████▎   | 616/971 [00:11<00:06, 50.77it/s]backtest loop:  64%|██████▍   | 622/971 [00:12<00:06, 51.60it/s]backtest loop:  65%|██████▍   | 628/971 [00:12<00:06, 52.54it/s]backtest loop:  65%|██████▌   | 634/971 [00:12<00:06, 52.97it/s]backtest loop:  66%|██████▌   | 640/971 [00:12<00:06, 50.22it/s]backtest loop:  67%|██████▋   | 646/971 [00:12<00:06, 51.29it/s]backtest loop:  67%|██████▋   | 652/971 [00:12<00:06, 51.91it/s]backtest loop:  68%|██████▊   | 658/971 [00:12<00:05, 52.75it/s]backtest loop:  68%|██████▊   | 664/971 [00:12<00:05, 53.12it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 50.38it/s]backtest loop:  70%|██████▉   | 676/971 [00:13<00:05, 51.36it/s]backtest loop:  70%|███████   | 682/971 [00:13<00:05, 52.07it/s]backtest loop:  71%|███████   | 688/971 [00:13<00:05, 52.40it/s]backtest loop:  71%|███████▏  | 694/971 [00:13<00:05, 49.78it/s]backtest loop:  72%|███████▏  | 700/971 [00:13<00:05, 51.09it/s]backtest loop:  73%|███████▎  | 706/971 [00:13<00:05, 51.87it/s]backtest loop:  73%|███████▎  | 712/971 [00:13<00:04, 52.66it/s]backtest loop:  74%|███████▍  | 718/971 [00:13<00:04, 53.12it/s]backtest loop:  75%|███████▍  | 724/971 [00:14<00:04, 50.21it/s]backtest loop:  75%|███████▌  | 730/971 [00:14<00:04, 51.35it/s]backtest loop:  76%|███████▌  | 736/971 [00:14<00:04, 48.95it/s]backtest loop:  76%|███████▋  | 742/971 [00:14<00:04, 50.18it/s]backtest loop:  77%|███████▋  | 748/971 [00:14<00:04, 48.51it/s]backtest loop:  78%|███████▊  | 754/971 [00:14<00:04, 50.12it/s]backtest loop:  78%|███████▊  | 760/971 [00:14<00:04, 48.71it/s]backtest loop:  79%|███████▉  | 766/971 [00:14<00:04, 50.42it/s]backtest loop:  80%|███████▉  | 772/971 [00:15<00:03, 51.34it/s]backtest loop:  80%|████████  | 778/971 [00:15<00:03, 52.17it/s]backtest loop:  81%|████████  | 784/971 [00:15<00:03, 49.80it/s]backtest loop:  81%|████████▏ | 790/971 [00:15<00:03, 50.92it/s]backtest loop:  82%|████████▏ | 796/971 [00:15<00:03, 51.76it/s]backtest loop:  83%|████████▎ | 802/971 [00:15<00:03, 52.66it/s]backtest loop:  83%|████████▎ | 808/971 [00:15<00:03, 49.88it/s]backtest loop:  84%|████████▍ | 814/971 [00:15<00:03, 50.80it/s]backtest loop:  84%|████████▍ | 820/971 [00:15<00:02, 51.71it/s]backtest loop:  85%|████████▌ | 826/971 [00:16<00:02, 52.25it/s]backtest loop:  86%|████████▌ | 832/971 [00:16<00:02, 52.62it/s]backtest loop:  86%|████████▋ | 838/971 [00:16<00:02, 49.88it/s]backtest loop:  87%|████████▋ | 844/971 [00:16<00:02, 51.05it/s]backtest loop:  88%|████████▊ | 850/971 [00:16<00:02, 52.05it/s]backtest loop:  88%|████████▊ | 856/971 [00:16<00:02, 52.29it/s]backtest loop:  89%|████████▉ | 862/971 [00:16<00:02, 49.64it/s]backtest loop:  89%|████████▉ | 868/971 [00:16<00:02, 50.68it/s]backtest loop:  90%|█████████ | 874/971 [00:16<00:01, 51.53it/s]backtest loop:  91%|█████████ | 880/971 [00:17<00:01, 52.20it/s]backtest loop:  91%|█████████ | 886/971 [00:17<00:01, 52.65it/s]backtest loop:  92%|█████████▏| 892/971 [00:17<00:01, 49.88it/s]backtest loop:  92%|█████████▏| 898/971 [00:17<00:01, 50.85it/s]backtest loop:  93%|█████████▎| 904/971 [00:17<00:01, 51.60it/s]backtest loop:  94%|█████████▎| 910/971 [00:17<00:01, 52.17it/s]backtest loop:  94%|█████████▍| 916/971 [00:17<00:01, 49.63it/s]backtest loop:  95%|█████████▍| 922/971 [00:17<00:00, 50.75it/s]backtest loop:  96%|█████████▌| 928/971 [00:18<00:00, 51.62it/s]backtest loop:  96%|█████████▌| 934/971 [00:18<00:00, 52.13it/s]backtest loop:  97%|█████████▋| 940/971 [00:18<00:00, 49.70it/s]backtest loop:  97%|█████████▋| 946/971 [00:18<00:00, 50.82it/s]backtest loop:  98%|█████████▊| 952/971 [00:18<00:00, 51.63it/s]backtest loop:  99%|█████████▊| 958/971 [00:18<00:00, 52.35it/s]backtest loop:  99%|█████████▉| 964/971 [00:18<00:00, 52.71it/s]backtest loop: 100%|█████████▉| 970/971 [00:18<00:00, 49.95it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 51.41it/s]
[3047527:MainThread](2024-04-25 05:29:49,238) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000311
std                0.005261
annualized_return  0.073997
information_ratio  0.911748
max_drawdown      -0.118966
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000117
std                0.005264
annualized_return  0.027931
information_ratio  0.343915
max_drawdown      -0.175983
[3047527:MainThread](2024-04-25 05:29:49,256) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_Transformer_alpha360_horizon1_step20_rankFalse_2024-04-25_03:13:01_online`.
Round 6 Done!
{'1day.excess_return_with_cost.annualized_return': [0.043797486231573146,
                                                    0.0634228370113721,
                                                    0.032834642441840194,
                                                    0.09269971081251317,
                                                    0.0657184256393298,
                                                    0.02793087131617893],
 '1day.excess_return_with_cost.information_ratio': [0.5649832165888312,
                                                    0.7857064560613483,
                                                    0.42725276418160857,
                                                    1.2498966992194853,
                                                    0.8434476777972351,
                                                    0.3439149144228769],
 '1day.excess_return_with_cost.max_drawdown': [-0.09264196275626242,
                                               -0.11042126565462691,
                                               -0.12438813489577007,
                                               -0.0910373026769272,
                                               -0.14795385465041527,
                                               -0.17598279790117916],
 'IC': [0.02338127556803707,
        0.023874553769198607,
        0.021049908565493873,
        0.022668472335526615,
        0.023429347755308673,
        0.02417324596657715],
 'ICIR': [0.20238622048809674,
          0.18560857194822403,
          0.1806449258518542,
          0.20035905213919242,
          0.2010511035996123,
          0.1958382849156171],
 'Rank IC': [0.013917040518004948,
             0.012129057369372705,
             0.014330230707453042,
             0.018533569798826154,
             0.008485277600671977,
             0.015422447514420396],
 'Rank ICIR': [0.12551679322509657,
               0.09548055549514188,
               0.12272525155573737,
               0.1641887623113997,
               0.07311631025877363,
               0.12574576750378694],
 'mae': [0.685724139213562,
         0.685746431350708,
         0.6857940554618835,
         0.6857808232307434,
         0.6859009265899658,
         0.6857696771621704],
 'mse': [0.9972350597381592,
         0.9971662163734436,
         0.997454822063446,
         0.9973787665367126,
         0.9972341656684875,
         0.9972487092018127]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3047527:MainThread](2024-04-25 05:29:50,674) INFO - qlib.TransformerModel - [pytorch_transformer.py:66] - Naive Transformer:
batch_size : 2048
dim : 32
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:27<45:53, 27.81s/it]epoch:   2%|▏         | 2/100 [00:55<45:11, 27.67s/it]epoch:   3%|▎         | 3/100 [01:23<44:41, 27.65s/it]epoch:   4%|▍         | 4/100 [01:50<44:16, 27.67s/it]epoch:   5%|▌         | 5/100 [02:18<43:38, 27.57s/it]epoch:   6%|▌         | 6/100 [02:46<43:23, 27.70s/it]epoch:   7%|▋         | 7/100 [03:13<42:42, 27.55s/it]epoch:   8%|▊         | 8/100 [03:40<42:16, 27.57s/it]epoch:   9%|▉         | 9/100 [04:08<41:40, 27.47s/it]epoch:  10%|█         | 10/100 [04:36<41:24, 27.61s/it]epoch:  11%|█         | 11/100 [05:03<40:52, 27.55s/it]epoch:  12%|█▏        | 12/100 [05:31<40:29, 27.61s/it]epoch:  13%|█▎        | 13/100 [05:58<39:59, 27.58s/it]epoch:  14%|█▍        | 14/100 [06:26<39:33, 27.60s/it]epoch:  15%|█▌        | 15/100 [06:53<39:01, 27.54s/it]epoch:  16%|█▌        | 16/100 [07:21<38:37, 27.59s/it]epoch:  17%|█▋        | 17/100 [07:49<38:09, 27.58s/it]epoch:  18%|█▊        | 18/100 [08:16<37:43, 27.60s/it]epoch:  19%|█▉        | 19/100 [08:43<37:06, 27.49s/it]epoch:  20%|██        | 20/100 [09:11<36:46, 27.58s/it]0.04103091332665161
best ic: 0.04103091332665161
epoch:  21%|██        | 21/100 [09:43<37:59, 28.86s/it]0.037496536414284416
epoch:  22%|██▏       | 22/100 [10:17<39:25, 30.32s/it]0.040870731487345255
epoch:  23%|██▎       | 23/100 [10:49<39:43, 30.96s/it]0.04193823656842271
best ic: 0.04193823656842271
epoch:  24%|██▍       | 24/100 [11:21<39:25, 31.12s/it]0.04236244695501353
best ic: 0.04236244695501353
epoch:  25%|██▌       | 25/100 [11:52<38:54, 31.12s/it]0.045199385081931255
best ic: 0.045199385081931255
epoch:  26%|██▌       | 26/100 [12:23<38:14, 31.00s/it]0.04500628398794624
epoch:  27%|██▋       | 27/100 [12:54<37:43, 31.00s/it]0.04636668828978498
best ic: 0.04636668828978498
epoch:  28%|██▊       | 28/100 [13:24<36:58, 30.81s/it]0.04020271297594019
epoch:  29%|██▉       | 29/100 [13:55<36:37, 30.96s/it]0.04100046239939432
epoch:  30%|███       | 30/100 [14:26<35:53, 30.76s/it]0.04217305427214282
epoch:  31%|███       | 31/100 [14:57<35:28, 30.85s/it]0.04103639730974411
epoch:  32%|███▏      | 32/100 [15:27<34:49, 30.73s/it]0.04374106622494272
epoch:  33%|███▎      | 33/100 [15:58<34:27, 30.86s/it]0.04039133991914488
epoch:  34%|███▍      | 34/100 [16:29<33:46, 30.70s/it]0.04318567619312343
epoch:  35%|███▌      | 35/100 [17:00<33:24, 30.84s/it]0.0394421916846771
epoch:  35%|███▌      | 35/100 [17:30<32:31, 30.02s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3047527:MainThread](2024-04-25 05:47:21,438) INFO - qlib.workflow - [exp.py:258] - Experiment 49 starts running ...
[3047527:MainThread](2024-04-25 05:47:21,456) INFO - qlib.workflow - [recorder.py:341] - Recorder b7bb9a41a4d94ec7b02770395a2fb277 starts running under Experiment 49 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:12,  4.90it/s]online:   3%|▎         | 2/63 [00:00<00:13,  4.45it/s]online:   5%|▍         | 3/63 [00:00<00:13,  4.38it/s]online:   6%|▋         | 4/63 [00:00<00:13,  4.30it/s]online:   8%|▊         | 5/63 [00:01<00:13,  4.22it/s]online:  10%|▉         | 6/63 [00:01<00:13,  4.26it/s]online:  11%|█         | 7/63 [00:01<00:13,  4.27it/s]online:  13%|█▎        | 8/63 [00:01<00:12,  4.26it/s]online:  14%|█▍        | 9/63 [00:02<00:12,  4.27it/s]online:  16%|█▌        | 10/63 [00:02<00:12,  4.30it/s]online:  17%|█▋        | 11/63 [00:02<00:12,  4.25it/s]online:  19%|█▉        | 12/63 [00:02<00:12,  4.16it/s]online:  21%|██        | 13/63 [00:03<00:11,  4.22it/s]online:  22%|██▏       | 14/63 [00:03<00:11,  4.24it/s]online:  24%|██▍       | 15/63 [00:03<00:11,  4.26it/s]online:  25%|██▌       | 16/63 [00:03<00:11,  4.27it/s]online:  27%|██▋       | 17/63 [00:03<00:10,  4.27it/s]online:  29%|██▊       | 18/63 [00:04<00:10,  4.28it/s]online:  30%|███       | 19/63 [00:04<00:10,  4.28it/s]online:  32%|███▏      | 20/63 [00:04<00:10,  4.27it/s]online:  33%|███▎      | 21/63 [00:04<00:09,  4.27it/s]online:  35%|███▍      | 22/63 [00:05<00:09,  4.28it/s]online:  37%|███▋      | 23/63 [00:05<00:09,  4.28it/s]online:  38%|███▊      | 24/63 [00:05<00:09,  4.28it/s]online:  40%|███▉      | 25/63 [00:05<00:08,  4.29it/s]online:  41%|████▏     | 26/63 [00:06<00:08,  4.29it/s]online:  43%|████▎     | 27/63 [00:06<00:08,  4.29it/s]online:  44%|████▍     | 28/63 [00:06<00:08,  4.28it/s]online:  46%|████▌     | 29/63 [00:06<00:07,  4.26it/s]online:  48%|████▊     | 30/63 [00:07<00:07,  4.28it/s]online:  49%|████▉     | 31/63 [00:07<00:07,  4.27it/s]online:  51%|█████     | 32/63 [00:07<00:07,  4.23it/s]online:  52%|█████▏    | 33/63 [00:07<00:07,  4.21it/s]online:  54%|█████▍    | 34/63 [00:07<00:06,  4.24it/s]online:  56%|█████▌    | 35/63 [00:08<00:06,  4.25it/s]online:  57%|█████▋    | 36/63 [00:08<00:06,  4.25it/s]online:  59%|█████▊    | 37/63 [00:08<00:06,  4.29it/s]online:  60%|██████    | 38/63 [00:08<00:05,  4.24it/s]online:  62%|██████▏   | 39/63 [00:09<00:05,  4.19it/s]online:  63%|██████▎   | 40/63 [00:09<00:05,  4.20it/s]online:  65%|██████▌   | 41/63 [00:09<00:05,  4.21it/s]online:  67%|██████▋   | 42/63 [00:09<00:04,  4.23it/s]online:  68%|██████▊   | 43/63 [00:10<00:04,  4.23it/s]online:  70%|██████▉   | 44/63 [00:10<00:04,  4.23it/s]online:  71%|███████▏  | 45/63 [00:10<00:04,  4.30it/s]online:  73%|███████▎  | 46/63 [00:10<00:03,  4.26it/s]online:  75%|███████▍  | 47/63 [00:11<00:03,  4.25it/s]online:  76%|███████▌  | 48/63 [00:11<00:03,  4.25it/s]online:  78%|███████▊  | 49/63 [00:11<00:03,  4.26it/s]online:  79%|███████▉  | 50/63 [00:11<00:03,  4.27it/s]online:  81%|████████  | 51/63 [00:11<00:02,  4.30it/s]online:  83%|████████▎ | 52/63 [00:12<00:02,  4.25it/s]online:  84%|████████▍ | 53/63 [00:12<00:02,  4.31it/s]online:  86%|████████▌ | 54/63 [00:12<00:02,  4.30it/s]online:  87%|████████▋ | 55/63 [00:12<00:01,  4.25it/s]online:  89%|████████▉ | 56/63 [00:13<00:01,  4.24it/s]online:  90%|█████████ | 57/63 [00:13<00:01,  4.16it/s]online:  92%|█████████▏| 58/63 [00:13<00:01,  4.17it/s]online:  94%|█████████▎| 59/63 [00:13<00:00,  4.22it/s]online:  95%|█████████▌| 60/63 [00:14<00:00,  4.24it/s]online:  97%|█████████▋| 61/63 [00:14<00:00,  4.21it/s]online:  98%|█████████▊| 62/63 [00:14<00:00,  4.24it/s]online: 100%|██████████| 63/63 [00:14<00:00,  4.44it/s]online: 100%|██████████| 63/63 [00:14<00:00,  4.27it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.001
[3047527:MainThread](2024-04-25 05:48:05,085) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9970696 mae 0.685705
{'IC': 0.025525801842171507,
 'ICIR': 0.21886157065984174,
 'Rank IC': 0.01590147842680528,
 'Rank ICIR': 0.14020606031217148}
[3047527:MainThread](2024-04-25 05:48:06,975) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3047527:MainThread](2024-04-25 05:48:22,681) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 05:48:22,684) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 05:48:29,175) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f6e184d5ee0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<03:18,  4.88it/s]backtest loop:   1%|          | 9/971 [00:00<01:03, 15.09it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:36, 26.04it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:31, 30.45it/s]backtest loop:   3%|▎         | 28/971 [00:01<00:24, 38.72it/s]backtest loop:   4%|▎         | 34/971 [00:01<00:22, 41.61it/s]backtest loop:   4%|▍         | 40/971 [00:01<00:20, 45.83it/s]backtest loop:   5%|▍         | 46/971 [00:01<00:18, 49.49it/s]backtest loop:   5%|▌         | 53/971 [00:01<00:17, 53.42it/s]backtest loop:   6%|▌         | 59/971 [00:01<00:17, 52.36it/s]backtest loop:   7%|▋         | 66/971 [00:01<00:16, 55.58it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 54.24it/s]backtest loop:   8%|▊         | 78/971 [00:01<00:16, 55.67it/s]backtest loop:   9%|▉         | 85/971 [00:02<00:15, 57.75it/s]backtest loop:   9%|▉         | 92/971 [00:02<00:15, 56.17it/s]backtest loop:  10%|█         | 99/971 [00:02<00:15, 57.79it/s]backtest loop:  11%|█         | 105/971 [00:02<00:15, 56.79it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:15, 54.91it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 52.98it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:15, 55.71it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:15, 53.79it/s]backtest loop:  14%|█▍        | 136/971 [00:03<00:15, 52.21it/s]backtest loop:  15%|█▍        | 142/971 [00:03<00:15, 53.93it/s]backtest loop:  15%|█▌        | 149/971 [00:03<00:14, 56.38it/s]backtest loop:  16%|█▌        | 155/971 [00:03<00:14, 56.50it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 54.12it/s]backtest loop:  17%|█▋        | 167/971 [00:03<00:14, 55.60it/s]backtest loop:  18%|█▊        | 174/971 [00:03<00:13, 57.76it/s]backtest loop:  19%|█▊        | 180/971 [00:03<00:13, 57.81it/s]backtest loop:  19%|█▉        | 186/971 [00:03<00:14, 55.14it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:13, 56.15it/s]backtest loop:  20%|██        | 199/971 [00:04<00:13, 57.99it/s]backtest loop:  21%|██        | 205/971 [00:04<00:14, 53.25it/s]backtest loop:  22%|██▏       | 211/971 [00:04<00:13, 54.83it/s]backtest loop:  22%|██▏       | 217/971 [00:04<00:14, 53.05it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:13, 54.56it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 53.76it/s]backtest loop:  24%|██▍       | 236/971 [00:04<00:13, 55.07it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:12, 56.29it/s]backtest loop:  26%|██▌       | 248/971 [00:05<00:12, 57.27it/s]backtest loop:  26%|██▌       | 254/971 [00:05<00:13, 54.55it/s]backtest loop:  27%|██▋       | 260/971 [00:05<00:12, 56.01it/s]backtest loop:  27%|██▋       | 266/971 [00:05<00:13, 53.74it/s]backtest loop:  28%|██▊       | 272/971 [00:05<00:12, 55.19it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:12, 57.60it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:11, 58.27it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 55.35it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 57.57it/s]backtest loop:  31%|███▏      | 304/971 [00:05<00:11, 58.16it/s]backtest loop:  32%|███▏      | 310/971 [00:06<00:11, 55.44it/s]backtest loop:  33%|███▎      | 316/971 [00:06<00:11, 56.65it/s]backtest loop:  33%|███▎      | 323/971 [00:06<00:10, 59.09it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:11, 56.87it/s]backtest loop:  35%|███▍      | 336/971 [00:06<00:11, 57.63it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:10, 57.67it/s]backtest loop:  36%|███▌      | 348/971 [00:06<00:10, 58.16it/s]backtest loop:  37%|███▋      | 355/971 [00:06<00:10, 56.34it/s]backtest loop:  37%|███▋      | 362/971 [00:07<00:10, 58.69it/s]backtest loop:  38%|███▊      | 368/971 [00:07<00:11, 52.88it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:10, 55.85it/s]backtest loop:  39%|███▉      | 382/971 [00:07<00:10, 57.66it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:10, 55.21it/s]backtest loop:  41%|████      | 394/971 [00:07<00:10, 56.45it/s]backtest loop:  41%|████      | 400/971 [00:07<00:09, 57.33it/s]backtest loop:  42%|████▏     | 406/971 [00:07<00:09, 57.79it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:09, 55.81it/s]backtest loop:  43%|████▎     | 420/971 [00:08<00:09, 57.68it/s]backtest loop:  44%|████▍     | 426/971 [00:08<00:09, 58.28it/s]backtest loop:  44%|████▍     | 432/971 [00:08<00:09, 54.63it/s]backtest loop:  45%|████▌     | 438/971 [00:08<00:09, 55.95it/s]backtest loop:  46%|████▌     | 444/971 [00:08<00:09, 56.95it/s]backtest loop:  46%|████▋     | 450/971 [00:08<00:09, 57.62it/s]backtest loop:  47%|████▋     | 456/971 [00:08<00:08, 57.93it/s]backtest loop:  48%|████▊     | 462/971 [00:08<00:09, 54.84it/s]backtest loop:  48%|████▊     | 469/971 [00:08<00:08, 57.07it/s]backtest loop:  49%|████▉     | 476/971 [00:09<00:08, 58.89it/s]backtest loop:  50%|████▉     | 482/971 [00:09<00:08, 55.55it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:08, 57.78it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:08, 55.33it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:08, 57.39it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:08, 55.32it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 56.50it/s]backtest loop:  54%|█████▎    | 520/971 [00:09<00:07, 57.13it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 54.71it/s]backtest loop:  55%|█████▍    | 532/971 [00:10<00:07, 55.89it/s]backtest loop:  55%|█████▌    | 538/971 [00:10<00:07, 56.88it/s]backtest loop:  56%|█████▌    | 544/971 [00:10<00:07, 57.65it/s]backtest loop:  57%|█████▋    | 550/971 [00:10<00:07, 57.95it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:07, 54.91it/s]backtest loop:  58%|█████▊    | 562/971 [00:10<00:07, 56.16it/s]backtest loop:  59%|█████▊    | 569/971 [00:10<00:06, 57.90it/s]backtest loop:  59%|█████▉    | 575/971 [00:10<00:06, 58.30it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:07, 55.05it/s]backtest loop:  60%|██████    | 587/971 [00:11<00:06, 55.91it/s]backtest loop:  61%|██████    | 593/971 [00:11<00:06, 56.61it/s]backtest loop:  62%|██████▏   | 599/971 [00:11<00:06, 57.33it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:06, 54.62it/s]backtest loop:  63%|██████▎   | 611/971 [00:11<00:06, 55.88it/s]backtest loop:  64%|██████▎   | 617/971 [00:11<00:06, 56.70it/s]backtest loop:  64%|██████▍   | 623/971 [00:11<00:06, 57.47it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:06, 56.14it/s]backtest loop:  65%|██████▌   | 636/971 [00:11<00:05, 57.04it/s]backtest loop:  66%|██████▌   | 642/971 [00:11<00:05, 57.79it/s]backtest loop:  67%|██████▋   | 648/971 [00:12<00:05, 58.41it/s]backtest loop:  67%|██████▋   | 655/971 [00:12<00:05, 56.31it/s]backtest loop:  68%|██████▊   | 662/971 [00:12<00:05, 57.95it/s]backtest loop:  69%|██████▉   | 668/971 [00:12<00:05, 58.50it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:05, 55.40it/s]backtest loop:  70%|███████   | 680/971 [00:12<00:05, 56.17it/s]backtest loop:  71%|███████   | 686/971 [00:12<00:05, 56.96it/s]backtest loop:  71%|███████▏  | 692/971 [00:12<00:04, 57.69it/s]backtest loop:  72%|███████▏  | 698/971 [00:12<00:04, 58.12it/s]backtest loop:  73%|███████▎  | 704/971 [00:13<00:04, 55.09it/s]backtest loop:  73%|███████▎  | 710/971 [00:13<00:04, 56.41it/s]backtest loop:  74%|███████▎  | 716/971 [00:13<00:04, 57.40it/s]backtest loop:  74%|███████▍  | 722/971 [00:13<00:04, 58.09it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 58.26it/s]backtest loop:  76%|███████▌  | 734/971 [00:13<00:04, 52.22it/s]backtest loop:  76%|███████▌  | 740/971 [00:13<00:04, 54.17it/s]backtest loop:  77%|███████▋  | 746/971 [00:13<00:04, 55.75it/s]backtest loop:  77%|███████▋  | 752/971 [00:13<00:04, 53.67it/s]backtest loop:  78%|███████▊  | 759/971 [00:14<00:03, 56.55it/s]backtest loop:  79%|███████▉  | 765/971 [00:14<00:03, 54.37it/s]backtest loop:  79%|███████▉  | 771/971 [00:14<00:03, 54.06it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 54.99it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 53.19it/s]backtest loop:  81%|████████▏ | 789/971 [00:14<00:03, 55.03it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 54.80it/s]backtest loop:  82%|████████▏ | 801/971 [00:14<00:03, 54.35it/s]backtest loop:  83%|████████▎ | 807/971 [00:14<00:02, 55.64it/s]backtest loop:  84%|████████▎ | 813/971 [00:15<00:02, 52.78it/s]backtest loop:  84%|████████▍ | 819/971 [00:15<00:02, 54.32it/s]backtest loop:  85%|████████▍ | 825/971 [00:15<00:02, 55.58it/s]backtest loop:  86%|████████▌ | 831/971 [00:15<00:02, 56.59it/s]backtest loop:  86%|████████▌ | 837/971 [00:15<00:02, 57.36it/s]backtest loop:  87%|████████▋ | 843/971 [00:15<00:02, 54.34it/s]backtest loop:  87%|████████▋ | 849/971 [00:15<00:02, 55.78it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:02, 56.80it/s]backtest loop:  89%|████████▊ | 861/971 [00:15<00:01, 56.65it/s]backtest loop:  89%|████████▉ | 867/971 [00:16<00:01, 54.00it/s]backtest loop:  90%|████████▉ | 873/971 [00:16<00:01, 55.16it/s]backtest loop:  91%|█████████ | 879/971 [00:16<00:01, 56.24it/s]backtest loop:  91%|█████████ | 885/971 [00:16<00:01, 56.95it/s]backtest loop:  92%|█████████▏| 891/971 [00:16<00:01, 57.50it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 54.61it/s]backtest loop:  93%|█████████▎| 903/971 [00:16<00:01, 55.85it/s]backtest loop:  94%|█████████▎| 909/971 [00:16<00:01, 56.89it/s]backtest loop:  94%|█████████▍| 915/971 [00:16<00:00, 57.59it/s]backtest loop:  95%|█████████▍| 921/971 [00:16<00:00, 54.24it/s]backtest loop:  95%|█████████▌| 927/971 [00:17<00:00, 55.39it/s]backtest loop:  96%|█████████▌| 933/971 [00:17<00:00, 56.40it/s]backtest loop:  97%|█████████▋| 939/971 [00:17<00:00, 56.86it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 53.17it/s]backtest loop:  98%|█████████▊| 951/971 [00:17<00:00, 54.12it/s]backtest loop:  99%|█████████▊| 957/971 [00:17<00:00, 55.60it/s]backtest loop:  99%|█████████▉| 963/971 [00:17<00:00, 56.64it/s]backtest loop: 100%|█████████▉| 969/971 [00:17<00:00, 57.43it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.32it/s]
[3047527:MainThread](2024-04-25 05:48:47,130) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000554
std                0.005110
annualized_return  0.131949
information_ratio  1.673931
max_drawdown      -0.092622
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000363
std                0.005112
annualized_return  0.086343
information_ratio  1.094760
max_drawdown      -0.122296
[3047527:MainThread](2024-04-25 05:48:47,149) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_Transformer_alpha360_horizon1_step20_rankFalse_2024-04-25_03:13:01_online`.
Round 7 Done!
{'1day.excess_return_with_cost.annualized_return': [0.043797486231573146,
                                                    0.0634228370113721,
                                                    0.032834642441840194,
                                                    0.09269971081251317,
                                                    0.0657184256393298,
                                                    0.02793087131617893,
                                                    0.08634293469479305],
 '1day.excess_return_with_cost.information_ratio': [0.5649832165888312,
                                                    0.7857064560613483,
                                                    0.42725276418160857,
                                                    1.2498966992194853,
                                                    0.8434476777972351,
                                                    0.3439149144228769,
                                                    1.0947603545987385],
 '1day.excess_return_with_cost.max_drawdown': [-0.09264196275626242,
                                               -0.11042126565462691,
                                               -0.12438813489577007,
                                               -0.0910373026769272,
                                               -0.14795385465041527,
                                               -0.17598279790117916,
                                               -0.12229648137858812],
 'IC': [0.02338127556803707,
        0.023874553769198607,
        0.021049908565493873,
        0.022668472335526615,
        0.023429347755308673,
        0.02417324596657715,
        0.025525801842171507],
 'ICIR': [0.20238622048809674,
          0.18560857194822403,
          0.1806449258518542,
          0.20035905213919242,
          0.2010511035996123,
          0.1958382849156171,
          0.21886157065984174],
 'Rank IC': [0.013917040518004948,
             0.012129057369372705,
             0.014330230707453042,
             0.018533569798826154,
             0.008485277600671977,
             0.015422447514420396,
             0.01590147842680528],
 'Rank ICIR': [0.12551679322509657,
               0.09548055549514188,
               0.12272525155573737,
               0.1641887623113997,
               0.07311631025877363,
               0.12574576750378694,
               0.14020606031217148],
 'mae': [0.685724139213562,
         0.685746431350708,
         0.6857940554618835,
         0.6857808232307434,
         0.6859009265899658,
         0.6857696771621704,
         0.6857050061225891],
 'mse': [0.9972350597381592,
         0.9971662163734436,
         0.997454822063446,
         0.9973787665367126,
         0.9972341656684875,
         0.9972487092018127,
         0.9970695972442627]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3047527:MainThread](2024-04-25 05:48:48,455) INFO - qlib.TransformerModel - [pytorch_transformer.py:66] - Naive Transformer:
batch_size : 2048
dim : 32
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:27<45:49, 27.77s/it]epoch:   2%|▏         | 2/100 [00:55<45:02, 27.57s/it]epoch:   3%|▎         | 3/100 [01:22<44:14, 27.37s/it]epoch:   4%|▍         | 4/100 [01:50<44:00, 27.51s/it]epoch:   5%|▌         | 5/100 [02:17<43:26, 27.43s/it]epoch:   6%|▌         | 6/100 [02:44<42:59, 27.44s/it]epoch:   7%|▋         | 7/100 [03:11<42:24, 27.36s/it]epoch:   8%|▊         | 8/100 [03:39<42:05, 27.45s/it]epoch:   9%|▉         | 9/100 [04:06<41:28, 27.34s/it]epoch:  10%|█         | 10/100 [04:34<41:08, 27.43s/it]epoch:  11%|█         | 11/100 [05:01<40:38, 27.40s/it]epoch:  12%|█▏        | 12/100 [05:29<40:14, 27.44s/it]epoch:  13%|█▎        | 13/100 [05:56<39:33, 27.28s/it]epoch:  14%|█▍        | 14/100 [06:23<39:13, 27.37s/it]epoch:  15%|█▌        | 15/100 [06:51<39:06, 27.60s/it]epoch:  16%|█▌        | 16/100 [07:19<38:38, 27.60s/it]epoch:  17%|█▋        | 17/100 [07:46<37:56, 27.43s/it]epoch:  18%|█▊        | 18/100 [08:14<37:37, 27.53s/it]epoch:  19%|█▉        | 19/100 [08:41<36:55, 27.36s/it]epoch:  20%|██        | 20/100 [09:08<36:33, 27.42s/it]0.04127663771200547
best ic: 0.04127663771200547
epoch:  21%|██        | 21/100 [09:39<37:26, 28.43s/it]0.03946415095545499
epoch:  22%|██▏       | 22/100 [10:10<37:59, 29.22s/it]0.04056014429651887
epoch:  23%|██▎       | 23/100 [10:40<37:55, 29.56s/it]0.03875225978251136
epoch:  24%|██▍       | 24/100 [11:12<38:03, 30.04s/it]0.03843240958855589
epoch:  25%|██▌       | 25/100 [11:42<37:44, 30.19s/it]0.03820421400282758
epoch:  26%|██▌       | 26/100 [12:13<37:33, 30.46s/it]0.03634525737493038
epoch:  27%|██▋       | 27/100 [12:44<37:01, 30.43s/it]0.03864276518439049
epoch:  28%|██▊       | 28/100 [13:15<36:48, 30.67s/it]0.041867586614332
best ic: 0.041867586614332
epoch:  29%|██▉       | 29/100 [13:45<36:11, 30.58s/it]0.04128308281960331
epoch:  30%|███       | 30/100 [14:16<35:50, 30.72s/it]0.03753773444567444
epoch:  31%|███       | 31/100 [14:47<35:17, 30.68s/it]0.0420658281781076
best ic: 0.0420658281781076
epoch:  32%|███▏      | 32/100 [15:18<34:52, 30.77s/it]0.04444580604105438
best ic: 0.04444580604105438
epoch:  33%|███▎      | 33/100 [15:48<34:15, 30.68s/it]0.03510074330370962
epoch:  34%|███▍      | 34/100 [16:20<33:56, 30.86s/it]0.042088402748415896
epoch:  35%|███▌      | 35/100 [16:50<33:18, 30.74s/it]0.04102199556783163
epoch:  36%|███▌      | 36/100 [17:21<32:49, 30.78s/it]0.03879448812292622
epoch:  37%|███▋      | 37/100 [17:52<32:17, 30.76s/it]0.034964246159562826
epoch:  38%|███▊      | 38/100 [18:22<31:48, 30.78s/it]0.04043312548256908
epoch:  39%|███▉      | 39/100 [18:53<31:14, 30.73s/it]0.0348455956660378
epoch:  40%|████      | 40/100 [19:24<30:47, 30.79s/it]0.042954763659295514
epoch:  40%|████      | 40/100 [19:55<29:52, 29.88s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3047527:MainThread](2024-04-25 06:08:43,765) INFO - qlib.workflow - [exp.py:258] - Experiment 49 starts running ...
[3047527:MainThread](2024-04-25 06:08:43,783) INFO - qlib.workflow - [recorder.py:341] - Recorder e46f580cf3a74738af8ff9754eb3ffdc starts running under Experiment 49 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:11,  5.45it/s]online:   3%|▎         | 2/63 [00:00<00:12,  4.88it/s]online:   5%|▍         | 3/63 [00:00<00:12,  4.73it/s]online:   6%|▋         | 4/63 [00:00<00:12,  4.65it/s]online:   8%|▊         | 5/63 [00:01<00:12,  4.66it/s]online:  10%|▉         | 6/63 [00:01<00:12,  4.64it/s]online:  11%|█         | 7/63 [00:01<00:12,  4.60it/s]online:  13%|█▎        | 8/63 [00:01<00:11,  4.59it/s]online:  14%|█▍        | 9/63 [00:01<00:11,  4.57it/s]online:  16%|█▌        | 10/63 [00:02<00:11,  4.54it/s]online:  17%|█▋        | 11/63 [00:02<00:11,  4.57it/s]online:  19%|█▉        | 12/63 [00:02<00:11,  4.53it/s]online:  21%|██        | 13/63 [00:02<00:10,  4.55it/s]online:  22%|██▏       | 14/63 [00:03<00:10,  4.55it/s]online:  24%|██▍       | 15/63 [00:03<00:10,  4.58it/s]online:  25%|██▌       | 16/63 [00:03<00:10,  4.55it/s]online:  27%|██▋       | 17/63 [00:03<00:10,  4.60it/s]online:  29%|██▊       | 18/63 [00:03<00:09,  4.56it/s]online:  30%|███       | 19/63 [00:04<00:09,  4.57it/s]online:  32%|███▏      | 20/63 [00:04<00:09,  4.56it/s]online:  33%|███▎      | 21/63 [00:04<00:09,  4.57it/s]online:  35%|███▍      | 22/63 [00:04<00:08,  4.61it/s]online:  37%|███▋      | 23/63 [00:04<00:08,  4.61it/s]online:  38%|███▊      | 24/63 [00:05<00:08,  4.58it/s]online:  40%|███▉      | 25/63 [00:05<00:08,  4.62it/s]online:  41%|████▏     | 26/63 [00:05<00:08,  4.57it/s]online:  43%|████▎     | 27/63 [00:05<00:07,  4.59it/s]online:  44%|████▍     | 28/63 [00:06<00:07,  4.56it/s]online:  46%|████▌     | 29/63 [00:06<00:07,  4.52it/s]online:  48%|████▊     | 30/63 [00:06<00:07,  4.58it/s]online:  49%|████▉     | 31/63 [00:06<00:07,  4.56it/s]online:  51%|█████     | 32/63 [00:06<00:06,  4.56it/s]online:  52%|█████▏    | 33/63 [00:07<00:06,  4.58it/s]online:  54%|█████▍    | 34/63 [00:07<00:06,  4.57it/s]online:  56%|█████▌    | 35/63 [00:07<00:06,  4.56it/s]online:  57%|█████▋    | 36/63 [00:07<00:05,  4.50it/s]online:  59%|█████▊    | 37/63 [00:08<00:05,  4.54it/s]online:  60%|██████    | 38/63 [00:08<00:05,  4.53it/s]online:  62%|██████▏   | 39/63 [00:08<00:05,  4.53it/s]online:  63%|██████▎   | 40/63 [00:08<00:05,  4.56it/s]online:  65%|██████▌   | 41/63 [00:08<00:04,  4.56it/s]online:  67%|██████▋   | 42/63 [00:09<00:04,  4.57it/s]online:  68%|██████▊   | 43/63 [00:09<00:04,  4.55it/s]online:  70%|██████▉   | 44/63 [00:09<00:04,  4.54it/s]online:  71%|███████▏  | 45/63 [00:09<00:03,  4.56it/s]online:  73%|███████▎  | 46/63 [00:10<00:03,  4.54it/s]online:  75%|███████▍  | 47/63 [00:10<00:03,  4.56it/s]online:  76%|███████▌  | 48/63 [00:10<00:03,  4.56it/s]online:  78%|███████▊  | 49/63 [00:10<00:03,  4.55it/s]online:  79%|███████▉  | 50/63 [00:10<00:02,  4.54it/s]online:  81%|████████  | 51/63 [00:11<00:02,  4.55it/s]online:  83%|████████▎ | 52/63 [00:11<00:02,  4.54it/s]online:  84%|████████▍ | 53/63 [00:11<00:02,  4.56it/s]online:  86%|████████▌ | 54/63 [00:11<00:01,  4.55it/s]online:  87%|████████▋ | 55/63 [00:12<00:01,  4.58it/s]online:  89%|████████▉ | 56/63 [00:12<00:01,  4.55it/s]online:  90%|█████████ | 57/63 [00:12<00:01,  4.56it/s]online:  92%|█████████▏| 58/63 [00:12<00:01,  4.55it/s]online:  94%|█████████▎| 59/63 [00:12<00:00,  4.53it/s]online:  95%|█████████▌| 60/63 [00:13<00:00,  4.54it/s]online:  97%|█████████▋| 61/63 [00:13<00:00,  4.55it/s]online:  98%|█████████▊| 62/63 [00:13<00:00,  4.57it/s]online: 100%|██████████| 63/63 [00:13<00:00,  4.72it/s]online: 100%|██████████| 63/63 [00:13<00:00,  4.58it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.001
[3047527:MainThread](2024-04-25 06:09:12,186) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9971586 mae 0.68572426
{'IC': 0.02442065458106158,
 'ICIR': 0.19322319881052735,
 'Rank IC': 0.01134180877794962,
 'Rank ICIR': 0.09108542235925256}
[3047527:MainThread](2024-04-25 06:09:14,030) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3047527:MainThread](2024-04-25 06:09:29,218) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 06:09:29,222) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 06:09:35,547) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f6e1ae47f40>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:46,  9.10it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.20it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 34.85it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.77it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.51it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:18, 49.53it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:19, 48.89it/s]backtest loop:   5%|▍         | 46/971 [00:01<00:17, 52.98it/s]backtest loop:   5%|▌         | 52/971 [00:01<00:16, 54.48it/s]backtest loop:   6%|▌         | 58/971 [00:01<00:17, 50.93it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:17, 53.22it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:15, 56.49it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:16, 54.24it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 56.41it/s]backtest loop:   9%|▉         | 90/971 [00:01<00:15, 57.14it/s]backtest loop:  10%|▉         | 97/971 [00:02<00:15, 55.35it/s]backtest loop:  11%|█         | 103/971 [00:02<00:15, 56.38it/s]backtest loop:  11%|█         | 109/971 [00:02<00:15, 56.84it/s]backtest loop:  12%|█▏        | 115/971 [00:02<00:14, 57.28it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 57.88it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:16, 52.14it/s]backtest loop:  14%|█▎        | 133/971 [00:02<00:15, 54.20it/s]backtest loop:  14%|█▍        | 139/971 [00:02<00:14, 55.66it/s]backtest loop:  15%|█▌        | 146/971 [00:02<00:15, 54.53it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:14, 56.81it/s]backtest loop:  16%|█▋        | 160/971 [00:03<00:13, 58.50it/s]backtest loop:  17%|█▋        | 166/971 [00:03<00:14, 54.95it/s]backtest loop:  18%|█▊        | 172/971 [00:03<00:14, 55.84it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:13, 56.88it/s]backtest loop:  19%|█▉        | 184/971 [00:03<00:13, 57.51it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:14, 55.12it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 57.70it/s]backtest loop:  21%|██        | 203/971 [00:03<00:13, 57.95it/s]backtest loop:  22%|██▏       | 210/971 [00:04<00:13, 55.54it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:14, 53.78it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:13, 55.43it/s]backtest loop:  23%|██▎       | 228/971 [00:04<00:13, 56.18it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:13, 54.81it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:12, 56.95it/s]backtest loop:  26%|██▌       | 248/971 [00:04<00:12, 57.67it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:13, 55.02it/s]backtest loop:  27%|██▋       | 261/971 [00:04<00:12, 57.26it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:12, 54.69it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 55.79it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:11, 57.75it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 55.10it/s]backtest loop:  30%|███       | 292/971 [00:05<00:12, 56.39it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 56.22it/s]backtest loop:  31%|███▏      | 304/971 [00:05<00:11, 56.24it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:14, 45.39it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:14, 44.58it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:13, 47.74it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:12, 50.88it/s]backtest loop:  34%|███▍      | 334/971 [00:06<00:11, 54.43it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:11, 52.72it/s]backtest loop:  36%|███▌      | 346/971 [00:06<00:11, 54.66it/s]backtest loop:  36%|███▋      | 353/971 [00:06<00:10, 57.14it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 56.09it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 54.93it/s]backtest loop:  38%|███▊      | 373/971 [00:07<00:11, 53.18it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:10, 55.88it/s]backtest loop:  40%|███▉      | 386/971 [00:07<00:10, 56.96it/s]backtest loop:  40%|████      | 392/971 [00:07<00:10, 57.32it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 54.69it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 56.94it/s]backtest loop:  42%|████▏     | 411/971 [00:07<00:09, 57.76it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:09, 55.90it/s]backtest loop:  44%|████▎     | 424/971 [00:07<00:09, 56.60it/s]backtest loop:  44%|████▍     | 430/971 [00:08<00:09, 56.89it/s]backtest loop:  45%|████▍     | 436/971 [00:08<00:09, 57.50it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:09, 54.77it/s]backtest loop:  46%|████▌     | 448/971 [00:08<00:09, 55.83it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:09, 56.50it/s]backtest loop:  47%|████▋     | 460/971 [00:08<00:08, 57.18it/s]backtest loop:  48%|████▊     | 466/971 [00:08<00:08, 57.81it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:09, 54.91it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 57.29it/s]backtest loop:  50%|████▉     | 485/971 [00:09<00:08, 57.86it/s]backtest loop:  51%|█████     | 491/971 [00:09<00:08, 54.41it/s]backtest loop:  51%|█████     | 497/971 [00:09<00:08, 55.53it/s]backtest loop:  52%|█████▏    | 503/971 [00:09<00:08, 56.79it/s]backtest loop:  52%|█████▏    | 509/971 [00:09<00:08, 55.40it/s]backtest loop:  53%|█████▎    | 516/971 [00:09<00:07, 57.48it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:08, 54.31it/s]backtest loop:  54%|█████▍    | 529/971 [00:09<00:07, 56.43it/s]backtest loop:  55%|█████▌    | 535/971 [00:09<00:07, 56.40it/s]backtest loop:  56%|█████▌    | 541/971 [00:10<00:09, 44.93it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:09, 46.05it/s]backtest loop:  57%|█████▋    | 552/971 [00:10<00:08, 49.44it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 52.00it/s]backtest loop:  58%|█████▊    | 564/971 [00:10<00:07, 53.93it/s]backtest loop:  59%|█████▊    | 570/971 [00:10<00:07, 55.11it/s]backtest loop:  59%|█████▉    | 576/971 [00:10<00:07, 52.99it/s]backtest loop:  60%|█████▉    | 582/971 [00:10<00:07, 54.77it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:06, 55.99it/s]backtest loop:  61%|██████    | 594/971 [00:11<00:06, 57.06it/s]backtest loop:  62%|██████▏   | 600/971 [00:11<00:06, 54.02it/s]backtest loop:  62%|██████▏   | 606/971 [00:11<00:06, 55.54it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 56.66it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:06, 58.33it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 55.43it/s]backtest loop:  65%|██████▍   | 631/971 [00:11<00:05, 56.67it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:05, 56.34it/s]backtest loop:  66%|██████▌   | 643/971 [00:11<00:05, 57.15it/s]backtest loop:  67%|██████▋   | 649/971 [00:12<00:05, 57.70it/s]backtest loop:  67%|██████▋   | 655/971 [00:12<00:05, 54.87it/s]backtest loop:  68%|██████▊   | 661/971 [00:12<00:05, 55.79it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 52.22it/s]backtest loop:  69%|██████▉   | 673/971 [00:12<00:05, 54.20it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 52.25it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 54.06it/s]backtest loop:  71%|███████   | 691/971 [00:12<00:05, 55.69it/s]backtest loop:  72%|███████▏  | 697/971 [00:12<00:04, 56.43it/s]backtest loop:  73%|███████▎  | 704/971 [00:13<00:04, 54.93it/s]backtest loop:  73%|███████▎  | 710/971 [00:13<00:04, 56.25it/s]backtest loop:  74%|███████▎  | 716/971 [00:13<00:04, 57.03it/s]backtest loop:  74%|███████▍  | 722/971 [00:13<00:04, 57.82it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 58.13it/s]backtest loop:  76%|███████▌  | 734/971 [00:13<00:04, 51.71it/s]backtest loop:  76%|███████▌  | 740/971 [00:13<00:04, 53.80it/s]backtest loop:  77%|███████▋  | 746/971 [00:13<00:04, 55.45it/s]backtest loop:  77%|███████▋  | 752/971 [00:13<00:04, 53.31it/s]backtest loop:  78%|███████▊  | 759/971 [00:14<00:03, 55.83it/s]backtest loop:  79%|███████▉  | 765/971 [00:14<00:03, 54.12it/s]backtest loop:  80%|███████▉  | 772/971 [00:14<00:03, 57.46it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 59.08it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 55.99it/s]backtest loop:  82%|████████▏ | 792/971 [00:14<00:03, 57.80it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 54.91it/s]backtest loop:  83%|████████▎ | 804/971 [00:14<00:02, 56.16it/s]backtest loop:  83%|████████▎ | 810/971 [00:14<00:02, 56.77it/s]backtest loop:  84%|████████▍ | 816/971 [00:15<00:02, 57.58it/s]backtest loop:  85%|████████▍ | 822/971 [00:15<00:02, 58.22it/s]backtest loop:  85%|████████▌ | 828/971 [00:15<00:02, 54.87it/s]backtest loop:  86%|████████▌ | 834/971 [00:15<00:02, 56.18it/s]backtest loop:  87%|████████▋ | 840/971 [00:15<00:02, 57.20it/s]backtest loop:  87%|████████▋ | 846/971 [00:15<00:02, 57.80it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 54.50it/s]backtest loop:  88%|████████▊ | 858/971 [00:15<00:02, 55.48it/s]backtest loop:  89%|████████▉ | 864/971 [00:15<00:01, 56.03it/s]backtest loop:  90%|████████▉ | 870/971 [00:15<00:01, 56.76it/s]backtest loop:  90%|█████████ | 876/971 [00:16<00:01, 57.36it/s]backtest loop:  91%|█████████ | 882/971 [00:16<00:01, 54.42it/s]backtest loop:  91%|█████████▏| 888/971 [00:16<00:01, 55.73it/s]backtest loop:  92%|█████████▏| 894/971 [00:16<00:01, 56.43it/s]backtest loop:  93%|█████████▎| 900/971 [00:16<00:01, 57.15it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 57.84it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 55.07it/s]backtest loop:  95%|█████████▍| 918/971 [00:16<00:00, 56.23it/s]backtest loop:  95%|█████████▌| 924/971 [00:16<00:00, 56.55it/s]backtest loop:  96%|█████████▌| 930/971 [00:17<00:00, 57.19it/s]backtest loop:  96%|█████████▋| 936/971 [00:17<00:00, 54.32it/s]backtest loop:  97%|█████████▋| 942/971 [00:17<00:00, 55.23it/s]backtest loop:  98%|█████████▊| 948/971 [00:17<00:00, 56.35it/s]backtest loop:  98%|█████████▊| 954/971 [00:17<00:00, 57.04it/s]backtest loop:  99%|█████████▉| 960/971 [00:17<00:00, 53.88it/s]backtest loop: 100%|█████████▉| 967/971 [00:17<00:00, 56.29it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.56it/s]
[3047527:MainThread](2024-04-25 06:09:53,423) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000361
std                0.005830
annualized_return  0.086020
information_ratio  0.956486
max_drawdown      -0.119000
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000169
std                0.005829
annualized_return  0.040229
information_ratio  0.447343
max_drawdown      -0.173098
[3047527:MainThread](2024-04-25 06:09:53,441) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_Transformer_alpha360_horizon1_step20_rankFalse_2024-04-25_03:13:01_online`.
Round 8 Done!
{'1day.excess_return_with_cost.annualized_return': [0.043797486231573146,
                                                    0.0634228370113721,
                                                    0.032834642441840194,
                                                    0.09269971081251317,
                                                    0.0657184256393298,
                                                    0.02793087131617893,
                                                    0.08634293469479305,
                                                    0.040229393306477026],
 '1day.excess_return_with_cost.information_ratio': [0.5649832165888312,
                                                    0.7857064560613483,
                                                    0.42725276418160857,
                                                    1.2498966992194853,
                                                    0.8434476777972351,
                                                    0.3439149144228769,
                                                    1.0947603545987385,
                                                    0.4473426123644782],
 '1day.excess_return_with_cost.max_drawdown': [-0.09264196275626242,
                                               -0.11042126565462691,
                                               -0.12438813489577007,
                                               -0.0910373026769272,
                                               -0.14795385465041527,
                                               -0.17598279790117916,
                                               -0.12229648137858812,
                                               -0.17309814005010368],
 'IC': [0.02338127556803707,
        0.023874553769198607,
        0.021049908565493873,
        0.022668472335526615,
        0.023429347755308673,
        0.02417324596657715,
        0.025525801842171507,
        0.02442065458106158],
 'ICIR': [0.20238622048809674,
          0.18560857194822403,
          0.1806449258518542,
          0.20035905213919242,
          0.2010511035996123,
          0.1958382849156171,
          0.21886157065984174,
          0.19322319881052735],
 'Rank IC': [0.013917040518004948,
             0.012129057369372705,
             0.014330230707453042,
             0.018533569798826154,
             0.008485277600671977,
             0.015422447514420396,
             0.01590147842680528,
             0.01134180877794962],
 'Rank ICIR': [0.12551679322509657,
               0.09548055549514188,
               0.12272525155573737,
               0.1641887623113997,
               0.07311631025877363,
               0.12574576750378694,
               0.14020606031217148,
               0.09108542235925256],
 'mae': [0.685724139213562,
         0.685746431350708,
         0.6857940554618835,
         0.6857808232307434,
         0.6859009265899658,
         0.6857696771621704,
         0.6857050061225891,
         0.6857242584228516],
 'mse': [0.9972350597381592,
         0.9971662163734436,
         0.997454822063446,
         0.9973787665367126,
         0.9972341656684875,
         0.9972487092018127,
         0.9970695972442627,
         0.9971585869789124]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3047527:MainThread](2024-04-25 06:09:54,761) INFO - qlib.TransformerModel - [pytorch_transformer.py:66] - Naive Transformer:
batch_size : 2048
dim : 32
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:27<45:52, 27.81s/it]epoch:   2%|▏         | 2/100 [00:55<45:03, 27.59s/it]epoch:   3%|▎         | 3/100 [01:22<44:14, 27.37s/it]epoch:   4%|▍         | 4/100 [01:50<44:08, 27.58s/it]epoch:   5%|▌         | 5/100 [02:17<43:30, 27.47s/it]epoch:   6%|▌         | 6/100 [02:45<43:02, 27.48s/it]epoch:   7%|▋         | 7/100 [03:12<42:26, 27.38s/it]epoch:   8%|▊         | 8/100 [03:39<42:06, 27.46s/it]epoch:   9%|▉         | 9/100 [04:06<41:27, 27.33s/it]epoch:  10%|█         | 10/100 [04:34<41:11, 27.46s/it]epoch:  11%|█         | 11/100 [05:01<40:38, 27.40s/it]epoch:  12%|█▏        | 12/100 [05:29<40:16, 27.46s/it]epoch:  13%|█▎        | 13/100 [05:56<39:37, 27.32s/it]epoch:  14%|█▍        | 14/100 [06:24<39:19, 27.43s/it]epoch:  15%|█▌        | 15/100 [06:51<38:47, 27.38s/it]epoch:  16%|█▌        | 16/100 [07:19<38:25, 27.45s/it]epoch:  17%|█▋        | 17/100 [07:46<37:49, 27.34s/it]epoch:  18%|█▊        | 18/100 [08:13<37:33, 27.48s/it]epoch:  19%|█▉        | 19/100 [08:41<37:11, 27.55s/it]epoch:  20%|██        | 20/100 [09:09<36:50, 27.63s/it]0.03517048574436784
best ic: 0.03517048574436784
epoch:  21%|██        | 21/100 [09:39<37:28, 28.47s/it]0.029240291595168274
epoch:  22%|██▏       | 22/100 [10:12<38:26, 29.57s/it]0.028657479772151842
epoch:  23%|██▎       | 23/100 [10:43<38:50, 30.27s/it]0.03342757023688764
epoch:  24%|██▍       | 24/100 [11:14<38:37, 30.50s/it]0.03095446821884498
epoch:  25%|██▌       | 25/100 [11:45<38:07, 30.50s/it]0.03453001378854928
epoch:  26%|██▌       | 26/100 [12:16<37:50, 30.68s/it]0.03644023887718442
best ic: 0.03644023887718442
epoch:  27%|██▋       | 27/100 [12:46<37:12, 30.59s/it]0.03412358961288145
epoch:  28%|██▊       | 28/100 [13:17<36:52, 30.72s/it]0.04137425462902338
best ic: 0.04137425462902338
epoch:  29%|██▉       | 29/100 [13:48<36:15, 30.64s/it]0.03932168487383645
epoch:  30%|███       | 30/100 [14:19<35:53, 30.76s/it]0.039081705685501573
epoch:  31%|███       | 31/100 [14:50<35:19, 30.72s/it]0.03905733852187212
epoch:  32%|███▏      | 32/100 [15:21<34:54, 30.81s/it]0.044259594112247246
best ic: 0.044259594112247246
epoch:  33%|███▎      | 33/100 [15:51<34:18, 30.72s/it]0.04010727237308044
epoch:  34%|███▍      | 34/100 [16:22<33:56, 30.86s/it]0.042582274629483725
epoch:  35%|███▌      | 35/100 [16:53<33:20, 30.77s/it]0.04259145362948532
epoch:  36%|███▌      | 36/100 [17:24<32:51, 30.81s/it]0.037492497005602414
epoch:  37%|███▋      | 37/100 [17:55<32:21, 30.82s/it]0.04050718819197454
epoch:  38%|███▊      | 38/100 [18:25<31:48, 30.78s/it]0.037981882602820045
epoch:  39%|███▉      | 39/100 [18:56<31:18, 30.79s/it]0.03630044114700294
epoch:  40%|████      | 40/100 [19:27<30:49, 30.82s/it]0.038275607105075514
epoch:  40%|████      | 40/100 [19:58<29:57, 29.96s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3047527:MainThread](2024-04-25 06:29:53,257) INFO - qlib.workflow - [exp.py:258] - Experiment 49 starts running ...
[3047527:MainThread](2024-04-25 06:29:53,275) INFO - qlib.workflow - [recorder.py:341] - Recorder 5e6fbda3683c49eabe31191f12c14331 starts running under Experiment 49 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:11,  5.61it/s]online:   3%|▎         | 2/63 [00:00<00:12,  4.91it/s]online:   5%|▍         | 3/63 [00:00<00:12,  4.77it/s]online:   6%|▋         | 4/63 [00:00<00:12,  4.70it/s]online:   8%|▊         | 5/63 [00:01<00:12,  4.61it/s]online:  10%|▉         | 6/63 [00:01<00:12,  4.59it/s]online:  11%|█         | 7/63 [00:01<00:12,  4.58it/s]online:  13%|█▎        | 8/63 [00:01<00:11,  4.59it/s]online:  14%|█▍        | 9/63 [00:01<00:11,  4.60it/s]online:  16%|█▌        | 10/63 [00:02<00:11,  4.53it/s]online:  17%|█▋        | 11/63 [00:02<00:11,  4.52it/s]online:  19%|█▉        | 12/63 [00:02<00:11,  4.57it/s]online:  21%|██        | 13/63 [00:02<00:10,  4.57it/s]online:  22%|██▏       | 14/63 [00:03<00:10,  4.56it/s]online:  24%|██▍       | 15/63 [00:03<00:10,  4.54it/s]online:  25%|██▌       | 16/63 [00:03<00:10,  4.54it/s]online:  27%|██▋       | 17/63 [00:03<00:10,  4.57it/s]online:  29%|██▊       | 18/63 [00:03<00:09,  4.56it/s]online:  30%|███       | 19/63 [00:04<00:09,  4.55it/s]online:  32%|███▏      | 20/63 [00:04<00:09,  4.57it/s]online:  33%|███▎      | 21/63 [00:04<00:09,  4.52it/s]online:  35%|███▍      | 22/63 [00:04<00:09,  4.53it/s]online:  37%|███▋      | 23/63 [00:05<00:08,  4.54it/s]online:  38%|███▊      | 24/63 [00:05<00:08,  4.56it/s]online:  40%|███▉      | 25/63 [00:05<00:08,  4.55it/s]online:  41%|████▏     | 26/63 [00:05<00:08,  4.57it/s]online:  43%|████▎     | 27/63 [00:05<00:07,  4.57it/s]online:  44%|████▍     | 28/63 [00:06<00:07,  4.53it/s]online:  46%|████▌     | 29/63 [00:06<00:07,  4.54it/s]online:  48%|████▊     | 30/63 [00:06<00:07,  4.54it/s]online:  49%|████▉     | 31/63 [00:06<00:07,  4.55it/s]online:  51%|█████     | 32/63 [00:06<00:06,  4.55it/s]online:  52%|█████▏    | 33/63 [00:07<00:06,  4.56it/s]online:  54%|█████▍    | 34/63 [00:07<00:06,  4.60it/s]online:  56%|█████▌    | 35/63 [00:07<00:06,  4.55it/s]online:  57%|█████▋    | 36/63 [00:07<00:05,  4.55it/s]online:  59%|█████▊    | 37/63 [00:08<00:05,  4.58it/s]online:  60%|██████    | 38/63 [00:08<00:05,  4.56it/s]online:  62%|██████▏   | 39/63 [00:08<00:05,  4.57it/s]online:  63%|██████▎   | 40/63 [00:08<00:05,  4.55it/s]online:  65%|██████▌   | 41/63 [00:08<00:04,  4.55it/s]online:  67%|██████▋   | 42/63 [00:09<00:04,  4.54it/s]online:  68%|██████▊   | 43/63 [00:09<00:04,  4.55it/s]online:  70%|██████▉   | 44/63 [00:09<00:04,  4.63it/s]online:  71%|███████▏  | 45/63 [00:09<00:03,  4.62it/s]online:  73%|███████▎  | 46/63 [00:10<00:03,  4.60it/s]online:  75%|███████▍  | 47/63 [00:10<00:03,  4.61it/s]online:  76%|███████▌  | 48/63 [00:10<00:03,  4.60it/s]online:  78%|███████▊  | 49/63 [00:10<00:03,  4.60it/s]online:  79%|███████▉  | 50/63 [00:10<00:02,  4.59it/s]online:  81%|████████  | 51/63 [00:11<00:02,  4.56it/s]online:  83%|████████▎ | 52/63 [00:11<00:02,  4.52it/s]online:  84%|████████▍ | 53/63 [00:11<00:02,  4.52it/s]online:  86%|████████▌ | 54/63 [00:11<00:01,  4.59it/s]online:  87%|████████▋ | 55/63 [00:12<00:01,  4.57it/s]online:  89%|████████▉ | 56/63 [00:12<00:01,  4.56it/s]online:  90%|█████████ | 57/63 [00:12<00:01,  4.55it/s]online:  92%|█████████▏| 58/63 [00:12<00:01,  4.56it/s]online:  94%|█████████▎| 59/63 [00:12<00:00,  4.58it/s]online:  95%|█████████▌| 60/63 [00:13<00:00,  4.56it/s]online:  97%|█████████▋| 61/63 [00:13<00:00,  4.57it/s]online:  98%|█████████▊| 62/63 [00:13<00:00,  4.60it/s]online: 100%|██████████| 63/63 [00:13<00:00,  4.74it/s]online: 100%|██████████| 63/63 [00:13<00:00,  4.58it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.001
[3047527:MainThread](2024-04-25 06:30:20,882) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9971658 mae 0.6857452
{'IC': 0.024561987528414465,
 'ICIR': 0.21403082395565073,
 'Rank IC': 0.013096018233392523,
 'Rank ICIR': 0.11257218176401919}
[3047527:MainThread](2024-04-25 06:30:22,764) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3047527:MainThread](2024-04-25 06:30:37,886) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 06:30:37,890) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 06:30:44,018) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f6e2208cd00>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:45,  9.21it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.45it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 36.97it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 39.01it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 44.36it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:22, 41.27it/s]backtest loop:   4%|▍         | 38/971 [00:01<00:21, 42.49it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:20, 44.75it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 49.77it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 49.48it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 52.02it/s]backtest loop:   7%|▋         | 70/971 [00:01<00:16, 55.24it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:16, 54.50it/s]backtest loop:   9%|▊         | 83/971 [00:01<00:15, 55.94it/s]backtest loop:   9%|▉         | 90/971 [00:01<00:15, 58.08it/s]backtest loop:  10%|▉         | 97/971 [00:02<00:15, 55.87it/s]backtest loop:  11%|█         | 103/971 [00:02<00:15, 56.60it/s]backtest loop:  11%|█         | 109/971 [00:02<00:15, 57.02it/s]backtest loop:  12%|█▏        | 115/971 [00:02<00:15, 55.97it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:15, 55.79it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:16, 51.07it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:15, 54.42it/s]backtest loop:  14%|█▍        | 140/971 [00:02<00:14, 55.71it/s]backtest loop:  15%|█▌        | 146/971 [00:03<00:16, 48.82it/s]backtest loop:  16%|█▌        | 152/971 [00:03<00:15, 51.36it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:14, 54.38it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:14, 55.57it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:14, 53.40it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:14, 54.93it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 55.82it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:14, 54.72it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 56.96it/s]backtest loop:  21%|██        | 203/971 [00:04<00:13, 57.76it/s]backtest loop:  22%|██▏       | 210/971 [00:04<00:13, 55.80it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:14, 53.64it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:13, 56.19it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:13, 57.03it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:13, 54.59it/s]backtest loop:  25%|██▍       | 241/971 [00:04<00:13, 55.91it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:12, 56.87it/s]backtest loop:  26%|██▌       | 253/971 [00:04<00:12, 57.35it/s]backtest loop:  27%|██▋       | 259/971 [00:05<00:13, 54.71it/s]backtest loop:  27%|██▋       | 266/971 [00:05<00:13, 53.92it/s]backtest loop:  28%|██▊       | 272/971 [00:05<00:12, 55.23it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:12, 55.62it/s]backtest loop:  29%|██▉       | 284/971 [00:05<00:12, 56.63it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 54.98it/s]backtest loop:  31%|███       | 297/971 [00:05<00:12, 55.95it/s]backtest loop:  31%|███       | 303/971 [00:05<00:11, 56.98it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 57.45it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:11, 54.71it/s]backtest loop:  33%|███▎      | 322/971 [00:06<00:11, 57.22it/s]backtest loop:  34%|███▍      | 329/971 [00:06<00:10, 59.00it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:11, 55.99it/s]backtest loop:  35%|███▌      | 341/971 [00:06<00:11, 56.87it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:10, 57.45it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:10, 58.96it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 56.09it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.13it/s]backtest loop:  38%|███▊      | 373/971 [00:07<00:11, 53.63it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:10, 56.15it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 58.03it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 54.80it/s]backtest loop:  41%|████      | 399/971 [00:07<00:10, 55.82it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 56.68it/s]backtest loop:  42%|████▏     | 411/971 [00:07<00:09, 57.32it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 57.89it/s]backtest loop:  44%|████▎     | 423/971 [00:07<00:10, 54.74it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:09, 56.10it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:09, 57.14it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 57.89it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 54.92it/s]backtest loop:  47%|████▋     | 453/971 [00:08<00:09, 56.19it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:09, 56.88it/s]backtest loop:  48%|████▊     | 465/971 [00:08<00:08, 57.62it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:08, 55.62it/s]backtest loop:  49%|████▉     | 478/971 [00:08<00:08, 56.79it/s]backtest loop:  50%|████▉     | 484/971 [00:09<00:08, 57.05it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:08, 54.17it/s]backtest loop:  51%|█████     | 496/971 [00:09<00:08, 55.67it/s]backtest loop:  52%|█████▏    | 503/971 [00:09<00:08, 57.83it/s]backtest loop:  52%|█████▏    | 509/971 [00:09<00:08, 54.63it/s]backtest loop:  53%|█████▎    | 515/971 [00:09<00:08, 55.75it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 56.63it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:08, 53.87it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:07, 55.30it/s]backtest loop:  56%|█████▌    | 539/971 [00:10<00:07, 56.57it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 55.25it/s]backtest loop:  57%|█████▋    | 552/971 [00:10<00:07, 56.53it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 57.09it/s]backtest loop:  58%|█████▊    | 565/971 [00:10<00:06, 59.02it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 56.02it/s]backtest loop:  59%|█████▉    | 577/971 [00:10<00:06, 57.06it/s]backtest loop:  60%|██████    | 583/971 [00:10<00:06, 57.73it/s]backtest loop:  61%|██████    | 589/971 [00:10<00:06, 57.72it/s]backtest loop:  61%|██████▏   | 595/971 [00:10<00:06, 58.22it/s]backtest loop:  62%|██████▏   | 601/971 [00:11<00:06, 54.77it/s]backtest loop:  63%|██████▎   | 608/971 [00:11<00:06, 57.04it/s]backtest loop:  63%|██████▎   | 614/971 [00:11<00:06, 57.72it/s]backtest loop:  64%|██████▍   | 620/971 [00:11<00:06, 54.82it/s]backtest loop:  65%|██████▍   | 627/971 [00:11<00:06, 57.25it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:05, 58.81it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:05, 55.74it/s]backtest loop:  67%|██████▋   | 646/971 [00:11<00:05, 56.71it/s]backtest loop:  67%|██████▋   | 652/971 [00:11<00:05, 57.44it/s]backtest loop:  68%|██████▊   | 659/971 [00:12<00:05, 58.89it/s]backtest loop:  68%|██████▊   | 665/971 [00:12<00:05, 55.63it/s]backtest loop:  69%|██████▉   | 672/971 [00:12<00:05, 57.45it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 55.63it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 56.55it/s]backtest loop:  71%|███████   | 691/971 [00:12<00:04, 57.03it/s]backtest loop:  72%|███████▏  | 697/971 [00:12<00:04, 57.83it/s]backtest loop:  73%|███████▎  | 704/971 [00:12<00:04, 55.96it/s]backtest loop:  73%|███████▎  | 710/971 [00:13<00:04, 57.03it/s]backtest loop:  74%|███████▍  | 717/971 [00:13<00:04, 58.69it/s]backtest loop:  75%|███████▍  | 724/971 [00:13<00:04, 56.49it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 55.25it/s]backtest loop:  76%|███████▌  | 737/971 [00:13<00:04, 56.36it/s]backtest loop:  77%|███████▋  | 743/971 [00:13<00:04, 54.04it/s]backtest loop:  77%|███████▋  | 749/971 [00:13<00:03, 55.54it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 53.71it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 56.43it/s]backtest loop:  79%|███████▉  | 768/971 [00:14<00:03, 57.28it/s]backtest loop:  80%|███████▉  | 774/971 [00:14<00:03, 57.68it/s]backtest loop:  80%|████████  | 780/971 [00:14<00:03, 54.74it/s]backtest loop:  81%|████████  | 787/971 [00:14<00:03, 57.37it/s]backtest loop:  82%|████████▏ | 793/971 [00:14<00:03, 54.85it/s]backtest loop:  82%|████████▏ | 800/971 [00:14<00:02, 57.16it/s]backtest loop:  83%|████████▎ | 806/971 [00:14<00:02, 57.72it/s]backtest loop:  84%|████████▎ | 812/971 [00:14<00:02, 58.13it/s]backtest loop:  84%|████████▍ | 818/971 [00:14<00:02, 55.11it/s]backtest loop:  85%|████████▍ | 824/971 [00:15<00:02, 56.04it/s]backtest loop:  86%|████████▌ | 831/971 [00:15<00:02, 57.90it/s]backtest loop:  86%|████████▋ | 838/971 [00:15<00:02, 55.93it/s]backtest loop:  87%|████████▋ | 844/971 [00:15<00:02, 57.01it/s]backtest loop:  88%|████████▊ | 850/971 [00:15<00:02, 57.82it/s]backtest loop:  88%|████████▊ | 856/971 [00:15<00:01, 58.20it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 55.21it/s]backtest loop:  89%|████████▉ | 868/971 [00:15<00:01, 56.42it/s]backtest loop:  90%|█████████ | 874/971 [00:15<00:01, 56.91it/s]backtest loop:  91%|█████████ | 880/971 [00:16<00:01, 57.57it/s]backtest loop:  91%|█████████ | 886/971 [00:16<00:01, 57.91it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 54.70it/s]backtest loop:  92%|█████████▏| 898/971 [00:16<00:01, 56.11it/s]backtest loop:  93%|█████████▎| 904/971 [00:16<00:01, 57.05it/s]backtest loop:  94%|█████████▍| 911/971 [00:16<00:01, 58.74it/s]backtest loop:  94%|█████████▍| 917/971 [00:16<00:00, 55.41it/s]backtest loop:  95%|█████████▌| 923/971 [00:16<00:00, 56.60it/s]backtest loop:  96%|█████████▌| 930/971 [00:16<00:00, 58.43it/s]backtest loop:  96%|█████████▋| 936/971 [00:17<00:00, 55.56it/s]backtest loop:  97%|█████████▋| 943/971 [00:17<00:00, 57.47it/s]backtest loop:  98%|█████████▊| 949/971 [00:17<00:00, 58.12it/s]backtest loop:  98%|█████████▊| 955/971 [00:17<00:00, 55.14it/s]backtest loop:  99%|█████████▉| 961/971 [00:17<00:00, 56.47it/s]backtest loop: 100%|█████████▉| 967/971 [00:17<00:00, 57.17it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.09it/s]
[3047527:MainThread](2024-04-25 06:31:01,720) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000345
std                0.005016
annualized_return  0.082006
information_ratio  1.059833
max_drawdown      -0.091303
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000152
std                0.005016
annualized_return  0.036153
information_ratio  0.467157
max_drawdown      -0.106572
[3047527:MainThread](2024-04-25 06:31:01,738) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_Transformer_alpha360_horizon1_step20_rankFalse_2024-04-25_03:13:01_online`.
Round 9 Done!
{'1day.excess_return_with_cost.annualized_return': [0.043797486231573146,
                                                    0.0634228370113721,
                                                    0.032834642441840194,
                                                    0.09269971081251317,
                                                    0.0657184256393298,
                                                    0.02793087131617893,
                                                    0.08634293469479305,
                                                    0.040229393306477026,
                                                    0.0361528321661684],
 '1day.excess_return_with_cost.information_ratio': [0.5649832165888312,
                                                    0.7857064560613483,
                                                    0.42725276418160857,
                                                    1.2498966992194853,
                                                    0.8434476777972351,
                                                    0.3439149144228769,
                                                    1.0947603545987385,
                                                    0.4473426123644782,
                                                    0.4671567144133433],
 '1day.excess_return_with_cost.max_drawdown': [-0.09264196275626242,
                                               -0.11042126565462691,
                                               -0.12438813489577007,
                                               -0.0910373026769272,
                                               -0.14795385465041527,
                                               -0.17598279790117916,
                                               -0.12229648137858812,
                                               -0.17309814005010368,
                                               -0.10657211677674233],
 'IC': [0.02338127556803707,
        0.023874553769198607,
        0.021049908565493873,
        0.022668472335526615,
        0.023429347755308673,
        0.02417324596657715,
        0.025525801842171507,
        0.02442065458106158,
        0.024561987528414465],
 'ICIR': [0.20238622048809674,
          0.18560857194822403,
          0.1806449258518542,
          0.20035905213919242,
          0.2010511035996123,
          0.1958382849156171,
          0.21886157065984174,
          0.19322319881052735,
          0.21403082395565073],
 'Rank IC': [0.013917040518004948,
             0.012129057369372705,
             0.014330230707453042,
             0.018533569798826154,
             0.008485277600671977,
             0.015422447514420396,
             0.01590147842680528,
             0.01134180877794962,
             0.013096018233392523],
 'Rank ICIR': [0.12551679322509657,
               0.09548055549514188,
               0.12272525155573737,
               0.1641887623113997,
               0.07311631025877363,
               0.12574576750378694,
               0.14020606031217148,
               0.09108542235925256,
               0.11257218176401919],
 'mae': [0.685724139213562,
         0.685746431350708,
         0.6857940554618835,
         0.6857808232307434,
         0.6859009265899658,
         0.6857696771621704,
         0.6857050061225891,
         0.6857242584228516,
         0.6857451796531677],
 'mse': [0.9972350597381592,
         0.9971662163734436,
         0.997454822063446,
         0.9973787665367126,
         0.9972341656684875,
         0.9972487092018127,
         0.9970695972442627,
         0.9971585869789124,
         0.9971657991409302]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3047527:MainThread](2024-04-25 06:31:03,058) INFO - qlib.TransformerModel - [pytorch_transformer.py:66] - Naive Transformer:
batch_size : 2048
dim : 32
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:27<45:45, 27.73s/it]epoch:   2%|▏         | 2/100 [00:55<45:07, 27.63s/it]epoch:   3%|▎         | 3/100 [01:22<44:29, 27.52s/it]epoch:   4%|▍         | 4/100 [01:50<44:05, 27.56s/it]epoch:   5%|▌         | 5/100 [02:17<43:21, 27.38s/it]epoch:   6%|▌         | 6/100 [02:45<43:07, 27.53s/it]epoch:   7%|▋         | 7/100 [03:12<42:30, 27.42s/it]epoch:   8%|▊         | 8/100 [03:39<42:06, 27.46s/it]epoch:   9%|▉         | 9/100 [04:07<41:29, 27.36s/it]epoch:  10%|█         | 10/100 [04:34<41:11, 27.46s/it]epoch:  11%|█         | 11/100 [05:01<40:34, 27.36s/it]epoch:  12%|█▏        | 12/100 [05:30<40:49, 27.84s/it]epoch:  13%|█▎        | 13/100 [05:58<40:08, 27.68s/it]epoch:  14%|█▍        | 14/100 [06:25<39:39, 27.67s/it]epoch:  15%|█▌        | 15/100 [06:52<38:56, 27.49s/it]epoch:  16%|█▌        | 16/100 [07:20<38:32, 27.53s/it]epoch:  17%|█▋        | 17/100 [07:47<38:00, 27.48s/it]epoch:  18%|█▊        | 18/100 [08:15<37:34, 27.49s/it]epoch:  19%|█▉        | 19/100 [08:42<36:58, 27.39s/it]epoch:  20%|██        | 20/100 [09:10<36:40, 27.51s/it]0.045090642145373984
best ic: 0.045090642145373984
epoch:  21%|██        | 21/100 [09:40<37:27, 28.45s/it]0.040685805546469084
epoch:  22%|██▏       | 22/100 [10:12<38:00, 29.24s/it]0.045645099006948395
best ic: 0.045645099006948395
epoch:  23%|██▎       | 23/100 [10:42<38:04, 29.67s/it]0.041518123812105956
epoch:  24%|██▍       | 24/100 [11:13<38:09, 30.12s/it]0.045193255091667585
epoch:  25%|██▌       | 25/100 [11:45<38:05, 30.47s/it]0.03772521165400596
epoch:  26%|██▌       | 26/100 [12:16<37:57, 30.78s/it]0.040390367186058006
epoch:  27%|██▋       | 27/100 [12:47<37:33, 30.87s/it]0.03705056985563633
epoch:  28%|██▊       | 28/100 [13:18<36:52, 30.73s/it]0.04217888540475418
epoch:  29%|██▉       | 29/100 [13:49<36:34, 30.91s/it]0.04169326365929226
epoch:  30%|███       | 30/100 [14:19<35:54, 30.77s/it]0.04141230823415713
epoch:  30%|███       | 30/100 [14:50<34:38, 29.70s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3047527:MainThread](2024-04-25 06:45:54,104) INFO - qlib.workflow - [exp.py:258] - Experiment 49 starts running ...
[3047527:MainThread](2024-04-25 06:45:54,122) INFO - qlib.workflow - [recorder.py:341] - Recorder 5094183765d54e18806e1982c658b36d starts running under Experiment 49 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:11,  5.37it/s]online:   3%|▎         | 2/63 [00:00<00:12,  4.86it/s]online:   5%|▍         | 3/63 [00:00<00:12,  4.77it/s]online:   6%|▋         | 4/63 [00:00<00:12,  4.66it/s]online:   8%|▊         | 5/63 [00:01<00:12,  4.65it/s]online:  10%|▉         | 6/63 [00:01<00:12,  4.60it/s]online:  11%|█         | 7/63 [00:01<00:12,  4.62it/s]online:  13%|█▎        | 8/63 [00:01<00:12,  4.58it/s]online:  14%|█▍        | 9/63 [00:01<00:11,  4.57it/s]online:  16%|█▌        | 10/63 [00:02<00:11,  4.54it/s]online:  17%|█▋        | 11/63 [00:02<00:11,  4.56it/s]online:  19%|█▉        | 12/63 [00:02<00:11,  4.57it/s]online:  21%|██        | 13/63 [00:02<00:10,  4.59it/s]online:  22%|██▏       | 14/63 [00:03<00:10,  4.55it/s]online:  24%|██▍       | 15/63 [00:03<00:10,  4.54it/s]online:  25%|██▌       | 16/63 [00:03<00:10,  4.54it/s]online:  27%|██▋       | 17/63 [00:03<00:10,  4.55it/s]online:  29%|██▊       | 18/63 [00:03<00:09,  4.51it/s]online:  30%|███       | 19/63 [00:04<00:09,  4.53it/s]online:  32%|███▏      | 20/63 [00:04<00:09,  4.57it/s]online:  33%|███▎      | 21/63 [00:04<00:09,  4.62it/s]online:  35%|███▍      | 22/63 [00:04<00:08,  4.58it/s]online:  37%|███▋      | 23/63 [00:05<00:08,  4.56it/s]online:  38%|███▊      | 24/63 [00:05<00:08,  4.57it/s]online:  40%|███▉      | 25/63 [00:05<00:08,  4.56it/s]online:  41%|████▏     | 26/63 [00:05<00:08,  4.54it/s]online:  43%|████▎     | 27/63 [00:05<00:07,  4.54it/s]online:  44%|████▍     | 28/63 [00:06<00:07,  4.56it/s]online:  46%|████▌     | 29/63 [00:06<00:07,  4.58it/s]online:  48%|████▊     | 30/63 [00:06<00:07,  4.60it/s]online:  49%|████▉     | 31/63 [00:06<00:07,  4.55it/s]online:  51%|█████     | 32/63 [00:06<00:06,  4.59it/s]online:  52%|█████▏    | 33/63 [00:07<00:06,  4.52it/s]online:  54%|█████▍    | 34/63 [00:07<00:06,  4.48it/s]online:  56%|█████▌    | 35/63 [00:07<00:06,  4.46it/s]online:  57%|█████▋    | 36/63 [00:07<00:06,  4.46it/s]online:  59%|█████▊    | 37/63 [00:08<00:05,  4.52it/s]online:  60%|██████    | 38/63 [00:08<00:05,  4.52it/s]online:  62%|██████▏   | 39/63 [00:08<00:05,  4.53it/s]online:  63%|██████▎   | 40/63 [00:08<00:05,  4.51it/s]online:  65%|██████▌   | 41/63 [00:08<00:04,  4.51it/s]online:  67%|██████▋   | 42/63 [00:09<00:04,  4.58it/s]online:  68%|██████▊   | 43/63 [00:09<00:04,  4.57it/s]online:  70%|██████▉   | 44/63 [00:09<00:04,  4.58it/s]online:  71%|███████▏  | 45/63 [00:09<00:03,  4.59it/s]online:  73%|███████▎  | 46/63 [00:10<00:03,  4.59it/s]online:  75%|███████▍  | 47/63 [00:10<00:03,  4.59it/s]online:  76%|███████▌  | 48/63 [00:10<00:03,  4.56it/s]online:  78%|███████▊  | 49/63 [00:10<00:03,  4.54it/s]online:  79%|███████▉  | 50/63 [00:10<00:02,  4.56it/s]online:  81%|████████  | 51/63 [00:11<00:02,  4.55it/s]online:  83%|████████▎ | 52/63 [00:11<00:02,  4.58it/s]online:  84%|████████▍ | 53/63 [00:11<00:02,  4.59it/s]online:  86%|████████▌ | 54/63 [00:11<00:01,  4.55it/s]online:  87%|████████▋ | 55/63 [00:12<00:01,  4.62it/s]online:  89%|████████▉ | 56/63 [00:12<00:01,  4.61it/s]online:  90%|█████████ | 57/63 [00:12<00:01,  4.61it/s]online:  92%|█████████▏| 58/63 [00:12<00:01,  4.61it/s]online:  94%|█████████▎| 59/63 [00:12<00:00,  4.60it/s]online:  95%|█████████▌| 60/63 [00:13<00:00,  4.59it/s]online:  97%|█████████▋| 61/63 [00:13<00:00,  4.52it/s]online:  98%|█████████▊| 62/63 [00:13<00:00,  4.55it/s]online: 100%|██████████| 63/63 [00:13<00:00,  4.73it/s]online: 100%|██████████| 63/63 [00:13<00:00,  4.58it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.001
[3047527:MainThread](2024-04-25 06:46:23,607) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99740183 mae 0.6858993
{'IC': 0.02318432804937657,
 'ICIR': 0.20102413448089154,
 'Rank IC': 0.014543446664084516,
 'Rank ICIR': 0.12829315634025396}
[3047527:MainThread](2024-04-25 06:46:25,493) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3047527:MainThread](2024-04-25 06:46:40,794) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 06:46:40,798) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3047527:MainThread](2024-04-25 06:46:46,910) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f6e249be250>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:49,  8.86it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 24.01it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:26, 36.37it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 39.28it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.18it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 48.73it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:19, 48.79it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:17, 51.88it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:17, 54.04it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 52.25it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:16, 53.97it/s]backtest loop:   7%|▋         | 70/971 [00:01<00:15, 56.80it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:16, 55.36it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 57.30it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 58.95it/s]backtest loop:  10%|▉         | 97/971 [00:02<00:15, 55.88it/s]backtest loop:  11%|█         | 103/971 [00:02<00:15, 56.74it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:14, 58.58it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:15, 56.42it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:14, 58.08it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:15, 54.84it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 53.54it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:14, 55.95it/s]backtest loop:  15%|█▌        | 150/971 [00:02<00:14, 58.07it/s]backtest loop:  16%|█▌        | 156/971 [00:03<00:14, 55.37it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:14, 57.58it/s]backtest loop:  17%|█▋        | 169/971 [00:03<00:13, 58.09it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 56.18it/s]backtest loop:  19%|█▊        | 182/971 [00:03<00:13, 56.87it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:13, 58.61it/s]backtest loop:  20%|██        | 195/971 [00:03<00:14, 54.81it/s]backtest loop:  21%|██        | 201/971 [00:03<00:13, 55.60it/s]backtest loop:  21%|██▏       | 207/971 [00:03<00:13, 56.66it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:13, 54.35it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:14, 53.51it/s]backtest loop:  23%|██▎       | 226/971 [00:04<00:13, 54.86it/s]backtest loop:  24%|██▍       | 233/971 [00:04<00:12, 57.10it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:13, 55.48it/s]backtest loop:  25%|██▌       | 246/971 [00:04<00:12, 56.65it/s]backtest loop:  26%|██▌       | 253/971 [00:04<00:12, 58.37it/s]backtest loop:  27%|██▋       | 259/971 [00:04<00:12, 55.27it/s]backtest loop:  27%|██▋       | 265/971 [00:04<00:12, 56.51it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:13, 53.18it/s]backtest loop:  29%|██▊       | 277/971 [00:05<00:15, 45.90it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:14, 48.65it/s]backtest loop:  30%|██▉       | 289/971 [00:05<00:13, 51.10it/s]backtest loop:  30%|███       | 295/971 [00:05<00:13, 50.56it/s]backtest loop:  31%|███       | 302/971 [00:05<00:12, 53.93it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 56.35it/s]backtest loop:  32%|███▏      | 315/971 [00:05<00:12, 54.43it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:11, 55.87it/s]backtest loop:  34%|███▍      | 328/971 [00:06<00:11, 57.70it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:11, 55.98it/s]backtest loop:  35%|███▌      | 341/971 [00:06<00:11, 56.53it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:10, 57.33it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:10, 58.84it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 56.78it/s]backtest loop:  38%|███▊      | 366/971 [00:06<00:11, 54.70it/s]backtest loop:  38%|███▊      | 372/971 [00:07<00:12, 46.15it/s]backtest loop:  39%|███▉      | 378/971 [00:07<00:12, 46.78it/s]backtest loop:  40%|███▉      | 384/971 [00:07<00:11, 49.92it/s]backtest loop:  40%|████      | 390/971 [00:07<00:11, 52.52it/s]backtest loop:  41%|████      | 396/971 [00:07<00:10, 54.26it/s]backtest loop:  41%|████▏     | 402/971 [00:07<00:10, 55.75it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:10, 53.61it/s]backtest loop:  43%|████▎     | 415/971 [00:07<00:09, 56.49it/s]backtest loop:  43%|████▎     | 422/971 [00:07<00:09, 58.28it/s]backtest loop:  44%|████▍     | 428/971 [00:08<00:09, 55.42it/s]backtest loop:  45%|████▍     | 434/971 [00:08<00:09, 56.35it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:09, 57.23it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:09, 57.93it/s]backtest loop:  47%|████▋     | 452/971 [00:08<00:09, 55.01it/s]backtest loop:  47%|████▋     | 458/971 [00:08<00:09, 56.25it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:08, 56.76it/s]backtest loop:  48%|████▊     | 470/971 [00:08<00:08, 57.23it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:08, 55.67it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:08, 56.61it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:08, 54.99it/s]backtest loop:  51%|█████     | 496/971 [00:09<00:08, 55.94it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:08, 56.95it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:08, 54.60it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 56.07it/s]backtest loop:  54%|█████▎    | 520/971 [00:09<00:07, 57.14it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 54.74it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:07, 57.26it/s]backtest loop:  56%|█████▌    | 540/971 [00:10<00:07, 58.99it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 56.21it/s]backtest loop:  57%|█████▋    | 553/971 [00:10<00:07, 58.02it/s]backtest loop:  58%|█████▊    | 560/971 [00:10<00:06, 59.70it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 56.64it/s]backtest loop:  59%|█████▉    | 572/971 [00:10<00:06, 57.39it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:06, 57.93it/s]backtest loop:  60%|██████    | 584/971 [00:10<00:06, 58.43it/s]backtest loop:  61%|██████    | 590/971 [00:10<00:06, 58.73it/s]backtest loop:  61%|██████▏   | 596/971 [00:11<00:07, 50.87it/s]backtest loop:  62%|██████▏   | 602/971 [00:11<00:06, 53.17it/s]backtest loop:  63%|██████▎   | 609/971 [00:11<00:06, 55.93it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:06, 53.46it/s]backtest loop:  64%|██████▍   | 621/971 [00:11<00:06, 55.00it/s]backtest loop:  65%|██████▍   | 628/971 [00:11<00:05, 57.36it/s]backtest loop:  65%|██████▌   | 635/971 [00:11<00:06, 55.85it/s]backtest loop:  66%|██████▌   | 642/971 [00:11<00:05, 57.79it/s]backtest loop:  67%|██████▋   | 649/971 [00:11<00:05, 59.29it/s]backtest loop:  67%|██████▋   | 655/971 [00:12<00:05, 56.42it/s]backtest loop:  68%|██████▊   | 661/971 [00:12<00:05, 57.06it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 57.41it/s]backtest loop:  69%|██████▉   | 673/971 [00:12<00:05, 57.85it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 54.81it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 56.00it/s]backtest loop:  71%|███████   | 691/971 [00:12<00:04, 57.07it/s]backtest loop:  72%|███████▏  | 697/971 [00:12<00:04, 57.48it/s]backtest loop:  73%|███████▎  | 704/971 [00:12<00:04, 55.58it/s]backtest loop:  73%|███████▎  | 711/971 [00:13<00:04, 57.49it/s]backtest loop:  74%|███████▍  | 717/971 [00:13<00:04, 57.73it/s]backtest loop:  75%|███████▍  | 724/971 [00:13<00:04, 55.91it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 54.86it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 54.14it/s]backtest loop:  77%|███████▋  | 744/971 [00:13<00:04, 55.62it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 53.85it/s]backtest loop:  78%|███████▊  | 757/971 [00:13<00:03, 56.62it/s]backtest loop:  79%|███████▊  | 764/971 [00:13<00:03, 58.09it/s]backtest loop:  79%|███████▉  | 770/971 [00:14<00:03, 56.35it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 58.52it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 55.50it/s]backtest loop:  81%|████████▏ | 789/971 [00:14<00:03, 56.57it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 53.17it/s]backtest loop:  82%|████████▏ | 801/971 [00:14<00:03, 54.85it/s]backtest loop:  83%|████████▎ | 807/971 [00:14<00:02, 56.20it/s]backtest loop:  84%|████████▎ | 813/971 [00:14<00:02, 53.48it/s]backtest loop:  84%|████████▍ | 819/971 [00:14<00:02, 55.25it/s]backtest loop:  85%|████████▌ | 826/971 [00:15<00:02, 57.40it/s]backtest loop:  86%|████████▌ | 832/971 [00:15<00:02, 57.85it/s]backtest loop:  86%|████████▋ | 838/971 [00:15<00:02, 55.09it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 57.23it/s]backtest loop:  88%|████████▊ | 851/971 [00:15<00:02, 57.98it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 54.63it/s]backtest loop:  89%|████████▉ | 863/971 [00:15<00:01, 54.95it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 55.85it/s]backtest loop:  90%|█████████ | 875/971 [00:15<00:01, 56.68it/s]backtest loop:  91%|█████████ | 881/971 [00:16<00:01, 57.07it/s]backtest loop:  91%|█████████▏| 887/971 [00:16<00:01, 53.99it/s]backtest loop:  92%|█████████▏| 893/971 [00:16<00:01, 55.28it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 56.50it/s]backtest loop:  93%|█████████▎| 905/971 [00:16<00:01, 57.37it/s]backtest loop:  94%|█████████▍| 911/971 [00:16<00:01, 57.62it/s]backtest loop:  94%|█████████▍| 917/971 [00:16<00:00, 54.79it/s]backtest loop:  95%|█████████▌| 923/971 [00:16<00:00, 56.13it/s]backtest loop:  96%|█████████▌| 929/971 [00:16<00:00, 56.91it/s]backtest loop:  96%|█████████▋| 936/971 [00:17<00:00, 55.21it/s]backtest loop:  97%|█████████▋| 943/971 [00:17<00:00, 57.28it/s]backtest loop:  98%|█████████▊| 949/971 [00:17<00:00, 57.90it/s]backtest loop:  98%|█████████▊| 955/971 [00:17<00:00, 54.83it/s]backtest loop:  99%|█████████▉| 961/971 [00:17<00:00, 55.31it/s]backtest loop: 100%|█████████▉| 967/971 [00:17<00:00, 56.46it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.90it/s]
[3047527:MainThread](2024-04-25 06:47:04,673) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000145
std                0.012140
annualized_return  0.034434
information_ratio  0.183856
max_drawdown      -0.500754
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000315
std                0.005013
annualized_return  0.074899
information_ratio  0.968503
max_drawdown      -0.084041
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000122
std                0.005015
annualized_return  0.029033
information_ratio  0.375284
max_drawdown      -0.141761
[3047527:MainThread](2024-04-25 06:47:04,691) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 49
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi500_Transformer_alpha360_horizon1_step20_rankFalse_2024-04-25_03:13:01_online`.
Round 10 Done!
{'1day.excess_return_with_cost.annualized_return': [0.043797486231573146,
                                                    0.0634228370113721,
                                                    0.032834642441840194,
                                                    0.09269971081251317,
                                                    0.0657184256393298,
                                                    0.02793087131617893,
                                                    0.08634293469479305,
                                                    0.040229393306477026,
                                                    0.0361528321661684,
                                                    0.029033010071720232],
 '1day.excess_return_with_cost.information_ratio': [0.5649832165888312,
                                                    0.7857064560613483,
                                                    0.42725276418160857,
                                                    1.2498966992194853,
                                                    0.8434476777972351,
                                                    0.3439149144228769,
                                                    1.0947603545987385,
                                                    0.4473426123644782,
                                                    0.4671567144133433,
                                                    0.37528419987497785],
 '1day.excess_return_with_cost.max_drawdown': [-0.09264196275626242,
                                               -0.11042126565462691,
                                               -0.12438813489577007,
                                               -0.0910373026769272,
                                               -0.14795385465041527,
                                               -0.17598279790117916,
                                               -0.12229648137858812,
                                               -0.17309814005010368,
                                               -0.10657211677674233,
                                               -0.14176116178507242],
 'IC': [0.02338127556803707,
        0.023874553769198607,
        0.021049908565493873,
        0.022668472335526615,
        0.023429347755308673,
        0.02417324596657715,
        0.025525801842171507,
        0.02442065458106158,
        0.024561987528414465,
        0.02318432804937657],
 'ICIR': [0.20238622048809674,
          0.18560857194822403,
          0.1806449258518542,
          0.20035905213919242,
          0.2010511035996123,
          0.1958382849156171,
          0.21886157065984174,
          0.19322319881052735,
          0.21403082395565073,
          0.20102413448089154],
 'Rank IC': [0.013917040518004948,
             0.012129057369372705,
             0.014330230707453042,
             0.018533569798826154,
             0.008485277600671977,
             0.015422447514420396,
             0.01590147842680528,
             0.01134180877794962,
             0.013096018233392523,
             0.014543446664084516],
 'Rank ICIR': [0.12551679322509657,
               0.09548055549514188,
               0.12272525155573737,
               0.1641887623113997,
               0.07311631025877363,
               0.12574576750378694,
               0.14020606031217148,
               0.09108542235925256,
               0.11257218176401919,
               0.12829315634025396],
 'mae': [0.685724139213562,
         0.685746431350708,
         0.6857940554618835,
         0.6857808232307434,
         0.6859009265899658,
         0.6857696771621704,
         0.6857050061225891,
         0.6857242584228516,
         0.6857451796531677,
         0.6858993172645569],
 'mse': [0.9972350597381592,
         0.9971662163734436,
         0.997454822063446,
         0.9973787665367126,
         0.9972341656684875,
         0.9972487092018127,
         0.9970695972442627,
         0.9971585869789124,
         0.9971657991409302,
         0.9974018335342407]}
[3047527:MainThread](2024-04-25 06:47:06,004) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name csi500_Transformer_alpha360_horizon1_step20_rankFalse_2024-04-25_03:13:01_final.
[3047527:MainThread](2024-04-25 06:47:06,046) INFO - qlib.workflow - [exp.py:258] - Experiment 50 starts running ...
[3047527:MainThread](2024-04-25 06:47:06,062) INFO - qlib.workflow - [recorder.py:341] - Recorder 184189f43e5540bdb0f08128c34f6404 starts running under Experiment 50 ...
Time cost: 1204.1563715934753	80.26181104183198
Final results:
{'1day.excess_return_with_cost.annualized_return': [0.0518162143691966,
                                                    0.02255065390228616],
 '1day.excess_return_with_cost.information_ratio': [0.6599745609522923,
                                                    0.3021645030743969],
 '1day.excess_return_with_cost.max_drawdown': [-0.12861532185256877,
                                               0.028896547156371223],
 'IC': [0.02362695759611661, 0.0011543303739553641],
 'ICIR': [0.19930278868495083, 0.0109577163349658],
 'Rank IC': [0.013770037561098116, 0.0026051953280944967],
 'Rank ICIR': [0.11789302611256333, 0.024792537777765012],
 'mae': [0.6857789814472198, 6.583708171335228e-05],
 'mse': [0.9972513556480408, 0.00011707028745266244]}
Your final results can be found in the experiment named `csi500_Transformer_alpha360_horizon1_step20_rankFalse_2024-04-25_03:13:01_final`.
All Done!
[3047527:MainThread](2024-04-25 06:47:07,284) INFO - qlib.timer - [log.py:127] - Time cost: 0.042s | waiting `async_log` Done

['main.py', 'run_all', '--forecast_model', 'MLP', '-num_head', '8', '--train_start=2008-01-01', '--train_end=2018-12-31', '--valid_start=2019-01-01', '--valid_end=2020-03-31', '--test_start=2020-04-01', '--test_end=2024-03-31', '--tau', '10', '--lr_da', '0.01', '--market', 'csi300', '--data_dir', 'crowd_data', '--rank_label', 'False', '--begin_valid_epoch', '30']
[3408179:MainThread](2024-04-25 19:37:03,910) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[3408179:MainThread](2024-04-25 19:37:03,913) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[3408179:MainThread](2024-04-25 19:37:03,913) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/crowd_data')}
Remove CSRankNorm
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
[3408179:MainThread](2024-04-25 19:37:36,167) INFO - qlib.timer - [log.py:127] - Time cost: 32.241s | Loading data Done
[3408179:MainThread](2024-04-25 19:40:21,446) INFO - qlib.timer - [log.py:127] - Time cost: 162.967s | RobustZScoreNorm Done
[3408179:MainThread](2024-04-25 19:40:24,446) INFO - qlib.timer - [log.py:127] - Time cost: 2.998s | Fillna Done
[3408179:MainThread](2024-04-25 19:40:26,125) INFO - qlib.timer - [log.py:127] - Time cost: 0.915s | DropnaLabel Done
[3408179:MainThread](2024-04-25 19:40:33,740) INFO - qlib.timer - [log.py:127] - Time cost: 7.614s | CSZScoreNorm Done
[3408179:MainThread](2024-04-25 19:40:33,745) INFO - qlib.timer - [log.py:127] - Time cost: 177.578s | fit & process data Done
[3408179:MainThread](2024-04-25 19:40:33,746) INFO - qlib.timer - [log.py:127] - Time cost: 209.821s | Init data Done
Save handler file to /home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_MLP_alpha360_handler_horizon1.pkl
Task: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.001, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
[3408179:MainThread](2024-04-25 19:40:47,720) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.001, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-02 00:00:00'), Timestamp('2008-01-29 00:00:00')), 'test': (Timestamp('2008-01-31 00:00:00'), Timestamp('2008-03-05 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/147 [00:00<?, ?it/s]creating meta tasks:  27%|██▋       | 39/147 [00:00<00:00, 389.72it/s]creating meta tasks:  56%|█████▌    | 82/147 [00:00<00:00, 409.15it/s]creating meta tasks:  85%|████████▌ | 125/147 [00:00<00:00, 415.55it/s]creating meta tasks: 100%|██████████| 147/147 [00:00<00:00, 412.60it/s]
[3408179:MainThread](2024-04-25 19:40:48,371) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'DNNModelPytorch', 'module_path': 'qlib.contrib.model.pytorch_nn', 'kwargs': {'loss': 'mse', 'lr': 0.001, 'optimizer': 'adam', 'max_steps': 8000, 'batch_size': 4096, 'GPU': 0, 'pt_model_kwargs': {'input_dim': 360}, 'scheduler': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_MLP_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2019-01-02 00:00:00'), Timestamp('2019-01-29 00:00:00')), 'test': (Timestamp('2019-01-31 00:00:00'), Timestamp('2019-03-06 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/63 [00:00<?, ?it/s]creating meta tasks:  52%|█████▏    | 33/63 [00:00<00:00, 328.13it/s]creating meta tasks: 100%|██████████| 63/63 [00:00<00:00, 335.46it/s]
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3408179:MainThread](2024-04-25 19:40:49,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3408179:MainThread](2024-04-25 19:40:50,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.001
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3408179:MainThread](2024-04-25 19:40:50,006) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3408179:MainThread](2024-04-25 19:40:50,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:12<20:28, 12.41s/it]epoch:   2%|▏         | 2/100 [00:16<12:37,  7.73s/it]epoch:   3%|▎         | 3/100 [00:21<10:12,  6.32s/it]epoch:   4%|▍         | 4/100 [00:26<09:04,  5.67s/it]epoch:   5%|▌         | 5/100 [00:30<08:20,  5.27s/it]epoch:   6%|▌         | 6/100 [00:35<07:59,  5.10s/it]epoch:   7%|▋         | 7/100 [00:39<07:31,  4.86s/it]epoch:   8%|▊         | 8/100 [00:44<07:17,  4.75s/it]epoch:   9%|▉         | 9/100 [00:48<07:02,  4.64s/it]epoch:  10%|█         | 10/100 [00:53<06:50,  4.56s/it]epoch:  11%|█         | 11/100 [00:57<06:42,  4.52s/it]epoch:  12%|█▏        | 12/100 [01:02<06:35,  4.50s/it]epoch:  13%|█▎        | 13/100 [01:06<06:28,  4.46s/it]epoch:  14%|█▍        | 14/100 [01:10<06:22,  4.45s/it]epoch:  15%|█▌        | 15/100 [01:15<06:19,  4.47s/it]epoch:  16%|█▌        | 16/100 [01:19<06:13,  4.45s/it]epoch:  17%|█▋        | 17/100 [01:24<06:09,  4.46s/it]epoch:  18%|█▊        | 18/100 [01:28<06:06,  4.47s/it]epoch:  19%|█▉        | 19/100 [01:33<05:59,  4.44s/it]epoch:  20%|██        | 20/100 [01:37<05:50,  4.39s/it]epoch:  21%|██        | 21/100 [01:41<05:37,  4.27s/it]epoch:  22%|██▏       | 22/100 [01:45<05:37,  4.33s/it]epoch:  23%|██▎       | 23/100 [01:50<05:31,  4.30s/it]epoch:  24%|██▍       | 24/100 [01:54<05:33,  4.39s/it]epoch:  25%|██▌       | 25/100 [01:59<05:30,  4.41s/it]epoch:  26%|██▌       | 26/100 [02:03<05:26,  4.41s/it]epoch:  27%|██▋       | 27/100 [02:07<05:18,  4.37s/it]epoch:  28%|██▊       | 28/100 [02:12<05:19,  4.43s/it]epoch:  29%|██▉       | 29/100 [02:16<05:17,  4.47s/it]epoch:  30%|███       | 30/100 [02:21<05:11,  4.46s/it]0.02950954747427834
best ic: 0.02950954747427834
epoch:  31%|███       | 31/100 [02:26<05:30,  4.79s/it]0.030844135286957463
best ic: 0.030844135286957463
epoch:  32%|███▏      | 32/100 [02:32<05:35,  4.93s/it]0.023866539316328407
epoch:  33%|███▎      | 33/100 [02:37<05:40,  5.08s/it]0.03288436997120754
best ic: 0.03288436997120754
epoch:  34%|███▍      | 34/100 [02:43<05:45,  5.24s/it]0.029684208842178823
epoch:  35%|███▌      | 35/100 [02:48<05:38,  5.20s/it]0.02975831809860825
epoch:  36%|███▌      | 36/100 [02:53<05:33,  5.21s/it]0.023227370054981464
epoch:  37%|███▋      | 37/100 [02:58<05:25,  5.16s/it]0.02357141327920378
epoch:  38%|███▊      | 38/100 [03:03<05:20,  5.16s/it]0.023468324533744964
epoch:  39%|███▉      | 39/100 [03:08<05:13,  5.13s/it]0.03138565071180429
epoch:  40%|████      | 40/100 [03:13<05:03,  5.06s/it]0.029127318215785465
epoch:  41%|████      | 41/100 [03:19<05:02,  5.12s/it]0.02722766950195417
epoch:  41%|████      | 41/100 [03:24<04:53,  4.98s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3408179:MainThread](2024-04-25 19:44:16,754) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name csi300_MLP_alpha360_horizon1_step20_rankFalse_2024-04-25_19:40:48_online.
[3408179:MainThread](2024-04-25 19:44:16,795) INFO - qlib.workflow - [exp.py:258] - Experiment 51 starts running ...
[3408179:MainThread](2024-04-25 19:44:17,750) INFO - qlib.workflow - [recorder.py:341] - Recorder 3c74d4de3a9b4327b69fc120bda72674 starts running under Experiment 51 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   5%|▍         | 3/63 [00:00<00:02, 24.52it/s]online:  10%|▉         | 6/63 [00:00<00:02, 23.87it/s]online:  14%|█▍        | 9/63 [00:00<00:02, 22.99it/s]online:  19%|█▉        | 12/63 [00:00<00:02, 23.08it/s]online:  24%|██▍       | 15/63 [00:00<00:02, 22.47it/s]online:  29%|██▊       | 18/63 [00:00<00:02, 22.13it/s]online:  33%|███▎      | 21/63 [00:00<00:01, 21.58it/s]online:  38%|███▊      | 24/63 [00:01<00:01, 21.81it/s]online:  43%|████▎     | 27/63 [00:01<00:01, 22.09it/s]online:  48%|████▊     | 30/63 [00:01<00:01, 22.34it/s]online:  52%|█████▏    | 33/63 [00:01<00:01, 23.04it/s]online:  57%|█████▋    | 36/63 [00:01<00:01, 23.50it/s]online:  62%|██████▏   | 39/63 [00:01<00:01, 23.72it/s]online:  67%|██████▋   | 42/63 [00:01<00:00, 23.20it/s]online:  71%|███████▏  | 45/63 [00:01<00:00, 23.13it/s]online:  76%|███████▌  | 48/63 [00:02<00:00, 23.10it/s]online:  81%|████████  | 51/63 [00:02<00:00, 23.63it/s]online:  86%|████████▌ | 54/63 [00:02<00:00, 23.83it/s]online:  90%|█████████ | 57/63 [00:02<00:00, 24.09it/s]online:  95%|█████████▌| 60/63 [00:02<00:00, 24.44it/s]online: 100%|██████████| 63/63 [00:02<00:00, 24.10it/s]online: 100%|██████████| 63/63 [00:02<00:00, 23.21it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3408179:MainThread](2024-04-25 19:44:27,196) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 1.0026988 mae 0.7102561
{'IC': 0.01965990918075504,
 'ICIR': 0.1335802115342955,
 'Rank IC': 0.020391620238398377,
 'Rank ICIR': 0.13725662019635151}
[3408179:MainThread](2024-04-25 19:44:29,148) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3408179:MainThread](2024-04-25 19:44:40,008) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 19:44:40,011) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 19:44:46,164) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f15953224c0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 6/971 [00:00<00:18, 53.49it/s]backtest loop:   1%|          | 12/971 [00:00<00:19, 49.82it/s]backtest loop:   2%|▏         | 18/971 [00:00<00:18, 52.66it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:18, 50.53it/s]backtest loop:   3%|▎         | 30/971 [00:00<00:18, 52.16it/s]backtest loop:   4%|▎         | 36/971 [00:00<00:17, 53.88it/s]backtest loop:   4%|▍         | 42/971 [00:00<00:16, 55.15it/s]backtest loop:   5%|▍         | 48/971 [00:00<00:16, 55.88it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 51.02it/s]backtest loop:   6%|▌         | 60/971 [00:01<00:17, 51.38it/s]backtest loop:   7%|▋         | 66/971 [00:01<00:17, 51.86it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:18, 49.26it/s]backtest loop:   8%|▊         | 78/971 [00:01<00:17, 50.34it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:17, 50.96it/s]backtest loop:   9%|▉         | 90/971 [00:01<00:17, 51.44it/s]backtest loop:  10%|▉         | 96/971 [00:01<00:17, 51.37it/s]backtest loop:  11%|█         | 102/971 [00:01<00:17, 48.49it/s]backtest loop:  11%|█         | 107/971 [00:02<00:17, 48.72it/s]backtest loop:  12%|█▏        | 113/971 [00:02<00:17, 49.85it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:16, 50.61it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:17, 48.33it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:17, 46.71it/s]backtest loop:  14%|█▍        | 137/971 [00:02<00:17, 48.41it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:16, 49.68it/s]backtest loop:  15%|█▌        | 149/971 [00:02<00:16, 50.44it/s]backtest loop:  16%|█▌        | 155/971 [00:03<00:15, 51.22it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:16, 48.50it/s]backtest loop:  17%|█▋        | 167/971 [00:03<00:16, 49.57it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:15, 50.46it/s]backtest loop:  18%|█▊        | 179/971 [00:03<00:15, 51.10it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:16, 48.40it/s]backtest loop:  20%|█▉        | 191/971 [00:03<00:15, 49.78it/s]backtest loop:  20%|██        | 197/971 [00:03<00:15, 50.54it/s]backtest loop:  21%|██        | 203/971 [00:04<00:14, 51.32it/s]backtest loop:  22%|██▏       | 209/971 [00:04<00:14, 51.88it/s]backtest loop:  22%|██▏       | 215/971 [00:04<00:16, 46.50it/s]backtest loop:  23%|██▎       | 221/971 [00:04<00:15, 47.80it/s]backtest loop:  23%|██▎       | 226/971 [00:04<00:15, 48.35it/s]backtest loop:  24%|██▍       | 232/971 [00:04<00:14, 49.56it/s]backtest loop:  25%|██▍       | 238/971 [00:04<00:14, 50.27it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:14, 51.15it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:14, 48.24it/s]backtest loop:  26%|██▋       | 256/971 [00:05<00:14, 49.69it/s]backtest loop:  27%|██▋       | 262/971 [00:05<00:14, 50.57it/s]backtest loop:  28%|██▊       | 268/971 [00:05<00:14, 48.23it/s]backtest loop:  28%|██▊       | 274/971 [00:05<00:14, 49.53it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:13, 50.57it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:14, 48.07it/s]backtest loop:  30%|██▉       | 291/971 [00:06<00:22, 30.24it/s]backtest loop:  31%|███       | 297/971 [00:06<00:19, 34.81it/s]backtest loop:  31%|███       | 302/971 [00:06<00:17, 37.89it/s]backtest loop:  32%|███▏      | 307/971 [00:06<00:16, 40.62it/s]backtest loop:  32%|███▏      | 313/971 [00:06<00:15, 43.80it/s]backtest loop:  33%|███▎      | 319/971 [00:06<00:14, 46.14it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:14, 45.13it/s]backtest loop:  34%|███▍      | 331/971 [00:06<00:13, 47.31it/s]backtest loop:  35%|███▍      | 337/971 [00:06<00:12, 48.83it/s]backtest loop:  35%|███▌      | 343/971 [00:07<00:12, 49.90it/s]backtest loop:  36%|███▌      | 349/971 [00:07<00:12, 50.75it/s]backtest loop:  37%|███▋      | 355/971 [00:07<00:12, 48.37it/s]backtest loop:  37%|███▋      | 361/971 [00:07<00:12, 49.88it/s]backtest loop:  38%|███▊      | 367/971 [00:07<00:12, 47.72it/s]backtest loop:  38%|███▊      | 373/971 [00:07<00:12, 46.27it/s]backtest loop:  39%|███▉      | 379/971 [00:07<00:12, 47.83it/s]backtest loop:  40%|███▉      | 384/971 [00:07<00:12, 48.38it/s]backtest loop:  40%|████      | 389/971 [00:08<00:11, 48.75it/s]backtest loop:  41%|████      | 394/971 [00:08<00:11, 49.00it/s]backtest loop:  41%|████      | 399/971 [00:08<00:11, 49.14it/s]backtest loop:  42%|████▏     | 405/971 [00:08<00:11, 50.26it/s]backtest loop:  42%|████▏     | 411/971 [00:08<00:10, 51.03it/s]backtest loop:  43%|████▎     | 417/971 [00:08<00:10, 51.53it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:11, 48.76it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:10, 49.57it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:10, 50.44it/s]backtest loop:  45%|████▌     | 441/971 [00:09<00:10, 51.16it/s]backtest loop:  46%|████▌     | 447/971 [00:09<00:10, 48.55it/s]backtest loop:  47%|████▋     | 452/971 [00:09<00:10, 48.88it/s]backtest loop:  47%|████▋     | 458/971 [00:09<00:10, 50.28it/s]backtest loop:  48%|████▊     | 464/971 [00:09<00:09, 51.14it/s]backtest loop:  48%|████▊     | 470/971 [00:09<00:09, 51.73it/s]backtest loop:  49%|████▉     | 476/971 [00:09<00:09, 52.10it/s]backtest loop:  50%|████▉     | 482/971 [00:09<00:09, 48.97it/s]backtest loop:  50%|█████     | 488/971 [00:10<00:09, 50.21it/s]backtest loop:  51%|█████     | 494/971 [00:10<00:09, 50.96it/s]backtest loop:  51%|█████▏    | 500/971 [00:10<00:09, 48.68it/s]backtest loop:  52%|█████▏    | 506/971 [00:10<00:09, 50.01it/s]backtest loop:  53%|█████▎    | 512/971 [00:10<00:09, 47.78it/s]backtest loop:  53%|█████▎    | 518/971 [00:10<00:09, 49.58it/s]backtest loop:  54%|█████▍    | 524/971 [00:10<00:08, 50.34it/s]backtest loop:  55%|█████▍    | 530/971 [00:10<00:08, 51.09it/s]backtest loop:  55%|█████▌    | 536/971 [00:10<00:08, 48.72it/s]backtest loop:  56%|█████▌    | 542/971 [00:11<00:08, 49.66it/s]backtest loop:  56%|█████▋    | 548/971 [00:11<00:08, 50.18it/s]backtest loop:  57%|█████▋    | 554/971 [00:11<00:08, 50.86it/s]backtest loop:  58%|█████▊    | 560/971 [00:11<00:07, 51.40it/s]backtest loop:  58%|█████▊    | 566/971 [00:11<00:08, 48.40it/s]backtest loop:  59%|█████▉    | 572/971 [00:11<00:08, 49.52it/s]backtest loop:  60%|█████▉    | 578/971 [00:11<00:07, 50.55it/s]backtest loop:  60%|██████    | 584/971 [00:11<00:07, 51.08it/s]backtest loop:  61%|██████    | 590/971 [00:12<00:07, 51.58it/s]backtest loop:  61%|██████▏   | 596/971 [00:12<00:07, 48.95it/s]backtest loop:  62%|██████▏   | 601/971 [00:12<00:07, 49.10it/s]backtest loop:  63%|██████▎   | 607/971 [00:12<00:07, 50.11it/s]backtest loop:  63%|██████▎   | 613/971 [00:12<00:07, 50.85it/s]backtest loop:  64%|██████▎   | 619/971 [00:12<00:06, 51.03it/s]backtest loop:  64%|██████▍   | 625/971 [00:12<00:07, 48.41it/s]backtest loop:  65%|██████▍   | 631/971 [00:12<00:06, 49.62it/s]backtest loop:  66%|██████▌   | 637/971 [00:12<00:06, 50.53it/s]backtest loop:  66%|██████▌   | 643/971 [00:13<00:06, 50.87it/s]backtest loop:  67%|██████▋   | 649/971 [00:13<00:06, 51.46it/s]backtest loop:  67%|██████▋   | 655/971 [00:13<00:06, 48.80it/s]backtest loop:  68%|██████▊   | 661/971 [00:13<00:06, 49.89it/s]backtest loop:  69%|██████▊   | 667/971 [00:13<00:06, 50.49it/s]backtest loop:  69%|██████▉   | 673/971 [00:13<00:05, 51.07it/s]backtest loop:  70%|██████▉   | 679/971 [00:13<00:06, 48.60it/s]backtest loop:  70%|███████   | 684/971 [00:13<00:05, 48.88it/s]backtest loop:  71%|███████   | 690/971 [00:14<00:05, 49.98it/s]backtest loop:  72%|███████▏  | 696/971 [00:14<00:05, 50.83it/s]backtest loop:  72%|███████▏  | 702/971 [00:14<00:05, 51.15it/s]backtest loop:  73%|███████▎  | 708/971 [00:14<00:05, 51.41it/s]backtest loop:  74%|███████▎  | 714/971 [00:14<00:05, 48.89it/s]backtest loop:  74%|███████▍  | 720/971 [00:14<00:05, 50.15it/s]backtest loop:  75%|███████▍  | 726/971 [00:14<00:04, 51.08it/s]backtest loop:  75%|███████▌  | 732/971 [00:14<00:04, 48.36it/s]backtest loop:  76%|███████▌  | 738/971 [00:15<00:05, 46.56it/s]backtest loop:  77%|███████▋  | 744/971 [00:15<00:04, 48.20it/s]backtest loop:  77%|███████▋  | 750/971 [00:15<00:04, 46.55it/s]backtest loop:  78%|███████▊  | 756/971 [00:15<00:04, 48.28it/s]backtest loop:  78%|███████▊  | 762/971 [00:15<00:04, 49.49it/s]backtest loop:  79%|███████▉  | 768/971 [00:15<00:04, 50.46it/s]backtest loop:  80%|███████▉  | 774/971 [00:15<00:03, 50.90it/s]backtest loop:  80%|████████  | 780/971 [00:15<00:03, 48.51it/s]backtest loop:  81%|████████  | 786/971 [00:15<00:03, 49.66it/s]backtest loop:  82%|████████▏ | 792/971 [00:16<00:03, 50.34it/s]backtest loop:  82%|████████▏ | 798/971 [00:16<00:03, 48.02it/s]backtest loop:  83%|████████▎ | 804/971 [00:16<00:03, 49.34it/s]backtest loop:  83%|████████▎ | 810/971 [00:16<00:03, 50.19it/s]backtest loop:  84%|████████▍ | 816/971 [00:16<00:03, 50.95it/s]backtest loop:  85%|████████▍ | 822/971 [00:16<00:02, 51.27it/s]backtest loop:  85%|████████▌ | 828/971 [00:16<00:02, 48.64it/s]backtest loop:  86%|████████▌ | 834/971 [00:16<00:02, 49.77it/s]backtest loop:  87%|████████▋ | 840/971 [00:17<00:02, 50.17it/s]backtest loop:  87%|████████▋ | 846/971 [00:17<00:02, 50.88it/s]backtest loop:  88%|████████▊ | 852/971 [00:17<00:02, 48.35it/s]backtest loop:  88%|████████▊ | 857/971 [00:17<00:02, 48.73it/s]backtest loop:  89%|████████▉ | 863/971 [00:17<00:02, 49.89it/s]backtest loop:  89%|████████▉ | 869/971 [00:17<00:02, 50.37it/s]backtest loop:  90%|█████████ | 875/971 [00:17<00:01, 50.96it/s]backtest loop:  91%|█████████ | 881/971 [00:17<00:01, 51.54it/s]backtest loop:  91%|█████████▏| 887/971 [00:18<00:01, 48.94it/s]backtest loop:  92%|█████████▏| 893/971 [00:18<00:01, 49.83it/s]backtest loop:  93%|█████████▎| 899/971 [00:18<00:01, 50.76it/s]backtest loop:  93%|█████████▎| 905/971 [00:18<00:01, 51.39it/s]backtest loop:  94%|█████████▍| 911/971 [00:18<00:01, 51.85it/s]backtest loop:  94%|█████████▍| 917/971 [00:18<00:01, 48.99it/s]backtest loop:  95%|█████████▌| 923/971 [00:18<00:00, 50.04it/s]backtest loop:  96%|█████████▌| 929/971 [00:18<00:00, 50.87it/s]backtest loop:  96%|█████████▋| 935/971 [00:18<00:00, 51.33it/s]backtest loop:  97%|█████████▋| 941/971 [00:19<00:00, 48.64it/s]backtest loop:  98%|█████████▊| 947/971 [00:19<00:00, 49.57it/s]backtest loop:  98%|█████████▊| 953/971 [00:19<00:00, 50.77it/s]backtest loop:  99%|█████████▉| 959/971 [00:19<00:00, 51.32it/s]backtest loop:  99%|█████████▉| 965/971 [00:19<00:00, 48.54it/s]backtest loop: 100%|█████████▉| 970/971 [00:19<00:00, 48.75it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 49.30it/s]
[3408179:MainThread](2024-04-25 19:45:05,943) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000437
std                0.006493
annualized_return  0.103962
information_ratio  1.037907
max_drawdown      -0.104772
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000240
std                0.006493
annualized_return  0.057177
information_ratio  0.570841
max_drawdown      -0.136921
[3408179:MainThread](2024-04-25 19:45:05,963) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_MLP_alpha360_horizon1_step20_rankFalse_2024-04-25_19:40:48_online`.
Round 1 Done!
{'1day.excess_return_with_cost.annualized_return': [0.057177137820259884],
 '1day.excess_return_with_cost.information_ratio': [0.5708410850384811],
 '1day.excess_return_with_cost.max_drawdown': [-0.1369210363821404],
 'IC': [0.01965990918075504],
 'ICIR': [0.1335802115342955],
 'Rank IC': [0.020391620238398377],
 'Rank ICIR': [0.13725662019635151],
 'mae': [0.7102560997009277],
 'mse': [1.0026987791061401]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3408179:MainThread](2024-04-25 19:45:07,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3408179:MainThread](2024-04-25 19:45:07,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.001
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3408179:MainThread](2024-04-25 19:45:07,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3408179:MainThread](2024-04-25 19:45:07,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:05<08:33,  5.19s/it]epoch:   2%|▏         | 2/100 [00:10<08:08,  4.99s/it]epoch:   3%|▎         | 3/100 [00:14<07:59,  4.94s/it]epoch:   4%|▍         | 4/100 [00:19<07:44,  4.83s/it]epoch:   5%|▌         | 5/100 [00:24<07:26,  4.70s/it]epoch:   6%|▌         | 6/100 [00:28<07:24,  4.73s/it]epoch:   7%|▋         | 7/100 [00:33<07:21,  4.75s/it]epoch:   8%|▊         | 8/100 [00:38<07:20,  4.79s/it]epoch:   9%|▉         | 9/100 [00:42<07:06,  4.69s/it]epoch:  10%|█         | 10/100 [00:47<06:56,  4.63s/it]epoch:  11%|█         | 11/100 [00:51<06:40,  4.50s/it]epoch:  12%|█▏        | 12/100 [00:56<06:37,  4.51s/it]epoch:  13%|█▎        | 13/100 [01:01<06:44,  4.65s/it]epoch:  14%|█▍        | 14/100 [01:06<06:45,  4.71s/it]epoch:  15%|█▌        | 15/100 [01:10<06:37,  4.67s/it]epoch:  16%|█▌        | 16/100 [01:14<06:22,  4.55s/it]epoch:  17%|█▋        | 17/100 [01:19<06:20,  4.58s/it]epoch:  18%|█▊        | 18/100 [01:23<06:11,  4.53s/it]epoch:  19%|█▉        | 19/100 [01:28<06:02,  4.47s/it]epoch:  20%|██        | 20/100 [01:33<06:09,  4.61s/it]epoch:  21%|██        | 21/100 [01:38<06:10,  4.69s/it]epoch:  22%|██▏       | 22/100 [01:42<06:07,  4.72s/it]epoch:  23%|██▎       | 23/100 [01:47<06:02,  4.70s/it]epoch:  24%|██▍       | 24/100 [01:52<05:56,  4.69s/it]epoch:  25%|██▌       | 25/100 [01:56<05:45,  4.61s/it]epoch:  26%|██▌       | 26/100 [02:01<05:41,  4.61s/it]epoch:  27%|██▋       | 27/100 [02:05<05:36,  4.60s/it]epoch:  28%|██▊       | 28/100 [02:10<05:27,  4.55s/it]epoch:  29%|██▉       | 29/100 [02:14<05:15,  4.45s/it]epoch:  30%|███       | 30/100 [02:18<05:07,  4.39s/it]0.025863378011720065
best ic: 0.025863378011720065
epoch:  31%|███       | 31/100 [02:23<05:19,  4.62s/it]0.027670140129594064
best ic: 0.027670140129594064
epoch:  32%|███▏      | 32/100 [02:29<05:26,  4.80s/it]0.031892875338253975
best ic: 0.031892875338253975
epoch:  33%|███▎      | 33/100 [02:33<05:19,  4.77s/it]0.028016472752480617
epoch:  34%|███▍      | 34/100 [02:39<05:28,  4.98s/it]0.026383691399478073
epoch:  35%|███▌      | 35/100 [02:44<05:34,  5.14s/it]0.0309324712503631
epoch:  36%|███▌      | 36/100 [02:50<05:35,  5.24s/it]0.03074145422718947
epoch:  37%|███▋      | 37/100 [02:55<05:31,  5.26s/it]0.030336930586770297
epoch:  38%|███▊      | 38/100 [03:01<05:31,  5.35s/it]0.027199741536736096
epoch:  39%|███▉      | 39/100 [03:06<05:27,  5.37s/it]0.02478226881114494
epoch:  40%|████      | 40/100 [03:11<05:13,  5.23s/it]0.030031158742108537
epoch:  40%|████      | 40/100 [03:16<04:54,  4.91s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3408179:MainThread](2024-04-25 19:48:23,677) INFO - qlib.workflow - [exp.py:258] - Experiment 51 starts running ...
[3408179:MainThread](2024-04-25 19:48:23,696) INFO - qlib.workflow - [recorder.py:341] - Recorder e318040aab2c40da8545b834476624d2 starts running under Experiment 51 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   5%|▍         | 3/63 [00:00<00:02, 26.97it/s]online:  10%|▉         | 6/63 [00:00<00:02, 28.38it/s]online:  14%|█▍        | 9/63 [00:00<00:01, 28.32it/s]online:  19%|█▉        | 12/63 [00:00<00:01, 28.12it/s]online:  24%|██▍       | 15/63 [00:00<00:01, 27.95it/s]online:  29%|██▊       | 18/63 [00:00<00:01, 28.12it/s]online:  33%|███▎      | 21/63 [00:00<00:01, 28.16it/s]online:  38%|███▊      | 24/63 [00:00<00:01, 28.14it/s]online:  43%|████▎     | 27/63 [00:00<00:01, 28.06it/s]online:  48%|████▊     | 30/63 [00:01<00:01, 26.73it/s]online:  52%|█████▏    | 33/63 [00:01<00:01, 25.74it/s]online:  57%|█████▋    | 36/63 [00:01<00:01, 25.44it/s]online:  63%|██████▎   | 40/63 [00:01<00:00, 27.42it/s]online:  70%|██████▉   | 44/63 [00:01<00:00, 28.77it/s]online:  76%|███████▌  | 48/63 [00:01<00:00, 29.69it/s]online:  83%|████████▎ | 52/63 [00:01<00:00, 30.21it/s]online:  89%|████████▉ | 56/63 [00:01<00:00, 30.66it/s]online:  95%|█████████▌| 60/63 [00:02<00:00, 30.79it/s]online: 100%|██████████| 63/63 [00:02<00:00, 28.78it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3408179:MainThread](2024-04-25 19:48:32,784) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 1.0009209 mae 0.70943123
{'IC': 0.017473035411976354,
 'ICIR': 0.11199170785924299,
 'Rank IC': 0.020504008283316912,
 'Rank ICIR': 0.12869373013758173}
[3408179:MainThread](2024-04-25 19:48:34,601) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3408179:MainThread](2024-04-25 19:48:46,145) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 19:48:46,149) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 19:48:52,232) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f17196c0a00>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:41,  9.57it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 24.83it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 35.08it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 39.07it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 44.35it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 48.06it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:19, 47.53it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:18, 49.98it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:17, 52.15it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 50.56it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 52.66it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:16, 53.91it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 55.12it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 55.78it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:16, 52.90it/s]backtest loop:  10%|▉         | 93/971 [00:01<00:16, 54.28it/s]backtest loop:  10%|█         | 99/971 [00:02<00:15, 55.22it/s]backtest loop:  11%|█         | 105/971 [00:02<00:15, 56.00it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:15, 56.63it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:15, 53.40it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:15, 54.63it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:16, 51.96it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:15, 53.57it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:16, 50.86it/s]backtest loop:  15%|█▌        | 147/971 [00:02<00:15, 52.53it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 53.69it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:14, 55.12it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:14, 55.88it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 52.92it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:14, 54.32it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 55.25it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:13, 56.22it/s]backtest loop:  20%|██        | 195/971 [00:03<00:14, 53.19it/s]backtest loop:  21%|██        | 201/971 [00:03<00:14, 54.75it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:13, 56.13it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:14, 53.23it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:13, 54.48it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:14, 51.88it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:13, 53.37it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:13, 54.39it/s]backtest loop:  25%|██▌       | 243/971 [00:04<00:13, 55.32it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:13, 52.62it/s]backtest loop:  26%|██▋       | 255/971 [00:04<00:13, 53.86it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:12, 55.13it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:13, 52.38it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 54.16it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:12, 55.13it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:12, 55.74it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 52.87it/s]backtest loop:  31%|███       | 297/971 [00:05<00:12, 54.10it/s]backtest loop:  31%|███       | 303/971 [00:05<00:12, 55.19it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 55.63it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:12, 52.98it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:12, 53.35it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:11, 54.45it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:11, 55.66it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:11, 56.01it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 52.93it/s]backtest loop:  36%|███▌      | 351/971 [00:06<00:11, 54.28it/s]backtest loop:  37%|███▋      | 357/971 [00:06<00:11, 54.97it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:11, 52.71it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:11, 51.01it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 52.75it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:10, 54.26it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 55.35it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 52.75it/s]backtest loop:  41%|████      | 399/971 [00:07<00:10, 54.04it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:10, 54.79it/s]backtest loop:  42%|████▏     | 411/971 [00:07<00:10, 55.79it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 56.89it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:10, 53.47it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:09, 54.57it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:09, 55.40it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 55.84it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 52.83it/s]backtest loop:  47%|████▋     | 453/971 [00:08<00:09, 54.20it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:09, 55.00it/s]backtest loop:  48%|████▊     | 465/971 [00:08<00:09, 55.67it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:08, 56.17it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 52.98it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:09, 54.04it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:08, 55.10it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:09, 52.22it/s]backtest loop:  52%|█████▏    | 501/971 [00:09<00:08, 53.33it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 51.61it/s]backtest loop:  53%|█████▎    | 513/971 [00:09<00:08, 53.24it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:08, 54.56it/s]backtest loop:  54%|█████▍    | 525/971 [00:09<00:08, 55.35it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 52.93it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:07, 54.52it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:07, 55.16it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 55.75it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 56.40it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 53.08it/s]backtest loop:  58%|█████▊    | 567/971 [00:10<00:07, 54.29it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:07, 55.15it/s]backtest loop:  60%|█████▉    | 579/971 [00:10<00:07, 55.48it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:06, 56.10it/s]backtest loop:  61%|██████    | 591/971 [00:11<00:07, 53.21it/s]backtest loop:  61%|██████▏   | 597/971 [00:11<00:06, 54.43it/s]backtest loop:  62%|██████▏   | 603/971 [00:11<00:06, 55.19it/s]backtest loop:  63%|██████▎   | 609/971 [00:11<00:06, 55.94it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:11, 31.65it/s]backtest loop:  64%|██████▍   | 621/971 [00:11<00:09, 36.49it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:08, 41.08it/s]backtest loop:  65%|██████▌   | 633/971 [00:12<00:07, 44.94it/s]backtest loop:  66%|██████▌   | 639/971 [00:12<00:06, 48.09it/s]backtest loop:  66%|██████▋   | 645/971 [00:12<00:06, 48.01it/s]backtest loop:  67%|██████▋   | 651/971 [00:12<00:06, 50.47it/s]backtest loop:  68%|██████▊   | 657/971 [00:12<00:06, 52.27it/s]backtest loop:  68%|██████▊   | 663/971 [00:12<00:05, 53.37it/s]backtest loop:  69%|██████▉   | 669/971 [00:12<00:05, 54.11it/s]backtest loop:  70%|██████▉   | 675/971 [00:12<00:05, 51.89it/s]backtest loop:  70%|███████   | 681/971 [00:13<00:05, 53.31it/s]backtest loop:  71%|███████   | 687/971 [00:13<00:05, 54.28it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:05, 55.23it/s]backtest loop:  72%|███████▏  | 699/971 [00:13<00:05, 52.54it/s]backtest loop:  73%|███████▎  | 705/971 [00:13<00:04, 53.80it/s]backtest loop:  73%|███████▎  | 711/971 [00:13<00:04, 54.79it/s]backtest loop:  74%|███████▍  | 717/971 [00:13<00:04, 55.60it/s]backtest loop:  74%|███████▍  | 723/971 [00:13<00:04, 56.11it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 52.96it/s]backtest loop:  76%|███████▌  | 735/971 [00:14<00:04, 50.89it/s]backtest loop:  76%|███████▋  | 741/971 [00:14<00:04, 52.62it/s]backtest loop:  77%|███████▋  | 747/971 [00:14<00:04, 54.04it/s]backtest loop:  78%|███████▊  | 753/971 [00:14<00:04, 51.61it/s]backtest loop:  78%|███████▊  | 759/971 [00:14<00:03, 53.17it/s]backtest loop:  79%|███████▉  | 765/971 [00:14<00:04, 51.26it/s]backtest loop:  79%|███████▉  | 771/971 [00:14<00:03, 52.81it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 54.13it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 52.04it/s]backtest loop:  81%|████████▏ | 789/971 [00:15<00:03, 53.33it/s]backtest loop:  82%|████████▏ | 795/971 [00:15<00:03, 54.41it/s]backtest loop:  82%|████████▏ | 801/971 [00:15<00:03, 55.28it/s]backtest loop:  83%|████████▎ | 807/971 [00:15<00:02, 55.97it/s]backtest loop:  84%|████████▎ | 813/971 [00:15<00:02, 52.80it/s]backtest loop:  84%|████████▍ | 819/971 [00:15<00:02, 54.11it/s]backtest loop:  85%|████████▍ | 825/971 [00:15<00:02, 55.10it/s]backtest loop:  86%|████████▌ | 831/971 [00:15<00:02, 55.48it/s]backtest loop:  86%|████████▌ | 837/971 [00:15<00:02, 55.65it/s]backtest loop:  87%|████████▋ | 843/971 [00:16<00:02, 52.53it/s]backtest loop:  87%|████████▋ | 849/971 [00:16<00:02, 53.35it/s]backtest loop:  88%|████████▊ | 855/971 [00:16<00:02, 54.53it/s]backtest loop:  89%|████████▊ | 861/971 [00:16<00:01, 55.45it/s]backtest loop:  89%|████████▉ | 867/971 [00:16<00:01, 52.87it/s]backtest loop:  90%|████████▉ | 873/971 [00:16<00:01, 53.63it/s]backtest loop:  91%|█████████ | 879/971 [00:16<00:01, 54.76it/s]backtest loop:  91%|█████████ | 885/971 [00:16<00:01, 54.08it/s]backtest loop:  92%|█████████▏| 891/971 [00:16<00:01, 53.70it/s]backtest loop:  92%|█████████▏| 897/971 [00:17<00:01, 50.14it/s]backtest loop:  93%|█████████▎| 903/971 [00:17<00:01, 50.91it/s]backtest loop:  94%|█████████▎| 909/971 [00:17<00:01, 51.45it/s]backtest loop:  94%|█████████▍| 915/971 [00:17<00:01, 51.94it/s]backtest loop:  95%|█████████▍| 921/971 [00:17<00:01, 49.10it/s]backtest loop:  95%|█████████▌| 927/971 [00:17<00:00, 50.22it/s]backtest loop:  96%|█████████▌| 933/971 [00:17<00:00, 50.97it/s]backtest loop:  97%|█████████▋| 939/971 [00:17<00:00, 51.50it/s]backtest loop:  97%|█████████▋| 945/971 [00:18<00:00, 48.95it/s]backtest loop:  98%|█████████▊| 951/971 [00:18<00:00, 50.15it/s]backtest loop:  99%|█████████▊| 957/971 [00:18<00:00, 51.00it/s]backtest loop:  99%|█████████▉| 963/971 [00:18<00:00, 51.55it/s]backtest loop: 100%|█████████▉| 969/971 [00:18<00:00, 51.73it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 52.31it/s]
[3408179:MainThread](2024-04-25 19:49:10,878) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000555
std                0.006554
annualized_return  0.132138
information_ratio  1.306952
max_drawdown      -0.116121
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000359
std                0.006554
annualized_return  0.085484
information_ratio  0.845421
max_drawdown      -0.119775
[3408179:MainThread](2024-04-25 19:49:10,896) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_MLP_alpha360_horizon1_step20_rankFalse_2024-04-25_19:40:48_online`.
Round 2 Done!
{'1day.excess_return_with_cost.annualized_return': [0.057177137820259884,
                                                    0.08548363170297701],
 '1day.excess_return_with_cost.information_ratio': [0.5708410850384811,
                                                    0.845421016572987],
 '1day.excess_return_with_cost.max_drawdown': [-0.1369210363821404,
                                               -0.11977546407167693],
 'IC': [0.01965990918075504, 0.017473035411976354],
 'ICIR': [0.1335802115342955, 0.11199170785924299],
 'Rank IC': [0.020391620238398377, 0.020504008283316912],
 'Rank ICIR': [0.13725662019635151, 0.12869373013758173],
 'mae': [0.7102560997009277, 0.7094312310218811],
 'mse': [1.0026987791061401, 1.0009208917617798]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3408179:MainThread](2024-04-25 19:49:12,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3408179:MainThread](2024-04-25 19:49:12,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.001
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3408179:MainThread](2024-04-25 19:49:12,141) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3408179:MainThread](2024-04-25 19:49:12,141) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:05<08:15,  5.01s/it]epoch:   2%|▏         | 2/100 [00:09<07:26,  4.56s/it]epoch:   3%|▎         | 3/100 [00:14<07:35,  4.70s/it]epoch:   4%|▍         | 4/100 [00:18<07:29,  4.68s/it]epoch:   5%|▌         | 5/100 [00:23<07:27,  4.72s/it]epoch:   6%|▌         | 6/100 [00:28<07:27,  4.76s/it]epoch:   7%|▋         | 7/100 [00:33<07:30,  4.84s/it]epoch:   8%|▊         | 8/100 [00:37<07:17,  4.75s/it]epoch:   9%|▉         | 9/100 [00:42<07:00,  4.62s/it]epoch:  10%|█         | 10/100 [00:46<06:47,  4.52s/it]epoch:  11%|█         | 11/100 [00:51<06:42,  4.52s/it]epoch:  12%|█▏        | 12/100 [00:55<06:45,  4.60s/it]epoch:  13%|█▎        | 13/100 [01:00<06:40,  4.61s/it]epoch:  14%|█▍        | 14/100 [01:04<06:32,  4.56s/it]epoch:  15%|█▌        | 15/100 [01:09<06:17,  4.45s/it]epoch:  16%|█▌        | 16/100 [01:13<06:17,  4.50s/it]epoch:  17%|█▋        | 17/100 [01:17<06:04,  4.40s/it]epoch:  18%|█▊        | 18/100 [01:22<06:01,  4.41s/it]epoch:  19%|█▉        | 19/100 [01:27<06:06,  4.52s/it]epoch:  20%|██        | 20/100 [01:31<06:08,  4.60s/it]epoch:  21%|██        | 21/100 [01:36<05:55,  4.51s/it]epoch:  22%|██▏       | 22/100 [01:40<05:55,  4.55s/it]epoch:  23%|██▎       | 23/100 [01:45<05:56,  4.64s/it]epoch:  24%|██▍       | 24/100 [01:50<05:58,  4.72s/it]epoch:  25%|██▌       | 25/100 [01:55<05:58,  4.78s/it]epoch:  26%|██▌       | 26/100 [02:00<05:52,  4.76s/it]epoch:  27%|██▋       | 27/100 [02:04<05:42,  4.70s/it]epoch:  28%|██▊       | 28/100 [02:08<05:25,  4.52s/it]epoch:  29%|██▉       | 29/100 [02:13<05:22,  4.55s/it]epoch:  30%|███       | 30/100 [02:18<05:23,  4.62s/it]0.02456615450029569
best ic: 0.02456615450029569
epoch:  31%|███       | 31/100 [02:23<05:37,  4.89s/it]0.02297387717813829
epoch:  32%|███▏      | 32/100 [02:29<05:46,  5.10s/it]0.026017540967513488
best ic: 0.026017540967513488
epoch:  33%|███▎      | 33/100 [02:35<05:52,  5.26s/it]0.024219100094536282
epoch:  34%|███▍      | 34/100 [02:40<05:48,  5.28s/it]0.023402819420799432
epoch:  35%|███▌      | 35/100 [02:45<05:34,  5.15s/it]0.019148247864121497
epoch:  36%|███▌      | 36/100 [02:50<05:28,  5.14s/it]0.024195165117892162
epoch:  37%|███▋      | 37/100 [02:55<05:28,  5.22s/it]0.025672811743209845
epoch:  38%|███▊      | 38/100 [03:01<05:23,  5.22s/it]0.023173657802343182
epoch:  39%|███▉      | 39/100 [03:06<05:15,  5.18s/it]0.023186314160266612
epoch:  40%|████      | 40/100 [03:11<05:12,  5.20s/it]0.0220422175769795
epoch:  40%|████      | 40/100 [03:16<04:55,  4.92s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3408179:MainThread](2024-04-25 19:52:28,860) INFO - qlib.workflow - [exp.py:258] - Experiment 51 starts running ...
[3408179:MainThread](2024-04-25 19:52:28,878) INFO - qlib.workflow - [recorder.py:341] - Recorder 89101d3e36854b94b204ed6a54901013 starts running under Experiment 51 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   5%|▍         | 3/63 [00:00<00:02, 24.23it/s]online:  10%|▉         | 6/63 [00:00<00:02, 24.97it/s]online:  14%|█▍        | 9/63 [00:00<00:02, 25.73it/s]online:  19%|█▉        | 12/63 [00:00<00:02, 25.06it/s]online:  24%|██▍       | 15/63 [00:00<00:01, 25.02it/s]online:  29%|██▊       | 18/63 [00:00<00:01, 24.64it/s]online:  33%|███▎      | 21/63 [00:00<00:01, 24.34it/s]online:  38%|███▊      | 24/63 [00:00<00:01, 24.14it/s]online:  43%|████▎     | 27/63 [00:01<00:01, 24.43it/s]online:  48%|████▊     | 30/63 [00:01<00:01, 24.52it/s]online:  52%|█████▏    | 33/63 [00:01<00:01, 24.52it/s]online:  57%|█████▋    | 36/63 [00:01<00:01, 24.54it/s]online:  62%|██████▏   | 39/63 [00:01<00:00, 24.55it/s]online:  67%|██████▋   | 42/63 [00:01<00:00, 24.93it/s]online:  71%|███████▏  | 45/63 [00:01<00:00, 24.54it/s]online:  76%|███████▌  | 48/63 [00:01<00:00, 24.43it/s]online:  81%|████████  | 51/63 [00:02<00:00, 24.93it/s]online:  86%|████████▌ | 54/63 [00:02<00:00, 24.96it/s]online:  90%|█████████ | 57/63 [00:02<00:00, 24.77it/s]online:  95%|█████████▌| 60/63 [00:02<00:00, 24.67it/s]online: 100%|██████████| 63/63 [00:02<00:00, 25.17it/s]online: 100%|██████████| 63/63 [00:02<00:00, 24.75it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3408179:MainThread](2024-04-25 19:52:38,128) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 1.0006343 mae 0.70950294
{'IC': 0.022471273042633803,
 'ICIR': 0.1499332834341299,
 'Rank IC': 0.02404224943985234,
 'Rank ICIR': 0.16079934584854338}
[3408179:MainThread](2024-04-25 19:52:39,880) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3408179:MainThread](2024-04-25 19:52:51,862) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 19:52:51,866) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 19:52:58,007) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1595319eb0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:40,  9.62it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 24.87it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 35.14it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 39.40it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 44.71it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 48.50it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:19, 47.98it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:18, 50.88it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:17, 52.65it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 50.61it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 52.79it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:16, 53.79it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 55.19it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 55.74it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:16, 53.38it/s]backtest loop:  10%|▉         | 93/971 [00:01<00:16, 54.83it/s]backtest loop:  10%|█         | 99/971 [00:02<00:15, 55.89it/s]backtest loop:  11%|█         | 105/971 [00:02<00:15, 56.45it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:15, 57.00it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:15, 53.70it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:15, 54.94it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:16, 51.99it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:15, 53.36it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:16, 51.31it/s]backtest loop:  15%|█▌        | 147/971 [00:02<00:15, 53.16it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 54.49it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:14, 55.45it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:14, 56.04it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 53.20it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:14, 54.30it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 55.74it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:13, 56.54it/s]backtest loop:  20%|██        | 195/971 [00:03<00:14, 53.43it/s]backtest loop:  21%|██        | 201/971 [00:03<00:14, 54.63it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:13, 55.73it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:14, 53.61it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:13, 54.90it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:14, 52.17it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:13, 53.70it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:13, 54.32it/s]backtest loop:  25%|██▌       | 243/971 [00:04<00:13, 55.44it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:13, 52.60it/s]backtest loop:  26%|██▋       | 255/971 [00:04<00:13, 54.36it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:12, 55.50it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:13, 52.82it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 54.28it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:12, 55.27it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:12, 56.10it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 53.16it/s]backtest loop:  31%|███       | 297/971 [00:05<00:12, 54.56it/s]backtest loop:  31%|███       | 303/971 [00:05<00:11, 55.77it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 56.26it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:12, 53.19it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:12, 53.99it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:11, 55.14it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:11, 56.22it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:11, 56.75it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 53.64it/s]backtest loop:  36%|███▌      | 351/971 [00:06<00:11, 54.76it/s]backtest loop:  37%|███▋      | 357/971 [00:06<00:11, 55.30it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:11, 53.00it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:11, 51.31it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 52.91it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:10, 54.37it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 55.37it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 52.84it/s]backtest loop:  41%|████      | 399/971 [00:07<00:10, 54.22it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:10, 54.87it/s]backtest loop:  42%|████▏     | 411/971 [00:07<00:10, 55.71it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 56.61it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:10, 53.10it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:09, 54.36it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:09, 54.95it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 55.68it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:09, 52.84it/s]backtest loop:  47%|████▋     | 453/971 [00:08<00:09, 53.95it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:09, 54.99it/s]backtest loop:  48%|████▊     | 465/971 [00:08<00:09, 55.76it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:08, 56.31it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 53.65it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:08, 54.74it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:08, 55.32it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:09, 52.74it/s]backtest loop:  52%|█████▏    | 501/971 [00:09<00:08, 53.87it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 51.62it/s]backtest loop:  53%|█████▎    | 513/971 [00:09<00:08, 53.30it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:08, 54.75it/s]backtest loop:  54%|█████▍    | 525/971 [00:09<00:08, 55.52it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 53.01it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:07, 54.32it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:07, 55.21it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 55.83it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 56.21it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 53.27it/s]backtest loop:  58%|█████▊    | 567/971 [00:10<00:07, 54.45it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:07, 55.17it/s]backtest loop:  60%|█████▉    | 579/971 [00:10<00:07, 55.86it/s]backtest loop:  60%|██████    | 585/971 [00:10<00:06, 56.36it/s]backtest loop:  61%|██████    | 591/971 [00:11<00:07, 53.17it/s]backtest loop:  61%|██████▏   | 597/971 [00:11<00:06, 54.41it/s]backtest loop:  62%|██████▏   | 603/971 [00:11<00:06, 55.31it/s]backtest loop:  63%|██████▎   | 609/971 [00:11<00:06, 55.38it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:11, 31.57it/s]backtest loop:  64%|██████▍   | 621/971 [00:11<00:09, 36.01it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:08, 39.88it/s]backtest loop:  65%|██████▌   | 632/971 [00:12<00:08, 41.99it/s]backtest loop:  66%|██████▌   | 638/971 [00:12<00:07, 44.88it/s]backtest loop:  66%|██████▋   | 644/971 [00:12<00:06, 47.12it/s]backtest loop:  67%|██████▋   | 650/971 [00:12<00:06, 45.94it/s]backtest loop:  68%|██████▊   | 656/971 [00:12<00:06, 47.83it/s]backtest loop:  68%|██████▊   | 662/971 [00:12<00:06, 49.30it/s]backtest loop:  69%|██████▉   | 668/971 [00:12<00:06, 50.04it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:06, 47.84it/s]backtest loop:  70%|███████   | 680/971 [00:13<00:05, 49.13it/s]backtest loop:  71%|███████   | 685/971 [00:13<00:05, 49.21it/s]backtest loop:  71%|███████   | 691/971 [00:13<00:05, 50.26it/s]backtest loop:  72%|███████▏  | 697/971 [00:13<00:05, 51.11it/s]backtest loop:  72%|███████▏  | 703/971 [00:13<00:05, 51.73it/s]backtest loop:  73%|███████▎  | 709/971 [00:13<00:05, 49.03it/s]backtest loop:  74%|███████▎  | 715/971 [00:13<00:05, 50.36it/s]backtest loop:  74%|███████▍  | 721/971 [00:13<00:04, 51.00it/s]backtest loop:  75%|███████▍  | 727/971 [00:14<00:04, 51.57it/s]backtest loop:  75%|███████▌  | 733/971 [00:14<00:05, 46.03it/s]backtest loop:  76%|███████▌  | 739/971 [00:14<00:04, 47.86it/s]backtest loop:  77%|███████▋  | 745/971 [00:14<00:04, 49.10it/s]backtest loop:  77%|███████▋  | 750/971 [00:14<00:04, 46.50it/s]backtest loop:  78%|███████▊  | 756/971 [00:14<00:04, 48.12it/s]backtest loop:  78%|███████▊  | 762/971 [00:14<00:04, 49.36it/s]backtest loop:  79%|███████▉  | 768/971 [00:14<00:04, 50.47it/s]backtest loop:  80%|███████▉  | 774/971 [00:14<00:03, 51.12it/s]backtest loop:  80%|████████  | 780/971 [00:15<00:03, 48.47it/s]backtest loop:  81%|████████  | 786/971 [00:15<00:03, 49.68it/s]backtest loop:  82%|████████▏ | 792/971 [00:15<00:03, 50.66it/s]backtest loop:  82%|████████▏ | 798/971 [00:15<00:03, 48.12it/s]backtest loop:  83%|████████▎ | 804/971 [00:15<00:03, 49.39it/s]backtest loop:  83%|████████▎ | 810/971 [00:15<00:03, 50.23it/s]backtest loop:  84%|████████▍ | 816/971 [00:15<00:03, 50.91it/s]backtest loop:  85%|████████▍ | 822/971 [00:15<00:02, 51.49it/s]backtest loop:  85%|████████▌ | 828/971 [00:16<00:02, 48.79it/s]backtest loop:  86%|████████▌ | 833/971 [00:16<00:02, 48.85it/s]backtest loop:  86%|████████▋ | 839/971 [00:16<00:02, 49.97it/s]backtest loop:  87%|████████▋ | 845/971 [00:16<00:02, 50.85it/s]backtest loop:  88%|████████▊ | 851/971 [00:16<00:02, 51.49it/s]backtest loop:  88%|████████▊ | 857/971 [00:16<00:02, 48.52it/s]backtest loop:  89%|████████▉ | 863/971 [00:16<00:02, 49.70it/s]backtest loop:  89%|████████▉ | 869/971 [00:16<00:02, 50.56it/s]backtest loop:  90%|█████████ | 875/971 [00:17<00:01, 50.55it/s]backtest loop:  91%|█████████ | 881/971 [00:17<00:01, 51.20it/s]backtest loop:  91%|█████████▏| 887/971 [00:17<00:01, 48.71it/s]backtest loop:  92%|█████████▏| 892/971 [00:17<00:01, 48.97it/s]backtest loop:  92%|█████████▏| 898/971 [00:17<00:01, 50.08it/s]backtest loop:  93%|█████████▎| 904/971 [00:17<00:01, 50.93it/s]backtest loop:  94%|█████████▎| 910/971 [00:17<00:01, 51.61it/s]backtest loop:  94%|█████████▍| 916/971 [00:17<00:01, 48.90it/s]backtest loop:  95%|█████████▍| 922/971 [00:17<00:00, 49.98it/s]backtest loop:  96%|█████████▌| 928/971 [00:18<00:00, 50.85it/s]backtest loop:  96%|█████████▌| 934/971 [00:18<00:00, 51.40it/s]backtest loop:  97%|█████████▋| 940/971 [00:18<00:00, 48.61it/s]backtest loop:  97%|█████████▋| 946/971 [00:18<00:00, 49.71it/s]backtest loop:  98%|█████████▊| 952/971 [00:18<00:00, 50.75it/s]backtest loop:  99%|█████████▊| 958/971 [00:18<00:00, 51.34it/s]backtest loop:  99%|█████████▉| 964/971 [00:18<00:00, 51.54it/s]backtest loop: 100%|█████████▉| 970/971 [00:18<00:00, 48.84it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 51.28it/s]
[3408179:MainThread](2024-04-25 19:53:17,026) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000542
std                0.006684
annualized_return  0.129099
information_ratio  1.251952
max_drawdown      -0.099571
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000346
std                0.006684
annualized_return  0.082264
information_ratio  0.797827
max_drawdown      -0.103433
[3408179:MainThread](2024-04-25 19:53:17,044) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_MLP_alpha360_horizon1_step20_rankFalse_2024-04-25_19:40:48_online`.
Round 3 Done!
{'1day.excess_return_with_cost.annualized_return': [0.057177137820259884,
                                                    0.08548363170297701,
                                                    0.08226411002449573],
 '1day.excess_return_with_cost.information_ratio': [0.5708410850384811,
                                                    0.845421016572987,
                                                    0.7978274309230767],
 '1day.excess_return_with_cost.max_drawdown': [-0.1369210363821404,
                                               -0.11977546407167693,
                                               -0.1034332552834204],
 'IC': [0.01965990918075504, 0.017473035411976354, 0.022471273042633803],
 'ICIR': [0.1335802115342955, 0.11199170785924299, 0.1499332834341299],
 'Rank IC': [0.020391620238398377, 0.020504008283316912, 0.02404224943985234],
 'Rank ICIR': [0.13725662019635151, 0.12869373013758173, 0.16079934584854338],
 'mae': [0.7102560997009277, 0.7094312310218811, 0.7095029354095459],
 'mse': [1.0026987791061401, 1.0009208917617798, 1.0006343126296997]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3408179:MainThread](2024-04-25 19:53:18,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3408179:MainThread](2024-04-25 19:53:18,285) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.001
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3408179:MainThread](2024-04-25 19:53:18,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3408179:MainThread](2024-04-25 19:53:18,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:05<08:28,  5.14s/it]epoch:   2%|▏         | 2/100 [00:09<08:00,  4.91s/it]epoch:   3%|▎         | 3/100 [00:14<07:57,  4.92s/it]epoch:   4%|▍         | 4/100 [00:19<07:43,  4.83s/it]epoch:   5%|▌         | 5/100 [00:23<07:23,  4.67s/it]epoch:   6%|▌         | 6/100 [00:28<07:24,  4.73s/it]epoch:   7%|▋         | 7/100 [00:34<07:36,  4.91s/it]epoch:   8%|▊         | 8/100 [00:38<07:19,  4.78s/it]epoch:   9%|▉         | 9/100 [00:42<07:06,  4.68s/it]epoch:  10%|█         | 10/100 [00:47<07:08,  4.76s/it]epoch:  11%|█         | 11/100 [00:52<07:10,  4.83s/it]epoch:  12%|█▏        | 12/100 [00:57<07:03,  4.82s/it]epoch:  13%|█▎        | 13/100 [01:02<06:51,  4.73s/it]epoch:  14%|█▍        | 14/100 [01:06<06:32,  4.57s/it]epoch:  15%|█▌        | 15/100 [01:11<06:32,  4.62s/it]epoch:  16%|█▌        | 16/100 [01:15<06:32,  4.67s/it]epoch:  17%|█▋        | 17/100 [01:20<06:19,  4.58s/it]epoch:  18%|█▊        | 18/100 [01:24<06:15,  4.58s/it]epoch:  19%|█▉        | 19/100 [01:29<06:06,  4.53s/it]epoch:  20%|██        | 20/100 [01:34<06:15,  4.70s/it]epoch:  21%|██        | 21/100 [01:38<05:58,  4.54s/it]epoch:  22%|██▏       | 22/100 [01:42<05:47,  4.46s/it]epoch:  23%|██▎       | 23/100 [01:47<05:56,  4.63s/it]epoch:  24%|██▍       | 24/100 [01:52<05:50,  4.61s/it]epoch:  25%|██▌       | 25/100 [01:56<05:39,  4.53s/it]epoch:  26%|██▌       | 26/100 [02:01<05:36,  4.55s/it]epoch:  27%|██▋       | 27/100 [02:05<05:31,  4.54s/it]epoch:  28%|██▊       | 28/100 [02:10<05:32,  4.62s/it]epoch:  29%|██▉       | 29/100 [02:15<05:21,  4.53s/it]epoch:  30%|███       | 30/100 [02:19<05:16,  4.53s/it]0.02327420106943813
best ic: 0.02327420106943813
epoch:  31%|███       | 31/100 [02:24<05:23,  4.69s/it]0.024812979838279372
best ic: 0.024812979838279372
epoch:  32%|███▏      | 32/100 [02:29<05:31,  4.87s/it]0.02522060450643695
best ic: 0.02522060450643695
epoch:  33%|███▎      | 33/100 [02:34<05:30,  4.94s/it]0.028076343889802177
best ic: 0.028076343889802177
epoch:  34%|███▍      | 34/100 [02:40<05:31,  5.02s/it]0.033583944399444524
best ic: 0.033583944399444524
epoch:  35%|███▌      | 35/100 [02:45<05:36,  5.17s/it]0.0251101761220235
epoch:  36%|███▌      | 36/100 [02:50<05:31,  5.18s/it]0.02476755427177927
epoch:  37%|███▋      | 37/100 [02:56<05:34,  5.32s/it]0.032276470606444556
epoch:  38%|███▊      | 38/100 [03:02<05:36,  5.43s/it]0.028848519500020754
epoch:  39%|███▉      | 39/100 [03:07<05:27,  5.38s/it]0.025317022334177517
epoch:  40%|████      | 40/100 [03:12<05:22,  5.38s/it]0.028386307622536442
epoch:  41%|████      | 41/100 [03:18<05:18,  5.40s/it]0.025816360538213807
epoch:  42%|████▏     | 42/100 [03:23<05:12,  5.38s/it]0.02445639893046914
epoch:  42%|████▏     | 42/100 [03:29<04:48,  4.98s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3408179:MainThread](2024-04-25 19:56:47,411) INFO - qlib.workflow - [exp.py:258] - Experiment 51 starts running ...
[3408179:MainThread](2024-04-25 19:56:47,429) INFO - qlib.workflow - [recorder.py:341] - Recorder 84b8bdddce594013b2934e87b4fe7ae0 starts running under Experiment 51 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   5%|▍         | 3/63 [00:00<00:02, 24.48it/s]online:  10%|▉         | 6/63 [00:00<00:02, 25.81it/s]online:  14%|█▍        | 9/63 [00:00<00:02, 25.77it/s]online:  19%|█▉        | 12/63 [00:00<00:02, 25.04it/s]online:  24%|██▍       | 15/63 [00:00<00:01, 25.01it/s]online:  29%|██▊       | 18/63 [00:00<00:01, 25.00it/s]online:  33%|███▎      | 21/63 [00:00<00:01, 24.92it/s]online:  38%|███▊      | 24/63 [00:00<00:01, 24.85it/s]online:  43%|████▎     | 27/63 [00:01<00:01, 25.22it/s]online:  48%|████▊     | 30/63 [00:01<00:01, 24.48it/s]online:  52%|█████▏    | 33/63 [00:01<00:01, 24.22it/s]online:  57%|█████▋    | 36/63 [00:01<00:01, 23.89it/s]online:  62%|██████▏   | 39/63 [00:01<00:00, 24.26it/s]online:  67%|██████▋   | 42/63 [00:01<00:00, 24.49it/s]online:  71%|███████▏  | 45/63 [00:01<00:00, 24.85it/s]online:  76%|███████▌  | 48/63 [00:01<00:00, 24.89it/s]online:  81%|████████  | 51/63 [00:02<00:00, 24.86it/s]online:  86%|████████▌ | 54/63 [00:02<00:00, 24.88it/s]online:  90%|█████████ | 57/63 [00:02<00:00, 25.38it/s]online:  95%|█████████▌| 60/63 [00:02<00:00, 24.92it/s]online: 100%|██████████| 63/63 [00:02<00:00, 25.19it/s]online: 100%|██████████| 63/63 [00:02<00:00, 24.87it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3408179:MainThread](2024-04-25 19:56:56,750) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 1.0026758 mae 0.71018213
{'IC': 0.014764623845075724,
 'ICIR': 0.09867948469078397,
 'Rank IC': 0.015979887830955906,
 'Rank ICIR': 0.10527904193204127}
[3408179:MainThread](2024-04-25 19:56:58,498) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3408179:MainThread](2024-04-25 19:57:10,872) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 19:57:10,875) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 19:57:17,043) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f15863e3d60>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:44,  9.25it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 23.74it/s]backtest loop:   1%|▏         | 14/971 [00:00<00:30, 31.38it/s]backtest loop:   2%|▏         | 20/971 [00:00<00:24, 38.32it/s]backtest loop:   3%|▎         | 25/971 [00:00<00:24, 38.80it/s]backtest loop:   3%|▎         | 30/971 [00:00<00:22, 41.90it/s]backtest loop:   4%|▎         | 35/971 [00:00<00:21, 43.93it/s]backtest loop:   4%|▍         | 41/971 [00:01<00:19, 46.89it/s]backtest loop:   5%|▍         | 46/971 [00:01<00:19, 47.73it/s]backtest loop:   5%|▌         | 52/971 [00:01<00:18, 49.22it/s]backtest loop:   6%|▌         | 58/971 [00:01<00:19, 46.87it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:18, 48.77it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:18, 48.96it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:17, 50.40it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:17, 51.24it/s]backtest loop:   9%|▉         | 87/971 [00:02<00:18, 48.72it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:17, 49.94it/s]backtest loop:  10%|█         | 99/971 [00:02<00:17, 50.85it/s]backtest loop:  11%|█         | 105/971 [00:02<00:16, 51.30it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:16, 51.88it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:17, 48.88it/s]backtest loop:  13%|█▎        | 122/971 [00:02<00:17, 49.04it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:18, 46.33it/s]backtest loop:  14%|█▎        | 133/971 [00:02<00:17, 48.15it/s]backtest loop:  14%|█▍        | 138/971 [00:03<00:17, 48.43it/s]backtest loop:  15%|█▍        | 144/971 [00:03<00:16, 49.75it/s]backtest loop:  15%|█▌        | 149/971 [00:03<00:16, 49.74it/s]backtest loop:  16%|█▌        | 155/971 [00:03<00:16, 50.67it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:16, 48.07it/s]backtest loop:  17%|█▋        | 167/971 [00:03<00:16, 49.50it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:15, 50.31it/s]backtest loop:  18%|█▊        | 179/971 [00:03<00:15, 51.08it/s]backtest loop:  19%|█▉        | 185/971 [00:04<00:16, 48.46it/s]backtest loop:  20%|█▉        | 190/971 [00:04<00:16, 48.76it/s]backtest loop:  20%|██        | 196/971 [00:04<00:15, 50.02it/s]backtest loop:  21%|██        | 202/971 [00:04<00:15, 50.71it/s]backtest loop:  21%|██▏       | 208/971 [00:04<00:14, 51.48it/s]backtest loop:  22%|██▏       | 214/971 [00:04<00:15, 48.97it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:15, 49.19it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:15, 47.28it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:15, 48.72it/s]backtest loop:  24%|██▍       | 237/971 [00:05<00:14, 49.86it/s]backtest loop:  25%|██▌       | 243/971 [00:05<00:14, 50.54it/s]backtest loop:  26%|██▌       | 249/971 [00:05<00:15, 47.92it/s]backtest loop:  26%|██▌       | 254/971 [00:05<00:14, 48.34it/s]backtest loop:  27%|██▋       | 260/971 [00:05<00:14, 49.88it/s]backtest loop:  27%|██▋       | 266/971 [00:05<00:14, 47.81it/s]backtest loop:  28%|██▊       | 272/971 [00:05<00:14, 49.50it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:13, 50.51it/s]backtest loop:  29%|██▉       | 284/971 [00:05<00:13, 51.47it/s]backtest loop:  30%|██▉       | 290/971 [00:06<00:13, 51.83it/s]backtest loop:  30%|███       | 296/971 [00:06<00:13, 49.12it/s]backtest loop:  31%|███       | 302/971 [00:06<00:13, 49.88it/s]backtest loop:  32%|███▏      | 308/971 [00:06<00:13, 50.37it/s]backtest loop:  32%|███▏      | 314/971 [00:06<00:12, 51.06it/s]backtest loop:  33%|███▎      | 320/971 [00:06<00:13, 48.30it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:13, 48.66it/s]backtest loop:  34%|███▍      | 331/971 [00:06<00:12, 49.84it/s]backtest loop:  35%|███▍      | 337/971 [00:07<00:12, 50.65it/s]backtest loop:  35%|███▌      | 343/971 [00:07<00:12, 51.07it/s]backtest loop:  36%|███▌      | 349/971 [00:07<00:12, 51.53it/s]backtest loop:  37%|███▋      | 355/971 [00:07<00:12, 48.94it/s]backtest loop:  37%|███▋      | 361/971 [00:07<00:12, 50.73it/s]backtest loop:  38%|███▊      | 367/971 [00:07<00:12, 47.85it/s]backtest loop:  38%|███▊      | 373/971 [00:07<00:12, 46.48it/s]backtest loop:  39%|███▉      | 378/971 [00:07<00:12, 47.16it/s]backtest loop:  39%|███▉      | 383/971 [00:08<00:12, 47.04it/s]backtest loop:  40%|███▉      | 388/971 [00:08<00:12, 47.71it/s]backtest loop:  40%|████      | 393/971 [00:08<00:12, 48.15it/s]backtest loop:  41%|████      | 398/971 [00:08<00:11, 48.41it/s]backtest loop:  42%|████▏     | 403/971 [00:08<00:11, 48.78it/s]backtest loop:  42%|████▏     | 409/971 [00:08<00:11, 49.90it/s]backtest loop:  43%|████▎     | 414/971 [00:08<00:11, 49.70it/s]backtest loop:  43%|████▎     | 419/971 [00:08<00:11, 49.75it/s]backtest loop:  44%|████▎     | 424/971 [00:08<00:10, 49.78it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:10, 49.44it/s]backtest loop:  45%|████▍     | 434/971 [00:09<00:10, 49.46it/s]backtest loop:  45%|████▌     | 439/971 [00:09<00:10, 49.49it/s]backtest loop:  46%|████▌     | 444/971 [00:09<00:10, 49.36it/s]backtest loop:  46%|████▌     | 449/971 [00:09<00:10, 49.41it/s]backtest loop:  47%|████▋     | 454/971 [00:09<00:10, 49.52it/s]backtest loop:  47%|████▋     | 459/971 [00:09<00:10, 49.58it/s]backtest loop:  48%|████▊     | 464/971 [00:09<00:10, 49.62it/s]backtest loop:  48%|████▊     | 470/971 [00:09<00:09, 50.46it/s]backtest loop:  49%|████▉     | 476/971 [00:09<00:09, 50.74it/s]backtest loop:  50%|████▉     | 482/971 [00:10<00:10, 47.91it/s]backtest loop:  50%|█████     | 487/971 [00:10<00:10, 48.34it/s]backtest loop:  51%|█████     | 492/971 [00:10<00:09, 48.70it/s]backtest loop:  51%|█████▏    | 498/971 [00:10<00:09, 49.81it/s]backtest loop:  52%|█████▏    | 503/971 [00:10<00:09, 49.59it/s]backtest loop:  52%|█████▏    | 508/971 [00:10<00:09, 46.66it/s]backtest loop:  53%|█████▎    | 514/971 [00:10<00:09, 48.43it/s]backtest loop:  54%|█████▎    | 520/971 [00:10<00:09, 49.31it/s]backtest loop:  54%|█████▍    | 525/971 [00:10<00:09, 49.39it/s]backtest loop:  55%|█████▍    | 531/971 [00:11<00:09, 47.22it/s]backtest loop:  55%|█████▌    | 537/971 [00:11<00:08, 48.94it/s]backtest loop:  56%|█████▌    | 543/971 [00:11<00:08, 49.95it/s]backtest loop:  57%|█████▋    | 549/971 [00:11<00:08, 50.64it/s]backtest loop:  57%|█████▋    | 555/971 [00:11<00:08, 51.22it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:08, 48.56it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:08, 49.61it/s]backtest loop:  59%|█████▉    | 572/971 [00:11<00:08, 49.48it/s]backtest loop:  59%|█████▉    | 577/971 [00:11<00:08, 48.44it/s]backtest loop:  60%|█████▉    | 582/971 [00:12<00:08, 48.10it/s]backtest loop:  60%|██████    | 587/971 [00:12<00:08, 47.70it/s]backtest loop:  61%|██████    | 592/971 [00:12<00:07, 47.39it/s]backtest loop:  61%|██████▏   | 597/971 [00:12<00:07, 47.75it/s]backtest loop:  62%|██████▏   | 603/971 [00:12<00:07, 49.29it/s]backtest loop:  63%|██████▎   | 609/971 [00:12<00:07, 50.42it/s]backtest loop:  63%|██████▎   | 615/971 [00:12<00:12, 29.08it/s]backtest loop:  64%|██████▍   | 621/971 [00:13<00:10, 33.73it/s]backtest loop:  65%|██████▍   | 627/971 [00:13<00:09, 37.85it/s]backtest loop:  65%|██████▌   | 633/971 [00:13<00:08, 41.34it/s]backtest loop:  66%|██████▌   | 638/971 [00:13<00:07, 43.27it/s]backtest loop:  66%|██████▋   | 644/971 [00:13<00:07, 45.72it/s]backtest loop:  67%|██████▋   | 650/971 [00:13<00:07, 44.99it/s]backtest loop:  67%|██████▋   | 655/971 [00:13<00:06, 46.07it/s]backtest loop:  68%|██████▊   | 660/971 [00:13<00:06, 47.07it/s]backtest loop:  69%|██████▊   | 666/971 [00:14<00:06, 49.39it/s]backtest loop:  69%|██████▉   | 672/971 [00:14<00:05, 51.43it/s]backtest loop:  70%|██████▉   | 678/971 [00:14<00:05, 52.45it/s]backtest loop:  70%|███████   | 684/971 [00:14<00:05, 50.33it/s]backtest loop:  71%|███████   | 690/971 [00:14<00:05, 52.20it/s]backtest loop:  72%|███████▏  | 696/971 [00:14<00:05, 53.53it/s]backtest loop:  72%|███████▏  | 702/971 [00:14<00:04, 54.67it/s]backtest loop:  73%|███████▎  | 708/971 [00:14<00:04, 55.43it/s]backtest loop:  74%|███████▎  | 714/971 [00:14<00:04, 52.96it/s]backtest loop:  74%|███████▍  | 720/971 [00:15<00:04, 53.83it/s]backtest loop:  75%|███████▍  | 726/971 [00:15<00:04, 54.78it/s]backtest loop:  75%|███████▌  | 732/971 [00:15<00:04, 52.38it/s]backtest loop:  76%|███████▌  | 738/971 [00:15<00:04, 50.38it/s]backtest loop:  77%|███████▋  | 744/971 [00:15<00:04, 52.22it/s]backtest loop:  77%|███████▋  | 750/971 [00:15<00:04, 50.65it/s]backtest loop:  78%|███████▊  | 756/971 [00:15<00:04, 51.96it/s]backtest loop:  78%|███████▊  | 762/971 [00:15<00:03, 53.49it/s]backtest loop:  79%|███████▉  | 768/971 [00:15<00:03, 54.51it/s]backtest loop:  80%|███████▉  | 774/971 [00:16<00:03, 55.64it/s]backtest loop:  80%|████████  | 780/971 [00:16<00:03, 53.01it/s]backtest loop:  81%|████████  | 786/971 [00:16<00:03, 54.68it/s]backtest loop:  82%|████████▏ | 792/971 [00:16<00:03, 55.62it/s]backtest loop:  82%|████████▏ | 798/971 [00:16<00:03, 52.97it/s]backtest loop:  83%|████████▎ | 804/971 [00:16<00:03, 54.28it/s]backtest loop:  83%|████████▎ | 810/971 [00:16<00:02, 55.21it/s]backtest loop:  84%|████████▍ | 816/971 [00:16<00:02, 56.00it/s]backtest loop:  85%|████████▍ | 822/971 [00:16<00:02, 56.59it/s]backtest loop:  85%|████████▌ | 828/971 [00:17<00:02, 53.56it/s]backtest loop:  86%|████████▌ | 834/971 [00:17<00:02, 54.73it/s]backtest loop:  87%|████████▋ | 840/971 [00:17<00:02, 55.62it/s]backtest loop:  87%|████████▋ | 846/971 [00:17<00:02, 56.31it/s]backtest loop:  88%|████████▊ | 852/971 [00:17<00:02, 53.41it/s]backtest loop:  88%|████████▊ | 858/971 [00:17<00:02, 54.60it/s]backtest loop:  89%|████████▉ | 864/971 [00:17<00:01, 55.52it/s]backtest loop:  90%|████████▉ | 870/971 [00:17<00:01, 56.32it/s]backtest loop:  90%|█████████ | 876/971 [00:17<00:01, 56.65it/s]backtest loop:  91%|█████████ | 882/971 [00:17<00:01, 53.61it/s]backtest loop:  91%|█████████▏| 888/971 [00:18<00:01, 54.74it/s]backtest loop:  92%|█████████▏| 894/971 [00:18<00:01, 55.66it/s]backtest loop:  93%|█████████▎| 900/971 [00:18<00:01, 56.36it/s]backtest loop:  93%|█████████▎| 906/971 [00:18<00:01, 56.90it/s]backtest loop:  94%|█████████▍| 912/971 [00:18<00:01, 54.08it/s]backtest loop:  95%|█████████▍| 918/971 [00:18<00:00, 55.13it/s]backtest loop:  95%|█████████▌| 924/971 [00:18<00:00, 55.86it/s]backtest loop:  96%|█████████▌| 930/971 [00:18<00:00, 56.55it/s]backtest loop:  96%|█████████▋| 936/971 [00:18<00:00, 53.52it/s]backtest loop:  97%|█████████▋| 942/971 [00:19<00:00, 54.69it/s]backtest loop:  98%|█████████▊| 948/971 [00:19<00:00, 55.75it/s]backtest loop:  98%|█████████▊| 954/971 [00:19<00:00, 56.71it/s]backtest loop:  99%|█████████▉| 960/971 [00:19<00:00, 53.38it/s]backtest loop:  99%|█████████▉| 966/971 [00:19<00:00, 54.46it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 49.54it/s]
[3408179:MainThread](2024-04-25 19:57:36,725) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000562
std                0.006743
annualized_return  0.133729
information_ratio  1.285614
max_drawdown      -0.112273
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000366
std                0.006743
annualized_return  0.087061
information_ratio  0.836976
max_drawdown      -0.123081
[3408179:MainThread](2024-04-25 19:57:36,744) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_MLP_alpha360_horizon1_step20_rankFalse_2024-04-25_19:40:48_online`.
Round 4 Done!
{'1day.excess_return_with_cost.annualized_return': [0.057177137820259884,
                                                    0.08548363170297701,
                                                    0.08226411002449573,
                                                    0.08706121975225466],
 '1day.excess_return_with_cost.information_ratio': [0.5708410850384811,
                                                    0.845421016572987,
                                                    0.7978274309230767,
                                                    0.8369757920170999],
 '1day.excess_return_with_cost.max_drawdown': [-0.1369210363821404,
                                               -0.11977546407167693,
                                               -0.1034332552834204,
                                               -0.12308119808575027],
 'IC': [0.01965990918075504,
        0.017473035411976354,
        0.022471273042633803,
        0.014764623845075724],
 'ICIR': [0.1335802115342955,
          0.11199170785924299,
          0.1499332834341299,
          0.09867948469078397],
 'Rank IC': [0.020391620238398377,
             0.020504008283316912,
             0.02404224943985234,
             0.015979887830955906],
 'Rank ICIR': [0.13725662019635151,
               0.12869373013758173,
               0.16079934584854338,
               0.10527904193204127],
 'mae': [0.7102560997009277,
         0.7094312310218811,
         0.7095029354095459,
         0.7101821303367615],
 'mse': [1.0026987791061401,
         1.0009208917617798,
         1.0006343126296997,
         1.0026757717132568]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3408179:MainThread](2024-04-25 19:57:37,968) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3408179:MainThread](2024-04-25 19:57:37,968) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.001
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3408179:MainThread](2024-04-25 19:57:37,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3408179:MainThread](2024-04-25 19:57:37,972) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:05<08:40,  5.26s/it]epoch:   2%|▏         | 2/100 [00:09<08:04,  4.94s/it]epoch:   3%|▎         | 3/100 [00:14<07:23,  4.57s/it]epoch:   4%|▍         | 4/100 [00:18<07:16,  4.55s/it]epoch:   5%|▌         | 5/100 [00:23<07:16,  4.60s/it]epoch:   6%|▌         | 6/100 [00:27<07:07,  4.55s/it]epoch:   7%|▋         | 7/100 [00:32<07:11,  4.64s/it]epoch:   8%|▊         | 8/100 [00:37<07:05,  4.62s/it]epoch:   9%|▉         | 9/100 [00:41<06:49,  4.50s/it]epoch:  10%|█         | 10/100 [00:45<06:32,  4.36s/it]epoch:  11%|█         | 11/100 [00:49<06:29,  4.38s/it]epoch:  12%|█▏        | 12/100 [00:54<06:34,  4.49s/it]epoch:  13%|█▎        | 13/100 [00:59<06:32,  4.51s/it]epoch:  14%|█▍        | 14/100 [01:04<06:36,  4.61s/it]epoch:  15%|█▌        | 15/100 [01:08<06:16,  4.43s/it]epoch:  16%|█▌        | 16/100 [01:12<06:06,  4.36s/it]epoch:  17%|█▋        | 17/100 [01:16<06:00,  4.34s/it]epoch:  18%|█▊        | 18/100 [01:21<05:59,  4.39s/it]epoch:  19%|█▉        | 19/100 [01:25<06:03,  4.49s/it]epoch:  20%|██        | 20/100 [01:30<05:57,  4.46s/it]epoch:  21%|██        | 21/100 [01:34<05:44,  4.35s/it]epoch:  22%|██▏       | 22/100 [01:38<05:45,  4.43s/it]epoch:  23%|██▎       | 23/100 [01:42<05:31,  4.30s/it]epoch:  24%|██▍       | 24/100 [01:47<05:30,  4.35s/it]epoch:  25%|██▌       | 25/100 [01:51<05:19,  4.26s/it]epoch:  26%|██▌       | 26/100 [01:56<05:35,  4.54s/it]epoch:  27%|██▋       | 27/100 [02:01<05:42,  4.70s/it]epoch:  28%|██▊       | 28/100 [02:06<05:34,  4.64s/it]epoch:  29%|██▉       | 29/100 [02:10<05:22,  4.54s/it]epoch:  30%|███       | 30/100 [02:15<05:27,  4.68s/it]0.025575462718095226
best ic: 0.025575462718095226
epoch:  31%|███       | 31/100 [02:21<05:45,  5.01s/it]0.02923053181854159
best ic: 0.02923053181854159
epoch:  32%|███▏      | 32/100 [02:26<05:55,  5.23s/it]0.029713863599255753
best ic: 0.029713863599255753
epoch:  33%|███▎      | 33/100 [02:32<05:53,  5.28s/it]0.025609615790463617
epoch:  34%|███▍      | 34/100 [02:37<05:43,  5.20s/it]0.027694986183864546
epoch:  35%|███▌      | 35/100 [02:43<05:47,  5.34s/it]0.0260948193611195
epoch:  36%|███▌      | 36/100 [02:48<05:38,  5.29s/it]0.027215373086499774
epoch:  37%|███▋      | 37/100 [02:53<05:35,  5.32s/it]0.027828210550127408
epoch:  38%|███▊      | 38/100 [02:59<05:31,  5.35s/it]0.03082028478297723
best ic: 0.03082028478297723
epoch:  39%|███▉      | 39/100 [03:03<05:17,  5.21s/it]0.026181317021446916
epoch:  40%|████      | 40/100 [03:08<05:05,  5.09s/it]0.029334847719756887
epoch:  41%|████      | 41/100 [03:14<05:05,  5.18s/it]0.02912438650195587
epoch:  42%|████▏     | 42/100 [03:19<05:08,  5.33s/it]0.03180826538146131
best ic: 0.03180826538146131
epoch:  43%|████▎     | 43/100 [03:25<05:03,  5.32s/it]0.029967618095906024
epoch:  44%|████▍     | 44/100 [03:30<04:58,  5.34s/it]0.02949540256314552
epoch:  45%|████▌     | 45/100 [03:35<04:54,  5.35s/it]0.02880794286580779
epoch:  46%|████▌     | 46/100 [03:41<04:53,  5.44s/it]0.03563265150215798
best ic: 0.03563265150215798
epoch:  47%|████▋     | 47/100 [03:46<04:47,  5.42s/it]0.030642617137890796
epoch:  48%|████▊     | 48/100 [03:52<04:41,  5.42s/it]0.02959131308510279
epoch:  49%|████▉     | 49/100 [03:57<04:31,  5.33s/it]0.03501369736612392
epoch:  50%|█████     | 50/100 [04:03<04:31,  5.43s/it]0.03450654729473489
epoch:  51%|█████     | 51/100 [04:08<04:24,  5.39s/it]0.028051094343302177
epoch:  52%|█████▏    | 52/100 [04:13<04:11,  5.24s/it]0.028342480066675436
epoch:  53%|█████▎    | 53/100 [04:18<04:02,  5.17s/it]0.031847931609791366
epoch:  54%|█████▍    | 54/100 [04:23<03:56,  5.14s/it]0.030461881547504108
epoch:  54%|█████▍    | 54/100 [04:29<03:49,  4.98s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3408179:MainThread](2024-04-25 20:02:07,008) INFO - qlib.workflow - [exp.py:258] - Experiment 51 starts running ...
[3408179:MainThread](2024-04-25 20:02:07,027) INFO - qlib.workflow - [recorder.py:341] - Recorder 37e2f49ddb414143bd199e49966b406f starts running under Experiment 51 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   5%|▍         | 3/63 [00:00<00:02, 23.41it/s]online:  10%|▉         | 6/63 [00:00<00:02, 24.77it/s]online:  14%|█▍        | 9/63 [00:00<00:02, 24.23it/s]online:  19%|█▉        | 12/63 [00:00<00:02, 24.80it/s]online:  24%|██▍       | 15/63 [00:00<00:01, 25.61it/s]online:  29%|██▊       | 18/63 [00:00<00:01, 26.05it/s]online:  33%|███▎      | 21/63 [00:00<00:01, 25.59it/s]online:  38%|███▊      | 24/63 [00:00<00:01, 25.88it/s]online:  43%|████▎     | 27/63 [00:01<00:01, 25.65it/s]online:  48%|████▊     | 30/63 [00:01<00:01, 25.58it/s]online:  52%|█████▏    | 33/63 [00:01<00:01, 26.01it/s]online:  57%|█████▋    | 36/63 [00:01<00:01, 26.74it/s]online:  62%|██████▏   | 39/63 [00:01<00:00, 27.16it/s]online:  67%|██████▋   | 42/63 [00:01<00:00, 27.50it/s]online:  71%|███████▏  | 45/63 [00:01<00:00, 27.69it/s]online:  76%|███████▌  | 48/63 [00:01<00:00, 27.99it/s]online:  81%|████████  | 51/63 [00:01<00:00, 28.18it/s]online:  86%|████████▌ | 54/63 [00:02<00:00, 28.39it/s]online:  90%|█████████ | 57/63 [00:02<00:00, 28.67it/s]online:  95%|█████████▌| 60/63 [00:02<00:00, 28.60it/s]online: 100%|██████████| 63/63 [00:02<00:00, 28.55it/s]online: 100%|██████████| 63/63 [00:02<00:00, 26.89it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3408179:MainThread](2024-04-25 20:02:16,813) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 1.0076842 mae 0.71238947
{'IC': 0.01618276252046565,
 'ICIR': 0.12049670733212928,
 'Rank IC': 0.017656452109903808,
 'Rank ICIR': 0.1321966458897622}
[3408179:MainThread](2024-04-25 20:02:18,616) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3408179:MainThread](2024-04-25 20:02:31,282) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 20:02:31,285) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 20:02:37,495) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f157a5fe820>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:46,  9.07it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 24.01it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 34.00it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 38.41it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 43.87it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 47.73it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:19, 47.39it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:18, 50.33it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:17, 52.56it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 50.90it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 51.99it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:16, 53.91it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 54.92it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 56.06it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:16, 52.77it/s]backtest loop:  10%|▉         | 93/971 [00:01<00:16, 53.85it/s]backtest loop:  10%|█         | 99/971 [00:02<00:15, 54.79it/s]backtest loop:  11%|█         | 105/971 [00:02<00:15, 55.71it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:15, 56.23it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 53.30it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:15, 54.59it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:16, 52.10it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:16, 52.25it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:16, 50.30it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:15, 52.28it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 53.50it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:14, 54.81it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:14, 55.58it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 52.81it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:14, 53.98it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 55.10it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:14, 55.78it/s]backtest loop:  20%|██        | 195/971 [00:03<00:14, 53.13it/s]backtest loop:  21%|██        | 201/971 [00:03<00:14, 54.38it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:13, 55.28it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:14, 52.98it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:13, 54.26it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:14, 52.14it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:13, 53.81it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:13, 54.69it/s]backtest loop:  25%|██▌       | 243/971 [00:04<00:13, 55.66it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:13, 52.30it/s]backtest loop:  26%|██▋       | 255/971 [00:05<00:13, 53.96it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:12, 55.20it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:13, 52.25it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 53.75it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:12, 55.07it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:12, 55.71it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 52.89it/s]backtest loop:  31%|███       | 297/971 [00:05<00:12, 54.06it/s]backtest loop:  31%|███       | 303/971 [00:05<00:12, 55.35it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 55.95it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:12, 53.18it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:11, 54.28it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:11, 55.33it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:11, 55.74it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:11, 56.04it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 52.99it/s]backtest loop:  36%|███▌      | 351/971 [00:06<00:11, 54.62it/s]backtest loop:  37%|███▋      | 357/971 [00:06<00:11, 55.41it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:11, 52.78it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:11, 51.16it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 52.87it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:10, 54.16it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 55.13it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 52.59it/s]backtest loop:  41%|████      | 399/971 [00:07<00:10, 53.87it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:10, 54.57it/s]backtest loop:  42%|████▏     | 411/971 [00:07<00:10, 55.40it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 55.75it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:10, 52.69it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:10, 53.84it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:09, 54.26it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:09, 55.08it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:10, 52.31it/s]backtest loop:  47%|████▋     | 453/971 [00:08<00:09, 53.23it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:09, 54.47it/s]backtest loop:  48%|████▊     | 465/971 [00:08<00:09, 55.25it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:08, 55.62it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 52.89it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:09, 54.01it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:08, 54.89it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:09, 52.34it/s]backtest loop:  52%|█████▏    | 501/971 [00:09<00:08, 53.70it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:09, 51.46it/s]backtest loop:  53%|█████▎    | 513/971 [00:09<00:08, 53.17it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:08, 54.26it/s]backtest loop:  54%|█████▍    | 525/971 [00:09<00:08, 54.98it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 52.28it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:08, 53.86it/s]backtest loop:  56%|█████▌    | 543/971 [00:10<00:07, 54.88it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 55.59it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 55.77it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 52.84it/s]backtest loop:  58%|█████▊    | 567/971 [00:10<00:07, 54.07it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:07, 54.83it/s]backtest loop:  60%|█████▉    | 579/971 [00:10<00:07, 55.52it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:06, 56.16it/s]backtest loop:  61%|██████    | 591/971 [00:11<00:07, 53.08it/s]backtest loop:  61%|██████▏   | 597/971 [00:11<00:06, 54.31it/s]backtest loop:  62%|██████▏   | 603/971 [00:11<00:06, 55.17it/s]backtest loop:  63%|██████▎   | 609/971 [00:11<00:06, 55.64it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:11, 30.92it/s]backtest loop:  64%|██████▍   | 621/971 [00:12<00:09, 35.85it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:08, 39.95it/s]backtest loop:  65%|██████▌   | 633/971 [00:12<00:07, 43.91it/s]backtest loop:  66%|██████▌   | 639/971 [00:12<00:07, 47.39it/s]backtest loop:  66%|██████▋   | 645/971 [00:12<00:06, 47.11it/s]backtest loop:  67%|██████▋   | 651/971 [00:12<00:06, 49.73it/s]backtest loop:  68%|██████▊   | 657/971 [00:12<00:06, 51.82it/s]backtest loop:  68%|██████▊   | 663/971 [00:12<00:05, 53.42it/s]backtest loop:  69%|██████▉   | 669/971 [00:12<00:05, 54.41it/s]backtest loop:  70%|██████▉   | 675/971 [00:13<00:05, 52.14it/s]backtest loop:  70%|███████   | 681/971 [00:13<00:05, 53.53it/s]backtest loop:  71%|███████   | 687/971 [00:13<00:05, 54.51it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:05, 55.44it/s]backtest loop:  72%|███████▏  | 699/971 [00:13<00:05, 52.79it/s]backtest loop:  73%|███████▎  | 705/971 [00:13<00:04, 53.94it/s]backtest loop:  73%|███████▎  | 711/971 [00:13<00:04, 54.77it/s]backtest loop:  74%|███████▍  | 717/971 [00:13<00:04, 55.44it/s]backtest loop:  74%|███████▍  | 723/971 [00:13<00:04, 56.25it/s]backtest loop:  75%|███████▌  | 729/971 [00:14<00:04, 53.22it/s]backtest loop:  76%|███████▌  | 735/971 [00:14<00:04, 51.38it/s]backtest loop:  76%|███████▋  | 741/971 [00:14<00:04, 53.07it/s]backtest loop:  77%|███████▋  | 747/971 [00:14<00:04, 54.73it/s]backtest loop:  78%|███████▊  | 753/971 [00:14<00:04, 51.93it/s]backtest loop:  78%|███████▊  | 759/971 [00:14<00:03, 53.50it/s]backtest loop:  79%|███████▉  | 765/971 [00:14<00:03, 51.62it/s]backtest loop:  79%|███████▉  | 771/971 [00:14<00:03, 53.09it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 54.34it/s]backtest loop:  81%|████████  | 783/971 [00:15<00:03, 52.37it/s]backtest loop:  81%|████████▏ | 789/971 [00:15<00:03, 53.80it/s]backtest loop:  82%|████████▏ | 795/971 [00:15<00:03, 54.73it/s]backtest loop:  82%|████████▏ | 801/971 [00:15<00:03, 55.38it/s]backtest loop:  83%|████████▎ | 807/971 [00:15<00:02, 55.97it/s]backtest loop:  84%|████████▎ | 813/971 [00:15<00:02, 52.72it/s]backtest loop:  84%|████████▍ | 819/971 [00:15<00:02, 54.08it/s]backtest loop:  85%|████████▍ | 825/971 [00:15<00:02, 54.95it/s]backtest loop:  86%|████████▌ | 831/971 [00:15<00:02, 55.55it/s]backtest loop:  86%|████████▌ | 837/971 [00:16<00:02, 56.01it/s]backtest loop:  87%|████████▋ | 843/971 [00:16<00:02, 53.09it/s]backtest loop:  87%|████████▋ | 849/971 [00:16<00:02, 54.24it/s]backtest loop:  88%|████████▊ | 855/971 [00:16<00:02, 55.09it/s]backtest loop:  89%|████████▊ | 861/971 [00:16<00:01, 55.79it/s]backtest loop:  89%|████████▉ | 867/971 [00:16<00:01, 53.01it/s]backtest loop:  90%|████████▉ | 873/971 [00:16<00:01, 53.93it/s]backtest loop:  91%|█████████ | 879/971 [00:16<00:01, 54.93it/s]backtest loop:  91%|█████████ | 885/971 [00:16<00:01, 55.74it/s]backtest loop:  92%|█████████▏| 891/971 [00:16<00:01, 56.27it/s]backtest loop:  92%|█████████▏| 897/971 [00:17<00:01, 52.94it/s]backtest loop:  93%|█████████▎| 903/971 [00:17<00:01, 53.89it/s]backtest loop:  94%|█████████▎| 909/971 [00:17<00:01, 54.77it/s]backtest loop:  94%|█████████▍| 915/971 [00:17<00:01, 55.33it/s]backtest loop:  95%|█████████▍| 921/971 [00:17<00:00, 52.72it/s]backtest loop:  95%|█████████▌| 927/971 [00:17<00:00, 54.29it/s]backtest loop:  96%|█████████▌| 933/971 [00:17<00:00, 55.22it/s]backtest loop:  97%|█████████▋| 939/971 [00:17<00:00, 55.61it/s]backtest loop:  97%|█████████▋| 945/971 [00:18<00:00, 53.16it/s]backtest loop:  98%|█████████▊| 951/971 [00:18<00:00, 54.60it/s]backtest loop:  99%|█████████▊| 957/971 [00:18<00:00, 55.50it/s]backtest loop:  99%|█████████▉| 963/971 [00:18<00:00, 55.85it/s]backtest loop: 100%|█████████▉| 969/971 [00:18<00:00, 56.43it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 52.58it/s]
[3408179:MainThread](2024-04-25 20:02:56,046) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000532
std                0.006198
annualized_return  0.126621
information_ratio  1.324337
max_drawdown      -0.074713
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000337
std                0.006197
annualized_return  0.080131
information_ratio  0.838104
max_drawdown      -0.085101
[3408179:MainThread](2024-04-25 20:02:56,065) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_MLP_alpha360_horizon1_step20_rankFalse_2024-04-25_19:40:48_online`.
Round 5 Done!
{'1day.excess_return_with_cost.annualized_return': [0.057177137820259884,
                                                    0.08548363170297701,
                                                    0.08226411002449573,
                                                    0.08706121975225466,
                                                    0.08013060465524563],
 '1day.excess_return_with_cost.information_ratio': [0.5708410850384811,
                                                    0.845421016572987,
                                                    0.7978274309230767,
                                                    0.8369757920170999,
                                                    0.8381038258157765],
 '1day.excess_return_with_cost.max_drawdown': [-0.1369210363821404,
                                               -0.11977546407167693,
                                               -0.1034332552834204,
                                               -0.12308119808575027,
                                               -0.08510115880048863],
 'IC': [0.01965990918075504,
        0.017473035411976354,
        0.022471273042633803,
        0.014764623845075724,
        0.01618276252046565],
 'ICIR': [0.1335802115342955,
          0.11199170785924299,
          0.1499332834341299,
          0.09867948469078397,
          0.12049670733212928],
 'Rank IC': [0.020391620238398377,
             0.020504008283316912,
             0.02404224943985234,
             0.015979887830955906,
             0.017656452109903808],
 'Rank ICIR': [0.13725662019635151,
               0.12869373013758173,
               0.16079934584854338,
               0.10527904193204127,
               0.1321966458897622],
 'mae': [0.7102560997009277,
         0.7094312310218811,
         0.7095029354095459,
         0.7101821303367615,
         0.7123894691467285],
 'mse': [1.0026987791061401,
         1.0009208917617798,
         1.0006343126296997,
         1.0026757717132568,
         1.0076842308044434]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3408179:MainThread](2024-04-25 20:02:57,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3408179:MainThread](2024-04-25 20:02:57,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.001
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3408179:MainThread](2024-04-25 20:02:57,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3408179:MainThread](2024-04-25 20:02:57,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:04<07:31,  4.56s/it]epoch:   2%|▏         | 2/100 [00:09<07:26,  4.56s/it]epoch:   3%|▎         | 3/100 [00:13<07:36,  4.70s/it]epoch:   4%|▍         | 4/100 [00:18<07:32,  4.71s/it]epoch:   5%|▌         | 5/100 [00:23<07:28,  4.72s/it]epoch:   6%|▌         | 6/100 [00:28<07:23,  4.72s/it]epoch:   7%|▋         | 7/100 [00:32<07:15,  4.69s/it]epoch:   8%|▊         | 8/100 [00:37<07:07,  4.65s/it]epoch:   9%|▉         | 9/100 [00:42<07:04,  4.67s/it]epoch:  10%|█         | 10/100 [00:46<06:57,  4.64s/it]epoch:  11%|█         | 11/100 [00:50<06:39,  4.49s/it]epoch:  12%|█▏        | 12/100 [00:54<06:25,  4.39s/it]epoch:  13%|█▎        | 13/100 [00:59<06:20,  4.37s/it]epoch:  14%|█▍        | 14/100 [01:03<06:24,  4.47s/it]epoch:  15%|█▌        | 15/100 [01:08<06:21,  4.49s/it]epoch:  16%|█▌        | 16/100 [01:13<06:17,  4.50s/it]epoch:  17%|█▋        | 17/100 [01:17<06:05,  4.40s/it]epoch:  18%|█▊        | 18/100 [01:21<06:00,  4.39s/it]epoch:  19%|█▉        | 19/100 [01:26<05:59,  4.44s/it]epoch:  20%|██        | 20/100 [01:31<06:07,  4.59s/it]epoch:  21%|██        | 21/100 [01:35<06:01,  4.57s/it]epoch:  22%|██▏       | 22/100 [01:40<05:56,  4.57s/it]epoch:  23%|██▎       | 23/100 [01:44<05:46,  4.50s/it]epoch:  24%|██▍       | 24/100 [01:48<05:35,  4.41s/it]epoch:  25%|██▌       | 25/100 [01:53<05:32,  4.44s/it]epoch:  26%|██▌       | 26/100 [01:57<05:27,  4.43s/it]epoch:  27%|██▋       | 27/100 [02:02<05:28,  4.50s/it]epoch:  28%|██▊       | 28/100 [02:06<05:25,  4.52s/it]epoch:  29%|██▉       | 29/100 [02:11<05:26,  4.59s/it]epoch:  30%|███       | 30/100 [02:16<05:17,  4.54s/it]0.029629572942147034
best ic: 0.029629572942147034
epoch:  31%|███       | 31/100 [02:21<05:22,  4.67s/it]0.025100368599060997
epoch:  32%|███▏      | 32/100 [02:26<05:28,  4.83s/it]0.02816500249404281
epoch:  33%|███▎      | 33/100 [02:31<05:33,  4.98s/it]0.0212841480522023
epoch:  34%|███▍      | 34/100 [02:37<05:39,  5.14s/it]0.02959361493947953
epoch:  35%|███▌      | 35/100 [02:42<05:35,  5.15s/it]0.030076957134425254
best ic: 0.030076957134425254
epoch:  36%|███▌      | 36/100 [02:47<05:37,  5.27s/it]0.028834531031516394
epoch:  37%|███▋      | 37/100 [02:53<05:37,  5.36s/it]0.03080595166365844
best ic: 0.03080595166365844
epoch:  38%|███▊      | 38/100 [02:58<05:32,  5.37s/it]0.032403846853847146
best ic: 0.032403846853847146
epoch:  39%|███▉      | 39/100 [03:04<05:27,  5.38s/it]0.025436933479299807
epoch:  40%|████      | 40/100 [03:09<05:20,  5.34s/it]0.03109134802548668
epoch:  41%|████      | 41/100 [03:14<05:09,  5.25s/it]0.025270434451746027
epoch:  42%|████▏     | 42/100 [03:19<04:57,  5.12s/it]0.027314765299297435
epoch:  43%|████▎     | 43/100 [03:24<04:45,  5.01s/it]0.03302405343480052
best ic: 0.03302405343480052
epoch:  44%|████▍     | 44/100 [03:28<04:38,  4.98s/it]0.02821544500459411
epoch:  45%|████▌     | 45/100 [03:34<04:40,  5.09s/it]0.025261839201851623
epoch:  46%|████▌     | 46/100 [03:39<04:41,  5.21s/it]0.023215134287680548
epoch:  47%|████▋     | 47/100 [03:45<04:41,  5.31s/it]0.032461190088263626
epoch:  48%|████▊     | 48/100 [03:50<04:37,  5.33s/it]0.0318954630660544
epoch:  49%|████▉     | 49/100 [03:56<04:32,  5.34s/it]0.028389497029986804
epoch:  50%|█████     | 50/100 [04:01<04:25,  5.32s/it]0.026506890355374953
epoch:  51%|█████     | 51/100 [04:06<04:21,  5.33s/it]0.027874470696765345
epoch:  51%|█████     | 51/100 [04:11<04:01,  4.94s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3408179:MainThread](2024-04-25 20:07:09,086) INFO - qlib.workflow - [exp.py:258] - Experiment 51 starts running ...
[3408179:MainThread](2024-04-25 20:07:09,104) INFO - qlib.workflow - [recorder.py:341] - Recorder d5cf4f5998b44b3f98e322edf8bca0df starts running under Experiment 51 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   5%|▍         | 3/63 [00:00<00:02, 22.47it/s]online:  10%|▉         | 6/63 [00:00<00:02, 24.20it/s]online:  14%|█▍        | 9/63 [00:00<00:02, 24.90it/s]online:  19%|█▉        | 12/63 [00:00<00:02, 24.83it/s]online:  24%|██▍       | 15/63 [00:00<00:01, 25.72it/s]online:  29%|██▊       | 18/63 [00:00<00:01, 26.95it/s]online:  33%|███▎      | 21/63 [00:00<00:01, 27.15it/s]online:  38%|███▊      | 24/63 [00:00<00:01, 27.37it/s]online:  43%|████▎     | 27/63 [00:01<00:01, 27.86it/s]online:  48%|████▊     | 30/63 [00:01<00:01, 27.86it/s]online:  52%|█████▏    | 33/63 [00:01<00:01, 27.84it/s]online:  57%|█████▋    | 36/63 [00:01<00:00, 27.49it/s]online:  62%|██████▏   | 39/63 [00:01<00:00, 27.33it/s]online:  67%|██████▋   | 42/63 [00:01<00:00, 27.73it/s]online:  71%|███████▏  | 45/63 [00:01<00:00, 27.96it/s]online:  76%|███████▌  | 48/63 [00:01<00:00, 28.26it/s]online:  81%|████████  | 51/63 [00:01<00:00, 28.37it/s]online:  86%|████████▌ | 54/63 [00:01<00:00, 28.63it/s]online:  90%|█████████ | 57/63 [00:02<00:00, 28.70it/s]online:  95%|█████████▌| 60/63 [00:02<00:00, 28.99it/s]online: 100%|██████████| 63/63 [00:02<00:00, 27.60it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3408179:MainThread](2024-04-25 20:07:18,355) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 1.0052242 mae 0.7115301
{'IC': 0.017526135258189312,
 'ICIR': 0.1254889069438199,
 'Rank IC': 0.017278615004094867,
 'Rank ICIR': 0.1261435732927875}
[3408179:MainThread](2024-04-25 20:07:20,129) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3408179:MainThread](2024-04-25 20:07:32,599) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 20:07:32,604) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 20:07:38,795) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f15873c6fd0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:47,  8.97it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 23.81it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 33.63it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 38.26it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 43.45it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 47.56it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:19, 47.19it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:18, 50.12it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:17, 52.33it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 50.71it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 52.66it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:16, 53.98it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 55.09it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 56.26it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:16, 53.15it/s]backtest loop:  10%|▉         | 93/971 [00:01<00:16, 54.39it/s]backtest loop:  10%|█         | 99/971 [00:02<00:15, 54.89it/s]backtest loop:  11%|█         | 105/971 [00:02<00:15, 55.54it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:16, 53.70it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:17, 49.86it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 50.72it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:17, 48.00it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:16, 49.28it/s]backtest loop:  14%|█▍        | 140/971 [00:02<00:16, 49.13it/s]backtest loop:  15%|█▌        | 146/971 [00:03<00:17, 47.22it/s]backtest loop:  16%|█▌        | 152/971 [00:03<00:16, 48.87it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:16, 50.17it/s]backtest loop:  17%|█▋        | 164/971 [00:03<00:15, 50.93it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:15, 51.47it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:16, 48.50it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:16, 48.87it/s]backtest loop:  19%|█▉        | 187/971 [00:03<00:15, 50.13it/s]backtest loop:  20%|█▉        | 193/971 [00:04<00:15, 50.66it/s]backtest loop:  20%|██        | 199/971 [00:04<00:15, 51.36it/s]backtest loop:  21%|██        | 205/971 [00:04<00:15, 48.33it/s]backtest loop:  22%|██▏       | 211/971 [00:04<00:15, 49.81it/s]backtest loop:  22%|██▏       | 217/971 [00:04<00:15, 47.70it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:15, 49.00it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:14, 50.11it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:15, 47.92it/s]backtest loop:  25%|██▍       | 241/971 [00:04<00:14, 49.25it/s]backtest loop:  25%|██▌       | 247/971 [00:05<00:14, 50.30it/s]backtest loop:  26%|██▌       | 253/971 [00:05<00:14, 51.04it/s]backtest loop:  27%|██▋       | 259/971 [00:05<00:14, 48.40it/s]backtest loop:  27%|██▋       | 265/971 [00:05<00:14, 49.59it/s]backtest loop:  28%|██▊       | 270/971 [00:05<00:14, 49.65it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:14, 47.52it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:14, 48.15it/s]backtest loop:  30%|██▉       | 287/971 [00:05<00:13, 49.56it/s]backtest loop:  30%|███       | 292/971 [00:06<00:13, 49.65it/s]backtest loop:  31%|███       | 297/971 [00:06<00:13, 49.69it/s]backtest loop:  31%|███       | 303/971 [00:06<00:13, 50.60it/s]backtest loop:  32%|███▏      | 309/971 [00:06<00:12, 51.08it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:13, 48.18it/s]backtest loop:  33%|███▎      | 320/971 [00:06<00:13, 48.33it/s]backtest loop:  34%|███▎      | 326/971 [00:06<00:13, 49.58it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:12, 50.60it/s]backtest loop:  35%|███▍      | 338/971 [00:06<00:12, 51.40it/s]backtest loop:  35%|███▌      | 344/971 [00:07<00:12, 51.44it/s]backtest loop:  36%|███▌      | 350/971 [00:07<00:12, 48.76it/s]backtest loop:  37%|███▋      | 356/971 [00:07<00:12, 49.79it/s]backtest loop:  37%|███▋      | 362/971 [00:07<00:11, 51.80it/s]backtest loop:  38%|███▊      | 368/971 [00:07<00:12, 47.68it/s]backtest loop:  39%|███▊      | 374/971 [00:07<00:12, 49.66it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:11, 51.68it/s]backtest loop:  40%|███▉      | 386/971 [00:07<00:10, 53.29it/s]backtest loop:  40%|████      | 392/971 [00:07<00:10, 54.22it/s]backtest loop:  41%|████      | 398/971 [00:08<00:11, 51.95it/s]backtest loop:  42%|████▏     | 404/971 [00:08<00:10, 53.41it/s]backtest loop:  42%|████▏     | 410/971 [00:08<00:10, 54.51it/s]backtest loop:  43%|████▎     | 416/971 [00:08<00:10, 55.24it/s]backtest loop:  43%|████▎     | 422/971 [00:08<00:09, 55.81it/s]backtest loop:  44%|████▍     | 428/971 [00:08<00:10, 52.88it/s]backtest loop:  45%|████▍     | 434/971 [00:08<00:09, 54.07it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:09, 55.00it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:09, 55.66it/s]backtest loop:  47%|████▋     | 452/971 [00:09<00:09, 53.06it/s]backtest loop:  47%|████▋     | 458/971 [00:09<00:09, 53.99it/s]backtest loop:  48%|████▊     | 464/971 [00:09<00:09, 54.89it/s]backtest loop:  48%|████▊     | 470/971 [00:09<00:09, 55.54it/s]backtest loop:  49%|████▉     | 476/971 [00:09<00:08, 55.94it/s]backtest loop:  50%|████▉     | 482/971 [00:09<00:09, 52.96it/s]backtest loop:  50%|█████     | 488/971 [00:09<00:08, 54.41it/s]backtest loop:  51%|█████     | 494/971 [00:09<00:08, 55.00it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 52.39it/s]backtest loop:  52%|█████▏    | 506/971 [00:10<00:08, 54.10it/s]backtest loop:  53%|█████▎    | 512/971 [00:10<00:08, 51.26it/s]backtest loop:  53%|█████▎    | 518/971 [00:10<00:08, 53.23it/s]backtest loop:  54%|█████▍    | 524/971 [00:10<00:08, 54.45it/s]backtest loop:  55%|█████▍    | 530/971 [00:10<00:08, 55.10it/s]backtest loop:  55%|█████▌    | 536/971 [00:10<00:08, 52.66it/s]backtest loop:  56%|█████▌    | 542/971 [00:10<00:07, 53.86it/s]backtest loop:  56%|█████▋    | 548/971 [00:10<00:07, 54.66it/s]backtest loop:  57%|█████▋    | 554/971 [00:10<00:07, 55.44it/s]backtest loop:  58%|█████▊    | 560/971 [00:11<00:07, 55.90it/s]backtest loop:  58%|█████▊    | 566/971 [00:11<00:07, 52.92it/s]backtest loop:  59%|█████▉    | 572/971 [00:11<00:07, 54.10it/s]backtest loop:  60%|█████▉    | 578/971 [00:11<00:07, 54.91it/s]backtest loop:  60%|██████    | 584/971 [00:11<00:06, 55.52it/s]backtest loop:  61%|██████    | 590/971 [00:11<00:06, 56.06it/s]backtest loop:  61%|██████▏   | 596/971 [00:11<00:07, 52.89it/s]backtest loop:  62%|██████▏   | 602/971 [00:11<00:06, 54.09it/s]backtest loop:  63%|██████▎   | 608/971 [00:11<00:06, 54.98it/s]backtest loop:  63%|██████▎   | 614/971 [00:12<00:06, 55.00it/s]backtest loop:  64%|██████▍   | 620/971 [00:12<00:11, 31.01it/s]backtest loop:  64%|██████▍   | 626/971 [00:12<00:09, 36.00it/s]backtest loop:  65%|██████▌   | 632/971 [00:12<00:08, 40.55it/s]backtest loop:  66%|██████▌   | 638/971 [00:12<00:07, 44.47it/s]backtest loop:  66%|██████▋   | 644/971 [00:12<00:06, 47.65it/s]backtest loop:  67%|██████▋   | 650/971 [00:13<00:06, 47.61it/s]backtest loop:  68%|██████▊   | 656/971 [00:13<00:06, 50.13it/s]backtest loop:  68%|██████▊   | 662/971 [00:13<00:05, 51.98it/s]backtest loop:  69%|██████▉   | 668/971 [00:13<00:05, 53.48it/s]backtest loop:  69%|██████▉   | 674/971 [00:13<00:05, 51.55it/s]backtest loop:  70%|███████   | 680/971 [00:13<00:05, 52.98it/s]backtest loop:  71%|███████   | 686/971 [00:13<00:05, 54.04it/s]backtest loop:  71%|███████▏  | 692/971 [00:13<00:05, 54.84it/s]backtest loop:  72%|███████▏  | 698/971 [00:13<00:04, 55.27it/s]backtest loop:  73%|███████▎  | 704/971 [00:13<00:05, 52.64it/s]backtest loop:  73%|███████▎  | 710/971 [00:14<00:04, 54.16it/s]backtest loop:  74%|███████▎  | 716/971 [00:14<00:04, 55.18it/s]backtest loop:  74%|███████▍  | 722/971 [00:14<00:04, 55.64it/s]backtest loop:  75%|███████▍  | 728/971 [00:14<00:04, 56.10it/s]backtest loop:  76%|███████▌  | 734/971 [00:14<00:04, 50.35it/s]backtest loop:  76%|███████▌  | 740/971 [00:14<00:04, 52.15it/s]backtest loop:  77%|███████▋  | 746/971 [00:14<00:04, 53.63it/s]backtest loop:  77%|███████▋  | 752/971 [00:14<00:04, 51.57it/s]backtest loop:  78%|███████▊  | 758/971 [00:15<00:04, 53.00it/s]backtest loop:  79%|███████▊  | 764/971 [00:15<00:03, 54.24it/s]backtest loop:  79%|███████▉  | 770/971 [00:15<00:03, 51.91it/s]backtest loop:  80%|███████▉  | 776/971 [00:15<00:03, 53.35it/s]backtest loop:  81%|████████  | 782/971 [00:15<00:03, 54.45it/s]backtest loop:  81%|████████  | 788/971 [00:15<00:03, 52.17it/s]backtest loop:  82%|████████▏ | 794/971 [00:15<00:03, 53.53it/s]backtest loop:  82%|████████▏ | 800/971 [00:15<00:03, 52.20it/s]backtest loop:  83%|████████▎ | 806/971 [00:15<00:03, 52.31it/s]backtest loop:  84%|████████▎ | 812/971 [00:16<00:03, 52.23it/s]backtest loop:  84%|████████▍ | 818/971 [00:16<00:03, 49.05it/s]backtest loop:  85%|████████▍ | 824/971 [00:16<00:02, 50.03it/s]backtest loop:  85%|████████▌ | 830/971 [00:16<00:02, 50.80it/s]backtest loop:  86%|████████▌ | 836/971 [00:16<00:02, 51.30it/s]backtest loop:  87%|████████▋ | 842/971 [00:16<00:02, 52.97it/s]backtest loop:  87%|████████▋ | 848/971 [00:16<00:02, 51.18it/s]backtest loop:  88%|████████▊ | 854/971 [00:16<00:02, 52.85it/s]backtest loop:  89%|████████▊ | 860/971 [00:16<00:02, 54.14it/s]backtest loop:  89%|████████▉ | 866/971 [00:17<00:01, 55.12it/s]backtest loop:  90%|████████▉ | 872/971 [00:17<00:01, 52.42it/s]backtest loop:  90%|█████████ | 878/971 [00:17<00:01, 53.54it/s]backtest loop:  91%|█████████ | 884/971 [00:17<00:01, 54.56it/s]backtest loop:  92%|█████████▏| 890/971 [00:17<00:01, 55.05it/s]backtest loop:  92%|█████████▏| 896/971 [00:17<00:01, 55.41it/s]backtest loop:  93%|█████████▎| 902/971 [00:17<00:01, 50.78it/s]backtest loop:  94%|█████████▎| 908/971 [00:17<00:01, 51.41it/s]backtest loop:  94%|█████████▍| 914/971 [00:17<00:01, 52.00it/s]backtest loop:  95%|█████████▍| 920/971 [00:18<00:00, 51.69it/s]backtest loop:  95%|█████████▌| 926/971 [00:18<00:00, 48.92it/s]backtest loop:  96%|█████████▌| 932/971 [00:18<00:00, 49.97it/s]backtest loop:  97%|█████████▋| 938/971 [00:18<00:00, 50.48it/s]backtest loop:  97%|█████████▋| 944/971 [00:18<00:00, 51.15it/s]backtest loop:  98%|█████████▊| 950/971 [00:18<00:00, 48.76it/s]backtest loop:  98%|█████████▊| 956/971 [00:18<00:00, 50.06it/s]backtest loop:  99%|█████████▉| 962/971 [00:18<00:00, 50.66it/s]backtest loop: 100%|█████████▉| 968/971 [00:19<00:00, 51.25it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 50.79it/s]
[3408179:MainThread](2024-04-25 20:07:57,997) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000514
std                0.006689
annualized_return  0.122363
information_ratio  1.185825
max_drawdown      -0.083995
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000318
std                0.006689
annualized_return  0.075716
information_ratio  0.733682
max_drawdown      -0.089217
[3408179:MainThread](2024-04-25 20:07:58,016) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_MLP_alpha360_horizon1_step20_rankFalse_2024-04-25_19:40:48_online`.
Round 6 Done!
{'1day.excess_return_with_cost.annualized_return': [0.057177137820259884,
                                                    0.08548363170297701,
                                                    0.08226411002449573,
                                                    0.08706121975225466,
                                                    0.08013060465524563,
                                                    0.07571558432705998],
 '1day.excess_return_with_cost.information_ratio': [0.5708410850384811,
                                                    0.845421016572987,
                                                    0.7978274309230767,
                                                    0.8369757920170999,
                                                    0.8381038258157765,
                                                    0.7336819149814031],
 '1day.excess_return_with_cost.max_drawdown': [-0.1369210363821404,
                                               -0.11977546407167693,
                                               -0.1034332552834204,
                                               -0.12308119808575027,
                                               -0.08510115880048863,
                                               -0.08921683499605616],
 'IC': [0.01965990918075504,
        0.017473035411976354,
        0.022471273042633803,
        0.014764623845075724,
        0.01618276252046565,
        0.017526135258189312],
 'ICIR': [0.1335802115342955,
          0.11199170785924299,
          0.1499332834341299,
          0.09867948469078397,
          0.12049670733212928,
          0.1254889069438199],
 'Rank IC': [0.020391620238398377,
             0.020504008283316912,
             0.02404224943985234,
             0.015979887830955906,
             0.017656452109903808,
             0.017278615004094867],
 'Rank ICIR': [0.13725662019635151,
               0.12869373013758173,
               0.16079934584854338,
               0.10527904193204127,
               0.1321966458897622,
               0.1261435732927875],
 'mae': [0.7102560997009277,
         0.7094312310218811,
         0.7095029354095459,
         0.7101821303367615,
         0.7123894691467285,
         0.7115300893783569],
 'mse': [1.0026987791061401,
         1.0009208917617798,
         1.0006343126296997,
         1.0026757717132568,
         1.0076842308044434,
         1.0052242279052734]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3408179:MainThread](2024-04-25 20:07:59,251) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3408179:MainThread](2024-04-25 20:07:59,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.001
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3408179:MainThread](2024-04-25 20:07:59,255) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3408179:MainThread](2024-04-25 20:07:59,255) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:05<08:32,  5.17s/it]epoch:   2%|▏         | 2/100 [00:09<07:50,  4.80s/it]epoch:   3%|▎         | 3/100 [00:14<07:30,  4.64s/it]epoch:   4%|▍         | 4/100 [00:18<07:13,  4.52s/it]epoch:   5%|▌         | 5/100 [00:23<07:15,  4.58s/it]epoch:   6%|▌         | 6/100 [00:27<07:12,  4.60s/it]epoch:   7%|▋         | 7/100 [00:32<06:55,  4.46s/it]epoch:   8%|▊         | 8/100 [00:36<06:57,  4.54s/it]epoch:   9%|▉         | 9/100 [00:41<06:48,  4.49s/it]epoch:  10%|█         | 10/100 [00:45<06:37,  4.41s/it]epoch:  11%|█         | 11/100 [00:49<06:39,  4.49s/it]epoch:  12%|█▏        | 12/100 [00:54<06:40,  4.56s/it]epoch:  13%|█▎        | 13/100 [00:59<06:45,  4.66s/it]epoch:  14%|█▍        | 14/100 [01:04<06:39,  4.65s/it]epoch:  15%|█▌        | 15/100 [01:08<06:33,  4.63s/it]epoch:  16%|█▌        | 16/100 [01:12<06:13,  4.45s/it]epoch:  17%|█▋        | 17/100 [01:17<06:08,  4.44s/it]epoch:  18%|█▊        | 18/100 [01:21<06:10,  4.52s/it]epoch:  19%|█▉        | 19/100 [01:26<06:10,  4.58s/it]epoch:  20%|██        | 20/100 [01:31<06:10,  4.63s/it]epoch:  21%|██        | 21/100 [01:35<06:01,  4.57s/it]epoch:  22%|██▏       | 22/100 [01:39<05:45,  4.43s/it]epoch:  23%|██▎       | 23/100 [01:44<05:45,  4.49s/it]epoch:  24%|██▍       | 24/100 [01:49<05:46,  4.56s/it]epoch:  25%|██▌       | 25/100 [01:54<05:49,  4.66s/it]epoch:  26%|██▌       | 26/100 [01:58<05:46,  4.68s/it]epoch:  27%|██▋       | 27/100 [02:03<05:30,  4.53s/it]epoch:  28%|██▊       | 28/100 [02:07<05:15,  4.39s/it]epoch:  29%|██▉       | 29/100 [02:11<05:17,  4.47s/it]epoch:  30%|███       | 30/100 [02:16<05:23,  4.62s/it]0.02751719024551978
best ic: 0.02751719024551978
epoch:  31%|███       | 31/100 [02:21<05:29,  4.78s/it]0.035100071666543047
best ic: 0.035100071666543047
epoch:  32%|███▏      | 32/100 [02:27<05:49,  5.13s/it]0.03350637730886199
epoch:  33%|███▎      | 33/100 [02:33<05:57,  5.33s/it]0.029702761805716852
epoch:  34%|███▍      | 34/100 [02:39<05:59,  5.45s/it]0.022059024120022766
epoch:  35%|███▌      | 35/100 [02:45<05:59,  5.54s/it]0.032739703418254905
epoch:  36%|███▌      | 36/100 [02:50<05:51,  5.49s/it]0.027450253699662894
epoch:  37%|███▋      | 37/100 [02:55<05:44,  5.47s/it]0.029306477365363133
epoch:  38%|███▊      | 38/100 [03:01<05:38,  5.47s/it]0.03197538722304909
epoch:  39%|███▉      | 39/100 [03:07<05:36,  5.51s/it]0.03340923337634265
epoch:  39%|███▉      | 39/100 [03:12<05:00,  4.93s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3408179:MainThread](2024-04-25 20:11:11,646) INFO - qlib.workflow - [exp.py:258] - Experiment 51 starts running ...
[3408179:MainThread](2024-04-25 20:11:11,665) INFO - qlib.workflow - [recorder.py:341] - Recorder 177f81e08edf4d3eb94c06f03dbd3cb5 starts running under Experiment 51 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   5%|▍         | 3/63 [00:00<00:02, 21.27it/s]online:  10%|▉         | 6/63 [00:00<00:02, 22.95it/s]online:  14%|█▍        | 9/63 [00:00<00:02, 23.49it/s]online:  19%|█▉        | 12/63 [00:00<00:02, 24.12it/s]online:  24%|██▍       | 15/63 [00:00<00:01, 24.25it/s]online:  29%|██▊       | 18/63 [00:00<00:01, 24.45it/s]online:  33%|███▎      | 21/63 [00:00<00:01, 24.82it/s]online:  38%|███▊      | 24/63 [00:00<00:01, 24.85it/s]online:  43%|████▎     | 27/63 [00:01<00:01, 24.88it/s]online:  48%|████▊     | 30/63 [00:01<00:01, 24.95it/s]online:  52%|█████▏    | 33/63 [00:01<00:01, 25.12it/s]online:  57%|█████▋    | 36/63 [00:01<00:01, 25.11it/s]online:  62%|██████▏   | 39/63 [00:01<00:00, 25.24it/s]online:  67%|██████▋   | 42/63 [00:01<00:00, 25.51it/s]online:  71%|███████▏  | 45/63 [00:01<00:00, 25.31it/s]online:  76%|███████▌  | 48/63 [00:01<00:00, 25.21it/s]online:  81%|████████  | 51/63 [00:02<00:00, 25.41it/s]online:  86%|████████▌ | 54/63 [00:02<00:00, 25.12it/s]online:  90%|█████████ | 57/63 [00:02<00:00, 24.21it/s]online:  95%|█████████▌| 60/63 [00:02<00:00, 23.48it/s]online: 100%|██████████| 63/63 [00:02<00:00, 24.17it/s]online: 100%|██████████| 63/63 [00:02<00:00, 24.57it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3408179:MainThread](2024-04-25 20:11:21,545) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 1.0013188 mae 0.7095363
{'IC': 0.01968359506459353,
 'ICIR': 0.13207641436532627,
 'Rank IC': 0.020537665285686294,
 'Rank ICIR': 0.13624013905361673}
[3408179:MainThread](2024-04-25 20:11:23,405) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3408179:MainThread](2024-04-25 20:11:36,073) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 20:11:36,076) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 20:11:42,332) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f159484b250>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:50,  8.77it/s]backtest loop:   1%|          | 8/971 [00:00<00:46, 20.91it/s]backtest loop:   1%|▏         | 13/971 [00:00<00:32, 29.41it/s]backtest loop:   2%|▏         | 19/971 [00:00<00:25, 36.87it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:25, 37.80it/s]backtest loop:   3%|▎         | 30/971 [00:00<00:22, 42.22it/s]backtest loop:   4%|▎         | 35/971 [00:01<00:21, 44.05it/s]backtest loop:   4%|▍         | 41/971 [00:01<00:19, 46.62it/s]backtest loop:   5%|▍         | 46/971 [00:01<00:19, 47.51it/s]backtest loop:   5%|▌         | 52/971 [00:01<00:18, 49.13it/s]backtest loop:   6%|▌         | 58/971 [00:01<00:19, 46.86it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:18, 48.75it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:18, 48.97it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:17, 50.37it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:17, 50.99it/s]backtest loop:   9%|▉         | 87/971 [00:02<00:18, 48.49it/s]backtest loop:   9%|▉         | 92/971 [00:02<00:17, 48.84it/s]backtest loop:  10%|█         | 98/971 [00:02<00:17, 50.05it/s]backtest loop:  11%|█         | 104/971 [00:02<00:17, 50.71it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:16, 51.50it/s]backtest loop:  12%|█▏        | 116/971 [00:02<00:16, 51.75it/s]backtest loop:  13%|█▎        | 122/971 [00:02<00:17, 48.81it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:18, 46.14it/s]backtest loop:  14%|█▎        | 133/971 [00:02<00:17, 47.70it/s]backtest loop:  14%|█▍        | 139/971 [00:03<00:16, 49.11it/s]backtest loop:  15%|█▍        | 145/971 [00:03<00:16, 50.31it/s]backtest loop:  16%|█▌        | 151/971 [00:03<00:17, 47.93it/s]backtest loop:  16%|█▌        | 157/971 [00:03<00:16, 49.45it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:16, 50.27it/s]backtest loop:  17%|█▋        | 169/971 [00:03<00:15, 51.00it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:15, 51.37it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:16, 48.80it/s]backtest loop:  19%|█▉        | 187/971 [00:04<00:15, 49.92it/s]backtest loop:  20%|█▉        | 193/971 [00:04<00:15, 50.61it/s]backtest loop:  20%|██        | 199/971 [00:04<00:15, 51.40it/s]backtest loop:  21%|██        | 205/971 [00:04<00:15, 48.69it/s]backtest loop:  22%|██▏       | 211/971 [00:04<00:15, 49.83it/s]backtest loop:  22%|██▏       | 217/971 [00:04<00:15, 47.73it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:15, 49.01it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:14, 49.97it/s]backtest loop:  24%|██▍       | 235/971 [00:05<00:15, 47.85it/s]backtest loop:  25%|██▍       | 240/971 [00:05<00:15, 48.36it/s]backtest loop:  25%|██▌       | 246/971 [00:05<00:14, 49.62it/s]backtest loop:  26%|██▌       | 251/971 [00:05<00:14, 49.60it/s]backtest loop:  26%|██▋       | 257/971 [00:05<00:14, 50.76it/s]backtest loop:  27%|██▋       | 263/971 [00:05<00:13, 51.31it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:14, 48.64it/s]backtest loop:  28%|██▊       | 275/971 [00:05<00:13, 49.74it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:14, 47.62it/s]backtest loop:  30%|██▉       | 287/971 [00:06<00:13, 49.03it/s]backtest loop:  30%|███       | 292/971 [00:06<00:13, 49.13it/s]backtest loop:  31%|███       | 298/971 [00:06<00:13, 50.30it/s]backtest loop:  31%|███▏      | 304/971 [00:06<00:13, 50.50it/s]backtest loop:  32%|███▏      | 310/971 [00:06<00:13, 48.04it/s]backtest loop:  33%|███▎      | 316/971 [00:06<00:13, 48.94it/s]backtest loop:  33%|███▎      | 322/971 [00:06<00:12, 49.92it/s]backtest loop:  34%|███▍      | 328/971 [00:06<00:12, 50.96it/s]backtest loop:  34%|███▍      | 334/971 [00:07<00:12, 51.31it/s]backtest loop:  35%|███▌      | 340/971 [00:07<00:12, 48.77it/s]backtest loop:  36%|███▌      | 345/971 [00:07<00:12, 48.97it/s]backtest loop:  36%|███▌      | 351/971 [00:07<00:12, 50.25it/s]backtest loop:  37%|███▋      | 357/971 [00:07<00:12, 51.09it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:12, 48.48it/s]backtest loop:  38%|███▊      | 368/971 [00:07<00:13, 46.15it/s]backtest loop:  39%|███▊      | 374/971 [00:07<00:12, 47.94it/s]backtest loop:  39%|███▉      | 379/971 [00:07<00:12, 48.30it/s]backtest loop:  40%|███▉      | 385/971 [00:08<00:11, 49.68it/s]backtest loop:  40%|████      | 391/971 [00:08<00:11, 50.54it/s]backtest loop:  41%|████      | 397/971 [00:08<00:11, 50.93it/s]backtest loop:  42%|████▏     | 403/971 [00:08<00:11, 48.33it/s]backtest loop:  42%|████▏     | 409/971 [00:08<00:11, 49.49it/s]backtest loop:  43%|████▎     | 415/971 [00:08<00:11, 50.20it/s]backtest loop:  43%|████▎     | 421/971 [00:08<00:10, 50.88it/s]backtest loop:  44%|████▍     | 427/971 [00:08<00:10, 51.17it/s]backtest loop:  45%|████▍     | 433/971 [00:09<00:11, 48.44it/s]backtest loop:  45%|████▌     | 439/971 [00:09<00:10, 49.59it/s]backtest loop:  46%|████▌     | 444/971 [00:09<00:10, 49.56it/s]backtest loop:  46%|████▋     | 450/971 [00:09<00:10, 50.43it/s]backtest loop:  47%|████▋     | 456/971 [00:09<00:10, 50.99it/s]backtest loop:  48%|████▊     | 462/971 [00:09<00:10, 48.34it/s]backtest loop:  48%|████▊     | 467/971 [00:09<00:10, 48.74it/s]backtest loop:  49%|████▊     | 472/971 [00:09<00:10, 48.92it/s]backtest loop:  49%|████▉     | 478/971 [00:09<00:09, 49.96it/s]backtest loop:  50%|████▉     | 484/971 [00:10<00:09, 50.65it/s]backtest loop:  50%|█████     | 490/971 [00:10<00:10, 47.91it/s]backtest loop:  51%|█████     | 496/971 [00:10<00:09, 49.22it/s]backtest loop:  52%|█████▏    | 502/971 [00:10<00:09, 49.84it/s]backtest loop:  52%|█████▏    | 508/971 [00:10<00:09, 47.56it/s]backtest loop:  53%|█████▎    | 514/971 [00:10<00:09, 49.02it/s]backtest loop:  54%|█████▎    | 520/971 [00:10<00:09, 49.79it/s]backtest loop:  54%|█████▍    | 526/971 [00:10<00:09, 47.63it/s]backtest loop:  55%|█████▍    | 532/971 [00:11<00:08, 49.31it/s]backtest loop:  55%|█████▌    | 538/971 [00:11<00:08, 50.45it/s]backtest loop:  56%|█████▌    | 544/971 [00:11<00:08, 50.89it/s]backtest loop:  57%|█████▋    | 550/971 [00:11<00:08, 51.34it/s]backtest loop:  57%|█████▋    | 556/971 [00:11<00:13, 29.68it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:12, 33.22it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:10, 38.10it/s]backtest loop:  59%|█████▉    | 573/971 [00:12<00:09, 42.49it/s]backtest loop:  60%|█████▉    | 579/971 [00:12<00:08, 46.28it/s]backtest loop:  60%|██████    | 585/971 [00:12<00:07, 48.76it/s]backtest loop:  61%|██████    | 591/971 [00:12<00:07, 48.15it/s]backtest loop:  61%|██████▏   | 597/971 [00:12<00:07, 50.61it/s]backtest loop:  62%|██████▏   | 603/971 [00:12<00:07, 52.50it/s]backtest loop:  63%|██████▎   | 609/971 [00:12<00:06, 53.67it/s]backtest loop:  63%|██████▎   | 615/971 [00:12<00:06, 51.71it/s]backtest loop:  64%|██████▍   | 621/971 [00:12<00:06, 53.17it/s]backtest loop:  65%|██████▍   | 627/971 [00:13<00:06, 54.12it/s]backtest loop:  65%|██████▌   | 633/971 [00:13<00:06, 54.89it/s]backtest loop:  66%|██████▌   | 639/971 [00:13<00:05, 55.74it/s]backtest loop:  66%|██████▋   | 645/971 [00:13<00:06, 52.69it/s]backtest loop:  67%|██████▋   | 651/971 [00:13<00:05, 53.85it/s]backtest loop:  68%|██████▊   | 657/971 [00:13<00:05, 54.87it/s]backtest loop:  68%|██████▊   | 663/971 [00:13<00:05, 55.49it/s]backtest loop:  69%|██████▉   | 669/971 [00:13<00:05, 55.58it/s]backtest loop:  70%|██████▉   | 675/971 [00:13<00:05, 52.56it/s]backtest loop:  70%|███████   | 681/971 [00:14<00:05, 51.67it/s]backtest loop:  71%|███████   | 687/971 [00:14<00:05, 51.75it/s]backtest loop:  71%|███████▏  | 693/971 [00:14<00:05, 51.97it/s]backtest loop:  72%|███████▏  | 699/971 [00:14<00:05, 49.05it/s]backtest loop:  73%|███████▎  | 705/971 [00:14<00:05, 49.96it/s]backtest loop:  73%|███████▎  | 711/971 [00:14<00:05, 50.76it/s]backtest loop:  74%|███████▍  | 717/971 [00:14<00:04, 51.20it/s]backtest loop:  74%|███████▍  | 723/971 [00:14<00:04, 51.32it/s]backtest loop:  75%|███████▌  | 729/971 [00:15<00:04, 48.66it/s]backtest loop:  76%|███████▌  | 734/971 [00:15<00:05, 46.18it/s]backtest loop:  76%|███████▌  | 739/971 [00:15<00:04, 46.90it/s]backtest loop:  77%|███████▋  | 745/971 [00:15<00:04, 48.64it/s]backtest loop:  77%|███████▋  | 750/971 [00:15<00:04, 46.11it/s]backtest loop:  78%|███████▊  | 756/971 [00:15<00:04, 48.04it/s]backtest loop:  78%|███████▊  | 761/971 [00:15<00:04, 48.11it/s]backtest loop:  79%|███████▉  | 766/971 [00:15<00:04, 48.18it/s]backtest loop:  80%|███████▉  | 772/971 [00:15<00:03, 50.83it/s]backtest loop:  80%|████████  | 778/971 [00:16<00:03, 52.69it/s]backtest loop:  81%|████████  | 784/971 [00:16<00:03, 50.54it/s]backtest loop:  81%|████████▏ | 790/971 [00:16<00:03, 52.60it/s]backtest loop:  82%|████████▏ | 796/971 [00:16<00:03, 53.97it/s]backtest loop:  83%|████████▎ | 802/971 [00:16<00:03, 54.87it/s]backtest loop:  83%|████████▎ | 808/971 [00:16<00:03, 52.15it/s]backtest loop:  84%|████████▍ | 814/971 [00:16<00:02, 53.43it/s]backtest loop:  84%|████████▍ | 820/971 [00:16<00:02, 54.60it/s]backtest loop:  85%|████████▌ | 826/971 [00:16<00:02, 55.41it/s]backtest loop:  86%|████████▌ | 832/971 [00:17<00:02, 55.93it/s]backtest loop:  86%|████████▋ | 838/971 [00:17<00:02, 52.99it/s]backtest loop:  87%|████████▋ | 844/971 [00:17<00:02, 54.13it/s]backtest loop:  88%|████████▊ | 850/971 [00:17<00:02, 54.86it/s]backtest loop:  88%|████████▊ | 856/971 [00:17<00:02, 55.19it/s]backtest loop:  89%|████████▉ | 862/971 [00:17<00:02, 52.54it/s]backtest loop:  89%|████████▉ | 868/971 [00:17<00:01, 53.87it/s]backtest loop:  90%|█████████ | 874/971 [00:17<00:01, 54.78it/s]backtest loop:  91%|█████████ | 880/971 [00:17<00:01, 55.21it/s]backtest loop:  91%|█████████ | 886/971 [00:18<00:01, 55.80it/s]backtest loop:  92%|█████████▏| 892/971 [00:18<00:01, 52.91it/s]backtest loop:  92%|█████████▏| 898/971 [00:18<00:01, 54.17it/s]backtest loop:  93%|█████████▎| 904/971 [00:18<00:01, 54.93it/s]backtest loop:  94%|█████████▎| 910/971 [00:18<00:01, 55.77it/s]backtest loop:  94%|█████████▍| 916/971 [00:18<00:01, 52.94it/s]backtest loop:  95%|█████████▍| 922/971 [00:18<00:00, 54.08it/s]backtest loop:  96%|█████████▌| 928/971 [00:18<00:00, 54.80it/s]backtest loop:  96%|█████████▌| 934/971 [00:18<00:00, 55.41it/s]backtest loop:  97%|█████████▋| 940/971 [00:19<00:00, 52.50it/s]backtest loop:  97%|█████████▋| 946/971 [00:19<00:00, 53.80it/s]backtest loop:  98%|█████████▊| 952/971 [00:19<00:00, 54.80it/s]backtest loop:  99%|█████████▊| 958/971 [00:19<00:00, 55.61it/s]backtest loop:  99%|█████████▉| 964/971 [00:19<00:00, 56.13it/s]backtest loop: 100%|█████████▉| 970/971 [00:19<00:00, 53.07it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 49.49it/s]
[3408179:MainThread](2024-04-25 20:12:02,034) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000517
std                0.006475
annualized_return  0.123064
information_ratio  1.231914
max_drawdown      -0.096075
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000321
std                0.006476
annualized_return  0.076283
information_ratio  0.763557
max_drawdown      -0.116584
[3408179:MainThread](2024-04-25 20:12:02,053) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_MLP_alpha360_horizon1_step20_rankFalse_2024-04-25_19:40:48_online`.
Round 7 Done!
{'1day.excess_return_with_cost.annualized_return': [0.057177137820259884,
                                                    0.08548363170297701,
                                                    0.08226411002449573,
                                                    0.08706121975225466,
                                                    0.08013060465524563,
                                                    0.07571558432705998,
                                                    0.07628304739056636],
 '1day.excess_return_with_cost.information_ratio': [0.5708410850384811,
                                                    0.845421016572987,
                                                    0.7978274309230767,
                                                    0.8369757920170999,
                                                    0.8381038258157765,
                                                    0.7336819149814031,
                                                    0.7635567445621011],
 '1day.excess_return_with_cost.max_drawdown': [-0.1369210363821404,
                                               -0.11977546407167693,
                                               -0.1034332552834204,
                                               -0.12308119808575027,
                                               -0.08510115880048863,
                                               -0.08921683499605616,
                                               -0.11658439508297297],
 'IC': [0.01965990918075504,
        0.017473035411976354,
        0.022471273042633803,
        0.014764623845075724,
        0.01618276252046565,
        0.017526135258189312,
        0.01968359506459353],
 'ICIR': [0.1335802115342955,
          0.11199170785924299,
          0.1499332834341299,
          0.09867948469078397,
          0.12049670733212928,
          0.1254889069438199,
          0.13207641436532627],
 'Rank IC': [0.020391620238398377,
             0.020504008283316912,
             0.02404224943985234,
             0.015979887830955906,
             0.017656452109903808,
             0.017278615004094867,
             0.020537665285686294],
 'Rank ICIR': [0.13725662019635151,
               0.12869373013758173,
               0.16079934584854338,
               0.10527904193204127,
               0.1321966458897622,
               0.1261435732927875,
               0.13624013905361673],
 'mae': [0.7102560997009277,
         0.7094312310218811,
         0.7095029354095459,
         0.7101821303367615,
         0.7123894691467285,
         0.7115300893783569,
         0.7095363140106201],
 'mse': [1.0026987791061401,
         1.0009208917617798,
         1.0006343126296997,
         1.0026757717132568,
         1.0076842308044434,
         1.0052242279052734,
         1.0013188123703003]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3408179:MainThread](2024-04-25 20:12:03,309) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3408179:MainThread](2024-04-25 20:12:03,310) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.001
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3408179:MainThread](2024-04-25 20:12:03,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3408179:MainThread](2024-04-25 20:12:03,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:04<07:23,  4.48s/it]epoch:   2%|▏         | 2/100 [00:09<07:27,  4.57s/it]epoch:   3%|▎         | 3/100 [00:13<07:23,  4.58s/it]epoch:   4%|▍         | 4/100 [00:18<07:20,  4.59s/it]epoch:   5%|▌         | 5/100 [00:22<07:03,  4.46s/it]epoch:   6%|▌         | 6/100 [00:27<07:16,  4.64s/it]epoch:   7%|▋         | 7/100 [00:32<07:23,  4.77s/it]epoch:   8%|▊         | 8/100 [00:36<07:09,  4.66s/it]epoch:   9%|▉         | 9/100 [00:41<07:01,  4.63s/it]epoch:  10%|█         | 10/100 [00:46<06:56,  4.63s/it]epoch:  11%|█         | 11/100 [00:50<06:46,  4.57s/it]epoch:  12%|█▏        | 12/100 [00:55<06:51,  4.68s/it]epoch:  13%|█▎        | 13/100 [01:00<06:56,  4.79s/it]epoch:  14%|█▍        | 14/100 [01:05<06:47,  4.74s/it]epoch:  15%|█▌        | 15/100 [01:09<06:30,  4.60s/it]epoch:  16%|█▌        | 16/100 [01:13<06:21,  4.54s/it]epoch:  17%|█▋        | 17/100 [01:18<06:22,  4.60s/it]epoch:  18%|█▊        | 18/100 [01:23<06:17,  4.60s/it]epoch:  19%|█▉        | 19/100 [01:27<06:09,  4.56s/it]epoch:  20%|██        | 20/100 [01:32<06:03,  4.54s/it]epoch:  21%|██        | 21/100 [01:36<06:01,  4.57s/it]epoch:  22%|██▏       | 22/100 [01:41<05:53,  4.53s/it]epoch:  23%|██▎       | 23/100 [01:46<05:54,  4.60s/it]epoch:  24%|██▍       | 24/100 [01:50<05:44,  4.54s/it]epoch:  25%|██▌       | 25/100 [01:55<05:44,  4.59s/it]epoch:  26%|██▌       | 26/100 [01:59<05:32,  4.49s/it]epoch:  27%|██▋       | 27/100 [02:04<05:36,  4.61s/it]epoch:  28%|██▊       | 28/100 [02:08<05:32,  4.62s/it]epoch:  29%|██▉       | 29/100 [02:13<05:18,  4.48s/it]epoch:  30%|███       | 30/100 [02:17<05:09,  4.42s/it]0.027690675066673068
best ic: 0.027690675066673068
epoch:  31%|███       | 31/100 [02:22<05:26,  4.74s/it]0.028230381261240254
best ic: 0.028230381261240254
epoch:  32%|███▏      | 32/100 [02:28<05:34,  4.91s/it]0.027234640680672512
epoch:  33%|███▎      | 33/100 [02:33<05:43,  5.13s/it]0.028375992550155268
best ic: 0.028375992550155268
epoch:  34%|███▍      | 34/100 [02:39<05:49,  5.30s/it]0.03145603309423206
best ic: 0.03145603309423206
epoch:  35%|███▌      | 35/100 [02:45<05:53,  5.44s/it]0.021912171035307536
epoch:  36%|███▌      | 36/100 [02:50<05:49,  5.46s/it]0.02425249197876109
epoch:  37%|███▋      | 37/100 [02:56<05:39,  5.40s/it]0.030156126019008037
epoch:  38%|███▊      | 38/100 [03:01<05:35,  5.41s/it]0.027675556956771052
epoch:  39%|███▉      | 39/100 [03:06<05:22,  5.29s/it]0.030040410253862292
epoch:  40%|████      | 40/100 [03:11<05:12,  5.21s/it]0.03012505006875828
epoch:  41%|████      | 41/100 [03:16<05:09,  5.25s/it]0.027576490622812942
epoch:  42%|████▏     | 42/100 [03:22<05:03,  5.23s/it]0.029352795771116106
epoch:  42%|████▏     | 42/100 [03:27<04:46,  4.94s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3408179:MainThread](2024-04-25 20:15:30,978) INFO - qlib.workflow - [exp.py:258] - Experiment 51 starts running ...
[3408179:MainThread](2024-04-25 20:15:30,996) INFO - qlib.workflow - [recorder.py:341] - Recorder 865a84b078d24efbbfeb0f6733405f82 starts running under Experiment 51 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   5%|▍         | 3/63 [00:00<00:02, 27.55it/s]online:  10%|▉         | 6/63 [00:00<00:02, 27.81it/s]online:  14%|█▍        | 9/63 [00:00<00:01, 28.11it/s]online:  19%|█▉        | 12/63 [00:00<00:01, 28.44it/s]online:  24%|██▍       | 15/63 [00:00<00:01, 28.64it/s]online:  29%|██▊       | 18/63 [00:00<00:01, 29.04it/s]online:  33%|███▎      | 21/63 [00:00<00:01, 28.94it/s]online:  38%|███▊      | 24/63 [00:00<00:01, 28.90it/s]online:  43%|████▎     | 27/63 [00:00<00:01, 28.79it/s]online:  48%|████▊     | 30/63 [00:01<00:01, 28.58it/s]online:  52%|█████▏    | 33/63 [00:01<00:01, 28.71it/s]online:  57%|█████▋    | 36/63 [00:01<00:00, 28.76it/s]online:  63%|██████▎   | 40/63 [00:01<00:00, 29.30it/s]online:  70%|██████▉   | 44/63 [00:01<00:00, 29.76it/s]online:  75%|███████▍  | 47/63 [00:01<00:00, 29.69it/s]online:  79%|███████▉  | 50/63 [00:01<00:00, 29.44it/s]online:  84%|████████▍ | 53/63 [00:01<00:00, 28.96it/s]online:  89%|████████▉ | 56/63 [00:01<00:00, 28.58it/s]online:  94%|█████████▎| 59/63 [00:02<00:00, 28.35it/s]online:  98%|█████████▊| 62/63 [00:02<00:00, 28.38it/s]online: 100%|██████████| 63/63 [00:02<00:00, 28.79it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3408179:MainThread](2024-04-25 20:15:39,917) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 1.0026739 mae 0.7102061
{'IC': 0.019798322979279775,
 'ICIR': 0.13792349545898205,
 'Rank IC': 0.01918600894545256,
 'Rank ICIR': 0.13495709765546768}
[3408179:MainThread](2024-04-25 20:15:41,680) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3408179:MainThread](2024-04-25 20:15:54,342) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 20:15:54,345) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 20:16:00,435) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f157c8f3100>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:38,  9.79it/s]backtest loop:   1%|          | 9/971 [00:00<00:37, 25.35it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:26, 35.61it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.81it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 44.49it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 48.47it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:19, 47.81it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:18, 50.26it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:17, 52.01it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:18, 50.51it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:17, 51.81it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:16, 53.68it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:16, 55.05it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 56.01it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:16, 53.22it/s]backtest loop:  10%|▉         | 93/971 [00:01<00:16, 54.62it/s]backtest loop:  10%|█         | 99/971 [00:02<00:15, 55.74it/s]backtest loop:  11%|█         | 105/971 [00:02<00:15, 56.03it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:15, 56.50it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:15, 53.66it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:15, 54.85it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:16, 52.40it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:15, 53.91it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 52.05it/s]backtest loop:  15%|█▌        | 147/971 [00:02<00:15, 53.56it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:14, 54.63it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:14, 55.56it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:14, 56.30it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 53.23it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:14, 54.54it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 55.36it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:14, 55.71it/s]backtest loop:  20%|██        | 195/971 [00:03<00:14, 52.85it/s]backtest loop:  21%|██        | 201/971 [00:03<00:14, 54.29it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:13, 55.24it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:14, 53.09it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:13, 54.19it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:14, 51.92it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:13, 53.49it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:13, 54.67it/s]backtest loop:  25%|██▌       | 243/971 [00:04<00:13, 55.52it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:13, 52.81it/s]backtest loop:  26%|██▋       | 255/971 [00:04<00:13, 54.34it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:12, 55.36it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:13, 52.72it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 54.21it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:12, 55.27it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:12, 55.61it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 52.89it/s]backtest loop:  31%|███       | 297/971 [00:05<00:12, 54.16it/s]backtest loop:  31%|███       | 303/971 [00:05<00:12, 55.12it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 55.88it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:12, 51.31it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:12, 51.82it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:12, 51.92it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:12, 52.16it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:12, 52.59it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:12, 49.21it/s]backtest loop:  36%|███▌      | 351/971 [00:06<00:12, 50.40it/s]backtest loop:  37%|███▋      | 357/971 [00:06<00:12, 51.16it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:12, 48.87it/s]backtest loop:  38%|███▊      | 368/971 [00:07<00:12, 46.79it/s]backtest loop:  39%|███▊      | 374/971 [00:07<00:12, 48.57it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:11, 49.89it/s]backtest loop:  40%|███▉      | 386/971 [00:07<00:11, 50.94it/s]backtest loop:  40%|████      | 392/971 [00:07<00:11, 51.45it/s]backtest loop:  41%|████      | 398/971 [00:07<00:11, 48.59it/s]backtest loop:  42%|████▏     | 404/971 [00:07<00:11, 49.86it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:11, 50.98it/s]backtest loop:  43%|████▎     | 416/971 [00:08<00:10, 51.54it/s]backtest loop:  43%|████▎     | 422/971 [00:08<00:10, 51.97it/s]backtest loop:  44%|████▍     | 428/971 [00:08<00:11, 49.10it/s]backtest loop:  45%|████▍     | 434/971 [00:08<00:10, 50.11it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:10, 50.88it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:10, 51.48it/s]backtest loop:  47%|████▋     | 452/971 [00:08<00:10, 48.84it/s]backtest loop:  47%|████▋     | 458/971 [00:08<00:10, 49.87it/s]backtest loop:  48%|████▊     | 464/971 [00:09<00:10, 50.47it/s]backtest loop:  48%|████▊     | 470/971 [00:09<00:09, 51.15it/s]backtest loop:  49%|████▉     | 476/971 [00:09<00:09, 51.66it/s]backtest loop:  50%|████▉     | 482/971 [00:09<00:10, 48.87it/s]backtest loop:  50%|█████     | 488/971 [00:09<00:09, 49.97it/s]backtest loop:  51%|█████     | 494/971 [00:09<00:09, 50.76it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:09, 48.44it/s]backtest loop:  52%|█████▏    | 506/971 [00:09<00:09, 50.01it/s]backtest loop:  53%|█████▎    | 512/971 [00:10<00:09, 47.85it/s]backtest loop:  53%|█████▎    | 518/971 [00:10<00:09, 49.51it/s]backtest loop:  54%|█████▍    | 524/971 [00:10<00:08, 50.67it/s]backtest loop:  55%|█████▍    | 530/971 [00:10<00:08, 51.40it/s]backtest loop:  55%|█████▌    | 536/971 [00:10<00:08, 49.21it/s]backtest loop:  56%|█████▌    | 542/971 [00:10<00:08, 50.31it/s]backtest loop:  56%|█████▋    | 548/971 [00:10<00:08, 51.03it/s]backtest loop:  57%|█████▋    | 554/971 [00:10<00:08, 51.59it/s]backtest loop:  58%|█████▊    | 560/971 [00:10<00:07, 51.82it/s]backtest loop:  58%|█████▊    | 566/971 [00:11<00:08, 49.08it/s]backtest loop:  59%|█████▉    | 572/971 [00:11<00:07, 50.13it/s]backtest loop:  60%|█████▉    | 578/971 [00:11<00:07, 50.88it/s]backtest loop:  60%|██████    | 584/971 [00:11<00:07, 51.50it/s]backtest loop:  61%|██████    | 590/971 [00:11<00:07, 51.68it/s]backtest loop:  61%|██████▏   | 596/971 [00:11<00:07, 48.86it/s]backtest loop:  62%|██████▏   | 602/971 [00:11<00:07, 50.07it/s]backtest loop:  63%|██████▎   | 608/971 [00:11<00:07, 50.87it/s]backtest loop:  63%|██████▎   | 614/971 [00:12<00:06, 51.25it/s]backtest loop:  64%|██████▍   | 620/971 [00:12<00:11, 31.00it/s]backtest loop:  64%|██████▍   | 626/971 [00:12<00:09, 35.36it/s]backtest loop:  65%|██████▌   | 632/971 [00:12<00:08, 39.26it/s]backtest loop:  66%|██████▌   | 638/971 [00:12<00:07, 42.52it/s]backtest loop:  66%|██████▋   | 644/971 [00:12<00:07, 45.17it/s]backtest loop:  67%|██████▋   | 650/971 [00:12<00:07, 44.72it/s]backtest loop:  67%|██████▋   | 655/971 [00:13<00:06, 45.96it/s]backtest loop:  68%|██████▊   | 661/971 [00:13<00:06, 47.84it/s]backtest loop:  69%|██████▊   | 667/971 [00:13<00:06, 49.25it/s]backtest loop:  69%|██████▉   | 673/971 [00:13<00:05, 50.31it/s]backtest loop:  70%|██████▉   | 679/971 [00:13<00:06, 48.03it/s]backtest loop:  71%|███████   | 685/971 [00:13<00:05, 49.28it/s]backtest loop:  71%|███████   | 691/971 [00:13<00:05, 50.31it/s]backtest loop:  72%|███████▏  | 697/971 [00:13<00:05, 50.96it/s]backtest loop:  72%|███████▏  | 703/971 [00:14<00:05, 51.58it/s]backtest loop:  73%|███████▎  | 709/971 [00:14<00:05, 48.53it/s]backtest loop:  74%|███████▎  | 715/971 [00:14<00:05, 49.58it/s]backtest loop:  74%|███████▍  | 721/971 [00:14<00:04, 50.63it/s]backtest loop:  75%|███████▍  | 727/971 [00:14<00:04, 51.31it/s]backtest loop:  75%|███████▌  | 733/971 [00:14<00:05, 46.09it/s]backtest loop:  76%|███████▌  | 739/971 [00:14<00:04, 48.09it/s]backtest loop:  77%|███████▋  | 745/971 [00:14<00:04, 49.44it/s]backtest loop:  77%|███████▋  | 751/971 [00:15<00:04, 47.48it/s]backtest loop:  78%|███████▊  | 757/971 [00:15<00:04, 48.96it/s]backtest loop:  79%|███████▊  | 763/971 [00:15<00:04, 49.96it/s]backtest loop:  79%|███████▉  | 769/971 [00:15<00:03, 50.81it/s]backtest loop:  80%|███████▉  | 775/971 [00:15<00:04, 48.60it/s]backtest loop:  80%|████████  | 781/971 [00:15<00:03, 49.75it/s]backtest loop:  81%|████████  | 787/971 [00:15<00:03, 50.76it/s]backtest loop:  82%|████████▏ | 793/971 [00:15<00:03, 48.52it/s]backtest loop:  82%|████████▏ | 799/971 [00:15<00:03, 49.71it/s]backtest loop:  83%|████████▎ | 805/971 [00:16<00:03, 50.64it/s]backtest loop:  84%|████████▎ | 811/971 [00:16<00:03, 51.21it/s]backtest loop:  84%|████████▍ | 817/971 [00:16<00:02, 51.45it/s]backtest loop:  85%|████████▍ | 823/971 [00:16<00:03, 48.82it/s]backtest loop:  85%|████████▌ | 829/971 [00:16<00:02, 49.93it/s]backtest loop:  86%|████████▌ | 835/971 [00:16<00:02, 50.71it/s]backtest loop:  87%|████████▋ | 841/971 [00:16<00:02, 51.09it/s]backtest loop:  87%|████████▋ | 847/971 [00:16<00:02, 51.60it/s]backtest loop:  88%|████████▊ | 853/971 [00:17<00:02, 48.42it/s]backtest loop:  88%|████████▊ | 859/971 [00:17<00:02, 50.28it/s]backtest loop:  89%|████████▉ | 865/971 [00:17<00:02, 52.43it/s]backtest loop:  90%|████████▉ | 871/971 [00:17<00:01, 53.70it/s]backtest loop:  90%|█████████ | 877/971 [00:17<00:01, 51.60it/s]backtest loop:  91%|█████████ | 883/971 [00:17<00:01, 53.30it/s]backtest loop:  92%|█████████▏| 889/971 [00:17<00:01, 54.52it/s]backtest loop:  92%|█████████▏| 895/971 [00:17<00:01, 55.43it/s]backtest loop:  93%|█████████▎| 901/971 [00:17<00:01, 56.16it/s]backtest loop:  93%|█████████▎| 907/971 [00:18<00:01, 53.37it/s]backtest loop:  94%|█████████▍| 913/971 [00:18<00:01, 54.88it/s]backtest loop:  95%|█████████▍| 919/971 [00:18<00:00, 55.74it/s]backtest loop:  95%|█████████▌| 925/971 [00:18<00:00, 56.31it/s]backtest loop:  96%|█████████▌| 931/971 [00:18<00:00, 53.36it/s]backtest loop:  96%|█████████▋| 937/971 [00:18<00:00, 54.42it/s]backtest loop:  97%|█████████▋| 943/971 [00:18<00:00, 55.43it/s]backtest loop:  98%|█████████▊| 949/971 [00:18<00:00, 56.06it/s]backtest loop:  98%|█████████▊| 955/971 [00:18<00:00, 53.33it/s]backtest loop:  99%|█████████▉| 961/971 [00:19<00:00, 54.50it/s]backtest loop: 100%|█████████▉| 967/971 [00:19<00:00, 55.36it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 50.57it/s]
[3408179:MainThread](2024-04-25 20:16:19,713) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000554
std                0.006594
annualized_return  0.131845
information_ratio  1.296019
max_drawdown      -0.100753
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000357
std                0.006595
annualized_return  0.085028
information_ratio  0.835770
max_drawdown      -0.105528
[3408179:MainThread](2024-04-25 20:16:19,732) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_MLP_alpha360_horizon1_step20_rankFalse_2024-04-25_19:40:48_online`.
Round 8 Done!
{'1day.excess_return_with_cost.annualized_return': [0.057177137820259884,
                                                    0.08548363170297701,
                                                    0.08226411002449573,
                                                    0.08706121975225466,
                                                    0.08013060465524563,
                                                    0.07571558432705998,
                                                    0.07628304739056636,
                                                    0.08502783323648323],
 '1day.excess_return_with_cost.information_ratio': [0.5708410850384811,
                                                    0.845421016572987,
                                                    0.7978274309230767,
                                                    0.8369757920170999,
                                                    0.8381038258157765,
                                                    0.7336819149814031,
                                                    0.7635567445621011,
                                                    0.8357697360345328],
 '1day.excess_return_with_cost.max_drawdown': [-0.1369210363821404,
                                               -0.11977546407167693,
                                               -0.1034332552834204,
                                               -0.12308119808575027,
                                               -0.08510115880048863,
                                               -0.08921683499605616,
                                               -0.11658439508297297,
                                               -0.10552794082154454],
 'IC': [0.01965990918075504,
        0.017473035411976354,
        0.022471273042633803,
        0.014764623845075724,
        0.01618276252046565,
        0.017526135258189312,
        0.01968359506459353,
        0.019798322979279775],
 'ICIR': [0.1335802115342955,
          0.11199170785924299,
          0.1499332834341299,
          0.09867948469078397,
          0.12049670733212928,
          0.1254889069438199,
          0.13207641436532627,
          0.13792349545898205],
 'Rank IC': [0.020391620238398377,
             0.020504008283316912,
             0.02404224943985234,
             0.015979887830955906,
             0.017656452109903808,
             0.017278615004094867,
             0.020537665285686294,
             0.01918600894545256],
 'Rank ICIR': [0.13725662019635151,
               0.12869373013758173,
               0.16079934584854338,
               0.10527904193204127,
               0.1321966458897622,
               0.1261435732927875,
               0.13624013905361673,
               0.13495709765546768],
 'mae': [0.7102560997009277,
         0.7094312310218811,
         0.7095029354095459,
         0.7101821303367615,
         0.7123894691467285,
         0.7115300893783569,
         0.7095363140106201,
         0.7102060914039612],
 'mse': [1.0026987791061401,
         1.0009208917617798,
         1.0006343126296997,
         1.0026757717132568,
         1.0076842308044434,
         1.0052242279052734,
         1.0013188123703003,
         1.002673864364624]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3408179:MainThread](2024-04-25 20:16:21,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3408179:MainThread](2024-04-25 20:16:21,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.001
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3408179:MainThread](2024-04-25 20:16:21,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3408179:MainThread](2024-04-25 20:16:21,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:04<07:44,  4.69s/it]epoch:   2%|▏         | 2/100 [00:09<07:19,  4.48s/it]epoch:   3%|▎         | 3/100 [00:13<07:20,  4.54s/it]epoch:   4%|▍         | 4/100 [00:17<07:07,  4.45s/it]epoch:   5%|▌         | 5/100 [00:22<07:05,  4.48s/it]epoch:   6%|▌         | 6/100 [00:27<07:03,  4.51s/it]epoch:   7%|▋         | 7/100 [00:31<07:08,  4.60s/it]epoch:   8%|▊         | 8/100 [00:36<07:08,  4.66s/it]epoch:   9%|▉         | 9/100 [00:41<07:04,  4.67s/it]epoch:  10%|█         | 10/100 [00:46<07:05,  4.73s/it]epoch:  11%|█         | 11/100 [00:50<07:00,  4.72s/it]epoch:  12%|█▏        | 12/100 [00:55<06:54,  4.71s/it]epoch:  13%|█▎        | 13/100 [00:59<06:35,  4.54s/it]epoch:  14%|█▍        | 14/100 [01:03<06:17,  4.39s/it]epoch:  15%|█▌        | 15/100 [01:08<06:16,  4.43s/it]epoch:  16%|█▌        | 16/100 [01:12<06:19,  4.51s/it]epoch:  17%|█▋        | 17/100 [01:17<06:19,  4.57s/it]epoch:  18%|█▊        | 18/100 [01:22<06:19,  4.63s/it]epoch:  19%|█▉        | 19/100 [01:27<06:18,  4.68s/it]epoch:  20%|██        | 20/100 [01:31<06:14,  4.68s/it]epoch:  21%|██        | 21/100 [01:36<06:11,  4.71s/it]epoch:  22%|██▏       | 22/100 [01:41<06:04,  4.67s/it]epoch:  23%|██▎       | 23/100 [01:45<05:59,  4.66s/it]epoch:  24%|██▍       | 24/100 [01:50<05:53,  4.66s/it]epoch:  25%|██▌       | 25/100 [01:55<05:48,  4.65s/it]epoch:  26%|██▌       | 26/100 [01:59<05:36,  4.55s/it]epoch:  27%|██▋       | 27/100 [02:03<05:21,  4.40s/it]epoch:  28%|██▊       | 28/100 [02:07<05:10,  4.31s/it]epoch:  29%|██▉       | 29/100 [02:12<05:12,  4.40s/it]epoch:  30%|███       | 30/100 [02:16<05:13,  4.48s/it]0.03620596231890102
best ic: 0.03620596231890102
epoch:  31%|███       | 31/100 [02:21<05:20,  4.64s/it]0.027000585593249027
epoch:  32%|███▏      | 32/100 [02:27<05:25,  4.79s/it]0.027723500738063837
epoch:  33%|███▎      | 33/100 [02:32<05:32,  4.96s/it]0.029808360797461894
epoch:  34%|███▍      | 34/100 [02:37<05:37,  5.11s/it]0.033012934343457506
epoch:  35%|███▌      | 35/100 [02:43<05:37,  5.19s/it]0.0318369757963066
epoch:  36%|███▌      | 36/100 [02:48<05:36,  5.25s/it]0.028837587797724495
epoch:  37%|███▋      | 37/100 [02:54<05:32,  5.28s/it]0.02710369992457134
epoch:  38%|███▊      | 38/100 [02:58<05:19,  5.15s/it]0.025673180813189263
epoch:  38%|███▊      | 38/100 [03:04<05:00,  4.85s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3408179:MainThread](2024-04-25 20:19:25,430) INFO - qlib.workflow - [exp.py:258] - Experiment 51 starts running ...
[3408179:MainThread](2024-04-25 20:19:25,451) INFO - qlib.workflow - [recorder.py:341] - Recorder 75b2718d166140dd96614a99b5171e3e starts running under Experiment 51 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   5%|▍         | 3/63 [00:00<00:02, 23.67it/s]online:  10%|▉         | 6/63 [00:00<00:02, 24.24it/s]online:  14%|█▍        | 9/63 [00:00<00:02, 21.91it/s]online:  19%|█▉        | 12/63 [00:00<00:02, 23.10it/s]online:  24%|██▍       | 15/63 [00:00<00:02, 23.75it/s]online:  29%|██▊       | 18/63 [00:00<00:01, 23.73it/s]online:  33%|███▎      | 21/63 [00:00<00:01, 23.78it/s]online:  38%|███▊      | 24/63 [00:01<00:01, 24.03it/s]online:  43%|████▎     | 27/63 [00:01<00:01, 24.58it/s]online:  48%|████▊     | 30/63 [00:01<00:01, 24.89it/s]online:  52%|█████▏    | 33/63 [00:01<00:01, 24.96it/s]online:  57%|█████▋    | 36/63 [00:01<00:01, 24.68it/s]online:  62%|██████▏   | 39/63 [00:01<00:00, 24.69it/s]online:  67%|██████▋   | 42/63 [00:01<00:00, 24.63it/s]online:  71%|███████▏  | 45/63 [00:01<00:00, 24.97it/s]online:  76%|███████▌  | 48/63 [00:01<00:00, 25.51it/s]online:  81%|████████  | 51/63 [00:02<00:00, 25.64it/s]online:  86%|████████▌ | 54/63 [00:02<00:00, 25.96it/s]online:  90%|█████████ | 57/63 [00:02<00:00, 24.97it/s]online:  95%|█████████▌| 60/63 [00:02<00:00, 25.20it/s]online: 100%|██████████| 63/63 [00:02<00:00, 24.88it/s]online: 100%|██████████| 63/63 [00:02<00:00, 24.58it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3408179:MainThread](2024-04-25 20:19:34,800) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 1.0009912 mae 0.7096025
{'IC': 0.018741158658677842,
 'ICIR': 0.12786199158178227,
 'Rank IC': 0.01987243200718023,
 'Rank ICIR': 0.13401083202236763}
[3408179:MainThread](2024-04-25 20:19:36,585) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3408179:MainThread](2024-04-25 20:19:49,119) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 20:19:49,123) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 20:19:55,239) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f157a75b670>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:41,  9.53it/s]backtest loop:   1%|          | 8/971 [00:00<00:43, 22.14it/s]backtest loop:   1%|▏         | 14/971 [00:00<00:29, 32.37it/s]backtest loop:   2%|▏         | 20/971 [00:00<00:24, 38.94it/s]backtest loop:   3%|▎         | 25/971 [00:00<00:24, 39.33it/s]backtest loop:   3%|▎         | 30/971 [00:00<00:22, 42.26it/s]backtest loop:   4%|▎         | 35/971 [00:00<00:21, 44.25it/s]backtest loop:   4%|▍         | 41/971 [00:01<00:19, 46.91it/s]backtest loop:   5%|▍         | 47/971 [00:01<00:18, 48.81it/s]backtest loop:   5%|▌         | 53/971 [00:01<00:18, 50.06it/s]backtest loop:   6%|▌         | 59/971 [00:01<00:19, 47.84it/s]backtest loop:   7%|▋         | 65/971 [00:01<00:18, 49.41it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:17, 51.01it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:18, 48.64it/s]backtest loop:   9%|▊         | 83/971 [00:01<00:17, 50.00it/s]backtest loop:   9%|▉         | 89/971 [00:02<00:17, 50.90it/s]backtest loop:  10%|▉         | 95/971 [00:02<00:16, 51.60it/s]backtest loop:  10%|█         | 101/971 [00:02<00:16, 51.97it/s]backtest loop:  11%|█         | 107/971 [00:02<00:17, 49.18it/s]backtest loop:  12%|█▏        | 113/971 [00:02<00:17, 50.19it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:16, 50.94it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:17, 48.56it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:17, 48.75it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:17, 47.14it/s]backtest loop:  15%|█▍        | 142/971 [00:03<00:17, 48.73it/s]backtest loop:  15%|█▌        | 148/971 [00:03<00:16, 50.10it/s]backtest loop:  16%|█▌        | 154/971 [00:03<00:16, 50.91it/s]backtest loop:  16%|█▋        | 160/971 [00:03<00:15, 51.39it/s]backtest loop:  17%|█▋        | 166/971 [00:03<00:16, 48.55it/s]backtest loop:  18%|█▊        | 172/971 [00:03<00:16, 49.76it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:15, 51.25it/s]backtest loop:  19%|█▉        | 184/971 [00:03<00:15, 52.25it/s]backtest loop:  20%|█▉        | 190/971 [00:04<00:15, 49.41it/s]backtest loop:  20%|██        | 196/971 [00:04<00:15, 50.35it/s]backtest loop:  21%|██        | 202/971 [00:04<00:15, 50.58it/s]backtest loop:  21%|██▏       | 208/971 [00:04<00:14, 51.42it/s]backtest loop:  22%|██▏       | 214/971 [00:04<00:15, 49.14it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:15, 47.47it/s]backtest loop:  23%|██▎       | 226/971 [00:04<00:15, 49.07it/s]backtest loop:  24%|██▍       | 232/971 [00:04<00:14, 50.21it/s]backtest loop:  25%|██▍       | 238/971 [00:05<00:14, 51.03it/s]backtest loop:  25%|██▌       | 244/971 [00:05<00:14, 51.29it/s]backtest loop:  26%|██▌       | 250/971 [00:05<00:14, 48.47it/s]backtest loop:  26%|██▋       | 256/971 [00:05<00:14, 49.90it/s]backtest loop:  27%|██▋       | 262/971 [00:05<00:13, 50.83it/s]backtest loop:  28%|██▊       | 268/971 [00:05<00:14, 48.56it/s]backtest loop:  28%|██▊       | 274/971 [00:05<00:13, 49.98it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:13, 50.96it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:14, 48.74it/s]backtest loop:  30%|███       | 292/971 [00:06<00:13, 50.40it/s]backtest loop:  31%|███       | 298/971 [00:06<00:13, 51.74it/s]backtest loop:  31%|███▏      | 304/971 [00:06<00:13, 51.25it/s]backtest loop:  32%|███▏      | 310/971 [00:06<00:13, 50.42it/s]backtest loop:  33%|███▎      | 316/971 [00:06<00:12, 52.84it/s]backtest loop:  33%|███▎      | 322/971 [00:06<00:11, 54.34it/s]backtest loop:  34%|███▍      | 328/971 [00:06<00:11, 55.10it/s]backtest loop:  34%|███▍      | 334/971 [00:06<00:11, 55.74it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:11, 53.07it/s]backtest loop:  36%|███▌      | 346/971 [00:07<00:11, 54.02it/s]backtest loop:  36%|███▋      | 352/971 [00:07<00:11, 54.86it/s]backtest loop:  37%|███▋      | 358/971 [00:07<00:11, 55.55it/s]backtest loop:  37%|███▋      | 364/971 [00:07<00:11, 52.82it/s]backtest loop:  38%|███▊      | 370/971 [00:07<00:11, 50.99it/s]backtest loop:  39%|███▊      | 376/971 [00:07<00:11, 52.75it/s]backtest loop:  39%|███▉      | 382/971 [00:07<00:10, 53.90it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:11, 51.55it/s]backtest loop:  41%|████      | 394/971 [00:08<00:10, 53.10it/s]backtest loop:  41%|████      | 400/971 [00:08<00:10, 54.08it/s]backtest loop:  42%|████▏     | 406/971 [00:08<00:10, 54.95it/s]backtest loop:  42%|████▏     | 412/971 [00:08<00:10, 55.57it/s]backtest loop:  43%|████▎     | 418/971 [00:08<00:10, 52.51it/s]backtest loop:  44%|████▎     | 424/971 [00:08<00:10, 53.63it/s]backtest loop:  44%|████▍     | 430/971 [00:08<00:09, 54.47it/s]backtest loop:  45%|████▍     | 436/971 [00:08<00:09, 55.14it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:10, 52.28it/s]backtest loop:  46%|████▌     | 448/971 [00:09<00:09, 53.56it/s]backtest loop:  47%|████▋     | 454/971 [00:09<00:09, 54.80it/s]backtest loop:  47%|████▋     | 460/971 [00:09<00:09, 55.53it/s]backtest loop:  48%|████▊     | 466/971 [00:09<00:09, 56.08it/s]backtest loop:  49%|████▊     | 472/971 [00:09<00:09, 53.08it/s]backtest loop:  49%|████▉     | 478/971 [00:09<00:09, 54.15it/s]backtest loop:  50%|████▉     | 484/971 [00:09<00:08, 54.81it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:09, 52.46it/s]backtest loop:  51%|█████     | 496/971 [00:09<00:08, 53.72it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:08, 54.72it/s]backtest loop:  52%|█████▏    | 508/971 [00:10<00:08, 52.29it/s]backtest loop:  53%|█████▎    | 514/971 [00:10<00:08, 53.60it/s]backtest loop:  54%|█████▎    | 520/971 [00:10<00:08, 54.71it/s]backtest loop:  54%|█████▍    | 526/971 [00:10<00:08, 52.20it/s]backtest loop:  55%|█████▍    | 532/971 [00:10<00:08, 53.60it/s]backtest loop:  55%|█████▌    | 538/971 [00:10<00:08, 54.09it/s]backtest loop:  56%|█████▌    | 544/971 [00:10<00:07, 53.44it/s]backtest loop:  57%|█████▋    | 550/971 [00:10<00:07, 53.04it/s]backtest loop:  57%|█████▋    | 556/971 [00:11<00:08, 50.02it/s]backtest loop:  58%|█████▊    | 562/971 [00:11<00:07, 52.14it/s]backtest loop:  58%|█████▊    | 568/971 [00:11<00:07, 53.77it/s]backtest loop:  59%|█████▉    | 574/971 [00:11<00:07, 55.07it/s]backtest loop:  60%|█████▉    | 580/971 [00:11<00:06, 55.97it/s]backtest loop:  60%|██████    | 586/971 [00:11<00:07, 53.37it/s]backtest loop:  61%|██████    | 592/971 [00:11<00:06, 54.70it/s]backtest loop:  62%|██████▏   | 598/971 [00:11<00:06, 55.73it/s]backtest loop:  62%|██████▏   | 604/971 [00:11<00:06, 56.20it/s]backtest loop:  63%|██████▎   | 610/971 [00:12<00:06, 52.99it/s]backtest loop:  63%|██████▎   | 616/971 [00:12<00:10, 32.95it/s]backtest loop:  64%|██████▍   | 622/971 [00:12<00:09, 37.80it/s]backtest loop:  65%|██████▍   | 628/971 [00:12<00:08, 42.09it/s]backtest loop:  65%|██████▌   | 634/971 [00:12<00:07, 45.95it/s]backtest loop:  66%|██████▌   | 640/971 [00:12<00:07, 46.36it/s]backtest loop:  67%|██████▋   | 646/971 [00:12<00:06, 47.94it/s]backtest loop:  67%|██████▋   | 652/971 [00:13<00:06, 49.24it/s]backtest loop:  68%|██████▊   | 658/971 [00:13<00:06, 49.61it/s]backtest loop:  68%|██████▊   | 664/971 [00:13<00:06, 47.59it/s]backtest loop:  69%|██████▉   | 670/971 [00:13<00:06, 46.84it/s]backtest loop:  70%|██████▉   | 676/971 [00:13<00:05, 49.86it/s]backtest loop:  70%|███████   | 682/971 [00:13<00:05, 50.93it/s]backtest loop:  71%|███████   | 688/971 [00:13<00:05, 52.63it/s]backtest loop:  71%|███████▏  | 694/971 [00:13<00:05, 50.83it/s]backtest loop:  72%|███████▏  | 700/971 [00:13<00:05, 52.64it/s]backtest loop:  73%|███████▎  | 706/971 [00:14<00:04, 53.76it/s]backtest loop:  73%|███████▎  | 712/971 [00:14<00:04, 54.80it/s]backtest loop:  74%|███████▍  | 718/971 [00:14<00:04, 55.57it/s]backtest loop:  75%|███████▍  | 724/971 [00:14<00:04, 52.68it/s]backtest loop:  75%|███████▌  | 730/971 [00:14<00:04, 53.94it/s]backtest loop:  76%|███████▌  | 736/971 [00:14<00:04, 51.95it/s]backtest loop:  76%|███████▋  | 742/971 [00:14<00:04, 53.40it/s]backtest loop:  77%|███████▋  | 748/971 [00:14<00:04, 51.36it/s]backtest loop:  78%|███████▊  | 754/971 [00:14<00:04, 52.95it/s]backtest loop:  78%|███████▊  | 760/971 [00:15<00:04, 51.16it/s]backtest loop:  79%|███████▉  | 766/971 [00:15<00:03, 52.94it/s]backtest loop:  80%|███████▉  | 772/971 [00:15<00:03, 54.66it/s]backtest loop:  80%|████████  | 778/971 [00:15<00:03, 56.00it/s]backtest loop:  81%|████████  | 784/971 [00:15<00:03, 53.87it/s]backtest loop:  81%|████████▏ | 791/971 [00:15<00:03, 56.38it/s]backtest loop:  82%|████████▏ | 797/971 [00:15<00:03, 57.27it/s]backtest loop:  83%|████████▎ | 803/971 [00:15<00:03, 54.36it/s]backtest loop:  83%|████████▎ | 809/971 [00:15<00:02, 55.34it/s]backtest loop:  84%|████████▍ | 815/971 [00:16<00:02, 56.05it/s]backtest loop:  85%|████████▍ | 821/971 [00:16<00:02, 56.58it/s]backtest loop:  85%|████████▌ | 827/971 [00:16<00:02, 56.96it/s]backtest loop:  86%|████████▌ | 833/971 [00:16<00:02, 53.76it/s]backtest loop:  86%|████████▋ | 839/971 [00:16<00:02, 54.87it/s]backtest loop:  87%|████████▋ | 845/971 [00:16<00:02, 55.72it/s]backtest loop:  88%|████████▊ | 851/971 [00:16<00:02, 56.37it/s]backtest loop:  88%|████████▊ | 857/971 [00:16<00:02, 53.45it/s]backtest loop:  89%|████████▉ | 863/971 [00:16<00:01, 54.65it/s]backtest loop:  89%|████████▉ | 869/971 [00:17<00:01, 55.62it/s]backtest loop:  90%|█████████ | 875/971 [00:17<00:01, 56.10it/s]backtest loop:  91%|█████████ | 881/971 [00:17<00:01, 56.53it/s]backtest loop:  91%|█████████▏| 887/971 [00:17<00:01, 53.61it/s]backtest loop:  92%|█████████▏| 893/971 [00:17<00:01, 54.55it/s]backtest loop:  93%|█████████▎| 899/971 [00:17<00:01, 55.54it/s]backtest loop:  93%|█████████▎| 905/971 [00:17<00:01, 56.17it/s]backtest loop:  94%|█████████▍| 911/971 [00:17<00:01, 56.64it/s]backtest loop:  94%|█████████▍| 917/971 [00:17<00:01, 53.73it/s]backtest loop:  95%|█████████▌| 923/971 [00:18<00:00, 54.82it/s]backtest loop:  96%|█████████▌| 929/971 [00:18<00:00, 55.73it/s]backtest loop:  96%|█████████▋| 935/971 [00:18<00:00, 56.29it/s]backtest loop:  97%|█████████▋| 941/971 [00:18<00:00, 53.38it/s]backtest loop:  98%|█████████▊| 947/971 [00:18<00:00, 54.59it/s]backtest loop:  98%|█████████▊| 953/971 [00:18<00:00, 55.32it/s]backtest loop:  99%|█████████▉| 959/971 [00:18<00:00, 55.89it/s]backtest loop:  99%|█████████▉| 965/971 [00:18<00:00, 53.09it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 54.32it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 51.35it/s]
[3408179:MainThread](2024-04-25 20:20:14,226) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000571
std                0.006490
annualized_return  0.135792
information_ratio  1.356168
max_drawdown      -0.095617
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000374
std                0.006490
annualized_return  0.089076
information_ratio  0.889727
max_drawdown      -0.103392
[3408179:MainThread](2024-04-25 20:20:14,244) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_MLP_alpha360_horizon1_step20_rankFalse_2024-04-25_19:40:48_online`.
Round 9 Done!
{'1day.excess_return_with_cost.annualized_return': [0.057177137820259884,
                                                    0.08548363170297701,
                                                    0.08226411002449573,
                                                    0.08706121975225466,
                                                    0.08013060465524563,
                                                    0.07571558432705998,
                                                    0.07628304739056636,
                                                    0.08502783323648323,
                                                    0.08907643553965552],
 '1day.excess_return_with_cost.information_ratio': [0.5708410850384811,
                                                    0.845421016572987,
                                                    0.7978274309230767,
                                                    0.8369757920170999,
                                                    0.8381038258157765,
                                                    0.7336819149814031,
                                                    0.7635567445621011,
                                                    0.8357697360345328,
                                                    0.8897272972191618],
 '1day.excess_return_with_cost.max_drawdown': [-0.1369210363821404,
                                               -0.11977546407167693,
                                               -0.1034332552834204,
                                               -0.12308119808575027,
                                               -0.08510115880048863,
                                               -0.08921683499605616,
                                               -0.11658439508297297,
                                               -0.10552794082154454,
                                               -0.10339158479807933],
 'IC': [0.01965990918075504,
        0.017473035411976354,
        0.022471273042633803,
        0.014764623845075724,
        0.01618276252046565,
        0.017526135258189312,
        0.01968359506459353,
        0.019798322979279775,
        0.018741158658677842],
 'ICIR': [0.1335802115342955,
          0.11199170785924299,
          0.1499332834341299,
          0.09867948469078397,
          0.12049670733212928,
          0.1254889069438199,
          0.13207641436532627,
          0.13792349545898205,
          0.12786199158178227],
 'Rank IC': [0.020391620238398377,
             0.020504008283316912,
             0.02404224943985234,
             0.015979887830955906,
             0.017656452109903808,
             0.017278615004094867,
             0.020537665285686294,
             0.01918600894545256,
             0.01987243200718023],
 'Rank ICIR': [0.13725662019635151,
               0.12869373013758173,
               0.16079934584854338,
               0.10527904193204127,
               0.1321966458897622,
               0.1261435732927875,
               0.13624013905361673,
               0.13495709765546768,
               0.13401083202236763],
 'mae': [0.7102560997009277,
         0.7094312310218811,
         0.7095029354095459,
         0.7101821303367615,
         0.7123894691467285,
         0.7115300893783569,
         0.7095363140106201,
         0.7102060914039612,
         0.7096024751663208],
 'mse': [1.0026987791061401,
         1.0009208917617798,
         1.0006343126296997,
         1.0026757717132568,
         1.0076842308044434,
         1.0052242279052734,
         1.0013188123703003,
         1.002673864364624,
         1.0009912252426147]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3408179:MainThread](2024-04-25 20:20:15,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[3408179:MainThread](2024-04-25 20:20:15,452) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.001
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[3408179:MainThread](2024-04-25 20:20:15,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[3408179:MainThread](2024-04-25 20:20:15,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:05<08:26,  5.12s/it]epoch:   2%|▏         | 2/100 [00:09<07:52,  4.82s/it]epoch:   3%|▎         | 3/100 [00:14<07:33,  4.67s/it]epoch:   4%|▍         | 4/100 [00:18<07:23,  4.62s/it]epoch:   5%|▌         | 5/100 [00:23<07:17,  4.61s/it]epoch:   6%|▌         | 6/100 [00:27<07:13,  4.61s/it]epoch:   7%|▋         | 7/100 [00:32<07:12,  4.65s/it]epoch:   8%|▊         | 8/100 [00:37<07:11,  4.69s/it]epoch:   9%|▉         | 9/100 [00:42<07:10,  4.73s/it]epoch:  10%|█         | 10/100 [00:46<07:02,  4.70s/it]epoch:  11%|█         | 11/100 [00:51<06:50,  4.62s/it]epoch:  12%|█▏        | 12/100 [00:55<06:40,  4.55s/it]epoch:  13%|█▎        | 13/100 [01:00<06:35,  4.54s/it]epoch:  14%|█▍        | 14/100 [01:04<06:26,  4.49s/it]epoch:  15%|█▌        | 15/100 [01:08<06:17,  4.44s/it]epoch:  16%|█▌        | 16/100 [01:13<06:19,  4.52s/it]epoch:  17%|█▋        | 17/100 [01:18<06:17,  4.55s/it]epoch:  18%|█▊        | 18/100 [01:23<06:19,  4.62s/it]epoch:  19%|█▉        | 19/100 [01:27<06:19,  4.68s/it]epoch:  20%|██        | 20/100 [01:32<06:21,  4.77s/it]epoch:  21%|██        | 21/100 [01:37<06:15,  4.75s/it]epoch:  22%|██▏       | 22/100 [01:42<06:07,  4.71s/it]epoch:  23%|██▎       | 23/100 [01:47<06:06,  4.76s/it]epoch:  24%|██▍       | 24/100 [01:51<06:04,  4.80s/it]epoch:  25%|██▌       | 25/100 [01:56<06:03,  4.84s/it]epoch:  26%|██▌       | 26/100 [02:01<05:51,  4.75s/it]epoch:  27%|██▋       | 27/100 [02:06<05:44,  4.71s/it]epoch:  28%|██▊       | 28/100 [02:10<05:36,  4.68s/it]epoch:  29%|██▉       | 29/100 [02:15<05:30,  4.66s/it]epoch:  30%|███       | 30/100 [02:19<05:16,  4.52s/it]0.03307413517869418
best ic: 0.03307413517869418
epoch:  31%|███       | 31/100 [02:25<05:36,  4.87s/it]0.0345611171546974
best ic: 0.0345611171546974
epoch:  32%|███▏      | 32/100 [02:30<05:40,  5.01s/it]0.02649512568455574
epoch:  33%|███▎      | 33/100 [02:36<05:45,  5.16s/it]0.03038829050964076
epoch:  34%|███▍      | 34/100 [02:41<05:45,  5.24s/it]0.027504483598727005
epoch:  35%|███▌      | 35/100 [02:46<05:43,  5.29s/it]0.028033038450273794
epoch:  36%|███▌      | 36/100 [02:52<05:38,  5.29s/it]0.03086248519837012
epoch:  37%|███▋      | 37/100 [02:57<05:30,  5.25s/it]0.03188537799812465
epoch:  38%|███▊      | 38/100 [03:02<05:23,  5.21s/it]0.030765598319574716
epoch:  39%|███▉      | 39/100 [03:07<05:17,  5.21s/it]0.027814983196891064
epoch:  39%|███▉      | 39/100 [03:12<05:01,  4.95s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3408179:MainThread](2024-04-25 20:23:28,394) INFO - qlib.workflow - [exp.py:258] - Experiment 51 starts running ...
[3408179:MainThread](2024-04-25 20:23:28,413) INFO - qlib.workflow - [recorder.py:341] - Recorder 604ed2fb34bf432aa9f36163c535e244 starts running under Experiment 51 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   5%|▍         | 3/63 [00:00<00:02, 25.16it/s]online:  10%|▉         | 6/63 [00:00<00:02, 24.46it/s]online:  14%|█▍        | 9/63 [00:00<00:02, 24.43it/s]online:  19%|█▉        | 12/63 [00:00<00:02, 24.62it/s]online:  24%|██▍       | 15/63 [00:00<00:01, 24.50it/s]online:  29%|██▊       | 18/63 [00:00<00:01, 25.26it/s]online:  33%|███▎      | 21/63 [00:00<00:01, 25.43it/s]online:  38%|███▊      | 24/63 [00:00<00:01, 24.79it/s]online:  43%|████▎     | 27/63 [00:01<00:01, 24.59it/s]online:  48%|████▊     | 30/63 [00:01<00:01, 24.14it/s]online:  52%|█████▏    | 33/63 [00:01<00:01, 24.37it/s]online:  57%|█████▋    | 36/63 [00:01<00:01, 24.77it/s]online:  62%|██████▏   | 39/63 [00:01<00:00, 25.25it/s]online:  67%|██████▋   | 42/63 [00:01<00:00, 25.32it/s]online:  71%|███████▏  | 45/63 [00:01<00:00, 25.90it/s]online:  76%|███████▌  | 48/63 [00:01<00:00, 25.29it/s]online:  81%|████████  | 51/63 [00:02<00:00, 24.66it/s]online:  86%|████████▌ | 54/63 [00:02<00:00, 24.29it/s]online:  90%|█████████ | 57/63 [00:02<00:00, 24.56it/s]online:  95%|█████████▌| 60/63 [00:02<00:00, 24.71it/s]online: 100%|██████████| 63/63 [00:02<00:00, 25.11it/s]online: 100%|██████████| 63/63 [00:02<00:00, 24.86it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3408179:MainThread](2024-04-25 20:23:37,762) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 1.0015361 mae 0.70986015
{'IC': 0.021615467289584845,
 'ICIR': 0.1475390720500872,
 'Rank IC': 0.021063982914982134,
 'Rank ICIR': 0.14397438293035572}
[3408179:MainThread](2024-04-25 20:23:39,553) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3408179:MainThread](2024-04-25 20:23:52,203) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 20:23:52,206) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3408179:MainThread](2024-04-25 20:23:58,472) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1594a8e820>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:49,  8.84it/s]backtest loop:   1%|          | 9/971 [00:00<00:41, 23.44it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 33.45it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 38.11it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 43.51it/s]backtest loop:   3%|▎         | 32/971 [00:00<00:21, 44.24it/s]backtest loop:   4%|▍         | 37/971 [00:00<00:20, 45.82it/s]backtest loop:   4%|▍         | 42/971 [00:01<00:19, 46.94it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:18, 48.88it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:19, 46.80it/s]backtest loop:   6%|▌         | 60/971 [00:01<00:18, 48.13it/s]backtest loop:   7%|▋         | 65/971 [00:01<00:18, 48.59it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:17, 50.26it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:18, 47.89it/s]backtest loop:   9%|▊         | 83/971 [00:01<00:17, 49.58it/s]backtest loop:   9%|▉         | 89/971 [00:02<00:17, 50.51it/s]backtest loop:  10%|▉         | 95/971 [00:02<00:17, 51.28it/s]backtest loop:  10%|█         | 101/971 [00:02<00:16, 51.71it/s]backtest loop:  11%|█         | 107/971 [00:02<00:17, 49.04it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:17, 49.15it/s]backtest loop:  12%|█▏        | 118/971 [00:02<00:17, 50.16it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:16, 50.64it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:17, 47.96it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:17, 48.41it/s]backtest loop:  15%|█▍        | 141/971 [00:03<00:17, 46.78it/s]backtest loop:  15%|█▌        | 146/971 [00:03<00:17, 47.47it/s]backtest loop:  16%|█▌        | 151/971 [00:03<00:17, 47.42it/s]backtest loop:  16%|█▌        | 157/971 [00:03<00:16, 49.86it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:15, 51.92it/s]backtest loop:  17%|█▋        | 169/971 [00:03<00:15, 53.08it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:14, 54.19it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:15, 51.72it/s]backtest loop:  19%|█▉        | 187/971 [00:03<00:14, 53.33it/s]backtest loop:  20%|█▉        | 193/971 [00:04<00:14, 54.48it/s]backtest loop:  20%|██        | 199/971 [00:04<00:13, 55.41it/s]backtest loop:  21%|██        | 205/971 [00:04<00:14, 52.78it/s]backtest loop:  22%|██▏       | 211/971 [00:04<00:14, 54.13it/s]backtest loop:  22%|██▏       | 217/971 [00:04<00:14, 52.16it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:14, 53.40it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:13, 54.53it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:14, 52.01it/s]backtest loop:  25%|██▍       | 241/971 [00:04<00:13, 53.45it/s]backtest loop:  25%|██▌       | 247/971 [00:05<00:13, 54.10it/s]backtest loop:  26%|██▌       | 253/971 [00:05<00:12, 55.30it/s]backtest loop:  27%|██▋       | 259/971 [00:05<00:13, 52.83it/s]backtest loop:  27%|██▋       | 265/971 [00:05<00:13, 53.78it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:13, 51.66it/s]backtest loop:  29%|██▊       | 277/971 [00:05<00:13, 52.77it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:12, 53.78it/s]backtest loop:  30%|██▉       | 289/971 [00:05<00:12, 54.72it/s]backtest loop:  30%|███       | 295/971 [00:06<00:12, 52.25it/s]backtest loop:  31%|███       | 301/971 [00:06<00:12, 53.59it/s]backtest loop:  32%|███▏      | 307/971 [00:06<00:12, 54.64it/s]backtest loop:  32%|███▏      | 313/971 [00:06<00:11, 55.28it/s]backtest loop:  33%|███▎      | 319/971 [00:06<00:11, 55.90it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:12, 52.86it/s]backtest loop:  34%|███▍      | 331/971 [00:06<00:11, 54.14it/s]backtest loop:  35%|███▍      | 337/971 [00:06<00:11, 54.83it/s]backtest loop:  35%|███▌      | 343/971 [00:06<00:11, 55.34it/s]backtest loop:  36%|███▌      | 349/971 [00:06<00:11, 55.87it/s]backtest loop:  37%|███▋      | 355/971 [00:07<00:11, 53.28it/s]backtest loop:  37%|███▋      | 361/971 [00:07<00:11, 54.72it/s]backtest loop:  38%|███▊      | 367/971 [00:07<00:11, 52.26it/s]backtest loop:  38%|███▊      | 373/971 [00:07<00:11, 50.35it/s]backtest loop:  39%|███▉      | 379/971 [00:07<00:11, 51.97it/s]backtest loop:  40%|███▉      | 385/971 [00:07<00:10, 53.28it/s]backtest loop:  40%|████      | 391/971 [00:07<00:10, 54.25it/s]backtest loop:  41%|████      | 397/971 [00:07<00:10, 55.07it/s]backtest loop:  42%|████▏     | 403/971 [00:08<00:10, 52.24it/s]backtest loop:  42%|████▏     | 409/971 [00:08<00:10, 53.67it/s]backtest loop:  43%|████▎     | 415/971 [00:08<00:10, 54.52it/s]backtest loop:  43%|████▎     | 421/971 [00:08<00:09, 55.36it/s]backtest loop:  44%|████▍     | 427/971 [00:08<00:09, 55.91it/s]backtest loop:  45%|████▍     | 433/971 [00:08<00:10, 52.42it/s]backtest loop:  45%|████▌     | 439/971 [00:08<00:09, 53.43it/s]backtest loop:  46%|████▌     | 445/971 [00:08<00:09, 54.47it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:09, 54.93it/s]backtest loop:  47%|████▋     | 457/971 [00:09<00:09, 52.30it/s]backtest loop:  48%|████▊     | 463/971 [00:09<00:09, 53.35it/s]backtest loop:  48%|████▊     | 469/971 [00:09<00:09, 54.34it/s]backtest loop:  49%|████▉     | 475/971 [00:09<00:08, 55.47it/s]backtest loop:  50%|████▉     | 481/971 [00:09<00:08, 55.89it/s]backtest loop:  50%|█████     | 487/971 [00:09<00:09, 52.76it/s]backtest loop:  51%|█████     | 493/971 [00:09<00:08, 53.96it/s]backtest loop:  51%|█████▏    | 499/971 [00:09<00:08, 54.89it/s]backtest loop:  52%|█████▏    | 505/971 [00:09<00:08, 52.37it/s]backtest loop:  53%|█████▎    | 511/971 [00:10<00:08, 53.59it/s]backtest loop:  53%|█████▎    | 517/971 [00:10<00:08, 51.52it/s]backtest loop:  54%|█████▍    | 523/971 [00:10<00:08, 53.06it/s]backtest loop:  54%|█████▍    | 529/971 [00:10<00:08, 54.23it/s]backtest loop:  55%|█████▌    | 535/971 [00:10<00:07, 55.35it/s]backtest loop:  56%|█████▌    | 541/971 [00:10<00:08, 52.44it/s]backtest loop:  56%|█████▋    | 547/971 [00:10<00:07, 53.73it/s]backtest loop:  57%|█████▋    | 553/971 [00:10<00:07, 54.75it/s]backtest loop:  58%|█████▊    | 559/971 [00:10<00:07, 55.14it/s]backtest loop:  58%|█████▊    | 565/971 [00:10<00:07, 55.81it/s]backtest loop:  59%|█████▉    | 571/971 [00:11<00:07, 52.93it/s]backtest loop:  59%|█████▉    | 577/971 [00:11<00:07, 54.01it/s]backtest loop:  60%|██████    | 583/971 [00:11<00:07, 54.97it/s]backtest loop:  61%|██████    | 589/971 [00:11<00:06, 55.44it/s]backtest loop:  61%|██████▏   | 595/971 [00:11<00:06, 55.48it/s]backtest loop:  62%|██████▏   | 601/971 [00:11<00:07, 52.72it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 53.94it/s]backtest loop:  63%|██████▎   | 613/971 [00:11<00:06, 54.86it/s]backtest loop:  64%|██████▎   | 619/971 [00:12<00:10, 32.02it/s]backtest loop:  64%|██████▍   | 625/971 [00:12<00:09, 35.43it/s]backtest loop:  65%|██████▍   | 631/971 [00:12<00:08, 40.03it/s]backtest loop:  66%|██████▌   | 637/971 [00:12<00:07, 44.04it/s]backtest loop:  66%|██████▌   | 643/971 [00:12<00:06, 47.31it/s]backtest loop:  67%|██████▋   | 649/971 [00:12<00:06, 49.87it/s]backtest loop:  67%|██████▋   | 655/971 [00:12<00:06, 48.94it/s]backtest loop:  68%|██████▊   | 661/971 [00:13<00:06, 51.06it/s]backtest loop:  69%|██████▊   | 667/971 [00:13<00:05, 52.61it/s]backtest loop:  69%|██████▉   | 673/971 [00:13<00:05, 53.64it/s]backtest loop:  70%|██████▉   | 679/971 [00:13<00:05, 51.41it/s]backtest loop:  71%|███████   | 685/971 [00:13<00:05, 52.82it/s]backtest loop:  71%|███████   | 691/971 [00:13<00:05, 53.78it/s]backtest loop:  72%|███████▏  | 697/971 [00:13<00:05, 54.71it/s]backtest loop:  72%|███████▏  | 703/971 [00:13<00:04, 55.54it/s]backtest loop:  73%|███████▎  | 709/971 [00:13<00:04, 52.65it/s]backtest loop:  74%|███████▎  | 715/971 [00:14<00:04, 53.73it/s]backtest loop:  74%|███████▍  | 721/971 [00:14<00:04, 54.66it/s]backtest loop:  75%|███████▍  | 727/971 [00:14<00:04, 55.47it/s]backtest loop:  75%|███████▌  | 733/971 [00:14<00:04, 49.27it/s]backtest loop:  76%|███████▌  | 739/971 [00:14<00:04, 51.33it/s]backtest loop:  77%|███████▋  | 745/971 [00:14<00:04, 52.95it/s]backtest loop:  77%|███████▋  | 751/971 [00:14<00:04, 51.18it/s]backtest loop:  78%|███████▊  | 757/971 [00:14<00:04, 52.65it/s]backtest loop:  79%|███████▊  | 763/971 [00:14<00:03, 54.04it/s]backtest loop:  79%|███████▉  | 769/971 [00:15<00:03, 55.00it/s]backtest loop:  80%|███████▉  | 775/971 [00:15<00:03, 52.35it/s]backtest loop:  80%|████████  | 781/971 [00:15<00:03, 53.78it/s]backtest loop:  81%|████████  | 787/971 [00:15<00:03, 54.85it/s]backtest loop:  82%|████████▏ | 793/971 [00:15<00:03, 52.58it/s]backtest loop:  82%|████████▏ | 799/971 [00:15<00:03, 53.72it/s]backtest loop:  83%|████████▎ | 805/971 [00:15<00:03, 54.66it/s]backtest loop:  84%|████████▎ | 811/971 [00:15<00:02, 55.30it/s]backtest loop:  84%|████████▍ | 817/971 [00:15<00:02, 55.96it/s]backtest loop:  85%|████████▍ | 823/971 [00:16<00:02, 52.71it/s]backtest loop:  85%|████████▌ | 829/971 [00:16<00:02, 53.88it/s]backtest loop:  86%|████████▌ | 835/971 [00:16<00:02, 54.78it/s]backtest loop:  87%|████████▋ | 841/971 [00:16<00:02, 55.45it/s]backtest loop:  87%|████████▋ | 847/971 [00:16<00:02, 55.78it/s]backtest loop:  88%|████████▊ | 853/971 [00:16<00:02, 52.80it/s]backtest loop:  88%|████████▊ | 859/971 [00:16<00:02, 53.99it/s]backtest loop:  89%|████████▉ | 865/971 [00:16<00:01, 54.86it/s]backtest loop:  90%|████████▉ | 871/971 [00:16<00:01, 55.52it/s]backtest loop:  90%|█████████ | 877/971 [00:17<00:01, 52.62it/s]backtest loop:  91%|█████████ | 883/971 [00:17<00:01, 53.80it/s]backtest loop:  92%|█████████▏| 889/971 [00:17<00:01, 54.22it/s]backtest loop:  92%|█████████▏| 895/971 [00:17<00:01, 54.86it/s]backtest loop:  93%|█████████▎| 901/971 [00:17<00:01, 55.61it/s]backtest loop:  93%|█████████▎| 907/971 [00:17<00:01, 52.81it/s]backtest loop:  94%|█████████▍| 913/971 [00:17<00:01, 53.87it/s]backtest loop:  95%|█████████▍| 919/971 [00:17<00:00, 54.83it/s]backtest loop:  95%|█████████▌| 925/971 [00:17<00:00, 55.51it/s]backtest loop:  96%|█████████▌| 931/971 [00:18<00:00, 52.66it/s]backtest loop:  96%|█████████▋| 937/971 [00:18<00:00, 53.70it/s]backtest loop:  97%|█████████▋| 943/971 [00:18<00:00, 54.85it/s]backtest loop:  98%|█████████▊| 949/971 [00:18<00:00, 55.69it/s]backtest loop:  98%|█████████▊| 955/971 [00:18<00:00, 52.77it/s]backtest loop:  99%|█████████▉| 961/971 [00:18<00:00, 53.95it/s]backtest loop: 100%|█████████▉| 967/971 [00:18<00:00, 54.95it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 51.73it/s]
[3408179:MainThread](2024-04-25 20:24:17,327) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000438
std                0.006452
annualized_return  0.104284
information_ratio  1.047638
max_drawdown      -0.099296
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000242
std                0.006452
annualized_return  0.057510
information_ratio  0.577818
max_drawdown      -0.107382
[3408179:MainThread](2024-04-25 20:24:17,345) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 51
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_MLP_alpha360_horizon1_step20_rankFalse_2024-04-25_19:40:48_online`.
Round 10 Done!
{'1day.excess_return_with_cost.annualized_return': [0.057177137820259884,
                                                    0.08548363170297701,
                                                    0.08226411002449573,
                                                    0.08706121975225466,
                                                    0.08013060465524563,
                                                    0.07571558432705998,
                                                    0.07628304739056636,
                                                    0.08502783323648323,
                                                    0.08907643553965552,
                                                    0.05751020887622872],
 '1day.excess_return_with_cost.information_ratio': [0.5708410850384811,
                                                    0.845421016572987,
                                                    0.7978274309230767,
                                                    0.8369757920170999,
                                                    0.8381038258157765,
                                                    0.7336819149814031,
                                                    0.7635567445621011,
                                                    0.8357697360345328,
                                                    0.8897272972191618,
                                                    0.5778175667076613],
 '1day.excess_return_with_cost.max_drawdown': [-0.1369210363821404,
                                               -0.11977546407167693,
                                               -0.1034332552834204,
                                               -0.12308119808575027,
                                               -0.08510115880048863,
                                               -0.08921683499605616,
                                               -0.11658439508297297,
                                               -0.10552794082154454,
                                               -0.10339158479807933,
                                               -0.1073819419445659],
 'IC': [0.01965990918075504,
        0.017473035411976354,
        0.022471273042633803,
        0.014764623845075724,
        0.01618276252046565,
        0.017526135258189312,
        0.01968359506459353,
        0.019798322979279775,
        0.018741158658677842,
        0.021615467289584845],
 'ICIR': [0.1335802115342955,
          0.11199170785924299,
          0.1499332834341299,
          0.09867948469078397,
          0.12049670733212928,
          0.1254889069438199,
          0.13207641436532627,
          0.13792349545898205,
          0.12786199158178227,
          0.1475390720500872],
 'Rank IC': [0.020391620238398377,
             0.020504008283316912,
             0.02404224943985234,
             0.015979887830955906,
             0.017656452109903808,
             0.017278615004094867,
             0.020537665285686294,
             0.01918600894545256,
             0.01987243200718023,
             0.021063982914982134],
 'Rank ICIR': [0.13725662019635151,
               0.12869373013758173,
               0.16079934584854338,
               0.10527904193204127,
               0.1321966458897622,
               0.1261435732927875,
               0.13624013905361673,
               0.13495709765546768,
               0.13401083202236763,
               0.14397438293035572],
 'mae': [0.7102560997009277,
         0.7094312310218811,
         0.7095029354095459,
         0.7101821303367615,
         0.7123894691467285,
         0.7115300893783569,
         0.7095363140106201,
         0.7102060914039612,
         0.7096024751663208,
         0.7098601460456848],
 'mse': [1.0026987791061401,
         1.0009208917617798,
         1.0006343126296997,
         1.0026757717132568,
         1.0076842308044434,
         1.0052242279052734,
         1.0013188123703003,
         1.002673864364624,
         1.0009912252426147,
         1.0015361309051514]}
[3408179:MainThread](2024-04-25 20:24:18,620) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name csi300_MLP_alpha360_horizon1_step20_rankFalse_2024-04-25_19:40:48_final.
[3408179:MainThread](2024-04-25 20:24:18,662) INFO - qlib.workflow - [exp.py:258] - Experiment 52 starts running ...
[3408179:MainThread](2024-04-25 20:24:18,681) INFO - qlib.workflow - [recorder.py:341] - Recorder 2db404c22e5a47c19ae82350c2bdb143 starts running under Experiment 52 ...
Time cost: 210.7754107236862	50.182287669181825
Final results:
{'1day.excess_return_with_cost.annualized_return': [0.07757298133252268,
                                                    0.010920973322395194],
 '1day.excess_return_with_cost.information_ratio': [0.7689722409872282,
                                                    0.10592222824609993],
 '1day.excess_return_with_cost.max_drawdown': [-0.10904148102666955,
                                               0.014802450415524849],
 'IC': [0.01879162832512319, 0.0022459397856782553],
 'ICIR': [0.12855712752505793, 0.014780237128477257],
 'Rank IC': [0.019651292205982343, 0.00216080201619595],
 'Rank ICIR': [0.13395514089588753, 0.013237214735523455],
 'mae': [0.7102496981620788, 0.0009236686606610413],
 'mse': [1.0026358246803284, 0.0021163374548981546]}
Your final results can be found in the experiment named `csi300_MLP_alpha360_horizon1_step20_rankFalse_2024-04-25_19:40:48_final`.
All Done!
[3408179:MainThread](2024-04-25 20:24:19,985) INFO - qlib.timer - [log.py:127] - Time cost: 0.043s | waiting `async_log` Done

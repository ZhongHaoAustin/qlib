['main.py', 'run_all', '--forecast_model', 'ALSTM', '-num_head', '8', '--train_start=2008-01-01', '--train_end=2018-12-31', '--valid_start=2019-01-01', '--valid_end=2020-03-31', '--test_start=2020-04-01', '--test_end=2024-03-31', '--tau', '10', '--lr_da', '0.01', '--market', 'csi300', '--data_dir', 'crowd_data', '--rank_label', 'False', '--begin_valid_epoch', '30']
[2924289:MainThread](2024-04-24 21:48:03,119) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[2924289:MainThread](2024-04-24 21:48:03,121) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[2924289:MainThread](2024-04-24 21:48:03,122) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/crowd_data')}
Remove CSRankNorm
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
[2924289:MainThread](2024-04-24 21:48:09,937) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-02 00:00:00'), Timestamp('2008-01-29 00:00:00')), 'test': (Timestamp('2008-01-31 00:00:00'), Timestamp('2008-03-05 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/147 [00:00<?, ?it/s]creating meta tasks:  24%|██▍       | 36/147 [00:00<00:00, 356.64it/s]creating meta tasks:  52%|█████▏    | 76/147 [00:00<00:00, 377.21it/s]creating meta tasks:  80%|████████  | 118/147 [00:00<00:00, 392.51it/s]creating meta tasks: 100%|██████████| 147/147 [00:00<00:00, 391.51it/s]
[2924289:MainThread](2024-04-24 21:48:10,568) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'ALSTM', 'module_path': 'qlib.contrib.model.pytorch_alstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0, 'rnn_type': 'GRU'}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2019-01-02 00:00:00'), Timestamp('2019-01-29 00:00:00')), 'test': (Timestamp('2019-01-31 00:00:00'), Timestamp('2019-03-06 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/63 [00:00<?, ?it/s]creating meta tasks:  54%|█████▍    | 34/63 [00:00<00:00, 333.30it/s]creating meta tasks: 100%|██████████| 63/63 [00:00<00:00, 322.53it/s]
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2924289:MainThread](2024-04-24 21:48:11,474) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[2924289:MainThread](2024-04-24 21:48:11,875) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[2924289:MainThread](2024-04-24 21:48:11,879) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[2924289:MainThread](2024-04-24 21:48:11,879) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:10<16:30, 10.00s/it]epoch:   2%|▏         | 2/100 [00:18<14:59,  9.18s/it]epoch:   3%|▎         | 3/100 [00:27<14:32,  8.99s/it]epoch:   4%|▍         | 4/100 [00:35<14:02,  8.77s/it]epoch:   5%|▌         | 5/100 [00:44<13:41,  8.65s/it]epoch:   6%|▌         | 6/100 [00:52<13:27,  8.59s/it]epoch:   7%|▋         | 7/100 [01:01<13:18,  8.59s/it]epoch:   8%|▊         | 8/100 [01:09<13:05,  8.54s/it]epoch:   9%|▉         | 9/100 [01:18<12:51,  8.48s/it]epoch:  10%|█         | 10/100 [01:26<12:41,  8.47s/it]epoch:  11%|█         | 11/100 [01:35<12:38,  8.53s/it]epoch:  12%|█▏        | 12/100 [01:43<12:24,  8.46s/it]epoch:  13%|█▎        | 13/100 [01:51<12:16,  8.47s/it]epoch:  14%|█▍        | 14/100 [02:00<12:04,  8.42s/it]epoch:  15%|█▌        | 15/100 [02:08<11:52,  8.38s/it]epoch:  16%|█▌        | 16/100 [02:17<11:47,  8.43s/it]epoch:  17%|█▋        | 17/100 [02:25<11:41,  8.45s/it]epoch:  18%|█▊        | 18/100 [02:33<11:27,  8.39s/it]epoch:  19%|█▉        | 19/100 [02:42<11:21,  8.41s/it]epoch:  20%|██        | 20/100 [02:50<11:16,  8.46s/it]epoch:  21%|██        | 21/100 [02:59<11:03,  8.40s/it]epoch:  22%|██▏       | 22/100 [03:07<10:50,  8.34s/it]epoch:  23%|██▎       | 23/100 [03:15<10:44,  8.37s/it]epoch:  24%|██▍       | 24/100 [03:24<10:39,  8.42s/it]epoch:  25%|██▌       | 25/100 [03:32<10:34,  8.45s/it]epoch:  26%|██▌       | 26/100 [03:41<10:20,  8.38s/it]epoch:  27%|██▋       | 27/100 [03:49<10:09,  8.35s/it]epoch:  28%|██▊       | 28/100 [03:57<10:01,  8.36s/it]epoch:  29%|██▉       | 29/100 [04:06<09:53,  8.35s/it]epoch:  30%|███       | 30/100 [04:14<09:45,  8.37s/it]0.062259699175824704
best ic: 0.062259699175824704
epoch:  31%|███       | 31/100 [04:24<10:13,  8.89s/it]0.05563818040505711
epoch:  32%|███▏      | 32/100 [04:34<10:16,  9.07s/it]0.057901573560045064
epoch:  33%|███▎      | 33/100 [04:43<10:14,  9.17s/it]0.05920371700009338
epoch:  34%|███▍      | 34/100 [04:53<10:13,  9.30s/it]0.05611936730357762
epoch:  35%|███▌      | 35/100 [05:02<10:11,  9.41s/it]0.05605693385265249
epoch:  36%|███▌      | 36/100 [05:12<10:08,  9.51s/it]0.055699400725606786
epoch:  37%|███▋      | 37/100 [05:21<09:58,  9.50s/it]0.056655726206395966
epoch:  38%|███▊      | 38/100 [05:31<09:49,  9.50s/it]0.05421404477695938
epoch:  38%|███▊      | 38/100 [05:40<09:16,  8.97s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2924289:MainThread](2024-04-24 21:53:56,881) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name csi300_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_21:48:11_online.
[2924289:MainThread](2024-04-24 21:53:56,909) INFO - qlib.workflow - [exp.py:258] - Experiment 39 starts running ...
[2924289:MainThread](2024-04-24 21:53:57,873) INFO - qlib.workflow - [recorder.py:341] - Recorder 3b2ec1ab651146b8ac06bd199f30daa2 starts running under Experiment 39 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:04, 13.45it/s]online:   6%|▋         | 4/63 [00:00<00:04, 13.43it/s]online:  10%|▉         | 6/63 [00:00<00:04, 13.53it/s]online:  13%|█▎        | 8/63 [00:00<00:04, 13.71it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 13.71it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 13.76it/s]online:  22%|██▏       | 14/63 [00:01<00:03, 13.94it/s]online:  25%|██▌       | 16/63 [00:01<00:03, 13.80it/s]online:  29%|██▊       | 18/63 [00:01<00:03, 13.91it/s]online:  32%|███▏      | 20/63 [00:01<00:03, 13.89it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 13.82it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 13.92it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 13.84it/s]online:  44%|████▍     | 28/63 [00:02<00:02, 13.90it/s]online:  48%|████▊     | 30/63 [00:02<00:02, 13.96it/s]online:  51%|█████     | 32/63 [00:02<00:02, 13.96it/s]online:  54%|█████▍    | 34/63 [00:02<00:02, 13.79it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 13.83it/s]online:  60%|██████    | 38/63 [00:02<00:01, 13.61it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 13.50it/s]online:  67%|██████▋   | 42/63 [00:03<00:01, 13.47it/s]online:  70%|██████▉   | 44/63 [00:03<00:01, 13.48it/s]online:  73%|███████▎  | 46/63 [00:03<00:01, 13.58it/s]online:  76%|███████▌  | 48/63 [00:03<00:01, 13.72it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 13.66it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 13.85it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 13.80it/s]online:  89%|████████▉ | 56/63 [00:04<00:00, 13.84it/s]online:  92%|█████████▏| 58/63 [00:04<00:00, 13.81it/s]online:  95%|█████████▌| 60/63 [00:04<00:00, 13.87it/s]online:  98%|█████████▊| 62/63 [00:04<00:00, 13.81it/s]online: 100%|██████████| 63/63 [00:04<00:00, 13.78it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2924289:MainThread](2024-04-24 21:54:08,964) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99626774 mae 0.7075666
{'IC': 0.03247239452907499,
 'ICIR': 0.22552705133383394,
 'Rank IC': 0.031136367658080418,
 'Rank ICIR': 0.21727391618606592}
[2924289:MainThread](2024-04-24 21:54:10,700) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2924289:MainThread](2024-04-24 21:54:22,025) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 21:54:22,028) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 21:54:28,107) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f55ee4cd820>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 6/971 [00:00<00:17, 56.18it/s]backtest loop:   1%|          | 12/971 [00:00<00:18, 51.81it/s]backtest loop:   2%|▏         | 18/971 [00:00<00:17, 55.00it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:18, 52.57it/s]backtest loop:   3%|▎         | 30/971 [00:00<00:17, 54.63it/s]backtest loop:   4%|▎         | 36/971 [00:00<00:16, 56.34it/s]backtest loop:   4%|▍         | 43/971 [00:00<00:15, 58.36it/s]backtest loop:   5%|▌         | 49/971 [00:00<00:16, 55.58it/s]backtest loop:   6%|▌         | 55/971 [00:00<00:16, 56.79it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:15, 57.58it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 55.44it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 57.57it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 58.95it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 55.60it/s]backtest loop:  10%|▉         | 93/971 [00:01<00:15, 56.53it/s]backtest loop:  10%|█         | 99/971 [00:01<00:23, 36.78it/s]backtest loop:  11%|█         | 105/971 [00:02<00:20, 41.40it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:18, 45.54it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:18, 46.67it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:16, 50.95it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:16, 50.49it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:16, 49.98it/s]backtest loop:  15%|█▍        | 142/971 [00:02<00:15, 52.45it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:15, 54.29it/s]backtest loop:  16%|█▌        | 155/971 [00:02<00:14, 56.80it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 54.01it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:14, 56.33it/s]backtest loop:  18%|█▊        | 174/971 [00:03<00:13, 57.06it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:14, 55.44it/s]backtest loop:  19%|█▉        | 187/971 [00:03<00:13, 56.57it/s]backtest loop:  20%|█▉        | 193/971 [00:03<00:13, 57.47it/s]backtest loop:  21%|██        | 200/971 [00:03<00:13, 55.75it/s]backtest loop:  21%|██▏       | 207/971 [00:03<00:13, 58.01it/s]backtest loop:  22%|██▏       | 213/971 [00:03<00:13, 55.88it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 54.77it/s]backtest loop:  23%|██▎       | 226/971 [00:04<00:13, 56.06it/s]backtest loop:  24%|██▍       | 233/971 [00:04<00:12, 57.89it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:13, 56.23it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:12, 58.02it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:12, 56.08it/s]backtest loop:  27%|██▋       | 261/971 [00:04<00:12, 57.97it/s]backtest loop:  27%|██▋       | 267/971 [00:04<00:12, 55.55it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 56.59it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:11, 58.31it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 55.43it/s]backtest loop:  30%|███       | 292/971 [00:05<00:12, 56.22it/s]backtest loop:  31%|███       | 299/971 [00:05<00:11, 58.24it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:12, 55.14it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 57.52it/s]backtest loop:  33%|███▎      | 318/971 [00:05<00:11, 57.93it/s]backtest loop:  33%|███▎      | 325/971 [00:05<00:11, 55.87it/s]backtest loop:  34%|███▍      | 331/971 [00:06<00:11, 56.90it/s]backtest loop:  35%|███▍      | 338/971 [00:06<00:10, 58.59it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 56.38it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 58.99it/s]backtest loop:  37%|███▋      | 359/971 [00:06<00:10, 60.15it/s]backtest loop:  38%|███▊      | 366/971 [00:06<00:10, 57.67it/s]backtest loop:  38%|███▊      | 372/971 [00:06<00:10, 54.98it/s]backtest loop:  39%|███▉      | 378/971 [00:06<00:11, 53.31it/s]backtest loop:  40%|███▉      | 384/971 [00:07<00:10, 54.58it/s]backtest loop:  40%|████      | 390/971 [00:07<00:10, 55.97it/s]backtest loop:  41%|████      | 397/971 [00:07<00:09, 57.90it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 55.03it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:09, 57.35it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 59.03it/s]backtest loop:  44%|████▎     | 423/971 [00:07<00:09, 56.05it/s]backtest loop:  44%|████▍     | 430/971 [00:07<00:09, 57.83it/s]backtest loop:  45%|████▍     | 436/971 [00:07<00:09, 58.40it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:09, 55.57it/s]backtest loop:  46%|████▌     | 448/971 [00:08<00:09, 56.51it/s]backtest loop:  47%|████▋     | 455/971 [00:08<00:08, 58.20it/s]backtest loop:  48%|████▊     | 462/971 [00:08<00:09, 56.09it/s]backtest loop:  48%|████▊     | 468/971 [00:08<00:08, 56.94it/s]backtest loop:  49%|████▉     | 475/971 [00:08<00:08, 58.67it/s]backtest loop:  50%|████▉     | 481/971 [00:08<00:08, 58.57it/s]backtest loop:  50%|█████     | 487/971 [00:08<00:09, 51.67it/s]backtest loop:  51%|█████     | 493/971 [00:08<00:09, 52.46it/s]backtest loop:  51%|█████▏    | 499/971 [00:09<00:08, 54.35it/s]backtest loop:  52%|█████▏    | 505/971 [00:09<00:08, 52.79it/s]backtest loop:  53%|█████▎    | 511/971 [00:09<00:08, 54.60it/s]backtest loop:  53%|█████▎    | 517/971 [00:09<00:08, 53.05it/s]backtest loop:  54%|█████▍    | 524/971 [00:09<00:07, 55.91it/s]backtest loop:  55%|█████▍    | 530/971 [00:09<00:07, 57.01it/s]backtest loop:  55%|█████▌    | 536/971 [00:09<00:07, 54.90it/s]backtest loop:  56%|█████▌    | 542/971 [00:09<00:07, 56.17it/s]backtest loop:  57%|█████▋    | 549/971 [00:09<00:07, 58.00it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:07, 56.09it/s]backtest loop:  58%|█████▊    | 562/971 [00:10<00:07, 56.69it/s]backtest loop:  59%|█████▊    | 569/971 [00:10<00:06, 58.32it/s]backtest loop:  59%|█████▉    | 576/971 [00:10<00:06, 56.46it/s]backtest loop:  60%|█████▉    | 582/971 [00:10<00:06, 57.13it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:06, 57.88it/s]backtest loop:  61%|██████▏   | 595/971 [00:10<00:06, 59.23it/s]backtest loop:  62%|██████▏   | 601/971 [00:10<00:06, 56.14it/s]backtest loop:  63%|██████▎   | 608/971 [00:10<00:06, 57.94it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:06, 56.02it/s]backtest loop:  64%|██████▍   | 622/971 [00:11<00:06, 57.85it/s]backtest loop:  65%|██████▍   | 629/971 [00:11<00:05, 59.31it/s]backtest loop:  65%|██████▌   | 635/971 [00:11<00:05, 56.17it/s]backtest loop:  66%|██████▌   | 642/971 [00:11<00:05, 58.48it/s]backtest loop:  67%|██████▋   | 649/971 [00:11<00:05, 59.70it/s]backtest loop:  67%|██████▋   | 655/971 [00:11<00:05, 56.26it/s]backtest loop:  68%|██████▊   | 662/971 [00:11<00:05, 57.99it/s]backtest loop:  69%|██████▉   | 669/971 [00:12<00:05, 59.24it/s]backtest loop:  70%|██████▉   | 675/971 [00:12<00:05, 55.79it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:05, 56.88it/s]backtest loop:  71%|███████   | 687/971 [00:12<00:04, 57.70it/s]backtest loop:  71%|███████▏  | 693/971 [00:12<00:04, 58.34it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 55.23it/s]backtest loop:  73%|███████▎  | 706/971 [00:12<00:04, 57.30it/s]backtest loop:  73%|███████▎  | 713/971 [00:12<00:04, 58.80it/s]backtest loop:  74%|███████▍  | 719/971 [00:12<00:04, 55.83it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 57.71it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 55.05it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 53.18it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:04, 55.92it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 53.65it/s]backtest loop:  78%|███████▊  | 758/971 [00:13<00:03, 56.14it/s]backtest loop:  79%|███████▉  | 765/971 [00:13<00:03, 54.89it/s]backtest loop:  79%|███████▉  | 771/971 [00:13<00:03, 55.77it/s]backtest loop:  80%|████████  | 778/971 [00:13<00:03, 57.70it/s]backtest loop:  81%|████████  | 784/971 [00:14<00:03, 55.37it/s]backtest loop:  81%|████████▏ | 791/971 [00:14<00:03, 57.48it/s]backtest loop:  82%|████████▏ | 797/971 [00:14<00:03, 57.88it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:03, 55.18it/s]backtest loop:  83%|████████▎ | 809/971 [00:14<00:02, 56.47it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 57.24it/s]backtest loop:  85%|████████▍ | 822/971 [00:14<00:02, 58.81it/s]backtest loop:  85%|████████▌ | 828/971 [00:14<00:02, 55.65it/s]backtest loop:  86%|████████▌ | 834/971 [00:14<00:02, 56.78it/s]backtest loop:  87%|████████▋ | 840/971 [00:15<00:02, 57.52it/s]backtest loop:  87%|████████▋ | 847/971 [00:15<00:02, 59.00it/s]backtest loop:  88%|████████▊ | 853/971 [00:15<00:02, 55.92it/s]backtest loop:  89%|████████▊ | 860/971 [00:15<00:01, 57.96it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 58.38it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 55.41it/s]backtest loop:  91%|█████████ | 879/971 [00:15<00:01, 57.51it/s]backtest loop:  91%|█████████ | 885/971 [00:15<00:01, 58.05it/s]backtest loop:  92%|█████████▏| 892/971 [00:15<00:01, 55.98it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 57.87it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 59.16it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 55.91it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 57.71it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 56.01it/s]backtest loop:  96%|█████████▌| 932/971 [00:16<00:00, 56.78it/s]backtest loop:  97%|█████████▋| 939/971 [00:16<00:00, 58.34it/s]backtest loop:  97%|█████████▋| 945/971 [00:16<00:00, 55.60it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 57.55it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 58.88it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 55.94it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 56.00it/s]
[2924289:MainThread](2024-04-24 21:54:45,521) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000717
std                0.005678
annualized_return  0.170559
information_ratio  1.947107
max_drawdown      -0.066751
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000520
std                0.005678
annualized_return  0.123870
information_ratio  1.414047
max_drawdown      -0.080394
[2924289:MainThread](2024-04-24 21:54:45,539) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_21:48:11_online`.
Round 1 Done!
{'1day.excess_return_with_cost.annualized_return': [0.12386974698091249],
 '1day.excess_return_with_cost.information_ratio': [1.414046816672812],
 '1day.excess_return_with_cost.max_drawdown': [-0.08039447825046309],
 'IC': [0.03247239452907499],
 'ICIR': [0.22552705133383394],
 'Rank IC': [0.031136367658080418],
 'Rank ICIR': [0.21727391618606592],
 'mae': [0.7075666189193726],
 'mse': [0.9962677359580994]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2924289:MainThread](2024-04-24 21:54:46,687) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[2924289:MainThread](2024-04-24 21:54:46,687) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[2924289:MainThread](2024-04-24 21:54:46,689) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[2924289:MainThread](2024-04-24 21:54:46,690) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:08<14:34,  8.84s/it]epoch:   2%|▏         | 2/100 [00:17<14:06,  8.64s/it]epoch:   3%|▎         | 3/100 [00:25<13:57,  8.63s/it]epoch:   4%|▍         | 4/100 [00:34<13:42,  8.57s/it]epoch:   5%|▌         | 5/100 [00:42<13:29,  8.52s/it]epoch:   6%|▌         | 6/100 [00:51<13:27,  8.59s/it]epoch:   7%|▋         | 7/100 [01:00<13:13,  8.53s/it]epoch:   8%|▊         | 8/100 [01:08<13:04,  8.52s/it]epoch:   9%|▉         | 9/100 [01:17<12:58,  8.55s/it]epoch:  10%|█         | 10/100 [01:25<12:46,  8.52s/it]epoch:  11%|█         | 11/100 [01:34<12:38,  8.52s/it]epoch:  12%|█▏        | 12/100 [01:42<12:34,  8.58s/it]epoch:  13%|█▎        | 13/100 [01:51<12:18,  8.49s/it]epoch:  14%|█▍        | 14/100 [01:59<12:05,  8.44s/it]epoch:  15%|█▌        | 15/100 [02:07<11:56,  8.43s/it]epoch:  16%|█▌        | 16/100 [02:16<11:55,  8.52s/it]epoch:  17%|█▋        | 17/100 [02:25<11:46,  8.51s/it]epoch:  18%|█▊        | 18/100 [02:33<11:35,  8.48s/it]epoch:  19%|█▉        | 19/100 [02:41<11:26,  8.48s/it]epoch:  20%|██        | 20/100 [02:50<11:19,  8.49s/it]epoch:  21%|██        | 21/100 [02:59<11:13,  8.52s/it]epoch:  22%|██▏       | 22/100 [03:07<11:04,  8.52s/it]epoch:  23%|██▎       | 23/100 [03:16<10:54,  8.50s/it]epoch:  24%|██▍       | 24/100 [03:24<10:43,  8.46s/it]epoch:  25%|██▌       | 25/100 [03:32<10:32,  8.43s/it]epoch:  26%|██▌       | 26/100 [03:41<10:27,  8.47s/it]epoch:  27%|██▋       | 27/100 [03:49<10:20,  8.50s/it]epoch:  28%|██▊       | 28/100 [03:58<10:08,  8.46s/it]epoch:  29%|██▉       | 29/100 [04:06<09:55,  8.38s/it]epoch:  30%|███       | 30/100 [04:14<09:41,  8.31s/it]0.05102751148581348
best ic: 0.05102751148581348
epoch:  31%|███       | 31/100 [04:24<09:57,  8.66s/it]0.05445133285762324
best ic: 0.05445133285762324
epoch:  32%|███▏      | 32/100 [04:33<10:06,  8.91s/it]0.05434703898916501
epoch:  33%|███▎      | 33/100 [04:43<10:11,  9.13s/it]0.055931249896507156
best ic: 0.055931249896507156
epoch:  34%|███▍      | 34/100 [04:52<10:15,  9.32s/it]0.05450177373627016
epoch:  35%|███▌      | 35/100 [05:02<10:11,  9.40s/it]0.055097816356500975
epoch:  36%|███▌      | 36/100 [05:12<10:03,  9.43s/it]0.05311566381287046
epoch:  37%|███▋      | 37/100 [05:21<09:57,  9.48s/it]0.05385111543229844
epoch:  38%|███▊      | 38/100 [05:31<09:48,  9.50s/it]0.05139000821704375
epoch:  39%|███▉      | 39/100 [05:40<09:44,  9.57s/it]0.048087419744152225
epoch:  40%|████      | 40/100 [05:50<09:37,  9.62s/it]0.053615789257044
epoch:  41%|████      | 41/100 [06:00<09:26,  9.60s/it]0.052859652642946675
epoch:  41%|████      | 41/100 [06:10<08:52,  9.03s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2924289:MainThread](2024-04-24 22:00:56,769) INFO - qlib.workflow - [exp.py:258] - Experiment 39 starts running ...
[2924289:MainThread](2024-04-24 22:00:56,782) INFO - qlib.workflow - [recorder.py:341] - Recorder dff93e482a0d49d68a79afa80d445b83 starts running under Experiment 39 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:04, 14.21it/s]online:   6%|▋         | 4/63 [00:00<00:03, 14.84it/s]online:  10%|▉         | 6/63 [00:00<00:03, 14.71it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 14.90it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 14.75it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 14.64it/s]online:  22%|██▏       | 14/63 [00:00<00:03, 14.69it/s]online:  25%|██▌       | 16/63 [00:01<00:03, 14.81it/s]online:  29%|██▊       | 18/63 [00:01<00:03, 14.80it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 15.01it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 14.82it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 14.74it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 14.74it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 14.70it/s]online:  48%|████▊     | 30/63 [00:02<00:02, 14.74it/s]online:  51%|█████     | 32/63 [00:02<00:02, 14.92it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 14.94it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 15.02it/s]online:  60%|██████    | 38/63 [00:02<00:01, 15.07it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 15.11it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 15.14it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 14.93it/s]online:  73%|███████▎  | 46/63 [00:03<00:01, 14.79it/s]online:  76%|███████▌  | 48/63 [00:03<00:01, 14.70it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 14.53it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 14.38it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 14.61it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 14.80it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 14.59it/s]online:  95%|█████████▌| 60/63 [00:04<00:00, 14.52it/s]online:  98%|█████████▊| 62/63 [00:04<00:00, 14.47it/s]online: 100%|██████████| 63/63 [00:04<00:00, 14.28it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2924289:MainThread](2024-04-24 22:01:07,443) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99573505 mae 0.7071626
{'IC': 0.034917389108111305,
 'ICIR': 0.24081672568443255,
 'Rank IC': 0.03398929167284011,
 'Rank ICIR': 0.23611117650462315}
[2924289:MainThread](2024-04-24 22:01:09,170) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2924289:MainThread](2024-04-24 22:01:20,723) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 22:01:20,726) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 22:01:26,759) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f55fd834be0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:37,  9.94it/s]backtest loop:   1%|          | 9/971 [00:00<00:37, 25.81it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:26, 36.43it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.91it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:19, 47.62it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:20, 46.74it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:18, 51.27it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 54.65it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 52.46it/s]backtest loop:   6%|▌         | 60/971 [00:01<00:16, 54.38it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 53.83it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 56.17it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 58.04it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:16, 55.14it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 57.25it/s]backtest loop:  10%|█         | 100/971 [00:02<00:15, 57.90it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 55.94it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 57.75it/s]backtest loop:  12%|█▏        | 120/971 [00:02<00:14, 58.25it/s]backtest loop:  13%|█▎        | 126/971 [00:02<00:16, 52.56it/s]backtest loop:  14%|█▎        | 132/971 [00:02<00:15, 54.23it/s]backtest loop:  14%|█▍        | 139/971 [00:02<00:14, 56.44it/s]backtest loop:  15%|█▌        | 146/971 [00:02<00:15, 54.87it/s]backtest loop:  16%|█▌        | 152/971 [00:02<00:14, 56.03it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:14, 57.81it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:13, 58.26it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:14, 55.45it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:14, 56.45it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:13, 57.44it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:14, 55.46it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 57.37it/s]backtest loop:  21%|██        | 204/971 [00:03<00:12, 59.22it/s]backtest loop:  22%|██▏       | 210/971 [00:03<00:13, 56.41it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 54.60it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:13, 55.28it/s]backtest loop:  23%|██▎       | 228/971 [00:04<00:13, 56.53it/s]backtest loop:  24%|██▍       | 234/971 [00:04<00:12, 57.27it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:13, 54.77it/s]backtest loop:  25%|██▌       | 246/971 [00:04<00:12, 55.95it/s]backtest loop:  26%|██▌       | 253/971 [00:04<00:12, 58.05it/s]backtest loop:  27%|██▋       | 259/971 [00:04<00:12, 55.11it/s]backtest loop:  27%|██▋       | 266/971 [00:04<00:13, 54.23it/s]backtest loop:  28%|██▊       | 272/971 [00:05<00:12, 55.70it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:11, 57.90it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:11, 58.44it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 55.11it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 57.43it/s]backtest loop:  31%|███▏      | 304/971 [00:05<00:11, 57.81it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:12, 54.70it/s]backtest loop:  33%|███▎      | 316/971 [00:05<00:11, 55.69it/s]backtest loop:  33%|███▎      | 323/971 [00:05<00:11, 57.77it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:11, 55.91it/s]backtest loop:  35%|███▍      | 337/971 [00:06<00:10, 57.67it/s]backtest loop:  35%|███▌      | 343/971 [00:06<00:10, 58.12it/s]backtest loop:  36%|███▌      | 350/971 [00:06<00:11, 56.26it/s]backtest loop:  37%|███▋      | 356/971 [00:06<00:10, 57.20it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:10, 55.83it/s]backtest loop:  38%|███▊      | 369/971 [00:06<00:11, 53.69it/s]backtest loop:  39%|███▊      | 376/971 [00:06<00:10, 56.41it/s]backtest loop:  39%|███▉      | 382/971 [00:07<00:10, 56.96it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:10, 54.66it/s]backtest loop:  41%|████      | 395/971 [00:07<00:10, 56.81it/s]backtest loop:  41%|████▏     | 401/971 [00:07<00:09, 57.42it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 58.09it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:10, 55.03it/s]backtest loop:  43%|████▎     | 419/971 [00:07<00:09, 56.27it/s]backtest loop:  44%|████▍     | 425/971 [00:08<00:15, 34.80it/s]backtest loop:  44%|████▍     | 431/971 [00:08<00:13, 39.73it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:12, 41.99it/s]backtest loop:  46%|████▌     | 443/971 [00:08<00:11, 46.10it/s]backtest loop:  46%|████▌     | 449/971 [00:08<00:10, 49.52it/s]backtest loop:  47%|████▋     | 455/971 [00:08<00:09, 52.05it/s]backtest loop:  47%|████▋     | 461/971 [00:08<00:09, 54.13it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:09, 52.35it/s]backtest loop:  49%|████▊     | 473/971 [00:08<00:09, 54.34it/s]backtest loop:  49%|████▉     | 480/971 [00:08<00:08, 56.70it/s]backtest loop:  50%|█████     | 486/971 [00:09<00:08, 57.26it/s]backtest loop:  51%|█████     | 492/971 [00:09<00:08, 54.65it/s]backtest loop:  51%|█████▏    | 498/971 [00:09<00:08, 56.01it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:08, 56.83it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:08, 54.39it/s]backtest loop:  53%|█████▎    | 517/971 [00:09<00:08, 53.54it/s]backtest loop:  54%|█████▍    | 523/971 [00:09<00:08, 55.17it/s]backtest loop:  54%|█████▍    | 529/971 [00:09<00:07, 56.40it/s]backtest loop:  55%|█████▌    | 536/971 [00:09<00:07, 54.86it/s]backtest loop:  56%|█████▌    | 542/971 [00:10<00:07, 56.15it/s]backtest loop:  56%|█████▋    | 548/971 [00:10<00:07, 57.08it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 58.73it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 55.62it/s]backtest loop:  58%|█████▊    | 567/971 [00:10<00:07, 56.45it/s]backtest loop:  59%|█████▉    | 574/971 [00:10<00:06, 58.13it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 58.62it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:07, 54.90it/s]backtest loop:  61%|██████    | 593/971 [00:10<00:06, 57.01it/s]backtest loop:  62%|██████▏   | 600/971 [00:11<00:06, 55.21it/s]backtest loop:  62%|██████▏   | 606/971 [00:11<00:06, 56.46it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 57.40it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:05, 59.10it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 55.72it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 57.73it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 58.98it/s]backtest loop:  66%|██████▋   | 645/971 [00:11<00:06, 53.57it/s]backtest loop:  67%|██████▋   | 651/971 [00:12<00:05, 54.89it/s]backtest loop:  68%|██████▊   | 657/971 [00:12<00:05, 56.22it/s]backtest loop:  68%|██████▊   | 663/971 [00:12<00:05, 57.14it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 55.34it/s]backtest loop:  70%|██████▉   | 677/971 [00:12<00:05, 57.44it/s]backtest loop:  70%|███████   | 683/971 [00:12<00:04, 57.79it/s]backtest loop:  71%|███████   | 689/971 [00:12<00:05, 55.20it/s]backtest loop:  72%|███████▏  | 695/971 [00:12<00:04, 56.48it/s]backtest loop:  72%|███████▏  | 702/971 [00:12<00:04, 58.26it/s]backtest loop:  73%|███████▎  | 709/971 [00:13<00:04, 56.23it/s]backtest loop:  74%|███████▎  | 716/971 [00:13<00:04, 58.01it/s]backtest loop:  74%|███████▍  | 722/971 [00:13<00:04, 58.52it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 56.54it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 54.55it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 55.95it/s]backtest loop:  77%|███████▋  | 747/971 [00:13<00:03, 57.01it/s]backtest loop:  78%|███████▊  | 753/971 [00:13<00:04, 54.47it/s]backtest loop:  78%|███████▊  | 759/971 [00:13<00:03, 55.93it/s]backtest loop:  79%|███████▉  | 765/971 [00:14<00:03, 53.83it/s]backtest loop:  79%|███████▉  | 771/971 [00:14<00:03, 55.50it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 56.63it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 54.43it/s]backtest loop:  81%|████████▏ | 790/971 [00:14<00:03, 56.80it/s]backtest loop:  82%|████████▏ | 796/971 [00:14<00:03, 57.34it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 57.97it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 55.02it/s]backtest loop:  84%|████████▍ | 814/971 [00:14<00:02, 56.09it/s]backtest loop:  84%|████████▍ | 820/971 [00:15<00:02, 57.04it/s]backtest loop:  85%|████████▌ | 826/971 [00:15<00:02, 57.85it/s]backtest loop:  86%|████████▌ | 832/971 [00:15<00:02, 58.46it/s]backtest loop:  86%|████████▋ | 838/971 [00:15<00:02, 55.03it/s]backtest loop:  87%|████████▋ | 844/971 [00:15<00:02, 56.38it/s]backtest loop:  88%|████████▊ | 850/971 [00:15<00:02, 57.35it/s]backtest loop:  88%|████████▊ | 856/971 [00:15<00:01, 57.80it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 54.84it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 56.65it/s]backtest loop:  90%|█████████ | 875/971 [00:15<00:01, 57.29it/s]backtest loop:  91%|█████████ | 881/971 [00:16<00:01, 58.03it/s]backtest loop:  91%|█████████▏| 887/971 [00:16<00:01, 55.17it/s]backtest loop:  92%|█████████▏| 893/971 [00:16<00:01, 56.39it/s]backtest loop:  93%|█████████▎| 900/971 [00:16<00:01, 58.21it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 56.12it/s]backtest loop:  94%|█████████▍| 913/971 [00:16<00:01, 56.83it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 57.67it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 55.70it/s]backtest loop:  96%|█████████▌| 932/971 [00:16<00:00, 56.48it/s]backtest loop:  97%|█████████▋| 938/971 [00:17<00:00, 57.40it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 55.46it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 57.37it/s]backtest loop:  99%|█████████▊| 958/971 [00:17<00:00, 57.71it/s]backtest loop:  99%|█████████▉| 964/971 [00:17<00:00, 58.31it/s]backtest loop: 100%|█████████▉| 970/971 [00:17<00:00, 55.36it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.94it/s]
[2924289:MainThread](2024-04-24 22:01:44,508) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000701
std                0.005439
annualized_return  0.166740
information_ratio  1.987166
max_drawdown      -0.062314
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000504
std                0.005441
annualized_return  0.119873
information_ratio  1.428098
max_drawdown      -0.072480
[2924289:MainThread](2024-04-24 22:01:44,524) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_21:48:11_online`.
Round 2 Done!
{'1day.excess_return_with_cost.annualized_return': [0.12386974698091249,
                                                    0.1198726782033047],
 '1day.excess_return_with_cost.information_ratio': [1.414046816672812,
                                                    1.428098235977815],
 '1day.excess_return_with_cost.max_drawdown': [-0.08039447825046309,
                                               -0.0724795167180563],
 'IC': [0.03247239452907499, 0.034917389108111305],
 'ICIR': [0.22552705133383394, 0.24081672568443255],
 'Rank IC': [0.031136367658080418, 0.03398929167284011],
 'Rank ICIR': [0.21727391618606592, 0.23611117650462315],
 'mae': [0.7075666189193726, 0.707162618637085],
 'mse': [0.9962677359580994, 0.9957350492477417]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2924289:MainThread](2024-04-24 22:01:45,708) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[2924289:MainThread](2024-04-24 22:01:45,708) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[2924289:MainThread](2024-04-24 22:01:45,710) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[2924289:MainThread](2024-04-24 22:01:45,711) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:08<14:30,  8.79s/it]epoch:   2%|▏         | 2/100 [00:17<14:12,  8.70s/it]epoch:   3%|▎         | 3/100 [00:25<13:54,  8.60s/it]epoch:   4%|▍         | 4/100 [00:34<13:51,  8.66s/it]epoch:   5%|▌         | 5/100 [00:43<13:35,  8.58s/it]epoch:   6%|▌         | 6/100 [00:51<13:23,  8.54s/it]epoch:   7%|▋         | 7/100 [01:00<13:12,  8.52s/it]epoch:   8%|▊         | 8/100 [01:08<12:53,  8.41s/it]epoch:   9%|▉         | 9/100 [01:16<12:52,  8.49s/it]epoch:  10%|█         | 10/100 [01:25<12:45,  8.51s/it]epoch:  11%|█         | 11/100 [01:33<12:31,  8.44s/it]epoch:  12%|█▏        | 12/100 [01:42<12:20,  8.41s/it]epoch:  13%|█▎        | 13/100 [01:50<12:17,  8.48s/it]epoch:  14%|█▍        | 14/100 [01:58<12:02,  8.40s/it]epoch:  15%|█▌        | 15/100 [02:07<11:47,  8.32s/it]epoch:  16%|█▌        | 16/100 [02:15<11:41,  8.35s/it]epoch:  17%|█▋        | 17/100 [02:24<11:58,  8.66s/it]epoch:  18%|█▊        | 18/100 [02:35<12:36,  9.22s/it]epoch:  19%|█▉        | 19/100 [02:46<13:11,  9.77s/it]epoch:  20%|██        | 20/100 [02:57<13:33, 10.17s/it]epoch:  21%|██        | 21/100 [03:06<12:50,  9.75s/it]epoch:  22%|██▏       | 22/100 [03:15<12:19,  9.48s/it]epoch:  23%|██▎       | 23/100 [03:23<11:55,  9.29s/it]epoch:  24%|██▍       | 24/100 [03:32<11:33,  9.13s/it]epoch:  25%|██▌       | 25/100 [03:41<11:15,  9.00s/it]epoch:  26%|██▌       | 26/100 [03:50<11:00,  8.92s/it]epoch:  27%|██▋       | 27/100 [03:58<10:46,  8.85s/it]epoch:  28%|██▊       | 28/100 [04:07<10:30,  8.76s/it]epoch:  29%|██▉       | 29/100 [04:15<10:15,  8.67s/it]epoch:  30%|███       | 30/100 [04:24<10:05,  8.65s/it]0.05343728349126337
best ic: 0.05343728349126337
epoch:  31%|███       | 31/100 [04:34<10:18,  8.96s/it]0.05473437086240387
best ic: 0.05473437086240387
epoch:  32%|███▏      | 32/100 [04:44<10:29,  9.26s/it]0.05863468448392254
best ic: 0.05863468448392254
epoch:  33%|███▎      | 33/100 [04:53<10:28,  9.38s/it]0.05735175919557853
epoch:  34%|███▍      | 34/100 [05:03<10:28,  9.52s/it]0.05487633107549621
epoch:  35%|███▌      | 35/100 [05:13<10:20,  9.55s/it]0.05886226357074295
best ic: 0.05886226357074295
epoch:  36%|███▌      | 36/100 [05:22<10:08,  9.51s/it]0.05677731632418992
epoch:  37%|███▋      | 37/100 [05:32<10:03,  9.57s/it]0.05312001059831162
epoch:  38%|███▊      | 38/100 [05:42<09:56,  9.63s/it]0.049597834299725356
epoch:  39%|███▉      | 39/100 [05:51<09:46,  9.61s/it]0.05370472082485963
epoch:  40%|████      | 40/100 [06:01<09:36,  9.60s/it]0.05523732494662008
epoch:  41%|████      | 41/100 [06:11<09:33,  9.73s/it]0.051608589838180896
epoch:  42%|████▏     | 42/100 [06:21<09:24,  9.73s/it]0.05431436614485168
epoch:  43%|████▎     | 43/100 [06:30<09:10,  9.67s/it]0.05385243646776916
epoch:  43%|████▎     | 43/100 [06:40<08:50,  9.30s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2924289:MainThread](2024-04-24 22:08:25,812) INFO - qlib.workflow - [exp.py:258] - Experiment 39 starts running ...
[2924289:MainThread](2024-04-24 22:08:25,825) INFO - qlib.workflow - [recorder.py:341] - Recorder 850a9fece01c49f595edaf3d1dadc87b starts running under Experiment 39 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:04, 14.03it/s]online:   6%|▋         | 4/63 [00:00<00:04, 14.35it/s]online:  10%|▉         | 6/63 [00:00<00:03, 14.65it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 14.55it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 14.57it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 14.53it/s]online:  22%|██▏       | 14/63 [00:00<00:03, 14.62it/s]online:  25%|██▌       | 16/63 [00:01<00:03, 14.63it/s]online:  29%|██▊       | 18/63 [00:01<00:03, 14.76it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 14.80it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 14.61it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 14.63it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 14.65it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 14.68it/s]online:  48%|████▊     | 30/63 [00:02<00:02, 14.56it/s]online:  51%|█████     | 32/63 [00:02<00:02, 14.72it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 14.77it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 14.70it/s]online:  60%|██████    | 38/63 [00:02<00:01, 14.73it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 14.75it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 14.84it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 14.90it/s]online:  73%|███████▎  | 46/63 [00:03<00:01, 14.73it/s]online:  76%|███████▌  | 48/63 [00:03<00:00, 15.01it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 14.72it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 14.77it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 14.62it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 14.62it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 14.65it/s]online:  95%|█████████▌| 60/63 [00:04<00:00, 15.02it/s]online:  98%|█████████▊| 62/63 [00:04<00:00, 14.78it/s]online: 100%|██████████| 63/63 [00:04<00:00, 14.72it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2924289:MainThread](2024-04-24 22:08:38,712) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99651796 mae 0.70765877
{'IC': 0.02964435031889077,
 'ICIR': 0.20714330233910136,
 'Rank IC': 0.0262953640059444,
 'Rank ICIR': 0.18299316660535125}
[2924289:MainThread](2024-04-24 22:08:40,458) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2924289:MainThread](2024-04-24 22:08:52,531) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 22:08:52,534) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 22:08:58,658) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f55e6c08370>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:40,  9.64it/s]backtest loop:   1%|          | 9/971 [00:00<00:37, 25.34it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:26, 35.96it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.51it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:19, 47.40it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.96it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.32it/s]backtest loop:   5%|▍         | 47/971 [00:01<00:16, 54.42it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.54it/s]backtest loop:   6%|▌         | 60/971 [00:01<00:16, 55.14it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.21it/s]backtest loop:   8%|▊         | 73/971 [00:01<00:16, 55.72it/s]backtest loop:   8%|▊         | 80/971 [00:01<00:15, 57.61it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 55.88it/s]backtest loop:  10%|▉         | 93/971 [00:01<00:15, 56.87it/s]backtest loop:  10%|█         | 99/971 [00:02<00:15, 57.66it/s]backtest loop:  11%|█         | 106/971 [00:02<00:14, 59.32it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 56.11it/s]backtest loop:  12%|█▏        | 118/971 [00:02<00:14, 57.15it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 55.55it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 53.37it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:14, 56.01it/s]backtest loop:  15%|█▍        | 144/971 [00:02<00:14, 56.76it/s]backtest loop:  16%|█▌        | 151/971 [00:02<00:14, 55.31it/s]backtest loop:  16%|█▌        | 157/971 [00:03<00:14, 56.47it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:14, 57.41it/s]backtest loop:  17%|█▋        | 169/971 [00:03<00:13, 58.05it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 56.00it/s]backtest loop:  19%|█▊        | 182/971 [00:03<00:13, 57.08it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:13, 58.65it/s]backtest loop:  20%|██        | 195/971 [00:03<00:14, 55.12it/s]backtest loop:  21%|██        | 201/971 [00:03<00:13, 56.22it/s]backtest loop:  21%|██▏       | 208/971 [00:03<00:13, 58.19it/s]backtest loop:  22%|██▏       | 214/971 [00:04<00:13, 55.80it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 53.77it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:13, 56.31it/s]backtest loop:  24%|██▍       | 233/971 [00:04<00:12, 57.29it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:13, 55.34it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:12, 57.45it/s]backtest loop:  26%|██▌       | 253/971 [00:04<00:12, 57.75it/s]backtest loop:  27%|██▋       | 259/971 [00:04<00:12, 54.82it/s]backtest loop:  27%|██▋       | 266/971 [00:04<00:13, 53.98it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 56.44it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:11, 58.35it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 55.31it/s]backtest loop:  30%|███       | 292/971 [00:05<00:12, 56.49it/s]backtest loop:  31%|███       | 299/971 [00:05<00:11, 58.16it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:12, 55.26it/s]backtest loop:  32%|███▏      | 311/971 [00:05<00:11, 56.29it/s]backtest loop:  33%|███▎      | 317/971 [00:05<00:11, 57.26it/s]backtest loop:  33%|███▎      | 324/971 [00:05<00:10, 59.10it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:11, 55.61it/s]backtest loop:  35%|███▍      | 337/971 [00:06<00:11, 57.61it/s]backtest loop:  35%|███▌      | 343/971 [00:06<00:10, 58.07it/s]backtest loop:  36%|███▌      | 350/971 [00:06<00:11, 56.38it/s]backtest loop:  37%|███▋      | 356/971 [00:06<00:10, 57.13it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:10, 55.48it/s]backtest loop:  38%|███▊      | 369/971 [00:06<00:11, 53.64it/s]backtest loop:  39%|███▊      | 375/971 [00:06<00:10, 55.32it/s]backtest loop:  39%|███▉      | 382/971 [00:07<00:10, 57.33it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:10, 54.82it/s]backtest loop:  41%|████      | 394/971 [00:07<00:10, 56.13it/s]backtest loop:  41%|████      | 400/971 [00:07<00:10, 57.07it/s]backtest loop:  42%|████▏     | 406/971 [00:07<00:09, 57.69it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:09, 55.90it/s]backtest loop:  43%|████▎     | 419/971 [00:07<00:09, 56.76it/s]backtest loop:  44%|████▍     | 425/971 [00:08<00:16, 33.92it/s]backtest loop:  44%|████▍     | 431/971 [00:08<00:14, 38.50it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:12, 41.10it/s]backtest loop:  46%|████▌     | 443/971 [00:08<00:11, 45.29it/s]backtest loop:  46%|████▌     | 449/971 [00:08<00:10, 48.61it/s]backtest loop:  47%|████▋     | 455/971 [00:08<00:10, 51.43it/s]backtest loop:  48%|████▊     | 462/971 [00:08<00:09, 51.56it/s]backtest loop:  48%|████▊     | 468/971 [00:08<00:09, 53.66it/s]backtest loop:  49%|████▉     | 475/971 [00:08<00:08, 56.25it/s]backtest loop:  50%|████▉     | 482/971 [00:09<00:08, 54.90it/s]backtest loop:  50%|█████     | 488/971 [00:09<00:08, 56.20it/s]backtest loop:  51%|█████     | 494/971 [00:09<00:08, 57.20it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 54.47it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 53.84it/s]backtest loop:  53%|█████▎    | 513/971 [00:09<00:08, 55.34it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:08, 56.21it/s]backtest loop:  54%|█████▍    | 525/971 [00:09<00:07, 57.03it/s]backtest loop:  55%|█████▍    | 531/971 [00:09<00:08, 54.32it/s]backtest loop:  55%|█████▌    | 538/971 [00:10<00:07, 56.78it/s]backtest loop:  56%|█████▌    | 545/971 [00:10<00:07, 58.35it/s]backtest loop:  57%|█████▋    | 551/971 [00:10<00:07, 55.60it/s]backtest loop:  57%|█████▋    | 557/971 [00:10<00:07, 56.45it/s]backtest loop:  58%|█████▊    | 564/971 [00:10<00:07, 58.14it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 55.92it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:06, 57.66it/s]backtest loop:  60%|██████    | 585/971 [00:10<00:06, 58.98it/s]backtest loop:  61%|██████    | 591/971 [00:10<00:06, 55.74it/s]backtest loop:  62%|██████▏   | 598/971 [00:11<00:06, 57.56it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:06, 55.73it/s]backtest loop:  63%|██████▎   | 611/971 [00:11<00:06, 56.76it/s]backtest loop:  64%|██████▎   | 618/971 [00:11<00:06, 58.42it/s]backtest loop:  64%|██████▍   | 624/971 [00:11<00:05, 58.79it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:06, 55.65it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:05, 57.71it/s]backtest loop:  66%|██████▌   | 643/971 [00:11<00:05, 58.29it/s]backtest loop:  67%|██████▋   | 649/971 [00:11<00:05, 58.71it/s]backtest loop:  67%|██████▋   | 655/971 [00:12<00:05, 55.67it/s]backtest loop:  68%|██████▊   | 661/971 [00:12<00:05, 56.58it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 57.53it/s]backtest loop:  69%|██████▉   | 673/971 [00:12<00:05, 58.23it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 55.04it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 56.18it/s]backtest loop:  71%|███████   | 691/971 [00:12<00:04, 57.20it/s]backtest loop:  72%|███████▏  | 697/971 [00:12<00:04, 57.83it/s]backtest loop:  72%|███████▏  | 703/971 [00:12<00:04, 58.42it/s]backtest loop:  73%|███████▎  | 709/971 [00:13<00:04, 55.24it/s]backtest loop:  74%|███████▎  | 715/971 [00:13<00:04, 56.49it/s]backtest loop:  74%|███████▍  | 722/971 [00:13<00:04, 58.20it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 58.34it/s]backtest loop:  76%|███████▌  | 734/971 [00:13<00:04, 52.08it/s]backtest loop:  76%|███████▌  | 740/971 [00:13<00:04, 54.15it/s]backtest loop:  77%|███████▋  | 746/971 [00:13<00:04, 55.62it/s]backtest loop:  77%|███████▋  | 752/971 [00:13<00:04, 53.12it/s]backtest loop:  78%|███████▊  | 758/971 [00:13<00:03, 54.91it/s]backtest loop:  79%|███████▉  | 765/971 [00:14<00:03, 53.35it/s]backtest loop:  80%|███████▉  | 772/971 [00:14<00:03, 55.91it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 57.76it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 54.78it/s]backtest loop:  81%|████████▏ | 791/971 [00:14<00:03, 56.11it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 54.67it/s]backtest loop:  83%|████████▎ | 804/971 [00:14<00:02, 56.07it/s]backtest loop:  83%|████████▎ | 810/971 [00:14<00:02, 56.79it/s]backtest loop:  84%|████████▍ | 816/971 [00:14<00:02, 57.67it/s]backtest loop:  85%|████████▍ | 822/971 [00:15<00:02, 58.31it/s]backtest loop:  85%|████████▌ | 828/971 [00:15<00:02, 55.21it/s]backtest loop:  86%|████████▌ | 834/971 [00:15<00:02, 56.53it/s]backtest loop:  87%|████████▋ | 841/971 [00:15<00:02, 58.25it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 56.07it/s]backtest loop:  88%|████████▊ | 854/971 [00:15<00:02, 57.00it/s]backtest loop:  89%|████████▊ | 860/971 [00:15<00:01, 57.81it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 58.36it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 54.67it/s]backtest loop:  90%|█████████ | 878/971 [00:16<00:01, 55.96it/s]backtest loop:  91%|█████████ | 884/971 [00:16<00:01, 56.65it/s]backtest loop:  92%|█████████▏| 890/971 [00:16<00:01, 57.57it/s]backtest loop:  92%|█████████▏| 896/971 [00:16<00:01, 58.10it/s]backtest loop:  93%|█████████▎| 902/971 [00:16<00:01, 55.16it/s]backtest loop:  94%|█████████▎| 908/971 [00:16<00:01, 56.46it/s]backtest loop:  94%|█████████▍| 914/971 [00:16<00:00, 57.34it/s]backtest loop:  95%|█████████▍| 920/971 [00:16<00:00, 58.09it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 55.04it/s]backtest loop:  96%|█████████▌| 932/971 [00:16<00:00, 56.37it/s]backtest loop:  97%|█████████▋| 938/971 [00:17<00:00, 57.12it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 55.24it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 57.31it/s]backtest loop:  99%|█████████▊| 958/971 [00:17<00:00, 57.87it/s]backtest loop:  99%|█████████▉| 964/971 [00:17<00:00, 58.32it/s]backtest loop: 100%|█████████▉| 970/971 [00:17<00:00, 55.26it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.90it/s]
[2924289:MainThread](2024-04-24 22:09:16,417) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000558
std                0.005547
annualized_return  0.132811
information_ratio  1.551934
max_drawdown      -0.129428
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000360
std                0.005548
annualized_return  0.085686
information_ratio  1.001195
max_drawdown      -0.163733
[2924289:MainThread](2024-04-24 22:09:16,433) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_21:48:11_online`.
Round 3 Done!
{'1day.excess_return_with_cost.annualized_return': [0.12386974698091249,
                                                    0.1198726782033047,
                                                    0.08568619333630892],
 '1day.excess_return_with_cost.information_ratio': [1.414046816672812,
                                                    1.428098235977815,
                                                    1.0011945847928823],
 '1day.excess_return_with_cost.max_drawdown': [-0.08039447825046309,
                                               -0.0724795167180563,
                                               -0.16373344369967016],
 'IC': [0.03247239452907499, 0.034917389108111305, 0.02964435031889077],
 'ICIR': [0.22552705133383394, 0.24081672568443255, 0.20714330233910136],
 'Rank IC': [0.031136367658080418, 0.03398929167284011, 0.0262953640059444],
 'Rank ICIR': [0.21727391618606592, 0.23611117650462315, 0.18299316660535125],
 'mae': [0.7075666189193726, 0.707162618637085, 0.7076587677001953],
 'mse': [0.9962677359580994, 0.9957350492477417, 0.9965179562568665]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2924289:MainThread](2024-04-24 22:09:17,613) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[2924289:MainThread](2024-04-24 22:09:17,613) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[2924289:MainThread](2024-04-24 22:09:17,616) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[2924289:MainThread](2024-04-24 22:09:17,616) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:08<14:08,  8.57s/it]epoch:   2%|▏         | 2/100 [00:16<13:48,  8.46s/it]epoch:   3%|▎         | 3/100 [00:25<13:42,  8.48s/it]epoch:   4%|▍         | 4/100 [00:33<13:35,  8.50s/it]epoch:   5%|▌         | 5/100 [00:42<13:26,  8.49s/it]epoch:   6%|▌         | 6/100 [00:51<13:21,  8.52s/it]epoch:   7%|▋         | 7/100 [00:59<13:10,  8.50s/it]epoch:   8%|▊         | 8/100 [01:08<13:09,  8.58s/it]epoch:   9%|▉         | 9/100 [01:16<12:58,  8.56s/it]epoch:  10%|█         | 10/100 [01:25<12:46,  8.52s/it]epoch:  11%|█         | 11/100 [01:33<12:38,  8.53s/it]epoch:  12%|█▏        | 12/100 [01:42<12:30,  8.53s/it]epoch:  13%|█▎        | 13/100 [01:50<12:18,  8.49s/it]epoch:  14%|█▍        | 14/100 [01:59<12:08,  8.47s/it]epoch:  15%|█▌        | 15/100 [02:07<12:03,  8.51s/it]epoch:  16%|█▌        | 16/100 [02:16<11:58,  8.55s/it]epoch:  17%|█▋        | 17/100 [02:24<11:47,  8.53s/it]epoch:  18%|█▊        | 18/100 [02:33<11:37,  8.51s/it]epoch:  19%|█▉        | 19/100 [02:41<11:30,  8.52s/it]epoch:  20%|██        | 20/100 [02:50<11:24,  8.56s/it]epoch:  21%|██        | 21/100 [02:58<11:11,  8.50s/it]epoch:  22%|██▏       | 22/100 [03:07<11:01,  8.48s/it]epoch:  23%|██▎       | 23/100 [03:15<10:51,  8.46s/it]epoch:  24%|██▍       | 24/100 [03:24<10:43,  8.46s/it]epoch:  25%|██▌       | 25/100 [03:32<10:37,  8.49s/it]epoch:  26%|██▌       | 26/100 [03:41<10:29,  8.51s/it]epoch:  27%|██▋       | 27/100 [03:49<10:18,  8.48s/it]epoch:  28%|██▊       | 28/100 [03:58<10:08,  8.46s/it]epoch:  29%|██▉       | 29/100 [04:06<10:00,  8.45s/it]epoch:  30%|███       | 30/100 [04:15<09:52,  8.46s/it]0.058128262124589485
best ic: 0.058128262124589485
epoch:  31%|███       | 31/100 [04:24<10:11,  8.86s/it]0.0564878933171988
epoch:  32%|███▏      | 32/100 [04:34<10:22,  9.16s/it]0.057864178529958656
epoch:  33%|███▎      | 33/100 [04:44<10:22,  9.29s/it]0.053907214392952124
epoch:  34%|███▍      | 34/100 [04:53<10:19,  9.39s/it]0.06055682328749785
best ic: 0.06055682328749785
epoch:  35%|███▌      | 35/100 [05:03<10:14,  9.45s/it]0.054190735495847235
epoch:  36%|███▌      | 36/100 [05:13<10:07,  9.50s/it]0.05965939652745928
epoch:  37%|███▋      | 37/100 [05:22<10:01,  9.55s/it]0.05934927116149294
epoch:  38%|███▊      | 38/100 [05:32<09:57,  9.63s/it]0.05406209228691527
epoch:  39%|███▉      | 39/100 [05:42<09:53,  9.72s/it]0.054432063417928375
epoch:  40%|████      | 40/100 [05:52<09:42,  9.71s/it]0.05532446403145119
epoch:  41%|████      | 41/100 [06:01<09:31,  9.69s/it]0.05227942948151483
epoch:  42%|████▏     | 42/100 [06:11<09:17,  9.62s/it]0.049158787329475366
epoch:  42%|████▏     | 42/100 [06:20<08:46,  9.07s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2924289:MainThread](2024-04-24 22:15:38,599) INFO - qlib.workflow - [exp.py:258] - Experiment 39 starts running ...
[2924289:MainThread](2024-04-24 22:15:38,613) INFO - qlib.workflow - [recorder.py:341] - Recorder e40bf782abf6439fade2027fca46d7aa starts running under Experiment 39 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:04, 14.06it/s]online:   6%|▋         | 4/63 [00:00<00:04, 14.02it/s]online:  10%|▉         | 6/63 [00:00<00:03, 14.29it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 14.39it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 14.33it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 14.22it/s]online:  22%|██▏       | 14/63 [00:00<00:03, 14.27it/s]online:  25%|██▌       | 16/63 [00:01<00:03, 14.36it/s]online:  29%|██▊       | 18/63 [00:01<00:03, 14.37it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 14.48it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 14.55it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 14.48it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 14.43it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 14.47it/s]online:  48%|████▊     | 30/63 [00:02<00:02, 14.28it/s]online:  51%|█████     | 32/63 [00:02<00:02, 14.44it/s]online:  54%|█████▍    | 34/63 [00:02<00:02, 14.41it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 14.50it/s]online:  60%|██████    | 38/63 [00:02<00:01, 14.52it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 14.35it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 14.49it/s]online:  70%|██████▉   | 44/63 [00:03<00:01, 14.31it/s]online:  73%|███████▎  | 46/63 [00:03<00:01, 14.27it/s]online:  76%|███████▌  | 48/63 [00:03<00:01, 14.32it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 14.38it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 14.44it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 14.44it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 14.31it/s]online:  92%|█████████▏| 58/63 [00:04<00:00, 14.24it/s]online:  95%|█████████▌| 60/63 [00:04<00:00, 14.44it/s]online:  98%|█████████▊| 62/63 [00:04<00:00, 14.25it/s]online: 100%|██████████| 63/63 [00:04<00:00, 14.39it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2924289:MainThread](2024-04-24 22:15:51,614) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9958708 mae 0.70743364
{'IC': 0.0355889467556545,
 'ICIR': 0.252880714547846,
 'Rank IC': 0.0335393501370497,
 'Rank ICIR': 0.23971972679218712}
[2924289:MainThread](2024-04-24 22:15:53,355) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2924289:MainThread](2024-04-24 22:16:07,061) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 22:16:07,064) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 22:16:13,194) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f5604c3e3a0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:44,  9.29it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.61it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 35.14it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.95it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.37it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 49.34it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:19, 48.58it/s]backtest loop:   5%|▍         | 46/971 [00:01<00:17, 52.76it/s]backtest loop:   5%|▌         | 53/971 [00:01<00:16, 55.75it/s]backtest loop:   6%|▌         | 59/971 [00:01<00:16, 53.80it/s]backtest loop:   7%|▋         | 66/971 [00:01<00:16, 56.33it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 54.11it/s]backtest loop:   8%|▊         | 78/971 [00:01<00:16, 55.29it/s]backtest loop:   9%|▉         | 85/971 [00:01<00:15, 57.74it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:15, 58.13it/s]backtest loop:  10%|▉         | 97/971 [00:01<00:15, 55.45it/s]backtest loop:  11%|█         | 103/971 [00:02<00:15, 55.32it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:14, 57.56it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:15, 55.71it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:14, 57.73it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:15, 55.11it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 53.01it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:14, 55.69it/s]backtest loop:  15%|█▌        | 150/971 [00:02<00:14, 57.42it/s]backtest loop:  16%|█▌        | 156/971 [00:03<00:14, 54.96it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:14, 57.11it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:13, 58.75it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 55.70it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:13, 57.65it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:13, 58.19it/s]backtest loop:  20%|██        | 195/971 [00:03<00:14, 55.16it/s]backtest loop:  21%|██        | 201/971 [00:03<00:13, 56.36it/s]backtest loop:  21%|██▏       | 208/971 [00:03<00:13, 58.17it/s]backtest loop:  22%|██▏       | 214/971 [00:04<00:13, 55.89it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 53.88it/s]backtest loop:  23%|██▎       | 226/971 [00:04<00:13, 55.48it/s]backtest loop:  24%|██▍       | 233/971 [00:04<00:12, 57.54it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:13, 55.63it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:12, 57.53it/s]backtest loop:  26%|██▌       | 253/971 [00:04<00:12, 58.09it/s]backtest loop:  27%|██▋       | 259/971 [00:04<00:12, 55.27it/s]backtest loop:  27%|██▋       | 265/971 [00:04<00:12, 56.31it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:12, 54.01it/s]backtest loop:  29%|██▊       | 277/971 [00:05<00:12, 55.59it/s]backtest loop:  29%|██▉       | 284/971 [00:05<00:11, 57.63it/s]backtest loop:  30%|██▉       | 290/971 [00:05<00:11, 58.02it/s]backtest loop:  30%|███       | 296/971 [00:05<00:12, 55.06it/s]backtest loop:  31%|███       | 302/971 [00:05<00:12, 55.58it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 57.61it/s]backtest loop:  32%|███▏      | 315/971 [00:05<00:11, 55.12it/s]backtest loop:  33%|███▎      | 321/971 [00:05<00:11, 56.45it/s]backtest loop:  34%|███▍      | 328/971 [00:06<00:11, 58.43it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:11, 56.19it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:10, 57.81it/s]backtest loop:  36%|███▌      | 348/971 [00:06<00:10, 58.09it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:10, 58.57it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 55.90it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:11, 54.67it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 52.98it/s]backtest loop:  39%|███▉      | 379/971 [00:07<00:10, 54.45it/s]backtest loop:  40%|███▉      | 385/971 [00:07<00:10, 55.82it/s]backtest loop:  40%|████      | 392/971 [00:07<00:10, 57.73it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 54.74it/s]backtest loop:  42%|████▏     | 404/971 [00:07<00:10, 55.91it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:09, 56.82it/s]backtest loop:  43%|████▎     | 416/971 [00:07<00:09, 57.09it/s]backtest loop:  43%|████▎     | 422/971 [00:07<00:15, 34.42it/s]backtest loop:  44%|████▍     | 428/971 [00:08<00:14, 37.47it/s]backtest loop:  45%|████▍     | 434/971 [00:08<00:12, 42.16it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:11, 45.63it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:10, 49.02it/s]backtest loop:  47%|████▋     | 452/971 [00:08<00:10, 48.98it/s]backtest loop:  47%|████▋     | 458/971 [00:08<00:09, 51.55it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:09, 53.70it/s]backtest loop:  48%|████▊     | 470/971 [00:08<00:09, 55.37it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:09, 54.16it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:08, 55.54it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:08, 56.69it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:08, 54.03it/s]backtest loop:  52%|█████▏    | 501/971 [00:09<00:08, 55.50it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 51.81it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 54.91it/s]backtest loop:  54%|█████▎    | 520/971 [00:09<00:08, 54.58it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 52.62it/s]backtest loop:  55%|█████▍    | 532/971 [00:09<00:08, 54.46it/s]backtest loop:  55%|█████▌    | 538/971 [00:10<00:07, 55.76it/s]backtest loop:  56%|█████▌    | 544/971 [00:10<00:07, 56.84it/s]backtest loop:  57%|█████▋    | 550/971 [00:10<00:07, 57.45it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:07, 54.57it/s]backtest loop:  58%|█████▊    | 562/971 [00:10<00:07, 55.84it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:07, 55.52it/s]backtest loop:  59%|█████▉    | 575/971 [00:10<00:06, 57.66it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:07, 54.87it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:06, 57.06it/s]backtest loop:  61%|██████    | 594/971 [00:11<00:06, 57.75it/s]backtest loop:  62%|██████▏   | 600/971 [00:11<00:06, 55.10it/s]backtest loop:  62%|██████▏   | 606/971 [00:11<00:06, 56.41it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 57.09it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:05, 58.71it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 54.57it/s]backtest loop:  65%|██████▍   | 631/971 [00:11<00:06, 55.93it/s]backtest loop:  66%|██████▌   | 638/971 [00:11<00:05, 57.97it/s]backtest loop:  66%|██████▋   | 645/971 [00:11<00:05, 55.94it/s]backtest loop:  67%|██████▋   | 651/971 [00:12<00:05, 56.94it/s]backtest loop:  68%|██████▊   | 657/971 [00:12<00:05, 57.50it/s]backtest loop:  68%|██████▊   | 664/971 [00:12<00:05, 58.94it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 55.60it/s]backtest loop:  70%|██████▉   | 676/971 [00:12<00:05, 56.77it/s]backtest loop:  70%|███████   | 682/971 [00:12<00:05, 57.57it/s]backtest loop:  71%|███████   | 688/971 [00:12<00:04, 57.72it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:05, 55.08it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 57.20it/s]backtest loop:  73%|███████▎  | 707/971 [00:13<00:04, 57.66it/s]backtest loop:  73%|███████▎  | 713/971 [00:13<00:04, 58.26it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 54.99it/s]backtest loop:  75%|███████▍  | 725/971 [00:13<00:04, 56.32it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 54.06it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 53.31it/s]backtest loop:  77%|███████▋  | 744/971 [00:13<00:04, 55.02it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 53.18it/s]backtest loop:  78%|███████▊  | 756/971 [00:13<00:03, 54.84it/s]backtest loop:  79%|███████▊  | 763/971 [00:14<00:03, 57.03it/s]backtest loop:  79%|███████▉  | 769/971 [00:14<00:03, 57.80it/s]backtest loop:  80%|███████▉  | 775/971 [00:14<00:03, 54.57it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 56.81it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 54.61it/s]backtest loop:  82%|████████▏ | 794/971 [00:14<00:03, 55.75it/s]backtest loop:  82%|████████▏ | 801/971 [00:14<00:02, 57.68it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 55.80it/s]backtest loop:  84%|████████▍ | 814/971 [00:15<00:02, 56.69it/s]backtest loop:  85%|████████▍ | 821/971 [00:15<00:02, 58.38it/s]backtest loop:  85%|████████▌ | 828/971 [00:15<00:02, 56.33it/s]backtest loop:  86%|████████▌ | 835/971 [00:15<00:02, 58.00it/s]backtest loop:  87%|████████▋ | 842/971 [00:15<00:02, 59.29it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 56.26it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:01, 58.09it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 56.14it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 57.97it/s]backtest loop:  90%|█████████ | 876/971 [00:16<00:01, 59.21it/s]backtest loop:  91%|█████████ | 882/971 [00:16<00:01, 55.90it/s]backtest loop:  91%|█████████▏| 888/971 [00:16<00:01, 56.97it/s]backtest loop:  92%|█████████▏| 895/971 [00:16<00:01, 58.53it/s]backtest loop:  93%|█████████▎| 901/971 [00:16<00:01, 58.88it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 55.88it/s]backtest loop:  94%|█████████▍| 914/971 [00:16<00:00, 57.74it/s]backtest loop:  95%|█████████▍| 920/971 [00:16<00:00, 58.27it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 55.35it/s]backtest loop:  96%|█████████▌| 932/971 [00:17<00:00, 56.53it/s]backtest loop:  97%|█████████▋| 938/971 [00:17<00:00, 57.44it/s]backtest loop:  97%|█████████▋| 944/971 [00:17<00:00, 57.98it/s]backtest loop:  98%|█████████▊| 950/971 [00:17<00:00, 55.13it/s]backtest loop:  98%|█████████▊| 956/971 [00:17<00:00, 56.47it/s]backtest loop:  99%|█████████▉| 962/971 [00:17<00:00, 57.33it/s]backtest loop: 100%|█████████▉| 969/971 [00:17<00:00, 58.82it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.73it/s]
[2924289:MainThread](2024-04-24 22:16:31,009) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000699
std                0.005439
annualized_return  0.166370
information_ratio  1.982605
max_drawdown      -0.045523
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000501
std                0.005440
annualized_return  0.119249
information_ratio  1.420969
max_drawdown      -0.059678
[2924289:MainThread](2024-04-24 22:16:31,025) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_21:48:11_online`.
Round 4 Done!
{'1day.excess_return_with_cost.annualized_return': [0.12386974698091249,
                                                    0.1198726782033047,
                                                    0.08568619333630892,
                                                    0.11924882547054218],
 '1day.excess_return_with_cost.information_ratio': [1.414046816672812,
                                                    1.428098235977815,
                                                    1.0011945847928823,
                                                    1.4209694086345042],
 '1day.excess_return_with_cost.max_drawdown': [-0.08039447825046309,
                                               -0.0724795167180563,
                                               -0.16373344369967016,
                                               -0.0596780068312569],
 'IC': [0.03247239452907499,
        0.034917389108111305,
        0.02964435031889077,
        0.0355889467556545],
 'ICIR': [0.22552705133383394,
          0.24081672568443255,
          0.20714330233910136,
          0.252880714547846],
 'Rank IC': [0.031136367658080418,
             0.03398929167284011,
             0.0262953640059444,
             0.0335393501370497],
 'Rank ICIR': [0.21727391618606592,
               0.23611117650462315,
               0.18299316660535125,
               0.23971972679218712],
 'mae': [0.7075666189193726,
         0.707162618637085,
         0.7076587677001953,
         0.7074336409568787],
 'mse': [0.9962677359580994,
         0.9957350492477417,
         0.9965179562568665,
         0.99587082862854]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2924289:MainThread](2024-04-24 22:16:32,209) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[2924289:MainThread](2024-04-24 22:16:32,210) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[2924289:MainThread](2024-04-24 22:16:32,212) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[2924289:MainThread](2024-04-24 22:16:32,213) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:08<14:33,  8.82s/it]epoch:   2%|▏         | 2/100 [00:17<14:02,  8.60s/it]epoch:   3%|▎         | 3/100 [00:25<13:53,  8.59s/it]epoch:   4%|▍         | 4/100 [00:34<13:30,  8.44s/it]epoch:   5%|▌         | 5/100 [00:42<13:23,  8.46s/it]epoch:   6%|▌         | 6/100 [00:51<13:15,  8.46s/it]epoch:   7%|▋         | 7/100 [00:59<13:06,  8.46s/it]epoch:   8%|▊         | 8/100 [01:08<13:00,  8.49s/it]epoch:   9%|▉         | 9/100 [01:16<12:46,  8.43s/it]epoch:  10%|█         | 10/100 [01:24<12:39,  8.44s/it]epoch:  11%|█         | 11/100 [01:33<12:37,  8.51s/it]epoch:  12%|█▏        | 12/100 [01:41<12:27,  8.49s/it]epoch:  13%|█▎        | 13/100 [01:50<12:18,  8.49s/it]epoch:  14%|█▍        | 14/100 [01:58<12:10,  8.50s/it]epoch:  15%|█▌        | 15/100 [02:07<12:06,  8.54s/it]epoch:  16%|█▌        | 16/100 [02:16<11:55,  8.52s/it]epoch:  17%|█▋        | 17/100 [02:24<11:45,  8.50s/it]epoch:  18%|█▊        | 18/100 [02:32<11:35,  8.48s/it]epoch:  19%|█▉        | 19/100 [02:41<11:28,  8.50s/it]epoch:  20%|██        | 20/100 [02:50<11:24,  8.55s/it]epoch:  21%|██        | 21/100 [02:58<11:11,  8.50s/it]epoch:  22%|██▏       | 22/100 [03:06<11:02,  8.50s/it]epoch:  23%|██▎       | 23/100 [03:15<10:53,  8.49s/it]epoch:  24%|██▍       | 24/100 [03:23<10:46,  8.50s/it]epoch:  25%|██▌       | 25/100 [03:32<10:47,  8.64s/it]epoch:  26%|██▌       | 26/100 [03:41<10:34,  8.58s/it]epoch:  27%|██▋       | 27/100 [03:49<10:21,  8.52s/it]epoch:  28%|██▊       | 28/100 [03:58<10:10,  8.47s/it]epoch:  29%|██▉       | 29/100 [04:06<09:59,  8.44s/it]epoch:  30%|███       | 30/100 [04:14<09:50,  8.43s/it]0.05882072388834887
best ic: 0.05882072388834887
epoch:  31%|███       | 31/100 [04:24<10:08,  8.82s/it]0.0585723817660554
epoch:  32%|███▏      | 32/100 [04:34<10:16,  9.07s/it]0.059674789111350934
best ic: 0.059674789111350934
epoch:  33%|███▎      | 33/100 [04:43<10:18,  9.23s/it]0.05512782227802095
epoch:  34%|███▍      | 34/100 [04:53<10:16,  9.33s/it]0.06000009238792355
best ic: 0.06000009238792355
epoch:  35%|███▌      | 35/100 [05:02<10:08,  9.36s/it]0.05799976065086258
epoch:  36%|███▌      | 36/100 [05:12<10:01,  9.40s/it]0.059291144706382894
epoch:  37%|███▋      | 37/100 [05:21<09:55,  9.45s/it]0.05519546818375835
epoch:  38%|███▊      | 38/100 [05:31<09:53,  9.56s/it]0.05851626888985108
epoch:  39%|███▉      | 39/100 [05:41<09:47,  9.64s/it]0.055268085206470315
epoch:  40%|████      | 40/100 [05:51<09:38,  9.63s/it]0.056333110997121426
epoch:  41%|████      | 41/100 [06:00<09:26,  9.60s/it]0.05026821578899624
epoch:  42%|████▏     | 42/100 [06:10<09:17,  9.60s/it]0.05319091611190709
epoch:  42%|████▏     | 42/100 [06:19<08:44,  9.05s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2924289:MainThread](2024-04-24 22:22:52,238) INFO - qlib.workflow - [exp.py:258] - Experiment 39 starts running ...
[2924289:MainThread](2024-04-24 22:22:52,270) INFO - qlib.workflow - [recorder.py:341] - Recorder ca4d84843293466981b3b706d28cebcf starts running under Experiment 39 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:04, 13.78it/s]online:   6%|▋         | 4/63 [00:00<00:04, 14.31it/s]online:  10%|▉         | 6/63 [00:00<00:04, 14.09it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 14.32it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 14.27it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 14.24it/s]online:  22%|██▏       | 14/63 [00:00<00:03, 14.26it/s]online:  25%|██▌       | 16/63 [00:01<00:03, 14.51it/s]online:  29%|██▊       | 18/63 [00:01<00:03, 14.43it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 14.42it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 14.36it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 14.41it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 14.37it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 14.36it/s]online:  48%|████▊     | 30/63 [00:02<00:02, 14.31it/s]online:  51%|█████     | 32/63 [00:02<00:02, 14.37it/s]online:  54%|█████▍    | 34/63 [00:02<00:02, 14.33it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 14.41it/s]online:  60%|██████    | 38/63 [00:02<00:01, 14.43it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 14.44it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 14.20it/s]online:  70%|██████▉   | 44/63 [00:03<00:01, 14.22it/s]online:  73%|███████▎  | 46/63 [00:03<00:01, 14.22it/s]online:  76%|███████▌  | 48/63 [00:03<00:01, 14.25it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 14.27it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 14.38it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 14.15it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 14.27it/s]online:  92%|█████████▏| 58/63 [00:04<00:00, 14.45it/s]online:  95%|█████████▌| 60/63 [00:04<00:00, 14.34it/s]online:  98%|█████████▊| 62/63 [00:04<00:00, 14.48it/s]online: 100%|██████████| 63/63 [00:04<00:00, 14.37it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2924289:MainThread](2024-04-24 22:23:03,942) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9965299 mae 0.7076197
{'IC': 0.029887754919344072,
 'ICIR': 0.2115851609448364,
 'Rank IC': 0.029115694342890748,
 'Rank ICIR': 0.20831071518991923}
[2924289:MainThread](2024-04-24 22:23:05,670) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2924289:MainThread](2024-04-24 22:23:18,076) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 22:23:18,079) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 22:23:24,152) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f55ee41c820>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:38,  9.85it/s]backtest loop:   1%|          | 9/971 [00:00<00:37, 25.78it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:26, 36.46it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.94it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:19, 47.65it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 48.17it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.41it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.38it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.51it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 56.14it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.29it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 56.72it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 58.59it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 56.03it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 58.04it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 59.22it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.19it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 58.08it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.29it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:15, 53.21it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:15, 55.72it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 54.56it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 56.79it/s]backtest loop:  16%|█▌        | 154/971 [00:02<00:14, 57.58it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 55.72it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:13, 57.66it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:13, 59.13it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:14, 56.12it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 58.29it/s]backtest loop:  20%|█▉        | 194/971 [00:03<00:13, 58.74it/s]backtest loop:  21%|██        | 200/971 [00:03<00:13, 55.72it/s]backtest loop:  21%|██        | 206/971 [00:03<00:13, 56.68it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:13, 55.15it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:13, 55.91it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:13, 53.77it/s]backtest loop:  24%|██▍       | 232/971 [00:04<00:13, 56.55it/s]backtest loop:  25%|██▍       | 239/971 [00:04<00:12, 58.37it/s]backtest loop:  25%|██▌       | 245/971 [00:04<00:13, 55.58it/s]backtest loop:  26%|██▌       | 252/971 [00:04<00:12, 57.73it/s]backtest loop:  27%|██▋       | 259/971 [00:04<00:12, 55.83it/s]backtest loop:  27%|██▋       | 266/971 [00:04<00:12, 55.11it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 57.26it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:11, 58.91it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 56.00it/s]backtest loop:  30%|███       | 292/971 [00:05<00:12, 56.47it/s]backtest loop:  31%|███       | 299/971 [00:05<00:11, 58.15it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:12, 55.41it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 57.47it/s]backtest loop:  33%|███▎      | 319/971 [00:05<00:11, 59.00it/s]backtest loop:  33%|███▎      | 325/971 [00:05<00:11, 56.10it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:10, 58.14it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 59.41it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 56.16it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 58.39it/s]backtest loop:  37%|███▋      | 359/971 [00:06<00:10, 59.59it/s]backtest loop:  38%|███▊      | 365/971 [00:06<00:10, 56.16it/s]backtest loop:  38%|███▊      | 371/971 [00:06<00:11, 54.06it/s]backtest loop:  39%|███▉      | 378/971 [00:06<00:11, 53.43it/s]backtest loop:  40%|███▉      | 385/971 [00:07<00:10, 56.13it/s]backtest loop:  40%|████      | 392/971 [00:07<00:09, 58.02it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 55.44it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 57.43it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:09, 59.02it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:09, 55.80it/s]backtest loop:  44%|████▎     | 424/971 [00:07<00:15, 35.51it/s]backtest loop:  44%|████▍     | 431/971 [00:08<00:13, 41.15it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:12, 43.14it/s]backtest loop:  46%|████▌     | 444/971 [00:08<00:11, 47.83it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:10, 51.59it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:10, 50.95it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:09, 54.05it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:08, 56.45it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:09, 54.47it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:08, 56.66it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:08, 54.46it/s]backtest loop:  51%|█████     | 496/971 [00:09<00:08, 55.55it/s]backtest loop:  52%|█████▏    | 503/971 [00:09<00:08, 57.69it/s]backtest loop:  52%|█████▏    | 509/971 [00:09<00:08, 55.26it/s]backtest loop:  53%|█████▎    | 516/971 [00:09<00:07, 57.50it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:08, 55.04it/s]backtest loop:  54%|█████▍    | 529/971 [00:09<00:07, 57.19it/s]backtest loop:  55%|█████▌    | 536/971 [00:09<00:07, 55.77it/s]backtest loop:  56%|█████▌    | 542/971 [00:10<00:07, 56.71it/s]backtest loop:  57%|█████▋    | 549/971 [00:10<00:07, 58.40it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:07, 56.43it/s]backtest loop:  58%|█████▊    | 562/971 [00:10<00:07, 57.27it/s]backtest loop:  59%|█████▊    | 569/971 [00:10<00:06, 58.76it/s]backtest loop:  59%|█████▉    | 575/971 [00:10<00:06, 58.67it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:06, 55.83it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:06, 57.71it/s]backtest loop:  61%|██████▏   | 595/971 [00:10<00:06, 59.08it/s]backtest loop:  62%|██████▏   | 601/971 [00:11<00:06, 56.20it/s]backtest loop:  63%|██████▎   | 608/971 [00:11<00:06, 57.98it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:06, 56.28it/s]backtest loop:  64%|██████▍   | 622/971 [00:11<00:06, 57.94it/s]backtest loop:  65%|██████▍   | 629/971 [00:11<00:05, 59.41it/s]backtest loop:  65%|██████▌   | 635/971 [00:11<00:05, 56.48it/s]backtest loop:  66%|██████▌   | 641/971 [00:11<00:05, 57.07it/s]backtest loop:  67%|██████▋   | 648/971 [00:11<00:05, 58.68it/s]backtest loop:  67%|██████▋   | 655/971 [00:11<00:05, 56.49it/s]backtest loop:  68%|██████▊   | 662/971 [00:12<00:05, 58.17it/s]backtest loop:  69%|██████▉   | 669/971 [00:12<00:05, 59.35it/s]backtest loop:  70%|██████▉   | 675/971 [00:12<00:05, 56.17it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:05, 57.19it/s]backtest loop:  71%|███████   | 687/971 [00:12<00:04, 57.89it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:04, 55.76it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 57.67it/s]backtest loop:  73%|███████▎  | 707/971 [00:12<00:04, 57.83it/s]backtest loop:  74%|███████▎  | 714/971 [00:13<00:04, 55.94it/s]backtest loop:  74%|███████▍  | 721/971 [00:13<00:04, 57.89it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 59.17it/s]backtest loop:  76%|███████▌  | 734/971 [00:13<00:04, 53.13it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 55.63it/s]backtest loop:  77%|███████▋  | 747/971 [00:13<00:03, 56.77it/s]backtest loop:  78%|███████▊  | 753/971 [00:13<00:04, 54.43it/s]backtest loop:  78%|███████▊  | 760/971 [00:13<00:03, 53.66it/s]backtest loop:  79%|███████▉  | 767/971 [00:13<00:03, 56.03it/s]backtest loop:  80%|███████▉  | 773/971 [00:14<00:03, 56.52it/s]backtest loop:  80%|████████  | 780/971 [00:14<00:03, 55.07it/s]backtest loop:  81%|████████  | 787/971 [00:14<00:03, 57.23it/s]backtest loop:  82%|████████▏ | 793/971 [00:14<00:03, 54.71it/s]backtest loop:  82%|████████▏ | 800/971 [00:14<00:03, 56.87it/s]backtest loop:  83%|████████▎ | 807/971 [00:14<00:02, 58.47it/s]backtest loop:  84%|████████▎ | 813/971 [00:14<00:02, 55.73it/s]backtest loop:  84%|████████▍ | 820/971 [00:14<00:02, 57.40it/s]backtest loop:  85%|████████▌ | 827/971 [00:14<00:02, 58.86it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 55.96it/s]backtest loop:  86%|████████▋ | 839/971 [00:15<00:02, 56.81it/s]backtest loop:  87%|████████▋ | 846/971 [00:15<00:02, 58.44it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 55.56it/s]backtest loop:  88%|████████▊ | 859/971 [00:15<00:01, 57.53it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 58.93it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 55.83it/s]backtest loop:  91%|█████████ | 879/971 [00:15<00:01, 57.71it/s]backtest loop:  91%|█████████ | 886/971 [00:16<00:01, 59.10it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 56.02it/s]backtest loop:  92%|█████████▏| 898/971 [00:16<00:01, 57.03it/s]backtest loop:  93%|█████████▎| 904/971 [00:16<00:01, 57.77it/s]backtest loop:  94%|█████████▎| 910/971 [00:16<00:01, 58.33it/s]backtest loop:  94%|█████████▍| 916/971 [00:16<00:00, 55.41it/s]backtest loop:  95%|█████████▌| 923/971 [00:16<00:00, 57.42it/s]backtest loop:  96%|█████████▌| 929/971 [00:16<00:00, 58.08it/s]backtest loop:  96%|█████████▋| 935/971 [00:16<00:00, 58.62it/s]backtest loop:  97%|█████████▋| 941/971 [00:17<00:00, 55.40it/s]backtest loop:  98%|█████████▊| 947/971 [00:17<00:00, 56.68it/s]backtest loop:  98%|█████████▊| 954/971 [00:17<00:00, 58.37it/s]backtest loop:  99%|█████████▉| 960/971 [00:17<00:00, 55.41it/s]backtest loop: 100%|█████████▉| 967/971 [00:17<00:00, 57.36it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.40it/s]
[2924289:MainThread](2024-04-24 22:23:41,747) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000510
std                0.005350
annualized_return  0.121319
information_ratio  1.469973
max_drawdown      -0.090182
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000312
std                0.005350
annualized_return  0.074348
information_ratio  0.900759
max_drawdown      -0.110807
[2924289:MainThread](2024-04-24 22:23:41,763) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_21:48:11_online`.
Round 5 Done!
{'1day.excess_return_with_cost.annualized_return': [0.12386974698091249,
                                                    0.1198726782033047,
                                                    0.08568619333630892,
                                                    0.11924882547054218,
                                                    0.07434750552095895],
 '1day.excess_return_with_cost.information_ratio': [1.414046816672812,
                                                    1.428098235977815,
                                                    1.0011945847928823,
                                                    1.4209694086345042,
                                                    0.9007592657254062],
 '1day.excess_return_with_cost.max_drawdown': [-0.08039447825046309,
                                               -0.0724795167180563,
                                               -0.16373344369967016,
                                               -0.0596780068312569,
                                               -0.11080742895235432],
 'IC': [0.03247239452907499,
        0.034917389108111305,
        0.02964435031889077,
        0.0355889467556545,
        0.029887754919344072],
 'ICIR': [0.22552705133383394,
          0.24081672568443255,
          0.20714330233910136,
          0.252880714547846,
          0.2115851609448364],
 'Rank IC': [0.031136367658080418,
             0.03398929167284011,
             0.0262953640059444,
             0.0335393501370497,
             0.029115694342890748],
 'Rank ICIR': [0.21727391618606592,
               0.23611117650462315,
               0.18299316660535125,
               0.23971972679218712,
               0.20831071518991923],
 'mae': [0.7075666189193726,
         0.707162618637085,
         0.7076587677001953,
         0.7074336409568787,
         0.7076197266578674],
 'mse': [0.9962677359580994,
         0.9957350492477417,
         0.9965179562568665,
         0.99587082862854,
         0.9965298771858215]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2924289:MainThread](2024-04-24 22:23:42,913) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[2924289:MainThread](2024-04-24 22:23:42,914) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[2924289:MainThread](2024-04-24 22:23:42,916) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[2924289:MainThread](2024-04-24 22:23:42,916) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:08<14:27,  8.77s/it]epoch:   2%|▏         | 2/100 [00:17<13:51,  8.48s/it]epoch:   3%|▎         | 3/100 [00:25<13:38,  8.44s/it]epoch:   4%|▍         | 4/100 [00:34<13:35,  8.49s/it]epoch:   5%|▌         | 5/100 [00:42<13:28,  8.51s/it]epoch:   6%|▌         | 6/100 [00:50<13:13,  8.44s/it]epoch:   7%|▋         | 7/100 [00:59<13:04,  8.44s/it]epoch:   8%|▊         | 8/100 [01:07<12:55,  8.43s/it]epoch:   9%|▉         | 9/100 [01:16<12:48,  8.45s/it]epoch:  10%|█         | 10/100 [01:24<12:45,  8.51s/it]epoch:  11%|█         | 11/100 [01:33<12:36,  8.50s/it]epoch:  12%|█▏        | 12/100 [01:41<12:25,  8.47s/it]epoch:  13%|█▎        | 13/100 [01:50<12:16,  8.47s/it]epoch:  14%|█▍        | 14/100 [01:58<12:06,  8.45s/it]epoch:  15%|█▌        | 15/100 [02:06<11:56,  8.43s/it]epoch:  16%|█▌        | 16/100 [02:15<11:52,  8.48s/it]epoch:  17%|█▋        | 17/100 [02:24<11:45,  8.51s/it]epoch:  18%|█▊        | 18/100 [02:32<11:38,  8.51s/it]epoch:  19%|█▉        | 19/100 [02:41<11:28,  8.50s/it]epoch:  20%|██        | 20/100 [02:49<11:18,  8.48s/it]epoch:  21%|██        | 21/100 [02:57<11:08,  8.46s/it]epoch:  22%|██▏       | 22/100 [03:06<10:59,  8.45s/it]epoch:  23%|██▎       | 23/100 [03:14<10:52,  8.48s/it]epoch:  24%|██▍       | 24/100 [03:23<10:46,  8.50s/it]epoch:  25%|██▌       | 25/100 [03:32<10:38,  8.52s/it]epoch:  26%|██▌       | 26/100 [03:40<10:27,  8.49s/it]epoch:  27%|██▋       | 27/100 [03:48<10:19,  8.49s/it]epoch:  28%|██▊       | 28/100 [03:57<10:06,  8.43s/it]epoch:  29%|██▉       | 29/100 [04:05<09:58,  8.43s/it]epoch:  30%|███       | 30/100 [04:14<09:51,  8.45s/it]0.058072239164562924
best ic: 0.058072239164562924
epoch:  31%|███       | 31/100 [04:24<10:12,  8.88s/it]0.05690182260645809
epoch:  32%|███▏      | 32/100 [04:33<10:20,  9.12s/it]0.059575600666239466
best ic: 0.059575600666239466
epoch:  33%|███▎      | 33/100 [04:43<10:20,  9.27s/it]0.054355210326094174
epoch:  34%|███▍      | 34/100 [04:52<10:16,  9.34s/it]0.05148985124564264
epoch:  35%|███▌      | 35/100 [05:02<10:13,  9.43s/it]0.053037329996765525
epoch:  36%|███▌      | 36/100 [05:12<10:06,  9.48s/it]0.057061561310607585
epoch:  37%|███▋      | 37/100 [05:21<10:00,  9.54s/it]0.0555166903902454
epoch:  38%|███▊      | 38/100 [05:31<09:56,  9.62s/it]0.05267449154924534
epoch:  39%|███▉      | 39/100 [05:41<09:47,  9.64s/it]0.054166599985564653
epoch:  40%|████      | 40/100 [05:50<09:37,  9.62s/it]0.050941930043293004
epoch:  40%|████      | 40/100 [06:00<09:00,  9.01s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2924289:MainThread](2024-04-24 22:29:43,382) INFO - qlib.workflow - [exp.py:258] - Experiment 39 starts running ...
[2924289:MainThread](2024-04-24 22:29:43,396) INFO - qlib.workflow - [recorder.py:341] - Recorder 4e5fd2555e134f25a92ca6c858766451 starts running under Experiment 39 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:08,  7.30it/s]online:   5%|▍         | 3/63 [00:00<00:05, 11.31it/s]online:   8%|▊         | 5/63 [00:00<00:04, 12.92it/s]online:  11%|█         | 7/63 [00:00<00:04, 13.47it/s]online:  14%|█▍        | 9/63 [00:00<00:03, 13.93it/s]online:  17%|█▋        | 11/63 [00:00<00:03, 14.04it/s]online:  21%|██        | 13/63 [00:00<00:03, 14.26it/s]online:  24%|██▍       | 15/63 [00:01<00:03, 14.32it/s]online:  27%|██▋       | 17/63 [00:01<00:03, 14.49it/s]online:  30%|███       | 19/63 [00:01<00:03, 14.43it/s]online:  33%|███▎      | 21/63 [00:01<00:02, 14.41it/s]online:  37%|███▋      | 23/63 [00:01<00:02, 14.49it/s]online:  40%|███▉      | 25/63 [00:01<00:02, 14.54it/s]online:  43%|████▎     | 27/63 [00:01<00:02, 14.73it/s]online:  46%|████▌     | 29/63 [00:02<00:02, 14.45it/s]online:  49%|████▉     | 31/63 [00:02<00:02, 14.46it/s]online:  52%|█████▏    | 33/63 [00:02<00:02, 14.36it/s]online:  56%|█████▌    | 35/63 [00:02<00:01, 14.57it/s]online:  59%|█████▊    | 37/63 [00:02<00:01, 14.42it/s]online:  62%|██████▏   | 39/63 [00:02<00:01, 14.49it/s]online:  65%|██████▌   | 41/63 [00:02<00:01, 14.53it/s]online:  68%|██████▊   | 43/63 [00:03<00:01, 14.55it/s]online:  71%|███████▏  | 45/63 [00:03<00:01, 14.59it/s]online:  75%|███████▍  | 47/63 [00:03<00:01, 14.56it/s]online:  78%|███████▊  | 49/63 [00:03<00:00, 14.55it/s]online:  81%|████████  | 51/63 [00:03<00:00, 14.64it/s]online:  84%|████████▍ | 53/63 [00:03<00:00, 14.52it/s]online:  87%|████████▋ | 55/63 [00:03<00:00, 14.84it/s]online:  90%|█████████ | 57/63 [00:03<00:00, 14.78it/s]online:  94%|█████████▎| 59/63 [00:04<00:00, 14.59it/s]online:  97%|█████████▋| 61/63 [00:04<00:00, 14.69it/s]online: 100%|██████████| 63/63 [00:04<00:00, 14.60it/s]online: 100%|██████████| 63/63 [00:04<00:00, 14.33it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2924289:MainThread](2024-04-24 22:30:02,105) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99649215 mae 0.70771044
{'IC': 0.03243817179133714,
 'ICIR': 0.23325480456403733,
 'Rank IC': 0.03294090283830007,
 'Rank ICIR': 0.2375896291821766}
[2924289:MainThread](2024-04-24 22:30:03,965) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2924289:MainThread](2024-04-24 22:30:17,230) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 22:30:17,233) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 22:30:23,349) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f55ee560760>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:45,  9.15it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.37it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:26, 36.72it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 39.44it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.26it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:18, 49.44it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:18, 49.18it/s]backtest loop:   5%|▍         | 46/971 [00:01<00:17, 53.36it/s]backtest loop:   5%|▌         | 52/971 [00:01<00:16, 55.19it/s]backtest loop:   6%|▌         | 58/971 [00:01<00:17, 53.29it/s]backtest loop:   7%|▋         | 65/971 [00:01<00:16, 56.36it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 55.15it/s]backtest loop:   8%|▊         | 79/971 [00:01<00:15, 57.49it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:15, 58.94it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:15, 55.96it/s]backtest loop:  10%|█         | 99/971 [00:02<00:15, 57.78it/s]backtest loop:  11%|█         | 105/971 [00:02<00:14, 58.21it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 56.10it/s]backtest loop:  12%|█▏        | 118/971 [00:02<00:14, 57.10it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:15, 56.42it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:15, 53.79it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 52.29it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:14, 55.21it/s]backtest loop:  15%|█▌        | 150/971 [00:02<00:14, 57.35it/s]backtest loop:  16%|█▌        | 156/971 [00:03<00:14, 54.97it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:14, 57.09it/s]backtest loop:  17%|█▋        | 169/971 [00:03<00:13, 57.74it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 55.97it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:13, 57.72it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:14, 55.67it/s]backtest loop:  20%|██        | 196/971 [00:03<00:13, 56.70it/s]backtest loop:  21%|██        | 203/971 [00:03<00:13, 58.49it/s]backtest loop:  22%|██▏       | 210/971 [00:03<00:13, 56.64it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 54.36it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:13, 55.82it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:12, 57.73it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:13, 55.03it/s]backtest loop:  25%|██▍       | 241/971 [00:04<00:12, 56.26it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:12, 57.23it/s]backtest loop:  26%|██▌       | 253/971 [00:04<00:12, 58.00it/s]backtest loop:  27%|██▋       | 259/971 [00:04<00:12, 55.03it/s]backtest loop:  27%|██▋       | 266/971 [00:05<00:13, 54.15it/s]backtest loop:  28%|██▊       | 272/971 [00:05<00:12, 55.69it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:12, 56.84it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:11, 58.45it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 55.26it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 57.28it/s]backtest loop:  31%|███▏      | 304/971 [00:05<00:11, 57.80it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:12, 55.02it/s]backtest loop:  33%|███▎      | 316/971 [00:05<00:11, 56.02it/s]backtest loop:  33%|███▎      | 323/971 [00:05<00:11, 58.15it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:11, 55.99it/s]backtest loop:  35%|███▍      | 337/971 [00:06<00:10, 57.75it/s]backtest loop:  35%|███▌      | 343/971 [00:06<00:10, 58.34it/s]backtest loop:  36%|███▌      | 349/971 [00:06<00:10, 58.76it/s]backtest loop:  37%|███▋      | 355/971 [00:06<00:10, 56.03it/s]backtest loop:  37%|███▋      | 361/971 [00:06<00:10, 56.91it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:11, 54.54it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 52.84it/s]backtest loop:  39%|███▉      | 379/971 [00:07<00:10, 54.42it/s]backtest loop:  40%|███▉      | 386/971 [00:07<00:10, 56.80it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 55.16it/s]backtest loop:  41%|████      | 399/971 [00:07<00:10, 56.40it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 57.19it/s]backtest loop:  42%|████▏     | 411/971 [00:07<00:09, 57.86it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:15, 34.74it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:14, 37.96it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:12, 42.54it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:11, 46.47it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:10, 49.75it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:10, 49.61it/s]backtest loop:  47%|████▋     | 453/971 [00:08<00:09, 52.09it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:09, 54.08it/s]backtest loop:  48%|████▊     | 465/971 [00:08<00:09, 55.17it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:08, 56.51it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:09, 53.85it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:08, 54.67it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:08, 56.08it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:08, 53.77it/s]backtest loop:  52%|█████▏    | 501/971 [00:09<00:08, 55.33it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 53.61it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 56.31it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 58.07it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:08, 55.25it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:07, 56.53it/s]backtest loop:  56%|█████▌    | 540/971 [00:10<00:07, 58.71it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 55.62it/s]backtest loop:  57%|█████▋    | 552/971 [00:10<00:07, 56.78it/s]backtest loop:  58%|█████▊    | 559/971 [00:10<00:07, 58.39it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 56.17it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:06, 57.91it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 59.15it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:06, 56.04it/s]backtest loop:  61%|██████    | 592/971 [00:10<00:06, 55.91it/s]backtest loop:  62%|██████▏   | 599/971 [00:11<00:06, 57.79it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:06, 54.97it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 57.25it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:05, 59.02it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 55.83it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 57.77it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 59.08it/s]backtest loop:  66%|██████▋   | 645/971 [00:11<00:05, 56.29it/s]backtest loop:  67%|██████▋   | 652/971 [00:12<00:05, 58.11it/s]backtest loop:  68%|██████▊   | 658/971 [00:12<00:05, 58.31it/s]backtest loop:  68%|██████▊   | 664/971 [00:12<00:05, 58.78it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 55.65it/s]backtest loop:  70%|██████▉   | 676/971 [00:12<00:05, 56.84it/s]backtest loop:  70%|███████   | 682/971 [00:12<00:05, 57.67it/s]backtest loop:  71%|███████   | 688/971 [00:12<00:04, 58.10it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:05, 54.86it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 57.05it/s]backtest loop:  73%|███████▎  | 707/971 [00:12<00:04, 57.83it/s]backtest loop:  73%|███████▎  | 713/971 [00:13<00:04, 58.07it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 55.19it/s]backtest loop:  75%|███████▍  | 725/971 [00:13<00:04, 56.51it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 54.00it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 53.22it/s]backtest loop:  77%|███████▋  | 744/971 [00:13<00:04, 54.78it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 52.99it/s]backtest loop:  78%|███████▊  | 757/971 [00:13<00:03, 55.66it/s]backtest loop:  79%|███████▊  | 763/971 [00:14<00:03, 56.78it/s]backtest loop:  79%|███████▉  | 769/971 [00:14<00:03, 57.63it/s]backtest loop:  80%|███████▉  | 775/971 [00:14<00:03, 55.15it/s]backtest loop:  80%|████████  | 781/971 [00:14<00:03, 56.32it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 54.81it/s]backtest loop:  82%|████████▏ | 794/971 [00:14<00:03, 56.19it/s]backtest loop:  82%|████████▏ | 800/971 [00:14<00:03, 56.80it/s]backtest loop:  83%|████████▎ | 806/971 [00:14<00:02, 57.59it/s]backtest loop:  84%|████████▎ | 812/971 [00:14<00:02, 57.85it/s]backtest loop:  84%|████████▍ | 818/971 [00:15<00:02, 54.51it/s]backtest loop:  85%|████████▍ | 824/971 [00:15<00:02, 55.83it/s]backtest loop:  86%|████████▌ | 831/971 [00:15<00:02, 57.90it/s]backtest loop:  86%|████████▋ | 838/971 [00:15<00:02, 55.88it/s]backtest loop:  87%|████████▋ | 844/971 [00:15<00:02, 56.76it/s]backtest loop:  88%|████████▊ | 851/971 [00:15<00:02, 58.36it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 55.57it/s]backtest loop:  89%|████████▉ | 863/971 [00:15<00:01, 56.71it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 57.55it/s]backtest loop:  90%|█████████ | 876/971 [00:16<00:01, 59.01it/s]backtest loop:  91%|█████████ | 882/971 [00:16<00:01, 55.75it/s]backtest loop:  92%|█████████▏| 889/971 [00:16<00:01, 57.69it/s]backtest loop:  92%|█████████▏| 896/971 [00:16<00:01, 59.00it/s]backtest loop:  93%|█████████▎| 902/971 [00:16<00:01, 56.06it/s]backtest loop:  94%|█████████▎| 908/971 [00:16<00:01, 56.93it/s]backtest loop:  94%|█████████▍| 915/971 [00:16<00:00, 58.56it/s]backtest loop:  95%|█████████▍| 921/971 [00:16<00:00, 55.59it/s]backtest loop:  95%|█████████▌| 927/971 [00:16<00:00, 56.76it/s]backtest loop:  96%|█████████▌| 933/971 [00:17<00:00, 57.52it/s]backtest loop:  97%|█████████▋| 939/971 [00:17<00:00, 58.20it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 55.41it/s]backtest loop:  98%|█████████▊| 951/971 [00:17<00:00, 56.55it/s]backtest loop:  99%|█████████▊| 957/971 [00:17<00:00, 57.51it/s]backtest loop:  99%|█████████▉| 963/971 [00:17<00:00, 58.21it/s]backtest loop: 100%|█████████▉| 969/971 [00:17<00:00, 58.48it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.93it/s]
[2924289:MainThread](2024-04-24 22:30:41,102) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000754
std                0.005496
annualized_return  0.179398
information_ratio  2.115704
max_drawdown      -0.060917
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000558
std                0.005498
annualized_return  0.132744
information_ratio  1.565062
max_drawdown      -0.075291
[2924289:MainThread](2024-04-24 22:30:41,118) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_21:48:11_online`.
Round 6 Done!
{'1day.excess_return_with_cost.annualized_return': [0.12386974698091249,
                                                    0.1198726782033047,
                                                    0.08568619333630892,
                                                    0.11924882547054218,
                                                    0.07434750552095895,
                                                    0.1327441967693429],
 '1day.excess_return_with_cost.information_ratio': [1.414046816672812,
                                                    1.428098235977815,
                                                    1.0011945847928823,
                                                    1.4209694086345042,
                                                    0.9007592657254062,
                                                    1.5650619642691728],
 '1day.excess_return_with_cost.max_drawdown': [-0.08039447825046309,
                                               -0.0724795167180563,
                                               -0.16373344369967016,
                                               -0.0596780068312569,
                                               -0.11080742895235432,
                                               -0.07529115587639507],
 'IC': [0.03247239452907499,
        0.034917389108111305,
        0.02964435031889077,
        0.0355889467556545,
        0.029887754919344072,
        0.03243817179133714],
 'ICIR': [0.22552705133383394,
          0.24081672568443255,
          0.20714330233910136,
          0.252880714547846,
          0.2115851609448364,
          0.23325480456403733],
 'Rank IC': [0.031136367658080418,
             0.03398929167284011,
             0.0262953640059444,
             0.0335393501370497,
             0.029115694342890748,
             0.03294090283830007],
 'Rank ICIR': [0.21727391618606592,
               0.23611117650462315,
               0.18299316660535125,
               0.23971972679218712,
               0.20831071518991923,
               0.2375896291821766],
 'mae': [0.7075666189193726,
         0.707162618637085,
         0.7076587677001953,
         0.7074336409568787,
         0.7076197266578674,
         0.7077104449272156],
 'mse': [0.9962677359580994,
         0.9957350492477417,
         0.9965179562568665,
         0.99587082862854,
         0.9965298771858215,
         0.9964921474456787]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2924289:MainThread](2024-04-24 22:30:42,350) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[2924289:MainThread](2024-04-24 22:30:42,350) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[2924289:MainThread](2024-04-24 22:30:42,353) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[2924289:MainThread](2024-04-24 22:30:42,353) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:08<14:21,  8.70s/it]epoch:   2%|▏         | 2/100 [00:17<14:01,  8.58s/it]epoch:   3%|▎         | 3/100 [00:25<13:51,  8.58s/it]epoch:   4%|▍         | 4/100 [00:34<13:35,  8.49s/it]epoch:   5%|▌         | 5/100 [00:42<13:29,  8.53s/it]epoch:   6%|▌         | 6/100 [00:51<13:21,  8.52s/it]epoch:   7%|▋         | 7/100 [00:59<13:09,  8.49s/it]epoch:   8%|▊         | 8/100 [01:08<13:07,  8.56s/it]epoch:   9%|▉         | 9/100 [01:16<12:58,  8.55s/it]epoch:  10%|█         | 10/100 [01:25<12:44,  8.49s/it]epoch:  11%|█         | 11/100 [01:33<12:40,  8.54s/it]epoch:  12%|█▏        | 12/100 [01:42<12:31,  8.54s/it]epoch:  13%|█▎        | 13/100 [01:50<12:17,  8.48s/it]epoch:  14%|█▍        | 14/100 [01:59<12:08,  8.47s/it]epoch:  15%|█▌        | 15/100 [02:07<12:02,  8.49s/it]epoch:  16%|█▌        | 16/100 [02:16<11:56,  8.53s/it]epoch:  17%|█▋        | 17/100 [02:24<11:46,  8.51s/it]epoch:  18%|█▊        | 18/100 [02:33<11:33,  8.46s/it]epoch:  19%|█▉        | 19/100 [02:41<11:25,  8.46s/it]epoch:  20%|██        | 20/100 [02:50<11:20,  8.50s/it]epoch:  21%|██        | 21/100 [02:58<11:10,  8.49s/it]epoch:  22%|██▏       | 22/100 [03:07<10:59,  8.46s/it]epoch:  23%|██▎       | 23/100 [03:15<10:48,  8.42s/it]epoch:  24%|██▍       | 24/100 [03:23<10:38,  8.40s/it]epoch:  25%|██▌       | 25/100 [03:32<10:34,  8.46s/it]epoch:  26%|██▌       | 26/100 [03:41<10:30,  8.52s/it]epoch:  27%|██▋       | 27/100 [03:49<10:19,  8.49s/it]epoch:  28%|██▊       | 28/100 [03:57<10:09,  8.47s/it]epoch:  29%|██▉       | 29/100 [04:06<09:59,  8.45s/it]epoch:  30%|███       | 30/100 [04:14<09:51,  8.45s/it]0.055470760472395166
best ic: 0.055470760472395166
epoch:  31%|███       | 31/100 [04:24<10:10,  8.85s/it]0.058313911243901104
best ic: 0.058313911243901104
epoch:  32%|███▏      | 32/100 [04:34<10:23,  9.17s/it]0.0588689537521761
best ic: 0.0588689537521761
epoch:  33%|███▎      | 33/100 [04:44<10:25,  9.34s/it]0.05438248055000848
epoch:  34%|███▍      | 34/100 [04:53<10:17,  9.35s/it]0.0572293397474782
epoch:  35%|███▌      | 35/100 [05:02<10:08,  9.36s/it]0.056492125194756965
epoch:  36%|███▌      | 36/100 [05:12<10:02,  9.42s/it]0.05565336004432202
epoch:  37%|███▋      | 37/100 [05:22<09:55,  9.46s/it]0.05706128691525209
epoch:  38%|███▊      | 38/100 [05:31<09:53,  9.57s/it]0.05676602389425101
epoch:  39%|███▉      | 39/100 [05:41<09:47,  9.63s/it]0.05598980138732516
epoch:  40%|████      | 40/100 [05:51<09:38,  9.64s/it]0.052342420815311166
epoch:  40%|████      | 40/100 [06:00<09:01,  9.02s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2924289:MainThread](2024-04-24 22:36:43,060) INFO - qlib.workflow - [exp.py:258] - Experiment 39 starts running ...
[2924289:MainThread](2024-04-24 22:36:43,074) INFO - qlib.workflow - [recorder.py:341] - Recorder 1bda7deb9dfa4befb13e77a67e82ed06 starts running under Experiment 39 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:04, 14.80it/s]online:   6%|▋         | 4/63 [00:00<00:03, 15.02it/s]online:  10%|▉         | 6/63 [00:00<00:03, 15.08it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 15.11it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 15.13it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 15.14it/s]online:  22%|██▏       | 14/63 [00:00<00:03, 15.15it/s]online:  25%|██▌       | 16/63 [00:01<00:03, 15.10it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 15.12it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 15.14it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 15.15it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 15.16it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 15.16it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 15.17it/s]online:  48%|████▊     | 30/63 [00:01<00:02, 15.17it/s]online:  51%|█████     | 32/63 [00:02<00:02, 15.14it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 15.15it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 15.10it/s]online:  60%|██████    | 38/63 [00:02<00:01, 15.17it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 15.14it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 15.14it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 15.15it/s]online:  73%|███████▎  | 46/63 [00:03<00:01, 15.16it/s]online:  76%|███████▌  | 48/63 [00:03<00:00, 15.15it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 15.07it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 15.13it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 15.11it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 15.12it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 14.99it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 15.04it/s]online:  98%|█████████▊| 62/63 [00:04<00:00, 15.21it/s]online: 100%|██████████| 63/63 [00:04<00:00, 15.14it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2924289:MainThread](2024-04-24 22:36:59,448) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99610066 mae 0.707309
{'IC': 0.031934093208508825,
 'ICIR': 0.22850081818571194,
 'Rank IC': 0.03201431708725469,
 'Rank ICIR': 0.22617349904452566}
[2924289:MainThread](2024-04-24 22:37:01,206) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2924289:MainThread](2024-04-24 22:37:13,931) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 22:37:13,934) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 22:37:20,086) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f4f9b36d580>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:43,  9.34it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 24.87it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:26, 35.56it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.45it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:19, 47.43it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.71it/s]backtest loop:   4%|▍         | 40/971 [00:00<00:18, 50.81it/s]backtest loop:   5%|▍         | 47/971 [00:01<00:16, 54.39it/s]backtest loop:   5%|▌         | 53/971 [00:01<00:16, 55.83it/s]backtest loop:   6%|▌         | 59/971 [00:01<00:17, 53.60it/s]backtest loop:   7%|▋         | 66/971 [00:01<00:15, 56.74it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 54.39it/s]backtest loop:   8%|▊         | 79/971 [00:01<00:15, 57.10it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:15, 58.82it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:15, 56.12it/s]backtest loop:  10%|█         | 98/971 [00:01<00:15, 56.99it/s]backtest loop:  11%|█         | 104/971 [00:02<00:15, 57.72it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:14, 59.40it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:15, 56.11it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:15, 56.38it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:15, 54.16it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:15, 55.20it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 53.46it/s]backtest loop:  15%|█▌        | 147/971 [00:02<00:14, 55.07it/s]backtest loop:  16%|█▌        | 153/971 [00:02<00:14, 56.37it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:14, 57.22it/s]backtest loop:  17%|█▋        | 166/971 [00:03<00:14, 55.46it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:13, 57.54it/s]backtest loop:  19%|█▊        | 180/971 [00:03<00:13, 58.95it/s]backtest loop:  19%|█▉        | 186/971 [00:03<00:14, 55.86it/s]backtest loop:  20%|█▉        | 193/971 [00:03<00:13, 57.33it/s]backtest loop:  20%|██        | 199/971 [00:03<00:13, 57.91it/s]backtest loop:  21%|██        | 205/971 [00:03<00:14, 54.32it/s]backtest loop:  22%|██▏       | 212/971 [00:04<00:13, 57.07it/s]backtest loop:  22%|██▏       | 218/971 [00:04<00:13, 54.71it/s]backtest loop:  23%|██▎       | 224/971 [00:04<00:13, 56.13it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 53.96it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:13, 56.41it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 58.15it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:13, 55.40it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:12, 56.33it/s]backtest loop:  27%|██▋       | 263/971 [00:04<00:12, 58.07it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:12, 55.51it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:12, 54.63it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:12, 56.88it/s]backtest loop:  30%|██▉       | 290/971 [00:05<00:11, 58.44it/s]backtest loop:  30%|███       | 296/971 [00:05<00:12, 55.56it/s]backtest loop:  31%|███       | 303/971 [00:05<00:11, 57.49it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 57.59it/s]backtest loop:  32%|███▏      | 315/971 [00:05<00:11, 55.01it/s]backtest loop:  33%|███▎      | 321/971 [00:05<00:11, 56.22it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:11, 57.24it/s]backtest loop:  34%|███▍      | 334/971 [00:06<00:10, 58.65it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:11, 55.73it/s]backtest loop:  36%|███▌      | 346/971 [00:06<00:10, 56.86it/s]backtest loop:  36%|███▋      | 353/971 [00:06<00:10, 58.85it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 56.79it/s]backtest loop:  38%|███▊      | 366/971 [00:06<00:10, 57.50it/s]backtest loop:  38%|███▊      | 372/971 [00:06<00:10, 54.89it/s]backtest loop:  39%|███▉      | 378/971 [00:06<00:11, 52.98it/s]backtest loop:  40%|███▉      | 385/971 [00:07<00:10, 55.90it/s]backtest loop:  40%|████      | 392/971 [00:07<00:10, 57.64it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 55.08it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 57.20it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:09, 58.85it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:09, 55.60it/s]backtest loop:  44%|████▎     | 424/971 [00:08<00:15, 34.73it/s]backtest loop:  44%|████▍     | 430/971 [00:08<00:13, 39.44it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:12, 42.75it/s]backtest loop:  46%|████▌     | 443/971 [00:08<00:11, 46.53it/s]backtest loop:  46%|████▋     | 450/971 [00:08<00:10, 50.58it/s]backtest loop:  47%|████▋     | 456/971 [00:08<00:09, 52.85it/s]backtest loop:  48%|████▊     | 462/971 [00:08<00:09, 51.74it/s]backtest loop:  48%|████▊     | 468/971 [00:08<00:09, 53.69it/s]backtest loop:  49%|████▉     | 475/971 [00:08<00:08, 56.29it/s]backtest loop:  50%|████▉     | 481/971 [00:08<00:08, 57.23it/s]backtest loop:  50%|█████     | 487/971 [00:09<00:08, 54.49it/s]backtest loop:  51%|█████     | 493/971 [00:09<00:08, 55.99it/s]backtest loop:  51%|█████▏    | 499/971 [00:09<00:08, 56.77it/s]backtest loop:  52%|█████▏    | 505/971 [00:09<00:08, 54.83it/s]backtest loop:  53%|█████▎    | 512/971 [00:09<00:08, 53.47it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:08, 55.98it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 54.64it/s]backtest loop:  55%|█████▍    | 532/971 [00:09<00:07, 55.72it/s]backtest loop:  56%|█████▌    | 539/971 [00:10<00:07, 57.72it/s]backtest loop:  56%|█████▌    | 545/971 [00:10<00:07, 58.32it/s]backtest loop:  57%|█████▋    | 551/971 [00:10<00:07, 55.55it/s]backtest loop:  57%|█████▋    | 557/971 [00:10<00:07, 55.85it/s]backtest loop:  58%|█████▊    | 564/971 [00:10<00:07, 57.74it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 55.84it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:06, 57.85it/s]backtest loop:  60%|██████    | 585/971 [00:10<00:06, 59.23it/s]backtest loop:  61%|██████    | 591/971 [00:10<00:06, 56.21it/s]backtest loop:  62%|██████▏   | 598/971 [00:11<00:06, 57.99it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:06, 56.02it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 57.84it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:05, 59.39it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 56.34it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 58.25it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 59.51it/s]backtest loop:  66%|██████▋   | 645/971 [00:11<00:05, 56.72it/s]backtest loop:  67%|██████▋   | 652/971 [00:11<00:05, 58.42it/s]backtest loop:  68%|██████▊   | 659/971 [00:12<00:05, 59.52it/s]backtest loop:  68%|██████▊   | 665/971 [00:12<00:05, 56.54it/s]backtest loop:  69%|██████▉   | 672/971 [00:12<00:05, 58.24it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 56.23it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 57.16it/s]backtest loop:  71%|███████   | 691/971 [00:12<00:04, 57.79it/s]backtest loop:  72%|███████▏  | 698/971 [00:12<00:04, 59.13it/s]backtest loop:  73%|███████▎  | 704/971 [00:12<00:04, 56.11it/s]backtest loop:  73%|███████▎  | 710/971 [00:13<00:04, 57.06it/s]backtest loop:  74%|███████▍  | 717/971 [00:13<00:04, 58.76it/s]backtest loop:  75%|███████▍  | 724/971 [00:13<00:04, 56.55it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 55.02it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 54.05it/s]backtest loop:  77%|███████▋  | 744/971 [00:13<00:04, 55.33it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 53.49it/s]backtest loop:  78%|███████▊  | 757/971 [00:13<00:03, 55.96it/s]backtest loop:  79%|███████▊  | 763/971 [00:13<00:03, 56.86it/s]backtest loop:  79%|███████▉  | 770/971 [00:14<00:03, 55.23it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 57.28it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 54.88it/s]backtest loop:  81%|████████▏ | 790/971 [00:14<00:03, 57.05it/s]backtest loop:  82%|████████▏ | 797/971 [00:14<00:02, 58.52it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:03, 55.67it/s]backtest loop:  83%|████████▎ | 809/971 [00:14<00:02, 56.82it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 57.64it/s]backtest loop:  85%|████████▍ | 822/971 [00:14<00:02, 59.09it/s]backtest loop:  85%|████████▌ | 828/971 [00:15<00:02, 56.00it/s]backtest loop:  86%|████████▌ | 834/971 [00:15<00:02, 56.91it/s]backtest loop:  87%|████████▋ | 841/971 [00:15<00:02, 58.54it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 56.31it/s]backtest loop:  88%|████████▊ | 854/971 [00:15<00:02, 56.92it/s]backtest loop:  89%|████████▊ | 861/971 [00:15<00:01, 58.46it/s]backtest loop:  89%|████████▉ | 867/971 [00:15<00:01, 55.39it/s]backtest loop:  90%|████████▉ | 873/971 [00:15<00:01, 56.56it/s]backtest loop:  91%|█████████ | 880/971 [00:16<00:01, 58.24it/s]backtest loop:  91%|█████████ | 886/971 [00:16<00:01, 58.64it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 55.10it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 57.31it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 58.82it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 55.71it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 57.63it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 55.79it/s]backtest loop:  96%|█████████▌| 933/971 [00:16<00:00, 57.73it/s]backtest loop:  97%|█████████▋| 940/971 [00:17<00:00, 55.85it/s]backtest loop:  98%|█████████▊| 947/971 [00:17<00:00, 57.69it/s]backtest loop:  98%|█████████▊| 954/971 [00:17<00:00, 58.96it/s]backtest loop:  99%|█████████▉| 960/971 [00:17<00:00, 56.07it/s]backtest loop: 100%|█████████▉| 967/971 [00:17<00:00, 57.87it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.15it/s]
[2924289:MainThread](2024-04-24 22:37:37,769) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000550
std                0.005488
annualized_return  0.130871
information_ratio  1.545738
max_drawdown      -0.064647
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000353
std                0.005489
annualized_return  0.084023
information_ratio  0.992195
max_drawdown      -0.079252
[2924289:MainThread](2024-04-24 22:37:37,785) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_21:48:11_online`.
Round 7 Done!
{'1day.excess_return_with_cost.annualized_return': [0.12386974698091249,
                                                    0.1198726782033047,
                                                    0.08568619333630892,
                                                    0.11924882547054218,
                                                    0.07434750552095895,
                                                    0.1327441967693429,
                                                    0.08402333431837816],
 '1day.excess_return_with_cost.information_ratio': [1.414046816672812,
                                                    1.428098235977815,
                                                    1.0011945847928823,
                                                    1.4209694086345042,
                                                    0.9007592657254062,
                                                    1.5650619642691728,
                                                    0.9921947062675395],
 '1day.excess_return_with_cost.max_drawdown': [-0.08039447825046309,
                                               -0.0724795167180563,
                                               -0.16373344369967016,
                                               -0.0596780068312569,
                                               -0.11080742895235432,
                                               -0.07529115587639507,
                                               -0.07925196527005693],
 'IC': [0.03247239452907499,
        0.034917389108111305,
        0.02964435031889077,
        0.0355889467556545,
        0.029887754919344072,
        0.03243817179133714,
        0.031934093208508825],
 'ICIR': [0.22552705133383394,
          0.24081672568443255,
          0.20714330233910136,
          0.252880714547846,
          0.2115851609448364,
          0.23325480456403733,
          0.22850081818571194],
 'Rank IC': [0.031136367658080418,
             0.03398929167284011,
             0.0262953640059444,
             0.0335393501370497,
             0.029115694342890748,
             0.03294090283830007,
             0.03201431708725469],
 'Rank ICIR': [0.21727391618606592,
               0.23611117650462315,
               0.18299316660535125,
               0.23971972679218712,
               0.20831071518991923,
               0.2375896291821766,
               0.22617349904452566],
 'mae': [0.7075666189193726,
         0.707162618637085,
         0.7076587677001953,
         0.7074336409568787,
         0.7076197266578674,
         0.7077104449272156,
         0.7073090076446533],
 'mse': [0.9962677359580994,
         0.9957350492477417,
         0.9965179562568665,
         0.99587082862854,
         0.9965298771858215,
         0.9964921474456787,
         0.996100664138794]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2924289:MainThread](2024-04-24 22:37:38,959) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[2924289:MainThread](2024-04-24 22:37:38,959) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[2924289:MainThread](2024-04-24 22:37:38,962) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[2924289:MainThread](2024-04-24 22:37:38,962) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:08<14:31,  8.81s/it]epoch:   2%|▏         | 2/100 [00:17<14:08,  8.66s/it]epoch:   3%|▎         | 3/100 [00:25<13:46,  8.52s/it]epoch:   4%|▍         | 4/100 [00:34<13:42,  8.57s/it]epoch:   5%|▌         | 5/100 [00:42<13:27,  8.50s/it]epoch:   6%|▌         | 6/100 [00:51<13:22,  8.53s/it]epoch:   7%|▋         | 7/100 [00:59<13:10,  8.50s/it]epoch:   8%|▊         | 8/100 [01:08<12:59,  8.48s/it]epoch:   9%|▉         | 9/100 [01:16<12:55,  8.52s/it]epoch:  10%|█         | 10/100 [01:25<12:42,  8.47s/it]epoch:  11%|█         | 11/100 [01:33<12:32,  8.45s/it]epoch:  12%|█▏        | 12/100 [01:42<12:26,  8.48s/it]epoch:  13%|█▎        | 13/100 [01:50<12:14,  8.44s/it]epoch:  14%|█▍        | 14/100 [01:58<12:03,  8.42s/it]epoch:  15%|█▌        | 15/100 [02:07<11:52,  8.39s/it]epoch:  16%|█▌        | 16/100 [02:15<11:52,  8.48s/it]epoch:  17%|█▋        | 17/100 [02:24<11:42,  8.46s/it]epoch:  18%|█▊        | 18/100 [02:32<11:33,  8.46s/it]epoch:  19%|█▉        | 19/100 [02:41<11:22,  8.43s/it]epoch:  20%|██        | 20/100 [02:49<11:19,  8.49s/it]epoch:  21%|██        | 21/100 [02:58<11:13,  8.53s/it]epoch:  22%|██▏       | 22/100 [03:06<11:06,  8.54s/it]epoch:  23%|██▎       | 23/100 [03:15<10:55,  8.52s/it]epoch:  24%|██▍       | 24/100 [03:23<10:45,  8.50s/it]epoch:  25%|██▌       | 25/100 [03:32<10:35,  8.47s/it]epoch:  26%|██▌       | 26/100 [03:40<10:24,  8.43s/it]epoch:  27%|██▋       | 27/100 [03:49<10:20,  8.50s/it]epoch:  28%|██▊       | 28/100 [03:57<10:10,  8.48s/it]epoch:  29%|██▉       | 29/100 [04:05<09:58,  8.43s/it]epoch:  30%|███       | 30/100 [04:14<09:48,  8.40s/it]0.05216516781536867
best ic: 0.05216516781536867
epoch:  31%|███       | 31/100 [04:23<10:03,  8.75s/it]0.05722765682704797
best ic: 0.05722765682704797
epoch:  32%|███▏      | 32/100 [04:33<10:13,  9.03s/it]0.056346241485881424
epoch:  33%|███▎      | 33/100 [04:43<10:18,  9.24s/it]0.05510812322059093
epoch:  34%|███▍      | 34/100 [04:53<10:19,  9.39s/it]0.05639891506183607
epoch:  35%|███▌      | 35/100 [05:02<10:12,  9.42s/it]0.05408473216972399
epoch:  36%|███▌      | 36/100 [05:11<10:03,  9.43s/it]0.05400441331117583
epoch:  37%|███▋      | 37/100 [05:21<09:55,  9.45s/it]0.04919918855037911
epoch:  38%|███▊      | 38/100 [05:31<09:48,  9.50s/it]0.05362383763846163
epoch:  39%|███▉      | 39/100 [05:40<09:43,  9.57s/it]0.05398851325015166
epoch:  39%|███▉      | 39/100 [05:50<09:08,  8.99s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2924289:MainThread](2024-04-24 22:43:29,662) INFO - qlib.workflow - [exp.py:258] - Experiment 39 starts running ...
[2924289:MainThread](2024-04-24 22:43:29,676) INFO - qlib.workflow - [recorder.py:341] - Recorder 0f49da0569c847a09300cc4ab50f74c3 starts running under Experiment 39 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:04, 14.19it/s]online:   6%|▋         | 4/63 [00:00<00:04, 14.44it/s]online:  10%|▉         | 6/63 [00:00<00:03, 14.56it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 14.52it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 14.59it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 14.60it/s]online:  22%|██▏       | 14/63 [00:00<00:03, 14.66it/s]online:  25%|██▌       | 16/63 [00:01<00:03, 14.45it/s]online:  29%|██▊       | 18/63 [00:01<00:03, 14.27it/s]online:  32%|███▏      | 20/63 [00:01<00:03, 14.20it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 14.29it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 14.27it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 14.28it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 14.29it/s]online:  48%|████▊     | 30/63 [00:02<00:02, 14.40it/s]online:  51%|█████     | 32/63 [00:02<00:02, 14.36it/s]online:  54%|█████▍    | 34/63 [00:02<00:02, 14.35it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 14.45it/s]online:  60%|██████    | 38/63 [00:02<00:01, 14.52it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 14.52it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 14.52it/s]online:  70%|██████▉   | 44/63 [00:03<00:01, 14.34it/s]online:  73%|███████▎  | 46/63 [00:03<00:01, 14.36it/s]online:  76%|███████▌  | 48/63 [00:03<00:01, 14.31it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 14.28it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 14.37it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 14.37it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 14.36it/s]online:  92%|█████████▏| 58/63 [00:04<00:00, 14.23it/s]online:  95%|█████████▌| 60/63 [00:04<00:00, 14.31it/s]online:  98%|█████████▊| 62/63 [00:04<00:00, 14.27it/s]online: 100%|██████████| 63/63 [00:04<00:00, 14.40it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2924289:MainThread](2024-04-24 22:43:43,081) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99603605 mae 0.7072972
{'IC': 0.03359107128026256,
 'ICIR': 0.23819796657702028,
 'Rank IC': 0.033753986531726114,
 'Rank ICIR': 0.24671488678111922}
[2924289:MainThread](2024-04-24 22:43:44,856) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2924289:MainThread](2024-04-24 22:43:57,797) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 22:43:57,801) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 22:44:03,985) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f4f8a7f5940>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:50,  8.75it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 23.67it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 34.14it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 39.15it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:21, 44.83it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.24it/s]backtest loop:   4%|▍         | 40/971 [00:01<00:18, 50.58it/s]backtest loop:   5%|▍         | 46/971 [00:01<00:17, 53.20it/s]backtest loop:   5%|▌         | 52/971 [00:01<00:16, 54.93it/s]backtest loop:   6%|▌         | 58/971 [00:01<00:17, 53.10it/s]backtest loop:   7%|▋         | 65/971 [00:01<00:16, 56.32it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 55.31it/s]backtest loop:   8%|▊         | 79/971 [00:01<00:15, 57.49it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:14, 59.11it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:15, 56.38it/s]backtest loop:  10%|█         | 99/971 [00:02<00:15, 57.84it/s]backtest loop:  11%|█         | 106/971 [00:02<00:14, 59.17it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 56.08it/s]backtest loop:  12%|█▏        | 118/971 [00:02<00:15, 56.71it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 55.12it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 52.93it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:14, 55.65it/s]backtest loop:  15%|█▍        | 144/971 [00:02<00:14, 56.44it/s]backtest loop:  16%|█▌        | 151/971 [00:02<00:14, 54.99it/s]backtest loop:  16%|█▌        | 157/971 [00:03<00:14, 56.15it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:14, 57.15it/s]backtest loop:  17%|█▋        | 169/971 [00:03<00:13, 57.94it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 55.96it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:13, 57.74it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:13, 55.83it/s]backtest loop:  20%|██        | 196/971 [00:03<00:13, 56.78it/s]backtest loop:  21%|██        | 203/971 [00:03<00:13, 58.39it/s]backtest loop:  22%|██▏       | 210/971 [00:04<00:13, 56.28it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 54.24it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:13, 55.60it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:12, 57.53it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:13, 54.95it/s]backtest loop:  25%|██▍       | 241/971 [00:04<00:12, 56.23it/s]backtest loop:  26%|██▌       | 248/971 [00:04<00:12, 58.22it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:12, 55.17it/s]backtest loop:  27%|██▋       | 260/971 [00:04<00:12, 56.44it/s]backtest loop:  27%|██▋       | 266/971 [00:05<00:13, 53.98it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 56.50it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:11, 58.55it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 55.66it/s]backtest loop:  30%|███       | 292/971 [00:05<00:11, 56.66it/s]backtest loop:  31%|███       | 299/971 [00:05<00:11, 58.43it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:12, 55.20it/s]backtest loop:  32%|███▏      | 311/971 [00:05<00:11, 56.49it/s]backtest loop:  33%|███▎      | 317/971 [00:05<00:11, 57.40it/s]backtest loop:  33%|███▎      | 323/971 [00:06<00:11, 57.54it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:11, 55.02it/s]backtest loop:  35%|███▍      | 336/971 [00:06<00:11, 56.10it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:11, 57.09it/s]backtest loop:  36%|███▌      | 349/971 [00:06<00:10, 58.86it/s]backtest loop:  37%|███▋      | 355/971 [00:06<00:11, 55.61it/s]backtest loop:  37%|███▋      | 362/971 [00:06<00:10, 57.76it/s]backtest loop:  38%|███▊      | 368/971 [00:06<00:11, 52.07it/s]backtest loop:  39%|███▊      | 375/971 [00:06<00:10, 54.97it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:10, 56.28it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 57.15it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 54.66it/s]backtest loop:  41%|████      | 399/971 [00:07<00:10, 55.69it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 56.72it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:09, 58.33it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:10, 55.05it/s]backtest loop:  44%|████▎     | 424/971 [00:08<00:16, 33.58it/s]backtest loop:  44%|████▍     | 430/971 [00:08<00:14, 38.49it/s]backtest loop:  45%|████▍     | 436/971 [00:08<00:12, 42.85it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:11, 44.47it/s]backtest loop:  46%|████▌     | 448/971 [00:08<00:10, 48.11it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:10, 50.95it/s]backtest loop:  47%|████▋     | 460/971 [00:08<00:09, 53.34it/s]backtest loop:  48%|████▊     | 466/971 [00:08<00:09, 55.08it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:09, 53.28it/s]backtest loop:  49%|████▉     | 479/971 [00:09<00:08, 55.89it/s]backtest loop:  50%|████▉     | 485/971 [00:09<00:08, 56.76it/s]backtest loop:  51%|█████     | 491/971 [00:09<00:08, 54.37it/s]backtest loop:  51%|█████▏    | 498/971 [00:09<00:08, 56.66it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:08, 57.16it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:08, 54.67it/s]backtest loop:  53%|█████▎    | 516/971 [00:09<00:08, 55.55it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:08, 53.46it/s]backtest loop:  54%|█████▍    | 528/971 [00:09<00:08, 55.18it/s]backtest loop:  55%|█████▍    | 534/971 [00:10<00:07, 56.42it/s]backtest loop:  56%|█████▌    | 541/971 [00:10<00:07, 54.90it/s]backtest loop:  56%|█████▋    | 547/971 [00:10<00:07, 56.21it/s]backtest loop:  57%|█████▋    | 553/971 [00:10<00:07, 57.20it/s]backtest loop:  58%|█████▊    | 559/971 [00:10<00:07, 57.92it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 55.73it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:06, 57.59it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 58.92it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:06, 56.02it/s]backtest loop:  61%|██████    | 592/971 [00:11<00:06, 56.98it/s]backtest loop:  62%|██████▏   | 598/971 [00:11<00:06, 57.79it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:06, 55.93it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 57.76it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:05, 59.31it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 56.15it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 58.10it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 59.55it/s]backtest loop:  66%|██████▋   | 645/971 [00:11<00:05, 56.36it/s]backtest loop:  67%|██████▋   | 651/971 [00:12<00:05, 57.14it/s]backtest loop:  68%|██████▊   | 657/971 [00:12<00:05, 57.56it/s]backtest loop:  68%|██████▊   | 663/971 [00:12<00:05, 58.24it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 56.05it/s]backtest loop:  70%|██████▉   | 676/971 [00:12<00:05, 56.93it/s]backtest loop:  70%|███████   | 682/971 [00:12<00:05, 57.72it/s]backtest loop:  71%|███████   | 688/971 [00:12<00:04, 58.08it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:05, 54.82it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 57.02it/s]backtest loop:  73%|███████▎  | 708/971 [00:13<00:04, 58.57it/s]backtest loop:  74%|███████▎  | 714/971 [00:13<00:04, 54.98it/s]backtest loop:  74%|███████▍  | 720/971 [00:13<00:04, 56.30it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 57.33it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 54.49it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 52.72it/s]backtest loop:  77%|███████▋  | 744/971 [00:13<00:04, 54.53it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 52.64it/s]backtest loop:  78%|███████▊  | 756/971 [00:13<00:03, 54.60it/s]backtest loop:  78%|███████▊  | 762/971 [00:14<00:03, 56.00it/s]backtest loop:  79%|███████▉  | 768/971 [00:14<00:03, 56.79it/s]backtest loop:  80%|███████▉  | 774/971 [00:14<00:03, 57.58it/s]backtest loop:  80%|████████  | 780/971 [00:14<00:03, 54.70it/s]backtest loop:  81%|████████  | 786/971 [00:14<00:03, 56.14it/s]backtest loop:  82%|████████▏ | 792/971 [00:14<00:03, 57.01it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 54.38it/s]backtest loop:  83%|████████▎ | 804/971 [00:14<00:02, 55.87it/s]backtest loop:  83%|████████▎ | 810/971 [00:14<00:02, 56.84it/s]backtest loop:  84%|████████▍ | 816/971 [00:14<00:02, 57.64it/s]backtest loop:  85%|████████▍ | 822/971 [00:15<00:02, 58.23it/s]backtest loop:  85%|████████▌ | 828/971 [00:15<00:02, 55.07it/s]backtest loop:  86%|████████▌ | 834/971 [00:15<00:02, 56.44it/s]backtest loop:  87%|████████▋ | 840/971 [00:15<00:02, 57.42it/s]backtest loop:  87%|████████▋ | 846/971 [00:15<00:02, 57.89it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 54.95it/s]backtest loop:  88%|████████▊ | 858/971 [00:15<00:02, 56.35it/s]backtest loop:  89%|████████▉ | 865/971 [00:15<00:01, 57.65it/s]backtest loop:  90%|████████▉ | 871/971 [00:15<00:01, 58.14it/s]backtest loop:  90%|█████████ | 877/971 [00:16<00:01, 55.07it/s]backtest loop:  91%|█████████ | 884/971 [00:16<00:01, 57.24it/s]backtest loop:  92%|█████████▏| 890/971 [00:16<00:01, 57.61it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 55.72it/s]backtest loop:  93%|█████████▎| 904/971 [00:16<00:01, 57.61it/s]backtest loop:  94%|█████████▍| 911/971 [00:16<00:01, 58.95it/s]backtest loop:  94%|█████████▍| 917/971 [00:16<00:00, 55.76it/s]backtest loop:  95%|█████████▌| 924/971 [00:16<00:00, 57.58it/s]backtest loop:  96%|█████████▌| 931/971 [00:17<00:00, 55.71it/s]backtest loop:  96%|█████████▋| 937/971 [00:17<00:00, 56.70it/s]backtest loop:  97%|█████████▋| 944/971 [00:17<00:00, 58.55it/s]backtest loop:  98%|█████████▊| 950/971 [00:17<00:00, 55.61it/s]backtest loop:  99%|█████████▊| 957/971 [00:17<00:00, 57.47it/s]backtest loop:  99%|█████████▉| 963/971 [00:17<00:00, 57.90it/s]backtest loop: 100%|█████████▉| 970/971 [00:17<00:00, 55.97it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.80it/s]
[2924289:MainThread](2024-04-24 22:44:21,779) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000790
std                0.005274
annualized_return  0.187950
information_ratio  2.309978
max_drawdown      -0.059647
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000592
std                0.005275
annualized_return  0.140882
information_ratio  1.731263
max_drawdown      -0.074331
[2924289:MainThread](2024-04-24 22:44:21,795) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_21:48:11_online`.
Round 8 Done!
{'1day.excess_return_with_cost.annualized_return': [0.12386974698091249,
                                                    0.1198726782033047,
                                                    0.08568619333630892,
                                                    0.11924882547054218,
                                                    0.07434750552095895,
                                                    0.1327441967693429,
                                                    0.08402333431837816,
                                                    0.1408819888005938],
 '1day.excess_return_with_cost.information_ratio': [1.414046816672812,
                                                    1.428098235977815,
                                                    1.0011945847928823,
                                                    1.4209694086345042,
                                                    0.9007592657254062,
                                                    1.5650619642691728,
                                                    0.9921947062675395,
                                                    1.7312633217135882],
 '1day.excess_return_with_cost.max_drawdown': [-0.08039447825046309,
                                               -0.0724795167180563,
                                               -0.16373344369967016,
                                               -0.0596780068312569,
                                               -0.11080742895235432,
                                               -0.07529115587639507,
                                               -0.07925196527005693,
                                               -0.07433135212832731],
 'IC': [0.03247239452907499,
        0.034917389108111305,
        0.02964435031889077,
        0.0355889467556545,
        0.029887754919344072,
        0.03243817179133714,
        0.031934093208508825,
        0.03359107128026256],
 'ICIR': [0.22552705133383394,
          0.24081672568443255,
          0.20714330233910136,
          0.252880714547846,
          0.2115851609448364,
          0.23325480456403733,
          0.22850081818571194,
          0.23819796657702028],
 'Rank IC': [0.031136367658080418,
             0.03398929167284011,
             0.0262953640059444,
             0.0335393501370497,
             0.029115694342890748,
             0.03294090283830007,
             0.03201431708725469,
             0.033753986531726114],
 'Rank ICIR': [0.21727391618606592,
               0.23611117650462315,
               0.18299316660535125,
               0.23971972679218712,
               0.20831071518991923,
               0.2375896291821766,
               0.22617349904452566,
               0.24671488678111922],
 'mae': [0.7075666189193726,
         0.707162618637085,
         0.7076587677001953,
         0.7074336409568787,
         0.7076197266578674,
         0.7077104449272156,
         0.7073090076446533,
         0.7072972059249878],
 'mse': [0.9962677359580994,
         0.9957350492477417,
         0.9965179562568665,
         0.99587082862854,
         0.9965298771858215,
         0.9964921474456787,
         0.996100664138794,
         0.9960360527038574]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2924289:MainThread](2024-04-24 22:44:22,983) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[2924289:MainThread](2024-04-24 22:44:22,983) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[2924289:MainThread](2024-04-24 22:44:22,985) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[2924289:MainThread](2024-04-24 22:44:22,986) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:08<14:18,  8.67s/it]epoch:   2%|▏         | 2/100 [00:17<14:03,  8.60s/it]epoch:   3%|▎         | 3/100 [00:25<13:46,  8.52s/it]epoch:   4%|▍         | 4/100 [00:34<13:46,  8.61s/it]epoch:   5%|▌         | 5/100 [00:42<13:33,  8.56s/it]epoch:   6%|▌         | 6/100 [00:51<13:26,  8.58s/it]epoch:   7%|▋         | 7/100 [01:00<13:18,  8.59s/it]epoch:   8%|▊         | 8/100 [01:08<13:05,  8.54s/it]epoch:   9%|▉         | 9/100 [01:17<12:59,  8.57s/it]epoch:  10%|█         | 10/100 [01:25<12:53,  8.59s/it]epoch:  11%|█         | 11/100 [01:34<12:39,  8.53s/it]epoch:  12%|█▏        | 12/100 [01:42<12:29,  8.52s/it]epoch:  13%|█▎        | 13/100 [01:51<12:24,  8.56s/it]epoch:  14%|█▍        | 14/100 [01:59<12:11,  8.50s/it]epoch:  15%|█▌        | 15/100 [02:08<11:58,  8.45s/it]epoch:  16%|█▌        | 16/100 [02:16<11:49,  8.45s/it]epoch:  17%|█▋        | 17/100 [02:24<11:42,  8.46s/it]epoch:  18%|█▊        | 18/100 [02:33<11:34,  8.47s/it]epoch:  19%|█▉        | 19/100 [02:41<11:27,  8.49s/it]epoch:  20%|██        | 20/100 [02:50<11:15,  8.44s/it]epoch:  21%|██        | 21/100 [02:58<11:03,  8.40s/it]epoch:  22%|██▏       | 22/100 [03:07<10:59,  8.45s/it]epoch:  23%|██▎       | 23/100 [03:15<10:54,  8.50s/it]epoch:  24%|██▍       | 24/100 [03:24<10:44,  8.48s/it]epoch:  25%|██▌       | 25/100 [03:32<10:34,  8.47s/it]epoch:  26%|██▌       | 26/100 [03:41<10:24,  8.44s/it]epoch:  27%|██▋       | 27/100 [03:49<10:12,  8.39s/it]epoch:  28%|██▊       | 28/100 [03:57<10:07,  8.44s/it]epoch:  29%|██▉       | 29/100 [04:06<10:02,  8.48s/it]epoch:  30%|███       | 30/100 [04:15<09:56,  8.52s/it]0.05902163293016969
best ic: 0.05902163293016969
epoch:  31%|███       | 31/100 [04:24<10:12,  8.87s/it]0.05535226061983565
epoch:  32%|███▏      | 32/100 [04:34<10:19,  9.11s/it]0.05857430636087746
epoch:  33%|███▎      | 33/100 [04:44<10:22,  9.29s/it]0.05398337562757197
epoch:  34%|███▍      | 34/100 [04:53<10:20,  9.39s/it]0.054041421939268114
epoch:  35%|███▌      | 35/100 [05:03<10:13,  9.44s/it]0.05472038926577585
epoch:  36%|███▌      | 36/100 [05:12<10:04,  9.45s/it]0.053747035423087605
epoch:  37%|███▋      | 37/100 [05:22<09:57,  9.48s/it]0.056664482419974786
epoch:  38%|███▊      | 38/100 [05:31<09:45,  9.44s/it]0.0562610153718667
epoch:  38%|███▊      | 38/100 [05:41<09:16,  8.97s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2924289:MainThread](2024-04-24 22:50:04,033) INFO - qlib.workflow - [exp.py:258] - Experiment 39 starts running ...
[2924289:MainThread](2024-04-24 22:50:04,047) INFO - qlib.workflow - [recorder.py:341] - Recorder af4a9ebe0cd4449ab11d2af74c60bb61 starts running under Experiment 39 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:04, 15.13it/s]online:   6%|▋         | 4/63 [00:00<00:03, 15.21it/s]online:  10%|▉         | 6/63 [00:00<00:03, 15.19it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 15.18it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 15.17it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 15.17it/s]online:  22%|██▏       | 14/63 [00:00<00:03, 15.16it/s]online:  25%|██▌       | 16/63 [00:01<00:03, 15.17it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 15.17it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 15.17it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 15.03it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 15.02it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 15.07it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 15.10it/s]online:  48%|████▊     | 30/63 [00:01<00:02, 15.08it/s]online:  51%|█████     | 32/63 [00:02<00:02, 15.09it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 15.06it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 15.09it/s]online:  60%|██████    | 38/63 [00:02<00:01, 15.12it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 15.13it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 15.13it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 15.14it/s]online:  73%|███████▎  | 46/63 [00:03<00:01, 15.15it/s]online:  76%|███████▌  | 48/63 [00:03<00:00, 15.11it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 15.12it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 15.12it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 15.13it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 15.13it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 15.13it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 15.13it/s]online:  98%|█████████▊| 62/63 [00:04<00:00, 15.12it/s]online: 100%|██████████| 63/63 [00:04<00:00, 15.15it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2924289:MainThread](2024-04-24 22:50:16,301) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9962529 mae 0.70752376
{'IC': 0.03163532889365818,
 'ICIR': 0.22573230078117004,
 'Rank IC': 0.030937372483053616,
 'Rank ICIR': 0.21926036684408667}
[2924289:MainThread](2024-04-24 22:50:18,055) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2924289:MainThread](2024-04-24 22:50:30,744) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 22:50:30,749) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 22:50:36,869) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f55e455fcd0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:49,  8.81it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 23.86it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 34.26it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 39.19it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.08it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 49.30it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:18, 49.10it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:17, 52.06it/s]backtest loop:   5%|▌         | 52/971 [00:01<00:16, 55.21it/s]backtest loop:   6%|▌         | 58/971 [00:01<00:17, 53.21it/s]backtest loop:   7%|▋         | 65/971 [00:01<00:16, 55.89it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 55.12it/s]backtest loop:   8%|▊         | 78/971 [00:01<00:15, 56.33it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 57.16it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 58.86it/s]backtest loop:  10%|▉         | 97/971 [00:02<00:15, 55.20it/s]backtest loop:  11%|█         | 103/971 [00:02<00:15, 56.44it/s]backtest loop:  11%|█         | 109/971 [00:02<00:15, 57.02it/s]backtest loop:  12%|█▏        | 116/971 [00:02<00:14, 58.64it/s]backtest loop:  13%|█▎        | 122/971 [00:02<00:15, 55.59it/s]backtest loop:  13%|█▎        | 128/971 [00:02<00:15, 53.62it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:14, 56.13it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 54.15it/s]backtest loop:  15%|█▌        | 147/971 [00:02<00:14, 55.69it/s]backtest loop:  16%|█▌        | 154/971 [00:03<00:14, 57.71it/s]backtest loop:  16%|█▋        | 160/971 [00:03<00:13, 58.10it/s]backtest loop:  17%|█▋        | 166/971 [00:03<00:14, 55.26it/s]backtest loop:  18%|█▊        | 172/971 [00:03<00:14, 56.23it/s]backtest loop:  18%|█▊        | 179/971 [00:03<00:13, 58.35it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:14, 55.44it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:13, 57.60it/s]backtest loop:  20%|██        | 198/971 [00:03<00:13, 58.07it/s]backtest loop:  21%|██        | 205/971 [00:03<00:13, 55.87it/s]backtest loop:  22%|██▏       | 212/971 [00:04<00:13, 58.07it/s]backtest loop:  22%|██▏       | 218/971 [00:04<00:13, 55.39it/s]backtest loop:  23%|██▎       | 224/971 [00:04<00:13, 56.53it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 54.19it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 56.64it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 58.27it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:13, 55.44it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 57.60it/s]backtest loop:  27%|██▋       | 264/971 [00:04<00:12, 55.98it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:12, 54.63it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:12, 56.85it/s]backtest loop:  29%|██▉       | 284/971 [00:05<00:12, 57.14it/s]backtest loop:  30%|██▉       | 290/971 [00:05<00:11, 57.87it/s]backtest loop:  30%|███       | 296/971 [00:05<00:12, 54.85it/s]backtest loop:  31%|███       | 303/971 [00:05<00:11, 57.01it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 57.72it/s]backtest loop:  32%|███▏      | 315/971 [00:05<00:11, 55.00it/s]backtest loop:  33%|███▎      | 322/971 [00:05<00:11, 57.34it/s]backtest loop:  34%|███▍      | 329/971 [00:06<00:10, 59.09it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:11, 56.42it/s]backtest loop:  35%|███▌      | 341/971 [00:06<00:11, 57.24it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:10, 57.91it/s]backtest loop:  36%|███▋      | 353/971 [00:06<00:10, 58.45it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 56.41it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.03it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 53.22it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:10, 55.89it/s]backtest loop:  40%|███▉      | 386/971 [00:07<00:10, 56.90it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 55.49it/s]backtest loop:  41%|████      | 399/971 [00:07<00:10, 56.60it/s]backtest loop:  42%|████▏     | 406/971 [00:07<00:09, 58.26it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:09, 56.34it/s]backtest loop:  43%|████▎     | 419/971 [00:07<00:09, 57.00it/s]backtest loop:  44%|████▍     | 425/971 [00:07<00:09, 57.82it/s]backtest loop:  44%|████▍     | 431/971 [00:07<00:09, 58.19it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:09, 55.22it/s]backtest loop:  46%|████▌     | 443/971 [00:08<00:09, 56.27it/s]backtest loop:  46%|████▌     | 449/971 [00:08<00:09, 57.32it/s]backtest loop:  47%|████▋     | 455/971 [00:08<00:08, 58.07it/s]backtest loop:  47%|████▋     | 461/971 [00:08<00:08, 58.28it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:09, 55.22it/s]backtest loop:  49%|████▊     | 473/971 [00:08<00:08, 56.27it/s]backtest loop:  49%|████▉     | 480/971 [00:08<00:08, 58.06it/s]backtest loop:  50%|█████     | 486/971 [00:09<00:13, 34.75it/s]backtest loop:  51%|█████     | 491/971 [00:09<00:12, 37.05it/s]backtest loop:  51%|█████▏    | 498/971 [00:09<00:11, 42.98it/s]backtest loop:  52%|█████▏    | 505/971 [00:09<00:10, 45.65it/s]backtest loop:  53%|█████▎    | 512/971 [00:09<00:09, 47.52it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:08, 51.27it/s]backtest loop:  54%|█████▍    | 525/971 [00:09<00:08, 53.37it/s]backtest loop:  55%|█████▍    | 531/971 [00:09<00:08, 52.12it/s]backtest loop:  55%|█████▌    | 538/971 [00:10<00:07, 55.32it/s]backtest loop:  56%|█████▌    | 545/971 [00:10<00:07, 57.28it/s]backtest loop:  57%|█████▋    | 551/971 [00:10<00:07, 54.82it/s]backtest loop:  57%|█████▋    | 557/971 [00:10<00:07, 56.16it/s]backtest loop:  58%|█████▊    | 563/971 [00:10<00:07, 57.17it/s]backtest loop:  59%|█████▊    | 569/971 [00:10<00:06, 57.97it/s]backtest loop:  59%|█████▉    | 576/971 [00:10<00:07, 55.93it/s]backtest loop:  60%|██████    | 583/971 [00:10<00:06, 57.70it/s]backtest loop:  61%|██████    | 590/971 [00:10<00:06, 59.04it/s]backtest loop:  61%|██████▏   | 596/971 [00:11<00:06, 56.07it/s]backtest loop:  62%|██████▏   | 602/971 [00:11<00:06, 56.89it/s]backtest loop:  63%|██████▎   | 609/971 [00:11<00:06, 58.51it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:06, 55.72it/s]backtest loop:  64%|██████▍   | 622/971 [00:11<00:06, 57.59it/s]backtest loop:  65%|██████▍   | 629/971 [00:11<00:05, 58.97it/s]backtest loop:  65%|██████▌   | 635/971 [00:11<00:05, 56.14it/s]backtest loop:  66%|██████▌   | 642/971 [00:11<00:05, 57.94it/s]backtest loop:  67%|██████▋   | 649/971 [00:11<00:05, 59.31it/s]backtest loop:  67%|██████▋   | 655/971 [00:12<00:05, 55.92it/s]backtest loop:  68%|██████▊   | 662/971 [00:12<00:05, 57.70it/s]backtest loop:  69%|██████▉   | 669/971 [00:12<00:05, 58.98it/s]backtest loop:  70%|██████▉   | 675/971 [00:12<00:05, 55.70it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:05, 56.75it/s]backtest loop:  71%|███████   | 687/971 [00:12<00:04, 57.44it/s]backtest loop:  71%|███████▏  | 693/971 [00:12<00:04, 58.13it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 55.16it/s]backtest loop:  73%|███████▎  | 705/971 [00:12<00:04, 56.46it/s]backtest loop:  73%|███████▎  | 711/971 [00:13<00:04, 57.41it/s]backtest loop:  74%|███████▍  | 718/971 [00:13<00:04, 59.02it/s]backtest loop:  75%|███████▍  | 724/971 [00:13<00:04, 55.82it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 54.48it/s]backtest loop:  76%|███████▌  | 737/971 [00:13<00:04, 55.92it/s]backtest loop:  77%|███████▋  | 743/971 [00:13<00:04, 53.35it/s]backtest loop:  77%|███████▋  | 749/971 [00:13<00:04, 55.09it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 53.12it/s]backtest loop:  78%|███████▊  | 761/971 [00:13<00:03, 54.30it/s]backtest loop:  79%|███████▉  | 767/971 [00:14<00:03, 55.75it/s]backtest loop:  80%|███████▉  | 773/971 [00:14<00:03, 56.89it/s]backtest loop:  80%|████████  | 780/971 [00:14<00:03, 55.16it/s]backtest loop:  81%|████████  | 787/971 [00:14<00:03, 57.34it/s]backtest loop:  82%|████████▏ | 793/971 [00:14<00:03, 54.78it/s]backtest loop:  82%|████████▏ | 799/971 [00:14<00:03, 56.15it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:02, 57.17it/s]backtest loop:  84%|████████▎ | 811/971 [00:14<00:02, 57.94it/s]backtest loop:  84%|████████▍ | 818/971 [00:14<00:02, 55.90it/s]backtest loop:  85%|████████▍ | 824/971 [00:15<00:02, 57.01it/s]backtest loop:  86%|████████▌ | 831/971 [00:15<00:02, 58.58it/s]backtest loop:  86%|████████▌ | 837/971 [00:15<00:02, 58.95it/s]backtest loop:  87%|████████▋ | 843/971 [00:15<00:02, 55.56it/s]backtest loop:  88%|████████▊ | 850/971 [00:15<00:02, 57.57it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 55.66it/s]backtest loop:  89%|████████▉ | 864/971 [00:15<00:01, 57.52it/s]backtest loop:  90%|████████▉ | 871/971 [00:15<00:01, 59.05it/s]backtest loop:  90%|█████████ | 877/971 [00:16<00:01, 55.97it/s]backtest loop:  91%|█████████ | 884/971 [00:16<00:01, 57.81it/s]backtest loop:  92%|█████████▏| 890/971 [00:16<00:01, 58.39it/s]backtest loop:  92%|█████████▏| 897/971 [00:16<00:01, 56.27it/s]backtest loop:  93%|█████████▎| 904/971 [00:16<00:01, 57.98it/s]backtest loop:  94%|█████████▎| 910/971 [00:16<00:01, 58.37it/s]backtest loop:  94%|█████████▍| 916/971 [00:16<00:00, 55.69it/s]backtest loop:  95%|█████████▌| 923/971 [00:16<00:00, 57.65it/s]backtest loop:  96%|█████████▌| 930/971 [00:16<00:00, 59.10it/s]backtest loop:  96%|█████████▋| 936/971 [00:17<00:00, 55.89it/s]backtest loop:  97%|█████████▋| 943/971 [00:17<00:00, 57.88it/s]backtest loop:  98%|█████████▊| 950/971 [00:17<00:00, 55.85it/s]backtest loop:  98%|█████████▊| 956/971 [00:17<00:00, 56.88it/s]backtest loop:  99%|█████████▉| 962/971 [00:17<00:00, 57.71it/s]backtest loop: 100%|█████████▉| 968/971 [00:17<00:00, 58.30it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.01it/s]
[2924289:MainThread](2024-04-24 22:50:54,595) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000622
std                0.005752
annualized_return  0.148088
information_ratio  1.668913
max_drawdown      -0.050676
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000425
std                0.005753
annualized_return  0.101061
information_ratio  1.138709
max_drawdown      -0.057957
[2924289:MainThread](2024-04-24 22:50:54,612) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_21:48:11_online`.
Round 9 Done!
{'1day.excess_return_with_cost.annualized_return': [0.12386974698091249,
                                                    0.1198726782033047,
                                                    0.08568619333630892,
                                                    0.11924882547054218,
                                                    0.07434750552095895,
                                                    0.1327441967693429,
                                                    0.08402333431837816,
                                                    0.1408819888005938,
                                                    0.10106062935808849],
 '1day.excess_return_with_cost.information_ratio': [1.414046816672812,
                                                    1.428098235977815,
                                                    1.0011945847928823,
                                                    1.4209694086345042,
                                                    0.9007592657254062,
                                                    1.5650619642691728,
                                                    0.9921947062675395,
                                                    1.7312633217135882,
                                                    1.1387089117482565],
 '1day.excess_return_with_cost.max_drawdown': [-0.08039447825046309,
                                               -0.0724795167180563,
                                               -0.16373344369967016,
                                               -0.0596780068312569,
                                               -0.11080742895235432,
                                               -0.07529115587639507,
                                               -0.07925196527005693,
                                               -0.07433135212832731,
                                               -0.05795673047519162],
 'IC': [0.03247239452907499,
        0.034917389108111305,
        0.02964435031889077,
        0.0355889467556545,
        0.029887754919344072,
        0.03243817179133714,
        0.031934093208508825,
        0.03359107128026256,
        0.03163532889365818],
 'ICIR': [0.22552705133383394,
          0.24081672568443255,
          0.20714330233910136,
          0.252880714547846,
          0.2115851609448364,
          0.23325480456403733,
          0.22850081818571194,
          0.23819796657702028,
          0.22573230078117004],
 'Rank IC': [0.031136367658080418,
             0.03398929167284011,
             0.0262953640059444,
             0.0335393501370497,
             0.029115694342890748,
             0.03294090283830007,
             0.03201431708725469,
             0.033753986531726114,
             0.030937372483053616],
 'Rank ICIR': [0.21727391618606592,
               0.23611117650462315,
               0.18299316660535125,
               0.23971972679218712,
               0.20831071518991923,
               0.2375896291821766,
               0.22617349904452566,
               0.24671488678111922,
               0.21926036684408667],
 'mae': [0.7075666189193726,
         0.707162618637085,
         0.7076587677001953,
         0.7074336409568787,
         0.7076197266578674,
         0.7077104449272156,
         0.7073090076446533,
         0.7072972059249878,
         0.707523763179779],
 'mse': [0.9962677359580994,
         0.9957350492477417,
         0.9965179562568665,
         0.99587082862854,
         0.9965298771858215,
         0.9964921474456787,
         0.996100664138794,
         0.9960360527038574,
         0.9962528944015503]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2924289:MainThread](2024-04-24 22:50:55,787) INFO - qlib.ALSTM - [pytorch_alstm.py:61] - ALSTM pytorch version...
[2924289:MainThread](2024-04-24 22:50:55,787) INFO - qlib.ALSTM - [pytorch_alstm.py:78] - ALSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[2924289:MainThread](2024-04-24 22:50:55,790) INFO - qlib.ALSTM - [pytorch_alstm.py:121] - model:
ALSTMModel(
  (net): Sequential(
    (fc_in): Linear(in_features=6, out_features=64, bias=True)
    (act): Tanh()
  )
  (rnn): GRU(64, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=128, out_features=1, bias=True)
  (att_net): Sequential(
    (att_fc_in): Linear(in_features=64, out_features=32, bias=True)
    (att_dropout): Dropout(p=0.0, inplace=False)
    (att_act): Tanh()
    (att_fc_out): Linear(in_features=32, out_features=1, bias=False)
    (att_softmax): Softmax(dim=1)
  )
)
[2924289:MainThread](2024-04-24 22:50:55,790) INFO - qlib.ALSTM - [pytorch_alstm.py:122] - model size: 0.0502 MB
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:08<14:28,  8.77s/it]epoch:   2%|▏         | 2/100 [00:17<14:13,  8.70s/it]epoch:   3%|▎         | 3/100 [00:26<14:03,  8.70s/it]epoch:   4%|▍         | 4/100 [00:34<13:51,  8.66s/it]epoch:   5%|▌         | 5/100 [00:43<13:40,  8.64s/it]epoch:   6%|▌         | 6/100 [00:51<13:29,  8.61s/it]epoch:   7%|▋         | 7/100 [01:00<13:13,  8.53s/it]epoch:   8%|▊         | 8/100 [01:08<13:01,  8.50s/it]epoch:   9%|▉         | 9/100 [01:17<12:53,  8.50s/it]epoch:  10%|█         | 10/100 [01:25<12:40,  8.44s/it]epoch:  11%|█         | 11/100 [01:34<12:38,  8.52s/it]epoch:  12%|█▏        | 12/100 [01:42<12:29,  8.51s/it]epoch:  13%|█▎        | 13/100 [01:51<12:18,  8.48s/it]epoch:  14%|█▍        | 14/100 [01:59<12:05,  8.43s/it]epoch:  15%|█▌        | 15/100 [02:08<12:02,  8.50s/it]epoch:  16%|█▌        | 16/100 [02:16<11:52,  8.48s/it]epoch:  17%|█▋        | 17/100 [02:24<11:40,  8.44s/it]epoch:  18%|█▊        | 18/100 [02:33<11:31,  8.43s/it]epoch:  19%|█▉        | 19/100 [02:41<11:27,  8.49s/it]epoch:  20%|██        | 20/100 [02:50<11:19,  8.49s/it]epoch:  21%|██        | 21/100 [02:58<11:09,  8.47s/it]epoch:  22%|██▏       | 22/100 [03:07<10:57,  8.43s/it]epoch:  23%|██▎       | 23/100 [03:15<10:43,  8.36s/it]epoch:  24%|██▍       | 24/100 [03:23<10:35,  8.37s/it]epoch:  25%|██▌       | 25/100 [03:32<10:33,  8.44s/it]epoch:  26%|██▌       | 26/100 [03:40<10:24,  8.44s/it]epoch:  27%|██▋       | 27/100 [03:49<10:14,  8.42s/it]epoch:  28%|██▊       | 28/100 [03:57<10:05,  8.40s/it]epoch:  29%|██▉       | 29/100 [04:05<09:53,  8.36s/it]epoch:  30%|███       | 30/100 [04:14<09:48,  8.41s/it]0.05617627315683381
best ic: 0.05617627315683381
epoch:  31%|███       | 31/100 [04:24<10:10,  8.84s/it]0.059774240017818885
best ic: 0.059774240017818885
epoch:  32%|███▏      | 32/100 [04:33<10:21,  9.14s/it]0.05446066401648006
epoch:  33%|███▎      | 33/100 [04:43<10:21,  9.28s/it]0.060312069217697134
best ic: 0.060312069217697134
epoch:  34%|███▍      | 34/100 [04:53<10:19,  9.38s/it]0.058714078447176674
epoch:  35%|███▌      | 35/100 [05:02<10:12,  9.42s/it]0.05467752218932698
epoch:  36%|███▌      | 36/100 [05:12<10:05,  9.47s/it]0.05594825489211503
epoch:  37%|███▋      | 37/100 [05:21<09:56,  9.47s/it]0.05555674401672128
epoch:  38%|███▊      | 38/100 [05:31<09:49,  9.51s/it]0.057435455717655334
epoch:  39%|███▉      | 39/100 [05:41<09:46,  9.62s/it]0.05328190021100949
epoch:  40%|████      | 40/100 [05:50<09:36,  9.60s/it]0.05219591963564526
epoch:  41%|████      | 41/100 [06:00<09:23,  9.55s/it]0.05228508818159796
epoch:  41%|████      | 41/100 [06:09<08:52,  9.02s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2924289:MainThread](2024-04-24 22:57:05,564) INFO - qlib.workflow - [exp.py:258] - Experiment 39 starts running ...
[2924289:MainThread](2024-04-24 22:57:05,578) INFO - qlib.workflow - [recorder.py:341] - Recorder c4674b3f845c4e4eb42fba2e32af2fd4 starts running under Experiment 39 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:04, 14.09it/s]online:   6%|▋         | 4/63 [00:00<00:04, 14.56it/s]online:  10%|▉         | 6/63 [00:00<00:03, 14.38it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 14.48it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 14.49it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 14.77it/s]online:  22%|██▏       | 14/63 [00:00<00:03, 14.61it/s]online:  25%|██▌       | 16/63 [00:01<00:03, 14.55it/s]online:  29%|██▊       | 18/63 [00:01<00:03, 14.69it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 14.75it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 14.77it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 14.75it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 14.70it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 14.89it/s]online:  48%|████▊     | 30/63 [00:02<00:02, 14.97it/s]online:  51%|█████     | 32/63 [00:02<00:02, 14.99it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 15.04it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 15.07it/s]online:  60%|██████    | 38/63 [00:02<00:01, 15.09it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 15.10it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 15.12it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 15.12it/s]online:  73%|███████▎  | 46/63 [00:03<00:01, 15.11it/s]online:  76%|███████▌  | 48/63 [00:03<00:00, 15.05it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 15.02it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 14.94it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 15.02it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 15.01it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 14.82it/s]online:  95%|█████████▌| 60/63 [00:04<00:00, 14.73it/s]online:  98%|█████████▊| 62/63 [00:04<00:00, 14.53it/s]online: 100%|██████████| 63/63 [00:04<00:00, 14.84it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2924289:MainThread](2024-04-24 22:57:16,464) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9959392 mae 0.70741093
{'IC': 0.034691525196059135,
 'ICIR': 0.22759514897953836,
 'Rank IC': 0.03569296008797579,
 'Rank ICIR': 0.23210871826249652}
[2924289:MainThread](2024-04-24 22:57:18,229) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2924289:MainThread](2024-04-24 22:57:30,875) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 22:57:30,878) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2924289:MainThread](2024-04-24 22:57:37,044) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f55fd4088e0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:49,  8.83it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 23.72it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 34.33it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:24, 39.10it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 44.97it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:19, 49.05it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:19, 48.82it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:17, 51.93it/s]backtest loop:   5%|▌         | 52/971 [00:01<00:16, 55.16it/s]backtest loop:   6%|▌         | 58/971 [00:01<00:17, 52.29it/s]backtest loop:   7%|▋         | 65/971 [00:01<00:16, 55.48it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 54.49it/s]backtest loop:   8%|▊         | 79/971 [00:01<00:15, 56.56it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:15, 58.29it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:15, 55.60it/s]backtest loop:  10%|█         | 99/971 [00:02<00:15, 57.43it/s]backtest loop:  11%|█         | 105/971 [00:02<00:14, 57.86it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 55.55it/s]backtest loop:  12%|█▏        | 118/971 [00:02<00:15, 56.71it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:14, 57.60it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:15, 54.36it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 52.27it/s]backtest loop:  15%|█▍        | 142/971 [00:02<00:15, 54.31it/s]backtest loop:  15%|█▌        | 149/971 [00:02<00:14, 56.73it/s]backtest loop:  16%|█▌        | 156/971 [00:03<00:14, 55.15it/s]backtest loop:  17%|█▋        | 162/971 [00:03<00:14, 56.14it/s]backtest loop:  17%|█▋        | 169/971 [00:03<00:13, 58.00it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:13, 58.41it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:14, 55.54it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 57.85it/s]backtest loop:  20%|█▉        | 194/971 [00:03<00:13, 58.32it/s]backtest loop:  21%|██        | 200/971 [00:03<00:13, 55.51it/s]backtest loop:  21%|██▏       | 207/971 [00:03<00:13, 57.60it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:13, 55.04it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:13, 55.93it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:14, 52.57it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:13, 53.56it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:13, 54.11it/s]backtest loop:  25%|██▌       | 243/971 [00:04<00:13, 55.26it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:13, 53.42it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:12, 56.06it/s]backtest loop:  27%|██▋       | 262/971 [00:04<00:12, 57.02it/s]backtest loop:  28%|██▊       | 268/971 [00:05<00:12, 54.67it/s]backtest loop:  28%|██▊       | 274/971 [00:05<00:12, 55.91it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:12, 54.67it/s]backtest loop:  30%|██▉       | 287/971 [00:05<00:12, 55.71it/s]backtest loop:  30%|███       | 294/971 [00:05<00:11, 57.76it/s]backtest loop:  31%|███       | 300/971 [00:05<00:12, 54.76it/s]backtest loop:  32%|███▏      | 306/971 [00:05<00:11, 56.11it/s]backtest loop:  32%|███▏      | 313/971 [00:05<00:11, 57.91it/s]backtest loop:  33%|███▎      | 320/971 [00:06<00:11, 55.89it/s]backtest loop:  34%|███▎      | 326/971 [00:06<00:11, 56.60it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:11, 57.52it/s]backtest loop:  35%|███▍      | 338/971 [00:06<00:10, 58.11it/s]backtest loop:  35%|███▌      | 344/971 [00:06<00:10, 58.14it/s]backtest loop:  36%|███▌      | 350/971 [00:06<00:11, 55.51it/s]backtest loop:  37%|███▋      | 356/971 [00:06<00:10, 56.69it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:11, 55.13it/s]backtest loop:  38%|███▊      | 369/971 [00:06<00:11, 53.41it/s]backtest loop:  39%|███▊      | 375/971 [00:06<00:10, 54.84it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:10, 55.27it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 56.43it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 54.01it/s]backtest loop:  41%|████      | 399/971 [00:07<00:10, 55.58it/s]backtest loop:  42%|████▏     | 406/971 [00:07<00:09, 57.56it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:09, 57.44it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:10, 54.32it/s]backtest loop:  44%|████▎     | 424/971 [00:08<00:16, 33.64it/s]backtest loop:  44%|████▍     | 430/971 [00:08<00:14, 38.41it/s]backtest loop:  45%|████▍     | 436/971 [00:08<00:12, 42.95it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:11, 44.50it/s]backtest loop:  46%|████▌     | 448/971 [00:08<00:10, 48.08it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:10, 50.98it/s]backtest loop:  47%|████▋     | 460/971 [00:08<00:09, 53.10it/s]backtest loop:  48%|████▊     | 466/971 [00:08<00:09, 54.67it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:09, 52.79it/s]backtest loop:  49%|████▉     | 478/971 [00:09<00:09, 54.18it/s]backtest loop:  50%|████▉     | 484/971 [00:09<00:08, 55.65it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:09, 53.30it/s]backtest loop:  51%|█████     | 496/971 [00:09<00:08, 55.10it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:08, 56.46it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:08, 54.20it/s]backtest loop:  53%|█████▎    | 515/971 [00:09<00:08, 56.63it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 57.47it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:08, 54.72it/s]backtest loop:  55%|█████▍    | 533/971 [00:10<00:07, 56.08it/s]backtest loop:  56%|█████▌    | 540/971 [00:10<00:07, 57.96it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 55.02it/s]backtest loop:  57%|█████▋    | 553/971 [00:10<00:07, 57.10it/s]backtest loop:  58%|█████▊    | 560/971 [00:10<00:07, 58.58it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 55.41it/s]backtest loop:  59%|█████▉    | 572/971 [00:10<00:07, 56.65it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:06, 57.31it/s]backtest loop:  60%|██████    | 584/971 [00:10<00:06, 57.97it/s]backtest loop:  61%|██████    | 590/971 [00:11<00:06, 58.48it/s]backtest loop:  61%|██████▏   | 596/971 [00:11<00:06, 55.26it/s]backtest loop:  62%|██████▏   | 603/971 [00:11<00:06, 57.31it/s]backtest loop:  63%|██████▎   | 609/971 [00:11<00:06, 57.82it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:06, 55.03it/s]backtest loop:  64%|██████▍   | 621/971 [00:11<00:06, 56.19it/s]backtest loop:  65%|██████▍   | 627/971 [00:11<00:06, 57.19it/s]backtest loop:  65%|██████▌   | 633/971 [00:11<00:05, 57.98it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 58.30it/s]backtest loop:  66%|██████▋   | 645/971 [00:12<00:05, 55.37it/s]backtest loop:  67%|██████▋   | 651/971 [00:12<00:05, 56.62it/s]backtest loop:  68%|██████▊   | 657/971 [00:12<00:05, 57.59it/s]backtest loop:  68%|██████▊   | 664/971 [00:12<00:05, 58.98it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 55.62it/s]backtest loop:  70%|██████▉   | 676/971 [00:12<00:05, 56.57it/s]backtest loop:  70%|███████   | 682/971 [00:12<00:05, 57.11it/s]backtest loop:  71%|███████   | 688/971 [00:12<00:04, 57.71it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:05, 54.46it/s]backtest loop:  72%|███████▏  | 700/971 [00:12<00:04, 55.99it/s]backtest loop:  73%|███████▎  | 706/971 [00:13<00:04, 57.13it/s]backtest loop:  73%|███████▎  | 712/971 [00:13<00:04, 57.29it/s]backtest loop:  74%|███████▍  | 718/971 [00:13<00:04, 57.95it/s]backtest loop:  75%|███████▍  | 724/971 [00:13<00:04, 54.56it/s]backtest loop:  75%|███████▌  | 730/971 [00:13<00:04, 55.92it/s]backtest loop:  76%|███████▌  | 736/971 [00:13<00:04, 53.80it/s]backtest loop:  76%|███████▋  | 742/971 [00:13<00:04, 55.20it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 53.10it/s]backtest loop:  78%|███████▊  | 754/971 [00:13<00:03, 54.99it/s]backtest loop:  78%|███████▊  | 760/971 [00:14<00:03, 53.06it/s]backtest loop:  79%|███████▉  | 766/971 [00:14<00:03, 54.89it/s]backtest loop:  80%|███████▉  | 772/971 [00:14<00:03, 56.31it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 58.12it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 55.51it/s]backtest loop:  82%|████████▏ | 792/971 [00:14<00:03, 57.60it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 55.09it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:02, 57.20it/s]backtest loop:  84%|████████▎ | 812/971 [00:14<00:02, 58.66it/s]backtest loop:  84%|████████▍ | 818/971 [00:15<00:02, 55.52it/s]backtest loop:  85%|████████▍ | 824/971 [00:15<00:02, 56.54it/s]backtest loop:  86%|████████▌ | 831/971 [00:15<00:02, 58.26it/s]backtest loop:  86%|████████▋ | 838/971 [00:15<00:02, 56.15it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 57.85it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 55.90it/s]backtest loop:  88%|████████▊ | 858/971 [00:15<00:01, 56.87it/s]backtest loop:  89%|████████▉ | 865/971 [00:15<00:01, 58.32it/s]backtest loop:  90%|████████▉ | 872/971 [00:16<00:01, 56.12it/s]backtest loop:  91%|█████████ | 879/971 [00:16<00:01, 57.82it/s]backtest loop:  91%|█████████ | 886/971 [00:16<00:01, 59.09it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 56.08it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 58.08it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 59.26it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 56.24it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 57.94it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 56.13it/s]backtest loop:  96%|█████████▌| 933/971 [00:17<00:00, 58.00it/s]backtest loop:  97%|█████████▋| 939/971 [00:17<00:00, 58.52it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 55.65it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 57.56it/s]backtest loop:  99%|█████████▊| 958/971 [00:17<00:00, 58.22it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 56.12it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.67it/s]
[2924289:MainThread](2024-04-24 22:57:54,881) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000802
std                0.005508
annualized_return  0.190916
information_ratio  2.246733
max_drawdown      -0.065478
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000606
std                0.005509
annualized_return  0.144153
information_ratio  1.695997
max_drawdown      -0.080109
[2924289:MainThread](2024-04-24 22:57:54,897) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 39
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_21:48:11_online`.
Round 10 Done!
{'1day.excess_return_with_cost.annualized_return': [0.12386974698091249,
                                                    0.1198726782033047,
                                                    0.08568619333630892,
                                                    0.11924882547054218,
                                                    0.07434750552095895,
                                                    0.1327441967693429,
                                                    0.08402333431837816,
                                                    0.1408819888005938,
                                                    0.10106062935808849,
                                                    0.1441526186037439],
 '1day.excess_return_with_cost.information_ratio': [1.414046816672812,
                                                    1.428098235977815,
                                                    1.0011945847928823,
                                                    1.4209694086345042,
                                                    0.9007592657254062,
                                                    1.5650619642691728,
                                                    0.9921947062675395,
                                                    1.7312633217135882,
                                                    1.1387089117482565,
                                                    1.6959973199148548],
 '1day.excess_return_with_cost.max_drawdown': [-0.08039447825046309,
                                               -0.0724795167180563,
                                               -0.16373344369967016,
                                               -0.0596780068312569,
                                               -0.11080742895235432,
                                               -0.07529115587639507,
                                               -0.07925196527005693,
                                               -0.07433135212832731,
                                               -0.05795673047519162,
                                               -0.08010936361792143],
 'IC': [0.03247239452907499,
        0.034917389108111305,
        0.02964435031889077,
        0.0355889467556545,
        0.029887754919344072,
        0.03243817179133714,
        0.031934093208508825,
        0.03359107128026256,
        0.03163532889365818,
        0.034691525196059135],
 'ICIR': [0.22552705133383394,
          0.24081672568443255,
          0.20714330233910136,
          0.252880714547846,
          0.2115851609448364,
          0.23325480456403733,
          0.22850081818571194,
          0.23819796657702028,
          0.22573230078117004,
          0.22759514897953836],
 'Rank IC': [0.031136367658080418,
             0.03398929167284011,
             0.0262953640059444,
             0.0335393501370497,
             0.029115694342890748,
             0.03294090283830007,
             0.03201431708725469,
             0.033753986531726114,
             0.030937372483053616,
             0.03569296008797579],
 'Rank ICIR': [0.21727391618606592,
               0.23611117650462315,
               0.18299316660535125,
               0.23971972679218712,
               0.20831071518991923,
               0.2375896291821766,
               0.22617349904452566,
               0.24671488678111922,
               0.21926036684408667,
               0.23210871826249652],
 'mae': [0.7075666189193726,
         0.707162618637085,
         0.7076587677001953,
         0.7074336409568787,
         0.7076197266578674,
         0.7077104449272156,
         0.7073090076446533,
         0.7072972059249878,
         0.707523763179779,
         0.7074109315872192],
 'mse': [0.9962677359580994,
         0.9957350492477417,
         0.9965179562568665,
         0.99587082862854,
         0.9965298771858215,
         0.9964921474456787,
         0.996100664138794,
         0.9960360527038574,
         0.9962528944015503,
         0.9959391951560974]}
[2924289:MainThread](2024-04-24 22:57:56,104) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name csi300_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_21:48:11_final.
[2924289:MainThread](2024-04-24 22:57:56,162) INFO - qlib.workflow - [exp.py:258] - Experiment 41 starts running ...
[2924289:MainThread](2024-04-24 22:57:56,176) INFO - qlib.workflow - [recorder.py:341] - Recorder 1c2b7136fb4445368be1b80d3d7791bd starts running under Experiment 41 ...
Time cost: 365.93777265548704	52.54091453552246
Final results:
{'1day.excess_return_with_cost.annualized_return': [0.11258877173621744,
                                                    0.023585421723394537],
 '1day.excess_return_with_cost.information_ratio': [1.3288294535716834,
                                                    0.28604800075242337],
 '1day.excess_return_with_cost.max_drawdown': [-0.08540334418196929,
                                               0.029459984227051785],
 'IC': [0.03268010260009015, 0.001926272638753589],
 'ICIR': [0.22912339939375284, 0.012721757274827793],
 'Rank IC': [0.031941560684511566, 0.002581274564496656],
 'Rank ICIR': [0.2246255801392551, 0.01776630176266033],
 'mae': [0.7074692726135254, 0.0001682724500382531],
 'mse': [0.9961742401123047, 0.0002693165457725098]}
Your final results can be found in the experiment named `csi300_ALSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_21:48:11_final`.
All Done!
[2924289:MainThread](2024-04-24 22:57:57,154) INFO - qlib.timer - [log.py:127] - Time cost: 0.033s | waiting `async_log` Done

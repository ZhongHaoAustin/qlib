['main.py', 'run_all', '--forecast_model', 'Localformer', '-num_head', '8', '--train_start=2008-01-01', '--train_end=2018-12-31', '--valid_start=2019-01-01', '--valid_end=2020-03-31', '--test_start=2020-04-01', '--test_end=2024-03-31', '--tau', '10', '--lr_da', '0.01', '--market', 'csi300', '--data_dir', 'crowd_data', '--rank_label', 'False', '--begin_valid_epoch', '30']
[3553693:MainThread](2024-04-26 03:34:12,955) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[3553693:MainThread](2024-04-26 03:34:12,958) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[3553693:MainThread](2024-04-26 03:34:12,958) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/crowd_data')}
Remove CSRankNorm
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LocalformerModel', 'module_path': 'qlib.contrib.model.pytorch_localformer', 'kwargs': {'d_feat': 6, 'seed': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
[3553693:MainThread](2024-04-26 03:34:19,177) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'LocalformerModel', 'module_path': 'qlib.contrib.model.pytorch_localformer', 'kwargs': {'d_feat': 6, 'seed': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-02 00:00:00'), Timestamp('2008-01-29 00:00:00')), 'test': (Timestamp('2008-01-31 00:00:00'), Timestamp('2008-03-05 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/147 [00:00<?, ?it/s]creating meta tasks:  26%|██▌       | 38/147 [00:00<00:00, 375.59it/s]creating meta tasks:  54%|█████▍    | 80/147 [00:00<00:00, 398.33it/s]creating meta tasks:  83%|████████▎ | 122/147 [00:00<00:00, 405.17it/s]creating meta tasks: 100%|██████████| 147/147 [00:00<00:00, 403.76it/s]
[3553693:MainThread](2024-04-26 03:34:19,815) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'LocalformerModel', 'module_path': 'qlib.contrib.model.pytorch_localformer', 'kwargs': {'d_feat': 6, 'seed': None}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2019-01-02 00:00:00'), Timestamp('2019-01-29 00:00:00')), 'test': (Timestamp('2019-01-31 00:00:00'), Timestamp('2019-03-06 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/63 [00:00<?, ?it/s]creating meta tasks:  67%|██████▋   | 42/63 [00:00<00:00, 413.14it/s]creating meta tasks: 100%|██████████| 63/63 [00:00<00:00, 408.03it/s]
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3553693:MainThread](2024-04-26 03:34:20,625) INFO - qlib.TransformerModel - [pytorch_localformer.py:64] - Naive Transformer:
batch_size : 2048
device : cuda:0
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:56<1:33:25, 56.63s/it]epoch:   2%|▏         | 2/100 [01:50<1:29:50, 55.00s/it]epoch:   3%|▎         | 3/100 [02:44<1:28:00, 54.44s/it]epoch:   4%|▍         | 4/100 [03:37<1:26:30, 54.06s/it]epoch:   5%|▌         | 5/100 [04:30<1:25:06, 53.75s/it]epoch:   6%|▌         | 6/100 [05:24<1:23:57, 53.59s/it]epoch:   7%|▋         | 7/100 [06:17<1:22:47, 53.41s/it]epoch:   8%|▊         | 8/100 [07:10<1:21:45, 53.32s/it]epoch:   9%|▉         | 9/100 [08:03<1:20:57, 53.38s/it]epoch:  10%|█         | 10/100 [08:57<1:19:56, 53.30s/it]epoch:  11%|█         | 11/100 [09:50<1:19:01, 53.27s/it]epoch:  12%|█▏        | 12/100 [10:43<1:18:01, 53.20s/it]epoch:  13%|█▎        | 13/100 [11:36<1:17:05, 53.17s/it]epoch:  14%|█▍        | 14/100 [12:29<1:16:07, 53.11s/it]epoch:  15%|█▌        | 15/100 [13:22<1:15:17, 53.15s/it]epoch:  16%|█▌        | 16/100 [14:15<1:14:17, 53.06s/it]epoch:  17%|█▋        | 17/100 [15:08<1:13:21, 53.04s/it]epoch:  18%|█▊        | 18/100 [16:01<1:12:25, 52.99s/it]epoch:  19%|█▉        | 19/100 [16:54<1:11:27, 52.93s/it]epoch:  20%|██        | 20/100 [17:46<1:10:28, 52.86s/it]epoch:  21%|██        | 21/100 [18:39<1:09:35, 52.85s/it]epoch:  22%|██▏       | 22/100 [19:32<1:08:48, 52.93s/it]epoch:  23%|██▎       | 23/100 [20:25<1:07:55, 52.93s/it]epoch:  24%|██▍       | 24/100 [21:18<1:07:05, 52.96s/it]epoch:  25%|██▌       | 25/100 [22:11<1:06:14, 52.99s/it]epoch:  26%|██▌       | 26/100 [23:05<1:05:27, 53.08s/it]epoch:  27%|██▋       | 27/100 [23:58<1:04:34, 53.08s/it]epoch:  28%|██▊       | 28/100 [24:50<1:03:36, 53.01s/it]epoch:  29%|██▉       | 29/100 [25:43<1:02:40, 52.96s/it]epoch:  30%|███       | 30/100 [26:36<1:01:46, 52.96s/it]0.04965600193898659
best ic: 0.04965600193898659
epoch:  31%|███       | 31/100 [27:36<1:03:17, 55.04s/it]0.04063272641388936
epoch:  32%|███▏      | 32/100 [28:35<1:03:45, 56.26s/it]0.051654567694871326
best ic: 0.051654567694871326
epoch:  33%|███▎      | 33/100 [29:35<1:03:50, 57.16s/it]0.04860803003575327
epoch:  34%|███▍      | 34/100 [30:34<1:03:36, 57.82s/it]0.049510578273341335
epoch:  35%|███▌      | 35/100 [31:33<1:03:09, 58.30s/it]0.04764603327075859
epoch:  36%|███▌      | 36/100 [32:33<1:02:28, 58.57s/it]0.054038846199254184
best ic: 0.054038846199254184
epoch:  37%|███▋      | 37/100 [33:32<1:01:42, 58.77s/it]0.05511594038831788
best ic: 0.05511594038831788
epoch:  38%|███▊      | 38/100 [34:31<1:00:52, 58.91s/it]0.05196085102110426
epoch:  39%|███▉      | 39/100 [35:30<59:58, 58.99s/it]  0.05299094231817663
epoch:  40%|████      | 40/100 [36:29<59:04, 59.07s/it]0.049844362229132966
epoch:  41%|████      | 41/100 [37:28<58:03, 59.03s/it]0.05004613238292235
epoch:  42%|████▏     | 42/100 [38:27<57:04, 59.05s/it]0.043481205122263354
epoch:  43%|████▎     | 43/100 [39:27<56:08, 59.10s/it]0.04732780742531756
epoch:  44%|████▍     | 44/100 [40:26<55:10, 59.11s/it]0.05146636407684338
epoch:  45%|████▌     | 45/100 [41:25<54:14, 59.18s/it]0.05152568698791895
epoch:  45%|████▌     | 45/100 [42:24<51:50, 56.55s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3553693:MainThread](2024-04-26 04:16:48,326) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name csi300_Localformer_alpha360_horizon1_step20_rankFalse_2024-04-26_03:34:20_online.
[3553693:MainThread](2024-04-26 04:16:48,369) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3553693:MainThread](2024-04-26 04:16:49,185) INFO - qlib.workflow - [recorder.py:341] - Recorder 35e312b715fc481bacde8e2a3cd8b112 starts running under Experiment 53 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:19,  3.14it/s]online:   3%|▎         | 2/63 [00:00<00:22,  2.69it/s]online:   5%|▍         | 3/63 [00:01<00:23,  2.56it/s]online:   6%|▋         | 4/63 [00:01<00:23,  2.52it/s]online:   8%|▊         | 5/63 [00:01<00:23,  2.49it/s]online:  10%|▉         | 6/63 [00:02<00:23,  2.47it/s]online:  11%|█         | 7/63 [00:02<00:22,  2.46it/s]online:  13%|█▎        | 8/63 [00:03<00:22,  2.45it/s]online:  14%|█▍        | 9/63 [00:03<00:22,  2.44it/s]online:  16%|█▌        | 10/63 [00:04<00:21,  2.43it/s]online:  17%|█▋        | 11/63 [00:04<00:21,  2.45it/s]online:  19%|█▉        | 12/63 [00:04<00:20,  2.44it/s]online:  21%|██        | 13/63 [00:05<00:20,  2.44it/s]online:  22%|██▏       | 14/63 [00:05<00:20,  2.44it/s]online:  24%|██▍       | 15/63 [00:06<00:19,  2.44it/s]online:  25%|██▌       | 16/63 [00:06<00:19,  2.44it/s]online:  27%|██▋       | 17/63 [00:06<00:18,  2.44it/s]online:  29%|██▊       | 18/63 [00:07<00:18,  2.44it/s]online:  30%|███       | 19/63 [00:07<00:18,  2.44it/s]online:  32%|███▏      | 20/63 [00:08<00:17,  2.44it/s]online:  33%|███▎      | 21/63 [00:08<00:17,  2.43it/s]online:  35%|███▍      | 22/63 [00:09<00:18,  2.24it/s]online:  37%|███▋      | 23/63 [00:09<00:17,  2.29it/s]online:  38%|███▊      | 24/63 [00:09<00:16,  2.33it/s]online:  40%|███▉      | 25/63 [00:10<00:16,  2.36it/s]online:  41%|████▏     | 26/63 [00:10<00:15,  2.38it/s]online:  43%|████▎     | 27/63 [00:11<00:15,  2.40it/s]online:  44%|████▍     | 28/63 [00:11<00:14,  2.41it/s]online:  46%|████▌     | 29/63 [00:11<00:14,  2.41it/s]online:  48%|████▊     | 30/63 [00:12<00:13,  2.42it/s]online:  49%|████▉     | 31/63 [00:12<00:13,  2.43it/s]online:  51%|█████     | 32/63 [00:13<00:12,  2.43it/s]online:  52%|█████▏    | 33/63 [00:13<00:12,  2.43it/s]online:  54%|█████▍    | 34/63 [00:13<00:11,  2.43it/s]online:  56%|█████▌    | 35/63 [00:14<00:11,  2.43it/s]online:  57%|█████▋    | 36/63 [00:14<00:11,  2.43it/s]online:  59%|█████▊    | 37/63 [00:15<00:10,  2.43it/s]online:  60%|██████    | 38/63 [00:15<00:10,  2.43it/s]online:  62%|██████▏   | 39/63 [00:16<00:09,  2.43it/s]online:  63%|██████▎   | 40/63 [00:16<00:09,  2.43it/s]online:  65%|██████▌   | 41/63 [00:16<00:09,  2.43it/s]online:  67%|██████▋   | 42/63 [00:17<00:08,  2.43it/s]online:  68%|██████▊   | 43/63 [00:17<00:08,  2.43it/s]online:  70%|██████▉   | 44/63 [00:18<00:07,  2.43it/s]online:  71%|███████▏  | 45/63 [00:18<00:07,  2.43it/s]online:  73%|███████▎  | 46/63 [00:18<00:07,  2.42it/s]online:  75%|███████▍  | 47/63 [00:19<00:06,  2.43it/s]online:  76%|███████▌  | 48/63 [00:19<00:06,  2.43it/s]online:  78%|███████▊  | 49/63 [00:20<00:05,  2.41it/s]online:  79%|███████▉  | 50/63 [00:20<00:05,  2.41it/s]online:  81%|████████  | 51/63 [00:21<00:04,  2.41it/s]online:  83%|████████▎ | 52/63 [00:21<00:04,  2.41it/s]online:  84%|████████▍ | 53/63 [00:21<00:04,  2.41it/s]online:  86%|████████▌ | 54/63 [00:22<00:03,  2.41it/s]online:  87%|████████▋ | 55/63 [00:22<00:03,  2.41it/s]online:  89%|████████▉ | 56/63 [00:23<00:02,  2.41it/s]online:  90%|█████████ | 57/63 [00:23<00:02,  2.41it/s]online:  92%|█████████▏| 58/63 [00:23<00:02,  2.40it/s]online:  94%|█████████▎| 59/63 [00:24<00:01,  2.41it/s]online:  95%|█████████▌| 60/63 [00:24<00:01,  2.41it/s]online:  97%|█████████▋| 61/63 [00:25<00:00,  2.40it/s]online:  98%|█████████▊| 62/63 [00:25<00:00,  2.41it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.51it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.43it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3553693:MainThread](2024-04-26 04:17:22,248) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9960589 mae 0.7075116
{'IC': 0.023486286189309008,
 'ICIR': 0.17230008880149675,
 'Rank IC': 0.01784804193762672,
 'Rank ICIR': 0.12653690606414603}
[3553693:MainThread](2024-04-26 04:17:23,941) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3553693:MainThread](2024-04-26 04:17:33,981) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 04:17:33,984) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 04:17:40,141) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fd640d25ac0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 6/971 [00:00<00:16, 58.56it/s]backtest loop:   1%|          | 12/971 [00:00<00:18, 52.62it/s]backtest loop:   2%|▏         | 19/971 [00:00<00:16, 57.07it/s]backtest loop:   3%|▎         | 25/971 [00:00<00:17, 53.76it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:16, 55.52it/s]backtest loop:   4%|▍         | 38/971 [00:00<00:16, 57.82it/s]backtest loop:   5%|▍         | 44/971 [00:00<00:16, 54.97it/s]backtest loop:   5%|▌         | 51/971 [00:00<00:16, 57.40it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:16, 54.67it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:16, 56.12it/s]backtest loop:   7%|▋         | 70/971 [00:01<00:15, 58.18it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:15, 56.22it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 58.08it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 59.21it/s]backtest loop:  10%|▉         | 97/971 [00:01<00:15, 56.28it/s]backtest loop:  11%|█         | 103/971 [00:01<00:21, 39.65it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:19, 44.93it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:18, 46.97it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 49.97it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:16, 49.94it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:16, 52.24it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:16, 51.30it/s]backtest loop:  15%|█▌        | 147/971 [00:02<00:15, 53.37it/s]backtest loop:  16%|█▌        | 154/971 [00:02<00:14, 56.00it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 54.72it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:14, 56.86it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:13, 58.58it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:14, 55.70it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 57.56it/s]backtest loop:  20%|█▉        | 194/971 [00:03<00:13, 58.21it/s]backtest loop:  21%|██        | 200/971 [00:03<00:13, 55.28it/s]backtest loop:  21%|██        | 206/971 [00:03<00:13, 56.42it/s]backtest loop:  22%|██▏       | 213/971 [00:03<00:13, 55.41it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 54.45it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:13, 56.92it/s]backtest loop:  24%|██▍       | 234/971 [00:04<00:12, 58.54it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:13, 55.72it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:12, 57.47it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:12, 55.85it/s]backtest loop:  27%|██▋       | 261/971 [00:04<00:12, 57.66it/s]backtest loop:  27%|██▋       | 267/971 [00:04<00:12, 55.41it/s]backtest loop:  28%|██▊       | 273/971 [00:04<00:12, 56.57it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:11, 58.43it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 55.47it/s]backtest loop:  30%|███       | 293/971 [00:05<00:11, 57.58it/s]backtest loop:  31%|███       | 300/971 [00:05<00:12, 55.90it/s]backtest loop:  32%|███▏      | 307/971 [00:05<00:11, 57.78it/s]backtest loop:  32%|███▏      | 313/971 [00:05<00:11, 58.22it/s]backtest loop:  33%|███▎      | 320/971 [00:05<00:11, 56.11it/s]backtest loop:  34%|███▎      | 327/971 [00:05<00:11, 58.04it/s]backtest loop:  34%|███▍      | 334/971 [00:06<00:10, 59.31it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:11, 55.81it/s]backtest loop:  36%|███▌      | 346/971 [00:06<00:11, 56.80it/s]backtest loop:  36%|███▋      | 353/971 [00:06<00:10, 58.40it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 56.47it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 54.98it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 53.57it/s]backtest loop:  39%|███▉      | 379/971 [00:06<00:10, 55.22it/s]backtest loop:  40%|███▉      | 386/971 [00:06<00:10, 57.23it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 55.62it/s]backtest loop:  41%|████      | 400/971 [00:07<00:09, 57.66it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 59.02it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:10, 55.68it/s]backtest loop:  43%|████▎     | 419/971 [00:07<00:09, 56.77it/s]backtest loop:  44%|████▍     | 426/971 [00:07<00:09, 58.40it/s]backtest loop:  44%|████▍     | 432/971 [00:07<00:09, 55.53it/s]backtest loop:  45%|████▌     | 439/971 [00:07<00:09, 57.54it/s]backtest loop:  46%|████▌     | 445/971 [00:08<00:09, 58.00it/s]backtest loop:  47%|████▋     | 452/971 [00:08<00:09, 56.16it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:08, 57.97it/s]backtest loop:  48%|████▊     | 466/971 [00:08<00:08, 59.36it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:08, 56.35it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 58.35it/s]backtest loop:  50%|█████     | 486/971 [00:08<00:08, 59.64it/s]backtest loop:  51%|█████     | 492/971 [00:08<00:08, 56.45it/s]backtest loop:  51%|█████▏    | 499/971 [00:08<00:08, 58.23it/s]backtest loop:  52%|█████▏    | 505/971 [00:09<00:08, 55.72it/s]backtest loop:  53%|█████▎    | 512/971 [00:09<00:08, 54.53it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:07, 56.83it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 55.52it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:07, 57.67it/s]backtest loop:  56%|█████▌    | 540/971 [00:09<00:07, 59.19it/s]backtest loop:  56%|█████▌    | 546/971 [00:09<00:07, 56.08it/s]backtest loop:  57%|█████▋    | 553/971 [00:09<00:07, 58.02it/s]backtest loop:  58%|█████▊    | 560/971 [00:10<00:06, 59.45it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 56.36it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:06, 58.23it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 59.47it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:06, 56.35it/s]backtest loop:  61%|██████    | 593/971 [00:10<00:06, 58.14it/s]backtest loop:  62%|██████▏   | 600/971 [00:10<00:06, 56.21it/s]backtest loop:  63%|██████▎   | 607/971 [00:10<00:06, 57.98it/s]backtest loop:  63%|██████▎   | 614/971 [00:10<00:06, 59.33it/s]backtest loop:  64%|██████▍   | 620/971 [00:11<00:06, 56.20it/s]backtest loop:  65%|██████▍   | 627/971 [00:11<00:05, 58.07it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:05, 59.43it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:05, 56.50it/s]backtest loop:  67%|██████▋   | 647/971 [00:11<00:05, 58.29it/s]backtest loop:  67%|██████▋   | 654/971 [00:11<00:05, 59.60it/s]backtest loop:  68%|██████▊   | 660/971 [00:11<00:05, 56.44it/s]backtest loop:  69%|██████▊   | 667/971 [00:11<00:05, 58.16it/s]backtest loop:  69%|██████▉   | 674/971 [00:11<00:05, 56.10it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:05, 57.91it/s]backtest loop:  71%|███████   | 687/971 [00:12<00:04, 58.37it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:04, 56.28it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 58.10it/s]backtest loop:  73%|███████▎  | 708/971 [00:12<00:04, 59.35it/s]backtest loop:  74%|███████▎  | 714/971 [00:12<00:04, 56.35it/s]backtest loop:  74%|███████▍  | 721/971 [00:12<00:04, 58.13it/s]backtest loop:  75%|███████▍  | 728/971 [00:12<00:04, 59.69it/s]backtest loop:  76%|███████▌  | 734/971 [00:13<00:04, 53.77it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 56.21it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.97it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 53.82it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 56.27it/s]backtest loop:  79%|███████▉  | 769/971 [00:13<00:03, 57.95it/s]backtest loop:  80%|███████▉  | 775/971 [00:13<00:03, 55.56it/s]backtest loop:  81%|████████  | 782/971 [00:13<00:03, 57.56it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 55.14it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.45it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 58.92it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 55.91it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 57.78it/s]backtest loop:  85%|████████▍ | 822/971 [00:14<00:02, 59.14it/s]backtest loop:  85%|████████▌ | 828/971 [00:14<00:02, 56.02it/s]backtest loop:  86%|████████▌ | 835/971 [00:14<00:02, 57.85it/s]backtest loop:  87%|████████▋ | 842/971 [00:14<00:02, 59.22it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 56.18it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:01, 58.00it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 55.96it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 57.84it/s]backtest loop:  90%|█████████ | 876/971 [00:15<00:01, 59.17it/s]backtest loop:  91%|█████████ | 882/971 [00:15<00:01, 56.18it/s]backtest loop:  92%|█████████▏| 889/971 [00:15<00:01, 57.94it/s]backtest loop:  92%|█████████▏| 895/971 [00:15<00:01, 58.36it/s]backtest loop:  93%|█████████▎| 902/971 [00:15<00:01, 56.32it/s]backtest loop:  94%|█████████▎| 909/971 [00:16<00:01, 58.05it/s]backtest loop:  94%|█████████▍| 916/971 [00:16<00:00, 55.91it/s]backtest loop:  95%|█████████▌| 923/971 [00:16<00:00, 57.69it/s]backtest loop:  96%|█████████▌| 930/971 [00:16<00:00, 59.08it/s]backtest loop:  96%|█████████▋| 936/971 [00:16<00:00, 56.12it/s]backtest loop:  97%|█████████▋| 943/971 [00:16<00:00, 57.85it/s]backtest loop:  98%|█████████▊| 950/971 [00:16<00:00, 56.00it/s]backtest loop:  99%|█████████▊| 957/971 [00:16<00:00, 57.80it/s]backtest loop:  99%|█████████▉| 963/971 [00:17<00:00, 58.19it/s]backtest loop: 100%|█████████▉| 970/971 [00:17<00:00, 56.10it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 56.49it/s]
[3553693:MainThread](2024-04-26 04:17:57,399) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000495
std                0.006030
annualized_return  0.117720
information_ratio  1.265469
max_drawdown      -0.116710
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000297
std                0.006031
annualized_return  0.070757
information_ratio  0.760500
max_drawdown      -0.143291
[3553693:MainThread](2024-04-26 04:17:57,416) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_Localformer_alpha360_horizon1_step20_rankFalse_2024-04-26_03:34:20_online`.
Round 1 Done!
{'1day.excess_return_with_cost.annualized_return': [0.07075714264527615],
 '1day.excess_return_with_cost.information_ratio': [0.7604996387958325],
 '1day.excess_return_with_cost.max_drawdown': [-0.14329134900291735],
 'IC': [0.023486286189309008],
 'ICIR': [0.17230008880149675],
 'Rank IC': [0.01784804193762672],
 'Rank ICIR': [0.12653690606414603],
 'mae': [0.7075116038322449],
 'mse': [0.9960588812828064]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3553693:MainThread](2024-04-26 04:17:58,548) INFO - qlib.TransformerModel - [pytorch_localformer.py:64] - Naive Transformer:
batch_size : 2048
device : cuda:0
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:53<1:27:27, 53.01s/it]epoch:   2%|▏         | 2/100 [01:46<1:26:48, 53.15s/it]epoch:   3%|▎         | 3/100 [02:39<1:25:59, 53.19s/it]epoch:   4%|▍         | 4/100 [03:32<1:25:06, 53.19s/it]epoch:   5%|▌         | 5/100 [04:26<1:24:19, 53.26s/it]epoch:   6%|▌         | 6/100 [05:18<1:23:15, 53.14s/it]epoch:   7%|▋         | 7/100 [06:12<1:22:23, 53.15s/it]epoch:   8%|▊         | 8/100 [07:05<1:21:43, 53.30s/it]epoch:   9%|▉         | 9/100 [07:58<1:20:43, 53.23s/it]epoch:  10%|█         | 10/100 [08:52<1:19:51, 53.24s/it]epoch:  11%|█         | 11/100 [09:45<1:18:55, 53.21s/it]epoch:  12%|█▏        | 12/100 [10:38<1:18:00, 53.19s/it]epoch:  13%|█▎        | 13/100 [11:31<1:17:12, 53.25s/it]epoch:  14%|█▍        | 14/100 [12:25<1:16:20, 53.27s/it]epoch:  15%|█▌        | 15/100 [13:18<1:15:27, 53.26s/it]epoch:  16%|█▌        | 16/100 [14:11<1:14:33, 53.25s/it]epoch:  17%|█▋        | 17/100 [15:04<1:13:30, 53.14s/it]epoch:  18%|█▊        | 18/100 [15:57<1:12:35, 53.12s/it]epoch:  19%|█▉        | 19/100 [16:50<1:11:46, 53.17s/it]epoch:  20%|██        | 20/100 [17:44<1:10:56, 53.21s/it]epoch:  21%|██        | 21/100 [18:37<1:10:02, 53.20s/it]epoch:  22%|██▏       | 22/100 [19:30<1:09:08, 53.19s/it]epoch:  23%|██▎       | 23/100 [20:23<1:08:16, 53.20s/it]epoch:  24%|██▍       | 24/100 [21:16<1:07:19, 53.15s/it]epoch:  25%|██▌       | 25/100 [22:09<1:06:27, 53.17s/it]epoch:  26%|██▌       | 26/100 [23:02<1:05:32, 53.14s/it]epoch:  27%|██▋       | 27/100 [23:56<1:04:48, 53.27s/it]epoch:  28%|██▊       | 28/100 [24:49<1:03:54, 53.25s/it]epoch:  29%|██▉       | 29/100 [25:42<1:02:56, 53.19s/it]epoch:  30%|███       | 30/100 [26:35<1:02:00, 53.15s/it]0.05170553479783408
best ic: 0.05170553479783408
epoch:  31%|███       | 31/100 [27:35<1:03:18, 55.06s/it]0.053002577064075
best ic: 0.053002577064075
epoch:  32%|███▏      | 32/100 [28:35<1:03:57, 56.44s/it]0.05094756888581943
epoch:  33%|███▎      | 33/100 [29:34<1:04:09, 57.46s/it]0.054479486415817485
best ic: 0.054479486415817485
epoch:  34%|███▍      | 34/100 [30:34<1:03:49, 58.03s/it]0.05606827824501559
best ic: 0.05606827824501559
epoch:  35%|███▌      | 35/100 [31:33<1:03:20, 58.47s/it]0.04749200985812741
epoch:  36%|███▌      | 36/100 [32:33<1:02:44, 58.82s/it]0.045075001418736375
epoch:  37%|███▋      | 37/100 [33:32<1:02:00, 59.05s/it]0.047298896614241394
epoch:  38%|███▊      | 38/100 [34:32<1:01:06, 59.13s/it]0.04776168090778702
epoch:  39%|███▉      | 39/100 [35:31<1:00:17, 59.30s/it]0.04216227536859344
epoch:  40%|████      | 40/100 [36:31<59:20, 59.34s/it]  0.051279817244483696
epoch:  41%|████      | 41/100 [37:30<58:22, 59.36s/it]0.04556187830183936
epoch:  42%|████▏     | 42/100 [38:30<57:27, 59.44s/it]0.049300457893745625
epoch:  42%|████▏     | 42/100 [39:29<54:32, 56.42s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3553693:MainThread](2024-04-26 04:57:28,245) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3553693:MainThread](2024-04-26 04:57:28,259) INFO - qlib.workflow - [recorder.py:341] - Recorder fbff90e96468432784bd95fa5daed5de starts running under Experiment 53 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:20,  2.99it/s]online:   3%|▎         | 2/63 [00:00<00:23,  2.65it/s]online:   5%|▍         | 3/63 [00:01<00:23,  2.54it/s]online:   6%|▋         | 4/63 [00:01<00:23,  2.48it/s]online:   8%|▊         | 5/63 [00:01<00:23,  2.46it/s]online:  10%|▉         | 6/63 [00:02<00:23,  2.44it/s]online:  11%|█         | 7/63 [00:02<00:22,  2.44it/s]online:  13%|█▎        | 8/63 [00:03<00:22,  2.43it/s]online:  14%|█▍        | 9/63 [00:03<00:22,  2.43it/s]online:  16%|█▌        | 10/63 [00:04<00:21,  2.43it/s]online:  17%|█▋        | 11/63 [00:04<00:21,  2.44it/s]online:  19%|█▉        | 12/63 [00:04<00:21,  2.43it/s]online:  21%|██        | 13/63 [00:05<00:20,  2.43it/s]online:  22%|██▏       | 14/63 [00:05<00:20,  2.42it/s]online:  24%|██▍       | 15/63 [00:06<00:19,  2.43it/s]online:  25%|██▌       | 16/63 [00:06<00:19,  2.44it/s]online:  27%|██▋       | 17/63 [00:06<00:18,  2.43it/s]online:  29%|██▊       | 18/63 [00:07<00:18,  2.43it/s]online:  30%|███       | 19/63 [00:07<00:18,  2.43it/s]online:  32%|███▏      | 20/63 [00:08<00:17,  2.42it/s]online:  33%|███▎      | 21/63 [00:08<00:17,  2.43it/s]online:  35%|███▍      | 22/63 [00:08<00:16,  2.42it/s]online:  37%|███▋      | 23/63 [00:09<00:16,  2.42it/s]online:  38%|███▊      | 24/63 [00:09<00:16,  2.43it/s]online:  40%|███▉      | 25/63 [00:10<00:15,  2.42it/s]online:  41%|████▏     | 26/63 [00:10<00:15,  2.43it/s]online:  43%|████▎     | 27/63 [00:11<00:14,  2.42it/s]online:  44%|████▍     | 28/63 [00:11<00:14,  2.43it/s]online:  46%|████▌     | 29/63 [00:11<00:14,  2.43it/s]online:  48%|████▊     | 30/63 [00:12<00:13,  2.43it/s]online:  49%|████▉     | 31/63 [00:12<00:13,  2.42it/s]online:  51%|█████     | 32/63 [00:13<00:12,  2.42it/s]online:  52%|█████▏    | 33/63 [00:13<00:12,  2.44it/s]online:  54%|█████▍    | 34/63 [00:13<00:11,  2.42it/s]online:  56%|█████▌    | 35/63 [00:14<00:11,  2.43it/s]online:  57%|█████▋    | 36/63 [00:14<00:11,  2.43it/s]online:  59%|█████▊    | 37/63 [00:15<00:10,  2.43it/s]online:  60%|██████    | 38/63 [00:15<00:10,  2.42it/s]online:  62%|██████▏   | 39/63 [00:15<00:09,  2.43it/s]online:  63%|██████▎   | 40/63 [00:16<00:09,  2.44it/s]online:  65%|██████▌   | 41/63 [00:16<00:09,  2.43it/s]online:  67%|██████▋   | 42/63 [00:17<00:08,  2.42it/s]online:  68%|██████▊   | 43/63 [00:17<00:08,  2.43it/s]online:  70%|██████▉   | 44/63 [00:18<00:07,  2.43it/s]online:  71%|███████▏  | 45/63 [00:18<00:07,  2.42it/s]online:  73%|███████▎  | 46/63 [00:18<00:06,  2.44it/s]online:  75%|███████▍  | 47/63 [00:19<00:06,  2.43it/s]online:  76%|███████▌  | 48/63 [00:19<00:06,  2.43it/s]online:  78%|███████▊  | 49/63 [00:20<00:05,  2.43it/s]online:  79%|███████▉  | 50/63 [00:20<00:05,  2.43it/s]online:  81%|████████  | 51/63 [00:20<00:04,  2.44it/s]online:  83%|████████▎ | 52/63 [00:21<00:04,  2.42it/s]online:  84%|████████▍ | 53/63 [00:21<00:04,  2.43it/s]online:  86%|████████▌ | 54/63 [00:22<00:03,  2.43it/s]online:  87%|████████▋ | 55/63 [00:22<00:03,  2.41it/s]online:  89%|████████▉ | 56/63 [00:23<00:02,  2.43it/s]online:  90%|█████████ | 57/63 [00:23<00:02,  2.43it/s]online:  92%|█████████▏| 58/63 [00:23<00:02,  2.43it/s]online:  94%|█████████▎| 59/63 [00:24<00:01,  2.43it/s]online:  95%|█████████▌| 60/63 [00:24<00:01,  2.43it/s]online:  97%|█████████▋| 61/63 [00:25<00:00,  2.42it/s]online:  98%|█████████▊| 62/63 [00:25<00:00,  2.42it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.52it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.44it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3553693:MainThread](2024-04-26 04:58:02,126) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9957896 mae 0.70740515
{'IC': 0.02791365222447451,
 'ICIR': 0.19858094896927955,
 'Rank IC': 0.025047469820677314,
 'Rank ICIR': 0.1780858675400394}
[3553693:MainThread](2024-04-26 04:58:03,869) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3553693:MainThread](2024-04-26 04:58:14,327) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 04:58:14,330) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 04:58:20,375) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fd64a6d8ee0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:38,  9.83it/s]backtest loop:   1%|          | 9/971 [00:00<00:37, 25.71it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:26, 36.28it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.95it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 46.32it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:18, 50.21it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:18, 49.82it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:17, 52.57it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:16, 54.67it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 52.36it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:16, 54.05it/s]backtest loop:   7%|▋         | 70/971 [00:01<00:15, 56.72it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:16, 55.39it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 57.52it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 58.85it/s]backtest loop:  10%|▉         | 97/971 [00:01<00:15, 55.65it/s]backtest loop:  11%|█         | 103/971 [00:02<00:15, 56.55it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:14, 58.25it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:15, 56.07it/s]backtest loop:  13%|█▎        | 124/971 [00:02<00:14, 57.85it/s]backtest loop:  13%|█▎        | 130/971 [00:02<00:15, 54.97it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 53.16it/s]backtest loop:  15%|█▍        | 142/971 [00:02<00:15, 54.94it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 56.32it/s]backtest loop:  16%|█▌        | 154/971 [00:02<00:14, 57.32it/s]backtest loop:  16%|█▋        | 160/971 [00:03<00:14, 57.72it/s]backtest loop:  17%|█▋        | 166/971 [00:03<00:14, 54.53it/s]backtest loop:  18%|█▊        | 172/971 [00:03<00:14, 55.87it/s]backtest loop:  18%|█▊        | 179/971 [00:03<00:13, 57.86it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:14, 54.94it/s]backtest loop:  20%|█▉        | 191/971 [00:03<00:13, 56.25it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 57.17it/s]backtest loop:  21%|██        | 203/971 [00:03<00:13, 57.84it/s]backtest loop:  22%|██▏       | 210/971 [00:03<00:13, 55.73it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:14, 53.83it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:13, 54.91it/s]backtest loop:  23%|██▎       | 228/971 [00:04<00:13, 56.19it/s]backtest loop:  24%|██▍       | 234/971 [00:04<00:12, 57.20it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:13, 54.49it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:12, 56.78it/s]backtest loop:  26%|██▌       | 253/971 [00:04<00:12, 57.68it/s]backtest loop:  27%|██▋       | 259/971 [00:04<00:13, 54.55it/s]backtest loop:  27%|██▋       | 266/971 [00:05<00:13, 53.80it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 56.36it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:11, 58.23it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 55.17it/s]backtest loop:  30%|███       | 292/971 [00:05<00:12, 56.26it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 57.15it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:12, 55.20it/s]backtest loop:  32%|███▏      | 311/971 [00:05<00:11, 56.20it/s]backtest loop:  33%|███▎      | 317/971 [00:05<00:11, 57.19it/s]backtest loop:  33%|███▎      | 323/971 [00:05<00:11, 57.35it/s]backtest loop:  34%|███▍      | 330/971 [00:06<00:11, 55.49it/s]backtest loop:  35%|███▍      | 336/971 [00:06<00:11, 56.64it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:10, 57.42it/s]backtest loop:  36%|███▌      | 349/971 [00:06<00:10, 59.14it/s]backtest loop:  37%|███▋      | 355/971 [00:06<00:11, 55.68it/s]backtest loop:  37%|███▋      | 362/971 [00:06<00:10, 57.87it/s]backtest loop:  38%|███▊      | 368/971 [00:06<00:11, 51.73it/s]backtest loop:  39%|███▊      | 374/971 [00:06<00:11, 53.82it/s]backtest loop:  39%|███▉      | 380/971 [00:07<00:10, 55.37it/s]backtest loop:  40%|███▉      | 386/971 [00:07<00:10, 56.40it/s]backtest loop:  40%|████      | 392/971 [00:07<00:10, 57.40it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 54.55it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 56.84it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:09, 58.49it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:09, 55.41it/s]backtest loop:  44%|████▎     | 424/971 [00:07<00:09, 56.30it/s]backtest loop:  44%|████▍     | 430/971 [00:07<00:09, 57.18it/s]backtest loop:  45%|████▍     | 436/971 [00:07<00:09, 57.89it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:09, 54.76it/s]backtest loop:  46%|████▌     | 448/971 [00:08<00:09, 56.03it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:09, 56.70it/s]backtest loop:  47%|████▋     | 460/971 [00:08<00:08, 57.55it/s]backtest loop:  48%|████▊     | 466/971 [00:08<00:08, 57.98it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:09, 54.87it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 56.98it/s]backtest loop:  50%|████▉     | 485/971 [00:09<00:13, 34.99it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:12, 37.17it/s]backtest loop:  51%|█████     | 496/971 [00:09<00:11, 42.02it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:10, 46.06it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:09, 46.95it/s]backtest loop:  53%|█████▎    | 515/971 [00:09<00:08, 51.10it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:08, 51.38it/s]backtest loop:  54%|█████▍    | 528/971 [00:09<00:08, 53.43it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:07, 55.17it/s]backtest loop:  56%|█████▌    | 540/971 [00:10<00:07, 56.14it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 53.75it/s]backtest loop:  57%|█████▋    | 552/971 [00:10<00:07, 55.37it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 56.05it/s]backtest loop:  58%|█████▊    | 564/971 [00:10<00:07, 57.11it/s]backtest loop:  59%|█████▊    | 570/971 [00:10<00:07, 57.03it/s]backtest loop:  59%|█████▉    | 576/971 [00:10<00:07, 51.61it/s]backtest loop:  60%|█████▉    | 582/971 [00:10<00:07, 52.57it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:07, 52.88it/s]backtest loop:  61%|██████    | 594/971 [00:11<00:07, 53.36it/s]backtest loop:  62%|██████▏   | 600/971 [00:11<00:07, 50.14it/s]backtest loop:  62%|██████▏   | 606/971 [00:11<00:07, 51.33it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 52.38it/s]backtest loop:  64%|██████▎   | 618/971 [00:11<00:06, 53.05it/s]backtest loop:  64%|██████▍   | 624/971 [00:11<00:06, 53.52it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:06, 50.29it/s]backtest loop:  65%|██████▌   | 636/971 [00:11<00:06, 51.52it/s]backtest loop:  66%|██████▌   | 642/971 [00:12<00:06, 52.38it/s]backtest loop:  67%|██████▋   | 648/971 [00:12<00:06, 52.98it/s]backtest loop:  67%|██████▋   | 654/971 [00:12<00:05, 53.35it/s]backtest loop:  68%|██████▊   | 660/971 [00:12<00:06, 50.20it/s]backtest loop:  69%|██████▊   | 666/971 [00:12<00:05, 51.45it/s]backtest loop:  69%|██████▉   | 672/971 [00:12<00:05, 52.29it/s]backtest loop:  70%|██████▉   | 678/971 [00:12<00:05, 53.07it/s]backtest loop:  70%|███████   | 684/971 [00:12<00:05, 49.98it/s]backtest loop:  71%|███████   | 690/971 [00:12<00:05, 51.02it/s]backtest loop:  72%|███████▏  | 696/971 [00:13<00:05, 51.93it/s]backtest loop:  72%|███████▏  | 702/971 [00:13<00:05, 52.65it/s]backtest loop:  73%|███████▎  | 708/971 [00:13<00:04, 53.14it/s]backtest loop:  74%|███████▎  | 714/971 [00:13<00:05, 50.29it/s]backtest loop:  74%|███████▍  | 720/971 [00:13<00:04, 51.51it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 52.41it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 49.72it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 48.10it/s]backtest loop:  77%|███████▋  | 744/971 [00:14<00:04, 49.80it/s]backtest loop:  77%|███████▋  | 750/971 [00:14<00:04, 48.04it/s]backtest loop:  78%|███████▊  | 756/971 [00:14<00:04, 49.80it/s]backtest loop:  78%|███████▊  | 762/971 [00:14<00:04, 51.06it/s]backtest loop:  79%|███████▉  | 768/971 [00:14<00:03, 52.06it/s]backtest loop:  80%|███████▉  | 774/971 [00:14<00:03, 52.79it/s]backtest loop:  80%|████████  | 780/971 [00:14<00:03, 49.97it/s]backtest loop:  81%|████████  | 786/971 [00:14<00:03, 51.35it/s]backtest loop:  82%|████████▏ | 792/971 [00:14<00:03, 52.18it/s]backtest loop:  82%|████████▏ | 798/971 [00:15<00:03, 49.47it/s]backtest loop:  83%|████████▎ | 804/971 [00:15<00:03, 50.99it/s]backtest loop:  83%|████████▎ | 810/971 [00:15<00:03, 51.66it/s]backtest loop:  84%|████████▍ | 816/971 [00:15<00:02, 52.43it/s]backtest loop:  85%|████████▍ | 822/971 [00:15<00:02, 52.98it/s]backtest loop:  85%|████████▌ | 828/971 [00:15<00:02, 50.00it/s]backtest loop:  86%|████████▌ | 834/971 [00:15<00:02, 51.20it/s]backtest loop:  87%|████████▋ | 840/971 [00:15<00:02, 52.12it/s]backtest loop:  87%|████████▋ | 846/971 [00:15<00:02, 52.74it/s]backtest loop:  88%|████████▊ | 852/971 [00:16<00:02, 49.99it/s]backtest loop:  88%|████████▊ | 858/971 [00:16<00:02, 51.16it/s]backtest loop:  89%|████████▉ | 864/971 [00:16<00:02, 52.04it/s]backtest loop:  90%|████████▉ | 870/971 [00:16<00:01, 52.74it/s]backtest loop:  90%|█████████ | 876/971 [00:16<00:01, 52.84it/s]backtest loop:  91%|█████████ | 882/971 [00:16<00:01, 50.16it/s]backtest loop:  91%|█████████▏| 888/971 [00:16<00:01, 51.43it/s]backtest loop:  92%|█████████▏| 894/971 [00:16<00:01, 52.02it/s]backtest loop:  93%|█████████▎| 900/971 [00:17<00:01, 52.86it/s]backtest loop:  93%|█████████▎| 906/971 [00:17<00:01, 53.39it/s]backtest loop:  94%|█████████▍| 912/971 [00:17<00:01, 50.32it/s]backtest loop:  95%|█████████▍| 918/971 [00:17<00:01, 51.51it/s]backtest loop:  95%|█████████▌| 924/971 [00:17<00:00, 52.39it/s]backtest loop:  96%|█████████▌| 930/971 [00:17<00:00, 53.26it/s]backtest loop:  96%|█████████▋| 936/971 [00:17<00:00, 50.35it/s]backtest loop:  97%|█████████▋| 942/971 [00:17<00:00, 51.55it/s]backtest loop:  98%|█████████▊| 948/971 [00:17<00:00, 52.51it/s]backtest loop:  98%|█████████▊| 954/971 [00:18<00:00, 53.01it/s]backtest loop:  99%|█████████▉| 960/971 [00:18<00:00, 50.33it/s]backtest loop:  99%|█████████▉| 966/971 [00:18<00:00, 51.52it/s]backtest loop: 100%|██████████| 971/971 [00:18<00:00, 52.71it/s]
[3553693:MainThread](2024-04-26 04:58:38,869) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000655
std                0.005850
annualized_return  0.155968
information_ratio  1.728098
max_drawdown      -0.069834
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000456
std                0.005851
annualized_return  0.108504
information_ratio  1.202054
max_drawdown      -0.123165
[3553693:MainThread](2024-04-26 04:58:38,885) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_Localformer_alpha360_horizon1_step20_rankFalse_2024-04-26_03:34:20_online`.
Round 2 Done!
{'1day.excess_return_with_cost.annualized_return': [0.07075714264527615,
                                                    0.10850427937124411],
 '1day.excess_return_with_cost.information_ratio': [0.7604996387958325,
                                                    1.2020537825981399],
 '1day.excess_return_with_cost.max_drawdown': [-0.14329134900291735,
                                               -0.12316472001361661],
 'IC': [0.023486286189309008, 0.02791365222447451],
 'ICIR': [0.17230008880149675, 0.19858094896927955],
 'Rank IC': [0.01784804193762672, 0.025047469820677314],
 'Rank ICIR': [0.12653690606414603, 0.1780858675400394],
 'mae': [0.7075116038322449, 0.707405149936676],
 'mse': [0.9960588812828064, 0.9957895874977112]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3553693:MainThread](2024-04-26 04:58:40,073) INFO - qlib.TransformerModel - [pytorch_localformer.py:64] - Naive Transformer:
batch_size : 2048
device : cuda:0
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:53<1:27:40, 53.14s/it]epoch:   2%|▏         | 2/100 [01:46<1:26:49, 53.16s/it]epoch:   3%|▎         | 3/100 [02:39<1:25:59, 53.19s/it]epoch:   4%|▍         | 4/100 [03:32<1:25:11, 53.24s/it]epoch:   5%|▌         | 5/100 [04:25<1:24:12, 53.19s/it]epoch:   6%|▌         | 6/100 [05:19<1:23:27, 53.27s/it]epoch:   7%|▋         | 7/100 [06:12<1:22:29, 53.22s/it]epoch:   8%|▊         | 8/100 [07:05<1:21:38, 53.24s/it]epoch:   9%|▉         | 9/100 [07:58<1:20:42, 53.22s/it]epoch:  10%|█         | 10/100 [08:51<1:19:43, 53.15s/it]epoch:  11%|█         | 11/100 [09:45<1:18:53, 53.19s/it]epoch:  12%|█▏        | 12/100 [10:38<1:17:56, 53.14s/it]epoch:  13%|█▎        | 13/100 [11:31<1:17:01, 53.12s/it]epoch:  14%|█▍        | 14/100 [12:24<1:16:07, 53.11s/it]epoch:  15%|█▌        | 15/100 [13:17<1:15:15, 53.12s/it]epoch:  16%|█▌        | 16/100 [14:10<1:14:23, 53.13s/it]epoch:  17%|█▋        | 17/100 [15:04<1:13:39, 53.24s/it]epoch:  18%|█▊        | 18/100 [15:57<1:12:49, 53.29s/it]epoch:  19%|█▉        | 19/100 [16:51<1:12:00, 53.34s/it]epoch:  20%|██        | 20/100 [17:44<1:11:10, 53.38s/it]epoch:  21%|██        | 21/100 [18:37<1:10:07, 53.26s/it]epoch:  22%|██▏       | 22/100 [19:30<1:09:16, 53.29s/it]epoch:  23%|██▎       | 23/100 [20:23<1:08:18, 53.22s/it]epoch:  24%|██▍       | 24/100 [21:16<1:07:17, 53.12s/it]epoch:  25%|██▌       | 25/100 [22:09<1:06:22, 53.10s/it]epoch:  26%|██▌       | 26/100 [23:03<1:05:30, 53.12s/it]epoch:  27%|██▋       | 27/100 [23:56<1:04:36, 53.10s/it]epoch:  28%|██▊       | 28/100 [24:49<1:03:53, 53.24s/it]epoch:  29%|██▉       | 29/100 [25:42<1:02:58, 53.22s/it]epoch:  30%|███       | 30/100 [26:35<1:01:58, 53.13s/it]0.051036742237532295
best ic: 0.051036742237532295
epoch:  31%|███       | 31/100 [27:35<1:03:16, 55.02s/it]0.05437106913807423
best ic: 0.05437106913807423
epoch:  32%|███▏      | 32/100 [28:34<1:03:50, 56.34s/it]0.055428737335486936
best ic: 0.055428737335486936
epoch:  33%|███▎      | 33/100 [29:34<1:04:00, 57.32s/it]0.053005555868820414
epoch:  34%|███▍      | 34/100 [30:33<1:03:45, 57.96s/it]0.05517751896879777
epoch:  35%|███▌      | 35/100 [31:33<1:03:16, 58.40s/it]0.05619367420731166
best ic: 0.05619367420731166
epoch:  36%|███▌      | 36/100 [32:32<1:02:37, 58.72s/it]0.048132681581914055
epoch:  37%|███▋      | 37/100 [33:31<1:01:51, 58.91s/it]0.04857663191616618
epoch:  38%|███▊      | 38/100 [34:31<1:01:03, 59.08s/it]0.04848057144597691
epoch:  39%|███▉      | 39/100 [35:30<1:00:08, 59.15s/it]0.05052107307545476
epoch:  40%|████      | 40/100 [36:30<59:17, 59.28s/it]  0.04333419816628437
epoch:  41%|████      | 41/100 [37:29<58:18, 59.30s/it]0.04785225727373824
epoch:  42%|████▏     | 42/100 [38:28<57:19, 59.30s/it]0.04505062957569819
epoch:  43%|████▎     | 43/100 [39:28<56:22, 59.35s/it]0.04607770658568898
epoch:  43%|████▎     | 43/100 [40:27<53:38, 56.46s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3553693:MainThread](2024-04-26 05:39:07,785) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3553693:MainThread](2024-04-26 05:39:07,799) INFO - qlib.workflow - [recorder.py:341] - Recorder ea4acf3018a24d3c99c29ba62fe9994f starts running under Experiment 53 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:20,  3.06it/s]online:   3%|▎         | 2/63 [00:00<00:22,  2.68it/s]online:   5%|▍         | 3/63 [00:01<00:23,  2.57it/s]online:   6%|▋         | 4/63 [00:01<00:23,  2.52it/s]online:   8%|▊         | 5/63 [00:01<00:23,  2.50it/s]online:  10%|▉         | 6/63 [00:02<00:22,  2.48it/s]online:  11%|█         | 7/63 [00:02<00:22,  2.46it/s]online:  13%|█▎        | 8/63 [00:03<00:22,  2.45it/s]online:  14%|█▍        | 9/63 [00:03<00:22,  2.45it/s]online:  16%|█▌        | 10/63 [00:04<00:21,  2.44it/s]online:  17%|█▋        | 11/63 [00:04<00:21,  2.44it/s]online:  19%|█▉        | 12/63 [00:04<00:20,  2.43it/s]online:  21%|██        | 13/63 [00:05<00:20,  2.42it/s]online:  22%|██▏       | 14/63 [00:05<00:20,  2.43it/s]online:  24%|██▍       | 15/63 [00:06<00:19,  2.43it/s]online:  25%|██▌       | 16/63 [00:06<00:19,  2.43it/s]online:  27%|██▋       | 17/63 [00:06<00:18,  2.43it/s]online:  29%|██▊       | 18/63 [00:07<00:18,  2.43it/s]online:  30%|███       | 19/63 [00:07<00:18,  2.42it/s]online:  32%|███▏      | 20/63 [00:08<00:17,  2.43it/s]online:  33%|███▎      | 21/63 [00:08<00:17,  2.42it/s]online:  35%|███▍      | 22/63 [00:08<00:16,  2.43it/s]online:  37%|███▋      | 23/63 [00:09<00:16,  2.43it/s]online:  38%|███▊      | 24/63 [00:09<00:16,  2.43it/s]online:  40%|███▉      | 25/63 [00:10<00:15,  2.42it/s]online:  41%|████▏     | 26/63 [00:10<00:15,  2.42it/s]online:  43%|████▎     | 27/63 [00:11<00:14,  2.41it/s]online:  44%|████▍     | 28/63 [00:11<00:14,  2.42it/s]online:  46%|████▌     | 29/63 [00:11<00:14,  2.41it/s]online:  48%|████▊     | 30/63 [00:12<00:13,  2.42it/s]online:  49%|████▉     | 31/63 [00:12<00:13,  2.41it/s]online:  51%|█████     | 32/63 [00:13<00:12,  2.40it/s]online:  52%|█████▏    | 33/63 [00:13<00:12,  2.40it/s]online:  54%|█████▍    | 34/63 [00:13<00:12,  2.41it/s]online:  56%|█████▌    | 35/63 [00:14<00:11,  2.41it/s]online:  57%|█████▋    | 36/63 [00:14<00:11,  2.41it/s]online:  59%|█████▊    | 37/63 [00:15<00:10,  2.42it/s]online:  60%|██████    | 38/63 [00:15<00:10,  2.42it/s]online:  62%|██████▏   | 39/63 [00:16<00:09,  2.41it/s]online:  63%|██████▎   | 40/63 [00:16<00:09,  2.42it/s]online:  65%|██████▌   | 41/63 [00:16<00:09,  2.41it/s]online:  67%|██████▋   | 42/63 [00:17<00:08,  2.41it/s]online:  68%|██████▊   | 43/63 [00:17<00:08,  2.41it/s]online:  70%|██████▉   | 44/63 [00:18<00:07,  2.41it/s]online:  71%|███████▏  | 45/63 [00:18<00:07,  2.41it/s]online:  73%|███████▎  | 46/63 [00:18<00:07,  2.42it/s]online:  75%|███████▍  | 47/63 [00:19<00:06,  2.41it/s]online:  76%|███████▌  | 48/63 [00:19<00:06,  2.41it/s]online:  78%|███████▊  | 49/63 [00:20<00:05,  2.40it/s]online:  79%|███████▉  | 50/63 [00:20<00:05,  2.40it/s]online:  81%|████████  | 51/63 [00:20<00:04,  2.41it/s]online:  83%|████████▎ | 52/63 [00:21<00:04,  2.40it/s]online:  84%|████████▍ | 53/63 [00:21<00:04,  2.41it/s]online:  86%|████████▌ | 54/63 [00:22<00:03,  2.42it/s]online:  87%|████████▋ | 55/63 [00:22<00:03,  2.40it/s]online:  89%|████████▉ | 56/63 [00:23<00:02,  2.41it/s]online:  90%|█████████ | 57/63 [00:23<00:02,  2.40it/s]online:  92%|█████████▏| 58/63 [00:23<00:02,  2.39it/s]online:  94%|█████████▎| 59/63 [00:24<00:01,  2.40it/s]online:  95%|█████████▌| 60/63 [00:24<00:01,  2.41it/s]online:  97%|█████████▋| 61/63 [00:25<00:00,  2.41it/s]online:  98%|█████████▊| 62/63 [00:25<00:00,  2.41it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.51it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.43it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3553693:MainThread](2024-04-26 05:39:42,139) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99612194 mae 0.7074941
{'IC': 0.02441311490294145,
 'ICIR': 0.17400805891726157,
 'Rank IC': 0.017413522190489108,
 'Rank ICIR': 0.12095496861110042}
[3553693:MainThread](2024-04-26 05:39:43,932) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3553693:MainThread](2024-04-26 05:39:55,069) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 05:39:55,072) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 05:40:01,255) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fd64fc33b20>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:42,  9.43it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.28it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 33.80it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:25, 37.51it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:22, 42.72it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 45.99it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 45.48it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:19, 48.24it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 49.83it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:19, 48.07it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:18, 50.03it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 51.46it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:17, 52.59it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 53.39it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 50.53it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 51.78it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 52.46it/s]backtest loop:  11%|█         | 105/971 [00:02<00:16, 53.43it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:15, 53.83it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 50.30it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 51.59it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:17, 49.41it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:16, 50.72it/s]backtest loop:  15%|█▍        | 141/971 [00:03<00:17, 48.76it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:16, 50.10it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 51.33it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 52.05it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:15, 52.83it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 50.17it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:15, 51.17it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:15, 52.09it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:14, 52.94it/s]backtest loop:  20%|██        | 195/971 [00:04<00:15, 50.12it/s]backtest loop:  21%|██        | 201/971 [00:04<00:14, 51.42it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:14, 51.86it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:15, 49.75it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:14, 51.36it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:15, 49.10it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:14, 50.98it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:14, 51.64it/s]backtest loop:  25%|██▌       | 243/971 [00:04<00:13, 52.60it/s]backtest loop:  26%|██▌       | 249/971 [00:05<00:14, 49.95it/s]backtest loop:  26%|██▋       | 255/971 [00:05<00:13, 51.27it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:13, 52.01it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:14, 49.35it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:13, 50.76it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:13, 51.95it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:13, 52.55it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:13, 49.80it/s]backtest loop:  31%|███       | 297/971 [00:06<00:13, 50.89it/s]backtest loop:  31%|███       | 303/971 [00:06<00:12, 51.89it/s]backtest loop:  32%|███▏      | 309/971 [00:06<00:12, 52.65it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:13, 49.78it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:12, 51.07it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:12, 51.44it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:12, 52.32it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:11, 52.95it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:12, 49.92it/s]backtest loop:  36%|███▌      | 351/971 [00:07<00:12, 51.57it/s]backtest loop:  37%|███▋      | 357/971 [00:07<00:11, 52.10it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:12, 49.91it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:12, 48.11it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 49.98it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:11, 51.28it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:11, 51.94it/s]backtest loop:  40%|████      | 393/971 [00:07<00:11, 49.56it/s]backtest loop:  41%|████      | 399/971 [00:08<00:11, 50.97it/s]backtest loop:  42%|████▏     | 405/971 [00:08<00:10, 51.77it/s]backtest loop:  42%|████▏     | 411/971 [00:08<00:10, 52.57it/s]backtest loop:  43%|████▎     | 417/971 [00:08<00:10, 52.82it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:10, 49.89it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:10, 51.23it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:10, 51.99it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:10, 52.69it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:10, 49.67it/s]backtest loop:  47%|████▋     | 453/971 [00:09<00:10, 51.15it/s]backtest loop:  47%|████▋     | 459/971 [00:09<00:09, 51.98it/s]backtest loop:  48%|████▊     | 465/971 [00:09<00:09, 52.72it/s]backtest loop:  49%|████▊     | 471/971 [00:09<00:09, 53.24it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 49.91it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:15, 32.18it/s]backtest loop:  50%|█████     | 489/971 [00:10<00:13, 36.61it/s]backtest loop:  51%|█████     | 495/971 [00:10<00:12, 38.57it/s]backtest loop:  52%|█████▏    | 501/971 [00:10<00:11, 42.20it/s]backtest loop:  52%|█████▏    | 507/971 [00:10<00:10, 43.31it/s]backtest loop:  53%|█████▎    | 513/971 [00:10<00:09, 46.23it/s]backtest loop:  53%|█████▎    | 519/971 [00:10<00:09, 48.08it/s]backtest loop:  54%|█████▍    | 525/971 [00:10<00:08, 49.91it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:09, 48.13it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:08, 49.86it/s]backtest loop:  56%|█████▌    | 543/971 [00:11<00:08, 50.82it/s]backtest loop:  57%|█████▋    | 549/971 [00:11<00:08, 51.62it/s]backtest loop:  57%|█████▋    | 555/971 [00:11<00:08, 51.96it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:08, 49.48it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:07, 50.86it/s]backtest loop:  59%|█████▉    | 573/971 [00:11<00:07, 51.75it/s]backtest loop:  60%|█████▉    | 579/971 [00:11<00:07, 52.34it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:07, 52.92it/s]backtest loop:  61%|██████    | 591/971 [00:12<00:07, 50.13it/s]backtest loop:  61%|██████▏   | 597/971 [00:12<00:07, 51.33it/s]backtest loop:  62%|██████▏   | 603/971 [00:12<00:07, 52.20it/s]backtest loop:  63%|██████▎   | 609/971 [00:12<00:06, 52.72it/s]backtest loop:  63%|██████▎   | 615/971 [00:12<00:07, 50.22it/s]backtest loop:  64%|██████▍   | 621/971 [00:12<00:06, 51.45it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:06, 52.54it/s]backtest loop:  65%|██████▌   | 633/971 [00:12<00:06, 53.16it/s]backtest loop:  66%|██████▌   | 639/971 [00:12<00:06, 53.34it/s]backtest loop:  66%|██████▋   | 645/971 [00:13<00:06, 50.40it/s]backtest loop:  67%|██████▋   | 651/971 [00:13<00:06, 51.69it/s]backtest loop:  68%|██████▊   | 657/971 [00:13<00:05, 52.52it/s]backtest loop:  68%|██████▊   | 663/971 [00:13<00:05, 53.11it/s]backtest loop:  69%|██████▉   | 669/971 [00:13<00:05, 53.46it/s]backtest loop:  70%|██████▉   | 675/971 [00:13<00:05, 50.24it/s]backtest loop:  70%|███████   | 681/971 [00:13<00:05, 51.45it/s]backtest loop:  71%|███████   | 687/971 [00:13<00:05, 52.09it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:05, 52.79it/s]backtest loop:  72%|███████▏  | 699/971 [00:14<00:05, 49.95it/s]backtest loop:  73%|███████▎  | 705/971 [00:14<00:05, 51.10it/s]backtest loop:  73%|███████▎  | 711/971 [00:14<00:04, 52.11it/s]backtest loop:  74%|███████▍  | 717/971 [00:14<00:04, 52.69it/s]backtest loop:  74%|███████▍  | 723/971 [00:14<00:04, 53.24it/s]backtest loop:  75%|███████▌  | 729/971 [00:14<00:04, 50.31it/s]backtest loop:  76%|███████▌  | 735/971 [00:14<00:04, 48.28it/s]backtest loop:  76%|███████▋  | 741/971 [00:14<00:04, 50.00it/s]backtest loop:  77%|███████▋  | 747/971 [00:15<00:04, 51.15it/s]backtest loop:  78%|███████▊  | 753/971 [00:15<00:04, 48.98it/s]backtest loop:  78%|███████▊  | 759/971 [00:15<00:04, 50.27it/s]backtest loop:  79%|███████▉  | 765/971 [00:15<00:04, 48.34it/s]backtest loop:  79%|███████▉  | 771/971 [00:15<00:04, 49.96it/s]backtest loop:  80%|████████  | 777/971 [00:15<00:03, 51.15it/s]backtest loop:  81%|████████  | 783/971 [00:15<00:03, 48.99it/s]backtest loop:  81%|████████▏ | 789/971 [00:15<00:03, 50.27it/s]backtest loop:  82%|████████▏ | 795/971 [00:16<00:03, 51.26it/s]backtest loop:  82%|████████▏ | 801/971 [00:16<00:03, 52.15it/s]backtest loop:  83%|████████▎ | 807/971 [00:16<00:03, 52.74it/s]backtest loop:  84%|████████▎ | 813/971 [00:16<00:03, 50.02it/s]backtest loop:  84%|████████▍ | 819/971 [00:16<00:02, 51.01it/s]backtest loop:  85%|████████▍ | 825/971 [00:16<00:02, 51.98it/s]backtest loop:  86%|████████▌ | 831/971 [00:16<00:02, 52.69it/s]backtest loop:  86%|████████▌ | 837/971 [00:16<00:02, 53.20it/s]backtest loop:  87%|████████▋ | 843/971 [00:16<00:02, 50.29it/s]backtest loop:  87%|████████▋ | 849/971 [00:17<00:02, 51.27it/s]backtest loop:  88%|████████▊ | 855/971 [00:17<00:02, 52.18it/s]backtest loop:  89%|████████▊ | 861/971 [00:17<00:02, 52.82it/s]backtest loop:  89%|████████▉ | 867/971 [00:17<00:02, 50.12it/s]backtest loop:  90%|████████▉ | 873/971 [00:17<00:01, 51.35it/s]backtest loop:  91%|█████████ | 879/971 [00:17<00:01, 52.05it/s]backtest loop:  91%|█████████ | 885/971 [00:17<00:01, 52.84it/s]backtest loop:  92%|█████████▏| 891/971 [00:17<00:01, 53.14it/s]backtest loop:  92%|█████████▏| 897/971 [00:17<00:01, 50.36it/s]backtest loop:  93%|█████████▎| 903/971 [00:18<00:01, 51.52it/s]backtest loop:  94%|█████████▎| 909/971 [00:18<00:01, 51.94it/s]backtest loop:  94%|█████████▍| 915/971 [00:18<00:01, 52.14it/s]backtest loop:  95%|█████████▍| 921/971 [00:18<00:00, 51.14it/s]backtest loop:  95%|█████████▌| 927/971 [00:18<00:00, 53.23it/s]backtest loop:  96%|█████████▌| 933/971 [00:18<00:00, 54.94it/s]backtest loop:  97%|█████████▋| 939/971 [00:18<00:00, 56.09it/s]backtest loop:  97%|█████████▋| 945/971 [00:18<00:00, 53.48it/s]backtest loop:  98%|█████████▊| 951/971 [00:18<00:00, 55.25it/s]backtest loop:  99%|█████████▊| 958/971 [00:19<00:00, 57.33it/s]backtest loop:  99%|█████████▉| 965/971 [00:19<00:00, 55.37it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 56.37it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 50.25it/s]
[3553693:MainThread](2024-04-26 05:40:20,651) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000479
std                0.006081
annualized_return  0.113943
information_ratio  1.214512
max_drawdown      -0.117666
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000281
std                0.006082
annualized_return  0.066853
information_ratio  0.712505
max_drawdown      -0.164693
[3553693:MainThread](2024-04-26 05:40:20,667) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_Localformer_alpha360_horizon1_step20_rankFalse_2024-04-26_03:34:20_online`.
Round 3 Done!
{'1day.excess_return_with_cost.annualized_return': [0.07075714264527615,
                                                    0.10850427937124411,
                                                    0.06685286326248528],
 '1day.excess_return_with_cost.information_ratio': [0.7604996387958325,
                                                    1.2020537825981399,
                                                    0.7125046093662444],
 '1day.excess_return_with_cost.max_drawdown': [-0.14329134900291735,
                                               -0.12316472001361661,
                                               -0.1646927914298363],
 'IC': [0.023486286189309008, 0.02791365222447451, 0.02441311490294145],
 'ICIR': [0.17230008880149675, 0.19858094896927955, 0.17400805891726157],
 'Rank IC': [0.01784804193762672, 0.025047469820677314, 0.017413522190489108],
 'Rank ICIR': [0.12653690606414603, 0.1780858675400394, 0.12095496861110042],
 'mae': [0.7075116038322449, 0.707405149936676, 0.7074940800666809],
 'mse': [0.9960588812828064, 0.9957895874977112, 0.9961219429969788]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3553693:MainThread](2024-04-26 05:40:21,851) INFO - qlib.TransformerModel - [pytorch_localformer.py:64] - Naive Transformer:
batch_size : 2048
device : cuda:0
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:52<1:27:26, 53.00s/it]epoch:   2%|▏         | 2/100 [01:46<1:26:38, 53.04s/it]epoch:   3%|▎         | 3/100 [02:39<1:26:05, 53.26s/it]epoch:   4%|▍         | 4/100 [03:33<1:25:27, 53.41s/it]epoch:   5%|▌         | 5/100 [04:26<1:24:24, 53.31s/it]epoch:   6%|▌         | 6/100 [05:19<1:23:29, 53.29s/it]epoch:   7%|▋         | 7/100 [06:12<1:22:29, 53.22s/it]epoch:   8%|▊         | 8/100 [07:05<1:21:33, 53.20s/it]epoch:   9%|▉         | 9/100 [07:59<1:20:45, 53.24s/it]epoch:  10%|█         | 10/100 [08:52<1:19:43, 53.16s/it]epoch:  11%|█         | 11/100 [09:45<1:18:52, 53.18s/it]epoch:  12%|█▏        | 12/100 [10:38<1:18:02, 53.22s/it]epoch:  13%|█▎        | 13/100 [11:32<1:17:13, 53.25s/it]epoch:  14%|█▍        | 14/100 [12:25<1:16:21, 53.27s/it]epoch:  15%|█▌        | 15/100 [13:18<1:15:28, 53.27s/it]epoch:  16%|█▌        | 16/100 [14:11<1:14:30, 53.23s/it]epoch:  17%|█▋        | 17/100 [15:04<1:13:35, 53.20s/it]epoch:  18%|█▊        | 18/100 [15:57<1:12:40, 53.18s/it]epoch:  19%|█▉        | 19/100 [16:51<1:11:46, 53.16s/it]epoch:  20%|██        | 20/100 [17:44<1:10:56, 53.21s/it]epoch:  21%|██        | 21/100 [18:37<1:10:04, 53.22s/it]epoch:  22%|██▏       | 22/100 [19:30<1:09:09, 53.20s/it]epoch:  23%|██▎       | 23/100 [20:23<1:08:10, 53.13s/it]epoch:  24%|██▍       | 24/100 [21:16<1:07:14, 53.09s/it]epoch:  25%|██▌       | 25/100 [22:09<1:06:15, 53.01s/it]epoch:  26%|██▌       | 26/100 [23:02<1:05:24, 53.04s/it]epoch:  27%|██▋       | 27/100 [23:55<1:04:32, 53.04s/it]epoch:  28%|██▊       | 28/100 [24:48<1:03:41, 53.07s/it]epoch:  29%|██▉       | 29/100 [25:41<1:02:46, 53.04s/it]epoch:  30%|███       | 30/100 [26:34<1:01:54, 53.07s/it]0.04811839793529014
best ic: 0.04811839793529014
epoch:  31%|███       | 31/100 [27:34<1:03:24, 55.14s/it]0.04639685196867416
epoch:  32%|███▏      | 32/100 [28:34<1:04:06, 56.57s/it]0.05020816297776909
best ic: 0.05020816297776909
epoch:  33%|███▎      | 33/100 [29:34<1:04:14, 57.54s/it]0.04674422887172303
epoch:  34%|███▍      | 34/100 [30:34<1:03:56, 58.13s/it]0.04940985260166561
epoch:  35%|███▌      | 35/100 [31:33<1:03:23, 58.52s/it]0.04442551172876403
epoch:  36%|███▌      | 36/100 [32:33<1:02:44, 58.82s/it]0.0517231151019056
best ic: 0.0517231151019056
epoch:  37%|███▋      | 37/100 [33:32<1:01:52, 58.93s/it]0.04432567127497857
epoch:  38%|███▊      | 38/100 [34:31<1:01:07, 59.15s/it]0.043636312505325854
epoch:  39%|███▉      | 39/100 [35:31<1:00:14, 59.26s/it]0.048935787513987195
epoch:  40%|████      | 40/100 [36:30<59:12, 59.22s/it]  0.04662323235875699
epoch:  41%|████      | 41/100 [37:29<58:15, 59.24s/it]0.036269801706959
epoch:  42%|████▏     | 42/100 [38:29<57:17, 59.27s/it]0.049646212741678374
epoch:  43%|████▎     | 43/100 [39:28<56:20, 59.30s/it]0.035793991745568667
epoch:  44%|████▍     | 44/100 [40:28<55:25, 59.39s/it]0.04786089964729778
epoch:  44%|████▍     | 44/100 [41:27<52:45, 56.53s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3553693:MainThread](2024-04-26 06:21:49,389) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3553693:MainThread](2024-04-26 06:21:49,403) INFO - qlib.workflow - [recorder.py:341] - Recorder fa7a33547f4f49d78d73e0df08ed3745 starts running under Experiment 53 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:20,  3.07it/s]online:   3%|▎         | 2/63 [00:00<00:22,  2.66it/s]online:   5%|▍         | 3/63 [00:01<00:23,  2.56it/s]online:   6%|▋         | 4/63 [00:01<00:23,  2.51it/s]online:   8%|▊         | 5/63 [00:01<00:23,  2.48it/s]online:  10%|▉         | 6/63 [00:02<00:23,  2.48it/s]online:  11%|█         | 7/63 [00:02<00:22,  2.47it/s]online:  13%|█▎        | 8/63 [00:03<00:22,  2.45it/s]online:  14%|█▍        | 9/63 [00:03<00:22,  2.45it/s]online:  16%|█▌        | 10/63 [00:04<00:21,  2.45it/s]online:  17%|█▋        | 11/63 [00:04<00:21,  2.44it/s]online:  19%|█▉        | 12/63 [00:04<00:20,  2.44it/s]online:  21%|██        | 13/63 [00:05<00:20,  2.45it/s]online:  22%|██▏       | 14/63 [00:05<00:20,  2.44it/s]online:  24%|██▍       | 15/63 [00:06<00:19,  2.45it/s]online:  25%|██▌       | 16/63 [00:06<00:19,  2.45it/s]online:  27%|██▋       | 17/63 [00:06<00:18,  2.45it/s]online:  29%|██▊       | 18/63 [00:07<00:18,  2.45it/s]online:  30%|███       | 19/63 [00:07<00:18,  2.44it/s]online:  32%|███▏      | 20/63 [00:08<00:17,  2.44it/s]online:  33%|███▎      | 21/63 [00:08<00:17,  2.45it/s]online:  35%|███▍      | 22/63 [00:08<00:16,  2.44it/s]online:  37%|███▋      | 23/63 [00:09<00:16,  2.44it/s]online:  38%|███▊      | 24/63 [00:09<00:16,  2.43it/s]online:  40%|███▉      | 25/63 [00:10<00:15,  2.44it/s]online:  41%|████▏     | 26/63 [00:10<00:15,  2.43it/s]online:  43%|████▎     | 27/63 [00:10<00:14,  2.43it/s]online:  44%|████▍     | 28/63 [00:11<00:14,  2.43it/s]online:  46%|████▌     | 29/63 [00:11<00:13,  2.44it/s]online:  48%|████▊     | 30/63 [00:12<00:13,  2.44it/s]online:  49%|████▉     | 31/63 [00:12<00:13,  2.43it/s]online:  51%|█████     | 32/63 [00:13<00:12,  2.43it/s]online:  52%|█████▏    | 33/63 [00:13<00:12,  2.43it/s]online:  54%|█████▍    | 34/63 [00:13<00:11,  2.43it/s]online:  56%|█████▌    | 35/63 [00:14<00:11,  2.43it/s]online:  57%|█████▋    | 36/63 [00:14<00:11,  2.44it/s]online:  59%|█████▊    | 37/63 [00:15<00:10,  2.44it/s]online:  60%|██████    | 38/63 [00:15<00:10,  2.45it/s]online:  62%|██████▏   | 39/63 [00:15<00:09,  2.44it/s]online:  63%|██████▎   | 40/63 [00:16<00:09,  2.44it/s]online:  65%|██████▌   | 41/63 [00:16<00:09,  2.43it/s]online:  67%|██████▋   | 42/63 [00:17<00:08,  2.44it/s]online:  68%|██████▊   | 43/63 [00:17<00:08,  2.44it/s]online:  70%|██████▉   | 44/63 [00:17<00:07,  2.45it/s]online:  71%|███████▏  | 45/63 [00:18<00:07,  2.44it/s]online:  73%|███████▎  | 46/63 [00:18<00:06,  2.45it/s]online:  75%|███████▍  | 47/63 [00:19<00:06,  2.44it/s]online:  76%|███████▌  | 48/63 [00:19<00:06,  2.45it/s]online:  78%|███████▊  | 49/63 [00:20<00:05,  2.43it/s]online:  79%|███████▉  | 50/63 [00:20<00:05,  2.44it/s]online:  81%|████████  | 51/63 [00:20<00:04,  2.43it/s]online:  83%|████████▎ | 52/63 [00:21<00:04,  2.42it/s]online:  84%|████████▍ | 53/63 [00:21<00:04,  2.43it/s]online:  86%|████████▌ | 54/63 [00:22<00:03,  2.44it/s]online:  87%|████████▋ | 55/63 [00:22<00:03,  2.44it/s]online:  89%|████████▉ | 56/63 [00:22<00:02,  2.44it/s]online:  90%|█████████ | 57/63 [00:23<00:02,  2.44it/s]online:  92%|█████████▏| 58/63 [00:23<00:02,  2.43it/s]online:  94%|█████████▎| 59/63 [00:24<00:01,  2.43it/s]online:  95%|█████████▌| 60/63 [00:24<00:01,  2.43it/s]online:  97%|█████████▋| 61/63 [00:24<00:00,  2.42it/s]online:  98%|█████████▊| 62/63 [00:25<00:00,  2.43it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.52it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.45it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3553693:MainThread](2024-04-26 06:22:23,624) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9960363 mae 0.7074707
{'IC': 0.023209719834113737,
 'ICIR': 0.16495475959030012,
 'Rank IC': 0.016932903948649526,
 'Rank ICIR': 0.1191049590209752}
[3553693:MainThread](2024-04-26 06:22:25,353) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3553693:MainThread](2024-04-26 06:22:36,652) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 06:22:36,656) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 06:22:42,740) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fd64d12efa0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:43,  9.34it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 24.83it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:26, 35.52it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.20it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.89it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:18, 49.62it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:18, 49.34it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:17, 52.23it/s]backtest loop:   5%|▌         | 52/971 [00:01<00:16, 55.34it/s]backtest loop:   6%|▌         | 58/971 [00:01<00:17, 53.18it/s]backtest loop:   7%|▋         | 65/971 [00:01<00:16, 55.84it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:15, 56.98it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:16, 54.57it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 57.10it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 58.86it/s]backtest loop:  10%|▉         | 97/971 [00:01<00:15, 56.06it/s]backtest loop:  11%|█         | 103/971 [00:02<00:15, 57.02it/s]backtest loop:  11%|█▏        | 110/971 [00:02<00:14, 58.63it/s]backtest loop:  12%|█▏        | 116/971 [00:02<00:14, 58.73it/s]backtest loop:  13%|█▎        | 122/971 [00:02<00:15, 56.56it/s]backtest loop:  13%|█▎        | 128/971 [00:02<00:15, 54.66it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:14, 56.11it/s]backtest loop:  14%|█▍        | 140/971 [00:02<00:14, 57.11it/s]backtest loop:  15%|█▌        | 146/971 [00:02<00:15, 54.32it/s]backtest loop:  16%|█▌        | 152/971 [00:02<00:14, 55.85it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:14, 56.92it/s]backtest loop:  17%|█▋        | 164/971 [00:03<00:13, 57.77it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:13, 58.20it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 55.12it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:13, 57.35it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:14, 55.31it/s]backtest loop:  20%|██        | 196/971 [00:03<00:13, 56.52it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 57.37it/s]backtest loop:  22%|██▏       | 209/971 [00:03<00:12, 59.10it/s]backtest loop:  22%|██▏       | 215/971 [00:04<00:14, 53.02it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:13, 55.62it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:12, 57.73it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:13, 55.07it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:12, 57.13it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:13, 55.51it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:12, 57.71it/s]backtest loop:  27%|██▋       | 263/971 [00:04<00:11, 59.11it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:12, 56.12it/s]backtest loop:  28%|██▊       | 275/971 [00:05<00:12, 57.14it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:12, 54.29it/s]backtest loop:  30%|██▉       | 287/971 [00:05<00:12, 55.46it/s]backtest loop:  30%|███       | 293/971 [00:05<00:11, 56.59it/s]backtest loop:  31%|███       | 299/971 [00:05<00:11, 57.48it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:12, 54.49it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 56.94it/s]backtest loop:  33%|███▎      | 319/971 [00:05<00:11, 58.66it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:11, 55.88it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:11, 57.68it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 59.05it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 55.90it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 57.77it/s]backtest loop:  37%|███▋      | 358/971 [00:06<00:10, 58.35it/s]backtest loop:  37%|███▋      | 364/971 [00:06<00:10, 55.31it/s]backtest loop:  38%|███▊      | 370/971 [00:06<00:11, 53.43it/s]backtest loop:  39%|███▊      | 376/971 [00:06<00:10, 55.07it/s]backtest loop:  39%|███▉      | 382/971 [00:07<00:10, 56.36it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:10, 54.05it/s]backtest loop:  41%|████      | 394/971 [00:07<00:10, 55.38it/s]backtest loop:  41%|████      | 400/971 [00:07<00:10, 56.51it/s]backtest loop:  42%|████▏     | 406/971 [00:07<00:09, 57.23it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:09, 57.95it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:10, 54.92it/s]backtest loop:  44%|████▎     | 424/971 [00:07<00:09, 56.09it/s]backtest loop:  44%|████▍     | 430/971 [00:07<00:09, 56.97it/s]backtest loop:  45%|████▍     | 436/971 [00:07<00:09, 57.56it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:09, 54.63it/s]backtest loop:  46%|████▌     | 448/971 [00:08<00:09, 56.03it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:09, 57.09it/s]backtest loop:  47%|████▋     | 460/971 [00:08<00:08, 57.75it/s]backtest loop:  48%|████▊     | 466/971 [00:08<00:08, 58.17it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:09, 54.99it/s]backtest loop:  49%|████▉     | 478/971 [00:08<00:08, 56.31it/s]backtest loop:  50%|████▉     | 484/971 [00:09<00:14, 34.46it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:12, 37.80it/s]backtest loop:  51%|█████     | 496/971 [00:09<00:11, 42.45it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:10, 46.45it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:09, 47.27it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:09, 50.16it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:08, 53.61it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:08, 51.79it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:08, 53.91it/s]backtest loop:  56%|█████▌    | 540/971 [00:10<00:07, 56.51it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 53.96it/s]backtest loop:  57%|█████▋    | 552/971 [00:10<00:07, 55.54it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 56.68it/s]backtest loop:  58%|█████▊    | 564/971 [00:10<00:07, 57.51it/s]backtest loop:  59%|█████▊    | 570/971 [00:10<00:06, 58.14it/s]backtest loop:  59%|█████▉    | 576/971 [00:10<00:07, 55.26it/s]backtest loop:  60%|█████▉    | 582/971 [00:10<00:06, 56.49it/s]backtest loop:  61%|██████    | 589/971 [00:10<00:06, 58.21it/s]backtest loop:  61%|██████▏   | 595/971 [00:11<00:06, 58.59it/s]backtest loop:  62%|██████▏   | 601/971 [00:11<00:06, 55.47it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 56.68it/s]backtest loop:  63%|██████▎   | 614/971 [00:11<00:06, 58.35it/s]backtest loop:  64%|██████▍   | 620/971 [00:11<00:06, 55.72it/s]backtest loop:  65%|██████▍   | 627/971 [00:11<00:05, 58.01it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:05, 59.41it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:05, 56.39it/s]backtest loop:  67%|██████▋   | 647/971 [00:11<00:05, 58.06it/s]backtest loop:  67%|██████▋   | 653/971 [00:12<00:05, 58.56it/s]backtest loop:  68%|██████▊   | 660/971 [00:12<00:05, 56.25it/s]backtest loop:  69%|██████▊   | 666/971 [00:12<00:05, 57.23it/s]backtest loop:  69%|██████▉   | 672/971 [00:12<00:05, 57.87it/s]backtest loop:  70%|██████▉   | 678/971 [00:12<00:05, 58.43it/s]backtest loop:  70%|███████   | 684/971 [00:12<00:05, 55.01it/s]backtest loop:  71%|███████   | 690/971 [00:12<00:04, 56.36it/s]backtest loop:  72%|███████▏  | 696/971 [00:12<00:04, 57.33it/s]backtest loop:  72%|███████▏  | 702/971 [00:12<00:04, 57.82it/s]backtest loop:  73%|███████▎  | 709/971 [00:13<00:04, 55.79it/s]backtest loop:  74%|███████▎  | 716/971 [00:13<00:04, 57.68it/s]backtest loop:  74%|███████▍  | 722/971 [00:13<00:04, 57.88it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 58.41it/s]backtest loop:  76%|███████▌  | 734/971 [00:13<00:04, 52.38it/s]backtest loop:  76%|███████▌  | 740/971 [00:13<00:04, 54.17it/s]backtest loop:  77%|███████▋  | 746/971 [00:13<00:04, 55.74it/s]backtest loop:  77%|███████▋  | 752/971 [00:13<00:04, 53.24it/s]backtest loop:  78%|███████▊  | 758/971 [00:13<00:03, 54.80it/s]backtest loop:  79%|███████▊  | 764/971 [00:14<00:03, 56.21it/s]backtest loop:  79%|███████▉  | 770/971 [00:14<00:03, 53.64it/s]backtest loop:  80%|███████▉  | 776/971 [00:14<00:03, 55.36it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 56.59it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 53.98it/s]backtest loop:  82%|████████▏ | 794/971 [00:14<00:03, 55.43it/s]backtest loop:  82%|████████▏ | 800/971 [00:14<00:03, 56.59it/s]backtest loop:  83%|████████▎ | 806/971 [00:14<00:02, 57.22it/s]backtest loop:  84%|████████▎ | 812/971 [00:14<00:02, 57.79it/s]backtest loop:  84%|████████▍ | 818/971 [00:14<00:02, 54.79it/s]backtest loop:  85%|████████▍ | 824/971 [00:15<00:02, 56.07it/s]backtest loop:  85%|████████▌ | 830/971 [00:15<00:02, 57.07it/s]backtest loop:  86%|████████▌ | 836/971 [00:15<00:02, 57.88it/s]backtest loop:  87%|████████▋ | 842/971 [00:15<00:02, 58.41it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 55.25it/s]backtest loop:  88%|████████▊ | 854/971 [00:15<00:02, 56.56it/s]backtest loop:  89%|████████▊ | 860/971 [00:15<00:01, 57.48it/s]backtest loop:  89%|████████▉ | 867/971 [00:15<00:01, 55.57it/s]backtest loop:  90%|████████▉ | 873/971 [00:15<00:01, 56.69it/s]backtest loop:  91%|█████████ | 879/971 [00:16<00:01, 57.52it/s]backtest loop:  91%|█████████ | 886/971 [00:16<00:01, 58.97it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 55.72it/s]backtest loop:  92%|█████████▏| 898/971 [00:16<00:01, 56.59it/s]backtest loop:  93%|█████████▎| 904/971 [00:16<00:01, 57.51it/s]backtest loop:  94%|█████████▎| 910/971 [00:16<00:01, 58.20it/s]backtest loop:  94%|█████████▍| 916/971 [00:16<00:01, 54.77it/s]backtest loop:  95%|█████████▍| 922/971 [00:16<00:00, 56.13it/s]backtest loop:  96%|█████████▌| 929/971 [00:16<00:00, 58.02it/s]backtest loop:  96%|█████████▋| 935/971 [00:17<00:00, 58.32it/s]backtest loop:  97%|█████████▋| 941/971 [00:17<00:00, 55.28it/s]backtest loop:  98%|█████████▊| 948/971 [00:17<00:00, 57.42it/s]backtest loop:  98%|█████████▊| 954/971 [00:17<00:00, 58.12it/s]backtest loop:  99%|█████████▉| 960/971 [00:17<00:00, 55.00it/s]backtest loop:  99%|█████████▉| 966/971 [00:17<00:00, 56.35it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.94it/s]
[3553693:MainThread](2024-04-26 06:23:00,488) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000559
std                0.006266
annualized_return  0.132957
information_ratio  1.375441
max_drawdown      -0.097422
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000362
std                0.006267
annualized_return  0.086089
information_ratio  0.890457
max_drawdown      -0.130011
[3553693:MainThread](2024-04-26 06:23:00,504) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_Localformer_alpha360_horizon1_step20_rankFalse_2024-04-26_03:34:20_online`.
Round 4 Done!
{'1day.excess_return_with_cost.annualized_return': [0.07075714264527615,
                                                    0.10850427937124411,
                                                    0.06685286326248528,
                                                    0.08608948157805843],
 '1day.excess_return_with_cost.information_ratio': [0.7604996387958325,
                                                    1.2020537825981399,
                                                    0.7125046093662444,
                                                    0.8904572108774373],
 '1day.excess_return_with_cost.max_drawdown': [-0.14329134900291735,
                                               -0.12316472001361661,
                                               -0.1646927914298363,
                                               -0.13001096080026223],
 'IC': [0.023486286189309008,
        0.02791365222447451,
        0.02441311490294145,
        0.023209719834113737],
 'ICIR': [0.17230008880149675,
          0.19858094896927955,
          0.17400805891726157,
          0.16495475959030012],
 'Rank IC': [0.01784804193762672,
             0.025047469820677314,
             0.017413522190489108,
             0.016932903948649526],
 'Rank ICIR': [0.12653690606414603,
               0.1780858675400394,
               0.12095496861110042,
               0.1191049590209752],
 'mae': [0.7075116038322449,
         0.707405149936676,
         0.7074940800666809,
         0.707470715045929],
 'mse': [0.9960588812828064,
         0.9957895874977112,
         0.9961219429969788,
         0.9960362911224365]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3553693:MainThread](2024-04-26 06:23:01,684) INFO - qlib.TransformerModel - [pytorch_localformer.py:64] - Naive Transformer:
batch_size : 2048
device : cuda:0
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:52<1:27:14, 52.87s/it]epoch:   2%|▏         | 2/100 [01:46<1:26:41, 53.08s/it]epoch:   3%|▎         | 3/100 [02:39<1:25:49, 53.08s/it]epoch:   4%|▍         | 4/100 [03:32<1:24:55, 53.08s/it]epoch:   5%|▌         | 5/100 [04:25<1:24:03, 53.09s/it]epoch:   6%|▌         | 6/100 [05:18<1:23:18, 53.17s/it]epoch:   7%|▋         | 7/100 [06:12<1:22:28, 53.21s/it]epoch:   8%|▊         | 8/100 [07:05<1:21:29, 53.15s/it]epoch:   9%|▉         | 9/100 [07:58<1:20:39, 53.18s/it]epoch:  10%|█         | 10/100 [08:51<1:19:41, 53.13s/it]epoch:  11%|█         | 11/100 [09:44<1:18:52, 53.17s/it]epoch:  12%|█▏        | 12/100 [10:37<1:17:57, 53.15s/it]epoch:  13%|█▎        | 13/100 [11:30<1:17:07, 53.19s/it]epoch:  14%|█▍        | 14/100 [12:24<1:16:20, 53.27s/it]epoch:  15%|█▌        | 15/100 [13:17<1:15:19, 53.17s/it]epoch:  16%|█▌        | 16/100 [14:10<1:14:21, 53.12s/it]epoch:  17%|█▋        | 17/100 [15:03<1:13:30, 53.14s/it]epoch:  18%|█▊        | 18/100 [15:56<1:12:30, 53.05s/it]epoch:  19%|█▉        | 19/100 [16:49<1:11:34, 53.01s/it]epoch:  20%|██        | 20/100 [17:42<1:10:45, 53.07s/it]epoch:  21%|██        | 21/100 [18:35<1:09:52, 53.07s/it]epoch:  22%|██▏       | 22/100 [19:28<1:09:02, 53.10s/it]epoch:  23%|██▎       | 23/100 [20:21<1:08:04, 53.04s/it]epoch:  24%|██▍       | 24/100 [21:14<1:07:13, 53.07s/it]epoch:  25%|██▌       | 25/100 [22:08<1:06:28, 53.18s/it]epoch:  26%|██▌       | 26/100 [23:01<1:05:43, 53.29s/it]epoch:  27%|██▋       | 27/100 [23:55<1:04:49, 53.28s/it]epoch:  28%|██▊       | 28/100 [24:48<1:03:59, 53.33s/it]epoch:  29%|██▉       | 29/100 [25:41<1:02:58, 53.22s/it]epoch:  30%|███       | 30/100 [26:34<1:02:01, 53.16s/it]0.04724415911466402
best ic: 0.04724415911466402
epoch:  31%|███       | 31/100 [27:34<1:03:21, 55.10s/it]0.049265953227448096
best ic: 0.049265953227448096
epoch:  32%|███▏      | 32/100 [28:33<1:03:51, 56.35s/it]0.05280250014224078
best ic: 0.05280250014224078
epoch:  33%|███▎      | 33/100 [29:32<1:03:59, 57.30s/it]0.03644998924426076
epoch:  34%|███▍      | 34/100 [30:32<1:03:41, 57.90s/it]0.04828771646418747
epoch:  35%|███▌      | 35/100 [31:31<1:03:08, 58.28s/it]0.049161546739105916
epoch:  36%|███▌      | 36/100 [32:30<1:02:29, 58.59s/it]0.04487731930220137
epoch:  37%|███▋      | 37/100 [33:29<1:01:41, 58.76s/it]0.048280411801711526
epoch:  38%|███▊      | 38/100 [34:29<1:00:55, 58.96s/it]0.04739012402944197
epoch:  39%|███▉      | 39/100 [35:28<1:00:05, 59.11s/it]0.047106435164776375
epoch:  40%|████      | 40/100 [36:27<59:10, 59.17s/it]  0.051026750491565256
epoch:  40%|████      | 40/100 [37:27<56:10, 56.18s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3553693:MainThread](2024-04-26 07:00:28,850) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3553693:MainThread](2024-04-26 07:00:28,864) INFO - qlib.workflow - [recorder.py:341] - Recorder 586c83eb9813467b97b7c0313ffd1195 starts running under Experiment 53 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:20,  3.06it/s]online:   3%|▎         | 2/63 [00:00<00:22,  2.69it/s]online:   5%|▍         | 3/63 [00:01<00:23,  2.56it/s]online:   6%|▋         | 4/63 [00:01<00:23,  2.52it/s]online:   8%|▊         | 5/63 [00:01<00:23,  2.49it/s]online:  10%|▉         | 6/63 [00:02<00:23,  2.48it/s]online:  11%|█         | 7/63 [00:02<00:22,  2.46it/s]online:  13%|█▎        | 8/63 [00:03<00:22,  2.46it/s]online:  14%|█▍        | 9/63 [00:03<00:22,  2.45it/s]online:  16%|█▌        | 10/63 [00:04<00:21,  2.45it/s]online:  17%|█▋        | 11/63 [00:04<00:21,  2.46it/s]online:  19%|█▉        | 12/63 [00:04<00:20,  2.45it/s]online:  21%|██        | 13/63 [00:05<00:20,  2.45it/s]online:  22%|██▏       | 14/63 [00:05<00:20,  2.44it/s]online:  24%|██▍       | 15/63 [00:06<00:19,  2.44it/s]online:  25%|██▌       | 16/63 [00:06<00:19,  2.45it/s]online:  27%|██▋       | 17/63 [00:06<00:18,  2.44it/s]online:  29%|██▊       | 18/63 [00:07<00:18,  2.44it/s]online:  30%|███       | 19/63 [00:07<00:18,  2.44it/s]online:  32%|███▏      | 20/63 [00:08<00:17,  2.44it/s]online:  33%|███▎      | 21/63 [00:08<00:17,  2.43it/s]online:  35%|███▍      | 22/63 [00:08<00:16,  2.43it/s]online:  37%|███▋      | 23/63 [00:09<00:16,  2.43it/s]online:  38%|███▊      | 24/63 [00:09<00:15,  2.44it/s]online:  40%|███▉      | 25/63 [00:10<00:15,  2.43it/s]online:  41%|████▏     | 26/63 [00:10<00:15,  2.43it/s]online:  43%|████▎     | 27/63 [00:10<00:14,  2.43it/s]online:  44%|████▍     | 28/63 [00:11<00:14,  2.43it/s]online:  46%|████▌     | 29/63 [00:11<00:14,  2.43it/s]online:  48%|████▊     | 30/63 [00:12<00:13,  2.43it/s]online:  49%|████▉     | 31/63 [00:12<00:13,  2.44it/s]online:  51%|█████     | 32/63 [00:13<00:12,  2.43it/s]online:  52%|█████▏    | 33/63 [00:13<00:12,  2.44it/s]online:  54%|█████▍    | 34/63 [00:13<00:11,  2.43it/s]online:  56%|█████▌    | 35/63 [00:14<00:11,  2.43it/s]online:  57%|█████▋    | 36/63 [00:14<00:11,  2.43it/s]online:  59%|█████▊    | 37/63 [00:15<00:10,  2.43it/s]online:  60%|██████    | 38/63 [00:15<00:10,  2.43it/s]online:  62%|██████▏   | 39/63 [00:15<00:09,  2.43it/s]online:  63%|██████▎   | 40/63 [00:16<00:09,  2.43it/s]online:  65%|██████▌   | 41/63 [00:16<00:09,  2.43it/s]online:  67%|██████▋   | 42/63 [00:17<00:08,  2.43it/s]online:  68%|██████▊   | 43/63 [00:17<00:08,  2.44it/s]online:  70%|██████▉   | 44/63 [00:17<00:07,  2.44it/s]online:  71%|███████▏  | 45/63 [00:18<00:07,  2.43it/s]online:  73%|███████▎  | 46/63 [00:18<00:07,  2.42it/s]online:  75%|███████▍  | 47/63 [00:19<00:06,  2.43it/s]online:  76%|███████▌  | 48/63 [00:19<00:06,  2.43it/s]online:  78%|███████▊  | 49/63 [00:20<00:05,  2.43it/s]online:  79%|███████▉  | 50/63 [00:20<00:05,  2.43it/s]online:  81%|████████  | 51/63 [00:20<00:04,  2.43it/s]online:  83%|████████▎ | 52/63 [00:21<00:04,  2.43it/s]online:  84%|████████▍ | 53/63 [00:21<00:04,  2.43it/s]online:  86%|████████▌ | 54/63 [00:22<00:03,  2.42it/s]online:  87%|████████▋ | 55/63 [00:22<00:03,  2.43it/s]online:  89%|████████▉ | 56/63 [00:22<00:02,  2.42it/s]online:  90%|█████████ | 57/63 [00:23<00:02,  2.43it/s]online:  92%|█████████▏| 58/63 [00:23<00:02,  2.43it/s]online:  94%|█████████▎| 59/63 [00:24<00:01,  2.42it/s]online:  95%|█████████▌| 60/63 [00:24<00:01,  2.42it/s]online:  97%|█████████▋| 61/63 [00:24<00:00,  2.43it/s]online:  98%|█████████▊| 62/63 [00:25<00:00,  2.43it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.51it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.45it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3553693:MainThread](2024-04-26 07:01:03,216) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99592644 mae 0.7074753
{'IC': 0.02556309432113134,
 'ICIR': 0.1764065044712292,
 'Rank IC': 0.021804135075245198,
 'Rank ICIR': 0.15427744155570366}
[3553693:MainThread](2024-04-26 07:01:04,971) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3553693:MainThread](2024-04-26 07:01:16,439) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 07:01:16,442) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 07:01:22,622) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fd6524abe80>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:45,  9.19it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 23.71it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 33.19it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:25, 37.43it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:22, 42.29it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 45.72it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 45.39it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:19, 47.98it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 49.80it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:19, 48.05it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:18, 50.17it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 51.52it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:17, 52.71it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 53.13it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 50.50it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:16, 51.74it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 52.73it/s]backtest loop:  11%|█         | 105/971 [00:02<00:16, 53.41it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:16, 53.60it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 50.28it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 51.43it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:17, 49.04it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:16, 50.62it/s]backtest loop:  15%|█▍        | 141/971 [00:03<00:17, 48.66it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:16, 50.35it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 51.33it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 52.29it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:15, 53.02it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 50.38it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:15, 51.61it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:14, 52.88it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:14, 53.27it/s]backtest loop:  20%|██        | 195/971 [00:04<00:15, 50.09it/s]backtest loop:  21%|██        | 201/971 [00:04<00:14, 51.35it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:14, 52.33it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:15, 49.93it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:14, 51.20it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:15, 49.15it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:14, 50.61it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:14, 51.73it/s]backtest loop:  25%|██▌       | 243/971 [00:04<00:13, 52.55it/s]backtest loop:  26%|██▌       | 249/971 [00:05<00:14, 50.05it/s]backtest loop:  26%|██▋       | 255/971 [00:05<00:13, 51.28it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:13, 52.34it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:14, 49.88it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:13, 51.20it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:13, 52.29it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:12, 52.80it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:13, 50.18it/s]backtest loop:  31%|███       | 297/971 [00:06<00:13, 51.25it/s]backtest loop:  31%|███       | 303/971 [00:06<00:12, 52.19it/s]backtest loop:  32%|███▏      | 309/971 [00:06<00:12, 52.45it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:13, 49.94it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:12, 51.18it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:12, 52.29it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:12, 53.01it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:11, 53.53it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:12, 50.37it/s]backtest loop:  36%|███▌      | 351/971 [00:07<00:11, 51.87it/s]backtest loop:  37%|███▋      | 357/971 [00:07<00:11, 52.57it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:12, 50.09it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:12, 48.25it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 49.94it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:11, 51.07it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:11, 52.14it/s]backtest loop:  40%|████      | 393/971 [00:07<00:11, 49.55it/s]backtest loop:  41%|████      | 399/971 [00:08<00:11, 50.99it/s]backtest loop:  42%|████▏     | 405/971 [00:08<00:10, 51.85it/s]backtest loop:  42%|████▏     | 411/971 [00:08<00:10, 52.63it/s]backtest loop:  43%|████▎     | 417/971 [00:08<00:16, 32.99it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:15, 35.71it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:13, 39.83it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:12, 43.16it/s]backtest loop:  45%|████▌     | 441/971 [00:09<00:11, 46.02it/s]backtest loop:  46%|████▌     | 447/971 [00:09<00:11, 45.54it/s]backtest loop:  47%|████▋     | 453/971 [00:09<00:10, 47.97it/s]backtest loop:  47%|████▋     | 459/971 [00:09<00:10, 49.72it/s]backtest loop:  48%|████▊     | 465/971 [00:09<00:09, 51.06it/s]backtest loop:  49%|████▊     | 471/971 [00:09<00:09, 51.97it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 49.53it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:09, 50.80it/s]backtest loop:  50%|█████     | 489/971 [00:10<00:09, 51.68it/s]backtest loop:  51%|█████     | 495/971 [00:10<00:09, 49.18it/s]backtest loop:  52%|█████▏    | 501/971 [00:10<00:09, 50.68it/s]backtest loop:  52%|█████▏    | 507/971 [00:10<00:09, 48.91it/s]backtest loop:  53%|█████▎    | 513/971 [00:10<00:09, 50.61it/s]backtest loop:  53%|█████▎    | 519/971 [00:10<00:08, 51.60it/s]backtest loop:  54%|█████▍    | 525/971 [00:10<00:08, 52.29it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:08, 49.32it/s]backtest loop:  55%|█████▌    | 537/971 [00:10<00:08, 50.74it/s]backtest loop:  56%|█████▌    | 543/971 [00:11<00:08, 51.21it/s]backtest loop:  57%|█████▋    | 549/971 [00:11<00:08, 51.99it/s]backtest loop:  57%|█████▋    | 555/971 [00:11<00:07, 52.48it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:08, 49.79it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:07, 51.03it/s]backtest loop:  59%|█████▉    | 573/971 [00:11<00:07, 51.87it/s]backtest loop:  60%|█████▉    | 579/971 [00:11<00:07, 52.51it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:07, 52.85it/s]backtest loop:  61%|██████    | 591/971 [00:12<00:07, 50.18it/s]backtest loop:  61%|██████▏   | 597/971 [00:12<00:07, 51.42it/s]backtest loop:  62%|██████▏   | 603/971 [00:12<00:07, 52.41it/s]backtest loop:  63%|██████▎   | 609/971 [00:12<00:06, 53.00it/s]backtest loop:  63%|██████▎   | 615/971 [00:12<00:07, 50.04it/s]backtest loop:  64%|██████▍   | 621/971 [00:12<00:06, 51.25it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:06, 52.18it/s]backtest loop:  65%|██████▌   | 633/971 [00:12<00:06, 52.88it/s]backtest loop:  66%|██████▌   | 639/971 [00:12<00:06, 53.54it/s]backtest loop:  66%|██████▋   | 645/971 [00:13<00:06, 50.61it/s]backtest loop:  67%|██████▋   | 651/971 [00:13<00:06, 51.71it/s]backtest loop:  68%|██████▊   | 657/971 [00:13<00:05, 52.53it/s]backtest loop:  68%|██████▊   | 663/971 [00:13<00:05, 53.01it/s]backtest loop:  69%|██████▉   | 669/971 [00:13<00:05, 53.48it/s]backtest loop:  70%|██████▉   | 675/971 [00:13<00:05, 50.44it/s]backtest loop:  70%|███████   | 681/971 [00:13<00:05, 51.58it/s]backtest loop:  71%|███████   | 687/971 [00:13<00:05, 52.23it/s]backtest loop:  71%|███████▏  | 693/971 [00:13<00:05, 52.73it/s]backtest loop:  72%|███████▏  | 699/971 [00:14<00:05, 50.01it/s]backtest loop:  73%|███████▎  | 705/971 [00:14<00:05, 51.05it/s]backtest loop:  73%|███████▎  | 711/971 [00:14<00:04, 52.03it/s]backtest loop:  74%|███████▍  | 717/971 [00:14<00:04, 52.81it/s]backtest loop:  74%|███████▍  | 723/971 [00:14<00:04, 53.27it/s]backtest loop:  75%|███████▌  | 729/971 [00:14<00:04, 50.38it/s]backtest loop:  76%|███████▌  | 735/971 [00:14<00:04, 48.47it/s]backtest loop:  76%|███████▋  | 741/971 [00:14<00:04, 49.98it/s]backtest loop:  77%|███████▋  | 747/971 [00:15<00:04, 51.23it/s]backtest loop:  78%|███████▊  | 753/971 [00:15<00:04, 48.98it/s]backtest loop:  78%|███████▊  | 759/971 [00:15<00:04, 50.47it/s]backtest loop:  79%|███████▉  | 765/971 [00:15<00:04, 48.39it/s]backtest loop:  79%|███████▉  | 771/971 [00:15<00:04, 49.96it/s]backtest loop:  80%|████████  | 777/971 [00:15<00:03, 51.34it/s]backtest loop:  81%|████████  | 783/971 [00:15<00:03, 49.23it/s]backtest loop:  81%|████████▏ | 789/971 [00:15<00:03, 50.65it/s]backtest loop:  82%|████████▏ | 795/971 [00:15<00:03, 51.57it/s]backtest loop:  82%|████████▏ | 801/971 [00:16<00:03, 52.35it/s]backtest loop:  83%|████████▎ | 807/971 [00:16<00:03, 52.84it/s]backtest loop:  84%|████████▎ | 813/971 [00:16<00:03, 50.05it/s]backtest loop:  84%|████████▍ | 819/971 [00:16<00:02, 51.29it/s]backtest loop:  85%|████████▍ | 825/971 [00:16<00:02, 52.06it/s]backtest loop:  86%|████████▌ | 831/971 [00:16<00:02, 52.77it/s]backtest loop:  86%|████████▌ | 837/971 [00:16<00:02, 53.10it/s]backtest loop:  87%|████████▋ | 843/971 [00:16<00:02, 50.19it/s]backtest loop:  87%|████████▋ | 849/971 [00:17<00:02, 51.42it/s]backtest loop:  88%|████████▊ | 855/971 [00:17<00:02, 51.72it/s]backtest loop:  89%|████████▊ | 861/971 [00:17<00:02, 52.49it/s]backtest loop:  89%|████████▉ | 867/971 [00:17<00:02, 49.71it/s]backtest loop:  90%|████████▉ | 873/971 [00:17<00:01, 50.98it/s]backtest loop:  91%|█████████ | 879/971 [00:17<00:01, 51.95it/s]backtest loop:  91%|█████████ | 885/971 [00:17<00:01, 52.74it/s]backtest loop:  92%|█████████▏| 891/971 [00:17<00:01, 53.16it/s]backtest loop:  92%|█████████▏| 897/971 [00:17<00:01, 50.31it/s]backtest loop:  93%|█████████▎| 903/971 [00:18<00:01, 51.25it/s]backtest loop:  94%|█████████▎| 909/971 [00:18<00:01, 52.17it/s]backtest loop:  94%|█████████▍| 915/971 [00:18<00:01, 52.82it/s]backtest loop:  95%|█████████▍| 921/971 [00:18<00:01, 49.99it/s]backtest loop:  95%|█████████▌| 927/971 [00:18<00:00, 51.38it/s]backtest loop:  96%|█████████▌| 933/971 [00:18<00:00, 52.15it/s]backtest loop:  97%|█████████▋| 939/971 [00:18<00:00, 52.73it/s]backtest loop:  97%|█████████▋| 945/971 [00:18<00:00, 49.95it/s]backtest loop:  98%|█████████▊| 951/971 [00:19<00:00, 51.32it/s]backtest loop:  99%|█████████▊| 957/971 [00:19<00:00, 52.06it/s]backtest loop:  99%|█████████▉| 963/971 [00:19<00:00, 52.74it/s]backtest loop: 100%|█████████▉| 969/971 [00:19<00:00, 53.26it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 50.06it/s]
[3553693:MainThread](2024-04-26 07:01:42,093) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000521
std                0.005718
annualized_return  0.123957
information_ratio  1.405129
max_drawdown      -0.086828
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000323
std                0.005718
annualized_return  0.076829
information_ratio  0.870890
max_drawdown      -0.118198
[3553693:MainThread](2024-04-26 07:01:42,109) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_Localformer_alpha360_horizon1_step20_rankFalse_2024-04-26_03:34:20_online`.
Round 5 Done!
{'1day.excess_return_with_cost.annualized_return': [0.07075714264527615,
                                                    0.10850427937124411,
                                                    0.06685286326248528,
                                                    0.08608948157805843,
                                                    0.07682903517339368],
 '1day.excess_return_with_cost.information_ratio': [0.7604996387958325,
                                                    1.2020537825981399,
                                                    0.7125046093662444,
                                                    0.8904572108774373,
                                                    0.8708896268691235],
 '1day.excess_return_with_cost.max_drawdown': [-0.14329134900291735,
                                               -0.12316472001361661,
                                               -0.1646927914298363,
                                               -0.13001096080026223,
                                               -0.11819781308791061],
 'IC': [0.023486286189309008,
        0.02791365222447451,
        0.02441311490294145,
        0.023209719834113737,
        0.02556309432113134],
 'ICIR': [0.17230008880149675,
          0.19858094896927955,
          0.17400805891726157,
          0.16495475959030012,
          0.1764065044712292],
 'Rank IC': [0.01784804193762672,
             0.025047469820677314,
             0.017413522190489108,
             0.016932903948649526,
             0.021804135075245198],
 'Rank ICIR': [0.12653690606414603,
               0.1780858675400394,
               0.12095496861110042,
               0.1191049590209752,
               0.15427744155570366],
 'mae': [0.7075116038322449,
         0.707405149936676,
         0.7074940800666809,
         0.707470715045929,
         0.7074753046035767],
 'mse': [0.9960588812828064,
         0.9957895874977112,
         0.9961219429969788,
         0.9960362911224365,
         0.9959264397621155]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3553693:MainThread](2024-04-26 07:01:43,286) INFO - qlib.TransformerModel - [pytorch_localformer.py:64] - Naive Transformer:
batch_size : 2048
device : cuda:0
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:53<1:27:30, 53.04s/it]epoch:   2%|▏         | 2/100 [01:46<1:26:56, 53.23s/it]epoch:   3%|▎         | 3/100 [02:39<1:26:13, 53.34s/it]epoch:   4%|▍         | 4/100 [03:33<1:25:15, 53.28s/it]epoch:   5%|▌         | 5/100 [04:26<1:24:25, 53.32s/it]epoch:   6%|▌         | 6/100 [05:19<1:23:26, 53.26s/it]epoch:   7%|▋         | 7/100 [06:12<1:22:29, 53.22s/it]epoch:   8%|▊         | 8/100 [07:05<1:21:35, 53.21s/it]epoch:   9%|▉         | 9/100 [07:59<1:20:44, 53.24s/it]epoch:  10%|█         | 10/100 [08:52<1:19:49, 53.22s/it]epoch:  11%|█         | 11/100 [09:45<1:19:03, 53.30s/it]epoch:  12%|█▏        | 12/100 [10:39<1:18:15, 53.36s/it]epoch:  13%|█▎        | 13/100 [11:32<1:17:14, 53.27s/it]epoch:  14%|█▍        | 14/100 [12:25<1:16:15, 53.20s/it]epoch:  15%|█▌        | 15/100 [13:18<1:15:20, 53.18s/it]epoch:  16%|█▌        | 16/100 [14:11<1:14:22, 53.13s/it]epoch:  17%|█▋        | 17/100 [15:04<1:13:34, 53.19s/it]epoch:  18%|█▊        | 18/100 [15:58<1:12:39, 53.16s/it]epoch:  19%|█▉        | 19/100 [16:51<1:11:41, 53.11s/it]epoch:  20%|██        | 20/100 [17:44<1:10:52, 53.16s/it]epoch:  21%|██        | 21/100 [18:37<1:09:54, 53.09s/it]epoch:  22%|██▏       | 22/100 [19:30<1:09:01, 53.09s/it]epoch:  23%|██▎       | 23/100 [20:23<1:08:07, 53.08s/it]epoch:  24%|██▍       | 24/100 [21:16<1:07:10, 53.03s/it]epoch:  25%|██▌       | 25/100 [22:09<1:06:19, 53.06s/it]epoch:  26%|██▌       | 26/100 [23:02<1:05:26, 53.06s/it]epoch:  27%|██▋       | 27/100 [23:55<1:04:29, 53.01s/it]epoch:  28%|██▊       | 28/100 [24:48<1:03:36, 53.01s/it]epoch:  29%|██▉       | 29/100 [25:41<1:02:43, 53.01s/it]epoch:  30%|███       | 30/100 [26:34<1:01:48, 52.97s/it]0.051616167509908
best ic: 0.051616167509908
epoch:  31%|███       | 31/100 [27:33<1:03:09, 54.92s/it]0.05677769054034819
best ic: 0.05677769054034819
epoch:  32%|███▏      | 32/100 [28:33<1:03:47, 56.28s/it]0.05177160060306827
epoch:  33%|███▎      | 33/100 [29:32<1:03:56, 57.26s/it]0.05054587442902075
epoch:  34%|███▍      | 34/100 [30:32<1:03:40, 57.88s/it]0.05113206916794573
epoch:  35%|███▌      | 35/100 [31:31<1:03:08, 58.28s/it]0.05023825533826471
epoch:  36%|███▌      | 36/100 [32:30<1:02:27, 58.55s/it]0.05621628138524841
epoch:  37%|███▋      | 37/100 [33:29<1:01:39, 58.73s/it]0.05075514211206482
epoch:  38%|███▊      | 38/100 [34:29<1:00:53, 58.93s/it]0.04462286832527365
epoch:  39%|███▉      | 39/100 [35:28<1:00:02, 59.06s/it]0.05268232365270131
epoch:  39%|███▉      | 39/100 [36:28<57:02, 56.10s/it]  
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3553693:MainThread](2024-04-26 07:38:11,388) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3553693:MainThread](2024-04-26 07:38:11,401) INFO - qlib.workflow - [recorder.py:341] - Recorder 4c250cd129464b548091e27063fe3964 starts running under Experiment 53 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:20,  3.04it/s]online:   3%|▎         | 2/63 [00:00<00:23,  2.64it/s]online:   5%|▍         | 3/63 [00:01<00:23,  2.54it/s]online:   6%|▋         | 4/63 [00:01<00:23,  2.49it/s]online:   8%|▊         | 5/63 [00:01<00:23,  2.48it/s]online:  10%|▉         | 6/63 [00:02<00:23,  2.46it/s]online:  11%|█         | 7/63 [00:02<00:22,  2.46it/s]online:  13%|█▎        | 8/63 [00:03<00:22,  2.45it/s]online:  14%|█▍        | 9/63 [00:03<00:22,  2.44it/s]online:  16%|█▌        | 10/63 [00:04<00:21,  2.43it/s]online:  17%|█▋        | 11/63 [00:04<00:21,  2.44it/s]online:  19%|█▉        | 12/63 [00:04<00:20,  2.43it/s]online:  21%|██        | 13/63 [00:05<00:20,  2.43it/s]online:  22%|██▏       | 14/63 [00:05<00:20,  2.43it/s]online:  24%|██▍       | 15/63 [00:06<00:19,  2.42it/s]online:  25%|██▌       | 16/63 [00:06<00:19,  2.42it/s]online:  27%|██▋       | 17/63 [00:06<00:18,  2.43it/s]online:  29%|██▊       | 18/63 [00:07<00:18,  2.42it/s]online:  30%|███       | 19/63 [00:07<00:18,  2.42it/s]online:  32%|███▏      | 20/63 [00:08<00:17,  2.43it/s]online:  33%|███▎      | 21/63 [00:08<00:17,  2.41it/s]online:  35%|███▍      | 22/63 [00:08<00:16,  2.42it/s]online:  37%|███▋      | 23/63 [00:09<00:16,  2.42it/s]online:  38%|███▊      | 24/63 [00:09<00:16,  2.42it/s]online:  40%|███▉      | 25/63 [00:10<00:15,  2.42it/s]online:  41%|████▏     | 26/63 [00:10<00:15,  2.42it/s]online:  43%|████▎     | 27/63 [00:11<00:14,  2.41it/s]online:  44%|████▍     | 28/63 [00:11<00:14,  2.42it/s]online:  46%|████▌     | 29/63 [00:11<00:14,  2.42it/s]online:  48%|████▊     | 30/63 [00:12<00:13,  2.42it/s]online:  49%|████▉     | 31/63 [00:12<00:13,  2.42it/s]online:  51%|█████     | 32/63 [00:13<00:12,  2.42it/s]online:  52%|█████▏    | 33/63 [00:13<00:12,  2.42it/s]online:  54%|█████▍    | 34/63 [00:13<00:12,  2.41it/s]online:  56%|█████▌    | 35/63 [00:14<00:11,  2.42it/s]online:  57%|█████▋    | 36/63 [00:14<00:11,  2.42it/s]online:  59%|█████▊    | 37/63 [00:15<00:10,  2.42it/s]online:  60%|██████    | 38/63 [00:15<00:10,  2.41it/s]online:  62%|██████▏   | 39/63 [00:16<00:09,  2.42it/s]online:  63%|██████▎   | 40/63 [00:16<00:09,  2.42it/s]online:  65%|██████▌   | 41/63 [00:16<00:09,  2.43it/s]online:  67%|██████▋   | 42/63 [00:17<00:08,  2.44it/s]online:  68%|██████▊   | 43/63 [00:17<00:08,  2.43it/s]online:  70%|██████▉   | 44/63 [00:18<00:07,  2.43it/s]online:  71%|███████▏  | 45/63 [00:18<00:07,  2.42it/s]online:  73%|███████▎  | 46/63 [00:18<00:07,  2.42it/s]online:  75%|███████▍  | 47/63 [00:19<00:06,  2.42it/s]online:  76%|███████▌  | 48/63 [00:19<00:06,  2.42it/s]online:  78%|███████▊  | 49/63 [00:20<00:05,  2.42it/s]online:  79%|███████▉  | 50/63 [00:20<00:05,  2.42it/s]online:  81%|████████  | 51/63 [00:20<00:04,  2.42it/s]online:  83%|████████▎ | 52/63 [00:21<00:04,  2.41it/s]online:  84%|████████▍ | 53/63 [00:21<00:04,  2.42it/s]online:  86%|████████▌ | 54/63 [00:22<00:03,  2.42it/s]online:  87%|████████▋ | 55/63 [00:22<00:03,  2.41it/s]online:  89%|████████▉ | 56/63 [00:23<00:02,  2.41it/s]online:  90%|█████████ | 57/63 [00:23<00:02,  2.41it/s]online:  92%|█████████▏| 58/63 [00:23<00:02,  2.41it/s]online:  94%|█████████▎| 59/63 [00:24<00:01,  2.41it/s]online:  95%|█████████▌| 60/63 [00:24<00:01,  2.41it/s]online:  97%|█████████▋| 61/63 [00:25<00:00,  2.41it/s]online:  98%|█████████▊| 62/63 [00:25<00:00,  2.42it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.51it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.43it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3553693:MainThread](2024-04-26 07:38:45,786) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99605453 mae 0.7074763
{'IC': 0.023518064772987516,
 'ICIR': 0.1635279171880803,
 'Rank IC': 0.01589400216650591,
 'Rank ICIR': 0.10779982689789028}
[3553693:MainThread](2024-04-26 07:38:47,545) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3553693:MainThread](2024-04-26 07:38:58,983) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 07:38:58,987) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 07:39:05,168) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fd64f844370>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:47,  9.05it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 23.61it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:28, 33.17it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:25, 37.07it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:22, 41.92it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:20, 45.49it/s]backtest loop:   4%|▍         | 39/971 [00:01<00:20, 45.08it/s]backtest loop:   5%|▍         | 45/971 [00:01<00:19, 47.65it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:18, 49.50it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:19, 47.75it/s]backtest loop:   6%|▋         | 63/971 [00:01<00:18, 49.67it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:17, 51.19it/s]backtest loop:   8%|▊         | 75/971 [00:01<00:17, 52.49it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:16, 53.06it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:17, 50.05it/s]backtest loop:  10%|▉         | 93/971 [00:02<00:17, 51.34it/s]backtest loop:  10%|█         | 99/971 [00:02<00:16, 52.31it/s]backtest loop:  11%|█         | 105/971 [00:02<00:16, 53.09it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:16, 53.53it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:16, 50.32it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:16, 51.60it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:17, 48.96it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:16, 50.18it/s]backtest loop:  15%|█▍        | 141/971 [00:03<00:17, 48.27it/s]backtest loop:  15%|█▌        | 147/971 [00:03<00:16, 49.92it/s]backtest loop:  16%|█▌        | 153/971 [00:03<00:15, 51.39it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:15, 52.28it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:15, 52.74it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:15, 50.09it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:15, 51.03it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:15, 52.16it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:14, 53.20it/s]backtest loop:  20%|██        | 195/971 [00:04<00:15, 50.21it/s]backtest loop:  21%|██        | 201/971 [00:04<00:14, 51.40it/s]backtest loop:  21%|██▏       | 207/971 [00:04<00:14, 52.01it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:15, 49.85it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:14, 51.30it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:15, 49.19it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:14, 50.52it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:14, 51.44it/s]backtest loop:  25%|██▌       | 243/971 [00:05<00:13, 52.47it/s]backtest loop:  26%|██▌       | 249/971 [00:05<00:14, 49.79it/s]backtest loop:  26%|██▋       | 255/971 [00:05<00:13, 51.21it/s]backtest loop:  27%|██▋       | 261/971 [00:05<00:13, 52.12it/s]backtest loop:  27%|██▋       | 267/971 [00:05<00:14, 49.37it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:13, 50.81it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:13, 51.99it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:13, 52.74it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:13, 49.74it/s]backtest loop:  31%|███       | 297/971 [00:06<00:13, 50.50it/s]backtest loop:  31%|███       | 303/971 [00:06<00:12, 51.62it/s]backtest loop:  32%|███▏      | 309/971 [00:06<00:12, 52.32it/s]backtest loop:  32%|███▏      | 315/971 [00:06<00:13, 49.77it/s]backtest loop:  33%|███▎      | 321/971 [00:06<00:12, 50.83it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:12, 51.95it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:12, 52.46it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:11, 53.15it/s]backtest loop:  36%|███▌      | 345/971 [00:07<00:12, 50.12it/s]backtest loop:  36%|███▌      | 351/971 [00:07<00:12, 51.48it/s]backtest loop:  37%|███▋      | 357/971 [00:07<00:11, 52.24it/s]backtest loop:  37%|███▋      | 363/971 [00:07<00:12, 49.86it/s]backtest loop:  38%|███▊      | 369/971 [00:07<00:12, 48.02it/s]backtest loop:  39%|███▊      | 375/971 [00:07<00:11, 50.11it/s]backtest loop:  39%|███▉      | 381/971 [00:07<00:11, 50.91it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:11, 51.83it/s]backtest loop:  40%|████      | 393/971 [00:07<00:11, 49.24it/s]backtest loop:  41%|████      | 399/971 [00:08<00:11, 50.54it/s]backtest loop:  42%|████▏     | 405/971 [00:08<00:10, 51.65it/s]backtest loop:  42%|████▏     | 411/971 [00:08<00:10, 52.26it/s]backtest loop:  43%|████▎     | 417/971 [00:08<00:10, 52.93it/s]backtest loop:  44%|████▎     | 423/971 [00:08<00:10, 49.95it/s]backtest loop:  44%|████▍     | 429/971 [00:08<00:10, 51.18it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:10, 51.90it/s]backtest loop:  45%|████▌     | 441/971 [00:08<00:10, 52.59it/s]backtest loop:  46%|████▌     | 447/971 [00:09<00:10, 49.73it/s]backtest loop:  47%|████▋     | 453/971 [00:09<00:10, 51.04it/s]backtest loop:  47%|████▋     | 459/971 [00:09<00:09, 51.93it/s]backtest loop:  48%|████▊     | 465/971 [00:09<00:09, 52.80it/s]backtest loop:  49%|████▊     | 471/971 [00:09<00:09, 53.23it/s]backtest loop:  49%|████▉     | 477/971 [00:09<00:09, 50.63it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:09, 51.65it/s]backtest loop:  50%|█████     | 489/971 [00:10<00:15, 31.49it/s]backtest loop:  51%|█████     | 495/971 [00:10<00:13, 34.47it/s]backtest loop:  52%|█████▏    | 501/971 [00:10<00:12, 38.73it/s]backtest loop:  52%|█████▏    | 507/971 [00:10<00:11, 40.55it/s]backtest loop:  53%|█████▎    | 513/971 [00:10<00:10, 44.03it/s]backtest loop:  53%|█████▎    | 519/971 [00:10<00:09, 46.83it/s]backtest loop:  54%|█████▍    | 525/971 [00:10<00:09, 48.99it/s]backtest loop:  55%|█████▍    | 531/971 [00:10<00:09, 47.78it/s]backtest loop:  55%|█████▌    | 537/971 [00:11<00:08, 49.83it/s]backtest loop:  56%|█████▌    | 543/971 [00:11<00:08, 51.26it/s]backtest loop:  57%|█████▋    | 549/971 [00:11<00:08, 52.38it/s]backtest loop:  57%|█████▋    | 555/971 [00:11<00:07, 53.14it/s]backtest loop:  58%|█████▊    | 561/971 [00:11<00:08, 50.24it/s]backtest loop:  58%|█████▊    | 567/971 [00:11<00:07, 51.39it/s]backtest loop:  59%|█████▉    | 573/971 [00:11<00:07, 52.30it/s]backtest loop:  60%|█████▉    | 579/971 [00:11<00:07, 52.94it/s]backtest loop:  60%|██████    | 585/971 [00:11<00:07, 53.37it/s]backtest loop:  61%|██████    | 591/971 [00:12<00:07, 50.46it/s]backtest loop:  61%|██████▏   | 597/971 [00:12<00:07, 51.63it/s]backtest loop:  62%|██████▏   | 603/971 [00:12<00:07, 52.49it/s]backtest loop:  63%|██████▎   | 609/971 [00:12<00:06, 53.23it/s]backtest loop:  63%|██████▎   | 615/971 [00:12<00:07, 50.47it/s]backtest loop:  64%|██████▍   | 621/971 [00:12<00:06, 51.62it/s]backtest loop:  65%|██████▍   | 627/971 [00:12<00:06, 52.67it/s]backtest loop:  65%|██████▌   | 633/971 [00:12<00:06, 53.29it/s]backtest loop:  66%|██████▌   | 639/971 [00:12<00:06, 53.91it/s]backtest loop:  66%|██████▋   | 645/971 [00:13<00:06, 50.59it/s]backtest loop:  67%|██████▋   | 651/971 [00:13<00:06, 51.88it/s]backtest loop:  68%|██████▊   | 657/971 [00:13<00:05, 52.37it/s]backtest loop:  68%|██████▊   | 663/971 [00:13<00:05, 52.95it/s]backtest loop:  69%|██████▉   | 669/971 [00:13<00:05, 53.48it/s]backtest loop:  70%|██████▉   | 675/971 [00:13<00:05, 50.34it/s]backtest loop:  70%|███████   | 681/971 [00:13<00:05, 51.39it/s]backtest loop:  71%|███████   | 687/971 [00:13<00:05, 51.99it/s]backtest loop:  71%|███████▏  | 693/971 [00:14<00:05, 52.56it/s]backtest loop:  72%|███████▏  | 699/971 [00:14<00:05, 49.92it/s]backtest loop:  73%|███████▎  | 705/971 [00:14<00:05, 51.05it/s]backtest loop:  73%|███████▎  | 711/971 [00:14<00:05, 51.91it/s]backtest loop:  74%|███████▍  | 717/971 [00:14<00:04, 52.51it/s]backtest loop:  74%|███████▍  | 723/971 [00:14<00:04, 53.23it/s]backtest loop:  75%|███████▌  | 729/971 [00:14<00:04, 50.44it/s]backtest loop:  76%|███████▌  | 735/971 [00:14<00:04, 48.30it/s]backtest loop:  76%|███████▋  | 741/971 [00:14<00:04, 49.92it/s]backtest loop:  77%|███████▋  | 747/971 [00:15<00:04, 50.92it/s]backtest loop:  78%|███████▊  | 753/971 [00:15<00:04, 48.97it/s]backtest loop:  78%|███████▊  | 759/971 [00:15<00:04, 50.48it/s]backtest loop:  79%|███████▉  | 765/971 [00:15<00:04, 48.61it/s]backtest loop:  79%|███████▉  | 771/971 [00:15<00:03, 50.14it/s]backtest loop:  80%|████████  | 777/971 [00:15<00:03, 51.54it/s]backtest loop:  81%|████████  | 783/971 [00:15<00:03, 49.37it/s]backtest loop:  81%|████████▏ | 789/971 [00:15<00:03, 50.80it/s]backtest loop:  82%|████████▏ | 795/971 [00:16<00:03, 51.86it/s]backtest loop:  82%|████████▏ | 801/971 [00:16<00:03, 52.63it/s]backtest loop:  83%|████████▎ | 807/971 [00:16<00:03, 52.91it/s]backtest loop:  84%|████████▎ | 813/971 [00:16<00:03, 50.06it/s]backtest loop:  84%|████████▍ | 819/971 [00:16<00:02, 50.73it/s]backtest loop:  85%|████████▍ | 825/971 [00:16<00:02, 51.83it/s]backtest loop:  86%|████████▌ | 831/971 [00:16<00:02, 52.67it/s]backtest loop:  86%|████████▌ | 837/971 [00:16<00:02, 53.12it/s]backtest loop:  87%|████████▋ | 843/971 [00:16<00:02, 50.29it/s]backtest loop:  87%|████████▋ | 849/971 [00:17<00:02, 51.52it/s]backtest loop:  88%|████████▊ | 855/971 [00:17<00:02, 52.32it/s]backtest loop:  89%|████████▊ | 861/971 [00:17<00:02, 52.97it/s]backtest loop:  89%|████████▉ | 867/971 [00:17<00:02, 50.25it/s]backtest loop:  90%|████████▉ | 873/971 [00:17<00:01, 51.16it/s]backtest loop:  91%|█████████ | 879/971 [00:17<00:01, 52.23it/s]backtest loop:  91%|█████████ | 885/971 [00:17<00:01, 52.99it/s]backtest loop:  92%|█████████▏| 891/971 [00:17<00:01, 53.39it/s]backtest loop:  92%|█████████▏| 897/971 [00:17<00:01, 50.49it/s]backtest loop:  93%|█████████▎| 903/971 [00:18<00:01, 51.62it/s]backtest loop:  94%|█████████▎| 909/971 [00:18<00:01, 52.40it/s]backtest loop:  94%|█████████▍| 915/971 [00:18<00:01, 53.17it/s]backtest loop:  95%|█████████▍| 921/971 [00:18<00:00, 50.32it/s]backtest loop:  95%|█████████▌| 927/971 [00:18<00:00, 51.39it/s]backtest loop:  96%|█████████▌| 933/971 [00:18<00:00, 52.27it/s]backtest loop:  97%|█████████▋| 939/971 [00:18<00:00, 52.84it/s]backtest loop:  97%|█████████▋| 945/971 [00:18<00:00, 49.72it/s]backtest loop:  98%|█████████▊| 951/971 [00:19<00:00, 51.14it/s]backtest loop:  99%|█████████▊| 957/971 [00:19<00:00, 52.07it/s]backtest loop:  99%|█████████▉| 963/971 [00:19<00:00, 52.63it/s]backtest loop: 100%|█████████▉| 969/971 [00:19<00:00, 53.02it/s]backtest loop: 100%|██████████| 971/971 [00:19<00:00, 49.98it/s]
[3553693:MainThread](2024-04-26 07:39:24,669) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000446
std                0.005906
annualized_return  0.106109
information_ratio  1.164560
max_drawdown      -0.108370
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000248
std                0.005906
annualized_return  0.059029
information_ratio  0.647841
max_drawdown      -0.165187
[3553693:MainThread](2024-04-26 07:39:24,686) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_Localformer_alpha360_horizon1_step20_rankFalse_2024-04-26_03:34:20_online`.
Round 6 Done!
{'1day.excess_return_with_cost.annualized_return': [0.07075714264527615,
                                                    0.10850427937124411,
                                                    0.06685286326248528,
                                                    0.08608948157805843,
                                                    0.07682903517339368,
                                                    0.059029409217761133],
 '1day.excess_return_with_cost.information_ratio': [0.7604996387958325,
                                                    1.2020537825981399,
                                                    0.7125046093662444,
                                                    0.8904572108774373,
                                                    0.8708896268691235,
                                                    0.6478405490692812],
 '1day.excess_return_with_cost.max_drawdown': [-0.14329134900291735,
                                               -0.12316472001361661,
                                               -0.1646927914298363,
                                               -0.13001096080026223,
                                               -0.11819781308791061,
                                               -0.16518671305225527],
 'IC': [0.023486286189309008,
        0.02791365222447451,
        0.02441311490294145,
        0.023209719834113737,
        0.02556309432113134,
        0.023518064772987516],
 'ICIR': [0.17230008880149675,
          0.19858094896927955,
          0.17400805891726157,
          0.16495475959030012,
          0.1764065044712292,
          0.1635279171880803],
 'Rank IC': [0.01784804193762672,
             0.025047469820677314,
             0.017413522190489108,
             0.016932903948649526,
             0.021804135075245198,
             0.01589400216650591],
 'Rank ICIR': [0.12653690606414603,
               0.1780858675400394,
               0.12095496861110042,
               0.1191049590209752,
               0.15427744155570366,
               0.10779982689789028],
 'mae': [0.7075116038322449,
         0.707405149936676,
         0.7074940800666809,
         0.707470715045929,
         0.7074753046035767,
         0.7074763178825378],
 'mse': [0.9960588812828064,
         0.9957895874977112,
         0.9961219429969788,
         0.9960362911224365,
         0.9959264397621155,
         0.9960545301437378]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3553693:MainThread](2024-04-26 07:39:25,864) INFO - qlib.TransformerModel - [pytorch_localformer.py:64] - Naive Transformer:
batch_size : 2048
device : cuda:0
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:52<1:27:23, 52.97s/it]epoch:   2%|▏         | 2/100 [01:46<1:26:50, 53.17s/it]epoch:   3%|▎         | 3/100 [02:39<1:26:07, 53.27s/it]epoch:   4%|▍         | 4/100 [03:33<1:25:16, 53.30s/it]epoch:   5%|▌         | 5/100 [04:26<1:24:23, 53.30s/it]epoch:   6%|▌         | 6/100 [05:19<1:23:28, 53.28s/it]epoch:   7%|▋         | 7/100 [06:12<1:22:38, 53.32s/it]epoch:   8%|▊         | 8/100 [07:06<1:21:46, 53.33s/it]epoch:   9%|▉         | 9/100 [07:59<1:21:00, 53.41s/it]epoch:  10%|█         | 10/100 [08:53<1:20:04, 53.39s/it]epoch:  11%|█         | 11/100 [09:46<1:19:12, 53.40s/it]epoch:  12%|█▏        | 12/100 [10:39<1:18:09, 53.29s/it]epoch:  13%|█▎        | 13/100 [11:32<1:17:07, 53.18s/it]epoch:  14%|█▍        | 14/100 [12:25<1:16:11, 53.16s/it]epoch:  15%|█▌        | 15/100 [13:18<1:15:12, 53.09s/it]epoch:  16%|█▌        | 16/100 [14:11<1:14:15, 53.04s/it]epoch:  17%|█▋        | 17/100 [15:04<1:13:22, 53.05s/it]epoch:  18%|█▊        | 18/100 [15:57<1:12:26, 53.01s/it]epoch:  19%|█▉        | 19/100 [16:50<1:11:31, 52.98s/it]epoch:  20%|██        | 20/100 [17:43<1:10:41, 53.01s/it]epoch:  21%|██        | 21/100 [18:36<1:09:53, 53.09s/it]epoch:  22%|██▏       | 22/100 [19:30<1:09:09, 53.20s/it]epoch:  23%|██▎       | 23/100 [20:23<1:08:22, 53.28s/it]epoch:  24%|██▍       | 24/100 [21:17<1:07:32, 53.32s/it]epoch:  25%|██▌       | 25/100 [22:10<1:06:35, 53.27s/it]epoch:  26%|██▌       | 26/100 [23:03<1:05:34, 53.17s/it]epoch:  27%|██▋       | 27/100 [23:56<1:04:37, 53.11s/it]epoch:  28%|██▊       | 28/100 [24:49<1:03:44, 53.12s/it]epoch:  29%|██▉       | 29/100 [25:42<1:02:47, 53.06s/it]epoch:  30%|███       | 30/100 [26:35<1:01:52, 53.04s/it]0.04254067929345676
best ic: 0.04254067929345676
epoch:  31%|███       | 31/100 [27:34<1:03:11, 54.96s/it]0.04670916981672136
best ic: 0.04670916981672136
epoch:  32%|███▏      | 32/100 [28:33<1:03:44, 56.25s/it]0.05244670535372674
best ic: 0.05244670535372674
epoch:  33%|███▎      | 33/100 [29:33<1:03:53, 57.21s/it]0.04726287673044223
epoch:  34%|███▍      | 34/100 [30:32<1:03:37, 57.84s/it]0.050099711263660335
epoch:  35%|███▌      | 35/100 [31:32<1:03:09, 58.30s/it]0.041735707977900015
epoch:  36%|███▌      | 36/100 [32:31<1:02:36, 58.70s/it]0.04338633439531505
epoch:  37%|███▋      | 37/100 [33:30<1:01:46, 58.83s/it]0.04037616821823002
epoch:  38%|███▊      | 38/100 [34:30<1:00:55, 58.96s/it]0.03508774740942208
epoch:  39%|███▉      | 39/100 [35:29<59:59, 59.00s/it]  0.0423874641903669
epoch:  40%|████      | 40/100 [36:28<59:07, 59.12s/it]0.040325024911083356
epoch:  40%|████      | 40/100 [37:27<56:11, 56.20s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3553693:MainThread](2024-04-26 08:16:53,774) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3553693:MainThread](2024-04-26 08:16:53,788) INFO - qlib.workflow - [recorder.py:341] - Recorder d6fdb3ebbcaf47d2bfc721994faa8fe5 starts running under Experiment 53 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:19,  3.12it/s]online:   3%|▎         | 2/63 [00:00<00:22,  2.70it/s]online:   5%|▍         | 3/63 [00:01<00:23,  2.56it/s]online:   6%|▋         | 4/63 [00:01<00:23,  2.52it/s]online:   8%|▊         | 5/63 [00:01<00:23,  2.49it/s]online:  10%|▉         | 6/63 [00:02<00:22,  2.48it/s]online:  11%|█         | 7/63 [00:02<00:22,  2.47it/s]online:  13%|█▎        | 8/63 [00:03<00:22,  2.46it/s]online:  14%|█▍        | 9/63 [00:03<00:21,  2.46it/s]online:  16%|█▌        | 10/63 [00:03<00:21,  2.45it/s]online:  17%|█▋        | 11/63 [00:04<00:21,  2.45it/s]online:  19%|█▉        | 12/63 [00:04<00:20,  2.45it/s]online:  21%|██        | 13/63 [00:05<00:20,  2.44it/s]online:  22%|██▏       | 14/63 [00:05<00:20,  2.44it/s]online:  24%|██▍       | 15/63 [00:06<00:19,  2.43it/s]online:  25%|██▌       | 16/63 [00:06<00:19,  2.44it/s]online:  27%|██▋       | 17/63 [00:06<00:18,  2.43it/s]online:  29%|██▊       | 18/63 [00:07<00:18,  2.44it/s]online:  30%|███       | 19/63 [00:07<00:18,  2.43it/s]online:  32%|███▏      | 20/63 [00:08<00:17,  2.44it/s]online:  33%|███▎      | 21/63 [00:08<00:17,  2.44it/s]online:  35%|███▍      | 22/63 [00:08<00:16,  2.44it/s]online:  37%|███▋      | 23/63 [00:09<00:16,  2.43it/s]online:  38%|███▊      | 24/63 [00:09<00:15,  2.44it/s]online:  40%|███▉      | 25/63 [00:10<00:15,  2.44it/s]online:  41%|████▏     | 26/63 [00:10<00:15,  2.44it/s]online:  43%|████▎     | 27/63 [00:10<00:14,  2.44it/s]online:  44%|████▍     | 28/63 [00:11<00:14,  2.44it/s]online:  46%|████▌     | 29/63 [00:11<00:13,  2.44it/s]online:  48%|████▊     | 30/63 [00:12<00:13,  2.44it/s]online:  49%|████▉     | 31/63 [00:12<00:13,  2.44it/s]online:  51%|█████     | 32/63 [00:13<00:12,  2.44it/s]online:  52%|█████▏    | 33/63 [00:13<00:12,  2.45it/s]online:  54%|█████▍    | 34/63 [00:13<00:11,  2.43it/s]online:  56%|█████▌    | 35/63 [00:14<00:11,  2.42it/s]online:  57%|█████▋    | 36/63 [00:14<00:11,  2.42it/s]online:  59%|█████▊    | 37/63 [00:15<00:10,  2.41it/s]online:  60%|██████    | 38/63 [00:15<00:10,  2.43it/s]online:  62%|██████▏   | 39/63 [00:15<00:09,  2.42it/s]online:  63%|██████▎   | 40/63 [00:16<00:09,  2.42it/s]online:  65%|██████▌   | 41/63 [00:16<00:09,  2.42it/s]online:  67%|██████▋   | 42/63 [00:17<00:08,  2.42it/s]online:  68%|██████▊   | 43/63 [00:17<00:08,  2.42it/s]online:  70%|██████▉   | 44/63 [00:17<00:07,  2.42it/s]online:  71%|███████▏  | 45/63 [00:18<00:07,  2.41it/s]online:  73%|███████▎  | 46/63 [00:18<00:07,  2.42it/s]online:  75%|███████▍  | 47/63 [00:19<00:06,  2.41it/s]online:  76%|███████▌  | 48/63 [00:19<00:06,  2.42it/s]online:  78%|███████▊  | 49/63 [00:20<00:05,  2.42it/s]online:  79%|███████▉  | 50/63 [00:20<00:05,  2.42it/s]online:  81%|████████  | 51/63 [00:20<00:04,  2.41it/s]online:  83%|████████▎ | 52/63 [00:21<00:04,  2.41it/s]online:  84%|████████▍ | 53/63 [00:21<00:04,  2.41it/s]online:  86%|████████▌ | 54/63 [00:22<00:03,  2.41it/s]online:  87%|████████▋ | 55/63 [00:22<00:03,  2.41it/s]online:  89%|████████▉ | 56/63 [00:22<00:02,  2.40it/s]online:  90%|█████████ | 57/63 [00:23<00:02,  2.41it/s]online:  92%|█████████▏| 58/63 [00:23<00:02,  2.41it/s]online:  94%|█████████▎| 59/63 [00:24<00:01,  2.41it/s]online:  95%|█████████▌| 60/63 [00:24<00:01,  2.41it/s]online:  97%|█████████▋| 61/63 [00:25<00:00,  2.41it/s]online:  98%|█████████▊| 62/63 [00:25<00:00,  2.42it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.51it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.44it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3553693:MainThread](2024-04-26 08:17:28,228) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99623567 mae 0.707541
{'IC': 0.024515036617226375,
 'ICIR': 0.15749937419058055,
 'Rank IC': 0.01953202024121043,
 'Rank ICIR': 0.122363202162894}
[3553693:MainThread](2024-04-26 08:17:29,985) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3553693:MainThread](2024-04-26 08:17:41,510) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 08:17:41,513) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 08:17:47,608) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fd65231cf10>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:45,  9.16it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.50it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 35.02it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.00it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:20, 46.93it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.58it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 51.99it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.11it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.25it/s]backtest loop:   6%|▌         | 60/971 [00:01<00:16, 55.05it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.17it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 56.76it/s]backtest loop:   8%|▊         | 80/971 [00:01<00:15, 57.60it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:15, 58.25it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:16, 54.80it/s]backtest loop:  10%|█         | 98/971 [00:02<00:15, 56.04it/s]backtest loop:  11%|█         | 104/971 [00:02<00:15, 57.13it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:14, 58.67it/s]backtest loop:  12%|█▏        | 117/971 [00:02<00:15, 55.71it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:14, 56.72it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:15, 54.32it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:14, 55.78it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 53.62it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 56.24it/s]backtest loop:  16%|█▌        | 154/971 [00:02<00:14, 57.21it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 55.55it/s]backtest loop:  17%|█▋        | 167/971 [00:03<00:14, 56.70it/s]backtest loop:  18%|█▊        | 174/971 [00:03<00:13, 58.45it/s]backtest loop:  19%|█▊        | 180/971 [00:03<00:13, 58.77it/s]backtest loop:  19%|█▉        | 186/971 [00:03<00:14, 55.69it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:13, 56.52it/s]backtest loop:  20%|██        | 199/971 [00:03<00:13, 58.30it/s]backtest loop:  21%|██        | 205/971 [00:03<00:13, 55.15it/s]backtest loop:  22%|██▏       | 212/971 [00:04<00:13, 57.43it/s]backtest loop:  22%|██▏       | 218/971 [00:04<00:13, 55.09it/s]backtest loop:  23%|██▎       | 224/971 [00:04<00:13, 56.31it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 54.20it/s]backtest loop:  24%|██▍       | 236/971 [00:04<00:13, 55.62it/s]backtest loop:  25%|██▌       | 243/971 [00:04<00:12, 57.63it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:13, 55.15it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:12, 57.18it/s]backtest loop:  27%|██▋       | 263/971 [00:04<00:12, 58.91it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:12, 55.78it/s]backtest loop:  28%|██▊       | 275/971 [00:05<00:12, 56.87it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:12, 54.47it/s]backtest loop:  30%|██▉       | 288/971 [00:05<00:12, 56.81it/s]backtest loop:  30%|███       | 295/971 [00:05<00:12, 55.31it/s]backtest loop:  31%|███       | 301/971 [00:05<00:11, 56.50it/s]backtest loop:  32%|███▏      | 307/971 [00:05<00:11, 57.43it/s]backtest loop:  32%|███▏      | 313/971 [00:05<00:11, 57.91it/s]backtest loop:  33%|███▎      | 320/971 [00:05<00:11, 55.87it/s]backtest loop:  34%|███▎      | 326/971 [00:06<00:11, 56.86it/s]backtest loop:  34%|███▍      | 333/971 [00:06<00:10, 58.58it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 58.90it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 55.53it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 57.51it/s]backtest loop:  37%|███▋      | 359/971 [00:06<00:10, 59.01it/s]backtest loop:  38%|███▊      | 365/971 [00:06<00:10, 56.18it/s]backtest loop:  38%|███▊      | 371/971 [00:06<00:11, 53.99it/s]backtest loop:  39%|███▉      | 377/971 [00:06<00:10, 55.55it/s]backtest loop:  39%|███▉      | 383/971 [00:07<00:10, 53.52it/s]backtest loop:  40%|████      | 390/971 [00:07<00:10, 56.37it/s]backtest loop:  41%|████      | 396/971 [00:07<00:10, 57.31it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 55.54it/s]backtest loop:  42%|████▏     | 409/971 [00:07<00:09, 56.57it/s]backtest loop:  43%|████▎     | 415/971 [00:07<00:15, 35.01it/s]backtest loop:  43%|████▎     | 421/971 [00:07<00:13, 39.74it/s]backtest loop:  44%|████▍     | 428/971 [00:08<00:12, 43.02it/s]backtest loop:  45%|████▍     | 434/971 [00:08<00:11, 46.67it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:10, 49.86it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:10, 50.43it/s]backtest loop:  47%|████▋     | 453/971 [00:08<00:09, 52.81it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:09, 54.68it/s]backtest loop:  48%|████▊     | 465/971 [00:08<00:09, 56.02it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:09, 54.58it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 56.92it/s]backtest loop:  50%|█████     | 486/971 [00:09<00:08, 58.58it/s]backtest loop:  51%|█████     | 492/971 [00:09<00:08, 55.56it/s]backtest loop:  51%|█████▏    | 498/971 [00:09<00:08, 56.55it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:08, 57.46it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:08, 54.70it/s]backtest loop:  53%|█████▎    | 517/971 [00:09<00:08, 53.90it/s]backtest loop:  54%|█████▍    | 524/971 [00:09<00:07, 56.25it/s]backtest loop:  55%|█████▍    | 530/971 [00:09<00:07, 57.16it/s]backtest loop:  55%|█████▌    | 536/971 [00:09<00:07, 54.69it/s]backtest loop:  56%|█████▌    | 542/971 [00:10<00:07, 56.10it/s]backtest loop:  56%|█████▋    | 548/971 [00:10<00:07, 57.08it/s]backtest loop:  57%|█████▋    | 554/971 [00:10<00:07, 57.86it/s]backtest loop:  58%|█████▊    | 560/971 [00:10<00:07, 57.81it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 54.83it/s]backtest loop:  59%|█████▉    | 572/971 [00:10<00:07, 55.66it/s]backtest loop:  60%|█████▉    | 579/971 [00:10<00:06, 57.81it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:06, 55.58it/s]backtest loop:  61%|██████    | 593/971 [00:10<00:06, 57.44it/s]backtest loop:  62%|██████▏   | 600/971 [00:11<00:06, 55.63it/s]backtest loop:  62%|██████▏   | 606/971 [00:11<00:06, 56.61it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 57.41it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:05, 59.02it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 55.89it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 57.89it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 59.83it/s]backtest loop:  67%|██████▋   | 646/971 [00:11<00:05, 57.27it/s]backtest loop:  67%|██████▋   | 652/971 [00:12<00:05, 57.89it/s]backtest loop:  68%|██████▊   | 659/971 [00:12<00:05, 59.13it/s]backtest loop:  68%|██████▊   | 665/971 [00:12<00:05, 55.95it/s]backtest loop:  69%|██████▉   | 671/971 [00:12<00:05, 56.88it/s]backtest loop:  70%|██████▉   | 677/971 [00:12<00:05, 57.72it/s]backtest loop:  70%|███████   | 683/971 [00:12<00:04, 58.08it/s]backtest loop:  71%|███████   | 689/971 [00:12<00:05, 55.03it/s]backtest loop:  72%|███████▏  | 695/971 [00:12<00:04, 56.31it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 57.24it/s]backtest loop:  73%|███████▎  | 707/971 [00:12<00:04, 58.00it/s]backtest loop:  73%|███████▎  | 713/971 [00:13<00:04, 58.56it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 55.40it/s]backtest loop:  75%|███████▍  | 725/971 [00:13<00:04, 56.68it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 54.21it/s]backtest loop:  76%|███████▌  | 737/971 [00:13<00:04, 55.58it/s]backtest loop:  77%|███████▋  | 743/971 [00:13<00:04, 53.34it/s]backtest loop:  77%|███████▋  | 749/971 [00:13<00:04, 54.92it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 53.09it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 55.81it/s]backtest loop:  79%|███████▉  | 768/971 [00:14<00:03, 56.93it/s]backtest loop:  80%|███████▉  | 774/971 [00:14<00:03, 57.72it/s]backtest loop:  80%|████████  | 780/971 [00:14<00:03, 54.96it/s]backtest loop:  81%|████████  | 786/971 [00:14<00:03, 56.20it/s]backtest loop:  82%|████████▏ | 793/971 [00:14<00:03, 54.70it/s]backtest loop:  82%|████████▏ | 799/971 [00:14<00:03, 55.90it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:02, 56.86it/s]backtest loop:  84%|████████▎ | 811/971 [00:14<00:02, 57.68it/s]backtest loop:  84%|████████▍ | 817/971 [00:14<00:02, 58.09it/s]backtest loop:  85%|████████▍ | 823/971 [00:15<00:02, 55.09it/s]backtest loop:  85%|████████▌ | 830/971 [00:15<00:02, 57.20it/s]backtest loop:  86%|████████▌ | 836/971 [00:15<00:02, 57.95it/s]backtest loop:  87%|████████▋ | 842/971 [00:15<00:02, 58.52it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 55.23it/s]backtest loop:  88%|████████▊ | 854/971 [00:15<00:02, 56.47it/s]backtest loop:  89%|████████▊ | 860/971 [00:15<00:01, 57.42it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 58.08it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 55.11it/s]backtest loop:  91%|█████████ | 879/971 [00:16<00:01, 57.26it/s]backtest loop:  91%|█████████ | 886/971 [00:16<00:01, 58.80it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 55.71it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 57.58it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 58.92it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 55.58it/s]backtest loop:  95%|█████████▍| 918/971 [00:16<00:00, 56.66it/s]backtest loop:  95%|█████████▌| 924/971 [00:16<00:00, 57.53it/s]backtest loop:  96%|█████████▌| 930/971 [00:16<00:00, 57.85it/s]backtest loop:  96%|█████████▋| 936/971 [00:17<00:00, 54.76it/s]backtest loop:  97%|█████████▋| 943/971 [00:17<00:00, 57.01it/s]backtest loop:  98%|█████████▊| 949/971 [00:17<00:00, 57.75it/s]backtest loop:  98%|█████████▊| 955/971 [00:17<00:00, 54.90it/s]backtest loop:  99%|█████████▉| 961/971 [00:17<00:00, 56.29it/s]backtest loop: 100%|█████████▉| 967/971 [00:17<00:00, 57.19it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.99it/s]
[3553693:MainThread](2024-04-26 08:18:05,341) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000578
std                0.006013
annualized_return  0.137582
information_ratio  1.483245
max_drawdown      -0.122229
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000380
std                0.006014
annualized_return  0.090443
information_ratio  0.974841
max_drawdown      -0.137084
[3553693:MainThread](2024-04-26 08:18:05,357) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_Localformer_alpha360_horizon1_step20_rankFalse_2024-04-26_03:34:20_online`.
Round 7 Done!
{'1day.excess_return_with_cost.annualized_return': [0.07075714264527615,
                                                    0.10850427937124411,
                                                    0.06685286326248528,
                                                    0.08608948157805843,
                                                    0.07682903517339368,
                                                    0.059029409217761133,
                                                    0.090443017988795],
 '1day.excess_return_with_cost.information_ratio': [0.7604996387958325,
                                                    1.2020537825981399,
                                                    0.7125046093662444,
                                                    0.8904572108774373,
                                                    0.8708896268691235,
                                                    0.6478405490692812,
                                                    0.9748413400836983],
 '1day.excess_return_with_cost.max_drawdown': [-0.14329134900291735,
                                               -0.12316472001361661,
                                               -0.1646927914298363,
                                               -0.13001096080026223,
                                               -0.11819781308791061,
                                               -0.16518671305225527,
                                               -0.13708383052832637],
 'IC': [0.023486286189309008,
        0.02791365222447451,
        0.02441311490294145,
        0.023209719834113737,
        0.02556309432113134,
        0.023518064772987516,
        0.024515036617226375],
 'ICIR': [0.17230008880149675,
          0.19858094896927955,
          0.17400805891726157,
          0.16495475959030012,
          0.1764065044712292,
          0.1635279171880803,
          0.15749937419058055],
 'Rank IC': [0.01784804193762672,
             0.025047469820677314,
             0.017413522190489108,
             0.016932903948649526,
             0.021804135075245198,
             0.01589400216650591,
             0.01953202024121043],
 'Rank ICIR': [0.12653690606414603,
               0.1780858675400394,
               0.12095496861110042,
               0.1191049590209752,
               0.15427744155570366,
               0.10779982689789028,
               0.122363202162894],
 'mae': [0.7075116038322449,
         0.707405149936676,
         0.7074940800666809,
         0.707470715045929,
         0.7074753046035767,
         0.7074763178825378,
         0.7075409889221191],
 'mse': [0.9960588812828064,
         0.9957895874977112,
         0.9961219429969788,
         0.9960362911224365,
         0.9959264397621155,
         0.9960545301437378,
         0.9962356686592102]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3553693:MainThread](2024-04-26 08:18:06,530) INFO - qlib.TransformerModel - [pytorch_localformer.py:64] - Naive Transformer:
batch_size : 2048
device : cuda:0
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:52<1:27:15, 52.89s/it]epoch:   2%|▏         | 2/100 [01:45<1:26:34, 53.01s/it]epoch:   3%|▎         | 3/100 [02:39<1:25:46, 53.06s/it]epoch:   4%|▍         | 4/100 [03:32<1:24:58, 53.11s/it]epoch:   5%|▌         | 5/100 [04:25<1:24:08, 53.14s/it]epoch:   6%|▌         | 6/100 [05:18<1:23:16, 53.16s/it]epoch:   7%|▋         | 7/100 [06:11<1:22:25, 53.17s/it]epoch:   8%|▊         | 8/100 [07:04<1:21:30, 53.15s/it]epoch:   9%|▉         | 9/100 [07:58<1:20:39, 53.18s/it]epoch:  10%|█         | 10/100 [08:51<1:19:39, 53.11s/it]epoch:  11%|█         | 11/100 [09:44<1:18:47, 53.11s/it]epoch:  12%|█▏        | 12/100 [10:37<1:17:46, 53.03s/it]epoch:  13%|█▎        | 13/100 [11:29<1:16:49, 52.98s/it]epoch:  14%|█▍        | 14/100 [12:23<1:16:01, 53.04s/it]epoch:  15%|█▌        | 15/100 [13:16<1:15:12, 53.09s/it]epoch:  16%|█▌        | 16/100 [14:09<1:14:30, 53.22s/it]epoch:  17%|█▋        | 17/100 [15:02<1:13:32, 53.16s/it]epoch:  18%|█▊        | 18/100 [15:55<1:12:34, 53.10s/it]epoch:  19%|█▉        | 19/100 [16:48<1:11:37, 53.06s/it]epoch:  20%|██        | 20/100 [17:41<1:10:44, 53.06s/it]epoch:  21%|██        | 21/100 [18:34<1:09:47, 53.00s/it]epoch:  22%|██▏       | 22/100 [19:27<1:08:58, 53.06s/it]epoch:  23%|██▎       | 23/100 [20:21<1:08:08, 53.09s/it]epoch:  24%|██▍       | 24/100 [21:14<1:07:14, 53.08s/it]epoch:  25%|██▌       | 25/100 [22:07<1:06:21, 53.08s/it]epoch:  26%|██▌       | 26/100 [23:00<1:05:27, 53.08s/it]epoch:  27%|██▋       | 27/100 [23:53<1:04:41, 53.17s/it]epoch:  28%|██▊       | 28/100 [24:47<1:03:50, 53.20s/it]epoch:  29%|██▉       | 29/100 [25:39<1:02:51, 53.11s/it]epoch:  30%|███       | 30/100 [26:32<1:01:53, 53.05s/it]0.05085896670023861
best ic: 0.05085896670023861
epoch:  31%|███       | 31/100 [27:32<1:03:18, 55.05s/it]0.04828403651416192
epoch:  32%|███▏      | 32/100 [28:31<1:03:48, 56.30s/it]0.05285752649170741
best ic: 0.05285752649170741
epoch:  33%|███▎      | 33/100 [29:31<1:03:57, 57.28s/it]0.0463431091760681
epoch:  34%|███▍      | 34/100 [30:30<1:03:44, 57.94s/it]0.04344297610385149
epoch:  35%|███▌      | 35/100 [31:30<1:03:13, 58.36s/it]0.045072375215060044
epoch:  36%|███▌      | 36/100 [32:29<1:02:31, 58.62s/it]0.040915260810848175
epoch:  37%|███▋      | 37/100 [33:28<1:01:43, 58.79s/it]0.04177819639424654
epoch:  38%|███▊      | 38/100 [34:27<1:00:54, 58.95s/it]0.0467318659482183
epoch:  39%|███▉      | 39/100 [35:27<1:00:03, 59.08s/it]0.04853919430337459
epoch:  40%|████      | 40/100 [36:26<59:10, 59.18s/it]  0.04784665852028464
epoch:  40%|████      | 40/100 [37:25<56:08, 56.15s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3553693:MainThread](2024-04-26 08:55:32,554) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3553693:MainThread](2024-04-26 08:55:32,568) INFO - qlib.workflow - [recorder.py:341] - Recorder 9f2cb42e73f745879994b8d3b3540d1a starts running under Experiment 53 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:20,  3.01it/s]online:   3%|▎         | 2/63 [00:00<00:23,  2.63it/s]online:   5%|▍         | 3/63 [00:01<00:23,  2.53it/s]online:   6%|▋         | 4/63 [00:01<00:23,  2.50it/s]online:   8%|▊         | 5/63 [00:01<00:23,  2.47it/s]online:  10%|▉         | 6/63 [00:02<00:23,  2.44it/s]online:  11%|█         | 7/63 [00:02<00:22,  2.44it/s]online:  13%|█▎        | 8/63 [00:03<00:22,  2.44it/s]online:  14%|█▍        | 9/63 [00:03<00:22,  2.42it/s]online:  16%|█▌        | 10/63 [00:04<00:21,  2.43it/s]online:  17%|█▋        | 11/63 [00:04<00:21,  2.43it/s]online:  19%|█▉        | 12/63 [00:04<00:20,  2.43it/s]online:  21%|██        | 13/63 [00:05<00:20,  2.43it/s]online:  22%|██▏       | 14/63 [00:05<00:20,  2.43it/s]online:  24%|██▍       | 15/63 [00:06<00:19,  2.43it/s]online:  25%|██▌       | 16/63 [00:06<00:19,  2.43it/s]online:  27%|██▋       | 17/63 [00:06<00:18,  2.43it/s]online:  29%|██▊       | 18/63 [00:07<00:18,  2.43it/s]online:  30%|███       | 19/63 [00:07<00:18,  2.44it/s]online:  32%|███▏      | 20/63 [00:08<00:17,  2.44it/s]online:  33%|███▎      | 21/63 [00:08<00:17,  2.43it/s]online:  35%|███▍      | 22/63 [00:08<00:16,  2.43it/s]online:  37%|███▋      | 23/63 [00:09<00:16,  2.44it/s]online:  38%|███▊      | 24/63 [00:09<00:16,  2.43it/s]online:  40%|███▉      | 25/63 [00:10<00:15,  2.43it/s]online:  41%|████▏     | 26/63 [00:10<00:15,  2.43it/s]online:  43%|████▎     | 27/63 [00:11<00:14,  2.43it/s]online:  44%|████▍     | 28/63 [00:11<00:14,  2.43it/s]online:  46%|████▌     | 29/63 [00:11<00:14,  2.42it/s]online:  48%|████▊     | 30/63 [00:12<00:13,  2.42it/s]online:  49%|████▉     | 31/63 [00:12<00:13,  2.42it/s]online:  51%|█████     | 32/63 [00:13<00:12,  2.41it/s]online:  52%|█████▏    | 33/63 [00:13<00:12,  2.42it/s]online:  54%|█████▍    | 34/63 [00:13<00:11,  2.42it/s]online:  56%|█████▌    | 35/63 [00:14<00:11,  2.42it/s]online:  57%|█████▋    | 36/63 [00:14<00:11,  2.42it/s]online:  59%|█████▊    | 37/63 [00:15<00:10,  2.42it/s]online:  60%|██████    | 38/63 [00:15<00:10,  2.41it/s]online:  62%|██████▏   | 39/63 [00:16<00:09,  2.41it/s]online:  63%|██████▎   | 40/63 [00:16<00:09,  2.41it/s]online:  65%|██████▌   | 41/63 [00:16<00:09,  2.42it/s]online:  67%|██████▋   | 42/63 [00:17<00:08,  2.42it/s]online:  68%|██████▊   | 43/63 [00:17<00:08,  2.42it/s]online:  70%|██████▉   | 44/63 [00:18<00:07,  2.42it/s]online:  71%|███████▏  | 45/63 [00:18<00:07,  2.43it/s]online:  73%|███████▎  | 46/63 [00:18<00:07,  2.42it/s]online:  75%|███████▍  | 47/63 [00:19<00:06,  2.43it/s]online:  76%|███████▌  | 48/63 [00:19<00:06,  2.43it/s]online:  78%|███████▊  | 49/63 [00:20<00:05,  2.43it/s]online:  79%|███████▉  | 50/63 [00:20<00:05,  2.43it/s]online:  81%|████████  | 51/63 [00:20<00:04,  2.43it/s]online:  83%|████████▎ | 52/63 [00:21<00:04,  2.43it/s]online:  84%|████████▍ | 53/63 [00:21<00:04,  2.43it/s]online:  86%|████████▌ | 54/63 [00:22<00:03,  2.42it/s]online:  87%|████████▋ | 55/63 [00:22<00:03,  2.43it/s]online:  89%|████████▉ | 56/63 [00:23<00:02,  2.43it/s]online:  90%|█████████ | 57/63 [00:23<00:02,  2.42it/s]online:  92%|█████████▏| 58/63 [00:23<00:02,  2.42it/s]online:  94%|█████████▎| 59/63 [00:24<00:01,  2.41it/s]online:  95%|█████████▌| 60/63 [00:24<00:01,  2.41it/s]online:  97%|█████████▋| 61/63 [00:25<00:00,  2.42it/s]online:  98%|█████████▊| 62/63 [00:25<00:00,  2.42it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.52it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.44it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3553693:MainThread](2024-04-26 08:56:07,140) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99605113 mae 0.7075148
{'IC': 0.02656099433765106,
 'ICIR': 0.185415034924459,
 'Rank IC': 0.015610754757772752,
 'Rank ICIR': 0.10729239275972464}
[3553693:MainThread](2024-04-26 08:56:08,897) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3553693:MainThread](2024-04-26 08:56:20,399) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 08:56:20,402) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 08:56:26,496) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fd6430d0910>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:44,  9.24it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.57it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 35.03it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.92it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.64it/s]backtest loop:   3%|▎         | 33/971 [00:00<00:18, 49.66it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:18, 49.51it/s]backtest loop:   5%|▍         | 46/971 [00:01<00:17, 53.44it/s]backtest loop:   5%|▌         | 53/971 [00:01<00:16, 56.06it/s]backtest loop:   6%|▌         | 59/971 [00:01<00:16, 53.93it/s]backtest loop:   7%|▋         | 66/971 [00:01<00:16, 56.54it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 54.21it/s]backtest loop:   8%|▊         | 79/971 [00:01<00:15, 56.79it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:15, 58.73it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:15, 55.13it/s]backtest loop:  10%|█         | 99/971 [00:02<00:15, 57.36it/s]backtest loop:  11%|█         | 106/971 [00:02<00:14, 58.78it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 55.75it/s]backtest loop:  12%|█▏        | 119/971 [00:02<00:14, 57.60it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 54.84it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 53.20it/s]backtest loop:  14%|█▍        | 137/971 [00:02<00:15, 54.96it/s]backtest loop:  15%|█▍        | 144/971 [00:02<00:14, 57.14it/s]backtest loop:  16%|█▌        | 151/971 [00:02<00:14, 55.35it/s]backtest loop:  16%|█▌        | 157/971 [00:03<00:14, 56.51it/s]backtest loop:  17%|█▋        | 164/971 [00:03<00:13, 58.29it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:13, 58.63it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 55.64it/s]backtest loop:  19%|█▊        | 182/971 [00:03<00:13, 56.56it/s]backtest loop:  19%|█▉        | 189/971 [00:03<00:13, 58.35it/s]backtest loop:  20%|██        | 195/971 [00:03<00:14, 55.21it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 57.32it/s]backtest loop:  21%|██▏       | 208/971 [00:03<00:13, 57.70it/s]backtest loop:  22%|██▏       | 214/971 [00:04<00:13, 55.13it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:14, 53.25it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:13, 56.03it/s]backtest loop:  24%|██▍       | 234/971 [00:04<00:12, 57.88it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:13, 55.00it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:12, 57.22it/s]backtest loop:  26%|██▌       | 253/971 [00:04<00:12, 57.95it/s]backtest loop:  27%|██▋       | 259/971 [00:04<00:12, 55.07it/s]backtest loop:  27%|██▋       | 266/971 [00:04<00:13, 54.22it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 56.56it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:11, 58.33it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 55.30it/s]backtest loop:  30%|███       | 293/971 [00:05<00:11, 56.80it/s]backtest loop:  31%|███       | 300/971 [00:05<00:12, 55.14it/s]backtest loop:  32%|███▏      | 306/971 [00:05<00:11, 56.24it/s]backtest loop:  32%|███▏      | 313/971 [00:05<00:11, 58.05it/s]backtest loop:  33%|███▎      | 319/971 [00:05<00:11, 58.55it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:11, 55.83it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:11, 57.78it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 59.10it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 55.50it/s]backtest loop:  36%|███▌      | 351/971 [00:06<00:10, 56.67it/s]backtest loop:  37%|███▋      | 357/971 [00:06<00:10, 57.50it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:11, 55.14it/s]backtest loop:  38%|███▊      | 369/971 [00:06<00:11, 53.12it/s]backtest loop:  39%|███▊      | 376/971 [00:06<00:10, 55.86it/s]backtest loop:  39%|███▉      | 382/971 [00:07<00:10, 56.72it/s]backtest loop:  40%|███▉      | 388/971 [00:07<00:10, 54.22it/s]backtest loop:  41%|████      | 395/971 [00:07<00:10, 56.51it/s]backtest loop:  41%|████▏     | 401/971 [00:07<00:09, 57.45it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 58.02it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:10, 54.99it/s]backtest loop:  43%|████▎     | 419/971 [00:07<00:16, 34.20it/s]backtest loop:  44%|████▍     | 425/971 [00:08<00:13, 39.11it/s]backtest loop:  44%|████▍     | 431/971 [00:08<00:12, 43.46it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:11, 44.90it/s]backtest loop:  46%|████▌     | 443/971 [00:08<00:10, 48.41it/s]backtest loop:  46%|████▌     | 449/971 [00:08<00:10, 51.28it/s]backtest loop:  47%|████▋     | 455/971 [00:08<00:09, 53.47it/s]backtest loop:  47%|████▋     | 461/971 [00:08<00:09, 55.23it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:09, 53.16it/s]backtest loop:  49%|████▊     | 473/971 [00:08<00:09, 54.98it/s]backtest loop:  49%|████▉     | 480/971 [00:08<00:08, 57.22it/s]backtest loop:  50%|█████     | 486/971 [00:09<00:08, 57.98it/s]backtest loop:  51%|█████     | 492/971 [00:09<00:08, 54.63it/s]backtest loop:  51%|█████▏    | 498/971 [00:09<00:08, 56.05it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:08, 56.83it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:08, 54.30it/s]backtest loop:  53%|█████▎    | 516/971 [00:09<00:08, 55.86it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:08, 53.51it/s]backtest loop:  54%|█████▍    | 528/971 [00:09<00:08, 55.29it/s]backtest loop:  55%|█████▌    | 535/971 [00:09<00:07, 57.46it/s]backtest loop:  56%|█████▌    | 541/971 [00:10<00:07, 54.72it/s]backtest loop:  56%|█████▋    | 547/971 [00:10<00:07, 56.03it/s]backtest loop:  57%|█████▋    | 554/971 [00:10<00:07, 57.97it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 55.92it/s]backtest loop:  58%|█████▊    | 567/971 [00:10<00:07, 56.93it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:06, 57.77it/s]backtest loop:  60%|█████▉    | 579/971 [00:10<00:06, 58.25it/s]backtest loop:  60%|██████    | 585/971 [00:10<00:06, 58.72it/s]backtest loop:  61%|██████    | 591/971 [00:10<00:06, 55.51it/s]backtest loop:  61%|██████▏   | 597/971 [00:11<00:06, 56.70it/s]backtest loop:  62%|██████▏   | 604/971 [00:11<00:06, 58.56it/s]backtest loop:  63%|██████▎   | 610/971 [00:11<00:06, 55.38it/s]backtest loop:  64%|██████▎   | 617/971 [00:11<00:06, 57.80it/s]backtest loop:  64%|██████▍   | 624/971 [00:11<00:05, 58.99it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:06, 55.97it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:05, 58.09it/s]backtest loop:  66%|██████▌   | 643/971 [00:11<00:05, 58.55it/s]backtest loop:  67%|██████▋   | 650/971 [00:11<00:05, 56.25it/s]backtest loop:  68%|██████▊   | 656/971 [00:12<00:05, 57.01it/s]backtest loop:  68%|██████▊   | 663/971 [00:12<00:05, 58.55it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 56.03it/s]backtest loop:  70%|██████▉   | 676/971 [00:12<00:05, 56.95it/s]backtest loop:  70%|███████   | 682/971 [00:12<00:05, 57.75it/s]backtest loop:  71%|███████   | 688/971 [00:12<00:04, 57.96it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:05, 55.25it/s]backtest loop:  72%|███████▏  | 700/971 [00:12<00:04, 56.42it/s]backtest loop:  73%|███████▎  | 706/971 [00:12<00:04, 57.39it/s]backtest loop:  73%|███████▎  | 713/971 [00:13<00:04, 59.05it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 55.72it/s]backtest loop:  75%|███████▍  | 725/971 [00:13<00:04, 56.77it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 54.27it/s]backtest loop:  76%|███████▌  | 737/971 [00:13<00:04, 55.83it/s]backtest loop:  77%|███████▋  | 743/971 [00:13<00:04, 53.50it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 52.99it/s]backtest loop:  78%|███████▊  | 756/971 [00:13<00:03, 54.84it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 55.91it/s]backtest loop:  79%|███████▉  | 768/971 [00:14<00:03, 56.93it/s]backtest loop:  80%|███████▉  | 774/971 [00:14<00:03, 57.70it/s]backtest loop:  80%|████████  | 780/971 [00:14<00:03, 54.87it/s]backtest loop:  81%|████████  | 787/971 [00:14<00:03, 57.06it/s]backtest loop:  82%|████████▏ | 793/971 [00:14<00:03, 54.53it/s]backtest loop:  82%|████████▏ | 799/971 [00:14<00:03, 55.99it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:02, 56.66it/s]backtest loop:  84%|████████▎ | 812/971 [00:14<00:02, 58.56it/s]backtest loop:  84%|████████▍ | 818/971 [00:14<00:02, 55.21it/s]backtest loop:  85%|████████▍ | 824/971 [00:15<00:02, 56.41it/s]backtest loop:  86%|████████▌ | 831/971 [00:15<00:02, 58.23it/s]backtest loop:  86%|████████▌ | 837/971 [00:15<00:02, 58.53it/s]backtest loop:  87%|████████▋ | 843/971 [00:15<00:02, 55.44it/s]backtest loop:  87%|████████▋ | 849/971 [00:15<00:02, 56.64it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:02, 57.50it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 55.48it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 57.49it/s]backtest loop:  90%|█████████ | 875/971 [00:15<00:01, 57.86it/s]backtest loop:  91%|█████████ | 882/971 [00:16<00:01, 55.78it/s]backtest loop:  91%|█████████▏| 888/971 [00:16<00:01, 56.90it/s]backtest loop:  92%|█████████▏| 894/971 [00:16<00:01, 57.65it/s]backtest loop:  93%|█████████▎| 901/971 [00:16<00:01, 59.05it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 55.87it/s]backtest loop:  94%|█████████▍| 914/971 [00:16<00:00, 57.71it/s]backtest loop:  95%|█████████▍| 921/971 [00:16<00:00, 55.81it/s]backtest loop:  95%|█████████▌| 927/971 [00:16<00:00, 56.86it/s]backtest loop:  96%|█████████▌| 933/971 [00:16<00:00, 57.63it/s]backtest loop:  97%|█████████▋| 939/971 [00:17<00:00, 58.24it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 54.92it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 57.29it/s]backtest loop:  99%|█████████▊| 958/971 [00:17<00:00, 58.04it/s]backtest loop:  99%|█████████▉| 964/971 [00:17<00:00, 58.37it/s]backtest loop: 100%|█████████▉| 970/971 [00:17<00:00, 55.39it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.96it/s]
[3553693:MainThread](2024-04-26 08:56:44,239) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000645
std                0.006490
annualized_return  0.153594
information_ratio  1.534115
max_drawdown      -0.081640
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000447
std                0.006490
annualized_return  0.106436
information_ratio  1.062985
max_drawdown      -0.106674
[3553693:MainThread](2024-04-26 08:56:44,255) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_Localformer_alpha360_horizon1_step20_rankFalse_2024-04-26_03:34:20_online`.
Round 8 Done!
{'1day.excess_return_with_cost.annualized_return': [0.07075714264527615,
                                                    0.10850427937124411,
                                                    0.06685286326248528,
                                                    0.08608948157805843,
                                                    0.07682903517339368,
                                                    0.059029409217761133,
                                                    0.090443017988795,
                                                    0.10643622238339623],
 '1day.excess_return_with_cost.information_ratio': [0.7604996387958325,
                                                    1.2020537825981399,
                                                    0.7125046093662444,
                                                    0.8904572108774373,
                                                    0.8708896268691235,
                                                    0.6478405490692812,
                                                    0.9748413400836983,
                                                    1.0629849388113022],
 '1day.excess_return_with_cost.max_drawdown': [-0.14329134900291735,
                                               -0.12316472001361661,
                                               -0.1646927914298363,
                                               -0.13001096080026223,
                                               -0.11819781308791061,
                                               -0.16518671305225527,
                                               -0.13708383052832637,
                                               -0.10667381459091807],
 'IC': [0.023486286189309008,
        0.02791365222447451,
        0.02441311490294145,
        0.023209719834113737,
        0.02556309432113134,
        0.023518064772987516,
        0.024515036617226375,
        0.02656099433765106],
 'ICIR': [0.17230008880149675,
          0.19858094896927955,
          0.17400805891726157,
          0.16495475959030012,
          0.1764065044712292,
          0.1635279171880803,
          0.15749937419058055,
          0.185415034924459],
 'Rank IC': [0.01784804193762672,
             0.025047469820677314,
             0.017413522190489108,
             0.016932903948649526,
             0.021804135075245198,
             0.01589400216650591,
             0.01953202024121043,
             0.015610754757772752],
 'Rank ICIR': [0.12653690606414603,
               0.1780858675400394,
               0.12095496861110042,
               0.1191049590209752,
               0.15427744155570366,
               0.10779982689789028,
               0.122363202162894,
               0.10729239275972464],
 'mae': [0.7075116038322449,
         0.707405149936676,
         0.7074940800666809,
         0.707470715045929,
         0.7074753046035767,
         0.7074763178825378,
         0.7075409889221191,
         0.7075148224830627],
 'mse': [0.9960588812828064,
         0.9957895874977112,
         0.9961219429969788,
         0.9960362911224365,
         0.9959264397621155,
         0.9960545301437378,
         0.9962356686592102,
         0.9960511326789856]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3553693:MainThread](2024-04-26 08:56:45,429) INFO - qlib.TransformerModel - [pytorch_localformer.py:64] - Naive Transformer:
batch_size : 2048
device : cuda:0
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:53<1:27:43, 53.17s/it]epoch:   2%|▏         | 2/100 [01:46<1:27:10, 53.37s/it]epoch:   3%|▎         | 3/100 [02:40<1:26:24, 53.45s/it]epoch:   4%|▍         | 4/100 [03:33<1:25:23, 53.37s/it]epoch:   5%|▌         | 5/100 [04:26<1:24:26, 53.34s/it]epoch:   6%|▌         | 6/100 [05:19<1:23:26, 53.26s/it]epoch:   7%|▋         | 7/100 [06:12<1:22:27, 53.20s/it]epoch:   8%|▊         | 8/100 [07:06<1:21:34, 53.20s/it]epoch:   9%|▉         | 9/100 [07:59<1:20:43, 53.23s/it]epoch:  10%|█         | 10/100 [08:52<1:19:54, 53.27s/it]epoch:  11%|█         | 11/100 [09:46<1:19:01, 53.28s/it]epoch:  12%|█▏        | 12/100 [10:39<1:18:03, 53.22s/it]epoch:  13%|█▎        | 13/100 [11:32<1:17:06, 53.18s/it]epoch:  14%|█▍        | 14/100 [12:25<1:16:12, 53.17s/it]epoch:  15%|█▌        | 15/100 [13:18<1:15:12, 53.09s/it]epoch:  16%|█▌        | 16/100 [14:11<1:14:18, 53.08s/it]epoch:  17%|█▋        | 17/100 [15:04<1:13:19, 53.01s/it]epoch:  18%|█▊        | 18/100 [15:57<1:12:23, 52.96s/it]epoch:  19%|█▉        | 19/100 [16:49<1:11:28, 52.94s/it]epoch:  20%|██        | 20/100 [17:42<1:10:37, 52.96s/it]epoch:  21%|██        | 21/100 [18:35<1:09:41, 52.93s/it]epoch:  22%|██▏       | 22/100 [19:28<1:08:51, 52.97s/it]epoch:  23%|██▎       | 23/100 [20:21<1:07:56, 52.94s/it]epoch:  24%|██▍       | 24/100 [21:14<1:07:03, 52.95s/it]epoch:  25%|██▌       | 25/100 [22:07<1:06:16, 53.02s/it]epoch:  26%|██▌       | 26/100 [23:00<1:05:23, 53.01s/it]epoch:  27%|██▋       | 27/100 [23:54<1:04:36, 53.10s/it]epoch:  28%|██▊       | 28/100 [24:47<1:03:42, 53.08s/it]epoch:  29%|██▉       | 29/100 [25:40<1:02:48, 53.08s/it]epoch:  30%|███       | 30/100 [26:33<1:01:51, 53.02s/it]0.0572725592135477
best ic: 0.0572725592135477
epoch:  31%|███       | 31/100 [27:32<1:03:13, 54.97s/it]0.046980075824680397
epoch:  32%|███▏      | 32/100 [28:32<1:03:47, 56.29s/it]0.057246077889740406
epoch:  33%|███▎      | 33/100 [29:31<1:03:54, 57.22s/it]0.05337936471644873
epoch:  34%|███▍      | 34/100 [30:30<1:03:35, 57.81s/it]0.0503333836092563
epoch:  35%|███▌      | 35/100 [31:30<1:03:12, 58.34s/it]0.056235872320015166
epoch:  36%|███▌      | 36/100 [32:29<1:02:36, 58.70s/it]0.05411803928000031
epoch:  37%|███▋      | 37/100 [33:29<1:01:47, 58.86s/it]0.050997625488423126
epoch:  38%|███▊      | 38/100 [34:28<1:00:57, 58.99s/it]0.05408246216023109
epoch:  38%|███▊      | 38/100 [35:27<57:51, 55.99s/it]  
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3553693:MainThread](2024-04-26 09:32:13,091) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3553693:MainThread](2024-04-26 09:32:13,105) INFO - qlib.workflow - [recorder.py:341] - Recorder 630d4425bd0243deb4ed41cbdcaace24 starts running under Experiment 53 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:20,  3.03it/s]online:   3%|▎         | 2/63 [00:00<00:22,  2.67it/s]online:   5%|▍         | 3/63 [00:01<00:23,  2.56it/s]online:   6%|▋         | 4/63 [00:01<00:23,  2.52it/s]online:   8%|▊         | 5/63 [00:01<00:23,  2.50it/s]online:  10%|▉         | 6/63 [00:02<00:23,  2.47it/s]online:  11%|█         | 7/63 [00:02<00:22,  2.46it/s]online:  13%|█▎        | 8/63 [00:03<00:22,  2.45it/s]online:  14%|█▍        | 9/63 [00:03<00:22,  2.45it/s]online:  16%|█▌        | 10/63 [00:04<00:21,  2.44it/s]online:  17%|█▋        | 11/63 [00:04<00:21,  2.44it/s]online:  19%|█▉        | 12/63 [00:04<00:20,  2.44it/s]online:  21%|██        | 13/63 [00:05<00:20,  2.42it/s]online:  22%|██▏       | 14/63 [00:05<00:20,  2.42it/s]online:  24%|██▍       | 15/63 [00:06<00:19,  2.43it/s]online:  25%|██▌       | 16/63 [00:06<00:19,  2.44it/s]online:  27%|██▋       | 17/63 [00:06<00:18,  2.44it/s]online:  29%|██▊       | 18/63 [00:07<00:18,  2.43it/s]online:  30%|███       | 19/63 [00:07<00:18,  2.43it/s]online:  32%|███▏      | 20/63 [00:08<00:17,  2.43it/s]online:  33%|███▎      | 21/63 [00:08<00:17,  2.43it/s]online:  35%|███▍      | 22/63 [00:08<00:16,  2.44it/s]online:  37%|███▋      | 23/63 [00:09<00:16,  2.43it/s]online:  38%|███▊      | 24/63 [00:09<00:16,  2.43it/s]online:  40%|███▉      | 25/63 [00:10<00:15,  2.42it/s]online:  41%|████▏     | 26/63 [00:10<00:15,  2.43it/s]online:  43%|████▎     | 27/63 [00:11<00:14,  2.43it/s]online:  44%|████▍     | 28/63 [00:11<00:14,  2.43it/s]online:  46%|████▌     | 29/63 [00:11<00:13,  2.43it/s]online:  48%|████▊     | 30/63 [00:12<00:13,  2.43it/s]online:  49%|████▉     | 31/63 [00:12<00:13,  2.42it/s]online:  51%|█████     | 32/63 [00:13<00:12,  2.42it/s]online:  52%|█████▏    | 33/63 [00:13<00:12,  2.43it/s]online:  54%|█████▍    | 34/63 [00:13<00:11,  2.43it/s]online:  56%|█████▌    | 35/63 [00:14<00:11,  2.42it/s]online:  57%|█████▋    | 36/63 [00:14<00:11,  2.44it/s]online:  59%|█████▊    | 37/63 [00:15<00:10,  2.43it/s]online:  60%|██████    | 38/63 [00:15<00:10,  2.43it/s]online:  62%|██████▏   | 39/63 [00:15<00:09,  2.42it/s]online:  63%|██████▎   | 40/63 [00:16<00:09,  2.43it/s]online:  65%|██████▌   | 41/63 [00:16<00:09,  2.43it/s]online:  67%|██████▋   | 42/63 [00:17<00:08,  2.43it/s]online:  68%|██████▊   | 43/63 [00:17<00:08,  2.43it/s]online:  70%|██████▉   | 44/63 [00:18<00:07,  2.43it/s]online:  71%|███████▏  | 45/63 [00:18<00:07,  2.43it/s]online:  73%|███████▎  | 46/63 [00:18<00:07,  2.43it/s]online:  75%|███████▍  | 47/63 [00:19<00:06,  2.43it/s]online:  76%|███████▌  | 48/63 [00:19<00:06,  2.43it/s]online:  78%|███████▊  | 49/63 [00:20<00:05,  2.43it/s]online:  79%|███████▉  | 50/63 [00:20<00:05,  2.43it/s]online:  81%|████████  | 51/63 [00:20<00:04,  2.42it/s]online:  83%|████████▎ | 52/63 [00:21<00:04,  2.42it/s]online:  84%|████████▍ | 53/63 [00:21<00:04,  2.42it/s]online:  86%|████████▌ | 54/63 [00:22<00:03,  2.42it/s]online:  87%|████████▋ | 55/63 [00:22<00:03,  2.42it/s]online:  89%|████████▉ | 56/63 [00:22<00:02,  2.41it/s]online:  90%|█████████ | 57/63 [00:23<00:02,  2.42it/s]online:  92%|█████████▏| 58/63 [00:23<00:02,  2.41it/s]online:  94%|█████████▎| 59/63 [00:24<00:01,  2.42it/s]online:  95%|█████████▌| 60/63 [00:24<00:01,  2.42it/s]online:  97%|█████████▋| 61/63 [00:25<00:00,  2.42it/s]online:  98%|█████████▊| 62/63 [00:25<00:00,  2.42it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.50it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.44it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3553693:MainThread](2024-04-26 09:32:47,604) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9958461 mae 0.70736355
{'IC': 0.028996598518193386,
 'ICIR': 0.19232313936865622,
 'Rank IC': 0.025066074036637544,
 'Rank ICIR': 0.16360873889426036}
[3553693:MainThread](2024-04-26 09:32:49,411) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3553693:MainThread](2024-04-26 09:33:00,989) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 09:33:00,992) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 09:33:07,108) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fd64fd47bb0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:44,  9.26it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.56it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 35.25it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.90it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.63it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.75it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.08it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.14it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.57it/s]backtest loop:   6%|▌         | 60/971 [00:01<00:16, 55.20it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.39it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 56.98it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 58.47it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 55.53it/s]backtest loop:  10%|▉         | 93/971 [00:01<00:15, 56.55it/s]backtest loop:  10%|█         | 100/971 [00:02<00:14, 58.29it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.46it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 58.07it/s]backtest loop:  12%|█▏        | 120/971 [00:02<00:14, 58.47it/s]backtest loop:  13%|█▎        | 126/971 [00:02<00:16, 52.57it/s]backtest loop:  14%|█▎        | 132/971 [00:02<00:15, 54.48it/s]backtest loop:  14%|█▍        | 139/971 [00:02<00:14, 56.82it/s]backtest loop:  15%|█▌        | 146/971 [00:02<00:14, 55.47it/s]backtest loop:  16%|█▌        | 153/971 [00:02<00:14, 57.46it/s]backtest loop:  16%|█▋        | 160/971 [00:03<00:13, 58.81it/s]backtest loop:  17%|█▋        | 166/971 [00:03<00:14, 55.70it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:13, 57.54it/s]backtest loop:  19%|█▊        | 180/971 [00:03<00:13, 58.93it/s]backtest loop:  19%|█▉        | 186/971 [00:03<00:14, 55.84it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:13, 56.30it/s]backtest loop:  20%|██        | 198/971 [00:03<00:13, 57.22it/s]backtest loop:  21%|██        | 205/971 [00:03<00:13, 55.51it/s]backtest loop:  22%|██▏       | 212/971 [00:04<00:13, 57.70it/s]backtest loop:  22%|██▏       | 218/971 [00:04<00:13, 55.15it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:13, 54.26it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:13, 55.69it/s]backtest loop:  25%|██▍       | 238/971 [00:04<00:12, 57.89it/s]backtest loop:  25%|██▌       | 245/971 [00:04<00:12, 55.96it/s]backtest loop:  26%|██▌       | 252/971 [00:04<00:12, 57.82it/s]backtest loop:  27%|██▋       | 259/971 [00:04<00:12, 55.89it/s]backtest loop:  27%|██▋       | 266/971 [00:04<00:12, 54.68it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 57.00it/s]backtest loop:  29%|██▊       | 279/971 [00:05<00:12, 57.54it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 55.64it/s]backtest loop:  30%|███       | 292/971 [00:05<00:11, 56.65it/s]backtest loop:  31%|███       | 299/971 [00:05<00:11, 58.50it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:12, 55.42it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 57.55it/s]backtest loop:  33%|███▎      | 318/971 [00:05<00:11, 58.03it/s]backtest loop:  33%|███▎      | 325/971 [00:06<00:11, 55.90it/s]backtest loop:  34%|███▍      | 331/971 [00:06<00:11, 56.98it/s]backtest loop:  35%|███▍      | 338/971 [00:06<00:10, 58.77it/s]backtest loop:  35%|███▌      | 344/971 [00:06<00:10, 58.74it/s]backtest loop:  36%|███▌      | 350/971 [00:06<00:11, 55.79it/s]backtest loop:  37%|███▋      | 356/971 [00:06<00:10, 56.88it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:10, 55.37it/s]backtest loop:  38%|███▊      | 369/971 [00:06<00:11, 53.48it/s]backtest loop:  39%|███▊      | 376/971 [00:06<00:10, 55.88it/s]backtest loop:  39%|███▉      | 383/971 [00:07<00:10, 54.52it/s]backtest loop:  40%|████      | 389/971 [00:07<00:10, 55.90it/s]backtest loop:  41%|████      | 396/971 [00:07<00:09, 57.87it/s]backtest loop:  41%|████▏     | 402/971 [00:07<00:09, 58.33it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:10, 55.46it/s]backtest loop:  43%|████▎     | 414/971 [00:07<00:09, 56.54it/s]backtest loop:  43%|████▎     | 420/971 [00:07<00:09, 57.38it/s]backtest loop:  44%|████▍     | 426/971 [00:07<00:09, 57.80it/s]backtest loop:  44%|████▍     | 432/971 [00:07<00:09, 54.74it/s]backtest loop:  45%|████▌     | 438/971 [00:08<00:09, 56.18it/s]backtest loop:  46%|████▌     | 444/971 [00:08<00:09, 57.11it/s]backtest loop:  46%|████▋     | 450/971 [00:08<00:08, 57.90it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:09, 55.71it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:08, 57.58it/s]backtest loop:  48%|████▊     | 470/971 [00:08<00:08, 57.99it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:08, 56.06it/s]backtest loop:  50%|████▉     | 483/971 [00:08<00:08, 57.06it/s]backtest loop:  50%|█████     | 489/971 [00:09<00:13, 34.93it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:12, 38.13it/s]backtest loop:  52%|█████▏    | 501/971 [00:09<00:11, 42.53it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:10, 44.23it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:09, 48.90it/s]backtest loop:  54%|█████▎    | 520/971 [00:09<00:08, 51.41it/s]backtest loop:  54%|█████▍    | 526/971 [00:09<00:08, 50.73it/s]backtest loop:  55%|█████▍    | 532/971 [00:09<00:08, 53.03it/s]backtest loop:  55%|█████▌    | 538/971 [00:10<00:07, 54.90it/s]backtest loop:  56%|█████▌    | 545/971 [00:10<00:07, 56.94it/s]backtest loop:  57%|█████▋    | 551/971 [00:10<00:07, 54.44it/s]backtest loop:  57%|█████▋    | 557/971 [00:10<00:07, 55.89it/s]backtest loop:  58%|█████▊    | 563/971 [00:10<00:07, 56.78it/s]backtest loop:  59%|█████▊    | 570/971 [00:10<00:06, 58.41it/s]backtest loop:  59%|█████▉    | 576/971 [00:10<00:07, 55.11it/s]backtest loop:  60%|█████▉    | 582/971 [00:10<00:06, 56.43it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:06, 57.39it/s]backtest loop:  61%|██████    | 594/971 [00:10<00:06, 57.85it/s]backtest loop:  62%|██████▏   | 600/971 [00:11<00:06, 54.93it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 57.09it/s]backtest loop:  63%|██████▎   | 613/971 [00:11<00:06, 57.87it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:06, 58.34it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 55.29it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 57.60it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 58.95it/s]backtest loop:  66%|██████▋   | 645/971 [00:11<00:05, 55.84it/s]backtest loop:  67%|██████▋   | 651/971 [00:12<00:05, 56.84it/s]backtest loop:  68%|██████▊   | 657/971 [00:12<00:05, 57.67it/s]backtest loop:  68%|██████▊   | 663/971 [00:12<00:05, 58.28it/s]backtest loop:  69%|██████▉   | 669/971 [00:12<00:05, 58.71it/s]backtest loop:  70%|██████▉   | 675/971 [00:12<00:05, 55.39it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:05, 56.51it/s]backtest loop:  71%|███████   | 687/971 [00:12<00:04, 57.31it/s]backtest loop:  71%|███████▏  | 693/971 [00:12<00:04, 57.85it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 54.77it/s]backtest loop:  73%|███████▎  | 705/971 [00:12<00:04, 56.17it/s]backtest loop:  73%|███████▎  | 711/971 [00:13<00:04, 56.38it/s]backtest loop:  74%|███████▍  | 717/971 [00:13<00:04, 57.41it/s]backtest loop:  74%|███████▍  | 723/971 [00:13<00:04, 58.09it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 55.10it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 53.08it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 54.69it/s]backtest loop:  77%|███████▋  | 747/971 [00:13<00:03, 56.03it/s]backtest loop:  78%|███████▊  | 753/971 [00:13<00:04, 53.77it/s]backtest loop:  78%|███████▊  | 759/971 [00:13<00:03, 55.43it/s]backtest loop:  79%|███████▉  | 765/971 [00:14<00:03, 53.40it/s]backtest loop:  80%|███████▉  | 772/971 [00:14<00:03, 56.06it/s]backtest loop:  80%|████████  | 779/971 [00:14<00:03, 57.87it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 55.25it/s]backtest loop:  81%|████████▏ | 791/971 [00:14<00:03, 56.43it/s]backtest loop:  82%|████████▏ | 797/971 [00:14<00:03, 57.40it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:03, 54.64it/s]backtest loop:  83%|████████▎ | 809/971 [00:14<00:02, 55.92it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 57.00it/s]backtest loop:  85%|████████▍ | 821/971 [00:15<00:02, 57.85it/s]backtest loop:  85%|████████▌ | 827/971 [00:15<00:02, 58.41it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 55.03it/s]backtest loop:  87%|████████▋ | 840/971 [00:15<00:02, 57.18it/s]backtest loop:  87%|████████▋ | 846/971 [00:15<00:02, 57.94it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 55.06it/s]backtest loop:  88%|████████▊ | 858/971 [00:15<00:02, 56.37it/s]backtest loop:  89%|████████▉ | 864/971 [00:15<00:01, 57.26it/s]backtest loop:  90%|████████▉ | 871/971 [00:15<00:01, 58.82it/s]backtest loop:  90%|█████████ | 877/971 [00:16<00:01, 55.56it/s]backtest loop:  91%|█████████ | 883/971 [00:16<00:01, 56.76it/s]backtest loop:  92%|█████████▏| 889/971 [00:16<00:01, 57.58it/s]backtest loop:  92%|█████████▏| 895/971 [00:16<00:01, 58.22it/s]backtest loop:  93%|█████████▎| 901/971 [00:16<00:01, 58.56it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 55.36it/s]backtest loop:  94%|█████████▍| 913/971 [00:16<00:01, 56.65it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 57.28it/s]backtest loop:  95%|█████████▌| 925/971 [00:16<00:00, 57.99it/s]backtest loop:  96%|█████████▌| 931/971 [00:16<00:00, 55.02it/s]backtest loop:  96%|█████████▋| 937/971 [00:17<00:00, 56.23it/s]backtest loop:  97%|█████████▋| 943/971 [00:17<00:00, 57.24it/s]backtest loop:  98%|█████████▊| 950/971 [00:17<00:00, 55.31it/s]backtest loop:  98%|█████████▊| 956/971 [00:17<00:00, 56.32it/s]backtest loop:  99%|█████████▉| 963/971 [00:17<00:00, 58.25it/s]backtest loop: 100%|█████████▉| 969/971 [00:17<00:00, 58.65it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.95it/s]
[3553693:MainThread](2024-04-26 09:33:24,852) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000602
std                0.005740
annualized_return  0.143290
information_ratio  1.618064
max_drawdown      -0.090400
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000406
std                0.005740
annualized_return  0.096603
information_ratio  1.090892
max_drawdown      -0.114154
[3553693:MainThread](2024-04-26 09:33:24,868) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_Localformer_alpha360_horizon1_step20_rankFalse_2024-04-26_03:34:20_online`.
Round 9 Done!
{'1day.excess_return_with_cost.annualized_return': [0.07075714264527615,
                                                    0.10850427937124411,
                                                    0.06685286326248528,
                                                    0.08608948157805843,
                                                    0.07682903517339368,
                                                    0.059029409217761133,
                                                    0.090443017988795,
                                                    0.10643622238339623,
                                                    0.09660285159129235],
 '1day.excess_return_with_cost.information_ratio': [0.7604996387958325,
                                                    1.2020537825981399,
                                                    0.7125046093662444,
                                                    0.8904572108774373,
                                                    0.8708896268691235,
                                                    0.6478405490692812,
                                                    0.9748413400836983,
                                                    1.0629849388113022,
                                                    1.0908919764028806],
 '1day.excess_return_with_cost.max_drawdown': [-0.14329134900291735,
                                               -0.12316472001361661,
                                               -0.1646927914298363,
                                               -0.13001096080026223,
                                               -0.11819781308791061,
                                               -0.16518671305225527,
                                               -0.13708383052832637,
                                               -0.10667381459091807,
                                               -0.1141544521003029],
 'IC': [0.023486286189309008,
        0.02791365222447451,
        0.02441311490294145,
        0.023209719834113737,
        0.02556309432113134,
        0.023518064772987516,
        0.024515036617226375,
        0.02656099433765106,
        0.028996598518193386],
 'ICIR': [0.17230008880149675,
          0.19858094896927955,
          0.17400805891726157,
          0.16495475959030012,
          0.1764065044712292,
          0.1635279171880803,
          0.15749937419058055,
          0.185415034924459,
          0.19232313936865622],
 'Rank IC': [0.01784804193762672,
             0.025047469820677314,
             0.017413522190489108,
             0.016932903948649526,
             0.021804135075245198,
             0.01589400216650591,
             0.01953202024121043,
             0.015610754757772752,
             0.025066074036637544],
 'Rank ICIR': [0.12653690606414603,
               0.1780858675400394,
               0.12095496861110042,
               0.1191049590209752,
               0.15427744155570366,
               0.10779982689789028,
               0.122363202162894,
               0.10729239275972464,
               0.16360873889426036],
 'mae': [0.7075116038322449,
         0.707405149936676,
         0.7074940800666809,
         0.707470715045929,
         0.7074753046035767,
         0.7074763178825378,
         0.7075409889221191,
         0.7075148224830627,
         0.7073635458946228],
 'mse': [0.9960588812828064,
         0.9957895874977112,
         0.9961219429969788,
         0.9960362911224365,
         0.9959264397621155,
         0.9960545301437378,
         0.9962356686592102,
         0.9960511326789856,
         0.9958460927009583]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[3553693:MainThread](2024-04-26 09:33:26,042) INFO - qlib.TransformerModel - [pytorch_localformer.py:64] - Naive Transformer:
batch_size : 2048
device : cuda:0
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:52<1:27:11, 52.84s/it]epoch:   2%|▏         | 2/100 [01:46<1:26:48, 53.15s/it]epoch:   3%|▎         | 3/100 [02:39<1:26:12, 53.32s/it]epoch:   4%|▍         | 4/100 [03:32<1:25:16, 53.30s/it]epoch:   5%|▌         | 5/100 [04:26<1:24:20, 53.27s/it]epoch:   6%|▌         | 6/100 [05:19<1:23:34, 53.35s/it]epoch:   7%|▋         | 7/100 [06:12<1:22:33, 53.27s/it]epoch:   8%|▊         | 8/100 [07:06<1:21:48, 53.35s/it]epoch:   9%|▉         | 9/100 [07:59<1:21:01, 53.42s/it]epoch:  10%|█         | 10/100 [08:53<1:20:07, 53.42s/it]epoch:  11%|█         | 11/100 [09:46<1:19:17, 53.46s/it]epoch:  12%|█▏        | 12/100 [10:40<1:18:17, 53.38s/it]epoch:  13%|█▎        | 13/100 [11:33<1:17:15, 53.29s/it]epoch:  14%|█▍        | 14/100 [12:26<1:16:14, 53.19s/it]epoch:  15%|█▌        | 15/100 [13:19<1:15:18, 53.16s/it]epoch:  16%|█▌        | 16/100 [14:12<1:14:19, 53.09s/it]epoch:  17%|█▋        | 17/100 [15:05<1:13:30, 53.14s/it]epoch:  18%|█▊        | 18/100 [15:58<1:12:37, 53.14s/it]epoch:  19%|█▉        | 19/100 [16:51<1:11:46, 53.17s/it]epoch:  20%|██        | 20/100 [17:45<1:10:58, 53.23s/it]epoch:  21%|██        | 21/100 [18:38<1:09:59, 53.16s/it]epoch:  22%|██▏       | 22/100 [19:31<1:09:03, 53.12s/it]epoch:  23%|██▎       | 23/100 [20:24<1:08:07, 53.09s/it]epoch:  24%|██▍       | 24/100 [21:17<1:07:12, 53.06s/it]epoch:  25%|██▌       | 25/100 [22:10<1:06:16, 53.02s/it]epoch:  26%|██▌       | 26/100 [23:03<1:05:23, 53.02s/it]epoch:  27%|██▋       | 27/100 [23:56<1:04:31, 53.03s/it]epoch:  28%|██▊       | 28/100 [24:49<1:03:44, 53.12s/it]epoch:  29%|██▉       | 29/100 [25:42<1:02:47, 53.07s/it]epoch:  30%|███       | 30/100 [26:35<1:01:51, 53.02s/it]0.054452952591249895
best ic: 0.054452952591249895
epoch:  31%|███       | 31/100 [27:35<1:03:18, 55.05s/it]0.05955334611280835
best ic: 0.05955334611280835
epoch:  32%|███▏      | 32/100 [28:34<1:03:58, 56.44s/it]0.05637452630302462
epoch:  33%|███▎      | 33/100 [29:34<1:04:06, 57.41s/it]0.061127835984603654
best ic: 0.061127835984603654
epoch:  34%|███▍      | 34/100 [30:34<1:03:58, 58.16s/it]0.054301452789708146
epoch:  35%|███▌      | 35/100 [31:33<1:03:22, 58.50s/it]0.057221807232164135
epoch:  36%|███▌      | 36/100 [32:33<1:02:44, 58.83s/it]0.05615060759705673
epoch:  37%|███▋      | 37/100 [33:32<1:02:00, 59.06s/it]0.05594279317022178
epoch:  38%|███▊      | 38/100 [34:32<1:01:17, 59.32s/it]0.06161983052310722
best ic: 0.06161983052310722
epoch:  39%|███▉      | 39/100 [35:32<1:00:19, 59.33s/it]0.05664979462266931
epoch:  40%|████      | 40/100 [36:31<59:26, 59.44s/it]  0.053203103289958836
epoch:  41%|████      | 41/100 [37:31<58:32, 59.53s/it]0.05284512286873064
epoch:  42%|████▏     | 42/100 [38:31<57:31, 59.51s/it]0.049136589678348344
epoch:  43%|████▎     | 43/100 [39:30<56:37, 59.60s/it]0.04763244843415539
epoch:  44%|████▍     | 44/100 [40:30<55:37, 59.60s/it]0.03926864391982839
epoch:  45%|████▌     | 45/100 [41:29<54:35, 59.55s/it]0.04868105063719704
epoch:  46%|████▌     | 46/100 [42:29<53:33, 59.50s/it]0.043045672394015494
epoch:  46%|████▌     | 46/100 [43:28<51:02, 56.71s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[3553693:MainThread](2024-04-26 10:16:54,949) INFO - qlib.workflow - [exp.py:258] - Experiment 53 starts running ...
[3553693:MainThread](2024-04-26 10:16:54,963) INFO - qlib.workflow - [recorder.py:341] - Recorder b40b502e71f34b95bf12cc16ca7137a0 starts running under Experiment 53 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   2%|▏         | 1/63 [00:00<00:20,  3.02it/s]online:   3%|▎         | 2/63 [00:00<00:22,  2.67it/s]online:   5%|▍         | 3/63 [00:01<00:23,  2.56it/s]online:   6%|▋         | 4/63 [00:01<00:23,  2.51it/s]online:   8%|▊         | 5/63 [00:01<00:23,  2.47it/s]online:  10%|▉         | 6/63 [00:02<00:23,  2.47it/s]online:  11%|█         | 7/63 [00:02<00:22,  2.46it/s]online:  13%|█▎        | 8/63 [00:03<00:22,  2.46it/s]online:  14%|█▍        | 9/63 [00:03<00:22,  2.45it/s]online:  16%|█▌        | 10/63 [00:04<00:21,  2.46it/s]online:  17%|█▋        | 11/63 [00:04<00:21,  2.45it/s]online:  19%|█▉        | 12/63 [00:04<00:20,  2.44it/s]online:  21%|██        | 13/63 [00:05<00:20,  2.45it/s]online:  22%|██▏       | 14/63 [00:05<00:20,  2.45it/s]online:  24%|██▍       | 15/63 [00:06<00:19,  2.45it/s]online:  25%|██▌       | 16/63 [00:06<00:19,  2.45it/s]online:  27%|██▋       | 17/63 [00:06<00:18,  2.44it/s]online:  29%|██▊       | 18/63 [00:07<00:18,  2.43it/s]online:  30%|███       | 19/63 [00:07<00:17,  2.45it/s]online:  32%|███▏      | 20/63 [00:08<00:17,  2.44it/s]online:  33%|███▎      | 21/63 [00:08<00:17,  2.44it/s]online:  35%|███▍      | 22/63 [00:08<00:16,  2.44it/s]online:  37%|███▋      | 23/63 [00:09<00:16,  2.43it/s]online:  38%|███▊      | 24/63 [00:09<00:16,  2.43it/s]online:  40%|███▉      | 25/63 [00:10<00:15,  2.44it/s]online:  41%|████▏     | 26/63 [00:10<00:15,  2.43it/s]online:  43%|████▎     | 27/63 [00:10<00:14,  2.44it/s]online:  44%|████▍     | 28/63 [00:11<00:14,  2.43it/s]online:  46%|████▌     | 29/63 [00:11<00:13,  2.43it/s]online:  48%|████▊     | 30/63 [00:12<00:13,  2.45it/s]online:  49%|████▉     | 31/63 [00:12<00:13,  2.44it/s]online:  51%|█████     | 32/63 [00:13<00:12,  2.44it/s]online:  52%|█████▏    | 33/63 [00:13<00:12,  2.43it/s]online:  54%|█████▍    | 34/63 [00:13<00:11,  2.43it/s]online:  56%|█████▌    | 35/63 [00:14<00:11,  2.44it/s]online:  57%|█████▋    | 36/63 [00:14<00:11,  2.44it/s]online:  59%|█████▊    | 37/63 [00:15<00:10,  2.44it/s]online:  60%|██████    | 38/63 [00:15<00:10,  2.44it/s]online:  62%|██████▏   | 39/63 [00:15<00:09,  2.44it/s]online:  63%|██████▎   | 40/63 [00:16<00:09,  2.43it/s]online:  65%|██████▌   | 41/63 [00:16<00:09,  2.43it/s]online:  67%|██████▋   | 42/63 [00:17<00:08,  2.44it/s]online:  68%|██████▊   | 43/63 [00:17<00:08,  2.42it/s]online:  70%|██████▉   | 44/63 [00:17<00:07,  2.44it/s]online:  71%|███████▏  | 45/63 [00:18<00:07,  2.43it/s]online:  73%|███████▎  | 46/63 [00:18<00:06,  2.43it/s]online:  75%|███████▍  | 47/63 [00:19<00:06,  2.42it/s]online:  76%|███████▌  | 48/63 [00:19<00:06,  2.44it/s]online:  78%|███████▊  | 49/63 [00:20<00:05,  2.44it/s]online:  79%|███████▉  | 50/63 [00:20<00:05,  2.43it/s]online:  81%|████████  | 51/63 [00:20<00:04,  2.42it/s]online:  83%|████████▎ | 52/63 [00:21<00:04,  2.43it/s]online:  84%|████████▍ | 53/63 [00:21<00:04,  2.43it/s]online:  86%|████████▌ | 54/63 [00:22<00:03,  2.43it/s]online:  87%|████████▋ | 55/63 [00:22<00:03,  2.43it/s]online:  89%|████████▉ | 56/63 [00:22<00:02,  2.42it/s]online:  90%|█████████ | 57/63 [00:23<00:02,  2.43it/s]online:  92%|█████████▏| 58/63 [00:23<00:02,  2.42it/s]online:  94%|█████████▎| 59/63 [00:24<00:01,  2.43it/s]online:  95%|█████████▌| 60/63 [00:24<00:01,  2.43it/s]online:  97%|█████████▋| 61/63 [00:24<00:00,  2.43it/s]online:  98%|█████████▊| 62/63 [00:25<00:00,  2.43it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.53it/s]online: 100%|██████████| 63/63 [00:25<00:00,  2.45it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[3553693:MainThread](2024-04-26 10:17:29,346) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9960078 mae 0.70741695
{'IC': 0.02386093509168038,
 'ICIR': 0.16816278415303323,
 'Rank IC': 0.01707658902086641,
 'Rank ICIR': 0.11992560751243798}
[3553693:MainThread](2024-04-26 10:17:31,116) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[3553693:MainThread](2024-04-26 10:17:42,807) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 10:17:42,810) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[3553693:MainThread](2024-04-26 10:17:48,926) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7fd654803eb0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:47,  9.04it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.28it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 34.87it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.77it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.50it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.68it/s]backtest loop:   4%|▍         | 41/971 [00:01<00:17, 52.00it/s]backtest loop:   5%|▍         | 47/971 [00:01<00:17, 54.15it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.42it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 55.97it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.06it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 56.43it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 58.18it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 55.78it/s]backtest loop:  10%|▉         | 93/971 [00:01<00:15, 56.28it/s]backtest loop:  10%|█         | 100/971 [00:02<00:15, 58.02it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.11it/s]backtest loop:  12%|█▏        | 113/971 [00:02<00:15, 57.11it/s]backtest loop:  12%|█▏        | 120/971 [00:02<00:14, 58.44it/s]backtest loop:  13%|█▎        | 126/971 [00:02<00:16, 52.59it/s]backtest loop:  14%|█▎        | 133/971 [00:02<00:15, 55.34it/s]backtest loop:  14%|█▍        | 140/971 [00:02<00:14, 57.44it/s]backtest loop:  15%|█▌        | 146/971 [00:02<00:14, 55.10it/s]backtest loop:  16%|█▌        | 153/971 [00:02<00:14, 57.11it/s]backtest loop:  16%|█▋        | 159/971 [00:03<00:14, 57.88it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:13, 58.25it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:14, 55.14it/s]backtest loop:  18%|█▊        | 177/971 [00:03<00:14, 56.44it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:13, 57.35it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:14, 55.36it/s]backtest loop:  20%|██        | 196/971 [00:03<00:13, 56.30it/s]backtest loop:  21%|██        | 203/971 [00:03<00:13, 58.07it/s]backtest loop:  22%|██▏       | 210/971 [00:03<00:13, 56.24it/s]backtest loop:  22%|██▏       | 216/971 [00:04<00:13, 54.20it/s]backtest loop:  23%|██▎       | 223/971 [00:04<00:13, 56.45it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 55.00it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 57.06it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 58.71it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 55.77it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 57.83it/s]backtest loop:  27%|██▋       | 264/971 [00:04<00:12, 56.30it/s]backtest loop:  28%|██▊       | 271/971 [00:05<00:12, 54.94it/s]backtest loop:  29%|██▊       | 277/971 [00:05<00:12, 56.14it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:12, 57.14it/s]backtest loop:  30%|██▉       | 289/971 [00:05<00:11, 57.58it/s]backtest loop:  30%|███       | 295/971 [00:05<00:12, 55.16it/s]backtest loop:  31%|███       | 301/971 [00:05<00:11, 56.26it/s]backtest loop:  32%|███▏      | 307/971 [00:05<00:11, 57.27it/s]backtest loop:  32%|███▏      | 313/971 [00:05<00:11, 58.01it/s]backtest loop:  33%|███▎      | 320/971 [00:05<00:11, 55.84it/s]backtest loop:  34%|███▎      | 327/971 [00:06<00:11, 57.68it/s]backtest loop:  34%|███▍      | 334/971 [00:06<00:10, 59.09it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:11, 56.03it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:10, 57.79it/s]backtest loop:  36%|███▋      | 353/971 [00:06<00:10, 58.31it/s]backtest loop:  37%|███▋      | 359/971 [00:06<00:10, 58.74it/s]backtest loop:  38%|███▊      | 365/971 [00:06<00:10, 55.41it/s]backtest loop:  38%|███▊      | 371/971 [00:06<00:11, 53.22it/s]backtest loop:  39%|███▉      | 377/971 [00:06<00:10, 55.03it/s]backtest loop:  39%|███▉      | 383/971 [00:07<00:11, 52.94it/s]backtest loop:  40%|████      | 389/971 [00:07<00:10, 54.77it/s]backtest loop:  41%|████      | 396/971 [00:07<00:10, 56.99it/s]backtest loop:  41%|████▏     | 402/971 [00:07<00:09, 57.49it/s]backtest loop:  42%|████▏     | 408/971 [00:07<00:10, 54.77it/s]backtest loop:  43%|████▎     | 415/971 [00:07<00:09, 56.85it/s]backtest loop:  43%|████▎     | 422/971 [00:07<00:09, 58.47it/s]backtest loop:  44%|████▍     | 428/971 [00:07<00:09, 55.24it/s]backtest loop:  45%|████▍     | 434/971 [00:07<00:09, 56.49it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:09, 57.27it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:09, 57.98it/s]backtest loop:  47%|████▋     | 452/971 [00:08<00:09, 55.02it/s]backtest loop:  47%|████▋     | 458/971 [00:08<00:09, 56.33it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:08, 57.20it/s]backtest loop:  48%|████▊     | 470/971 [00:08<00:08, 57.98it/s]backtest loop:  49%|████▉     | 476/971 [00:08<00:08, 58.37it/s]backtest loop:  50%|████▉     | 482/971 [00:08<00:08, 55.11it/s]backtest loop:  50%|█████     | 488/971 [00:09<00:14, 33.46it/s]backtest loop:  51%|█████     | 495/971 [00:09<00:12, 37.95it/s]backtest loop:  52%|█████▏    | 501/971 [00:09<00:11, 42.36it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:10, 44.34it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:09, 49.04it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:08, 52.58it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:08, 51.61it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:08, 53.69it/s]backtest loop:  56%|█████▌    | 539/971 [00:10<00:07, 55.37it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 54.21it/s]backtest loop:  57%|█████▋    | 552/971 [00:10<00:07, 55.67it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 56.74it/s]backtest loop:  58%|█████▊    | 565/971 [00:10<00:06, 58.35it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 55.50it/s]backtest loop:  59%|█████▉    | 577/971 [00:10<00:06, 56.69it/s]backtest loop:  60%|██████    | 584/971 [00:10<00:06, 58.43it/s]backtest loop:  61%|██████    | 590/971 [00:10<00:06, 58.78it/s]backtest loop:  61%|██████▏   | 596/971 [00:11<00:06, 55.74it/s]backtest loop:  62%|██████▏   | 602/971 [00:11<00:06, 56.88it/s]backtest loop:  63%|██████▎   | 608/971 [00:11<00:06, 57.66it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:06, 55.83it/s]backtest loop:  64%|██████▍   | 622/971 [00:11<00:06, 57.71it/s]backtest loop:  65%|██████▍   | 629/971 [00:11<00:05, 59.21it/s]backtest loop:  65%|██████▌   | 635/971 [00:11<00:06, 56.00it/s]backtest loop:  66%|██████▌   | 642/971 [00:11<00:05, 57.99it/s]backtest loop:  67%|██████▋   | 649/971 [00:11<00:05, 59.27it/s]backtest loop:  67%|██████▋   | 655/971 [00:12<00:05, 55.69it/s]backtest loop:  68%|██████▊   | 661/971 [00:12<00:05, 56.80it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 57.39it/s]backtest loop:  69%|██████▉   | 673/971 [00:12<00:05, 58.11it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 55.02it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 56.19it/s]backtest loop:  71%|███████   | 691/971 [00:12<00:04, 57.19it/s]backtest loop:  72%|███████▏  | 697/971 [00:12<00:04, 57.75it/s]backtest loop:  72%|███████▏  | 703/971 [00:12<00:04, 58.38it/s]backtest loop:  73%|███████▎  | 709/971 [00:13<00:04, 55.02it/s]backtest loop:  74%|███████▎  | 715/971 [00:13<00:04, 56.33it/s]backtest loop:  74%|███████▍  | 721/971 [00:13<00:04, 57.29it/s]backtest loop:  75%|███████▍  | 727/971 [00:13<00:04, 57.83it/s]backtest loop:  75%|███████▌  | 733/971 [00:13<00:04, 51.70it/s]backtest loop:  76%|███████▌  | 739/971 [00:13<00:04, 53.73it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:04, 55.36it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 53.22it/s]backtest loop:  78%|███████▊  | 757/971 [00:13<00:03, 54.98it/s]backtest loop:  79%|███████▊  | 764/971 [00:14<00:03, 57.13it/s]backtest loop:  79%|███████▉  | 770/971 [00:14<00:03, 54.50it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 56.78it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 54.28it/s]backtest loop:  81%|████████▏ | 790/971 [00:14<00:03, 56.66it/s]backtest loop:  82%|████████▏ | 797/971 [00:14<00:02, 58.24it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:03, 54.99it/s]backtest loop:  83%|████████▎ | 810/971 [00:14<00:02, 57.19it/s]backtest loop:  84%|████████▍ | 816/971 [00:14<00:02, 57.33it/s]backtest loop:  85%|████████▍ | 823/971 [00:15<00:02, 55.50it/s]backtest loop:  85%|████████▌ | 829/971 [00:15<00:02, 56.55it/s]backtest loop:  86%|████████▌ | 836/971 [00:15<00:02, 58.27it/s]backtest loop:  87%|████████▋ | 843/971 [00:15<00:02, 56.11it/s]backtest loop:  87%|████████▋ | 849/971 [00:15<00:02, 57.04it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:02, 57.85it/s]backtest loop:  89%|████████▊ | 861/971 [00:15<00:01, 58.37it/s]backtest loop:  89%|████████▉ | 867/971 [00:15<00:01, 55.26it/s]backtest loop:  90%|████████▉ | 873/971 [00:15<00:01, 56.42it/s]backtest loop:  91%|█████████ | 879/971 [00:16<00:01, 57.34it/s]backtest loop:  91%|█████████ | 886/971 [00:16<00:01, 58.89it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 55.72it/s]backtest loop:  92%|█████████▏| 898/971 [00:16<00:01, 56.87it/s]backtest loop:  93%|█████████▎| 905/971 [00:16<00:01, 58.47it/s]backtest loop:  94%|█████████▍| 911/971 [00:16<00:01, 58.87it/s]backtest loop:  94%|█████████▍| 917/971 [00:16<00:00, 55.48it/s]backtest loop:  95%|█████████▌| 923/971 [00:16<00:00, 56.73it/s]backtest loop:  96%|█████████▌| 929/971 [00:16<00:00, 57.34it/s]backtest loop:  96%|█████████▋| 935/971 [00:17<00:00, 58.00it/s]backtest loop:  97%|█████████▋| 941/971 [00:17<00:00, 54.87it/s]backtest loop:  98%|█████████▊| 947/971 [00:17<00:00, 56.05it/s]backtest loop:  98%|█████████▊| 953/971 [00:17<00:00, 57.02it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 57.86it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 54.68it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 56.07it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 54.90it/s]
[3553693:MainThread](2024-04-26 10:18:06,687) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000452
std                0.006095
annualized_return  0.107556
information_ratio  1.143913
max_drawdown      -0.151738
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000255
std                0.006095
annualized_return  0.060575
information_ratio  0.644196
max_drawdown      -0.206038
[3553693:MainThread](2024-04-26 10:18:06,703) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 53
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_Localformer_alpha360_horizon1_step20_rankFalse_2024-04-26_03:34:20_online`.
Round 10 Done!
{'1day.excess_return_with_cost.annualized_return': [0.07075714264527615,
                                                    0.10850427937124411,
                                                    0.06685286326248528,
                                                    0.08608948157805843,
                                                    0.07682903517339368,
                                                    0.059029409217761133,
                                                    0.090443017988795,
                                                    0.10643622238339623,
                                                    0.09660285159129235,
                                                    0.060575459253698734],
 '1day.excess_return_with_cost.information_ratio': [0.7604996387958325,
                                                    1.2020537825981399,
                                                    0.7125046093662444,
                                                    0.8904572108774373,
                                                    0.8708896268691235,
                                                    0.6478405490692812,
                                                    0.9748413400836983,
                                                    1.0629849388113022,
                                                    1.0908919764028806,
                                                    0.6441958408775978],
 '1day.excess_return_with_cost.max_drawdown': [-0.14329134900291735,
                                               -0.12316472001361661,
                                               -0.1646927914298363,
                                               -0.13001096080026223,
                                               -0.11819781308791061,
                                               -0.16518671305225527,
                                               -0.13708383052832637,
                                               -0.10667381459091807,
                                               -0.1141544521003029,
                                               -0.20603840737646217],
 'IC': [0.023486286189309008,
        0.02791365222447451,
        0.02441311490294145,
        0.023209719834113737,
        0.02556309432113134,
        0.023518064772987516,
        0.024515036617226375,
        0.02656099433765106,
        0.028996598518193386,
        0.02386093509168038],
 'ICIR': [0.17230008880149675,
          0.19858094896927955,
          0.17400805891726157,
          0.16495475959030012,
          0.1764065044712292,
          0.1635279171880803,
          0.15749937419058055,
          0.185415034924459,
          0.19232313936865622,
          0.16816278415303323],
 'Rank IC': [0.01784804193762672,
             0.025047469820677314,
             0.017413522190489108,
             0.016932903948649526,
             0.021804135075245198,
             0.01589400216650591,
             0.01953202024121043,
             0.015610754757772752,
             0.025066074036637544,
             0.01707658902086641],
 'Rank ICIR': [0.12653690606414603,
               0.1780858675400394,
               0.12095496861110042,
               0.1191049590209752,
               0.15427744155570366,
               0.10779982689789028,
               0.122363202162894,
               0.10729239275972464,
               0.16360873889426036,
               0.11992560751243798],
 'mae': [0.7075116038322449,
         0.707405149936676,
         0.7074940800666809,
         0.707470715045929,
         0.7074753046035767,
         0.7074763178825378,
         0.7075409889221191,
         0.7075148224830627,
         0.7073635458946228,
         0.7074169516563416],
 'mse': [0.9960588812828064,
         0.9957895874977112,
         0.9961219429969788,
         0.9960362911224365,
         0.9959264397621155,
         0.9960545301437378,
         0.9962356686592102,
         0.9960511326789856,
         0.9958460927009583,
         0.9960078001022339]}
[3553693:MainThread](2024-04-26 10:18:07,901) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name csi300_Localformer_alpha360_horizon1_step20_rankFalse_2024-04-26_03:34:20_final.
[3553693:MainThread](2024-04-26 10:18:07,946) INFO - qlib.workflow - [exp.py:258] - Experiment 54 starts running ...
[3553693:MainThread](2024-04-26 10:18:07,959) INFO - qlib.workflow - [recorder.py:341] - Recorder 473d77e5fd534ebcb31cf728a2e1ecc6 starts running under Experiment 54 ...
Time cost: 2349.8459543943404	72.90114567279815
Final results:
{'1day.excess_return_with_cost.annualized_return': [0.08221197624654011,
                                                    0.017232653870368084],
 '1day.excess_return_with_cost.information_ratio': [0.8857159513751538,
                                                    0.18503370441667524],
 '1day.excess_return_with_cost.max_drawdown': [-0.14084948519828075,
                                               0.028730587139978024],
 'IC': [0.025203749680970878, 0.0019071042254625548],
 'ICIR': [0.17531786105743766, 0.012487600223612052],
 'Rank IC': [0.01922255131956809, 0.0033759531181602872],
 'Rank ICIR': [0.1319949911019172, 0.023178000277362103],
 'mae': [0.7074669480323792, 5.2618214751179496e-05],
 'mse': [0.9960128366947174, 0.0001235180029844277]}
Your final results can be found in the experiment named `csi300_Localformer_alpha360_horizon1_step20_rankFalse_2024-04-26_03:34:20_final`.
All Done!
[3553693:MainThread](2024-04-26 10:18:09,086) INFO - qlib.timer - [log.py:127] - Time cost: 0.028s | waiting `async_log` Done

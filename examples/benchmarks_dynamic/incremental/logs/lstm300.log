['main.py', 'run_all', '--forecast_model', 'LSTM', '-num_head', '8', '--train_start=2008-01-01', '--train_end=2018-12-31', '--valid_start=2019-01-01', '--valid_end=2020-03-31', '--test_start=2020-04-01', '--test_end=2024-03-31', '--tau', '10', '--lr_da', '0.01', '--market', 'csi300', '--data_dir', 'crowd_data', '--rank_label', 'False', '--begin_valid_epoch', '30']
[2907598:MainThread](2024-04-24 20:45:17,553) INFO - qlib.Initialization - [config.py:416] - default_conf: client.
[2907598:MainThread](2024-04-24 20:45:17,556) INFO - qlib.Initialization - [__init__.py:74] - qlib successfully initialized based on client settings.
[2907598:MainThread](2024-04-24 20:45:17,556) INFO - qlib.Initialization - [__init__.py:76] - data_path={'__DEFAULT_FREQ': PosixPath('/home/zhonghao/.qlib/qlib_data/crowd_data')}
Remove CSRankNorm
Handler: {'class': 'Alpha360', 'module_path': 'qlib.contrib.data.handler', 'kwargs': {'start_time': Timestamp('2008-01-01 00:00:00'), 'end_time': Timestamp('2024-03-31 00:00:00'), 'fit_start_time': Timestamp('2008-01-01 00:00:00'), 'fit_end_time': Timestamp('2018-12-31 00:00:00'), 'instruments': 'csi300', 'infer_processors': [{'class': 'RobustZScoreNorm', 'kwargs': {'fields_group': 'feature', 'clip_outlier': True}}, {'class': 'Fillna', 'kwargs': {'fields_group': 'feature'}}], 'learn_processors': [{'class': 'DropnaLabel'}, {'class': 'CSZScoreNorm', 'kwargs': {'fields_group': 'label'}}], 'label': ['Ref($close, -2) / Ref($close, -1) - 1']}}
Task: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-01 00:00:00'), Timestamp('2018-12-31 00:00:00')), 'valid': (Timestamp('2019-01-01 00:00:00'), Timestamp('2020-03-31 00:00:00')), 'test': (Timestamp('2020-04-01 00:00:00'), Timestamp('2024-03-31 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
[2907598:MainThread](2024-04-24 20:45:24,565) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2008-01-02 00:00:00'), Timestamp('2008-01-29 00:00:00')), 'test': (Timestamp('2008-01-31 00:00:00'), Timestamp('2008-03-05 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/147 [00:00<?, ?it/s]creating meta tasks:  26%|██▌       | 38/147 [00:00<00:00, 375.79it/s]creating meta tasks:  54%|█████▎    | 79/147 [00:00<00:00, 392.15it/s]creating meta tasks:  82%|████████▏ | 121/147 [00:00<00:00, 403.00it/s]creating meta tasks: 100%|██████████| 147/147 [00:00<00:00, 402.06it/s]
[2907598:MainThread](2024-04-24 20:45:25,206) INFO - qlib.MetaDatasetInc - [dataset.py:152] - Example task for training meta model: {'model': {'class': 'LSTM', 'module_path': 'qlib.contrib.model.pytorch_lstm', 'kwargs': {'d_feat': 6, 'hidden_size': 64, 'num_layers': 2, 'dropout': 0.0, 'n_epochs': 200, 'lr': 0.001, 'early_stop': 8, 'batch_size': 800, 'metric': 'loss', 'loss': 'mse', 'GPU': 0}}, 'dataset': {'class': 'DatasetH', 'module_path': 'qlib.data.dataset', 'kwargs': {'handler': 'file:///home/zhonghao/sjtu/qlib/examples/benchmarks/crowd_data_csi300_rankFalse_alpha360_handler_horizon1.pkl', 'segments': {'train': (Timestamp('2019-01-02 00:00:00'), Timestamp('2019-01-29 00:00:00')), 'test': (Timestamp('2019-01-31 00:00:00'), Timestamp('2019-03-06 00:00:00'))}}}, 'record': ['qlib.workflow.record_temp.SignalRecord']}
creating meta tasks:   0%|          | 0/63 [00:00<?, ?it/s]creating meta tasks:  51%|█████     | 32/63 [00:00<00:00, 312.62it/s]creating meta tasks: 100%|██████████| 63/63 [00:00<00:00, 322.64it/s]
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2907598:MainThread](2024-04-24 20:45:26,417) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[2907598:MainThread](2024-04-24 20:45:26,776) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:08<13:40,  8.29s/it]epoch:   2%|▏         | 2/100 [00:16<13:02,  7.98s/it]epoch:   3%|▎         | 3/100 [00:23<12:34,  7.78s/it]epoch:   4%|▍         | 4/100 [00:31<12:25,  7.76s/it]epoch:   5%|▌         | 5/100 [00:39<12:17,  7.76s/it]epoch:   6%|▌         | 6/100 [00:46<12:04,  7.70s/it]epoch:   7%|▋         | 7/100 [00:54<11:53,  7.67s/it]epoch:   8%|▊         | 8/100 [01:01<11:40,  7.61s/it]epoch:   9%|▉         | 9/100 [01:09<11:35,  7.64s/it]epoch:  10%|█         | 10/100 [01:16<11:24,  7.60s/it]epoch:  11%|█         | 11/100 [01:24<11:12,  7.56s/it]epoch:  12%|█▏        | 12/100 [01:32<11:08,  7.60s/it]epoch:  13%|█▎        | 13/100 [01:39<11:00,  7.59s/it]epoch:  14%|█▍        | 14/100 [01:47<10:48,  7.54s/it]epoch:  15%|█▌        | 15/100 [01:54<10:39,  7.53s/it]epoch:  16%|█▌        | 16/100 [02:02<10:28,  7.49s/it]epoch:  17%|█▋        | 17/100 [02:09<10:20,  7.48s/it]epoch:  18%|█▊        | 18/100 [02:16<10:13,  7.48s/it]epoch:  19%|█▉        | 19/100 [02:24<10:03,  7.45s/it]epoch:  20%|██        | 20/100 [02:31<09:56,  7.46s/it]epoch:  21%|██        | 21/100 [02:39<09:53,  7.51s/it]epoch:  22%|██▏       | 22/100 [02:46<09:44,  7.49s/it]epoch:  23%|██▎       | 23/100 [02:54<09:30,  7.41s/it]epoch:  24%|██▍       | 24/100 [03:01<09:21,  7.38s/it]epoch:  25%|██▌       | 25/100 [03:08<09:15,  7.41s/it]epoch:  26%|██▌       | 26/100 [03:16<09:06,  7.38s/it]epoch:  27%|██▋       | 27/100 [03:23<08:59,  7.39s/it]epoch:  28%|██▊       | 28/100 [03:31<08:57,  7.46s/it]epoch:  29%|██▉       | 29/100 [03:38<08:48,  7.45s/it]epoch:  30%|███       | 30/100 [03:46<08:39,  7.43s/it]0.05582072043380755
best ic: 0.05582072043380755
epoch:  31%|███       | 31/100 [03:54<08:56,  7.78s/it]0.05932846230360654
best ic: 0.05932846230360654
epoch:  32%|███▏      | 32/100 [04:03<09:03,  7.99s/it]0.05277798982906524
epoch:  33%|███▎      | 33/100 [04:11<09:07,  8.18s/it]0.05733090852262862
epoch:  34%|███▍      | 34/100 [04:20<09:10,  8.34s/it]0.054582589233563204
epoch:  35%|███▌      | 35/100 [04:29<09:08,  8.44s/it]0.050300257370171506
epoch:  36%|███▌      | 36/100 [04:37<09:06,  8.54s/it]0.05479991082338188
epoch:  37%|███▋      | 37/100 [04:46<08:58,  8.55s/it]0.05491537955700729
epoch:  38%|███▊      | 38/100 [04:55<08:50,  8.55s/it]0.04954132494693236
epoch:  39%|███▉      | 39/100 [05:03<08:42,  8.56s/it]0.05792582916700102
epoch:  39%|███▉      | 39/100 [05:12<08:08,  8.00s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2907598:MainThread](2024-04-24 20:50:43,422) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name csi300_LSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_20:45:25_online.
[2907598:MainThread](2024-04-24 20:50:43,448) INFO - qlib.workflow - [exp.py:258] - Experiment 37 starts running ...
[2907598:MainThread](2024-04-24 20:50:44,320) INFO - qlib.workflow - [recorder.py:341] - Recorder 140859ff8fdc478eb940d12630a13fa4 starts running under Experiment 37 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:03, 15.86it/s]online:   6%|▋         | 4/63 [00:00<00:03, 15.91it/s]online:  10%|▉         | 6/63 [00:00<00:03, 16.04it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 16.25it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 16.14it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 15.91it/s]online:  22%|██▏       | 14/63 [00:00<00:03, 16.08it/s]online:  25%|██▌       | 16/63 [00:00<00:02, 15.99it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 15.92it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 16.16it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 16.02it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 16.27it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 16.20it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 15.89it/s]online:  48%|████▊     | 30/63 [00:01<00:02, 16.06it/s]online:  51%|█████     | 32/63 [00:01<00:01, 16.08it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 15.96it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 16.19it/s]online:  60%|██████    | 38/63 [00:02<00:01, 16.34it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 16.15it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 16.09it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 15.91it/s]online:  73%|███████▎  | 46/63 [00:02<00:01, 15.90it/s]online:  76%|███████▌  | 48/63 [00:02<00:00, 15.92it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 15.91it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 15.94it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 16.03it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 16.22it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 16.07it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 16.05it/s]online:  98%|█████████▊| 62/63 [00:03<00:00, 16.03it/s]online: 100%|██████████| 63/63 [00:03<00:00, 16.06it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2907598:MainThread](2024-04-24 20:50:54,489) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9965026 mae 0.7075636
{'IC': 0.027313668501984606,
 'ICIR': 0.22308366803828927,
 'Rank IC': 0.029403174427850773,
 'Rank ICIR': 0.23996303432974886}
[2907598:MainThread](2024-04-24 20:50:56,108) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2907598:MainThread](2024-04-24 20:51:06,807) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 20:51:06,810) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 20:51:12,859) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f612594ebe0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   1%|          | 6/971 [00:00<00:16, 58.12it/s]backtest loop:   1%|          | 12/971 [00:00<00:18, 52.84it/s]backtest loop:   2%|▏         | 19/971 [00:00<00:16, 57.65it/s]backtest loop:   3%|▎         | 25/971 [00:00<00:17, 54.34it/s]backtest loop:   3%|▎         | 32/971 [00:00<00:16, 57.46it/s]backtest loop:   4%|▍         | 39/971 [00:00<00:16, 55.58it/s]backtest loop:   5%|▍         | 46/971 [00:00<00:15, 57.81it/s]backtest loop:   5%|▌         | 53/971 [00:00<00:15, 59.32it/s]backtest loop:   6%|▌         | 59/971 [00:01<00:16, 56.30it/s]backtest loop:   7%|▋         | 66/971 [00:01<00:15, 58.50it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 55.73it/s]backtest loop:   8%|▊         | 79/971 [00:01<00:15, 57.72it/s]backtest loop:   9%|▉         | 86/971 [00:01<00:14, 59.29it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:15, 56.34it/s]backtest loop:  10%|█         | 99/971 [00:01<00:14, 58.61it/s]backtest loop:  11%|█         | 106/971 [00:01<00:14, 59.98it/s]backtest loop:  12%|█▏        | 113/971 [00:01<00:14, 57.49it/s]backtest loop:  12%|█▏        | 120/971 [00:02<00:14, 59.03it/s]backtest loop:  13%|█▎        | 126/971 [00:02<00:15, 53.28it/s]backtest loop:  14%|█▎        | 133/971 [00:02<00:14, 55.89it/s]backtest loop:  14%|█▍        | 140/971 [00:02<00:14, 58.05it/s]backtest loop:  15%|█▌        | 146/971 [00:02<00:14, 55.52it/s]backtest loop:  16%|█▌        | 152/971 [00:02<00:20, 39.53it/s]backtest loop:  16%|█▋        | 159/971 [00:02<00:18, 44.89it/s]backtest loop:  17%|█▋        | 166/971 [00:03<00:17, 47.06it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:15, 50.92it/s]backtest loop:  19%|█▊        | 180/971 [00:03<00:14, 54.13it/s]backtest loop:  19%|█▉        | 186/971 [00:03<00:14, 52.96it/s]backtest loop:  20%|█▉        | 193/971 [00:03<00:13, 55.78it/s]backtest loop:  21%|██        | 200/971 [00:03<00:14, 55.00it/s]backtest loop:  21%|██▏       | 207/971 [00:03<00:13, 57.27it/s]backtest loop:  22%|██▏       | 213/971 [00:03<00:13, 55.33it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 54.38it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:13, 56.76it/s]backtest loop:  24%|██▍       | 234/971 [00:04<00:12, 58.62it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:13, 55.95it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:12, 57.88it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:12, 56.39it/s]backtest loop:  27%|██▋       | 261/971 [00:04<00:12, 58.18it/s]backtest loop:  27%|██▋       | 267/971 [00:04<00:12, 55.93it/s]backtest loop:  28%|██▊       | 274/971 [00:04<00:12, 57.90it/s]backtest loop:  29%|██▉       | 281/971 [00:05<00:12, 56.06it/s]backtest loop:  30%|██▉       | 288/971 [00:05<00:11, 57.95it/s]backtest loop:  30%|███       | 295/971 [00:05<00:11, 56.36it/s]backtest loop:  31%|███       | 301/971 [00:05<00:11, 57.20it/s]backtest loop:  32%|███▏      | 308/971 [00:05<00:11, 58.73it/s]backtest loop:  32%|███▏      | 315/971 [00:05<00:11, 56.61it/s]backtest loop:  33%|███▎      | 322/971 [00:05<00:11, 58.31it/s]backtest loop:  34%|███▍      | 329/971 [00:05<00:10, 59.64it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:11, 56.64it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:10, 58.52it/s]backtest loop:  36%|███▌      | 349/971 [00:06<00:10, 59.98it/s]backtest loop:  37%|███▋      | 356/971 [00:06<00:10, 57.83it/s]backtest loop:  37%|███▋      | 363/971 [00:06<00:10, 56.25it/s]backtest loop:  38%|███▊      | 369/971 [00:06<00:11, 54.37it/s]backtest loop:  39%|███▊      | 376/971 [00:06<00:10, 56.84it/s]backtest loop:  39%|███▉      | 383/971 [00:06<00:10, 55.52it/s]backtest loop:  40%|████      | 390/971 [00:06<00:10, 57.63it/s]backtest loop:  41%|████      | 397/971 [00:07<00:09, 59.26it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 56.36it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:09, 58.13it/s]backtest loop:  43%|████▎     | 417/971 [00:07<00:09, 59.94it/s]backtest loop:  44%|████▎     | 424/971 [00:07<00:09, 57.65it/s]backtest loop:  44%|████▍     | 431/971 [00:07<00:09, 59.15it/s]backtest loop:  45%|████▌     | 437/971 [00:07<00:09, 56.31it/s]backtest loop:  46%|████▌     | 444/971 [00:07<00:09, 58.22it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:08, 59.68it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:09, 56.60it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:08, 58.45it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:08, 59.78it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:08, 56.67it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:08, 58.42it/s]backtest loop:  50%|█████     | 490/971 [00:08<00:08, 55.79it/s]backtest loop:  51%|█████     | 497/971 [00:08<00:08, 57.96it/s]backtest loop:  52%|█████▏    | 504/971 [00:08<00:07, 59.64it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:08, 56.93it/s]backtest loop:  53%|█████▎    | 517/971 [00:09<00:08, 55.50it/s]backtest loop:  54%|█████▍    | 524/971 [00:09<00:07, 57.59it/s]backtest loop:  55%|█████▍    | 531/971 [00:09<00:07, 56.05it/s]backtest loop:  55%|█████▌    | 538/971 [00:09<00:07, 58.16it/s]backtest loop:  56%|█████▌    | 545/971 [00:09<00:07, 59.53it/s]backtest loop:  57%|█████▋    | 551/971 [00:09<00:07, 56.81it/s]backtest loop:  57%|█████▋    | 558/971 [00:09<00:07, 58.62it/s]backtest loop:  58%|█████▊    | 565/971 [00:09<00:06, 59.91it/s]backtest loop:  59%|█████▉    | 572/971 [00:10<00:06, 57.52it/s]backtest loop:  60%|█████▉    | 579/971 [00:10<00:06, 59.30it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:06, 57.29it/s]backtest loop:  61%|██████    | 593/971 [00:10<00:06, 58.88it/s]backtest loop:  62%|██████▏   | 600/971 [00:10<00:06, 56.89it/s]backtest loop:  63%|██████▎   | 607/971 [00:10<00:06, 58.36it/s]backtest loop:  63%|██████▎   | 614/971 [00:10<00:05, 59.77it/s]backtest loop:  64%|██████▍   | 621/971 [00:10<00:06, 57.51it/s]backtest loop:  65%|██████▍   | 628/971 [00:11<00:05, 59.12it/s]backtest loop:  65%|██████▌   | 635/971 [00:11<00:05, 57.13it/s]backtest loop:  66%|██████▌   | 642/971 [00:11<00:05, 59.04it/s]backtest loop:  67%|██████▋   | 649/971 [00:11<00:05, 60.16it/s]backtest loop:  68%|██████▊   | 656/971 [00:11<00:05, 57.65it/s]backtest loop:  68%|██████▊   | 663/971 [00:11<00:05, 59.11it/s]backtest loop:  69%|██████▉   | 670/971 [00:11<00:05, 56.91it/s]backtest loop:  70%|██████▉   | 677/971 [00:11<00:05, 58.53it/s]backtest loop:  70%|███████   | 684/971 [00:12<00:05, 56.56it/s]backtest loop:  71%|███████   | 691/971 [00:12<00:04, 58.31it/s]backtest loop:  72%|███████▏  | 698/971 [00:12<00:04, 59.54it/s]backtest loop:  73%|███████▎  | 704/971 [00:12<00:04, 56.66it/s]backtest loop:  73%|███████▎  | 711/971 [00:12<00:04, 58.45it/s]backtest loop:  74%|███████▍  | 718/971 [00:12<00:04, 59.81it/s]backtest loop:  75%|███████▍  | 725/971 [00:12<00:04, 57.49it/s]backtest loop:  75%|███████▌  | 731/971 [00:12<00:04, 55.33it/s]backtest loop:  76%|███████▌  | 738/971 [00:12<00:04, 54.43it/s]backtest loop:  77%|███████▋  | 744/971 [00:13<00:04, 55.85it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 54.09it/s]backtest loop:  78%|███████▊  | 757/971 [00:13<00:03, 56.72it/s]backtest loop:  79%|███████▊  | 764/971 [00:13<00:03, 58.59it/s]backtest loop:  79%|███████▉  | 770/971 [00:13<00:03, 55.90it/s]backtest loop:  80%|████████  | 777/971 [00:13<00:03, 57.99it/s]backtest loop:  81%|████████  | 783/971 [00:13<00:03, 55.54it/s]backtest loop:  81%|████████▏ | 790/971 [00:13<00:03, 57.70it/s]backtest loop:  82%|████████▏ | 797/971 [00:14<00:02, 59.22it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:02, 56.25it/s]backtest loop:  83%|████████▎ | 810/971 [00:14<00:02, 58.17it/s]backtest loop:  84%|████████▍ | 817/971 [00:14<00:02, 59.57it/s]backtest loop:  85%|████████▍ | 823/971 [00:14<00:02, 56.60it/s]backtest loop:  85%|████████▌ | 830/971 [00:14<00:02, 58.43it/s]backtest loop:  86%|████████▌ | 837/971 [00:14<00:02, 59.77it/s]backtest loop:  87%|████████▋ | 843/971 [00:14<00:02, 56.72it/s]backtest loop:  88%|████████▊ | 850/971 [00:14<00:02, 58.53it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 56.55it/s]backtest loop:  89%|████████▉ | 864/971 [00:15<00:01, 58.31it/s]backtest loop:  90%|████████▉ | 871/971 [00:15<00:01, 59.61it/s]backtest loop:  90%|█████████ | 877/971 [00:15<00:01, 56.62it/s]backtest loop:  91%|█████████ | 884/971 [00:15<00:01, 58.26it/s]backtest loop:  92%|█████████▏| 891/971 [00:15<00:01, 59.58it/s]backtest loop:  92%|█████████▏| 897/971 [00:15<00:01, 56.67it/s]backtest loop:  93%|█████████▎| 904/971 [00:15<00:01, 58.48it/s]backtest loop:  94%|█████████▍| 911/971 [00:15<00:01, 59.78it/s]backtest loop:  94%|█████████▍| 917/971 [00:16<00:00, 56.75it/s]backtest loop:  95%|█████████▌| 924/971 [00:16<00:00, 58.51it/s]backtest loop:  96%|█████████▌| 931/971 [00:16<00:00, 56.52it/s]backtest loop:  97%|█████████▋| 938/971 [00:16<00:00, 58.37it/s]backtest loop:  97%|█████████▋| 944/971 [00:16<00:00, 58.77it/s]backtest loop:  98%|█████████▊| 950/971 [00:16<00:00, 56.17it/s]backtest loop:  99%|█████████▊| 957/971 [00:16<00:00, 58.03it/s]backtest loop:  99%|█████████▉| 964/971 [00:16<00:00, 59.43it/s]backtest loop: 100%|█████████▉| 970/971 [00:17<00:00, 56.45it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 57.05it/s]
[2907598:MainThread](2024-04-24 20:51:29,947) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000427
std                0.004854
annualized_return  0.101580
information_ratio  1.356362
max_drawdown      -0.064141
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000230
std                0.004855
annualized_return  0.054665
information_ratio  0.729914
max_drawdown      -0.103003
[2907598:MainThread](2024-04-24 20:51:29,964) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_LSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_20:45:25_online`.
Round 1 Done!
{'1day.excess_return_with_cost.annualized_return': [0.05466509644132003],
 '1day.excess_return_with_cost.information_ratio': [0.7299136334968934],
 '1day.excess_return_with_cost.max_drawdown': [-0.10300273228156126],
 'IC': [0.027313668501984606],
 'ICIR': [0.22308366803828927],
 'Rank IC': [0.029403174427850773],
 'Rank ICIR': [0.23996303432974886],
 'mae': [0.707563579082489],
 'mse': [0.9965025782585144]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2907598:MainThread](2024-04-24 20:51:31,125) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[2907598:MainThread](2024-04-24 20:51:31,126) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:07<12:16,  7.43s/it]epoch:   2%|▏         | 2/100 [00:14<12:04,  7.39s/it]epoch:   3%|▎         | 3/100 [00:22<11:55,  7.38s/it]epoch:   4%|▍         | 4/100 [00:29<11:51,  7.41s/it]epoch:   5%|▌         | 5/100 [00:37<11:45,  7.42s/it]epoch:   6%|▌         | 6/100 [00:44<11:34,  7.39s/it]epoch:   7%|▋         | 7/100 [00:51<11:27,  7.39s/it]epoch:   8%|▊         | 8/100 [00:59<11:21,  7.40s/it]epoch:   9%|▉         | 9/100 [01:06<11:16,  7.43s/it]epoch:  10%|█         | 10/100 [01:13<11:05,  7.39s/it]epoch:  11%|█         | 11/100 [01:21<11:00,  7.42s/it]epoch:  12%|█▏        | 12/100 [01:28<10:48,  7.37s/it]epoch:  13%|█▎        | 13/100 [01:36<10:43,  7.40s/it]epoch:  14%|█▍        | 14/100 [01:43<10:36,  7.40s/it]epoch:  15%|█▌        | 15/100 [01:51<10:33,  7.45s/it]epoch:  16%|█▌        | 16/100 [01:58<10:30,  7.51s/it]epoch:  17%|█▋        | 17/100 [02:06<10:25,  7.54s/it]epoch:  18%|█▊        | 18/100 [02:13<10:17,  7.53s/it]epoch:  19%|█▉        | 19/100 [02:21<10:09,  7.52s/it]epoch:  20%|██        | 20/100 [02:28<10:00,  7.51s/it]epoch:  21%|██        | 21/100 [02:36<09:52,  7.51s/it]epoch:  22%|██▏       | 22/100 [02:43<09:44,  7.50s/it]epoch:  23%|██▎       | 23/100 [02:51<09:38,  7.51s/it]epoch:  24%|██▍       | 24/100 [02:59<09:34,  7.56s/it]epoch:  25%|██▌       | 25/100 [03:06<09:28,  7.58s/it]epoch:  26%|██▌       | 26/100 [03:14<09:19,  7.55s/it]epoch:  27%|██▋       | 27/100 [03:21<09:11,  7.56s/it]epoch:  28%|██▊       | 28/100 [03:29<09:02,  7.54s/it]epoch:  29%|██▉       | 29/100 [03:36<08:55,  7.54s/it]epoch:  30%|███       | 30/100 [03:44<08:47,  7.54s/it]0.05601849879427346
best ic: 0.05601849879427346
epoch:  31%|███       | 31/100 [03:52<08:57,  7.80s/it]0.05620543622937769
best ic: 0.05620543622937769
epoch:  32%|███▏      | 32/100 [04:01<09:06,  8.03s/it]0.05409638420846571
epoch:  33%|███▎      | 33/100 [04:09<09:08,  8.19s/it]0.05685442010938425
best ic: 0.05685442010938425
epoch:  34%|███▍      | 34/100 [04:18<09:09,  8.33s/it]0.05545023937336789
epoch:  35%|███▌      | 35/100 [04:27<09:05,  8.40s/it]0.055264236653312364
epoch:  36%|███▌      | 36/100 [04:35<09:00,  8.44s/it]0.05315208188504932
epoch:  37%|███▋      | 37/100 [04:44<08:52,  8.45s/it]0.05033860788335665
epoch:  38%|███▊      | 38/100 [04:52<08:42,  8.43s/it]0.05613485016666352
epoch:  39%|███▉      | 39/100 [05:01<08:37,  8.49s/it]0.05166521711633969
epoch:  40%|████      | 40/100 [05:09<08:30,  8.50s/it]0.05304760451433341
epoch:  41%|████      | 41/100 [05:18<08:22,  8.52s/it]0.056014733615232654
epoch:  41%|████      | 41/100 [05:26<07:50,  7.97s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2907598:MainThread](2024-04-24 20:56:57,958) INFO - qlib.workflow - [exp.py:258] - Experiment 37 starts running ...
[2907598:MainThread](2024-04-24 20:56:57,972) INFO - qlib.workflow - [recorder.py:341] - Recorder 1bf92584a9f94aed996b299137152a25 starts running under Experiment 37 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:03, 16.91it/s]online:   6%|▋         | 4/63 [00:00<00:03, 16.86it/s]online:  10%|▉         | 6/63 [00:00<00:03, 16.99it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 16.58it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 16.76it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 16.53it/s]online:  22%|██▏       | 14/63 [00:00<00:02, 16.36it/s]online:  25%|██▌       | 16/63 [00:00<00:02, 16.27it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 16.17it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 16.32it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 16.50it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 16.24it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 16.21it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 16.21it/s]online:  48%|████▊     | 30/63 [00:01<00:02, 16.18it/s]online:  51%|█████     | 32/63 [00:01<00:01, 16.41it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 16.36it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 16.39it/s]online:  60%|██████    | 38/63 [00:02<00:01, 16.47it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 16.30it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 16.17it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 16.07it/s]online:  73%|███████▎  | 46/63 [00:02<00:01, 16.01it/s]online:  76%|███████▌  | 48/63 [00:02<00:00, 15.90it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 16.19it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 16.30it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 16.33it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 16.21it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 15.98it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 15.99it/s]online:  98%|█████████▊| 62/63 [00:03<00:00, 15.95it/s]online: 100%|██████████| 63/63 [00:03<00:00, 16.29it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2907598:MainThread](2024-04-24 20:57:08,087) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99650604 mae 0.7076498
{'IC': 0.02579261406197789,
 'ICIR': 0.2041430983365273,
 'Rank IC': 0.026010289810945806,
 'Rank ICIR': 0.2041684188204175}
[2907598:MainThread](2024-04-24 20:57:09,805) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2907598:MainThread](2024-04-24 20:57:20,966) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 20:57:20,969) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 20:57:27,000) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f613be127f0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:42,  9.49it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 25.11it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 37.36it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.10it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:19, 47.19it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 48.05it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.58it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.71it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.94it/s]backtest loop:   6%|▌         | 60/971 [00:01<00:16, 55.48it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.36it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 57.25it/s]backtest loop:   8%|▊         | 80/971 [00:01<00:15, 57.96it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 56.31it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 58.19it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 59.54it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.45it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 58.31it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.63it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:15, 53.69it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:14, 56.27it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 55.25it/s]backtest loop:  15%|█▌        | 147/971 [00:02<00:14, 56.37it/s]backtest loop:  16%|█▌        | 154/971 [00:02<00:14, 58.35it/s]backtest loop:  16%|█▋        | 160/971 [00:03<00:13, 58.42it/s]backtest loop:  17%|█▋        | 166/971 [00:03<00:14, 55.61it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:13, 57.69it/s]backtest loop:  19%|█▊        | 180/971 [00:03<00:13, 58.95it/s]backtest loop:  19%|█▉        | 186/971 [00:03<00:14, 55.56it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:13, 56.37it/s]backtest loop:  20%|██        | 199/971 [00:03<00:13, 58.15it/s]backtest loop:  21%|██        | 205/971 [00:03<00:13, 55.30it/s]backtest loop:  22%|██▏       | 212/971 [00:03<00:13, 57.56it/s]backtest loop:  22%|██▏       | 218/971 [00:04<00:13, 55.24it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:13, 54.47it/s]backtest loop:  24%|██▍       | 232/971 [00:04<00:13, 56.84it/s]backtest loop:  25%|██▍       | 239/971 [00:04<00:12, 58.69it/s]backtest loop:  25%|██▌       | 245/971 [00:04<00:12, 55.89it/s]backtest loop:  26%|██▌       | 252/971 [00:04<00:12, 58.72it/s]backtest loop:  27%|██▋       | 258/971 [00:04<00:12, 59.04it/s]backtest loop:  27%|██▋       | 264/971 [00:04<00:12, 56.24it/s]backtest loop:  28%|██▊       | 270/971 [00:04<00:12, 57.18it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:12, 55.18it/s]backtest loop:  29%|██▉       | 282/971 [00:05<00:12, 56.27it/s]backtest loop:  30%|██▉       | 289/971 [00:05<00:11, 58.17it/s]backtest loop:  30%|███       | 295/971 [00:05<00:12, 55.68it/s]backtest loop:  31%|███       | 302/971 [00:05<00:11, 57.64it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 59.18it/s]backtest loop:  32%|███▏      | 315/971 [00:05<00:11, 56.11it/s]backtest loop:  33%|███▎      | 322/971 [00:05<00:11, 57.99it/s]backtest loop:  34%|███▍      | 329/971 [00:06<00:10, 59.43it/s]backtest loop:  35%|███▍      | 335/971 [00:06<00:11, 56.50it/s]backtest loop:  35%|███▌      | 342/971 [00:06<00:10, 58.08it/s]backtest loop:  36%|███▌      | 349/971 [00:06<00:10, 59.43it/s]backtest loop:  37%|███▋      | 355/971 [00:06<00:10, 56.53it/s]backtest loop:  37%|███▋      | 361/971 [00:06<00:10, 57.35it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 54.96it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 53.17it/s]backtest loop:  39%|███▉      | 380/971 [00:06<00:10, 55.99it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 57.99it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 55.51it/s]backtest loop:  41%|████      | 400/971 [00:07<00:09, 57.34it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 58.82it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:09, 56.01it/s]backtest loop:  43%|████▎     | 420/971 [00:07<00:09, 57.78it/s]backtest loop:  44%|████▍     | 427/971 [00:07<00:09, 59.19it/s]backtest loop:  45%|████▍     | 433/971 [00:07<00:09, 56.09it/s]backtest loop:  45%|████▌     | 440/971 [00:07<00:09, 57.99it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:08, 58.49it/s]backtest loop:  47%|████▋     | 452/971 [00:08<00:09, 55.68it/s]backtest loop:  47%|████▋     | 459/971 [00:08<00:08, 57.75it/s]backtest loop:  48%|████▊     | 465/971 [00:08<00:08, 57.90it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:08, 56.03it/s]backtest loop:  49%|████▉     | 478/971 [00:08<00:08, 56.91it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:13, 35.23it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:12, 38.58it/s]backtest loop:  51%|█████     | 497/971 [00:09<00:10, 44.26it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:09, 48.98it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:09, 49.23it/s]backtest loop:  53%|█████▎    | 517/971 [00:09<00:09, 50.10it/s]backtest loop:  54%|█████▍    | 524/971 [00:09<00:08, 53.39it/s]backtest loop:  55%|█████▍    | 531/971 [00:09<00:08, 53.17it/s]backtest loop:  55%|█████▌    | 538/971 [00:09<00:07, 55.65it/s]backtest loop:  56%|█████▌    | 545/971 [00:10<00:07, 57.76it/s]backtest loop:  57%|█████▋    | 551/971 [00:10<00:07, 55.43it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 56.36it/s]backtest loop:  58%|█████▊    | 565/971 [00:10<00:06, 58.22it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 55.50it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:06, 57.50it/s]backtest loop:  60%|██████    | 585/971 [00:10<00:06, 59.12it/s]backtest loop:  61%|██████    | 591/971 [00:10<00:06, 56.01it/s]backtest loop:  62%|██████▏   | 598/971 [00:10<00:06, 58.00it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:06, 56.02it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 57.82it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:05, 59.33it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 56.08it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 57.92it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 59.36it/s]backtest loop:  66%|██████▋   | 645/971 [00:11<00:05, 56.03it/s]backtest loop:  67%|██████▋   | 652/971 [00:11<00:05, 57.83it/s]backtest loop:  68%|██████▊   | 659/971 [00:12<00:05, 59.15it/s]backtest loop:  68%|██████▊   | 665/971 [00:12<00:05, 56.08it/s]backtest loop:  69%|██████▉   | 672/971 [00:12<00:05, 57.81it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 56.01it/s]backtest loop:  71%|███████   | 685/971 [00:12<00:05, 56.03it/s]backtest loop:  71%|███████▏  | 692/971 [00:12<00:04, 57.84it/s]backtest loop:  72%|███████▏  | 698/971 [00:12<00:04, 58.32it/s]backtest loop:  73%|███████▎  | 704/971 [00:12<00:04, 55.58it/s]backtest loop:  73%|███████▎  | 711/971 [00:12<00:04, 57.51it/s]backtest loop:  74%|███████▍  | 717/971 [00:13<00:04, 58.09it/s]backtest loop:  75%|███████▍  | 724/971 [00:13<00:04, 56.08it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 54.87it/s]backtest loop:  76%|███████▌  | 737/971 [00:13<00:04, 55.59it/s]backtest loop:  77%|███████▋  | 743/971 [00:13<00:04, 53.57it/s]backtest loop:  77%|███████▋  | 749/971 [00:13<00:04, 55.15it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 53.17it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 55.97it/s]backtest loop:  79%|███████▉  | 769/971 [00:13<00:03, 57.94it/s]backtest loop:  80%|███████▉  | 775/971 [00:14<00:03, 55.24it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 57.49it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 55.24it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.15it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 58.68it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 55.85it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 57.82it/s]backtest loop:  85%|████████▍ | 822/971 [00:14<00:02, 59.14it/s]backtest loop:  85%|████████▌ | 828/971 [00:15<00:02, 56.30it/s]backtest loop:  86%|████████▌ | 835/971 [00:15<00:02, 58.14it/s]backtest loop:  87%|████████▋ | 841/971 [00:15<00:02, 58.56it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 56.53it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:01, 58.27it/s]backtest loop:  89%|████████▊ | 861/971 [00:15<00:01, 58.63it/s]backtest loop:  89%|████████▉ | 867/971 [00:15<00:01, 55.57it/s]backtest loop:  90%|████████▉ | 873/971 [00:15<00:01, 56.71it/s]backtest loop:  91%|█████████ | 880/971 [00:15<00:01, 58.45it/s]backtest loop:  91%|█████████▏| 887/971 [00:16<00:01, 56.26it/s]backtest loop:  92%|█████████▏| 894/971 [00:16<00:01, 58.00it/s]backtest loop:  93%|█████████▎| 901/971 [00:16<00:01, 59.34it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 56.17it/s]backtest loop:  94%|█████████▍| 914/971 [00:16<00:00, 58.02it/s]backtest loop:  95%|█████████▍| 921/971 [00:16<00:00, 56.08it/s]backtest loop:  95%|█████████▌| 927/971 [00:16<00:00, 57.09it/s]backtest loop:  96%|█████████▌| 933/971 [00:16<00:00, 57.84it/s]backtest loop:  97%|█████████▋| 940/971 [00:16<00:00, 56.03it/s]backtest loop:  98%|█████████▊| 947/971 [00:17<00:00, 57.87it/s]backtest loop:  98%|█████████▊| 954/971 [00:17<00:00, 59.31it/s]backtest loop:  99%|█████████▉| 960/971 [00:17<00:00, 56.29it/s]backtest loop: 100%|█████████▉| 967/971 [00:17<00:00, 58.05it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.48it/s]
[2907598:MainThread](2024-04-24 20:57:44,577) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000356
std                0.004817
annualized_return  0.084665
information_ratio  1.139305
max_drawdown      -0.048464
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000159
std                0.004817
annualized_return  0.037829
information_ratio  0.509058
max_drawdown      -0.071100
[2907598:MainThread](2024-04-24 20:57:44,593) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_LSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_20:45:25_online`.
Round 2 Done!
{'1day.excess_return_with_cost.annualized_return': [0.05466509644132003,
                                                    0.03782940405138317],
 '1day.excess_return_with_cost.information_ratio': [0.7299136334968934,
                                                    0.5090576149926579],
 '1day.excess_return_with_cost.max_drawdown': [-0.10300273228156126,
                                               -0.07110045372162947],
 'IC': [0.027313668501984606, 0.02579261406197789],
 'ICIR': [0.22308366803828927, 0.2041430983365273],
 'Rank IC': [0.029403174427850773, 0.026010289810945806],
 'Rank ICIR': [0.23996303432974886, 0.2041684188204175],
 'mae': [0.707563579082489, 0.707649827003479],
 'mse': [0.9965025782585144, 0.9965060353279114]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2907598:MainThread](2024-04-24 20:57:45,800) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[2907598:MainThread](2024-04-24 20:57:45,801) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:07<12:47,  7.75s/it]epoch:   2%|▏         | 2/100 [00:15<12:25,  7.61s/it]epoch:   3%|▎         | 3/100 [00:22<12:19,  7.62s/it]epoch:   4%|▍         | 4/100 [00:30<12:06,  7.57s/it]epoch:   5%|▌         | 5/100 [00:37<12:00,  7.58s/it]epoch:   6%|▌         | 6/100 [00:45<11:58,  7.65s/it]epoch:   7%|▋         | 7/100 [00:53<11:40,  7.53s/it]epoch:   8%|▊         | 8/100 [01:00<11:34,  7.54s/it]epoch:   9%|▉         | 9/100 [01:08<11:32,  7.61s/it]epoch:  10%|█         | 10/100 [01:15<11:22,  7.58s/it]epoch:  11%|█         | 11/100 [01:23<11:15,  7.59s/it]epoch:  12%|█▏        | 12/100 [01:31<11:11,  7.63s/it]epoch:  13%|█▎        | 13/100 [01:38<11:01,  7.60s/it]epoch:  14%|█▍        | 14/100 [01:46<10:49,  7.56s/it]epoch:  15%|█▌        | 15/100 [01:53<10:38,  7.51s/it]epoch:  16%|█▌        | 16/100 [02:01<10:34,  7.55s/it]epoch:  17%|█▋        | 17/100 [02:08<10:25,  7.53s/it]epoch:  18%|█▊        | 18/100 [02:16<10:15,  7.51s/it]epoch:  19%|█▉        | 19/100 [02:23<10:07,  7.50s/it]epoch:  20%|██        | 20/100 [02:31<09:58,  7.48s/it]epoch:  21%|██        | 21/100 [02:38<09:56,  7.56s/it]epoch:  22%|██▏       | 22/100 [02:46<09:53,  7.60s/it]epoch:  23%|██▎       | 23/100 [02:54<09:44,  7.59s/it]epoch:  24%|██▍       | 24/100 [03:01<09:32,  7.54s/it]epoch:  25%|██▌       | 25/100 [03:08<09:23,  7.51s/it]epoch:  26%|██▌       | 26/100 [03:16<09:10,  7.44s/it]epoch:  27%|██▋       | 27/100 [03:23<09:04,  7.46s/it]epoch:  28%|██▊       | 28/100 [03:31<09:01,  7.52s/it]epoch:  29%|██▉       | 29/100 [03:39<08:55,  7.54s/it]epoch:  30%|███       | 30/100 [03:46<08:47,  7.54s/it]0.05339430389269073
best ic: 0.05339430389269073
epoch:  31%|███       | 31/100 [03:55<09:02,  7.87s/it]0.05468337503151003
best ic: 0.05468337503151003
epoch:  32%|███▏      | 32/100 [04:03<09:09,  8.09s/it]0.05744797107127631
best ic: 0.05744797107127631
epoch:  33%|███▎      | 33/100 [04:12<09:11,  8.24s/it]0.061098683395821425
best ic: 0.061098683395821425
epoch:  34%|███▍      | 34/100 [04:21<09:14,  8.41s/it]0.05167941196859121
epoch:  35%|███▌      | 35/100 [04:29<09:12,  8.50s/it]0.0534188903542536
epoch:  36%|███▌      | 36/100 [04:38<09:02,  8.48s/it]0.051556558787618105
epoch:  37%|███▋      | 37/100 [04:46<08:53,  8.47s/it]0.050207294522592594
epoch:  38%|███▊      | 38/100 [04:55<08:48,  8.53s/it]0.04666341258404739
epoch:  39%|███▉      | 39/100 [05:04<08:42,  8.56s/it]0.05223351561182616
epoch:  40%|████      | 40/100 [05:12<08:35,  8.60s/it]0.04471754633653464
epoch:  41%|████      | 41/100 [05:21<08:31,  8.67s/it]0.047593533842516654
epoch:  41%|████      | 41/100 [05:30<07:55,  8.05s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2907598:MainThread](2024-04-24 21:03:16,075) INFO - qlib.workflow - [exp.py:258] - Experiment 37 starts running ...
[2907598:MainThread](2024-04-24 21:03:16,089) INFO - qlib.workflow - [recorder.py:341] - Recorder 86fe37883eb0412db60e17fb822b5ba2 starts running under Experiment 37 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:03, 15.53it/s]online:   6%|▋         | 4/63 [00:00<00:03, 16.04it/s]online:  10%|▉         | 6/63 [00:00<00:03, 15.86it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 16.04it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 15.79it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 16.13it/s]online:  22%|██▏       | 14/63 [00:00<00:03, 16.30it/s]online:  25%|██▌       | 16/63 [00:00<00:02, 16.08it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 16.17it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 16.30it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 16.21it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 16.10it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 16.27it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 16.18it/s]online:  48%|████▊     | 30/63 [00:01<00:02, 15.93it/s]online:  51%|█████     | 32/63 [00:01<00:01, 15.93it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 16.05it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 15.88it/s]online:  60%|██████    | 38/63 [00:02<00:01, 16.24it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 16.34it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 16.64it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 16.61it/s]online:  73%|███████▎  | 46/63 [00:02<00:01, 16.72it/s]online:  76%|███████▌  | 48/63 [00:02<00:00, 16.88it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 16.50it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 16.17it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 16.39it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 16.35it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 16.19it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 16.10it/s]online:  98%|█████████▊| 62/63 [00:03<00:00, 16.00it/s]online: 100%|██████████| 63/63 [00:03<00:00, 16.22it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2907598:MainThread](2024-04-24 21:03:26,227) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99618024 mae 0.70766145
{'IC': 0.03255547500325296,
 'ICIR': 0.2649221294676209,
 'Rank IC': 0.03008340103876209,
 'Rank ICIR': 0.2484018289690483}
[2907598:MainThread](2024-04-24 21:03:27,931) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2907598:MainThread](2024-04-24 21:03:39,751) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 21:03:39,754) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 21:03:45,821) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f6127dfdd90>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:42,  9.44it/s]backtest loop:   1%|          | 9/971 [00:00<00:38, 24.94it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:26, 35.44it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.53it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:19, 47.62it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.96it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.45it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.46it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.51it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 56.30it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.79it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 57.34it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 59.00it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 56.72it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:14, 58.85it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 60.46it/s]backtest loop:  11%|█         | 108/971 [00:02<00:14, 57.78it/s]backtest loop:  12%|█▏        | 115/971 [00:02<00:14, 59.27it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.33it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:15, 53.02it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:15, 55.72it/s]backtest loop:  14%|█▍        | 140/971 [00:02<00:14, 56.75it/s]backtest loop:  15%|█▌        | 146/971 [00:02<00:15, 54.76it/s]backtest loop:  16%|█▌        | 153/971 [00:02<00:14, 57.07it/s]backtest loop:  16%|█▋        | 160/971 [00:03<00:13, 58.89it/s]backtest loop:  17%|█▋        | 166/971 [00:03<00:14, 55.97it/s]backtest loop:  18%|█▊        | 173/971 [00:03<00:13, 57.97it/s]backtest loop:  19%|█▊        | 180/971 [00:03<00:13, 59.34it/s]backtest loop:  19%|█▉        | 186/971 [00:03<00:13, 56.31it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:13, 57.28it/s]backtest loop:  20%|██        | 199/971 [00:03<00:13, 59.06it/s]backtest loop:  21%|██        | 205/971 [00:03<00:13, 55.92it/s]backtest loop:  22%|██▏       | 212/971 [00:03<00:13, 58.37it/s]backtest loop:  22%|██▏       | 218/971 [00:04<00:13, 55.74it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:13, 54.58it/s]backtest loop:  24%|██▍       | 232/971 [00:04<00:12, 57.10it/s]backtest loop:  25%|██▍       | 239/971 [00:04<00:12, 58.54it/s]backtest loop:  25%|██▌       | 245/971 [00:04<00:12, 55.87it/s]backtest loop:  26%|██▌       | 252/971 [00:04<00:12, 57.94it/s]backtest loop:  27%|██▋       | 259/971 [00:04<00:12, 56.27it/s]backtest loop:  27%|██▋       | 266/971 [00:04<00:12, 55.16it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 57.42it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:11, 58.93it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 56.28it/s]backtest loop:  30%|███       | 293/971 [00:05<00:11, 58.23it/s]backtest loop:  31%|███       | 300/971 [00:05<00:11, 56.13it/s]backtest loop:  32%|███▏      | 307/971 [00:05<00:11, 57.96it/s]backtest loop:  32%|███▏      | 314/971 [00:05<00:11, 59.04it/s]backtest loop:  33%|███▎      | 320/971 [00:05<00:11, 56.20it/s]backtest loop:  34%|███▎      | 326/971 [00:05<00:11, 57.09it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:11, 57.69it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 59.45it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 56.23it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 58.34it/s]backtest loop:  37%|███▋      | 359/971 [00:06<00:10, 59.66it/s]backtest loop:  38%|███▊      | 365/971 [00:06<00:10, 56.64it/s]backtest loop:  38%|███▊      | 371/971 [00:06<00:10, 54.56it/s]backtest loop:  39%|███▉      | 378/971 [00:06<00:11, 53.83it/s]backtest loop:  40%|███▉      | 385/971 [00:07<00:10, 56.51it/s]backtest loop:  40%|████      | 392/971 [00:07<00:09, 58.40it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 55.51it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 57.60it/s]backtest loop:  42%|████▏     | 411/971 [00:07<00:09, 58.16it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:09, 56.65it/s]backtest loop:  44%|████▍     | 425/971 [00:07<00:09, 58.41it/s]backtest loop:  44%|████▍     | 431/971 [00:07<00:09, 58.80it/s]backtest loop:  45%|████▌     | 437/971 [00:07<00:09, 55.90it/s]backtest loop:  46%|████▌     | 443/971 [00:08<00:09, 56.91it/s]backtest loop:  46%|████▋     | 450/971 [00:08<00:08, 58.74it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:09, 56.59it/s]backtest loop:  48%|████▊     | 463/971 [00:08<00:08, 57.41it/s]backtest loop:  48%|████▊     | 470/971 [00:08<00:08, 58.92it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:08, 56.80it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:13, 36.68it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:12, 39.52it/s]backtest loop:  51%|█████     | 497/971 [00:09<00:10, 44.67it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:09, 49.02it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:09, 49.14it/s]backtest loop:  53%|█████▎    | 516/971 [00:09<00:08, 51.67it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:08, 50.76it/s]backtest loop:  54%|█████▍    | 528/971 [00:09<00:08, 52.46it/s]backtest loop:  55%|█████▌    | 535/971 [00:09<00:07, 55.43it/s]backtest loop:  56%|█████▌    | 541/971 [00:09<00:08, 53.43it/s]backtest loop:  56%|█████▋    | 548/971 [00:10<00:07, 55.94it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 57.85it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 55.07it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:07, 57.31it/s]backtest loop:  59%|█████▉    | 575/971 [00:10<00:06, 59.00it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:06, 56.16it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:06, 58.11it/s]backtest loop:  61%|██████▏   | 595/971 [00:10<00:06, 59.54it/s]backtest loop:  62%|██████▏   | 601/971 [00:11<00:06, 56.81it/s]backtest loop:  63%|██████▎   | 608/971 [00:11<00:06, 58.58it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:06, 56.70it/s]backtest loop:  64%|██████▍   | 622/971 [00:11<00:05, 58.46it/s]backtest loop:  65%|██████▍   | 629/971 [00:11<00:05, 59.94it/s]backtest loop:  65%|██████▌   | 636/971 [00:11<00:05, 57.74it/s]backtest loop:  66%|██████▌   | 643/971 [00:11<00:05, 59.31it/s]backtest loop:  67%|██████▋   | 650/971 [00:11<00:05, 57.16it/s]backtest loop:  68%|██████▊   | 657/971 [00:11<00:05, 58.75it/s]backtest loop:  68%|██████▊   | 664/971 [00:12<00:05, 59.89it/s]backtest loop:  69%|██████▉   | 671/971 [00:12<00:05, 57.51it/s]backtest loop:  70%|██████▉   | 678/971 [00:12<00:04, 58.88it/s]backtest loop:  70%|███████   | 684/971 [00:12<00:05, 55.95it/s]backtest loop:  71%|███████   | 691/971 [00:12<00:04, 57.90it/s]backtest loop:  72%|███████▏  | 697/971 [00:12<00:04, 58.40it/s]backtest loop:  73%|███████▎  | 704/971 [00:12<00:04, 56.51it/s]backtest loop:  73%|███████▎  | 711/971 [00:12<00:04, 58.42it/s]backtest loop:  74%|███████▍  | 718/971 [00:12<00:04, 59.61it/s]backtest loop:  75%|███████▍  | 724/971 [00:13<00:04, 56.69it/s]backtest loop:  75%|███████▌  | 731/971 [00:13<00:04, 55.74it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 54.67it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:03, 56.76it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 54.68it/s]backtest loop:  78%|███████▊  | 757/971 [00:13<00:03, 55.92it/s]backtest loop:  79%|███████▊  | 764/971 [00:13<00:03, 57.98it/s]backtest loop:  79%|███████▉  | 770/971 [00:13<00:03, 55.37it/s]backtest loop:  80%|████████  | 777/971 [00:14<00:03, 57.51it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 55.25it/s]backtest loop:  81%|████████▏ | 790/971 [00:14<00:03, 57.37it/s]backtest loop:  82%|████████▏ | 796/971 [00:14<00:03, 57.97it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:02, 56.05it/s]backtest loop:  83%|████████▎ | 810/971 [00:14<00:02, 57.92it/s]backtest loop:  84%|████████▍ | 817/971 [00:14<00:02, 59.30it/s]backtest loop:  85%|████████▍ | 823/971 [00:14<00:02, 56.41it/s]backtest loop:  85%|████████▌ | 830/971 [00:14<00:02, 58.27it/s]backtest loop:  86%|████████▌ | 837/971 [00:15<00:02, 59.53it/s]backtest loop:  87%|████████▋ | 843/971 [00:15<00:02, 56.55it/s]backtest loop:  88%|████████▊ | 850/971 [00:15<00:02, 58.34it/s]backtest loop:  88%|████████▊ | 857/971 [00:15<00:02, 56.30it/s]backtest loop:  89%|████████▉ | 864/971 [00:15<00:01, 58.12it/s]backtest loop:  90%|████████▉ | 871/971 [00:15<00:01, 58.95it/s]backtest loop:  90%|█████████ | 877/971 [00:15<00:01, 55.89it/s]backtest loop:  91%|█████████ | 883/971 [00:15<00:01, 56.93it/s]backtest loop:  92%|█████████▏| 890/971 [00:16<00:01, 58.62it/s]backtest loop:  92%|█████████▏| 896/971 [00:16<00:01, 58.83it/s]backtest loop:  93%|█████████▎| 902/971 [00:16<00:01, 55.94it/s]backtest loop:  94%|█████████▎| 909/971 [00:16<00:01, 58.00it/s]backtest loop:  94%|█████████▍| 916/971 [00:16<00:00, 56.26it/s]backtest loop:  95%|█████████▌| 923/971 [00:16<00:00, 58.05it/s]backtest loop:  96%|█████████▌| 930/971 [00:16<00:00, 59.62it/s]backtest loop:  96%|█████████▋| 936/971 [00:16<00:00, 56.48it/s]backtest loop:  97%|█████████▋| 943/971 [00:16<00:00, 58.29it/s]backtest loop:  98%|█████████▊| 950/971 [00:17<00:00, 56.36it/s]backtest loop:  99%|█████████▊| 957/971 [00:17<00:00, 58.18it/s]backtest loop:  99%|█████████▉| 964/971 [00:17<00:00, 59.52it/s]backtest loop: 100%|█████████▉| 970/971 [00:17<00:00, 56.59it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.71it/s]
[2907598:MainThread](2024-04-24 21:04:03,382) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000517
std                0.005050
annualized_return  0.122973
information_ratio  1.578471
max_drawdown      -0.069250
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000319
std                0.005051
annualized_return  0.075864
information_ratio  0.973621
max_drawdown      -0.103167
[2907598:MainThread](2024-04-24 21:04:03,398) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_LSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_20:45:25_online`.
Round 3 Done!
{'1day.excess_return_with_cost.annualized_return': [0.05466509644132003,
                                                    0.03782940405138317,
                                                    0.07586443941440547],
 '1day.excess_return_with_cost.information_ratio': [0.7299136334968934,
                                                    0.5090576149926579,
                                                    0.973621450511456],
 '1day.excess_return_with_cost.max_drawdown': [-0.10300273228156126,
                                               -0.07110045372162947,
                                               -0.10316664621820637],
 'IC': [0.027313668501984606, 0.02579261406197789, 0.03255547500325296],
 'ICIR': [0.22308366803828927, 0.2041430983365273, 0.2649221294676209],
 'Rank IC': [0.029403174427850773, 0.026010289810945806, 0.03008340103876209],
 'Rank ICIR': [0.23996303432974886, 0.2041684188204175, 0.2484018289690483],
 'mae': [0.707563579082489, 0.707649827003479, 0.7076614499092102],
 'mse': [0.9965025782585144, 0.9965060353279114, 0.9961802363395691]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2907598:MainThread](2024-04-24 21:04:04,598) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[2907598:MainThread](2024-04-24 21:04:04,599) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:07<12:34,  7.62s/it]epoch:   2%|▏         | 2/100 [00:15<12:20,  7.56s/it]epoch:   3%|▎         | 3/100 [00:22<12:02,  7.45s/it]epoch:   4%|▍         | 4/100 [00:29<11:58,  7.49s/it]epoch:   5%|▌         | 5/100 [00:37<11:57,  7.55s/it]epoch:   6%|▌         | 6/100 [00:44<11:41,  7.46s/it]epoch:   7%|▋         | 7/100 [00:52<11:41,  7.54s/it]epoch:   8%|▊         | 8/100 [01:00<11:35,  7.56s/it]epoch:   9%|▉         | 9/100 [01:07<11:25,  7.54s/it]epoch:  10%|█         | 10/100 [01:15<11:20,  7.56s/it]epoch:  11%|█         | 11/100 [01:23<11:15,  7.59s/it]epoch:  12%|█▏        | 12/100 [01:30<11:05,  7.56s/it]epoch:  13%|█▎        | 13/100 [01:38<10:56,  7.54s/it]epoch:  14%|█▍        | 14/100 [01:45<10:50,  7.56s/it]epoch:  15%|█▌        | 15/100 [01:53<10:45,  7.60s/it]epoch:  16%|█▌        | 16/100 [02:00<10:37,  7.58s/it]epoch:  17%|█▋        | 17/100 [02:08<10:23,  7.51s/it]epoch:  18%|█▊        | 18/100 [02:15<10:16,  7.52s/it]epoch:  19%|█▉        | 19/100 [02:23<10:10,  7.54s/it]epoch:  20%|██        | 20/100 [02:31<10:08,  7.60s/it]epoch:  21%|██        | 21/100 [02:38<09:58,  7.58s/it]epoch:  22%|██▏       | 22/100 [02:46<09:50,  7.57s/it]epoch:  23%|██▎       | 23/100 [02:53<09:43,  7.57s/it]epoch:  24%|██▍       | 24/100 [03:01<09:36,  7.58s/it]epoch:  25%|██▌       | 25/100 [03:08<09:27,  7.57s/it]epoch:  26%|██▌       | 26/100 [03:16<09:22,  7.60s/it]epoch:  27%|██▋       | 27/100 [03:24<09:12,  7.57s/it]epoch:  28%|██▊       | 28/100 [03:31<09:03,  7.55s/it]epoch:  29%|██▉       | 29/100 [03:39<08:55,  7.54s/it]epoch:  30%|███       | 30/100 [03:46<08:42,  7.47s/it]0.059140811188669255
best ic: 0.059140811188669255
epoch:  31%|███       | 31/100 [03:54<08:59,  7.81s/it]0.06174189071442137
best ic: 0.06174189071442137
epoch:  32%|███▏      | 32/100 [04:03<09:11,  8.11s/it]0.05608225163691731
epoch:  33%|███▎      | 33/100 [04:12<09:17,  8.32s/it]0.05302011994101671
epoch:  34%|███▍      | 34/100 [04:21<09:13,  8.38s/it]0.0568681018780634
epoch:  35%|███▌      | 35/100 [04:29<09:07,  8.42s/it]0.05664506679840893
epoch:  36%|███▌      | 36/100 [04:37<08:57,  8.40s/it]0.05731421085006251
epoch:  37%|███▋      | 37/100 [04:46<08:53,  8.47s/it]0.054395581679545016
epoch:  38%|███▊      | 38/100 [04:55<08:47,  8.51s/it]0.056996287076161445
epoch:  39%|███▉      | 39/100 [05:03<08:39,  8.52s/it]0.05707374787037259
epoch:  39%|███▉      | 39/100 [05:12<08:08,  8.01s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2907598:MainThread](2024-04-24 21:09:17,052) INFO - qlib.workflow - [exp.py:258] - Experiment 37 starts running ...
[2907598:MainThread](2024-04-24 21:09:17,104) INFO - qlib.workflow - [recorder.py:341] - Recorder e2bb5f8d78e54b80b4e39711aeb011e5 starts running under Experiment 37 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:03, 16.04it/s]online:   6%|▋         | 4/63 [00:00<00:03, 16.05it/s]online:  10%|▉         | 6/63 [00:00<00:03, 16.54it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 16.37it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 16.27it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 16.20it/s]online:  22%|██▏       | 14/63 [00:00<00:03, 16.25it/s]online:  25%|██▌       | 16/63 [00:00<00:02, 16.29it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 16.56it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 16.62it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 16.55it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 16.46it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 16.37it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 16.14it/s]online:  48%|████▊     | 30/63 [00:01<00:02, 16.11it/s]online:  51%|█████     | 32/63 [00:01<00:01, 16.23it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 16.30it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 16.45it/s]online:  60%|██████    | 38/63 [00:02<00:01, 16.27it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 16.29it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 16.06it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 16.26it/s]online:  73%|███████▎  | 46/63 [00:02<00:01, 16.11it/s]online:  76%|███████▌  | 48/63 [00:02<00:00, 16.27it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 16.00it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 16.01it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 16.05it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 16.33it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 16.14it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 16.40it/s]online:  98%|█████████▊| 62/63 [00:03<00:00, 16.28it/s]online: 100%|██████████| 63/63 [00:04<00:00, 15.19it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2907598:MainThread](2024-04-24 21:09:27,530) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.99620193 mae 0.70738167
{'IC': 0.031253622229328794,
 'ICIR': 0.2376593376010492,
 'Rank IC': 0.03454798288534817,
 'Rank ICIR': 0.2636972930450768}
[2907598:MainThread](2024-04-24 21:09:29,289) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2907598:MainThread](2024-04-24 21:09:41,196) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 21:09:41,199) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 21:09:47,257) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f6139994f70>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:45,  9.21it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.66it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 37.11it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.15it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:19, 47.27it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 48.24it/s]backtest loop:   4%|▍         | 40/971 [00:00<00:18, 51.34it/s]backtest loop:   5%|▍         | 47/971 [00:01<00:16, 54.60it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.85it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 56.35it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.86it/s]backtest loop:   8%|▊         | 73/971 [00:01<00:15, 56.15it/s]backtest loop:   8%|▊         | 80/971 [00:01<00:15, 58.33it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 56.72it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 58.47it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 59.63it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.68it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 58.53it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.71it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:15, 53.75it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:14, 56.20it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 55.03it/s]backtest loop:  15%|█▌        | 147/971 [00:02<00:14, 56.19it/s]backtest loop:  16%|█▌        | 154/971 [00:02<00:14, 58.15it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 56.28it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:13, 58.13it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:13, 59.47it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:13, 57.00it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 58.63it/s]backtest loop:  20%|██        | 195/971 [00:03<00:13, 56.34it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 58.25it/s]backtest loop:  22%|██▏       | 209/971 [00:03<00:12, 59.60it/s]backtest loop:  22%|██▏       | 215/971 [00:04<00:13, 54.01it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:13, 56.33it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:12, 58.66it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:13, 56.05it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:12, 58.16it/s]backtest loop:  26%|██▌       | 248/971 [00:04<00:12, 58.48it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:12, 56.05it/s]backtest loop:  27%|██▋       | 261/971 [00:04<00:12, 57.86it/s]backtest loop:  27%|██▋       | 267/971 [00:04<00:12, 55.67it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 56.75it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:11, 58.87it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 56.05it/s]backtest loop:  30%|███       | 293/971 [00:05<00:11, 57.98it/s]backtest loop:  31%|███       | 299/971 [00:05<00:11, 58.47it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:11, 55.59it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 57.90it/s]backtest loop:  33%|███▎      | 319/971 [00:05<00:11, 59.27it/s]backtest loop:  33%|███▎      | 325/971 [00:05<00:11, 56.29it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:10, 58.50it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 59.63it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 56.71it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 58.22it/s]backtest loop:  37%|███▋      | 359/971 [00:06<00:10, 59.69it/s]backtest loop:  38%|███▊      | 365/971 [00:06<00:10, 56.62it/s]backtest loop:  38%|███▊      | 371/971 [00:06<00:10, 54.68it/s]backtest loop:  39%|███▉      | 378/971 [00:06<00:10, 53.99it/s]backtest loop:  40%|███▉      | 385/971 [00:06<00:10, 56.46it/s]backtest loop:  40%|████      | 392/971 [00:07<00:09, 58.22it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 55.62it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 57.54it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:09, 58.91it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:09, 55.94it/s]backtest loop:  44%|████▎     | 424/971 [00:07<00:15, 35.23it/s]backtest loop:  44%|████▍     | 431/971 [00:08<00:13, 40.95it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:12, 42.67it/s]backtest loop:  46%|████▌     | 443/971 [00:08<00:11, 46.33it/s]backtest loop:  46%|████▌     | 449/971 [00:08<00:10, 49.47it/s]backtest loop:  47%|████▋     | 455/971 [00:08<00:09, 51.87it/s]backtest loop:  47%|████▋     | 461/971 [00:08<00:09, 54.02it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:09, 52.59it/s]backtest loop:  49%|████▊     | 473/971 [00:08<00:09, 54.52it/s]backtest loop:  49%|████▉     | 480/971 [00:08<00:08, 57.06it/s]backtest loop:  50%|█████     | 487/971 [00:09<00:08, 55.46it/s]backtest loop:  51%|█████     | 493/971 [00:09<00:08, 56.63it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 55.32it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 54.65it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 57.01it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 58.84it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:07, 56.23it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:07, 58.24it/s]backtest loop:  56%|█████▌    | 540/971 [00:09<00:07, 58.65it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 55.81it/s]backtest loop:  57%|█████▋    | 552/971 [00:10<00:07, 56.41it/s]backtest loop:  58%|█████▊    | 559/971 [00:10<00:07, 58.31it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 56.43it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:06, 58.32it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 59.62it/s]backtest loop:  60%|██████    | 586/971 [00:10<00:06, 56.65it/s]backtest loop:  61%|██████    | 593/971 [00:10<00:06, 58.21it/s]backtest loop:  62%|██████▏   | 600/971 [00:10<00:06, 56.22it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 58.15it/s]backtest loop:  63%|██████▎   | 614/971 [00:11<00:06, 59.47it/s]backtest loop:  64%|██████▍   | 620/971 [00:11<00:06, 56.52it/s]backtest loop:  65%|██████▍   | 627/971 [00:11<00:05, 58.45it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:05, 59.76it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:05, 56.71it/s]backtest loop:  67%|██████▋   | 646/971 [00:11<00:05, 57.48it/s]backtest loop:  67%|██████▋   | 653/971 [00:11<00:05, 58.86it/s]backtest loop:  68%|██████▊   | 660/971 [00:12<00:05, 56.70it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 58.40it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:05, 56.41it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:04, 58.12it/s]backtest loop:  71%|███████   | 687/971 [00:12<00:04, 58.53it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:04, 56.33it/s]backtest loop:  72%|███████▏  | 700/971 [00:12<00:04, 56.61it/s]backtest loop:  73%|███████▎  | 706/971 [00:12<00:04, 55.20it/s]backtest loop:  73%|███████▎  | 713/971 [00:12<00:04, 57.40it/s]backtest loop:  74%|███████▍  | 719/971 [00:13<00:04, 55.18it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 57.32it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 55.13it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 53.38it/s]backtest loop:  77%|███████▋  | 744/971 [00:13<00:04, 55.00it/s]backtest loop:  77%|███████▋  | 750/971 [00:13<00:04, 53.50it/s]backtest loop:  78%|███████▊  | 756/971 [00:13<00:03, 54.12it/s]backtest loop:  79%|███████▊  | 763/971 [00:13<00:03, 56.70it/s]backtest loop:  79%|███████▉  | 770/971 [00:13<00:03, 55.22it/s]backtest loop:  80%|███████▉  | 776/971 [00:14<00:03, 56.38it/s]backtest loop:  81%|████████  | 783/971 [00:14<00:03, 54.98it/s]backtest loop:  81%|████████▏ | 790/971 [00:14<00:03, 57.24it/s]backtest loop:  82%|████████▏ | 796/971 [00:14<00:03, 57.63it/s]backtest loop:  83%|████████▎ | 803/971 [00:14<00:03, 55.78it/s]backtest loop:  83%|████████▎ | 809/971 [00:14<00:02, 55.92it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 56.14it/s]backtest loop:  85%|████████▍ | 822/971 [00:14<00:02, 58.07it/s]backtest loop:  85%|████████▌ | 828/971 [00:15<00:02, 55.67it/s]backtest loop:  86%|████████▌ | 835/971 [00:15<00:02, 57.83it/s]backtest loop:  87%|████████▋ | 842/971 [00:15<00:02, 59.29it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 56.04it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:01, 58.06it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 56.11it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 58.11it/s]backtest loop:  90%|█████████ | 876/971 [00:15<00:01, 59.45it/s]backtest loop:  91%|█████████ | 882/971 [00:15<00:01, 56.64it/s]backtest loop:  91%|█████████▏| 888/971 [00:16<00:01, 57.41it/s]backtest loop:  92%|█████████▏| 895/971 [00:16<00:01, 58.96it/s]backtest loop:  93%|█████████▎| 901/971 [00:16<00:01, 59.22it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 56.11it/s]backtest loop:  94%|█████████▍| 914/971 [00:16<00:00, 58.31it/s]backtest loop:  95%|█████████▍| 921/971 [00:16<00:00, 56.41it/s]backtest loop:  96%|█████████▌| 928/971 [00:16<00:00, 58.10it/s]backtest loop:  96%|█████████▋| 935/971 [00:16<00:00, 59.56it/s]backtest loop:  97%|█████████▋| 941/971 [00:16<00:00, 56.59it/s]backtest loop:  98%|█████████▊| 948/971 [00:17<00:00, 58.42it/s]backtest loop:  98%|█████████▊| 954/971 [00:17<00:00, 58.74it/s]backtest loop:  99%|█████████▉| 960/971 [00:17<00:00, 55.92it/s]backtest loop: 100%|█████████▉| 967/971 [00:17<00:00, 57.89it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.52it/s]
[2907598:MainThread](2024-04-24 21:10:04,823) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000620
std                0.005560
annualized_return  0.147641
information_ratio  1.721200
max_drawdown      -0.092212
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000423
std                0.005561
annualized_return  0.100724
information_ratio  1.174150
max_drawdown      -0.125653
[2907598:MainThread](2024-04-24 21:10:04,839) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_LSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_20:45:25_online`.
Round 4 Done!
{'1day.excess_return_with_cost.annualized_return': [0.05466509644132003,
                                                    0.03782940405138317,
                                                    0.07586443941440547,
                                                    0.1007235789374887],
 '1day.excess_return_with_cost.information_ratio': [0.7299136334968934,
                                                    0.5090576149926579,
                                                    0.973621450511456,
                                                    1.1741504408846737],
 '1day.excess_return_with_cost.max_drawdown': [-0.10300273228156126,
                                               -0.07110045372162947,
                                               -0.10316664621820637,
                                               -0.12565292200159456],
 'IC': [0.027313668501984606,
        0.02579261406197789,
        0.03255547500325296,
        0.031253622229328794],
 'ICIR': [0.22308366803828927,
          0.2041430983365273,
          0.2649221294676209,
          0.2376593376010492],
 'Rank IC': [0.029403174427850773,
             0.026010289810945806,
             0.03008340103876209,
             0.03454798288534817],
 'Rank ICIR': [0.23996303432974886,
               0.2041684188204175,
               0.2484018289690483,
               0.2636972930450768],
 'mae': [0.707563579082489,
         0.707649827003479,
         0.7076614499092102,
         0.7073816657066345],
 'mse': [0.9965025782585144,
         0.9965060353279114,
         0.9961802363395691,
         0.9962019324302673]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2907598:MainThread](2024-04-24 21:10:06,034) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[2907598:MainThread](2024-04-24 21:10:06,034) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:07<12:55,  7.83s/it]epoch:   2%|▏         | 2/100 [00:15<12:27,  7.63s/it]epoch:   3%|▎         | 3/100 [00:23<12:23,  7.67s/it]epoch:   4%|▍         | 4/100 [00:30<12:19,  7.70s/it]epoch:   5%|▌         | 5/100 [00:38<12:05,  7.64s/it]epoch:   6%|▌         | 6/100 [00:45<11:56,  7.63s/it]epoch:   7%|▋         | 7/100 [00:53<11:40,  7.53s/it]epoch:   8%|▊         | 8/100 [01:00<11:32,  7.52s/it]epoch:   9%|▉         | 9/100 [01:08<11:27,  7.55s/it]epoch:  10%|█         | 10/100 [01:15<11:13,  7.49s/it]epoch:  11%|█         | 11/100 [01:23<11:07,  7.50s/it]epoch:  12%|█▏        | 12/100 [01:30<11:06,  7.57s/it]epoch:  13%|█▎        | 13/100 [01:38<11:00,  7.60s/it]epoch:  14%|█▍        | 14/100 [01:46<10:47,  7.53s/it]epoch:  15%|█▌        | 15/100 [01:53<10:39,  7.53s/it]epoch:  16%|█▌        | 16/100 [02:01<10:33,  7.55s/it]epoch:  17%|█▋        | 17/100 [02:08<10:28,  7.58s/it]epoch:  18%|█▊        | 18/100 [02:16<10:18,  7.55s/it]epoch:  19%|█▉        | 19/100 [02:23<10:06,  7.48s/it]epoch:  20%|██        | 20/100 [02:31<09:57,  7.46s/it]epoch:  21%|██        | 21/100 [02:38<09:53,  7.51s/it]epoch:  22%|██▏       | 22/100 [02:46<09:48,  7.55s/it]epoch:  23%|██▎       | 23/100 [02:53<09:35,  7.47s/it]epoch:  24%|██▍       | 24/100 [03:00<09:27,  7.46s/it]epoch:  25%|██▌       | 25/100 [03:08<09:14,  7.40s/it]epoch:  26%|██▌       | 26/100 [03:15<09:04,  7.35s/it]epoch:  27%|██▋       | 27/100 [03:23<09:01,  7.42s/it]epoch:  28%|██▊       | 28/100 [03:30<09:00,  7.51s/it]epoch:  29%|██▉       | 29/100 [03:38<08:55,  7.54s/it]epoch:  30%|███       | 30/100 [03:45<08:46,  7.52s/it]0.05578120087104049
best ic: 0.05578120087104049
epoch:  31%|███       | 31/100 [03:54<09:01,  7.85s/it]0.053416117009411804
epoch:  32%|███▏      | 32/100 [04:02<09:07,  8.05s/it]0.05354318381231721
epoch:  33%|███▎      | 33/100 [04:11<09:11,  8.24s/it]0.04773600703442337
epoch:  34%|███▍      | 34/100 [04:20<09:14,  8.39s/it]0.05423407594623401
epoch:  35%|███▌      | 35/100 [04:29<09:09,  8.46s/it]0.0533090151338158
epoch:  36%|███▌      | 36/100 [04:37<09:06,  8.53s/it]0.05504191015252767
epoch:  37%|███▋      | 37/100 [04:46<09:00,  8.57s/it]0.05185110267319391
epoch:  38%|███▊      | 38/100 [04:55<08:53,  8.61s/it]0.050235469833402435
epoch:  38%|███▊      | 38/100 [05:03<08:15,  7.99s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2907598:MainThread](2024-04-24 21:15:09,865) INFO - qlib.workflow - [exp.py:258] - Experiment 37 starts running ...
[2907598:MainThread](2024-04-24 21:15:09,879) INFO - qlib.workflow - [recorder.py:341] - Recorder 8d0000c779bf453f9560147113ca4953 starts running under Experiment 37 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:03, 15.94it/s]online:   6%|▋         | 4/63 [00:00<00:03, 15.87it/s]online:  10%|▉         | 6/63 [00:00<00:03, 16.15it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 16.09it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 16.18it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 16.13it/s]online:  22%|██▏       | 14/63 [00:00<00:03, 15.94it/s]online:  25%|██▌       | 16/63 [00:00<00:02, 16.13it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 16.02it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 16.04it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 16.20it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 16.24it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 16.20it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 16.09it/s]online:  48%|████▊     | 30/63 [00:01<00:02, 15.99it/s]online:  51%|█████     | 32/63 [00:01<00:01, 16.09it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 16.14it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 16.09it/s]online:  60%|██████    | 38/63 [00:02<00:01, 16.40it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 16.26it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 16.27it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 16.21it/s]online:  73%|███████▎  | 46/63 [00:02<00:01, 16.08it/s]online:  76%|███████▌  | 48/63 [00:02<00:00, 16.21it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 16.08it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 16.14it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 16.14it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 16.09it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 16.14it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 16.27it/s]online:  98%|█████████▊| 62/63 [00:03<00:00, 16.15it/s]online: 100%|██████████| 63/63 [00:03<00:00, 16.17it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2907598:MainThread](2024-04-24 21:15:20,157) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9962647 mae 0.7075479
{'IC': 0.028359953926004513,
 'ICIR': 0.22114083430756656,
 'Rank IC': 0.03048201533902068,
 'Rank ICIR': 0.2367898341421186}
[2907598:MainThread](2024-04-24 21:15:21,862) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2907598:MainThread](2024-04-24 21:15:34,227) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 21:15:34,230) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 21:15:40,351) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f611e12c1f0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:44,  9.28it/s]backtest loop:   1%|          | 10/971 [00:00<00:35, 26.85it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:26, 36.10it/s]backtest loop:   2%|▏         | 24/971 [00:00<00:22, 41.58it/s]backtest loop:   3%|▎         | 31/971 [00:00<00:19, 47.76it/s]backtest loop:   4%|▍         | 37/971 [00:00<00:18, 50.64it/s]backtest loop:   5%|▍         | 44/971 [00:01<00:18, 50.96it/s]backtest loop:   5%|▌         | 51/971 [00:01<00:16, 54.15it/s]backtest loop:   6%|▌         | 57/971 [00:01<00:17, 52.56it/s]backtest loop:   7%|▋         | 64/971 [00:01<00:16, 55.62it/s]backtest loop:   7%|▋         | 71/971 [00:01<00:15, 57.86it/s]backtest loop:   8%|▊         | 77/971 [00:01<00:16, 55.51it/s]backtest loop:   9%|▊         | 84/971 [00:01<00:15, 57.51it/s]backtest loop:   9%|▉         | 91/971 [00:01<00:14, 59.17it/s]backtest loop:  10%|▉         | 97/971 [00:01<00:15, 56.49it/s]backtest loop:  11%|█         | 104/971 [00:02<00:14, 58.40it/s]backtest loop:  11%|█▏        | 111/971 [00:02<00:14, 59.80it/s]backtest loop:  12%|█▏        | 118/971 [00:02<00:14, 57.34it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 55.66it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 53.54it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:14, 56.15it/s]backtest loop:  15%|█▍        | 144/971 [00:02<00:14, 57.15it/s]backtest loop:  16%|█▌        | 151/971 [00:02<00:14, 55.77it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:14, 57.88it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:13, 59.26it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:14, 56.20it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:13, 58.09it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:13, 56.31it/s]backtest loop:  20%|█▉        | 192/971 [00:03<00:13, 58.30it/s]backtest loop:  20%|██        | 199/971 [00:03<00:12, 59.59it/s]backtest loop:  21%|██        | 205/971 [00:03<00:13, 56.44it/s]backtest loop:  22%|██▏       | 212/971 [00:03<00:12, 58.48it/s]backtest loop:  22%|██▏       | 218/971 [00:04<00:13, 55.84it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:13, 54.64it/s]backtest loop:  24%|██▍       | 232/971 [00:04<00:12, 56.96it/s]backtest loop:  25%|██▍       | 239/971 [00:04<00:12, 58.76it/s]backtest loop:  25%|██▌       | 245/971 [00:04<00:13, 55.47it/s]backtest loop:  26%|██▌       | 252/971 [00:04<00:12, 58.07it/s]backtest loop:  27%|██▋       | 259/971 [00:04<00:12, 56.10it/s]backtest loop:  27%|██▋       | 266/971 [00:04<00:12, 55.02it/s]backtest loop:  28%|██▊       | 273/971 [00:05<00:12, 57.16it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:11, 58.76it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 55.80it/s]backtest loop:  30%|███       | 293/971 [00:05<00:11, 57.61it/s]backtest loop:  31%|███       | 300/971 [00:05<00:11, 56.01it/s]backtest loop:  32%|███▏      | 307/971 [00:05<00:11, 57.80it/s]backtest loop:  32%|███▏      | 314/971 [00:05<00:11, 59.38it/s]backtest loop:  33%|███▎      | 320/971 [00:05<00:11, 56.24it/s]backtest loop:  34%|███▎      | 327/971 [00:05<00:11, 58.44it/s]backtest loop:  34%|███▍      | 334/971 [00:06<00:10, 59.62it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:11, 56.64it/s]backtest loop:  36%|███▌      | 346/971 [00:06<00:10, 57.30it/s]backtest loop:  36%|███▋      | 353/971 [00:06<00:10, 58.87it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 56.96it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.42it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 53.85it/s]backtest loop:  39%|███▉      | 380/971 [00:06<00:10, 56.23it/s]backtest loop:  40%|███▉      | 387/971 [00:07<00:10, 58.14it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 55.76it/s]backtest loop:  41%|████      | 400/971 [00:07<00:09, 57.79it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 59.28it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:09, 56.39it/s]backtest loop:  43%|████▎     | 420/971 [00:07<00:15, 36.29it/s]backtest loop:  44%|████▍     | 427/971 [00:07<00:13, 41.71it/s]backtest loop:  45%|████▍     | 433/971 [00:08<00:12, 43.60it/s]backtest loop:  45%|████▌     | 439/971 [00:08<00:11, 46.98it/s]backtest loop:  46%|████▌     | 445/971 [00:08<00:10, 50.09it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:09, 52.60it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:10, 51.23it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:09, 54.36it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:08, 56.71it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:09, 54.31it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:08, 56.59it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:08, 54.32it/s]backtest loop:  51%|█████     | 497/971 [00:09<00:08, 56.80it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:07, 58.53it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:08, 56.09it/s]backtest loop:  53%|█████▎    | 517/971 [00:09<00:08, 54.96it/s]backtest loop:  54%|█████▍    | 524/971 [00:09<00:07, 57.18it/s]backtest loop:  55%|█████▍    | 531/971 [00:09<00:07, 55.69it/s]backtest loop:  55%|█████▌    | 538/971 [00:09<00:07, 57.49it/s]backtest loop:  56%|█████▌    | 544/971 [00:10<00:07, 57.90it/s]backtest loop:  57%|█████▋    | 550/971 [00:10<00:07, 58.34it/s]backtest loop:  57%|█████▋    | 556/971 [00:10<00:07, 55.31it/s]backtest loop:  58%|█████▊    | 563/971 [00:10<00:07, 57.54it/s]backtest loop:  59%|█████▊    | 570/971 [00:10<00:06, 59.12it/s]backtest loop:  59%|█████▉    | 576/971 [00:10<00:07, 56.40it/s]backtest loop:  60%|██████    | 583/971 [00:10<00:06, 58.14it/s]backtest loop:  61%|██████    | 590/971 [00:10<00:06, 59.57it/s]backtest loop:  61%|██████▏   | 596/971 [00:10<00:06, 56.69it/s]backtest loop:  62%|██████▏   | 603/971 [00:11<00:06, 58.41it/s]backtest loop:  63%|██████▎   | 610/971 [00:11<00:06, 56.45it/s]backtest loop:  64%|██████▎   | 617/971 [00:11<00:06, 58.15it/s]backtest loop:  64%|██████▍   | 624/971 [00:11<00:05, 59.49it/s]backtest loop:  65%|██████▍   | 630/971 [00:11<00:06, 56.55it/s]backtest loop:  66%|██████▌   | 637/971 [00:11<00:05, 58.32it/s]backtest loop:  66%|██████▋   | 644/971 [00:11<00:05, 59.72it/s]backtest loop:  67%|██████▋   | 650/971 [00:11<00:05, 56.63it/s]backtest loop:  68%|██████▊   | 656/971 [00:11<00:05, 57.48it/s]backtest loop:  68%|██████▊   | 663/971 [00:12<00:05, 58.99it/s]backtest loop:  69%|██████▉   | 670/971 [00:12<00:05, 56.65it/s]backtest loop:  70%|██████▉   | 677/971 [00:12<00:05, 58.24it/s]backtest loop:  70%|███████   | 683/971 [00:12<00:04, 58.54it/s]backtest loop:  71%|███████   | 689/971 [00:12<00:05, 55.76it/s]backtest loop:  72%|███████▏  | 696/971 [00:12<00:04, 57.72it/s]backtest loop:  72%|███████▏  | 703/971 [00:12<00:04, 59.26it/s]backtest loop:  73%|███████▎  | 709/971 [00:12<00:04, 56.33it/s]backtest loop:  74%|███████▎  | 716/971 [00:13<00:04, 58.27it/s]backtest loop:  74%|███████▍  | 723/971 [00:13<00:04, 59.60it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 56.54it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 54.45it/s]backtest loop:  76%|███████▋  | 742/971 [00:13<00:04, 56.75it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.53it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 53.84it/s]backtest loop:  78%|███████▊  | 761/971 [00:13<00:03, 55.41it/s]backtest loop:  79%|███████▉  | 768/971 [00:13<00:03, 57.53it/s]backtest loop:  80%|███████▉  | 775/971 [00:14<00:03, 55.58it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 57.53it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 55.17it/s]backtest loop:  82%|████████▏ | 794/971 [00:14<00:03, 56.21it/s]backtest loop:  82%|████████▏ | 800/971 [00:14<00:02, 57.05it/s]backtest loop:  83%|████████▎ | 807/971 [00:14<00:02, 58.68it/s]backtest loop:  84%|████████▎ | 813/971 [00:14<00:02, 55.76it/s]backtest loop:  84%|████████▍ | 820/971 [00:14<00:02, 57.70it/s]backtest loop:  85%|████████▌ | 827/971 [00:14<00:02, 59.20it/s]backtest loop:  86%|████████▌ | 833/971 [00:15<00:02, 56.24it/s]backtest loop:  86%|████████▋ | 839/971 [00:15<00:02, 57.19it/s]backtest loop:  87%|████████▋ | 846/971 [00:15<00:02, 58.82it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 55.98it/s]backtest loop:  88%|████████▊ | 859/971 [00:15<00:01, 58.02it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 59.37it/s]backtest loop:  90%|████████▉ | 872/971 [00:15<00:01, 56.32it/s]backtest loop:  91%|█████████ | 879/971 [00:15<00:01, 58.20it/s]backtest loop:  91%|█████████ | 886/971 [00:15<00:01, 59.36it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 56.29it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 58.12it/s]backtest loop:  93%|█████████▎| 905/971 [00:16<00:01, 58.37it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 56.44it/s]backtest loop:  95%|█████████▍| 919/971 [00:16<00:00, 58.23it/s]backtest loop:  95%|█████████▌| 926/971 [00:16<00:00, 56.23it/s]backtest loop:  96%|█████████▌| 933/971 [00:16<00:00, 57.99it/s]backtest loop:  97%|█████████▋| 939/971 [00:16<00:00, 58.28it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 55.59it/s]backtest loop:  98%|█████████▊| 951/971 [00:17<00:00, 56.74it/s]backtest loop:  99%|█████████▊| 958/971 [00:17<00:00, 58.44it/s]backtest loop:  99%|█████████▉| 965/971 [00:17<00:00, 56.41it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 57.32it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.56it/s]
[2907598:MainThread](2024-04-24 21:15:57,902) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000547
std                0.005115
annualized_return  0.130162
information_ratio  1.649450
max_drawdown      -0.062308
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000349
std                0.005116
annualized_return  0.083080
information_ratio  1.052698
max_drawdown      -0.086662
[2907598:MainThread](2024-04-24 21:15:57,918) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_LSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_20:45:25_online`.
Round 5 Done!
{'1day.excess_return_with_cost.annualized_return': [0.05466509644132003,
                                                    0.03782940405138317,
                                                    0.07586443941440547,
                                                    0.1007235789374887,
                                                    0.08308022585420154],
 '1day.excess_return_with_cost.information_ratio': [0.7299136334968934,
                                                    0.5090576149926579,
                                                    0.973621450511456,
                                                    1.1741504408846737,
                                                    1.0526981011869454],
 '1day.excess_return_with_cost.max_drawdown': [-0.10300273228156126,
                                               -0.07110045372162947,
                                               -0.10316664621820637,
                                               -0.12565292200159456,
                                               -0.0866624354594844],
 'IC': [0.027313668501984606,
        0.02579261406197789,
        0.03255547500325296,
        0.031253622229328794,
        0.028359953926004513],
 'ICIR': [0.22308366803828927,
          0.2041430983365273,
          0.2649221294676209,
          0.2376593376010492,
          0.22114083430756656],
 'Rank IC': [0.029403174427850773,
             0.026010289810945806,
             0.03008340103876209,
             0.03454798288534817,
             0.03048201533902068],
 'Rank ICIR': [0.23996303432974886,
               0.2041684188204175,
               0.2484018289690483,
               0.2636972930450768,
               0.2367898341421186],
 'mae': [0.707563579082489,
         0.707649827003479,
         0.7076614499092102,
         0.7073816657066345,
         0.7075479030609131],
 'mse': [0.9965025782585144,
         0.9965060353279114,
         0.9961802363395691,
         0.9962019324302673,
         0.9962646961212158]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2907598:MainThread](2024-04-24 21:15:59,103) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[2907598:MainThread](2024-04-24 21:15:59,104) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:07<12:59,  7.87s/it]epoch:   2%|▏         | 2/100 [00:15<12:41,  7.78s/it]epoch:   3%|▎         | 3/100 [00:22<12:15,  7.58s/it]epoch:   4%|▍         | 4/100 [00:30<12:05,  7.55s/it]epoch:   5%|▌         | 5/100 [00:37<11:49,  7.47s/it]epoch:   6%|▌         | 6/100 [00:45<11:51,  7.57s/it]epoch:   7%|▋         | 7/100 [00:52<11:40,  7.53s/it]epoch:   8%|▊         | 8/100 [01:00<11:32,  7.52s/it]epoch:   9%|▉         | 9/100 [01:08<11:30,  7.59s/it]epoch:  10%|█         | 10/100 [01:15<11:13,  7.49s/it]epoch:  11%|█         | 11/100 [01:22<11:05,  7.48s/it]epoch:  12%|█▏        | 12/100 [01:30<11:04,  7.56s/it]epoch:  13%|█▎        | 13/100 [01:38<10:57,  7.55s/it]epoch:  14%|█▍        | 14/100 [01:45<10:44,  7.50s/it]epoch:  15%|█▌        | 15/100 [01:53<10:35,  7.48s/it]epoch:  16%|█▌        | 16/100 [02:00<10:32,  7.53s/it]epoch:  17%|█▋        | 17/100 [02:08<10:26,  7.55s/it]epoch:  18%|█▊        | 18/100 [02:15<10:16,  7.52s/it]epoch:  19%|█▉        | 19/100 [02:22<10:01,  7.43s/it]epoch:  20%|██        | 20/100 [02:30<09:54,  7.44s/it]epoch:  21%|██        | 21/100 [02:37<09:48,  7.45s/it]epoch:  22%|██▏       | 22/100 [02:45<09:43,  7.47s/it]epoch:  23%|██▎       | 23/100 [02:52<09:34,  7.46s/it]epoch:  24%|██▍       | 24/100 [03:00<09:26,  7.46s/it]epoch:  25%|██▌       | 25/100 [03:07<09:20,  7.48s/it]epoch:  26%|██▌       | 26/100 [03:15<09:16,  7.52s/it]epoch:  27%|██▋       | 27/100 [03:23<09:10,  7.54s/it]epoch:  28%|██▊       | 28/100 [03:30<09:04,  7.56s/it]epoch:  29%|██▉       | 29/100 [03:38<08:54,  7.53s/it]epoch:  30%|███       | 30/100 [03:45<08:46,  7.52s/it]0.05805565005947351
best ic: 0.05805565005947351
epoch:  31%|███       | 31/100 [03:54<09:02,  7.87s/it]0.05814135137774912
best ic: 0.05814135137774912
epoch:  32%|███▏      | 32/100 [04:02<09:11,  8.11s/it]0.056780731448500724
epoch:  33%|███▎      | 33/100 [04:11<09:15,  8.30s/it]0.05778568290070111
epoch:  34%|███▍      | 34/100 [04:20<09:14,  8.40s/it]0.05508028883572341
epoch:  35%|███▌      | 35/100 [04:28<09:05,  8.39s/it]0.05412923770903439
epoch:  36%|███▌      | 36/100 [04:37<09:02,  8.47s/it]0.057949598468878954
epoch:  37%|███▋      | 37/100 [04:45<08:55,  8.50s/it]0.05905585030571117
best ic: 0.05905585030571117
epoch:  38%|███▊      | 38/100 [04:54<08:47,  8.51s/it]0.05738606908976081
epoch:  39%|███▉      | 39/100 [05:02<08:38,  8.50s/it]0.053783574620623706
epoch:  40%|████      | 40/100 [05:11<08:31,  8.53s/it]0.05552796435059677
epoch:  41%|████      | 41/100 [05:20<08:27,  8.60s/it]0.05522617162487265
epoch:  42%|████▏     | 42/100 [05:29<08:21,  8.64s/it]0.053679870115858105
epoch:  43%|████▎     | 43/100 [05:37<08:11,  8.62s/it]0.05383978122012854
epoch:  44%|████▍     | 44/100 [05:46<08:02,  8.61s/it]0.053743226499671906
epoch:  45%|████▌     | 45/100 [05:54<07:54,  8.62s/it]0.05422194470499585
epoch:  45%|████▌     | 45/100 [06:03<07:24,  8.08s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2907598:MainThread](2024-04-24 21:22:02,643) INFO - qlib.workflow - [exp.py:258] - Experiment 37 starts running ...
[2907598:MainThread](2024-04-24 21:22:02,658) INFO - qlib.workflow - [recorder.py:341] - Recorder 8df9a97b238e42f4af1189929854cb9e starts running under Experiment 37 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:03, 16.48it/s]online:   6%|▋         | 4/63 [00:00<00:03, 16.38it/s]online:  10%|▉         | 6/63 [00:00<00:03, 16.54it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 16.79it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 16.61it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 16.43it/s]online:  22%|██▏       | 14/63 [00:00<00:02, 16.41it/s]online:  25%|██▌       | 16/63 [00:00<00:02, 16.40it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 16.29it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 16.32it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 16.42it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 16.62it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 16.29it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 16.24it/s]online:  48%|████▊     | 30/63 [00:01<00:02, 16.17it/s]online:  51%|█████     | 32/63 [00:01<00:01, 16.15it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 16.15it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 16.34it/s]online:  60%|██████    | 38/63 [00:02<00:01, 16.54it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 16.65it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 16.34it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 16.23it/s]online:  73%|███████▎  | 46/63 [00:02<00:01, 16.26it/s]online:  76%|███████▌  | 48/63 [00:02<00:00, 16.14it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 16.22it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 16.49it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 16.66it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 16.58it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 16.41it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 16.52it/s]online:  98%|█████████▊| 62/63 [00:03<00:00, 16.51it/s]online: 100%|██████████| 63/63 [00:03<00:00, 16.43it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2907598:MainThread](2024-04-24 21:22:13,210) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9963986 mae 0.7075843
{'IC': 0.02926831981190667,
 'ICIR': 0.23684439373579488,
 'Rank IC': 0.02668062819304763,
 'Rank ICIR': 0.21158468536298225}
[2907598:MainThread](2024-04-24 21:22:14,929) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2907598:MainThread](2024-04-24 21:22:27,023) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 21:22:27,026) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 21:22:33,086) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f613e7856d0>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:48,  8.91it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.13it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 34.76it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.97it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:20, 47.03it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.91it/s]backtest loop:   4%|▍         | 41/971 [00:01<00:17, 52.41it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.66it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.87it/s]backtest loop:   6%|▋         | 61/971 [00:01<00:16, 56.50it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.86it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 57.63it/s]backtest loop:   8%|▊         | 80/971 [00:01<00:15, 57.79it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 56.27it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 58.11it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 59.46it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.54it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 58.34it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.66it/s]backtest loop:  13%|█▎        | 127/971 [00:02<00:15, 53.66it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:14, 56.29it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 55.24it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 57.47it/s]backtest loop:  16%|█▌        | 154/971 [00:02<00:14, 58.11it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 56.52it/s]backtest loop:  17%|█▋        | 167/971 [00:03<00:14, 57.42it/s]backtest loop:  18%|█▊        | 174/971 [00:03<00:13, 59.16it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:13, 57.07it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 58.78it/s]backtest loop:  20%|█▉        | 194/971 [00:03<00:13, 58.94it/s]backtest loop:  21%|██        | 200/971 [00:03<00:13, 56.08it/s]backtest loop:  21%|██▏       | 207/971 [00:03<00:13, 57.89it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:13, 55.68it/s]backtest loop:  23%|██▎       | 220/971 [00:04<00:13, 54.72it/s]backtest loop:  23%|██▎       | 227/971 [00:04<00:13, 56.93it/s]backtest loop:  24%|██▍       | 234/971 [00:04<00:12, 58.93it/s]backtest loop:  25%|██▍       | 240/971 [00:04<00:13, 56.08it/s]backtest loop:  25%|██▌       | 247/971 [00:04<00:12, 58.35it/s]backtest loop:  26%|██▌       | 254/971 [00:04<00:12, 56.73it/s]backtest loop:  27%|██▋       | 261/971 [00:04<00:12, 58.52it/s]backtest loop:  27%|██▋       | 267/971 [00:04<00:12, 56.17it/s]backtest loop:  28%|██▊       | 274/971 [00:05<00:11, 58.27it/s]backtest loop:  29%|██▉       | 280/971 [00:05<00:11, 58.65it/s]backtest loop:  29%|██▉       | 286/971 [00:05<00:12, 55.95it/s]backtest loop:  30%|███       | 293/971 [00:05<00:11, 57.94it/s]backtest loop:  31%|███       | 300/971 [00:05<00:11, 56.06it/s]backtest loop:  32%|███▏      | 306/971 [00:05<00:11, 57.04it/s]backtest loop:  32%|███▏      | 313/971 [00:05<00:11, 59.12it/s]backtest loop:  33%|███▎      | 320/971 [00:05<00:11, 56.85it/s]backtest loop:  34%|███▎      | 327/971 [00:05<00:11, 58.51it/s]backtest loop:  34%|███▍      | 334/971 [00:06<00:10, 59.87it/s]backtest loop:  35%|███▌      | 341/971 [00:06<00:10, 57.55it/s]backtest loop:  36%|███▌      | 347/971 [00:06<00:10, 58.11it/s]backtest loop:  36%|███▋      | 354/971 [00:06<00:10, 59.56it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 56.82it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.41it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 53.67it/s]backtest loop:  39%|███▉      | 379/971 [00:06<00:10, 55.13it/s]backtest loop:  40%|███▉      | 386/971 [00:07<00:10, 57.34it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 55.90it/s]backtest loop:  41%|████      | 400/971 [00:07<00:09, 57.96it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 59.33it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:09, 56.36it/s]backtest loop:  43%|████▎     | 420/971 [00:07<00:15, 35.94it/s]backtest loop:  44%|████▍     | 427/971 [00:07<00:13, 41.32it/s]backtest loop:  45%|████▍     | 433/971 [00:08<00:12, 43.36it/s]backtest loop:  45%|████▌     | 440/971 [00:08<00:11, 47.98it/s]backtest loop:  46%|████▌     | 447/971 [00:08<00:10, 49.26it/s]backtest loop:  47%|████▋     | 454/971 [00:08<00:09, 52.78it/s]backtest loop:  47%|████▋     | 461/971 [00:08<00:09, 55.42it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:09, 53.79it/s]backtest loop:  49%|████▉     | 474/971 [00:08<00:08, 56.45it/s]backtest loop:  50%|████▉     | 481/971 [00:08<00:08, 58.24it/s]backtest loop:  50%|█████     | 487/971 [00:09<00:08, 55.32it/s]backtest loop:  51%|█████     | 494/971 [00:09<00:08, 57.54it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 54.82it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 54.34it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 56.55it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 58.35it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:07, 55.97it/s]backtest loop:  55%|█████▍    | 533/971 [00:09<00:07, 57.04it/s]backtest loop:  56%|█████▌    | 540/971 [00:09<00:07, 58.75it/s]backtest loop:  56%|█████▌    | 546/971 [00:10<00:07, 56.14it/s]backtest loop:  57%|█████▋    | 552/971 [00:10<00:07, 57.04it/s]backtest loop:  58%|█████▊    | 559/971 [00:10<00:07, 58.81it/s]backtest loop:  58%|█████▊    | 566/971 [00:10<00:07, 56.86it/s]backtest loop:  59%|█████▉    | 573/971 [00:10<00:06, 58.68it/s]backtest loop:  60%|█████▉    | 580/971 [00:10<00:06, 60.04it/s]backtest loop:  60%|██████    | 587/971 [00:10<00:06, 57.63it/s]backtest loop:  61%|██████    | 594/971 [00:10<00:06, 59.28it/s]backtest loop:  62%|██████▏   | 600/971 [00:10<00:06, 56.41it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 58.16it/s]backtest loop:  63%|██████▎   | 614/971 [00:11<00:05, 59.82it/s]backtest loop:  64%|██████▍   | 621/971 [00:11<00:06, 57.47it/s]backtest loop:  65%|██████▍   | 628/971 [00:11<00:05, 58.94it/s]backtest loop:  65%|██████▌   | 635/971 [00:11<00:05, 57.13it/s]backtest loop:  66%|██████▌   | 642/971 [00:11<00:05, 58.59it/s]backtest loop:  67%|██████▋   | 649/971 [00:11<00:05, 59.79it/s]backtest loop:  68%|██████▊   | 656/971 [00:11<00:05, 57.44it/s]backtest loop:  68%|██████▊   | 662/971 [00:12<00:05, 57.96it/s]backtest loop:  69%|██████▉   | 669/971 [00:12<00:05, 59.28it/s]backtest loop:  70%|██████▉   | 675/971 [00:12<00:05, 56.08it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:05, 56.85it/s]backtest loop:  71%|███████   | 687/971 [00:12<00:04, 57.65it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:04, 55.68it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 57.67it/s]backtest loop:  73%|███████▎  | 708/971 [00:12<00:04, 59.14it/s]backtest loop:  74%|███████▎  | 714/971 [00:12<00:04, 56.15it/s]backtest loop:  74%|███████▍  | 721/971 [00:13<00:04, 58.06it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 59.44it/s]backtest loop:  76%|███████▌  | 734/971 [00:13<00:04, 53.35it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 56.00it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.74it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:03, 54.07it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 56.46it/s]backtest loop:  79%|███████▉  | 769/971 [00:13<00:03, 58.30it/s]backtest loop:  80%|███████▉  | 775/971 [00:14<00:03, 55.71it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 57.83it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 55.56it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.69it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 58.98it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 56.19it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 58.09it/s]backtest loop:  85%|████████▍ | 821/971 [00:14<00:02, 58.32it/s]backtest loop:  85%|████████▌ | 828/971 [00:14<00:02, 56.63it/s]backtest loop:  86%|████████▌ | 835/971 [00:15<00:02, 58.42it/s]backtest loop:  87%|████████▋ | 842/971 [00:15<00:02, 59.74it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 56.78it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:01, 58.83it/s]backtest loop:  89%|████████▊ | 861/971 [00:15<00:01, 59.07it/s]backtest loop:  89%|████████▉ | 867/971 [00:15<00:01, 56.31it/s]backtest loop:  90%|█████████ | 874/971 [00:15<00:01, 58.22it/s]backtest loop:  91%|█████████ | 881/971 [00:15<00:01, 59.66it/s]backtest loop:  91%|█████████▏| 887/971 [00:15<00:01, 56.71it/s]backtest loop:  92%|█████████▏| 894/971 [00:16<00:01, 58.51it/s]backtest loop:  93%|█████████▎| 901/971 [00:16<00:01, 59.94it/s]backtest loop:  94%|█████████▎| 908/971 [00:16<00:01, 57.53it/s]backtest loop:  94%|█████████▍| 915/971 [00:16<00:00, 59.17it/s]backtest loop:  95%|█████████▍| 921/971 [00:16<00:00, 56.37it/s]backtest loop:  96%|█████████▌| 928/971 [00:16<00:00, 58.29it/s]backtest loop:  96%|█████████▋| 935/971 [00:16<00:00, 59.68it/s]backtest loop:  97%|█████████▋| 941/971 [00:16<00:00, 56.66it/s]backtest loop:  98%|█████████▊| 948/971 [00:17<00:00, 58.37it/s]backtest loop:  98%|█████████▊| 955/971 [00:17<00:00, 56.53it/s]backtest loop:  99%|█████████▉| 962/971 [00:17<00:00, 58.41it/s]backtest loop: 100%|█████████▉| 968/971 [00:17<00:00, 58.79it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.77it/s]
[2907598:MainThread](2024-04-24 21:22:50,574) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000519
std                0.005459
annualized_return  0.123617
information_ratio  1.467799
max_drawdown      -0.065994
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000322
std                0.005460
annualized_return  0.076620
information_ratio  0.909687
max_drawdown      -0.085508
[2907598:MainThread](2024-04-24 21:22:50,590) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_LSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_20:45:25_online`.
Round 6 Done!
{'1day.excess_return_with_cost.annualized_return': [0.05466509644132003,
                                                    0.03782940405138317,
                                                    0.07586443941440547,
                                                    0.1007235789374887,
                                                    0.08308022585420154,
                                                    0.07661986431541934],
 '1day.excess_return_with_cost.information_ratio': [0.7299136334968934,
                                                    0.5090576149926579,
                                                    0.973621450511456,
                                                    1.1741504408846737,
                                                    1.0526981011869454,
                                                    0.909687372692452],
 '1day.excess_return_with_cost.max_drawdown': [-0.10300273228156126,
                                               -0.07110045372162947,
                                               -0.10316664621820637,
                                               -0.12565292200159456,
                                               -0.0866624354594844,
                                               -0.08550822606800032],
 'IC': [0.027313668501984606,
        0.02579261406197789,
        0.03255547500325296,
        0.031253622229328794,
        0.028359953926004513,
        0.02926831981190667],
 'ICIR': [0.22308366803828927,
          0.2041430983365273,
          0.2649221294676209,
          0.2376593376010492,
          0.22114083430756656,
          0.23684439373579488],
 'Rank IC': [0.029403174427850773,
             0.026010289810945806,
             0.03008340103876209,
             0.03454798288534817,
             0.03048201533902068,
             0.02668062819304763],
 'Rank ICIR': [0.23996303432974886,
               0.2041684188204175,
               0.2484018289690483,
               0.2636972930450768,
               0.2367898341421186,
               0.21158468536298225],
 'mae': [0.707563579082489,
         0.707649827003479,
         0.7076614499092102,
         0.7073816657066345,
         0.7075479030609131,
         0.7075843214988708],
 'mse': [0.9965025782585144,
         0.9965060353279114,
         0.9961802363395691,
         0.9962019324302673,
         0.9962646961212158,
         0.9963986277580261]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2907598:MainThread](2024-04-24 21:22:51,785) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[2907598:MainThread](2024-04-24 21:22:51,785) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:07<12:34,  7.63s/it]epoch:   2%|▏         | 2/100 [00:15<12:21,  7.57s/it]epoch:   3%|▎         | 3/100 [00:22<12:10,  7.53s/it]epoch:   4%|▍         | 4/100 [00:30<12:12,  7.63s/it]epoch:   5%|▌         | 5/100 [00:37<11:59,  7.57s/it]epoch:   6%|▌         | 6/100 [00:45<11:51,  7.57s/it]epoch:   7%|▋         | 7/100 [00:53<11:43,  7.57s/it]epoch:   8%|▊         | 8/100 [01:00<11:28,  7.48s/it]epoch:   9%|▉         | 9/100 [01:07<11:22,  7.50s/it]epoch:  10%|█         | 10/100 [01:15<11:18,  7.54s/it]epoch:  11%|█         | 11/100 [01:23<11:10,  7.54s/it]epoch:  12%|█▏        | 12/100 [01:30<11:04,  7.55s/it]epoch:  13%|█▎        | 13/100 [01:38<11:02,  7.61s/it]epoch:  14%|█▍        | 14/100 [01:45<10:51,  7.57s/it]epoch:  15%|█▌        | 15/100 [01:53<10:41,  7.54s/it]epoch:  16%|█▌        | 16/100 [02:00<10:34,  7.56s/it]epoch:  17%|█▋        | 17/100 [02:08<10:26,  7.55s/it]epoch:  18%|█▊        | 18/100 [02:16<10:24,  7.62s/it]epoch:  19%|█▉        | 19/100 [02:23<10:15,  7.60s/it]epoch:  20%|██        | 20/100 [02:31<10:02,  7.53s/it]epoch:  21%|██        | 21/100 [02:38<09:55,  7.53s/it]epoch:  22%|██▏       | 22/100 [02:46<09:51,  7.59s/it]epoch:  23%|██▎       | 23/100 [02:54<09:46,  7.61s/it]epoch:  24%|██▍       | 24/100 [03:01<09:37,  7.60s/it]epoch:  25%|██▌       | 25/100 [03:09<09:28,  7.57s/it]epoch:  26%|██▌       | 26/100 [03:16<09:16,  7.52s/it]epoch:  27%|██▋       | 27/100 [03:24<09:08,  7.51s/it]epoch:  28%|██▊       | 28/100 [03:31<09:04,  7.56s/it]epoch:  29%|██▉       | 29/100 [03:39<09:00,  7.62s/it]epoch:  30%|███       | 30/100 [03:47<08:52,  7.61s/it]0.05184515678531179
best ic: 0.05184515678531179
epoch:  31%|███       | 31/100 [03:55<09:05,  7.91s/it]0.0521177529826369
best ic: 0.0521177529826369
epoch:  32%|███▏      | 32/100 [04:04<09:10,  8.10s/it]0.05340731974587067
best ic: 0.05340731974587067
epoch:  33%|███▎      | 33/100 [04:12<09:12,  8.24s/it]0.04882369772742087
epoch:  34%|███▍      | 34/100 [04:21<09:14,  8.40s/it]0.05143514216630286
epoch:  35%|███▌      | 35/100 [04:30<09:15,  8.55s/it]0.0489673101027492
epoch:  36%|███▌      | 36/100 [04:39<09:12,  8.64s/it]0.04789924072376392
epoch:  37%|███▋      | 37/100 [04:47<09:02,  8.61s/it]0.05303114186576954
epoch:  38%|███▊      | 38/100 [04:56<08:53,  8.61s/it]0.048255379553622316
epoch:  39%|███▉      | 39/100 [05:05<08:46,  8.63s/it]0.04759819152173577
epoch:  40%|████      | 40/100 [05:13<08:35,  8.58s/it]0.048025942135046226
epoch:  40%|████      | 40/100 [05:22<08:03,  8.06s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2907598:MainThread](2024-04-24 21:28:14,038) INFO - qlib.workflow - [exp.py:258] - Experiment 37 starts running ...
[2907598:MainThread](2024-04-24 21:28:14,053) INFO - qlib.workflow - [recorder.py:341] - Recorder 218460d6c3f143639d291af2405f8e3d starts running under Experiment 37 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:03, 16.00it/s]online:   6%|▋         | 4/63 [00:00<00:03, 16.17it/s]online:  10%|▉         | 6/63 [00:00<00:03, 16.00it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 15.99it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 16.10it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 16.02it/s]online:  22%|██▏       | 14/63 [00:00<00:03, 15.92it/s]online:  25%|██▌       | 16/63 [00:01<00:02, 15.92it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 15.81it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 15.84it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 15.91it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 15.88it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 15.80it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 16.13it/s]online:  48%|████▊     | 30/63 [00:01<00:02, 16.13it/s]online:  51%|█████     | 32/63 [00:02<00:01, 16.01it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 15.93it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 16.08it/s]online:  60%|██████    | 38/63 [00:02<00:01, 15.90it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 16.02it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 16.24it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 16.07it/s]online:  73%|███████▎  | 46/63 [00:02<00:01, 15.93it/s]online:  76%|███████▌  | 48/63 [00:03<00:00, 15.88it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 16.09it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 15.94it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 15.86it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 15.90it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 15.81it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 15.88it/s]online:  98%|█████████▊| 62/63 [00:03<00:00, 16.09it/s]online: 100%|██████████| 63/63 [00:03<00:00, 15.99it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2907598:MainThread](2024-04-24 21:28:24,602) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.996433 mae 0.7076896
{'IC': 0.028950484510480535,
 'ICIR': 0.22117865524855462,
 'Rank IC': 0.029248613099269714,
 'Rank ICIR': 0.22365030561168928}
[2907598:MainThread](2024-04-24 21:28:26,324) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2907598:MainThread](2024-04-24 21:28:38,586) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 21:28:38,590) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 21:28:44,727) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f6119331e50>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:46,  9.08it/s]backtest loop:   1%|          | 9/971 [00:00<00:39, 24.29it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 34.89it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.83it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:20, 46.88it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:20, 46.71it/s]backtest loop:   4%|▍         | 41/971 [00:01<00:18, 51.31it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 54.54it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.12it/s]backtest loop:   6%|▌         | 60/971 [00:01<00:16, 54.85it/s]backtest loop:   7%|▋         | 66/971 [00:01<00:16, 55.71it/s]backtest loop:   7%|▋         | 72/971 [00:01<00:16, 54.01it/s]backtest loop:   8%|▊         | 78/971 [00:01<00:16, 55.50it/s]backtest loop:   9%|▉         | 85/971 [00:01<00:15, 56.95it/s]backtest loop:   9%|▉         | 92/971 [00:01<00:15, 55.59it/s]backtest loop:  10%|█         | 99/971 [00:02<00:15, 57.52it/s]backtest loop:  11%|█         | 106/971 [00:02<00:14, 59.26it/s]backtest loop:  12%|█▏        | 112/971 [00:02<00:15, 56.35it/s]backtest loop:  12%|█▏        | 118/971 [00:02<00:14, 57.26it/s]backtest loop:  13%|█▎        | 125/971 [00:02<00:15, 55.68it/s]backtest loop:  13%|█▎        | 131/971 [00:02<00:15, 53.90it/s]backtest loop:  14%|█▍        | 138/971 [00:02<00:14, 56.41it/s]backtest loop:  15%|█▍        | 144/971 [00:02<00:14, 57.11it/s]backtest loop:  16%|█▌        | 151/971 [00:02<00:14, 55.58it/s]backtest loop:  16%|█▋        | 158/971 [00:03<00:14, 57.48it/s]backtest loop:  17%|█▋        | 165/971 [00:03<00:13, 59.00it/s]backtest loop:  18%|█▊        | 171/971 [00:03<00:14, 55.83it/s]backtest loop:  18%|█▊        | 178/971 [00:03<00:13, 57.73it/s]backtest loop:  19%|█▉        | 185/971 [00:03<00:13, 56.29it/s]backtest loop:  20%|█▉        | 191/971 [00:03<00:13, 57.12it/s]backtest loop:  20%|██        | 198/971 [00:03<00:13, 58.98it/s]backtest loop:  21%|██        | 205/971 [00:03<00:13, 56.90it/s]backtest loop:  22%|██▏       | 212/971 [00:04<00:12, 59.05it/s]backtest loop:  22%|██▏       | 218/971 [00:04<00:13, 55.93it/s]backtest loop:  23%|██▎       | 224/971 [00:04<00:13, 56.92it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 54.06it/s]backtest loop:  24%|██▍       | 236/971 [00:04<00:13, 54.85it/s]backtest loop:  25%|██▌       | 243/971 [00:04<00:12, 57.33it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:13, 55.02it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:12, 57.35it/s]backtest loop:  27%|██▋       | 263/971 [00:04<00:12, 58.87it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:12, 55.73it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:12, 54.60it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:12, 56.85it/s]backtest loop:  30%|██▉       | 289/971 [00:05<00:11, 57.66it/s]backtest loop:  30%|███       | 295/971 [00:05<00:12, 55.38it/s]backtest loop:  31%|███       | 302/971 [00:05<00:11, 57.46it/s]backtest loop:  32%|███▏      | 309/971 [00:05<00:11, 59.16it/s]backtest loop:  32%|███▏      | 315/971 [00:05<00:11, 55.97it/s]backtest loop:  33%|███▎      | 321/971 [00:05<00:11, 56.99it/s]backtest loop:  34%|███▍      | 328/971 [00:06<00:10, 58.59it/s]backtest loop:  34%|███▍      | 334/971 [00:06<00:10, 58.90it/s]backtest loop:  35%|███▌      | 340/971 [00:06<00:11, 55.95it/s]backtest loop:  36%|███▌      | 346/971 [00:06<00:11, 56.68it/s]backtest loop:  36%|███▋      | 353/971 [00:06<00:10, 58.68it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 56.54it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.09it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 52.50it/s]backtest loop:  39%|███▉      | 379/971 [00:06<00:10, 54.18it/s]backtest loop:  40%|███▉      | 385/971 [00:07<00:10, 55.62it/s]backtest loop:  40%|████      | 392/971 [00:07<00:10, 57.78it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 55.16it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 57.38it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:09, 59.06it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:09, 56.22it/s]backtest loop:  44%|████▎     | 424/971 [00:08<00:15, 34.31it/s]backtest loop:  44%|████▍     | 431/971 [00:08<00:13, 40.12it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:12, 42.45it/s]backtest loop:  46%|████▌     | 444/971 [00:08<00:11, 47.25it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:10, 51.26it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:10, 50.83it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:09, 53.93it/s]backtest loop:  48%|████▊     | 470/971 [00:08<00:09, 55.23it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:09, 54.23it/s]backtest loop:  50%|████▉     | 483/971 [00:09<00:08, 55.70it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:08, 54.64it/s]backtest loop:  51%|█████     | 496/971 [00:09<00:08, 56.00it/s]backtest loop:  52%|█████▏    | 502/971 [00:09<00:08, 56.86it/s]backtest loop:  52%|█████▏    | 508/971 [00:09<00:08, 54.81it/s]backtest loop:  53%|█████▎    | 515/971 [00:09<00:07, 57.18it/s]backtest loop:  54%|█████▍    | 522/971 [00:09<00:08, 55.51it/s]backtest loop:  54%|█████▍    | 528/971 [00:09<00:07, 56.33it/s]backtest loop:  55%|█████▌    | 535/971 [00:09<00:07, 58.24it/s]backtest loop:  56%|█████▌    | 541/971 [00:10<00:07, 55.56it/s]backtest loop:  56%|█████▋    | 548/971 [00:10<00:07, 57.64it/s]backtest loop:  57%|█████▋    | 555/971 [00:10<00:07, 59.02it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 56.06it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:06, 58.02it/s]backtest loop:  59%|█████▉    | 575/971 [00:10<00:06, 59.37it/s]backtest loop:  60%|█████▉    | 581/971 [00:10<00:06, 56.60it/s]backtest loop:  60%|██████    | 587/971 [00:10<00:06, 57.32it/s]backtest loop:  61%|██████    | 594/971 [00:10<00:06, 58.87it/s]backtest loop:  62%|██████▏   | 600/971 [00:11<00:06, 56.01it/s]backtest loop:  63%|██████▎   | 607/971 [00:11<00:06, 57.83it/s]backtest loop:  63%|██████▎   | 614/971 [00:11<00:05, 59.50it/s]backtest loop:  64%|██████▍   | 620/971 [00:11<00:06, 56.28it/s]backtest loop:  65%|██████▍   | 627/971 [00:11<00:05, 58.16it/s]backtest loop:  65%|██████▌   | 634/971 [00:11<00:05, 59.60it/s]backtest loop:  66%|██████▌   | 640/971 [00:11<00:05, 56.68it/s]backtest loop:  67%|██████▋   | 647/971 [00:11<00:05, 58.46it/s]backtest loop:  67%|██████▋   | 654/971 [00:12<00:05, 59.74it/s]backtest loop:  68%|██████▊   | 660/971 [00:12<00:05, 56.63it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 58.40it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:05, 56.44it/s]backtest loop:  70%|███████   | 680/971 [00:12<00:05, 57.24it/s]backtest loop:  71%|███████   | 686/971 [00:12<00:04, 57.63it/s]backtest loop:  71%|███████▏  | 693/971 [00:12<00:04, 59.17it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 55.77it/s]backtest loop:  73%|███████▎  | 705/971 [00:12<00:04, 56.47it/s]backtest loop:  73%|███████▎  | 711/971 [00:13<00:04, 56.93it/s]backtest loop:  74%|███████▍  | 717/971 [00:13<00:04, 57.70it/s]backtest loop:  74%|███████▍  | 723/971 [00:13<00:04, 58.19it/s]backtest loop:  75%|███████▌  | 729/971 [00:13<00:04, 55.51it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 53.77it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 55.26it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.22it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:04, 53.62it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 56.24it/s]backtest loop:  79%|███████▉  | 769/971 [00:14<00:03, 58.16it/s]backtest loop:  80%|███████▉  | 775/971 [00:14<00:03, 55.54it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 57.74it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 55.64it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.61it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 59.13it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 56.25it/s]backtest loop:  84%|████████▍ | 815/971 [00:14<00:02, 57.84it/s]backtest loop:  85%|████████▍ | 822/971 [00:14<00:02, 59.25it/s]backtest loop:  85%|████████▌ | 828/971 [00:15<00:02, 56.27it/s]backtest loop:  86%|████████▌ | 835/971 [00:15<00:02, 57.83it/s]backtest loop:  87%|████████▋ | 842/971 [00:15<00:02, 59.19it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 56.43it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:01, 58.04it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 56.18it/s]backtest loop:  89%|████████▉ | 869/971 [00:15<00:01, 58.15it/s]backtest loop:  90%|█████████ | 875/971 [00:15<00:01, 58.31it/s]backtest loop:  91%|█████████ | 881/971 [00:15<00:01, 58.52it/s]backtest loop:  91%|█████████▏| 887/971 [00:16<00:01, 53.96it/s]backtest loop:  92%|█████████▏| 893/971 [00:16<00:01, 55.50it/s]backtest loop:  93%|█████████▎| 900/971 [00:16<00:01, 57.52it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 55.74it/s]backtest loop:  94%|█████████▍| 914/971 [00:16<00:00, 57.63it/s]backtest loop:  95%|█████████▍| 921/971 [00:16<00:00, 55.87it/s]backtest loop:  96%|█████████▌| 928/971 [00:16<00:00, 57.66it/s]backtest loop:  96%|█████████▋| 935/971 [00:16<00:00, 59.11it/s]backtest loop:  97%|█████████▋| 941/971 [00:17<00:00, 56.26it/s]backtest loop:  98%|█████████▊| 948/971 [00:17<00:00, 58.21it/s]backtest loop:  98%|█████████▊| 955/971 [00:17<00:00, 56.34it/s]backtest loop:  99%|█████████▉| 962/971 [00:17<00:00, 58.32it/s]backtest loop: 100%|█████████▉| 969/971 [00:17<00:00, 59.57it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.26it/s]
[2907598:MainThread](2024-04-24 21:29:02,376) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000467
std                0.005402
annualized_return  0.111204
information_ratio  1.334428
max_drawdown      -0.055972
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000269
std                0.005403
annualized_return  0.064023
information_ratio  0.768105
max_drawdown      -0.090813
[2907598:MainThread](2024-04-24 21:29:02,393) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_LSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_20:45:25_online`.
Round 7 Done!
{'1day.excess_return_with_cost.annualized_return': [0.05466509644132003,
                                                    0.03782940405138317,
                                                    0.07586443941440547,
                                                    0.1007235789374887,
                                                    0.08308022585420154,
                                                    0.07661986431541934,
                                                    0.06402319866569046],
 '1day.excess_return_with_cost.information_ratio': [0.7299136334968934,
                                                    0.5090576149926579,
                                                    0.973621450511456,
                                                    1.1741504408846737,
                                                    1.0526981011869454,
                                                    0.909687372692452,
                                                    0.7681047075993076],
 '1day.excess_return_with_cost.max_drawdown': [-0.10300273228156126,
                                               -0.07110045372162947,
                                               -0.10316664621820637,
                                               -0.12565292200159456,
                                               -0.0866624354594844,
                                               -0.08550822606800032,
                                               -0.09081294564731399],
 'IC': [0.027313668501984606,
        0.02579261406197789,
        0.03255547500325296,
        0.031253622229328794,
        0.028359953926004513,
        0.02926831981190667,
        0.028950484510480535],
 'ICIR': [0.22308366803828927,
          0.2041430983365273,
          0.2649221294676209,
          0.2376593376010492,
          0.22114083430756656,
          0.23684439373579488,
          0.22117865524855462],
 'Rank IC': [0.029403174427850773,
             0.026010289810945806,
             0.03008340103876209,
             0.03454798288534817,
             0.03048201533902068,
             0.02668062819304763,
             0.029248613099269714],
 'Rank ICIR': [0.23996303432974886,
               0.2041684188204175,
               0.2484018289690483,
               0.2636972930450768,
               0.2367898341421186,
               0.21158468536298225,
               0.22365030561168928],
 'mae': [0.707563579082489,
         0.707649827003479,
         0.7076614499092102,
         0.7073816657066345,
         0.7075479030609131,
         0.7075843214988708,
         0.7076895833015442],
 'mse': [0.9965025782585144,
         0.9965060353279114,
         0.9961802363395691,
         0.9962019324302673,
         0.9962646961212158,
         0.9963986277580261,
         0.9964330196380615]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2907598:MainThread](2024-04-24 21:29:03,597) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[2907598:MainThread](2024-04-24 21:29:03,597) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:07<12:53,  7.81s/it]epoch:   2%|▏         | 2/100 [00:15<12:23,  7.58s/it]epoch:   3%|▎         | 3/100 [00:22<12:15,  7.58s/it]epoch:   4%|▍         | 4/100 [00:30<12:03,  7.53s/it]epoch:   5%|▌         | 5/100 [00:38<12:05,  7.64s/it]epoch:   6%|▌         | 6/100 [00:45<11:54,  7.61s/it]epoch:   7%|▋         | 7/100 [00:53<11:48,  7.61s/it]epoch:   8%|▊         | 8/100 [01:00<11:41,  7.63s/it]epoch:   9%|▉         | 9/100 [01:08<11:28,  7.57s/it]epoch:  10%|█         | 10/100 [01:16<11:23,  7.59s/it]epoch:  11%|█         | 11/100 [01:23<11:19,  7.63s/it]epoch:  12%|█▏        | 12/100 [01:31<11:07,  7.58s/it]epoch:  13%|█▎        | 13/100 [01:38<10:51,  7.49s/it]epoch:  14%|█▍        | 14/100 [01:46<10:47,  7.53s/it]epoch:  15%|█▌        | 15/100 [01:53<10:42,  7.56s/it]epoch:  16%|█▌        | 16/100 [02:01<10:35,  7.56s/it]epoch:  17%|█▋        | 17/100 [02:08<10:26,  7.55s/it]epoch:  18%|█▊        | 18/100 [02:16<10:18,  7.54s/it]epoch:  19%|█▉        | 19/100 [02:24<10:15,  7.60s/it]epoch:  20%|██        | 20/100 [02:31<10:06,  7.58s/it]epoch:  21%|██        | 21/100 [02:38<09:53,  7.51s/it]epoch:  22%|██▏       | 22/100 [02:46<09:39,  7.43s/it]epoch:  23%|██▎       | 23/100 [02:53<09:29,  7.40s/it]epoch:  24%|██▍       | 24/100 [03:01<09:24,  7.43s/it]epoch:  25%|██▌       | 25/100 [03:08<09:21,  7.48s/it]epoch:  26%|██▌       | 26/100 [03:16<09:14,  7.49s/it]epoch:  27%|██▋       | 27/100 [03:23<09:07,  7.49s/it]epoch:  28%|██▊       | 28/100 [03:31<09:00,  7.51s/it]epoch:  29%|██▉       | 29/100 [03:38<08:52,  7.50s/it]epoch:  30%|███       | 30/100 [03:46<08:44,  7.50s/it]0.05865060418082564
best ic: 0.05865060418082564
epoch:  31%|███       | 31/100 [03:54<09:01,  7.85s/it]0.060054188705638355
best ic: 0.060054188705638355
epoch:  32%|███▏      | 32/100 [04:03<09:06,  8.04s/it]0.05835888521973082
epoch:  33%|███▎      | 33/100 [04:11<09:10,  8.21s/it]0.05739553429191509
epoch:  34%|███▍      | 34/100 [04:20<09:10,  8.34s/it]0.05778837193040323
epoch:  35%|███▌      | 35/100 [04:29<09:07,  8.43s/it]0.053065965236602265
epoch:  36%|███▌      | 36/100 [04:37<09:04,  8.50s/it]0.05568598207658357
epoch:  37%|███▋      | 37/100 [04:46<08:58,  8.54s/it]0.05650127975529415
epoch:  38%|███▊      | 38/100 [04:55<08:52,  8.59s/it]0.054732337982974395
epoch:  39%|███▉      | 39/100 [05:03<08:42,  8.57s/it]0.05605240454294479
epoch:  39%|███▉      | 39/100 [05:12<08:08,  8.01s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2907598:MainThread](2024-04-24 21:34:16,015) INFO - qlib.workflow - [exp.py:258] - Experiment 37 starts running ...
[2907598:MainThread](2024-04-24 21:34:16,030) INFO - qlib.workflow - [recorder.py:341] - Recorder fd239fc201ae4297a39f018efa1e0eb9 starts running under Experiment 37 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:03, 15.87it/s]online:   6%|▋         | 4/63 [00:00<00:03, 15.40it/s]online:  10%|▉         | 6/63 [00:00<00:03, 15.86it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 16.20it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 16.34it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 16.44it/s]online:  22%|██▏       | 14/63 [00:00<00:02, 16.57it/s]online:  25%|██▌       | 16/63 [00:00<00:02, 16.60it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 16.56it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 16.79it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 16.77it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 16.72it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 16.83it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 16.89it/s]online:  48%|████▊     | 30/63 [00:01<00:01, 17.03it/s]online:  51%|█████     | 32/63 [00:01<00:01, 16.97it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 16.87it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 16.90it/s]online:  60%|██████    | 38/63 [00:02<00:01, 16.80it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 16.90it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 16.98it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 16.92it/s]online:  73%|███████▎  | 46/63 [00:02<00:01, 16.52it/s]online:  76%|███████▌  | 48/63 [00:02<00:00, 16.52it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 16.35it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 16.13it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 16.07it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 16.16it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 15.99it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 15.99it/s]online:  98%|█████████▊| 62/63 [00:03<00:00, 16.03it/s]online: 100%|██████████| 63/63 [00:03<00:00, 16.51it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2907598:MainThread](2024-04-24 21:34:26,391) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9964442 mae 0.7076772
{'IC': 0.028599683954604254,
 'ICIR': 0.22627021866475863,
 'Rank IC': 0.02618758280560536,
 'Rank ICIR': 0.20713449064856865}
[2907598:MainThread](2024-04-24 21:34:28,143) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2907598:MainThread](2024-04-24 21:34:40,607) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 21:34:40,611) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 21:34:46,709) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f613c054a60>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:48,  8.92it/s]backtest loop:   1%|          | 9/971 [00:00<00:40, 24.00it/s]backtest loop:   2%|▏         | 15/971 [00:00<00:27, 34.57it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 39.64it/s]backtest loop:   3%|▎         | 27/971 [00:00<00:20, 45.32it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 47.81it/s]backtest loop:   4%|▍         | 40/971 [00:00<00:18, 51.03it/s]backtest loop:   5%|▍         | 47/971 [00:01<00:16, 54.67it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 53.88it/s]backtest loop:   6%|▌         | 60/971 [00:01<00:16, 55.45it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 55.17it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 57.94it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:14, 59.40it/s]backtest loop:   9%|▉         | 88/971 [00:01<00:15, 57.50it/s]backtest loop:  10%|▉         | 95/971 [00:01<00:14, 59.23it/s]backtest loop:  11%|█         | 102/971 [00:02<00:15, 56.99it/s]backtest loop:  11%|█         | 109/971 [00:02<00:14, 58.49it/s]backtest loop:  12%|█▏        | 116/971 [00:02<00:14, 59.08it/s]backtest loop:  13%|█▎        | 122/971 [00:02<00:15, 56.21it/s]backtest loop:  13%|█▎        | 128/971 [00:02<00:15, 54.41it/s]backtest loop:  14%|█▍        | 134/971 [00:02<00:15, 55.76it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 54.72it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 56.97it/s]backtest loop:  16%|█▌        | 155/971 [00:02<00:13, 58.73it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 55.66it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:13, 57.39it/s]backtest loop:  18%|█▊        | 174/971 [00:03<00:14, 56.53it/s]backtest loop:  19%|█▊        | 180/971 [00:03<00:13, 56.53it/s]backtest loop:  19%|█▉        | 186/971 [00:03<00:14, 54.49it/s]backtest loop:  20%|█▉        | 193/971 [00:03<00:13, 56.86it/s]backtest loop:  21%|██        | 200/971 [00:03<00:13, 55.39it/s]backtest loop:  21%|██▏       | 207/971 [00:03<00:13, 57.32it/s]backtest loop:  22%|██▏       | 213/971 [00:04<00:13, 55.10it/s]backtest loop:  23%|██▎       | 219/971 [00:04<00:13, 56.32it/s]backtest loop:  23%|██▎       | 225/971 [00:04<00:13, 54.09it/s]backtest loop:  24%|██▍       | 231/971 [00:04<00:13, 54.87it/s]backtest loop:  25%|██▍       | 238/971 [00:04<00:12, 57.14it/s]backtest loop:  25%|██▌       | 245/971 [00:04<00:13, 55.37it/s]backtest loop:  26%|██▌       | 251/971 [00:04<00:12, 56.42it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 57.22it/s]backtest loop:  27%|██▋       | 263/971 [00:04<00:12, 57.87it/s]backtest loop:  28%|██▊       | 269/971 [00:05<00:12, 55.62it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:12, 54.60it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:12, 56.95it/s]backtest loop:  30%|██▉       | 290/971 [00:05<00:11, 58.66it/s]backtest loop:  30%|███       | 296/971 [00:05<00:12, 56.00it/s]backtest loop:  31%|███       | 303/971 [00:05<00:11, 58.05it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:11, 56.11it/s]backtest loop:  33%|███▎      | 317/971 [00:05<00:11, 57.84it/s]backtest loop:  33%|███▎      | 324/971 [00:05<00:10, 59.71it/s]backtest loop:  34%|███▍      | 331/971 [00:06<00:11, 57.34it/s]backtest loop:  35%|███▍      | 338/971 [00:06<00:10, 58.92it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:10, 56.93it/s]backtest loop:  36%|███▌      | 351/971 [00:06<00:10, 57.61it/s]backtest loop:  37%|███▋      | 358/971 [00:06<00:10, 59.12it/s]backtest loop:  37%|███▋      | 364/971 [00:06<00:10, 56.05it/s]backtest loop:  38%|███▊      | 370/971 [00:06<00:11, 54.21it/s]backtest loop:  39%|███▉      | 377/971 [00:06<00:10, 56.70it/s]backtest loop:  39%|███▉      | 383/971 [00:07<00:10, 54.35it/s]backtest loop:  40%|████      | 390/971 [00:07<00:10, 56.93it/s]backtest loop:  41%|████      | 397/971 [00:07<00:09, 58.84it/s]backtest loop:  42%|████▏     | 403/971 [00:07<00:10, 55.97it/s]backtest loop:  42%|████▏     | 410/971 [00:07<00:09, 57.98it/s]backtest loop:  43%|████▎     | 416/971 [00:07<00:09, 58.23it/s]backtest loop:  43%|████▎     | 422/971 [00:07<00:15, 35.75it/s]backtest loop:  44%|████▍     | 428/971 [00:08<00:13, 38.95it/s]backtest loop:  45%|████▍     | 435/971 [00:08<00:12, 44.38it/s]backtest loop:  46%|████▌     | 442/971 [00:08<00:11, 46.59it/s]backtest loop:  46%|████▌     | 449/971 [00:08<00:10, 50.59it/s]backtest loop:  47%|████▋     | 455/971 [00:08<00:09, 52.77it/s]backtest loop:  47%|████▋     | 461/971 [00:08<00:09, 54.49it/s]backtest loop:  48%|████▊     | 467/971 [00:08<00:09, 52.98it/s]backtest loop:  49%|████▉     | 474/971 [00:08<00:08, 55.76it/s]backtest loop:  49%|████▉     | 480/971 [00:08<00:08, 56.89it/s]backtest loop:  50%|█████     | 487/971 [00:09<00:08, 55.26it/s]backtest loop:  51%|█████     | 494/971 [00:09<00:08, 57.54it/s]backtest loop:  51%|█████▏    | 500/971 [00:09<00:08, 54.99it/s]backtest loop:  52%|█████▏    | 507/971 [00:09<00:08, 54.17it/s]backtest loop:  53%|█████▎    | 514/971 [00:09<00:08, 56.41it/s]backtest loop:  54%|█████▎    | 521/971 [00:09<00:07, 58.32it/s]backtest loop:  54%|█████▍    | 527/971 [00:09<00:07, 55.92it/s]backtest loop:  55%|█████▍    | 534/971 [00:09<00:07, 57.85it/s]backtest loop:  56%|█████▌    | 541/971 [00:10<00:07, 56.20it/s]backtest loop:  56%|█████▋    | 548/971 [00:10<00:07, 58.10it/s]backtest loop:  57%|█████▋    | 554/971 [00:10<00:07, 58.57it/s]backtest loop:  58%|█████▊    | 561/971 [00:10<00:07, 56.42it/s]backtest loop:  58%|█████▊    | 568/971 [00:10<00:06, 58.15it/s]backtest loop:  59%|█████▉    | 575/971 [00:10<00:06, 59.68it/s]backtest loop:  60%|█████▉    | 582/971 [00:10<00:06, 57.41it/s]backtest loop:  61%|██████    | 588/971 [00:10<00:06, 58.03it/s]backtest loop:  61%|██████▏   | 595/971 [00:10<00:06, 59.21it/s]backtest loop:  62%|██████▏   | 601/971 [00:11<00:06, 56.26it/s]backtest loop:  63%|██████▎   | 608/971 [00:11<00:06, 57.92it/s]backtest loop:  63%|██████▎   | 615/971 [00:11<00:06, 56.39it/s]backtest loop:  64%|██████▍   | 621/971 [00:11<00:06, 57.14it/s]backtest loop:  65%|██████▍   | 628/971 [00:11<00:05, 59.01it/s]backtest loop:  65%|██████▌   | 635/971 [00:11<00:05, 57.05it/s]backtest loop:  66%|██████▌   | 641/971 [00:11<00:05, 57.43it/s]backtest loop:  67%|██████▋   | 648/971 [00:11<00:05, 59.07it/s]backtest loop:  67%|██████▋   | 655/971 [00:11<00:05, 56.96it/s]backtest loop:  68%|██████▊   | 661/971 [00:12<00:05, 57.54it/s]backtest loop:  69%|██████▉   | 668/971 [00:12<00:05, 59.13it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:05, 56.21it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:04, 58.18it/s]backtest loop:  71%|███████   | 687/971 [00:12<00:04, 58.42it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:04, 56.46it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 58.44it/s]backtest loop:  73%|███████▎  | 708/971 [00:12<00:04, 59.72it/s]backtest loop:  74%|███████▎  | 714/971 [00:13<00:04, 56.46it/s]backtest loop:  74%|███████▍  | 721/971 [00:13<00:04, 58.34it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 59.77it/s]backtest loop:  76%|███████▌  | 735/971 [00:13<00:04, 54.55it/s]backtest loop:  76%|███████▋  | 742/971 [00:13<00:04, 56.89it/s]backtest loop:  77%|███████▋  | 748/971 [00:13<00:04, 54.66it/s]backtest loop:  78%|███████▊  | 755/971 [00:13<00:03, 54.09it/s]backtest loop:  78%|███████▊  | 762/971 [00:13<00:03, 56.36it/s]backtest loop:  79%|███████▉  | 769/971 [00:13<00:03, 58.13it/s]backtest loop:  80%|███████▉  | 775/971 [00:14<00:03, 55.83it/s]backtest loop:  81%|████████  | 782/971 [00:14<00:03, 58.07it/s]backtest loop:  81%|████████  | 788/971 [00:14<00:03, 55.39it/s]backtest loop:  82%|████████▏ | 795/971 [00:14<00:03, 57.56it/s]backtest loop:  83%|████████▎ | 802/971 [00:14<00:02, 59.18it/s]backtest loop:  83%|████████▎ | 808/971 [00:14<00:02, 56.35it/s]backtest loop:  84%|████████▍ | 814/971 [00:14<00:02, 56.83it/s]backtest loop:  85%|████████▍ | 821/971 [00:14<00:02, 58.46it/s]backtest loop:  85%|████████▌ | 828/971 [00:15<00:02, 56.55it/s]backtest loop:  86%|████████▌ | 835/971 [00:15<00:02, 58.15it/s]backtest loop:  87%|████████▋ | 842/971 [00:15<00:02, 59.52it/s]backtest loop:  87%|████████▋ | 848/971 [00:15<00:02, 56.58it/s]backtest loop:  88%|████████▊ | 855/971 [00:15<00:01, 58.15it/s]backtest loop:  89%|████████▉ | 862/971 [00:15<00:01, 56.24it/s]backtest loop:  89%|████████▉ | 868/971 [00:15<00:01, 57.18it/s]backtest loop:  90%|█████████ | 874/971 [00:15<00:01, 57.94it/s]backtest loop:  91%|█████████ | 880/971 [00:15<00:01, 58.43it/s]backtest loop:  91%|█████████ | 886/971 [00:16<00:01, 58.26it/s]backtest loop:  92%|█████████▏| 892/971 [00:16<00:01, 55.52it/s]backtest loop:  93%|█████████▎| 899/971 [00:16<00:01, 57.60it/s]backtest loop:  93%|█████████▎| 906/971 [00:16<00:01, 59.26it/s]backtest loop:  94%|█████████▍| 912/971 [00:16<00:01, 56.36it/s]backtest loop:  95%|█████████▍| 918/971 [00:16<00:00, 57.13it/s]backtest loop:  95%|█████████▌| 925/971 [00:16<00:00, 58.77it/s]backtest loop:  96%|█████████▌| 931/971 [00:16<00:00, 55.94it/s]backtest loop:  97%|█████████▋| 938/971 [00:16<00:00, 57.79it/s]backtest loop:  97%|█████████▋| 945/971 [00:17<00:00, 56.06it/s]backtest loop:  98%|█████████▊| 952/971 [00:17<00:00, 58.70it/s]backtest loop:  99%|█████████▉| 959/971 [00:17<00:00, 59.97it/s]backtest loop:  99%|█████████▉| 966/971 [00:17<00:00, 57.43it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.49it/s]
[2907598:MainThread](2024-04-24 21:35:04,283) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000404
std                0.005236
annualized_return  0.096112
information_ratio  1.189737
max_drawdown      -0.125192
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000207
std                0.005237
annualized_return  0.049232
information_ratio  0.609331
max_drawdown      -0.157452
[2907598:MainThread](2024-04-24 21:35:04,299) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_LSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_20:45:25_online`.
Round 8 Done!
{'1day.excess_return_with_cost.annualized_return': [0.05466509644132003,
                                                    0.03782940405138317,
                                                    0.07586443941440547,
                                                    0.1007235789374887,
                                                    0.08308022585420154,
                                                    0.07661986431541934,
                                                    0.06402319866569046,
                                                    0.04923227892553839],
 '1day.excess_return_with_cost.information_ratio': [0.7299136334968934,
                                                    0.5090576149926579,
                                                    0.973621450511456,
                                                    1.1741504408846737,
                                                    1.0526981011869454,
                                                    0.909687372692452,
                                                    0.7681047075993076,
                                                    0.6093312247202153],
 '1day.excess_return_with_cost.max_drawdown': [-0.10300273228156126,
                                               -0.07110045372162947,
                                               -0.10316664621820637,
                                               -0.12565292200159456,
                                               -0.0866624354594844,
                                               -0.08550822606800032,
                                               -0.09081294564731399,
                                               -0.1574520353107441],
 'IC': [0.027313668501984606,
        0.02579261406197789,
        0.03255547500325296,
        0.031253622229328794,
        0.028359953926004513,
        0.02926831981190667,
        0.028950484510480535,
        0.028599683954604254],
 'ICIR': [0.22308366803828927,
          0.2041430983365273,
          0.2649221294676209,
          0.2376593376010492,
          0.22114083430756656,
          0.23684439373579488,
          0.22117865524855462,
          0.22627021866475863],
 'Rank IC': [0.029403174427850773,
             0.026010289810945806,
             0.03008340103876209,
             0.03454798288534817,
             0.03048201533902068,
             0.02668062819304763,
             0.029248613099269714,
             0.02618758280560536],
 'Rank ICIR': [0.23996303432974886,
               0.2041684188204175,
               0.2484018289690483,
               0.2636972930450768,
               0.2367898341421186,
               0.21158468536298225,
               0.22365030561168928,
               0.20713449064856865],
 'mae': [0.707563579082489,
         0.707649827003479,
         0.7076614499092102,
         0.7073816657066345,
         0.7075479030609131,
         0.7075843214988708,
         0.7076895833015442,
         0.7076771855354309],
 'mse': [0.9965025782585144,
         0.9965060353279114,
         0.9961802363395691,
         0.9962019324302673,
         0.9962646961212158,
         0.9963986277580261,
         0.9964330196380615,
         0.9964442253112793]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2907598:MainThread](2024-04-24 21:35:05,511) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[2907598:MainThread](2024-04-24 21:35:05,511) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:07<12:53,  7.82s/it]epoch:   2%|▏         | 2/100 [00:15<12:33,  7.69s/it]epoch:   3%|▎         | 3/100 [00:23<12:26,  7.70s/it]epoch:   4%|▍         | 4/100 [00:30<12:08,  7.59s/it]epoch:   5%|▌         | 5/100 [00:38<12:07,  7.65s/it]epoch:   6%|▌         | 6/100 [00:45<11:55,  7.61s/it]epoch:   7%|▋         | 7/100 [00:53<11:39,  7.52s/it]epoch:   8%|▊         | 8/100 [01:00<11:39,  7.60s/it]epoch:   9%|▉         | 9/100 [01:08<11:31,  7.59s/it]epoch:  10%|█         | 10/100 [01:15<11:17,  7.53s/it]epoch:  11%|█         | 11/100 [01:23<11:08,  7.51s/it]epoch:  12%|█▏        | 12/100 [01:30<11:02,  7.53s/it]epoch:  13%|█▎        | 13/100 [01:38<10:49,  7.47s/it]epoch:  14%|█▍        | 14/100 [01:45<10:40,  7.45s/it]epoch:  15%|█▌        | 15/100 [01:53<10:37,  7.49s/it]epoch:  16%|█▌        | 16/100 [02:00<10:31,  7.51s/it]epoch:  17%|█▋        | 17/100 [02:08<10:21,  7.48s/it]epoch:  18%|█▊        | 18/100 [02:15<10:11,  7.46s/it]epoch:  19%|█▉        | 19/100 [02:23<10:03,  7.45s/it]epoch:  20%|██        | 20/100 [02:30<09:55,  7.45s/it]epoch:  21%|██        | 21/100 [02:38<09:55,  7.54s/it]epoch:  22%|██▏       | 22/100 [02:45<09:42,  7.47s/it]epoch:  23%|██▎       | 23/100 [02:53<09:34,  7.47s/it]epoch:  24%|██▍       | 24/100 [03:00<09:23,  7.41s/it]epoch:  25%|██▌       | 25/100 [03:07<09:19,  7.46s/it]epoch:  26%|██▌       | 26/100 [03:15<09:15,  7.51s/it]epoch:  27%|██▋       | 27/100 [03:23<09:09,  7.53s/it]epoch:  28%|██▊       | 28/100 [03:30<09:02,  7.53s/it]epoch:  29%|██▉       | 29/100 [03:37<08:50,  7.47s/it]epoch:  30%|███       | 30/100 [03:45<08:40,  7.44s/it]0.05762092979492056
best ic: 0.05762092979492056
epoch:  31%|███       | 31/100 [03:53<08:57,  7.79s/it]0.05345512299458059
epoch:  32%|███▏      | 32/100 [04:02<09:06,  8.03s/it]0.05923989145347463
best ic: 0.05923989145347463
epoch:  33%|███▎      | 33/100 [04:11<09:10,  8.22s/it]0.05933020044917493
best ic: 0.05933020044917493
epoch:  34%|███▍      | 34/100 [04:19<09:08,  8.31s/it]0.05987240938467489
best ic: 0.05987240938467489
epoch:  35%|███▌      | 35/100 [04:28<09:06,  8.41s/it]0.05999971566497673
best ic: 0.05999971566497673
epoch:  36%|███▌      | 36/100 [04:36<09:00,  8.45s/it]0.0567615314451662
epoch:  37%|███▋      | 37/100 [04:45<08:56,  8.51s/it]0.058986110844734485
epoch:  38%|███▊      | 38/100 [04:54<08:48,  8.52s/it]0.056377220830563186
epoch:  39%|███▉      | 39/100 [05:02<08:39,  8.52s/it]0.0557420439480331
epoch:  40%|████      | 40/100 [05:11<08:33,  8.56s/it]0.058557612501215314
epoch:  41%|████      | 41/100 [05:19<08:23,  8.54s/it]0.05601034807824511
epoch:  42%|████▏     | 42/100 [05:28<08:13,  8.50s/it]0.05650048859658708
epoch:  43%|████▎     | 43/100 [05:36<08:07,  8.55s/it]0.053837400643357354
epoch:  43%|████▎     | 43/100 [05:45<07:37,  8.03s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2907598:MainThread](2024-04-24 21:40:50,917) INFO - qlib.workflow - [exp.py:258] - Experiment 37 starts running ...
[2907598:MainThread](2024-04-24 21:40:50,931) INFO - qlib.workflow - [recorder.py:341] - Recorder d4c8f233ebf84466817deff5206ed928 starts running under Experiment 37 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:03, 15.67it/s]online:   6%|▋         | 4/63 [00:00<00:03, 16.20it/s]online:  10%|▉         | 6/63 [00:00<00:03, 16.58it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 16.33it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 16.12it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 16.07it/s]online:  22%|██▏       | 14/63 [00:00<00:03, 15.97it/s]online:  25%|██▌       | 16/63 [00:00<00:02, 15.83it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 15.99it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 16.03it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 16.05it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 15.89it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 15.84it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 15.90it/s]online:  48%|████▊     | 30/63 [00:01<00:02, 16.00it/s]online:  51%|█████     | 32/63 [00:01<00:01, 16.02it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 15.94it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 16.11it/s]online:  60%|██████    | 38/63 [00:02<00:01, 16.16it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 16.11it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 15.96it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 16.07it/s]online:  73%|███████▎  | 46/63 [00:02<00:01, 16.18it/s]online:  76%|███████▌  | 48/63 [00:02<00:00, 16.12it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 16.17it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 16.15it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 16.22it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 16.20it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 15.90it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 15.89it/s]online:  98%|█████████▊| 62/63 [00:03<00:00, 15.89it/s]online: 100%|██████████| 63/63 [00:03<00:00, 16.07it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2907598:MainThread](2024-04-24 21:41:01,567) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9963666 mae 0.7076547
{'IC': 0.030277411918822786,
 'ICIR': 0.23350961674470339,
 'Rank IC': 0.030557148580472576,
 'Rank ICIR': 0.23840990463425957}
[2907598:MainThread](2024-04-24 21:41:03,291) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2907598:MainThread](2024-04-24 21:41:15,509) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 21:41:15,512) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 21:41:21,605) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f611b583160>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:41,  9.58it/s]backtest loop:   1%|          | 10/971 [00:00<00:35, 27.43it/s]backtest loop:   2%|▏         | 17/971 [00:00<00:26, 36.54it/s]backtest loop:   2%|▏         | 23/971 [00:00<00:22, 43.00it/s]backtest loop:   3%|▎         | 29/971 [00:00<00:20, 45.12it/s]backtest loop:   4%|▎         | 36/971 [00:00<00:18, 50.60it/s]backtest loop:   4%|▍         | 43/971 [00:01<00:17, 54.28it/s]backtest loop:   5%|▌         | 49/971 [00:01<00:17, 53.14it/s]backtest loop:   6%|▌         | 56/971 [00:01<00:16, 56.09it/s]backtest loop:   6%|▋         | 62/971 [00:01<00:16, 53.53it/s]backtest loop:   7%|▋         | 69/971 [00:01<00:15, 56.71it/s]backtest loop:   8%|▊         | 76/971 [00:01<00:15, 58.40it/s]backtest loop:   8%|▊         | 82/971 [00:01<00:15, 55.87it/s]backtest loop:   9%|▉         | 89/971 [00:01<00:15, 57.92it/s]backtest loop:  10%|▉         | 95/971 [00:01<00:15, 57.93it/s]backtest loop:  11%|█         | 102/971 [00:02<00:15, 56.20it/s]backtest loop:  11%|█         | 109/971 [00:02<00:14, 58.33it/s]backtest loop:  12%|█▏        | 116/971 [00:02<00:14, 59.87it/s]backtest loop:  13%|█▎        | 123/971 [00:02<00:14, 57.63it/s]backtest loop:  13%|█▎        | 129/971 [00:02<00:15, 54.61it/s]backtest loop:  14%|█▍        | 136/971 [00:02<00:15, 53.99it/s]backtest loop:  15%|█▍        | 143/971 [00:02<00:14, 56.48it/s]backtest loop:  15%|█▌        | 150/971 [00:02<00:14, 58.45it/s]backtest loop:  16%|█▌        | 156/971 [00:02<00:14, 55.84it/s]backtest loop:  17%|█▋        | 163/971 [00:03<00:13, 57.94it/s]backtest loop:  18%|█▊        | 170/971 [00:03<00:13, 59.50it/s]backtest loop:  18%|█▊        | 176/971 [00:03<00:14, 56.59it/s]backtest loop:  19%|█▉        | 183/971 [00:03<00:13, 58.65it/s]backtest loop:  20%|█▉        | 190/971 [00:03<00:13, 56.73it/s]backtest loop:  20%|██        | 197/971 [00:03<00:13, 58.66it/s]backtest loop:  21%|██        | 204/971 [00:03<00:12, 60.20it/s]backtest loop:  22%|██▏       | 211/971 [00:03<00:13, 58.11it/s]backtest loop:  22%|██▏       | 217/971 [00:04<00:13, 55.89it/s]backtest loop:  23%|██▎       | 224/971 [00:04<00:12, 57.96it/s]backtest loop:  24%|██▎       | 230/971 [00:04<00:13, 55.56it/s]backtest loop:  24%|██▍       | 237/971 [00:04<00:12, 57.76it/s]backtest loop:  25%|██▌       | 244/971 [00:04<00:12, 59.31it/s]backtest loop:  26%|██▌       | 250/971 [00:04<00:12, 56.59it/s]backtest loop:  26%|██▋       | 257/971 [00:04<00:12, 58.68it/s]backtest loop:  27%|██▋       | 264/971 [00:04<00:12, 56.39it/s]backtest loop:  28%|██▊       | 271/971 [00:04<00:12, 55.51it/s]backtest loop:  29%|██▊       | 278/971 [00:05<00:12, 57.60it/s]backtest loop:  29%|██▉       | 285/971 [00:05<00:11, 59.13it/s]backtest loop:  30%|██▉       | 291/971 [00:05<00:12, 56.33it/s]backtest loop:  31%|███       | 298/971 [00:05<00:11, 58.21it/s]backtest loop:  31%|███▏      | 305/971 [00:05<00:11, 56.36it/s]backtest loop:  32%|███▏      | 312/971 [00:05<00:11, 58.27it/s]backtest loop:  33%|███▎      | 319/971 [00:05<00:10, 59.86it/s]backtest loop:  34%|███▎      | 326/971 [00:05<00:11, 57.69it/s]backtest loop:  34%|███▍      | 332/971 [00:06<00:10, 58.26it/s]backtest loop:  35%|███▍      | 339/971 [00:06<00:10, 60.12it/s]backtest loop:  36%|███▌      | 346/971 [00:06<00:10, 57.60it/s]backtest loop:  36%|███▋      | 353/971 [00:06<00:10, 59.32it/s]backtest loop:  37%|███▋      | 360/971 [00:06<00:10, 57.38it/s]backtest loop:  38%|███▊      | 367/971 [00:06<00:10, 55.96it/s]backtest loop:  38%|███▊      | 373/971 [00:06<00:11, 54.19it/s]backtest loop:  39%|███▉      | 380/971 [00:06<00:10, 56.62it/s]backtest loop:  40%|███▉      | 387/971 [00:06<00:09, 58.67it/s]backtest loop:  40%|████      | 393/971 [00:07<00:10, 56.25it/s]backtest loop:  41%|████      | 400/971 [00:07<00:09, 57.80it/s]backtest loop:  42%|████▏     | 407/971 [00:07<00:09, 59.30it/s]backtest loop:  43%|████▎     | 413/971 [00:07<00:09, 56.67it/s]backtest loop:  43%|████▎     | 419/971 [00:07<00:15, 35.95it/s]backtest loop:  44%|████▍     | 426/971 [00:07<00:13, 41.73it/s]backtest loop:  44%|████▍     | 432/971 [00:08<00:12, 43.76it/s]backtest loop:  45%|████▌     | 439/971 [00:08<00:10, 48.46it/s]backtest loop:  46%|████▌     | 446/971 [00:08<00:10, 52.25it/s]backtest loop:  47%|████▋     | 452/971 [00:08<00:10, 51.55it/s]backtest loop:  47%|████▋     | 458/971 [00:08<00:09, 53.49it/s]backtest loop:  48%|████▊     | 465/971 [00:08<00:09, 56.15it/s]backtest loop:  49%|████▊     | 472/971 [00:08<00:09, 55.01it/s]backtest loop:  49%|████▉     | 479/971 [00:08<00:08, 57.28it/s]backtest loop:  50%|█████     | 486/971 [00:08<00:08, 58.90it/s]backtest loop:  51%|█████     | 492/971 [00:09<00:08, 56.23it/s]backtest loop:  51%|█████▏    | 499/971 [00:09<00:08, 58.25it/s]backtest loop:  52%|█████▏    | 505/971 [00:09<00:08, 56.00it/s]backtest loop:  53%|█████▎    | 512/971 [00:09<00:08, 55.09it/s]backtest loop:  53%|█████▎    | 519/971 [00:09<00:07, 57.48it/s]backtest loop:  54%|█████▍    | 525/971 [00:09<00:07, 58.03it/s]backtest loop:  55%|█████▍    | 531/971 [00:09<00:07, 55.63it/s]backtest loop:  55%|█████▌    | 538/971 [00:09<00:07, 57.77it/s]backtest loop:  56%|█████▌    | 545/971 [00:09<00:07, 59.58it/s]backtest loop:  57%|█████▋    | 551/971 [00:10<00:07, 56.63it/s]backtest loop:  57%|█████▋    | 558/971 [00:10<00:07, 58.49it/s]backtest loop:  58%|█████▊    | 565/971 [00:10<00:06, 59.80it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 57.06it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:06, 58.67it/s]backtest loop:  60%|██████    | 585/971 [00:10<00:06, 60.20it/s]backtest loop:  61%|██████    | 592/971 [00:10<00:06, 57.74it/s]backtest loop:  62%|██████▏   | 599/971 [00:10<00:06, 59.06it/s]backtest loop:  62%|██████▏   | 605/971 [00:10<00:06, 56.24it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 58.23it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:05, 59.73it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 56.61it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 58.69it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 60.25it/s]backtest loop:  67%|██████▋   | 646/971 [00:11<00:05, 57.86it/s]backtest loop:  67%|██████▋   | 653/971 [00:11<00:05, 59.33it/s]backtest loop:  68%|██████▊   | 660/971 [00:11<00:05, 57.20it/s]backtest loop:  69%|██████▊   | 666/971 [00:12<00:05, 57.86it/s]backtest loop:  69%|██████▉   | 673/971 [00:12<00:05, 59.38it/s]backtest loop:  70%|██████▉   | 679/971 [00:12<00:05, 56.43it/s]backtest loop:  71%|███████   | 686/971 [00:12<00:04, 58.32it/s]backtest loop:  71%|███████▏  | 693/971 [00:12<00:04, 59.74it/s]backtest loop:  72%|███████▏  | 699/971 [00:12<00:04, 56.64it/s]backtest loop:  73%|███████▎  | 706/971 [00:12<00:04, 58.45it/s]backtest loop:  73%|███████▎  | 713/971 [00:12<00:04, 59.77it/s]backtest loop:  74%|███████▍  | 719/971 [00:12<00:04, 56.26it/s]backtest loop:  75%|███████▍  | 726/971 [00:13<00:04, 58.33it/s]backtest loop:  75%|███████▌  | 732/971 [00:13<00:04, 55.67it/s]backtest loop:  76%|███████▌  | 738/971 [00:13<00:04, 53.89it/s]backtest loop:  77%|███████▋  | 745/971 [00:13<00:03, 56.55it/s]backtest loop:  77%|███████▋  | 751/971 [00:13<00:04, 54.50it/s]backtest loop:  78%|███████▊  | 758/971 [00:13<00:03, 56.92it/s]backtest loop:  79%|███████▉  | 765/971 [00:13<00:03, 55.72it/s]backtest loop:  80%|███████▉  | 772/971 [00:13<00:03, 57.73it/s]backtest loop:  80%|████████  | 779/971 [00:13<00:03, 59.37it/s]backtest loop:  81%|████████  | 785/971 [00:14<00:03, 56.51it/s]backtest loop:  82%|████████▏ | 792/971 [00:14<00:03, 58.38it/s]backtest loop:  82%|████████▏ | 798/971 [00:14<00:03, 55.44it/s]backtest loop:  83%|████████▎ | 805/971 [00:14<00:02, 57.53it/s]backtest loop:  84%|████████▎ | 812/971 [00:14<00:02, 59.10it/s]backtest loop:  84%|████████▍ | 818/971 [00:14<00:02, 56.32it/s]backtest loop:  85%|████████▍ | 825/971 [00:14<00:02, 58.29it/s]backtest loop:  86%|████████▌ | 832/971 [00:14<00:02, 59.71it/s]backtest loop:  86%|████████▋ | 838/971 [00:15<00:02, 56.72it/s]backtest loop:  87%|████████▋ | 845/971 [00:15<00:02, 58.57it/s]backtest loop:  88%|████████▊ | 852/971 [00:15<00:02, 56.69it/s]backtest loop:  88%|████████▊ | 859/971 [00:15<00:01, 58.53it/s]backtest loop:  89%|████████▉ | 866/971 [00:15<00:01, 59.86it/s]backtest loop:  90%|████████▉ | 873/971 [00:15<00:01, 57.14it/s]backtest loop:  91%|█████████ | 880/971 [00:15<00:01, 58.81it/s]backtest loop:  91%|█████████▏| 887/971 [00:15<00:01, 56.95it/s]backtest loop:  92%|█████████▏| 894/971 [00:15<00:01, 58.67it/s]backtest loop:  93%|█████████▎| 901/971 [00:16<00:01, 60.02it/s]backtest loop:  94%|█████████▎| 908/971 [00:16<00:01, 57.68it/s]backtest loop:  94%|█████████▍| 915/971 [00:16<00:00, 59.29it/s]backtest loop:  95%|█████████▍| 921/971 [00:16<00:00, 56.50it/s]backtest loop:  96%|█████████▌| 928/971 [00:16<00:00, 58.41it/s]backtest loop:  96%|█████████▋| 935/971 [00:16<00:00, 59.78it/s]backtest loop:  97%|█████████▋| 942/971 [00:16<00:00, 57.14it/s]backtest loop:  98%|█████████▊| 949/971 [00:16<00:00, 58.91it/s]backtest loop:  98%|█████████▊| 955/971 [00:17<00:00, 56.21it/s]backtest loop:  99%|█████████▉| 962/971 [00:17<00:00, 58.18it/s]backtest loop: 100%|█████████▉| 969/971 [00:17<00:00, 59.62it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 56.08it/s]
[2907598:MainThread](2024-04-24 21:41:38,988) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000421
std                0.005218
annualized_return  0.100225
information_ratio  1.245025
max_drawdown      -0.081535
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000224
std                0.005218
annualized_return  0.053225
information_ratio  0.661158
max_drawdown      -0.113653
[2907598:MainThread](2024-04-24 21:41:39,003) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_LSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_20:45:25_online`.
Round 9 Done!
{'1day.excess_return_with_cost.annualized_return': [0.05466509644132003,
                                                    0.03782940405138317,
                                                    0.07586443941440547,
                                                    0.1007235789374887,
                                                    0.08308022585420154,
                                                    0.07661986431541934,
                                                    0.06402319866569046,
                                                    0.04923227892553839,
                                                    0.05322547876795422],
 '1day.excess_return_with_cost.information_ratio': [0.7299136334968934,
                                                    0.5090576149926579,
                                                    0.973621450511456,
                                                    1.1741504408846737,
                                                    1.0526981011869454,
                                                    0.909687372692452,
                                                    0.7681047075993076,
                                                    0.6093312247202153,
                                                    0.6611579153187023],
 '1day.excess_return_with_cost.max_drawdown': [-0.10300273228156126,
                                               -0.07110045372162947,
                                               -0.10316664621820637,
                                               -0.12565292200159456,
                                               -0.0866624354594844,
                                               -0.08550822606800032,
                                               -0.09081294564731399,
                                               -0.1574520353107441,
                                               -0.11365262021608893],
 'IC': [0.027313668501984606,
        0.02579261406197789,
        0.03255547500325296,
        0.031253622229328794,
        0.028359953926004513,
        0.02926831981190667,
        0.028950484510480535,
        0.028599683954604254,
        0.030277411918822786],
 'ICIR': [0.22308366803828927,
          0.2041430983365273,
          0.2649221294676209,
          0.2376593376010492,
          0.22114083430756656,
          0.23684439373579488,
          0.22117865524855462,
          0.22627021866475863,
          0.23350961674470339],
 'Rank IC': [0.029403174427850773,
             0.026010289810945806,
             0.03008340103876209,
             0.03454798288534817,
             0.03048201533902068,
             0.02668062819304763,
             0.029248613099269714,
             0.02618758280560536,
             0.030557148580472576],
 'Rank ICIR': [0.23996303432974886,
               0.2041684188204175,
               0.2484018289690483,
               0.2636972930450768,
               0.2367898341421186,
               0.21158468536298225,
               0.22365030561168928,
               0.20713449064856865,
               0.23840990463425957],
 'mae': [0.707563579082489,
         0.707649827003479,
         0.7076614499092102,
         0.7073816657066345,
         0.7075479030609131,
         0.7075843214988708,
         0.7076895833015442,
         0.7076771855354309,
         0.7076547145843506],
 'mse': [0.9965025782585144,
         0.9965060353279114,
         0.9961802363395691,
         0.9962019324302673,
         0.9962646961212158,
         0.9963986277580261,
         0.9964330196380615,
         0.9964442253112793,
         0.9963666200637817]}
Traceback (most recent call last):
  File "main.py", line 479, in run_all
    assert self.reload_tag is not None
AssertionError
No valid experiment to reload. Restart offline training...
[2907598:MainThread](2024-04-24 21:41:40,171) INFO - qlib.LSTM - [pytorch_lstm.py:60] - LSTM pytorch version...
[2907598:MainThread](2024-04-24 21:41:40,171) INFO - qlib.LSTM - [pytorch_lstm.py:77] - LSTM parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 8
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
epoch:   0%|          | 0/100 [00:00<?, ?it/s]epoch:   1%|          | 1/100 [00:07<12:45,  7.73s/it]epoch:   2%|▏         | 2/100 [00:15<12:22,  7.58s/it]epoch:   3%|▎         | 3/100 [00:22<12:10,  7.54s/it]epoch:   4%|▍         | 4/100 [00:30<12:00,  7.51s/it]epoch:   5%|▌         | 5/100 [00:37<11:52,  7.50s/it]epoch:   6%|▌         | 6/100 [00:45<11:50,  7.56s/it]epoch:   7%|▋         | 7/100 [00:52<11:45,  7.59s/it]epoch:   8%|▊         | 8/100 [01:00<11:33,  7.54s/it]epoch:   9%|▉         | 9/100 [01:07<11:24,  7.52s/it]epoch:  10%|█         | 10/100 [01:15<11:17,  7.53s/it]epoch:  11%|█         | 11/100 [01:22<11:11,  7.54s/it]epoch:  12%|█▏        | 12/100 [01:30<11:07,  7.58s/it]epoch:  13%|█▎        | 13/100 [01:38<11:03,  7.63s/it]epoch:  14%|█▍        | 14/100 [01:45<10:53,  7.60s/it]epoch:  15%|█▌        | 15/100 [01:53<10:43,  7.57s/it]epoch:  16%|█▌        | 16/100 [02:00<10:31,  7.52s/it]epoch:  17%|█▋        | 17/100 [02:08<10:18,  7.46s/it]epoch:  18%|█▊        | 18/100 [02:15<10:07,  7.40s/it]epoch:  19%|█▉        | 19/100 [02:23<10:04,  7.46s/it]epoch:  20%|██        | 20/100 [02:30<09:58,  7.48s/it]epoch:  21%|██        | 21/100 [02:38<09:51,  7.49s/it]epoch:  22%|██▏       | 22/100 [02:45<09:43,  7.48s/it]epoch:  23%|██▎       | 23/100 [02:52<09:35,  7.47s/it]epoch:  24%|██▍       | 24/100 [03:00<09:24,  7.43s/it]epoch:  25%|██▌       | 25/100 [03:07<09:14,  7.39s/it]epoch:  26%|██▌       | 26/100 [03:15<09:09,  7.42s/it]epoch:  27%|██▋       | 27/100 [03:22<09:05,  7.47s/it]epoch:  28%|██▊       | 28/100 [03:30<09:02,  7.54s/it]epoch:  29%|██▉       | 29/100 [03:38<08:57,  7.57s/it]epoch:  30%|███       | 30/100 [03:45<08:50,  7.57s/it]0.05668275500079169
best ic: 0.05668275500079169
epoch:  31%|███       | 31/100 [03:54<09:02,  7.87s/it]0.05665153266697775
epoch:  32%|███▏      | 32/100 [04:02<09:04,  8.01s/it]0.048690939119524095
epoch:  33%|███▎      | 33/100 [04:11<09:07,  8.18s/it]0.05817708488481896
best ic: 0.05817708488481896
epoch:  34%|███▍      | 34/100 [04:19<09:10,  8.33s/it]0.05742958775359892
epoch:  35%|███▌      | 35/100 [04:28<09:10,  8.47s/it]0.054845775846868276
epoch:  36%|███▌      | 36/100 [04:37<09:07,  8.56s/it]0.05324356553977006
epoch:  37%|███▋      | 37/100 [04:45<09:00,  8.58s/it]0.05202477277367303
epoch:  38%|███▊      | 38/100 [04:54<08:53,  8.61s/it]0.05505508312248895
epoch:  39%|███▉      | 39/100 [05:03<08:43,  8.58s/it]0.05419838607528823
epoch:  40%|████      | 40/100 [05:11<08:35,  8.59s/it]0.052875621769235014
epoch:  41%|████      | 41/100 [05:20<08:27,  8.60s/it]0.050711521772646935
epoch:  41%|████      | 41/100 [05:29<07:53,  8.03s/it]
Test segment: 2020-04-01 00:00:00 2024-03-29 00:00:00
[2907598:MainThread](2024-04-24 21:47:09,454) INFO - qlib.workflow - [exp.py:258] - Experiment 37 starts running ...
[2907598:MainThread](2024-04-24 21:47:09,468) INFO - qlib.workflow - [recorder.py:341] - Recorder d4b9e7d1a9694fbf87fd368600b92dac starts running under Experiment 37 ...
online:   0%|          | 0/63 [00:00<?, ?it/s]online:   3%|▎         | 2/63 [00:00<00:03, 15.85it/s]online:   6%|▋         | 4/63 [00:00<00:03, 16.65it/s]online:  10%|▉         | 6/63 [00:00<00:03, 16.11it/s]online:  13%|█▎        | 8/63 [00:00<00:03, 16.00it/s]online:  16%|█▌        | 10/63 [00:00<00:03, 15.92it/s]online:  19%|█▉        | 12/63 [00:00<00:03, 15.89it/s]online:  22%|██▏       | 14/63 [00:00<00:03, 15.97it/s]online:  25%|██▌       | 16/63 [00:00<00:02, 16.04it/s]online:  29%|██▊       | 18/63 [00:01<00:02, 15.89it/s]online:  32%|███▏      | 20/63 [00:01<00:02, 15.84it/s]online:  35%|███▍      | 22/63 [00:01<00:02, 15.99it/s]online:  38%|███▊      | 24/63 [00:01<00:02, 15.85it/s]online:  41%|████▏     | 26/63 [00:01<00:02, 15.94it/s]online:  44%|████▍     | 28/63 [00:01<00:02, 15.87it/s]online:  48%|████▊     | 30/63 [00:01<00:02, 15.97it/s]online:  51%|█████     | 32/63 [00:02<00:01, 16.00it/s]online:  54%|█████▍    | 34/63 [00:02<00:01, 16.10it/s]online:  57%|█████▋    | 36/63 [00:02<00:01, 16.27it/s]online:  60%|██████    | 38/63 [00:02<00:01, 16.04it/s]online:  63%|██████▎   | 40/63 [00:02<00:01, 16.03it/s]online:  67%|██████▋   | 42/63 [00:02<00:01, 16.30it/s]online:  70%|██████▉   | 44/63 [00:02<00:01, 16.02it/s]online:  73%|███████▎  | 46/63 [00:02<00:01, 16.12it/s]online:  76%|███████▌  | 48/63 [00:02<00:00, 16.08it/s]online:  79%|███████▉  | 50/63 [00:03<00:00, 16.00it/s]online:  83%|████████▎ | 52/63 [00:03<00:00, 15.98it/s]online:  86%|████████▌ | 54/63 [00:03<00:00, 15.99it/s]online:  89%|████████▉ | 56/63 [00:03<00:00, 16.06it/s]online:  92%|█████████▏| 58/63 [00:03<00:00, 16.11it/s]online:  95%|█████████▌| 60/63 [00:03<00:00, 16.00it/s]online:  98%|█████████▊| 62/63 [00:03<00:00, 16.00it/s]online: 100%|██████████| 63/63 [00:03<00:00, 16.06it/s]
lr_model: 0.001 lr_ma: 0.001 lr_da: 0.01
[2907598:MainThread](2024-04-24 21:47:19,913) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
mse: 0.9962564 mae 0.7076022
{'IC': 0.029430944949770152,
 'ICIR': 0.23570072097321412,
 'Rank IC': 0.02763966056343502,
 'Rank ICIR': 0.21981948924864825}
[2907598:MainThread](2024-04-24 21:47:21,657) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[2907598:MainThread](2024-04-24 21:47:33,820) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 21:47:33,823) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[2907598:MainThread](2024-04-24 21:47:39,884) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f5aaa69c400>
backtest loop:   0%|          | 0/971 [00:00<?, ?it/s]/home/zhonghao/miniconda3/envs/sjtu_qlib/lib/python3.8/site-packages/qlib/utils/index_data.py:481: RuntimeWarning: Mean of empty slice
  return np.nanmean(self.data)
backtest loop:   0%|          | 3/971 [00:00<01:40,  9.59it/s]backtest loop:   1%|          | 9/971 [00:00<00:37, 25.39it/s]backtest loop:   2%|▏         | 16/971 [00:00<00:25, 37.79it/s]backtest loop:   2%|▏         | 21/971 [00:00<00:23, 40.55it/s]backtest loop:   3%|▎         | 28/971 [00:00<00:19, 47.59it/s]backtest loop:   4%|▎         | 34/971 [00:00<00:19, 48.30it/s]backtest loop:   4%|▍         | 41/971 [00:00<00:17, 52.69it/s]backtest loop:   5%|▍         | 48/971 [00:01<00:16, 55.67it/s]backtest loop:   6%|▌         | 54/971 [00:01<00:17, 52.84it/s]backtest loop:   6%|▌         | 60/971 [00:01<00:16, 54.67it/s]backtest loop:   7%|▋         | 67/971 [00:01<00:16, 54.17it/s]backtest loop:   8%|▊         | 74/971 [00:01<00:15, 57.17it/s]backtest loop:   8%|▊         | 81/971 [00:01<00:15, 58.73it/s]backtest loop:   9%|▉         | 87/971 [00:01<00:15, 56.04it/s]backtest loop:  10%|▉         | 94/971 [00:01<00:15, 58.27it/s]backtest loop:  10%|█         | 101/971 [00:02<00:14, 59.63it/s]backtest loop:  11%|█         | 107/971 [00:02<00:15, 56.87it/s]backtest loop:  12%|█▏        | 114/971 [00:02<00:14, 58.70it/s]backtest loop:  12%|█▏        | 121/971 [00:02<00:14, 59.91it/s]backtest loop:  13%|█▎        | 128/971 [00:02<00:15, 54.55it/s]backtest loop:  14%|█▍        | 135/971 [00:02<00:14, 56.81it/s]backtest loop:  15%|█▍        | 141/971 [00:02<00:15, 54.74it/s]backtest loop:  15%|█▌        | 148/971 [00:02<00:14, 57.12it/s]backtest loop:  16%|█▌        | 155/971 [00:02<00:13, 58.78it/s]backtest loop:  17%|█▋        | 161/971 [00:03<00:14, 55.77it/s]backtest loop:  17%|█▋        | 168/971 [00:03<00:13, 57.79it/s]backtest loop:  18%|█▊        | 175/971 [00:03<00:13, 59.39it/s]backtest loop:  19%|█▊        | 181/971 [00:03<00:13, 56.72it/s]backtest loop:  19%|█▉        | 188/971 [00:03<00:13, 58.62it/s]backtest loop:  20%|██        | 195/971 [00:03<00:13, 56.52it/s]backtest loop:  21%|██        | 202/971 [00:03<00:13, 58.27it/s]backtest loop:  22%|██▏       | 209/971 [00:03<00:12, 59.60it/s]backtest loop:  22%|██▏       | 215/971 [00:04<00:13, 54.05it/s]backtest loop:  23%|██▎       | 222/971 [00:04<00:13, 56.48it/s]backtest loop:  24%|██▎       | 229/971 [00:04<00:12, 58.51it/s]backtest loop:  24%|██▍       | 235/971 [00:04<00:13, 55.98it/s]backtest loop:  25%|██▍       | 242/971 [00:04<00:12, 58.04it/s]backtest loop:  26%|██▌       | 249/971 [00:04<00:12, 56.47it/s]backtest loop:  26%|██▋       | 256/971 [00:04<00:12, 58.55it/s]backtest loop:  27%|██▋       | 263/971 [00:04<00:11, 59.90it/s]backtest loop:  28%|██▊       | 270/971 [00:04<00:12, 57.56it/s]backtest loop:  28%|██▊       | 276/971 [00:05<00:12, 55.21it/s]backtest loop:  29%|██▉       | 283/971 [00:05<00:11, 57.37it/s]backtest loop:  30%|██▉       | 290/971 [00:05<00:11, 59.03it/s]backtest loop:  30%|███       | 296/971 [00:05<00:12, 55.78it/s]backtest loop:  31%|███       | 303/971 [00:05<00:11, 57.75it/s]backtest loop:  32%|███▏      | 310/971 [00:05<00:11, 56.00it/s]backtest loop:  33%|███▎      | 317/971 [00:05<00:11, 58.10it/s]backtest loop:  33%|███▎      | 324/971 [00:05<00:10, 59.79it/s]backtest loop:  34%|███▍      | 331/971 [00:06<00:11, 57.42it/s]backtest loop:  35%|███▍      | 338/971 [00:06<00:10, 59.01it/s]backtest loop:  36%|███▌      | 345/971 [00:06<00:11, 56.76it/s]backtest loop:  36%|███▋      | 352/971 [00:06<00:10, 58.64it/s]backtest loop:  37%|███▋      | 359/971 [00:06<00:10, 59.96it/s]backtest loop:  38%|███▊      | 366/971 [00:06<00:10, 57.50it/s]backtest loop:  38%|███▊      | 372/971 [00:06<00:10, 55.33it/s]backtest loop:  39%|███▉      | 378/971 [00:06<00:11, 53.70it/s]backtest loop:  40%|███▉      | 385/971 [00:06<00:10, 56.34it/s]backtest loop:  40%|████      | 392/971 [00:07<00:09, 58.28it/s]backtest loop:  41%|████      | 398/971 [00:07<00:10, 55.56it/s]backtest loop:  42%|████▏     | 405/971 [00:07<00:09, 57.54it/s]backtest loop:  42%|████▏     | 412/971 [00:07<00:09, 58.90it/s]backtest loop:  43%|████▎     | 418/971 [00:07<00:09, 55.95it/s]backtest loop:  44%|████▎     | 424/971 [00:07<00:15, 35.50it/s]backtest loop:  44%|████▍     | 431/971 [00:07<00:13, 41.21it/s]backtest loop:  45%|████▌     | 437/971 [00:08<00:12, 43.30it/s]backtest loop:  46%|████▌     | 444/971 [00:08<00:10, 48.04it/s]backtest loop:  46%|████▋     | 451/971 [00:08<00:10, 51.84it/s]backtest loop:  47%|████▋     | 457/971 [00:08<00:10, 51.27it/s]backtest loop:  48%|████▊     | 464/971 [00:08<00:09, 54.35it/s]backtest loop:  49%|████▊     | 471/971 [00:08<00:08, 56.74it/s]backtest loop:  49%|████▉     | 477/971 [00:08<00:09, 54.60it/s]backtest loop:  50%|████▉     | 484/971 [00:08<00:08, 56.88it/s]backtest loop:  50%|█████     | 490/971 [00:09<00:08, 54.45it/s]backtest loop:  51%|█████     | 497/971 [00:09<00:08, 56.86it/s]backtest loop:  52%|█████▏    | 504/971 [00:09<00:07, 58.82it/s]backtest loop:  53%|█████▎    | 510/971 [00:09<00:08, 56.12it/s]backtest loop:  53%|█████▎    | 517/971 [00:09<00:08, 55.00it/s]backtest loop:  54%|█████▍    | 524/971 [00:09<00:07, 57.23it/s]backtest loop:  55%|█████▍    | 531/971 [00:09<00:07, 55.80it/s]backtest loop:  55%|█████▌    | 538/971 [00:09<00:07, 57.77it/s]backtest loop:  56%|█████▌    | 545/971 [00:09<00:07, 59.51it/s]backtest loop:  57%|█████▋    | 551/971 [00:10<00:07, 56.84it/s]backtest loop:  57%|█████▋    | 557/971 [00:10<00:07, 57.57it/s]backtest loop:  58%|█████▊    | 564/971 [00:10<00:06, 59.09it/s]backtest loop:  59%|█████▉    | 571/971 [00:10<00:07, 57.10it/s]backtest loop:  60%|█████▉    | 578/971 [00:10<00:06, 58.63it/s]backtest loop:  60%|██████    | 585/971 [00:10<00:06, 59.99it/s]backtest loop:  61%|██████    | 592/971 [00:10<00:06, 57.66it/s]backtest loop:  62%|██████▏   | 599/971 [00:10<00:06, 59.17it/s]backtest loop:  62%|██████▏   | 605/971 [00:11<00:06, 56.36it/s]backtest loop:  63%|██████▎   | 612/971 [00:11<00:06, 58.41it/s]backtest loop:  64%|██████▎   | 619/971 [00:11<00:05, 59.66it/s]backtest loop:  64%|██████▍   | 625/971 [00:11<00:06, 56.50it/s]backtest loop:  65%|██████▌   | 632/971 [00:11<00:05, 58.29it/s]backtest loop:  66%|██████▌   | 639/971 [00:11<00:05, 59.79it/s]backtest loop:  67%|██████▋   | 646/971 [00:11<00:05, 57.39it/s]backtest loop:  67%|██████▋   | 653/971 [00:11<00:05, 58.94it/s]backtest loop:  68%|██████▊   | 660/971 [00:11<00:05, 56.90it/s]backtest loop:  69%|██████▊   | 667/971 [00:12<00:05, 58.55it/s]backtest loop:  69%|██████▉   | 674/971 [00:12<00:05, 56.60it/s]backtest loop:  70%|███████   | 681/971 [00:12<00:04, 58.26it/s]backtest loop:  71%|███████   | 688/971 [00:12<00:04, 59.43it/s]backtest loop:  71%|███████▏  | 694/971 [00:12<00:04, 56.41it/s]backtest loop:  72%|███████▏  | 701/971 [00:12<00:04, 58.32it/s]backtest loop:  73%|███████▎  | 708/971 [00:12<00:04, 59.64it/s]backtest loop:  74%|███████▎  | 714/971 [00:12<00:04, 56.68it/s]backtest loop:  74%|███████▍  | 721/971 [00:13<00:04, 58.46it/s]backtest loop:  75%|███████▍  | 728/971 [00:13<00:04, 59.77it/s]backtest loop:  76%|███████▌  | 734/971 [00:13<00:04, 53.60it/s]backtest loop:  76%|███████▋  | 741/971 [00:13<00:04, 56.06it/s]backtest loop:  77%|███████▋  | 747/971 [00:13<00:03, 57.09it/s]backtest loop:  78%|███████▊  | 753/971 [00:13<00:03, 54.81it/s]backtest loop:  78%|███████▊  | 760/971 [00:13<00:03, 54.14it/s]backtest loop:  79%|███████▉  | 767/971 [00:13<00:03, 56.60it/s]backtest loop:  80%|███████▉  | 774/971 [00:13<00:03, 58.44it/s]backtest loop:  80%|████████  | 780/971 [00:14<00:03, 56.14it/s]backtest loop:  81%|████████  | 787/971 [00:14<00:03, 58.30it/s]backtest loop:  82%|████████▏ | 793/971 [00:14<00:03, 55.71it/s]backtest loop:  82%|████████▏ | 800/971 [00:14<00:02, 57.76it/s]backtest loop:  83%|████████▎ | 807/971 [00:14<00:02, 59.26it/s]backtest loop:  84%|████████▎ | 813/971 [00:14<00:02, 56.25it/s]backtest loop:  84%|████████▍ | 820/971 [00:14<00:02, 58.18it/s]backtest loop:  85%|████████▌ | 827/971 [00:14<00:02, 59.53it/s]backtest loop:  86%|████████▌ | 833/971 [00:14<00:02, 56.55it/s]backtest loop:  87%|████████▋ | 840/971 [00:15<00:02, 58.43it/s]backtest loop:  87%|████████▋ | 847/971 [00:15<00:02, 59.73it/s]backtest loop:  88%|████████▊ | 853/971 [00:15<00:02, 56.68it/s]backtest loop:  89%|████████▊ | 860/971 [00:15<00:01, 58.48it/s]backtest loop:  89%|████████▉ | 867/971 [00:15<00:01, 56.53it/s]backtest loop:  90%|█████████ | 874/971 [00:15<00:01, 58.34it/s]backtest loop:  91%|█████████ | 881/971 [00:15<00:01, 59.69it/s]backtest loop:  91%|█████████▏| 887/971 [00:15<00:01, 56.71it/s]backtest loop:  92%|█████████▏| 894/971 [00:16<00:01, 58.47it/s]backtest loop:  93%|█████████▎| 901/971 [00:16<00:01, 59.75it/s]backtest loop:  93%|█████████▎| 907/971 [00:16<00:01, 56.74it/s]backtest loop:  94%|█████████▍| 914/971 [00:16<00:00, 58.60it/s]backtest loop:  95%|█████████▍| 921/971 [00:16<00:00, 56.63it/s]backtest loop:  96%|█████████▌| 928/971 [00:16<00:00, 58.58it/s]backtest loop:  96%|█████████▋| 935/971 [00:16<00:00, 59.95it/s]backtest loop:  97%|█████████▋| 942/971 [00:16<00:00, 57.58it/s]backtest loop:  98%|█████████▊| 949/971 [00:16<00:00, 59.28it/s]backtest loop:  98%|█████████▊| 955/971 [00:17<00:00, 56.56it/s]backtest loop:  99%|█████████▉| 962/971 [00:17<00:00, 58.33it/s]backtest loop: 100%|█████████▉| 969/971 [00:17<00:00, 59.61it/s]backtest loop: 100%|██████████| 971/971 [00:17<00:00, 55.95it/s]
[2907598:MainThread](2024-04-24 21:47:57,309) INFO - qlib.workflow - [record_temp.py:515] - Portfolio analysis record 'port_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of benchmark return(1day).'
                       risk
mean               0.000039
std                0.011364
annualized_return  0.009266
information_ratio  0.052853
max_drawdown      -0.558443
'The following are analysis results of the excess return without cost(1day).'
                       risk
mean               0.000374
std                0.005296
annualized_return  0.088998
information_ratio  1.089207
max_drawdown      -0.129716
'The following are analysis results of the excess return with cost(1day).'
                       risk
mean               0.000176
std                0.005296
annualized_return  0.041903
information_ratio  0.512824
max_drawdown      -0.178895
[2907598:MainThread](2024-04-24 21:47:57,325) INFO - qlib.workflow - [record_temp.py:540] - Indicator analysis record 'indicator_analysis_1day.pkl' has been saved as the artifact of the Experiment 37
'The following are analysis results of indicators(1day).'
     value
ffr    1.0
pa     0.0
pos    0.0
Your evaluation results can be found in the experiment named `csi300_LSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_20:45:25_online`.
Round 10 Done!
{'1day.excess_return_with_cost.annualized_return': [0.05466509644132003,
                                                    0.03782940405138317,
                                                    0.07586443941440547,
                                                    0.1007235789374887,
                                                    0.08308022585420154,
                                                    0.07661986431541934,
                                                    0.06402319866569046,
                                                    0.04923227892553839,
                                                    0.05322547876795422,
                                                    0.041902957252909614],
 '1day.excess_return_with_cost.information_ratio': [0.7299136334968934,
                                                    0.5090576149926579,
                                                    0.973621450511456,
                                                    1.1741504408846737,
                                                    1.0526981011869454,
                                                    0.909687372692452,
                                                    0.7681047075993076,
                                                    0.6093312247202153,
                                                    0.6611579153187023,
                                                    0.5128237015179157],
 '1day.excess_return_with_cost.max_drawdown': [-0.10300273228156126,
                                               -0.07110045372162947,
                                               -0.10316664621820637,
                                               -0.12565292200159456,
                                               -0.0866624354594844,
                                               -0.08550822606800032,
                                               -0.09081294564731399,
                                               -0.1574520353107441,
                                               -0.11365262021608893,
                                               -0.17889519427911688],
 'IC': [0.027313668501984606,
        0.02579261406197789,
        0.03255547500325296,
        0.031253622229328794,
        0.028359953926004513,
        0.02926831981190667,
        0.028950484510480535,
        0.028599683954604254,
        0.030277411918822786,
        0.029430944949770152],
 'ICIR': [0.22308366803828927,
          0.2041430983365273,
          0.2649221294676209,
          0.2376593376010492,
          0.22114083430756656,
          0.23684439373579488,
          0.22117865524855462,
          0.22627021866475863,
          0.23350961674470339,
          0.23570072097321412],
 'Rank IC': [0.029403174427850773,
             0.026010289810945806,
             0.03008340103876209,
             0.03454798288534817,
             0.03048201533902068,
             0.02668062819304763,
             0.029248613099269714,
             0.02618758280560536,
             0.030557148580472576,
             0.02763966056343502],
 'Rank ICIR': [0.23996303432974886,
               0.2041684188204175,
               0.2484018289690483,
               0.2636972930450768,
               0.2367898341421186,
               0.21158468536298225,
               0.22365030561168928,
               0.20713449064856865,
               0.23840990463425957,
               0.21981948924864825],
 'mae': [0.707563579082489,
         0.707649827003479,
         0.7076614499092102,
         0.7073816657066345,
         0.7075479030609131,
         0.7075843214988708,
         0.7076895833015442,
         0.7076771855354309,
         0.7076547145843506,
         0.7076022028923035],
 'mse': [0.9965025782585144,
         0.9965060353279114,
         0.9961802363395691,
         0.9962019324302673,
         0.9962646961212158,
         0.9963986277580261,
         0.9964330196380615,
         0.9964442253112793,
         0.9963666200637817,
         0.996256411075592]}
[2907598:MainThread](2024-04-24 21:47:58,499) WARNING - qlib.workflow - [expm.py:230] - No valid experiment found. Create a new experiment with name csi300_LSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_20:45:25_final.
[2907598:MainThread](2024-04-24 21:47:58,527) INFO - qlib.workflow - [exp.py:258] - Experiment 38 starts running ...
[2907598:MainThread](2024-04-24 21:47:58,538) INFO - qlib.workflow - [recorder.py:341] - Recorder 0567b935e5e44b909adab5b613ffcfb6 starts running under Experiment 38 ...
Time cost: 326.36788218021394	48.887330937385556
Final results:
{'1day.excess_return_with_cost.annualized_return': [0.0637166522626311,
                                                    0.018990512246365616],
 '1day.excess_return_with_cost.information_ratio': [0.7900546162921219,
                                                    0.21764887240426856],
 '1day.excess_return_with_cost.max_drawdown': [-0.11159062112037403,
                                               0.03217570735800557],
 'IC': [0.029180217886813315, 0.0018162687917517328],
 'ICIR': [0.2304452673118079, 0.015015080833641377],
 'Rank IC': [0.029084049674375785, 0.0024659021501240138],
 'Rank ICIR': [0.2293619284812558, 0.01832850579652794],
 'mae': [0.7076012432575226, 8.670693821549868e-05],
 'mse': [0.9963554382324219, 0.00011511833211359618]}
Your final results can be found in the experiment named `csi300_LSTM_alpha360_horizon1_step20_rankFalse_2024-04-24_20:45:25_final`.
All Done!
[2907598:MainThread](2024-04-24 21:47:59,384) INFO - qlib.timer - [log.py:127] - Time cost: 0.026s | waiting `async_log` Done
